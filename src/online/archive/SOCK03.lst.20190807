* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100418  CR2018073000001  PEMA  REWORD REFUND METHODS
    54* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    55* 052319  IR2019052300001  PEMA  VIN&BENE not being passed at time
    56* 062119  CR2019050800001  PEMA  Add option to search by VIN
    57******************************************************************
    58 environment division.
    59 data division.
    60 working-storage section.
    61 01  DFH-START PIC X(04).
    62*
    63* program buffers
    64*
    65 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    66     88  ALREADY-SENT              VALUE 'Y'.
    67 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    68 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    69     88  ELCERT-FINISHED            VALUE 'Y'.
    70 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    71 77  WS-ERACCT-SW                PIC X VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   3
* SOCK03.cbl
    72     88  ERACCT-FOUND               VALUE 'Y'.
    73 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    74 77 ws-send-msg-size           pic s9(8) comp value 4096.
    75 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    76 77 ws-recv-buf                pic x(4096).
    77 77 ws-send-buf                pic x(4096) VALUE SPACES.
    78 77 ws-recv-total              pic s9(8) comp value 0.
    79 77 ws-recv-left               pic s9(8) comp value 0.
    80 77 ws-seq-num                 pic s9(8) comp value 0.
    81 77 ws-flags                   pic s9(8) comp value 0.
    82 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    83 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    84 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    85 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    86 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    87 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    88 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    89 77  ws-cancel-reason            pic x   value spaces.
    90 77  P1                          PIC S999 COMP-3 VALUE +0.
    91 77  P2                          PIC S999 COMP-3 VALUE +0.
    92 77  C0                          PIC S999 COMP-3 VALUE +0.
    93 77  C1                          PIC S999 COMP-3 VALUE +0.
    94 77  C2                          PIC S999 COMP-3 VALUE +0.
    95 77  C3                          PIC S999 COMP-3 VALUE +0.
    96 77 S1                           PIC S999 COMP-3 VALUE +0.
    97 77 S2                           PIC S999 COMP-3 VALUE +0.
    98 77 L1                           PIC S999 COMP-3 VALUE +0.
    99 77 L2                           PIC S999 COMP-3 VALUE +0.
   100 77 F1                           PIC S999 COMP-3 VALUE +0.
   101 77 WS-BUILD-SW                  PIC X.
   102    88  TIME-TO-BUILD               VALUE 'Y'.
   103 77 WS-SAVE-ERACCT               PIC X(2000).
   104 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   105 77 WS-STOP-SW                   PIC X  VALUE ' '.
   106    88  TOLD-TO-STOP               VALUE 'Y'.
   107 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   108    88  GET-RATES                    VALUE 'R'.
   109    88  GET-ACT-ACCTS                VALUE 'A'.
   110 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   111 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   112 77 ws-disp-rate                 pic z9.99999.
   113 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   114     88  END-OF-ERCTBL                 VALUE 'Y'.
   115 77  WS-STATUS                   PIC X.
   116 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   117 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   118 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   119 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   120 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   121 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   122 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   123 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   124 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   125 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   126 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   127 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   128     88  WS-ELCERT-FULL             VALUE '1'.
   129     88  WS-ELCERT-NAME             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   4
* SOCK03.cbl
   130     88  WS-ELCERT-CERT-NO          VALUE '3'.
   131     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   132     88  WS-ELCERT-VIN              value '5'.
   133 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   134 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   135     88  I-SAY-TO-STOP      VALUE 'Y'.
   136 77  WS-HEX-0A                   PIC X.
   137 77  WS-CALL-TYPE                PIC X(6).
   138 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   139 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   140 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   141 77  DD-IU-SW                    PIC X   VALUE ' '.
   142     88  DD-IU-PRESENT                 VALUE 'Y'.
   143 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   144 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   145 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   146 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   147 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   148 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   149 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   150 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   151 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   152     88  PDEF-FOUND                              VALUE 'Y'.
   153 77  ws-epiq-sw                  pic x  value ' '.
   154     88  ws-epiq-request           value 'Y'.
   155 77  ws-epiq-max                 pic s999 value +0 comp-3.
   156 01  WS-STRING-DATA.
   157     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   158     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   159     05  WS-CARRIER              PIC X        VALUE SPACES.
   160     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   161     05  WS-STATE                PIC XX       VALUE SPACES.
   162     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   163     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   164     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   165     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   166     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   167     05  WS-MID-INIT             PIC X        VALUE SPACES.
   168     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   169     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   170     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   171     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   172     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   173     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   174     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   175     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   176     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   177     05  WS-LF-METHOD            PIC X(15)    VALUE SPACES.
   178     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   179     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   180     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   181     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   182     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   183     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   184     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   185     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   186     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   187     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   5
* SOCK03.cbl
   188     05  WS-AH-METHOD            PIC X(15)    VALUE SPACES.
   189     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   190     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   191     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   192     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   193     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   194     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   195     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   196     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   197     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   198     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   199     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   200     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   201     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   202     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   203     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   204     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   205     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   206     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   207     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   208     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   209     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   210     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   211 01  ws-work-date.
   212     05  ws-work-ccyy            pic x(4).
   213     05  ws-work-mm              pic xx.
   214     05  ws-work-dd              pic xx.
   215 01  ws-work-date-num redefines ws-work-date
   216                                 pic 9(8).
   217 01  FILLER.
   218     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   219     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   220     12  WS-STATE-ABBREVIATION   PIC XX.
   221     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   222     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   223     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   224     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   225     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   226     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   227     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   228     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   229     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   230     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   231     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   232     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   233     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   234     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   235     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   236     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   237     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   238     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   239     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   240     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   241     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   242     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   243     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   244     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   245     12  WS-AH-OVERRIDE-L2       PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   6
* SOCK03.cbl
   246     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   247         88  WS-REDUCING                         VALUE 'R'.
   248         88  WS-LEVEL                            VALUE 'L'  'P'.
   249 01  ELMSTR-KEY.
   250     12  ELMSTR-COMP-CD          PIC X.
   251     12  ELMSTR-CERT-NO          PIC X(11).
   252 01  CTBL-KEY-SAVE               PIC X(5).
   253 01  CTBL-KEY.
   254     05  CTBL-COMPANY-CD         PIC X.
   255     05  CTBL-TABLE              PIC XXX.
   256     05  CTBL-BEN-TYPE           PIC X.
   257     05  CTBL-BEN-CODE           PIC XX.
   258 01  ERPDEF-KEY-SAVE             PIC X(18).
   259 01  ERPDEF-KEY.
   260     12  ERPDEF-COMPANY-CD       PIC X.
   261     12  ERPDEF-STATE            PIC XX.
   262     12  ERPDEF-PROD-CD          PIC XXX.
   263     12  F                       PIC X(7).
   264     12  ERPDEF-BEN-TYPE         PIC X.
   265     12  ERPDEF-BEN-CODE         PIC XX.
   266     12  ERPDEF-EXP-DT           PIC XX.
   267 01  WS-AM3-KEY.
   268     12  WS-AM3-ACCOUNT          PIC X(10).
   269     12  WS-AM3-EXP-DT           PIC XX.
   270 01  WS-AM-KEY.
   271     12  WS-AM-COMPANY-CD        PIC X.
   272     12  WS-AM-CARRIER           PIC X.
   273     12  WS-AM-GROUPING          PIC X(6).
   274     12  WS-AM-STATE             PIC XX.
   275     12  WS-AM-ACCOUNT           PIC X(10).
   276     12  WS-AM-EXPIRATION-DT     PIC XX.
   277     12  WS-AM-FILLER            PIC XXXX.
   278 01  WS-CO-DATA.
   279     05  WS-CO-NUM               PIC X(10).
   280     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   281     05  WS-CO-NAME              PIC X(30).
   282     05  WS-CO-MAIL-NAME         PIC X(30).
   283     05  WS-CO-ADDR1             PIC X(30).
   284     05  WS-CO-ADDR2             PIC X(30).
   285     05  WS-CO-ADDR3             PIC X(30).
   286     05  WS-CO-ZIP               PIC X(9).
   287     05  WS-CO-PHONE             PIC X(10).
   288 01  WS-CF-KEY.
   289     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   290     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   291*        88  COMPANY-MASTER                      VALUE '1'.
   292*        88  STATE-MASTER                        VALUE '3'.
   293*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   294*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   295     12  WS-CF-ACCESS.
   296         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   297         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   298             20  FILLER          PIC  X(01).
   299             20  WS-CF-CARRIER   PIC  X(01).
   300     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   301 01  WS-CS-KEY.
   302     05  WS-CS-COMPANY-CD        PIC X.
   303     05  WS-CS-CARRIER           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   7
* SOCK03.cbl
   304     05  WS-CS-GROUP             PIC X(6).
   305     05  WS-CS-STATE             PIC XX.
   306     05  WS-CS-ACCOUNT           PIC X(10).
   307     05  WS-CS-EFF-DT            PIC XX.
   308     05  WS-CS-CERT-NO           PIC X(11).
   309     05  WS-CS-TRLR-TYPE         PIC X.
   310 01  WS-MA-KEY.
   311     05  WS-MA-COMPANY-CD        PIC X.
   312     05  WS-MA-CARRIER           PIC X.
   313     05  WS-MA-GROUP             PIC X(6).
   314     05  WS-MA-STATE             PIC XX.
   315     05  WS-MA-ACCOUNT           PIC X(10).
   316     05  WS-MA-EFF-DT            PIC XX.
   317     05  WS-MA-CERT-NO           PIC X(11).
   318 01  WS-CM-KEY.
   319     05  WS-CM-COMPANY-CD        PIC X.
   320     05  WS-CM-CARRIER           PIC X.
   321     05  WS-CM-GROUP             PIC X(6).
   322     05  WS-CM-STATE             PIC XX.
   323     05  WS-CM-ACCOUNT           PIC X(10).
   324     05  WS-CM-EFF-DT            PIC XX.
   325     05  WS-CM-CERT-NO           PIC X(11).
   326 01  WS-CM-KEY-A1.
   327     05  WS-CM-COMPANY-CD-A1     PIC X.
   328     05  WS-CM-LAST-NAME         PIC X(15).
   329     05  WS-CM-INITIALS          PIC XX.
   330 01  WS-CM-KEY-A4.
   331     05  WS-CM-COMPANY-CD-A4     PIC X.
   332     05  WS-CM-CERT-NO-A4        PIC X(11).
   333 01  WS-CID-NO                   PIC X(8).
   334 01  WS-DISP-RESP                PIC 9(5).
   335 01  WS-RESPONSE                 PIC S9(8)   COMP.
   336     88  RESP-NORMAL                  VALUE +00.
   337     88  RESP-NOTFND                  VALUE +13.
   338     88  RESP-DUPKEY                  VALUE +15.
   339     88  RESP-NOTOPEN                 VALUE +19.
   340     88  RESP-ENDFILE                 VALUE +20.
   341*                                 COPY ELCCERT.
   342******************************************************************
   343*                                                                *
   344*                            ELCCERT.                            *
   345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   346*                            VMOD=2.013                          *
   347*                                                                *
   348*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   349*                                                                *
   350*   FILE TYPE = VSAM,KSDS                                        *
   351*   RECORD SIZE = 450  RECFORM = FIXED                           *
   352*                                                                *
   353*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   354*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   355*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   356*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   357*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   358*                                                                *
   359*   LOG = YES                                                    *
   360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   361******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   8
* SOCK03.cbl
   362*                   C H A N G E   L O G
   363*
   364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   365*-----------------------------------------------------------------
   366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   367* EFFECTIVE    NUMBER
   368*-----------------------------------------------------------------
   369* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   370* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   371* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   372* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   373* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   374* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   375* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   376* 032612  CR2011110200001  PEMA  AHL CHANGES
   377* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   378* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   379* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   380******************************************************************
   381
   382 01  CERTIFICATE-MASTER.
   383     12  CM-RECORD-ID                      PIC XX.
   384         88  VALID-CM-ID                      VALUE 'CM'.
   385
   386     12  CM-CONTROL-PRIMARY.
   387         16  CM-COMPANY-CD                 PIC X.
   388         16  CM-CARRIER                    PIC X.
   389         16  CM-GROUPING.
   390             20  CM-GROUPING-PREFIX        PIC X(3).
   391             20  CM-GROUPING-PRIME         PIC X(3).
   392         16  CM-STATE                      PIC XX.
   393         16  CM-ACCOUNT.
   394             20  CM-ACCOUNT-PREFIX         PIC X(4).
   395             20  CM-ACCOUNT-PRIME          PIC X(6).
   396         16  CM-CERT-EFF-DT                PIC XX.
   397         16  CM-CERT-NO.
   398             20  CM-CERT-PRIME             PIC X(10).
   399             20  CM-CERT-SFX               PIC X.
   400
   401     12  CM-CONTROL-BY-NAME.
   402         16  CM-COMPANY-CD-A1              PIC X.
   403         16  CM-INSURED-LAST-NAME          PIC X(15).
   404         16  CM-INSURED-INITIALS.
   405             20  CM-INSURED-INITIAL1       PIC X.
   406             20  CM-INSURED-INITIAL2       PIC X.
   407
   408     12  CM-CONTROL-BY-SSN.
   409         16  CM-COMPANY-CD-A2              PIC X.
   410         16  CM-SOC-SEC-NO.
   411             20  CM-SSN-STATE              PIC XX.
   412             20  CM-SSN-ACCOUNT            PIC X(6).
   413             20  CM-SSN-LN3.
   414                 25  CM-INSURED-INITIALS-A2.
   415                     30 CM-INSURED-INITIAL1-A2   PIC X.
   416                     30 CM-INSURED-INITIAL2-A2   PIC X.
   417                 25 CM-PART-LAST-NAME-A2         PIC X.
   418
   419     12  CM-CONTROL-BY-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page   9
* SOCK03.cbl
   420         16  CM-COMPANY-CD-A4              PIC X.
   421         16  CM-CERT-NO-A4                 PIC X(11).
   422
   423     12  CM-CONTROL-BY-MEMB.
   424         16  CM-COMPANY-CD-A5              PIC X.
   425         16  CM-MEMBER-NO.
   426             20  CM-MEMB-STATE             PIC XX.
   427             20  CM-MEMB-ACCOUNT           PIC X(6).
   428             20  CM-MEMB-LN4.
   429                 25  CM-INSURED-INITIALS-A5.
   430                     30 CM-INSURED-INITIAL1-A5   PIC X.
   431                     30 CM-INSURED-INITIAL2-A5   PIC X.
   432                 25 CM-PART-LAST-NAME-A5         PIC XX.
   433
   434     12  CM-INSURED-PROFILE-DATA.
   435         16  CM-INSURED-FIRST-NAME.
   436             20  CM-INSURED-1ST-INIT       PIC X.
   437             20  FILLER                    PIC X(9).
   438         16  CM-INSURED-ISSUE-AGE          PIC 99.
   439         16  CM-INSURED-SEX                PIC X.
   440             88  CM-SEX-MALE                  VALUE 'M'.
   441             88  CM-SEX-FEMAL                 VALUE 'F'.
   442         16  CM-INSURED-JOINT-AGE          PIC 99.
   443         16  CM-JOINT-INSURED-NAME.
   444             20  CM-JT-LAST-NAME           PIC X(15).
   445             20  CM-JT-FIRST-NAME.
   446                 24  CM-JT-1ST-INIT        PIC X.
   447                 24  FILLER                PIC X(9).
   448             20  CM-JT-INITIAL             PIC X.
   449
   450     12  CM-LIFE-DATA.
   451         16  CM-LF-BENEFIT-CD              PIC XX.
   452         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   453         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   454         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   455         16  CM-LF-DEV-CODE                PIC XXX.
   456         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   457         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   458         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   459         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   460         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   461         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   462         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   463         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   464         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   465         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   466         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   467         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   468         16  cm-temp-epiq                  pic xx.
   469             88  EPIQ-CLASS                  value 'EQ'.
   470*        16  FILLER                        PIC XX.
   471
   472     12  CM-AH-DATA.
   473         16  CM-AH-BENEFIT-CD              PIC XX.
   474         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   475         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   476         16  CM-AH-DEV-CODE                PIC XXX.
   477         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  10
* SOCK03.cbl
   478         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   479         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   480         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   481         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   482         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   483         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   484         16  CM-AH-PAID-THRU-DT            PIC XX.
   485             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   486         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   487         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   488         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   489         16  FILLER                        PIC X.
   490
   491     12  CM-LOAN-INFORMATION.
   492         16  CM-LIVES                      PIC S9(7)     COMP-3.
   493         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   494                                           PIC S9(5)V99  COMP-3.
   495         16  CM-BILLED                     PIC S9(7)     COMP-3.
   496         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   497         16  CM-PAY-FREQUENCY              PIC S99.
   498         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   499         16  CM-RATE-CLASS                 PIC XX.
   500         16  CM-BENEFICIARY                PIC X(25).
   501         16  CM-POLICY-FORM-NO             PIC X(12).
   502         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   503         16  CM-LAST-ADD-ON-DT             PIC XX.
   504         16  CM-DEDUCTIBLE-AMOUNTS.
   505             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   506             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   507         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   508             20  CM-RESIDENT-STATE         PIC XX.
   509             20  CM-RATE-CODE              PIC X(4).
   510             20  FILLER                    PIC XX.
   511         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   512             20  CM-LOAN-OFFICER           PIC X(5).
   513             20  FILLER                    PIC XXX.
   514         16  CM-CSR-CODE                   PIC XXX.
   515         16  CM-UNDERWRITING-CODE          PIC X.
   516             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   517         16  CM-POST-CARD-IND              PIC X.
   518         16  CM-REF-INTERFACE-SW           PIC X.
   519         16  CM-PREMIUM-TYPE               PIC X.
   520             88  CM-SING-PRM                  VALUE '1'.
   521             88  CM-O-B-COVERAGE              VALUE '2'.
   522             88  CM-OPEN-END                  VALUE '3'.
   523         16  CM-IND-GRP-TYPE               PIC X.
   524             88  CM-INDIVIDUAL                VALUE 'I'.
   525             88  CM-GROUP                     VALUE 'G'.
   526         16  CM-SKIP-CODE                  PIC X.
   527             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   528             88  SKIP-JULY                    VALUE '1'.
   529             88  SKIP-AUGUST                  VALUE '2'.
   530             88  SKIP-SEPTEMBER               VALUE '3'.
   531             88  SKIP-JULY-AUG                VALUE '4'.
   532             88  SKIP-AUG-SEPT                VALUE '5'.
   533             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   534             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   535             88  SKIP-JUNE                    VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  11
* SOCK03.cbl
   536             88  SKIP-JUNE-JULY               VALUE '9'.
   537             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   538             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   539         16  CM-PAYMENT-MODE               PIC X.
   540             88  PAY-MONTHLY                  VALUE SPACE.
   541             88  PAY-WEEKLY                   VALUE '1'.
   542             88  PAY-SEMI-MONTHLY             VALUE '2'.
   543             88  PAY-BI-WEEKLY                VALUE '3'.
   544             88  PAY-SEMI-ANUALLY             VALUE '4'.
   545         16  CM-LOAN-NUMBER                PIC X(8).
   546         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   547         16  CM-OLD-LOF                    PIC XXX.
   548*        16  CM-LOAN-OFFICER               PIC XXX.
   549         16  CM-REIN-TABLE                 PIC XXX.
   550         16  CM-SPECIAL-REIN-CODE          PIC X.
   551         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   552         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   553         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   554
   555     12  CM-STATUS-DATA.
   556         16  CM-ENTRY-STATUS               PIC X.
   557         16  CM-ENTRY-DT                   PIC XX.
   558
   559         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   560         16  CM-LF-CANCEL-DT               PIC XX.
   561         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   562
   563         16  CM-LF-STATUS-AT-DEATH         PIC X.
   564         16  CM-LF-DEATH-DT                PIC XX.
   565         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   566
   567         16  CM-LF-CURRENT-STATUS          PIC X.
   568             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   569                                                'M' '4' '5' '9'.
   570             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   571             88  CM-LF-POLICY-PENDING         VALUE '2'.
   572             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   573             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   574             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   575             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   576             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   577             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   578             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   579             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   580             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   581             88  CM-LF-DECLINED               VALUE 'D'.
   582             88  CM-LF-VOIDED                 VALUE 'V'.
   583
   584         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   585         16  CM-AH-CANCEL-DT               PIC XX.
   586         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   587
   588         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   589         16  CM-AH-SETTLEMENT-DT           PIC XX.
   590         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   591
   592         16  CM-AH-CURRENT-STATUS          PIC X.
   593             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  12
* SOCK03.cbl
   594                                                'M' '4' '5' '9'.
   595             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   596             88  CM-AH-POLICY-PENDING         VALUE '2'.
   597             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   598             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   599             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   600             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   601             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   602             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   603             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   604             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   605             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   606             88  CM-AH-DECLINED               VALUE 'D'.
   607             88  CM-AH-VOIDED                 VALUE 'V'.
   608
   609         16  CM-CLAIM-INTERFACE-SW         PIC X.
   610             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   611             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   612             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   613         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   614
   615         16  CM-ENTRY-BATCH                PIC X(6).
   616         16  CM-LF-EXIT-BATCH              PIC X(6).
   617         16  CM-AH-EXIT-BATCH              PIC X(6).
   618         16  CM-LAST-MONTH-END             PIC XX.
   619
   620     12  CM-NOTE-SW                        PIC X.
   621         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   622         88  CERT-NOTES-PRESENT               VALUE '1'.
   623         88  BILLING-NOTES-PRESENT            VALUE '2'.
   624         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   625         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   626         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   627         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   628         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   629     12  CM-COMP-EXCP-SW                   PIC X.
   630         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   631         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   632     12  CM-INSURED-ADDRESS-SW             PIC X.
   633         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   634         88  INSURED-ADDR-PRESENT             VALUE '1'.
   635
   636*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   637     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   638     12  FILLER                            PIC X.
   639
   640*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   641     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   642     12  FILLER                            PIC X.
   643*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   644     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   645
   646     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   647         88  CERT-ADDED-BATCH                 VALUE ' '.
   648         88  CERT-ADDED-ONLINE                VALUE '1'.
   649         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   650         88  CERT-PURGED-OFFLINE              VALUE '3'.
   651         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  13
* SOCK03.cbl
   652     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   653         88  CERT-AS-LOADED                   VALUE ' '.
   654         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   655         88  CERT-CLAIM-ONLINE                VALUE '2'.
   656         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   657         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   658         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   659         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   660         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   661
   662     12  CM-ACCOUNT-COMM-PCTS.
   663         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   664         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   665
   666     12  CM-USER-FIELD                     PIC X.
   667     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   668     12  CM-CLP-STATE                      PIC XX.
   669     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   670     12  CM-USER-RESERVED                  PIC XXX.
   671     12  FILLER REDEFINES CM-USER-RESERVED.
   672         16  CM-AH-CLASS-CD                PIC XX.
   673         16  F                             PIC X.
   674******************************************************************
   675*                                 COPY ELCMSTR.
   676******************************************************************
   677*                                                                *
   678*                            ELCMSTR.                            *
   679*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   680*                            VMOD=2.012                          *
   681*                                                                *
   682*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   683*                                                                *
   684*   FILE TYPE = VSAM,KSDS                                        *
   685*   RECORD SIZE = 350  RECFORM = FIXED                           *
   686*                                                                *
   687*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   688*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   689*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   690*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   691*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   692*                                                 RKP=75,LEN=21  *
   693*                                                                *
   694*   **** NOTE ****                                               *
   695*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   696*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   697*                                                                *
   698*   LOG = YES                                                    *
   699*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   700******************************************************************
   701*                   C H A N G E   L O G
   702*
   703* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   704*-----------------------------------------------------------------
   705*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   706* EFFECTIVE    NUMBER
   707*-----------------------------------------------------------------
   708* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   709* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  14
* SOCK03.cbl
   710* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   711* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   712* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   713* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   714* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   715******************************************************************
   716 01  CLAIM-MASTER.
   717     12  CL-RECORD-ID                PIC XX.
   718         88  VALID-CL-ID         VALUE 'CL'.
   719
   720     12  CL-CONTROL-PRIMARY.
   721         16  CL-COMPANY-CD           PIC X.
   722         16  CL-CARRIER              PIC X.
   723         16  CL-CLAIM-NO             PIC X(7).
   724         16  CL-CERT-NO.
   725             20  CL-CERT-PRIME       PIC X(10).
   726             20  CL-CERT-SFX         PIC X.
   727
   728     12  CL-CONTROL-BY-NAME.
   729         16  CL-COMPANY-CD-A1        PIC X.
   730         16  CL-INSURED-LAST-NAME    PIC X(15).
   731         16  CL-INSURED-NAME.
   732             20  CL-INSURED-1ST-NAME PIC X(12).
   733             20  CL-INSURED-MID-INIT PIC X.
   734
   735     12  CL-CONTROL-BY-SSN.
   736         16  CL-COMPANY-CD-A2        PIC X.
   737         16  CL-SOC-SEC-NO.
   738             20  CL-SSN-STATE        PIC XX.
   739             20  CL-SSN-ACCOUNT      PIC X(6).
   740             20  CL-SSN-LN3          PIC X(3).
   741
   742     12  CL-CONTROL-BY-CERT-NO.
   743         16  CL-COMPANY-CD-A4        PIC X.
   744         16  CL-CERT-NO-A4.
   745             20  CL-CERT-A4-PRIME    PIC X(10).
   746             20  CL-CERT-A4-SFX      PIC X.
   747
   748     12  CL-CONTROL-BY-CCN.
   749         16  CL-COMPANY-CD-A5        PIC X.
   750         16  CL-CCN-A5.
   751             20  CL-CCN.
   752                 24  CL-CCN-PREFIX-A5 PIC X(4).
   753                 24  CL-CCN-PRIME-A5 PIC X(12).
   754             20  CL-CCN-FILLER-A5    PIC X(4).
   755
   756     12  CL-INSURED-PROFILE-DATA.
   757         16  CL-INSURED-BIRTH-DT     PIC XX.
   758         16  CL-INSURED-SEX-CD       PIC X.
   759             88  INSURED-IS-MALE        VALUE 'M'.
   760             88  INSURED-IS-FEMALE      VALUE 'F'.
   761             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   762         16  CL-INSURED-OCC-CD       PIC X(6).
   763         16  FILLER                  PIC X(5).
   764
   765     12  CL-PROCESSING-INFO.
   766         16  CL-PROCESSOR-ID         PIC X(4).
   767         16  CL-CLAIM-STATUS         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  15
* SOCK03.cbl
   768             88  CLAIM-IS-OPEN          VALUE 'O'.
   769             88  CLAIM-IS-CLOSED        VALUE 'C'.
   770         16  CL-CLAIM-TYPE           PIC X.
   771*            88  AH-CLAIM               VALUE 'A'.
   772*            88  LIFE-CLAIM             VALUE 'L'.
   773*            88  PROPERTY-CLAIM         VALUE 'P'.
   774*            88  IUI-CLAIM              VALUE 'I'.
   775*            88  GAP-CLAIM              VALUE 'G'.
   776*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   777*            88  OTHER-CLAIM            VALUE 'O'.
   778         16  CL-CLAIM-PREM-TYPE      PIC X.
   779             88  SINGLE-PREMIUM         VALUE '1'.
   780             88  O-B-COVERAGE           VALUE '2'.
   781             88  OPEN-END-COVERAGE      VALUE '3'.
   782         16  CL-INCURRED-DT          PIC XX.
   783         16  CL-REPORTED-DT          PIC XX.
   784         16  CL-FILE-ESTABLISH-DT    PIC XX.
   785         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   786         16  CL-LAST-PMT-DT          PIC XX.
   787         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   788         16  CL-PAID-THRU-DT         PIC XX.
   789         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   790         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   791         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   792         16  CL-PMT-CALC-METHOD      PIC X.
   793             88  CL-360-DAY-YR          VALUE '1'.
   794             88  CL-365-DAY-YR          VALUE '2'.
   795             88  CL-FULL-MONTHS         VALUE '3'.
   796         16  CL-CAUSE-CD             PIC X(6).
   797
   798         16  CL-PRIME-CERT-NO.
   799             20  CL-PRIME-CERT-PRIME PIC X(10).
   800             20  CL-PRIME-CERT-SFX   PIC X.
   801
   802         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   803             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   804             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   805
   806         16  CL-MICROFILM-NO         PIC X(10).
   807         16  FILLER REDEFINES CL-MICROFILM-NO.
   808             20  CL-BENEFIT-PERIOD   PIC 99.
   809             20  FILLER              PIC X(8).
   810         16  CL-PROG-FORM-TYPE       PIC X.
   811         16  CL-LAST-ADD-ON-DT       PIC XX.
   812
   813         16  CL-LAST-REOPEN-DT       PIC XX.
   814         16  CL-LAST-CLOSE-DT        PIC XX.
   815         16  CL-LAST-CLOSE-REASON    PIC X(01).
   816             88  FINAL-PAID             VALUE '1'.
   817             88  CLAIM-DENIED           VALUE '2'.
   818             88  AUTO-CLOSE             VALUE '3'.
   819             88  MANUAL-CLOSE           VALUE '4'.
   820             88  BENEFITS-CHANGED       VALUE 'C'.
   821             88  SETUP-ERRORS           VALUE 'E'.
   822         16  CL-ASSOC-CERT-SEQU      PIC S99.
   823         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   824         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   825             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  16
* SOCK03.cbl
   826         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   827         16  FILLER                  PIC X.
   828
   829     12  CL-CERTIFICATE-DATA.
   830         16  CL-CERT-ORIGIN          PIC X.
   831             88  CERT-WAS-ONLINE        VALUE '1'.
   832             88  CERT-WAS-CREATED       VALUE '2'.
   833             88  COVERAGE-WAS-ADDED     VALUE '3'.
   834         16  CL-CERT-KEY-DATA.
   835             20  CL-CERT-CARRIER     PIC X.
   836             20  CL-CERT-GROUPING    PIC X(6).
   837             20  CL-CERT-STATE       PIC XX.
   838             20  CL-CERT-ACCOUNT.
   839                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   840                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   841             20  CL-CERT-EFF-DT      PIC XX.
   842
   843     12  CL-STATUS-CONTROLS.
   844         16  CL-PRIORITY-CD          PIC X.
   845             88  CONFIDENTIAL-DATA      VALUE '8'.
   846             88  HIGHEST-PRIORITY       VALUE '9'.
   847         16  CL-SUPV-ATTN-CD         PIC X.
   848             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   849             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   850         16  CL-PURGED-DT            PIC XX.
   851         16  CL-RESTORED-DT          PIC XX.
   852         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   853         16  CL-NEXT-RESEND-DT       PIC XX.
   854         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   855         16  CL-CRITICAL-PERIOD      PIC 99.
   856*        16  FILLER                  PIC XX.
   857         16  CL-LAST-MAINT-DT        PIC XX.
   858         16  CL-LAST-MAINT-USER      PIC X(4).
   859         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   860         16  CL-LAST-MAINT-TYPE      PIC X.
   861             88  CLAIM-SET-UP           VALUE ' '.
   862             88  PAYMENT-MADE           VALUE '1'.
   863             88  LETTER-SENT            VALUE '2'.
   864             88  MASTER-WAS-ALTERED     VALUE '3'.
   865             88  MASTER-WAS-RESTORED    VALUE '4'.
   866             88  INCURRED-DATE-CHANGED  VALUE '5'.
   867             88  FILE-CONVERTED         VALUE '6'.
   868             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   869             88  ERROR-CORRECTION       VALUE 'E'.
   870         16  CL-RELATED-CLAIM-NO     PIC X(7).
   871         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   872         16  CL-BENEFICIARY          PIC X(10).
   873         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   874         16  CL-DENIAL-TYPE          PIC X.
   875             88  CL-TYPE-DENIAL          VALUE '1'.
   876             88  CL-TYPE-RESCISSION      VALUE '2'.
   877             88  CL-TYPE-REFORMATION     VALUE '3'.
   878             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   879             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   880         16  CL-NO-OF-EXTENSIONS     PIC 99.
   881         16  filler                  pic x(3).
   882*        16  CL-CRIT-PER-RECURRENT   PIC X.
   883*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  17
* SOCK03.cbl
   884*        16  CL-RTW-DT               PIC XX.
   885
   886     12  CL-TRAILER-CONTROLS.
   887         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   888             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   889             88  CL-LAST-TRL-AVAIL      VALUE +100.
   890             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   891         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   892         16  FILLER                  PIC XX.
   893         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   894         16  CL-ADDRESS-TRAILER-CNT.
   895             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   896                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   897             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   898                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   899             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   900                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   901             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   902                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   903             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   904                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   905             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   906                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   907             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   908                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   909
   910     12  CL-CV-REFERENCE-NO.
   911         16  CL-CV-REFNO-PRIME       PIC X(18).
   912         16  CL-CV-REFNO-SFX         PIC XX.
   913
   914     12  CL-FILE-LOCATION            PIC X(4).
   915
   916     12  CL-PROCESS-ERRORS.
   917         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   918             88  NO-FATAL-ERRORS        VALUE ZERO.
   919         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   920             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   921
   922     12  CL-PRODUCT-CD               PIC X.
   923
   924     12  CL-CURRENT-KEY-DATA.
   925         16  CL-CURRENT-CARRIER      PIC X.
   926         16  CL-CURRENT-GROUPING     PIC X(6).
   927         16  CL-CURRENT-STATE        PIC XX.
   928         16  CL-CURRENT-ACCOUNT      PIC X(10).
   929
   930     12  CL-ASSOCIATES               PIC X.
   931         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   932         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   933         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   934         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   935
   936     12  CL-ACTIVITY-CODE            PIC 99.
   937     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   938     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   939
   940     12  CL-LAPSE-REPORT-CODE        PIC 9.
   941     12  CL-LAG-REPORT-CODE          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  18
* SOCK03.cbl
   942     12  CL-LOAN-TYPE                PIC XX.
   943     12  CL-LEGAL-STATE              PIC XX.
   944
   945     12  CL-YESNOSW                  PIC X.
   946     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   947         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   948         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   949         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   950     12  cl-insured-type             pic x.
   951         88  cl-claim-on-primary         value 'P'.
   952         88  cl-claim-on-co-borrower     value 'C'.
   953     12  cl-benefit-expiration-dt    PIC XX.
   954*                                 COPY ERCPDEF.
   955******************************************************************
   956*                                                                *
   957*                                                                *
   958*                            ERCPDEF.                            *
   959*                                                                *
   960*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   961*                                                                *
   962*    FILE TYPE = VSAM,KSDS                                       *
   963*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   964*                                                                *
   965*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   966*                                                                *
   967*    LOG = YES                                                   *
   968*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   969******************************************************************
   970*                   C H A N G E   L O G
   971*
   972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   973*-----------------------------------------------------------------
   974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   975* EFFECTIVE    NUMBER
   976*-----------------------------------------------------------------
   977* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   978* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   979* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   980* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   981******************************************************************
   982 01  PRODUCT-MASTER.
   983    12  PD-RECORD-ID                 PIC X(02).
   984        88  VALID-PD-ID                  VALUE 'PD'.
   985    12  PD-CONTROL-PRIMARY.
   986        16  PD-COMPANY-CD            PIC X.
   987        16  PD-STATE                 PIC XX.
   988        16  PD-PRODUCT-CD            PIC XXX.
   989        16  PD-FILLER                PIC X(7).
   990        16  PD-BEN-TYPE              PIC X.
   991        16  PD-BEN-CODE              PIC XX.
   992        16  PD-PROD-EXP-DT           PIC XX.
   993    12  FILLER                       PIC X(50).
   994    12  PD-PRODUCT-DATA OCCURS 8.
   995        16  PD-PROD-CODE             PIC X.
   996            88  PD-PROD-LIFE           VALUE 'L'.
   997            88  PD-PROD-PROP           VALUE 'P'.
   998            88  PD-PROD-AH             VALUE 'A'.
   999            88  PD-PROD-IU             VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  19
* SOCK03.cbl
  1000            88  PD-PROD-GAP            VALUE 'G'.
  1001            88  PD-PROD-FAML           VALUE 'F'.
  1002            88  PD-PROD-OTH            VALUE 'O'.
  1003        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1004        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1005        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1006        16  PD-MAX-TERM              PIC S999        COMP-3.
  1007        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1008        16  FILLER                   PIC X.
  1009        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1010        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1011        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1012        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1013        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1014        16  PD-REC-CRIT-PERIOD       PIC 99.
  1015        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1016            20  PD-RECURRING-YN      PIC X.
  1017            20  FILLER               PIC X.
  1018        16  PD-RTW-MOS               PIC 99.
  1019        16  PD-MAX-EXTENSION         PIC 99.
  1020        16  pd-ben-pct               pic sv999 comp-3.
  1021*       16  FILLER                   PIC XX.
  1022    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1023    12  PD-TERM-LIMITS OCCURS 15.
  1024        16  PD-LOW-TERM              PIC S999        COMP-3.
  1025        16  PD-HI-TERM               PIC S999        COMP-3.
  1026*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1027    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1028        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1029        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1030    12  PD-EARN-FACTORS.
  1031        16  FILLER OCCURS 15.
  1032            20  FILLER OCCURS 15.
  1033                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1034    12  PD-PRODUCT-DESC              PIC X(80).
  1035    12  PD-TRUNCATED                 PIC X.
  1036    12  FILLER                       PIC X(59).
  1037    12  PD-MAINT-INFORMATION.
  1038        16  PD-LAST-MAINT-DT         PIC X(02).
  1039        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1040        16  PD-LAST-MAINT-BY         PIC X(04).
  1041*                                 COPY ERCCTBL.
  1042******************************************************************
  1043*                                                                *
  1044*                                                                *
  1045*                            ERCCTBL                             *
  1046*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1047*                            VMOD=2.003
  1048*                                                                *
  1049*   ONLINE CREDIT SYSTEM                                         *
  1050*                                                                *
  1051*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1052*                                                                *
  1053*   FILE TYPE = VSAM,KSDS                                        *
  1054*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1055*                                                                *
  1056*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1057*       ALTERNATE PATH = NONE                                    *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  20
* SOCK03.cbl
  1058*                                                                *
  1059*   LOG = NO                                                     *
  1060*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1061*                                                                *
  1062*                                                                *
  1063******************************************************************
  1064
  1065 01  COMM-TABLE-RECORD.
  1066     12  CT-RECORD-ID                      PIC XX.
  1067         88  VALID-CT-ID                      VALUE 'CT'.
  1068
  1069     12  CT-CONTROL-PRIMARY.
  1070         16  CT-COMPANY-CD                 PIC X.
  1071         16  CT-TABLE                      PIC XXX.
  1072         16  CT-CNTRL-2.
  1073             20  CT-BEN-TYPE               PIC X.
  1074             20  CT-BEN-CODE               PIC XX.
  1075
  1076     12  CT-MAINT-INFORMATION.
  1077         16  CT-LAST-MAINT-DT              PIC XX.
  1078         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1079         16  CT-LAST-MAINT-USER            PIC X(4).
  1080         16  FILLER                        PIC X(31).
  1081
  1082     12  CT-LIMITS.
  1083         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1084
  1085         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1086
  1087         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1088
  1089     12  CT-RATES.
  1090         16  CT-RTX          OCCURS 27 TIMES.
  1091             20  CT-RT                     PIC SV9(5)     COMP-3.
  1092             20  CT-RT-R   REDEFINES
  1093                 CT-RT                     PIC XXX.
  1094
  1095     12  FILLER                            PIC  X(42).
  1096
  1097******************************************************************
  1098*                                 COPY ELCCNTL.
  1099******************************************************************
  1100*                                                                *
  1101*                                                                *
  1102*                            ELCCNTL.                            *
  1103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1104*                            VMOD=2.059                          *
  1105*                                                                *
  1106*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1107*                                                                *
  1108*   FILE TYPE = VSAM,KSDS                                        *
  1109*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1110*                                                                *
  1111*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1112*       ALTERNATE INDEX = NONE                                   *
  1113*                                                                *
  1114*   LOG = YES                                                    *
  1115*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  21
* SOCK03.cbl
  1116******************************************************************
  1117*                   C H A N G E   L O G
  1118*
  1119* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1120*-----------------------------------------------------------------
  1121*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1122* EFFECTIVE    NUMBER
  1123*-----------------------------------------------------------------
  1124* 082503                   PEMA  ADD BENEFIT GROUP
  1125* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1126* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1127* 092705    2005050300006  PEMA  ADD SPP LEASES
  1128* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1129* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1130* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1131* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1132* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1133* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1134* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1135* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1136* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1137* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1138* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1139******************************************************************
  1140*
  1141 01  CONTROL-FILE.
  1142     12  CF-RECORD-ID                       PIC XX.
  1143         88  VALID-CF-ID                        VALUE 'CF'.
  1144
  1145     12  CF-CONTROL-PRIMARY.
  1146         16  CF-COMPANY-ID                  PIC XXX.
  1147         16  CF-RECORD-TYPE                 PIC X.
  1148             88  CF-COMPANY-MASTER              VALUE '1'.
  1149             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1150             88  CF-STATE-MASTER                VALUE '3'.
  1151             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1152             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1153             88  CF-CARRIER-MASTER              VALUE '6'.
  1154             88  CF-MORTALITY-MASTER            VALUE '7'.
  1155             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1156             88  CF-TERMINAL-MASTER             VALUE '9'.
  1157             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1158             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1159             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1160             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1161             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1162             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1163             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1164             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1165             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1166         16  CF-ACCESS-CD-GENL              PIC X(4).
  1167         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1168             20  CF-PROCESSOR               PIC X(4).
  1169         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1170             20  CF-STATE-CODE              PIC XX.
  1171             20  FILLER                     PIC XX.
  1172         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1173             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  22
* SOCK03.cbl
  1174             20  CF-HI-BEN-IN-REC           PIC XX.
  1175         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1176             20  FILLER                     PIC XXX.
  1177             20  CF-CARRIER-CNTL            PIC X.
  1178         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1179             20  FILLER                     PIC XX.
  1180             20  CF-HI-TYPE-IN-REC          PIC 99.
  1181         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1182             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1183                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1184             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1185             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1186         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1187             20  FILLER                     PIC X.
  1188             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1189         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1190             20  FILLER                     PIC XX.
  1191             20  CF-MORTGAGE-PLAN           PIC XX.
  1192         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1193
  1194     12  CF-LAST-MAINT-DT                   PIC XX.
  1195     12  CF-LAST-MAINT-BY                   PIC X(4).
  1196     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1197
  1198     12  CF-RECORD-BODY                     PIC X(728).
  1199
  1200
  1201****************************************************************
  1202*             COMPANY MASTER RECORD                            *
  1203****************************************************************
  1204
  1205     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1206         16  CF-COMPANY-ADDRESS.
  1207             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1208             20  CF-CL-IN-CARE-OF           PIC X(30).
  1209             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1210             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1211             20  CF-CL-CITY-STATE           PIC X(30).
  1212             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1213             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1214         16  CF-COMPANY-CD                  PIC X.
  1215         16  CF-COMPANY-PASSWORD            PIC X(8).
  1216         16  CF-SECURITY-OPTION             PIC X.
  1217             88  ALL-SECURITY                   VALUE '1'.
  1218             88  COMPANY-VERIFY                 VALUE '2'.
  1219             88  PROCESSOR-VERIFY               VALUE '3'.
  1220             88  NO-SECURITY                    VALUE '4'.
  1221             88  ALL-BUT-TERM                   VALUE '5'.
  1222         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1223             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1224         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1225             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1226         16  CF-INFORCE-LOCATION            PIC X.
  1227             88  CERTS-ARE-ONLINE               VALUE '1'.
  1228             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1229             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1230         16  CF-LOWER-CASE-LETTERS          PIC X.
  1231         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  23
* SOCK03.cbl
  1232             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1233             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1234             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1235             88  CF-ACCNT-CNTL                  VALUE '3'.
  1236             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1237
  1238         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1239         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1240
  1241         16  CF-LGX-CREDIT-USER             PIC X.
  1242             88  CO-IS-NOT-USER                 VALUE 'N'.
  1243             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1244
  1245         16 CF-CREDIT-CALC-CODES.
  1246             20  CF-CR-REM-TERM-CALC PIC X.
  1247               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1248               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1249               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1250               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1251               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1252               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1253               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1254             20  CF-CR-R78-METHOD           PIC X.
  1255               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1256               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1257
  1258         16  CF-CLAIM-CONTROL-COUNTS.
  1259             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1260                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1261
  1262             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1263                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1264
  1265             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1266                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1267
  1268             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1269                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1270
  1271         16  CF-CURRENT-MONTH-END           PIC XX.
  1272
  1273         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1274             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1275             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1276             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1277             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1278                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1279                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1280             20  CF-CO-PREM-REJECT-SW       PIC X.
  1281                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1282                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1283             20  CF-CO-REF-REJECT-SW        PIC X.
  1284                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1285                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1286
  1287         16  CF-CO-REPORTING-DT             PIC XX.
  1288         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1289         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  24
* SOCK03.cbl
  1290           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1291           88  CF-CO-MONTH-END                  VALUE '1'.
  1292
  1293         16  CF-LGX-CLAIM-USER              PIC X.
  1294             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1295             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1296
  1297         16  CF-CREDIT-EDIT-CONTROLS.
  1298             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1299             20  CF-MIN-AGE                 PIC 99.
  1300             20  CF-DEFAULT-AGE             PIC 99.
  1301             20  CF-MIN-TERM                PIC S999      COMP-3.
  1302             20  CF-MAX-TERM                PIC S999      COMP-3.
  1303             20  CF-DEFAULT-SEX             PIC X.
  1304             20  CF-JOINT-AGE-INPUT         PIC X.
  1305                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1306             20  CF-BIRTH-DATE-INPUT        PIC X.
  1307                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1308             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1309                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1310                 88  CF-ZERO-CARRIER            VALUE '1'.
  1311                 88  CF-ZERO-GROUPING           VALUE '2'.
  1312                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1313             20  CF-EDIT-SW                 PIC X.
  1314                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1315             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1316             20  CF-CR-PR-METHOD            PIC X.
  1317               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1318               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1319             20  FILLER                     PIC X.
  1320
  1321         16  CF-CREDIT-MISC-CONTROLS.
  1322             20  CF-REIN-TABLE-SW           PIC X.
  1323                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1324             20  CF-COMP-TABLE-SW           PIC X.
  1325                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1326             20  CF-EXPERIENCE-RETENTION-AGE
  1327                                            PIC S9        COMP-3.
  1328             20  CF-CONVERSION-DT           PIC XX.
  1329             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1330             20  CF-RUN-FREQUENCY-SW        PIC X.
  1331                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1332                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1333
  1334             20  CF-CR-CHECK-NO-CONTROL.
  1335                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1336                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1337                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1338                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1339                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1340                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1341
  1342                 24  CF-CR-CHECK-COUNT       REDEFINES
  1343                     CF-CR-CHECK-COUNTER      PIC X(4).
  1344
  1345                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1346                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1347
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  25
* SOCK03.cbl
  1348                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1349                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1350                 24  CF-MAIL-PROCESSING       PIC X.
  1351                     88  MAIL-PROCESSING          VALUE 'Y'.
  1352
  1353         16  CF-MISC-SYSTEM-CONTROL.
  1354             20  CF-SYSTEM-C                 PIC X.
  1355                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1356             20  CF-SYSTEM-D                 PIC X.
  1357                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1358             20  CF-SOC-SEC-NO-SW            PIC X.
  1359                 88  SOC-SEC-NO-USED             VALUE '1'.
  1360             20  CF-MEMBER-NO-SW             PIC X.
  1361                 88  MEMBER-NO-USED              VALUE '1'.
  1362             20  CF-TAX-ID-NUMBER            PIC X(11).
  1363             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1364             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1365                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1366                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1367                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1368                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1369             20  CF-SYSTEM-E                 PIC X.
  1370                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1371
  1372         16  CF-LGX-LIFE-USER               PIC X.
  1373             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1374             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1375
  1376         16  CF-CR-MONTH-END-DT             PIC XX.
  1377
  1378         16  CF-FILE-MAINT-DATES.
  1379             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1380                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1381             20  CF-LAST-BATCH       REDEFINES
  1382                 CF-LAST-BATCH-NO               PIC X(4).
  1383             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1384             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1385             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1386             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1387             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1388             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1389             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1390             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1391             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1392             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1393
  1394         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1395         16  FILLER                         PIC X.
  1396
  1397         16  CF-ALT-MORT-CODE               PIC X(4).
  1398         16  CF-MEMBER-CAPTION              PIC X(10).
  1399
  1400         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1401             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1402             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1403             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1404             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1405             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  26
* SOCK03.cbl
  1406
  1407         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1408
  1409         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1410         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1411         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1412         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1413
  1414         16  CF-AH-OVERRIDE-L1              PIC X.
  1415         16  CF-AH-OVERRIDE-L2              PIC XX.
  1416         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1417         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1418
  1419         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1420         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1421
  1422         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1423         16  CF-AR-LAST-EL860-DT            PIC XX.
  1424         16  CF-MP-MONTH-END-DT             PIC XX.
  1425
  1426         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1427         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1428             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1429
  1430         16  CF-AR-MONTH-END-DT             PIC XX.
  1431
  1432         16  CF-CRDTCRD-USER                PIC X.
  1433             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1434             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1435
  1436         16  CF-CC-MONTH-END-DT             PIC XX.
  1437
  1438         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1439
  1440         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1441             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1442             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1443             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1444         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1445         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1446         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1447         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1448             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1449             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1450         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1451         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1452         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1453             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1454         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1455
  1456         16  CF-CL-ZIP-CODE.
  1457             20  CF-CL-ZIP-PRIME.
  1458                 24  CF-CL-ZIP-1ST          PIC X.
  1459                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1460                 24  FILLER                 PIC X(4).
  1461             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1462         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1463             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  27
* SOCK03.cbl
  1464             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1465             20  FILLER                     PIC XXX.
  1466
  1467         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1468         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1469         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1470         16  CF-CO-OPTION-START-DATE        PIC XX.
  1471         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1472           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1473                                                      '3' '4'.
  1474           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1475           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1476           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1477           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1478           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1479           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1480
  1481         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1482
  1483         16  CF-PAYMENT-APPROVAL-LEVELS.
  1484             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1485             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1486             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1487             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1488             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1489             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1490
  1491         16  CF-END-USER-REPORTING-USER     PIC X.
  1492             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1493             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1494
  1495         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1496             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1497             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1498
  1499         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1500
  1501         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1502         16  FILLER                         PIC X.
  1503
  1504         16  CF-CREDIT-ARCHIVE-CNTL.
  1505             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1506             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1507             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1508
  1509         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1510
  1511         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1512             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1513             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1514
  1515         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1516             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1517             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1518
  1519         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1520
  1521         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  28
* SOCK03.cbl
  1522             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1523             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1524             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1525         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1526         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1527         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1528         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1529         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1530         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1531         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1532         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1533         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1534                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1535         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1536                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1537
  1538         16  CF-CO-OVER-SHORT.
  1539             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1540             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1541
  1542*         16  FILLER                         PIC X(102).
  1543         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1544             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1545             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1546
  1547         16  CF-AH-APPROVAL-DAYS.
  1548             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1549             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1550             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1551             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1552
  1553         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1554
  1555         16  CF-APPROV-LEV-5.
  1556             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1557             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1558             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1559
  1560         16  FILLER                         PIC X(68).
  1561****************************************************************
  1562*             PROCESSOR/USER RECORD                            *
  1563****************************************************************
  1564
  1565     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1566         16  CF-PROCESSOR-NAME              PIC X(30).
  1567         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1568         16  CF-PROCESSOR-TITLE             PIC X(26).
  1569         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1570                 88  MESSAGE-YES                VALUE 'Y'.
  1571                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1572
  1573*****************************************************
  1574****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1575****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1576****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1577****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1578*****************************************************
  1579
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  29
* SOCK03.cbl
  1580         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1581             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1582             20  CF-APPLICATION-FORCE       PIC X.
  1583             20  CF-INDIVIDUAL-APP.
  1584                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1585                     28  CF-BROWSE-APP      PIC X.
  1586                     28  CF-UPDATE-APP      PIC X.
  1587
  1588         16  CF-CURRENT-TERM-ON             PIC X(4).
  1589         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1590             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1591             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1592             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1593             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1594             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1595             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1596             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1597         16  CF-PROCESSOR-CARRIER           PIC X.
  1598             88  NO-CARRIER-SECURITY            VALUE ' '.
  1599         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1600             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1601         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1602             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1603         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1604             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1605
  1606         16  CF-PROC-SYS-ACCESS-SW.
  1607             20  CF-PROC-CREDIT-CLAIMS-SW.
  1608                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1609                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1610                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1611                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1612             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1613                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1614                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1615             20  CF-PROC-LIFE-GNRLDGR-SW.
  1616                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1617                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1618                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1619                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1620             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1621                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1622                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1623         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1624             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1625             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1626         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1627
  1628         16  CF-APPROVAL-LEVEL                  PIC X.
  1629             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1630             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1631             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1632             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1633             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1634
  1635         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1636
  1637         16  CF-LANGUAGE-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  30
* SOCK03.cbl
  1638             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1639             88  CF-LANG-IS-FR                      VALUE 'F'.
  1640
  1641         16  CF-CSR-IND                         PIC X.
  1642         16  FILLER                             PIC X(239).
  1643
  1644****************************************************************
  1645*             PROCESSOR/REMINDERS RECORD                       *
  1646****************************************************************
  1647
  1648     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1649         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1650             20  CF-START-REMIND-DT         PIC XX.
  1651             20  CF-END-REMIND-DT           PIC XX.
  1652             20  CF-REMINDER-TEXT           PIC X(50).
  1653         16  FILLER                         PIC X(296).
  1654
  1655
  1656****************************************************************
  1657*             STATE MASTER RECORD                              *
  1658****************************************************************
  1659
  1660     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1661         16  CF-STATE-ABBREVIATION          PIC XX.
  1662         16  CF-STATE-NAME                  PIC X(25).
  1663         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1664         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1665             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1666             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1667             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1668             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1669                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1670                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1671             20  CF-ST-PREM-REJECT-SW       PIC X.
  1672                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1673                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1674             20  CF-ST-REF-REJECT-SW        PIC X.
  1675                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1676                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1677         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1678         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1679         16  CF-ST-REFUND-RULES.
  1680             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1681             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1682             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1683         16  CF-ST-FST-PMT-EXTENSION.
  1684             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1685             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1686                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1687                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1688                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1689                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1690         16  CF-ST-STATE-CALL.
  1691             20  CF-ST-CALL-UNEARNED        PIC X.
  1692             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1693             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1694         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1695             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  31
* SOCK03.cbl
  1696             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1697         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1698         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1699         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1700         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1701         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1702         16  FILLER                         PIC X.
  1703         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1704             20  CF-ST-BENEFIT-CD           PIC XX.
  1705             20  CF-ST-BENEFIT-KIND         PIC X.
  1706                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1707                 88  CF-ST-AH-KIND              VALUE 'A'.
  1708             20  CF-ST-REM-TERM-CALC        PIC X.
  1709                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1710                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1711                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1712                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1713                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1714                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1715                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1716                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1717
  1718             20  CF-ST-REFUND-CALC          PIC X.
  1719                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1720                 88  ST-REFD-BY-R78             VALUE '1'.
  1721                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1722                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1723                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1724                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1725                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1726                 88  ST-REFD-UTAH               VALUE '7'.
  1727                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1728                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1729                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1730
  1731             20  CF-ST-EARNING-CALC         PIC X.
  1732                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1733                 88  ST-EARN-BY-R78             VALUE '1'.
  1734                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1735                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1736                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1737                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1738                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1739                 88  ST-EARN-MEAN               VALUE '8'.
  1740                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1741
  1742             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1743                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1744                 88  ST-OVRD-BY-R78             VALUE '1'.
  1745                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1746                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1747                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1748                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1749                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1750                 88  ST-OVRD-MEAN               VALUE '8'.
  1751                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1752             20  cf-st-extra-periods        pic 9.
  1753*            20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  32
* SOCK03.cbl
  1754
  1755         16  CF-ST-COMMISSION-CAPS.
  1756             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1757             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1758             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1759             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1760         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1761                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1762                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1763                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1764
  1765         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1766
  1767         16  CF-ST-STATUTORY-INTEREST.
  1768             20  CF-ST-STAT-DATE-FROM       PIC X.
  1769                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1770                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1771             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1772             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1773             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1774             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1775             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1776
  1777         16  CF-ST-OVER-SHORT.
  1778             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1779             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1780
  1781         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1782
  1783         16  CF-ST-RT-CALC                  PIC X.
  1784
  1785         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1786         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1787         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1788         16  CF-ST-RF-LR-CALC               PIC X.
  1789         16  CF-ST-RF-LL-CALC               PIC X.
  1790         16  CF-ST-RF-LN-CALC               PIC X.
  1791         16  CF-ST-RF-AH-CALC               PIC X.
  1792         16  CF-ST-RF-CP-CALC               PIC X.
  1793*        16  FILLER                         PIC X(206).
  1794*CIDMOD         16  FILLER                         PIC X(192).
  1795         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1796             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1797         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1798         16  CF-ST-VFY-2ND-BENE             PIC X.
  1799         16  CF-ST-CAUSAL-STATE             PIC X.
  1800         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1801         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1802         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1803             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1804         16  CF-ST-NET-ONLY-STATE           PIC X.
  1805             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1806         16  cf-commission-cap-required     pic x.
  1807         16  CF-ST-GA-COMMISSION-CAPS.
  1808             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1809             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1810             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1811             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  33
* SOCK03.cbl
  1812         16  CF-ST-TOT-COMMISSION-CAPS.
  1813             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1814             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1815             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1816             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1817         16  FILLER                         PIC X(156).
  1818
  1819****************************************************************
  1820*             BENEFIT MASTER RECORD                            *
  1821****************************************************************
  1822
  1823     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1824         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1825             20  CF-BENEFIT-CODE            PIC XX.
  1826             20  CF-BENEFIT-NUMERIC  REDEFINES
  1827                 CF-BENEFIT-CODE            PIC XX.
  1828             20  CF-BENEFIT-ALPHA           PIC XXX.
  1829             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1830             20  CF-BENEFIT-COMMENT         PIC X(10).
  1831
  1832             20  CF-LF-COVERAGE-TYPE        PIC X.
  1833                 88  CF-REDUCING                VALUE 'R'.
  1834                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1835
  1836             20  CF-SPECIAL-CALC-CD         PIC X.
  1837                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1838                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1839                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1840                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1841                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1842                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1843                 88  CF-FARM-PLAN               VALUE 'F'.
  1844                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1845                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1846                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1847                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1848                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1849                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1850                 88  CF-PRUDENTIAL              VALUE 'P'.
  1851                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1852                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1853                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1854                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1855                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1856                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1857
  1858             20  CF-JOINT-INDICATOR         PIC X.
  1859                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1860
  1861*            20  FILLER                     PIC X(12).
  1862             20  cf-maximum-benefits        pic s999 comp-3.
  1863             20  FILLER                     PIC X(09).
  1864             20  CF-BENEFIT-CATEGORY        PIC X.
  1865             20  CF-LOAN-TYPE               PIC X(8).
  1866
  1867             20  CF-CO-REM-TERM-CALC        PIC X.
  1868                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1869                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  34
* SOCK03.cbl
  1870                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1871                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1872                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1873
  1874             20  CF-CO-EARNINGS-CALC        PIC X.
  1875                 88  CO-EARN-BY-R78             VALUE '1'.
  1876                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1877                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1878                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1879                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1880                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1881                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1882                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1883
  1884             20  CF-CO-REFUND-CALC          PIC X.
  1885                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1886                 88  CO-REFD-BY-R78             VALUE '1'.
  1887                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1888                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1889                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1890                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1891                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1892                 88  CO-REFD-MEAN               VALUE '8'.
  1893                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1894                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1895                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1896
  1897             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1898                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1899                 88  CO-OVRD-BY-R78             VALUE '1'.
  1900                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1901                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1902                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1903                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1904                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1905                 88  CO-OVRD-MEAN               VALUE '8'.
  1906                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1907
  1908             20  CF-CO-BEN-I-G-CD           PIC X.
  1909                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1910                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1911                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1912
  1913         16  FILLER                         PIC X(304).
  1914
  1915
  1916****************************************************************
  1917*             CARRIER MASTER RECORD                            *
  1918****************************************************************
  1919
  1920     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1921         16  CF-ADDRESS-DATA.
  1922             20  CF-MAIL-TO-NAME            PIC X(30).
  1923             20  CF-IN-CARE-OF              PIC X(30).
  1924             20  CF-ADDRESS-LINE-1          PIC X(30).
  1925             20  CF-ADDRESS-LINE-2          PIC X(30).
  1926             20  CF-CITY-STATE              PIC X(30).
  1927             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  35
* SOCK03.cbl
  1928             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1929
  1930         16  CF-CLAIM-NO-CONTROL.
  1931             20  CF-CLAIM-NO-METHOD         PIC X.
  1932                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1933                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1934                 88  CLAIM-NO-SEQ               VALUE '3'.
  1935                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1936             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1937                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1938                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1939                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1940
  1941         16  CF-CHECK-NO-CONTROL.
  1942             20  CF-CHECK-NO-METHOD         PIC X.
  1943                 88  CHECK-NO-MANUAL            VALUE '1'.
  1944                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1945                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1946                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1947             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1948                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1949
  1950         16  CF-DOMICILE-STATE              PIC XX.
  1951
  1952         16  CF-EXPENSE-CONTROLS.
  1953             20  CF-EXPENSE-METHOD          PIC X.
  1954                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1955                 88  DOLLARS-PER-PMT            VALUE '2'.
  1956                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1957                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1958             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1959             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1960
  1961         16  CF-CORRESPONDENCE-CONTROL.
  1962             20  CF-LETTER-RESEND-OPT       PIC X.
  1963                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1964                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1965             20  FILLER                     PIC X(4).
  1966
  1967         16  CF-RESERVE-CONTROLS.
  1968             20  CF-MANUAL-SW               PIC X.
  1969                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1970             20  CF-FUTURE-SW               PIC X.
  1971                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1972             20  CF-PTC-SW                  PIC X.
  1973                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1974             20  CF-IBNR-SW                 PIC X.
  1975                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1976             20  CF-PTC-LF-SW               PIC X.
  1977                 88  CF-LF-PTC-USED             VALUE '1'.
  1978             20  CF-CDT-ACCESS-METHOD       PIC X.
  1979                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1980                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1981                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1982             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1983
  1984         16  CF-CLAIM-CALC-METHOD           PIC X.
  1985             88  360-PLUS-MONTHS                VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  36
* SOCK03.cbl
  1986             88  365-PLUS-MONTHS                VALUE '2'.
  1987             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1988             88  360-DAILY                      VALUE '4'.
  1989             88  365-DAILY                      VALUE '5'.
  1990
  1991         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1992         16  FILLER                         PIC X(11).
  1993
  1994         16  CF-LIMIT-AMOUNTS.
  1995             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1996             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1997             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1998             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1999             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2000             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2001             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2002             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2003             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2004             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2005
  2006         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2007         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2008         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2009
  2010         16  CF-ZIP-CODE.
  2011             20  CF-ZIP-PRIME.
  2012                 24  CF-ZIP-1ST             PIC X.
  2013                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2014                 24  FILLER                 PIC X(4).
  2015             20  CF-ZIP-PLUS4               PIC X(4).
  2016         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2017             20  CF-CAN-POSTAL-1            PIC XXX.
  2018             20  CF-CAN-POSTAL-2            PIC XXX.
  2019             20  FILLER                     PIC XXX.
  2020
  2021         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2022         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2023         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2024
  2025         16  CF-RATING-SWITCH               PIC X.
  2026             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2027             88  CF-NO-RATING                   VALUE 'N'.
  2028
  2029         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2030
  2031         16  CF-CARRIER-OVER-SHORT.
  2032             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2033             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2034
  2035         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2036         16  CF-SECPAY-SWITCH               PIC X.
  2037             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2038             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2039         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2040         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2041         16  FILLER                         PIC X(444).
  2042*        16  FILLER                         PIC X(452).
  2043
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  37
* SOCK03.cbl
  2044
  2045****************************************************************
  2046*             MORTALITY MASTER RECORD                          *
  2047****************************************************************
  2048
  2049     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2050         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2051                                INDEXED BY CF-MORT-NDX.
  2052             20  CF-MORT-TABLE              PIC X(5).
  2053             20  CF-MORT-TABLE-TYPE         PIC X.
  2054                 88  CF-MORT-JOINT              VALUE 'J'.
  2055                 88  CF-MORT-SINGLE             VALUE 'S'.
  2056                 88  CF-MORT-COMBINED           VALUE 'C'.
  2057                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2058                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2059             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2060             20  CF-MORT-AGE-METHOD         PIC XX.
  2061                 88  CF-AGE-LAST                VALUE 'AL'.
  2062                 88  CF-AGE-NEAR                VALUE 'AN'.
  2063             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2064             20  CF-MORT-ADJUSTMENT-DIRECTION
  2065                                            PIC X.
  2066                 88  CF-MINUS                   VALUE '-'.
  2067                 88  CF-PLUS                    VALUE '+'.
  2068             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2069             20  CF-MORT-JOINT-CODE         PIC X.
  2070                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2071             20  CF-MORT-PC-Q               PIC X.
  2072                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2073             20  CF-MORT-TABLE-CODE         PIC X(4).
  2074             20  CF-MORT-COMMENTS           PIC X(15).
  2075             20  FILLER                     PIC X(14).
  2076
  2077         16  FILLER                         PIC X(251).
  2078
  2079
  2080****************************************************************
  2081*             BUSSINESS TYPE MASTER RECORD                     *
  2082****************************************************************
  2083
  2084     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2085* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2086* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2087* AND RECORD 05 IS TYPES 81-99
  2088         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2089             20  CF-BUSINESS-TITLE          PIC  X(19).
  2090             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2091                                            PIC S9V9(4) COMP-3.
  2092             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2093             20  FILLER                     PIC  X.
  2094         16  FILLER                         PIC  X(248).
  2095
  2096
  2097****************************************************************
  2098*             TERMINAL MASTER RECORD                           *
  2099****************************************************************
  2100
  2101     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  38
* SOCK03.cbl
  2102
  2103         16  CF-COMPANY-TERMINALS.
  2104             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2105                                  PIC X(4).
  2106         16  FILLER               PIC X(248).
  2107
  2108
  2109****************************************************************
  2110*             LIFE EDIT MASTER RECORD                          *
  2111****************************************************************
  2112
  2113     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2114         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2115             20  CF-LIFE-CODE-IN            PIC XX.
  2116             20  CF-LIFE-CODE-OUT           PIC XX.
  2117         16  FILLER                         PIC X(248).
  2118
  2119
  2120****************************************************************
  2121*             AH EDIT MASTER RECORD                            *
  2122****************************************************************
  2123
  2124     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2125         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2126             20  CF-AH-CODE-IN              PIC XXX.
  2127             20  CF-AH-CODE-OUT             PIC XX.
  2128         16  FILLER                         PIC X(248).
  2129
  2130
  2131****************************************************************
  2132*             CREDIBILITY TABLES                               *
  2133****************************************************************
  2134
  2135     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2136         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2137                             INDEXED BY CF-CRDB-NDX.
  2138             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2139             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2140             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2141         16  FILLER                         PIC  X(332).
  2142
  2143
  2144****************************************************************
  2145*             REPORT CUSTOMIZATION RECORD                      *
  2146****************************************************************
  2147
  2148     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2149         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2150             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2151             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2152             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2153**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2154****       A T-TRANSFER.                                   ****
  2155             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2156
  2157         16  FILLER                         PIC XX.
  2158
  2159         16  CF-CARRIER-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  39
* SOCK03.cbl
  2160             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2161                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2162                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2163             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2164                                            PIC X.
  2165         16  CF-GROUP-CNTL-OPT.
  2166             20  CF-GROUP-OPT-SEQ           PIC 9.
  2167                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2168                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2169             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2170                                            PIC X(6).
  2171         16  CF-STATE-CNTL-OPT.
  2172             20  CF-STATE-OPT-SEQ           PIC 9.
  2173                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2174                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2175             20  CF-STATE-SELECT OCCURS 3 TIMES
  2176                                            PIC XX.
  2177         16  CF-ACCOUNT-CNTL-OPT.
  2178             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2179                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2180                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2181             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2182                                            PIC X(10).
  2183         16  CF-BUS-TYP-CNTL-OPT.
  2184             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2185                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2186                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2187             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2188                                            PIC XX.
  2189         16  CF-LF-TYP-CNTL-OPT.
  2190             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2191                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2192                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2193             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2194                                            PIC XX.
  2195         16  CF-AH-TYP-CNTL-OPT.
  2196             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2197                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2198                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2199             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2200                                            PIC XX.
  2201         16  CF-REPTCD1-CNTL-OPT.
  2202             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2203                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2204                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2205             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2206                                            PIC X(10).
  2207         16  CF-REPTCD2-CNTL-OPT.
  2208             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2209                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2210                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2211             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2212                                            PIC X(10).
  2213         16  CF-USER1-CNTL-OPT.
  2214             20  CF-USER1-OPT-SEQ           PIC 9.
  2215                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2216                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2217             20  CF-USER1-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  40
* SOCK03.cbl
  2218                                            PIC X(10).
  2219         16  CF-USER2-CNTL-OPT.
  2220             20  CF-USER2-OPT-SEQ           PIC 9.
  2221                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2222                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2223             20  CF-USER2-SELECT OCCURS 3 TIMES
  2224                                            PIC X(10).
  2225         16  CF-USER3-CNTL-OPT.
  2226             20  CF-USER3-OPT-SEQ           PIC 9.
  2227                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2228                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2229             20  CF-USER3-SELECT OCCURS 3 TIMES
  2230                                            PIC X(10).
  2231         16  CF-USER4-CNTL-OPT.
  2232             20  CF-USER4-OPT-SEQ           PIC 9.
  2233                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2234                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2235             20  CF-USER4-SELECT OCCURS 3 TIMES
  2236                                            PIC X(10).
  2237         16  CF-USER5-CNTL-OPT.
  2238             20  CF-USER5-OPT-SEQ           PIC 9.
  2239                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2240                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2241             20  CF-USER5-SELECT OCCURS 3 TIMES
  2242                                            PIC X(10).
  2243         16  CF-REINS-CNTL-OPT.
  2244             20  CF-REINS-OPT-SEQ           PIC 9.
  2245                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2246                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2247             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2248                 24  CF-REINS-PRIME         PIC XXX.
  2249                 24  CF-REINS-SUB           PIC XXX.
  2250
  2251         16  CF-AGENT-CNTL-OPT.
  2252             20  CF-AGENT-OPT-SEQ           PIC 9.
  2253                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2254                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2255             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2256                                            PIC X(10).
  2257
  2258         16  FILLER                         PIC X(43).
  2259
  2260         16  CF-LOSS-RATIO-SELECT.
  2261             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2262             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2263         16  CF-ENTRY-DATE-SELECT.
  2264             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2265             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2266         16  CF-EFFECTIVE-DATE-SELECT.
  2267             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2268             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2269
  2270         16  CF-EXCEPTION-LIST-IND          PIC X.
  2271             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2272
  2273         16  FILLER                         PIC X(318).
  2274
  2275****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  41
* SOCK03.cbl
  2276*                  EXCEPTION REPORTING RECORD                  *
  2277****************************************************************
  2278
  2279     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2280         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2281             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2282
  2283         16  CF-COMBINED-LIFE-AH-OPT.
  2284             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2285             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2286             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2287             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2288
  2289         16  CF-LIFE-OPT.
  2290             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2291             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2292             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2293             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2294             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2295             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2296             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2297             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2298             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2299             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2300
  2301         16  CF-AH-OPT.
  2302             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2303             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2304             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2305             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2306             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2307             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2308             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2309             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2310             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2311             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2312
  2313         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2314             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2315             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2316             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2317
  2318         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2319
  2320         16  FILLER                         PIC X(673).
  2321
  2322
  2323****************************************************************
  2324*             MORTGAGE SYSTEM PLAN RECORD                      *
  2325****************************************************************
  2326
  2327     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2328         16  CF-PLAN-TYPE                   PIC X.
  2329             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2330             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2331             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2332         16  CF-PLAN-ABBREV                 PIC XXX.
  2333         16  CF-PLAN-DESCRIPT               PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  42
* SOCK03.cbl
  2334         16  CF-PLAN-NOTES                  PIC X(20).
  2335         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2336         16  CF-PLAN-UNDERWRITING.
  2337             20  CF-PLAN-TERM-DATA.
  2338                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2339                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2340             20  CF-PLAN-AGE-DATA.
  2341                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2342                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2343                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2344             20  CF-PLAN-BENEFIT-DATA.
  2345                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2346                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2347                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2348                                            PIC S9(7)V99  COMP-3.
  2349         16  CF-PLAN-POLICY-FORMS.
  2350             20  CF-POLICY-FORM             PIC X(12).
  2351             20  CF-MASTER-APPLICATION      PIC X(12).
  2352             20  CF-MASTER-POLICY           PIC X(12).
  2353         16  CF-PLAN-RATING.
  2354             20  CF-RATE-CODE               PIC X(5).
  2355             20  CF-SEX-RATING              PIC X.
  2356                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2357                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2358             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2359             20  CF-SUB-STD-TYPE            PIC X.
  2360                 88  CF-PCT-OF-PREM            VALUE '1'.
  2361                 88  CF-PCT-OF-BENE            VALUE '2'.
  2362         16  CF-PLAN-PREM-TOLERANCES.
  2363             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2364             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2365         16  CF-PLAN-PYMT-TOLERANCES.
  2366             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2367             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2368         16  CF-PLAN-MISC-DATA.
  2369             20  FILLER                     PIC X.
  2370             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2371             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2372         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2373         16  CF-PLAN-IND-GRP                PIC X.
  2374             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2375                                                     '1'.
  2376             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2377                                                     '2'.
  2378         16  CF-MIB-SEARCH-SW               PIC X.
  2379             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2380             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2381             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2382             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2383         16  CF-ALPHA-SEARCH-SW             PIC X.
  2384             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2385             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2386             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2387             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2388             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2389             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2390             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2391             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  43
* SOCK03.cbl
  2392             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2393             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2394                                                     'A' 'B' 'C'
  2395                                                     'X' 'Y' 'Z'.
  2396         16  CF-EFF-DT-RULE-SW              PIC X.
  2397             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2398             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2399             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2400             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2401             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2402         16  FILLER                         PIC X(4).
  2403         16  CF-HEALTH-QUESTIONS            PIC X.
  2404             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2405         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2406         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2407         16  CF-PLAN-SNGL-JNT               PIC X.
  2408             88  CF-COMBINED-PLAN              VALUE 'C'.
  2409             88  CF-JNT-PLAN                   VALUE 'J'.
  2410             88  CF-SNGL-PLAN                  VALUE 'S'.
  2411         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2412         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2413         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2414         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2415         16  CF-RERATE-CNTL                 PIC  X.
  2416             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2417             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2418             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2419             88  CF-AUTO-RECALC                 VALUE '4'.
  2420         16  CF-BENEFIT-TYPE                PIC  X.
  2421             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2422             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2423         16  CF-POLICY-FEE                  PIC S999V99
  2424                                                    COMP-3.
  2425         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2426         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2427         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2428         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2429         16  FILLER                         PIC  X(32).
  2430         16  CF-TERMINATION-FORM            PIC  X(04).
  2431         16  FILLER                         PIC  X(08).
  2432         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2433                                                       COMP-3.
  2434         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2435         16  CF-ISSUE-LETTER                PIC  X(4).
  2436         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2437         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2438             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2439             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2440         16  CF-MP-REFUND-CALC              PIC X.
  2441             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2442             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2443             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2444             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2445             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2446             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2447             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2448             88  CF-MP-REFD-MEAN                VALUE '8'.
  2449         16  CF-ALT-RATE-CODE               PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  44
* SOCK03.cbl
  2450
  2451
  2452         16  FILLER                         PIC X(498).
  2453****************************************************************
  2454*             MORTGAGE COMPANY MASTER RECORD                   *
  2455****************************************************************
  2456
  2457     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2458         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2459         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2460             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2461             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2462             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2463             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2464             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2465
  2466         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2467         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2468         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2469         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2470         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2471
  2472         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2473             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2474         16  CF-MP-RECON-USE-IND            PIC X(1).
  2475             88  CF-MP-USE-RECON             VALUE 'Y'.
  2476         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2477             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2478         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2479             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2480             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2481         16  FILLER                         PIC X(1).
  2482         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2483             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2484         16  CF-MORTG-MIB-VERSION           PIC X.
  2485             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2486             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2487             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2488         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2489             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2490                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2491             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2492                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2493             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2494                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2495             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2496                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2497             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2498                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2499             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2500                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2501         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2502         16  FILLER                         PIC X(7).
  2503         16  CF-MORTG-DESTINATION-SYMBOL.
  2504             20  CF-MORTG-MIB-COMM          PIC X(5).
  2505             20  CF-MORTG-MIB-TERM          PIC X(5).
  2506         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2507             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  45
* SOCK03.cbl
  2508         16  FILLER                         PIC X(03).
  2509         16  CF-MP-CHECK-NO-CONTROL.
  2510             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2511                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2512                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2513                                                ' ' LOW-VALUES.
  2514                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2515                                               VALUE '3'.
  2516         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2517         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2518         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2519             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2520                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2521             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2522                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2523             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2524                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2525             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2526                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2527             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2528                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2529             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2530                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2531         16  CF-MORTG-BILLING-AREA.
  2532             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2533                                            PIC X.
  2534         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2535         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2536         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2537         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2538             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2539             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2540         16  FILLER                         PIC X.
  2541         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2542             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2543             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2544         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2545         16  FILLER                         PIC X(8).
  2546         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2547         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2548         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2549         16  CF-ACH-COMPANY-ID.
  2550             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2551                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2552                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2553                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2554             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2555         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2556             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2557         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2558             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2559             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2560         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2561         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2562         16  FILLER                         PIC X(536).
  2563
  2564****************************************************************
  2565*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  46
* SOCK03.cbl
  2566****************************************************************
  2567
  2568     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2569         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2570             20  CF-FEMALE-HEIGHT.
  2571                 24  CF-FEMALE-FT           PIC 99.
  2572                 24  CF-FEMALE-IN           PIC 99.
  2573             20  CF-FEMALE-MIN-WT           PIC 999.
  2574             20  CF-FEMALE-MAX-WT           PIC 999.
  2575         16  FILLER                         PIC X(428).
  2576
  2577     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2578         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2579             20  CF-MALE-HEIGHT.
  2580                 24  CF-MALE-FT             PIC 99.
  2581                 24  CF-MALE-IN             PIC 99.
  2582             20  CF-MALE-MIN-WT             PIC 999.
  2583             20  CF-MALE-MAX-WT             PIC 999.
  2584         16  FILLER                         PIC X(428).
  2585******************************************************************
  2586*             AUTOMATIC ACTIVITY RECORD                          *
  2587******************************************************************
  2588     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2589         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2590             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2591             20  CF-SYS-LETTER-ID           PIC X(04).
  2592             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2593             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2594             20  CF-SYS-RESET-SW            PIC X(01).
  2595             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2596             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2597
  2598         16  FILLER                         PIC X(50).
  2599
  2600         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2601             20  CF-USER-ACTIVE-SW          PIC X(01).
  2602             20  CF-USER-LETTER-ID          PIC X(04).
  2603             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2604             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2605             20  CF-USER-RESET-SW           PIC X(01).
  2606             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2607             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2608             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2609
  2610         16  FILLER                         PIC X(246).
  2611*                                 COPY ERCACCT.
  2612******************************************************************
  2613*                                                                *
  2614*                                                                *
  2615*                            ERCACCT                             *
  2616*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2617*                            VMOD=2.031                          *
  2618*                                                                *
  2619*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2620*                                                                *
  2621*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2622*   VSAM ACCOUNT MASTER FILES.                                   *
  2623*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  47
* SOCK03.cbl
  2624*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2625*                                                                *
  2626*   FILE TYPE = VSAM,KSDS                                        *
  2627*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2628*                                                                *
  2629*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2630*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2631*                                                                *
  2632*   LOG = NO                                                     *
  2633*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2634*                                                                *
  2635*                                                                *
  2636******************************************************************
  2637*                   C H A N G E   L O G
  2638*
  2639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2640*-----------------------------------------------------------------
  2641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2642* EFFECTIVE    NUMBER
  2643*-----------------------------------------------------------------
  2644* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2645* 092705    2005050300006  PEMA  ADD SPP LEASES
  2646* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2647* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2648* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2649* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2650* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2651* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2652******************************************************************
  2653
  2654 01  ACCOUNT-MASTER.
  2655     12  AM-RECORD-ID                      PIC XX.
  2656         88  VALID-AM-ID                      VALUE 'AM'.
  2657
  2658     12  AM-CONTROL-PRIMARY.
  2659         16  AM-COMPANY-CD                 PIC X.
  2660         16  AM-MSTR-CNTRL.
  2661             20  AM-CONTROL-A.
  2662                 24  AM-CARRIER            PIC X.
  2663                 24  AM-GROUPING.
  2664                     28 AM-GROUPING-PREFIX PIC XXX.
  2665                     28 AM-GROUPING-PRIME  PIC XXX.
  2666                 24  AM-STATE              PIC XX.
  2667                 24  AM-ACCOUNT.
  2668                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2669                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2670             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2671                                           PIC X(19).
  2672             20  AM-CNTRL-B.
  2673                 24  AM-EXPIRATION-DT      PIC XX.
  2674                 24  FILLER                PIC X(4).
  2675             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2676                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2677
  2678     12  AM-CONTROL-BY-VAR-GRP.
  2679         16  AM-COMPANY-CD-A1              PIC X.
  2680         16  AM-VG-CARRIER                 PIC X.
  2681         16  AM-VG-GROUPING                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  48
* SOCK03.cbl
  2682         16  AM-VG-STATE                   PIC XX.
  2683         16  AM-VG-ACCOUNT                 PIC X(10).
  2684         16  AM-VG-DATE.
  2685             20  AM-VG-EXPIRATION-DT       PIC XX.
  2686             20  FILLER                    PIC X(4).
  2687         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2688                                           PIC 9(11)      COMP-3.
  2689     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2690         16  FILLER                        PIC X(10).
  2691         16  AM-VG-KEY3.
  2692             20  AM-VG3-ACCOUNT            PIC X(10).
  2693             20  AM-VG3-EXP-DT             PIC XX.
  2694         16  FILLER                        PIC X(4).
  2695     12  AM-MAINT-INFORMATION.
  2696         16  AM-LAST-MAINT-DT              PIC XX.
  2697         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2698         16  AM-LAST-MAINT-USER            PIC X(4).
  2699         16  FILLER                        PIC XX.
  2700
  2701     12  AM-EFFECTIVE-DT                   PIC XX.
  2702     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2703
  2704     12  AM-PREV-DATES  COMP-3.
  2705         16  AM-PREV-EXP-DT                PIC 9(11).
  2706         16  AM-PREV-EFF-DT                PIC 9(11).
  2707
  2708     12  AM-REPORT-CODE-1                  PIC X(10).
  2709     12  AM-REPORT-CODE-2                  PIC X(10).
  2710
  2711     12  AM-CITY-CODE                      PIC X(4).
  2712     12  AM-COUNTY-PARISH                  PIC X(6).
  2713
  2714     12  AM-NAME                           PIC X(30).
  2715     12  AM-PERSON                         PIC X(30).
  2716     12  AM-ADDRS                          PIC X(30).
  2717     12  AM-CITY.
  2718         16  AM-ADDR-CITY                  PIC X(28).
  2719         16  AM-ADDR-STATE                 PIC XX.
  2720     12  AM-ZIP.
  2721         16  AM-ZIP-PRIME.
  2722             20  AM-ZIP-PRI-1ST            PIC X.
  2723                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2724             20  FILLER                    PIC X(4).
  2725         16  AM-ZIP-PLUS4                  PIC X(4).
  2726     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2727         16  AM-CAN-POSTAL-1               PIC XXX.
  2728         16  AM-CAN-POSTAL-2               PIC XXX.
  2729         16  FILLER                        PIC XXX.
  2730     12  AM-TEL-NO.
  2731         16  AM-AREA-CODE                  PIC 999.
  2732         16  AM-TEL-PRE                    PIC 999.
  2733         16  AM-TEL-NBR                    PIC 9(4).
  2734     12  AM-TEL-LOC                        PIC X.
  2735         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2736         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2737
  2738     12  AM-COMM-STRUCTURE.
  2739         16  AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  49
* SOCK03.cbl
  2740             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2741                 24  AM-AGT.
  2742                     28  AM-AGT-PREFIX     PIC X(4).
  2743                     28  AM-AGT-PRIME      PIC X(6).
  2744                 24  AM-COM-TYP            PIC X.
  2745                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2746                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2747                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2748                 24  AM-RECALC-LV-INDIC    PIC X.
  2749                 24  AM-RETRO-LV-INDIC     PIC X.
  2750                 24  AM-GL-CODES           PIC X.
  2751                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2752                 24  FILLER                PIC X(01).
  2753         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2754             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2755                 24  FILLER                PIC X(11).
  2756                 24  AM-L-COMA             PIC XXX.
  2757                 24  AM-J-COMA             PIC XXX.
  2758                 24  AM-A-COMA             PIC XXX.
  2759                 24  FILLER                PIC X(6).
  2760
  2761     12  AM-COMM-CHANGE-STATUS             PIC X.
  2762         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2763
  2764     12  AM-CSR-CODE                       PIC X(4).
  2765
  2766     12  AM-BILLING-STATUS                 PIC X.
  2767         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2768         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2769     12  AM-AUTO-REFUND-SW                 PIC X.
  2770         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2771         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2772     12  AM-GPCD                           PIC 99.
  2773     12  AM-IG                             PIC X.
  2774         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2775         88  AM-HAS-GROUP                     VALUE '2'.
  2776     12  AM-STATUS                         PIC X.
  2777         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2778         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2779         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2780         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2781         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2782         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2783         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2784         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2785         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2786         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2787     12  AM-REMIT-TO                       PIC 99.
  2788     12  AM-ID-NO                          PIC X(11).
  2789
  2790     12  AM-CAL-TABLE                      PIC XX.
  2791     12  AM-LF-DEVIATION                   PIC XXX.
  2792     12  AM-AH-DEVIATION                   PIC XXX.
  2793     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2794     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2795     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2796     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2797     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  50
* SOCK03.cbl
  2798     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2799
  2800     12  AM-USER-FIELDS.
  2801         16  AM-FLD-1                      PIC XX.
  2802         16  AM-FLD-2                      PIC XX.
  2803         16  AM-FLD-3                      PIC XX.
  2804         16  AM-FLD-4                      PIC XX.
  2805         16  AM-FLD-5                      PIC XX.
  2806
  2807     12  AM-1ST-PROD-DATE.
  2808         16  AM-1ST-PROD-YR                PIC XX.
  2809         16  AM-1ST-PROD-MO                PIC XX.
  2810         16  AM-1ST-PROD-DA                PIC XX.
  2811     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2812     12  AM-CERTS-PURGED-DATE.
  2813         16  AM-PUR-YR                     PIC XX.
  2814         16  AM-PUR-MO                     PIC XX.
  2815         16  AM-PUR-DA                     PIC XX.
  2816     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2817     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2818     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2819     12  AM-INACTIVE-DATE.
  2820         16  AM-INA-MO                     PIC 99.
  2821         16  AM-INA-DA                     PIC 99.
  2822         16  AM-INA-YR                     PIC 99.
  2823     12  AM-AR-HI-CERT-DATE                PIC XX.
  2824
  2825     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2826     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2827
  2828     12  AM-OB-PAYMENT-MODE                PIC X.
  2829         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2830         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2831         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2832         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2833
  2834     12  AM-AH-ONLY-INDICATOR              PIC X.
  2835         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2836         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2837
  2838     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2839
  2840     12  AM-OVER-SHORT.
  2841         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2842         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2843
  2844     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2845     12  AM-DCC-CLP-STATE                  PIC XX.
  2846
  2847     12  AM-RECALC-COMM                    PIC X.
  2848     12  AM-RECALC-REIN                    PIC X.
  2849
  2850     12  AM-REI-TABLE                      PIC XXX.
  2851     12  AM-REI-ET-LF                      PIC X.
  2852     12  AM-REI-ET-AH                      PIC X.
  2853     12  AM-REI-PE-LF                      PIC X.
  2854     12  AM-REI-PE-AH                      PIC X.
  2855     12  AM-REI-PRT-ST                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  51
* SOCK03.cbl
  2856     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2857     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2858     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2859     12  AM-REI-GROUP-A                    PIC X(6).
  2860     12  AM-REI-MORT                       PIC X(4).
  2861     12  AM-REI-PRT-OW                     PIC X.
  2862     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2863     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2864     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2865     12  AM-REI-GROUP-B                    PIC X(6).
  2866
  2867     12  AM-TRUST-TYPE                     PIC X(2).
  2868
  2869     12  AM-EMPLOYER-STMT-USED             PIC X.
  2870     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2871
  2872     12  AM-STD-AH-TYPE                    PIC XX.
  2873     12  AM-EARN-METHODS.
  2874         16  AM-EARN-METHOD-R              PIC X.
  2875             88 AM-REF-RL-R78                 VALUE 'R'.
  2876             88 AM-REF-RL-PR                  VALUE 'P'.
  2877             88 AM-REF-RL-MEAN                VALUE 'M'.
  2878             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2879         16  AM-EARN-METHOD-L              PIC X.
  2880             88 AM-REF-LL-R78                 VALUE 'R'.
  2881             88 AM-REF-LL-PR                  VALUE 'P'.
  2882             88 AM-REF-LL-MEAN                VALUE 'M'.
  2883             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2884         16  AM-EARN-METHOD-A              PIC X.
  2885             88 AM-REF-AH-R78                 VALUE 'R'.
  2886             88 AM-REF-AH-PR                  VALUE 'P'.
  2887             88 AM-REF-AH-MEAN                VALUE 'M'.
  2888             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2889             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2890             88 AM-REF-AH-NET                 VALUE 'N'.
  2891
  2892     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2893     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2894     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2895
  2896     12  AM-RET-Y-N                        PIC X.
  2897     12  AM-RET-P-E                        PIC X.
  2898     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2899     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2900     12  AM-RET-GRP                        PIC X(6).
  2901     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2902         16  AM-POOL-PRIME                 PIC XXX.
  2903         16  AM-POOL-SUB                   PIC XXX.
  2904     12  AM-RETRO-EARNINGS.
  2905         16  AM-RET-EARN-R                 PIC X.
  2906         16  AM-RET-EARN-L                 PIC X.
  2907         16  AM-RET-EARN-A                 PIC X.
  2908     12  AM-RET-ST-TAX-USE                 PIC X.
  2909         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2910         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2911     12  AM-RETRO-BEG-EARNINGS.
  2912         16  AM-RET-BEG-EARN-R             PIC X.
  2913         16  AM-RET-BEG-EARN-L             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  52
* SOCK03.cbl
  2914         16  AM-RET-BEG-EARN-A             PIC X.
  2915     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2916     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2917
  2918     12  AM-USER-SELECT-OPTIONS.
  2919         16  AM-USER-SELECT-1              PIC X(10).
  2920         16  AM-USER-SELECT-2              PIC X(10).
  2921         16  AM-USER-SELECT-3              PIC X(10).
  2922         16  AM-USER-SELECT-4              PIC X(10).
  2923         16  AM-USER-SELECT-5              PIC X(10).
  2924
  2925     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2926
  2927     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2928
  2929     12  AM-RPT045A-SWITCH                 PIC X.
  2930         88  RPT045A-OFF                   VALUE 'N'.
  2931
  2932     12  AM-INSURANCE-LIMITS.
  2933         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2934         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2935
  2936     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2937         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2938
  2939     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2940         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2941         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2942
  2943     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2944
  2945     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2946     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2947     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2948     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2949     12  AM-DCC-UEF-STATE                  PIC XX.
  2950     12  FILLER                            PIC XXX.
  2951     12  AM-REPORT-CODE-3                  PIC X(10).
  2952*    12  FILLER                            PIC X(22).
  2953
  2954     12  AM-RESERVE-DATE.
  2955         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2956         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2957         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2958
  2959     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2960     12  AM-NOTIFICATION-TYPES.
  2961         16  AM-NOTIF-OF-LETTERS           PIC X.
  2962         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2963         16  AM-NOTIF-OF-REPORTS           PIC X.
  2964         16  AM-NOTIF-OF-STATUS            PIC X.
  2965
  2966     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2967         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2968         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2969         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2970         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2971
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  53
* SOCK03.cbl
  2972     12  AM-BENEFIT-CONTROLS.
  2973         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2974             20  AM-BENEFIT-CODE           PIC XX.
  2975             20  AM-BENEFIT-TYPE           PIC X.
  2976             20  AM-BENEFIT-REVISION       PIC XXX.
  2977             20  AM-BENEFIT-REM-TERM       PIC X.
  2978             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2979             20  FILLER                    PIC XX.
  2980         16  FILLER                        PIC X(80).
  2981
  2982     12  AM-TRANSFER-DATA.
  2983         16  AM-TRANSFERRED-FROM.
  2984             20  AM-TRNFROM-CARRIER        PIC X.
  2985             20  AM-TRNFROM-GROUPING.
  2986                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2987                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2988             20  AM-TRNFROM-STATE          PIC XX.
  2989             20  AM-TRNFROM-ACCOUNT.
  2990                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2991                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2992             20  AM-TRNFROM-DTE            PIC XX.
  2993         16  AM-TRANSFERRED-TO.
  2994             20  AM-TRNTO-CARRIER          PIC X.
  2995             20  AM-TRNTO-GROUPING.
  2996                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2997                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2998             20  AM-TRNTO-STATE            PIC XX.
  2999             20  AM-TRNTO-ACCOUNT.
  3000                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3001                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3002             20  AM-TRNTO-DTE              PIC XX.
  3003         16  FILLER                        PIC X(10).
  3004
  3005     12  AM-SAVED-REMIT-TO                 PIC 99.
  3006
  3007     12  AM-COMM-STRUCTURE-SAVED.
  3008         16  AM-DEFN-1-SAVED.
  3009             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3010                 24  AM-AGT-SV             PIC X(10).
  3011                 24  AM-COM-TYP-SV         PIC X.
  3012                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3013                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3014                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3015                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3016                 24  FILLER                PIC X.
  3017                 24  AM-GL-CODES-SV        PIC X.
  3018                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3019                 24  FILLER                PIC X.
  3020         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3021             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3022                 24  FILLER                PIC X(11).
  3023                 24  AM-L-COMA-SV          PIC XXX.
  3024                 24  AM-J-COMA-SV          PIC XXX.
  3025                 24  AM-A-COMA-SV          PIC XXX.
  3026                 24  FILLER                PIC X(6).
  3027
  3028     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3029         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  54
* SOCK03.cbl
  3030            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3031            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3032            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3033
  3034     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3035     12  FILLER                            PIC X(120).
  3036
  3037     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3038         16  AM-CONTROL-NAME               PIC X(30).
  3039         16  AM-EXECUTIVE-ONE.
  3040             20  AM-EXEC1-NAME             PIC X(15).
  3041             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3042                                                          COMP-3.
  3043             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3044                                                          COMP-3.
  3045         16  AM-EXECUTIVE-TWO.
  3046             20  AM-EXEC2-NAME             PIC X(15).
  3047             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3048                                                          COMP-3.
  3049             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3050                                                          COMP-3.
  3051
  3052     12  AM-RETRO-ADDITIONAL-DATA.
  3053         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3054         16  AM-RETRO-PREM-P-E             PIC X.
  3055         16  AM-RETRO-CLMS-P-I             PIC X.
  3056         16  AM-RETRO-RET-BRACKET-LF.
  3057             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3058                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3059                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3060             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3061                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3062                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3063             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3064                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3065                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3066         16  AM-RETRO-RET-BRACKET-AH.
  3067             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3068                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3069                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3070                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3071             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3072                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3073                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3074             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3075                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3076                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3077
  3078     12  AM-COMMENTS.
  3079         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3080
  3081     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3082         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3083         16  AM-FLI-BILLING-CODE           PIC X.
  3084         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3085         16  AM-FLI-UNITED-IDENT           PIC X.
  3086         16  AM-FLI-INTEREST-LOST-DATA.
  3087             20  AM-FLI-BANK-NO            PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  55
* SOCK03.cbl
  3088             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3089             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3090             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3091         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3092             20  AM-FLI-AGT                PIC X(9).
  3093             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3094             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3095         16  FILLER                        PIC X(102).
  3096
  3097     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3098         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3099             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3100             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3101             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3102             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3103             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3104         16  FILLER                          PIC X(10).
  3105******************************************************************
  3106*                                 COPY ERCMAIL.
  3107******************************************************************
  3108*                                                                *
  3109*                                                                *
  3110*                            ERCMAIL                             *
  3111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3112*                            VMOD=2.003                          *
  3113*                                                                *
  3114*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3115*                                                                *
  3116*   FILE TYPE = VSAM,KSDS                                        *
  3117*   RECORD SIZE = 374   RECFORM = FIX                            *
  3118*                                                                *
  3119*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3120*   ALTERNATE PATH    = NOT USED                                 *
  3121*                                                                *
  3122*   LOG = YES                                                    *
  3123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3124******************************************************************
  3125*                   C H A N G E   L O G
  3126*
  3127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3128*-----------------------------------------------------------------
  3129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3130* EFFECTIVE    NUMBER
  3131*-----------------------------------------------------------------
  3132* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3133* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3134* 111108                   PEMA  ADD CRED BENE ADDR2
  3135******************************************************************
  3136
  3137 01  MAILING-DATA.
  3138     12  MA-RECORD-ID                      PIC XX.
  3139         88  VALID-MA-ID                       VALUE 'MA'.
  3140
  3141     12  MA-CONTROL-PRIMARY.
  3142         16  MA-COMPANY-CD                 PIC X.
  3143         16  MA-CARRIER                    PIC X.
  3144         16  MA-GROUPING.
  3145             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  56
* SOCK03.cbl
  3146             20  MA-GROUPING-PRIME         PIC XXX.
  3147         16  MA-STATE                      PIC XX.
  3148         16  MA-ACCOUNT.
  3149             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3150             20  MA-ACCOUNT-PRIME          PIC X(6).
  3151         16  MA-CERT-EFF-DT                PIC XX.
  3152         16  MA-CERT-NO.
  3153             20  MA-CERT-PRIME             PIC X(10).
  3154             20  MA-CERT-SFX               PIC X.
  3155
  3156     12  FILLER                            PIC XX.
  3157
  3158     12  MA-ACCESS-CONTROL.
  3159         16  MA-SOURCE-SYSTEM              PIC XX.
  3160             88  MA-FROM-CREDIT                VALUE 'CR'.
  3161             88  MA-FROM-VSI                   VALUE 'VS'.
  3162             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3163             88  MA-FROM-OTHER                 VALUE 'OT'.
  3164         16  MA-RECORD-ADD-DT              PIC XX.
  3165         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3166         16  MA-LAST-MAINT-DT              PIC XX.
  3167         16  MA-LAST-MAINT-BY              PIC XXXX.
  3168         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3169
  3170     12  MA-PROFILE-INFO.
  3171         16  MA-QUALIFY-CODE-1             PIC XX.
  3172         16  MA-QUALIFY-CODE-2             PIC XX.
  3173         16  MA-QUALIFY-CODE-3             PIC XX.
  3174         16  MA-QUALIFY-CODE-4             PIC XX.
  3175         16  MA-QUALIFY-CODE-5             PIC XX.
  3176
  3177         16  MA-INSURED-LAST-NAME          PIC X(15).
  3178         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3179         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3180         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3181         16  MA-INSURED-BIRTH-DT           PIC XX.
  3182         16  MA-INSURED-SEX                PIC X.
  3183             88  MA-SEX-MALE                   VALUE 'M'.
  3184             88  MA-SEX-FEMALE                 VALUE 'F'.
  3185         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3186
  3187         16  MA-ADDRESS-CORRECTED          PIC X.
  3188         16  MA-JOINT-BIRTH-DT             PIC XX.
  3189*        16  FILLER                        PIC X(12).
  3190
  3191         16  MA-ADDRESS-LINE-1             PIC X(30).
  3192         16  MA-ADDRESS-LINE-2             PIC X(30).
  3193         16  MA-CITY-STATE.
  3194             20  MA-CITY                   PIC X(28).
  3195             20  MA-ADDR-STATE             PIC XX.
  3196         16  MA-ZIP.
  3197             20  MA-ZIP-CODE.
  3198                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3199                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3200                 24  FILLER                PIC X(4).
  3201             20  MA-ZIP-PLUS4              PIC X(4).
  3202         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3203             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  57
* SOCK03.cbl
  3204             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3205             20  FILLER                    PIC X(3).
  3206
  3207         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3208
  3209         16  FILLER                        PIC XXX.
  3210*        16  FILLER                        PIC X(10).
  3211
  3212     12  MA-CRED-BENE-INFO.
  3213         16  MA-CRED-BENE-NAME                 PIC X(25).
  3214         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3215         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3216         16  MA-CRED-BENE-CTYST.
  3217             20  MA-CRED-BENE-CITY             PIC X(28).
  3218             20  MA-CRED-BENE-STATE            PIC XX.
  3219         16  MA-CRED-BENE-ZIP.
  3220             20  MA-CB-ZIP-CODE.
  3221                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3222                     88  MA-CB-CANADIAN-POST-CODE
  3223                                           VALUE 'A' THRU 'Z'.
  3224                 24  FILLER                    PIC X(4).
  3225             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3226         16  MA-CB-CANADIAN-POSTAL-CODE
  3227                            REDEFINES MA-CRED-BENE-ZIP.
  3228             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3229             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3230             20  FILLER                        PIC X(3).
  3231     12  MA-POST-CARD-MAIL-DATA.
  3232         16  MA-MAIL-DATA OCCURS 7.
  3233             20  MA-MAIL-TYPE              PIC X.
  3234                 88  MA-12MO-MAILING           VALUE '1'.
  3235                 88  MA-EXP-MAILING            VALUE '2'.
  3236             20  MA-MAIL-STATUS            PIC X.
  3237                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3238                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3239                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3240             20  MA-MAIL-DATE              PIC XX.
  3241     12  FILLER                            PIC XX.
  3242     12  FILLER                            PIC XX.
  3243*    12  FILLER                            PIC X(30).
  3244******************************************************************
  3245*                                 COPY ELCCRTT.
  3246******************************************************************
  3247*                                                                *
  3248*                            ELCCRTT.                            *
  3249*                                                                *
  3250*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3251*                                                                *
  3252*   FILE TYPE = VSAM,KSDS                                        *
  3253*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3254*                                                                *
  3255*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3256*                                                                *
  3257*   LOG = YES                                                    *
  3258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3259******************************************************************
  3260*                   C H A N G E   L O G
  3261*
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  58
* SOCK03.cbl
  3262* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3263*-----------------------------------------------------------------
  3264*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3265* EFFECTIVE    NUMBER
  3266*-----------------------------------------------------------------
  3267* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3268* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3269* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3270* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3271* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3272* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3273* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3274* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3275* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3276* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3277* 091318  CR2018073000001  PEMA  ADD Refund methods
  3278* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3279******************************************************************
  3280
  3281 01  CERTIFICATE-TRAILERS.
  3282     12  CS-RECORD-ID                      PIC XX.
  3283         88  VALID-CS-ID                      VALUE 'CS'.
  3284
  3285     12  CS-CONTROL-PRIMARY.
  3286         16  CS-COMPANY-CD                 PIC X.
  3287         16  CS-CARRIER                    PIC X.
  3288         16  CS-GROUPING                   PIC X(6).
  3289         16  CS-STATE                      PIC XX.
  3290         16  CS-ACCOUNT                    PIC X(10).
  3291         16  CS-CERT-EFF-DT                PIC XX.
  3292         16  CS-CERT-NO.
  3293             20  CS-CERT-PRIME             PIC X(10).
  3294             20  CS-CERT-SFX               PIC X.
  3295         16  CS-TRAILER-TYPE               PIC X.
  3296             88  COMM-TRLR           VALUE 'A'.
  3297             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3298             88  CERT-DATA-TRLR      VALUE 'C'.
  3299
  3300     12  CS-DATA-AREA                      PIC X(516).
  3301
  3302     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3303         16  CS-BANK-COMMISSION-AREA.
  3304             20  CS-BANK-COMMS       OCCURS 10.
  3305                 24  CS-AGT                PIC X(10).
  3306                 24  CS-COM-TYP            PIC X.
  3307                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3308                 24  CS-RECALC-LV-INDIC    PIC X.
  3309                 24  FILLER                PIC X(10).
  3310         16  FILLER                        PIC X(256).
  3311
  3312     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3313****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3314         16  CS-MB-CLAIM-DATA OCCURS 24.
  3315             20  CS-CLAIM-NO               PIC X(7).
  3316             20  CS-CLAIM-TYPE             PIC X.
  3317                 88  CS-AH-CLM               VALUE 'A'.
  3318                 88  CS-IU-CLM               VALUE 'I'.
  3319                 88  CS-GP-CLM               VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  59
* SOCK03.cbl
  3320                 88  CS-LF-CLM               VALUE 'L'.
  3321                 88  CS-PR-CLM               VALUE 'P'.
  3322                 88  CS-FL-CLM               VALUE 'F'.
  3323                 88  CS-OT-CLM               VALUE 'O'.
  3324             20  CS-INSURED-TYPE           PIC X.
  3325                 88  CS-PRIM-INSURED          VALUE 'P'.
  3326                 88  CS-CO-BORROWER           VALUE 'C'.
  3327             20  CS-BENEFIT-PERIOD         PIC 99.
  3328             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3329             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3330             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3331         16  FILLER                        PIC X(12).
  3332     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3333         16  CS-VIN-NUMBER                 PIC X(17).
  3334         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3335         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3336         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3337         16  cs-agent-name.
  3338             20  cs-agent-fname            pic x(20).
  3339             20  cs-agent-mi               pic x.
  3340             20  cs-agent-lname            pic x(25).
  3341         16  cs-license-no                 pic x(15).
  3342         16  cs-npn-number                 pic x(10).
  3343         16  cs-agent-edit-status          pic x.
  3344             88  cs-ae-refer-to-manager      value 'M'.
  3345             88  cs-ae-cover-sheet           value 'C'.
  3346             88  cs-ae-sig-form              value 'S'.
  3347             88  cs-ae-verified              value 'V'.
  3348             88  cs-unidentified-signature   value 'U'.
  3349             88  cs-cert-returned            value 'R'.
  3350             88  cs-accept-no-commission     value 'N'.
  3351         16  cs-year                       pic 9999.
  3352         16  cs-make                       pic x(20).
  3353         16  cs-model                      pic x(20).
  3354         16  cs-future                     pic x(20).
  3355         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3356         16  cs-claim-verification-status  pic x.
  3357             88  cs-clm-ver-eligible         value 'A'.
  3358             88  cs-clm-ver-partial-elig     value 'B'.
  3359             88  cs-clm-ver-not-eligible     value 'C'.
  3360             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3361             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3362             88  cs-clm-ver-ND-CERT          value 'F'.
  3363             88  cs-clm-ver-spec-other       value 'G'.
  3364             88  cs-clam-ver-pratial-corrected
  3365                                             value 'H'.
  3366             88  cs-clm-ver-no-matches       value 'I'.
  3367             88  cs-clm-ver-not-elig-corrected
  3368                                             value 'J'.
  3369             88  cs-clm-ver-needs-review     value 'R'.
  3370             88  cs-clm-ver-sent-to-claims   value 'W'.
  3371         16  CS-LF-REFUND-METHOD           PIC X.
  3372         16  CS-AH-REFUND-METHOD           PIC X.
  3373         16  FILLER                        PIC X(353). *> was 420
  3374*        16  FILLER                        PIC X(496).
  3375*                                 COPY ELCDATE.
  3376******************************************************************
  3377*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  60
* SOCK03.cbl
  3378*                                                                *
  3379*                            ELCDATE.                            *
  3380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3381*                            VMOD=2.003
  3382*                                                                *
  3383*                                                                *
  3384*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3385*                 LENGTH = 200                                   *
  3386******************************************************************
  3387
  3388 01  DATE-CONVERSION-DATA.
  3389     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3390     12  DC-OPTION-CODE                PIC X.
  3391         88  BIN-TO-GREG                VALUE ' '.
  3392         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3393         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3394         88  YMD-GREG-TO-BIN            VALUE '3'.
  3395         88  MDY-GREG-TO-BIN            VALUE '4'.
  3396         88  JULIAN-TO-BIN              VALUE '5'.
  3397         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3398         88  FIND-CENTURY               VALUE '7'.
  3399         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3400         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3401         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3402         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3403         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3404         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3405         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3406         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3407         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3408         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3409         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3410         88  BIN-3-TO-GREG              VALUE 'I'.
  3411         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3412         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3413         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3414         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3415         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3416         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3417         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3418         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3419         88  THREE-CHARACTER-BIN
  3420                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3421         88  GREGORIAN-TO-BIN
  3422                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3423         88  BIN-TO-GREGORIAN
  3424                  VALUES ' ' '1' 'I' '8' 'G'.
  3425         88  JULIAN-TO-BINARY
  3426                  VALUES '5' 'C' 'E' 'F'.
  3427     12  DC-ERROR-CODE                 PIC X.
  3428         88  NO-CONVERSION-ERROR        VALUE ' '.
  3429         88  DATE-CONVERSION-ERROR
  3430                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3431         88  DATE-IS-ZERO               VALUE '1'.
  3432         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3433         88  DATE-IS-INVALID            VALUE '3'.
  3434         88  DATE1-GREATER-DATE2        VALUE '4'.
  3435         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  61
* SOCK03.cbl
  3436         88  DATE-INVALID-OPTION        VALUE '9'.
  3437         88  INVALID-CENTURY            VALUE 'A'.
  3438         88  ONLY-CENTURY               VALUE 'B'.
  3439         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3440         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3441     12  DC-END-OF-MONTH               PIC X.
  3442         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3443     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3444         88  USE-NORMAL-PROCESS         VALUE ' '.
  3445         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3446         88  ADJUST-UP-100-YRS          VALUE '2'.
  3447     12  FILLER                        PIC X.
  3448     12  DC-CONVERSION-DATES.
  3449         16  DC-BIN-DATE-1             PIC XX.
  3450         16  DC-BIN-DATE-2             PIC XX.
  3451         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3452         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3453                       DC-GREG-DATE-1-EDIT.
  3454             20  DC-EDIT1-MONTH        PIC 99.
  3455             20  SLASH1-1              PIC X.
  3456             20  DC-EDIT1-DAY          PIC 99.
  3457             20  SLASH1-2              PIC X.
  3458             20  DC-EDIT1-YEAR         PIC 99.
  3459         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3460         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3461                     DC-GREG-DATE-2-EDIT.
  3462             20  DC-EDIT2-MONTH        PIC 99.
  3463             20  SLASH2-1              PIC X.
  3464             20  DC-EDIT2-DAY          PIC 99.
  3465             20  SLASH2-2              PIC X.
  3466             20  DC-EDIT2-YEAR         PIC 99.
  3467         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3468         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3469                     DC-GREG-DATE-1-YMD.
  3470             20  DC-YMD-YEAR           PIC 99.
  3471             20  DC-YMD-MONTH          PIC 99.
  3472             20  DC-YMD-DAY            PIC 99.
  3473         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3474         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3475                      DC-GREG-DATE-1-MDY.
  3476             20  DC-MDY-MONTH          PIC 99.
  3477             20  DC-MDY-DAY            PIC 99.
  3478             20  DC-MDY-YEAR           PIC 99.
  3479         16  DC-GREG-DATE-1-ALPHA.
  3480             20  DC-ALPHA-MONTH        PIC X(10).
  3481             20  DC-ALPHA-DAY          PIC 99.
  3482             20  FILLER                PIC XX.
  3483             20  DC-ALPHA-CENTURY.
  3484                 24 DC-ALPHA-CEN-N     PIC 99.
  3485             20  DC-ALPHA-YEAR         PIC 99.
  3486         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3487         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3488         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3489         16  DC-JULIAN-DATE            PIC 9(05).
  3490         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3491                                       PIC 9(05).
  3492         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3493             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  62
* SOCK03.cbl
  3494             20  DC-JULIAN-DAYS        PIC 999.
  3495         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3496         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3497         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3498     12  DATE-CONVERSION-VARIBLES.
  3499         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3500         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3501             20  FILLER                PIC 9(3).
  3502             20  HOLD-CEN-1-CCYY.
  3503                 24  HOLD-CEN-1-CC     PIC 99.
  3504                 24  HOLD-CEN-1-YY     PIC 99.
  3505             20  HOLD-CEN-1-MO         PIC 99.
  3506             20  HOLD-CEN-1-DA         PIC 99.
  3507         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3508             20  HOLD-CEN-1-R-MO       PIC 99.
  3509             20  HOLD-CEN-1-R-DA       PIC 99.
  3510             20  HOLD-CEN-1-R-CCYY.
  3511                 24  HOLD-CEN-1-R-CC   PIC 99.
  3512                 24  HOLD-CEN-1-R-YY   PIC 99.
  3513             20  FILLER                PIC 9(3).
  3514         16  HOLD-CENTURY-1-X.
  3515             20  FILLER                PIC X(3)  VALUE SPACES.
  3516             20  HOLD-CEN-1-X-CCYY.
  3517                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3518                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3519             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3520             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3521         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3522             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3523             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3524             20  HOLD-CEN-1-R-X-CCYY.
  3525                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3526                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3527             20  FILLER                PIC XXX.
  3528         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3529         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3530         16  DC-JULIAN-DATE-1          PIC 9(07).
  3531         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3532             20  DC-JULIAN-1-CCYY.
  3533                 24  DC-JULIAN-1-CC    PIC 99.
  3534                 24  DC-JULIAN-1-YR    PIC 99.
  3535             20  DC-JULIAN-DA-1        PIC 999.
  3536         16  DC-JULIAN-DATE-2          PIC 9(07).
  3537         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3538             20  DC-JULIAN-2-CCYY.
  3539                 24  DC-JULIAN-2-CC    PIC 99.
  3540                 24  DC-JULIAN-2-YR    PIC 99.
  3541             20  DC-JULIAN-DA-2        PIC 999.
  3542         16  DC-GREG-DATE-A-EDIT.
  3543             20  DC-EDITA-MONTH        PIC 99.
  3544             20  SLASHA-1              PIC X VALUE '/'.
  3545             20  DC-EDITA-DAY          PIC 99.
  3546             20  SLASHA-2              PIC X VALUE '/'.
  3547             20  DC-EDITA-CCYY.
  3548                 24  DC-EDITA-CENT     PIC 99.
  3549                 24  DC-EDITA-YEAR     PIC 99.
  3550         16  DC-GREG-DATE-B-EDIT.
  3551             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  63
* SOCK03.cbl
  3552             20  SLASHB-1              PIC X VALUE '/'.
  3553             20  DC-EDITB-DAY          PIC 99.
  3554             20  SLASHB-2              PIC X VALUE '/'.
  3555             20  DC-EDITB-CCYY.
  3556                 24  DC-EDITB-CENT     PIC 99.
  3557                 24  DC-EDITB-YEAR     PIC 99.
  3558         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3559         16  DC-GREG-DATE-CYMD-R REDEFINES
  3560                              DC-GREG-DATE-CYMD.
  3561             20  DC-CYMD-CEN           PIC 99.
  3562             20  DC-CYMD-YEAR          PIC 99.
  3563             20  DC-CYMD-MONTH         PIC 99.
  3564             20  DC-CYMD-DAY           PIC 99.
  3565         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3566         16  DC-GREG-DATE-MDCY-R REDEFINES
  3567                              DC-GREG-DATE-MDCY.
  3568             20  DC-MDCY-MONTH         PIC 99.
  3569             20  DC-MDCY-DAY           PIC 99.
  3570             20  DC-MDCY-CEN           PIC 99.
  3571             20  DC-MDCY-YEAR          PIC 99.
  3572    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3573        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3574    12  DC-EL310-DATE                  PIC X(21).
  3575    12  FILLER                         PIC X(28).
  3576*                                 COPY ELCCALC.
  3577******************************************************************
  3578*                                                                *
  3579*                           ELCCALC.                            *
  3580*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3581*                            VMOD=2.025                          *
  3582*                                                                *
  3583*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3584*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3585*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3586*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3587*                                                                *
  3588*  PASSED TO ELRTRM                                              *
  3589*  -----------------                                             *
  3590*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3591*  ORIGINAL TERM                                                 *
  3592*  BEGINNING DATE                                                *
  3593*  ENDING DATE                                                   *
  3594*  COMPANY I.D.                                                  *
  3595*  ACCOUNT MASTER USER FIELD                                     *
  3596*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3597*  FREE LOOK DAYS                                                *
  3598*                                                                *
  3599*  RETURNED FROM ELRTRM                                          *
  3600*  ---------------------                                         *
  3601*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3602*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3603*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3604*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3605*----------------------------------------------------------------*
  3606*  PASSED TO ELRAMT                                              *
  3607*  ----------------                                              *
  3608*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3609*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  64
* SOCK03.cbl
  3610*  ORIGINAL AMOUNT                                               *
  3611*  ALTERNATE BENEFIT (BALLON)                                    *
  3612*  A.P.R. - NET PAY ONLY                                         *
  3613*  METHOD
  3614*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3615*  COMPANY I.D.                                                  *
  3616*  BENEFIT TYPE                                                  *
  3617*                                                                *
  3618*  RETURNED FROM ELRAMT                                          *
  3619*  --------------------                                          *
  3620*  REMAINING AMOUNT 1 - CURRENT                                  *
  3621*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3622*  REMAINING AMOUNT FACTOR
  3623*----------------------------------------------------------------*
  3624*  PASSED TO ELRESV                                              *
  3625*  -----------------                                             *
  3626*  CERTIFICATE EFFECTIVE DATE                                    *
  3627*  VALUATION DATE                                                *
  3628*  PAID THRU DATE                                                *
  3629*  BENEFIT                                                       *
  3630*  INCURRED DATE                                                 *
  3631*  REPORTED DATE                                                 *
  3632*  ISSUE AGE                                                     *
  3633*  TERM                                                          *
  3634*  CDT PERCENT                                                   *
  3635*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3636* *CLAIM TYPE (LIFE, A/H)                                        *
  3637* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3638* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3639*                                                                *
  3640*  RETURNED FROM ELRESV                                          *
  3641*  --------------------                                          *
  3642*  CDT TABLE USED                                                *
  3643*  CDT FACTOR USED                                               *
  3644*  PAY TO CURRENT RESERVE                                        *
  3645*  I.B.N.R. - A/H ONLY                                           *
  3646*  FUTURE (ACCRUED) AH ONLY                                      *
  3647*----------------------------------------------------------------*
  3648*  PASSED TO ELRATE                                              *
  3649*  ----------------                                              *
  3650*  CERT ISSUE DATE                                               *
  3651*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3652*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3653*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3654*  STATE CODE (CLIENT DEFINED)                                   *
  3655*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3656*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3657*  DEVIATION CODE                                                *
  3658*  ISSUE AGE                                                     *
  3659*  ORIGINAL BENEFIT AMOUNT                                       *
  3660*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3661*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3662*  BENEFIT KIND (LIFE OR A/H)                                    *
  3663*  A.P.R.                                                        *
  3664*  METHOD
  3665*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3666*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3667*  COMPANY I.D. (3 CHARACTER)                                    *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  65
* SOCK03.cbl
  3668*  BENEFIT CODE                                                  *
  3669*  BENEFIT OVERRIDE CODE                                         *
  3670*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3671*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3672*  JOINT INDICATOR (CSL ONLY)                                    *
  3673*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3674*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3675*                                                                *
  3676*  RETURNED FROM ELRATE                                          *
  3677*  --------------------                                          *
  3678*  CALCULATED PREMIUM                                            *
  3679*  PREMIUM RATE                                                  *
  3680*  MORTALITY CODE                                                *
  3681*  MAX ATTAINED AGE                                              *
  3682*  MAX AGE                                                       *
  3683*  MAX TERM                                                      *
  3684*  MAX MONTHLY BENEFIT                                           *
  3685*  MAX TOTAL BENIFIT                                             *
  3686*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3687*----------------------------------------------------------------*
  3688*  PASSED TO ELRFND                                              *
  3689*  ----------------                                              *
  3690*  CERT ISSUE DATE                                               *
  3691*  REFUND DATE                                                   *
  3692*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3693*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3694*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3695*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3696*  STATE CODE (CLIENT DEFINED)                                   *
  3697*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3698*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3699*  DEVIATION CODE                                                *
  3700*  ISSUE AGE                                                     *
  3701*  ORIGINAL BENEFIT AMOUNT                                       *
  3702*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3703*  PROCESS TYPE (CANCEL)                                         *
  3704*  BENEFIT KIND (LIFE OR A/H)                                    *
  3705*  A.P.R.                                                        *
  3706*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3707*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3708*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3709*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3710*  COMPANY I.D. (3 CHARACTER)                                    *
  3711*  BENEFIT CODE                                                  *
  3712*  BENEFIT OVERRIDE CODE                                         *
  3713*                                                                *
  3714*  RETURNED FROM ELRFND                                          *
  3715*  --------------------                                          *
  3716*  CALCULATED REFUND                                             *
  3717*----------------------------------------------------------------*
  3718*  PASSED TO ELEARN                                              *
  3719*  ----------------                                              *
  3720*  CERT ISSUE DATE                                               *
  3721*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3722*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3723*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3724*  STATE CODE (CLIENT DEFINED)                                   *
  3725*  STATE CODE (STANDARD P.O. ABBRV)                              *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  66
* SOCK03.cbl
  3726*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3727*  DEVIATION CODE                                                *
  3728*  ISSUE AGE                                                     *
  3729*  ORIGINAL BENEFIT AMOUNT                                       *
  3730*  BENEFIT KIND (LIFE OR A/H)                                    *
  3731*  A.P.R.                                                        *
  3732*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3733*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3734*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3735*  COMPANY I.D. (3 CHARACTER)                                    *
  3736*  BENEFIT CODE                                                  *
  3737*  BENEFIT OVERRIDE CODE                                         *
  3738*                                                                *
  3739*  RETURNED FROM ELEARN                                          *
  3740*  --------------------                                          *
  3741*  INDICATED  EARNINGS                                           *
  3742*----------------------------------------------------------------*
  3743*                 LENGTH = 450                                   *
  3744*                                                                *
  3745******************************************************************
  3746******************************************************************
  3747*                   C H A N G E   L O G
  3748*
  3749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3750*-----------------------------------------------------------------
  3751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3752* EFFECTIVE    NUMBER
  3753*-----------------------------------------------------------------
  3754* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3755* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3756* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3757* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3758* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3759* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3760* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3761* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3762* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3763* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3764* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3765******************************************************************
  3766
  3767 01  CALCULATION-PASS-AREA.
  3768     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3769                                     COMP.
  3770
  3771     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3772       88  NO-CP-ERROR                             VALUE ZERO.
  3773       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3774                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3775       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3776       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3777       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3778       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3779       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3780       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3781       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3782       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3783       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  67
* SOCK03.cbl
  3784       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3785       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3786       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3787       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3788       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3789       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3790       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3791       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3792
  3793     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3794       88  NO-CP-ERROR-2                           VALUE ZERO.
  3795***********************  INPUT AREAS ****************************
  3796
  3797     12  CP-CALCULATION-AREA.
  3798         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3799         16  CP-CERT-EFF-DT        PIC XX.
  3800         16  CP-VALUATION-DT       PIC XX.
  3801         16  CP-PAID-THRU-DT       PIC XX.
  3802         16  CP-BENEFIT-TYPE       PIC X.
  3803           88  CP-AH                               VALUE 'A' 'D'
  3804                                                   'I' 'U'.
  3805           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3806           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3807         16  CP-INCURRED-DT        PIC XX.
  3808         16  CP-REPORTED-DT        PIC XX.
  3809         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3810         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3811         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-CDT-METHOD         PIC X.
  3816           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3817           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3818           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3819         16  CP-CLAIM-TYPE         PIC X.
  3820           88  CP-AH-CLAIM                         VALUE 'A'.
  3821           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3822         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-REM-TERM-METHOD    PIC X.
  3837           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3838           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3839           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3840           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3841           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  68
* SOCK03.cbl
  3842           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3843           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3844         16  CP-EARNING-METHOD     PIC X.
  3845           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3846           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3847           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3848           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3849           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3850           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3851           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3852           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3853           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3854           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3855           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3856           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3857           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3858           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3859         16  CP-PROCESS-TYPE       PIC X.
  3860           88  CP-CLAIM                            VALUE '1'.
  3861           88  CP-CANCEL                           VALUE '2'.
  3862           88  CP-ISSUE                            VALUE '3'.
  3863         16  CP-SPECIAL-CALC-CD    PIC X.
  3864           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3865           88  CP-1-MTH-INTEREST               VALUE ' '.
  3866           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3867           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3868           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3869           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3870           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3871           88  CP-FARM-PLAN                    VALUE 'F'.
  3872           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3873           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3874           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3875           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3876           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3877           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3878           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3879           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3880           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3881           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3882                                                     'W' 'X'.
  3883           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3884           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3885           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3886           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3887           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3888           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3889           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3890           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3891           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3892           88  CP-CSL-METH-1                   VALUE '5'.
  3893           88  CP-CSL-METH-2                   VALUE '6'.
  3894           88  CP-CSL-METH-3                   VALUE '7'.
  3895           88  CP-CSL-METH-4                   VALUE '8'.
  3896
  3897         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3898                                     COMP-3.
  3899         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  69
* SOCK03.cbl
  3900         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3901         16  CP-STATE              PIC XX          VALUE SPACE.
  3902         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3903         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3904           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3905               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3906         16  CP-R78-OPTION         PIC X.
  3907           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3908           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3909
  3910         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3911         16  CP-IBNR-RESERVE-SW    PIC X.
  3912         16  CP-CLAIM-STATUS       PIC X.
  3913         16  CP-RATE-FILE          PIC X.
  3914         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3915                                     COMP-3.
  3916
  3917         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3918         16  CP-AH-OVERRIDE-CODE   PIC X.
  3919
  3920         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3923                                   PIC S9(5)V99 COMP-3.
  3924         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3925                                     COMP-3.
  3926         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3927                                     COMP-3.
  3928         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3929                                     COMP-3.
  3930         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3931                                  PIC S9(7)V99 COMP-3.
  3932
  3933         16  CP-PAID-FROM-DATE     PIC X(02).
  3934         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3935         16  CP-EXT-DAYS-CALC      PIC X.
  3936           88  CP-EXT-NO-CHG                   VALUE ' '.
  3937           88  CP-EXT-CHG-LF                   VALUE '1'.
  3938           88  CP-EXT-CHG-AH                   VALUE '2'.
  3939           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3940         16  CP-DOMICILE-STATE     PIC XX.
  3941         16  CP-CARRIER            PIC X.
  3942         16  CP-REIN-FLAG          PIC X.
  3943         16  CP-REM-TRM-CALC-OPTION PIC X.
  3944           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3945                      '2' '3' '4' '5'.
  3946           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3947           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3948           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3949           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3950           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3951           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3952           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3953           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3954         16  CP-SIG-SWITCH         PIC X.
  3955         16  CP-RATING-METHOD      PIC X.
  3956           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3957           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  70
* SOCK03.cbl
  3958           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3959           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3960           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3961           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3962           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3963           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3964           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3965         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3966                                     COMP-3.
  3967         16  CP-BEN-CATEGORY       PIC X.
  3968         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3969         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3970                                   PIC S99V9(5) COMP-3.
  3971         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3972         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3973                                   PIC S99V9(5) COMP-3.
  3974         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3975         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3976         16  CP-EXPIRE-DT          PIC XX.
  3977         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3978         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3979         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3980         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3981         16  CP-DDF-SPEC-CALC      PIC X.
  3982             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3983             88  CP-CALC-CLP              VALUE 'C'.
  3984         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3985         16  CP-CANCEL-REASON      PIC X.
  3986         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3987         16  CP-PMT-MODE           PIC X.
  3988         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3989         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3990         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3991         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3992         16  FILLER                PIC X.
  3993
  3994***************    OUTPUT FROM ELRESV   ************************
  3995
  3996         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3997
  3998         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3999                                     COMP-3.
  4000         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  4001                                     COMP-3.
  4002         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  4003                                     COMP-3.
  4004         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4005                                     COMP-3.
  4006         16  FILLER                PIC X(09).
  4007***************    OUTPUT FROM ELRTRM   *************************
  4008
  4009         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4010                                     COMP-3.
  4011         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4012                                     COMP-3.
  4013         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4014                                     COMP-3.
  4015         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  71
* SOCK03.cbl
  4016                                     COMP-3.
  4017         16  FILLER                PIC X(12).
  4018
  4019***************    OUTPUT FROM ELRAMT   *************************
  4020
  4021         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4022                                     COMP-3.
  4023         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4024                                     COMP-3.
  4025         16  FILLER                PIC X(12).
  4026
  4027***************    OUTPUT FROM ELRATE   *************************
  4028
  4029         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4030                                     COMP-3.
  4031         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4032                                     COMP-3.
  4033         16  CP-MORTALITY-CODE     PIC X(4).
  4034         16  CP-RATE-EDIT-FLAG     PIC X.
  4035             88  CP-RATES-NEED-APR                  VALUE '1'.
  4036         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4037                                     COMP-3.
  4038         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4039         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4040         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4041                                   PIC S9(7)V99 COMP-3.
  4042         16  FILLER                PIC X(07).
  4043
  4044***************    OUTPUT FROM ELRFND   *************************
  4045
  4046         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4047                                     COMP-3.
  4048         16  CP-REFUND-TYPE-USED   PIC X.
  4049           88  CP-R-AS-R78                         VALUE '1'.
  4050           88  CP-R-AS-PRORATA                     VALUE '2'.
  4051           88  CP-R-AS-CALIF                       VALUE '3'.
  4052           88  CP-R-AS-TEXAS                       VALUE '4'.
  4053           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4054           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4055           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4056           88  CP-R-AS-MEAN                        VALUE '8'.
  4057           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4058           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4059           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4060           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4061           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4062           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4063         16  FILLER                PIC X(12).
  4064
  4065***************    OUTPUT FROM ELEARN   *************************
  4066
  4067         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4068                                     COMP-3.
  4069         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4070                                     COMP-3.
  4071         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4072                                     COMP-3.
  4073         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  72
* SOCK03.cbl
  4074                                     COMP-3.
  4075         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4076                                     COMP-3.
  4077         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4078                                     COMP-3.
  4079         16  CP-EARNING-TYPE-USED  PIC X.
  4080           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4081           88  CP-E-AS-R78                         VALUE '1'.
  4082           88  CP-E-AS-PRORATA                     VALUE '2'.
  4083           88  CP-E-AS-TEXAS                       VALUE '4'.
  4084           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4085           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4086           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4087           88  CP-E-AS-MEAN                        VALUE '8'.
  4088           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4089         16  FILLER                PIC X(12).
  4090
  4091***************    OUTPUT FROM ELPMNT   *************************
  4092
  4093         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4094                                     COMP-3.
  4095         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4096                                     COMP-3.
  4097         16  FILLER                PIC X(12).
  4098
  4099***************   MISC WORK AREAS    *****************************
  4100         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4101                                     COMP-3.
  4102         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4103                                     COMP-3.
  4104         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4105                                     COMP-3.
  4106         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4107                                     COMP-3.
  4108         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4109                                     COMP-3.
  4110         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4111                                     COMP-3.
  4112         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4113             88  OPEN-RATE-FILE                   VALUE 'O'.
  4114             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4115             88  IO-ERROR                         VALUE 'E'.
  4116
  4117         16  CP-FIRST-PAY-DATE     PIC XX.
  4118
  4119         16  CP-JOINT-INDICATOR    PIC X.
  4120
  4121         16  CP-RESERVE-REMAINING-TERM
  4122                                   PIC S9(4)V9    VALUE ZERO
  4123                                     COMP-3.
  4124
  4125         16  CP-INSURED-BIRTH-DT   PIC XX.
  4126
  4127         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4128                                     COMP-3.
  4129
  4130         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4131                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  73
* SOCK03.cbl
  4132
  4133         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4134                                     COMP-3.
  4135
  4136         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4137                                     COMP-3.
  4138
  4139         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4140                                     COMP-3.
  4141
  4142         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4143                                     COMP-3.
  4144
  4145         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4146                                     COMP-3.
  4147
  4148         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4149             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4150
  4151         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4152                                     COMP-3.
  4153         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4154                                     COMP-3.
  4155         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4156         16  cp-extra-periods      pic 9 value zeros.
  4157         16  cp-net-only-state     pic x value spaces.
  4158         16  FILLER                PIC X(13).
  4159******************************************************************
  4160****************************************************************
  4161*
  4162* Copyright (c) 2007-2013 Dell Inc.
  4163* All rights reserved.
  4164*
  4165****************************************************************
  4166 01  DFHEIV.
  4167   02  DFHEIV0               PIC X(35).
  4168   02  DFHEIV1               PIC X(08).
  4169   02  DFHEIV2               PIC X(08).
  4170   02  DFHEIV3               PIC X(08).
  4171   02  DFHEIV4               PIC X(06).
  4172   02  DFHEIV5               PIC X(04).
  4173   02  DFHEIV6               PIC X(04).
  4174   02  DFHEIV7               PIC X(02).
  4175   02  DFHEIV8               PIC X(02).
  4176   02  DFHEIV9               PIC X(01).
  4177   02  DFHEIV10              PIC S9(7) COMP-3.
  4178   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4179   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4180   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4181   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4182   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4183   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4184   02  DFHEIV17              PIC X(04).
  4185   02  DFHEIV18              PIC X(04).
  4186   02  DFHEIV19              PIC X(04).
  4187   02  DFHEIV20              USAGE IS POINTER.
  4188   02  DFHEIV21              USAGE IS POINTER.
  4189   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  74
* SOCK03.cbl
  4190   02  DFHEIV23              USAGE IS POINTER.
  4191   02  DFHEIV24              USAGE IS POINTER.
  4192   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4193   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4194   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4195   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4196   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4197   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4198   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4199   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4200   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4201   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4202   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4203   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4204   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4205   02  FILLER                PIC X(02).
  4206   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4207   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4208   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4209   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4210   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4211   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4212   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4213 LINKAGE  SECTION.
  4214*****************************************************************
  4215*                                                               *
  4216* Copyright (c) 2007-2013 Dell Inc.                             *
  4217* All rights reserved.                                          *
  4218*                                                               *
  4219*****************************************************************
  4220 01  dfheiblk.
  4221     02  eibtime          pic s9(7) comp-3.
  4222     02  eibdate          pic s9(7) comp-3.
  4223     02  eibtrnid         pic x(4).
  4224     02  eibtaskn         pic s9(7) comp-3.
  4225     02  eibtrmid         pic x(4).
  4226     02  dfheigdi         pic s9(4) comp.
  4227     02  eibcposn         pic s9(4) comp.
  4228     02  eibcalen         pic s9(4) comp.
  4229     02  eibaid           pic x(1).
  4230     02  eibfiller1       pic x(1).
  4231     02  eibfn            pic x(2).
  4232     02  eibfiller2       pic x(2).
  4233     02  eibrcode         pic x(6).
  4234     02  eibfiller3       pic x(2).
  4235     02  eibds            pic x(8).
  4236     02  eibreqid         pic x(8).
  4237     02  eibrsrce         pic x(8).
  4238     02  eibsync          pic x(1).
  4239     02  eibfree          pic x(1).
  4240     02  eibrecv          pic x(1).
  4241     02  eibsend          pic x(1).
  4242     02  eibatt           pic x(1).
  4243     02  eibeoc           pic x(1).
  4244     02  eibfmh           pic x(1).
  4245     02  eibcompl         pic x(1).
  4246     02  eibsig           pic x(1).
  4247     02  eibconf          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  75
* SOCK03.cbl
  4248     02  eiberr           pic x(1).
  4249     02  eibrldbk         pic x(1).
  4250     02  eiberrcd         pic x(4).
  4251     02  eibsynrb         pic x(1).
  4252     02  eibnodat         pic x(1).
  4253     02  eibfiller5       pic x(2).
  4254     02  eibresp          pic s9(8) comp.
  4255     02  eibresp2         pic s9(8) comp.
  4256     02  dfheigdj         pic s9(4) comp.
  4257     02  dfheigdk         pic s9(4) comp.
  4258 01  DFHCOMMAREA.
  4259   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4260   05 LSTN-NAME                PIC X(8).
  4261   05 LSTN-SUBNAME             PIC X(8).
  4262   05 CLIENT-IN-DATA.
  4263      15  CLIENT-CAR           PIC X.
  4264      15  CLIENT-GRP           PIC X(6).
  4265      15  CLIENT-STATE         PIC XX.
  4266      15  CLIENT-ACCOUNT       PIC X(10).
  4267      15  CLIENT-EFF-DT        PIC X(8).  *> ccyymmdd
  4268      15  CLIENT-CERT-NO       PIC X(11).
  4269      15  CLIENT-LAST-NAME     PIC X(15).
  4270      15  CLIENT-FIRST-NAME    PIC X(10).
  4271      15  CLIENT-VAL-DT        PIC X(8).  *> ccyymmdd
  4272      15  CLIENT-CAN-REASON    PIC X.
  4273      15  client-vin           pic x(17).
  4274   05 SOCKADDR-IN-PARM.
  4275     15 SIN-FAMILY             PIC 9(4) COMP.
  4276     15 SIN-PORT               PIC 9(4) COMP.
  4277     15 SIN-ADDRESS            PIC 9(8) COMP.
  4278     15 SIN-ZERO               PIC X(8).
  4279 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4280 0000-DFHEXIT SECTION.
  4281     MOVE '9#                    $   ' TO DFHEIV0.
  4282     MOVE 'SOCK03' TO DFHEIV1.
  4283     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4284     display '  BEGIN SOCK03 '
  4285     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4286     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4287     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4288        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4289        evaluate true
  4290           when client-in-data (8:3) = 'AHL'
  4291              MOVE X'06'         TO WS-COMP-CD
  4292              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4293                                    WS-COMP-ID
  4294           when CLIENT-IN-DATA (8:3) = 'DCC'
  4295              MOVE X'05'         TO WS-COMP-CD
  4296              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4297                                    WS-COMP-ID
  4298           when CLIENT-IN-DATA (8:3) = 'VPP'
  4299              MOVE X'07'         TO WS-COMP-CD
  4300              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4301                                    WS-COMP-ID
  4302           when other
  4303              MOVE X'04'         TO WS-COMP-CD
  4304              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  4305                                    WS-COMP-ID
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  76
* SOCK03.cbl
  4306        end-evaluate
  4307        move 'CSO'               to ws-send-buf (1:3)
  4308        move +25                 to ws-send-msg-size
  4309     END-IF
  4310     display 'SOCK03:sequence number  =', ws-seq-num.
  4311     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4312     call "send" using by value GIVE-TAKE-SOCKET,
  4313         by reference ws-send-buf,
  4314         by value ws-send-msg-size,
  4315         by value ws-flags.
  4316     if return-code <= zero
  4317         display 'SOCK03:send error ',
  4318         go to socket-error.
  4319     move low-values to ws-recv-buf.
  4320     set ws-recv-total to zero.
  4321     compute ws-recv-left = ws-recv-msg-size.
  4322     display 'SOCK03:About to recv '
  4323     call "recv" using by value GIVE-TAKE-SOCKET,
  4324         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4325         by value ws-recv-left,
  4326         by value ws-flags.
  4327     if return-code < zero
  4328        display 'SOCK03:recv error ',
  4329        go to socket-error.
  4330     if return-code = zero
  4331        display 'SOCK03:client disconnected',
  4332        go to socket-error.
  4333*
  4334     display 'SOCK03:Good recv  '
  4335     display 'SOCK03:return code      = ', return-code
  4336     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:89)
  4337     move +4096                  to ws-send-msg-size
  4338*    move +750                   to ws-send-msg-size
  4339     move ws-recv-buf (1:89)     to client-in-data
  4340     MOVE SPACES                 TO WS-ELCERT-SW
  4341     MOVE X'0A'                  TO WS-HEX-0A
  4342     if client-account = 'EPIQ000001'
  4343        set ws-epiq-request to true
  4344        move spaces              to client-account
  4345     end-if
  4346     move +0 to ws-epiq-max
  4347     EVALUATE TRUE
  4348        WHEN (CLIENT-CAR NOT = SPACES)
  4349           AND (CLIENT-STATE NOT = SPACES)
  4350           AND (CLIENT-ACCOUNT NOT = SPACES)
  4351           AND (CLIENT-EFF-DT NOT = SPACES)
  4352           AND (CLIENT-CERT-NO NOT = SPACES)
  4353           SET WS-ELCERT-FULL    TO TRUE
  4354           DISPLAY ' SETTING FULL '
  4355        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4356           SET WS-ELCERT-CERT-NO TO TRUE
  4357           DISPLAY ' SETTING CERT NO '
  4358*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4359*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4360        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4361           AND (CLIENT-LAST-NAME NOT = SPACES)
  4362           SET WS-ELCERT-ACT-NAME TO TRUE
  4363        WHEN CLIENT-LAST-NAME NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  77
* SOCK03.cbl
  4364           SET WS-ELCERT-NAME    TO TRUE
  4365           DISPLAY ' SETTING NAME '
  4366        when (client-vin not = spaces)
  4367           and (client-state not = spaces)
  4368           and (client-account not = spaces)
  4369           set ws-elcert-vin to true
  4370           display ' SETTING VIN '
  4371        WHEN OTHER
  4372           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4373           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4374           MOVE ZEROS            TO WS-RESP
  4375           PERFORM 0030-BUILD-BUFFER
  4376                                 THRU 0030-EXIT
  4377           PERFORM 0020-SEND-BUFFER
  4378                                 THRU 0020-EXIT
  4379           PERFORM 0025-CLOSE-SOCKET
  4380                                 THRU 0025-EXIT
  4381           GO TO 0010-RETURN
  4382     END-EVALUATE
  4383     IF CLIENT-CAN-REASON = 'R'
  4384        MOVE 'R'                 TO WS-CANCEL-REASON
  4385     ELSE
  4386        MOVE ' '                 TO WS-CANCEL-REASON
  4387     END-IF
  4388     IF WS-ELCERT-KEY-SW NOT = SPACES
  4389        PERFORM 0050-BEGIN-REFUND-PROCESS
  4390                                 THRU 0050-EXIT
  4391     END-IF
  4392     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4393     .
  4394 0010-RETURN.
  4395
  4396* exec cics return end-exec.
  4397*    MOVE '.(                    ''   #00004391' TO DFHEIV0
  4398     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4400     MOVE X'2020233030303034333931' TO DFHEIV0(25:11)
  4401     CALL 'kxdfhei1' USING DFHEIV0,
  4402           DFHEIV99,
  4403           DFHEIV99,
  4404           DFHEIV99,
  4405           DFHEIV99,
  4406           DFHEIV99,
  4407           DFHEIV99
  4408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4409
  4410
  4411* goback.
  4412     MOVE '9%                    "   ' TO DFHEIV0
  4413     MOVE 'SOCK03' TO DFHEIV1
  4414     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4415     goback.
  4416*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4417     .
  4418 0020-SEND-BUFFER.
  4419     display 'SOCK03:About to send      '
  4420     display 'SOCK03:sequence number  =', ws-seq-num.
  4421     display 'SOCK03:send buffer      =', ws-send-buf(1:500).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  78
* SOCK03.cbl
  4422     call "send" using by value GIVE-TAKE-SOCKET,
  4423         by reference ws-send-buf,
  4424         by value ws-send-msg-size,
  4425         by value ws-flags.
  4426     if return-code <= zero
  4427         display 'SOCK03:send error ' return-code,
  4428         go to socket-error.
  4429 0020-EXIT.
  4430     EXIT.
  4431 0025-CLOSE-SOCKET.
  4432*    display 'SOCK03:closing socket'.
  4433*    call "close" using by value GIVE-TAKE-SOCKET .
  4434     display 'SOCK03:done'.
  4435     .
  4436 0025-EXIT.
  4437     EXIT.
  4438*
  4439* set up the receive buffer
  4440*
  4441     move low-values to ws-recv-buf.
  4442     set ws-recv-total to zero.
  4443     compute ws-recv-left = ws-recv-msg-size.
  4444*
  4445* receive data
  4446*
  4447 recv-1.
  4448     call "recv" using by value GIVE-TAKE-SOCKET,
  4449         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4450         by value ws-recv-left,
  4451         by value ws-flags.
  4452*
  4453* test what was received and decide what we should do
  4454*
  4455     if return-code < zero
  4456        display 'SOCK03:recv error ',
  4457        go to socket-error.
  4458     if return-code = zero
  4459        display 'SOCK03:client disconnected',
  4460        go to socket-error.
  4461*
  4462* have we received all the data yet?
  4463*
  4464     compute ws-recv-total = ws-recv-total + return-code.
  4465     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4466*
  4467* not yet
  4468*
  4469     if ws-recv-left > 0 go to recv-1.
  4470*
  4471* received all the data
  4472*
  4473     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4474*
  4475* make sure what we received was what we sent
  4476*
  4477*    if ws-recv-buf <> ws-send-buf
  4478*        display "SOCK03:data doesn't match",
  4479*        go to socket-error.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  79
* SOCK03.cbl
  4480*
  4481* end of pass
  4482*
  4483*loop-end.
  4484*    if ws-seq-num = 5 go to socket-error.
  4485*    go to loop-1.
  4486*
  4487* program end
  4488*
  4489 socket-error.
  4490     if ws-seq-num <> 0
  4491         display "SOCK03:did not complete".
  4492*
  4493* flush the send buffer and deallocate
  4494*
  4495*    display 'SOCK03:closing socket'.
  4496*    call "close" using by value GIVE-TAKE-SOCKET .
  4497*
  4498* finised return to cics
  4499*
  4500 socket-fin.
  4501*    display 'SOCK03:closing socket'.
  4502*    call "close" using by value GIVE-TAKE-SOCKET .
  4503     display 'SOCK03:done'.
  4504
  4505* exec cics return end-exec.
  4506*    MOVE '.(                    ''   #00004481' TO DFHEIV0
  4507     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4508     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4509     MOVE X'2020233030303034343831' TO DFHEIV0(25:11)
  4510     CALL 'kxdfhei1' USING DFHEIV0,
  4511           DFHEIV99,
  4512           DFHEIV99,
  4513           DFHEIV99,
  4514           DFHEIV99,
  4515           DFHEIV99,
  4516           DFHEIV99
  4517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4518
  4519
  4520* goback.
  4521     MOVE '9%                    "   ' TO DFHEIV0
  4522     MOVE 'SOCK03' TO DFHEIV1
  4523     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4524     goback.
  4525 0030-BUILD-BUFFER.
  4526     MOVE SPACES                 TO WS-SEND-BUF
  4527     IF WS-CALL-TYPE = 'NEWBUS'
  4528        STRING
  4529           WS-COMMENT            ';'
  4530           WS-RESP               ';'
  4531           WS-CARRIER            ';'
  4532           WS-GROUPING           ';'
  4533           WS-STATE              ';'
  4534           WS-ACCOUNT            ';'
  4535           WS-CERT-EFF-DATE      ';'
  4536           WS-CERT-NO            ';'
  4537           WS-LAST-NAME          ';'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  80
* SOCK03.cbl
  4538           WS-FIRST-NAME         ';'
  4539           WS-MID-INIT           ';'
  4540           WS-LAST-JNAME         ';'
  4541           WS-FIRST-JNAME        ';'
  4542           WS-MID-JINIT          ';'
  4543           WS-POST-CARD-SW       ';'
  4544           ws-lf-coverage-type   ';'
  4545           WS-LF-STATUS          ';'
  4546           WS-LF-BEN-CODE        ';'
  4547           WS-LF-BEN-CODE-DESC   ';'
  4548           WS-LF-TERM            ';'
  4549           WS-LF-REM-TERM        ';'
  4550           WS-LF-PREM            ';'
  4551           WS-LF-REFUND          ';'
  4552           WS-LF-METHOD          ';'
  4553           WS-LF-ORIG-BENEFIT    ';'
  4554           WS-LF-REM-BEN         ';'
  4555           WS-LF-EXPIRE-DATE     ';'
  4556           WS-LF-COMM            ';'
  4557           WS-LF-UEC             ';'
  4558           WS-AH-COVERAGE-TYPE   ';'
  4559           WS-AH-STATUS          ';'
  4560           WS-AH-BEN-CODE        ';'
  4561           WS-AH-BEN-CODE-DESC   ';'
  4562           WS-AH-TERM            ';'
  4563           WS-AH-REM-TERM        ';'
  4564           WS-AH-PREM            ';'
  4565           WS-AH-REFUND          ';'
  4566           WS-AH-METHOD          ';'
  4567           WS-AH-ORIG-BENEFIT    ';'
  4568           WS-AH-REM-BEN         ';'
  4569           WS-AH-EXPIRE-DATE     ';'
  4570           WS-AH-COMM            ';'
  4571           WS-AH-UEC             ';'
  4572           WS-ACCOUNT-NAME       ';'
  4573           WS-REPORT-CODE-1      ';'
  4574           WS-REPORT-CODE-2      ';'
  4575           WS-REPORT-CODE-3      ';'
  4576           WS-CLM-PAID-THRU-DT   ';'
  4577           WS-LF-CANCEL-DATE     ';'
  4578           WS-AH-CANCEL-DATE     ';'
  4579           WS-VIN                ';'
  4580           WS-CRED-BENE-NAME     ';'
  4581           WS-HEX-0A
  4582            DELIMITED BY '  ' INTO WS-SEND-BUF
  4583        END-STRING
  4584     ELSE
  4585        STRING
  4586           WS-COMMENT            ';'  *> 0
  4587           WS-RESP               ';'
  4588           WS-CARRIER            ';'
  4589           WS-GROUPING           ';'
  4590           WS-STATE              ';'
  4591           WS-ACCOUNT            ';'
  4592           WS-CERT-EFF-DATE      ';'
  4593           WS-CERT-NO            ';'
  4594           WS-LAST-NAME          ';'
  4595           WS-FIRST-NAME         ';'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  81
* SOCK03.cbl
  4596           WS-MID-INIT           ';'
  4597           WS-LAST-JNAME         ';'
  4598           WS-FIRST-JNAME        ';'
  4599           WS-MID-JINIT          ';'
  4600           WS-POST-CARD-SW       ';'
  4601           WS-LF-STATUS          ';'
  4602           WS-LF-BEN-CODE        ';'  *> 16
  4603           WS-LF-BEN-CODE-DESC   ';'
  4604           WS-LF-TERM            ';'
  4605           WS-LF-REM-TERM        ';'
  4606           WS-LF-PREM            ';'
  4607           WS-LF-REFUND          ';'
  4608           WS-LF-METHOD          ';'
  4609           WS-LF-ORIG-BENEFIT    ';'
  4610           WS-LF-REM-BEN         ';'
  4611           WS-LF-EXPIRE-DATE     ';'
  4612           WS-LF-COMM            ';'
  4613           WS-LF-UEC             ';'
  4614           WS-AH-STATUS          ';'
  4615           WS-AH-BEN-CODE        ';'   *> 29
  4616           WS-AH-BEN-CODE-DESC   ';'
  4617           WS-AH-TERM            ';'
  4618           WS-AH-REM-TERM        ';'
  4619           WS-AH-PREM            ';'   *> 32
  4620           WS-AH-REFUND          ';'   *> 33
  4621           WS-AH-METHOD          ';'
  4622           WS-AH-ORIG-BENEFIT    ';'   *> 36
  4623           WS-AH-REM-BEN         ';'
  4624           WS-AH-EXPIRE-DATE     ';'
  4625           WS-AH-COMM            ';'
  4626           WS-AH-UEC             ';'
  4627           WS-ACCOUNT-NAME       ';'
  4628           WS-REPORT-CODE-1      ';'
  4629           WS-REPORT-CODE-2      ';'
  4630           WS-REPORT-CODE-3      ';'
  4631           WS-CLM-PAID-THRU-DT   ';'
  4632           WS-LF-CANCEL-DATE     ';'
  4633           WS-AH-CANCEL-DATE     ';'
  4634           WS-VIN                ';'
  4635           WS-CRED-BENE-NAME     ';'
  4636           'E'                   ';'
  4637            DELIMITED BY '  ' INTO WS-SEND-BUF
  4638        END-STRING
  4639     END-IF
  4640     .
  4641 0030-EXIT.
  4642     EXIT.
  4643 0040-search-elcrtt.
  4644
  4645     if client-state = 'KY'
  4646        move '8'                 to client-car
  4647     else
  4648        move '9'                 to client-car
  4649     end-if
  4650     move '000000'               to client-grp
  4651     move low-values             to ws-cs-key
  4652     move ws-comp-cd             to ws-cs-company-cd
  4653     move client-car             to ws-cs-carrier
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  82
* SOCK03.cbl
  4654     move client-grp             to ws-cs-group
  4655     move client-state           to ws-cs-state
  4656     move client-account         to ws-cs-account
  4657
  4658
  4659* EXEC CICS STARTBR
  4660*       DATASET ('ELCRTT')
  4661*       RIDFLD  (WS-CS-KEY)
  4662*       RESP    (WS-RESPONSE)
  4663*    END-EXEC
  4664     MOVE 'ELCRTT' TO DFHEIV1
  4665     MOVE 0
  4666       TO DFHEIV11
  4667*    MOVE '&,         G          &  N#00004616' TO DFHEIV0
  4668     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4669     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4670     MOVE X'204E233030303034363136' TO DFHEIV0(25:11)
  4671     CALL 'kxdfhei1' USING DFHEIV0,
  4672           DFHEIV1,
  4673           WS-CS-KEY,
  4674           DFHEIV99,
  4675           DFHEIV11,
  4676           DFHEIV99
  4677     MOVE EIBRESP  TO WS-RESPONSE
  4678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4679
  4680     IF NOT RESP-NORMAL
  4681        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4682        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4683        MOVE WS-RESPONSE         TO WS-RESP
  4684        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4685        PERFORM 0020-SEND-BUFFER
  4686                                 THRU 0020-EXIT
  4687        PERFORM 0025-CLOSE-SOCKET
  4688                                 THRU 0025-EXIT
  4689        GO TO 0010-RETURN
  4690     END-IF
  4691
  4692     MOVE ' '                    TO WS-STOP-SW
  4693     perform until told-to-stop
  4694
  4695* EXEC CICS READNEXT
  4696*          DATASET   ('ELCRTT')
  4697*          RIDFLD    (WS-CS-KEY)
  4698*          INTO      (CERTIFICATE-TRAILERS)
  4699*          RESP      (WS-RESPONSE)
  4700*       END-EXEC
  4701     MOVE LENGTH OF
  4702      CERTIFICATE-TRAILERS
  4703       TO DFHEIV12
  4704     MOVE 'ELCRTT' TO DFHEIV1
  4705     MOVE 0
  4706       TO DFHEIV11
  4707*    MOVE '&.IL                  )  N#00004636' TO DFHEIV0
  4708     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4709     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4710     MOVE X'204E233030303034363336' TO DFHEIV0(25:11)
  4711     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  83
* SOCK03.cbl
  4712           DFHEIV1,
  4713           CERTIFICATE-TRAILERS,
  4714           DFHEIV12,
  4715           WS-CS-KEY,
  4716           DFHEIV99,
  4717           DFHEIV11,
  4718           DFHEIV99,
  4719           DFHEIV99
  4720     MOVE EIBRESP  TO WS-RESPONSE
  4721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4722        evaluate true
  4723           when (cs-control-primary(2:19) <>
  4724                 client-in-data(1:19))
  4725              or (cs-company-cd <> ws-comp-cd)
  4726              or (not resp-normal)
  4727              set told-to-stop    to true
  4728           when (cs-trailer-type = 'C')
  4729              and (cs-vin-number = client-vin)
  4730              move cs-cert-eff-dt to ws-bin-eff-dt
  4731              move cs-cert-no     to client-cert-no
  4732              set told-to-stop    to true
  4733              set ws-elcert-full  to true
  4734           when (cs-trailer-type = 'C')
  4735              and (cs-vin-number(10:8) = client-vin(1:8))
  4736              move cs-cert-eff-dt to ws-bin-eff-dt
  4737              move cs-cert-no     to client-cert-no
  4738              set told-to-stop    to true
  4739              set ws-elcert-full  to true
  4740        end-evaluate
  4741     end-perform
  4742
  4743
  4744* EXEC CICS ENDBR
  4745*       DATASET   ('ELCRTT')
  4746*    END-EXEC
  4747     MOVE 'ELCRTT' TO DFHEIV1
  4748     MOVE 0
  4749       TO DFHEIV11
  4750*    MOVE '&2                    $   #00004663' TO DFHEIV0
  4751     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4752     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4753     MOVE X'2020233030303034363633' TO DFHEIV0(25:11)
  4754     CALL 'kxdfhei1' USING DFHEIV0,
  4755           DFHEIV1,
  4756           DFHEIV11,
  4757           DFHEIV99
  4758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4759
  4760     IF NOT WS-ELCERT-FULL
  4761        MOVE ' CERT NOT FOUND - VIN   ' TO WS-COMMENT
  4762        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4763        MOVE WS-RESPONSE         TO WS-RESP
  4764        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4765        PERFORM 0020-SEND-BUFFER
  4766                                 THRU 0020-EXIT
  4767        PERFORM 0025-CLOSE-SOCKET
  4768                                 THRU 0025-EXIT
  4769        GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  84
* SOCK03.cbl
  4770     END-IF
  4771
  4772     .
  4773 0040-exit.
  4774     exit.
  4775 0050-BEGIN-REFUND-PROCESS.
  4776     if ws-elcert-vin
  4777        perform 0040-search-elcrtt thru 0040-exit
  4778     end-if
  4779     IF WS-ELCERT-ACT-NAME
  4780        PERFORM 0060-FIND-FULL-KEY
  4781                                 THRU 0060-EXIT
  4782        MOVE AM-CARRIER          TO CLIENT-CAR
  4783        MOVE AM-GROUPING         TO CLIENT-GRP
  4784        MOVE AM-STATE            TO CLIENT-STATE
  4785     END-IF
  4786     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4787     IF NOT RESP-NORMAL
  4788        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4789        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4790        MOVE WS-RESPONSE         TO WS-RESP
  4791        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4792        PERFORM 0020-SEND-BUFFER
  4793                                 THRU 0020-EXIT
  4794        PERFORM 0025-CLOSE-SOCKET
  4795                                 THRU 0025-EXIT
  4796        GO TO 0010-RETURN
  4797     END-IF
  4798     PERFORM 0150-READ-NEXT-ELCERT
  4799                                 THRU 0150-EXIT
  4800*    display ' came back from 0150 ' ws-response
  4801     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4802        DISPLAY ' CERT NOT FOUND '
  4803        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4804        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4805        MOVE WS-RESPONSE         TO WS-RESP
  4806        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4807        PERFORM 0020-SEND-BUFFER
  4808                                 THRU 0020-EXIT
  4809        PERFORM 0025-CLOSE-SOCKET
  4810                                 THRU 0025-EXIT
  4811        GO TO 0010-RETURN
  4812     END-IF
  4813     PERFORM 0200-BEGIN-REFUND-PROCESS
  4814                                 THRU 0200-EXIT UNTIL
  4815        ELCERT-FINISHED
  4816     .
  4817 0050-EXIT.
  4818     EXIT.
  4819 0060-FIND-FULL-KEY.
  4820     MOVE ' ' TO WS-STOP-SW
  4821     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4822     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4823
  4824* EXEC CICS STARTBR
  4825*       DATASET  ('ERACCT3')
  4826*       RIDFLD   (WS-AM3-KEY)
  4827*       GTEQ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  85
* SOCK03.cbl
  4828*       RESP (WS-RESPONSE)
  4829*    END-EXEC
  4830     MOVE 'ERACCT3' TO DFHEIV1
  4831     MOVE 0
  4832       TO DFHEIV11
  4833*    MOVE '&,         G          &  N#00004730' TO DFHEIV0
  4834     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4836     MOVE X'204E233030303034373330' TO DFHEIV0(25:11)
  4837     CALL 'kxdfhei1' USING DFHEIV0,
  4838           DFHEIV1,
  4839           WS-AM3-KEY,
  4840           DFHEIV99,
  4841           DFHEIV11,
  4842           DFHEIV99
  4843     MOVE EIBRESP  TO WS-RESPONSE
  4844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4845     IF RESP-NORMAL
  4846        PERFORM UNTIL TOLD-TO-STOP
  4847
  4848* EXEC CICS READNEXT
  4849*             DATASET  ('ERACCT3')
  4850*             INTO     (ACCOUNT-MASTER)
  4851*             RIDFLD   (WS-AM3-KEY)
  4852*          END-EXEC
  4853     MOVE LENGTH OF
  4854      ACCOUNT-MASTER
  4855       TO DFHEIV12
  4856     MOVE 'ERACCT3' TO DFHEIV1
  4857     MOVE 0
  4858       TO DFHEIV11
  4859*    MOVE '&.IL                  )   #00004738' TO DFHEIV0
  4860     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4861     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4862     MOVE X'2020233030303034373338' TO DFHEIV0(25:11)
  4863     CALL 'kxdfhei1' USING DFHEIV0,
  4864           DFHEIV1,
  4865           ACCOUNT-MASTER,
  4866           DFHEIV12,
  4867           WS-AM3-KEY,
  4868           DFHEIV99,
  4869           DFHEIV11,
  4870           DFHEIV99,
  4871           DFHEIV99
  4872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4873           EVALUATE TRUE
  4874              WHEN (RESP-NORMAL)
  4875                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4876                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4877                 SET TOLD-TO-STOP TO TRUE
  4878              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4879                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4880                 CONTINUE
  4881              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4882                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4883                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4884                 MOVE ZEROS      TO WS-RESP
  4885                 PERFORM 0030-BUILD-BUFFER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  86
* SOCK03.cbl
  4886                                 THRU 0030-EXIT
  4887                 PERFORM 0020-SEND-BUFFER
  4888                                 THRU 0020-EXIT
  4889                 PERFORM 0025-CLOSE-SOCKET
  4890                                 THRU 0025-EXIT
  4891                 GO TO 0010-RETURN
  4892           END-EVALUATE
  4893        END-PERFORM
  4894
  4895* EXEC CICS ENDBR
  4896*          DATASET   ('ERACCT3')
  4897*       END-EXEC
  4898     MOVE 'ERACCT3' TO DFHEIV1
  4899     MOVE 0
  4900       TO DFHEIV11
  4901*    MOVE '&2                    $   #00004764' TO DFHEIV0
  4902     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4904     MOVE X'2020233030303034373634' TO DFHEIV0(25:11)
  4905     CALL 'kxdfhei1' USING DFHEIV0,
  4906           DFHEIV1,
  4907           DFHEIV11,
  4908           DFHEIV99
  4909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4910     ELSE
  4911        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4912        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4913        MOVE ZEROS      TO WS-RESP
  4914        PERFORM 0030-BUILD-BUFFER
  4915                                 THRU 0030-EXIT
  4916        PERFORM 0020-SEND-BUFFER
  4917                                 THRU 0020-EXIT
  4918        PERFORM 0025-CLOSE-SOCKET
  4919                                 THRU 0025-EXIT
  4920        GO TO 0010-RETURN
  4921     END-IF
  4922     .
  4923 0060-EXIT.
  4924     EXIT.
  4925 0100-START-ELCERT.
  4926     MOVE SPACES                 TO WS-SEND-BUF
  4927     INITIALIZE WS-STRING-DATA
  4928     MOVE LOW-VALUES             TO WS-CM-KEY
  4929                                    WS-CM-KEY-A1
  4930                                    WS-CM-KEY-A4
  4931     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4932                                    WS-CM-COMPANY-CD-A1
  4933                                    WS-CM-COMPANY-CD-A4
  4934     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4935     MOVE 'L'                    TO DC-OPTION-CODE
  4936     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4937     IF NO-CONVERSION-ERROR
  4938        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4939     ELSE
  4940        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4941        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4942        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4943        PERFORM 0020-SEND-BUFFER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  87
* SOCK03.cbl
  4944                                 THRU 0020-EXIT
  4945        PERFORM 0025-CLOSE-SOCKET
  4946                                 THRU 0025-EXIT
  4947        GO TO 0010-RETURN
  4948     END-IF
  4949     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4950        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4951        MOVE 'L'                 TO DC-OPTION-CODE
  4952        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4953        IF NO-CONVERSION-ERROR
  4954           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4955        ELSE
  4956           MOVE 'BAD EFF DT CONVERT '
  4957                                 TO WS-COMMENT
  4958           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4959           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4960           PERFORM 0020-SEND-BUFFER
  4961                                 THRU 0020-EXIT
  4962           PERFORM 0025-CLOSE-SOCKET
  4963                                 THRU 0025-EXIT
  4964           GO TO 0010-RETURN
  4965        END-IF
  4966     END-IF
  4967     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4968        (F1 > +10)
  4969        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4970     END-PERFORM
  4971     IF F1 > +1
  4972        SUBTRACT +1 FROM F1
  4973     END-IF
  4974     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4975        (L1 > +15)
  4976        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4977     END-PERFORM
  4978     IF L1 > +1
  4979        SUBTRACT +1 FROM L1
  4980     END-IF
  4981     EVALUATE TRUE
  4982        WHEN WS-ELCERT-FULL
  4983           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4984           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4985           MOVE CLIENT-STATE        TO WS-CM-STATE
  4986           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4987           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4988           MOVE CLIENT-CERT-NO (1:10)
  4989                                    TO WS-CM-CERT-NO
  4990
  4991* EXEC CICS READ
  4992*             INTO    (CERTIFICATE-MASTER)
  4993*             DATASET ('ELCERT')
  4994*             RIDFLD  (WS-CM-KEY)
  4995*             RESP    (WS-RESPONSE)
  4996*          END-EXEC
  4997     MOVE LENGTH OF
  4998      CERTIFICATE-MASTER
  4999       TO DFHEIV11
  5000     MOVE 'ELCERT' TO DFHEIV1
  5001*    MOVE '&"IL       E          (  N#00004848' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  88
* SOCK03.cbl
  5002     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5004     MOVE X'204E233030303034383438' TO DFHEIV0(25:11)
  5005     CALL 'kxdfhei1' USING DFHEIV0,
  5006           DFHEIV1,
  5007           CERTIFICATE-MASTER,
  5008           DFHEIV11,
  5009           WS-CM-KEY,
  5010           DFHEIV99,
  5011           DFHEIV99,
  5012           DFHEIV99
  5013     MOVE EIBRESP  TO WS-RESPONSE
  5014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5015        WHEN WS-ELCERT-ACT-NAME
  5016           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  5017           MOVE CLIENT-GRP          TO WS-CM-GROUP
  5018           MOVE CLIENT-STATE        TO WS-CM-STATE
  5019           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  5020           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  5021           MOVE ZEROS               TO WS-CM-CERT-NO
  5022
  5023* EXEC CICS STARTBR
  5024*             DATASET ('ELCERT')
  5025*             RIDFLD  (WS-CM-KEY)
  5026*             RESP    (WS-RESPONSE)
  5027*          END-EXEC
  5028     MOVE 'ELCERT' TO DFHEIV1
  5029     MOVE 0
  5030       TO DFHEIV11
  5031*    MOVE '&,         G          &  N#00004861' TO DFHEIV0
  5032     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5033     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5034     MOVE X'204E233030303034383631' TO DFHEIV0(25:11)
  5035     CALL 'kxdfhei1' USING DFHEIV0,
  5036           DFHEIV1,
  5037           WS-CM-KEY,
  5038           DFHEIV99,
  5039           DFHEIV11,
  5040           DFHEIV99
  5041     MOVE EIBRESP  TO WS-RESPONSE
  5042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5043        WHEN WS-ELCERT-NAME
  5044           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  5045           MOVE SPACES           TO WS-CM-INITIALS
  5046           COMPUTE WS-LENGTH = L1 + +1
  5047
  5048* EXEC CICS STARTBR
  5049*             DATASET   ('ELCERT2')
  5050*             RIDFLD    (WS-CM-KEY-A1)
  5051*             GENERIC
  5052*             KEYLENGTH (WS-LENGTH)
  5053*             GTEQ
  5054*             RESP      (WS-RESPONSE)
  5055*          END-EXEC
  5056     MOVE 'ELCERT2' TO DFHEIV1
  5057     MOVE 0
  5058       TO DFHEIV11
  5059*    MOVE '&,   KG    G          &  N#00004870' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  89
* SOCK03.cbl
  5060     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  5061     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5062     MOVE X'204E233030303034383730' TO DFHEIV0(25:11)
  5063     CALL 'kxdfhei1' USING DFHEIV0,
  5064           DFHEIV1,
  5065           WS-CM-KEY-A1,
  5066           WS-LENGTH,
  5067           DFHEIV11,
  5068           DFHEIV99
  5069     MOVE EIBRESP  TO WS-RESPONSE
  5070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5071*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  5072*          DISPLAY ' KEY ' WS-CM-KEY-A1
  5073        WHEN WS-ELCERT-CERT-NO
  5074* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  5075           MOVE +11 TO WS-LENGTH
  5076           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  5077
  5078* EXEC CICS STARTBR
  5079*             DATASET   ('ELCERT5')
  5080*             RIDFLD    (WS-CM-KEY-A4)
  5081*             GENERIC
  5082*             KEYLENGTH (WS-LENGTH)
  5083*             GTEQ
  5084*             RESP      (WS-RESPONSE)
  5085*          END-EXEC
  5086     MOVE 'ELCERT5' TO DFHEIV1
  5087     MOVE 0
  5088       TO DFHEIV11
  5089*    MOVE '&,   KG    G          &  N#00004884' TO DFHEIV0
  5090     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  5091     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5092     MOVE X'204E233030303034383834' TO DFHEIV0(25:11)
  5093     CALL 'kxdfhei1' USING DFHEIV0,
  5094           DFHEIV1,
  5095           WS-CM-KEY-A4,
  5096           WS-LENGTH,
  5097           DFHEIV11,
  5098           DFHEIV99
  5099     MOVE EIBRESP  TO WS-RESPONSE
  5100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5101     END-EVALUATE
  5102     .
  5103 0100-EXIT.
  5104     EXIT.
  5105 0150-READ-NEXT-ELCERT.
  5106     EVALUATE TRUE
  5107        WHEN WS-ELCERT-ACT-NAME
  5108*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  5109
  5110* EXEC CICS READNEXT
  5111*             DATASET   ('ELCERT')
  5112*             RIDFLD    (WS-CM-KEY)
  5113*             INTO      (CERTIFICATE-MASTER)
  5114*             RESP      (WS-RESPONSE)
  5115*          END-EXEC
  5116     MOVE LENGTH OF
  5117      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  90
* SOCK03.cbl
  5118       TO DFHEIV12
  5119     MOVE 'ELCERT' TO DFHEIV1
  5120     MOVE 0
  5121       TO DFHEIV11
  5122*    MOVE '&.IL                  )  N#00004901' TO DFHEIV0
  5123     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5124     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5125     MOVE X'204E233030303034393031' TO DFHEIV0(25:11)
  5126     CALL 'kxdfhei1' USING DFHEIV0,
  5127           DFHEIV1,
  5128           CERTIFICATE-MASTER,
  5129           DFHEIV12,
  5130           WS-CM-KEY,
  5131           DFHEIV99,
  5132           DFHEIV11,
  5133           DFHEIV99,
  5134           DFHEIV99
  5135     MOVE EIBRESP  TO WS-RESPONSE
  5136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5137        WHEN WS-ELCERT-NAME
  5138*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  5139
  5140* EXEC CICS READNEXT
  5141*             DATASET   ('ELCERT2')
  5142*             RIDFLD    (WS-CM-KEY-A1)
  5143*             INTO      (CERTIFICATE-MASTER)
  5144*             RESP      (WS-RESPONSE)
  5145*          END-EXEC
  5146     MOVE LENGTH OF
  5147      CERTIFICATE-MASTER
  5148       TO DFHEIV12
  5149     MOVE 'ELCERT2' TO DFHEIV1
  5150     MOVE 0
  5151       TO DFHEIV11
  5152*    MOVE '&.IL                  )  N#00004909' TO DFHEIV0
  5153     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5154     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5155     MOVE X'204E233030303034393039' TO DFHEIV0(25:11)
  5156     CALL 'kxdfhei1' USING DFHEIV0,
  5157           DFHEIV1,
  5158           CERTIFICATE-MASTER,
  5159           DFHEIV12,
  5160           WS-CM-KEY-A1,
  5161           DFHEIV99,
  5162           DFHEIV11,
  5163           DFHEIV99,
  5164           DFHEIV99
  5165     MOVE EIBRESP  TO WS-RESPONSE
  5166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5167        WHEN WS-ELCERT-CERT-NO
  5168
  5169* EXEC CICS READNEXT
  5170*             DATASET   ('ELCERT5')
  5171*             RIDFLD    (WS-CM-KEY-A4)
  5172*             INTO      (CERTIFICATE-MASTER)
  5173*             RESP      (WS-RESPONSE)
  5174*          END-EXEC
  5175     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  91
* SOCK03.cbl
  5176      CERTIFICATE-MASTER
  5177       TO DFHEIV12
  5178     MOVE 'ELCERT5' TO DFHEIV1
  5179     MOVE 0
  5180       TO DFHEIV11
  5181*    MOVE '&.IL                  )  N#00004916' TO DFHEIV0
  5182     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5183     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5184     MOVE X'204E233030303034393136' TO DFHEIV0(25:11)
  5185     CALL 'kxdfhei1' USING DFHEIV0,
  5186           DFHEIV1,
  5187           CERTIFICATE-MASTER,
  5188           DFHEIV12,
  5189           WS-CM-KEY-A4,
  5190           DFHEIV99,
  5191           DFHEIV11,
  5192           DFHEIV99,
  5193           DFHEIV99
  5194     MOVE EIBRESP  TO WS-RESPONSE
  5195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5196     END-EVALUATE
  5197     .
  5198 0150-EXIT.
  5199     EXIT.
  5200 0200-BEGIN-REFUND-PROCESS.
  5201     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5202                                    WS-ERACCT-SW
  5203     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  5204                                    WS-NCB-DIFF-ODD-DAYS
  5205     INITIALIZE WS-STRING-DATA
  5206     IF RESP-NORMAL OR RESP-DUPKEY
  5207        EVALUATE TRUE
  5208           WHEN WS-ELCERT-ACT-NAME
  5209              EVALUATE TRUE
  5210                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5211                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5212                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5213                    OR (CM-STATE NOT = CLIENT-STATE)
  5214                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5215                    SET ELCERT-FINISHED TO TRUE
  5216                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5217                    CLIENT-LAST-NAME (1:L1))
  5218                    GO TO 0200-CONTINUE
  5219                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5220                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5221                    GO TO 0200-CONTINUE
  5222                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5223                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5224                     CLIENT-FIRST-NAME (1:F1)))
  5225                    GO TO 0200-CONTINUE
  5226                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5227                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5228                    GO TO 0200-CONTINUE
  5229              END-EVALUATE
  5230           WHEN WS-ELCERT-CERT-NO
  5231              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5232                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5233                 SET ELCERT-FINISHED TO TRUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  92
* SOCK03.cbl
  5234              ELSE
  5235                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5236                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5237                              OR
  5238                    ((CLIENT-LAST-NAME NOT = SPACES)
  5239                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5240                        CLIENT-LAST-NAME (1:L1)))
  5241                              OR
  5242                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5243                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5244                        CLIENT-FIRST-NAME (1:F1)))
  5245                              OR
  5246                    ((CLIENT-ACCOUNT NOT = SPACES)
  5247                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5248                     GO TO 0200-CONTINUE
  5249                 END-IF
  5250              END-IF
  5251           WHEN WS-ELCERT-NAME
  5252              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5253                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5254                    CLIENT-LAST-NAME (1:L1))
  5255                  SET ELCERT-FINISHED TO TRUE
  5256              ELSE
  5257                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5258                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5259                           OR
  5260                 ((CLIENT-FIRST-NAME NOT = SPACES)
  5261                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5262                     CLIENT-FIRST-NAME (1:F1)))
  5263                           OR
  5264                 ((CLIENT-ACCOUNT NOT = SPACES)
  5265                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5266                  GO TO 0200-CONTINUE
  5267                 END-IF
  5268              END-IF
  5269           WHEN OTHER
  5270              SET ELCERT-FINISHED   TO TRUE
  5271        END-EVALUATE
  5272     ELSE
  5273        SET ELCERT-FINISHED TO TRUE
  5274     END-IF
  5275*       IF WS-ELCERT-CERT-NO
  5276*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5277*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5278*                          OR
  5279*                ((CLIENT-EFF-DT NOT = SPACES)
  5280*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5281*                          OR
  5282*                ((CLIENT-LAST-NAME NOT = SPACES)
  5283*                 AND (CM-INSURED-LAST-NAME NOT =
  5284*                    CLIENT-LAST-NAME))
  5285*                 SET ELCERT-FINISHED TO TRUE
  5286*          END-IF
  5287*          IF WS-ELCERT-NAME
  5288*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5289*                OR (CM-INSURED-LAST-NAME NOT =
  5290*                   CLIENT-LAST-NAME)
  5291*                            OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  93
* SOCK03.cbl
  5292*                ((CLIENT-EFF-DT NOT = SPACES)
  5293*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5294*                 SET ELCERT-FINISHED TO TRUE
  5295*             END-IF
  5296*          ELSE
  5297*             SET ELCERT-FINISHED   TO TRUE
  5298*          END-IF
  5299     IF NOT WS-ELCERT-FULL
  5300        IF ELCERT-FINISHED
  5301           GO TO 0200-EXIT
  5302        END-IF
  5303     END-IF
  5304     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  5305        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5306        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5307        PERFORM 0030-BUILD-BUFFER
  5308                                 THRU 0030-EXIT
  5309        PERFORM 0020-SEND-BUFFER
  5310                                 THRU 0020-EXIT
  5311        GO TO 0200-CONTINUE
  5312     END-IF
  5313     if (ws-epiq-request)
  5314        and (not EPIQ-CLASS)
  5315        go to 0200-continue
  5316     end-if
  5317
  5318     if ws-epiq-request
  5319        add +1 to ws-epiq-max
  5320        if ws-epiq-max > +100
  5321           go to 0200-continue
  5322        end-if
  5323     end-if
  5324     PERFORM 0300-GET-ELCNTL-RECORDS
  5325                                 THRU 0300-EXIT
  5326     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5327     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5328     MOVE +0                     TO DC-ELAPSED-MONTHS
  5329                                    DC-ELAPSED-DAYS
  5330     MOVE '1'                    TO DC-OPTION-CODE
  5331     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5332     IF NO-CONVERSION-ERROR
  5333        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5334        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5335     END-IF
  5336     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5337     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5338     perform 0610-get-ermail     thru 0610-exit
  5339     perform 0620-get-elcrtt     thru 0620-exit
  5340     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5341     IF NOT ALREADY-SENT
  5342        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5343     END-IF
  5344     .
  5345 0200-CONTINUE.
  5346     PERFORM 0150-READ-NEXT-ELCERT
  5347                                 THRU 0150-EXIT
  5348     .
  5349 0200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  94
* SOCK03.cbl
  5350     EXIT.
  5351 0300-GET-ELCNTL-RECORDS.
  5352     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5353     IF NOT RESP-NORMAL
  5354        MOVE ' COMPANY RECORD NOT FOUND '
  5355                                 TO WS-COMMENT
  5356        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5357        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5358        PERFORM 0020-SEND-BUFFER
  5359                                 THRU 0020-EXIT
  5360        PERFORM 0025-CLOSE-SOCKET
  5361                                 THRU 0025-EXIT
  5362        GO TO 0010-RETURN
  5363     END-IF
  5364     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5365        PERFORM 0320-GET-LIFE-RECORD
  5366                                 THRU 0320-EXIT
  5367        IF NOT RESP-NORMAL
  5368           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  5369                                 TO WS-COMMENT
  5370           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5371           PERFORM 0030-BUILD-BUFFER
  5372                                 THRU 0030-EXIT
  5373           PERFORM 0020-SEND-BUFFER
  5374                                 THRU 0020-EXIT
  5375           PERFORM 0025-CLOSE-SOCKET
  5376                                 THRU 0025-EXIT
  5377           GO TO 0010-RETURN
  5378        END-IF
  5379     END-IF
  5380     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5381        PERFORM 0330-GET-AH-RECORD
  5382                                 THRU 0330-EXIT
  5383        IF NOT RESP-NORMAL
  5384           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5385                                 TO WS-COMMENT
  5386           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5387           PERFORM 0030-BUILD-BUFFER
  5388                                 THRU 0030-EXIT
  5389           PERFORM 0020-SEND-BUFFER
  5390                                 THRU 0020-EXIT
  5391           PERFORM 0025-CLOSE-SOCKET
  5392                                 THRU 0025-EXIT
  5393           GO TO 0010-RETURN
  5394        END-IF
  5395     END-IF
  5396     PERFORM 0340-GET-STATE-RECORD
  5397                                 THRU 0340-EXIT
  5398     IF NOT RESP-NORMAL
  5399        MOVE ' STATE RECORD NOT FOUND '
  5400                                 TO WS-COMMENT
  5401        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5402        PERFORM 0030-BUILD-BUFFER
  5403                                 THRU 0030-EXIT
  5404        PERFORM 0020-SEND-BUFFER
  5405                                 THRU 0020-EXIT
  5406        PERFORM 0025-CLOSE-SOCKET
  5407                                 THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  95
* SOCK03.cbl
  5408        GO TO 0010-RETURN
  5409     END-IF
  5410     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5411     IF NOT ERACCT-FOUND
  5412        MOVE ' ACCOUNT NOT FOUND '
  5413                                 TO WS-COMMENT
  5414        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5415        PERFORM 0030-BUILD-BUFFER
  5416                                 THRU 0030-EXIT
  5417        PERFORM 0020-SEND-BUFFER
  5418                                 THRU 0020-EXIT
  5419        PERFORM 0025-CLOSE-SOCKET
  5420                                 THRU 0025-EXIT
  5421        GO TO 0010-RETURN
  5422     ELSE
  5423        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  5424        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5425        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  5426        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  5427     END-IF
  5428     .
  5429 0300-EXIT.
  5430     EXIT.
  5431 0310-GET-COMPANY.
  5432     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5433     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  5434     MOVE SPACES                 TO  WS-CF-ACCESS
  5435     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  5436
  5437* EXEC CICS READ
  5438*       INTO    (CONTROL-FILE)
  5439*       DATASET ('ELCNTL')
  5440*       RIDFLD  (WS-CF-KEY)
  5441*       RESP    (WS-RESPONSE)
  5442*    END-EXEC
  5443     MOVE LENGTH OF
  5444      CONTROL-FILE
  5445       TO DFHEIV11
  5446     MOVE 'ELCNTL' TO DFHEIV1
  5447*    MOVE '&"IL       E          (  N#00005163' TO DFHEIV0
  5448     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5449     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5450     MOVE X'204E233030303035313633' TO DFHEIV0(25:11)
  5451     CALL 'kxdfhei1' USING DFHEIV0,
  5452           DFHEIV1,
  5453           CONTROL-FILE,
  5454           DFHEIV11,
  5455           WS-CF-KEY,
  5456           DFHEIV99,
  5457           DFHEIV99,
  5458           DFHEIV99
  5459     MOVE EIBRESP  TO WS-RESPONSE
  5460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5461     IF (RESP-NORMAL)
  5462        AND (CF-COMPANY-ID = WS-COMP-ID)
  5463        AND (CF-RECORD-TYPE = '1')
  5464        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5465        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  96
* SOCK03.cbl
  5466        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5467        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5468        IF CF-DEFAULT-APR NUMERIC
  5469           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5470        ELSE
  5471           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5472        END-IF
  5473        IF CF-VALID-REM-TRM-OPTION
  5474           MOVE CF-REM-TRM-CALC-OPTION
  5475                                 TO WS-CF-REM-TRM-CALC-OPTION
  5476        ELSE
  5477           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5478        END-IF
  5479     END-IF
  5480     .
  5481 0310-EXIT.
  5482     EXIT.
  5483 0320-GET-LIFE-RECORD.
  5484     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5485     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5486                                    WS-LF-BEN-CODE
  5487     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5488
  5489* EXEC CICS READ
  5490*       INTO    (CONTROL-FILE)
  5491*       DATASET ('ELCNTL')
  5492*       RIDFLD  (WS-CF-KEY)
  5493*       GTEQ
  5494*       RESP    (WS-RESPONSE)
  5495*    END-EXEC
  5496     MOVE LENGTH OF
  5497      CONTROL-FILE
  5498       TO DFHEIV11
  5499     MOVE 'ELCNTL' TO DFHEIV1
  5500*    MOVE '&"IL       G          (  N#00005196' TO DFHEIV0
  5501     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5503     MOVE X'204E233030303035313936' TO DFHEIV0(25:11)
  5504     CALL 'kxdfhei1' USING DFHEIV0,
  5505           DFHEIV1,
  5506           CONTROL-FILE,
  5507           DFHEIV11,
  5508           WS-CF-KEY,
  5509           DFHEIV99,
  5510           DFHEIV99,
  5511           DFHEIV99
  5512     MOVE EIBRESP  TO WS-RESPONSE
  5513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5514     IF RESP-NORMAL
  5515        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5516        AND (CF-RECORD-TYPE = '4')
  5517        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5518           (S1 > +8)
  5519           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5520        END-PERFORM
  5521        IF S1 > +8
  5522           CONTINUE
  5523        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  97
* SOCK03.cbl
  5524           MOVE CF-BENEFIT-DESCRIP (S1)
  5525                                 TO WS-LF-BEN-CODE-DESC
  5526           MOVE CF-LF-COVERAGE-TYPE (S1)
  5527                                 TO WS-CF-LF-COVERAGE-TYPE
  5528           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5529              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5530           ELSE
  5531              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5532           END-IF
  5533           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5534               MOVE CF-CO-REM-TERM-CALC (S1)
  5535                                 TO WS-LF-CO-REM-TERM-CALC
  5536           END-IF
  5537           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5538               MOVE CF-CO-EARNINGS-CALC (S1)
  5539                                 TO WS-LF-CO-EARNINGS-CALC
  5540                                    WS-LF-CO-REFUND-CALC
  5541           END-IF
  5542           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5543               MOVE CF-SPECIAL-CALC-CD (S1)
  5544                                 TO WS-LF-SPECIAL-CALC-CD
  5545           END-IF
  5546           IF CF-CO-REFUND-CALC (S1) > '0'
  5547               MOVE CF-CO-REFUND-CALC (S1)
  5548                                 TO WS-LF-CO-REFUND-CALC
  5549        END-IF
  5550     END-IF
  5551     .
  5552 0320-EXIT.
  5553     EXIT.
  5554 0330-GET-AH-RECORD.
  5555     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5556     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5557     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5558
  5559* EXEC CICS READ
  5560*       INTO    (CONTROL-FILE)
  5561*       DATASET ('ELCNTL')
  5562*       RIDFLD  (WS-CF-KEY)
  5563*       GTEQ
  5564*       RESP    (WS-RESPONSE)
  5565*    END-EXEC
  5566     MOVE LENGTH OF
  5567      CONTROL-FILE
  5568       TO DFHEIV11
  5569     MOVE 'ELCNTL' TO DFHEIV1
  5570*    MOVE '&"IL       G          (  N#00005247' TO DFHEIV0
  5571     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5573     MOVE X'204E233030303035323437' TO DFHEIV0(25:11)
  5574     CALL 'kxdfhei1' USING DFHEIV0,
  5575           DFHEIV1,
  5576           CONTROL-FILE,
  5577           DFHEIV11,
  5578           WS-CF-KEY,
  5579           DFHEIV99,
  5580           DFHEIV99,
  5581           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  98
* SOCK03.cbl
  5582     MOVE EIBRESP  TO WS-RESPONSE
  5583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5584     IF RESP-NORMAL
  5585        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5586        AND (CF-RECORD-TYPE = '5')
  5587        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5588           (S1 > +8)
  5589           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5590        END-PERFORM
  5591        IF S1 > +8
  5592           CONTINUE
  5593        ELSE
  5594           MOVE CF-BENEFIT-DESCRIP (S1)
  5595                                 TO WS-AH-BEN-CODE-DESC
  5596           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5597              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5598           ELSE
  5599              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5600           END-IF
  5601           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5602              MOVE CF-CO-REM-TERM-CALC (S1)
  5603                                 TO WS-AH-CO-REM-TERM-CALC
  5604           END-IF
  5605           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5606              MOVE CF-CO-EARNINGS-CALC (S1)
  5607                                 TO WS-AH-CO-EARNINGS-CALC
  5608                                    WS-AH-CO-REFUND-CALC
  5609           END-IF
  5610           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5611              MOVE CF-SPECIAL-CALC-CD (S1)
  5612                                 TO WS-AH-SPECIAL-CALC-CD
  5613           END-IF
  5614           IF CF-CO-REFUND-CALC (S1) > '0'
  5615              MOVE CF-CO-REFUND-CALC (S1)
  5616                                 TO WS-AH-CO-REFUND-CALC
  5617           END-IF
  5618           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5619              MOVE CF-BENEFIT-CATEGORY (S1)
  5620                                 TO WS-AH-BEN-CATEGORY
  5621           END-IF
  5622        END-IF
  5623     END-IF
  5624     .
  5625 0330-EXIT.
  5626     EXIT.
  5627 0340-GET-STATE-RECORD.
  5628     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5629     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5630     MOVE CM-STATE               TO WS-CF-ACCESS
  5631     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5632
  5633* EXEC CICS READ
  5634*       INTO    (CONTROL-FILE)
  5635*       DATASET ('ELCNTL')
  5636*       RIDFLD  (WS-CF-KEY)
  5637*       RESP    (WS-RESPONSE)
  5638*    END-EXEC
  5639     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page  99
* SOCK03.cbl
  5640      CONTROL-FILE
  5641       TO DFHEIV11
  5642     MOVE 'ELCNTL' TO DFHEIV1
  5643*    MOVE '&"IL       E          (  N#00005302' TO DFHEIV0
  5644     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5645     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5646     MOVE X'204E233030303035333032' TO DFHEIV0(25:11)
  5647     CALL 'kxdfhei1' USING DFHEIV0,
  5648           DFHEIV1,
  5649           CONTROL-FILE,
  5650           DFHEIV11,
  5651           WS-CF-KEY,
  5652           DFHEIV99,
  5653           DFHEIV99,
  5654           DFHEIV99
  5655     MOVE EIBRESP  TO WS-RESPONSE
  5656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5657     IF (RESP-NORMAL)
  5658        AND (CF-COMPANY-ID = WS-COMP-ID)
  5659        AND (CF-RECORD-TYPE = '3')
  5660        AND (CF-STATE-CODE = CM-STATE)
  5661        MOVE CF-ST-FREE-LOOK-PERIOD
  5662                                 TO WS-FREE-LOOK
  5663        MOVE CF-STATE-ABBREVIATION
  5664                                 TO WS-STATE-ABBREVIATION
  5665        MOVE CF-ST-FST-PMT-DAYS-CHG
  5666                                 TO  WS-STATE-EXT-DAYS-CHG
  5667        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5668           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5669           IF CF-ST-RT-CALC NOT = SPACES
  5670              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5671           END-IF
  5672           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5673              IF CF-ST-RF-LR-CALC > '0'
  5674                 MOVE CF-ST-RF-LR-CALC
  5675                                 TO WS-LF-ST-REFUND-CALC
  5676              END-IF
  5677              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5678                 IF CF-ST-RF-LN-CALC > '0'
  5679                    MOVE CF-ST-RF-LN-CALC
  5680                                 TO WS-LF-ST-REFUND-CALC
  5681                 END-IF
  5682              END-IF
  5683           ELSE
  5684              IF CF-ST-RF-LL-CALC > '0'
  5685                 MOVE CF-ST-RF-LL-CALC
  5686                                 TO WS-LF-ST-REFUND-CALC
  5687              END-IF
  5688           END-IF
  5689           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5690              (S1 > 50)
  5691              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5692                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5693           END-PERFORM
  5694           IF S1 < +51
  5695              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5696                 MOVE CF-ST-REM-TERM-CALC (S1)
  5697                                 TO WS-LF-ST-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 100
* SOCK03.cbl
  5698              END-IF
  5699              IF CF-ST-REFUND-CALC (S1) > '0'
  5700                 MOVE CF-ST-REFUND-CALC (S1)
  5701                                 TO WS-LF-ST-REFUND-CALC
  5702              END-IF
  5703           END-IF
  5704        END-IF
  5705        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5706           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5707           IF CF-ST-RT-CALC NOT = SPACES
  5708              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5709           END-IF
  5710           IF CF-ST-RF-AH-CALC > '0'
  5711              MOVE CF-ST-RF-AH-CALC
  5712                                 TO WS-AH-ST-REFUND-CALC
  5713           END-IF
  5714           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5715              IF CF-ST-RF-CP-CALC > '0'
  5716                 MOVE CF-ST-RF-CP-CALC
  5717                                 TO WS-AH-ST-REFUND-CALC
  5718              END-IF
  5719           END-IF
  5720           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5721              (S1 > 50)
  5722              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5723                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5724           END-PERFORM
  5725           IF S1 < +51
  5726              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5727                 MOVE CF-ST-REM-TERM-CALC (S1)
  5728                                 TO WS-AH-ST-REM-TERM-CALC
  5729              END-IF
  5730              IF CF-ST-REFUND-CALC (S1) > '0'
  5731                 MOVE CF-ST-REFUND-CALC (S1)
  5732                                 TO WS-AH-ST-REFUND-CALC
  5733              END-IF
  5734           END-IF
  5735        END-IF
  5736     END-IF
  5737     .
  5738 0340-EXIT.
  5739     EXIT.
  5740 0350-GET-ERACCT.
  5741     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5742                                    WS-AM-EARN-METHOD-R
  5743                                    WS-AM-EARN-METHOD-A
  5744                                    WS-LF-AM-REM-TERM-CALC
  5745                                    WS-AH-AM-REM-TERM-CALC
  5746     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5747     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5748     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5749     MOVE CM-STATE               TO WS-AM-STATE
  5750     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5751     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5752     MOVE LOW-VALUES             TO WS-AM-FILLER
  5753     MOVE ' '                    TO WS-STOP-SW
  5754
  5755* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 101
* SOCK03.cbl
  5756*       DATASET  ('ERACCT')
  5757*       RIDFLD   (WS-AM-KEY)
  5758*       GTEQ
  5759*       RESP (WS-RESPONSE)
  5760*    END-EXEC
  5761     MOVE 'ERACCT' TO DFHEIV1
  5762     MOVE 0
  5763       TO DFHEIV11
  5764*    MOVE '&,         G          &  N#00005405' TO DFHEIV0
  5765     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5767     MOVE X'204E233030303035343035' TO DFHEIV0(25:11)
  5768     CALL 'kxdfhei1' USING DFHEIV0,
  5769           DFHEIV1,
  5770           WS-AM-KEY,
  5771           DFHEIV99,
  5772           DFHEIV11,
  5773           DFHEIV99
  5774     MOVE EIBRESP  TO WS-RESPONSE
  5775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5776     IF RESP-NORMAL
  5777        PERFORM UNTIL TOLD-TO-STOP
  5778
  5779* EXEC CICS READNEXT
  5780*             DATASET  ('ERACCT')
  5781*             INTO     (ACCOUNT-MASTER)
  5782*             RIDFLD   (WS-AM-KEY)
  5783*          END-EXEC
  5784     MOVE LENGTH OF
  5785      ACCOUNT-MASTER
  5786       TO DFHEIV12
  5787     MOVE 'ERACCT' TO DFHEIV1
  5788     MOVE 0
  5789       TO DFHEIV11
  5790*    MOVE '&.IL                  )   #00005413' TO DFHEIV0
  5791     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5792     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5793     MOVE X'2020233030303035343133' TO DFHEIV0(25:11)
  5794     CALL 'kxdfhei1' USING DFHEIV0,
  5795           DFHEIV1,
  5796           ACCOUNT-MASTER,
  5797           DFHEIV12,
  5798           WS-AM-KEY,
  5799           DFHEIV99,
  5800           DFHEIV11,
  5801           DFHEIV99,
  5802           DFHEIV99
  5803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5804           IF RESP-NORMAL
  5805              EVALUATE TRUE
  5806                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5807                    CM-CONTROL-PRIMARY (1:20)
  5808                    SET TOLD-TO-STOP TO TRUE
  5809                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5810                    CM-CONTROL-PRIMARY (1:20))
  5811                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5812                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5813                    SET ERACCT-FOUND      TO TRUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 102
* SOCK03.cbl
  5814                    SET TOLD-TO-STOP TO TRUE
  5815              END-EVALUATE
  5816           ELSE
  5817              SET TOLD-TO-STOP TO TRUE
  5818           END-IF
  5819        END-PERFORM
  5820
  5821* EXEC CICS ENDBR
  5822*          DATASET   ('ERACCT')
  5823*       END-EXEC
  5824     MOVE 'ERACCT' TO DFHEIV1
  5825     MOVE 0
  5826       TO DFHEIV11
  5827*    MOVE '&2                    $   #00005434' TO DFHEIV0
  5828     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5829     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5830     MOVE X'2020233030303035343334' TO DFHEIV0(25:11)
  5831     CALL 'kxdfhei1' USING DFHEIV0,
  5832           DFHEIV1,
  5833           DFHEIV11,
  5834           DFHEIV99
  5835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5836     END-IF
  5837     .
  5838 0350-EXIT.
  5839     EXIT.
  5840 0400-PROCESS-LIFE.
  5841     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5842     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5843     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5844     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5845     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5846     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5847     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5848     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5849     MOVE CM-CARRIER             TO WS-CARRIER
  5850     MOVE CM-GROUPING            TO WS-GROUPING
  5851     MOVE CM-STATE               TO WS-STATE
  5852     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5853     MOVE CM-CERT-NO             TO WS-CERT-NO
  5854     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5855     MOVE ' '                    TO  DC-OPTION-CODE.
  5856     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5857     IF NO-CONVERSION-ERROR
  5858        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5859     ELSE
  5860        MOVE 99999999            TO WS-CERT-EFF-DATE
  5861     END-IF
  5862     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5863        GO TO 0400-EXIT
  5864     END-IF
  5865     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5866                                    WS-TOT-LF-PREM
  5867                                    WS-TOT-LF-COMM
  5868                                    WS-LF-CANCEL-DATE
  5869     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5870     MOVE ' '                    TO  DC-OPTION-CODE
  5871     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 103
* SOCK03.cbl
  5872     IF NO-CONVERSION-ERROR
  5873        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5874     ELSE
  5875        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5876     END-IF
  5877     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5878        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5879        MOVE ' '                 TO DC-OPTION-CODE
  5880
  5881        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5882        IF NO-CONVERSION-ERROR
  5883           MOVE DC-GREG-DATE-CYMD
  5884                                 TO WS-LF-CANCEL-DATE
  5885        ELSE
  5886           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5887        END-IF
  5888     END-IF
  5889     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5890        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  5891        MOVE ' '                 TO DC-OPTION-CODE
  5892
  5893        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5894        IF NO-CONVERSION-ERROR
  5895           MOVE DC-GREG-DATE-CYMD
  5896                                 TO WS-LF-CANCEL-DATE
  5897        ELSE
  5898           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5899        END-IF
  5900     END-IF
  5901     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5902     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5903     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5904     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5905     MOVE CM-STATE               TO CP-STATE
  5906     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5907     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5908     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5909     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5910     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5911     MOVE '2'                    TO CP-PROCESS-TYPE
  5912     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5913     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5914     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5915     MOVE WS-CF-REM-TRM-CALC-OPTION
  5916                                 TO CP-REM-TRM-CALC-OPTION
  5917     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5918     IF WS-LF-CO-REM-TERM-CALC > '0'
  5919        MOVE WS-LF-CO-REM-TERM-CALC
  5920                                 TO CP-REM-TERM-METHOD
  5921     END-IF
  5922     IF WS-LF-ST-REM-TERM-CALC > '0'
  5923         MOVE WS-LF-ST-REM-TERM-CALC
  5924                                 TO  CP-REM-TERM-METHOD.
  5925     IF WS-LF-AM-REM-TERM-CALC > '0'
  5926         MOVE WS-LF-AM-REM-TERM-CALC
  5927                                 TO  CP-REM-TERM-METHOD.
  5928     IF (WS-COMP-ID = 'CID')
  5929        AND (CP-STATE-STD-ABBRV = 'WI')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 104
* SOCK03.cbl
  5930        MOVE '7'                 TO CP-REM-TERM-METHOD
  5931        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5932     END-IF
  5933     IF (WS-COMP-ID = 'CID')
  5934        AND (CP-STATE-STD-ABBRV = 'MO')
  5935        AND (CM-CERT-EFF-DT >= X'9B41')
  5936        AND (CM-CERT-EFF-DT <= X'A2FB')
  5937        MOVE '7'                 TO CP-REM-TERM-METHOD
  5938        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5939     END-IF
  5940     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5941                                    CP-LOAN-TERM
  5942                                    WS-LF-TERM
  5943     IF CP-TRUNCATED-LIFE
  5944         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5945     IF CP-TERM-IS-DAYS
  5946        IF CM-LF-TERM-IN-DAYS NUMERIC
  5947           MOVE CM-LF-TERM-IN-DAYS
  5948                                 TO CP-TERM-OR-EXT-DAYS
  5949        ELSE
  5950           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5951        END-IF
  5952     ELSE
  5953        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5954           MOVE CM-PMT-EXTENSION-DAYS
  5955                                 TO CP-TERM-OR-EXT-DAYS
  5956        ELSE
  5957           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5958        END-IF
  5959     END-IF
  5960     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5961     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5962        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5963        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5964     END-IF
  5965     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5966     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5967     MOVE ' '                    TO WS-CLM-STOP-SW
  5968     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5969     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5970
  5971* EXEC CICS STARTBR
  5972*       DATASET     ('ELMSTR5')
  5973*       RIDFLD      (ELMSTR-KEY)
  5974*       RESP        (WS-RESPONSE)
  5975*    END-EXEC
  5976     MOVE 'ELMSTR5' TO DFHEIV1
  5977     MOVE 0
  5978       TO DFHEIV11
  5979*    MOVE '&,         G          &  N#00005571' TO DFHEIV0
  5980     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5981     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5982     MOVE X'204E233030303035353731' TO DFHEIV0(25:11)
  5983     CALL 'kxdfhei1' USING DFHEIV0,
  5984           DFHEIV1,
  5985           ELMSTR-KEY,
  5986           DFHEIV99,
  5987           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 105
* SOCK03.cbl
  5988           DFHEIV99
  5989     MOVE EIBRESP  TO WS-RESPONSE
  5990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5991     DISPLAY ' AFTER START ' WS-RESPONSE
  5992     IF RESP-NORMAL
  5993        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5994
  5995* EXEC CICS READNEXT
  5996*             DATASET   ('ELMSTR5')
  5997*             RIDFLD    (ELMSTR-KEY)
  5998*             INTO      (CLAIM-MASTER)
  5999*             RESP      (WS-RESPONSE)
  6000*          END-EXEC
  6001     MOVE LENGTH OF
  6002      CLAIM-MASTER
  6003       TO DFHEIV12
  6004     MOVE 'ELMSTR5' TO DFHEIV1
  6005     MOVE 0
  6006       TO DFHEIV11
  6007*    MOVE '&.IL                  )  N#00005579' TO DFHEIV0
  6008     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6009     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6010     MOVE X'204E233030303035353739' TO DFHEIV0(25:11)
  6011     CALL 'kxdfhei1' USING DFHEIV0,
  6012           DFHEIV1,
  6013           CLAIM-MASTER,
  6014           DFHEIV12,
  6015           ELMSTR-KEY,
  6016           DFHEIV99,
  6017           DFHEIV11,
  6018           DFHEIV99,
  6019           DFHEIV99
  6020     MOVE EIBRESP  TO WS-RESPONSE
  6021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6022        IF (RESP-NORMAL OR RESP-DUPKEY)
  6023           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6024           AND (CM-CERT-NO = CL-CERT-NO)
  6025           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6026              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6027              IF CL-CLAIM-TYPE = 'L' OR 'O'
  6028                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  6029                    MOVE 'D'     TO WS-AH-STATUS
  6030                 END-IF
  6031                 IF CLAIM-IS-OPEN
  6032                    MOVE ' OPEN LIFE CLAIM '
  6033                                 TO WS-COMMENT
  6034                    MOVE 'L'     TO WS-LF-STATUS
  6035                    GO TO 0400-EXIT
  6036                 ELSE
  6037                    MOVE ' DEATH CLAIM APPLIED '
  6038                                 TO WS-COMMENT
  6039                    MOVE 'D'     TO WS-LF-STATUS
  6040*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  6041*                      MOVE CL-PAID-THRU-DT
  6042*                                TO WS-LF-BIN-PAID-THRU-DT
  6043*                   END-IF
  6044                 END-IF
  6045              END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 106
* SOCK03.cbl
  6046           END-IF
  6047        ELSE
  6048           SET I-SAY-TO-STOP TO TRUE
  6049        END-IF
  6050        END-PERFORM
  6051
  6052* EXEC CICS ENDBR
  6053*          DATASET   ('ELMSTR5')
  6054*       END-EXEC
  6055     MOVE 'ELMSTR5' TO DFHEIV1
  6056     MOVE 0
  6057       TO DFHEIV11
  6058*    MOVE '&2                    $   #00005614' TO DFHEIV0
  6059     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6060     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6061     MOVE X'2020233030303035363134' TO DFHEIV0(25:11)
  6062     CALL 'kxdfhei1' USING DFHEIV0,
  6063           DFHEIV1,
  6064           DFHEIV11,
  6065           DFHEIV99
  6066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6067     END-IF
  6068     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6069*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  6070        MOVE WS-LF-BIN-PAID-THRU-DT
  6071                                 TO DC-BIN-DATE-1
  6072        MOVE ' '                 TO DC-OPTION-CODE
  6073        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6074        IF NO-CONVERSION-ERROR
  6075           MOVE DC-GREG-DATE-CYMD
  6076                                 TO WS-CLM-PAID-THRU-DT
  6077        ELSE
  6078           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6079        END-IF
  6080*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  6081*          MOVE 'CAN DT =< CLM PD THRU DT'
  6082*                                TO WS-COMMENT
  6083*          MOVE 'P'              TO WS-LF-STATUS
  6084*          GO TO 0400-EXIT
  6085*       END-IF
  6086        GO TO 0400-EXIT
  6087     END-IF
  6088     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6089     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6090        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6091        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  6092        COMPUTE CP-REMAINING-TERM-1 =
  6093                CP-REMAINING-TERM-1 - +1
  6094        COMPUTE CP-REMAINING-TERM-2 =
  6095                CP-REMAINING-TERM-2 - +1
  6096     END-IF
  6097     IF CP-REMAINING-TERM-1 NEGATIVE
  6098        MOVE ZEROS               TO CP-REMAINING-TERM-1
  6099     END-IF
  6100     IF CP-REMAINING-TERM-2 NEGATIVE
  6101        MOVE ZEROS               TO CP-REMAINING-TERM-2
  6102     END-IF
  6103     IF CM-LIFE-COMM-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 107
* SOCK03.cbl
  6104        MOVE ZERO                TO CM-LIFE-COMM-PCT
  6105     END-IF
  6106     IF CM-LIFE-COMM-PCT > ZEROS
  6107        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  6108           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  6109     END-IF
  6110     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  6111     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  6112     IF CM-LF-CURRENT-STATUS = '8'
  6113        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  6114           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  6115                                 TO WS-COMMENT
  6116           MOVE 'C'              TO WS-LF-STATUS
  6117           move cm-lf-itd-cancel-amt
  6118                                 to ws-lf-refund
  6119*          PERFORM 0030-BUILD-BUFFER
  6120*                                THRU 0030-EXIT
  6121*          PERFORM 0020-SEND-BUFFER
  6122*                                THRU 0020-EXIT
  6123*          SET ALREADY-SENT      TO TRUE
  6124*          MOVE SPACES           TO WS-COMMENT
  6125           GO TO 0400-EXIT
  6126*          PERFORM 0025-CLOSE-SOCKET
  6127*                                THRU 0025-EXIT
  6128*          GO TO 0010-RETURN
  6129        END-IF
  6130     END-IF
  6131     IF CM-LF-CURRENT-STATUS = '7'
  6132        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  6133           MOVE ' DEATH CLAIM APPLIED '
  6134                                 TO WS-COMMENT
  6135           MOVE 'D'              TO WS-LF-STATUS
  6136*          PERFORM 0030-BUILD-BUFFER
  6137*                                THRU 0030-EXIT
  6138*          IF NOT ALREADY-SENT
  6139*             PERFORM 0020-SEND-BUFFER
  6140*                                THRU 0020-EXIT
  6141*             SET ALREADY-SENT   TO TRUE
  6142*          END-IF
  6143           GO TO 0400-EXIT
  6144*          PERFORM 0025-CLOSE-SOCKET
  6145*                                THRU 0025-EXIT
  6146*          GO TO 0010-RETURN
  6147        END-IF
  6148     END-IF
  6149     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6150        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6151        MOVE 'LF COVERAGE EXPIRED '
  6152                                 TO WS-COMMENT
  6153        MOVE 'E'                 TO WS-LF-STATUS
  6154        GO TO 0400-EXIT
  6155     END-IF
  6156     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6157        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6158        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6159     ELSE
  6160        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6161     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 108
* SOCK03.cbl
  6162     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6163     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6164*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6165     if ws-comp-id = 'AHL'
  6166        move cm-lf-class-cd      to cp-class-code
  6167        if cp-class-code = spaces
  6168           move zeros            to cp-class-code
  6169        end-if
  6170     else
  6171        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6172     end-if
  6173     IF (ws-comp-id = 'DCC' or 'VPP')
  6174        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6175        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6176        PERFORM 0730-GET-DDF-FACTORS
  6177                                 THRU 0730-EXIT
  6178        IF PDEF-FOUND
  6179           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6180              (P1 > +8)
  6181              OR (PD-PROD-CODE (P1) = 'L')
  6182           END-PERFORM
  6183           IF P1 < +9
  6184              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6185           END-IF
  6186        END-IF
  6187     END-IF
  6188     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  6189*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  6190     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6191        CM-LF-ALT-BENEFIT-AMT
  6192*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6193     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6194                                    WS-LF-REM-BEN
  6195     move cm-lf-premium-amt      to ws-tot-lf-prem
  6196     if ws-lf-co-earnings-calc = 'B'
  6197        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6198           + CM-LF-ALT-PREMIUM-AMT
  6199     end-if
  6200     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6201     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6202        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6203        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6204     ELSE
  6205        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6206     END-IF
  6207     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6208     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6209     IF WS-LF-ST-REFUND-CALC > ZERO
  6210         MOVE WS-LF-ST-REFUND-CALC
  6211                                 TO  CP-EARNING-METHOD.
  6212     IF WS-LF-FO-REFUND-CALC > ZERO
  6213         MOVE WS-LF-FO-REFUND-CALC
  6214                                 TO  CP-EARNING-METHOD.
  6215     IF CP-RATING-METHOD = '4'
  6216        MOVE '4'                 TO CP-EARNING-METHOD
  6217     END-IF
  6218*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6219     if ws-comp-id = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 109
* SOCK03.cbl
  6220        move cm-lf-class-cd      to cp-class-code
  6221        if cp-class-code = spaces
  6222           move zeros            to cp-class-code
  6223        end-if
  6224     else
  6225        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6226     end-if
  6227     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6228     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6229                                     CP-RATING-BENEFIT-AMT.
  6230     IF CP-STATE-STD-ABBRV = 'OR'
  6231         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6232                                         CM-LF-ALT-BENEFIT-AMT.
  6233****   N O T E   ****
  6234*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6235*      THE OH HARD CODING IN ELCRFNDP
  6236     IF WS-COMP-ID = 'CID'
  6237        IF CP-STATE-STD-ABBRV = 'OH'
  6238           MOVE WS-LF-CO-EARNINGS-CALC
  6239                                 TO CP-EARNING-METHOD
  6240        END-IF
  6241     END-IF
  6242****   N O T E   ****
  6243     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6244     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6245     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6246     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6247     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6248*    IF CP-EARN-AS-NET-PAY
  6249*       IF CP-LOAN-APR <= ZEROS
  6250*          IF WS-CF-DEFAULT-APR > ZEROS
  6251*             MOVE WS-CF-DEFAULT-APR
  6252*                                TO  CP-LOAN-APR
  6253*          END-IF
  6254*       END-IF
  6255*    END-IF
  6256*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6257*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6258*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6259*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6260*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6261*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6262*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6263*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6264*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6265*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6266*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6267*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6268*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6269*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6270*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6271*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6272*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6273*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6274     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6275     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6276     DISPLAY ' MADE IT BACK FROM ELRFND '
  6277     IF (CP-ERROR-RATE-IS-ZERO)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 110
* SOCK03.cbl
  6278        OR (CP-ERROR-RATE-NOT-FOUND)
  6279        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6280        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6281          DELIMITED BY SIZE INTO WS-COMMENT
  6282        END-STRING
  6283        MOVE 'X'                 TO WS-LF-STATUS
  6284        GO TO 0400-EXIT
  6285*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6286*       IF NOT ALREADY-SENT
  6287*          PERFORM 0020-SEND-BUFFER
  6288*                                THRU 0020-EXIT
  6289*          SET ALREADY-SENT      TO TRUE
  6290*       END-IF
  6291*       PERFORM 0025-CLOSE-SOCKET
  6292*                                THRU 0025-EXIT
  6293*       GO TO 0010-RETURN
  6294     END-IF
  6295     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  6296                                    WS-TOT-LF-RFND
  6297     IF (WS-LF-STATUS = SPACES)
  6298        OR (CP-CALC-REFUND > ZEROS)
  6299        MOVE 'A'                 TO WS-LF-STATUS
  6300     END-IF
  6301     EVALUATE TRUE
  6302        WHEN CP-R-AS-R78
  6303           MOVE 'RULE 78'          TO  WS-LF-METHOD
  6304        WHEN  CP-R-AS-PRORATA
  6305           MOVE 'PRORATA'          TO  WS-LF-METHOD
  6306        WHEN CP-R-AS-CALIF
  6307           MOVE 'CALIF'            TO  WS-LF-METHOD
  6308        WHEN CP-R-AS-TEXAS
  6309           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6310        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6311           MOVE 'UTAH'             TO  WS-LF-METHOD
  6312        WHEN CP-R-AS-FARM-PLAN
  6313           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6314        WHEN CP-R-AS-NET-PAY
  6315           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6316        WHEN CP-R-AS-ANTICIPATION
  6317           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6318        WHEN CP-R-AS-MEAN
  6319           MOVE 'MEAN'             TO  WS-LF-METHOD
  6320        WHEN CP-R-AS-SUM-OF-DIGITS
  6321           MOVE 'SUM OF DIGITS'    TO  WS-LF-METHOD
  6322        WHEN CP-R-AS-REPOSSESSION
  6323           MOVE 'REPOSSESSION'     TO  WS-LF-METHOD
  6324     END-EVALUATE
  6325     IF WS-TOT-LF-RFND > ZEROS
  6326        COMPUTE WS-WORK-FACTOR ROUNDED =
  6327           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6328        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6329           WS-TOT-LF-COMM
  6330     END-IF
  6331     IF ERACCT-FOUND
  6332        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6333           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6334        END-IF
  6335        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 111
* SOCK03.cbl
  6336           IF (AM-COMM-CHARGEBACK (1) = 99)
  6337                     OR
  6338              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6339                     OR
  6340              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6341              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6342              MOVE ZEROS         TO WS-LF-UEC
  6343           END-IF
  6344        END-IF
  6345     END-IF
  6346     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6347        GO TO 0400-EXIT
  6348     END-IF
  6349     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6350     MOVE '2'                    TO  CP-EARNING-METHOD
  6351                                     CP-RATING-METHOD.
  6352     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6353                                     CP-REMAINING-BENEFIT
  6354                                     CP-RATING-BENEFIT-AMT.
  6355     IF CP-STATE-STD-ABBRV = 'OR'
  6356         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6357                                         CM-LF-ALT-BENEFIT-AMT.
  6358     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6359     IF ws-comp-id = 'CID'
  6360        IF (CP-STATE-STD-ABBRV = 'MN')
  6361           AND (CM-CERT-EFF-DT > X'A4FF')
  6362           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6363           MOVE '5'              TO CP-EARNING-METHOD
  6364           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6365        END-IF
  6366     END-IF
  6367     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6368     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6369     IF (CP-ERROR-RATE-IS-ZERO)
  6370        OR (CP-ERROR-RATE-NOT-FOUND)
  6371        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6372        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6373          DELIMITED BY SIZE INTO WS-COMMENT
  6374        END-STRING
  6375        MOVE 'X'              TO WS-LF-STATUS
  6376        GO TO 0400-EXIT
  6377*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6378*       IF NOT ALREADY-SENT
  6379*          PERFORM 0020-SEND-BUFFER
  6380*                                THRU 0020-EXIT
  6381*          SET ALREADY-SENT      TO TRUE
  6382*       END-IF
  6383*       PERFORM 0025-CLOSE-SOCKET
  6384*                                THRU 0025-EXIT
  6385*       GO TO 0010-RETURN
  6386     END-IF
  6387     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6388     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6389     IF WS-TOT-LF-RFND > ZEROS
  6390        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6391           WS-TOT-LF-COMM
  6392     END-IF
  6393     IF ERACCT-FOUND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 112
* SOCK03.cbl
  6394        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6395           IF (AM-COMM-CHARGEBACK (1) = 99)
  6396                     OR
  6397              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6398                     OR
  6399              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6400              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6401              MOVE ZEROS         TO WS-LF-UEC
  6402           END-IF
  6403        END-IF
  6404     END-IF
  6405     .
  6406 0400-EXIT.
  6407     EXIT.
  6408 0500-PROCESS-AH.
  6409     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  6410        GO TO 0500-EXIT
  6411     END-IF
  6412     MOVE ZEROS                  TO WS-TOT-AH-RFND
  6413                                    WS-TOT-AH-PREM
  6414                                    WS-TOT-AH-COMM
  6415                                    WS-AH-CANCEL-DATE
  6416     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6417     MOVE ' '                    TO  DC-OPTION-CODE
  6418     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6419     IF NO-CONVERSION-ERROR
  6420        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  6421     ELSE
  6422        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6423     END-IF
  6424     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6425        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6426        MOVE ' '                 TO DC-OPTION-CODE
  6427
  6428        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6429        IF NO-CONVERSION-ERROR
  6430           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6431        ELSE
  6432           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6433        END-IF
  6434     END-IF
  6435     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6436     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6437     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6438     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6439     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6440     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6441     MOVE CM-STATE               TO  CP-STATE.
  6442     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6443     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6444     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6445     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6446     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6447     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6448     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6449     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6450     MOVE WS-CF-CR-REM-TERM-CALC
  6451                                 TO  CP-REM-TERM-METHOD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 113
* SOCK03.cbl
  6452     IF WS-AH-CO-REM-TERM-CALC > '0'
  6453         MOVE WS-AH-CO-REM-TERM-CALC
  6454                                 TO  CP-REM-TERM-METHOD.
  6455     IF WS-AH-ST-REM-TERM-CALC > '0'
  6456         MOVE WS-AH-ST-REM-TERM-CALC
  6457                                 TO  CP-REM-TERM-METHOD.
  6458     IF WS-AH-AM-REM-TERM-CALC > '0'
  6459         MOVE WS-AH-AM-REM-TERM-CALC
  6460                                 TO  CP-REM-TERM-METHOD.
  6461     IF (WS-COMP-ID = 'CID')
  6462        AND (CP-STATE-STD-ABBRV = 'WI')
  6463        MOVE '7'                 TO CP-REM-TERM-METHOD
  6464        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6465     END-IF
  6466     IF (WS-COMP-ID = 'CID')
  6467        AND (CP-STATE-STD-ABBRV = 'MO')
  6468        AND (CM-CERT-EFF-DT >= X'9B41')
  6469        AND (CM-CERT-EFF-DT <= X'A2FB')
  6470        MOVE '7'                 TO CP-REM-TERM-METHOD
  6471        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6472     END-IF
  6473     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6474                                     CP-LOAN-TERM.
  6475     IF  NOT  CP-TERM-IS-DAYS
  6476         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6477             MOVE CM-PMT-EXTENSION-DAYS
  6478                                 TO  CP-TERM-OR-EXT-DAYS
  6479         ELSE
  6480             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6481     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  6482     IF CM-AH-COMM-PCT > ZEROS
  6483        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6484           CM-AH-PREMIUM-AMT
  6485     END-IF
  6486     IF (ws-comp-id = 'DCC' or 'VPP')
  6487        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6488        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6489           (cm-ah-clp + cm-addl-clp)
  6490     end-if
  6491     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6492     IF WS-AH-STATUS = 'D'
  6493        GO TO 0500-EXIT
  6494     END-IF
  6495     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6496     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6497     MOVE ' '                    TO WS-CLM-STOP-SW
  6498     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6499     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6500
  6501* EXEC CICS STARTBR
  6502*       DATASET     ('ELMSTR5')
  6503*       RIDFLD      (ELMSTR-KEY)
  6504*       RESP        (WS-RESPONSE)
  6505*    END-EXEC
  6506     MOVE 'ELMSTR5' TO DFHEIV1
  6507     MOVE 0
  6508       TO DFHEIV11
  6509*    MOVE '&,         G          &  N#00006050' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 114
* SOCK03.cbl
  6510     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6512     MOVE X'204E233030303036303530' TO DFHEIV0(25:11)
  6513     CALL 'kxdfhei1' USING DFHEIV0,
  6514           DFHEIV1,
  6515           ELMSTR-KEY,
  6516           DFHEIV99,
  6517           DFHEIV11,
  6518           DFHEIV99
  6519     MOVE EIBRESP  TO WS-RESPONSE
  6520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6521     DISPLAY ' AFTER START ' WS-RESPONSE
  6522     IF RESP-NORMAL
  6523        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6524           DISPLAY ' AH READNEXT '
  6525
  6526* EXEC CICS READNEXT
  6527*             DATASET   ('ELMSTR5')
  6528*             RIDFLD    (ELMSTR-KEY)
  6529*             INTO      (CLAIM-MASTER)
  6530*             RESP      (WS-RESPONSE)
  6531*          END-EXEC
  6532     MOVE LENGTH OF
  6533      CLAIM-MASTER
  6534       TO DFHEIV12
  6535     MOVE 'ELMSTR5' TO DFHEIV1
  6536     MOVE 0
  6537       TO DFHEIV11
  6538*    MOVE '&.IL                  )  N#00006059' TO DFHEIV0
  6539     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6540     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6541     MOVE X'204E233030303036303539' TO DFHEIV0(25:11)
  6542     CALL 'kxdfhei1' USING DFHEIV0,
  6543           DFHEIV1,
  6544           CLAIM-MASTER,
  6545           DFHEIV12,
  6546           ELMSTR-KEY,
  6547           DFHEIV99,
  6548           DFHEIV11,
  6549           DFHEIV99,
  6550           DFHEIV99
  6551     MOVE EIBRESP  TO WS-RESPONSE
  6552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6553        IF (RESP-NORMAL OR RESP-DUPKEY)
  6554           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6555           AND (CM-CERT-NO = CL-CERT-NO)
  6556           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6557              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6558              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6559                 IF CLAIM-IS-OPEN
  6560                    DISPLAY ' FOUND OPEN AH CLAIM '
  6561                    MOVE ' OPEN HEALTH CLAIM '
  6562                                 TO WS-COMMENT
  6563                    MOVE 'H'     TO WS-AH-STATUS
  6564                 ELSE
  6565                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6566                    MOVE ' CLOSED HEALTH CLAIM '
  6567                                 TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 115
* SOCK03.cbl
  6568                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6569                       MOVE CL-PAID-THRU-DT
  6570                                 TO WS-AH-BIN-PAID-THRU-DT
  6571                    END-IF
  6572                 END-IF
  6573              END-IF
  6574           END-IF
  6575        ELSE
  6576           SET I-SAY-TO-STOP TO TRUE
  6577        END-IF
  6578        END-PERFORM
  6579
  6580* EXEC CICS ENDBR
  6581*          DATASET   ('ELMSTR5')
  6582*       END-EXEC
  6583     MOVE 'ELMSTR5' TO DFHEIV1
  6584     MOVE 0
  6585       TO DFHEIV11
  6586*    MOVE '&2                    $   #00006091' TO DFHEIV0
  6587     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6588     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6589     MOVE X'2020233030303036303931' TO DFHEIV0(25:11)
  6590     CALL 'kxdfhei1' USING DFHEIV0,
  6591           DFHEIV1,
  6592           DFHEIV11,
  6593           DFHEIV99
  6594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6595     END-IF
  6596     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6597*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6598        MOVE WS-AH-BIN-PAID-THRU-DT
  6599                                 TO DC-BIN-DATE-1
  6600        MOVE ' '                 TO DC-OPTION-CODE
  6601        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6602        IF NO-CONVERSION-ERROR
  6603           MOVE DC-GREG-DATE-CYMD
  6604                                 TO WS-CLM-PAID-THRU-DT
  6605        ELSE
  6606           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6607        END-IF
  6608        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6609           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6610                                 TO WS-COMMENT
  6611           MOVE 'P'              TO WS-AH-STATUS
  6612           GO TO 0500-EXIT
  6613        END-IF
  6614     END-IF
  6615     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6616     IF CM-AH-CURRENT-STATUS = '8'
  6617        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6618           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6619                                 TO WS-COMMENT
  6620           MOVE 'C'              TO WS-AH-STATUS
  6621           move cm-ah-itd-cancel-amt
  6622                                 to ws-ah-refund
  6623           GO TO 0500-EXIT
  6624        END-IF
  6625     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 116
* SOCK03.cbl
  6626     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6627        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6628           MOVE ' SETTLEMENT CLAIM APPLIED '
  6629                                 TO WS-COMMENT
  6630           MOVE 'S'              TO WS-AH-STATUS
  6631*          PERFORM 0030-BUILD-BUFFER
  6632*                                THRU 0030-EXIT
  6633*          IF NOT ALREADY-SENT
  6634*             PERFORM 0020-SEND-BUFFER
  6635*                                THRU 0020-EXIT
  6636*             SET ALREADY-SENT   TO TRUE
  6637*          END-IF
  6638           GO TO 0500-EXIT
  6639*          PERFORM 0025-CLOSE-SOCKET
  6640*                                THRU 0025-EXIT
  6641*          GO TO 0010-RETURN
  6642        END-IF
  6643     END-IF
  6644     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6645        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6646        MOVE 'AH COVERAGE EXPIRED '
  6647                                 TO WS-COMMENT
  6648        MOVE 'E'                 TO WS-AH-STATUS
  6649        GO TO 0500-EXIT
  6650     END-IF
  6651     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6652                                    WS-AH-PREM
  6653     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6654     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6655        * CP-REMAINING-TERM-1
  6656     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6657                                     WS-AH-REM-TERM
  6658     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6659     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6660     IF WS-AH-ST-REFUND-CALC > ZERO
  6661         MOVE WS-AH-ST-REFUND-CALC
  6662                                 TO  CP-EARNING-METHOD.
  6663     IF WS-AH-FO-REFUND-CALC > ZERO
  6664         MOVE WS-AH-FO-REFUND-CALC
  6665                                 TO  CP-EARNING-METHOD.
  6666*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6667     if ws-comp-id = 'AHL'
  6668        move cm-ah-class-cd      to cp-class-code
  6669        if cp-class-code = spaces
  6670           move zeros            to cp-class-code
  6671        end-if
  6672     else
  6673        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6674     end-if
  6675     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6676     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6677                                     CP-RATING-BENEFIT-AMT.
  6678     IF CP-STATE-STD-ABBRV = 'OR'
  6679         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6680                                         CM-AH-ORIG-TERM.
  6681     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6682     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6683     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 117
* SOCK03.cbl
  6684     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6685     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6686     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6687     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6688     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6689     MOVE ' '                    TO  DC-OPTION-CODE.
  6690     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6691     IF CP-STATE-STD-ABBRV = 'OH'
  6692        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6693         IF (CP-ORIGINAL-TERM > 60)
  6694           AND (DC-GREG-DATE-1-YMD > '831101')
  6695           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6696             MOVE '6'            TO  CP-EARNING-METHOD
  6697         END-IF
  6698        END-IF
  6699        IF WS-COMP-ID = 'CID'
  6700           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6701                           LOW-VALUES)
  6702              IF CP-CRITICAL-PERIOD
  6703                 MOVE '2'       TO CP-EARNING-METHOD
  6704              ELSE
  6705                 MOVE '6'       TO CP-EARNING-METHOD
  6706              END-IF
  6707           ELSE
  6708              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6709                 MOVE '2'       TO CP-EARNING-METHOD
  6710              ELSE
  6711                 IF ((CM-LF-ORIG-TERM > 60) AND
  6712                    (CM-RATE-CLASS NOT = 'L '))
  6713                               OR
  6714                    (WS-LF-CO-EARNINGS-CALC = '5')
  6715                    IF CP-CRITICAL-PERIOD
  6716                       MOVE '2'  TO CP-EARNING-METHOD
  6717                    ELSE
  6718                       MOVE '6'  TO CP-EARNING-METHOD
  6719                    END-IF
  6720                 ELSE
  6721                    MOVE '1'     TO CP-EARNING-METHOD
  6722                 END-IF
  6723              END-IF
  6724           END-IF
  6725        END-IF
  6726     END-IF
  6727     IF CP-STATE-STD-ABBRV = 'VA'
  6728       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6729         IF DC-GREG-DATE-1-YMD > '921231'
  6730            IF CP-ORIGINAL-TERM > 61
  6731                MOVE '6'            TO  CP-EARNING-METHOD
  6732            ELSE
  6733                MOVE '1'            TO  CP-EARNING-METHOD.
  6734*    IF CP-EARN-AS-NET-PAY
  6735*       IF CP-LOAN-APR <= ZEROS
  6736*          IF WS-CF-DEFAULT-APR > ZEROS
  6737*             MOVE WS-CF-DEFAULT-APR
  6738*                                TO  CP-LOAN-APR
  6739*          END-IF
  6740*       END-IF
  6741*    END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 118
* SOCK03.cbl
  6742     IF WS-COMP-ID = 'DCC' or 'VPP'
  6743        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6744           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6745           MOVE 'S'              TO CP-EARNING-METHOD
  6746        END-IF
  6747     END-IF
  6748     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6749     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6750        AND (CP-EARNING-METHOD = 'D')
  6751        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6752                                    WS-DDF-CSO-ADMIN-FEE
  6753                                    WS-DDF-1ST-YR-TOT-EXP
  6754                                    WS-DDF-COMM-AND-MFEE
  6755        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6756           S1 > +10
  6757           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6758              IF (AM-A-COM (S1) NUMERIC)
  6759                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6760                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6761              ELSE
  6762                 MOVE +0         TO WS-COMM-PCT C0
  6763                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6764                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6765              END-IF
  6766              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6767                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6768                    + WS-COMM-PCT
  6769              END-IF
  6770              IF AM-COM-TYP (S1) = 'N'
  6771                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6772                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6773              END-IF
  6774              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6775                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6776                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6777              END-IF
  6778              IF AM-COM-TYP (S1) = 'I'
  6779                 COMPUTE WS-DDF-COMM-AND-MFEE
  6780                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6781              END-IF
  6782           END-IF
  6783        END-PERFORM
  6784        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6785        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6786        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6787           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6788     END-IF
  6789     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6790        AND (CP-EARNING-METHOD = 'D')
  6791        AND (ws-CANCEL-REASON NOT = 'R')
  6792        PERFORM 0730-GET-DDF-FACTORS
  6793                                 THRU 0730-EXIT
  6794        IF NOT PDEF-FOUND
  6795           MOVE ' DDF UE FACTORS  NOT FOUND '
  6796                                 TO WS-COMMENT
  6797           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6798           PERFORM 0030-BUILD-BUFFER
  6799                                 THRU 0030-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 119
* SOCK03.cbl
  6800           PERFORM 0020-SEND-BUFFER
  6801                                 THRU 0020-EXIT
  6802           PERFORM 0025-CLOSE-SOCKET
  6803                                 THRU 0025-EXIT
  6804           GO TO 0010-RETURN
  6805        END-IF
  6806*       IF NOT PDEF-FOUND
  6807*          MOVE ER-9999          TO EMI-ERROR
  6808*          PERFORM 9700-ERROR-FORMAT
  6809*                                THRU 9799-EXIT
  6810*          GO TO 8200-SEND-DATAONLY
  6811*       END-IF
  6812        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6813                                 TO CP-DDF-LO-FACT
  6814        MOVE PD-UEP-FACTOR (P1 P2)
  6815                                 TO CP-DDF-HI-FACT
  6816        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6817        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6818        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6819        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6820           + PD-1ST-YR-ADMIN-ALLOW
  6821        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6822*       IF PI-CLP-YN = 'Y'
  6823*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6824*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6825*                                   CP-DDF-CLP
  6826*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6827*       END-IF
  6828        IF DD-IU-PRESENT
  6829           MOVE 'I'              TO CP-EARNING-METHOD
  6830        END-IF
  6831        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6832                                    CP-CLP-RATE-UP
  6833        IF (CP-CALC-GROSS-FEE)
  6834           AND (CP-IU-RATE-UP NOT = ZEROS)
  6835           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6836              / CP-ORIGINAL-PREMIUM)
  6837           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6838              / (1 - TEX-FACT-8)
  6839        END-IF
  6840     END-IF
  6841     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6842     IF (CP-ERROR-RATE-IS-ZERO)
  6843        OR (CP-ERROR-RATE-NOT-FOUND)
  6844        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6845        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6846          DELIMITED BY SIZE INTO WS-COMMENT
  6847        END-STRING
  6848        IF WS-AH-STATUS NOT = 'H'
  6849           MOVE 'X'                 TO WS-AH-STATUS
  6850        END-IF
  6851        GO TO 0500-EXIT
  6852*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6853*       IF NOT ALREADY-SENT
  6854*          PERFORM 0020-SEND-BUFFER
  6855*                                THRU 0020-EXIT
  6856*          SET ALREADY-SENT      TO TRUE
  6857*       END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 120
* SOCK03.cbl
  6858*       PERFORM 0025-CLOSE-SOCKET
  6859*                                THRU 0025-EXIT
  6860*       GO TO 0010-RETURN
  6861     END-IF
  6862     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6863                                    WS-TOT-AH-RFND
  6864     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6865     IF ((WS-AH-STATUS = SPACES)
  6866        OR (CP-CALC-REFUND > ZEROS))
  6867                  AND
  6868          (WS-AH-STATUS NOT = 'H')
  6869        MOVE 'A'                 TO WS-AH-STATUS
  6870     END-IF
  6871     IF WS-COMP-ID = 'DCC' or 'VPP'
  6872        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6873        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6874        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6875        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6876        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6877        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6878        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6879        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6880        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6881     END-IF
  6882     EVALUATE TRUE
  6883        WHEN CP-R-AS-R78
  6884           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6885        WHEN CP-R-AS-PRORATA
  6886           MOVE 'PRORATA'          TO  WS-AH-METHOD
  6887        WHEN CP-REFUND-TYPE-USED = '3'
  6888           MOVE 'CALIF'            TO  WS-AH-METHOD
  6889        WHEN CP-R-AS-TEXAS
  6890           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6891        WHEN CP-R-AS-FARM-PLAN
  6892           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6893        WHEN CP-R-AS-NET-PAY
  6894           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6895        WHEN CP-R-AS-ANTICIPATION
  6896           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6897        WHEN CP-R-AS-MEAN
  6898           MOVE 'MEAN'             TO  WS-AH-METHOD
  6899        WHEN CP-R-AS-SUM-OF-DIGITS
  6900           MOVE 'SUM OF DIGITS'    TO  WS-AH-METHOD
  6901        WHEN CP-GAP-ACTUARIAL
  6902           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6903        WHEN CP-R-AS-REPOSSESSION
  6904           MOVE 'REPOSSESSION'     TO WS-AH-METHOD
  6905     END-EVALUATE
  6906     IF WS-TOT-AH-RFND > ZEROS
  6907        IF (ws-comp-id = 'DCC' or 'VPP')
  6908           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6909           compute ws-work-factor rounded =
  6910              ws-ah-rfnd-clp / cm-ah-clp
  6911        else
  6912           COMPUTE WS-WORK-FACTOR ROUNDED =
  6913              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6914        end-if
  6915        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 121
* SOCK03.cbl
  6916           WS-TOT-AH-COMM
  6917     END-IF
  6918     IF ERACCT-FOUND
  6919        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6920           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6921        END-IF
  6922        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6923           IF (AM-COMM-CHARGEBACK (1) = 99)
  6924                     OR
  6925              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6926                     OR
  6927              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6928              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6929              MOVE ZEROS         TO WS-AH-UEC
  6930           END-IF
  6931        END-IF
  6932     END-IF
  6933     .
  6934 0500-EXIT.
  6935     EXIT.
  6936 0610-GET-ERMAIL.
  6937
  6938     move cm-control-primary     to ws-ma-key
  6939*    MOVE WS-CM-KEY              TO WS-MA-KEY
  6940
  6941* EXEC CICS READ
  6942*       INTO    (MAILING-DATA)
  6943*       DATASET ('ERMAIL')
  6944*       RIDFLD  (WS-MA-KEY)
  6945*       RESP    (WS-RESPONSE)
  6946*    END-EXEC
  6947     MOVE LENGTH OF
  6948      MAILING-DATA
  6949       TO DFHEIV11
  6950     MOVE 'ERMAIL' TO DFHEIV1
  6951*    MOVE '&"IL       E          (  N#00006439' TO DFHEIV0
  6952     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6954     MOVE X'204E233030303036343339' TO DFHEIV0(25:11)
  6955     CALL 'kxdfhei1' USING DFHEIV0,
  6956           DFHEIV1,
  6957           MAILING-DATA,
  6958           DFHEIV11,
  6959           WS-MA-KEY,
  6960           DFHEIV99,
  6961           DFHEIV99,
  6962           DFHEIV99
  6963     MOVE EIBRESP  TO WS-RESPONSE
  6964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6965
  6966     IF RESP-NORMAL
  6967        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6968     else
  6969        move spaces              to ws-cred-bene-name
  6970     end-if
  6971
  6972     .
  6973 0610-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 122
* SOCK03.cbl
  6974     EXIT.
  6975 0620-GET-ELCRTT.
  6976
  6977     move cm-control-primary     to ws-cs-key
  6978*    MOVE WS-CM-KEY              TO WS-CS-KEY
  6979     move 'C'                    to WS-CS-TRLR-TYPE
  6980
  6981
  6982* EXEC CICS READ
  6983*       INTO    (CERTIFICATE-TRAILERS)
  6984*       DATASET ('ELCRTT')
  6985*       RIDFLD  (WS-CS-KEY)
  6986*       RESP    (WS-RESPONSE)
  6987*    END-EXEC
  6988     MOVE LENGTH OF
  6989      CERTIFICATE-TRAILERS
  6990       TO DFHEIV11
  6991     MOVE 'ELCRTT' TO DFHEIV1
  6992*    MOVE '&"IL       E          (  N#00006461' TO DFHEIV0
  6993     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6995     MOVE X'204E233030303036343631' TO DFHEIV0(25:11)
  6996     CALL 'kxdfhei1' USING DFHEIV0,
  6997           DFHEIV1,
  6998           CERTIFICATE-TRAILERS,
  6999           DFHEIV11,
  7000           WS-CS-KEY,
  7001           DFHEIV99,
  7002           DFHEIV99,
  7003           DFHEIV99
  7004     MOVE EIBRESP  TO WS-RESPONSE
  7005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7006
  7007     IF RESP-NORMAL
  7008        MOVE cs-vin-number       to ws-vin
  7009     else
  7010        move spaces              to ws-vin
  7011     end-if
  7012
  7013     .
  7014 0620-EXIT.
  7015     EXIT.
  7016 0700-LINK-REM-TERM.
  7017
  7018* EXEC CICS LINK
  7019*        PROGRAM   ('ELRTRM')
  7020*        COMMAREA  (CALCULATION-PASS-AREA)
  7021*        LENGTH    (CP-COMM-LENGTH)
  7022*    END-EXEC.
  7023     MOVE 'ELRTRM' TO DFHEIV1
  7024*    MOVE '."C                   (   #00006478' TO DFHEIV0
  7025     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7027     MOVE X'2020233030303036343738' TO DFHEIV0(25:11)
  7028     CALL 'kxdfhei1' USING DFHEIV0,
  7029           DFHEIV1,
  7030           CALCULATION-PASS-AREA,
  7031           CP-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 123
* SOCK03.cbl
  7032           DFHEIV99,
  7033           DFHEIV99,
  7034           DFHEIV99,
  7035           DFHEIV99
  7036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7037
  7038 0700-EXIT.
  7039     EXIT.
  7040 0710-LINK-REM-AMOUNT.
  7041
  7042* EXEC CICS LINK
  7043*        PROGRAM   ('ELRAMT')
  7044*        COMMAREA  (CALCULATION-PASS-AREA)
  7045*        LENGTH    (CP-COMM-LENGTH)
  7046*    END-EXEC
  7047     MOVE 'ELRAMT' TO DFHEIV1
  7048*    MOVE '."C                   (   #00006486' TO DFHEIV0
  7049     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7051     MOVE X'2020233030303036343836' TO DFHEIV0(25:11)
  7052     CALL 'kxdfhei1' USING DFHEIV0,
  7053           DFHEIV1,
  7054           CALCULATION-PASS-AREA,
  7055           CP-COMM-LENGTH,
  7056           DFHEIV99,
  7057           DFHEIV99,
  7058           DFHEIV99,
  7059           DFHEIV99
  7060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7061     .
  7062 0710-EXIT.
  7063     EXIT.
  7064 0720-LINK-REFUND.
  7065
  7066* EXEC CICS LINK
  7067*        PROGRAM   ('ELRFND')
  7068*        COMMAREA  (CALCULATION-PASS-AREA)
  7069*        LENGTH    (CP-COMM-LENGTH)
  7070*    END-EXEC
  7071     MOVE 'ELRFND' TO DFHEIV1
  7072*    MOVE '."C                   (   #00006495' TO DFHEIV0
  7073     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7075     MOVE X'2020233030303036343935' TO DFHEIV0(25:11)
  7076     CALL 'kxdfhei1' USING DFHEIV0,
  7077           DFHEIV1,
  7078           CALCULATION-PASS-AREA,
  7079           CP-COMM-LENGTH,
  7080           DFHEIV99,
  7081           DFHEIV99,
  7082           DFHEIV99,
  7083           DFHEIV99
  7084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7085     .
  7086 0720-EXIT.
  7087     EXIT.
  7088 0730-GET-DDF-FACTORS.
  7089     MOVE ' '                    TO WS-PDEF-RECORD-SW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 124
* SOCK03.cbl
  7090     MOVE WS-COMP-CD             TO ERPDEF-KEY
  7091     MOVE CM-STATE               TO ERPDEF-STATE
  7092     if cm-clp-state not = cm-state and spaces and zeros
  7093        move cm-clp-state        to erpdef-state
  7094     end-if
  7095     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7096     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7097     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7098     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7099     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7100
  7101* EXEC CICS STARTBR
  7102*        DATASET  ('ERPDEF')
  7103*        RIDFLD   (ERPDEF-KEY)
  7104*        GTEQ
  7105*        RESP     (WS-RESPONSE)
  7106*    END-EXEC
  7107     MOVE 'ERPDEF' TO DFHEIV1
  7108     MOVE 0
  7109       TO DFHEIV11
  7110*    MOVE '&,         G          &  N#00006515' TO DFHEIV0
  7111     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7113     MOVE X'204E233030303036353135' TO DFHEIV0(25:11)
  7114     CALL 'kxdfhei1' USING DFHEIV0,
  7115           DFHEIV1,
  7116           ERPDEF-KEY,
  7117           DFHEIV99,
  7118           DFHEIV11,
  7119           DFHEIV99
  7120     MOVE EIBRESP  TO WS-RESPONSE
  7121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7122     IF NOT RESP-NORMAL
  7123        GO TO 0730-EXIT
  7124     END-IF
  7125     .
  7126 0730-READNEXT.
  7127
  7128* EXEC CICS READNEXT
  7129*       DATASET  ('ERPDEF')
  7130*       INTO     (PRODUCT-MASTER)
  7131*       RIDFLD   (ERPDEF-KEY)
  7132*       RESP     (WS-RESPONSE)
  7133*    END-EXEC
  7134     MOVE LENGTH OF
  7135      PRODUCT-MASTER
  7136       TO DFHEIV12
  7137     MOVE 'ERPDEF' TO DFHEIV1
  7138     MOVE 0
  7139       TO DFHEIV11
  7140*    MOVE '&.IL                  )  N#00006526' TO DFHEIV0
  7141     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7142     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7143     MOVE X'204E233030303036353236' TO DFHEIV0(25:11)
  7144     CALL 'kxdfhei1' USING DFHEIV0,
  7145           DFHEIV1,
  7146           PRODUCT-MASTER,
  7147           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 125
* SOCK03.cbl
  7148           ERPDEF-KEY,
  7149           DFHEIV99,
  7150           DFHEIV11,
  7151           DFHEIV99,
  7152           DFHEIV99
  7153     MOVE EIBRESP  TO WS-RESPONSE
  7154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7155     IF NOT RESP-NORMAL
  7156        GO TO 0730-ENDBR
  7157     END-IF
  7158     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7159        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7160           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7161        ELSE
  7162           GO TO 0730-READNEXT
  7163        END-IF
  7164     ELSE
  7165        GO TO 0730-ENDBR
  7166     END-IF
  7167     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7168        (P1 > +8)
  7169        OR (PD-PROD-CODE (P1) = 'I')
  7170     END-PERFORM
  7171     IF P1 < +9
  7172        SET DD-IU-PRESENT        TO TRUE
  7173     END-IF
  7174     IF CM-LOAN-TERM = ZEROS
  7175        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7176     END-IF
  7177     IF PD-TRUNCATED = 'Y'
  7178        MOVE CM-LOAN-TERM        TO WS-TERM
  7179     ELSE
  7180        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7181     END-IF
  7182     EVALUATE TRUE
  7183        WHEN WS-TERM > +168
  7184           MOVE 15               TO P1
  7185        WHEN WS-TERM > +156
  7186           MOVE 14               TO P1
  7187        WHEN WS-TERM > +144
  7188           MOVE 13               TO P1
  7189        WHEN WS-TERM > +132
  7190           MOVE 12               TO P1
  7191        WHEN WS-TERM > +120
  7192           MOVE 11               TO P1
  7193        WHEN WS-TERM > +108
  7194           MOVE 10               TO P1
  7195        WHEN WS-TERM > +96
  7196           MOVE 9                TO P1
  7197        WHEN WS-TERM > +84
  7198           MOVE 8                TO P1
  7199        WHEN WS-TERM > +72
  7200           MOVE 7                TO P1
  7201        WHEN WS-TERM > +60
  7202           MOVE 6                TO P1
  7203        WHEN WS-TERM > +48
  7204           MOVE 5                TO P1
  7205        WHEN WS-TERM > +36
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 126
* SOCK03.cbl
  7206           MOVE 4                TO P1
  7207        WHEN WS-TERM > +24
  7208           MOVE 3                TO P1
  7209        WHEN WS-TERM > +12
  7210           MOVE 2                TO P1
  7211        WHEN OTHER
  7212           MOVE 1                TO P1
  7213     END-EVALUATE
  7214     EVALUATE TRUE
  7215*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7216*          AND (DD-IU-PRESENT)
  7217*          MOVE 2                TO P2
  7218*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7219*          MOVE 1                TO P2
  7220        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7221           MOVE 2                TO P2
  7222        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7223           MOVE 3                TO P2
  7224        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7225           MOVE 4                TO P2
  7226        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7227           MOVE 5                TO P2
  7228        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7229           MOVE 6                TO P2
  7230        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7231           MOVE 7                TO P2
  7232        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7233           MOVE 8                TO P2
  7234        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7235           MOVE 9                TO P2
  7236        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7237           MOVE 10               TO P2
  7238        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7239           MOVE 11               TO P2
  7240        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7241           MOVE 12               TO P2
  7242        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7243           MOVE 13               TO P2
  7244        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7245           MOVE 14               TO P2
  7246        WHEN OTHER
  7247           MOVE 15               TO P2
  7248     END-EVALUATE
  7249     .
  7250 0730-ENDBR.
  7251
  7252* EXEC CICS ENDBR
  7253*       DATASET  ('ERPDEF')
  7254*    END-EXEC
  7255     MOVE 'ERPDEF' TO DFHEIV1
  7256     MOVE 0
  7257       TO DFHEIV11
  7258*    MOVE '&2                    $   #00006628' TO DFHEIV0
  7259     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7260     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7261     MOVE X'2020233030303036363238' TO DFHEIV0(25:11)
  7262     CALL 'kxdfhei1' USING DFHEIV0,
  7263           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 127
* SOCK03.cbl
  7264           DFHEIV11,
  7265           DFHEIV99
  7266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7267     .
  7268 0730-EXIT.
  7269     EXIT.
  7270 0740-GET-ERCTBL.
  7271     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7272     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7273     MOVE 'A'                    TO CTBL-BEN-TYPE
  7274     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7275     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7276     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7277     IF RESP-NORMAL
  7278        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7279     ELSE
  7280        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7281        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7282        MOVE 'A'                    TO CTBL-BEN-TYPE
  7283        MOVE 'AA'                   TO CTBL-BEN-CODE
  7284        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7285        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7286        IF RESP-NORMAL
  7287           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7288        END-IF
  7289     END-IF
  7290     .
  7291 0740-EXIT.
  7292     EXIT.
  7293 0750-READ-ERCTBL.
  7294
  7295* EXEC CICS READ
  7296*         INTO    (COMM-TABLE-RECORD)
  7297*         DATASET ('ERCTBL')
  7298*         RIDFLD  (CTBL-KEY)
  7299*         RESP    (WS-RESPONSE)
  7300*    END-EXEC
  7301     MOVE LENGTH OF
  7302      COMM-TABLE-RECORD
  7303       TO DFHEIV11
  7304     MOVE 'ERCTBL' TO DFHEIV1
  7305*    MOVE '&"IL       E          (  N#00006658' TO DFHEIV0
  7306     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7308     MOVE X'204E233030303036363538' TO DFHEIV0(25:11)
  7309     CALL 'kxdfhei1' USING DFHEIV0,
  7310           DFHEIV1,
  7311           COMM-TABLE-RECORD,
  7312           DFHEIV11,
  7313           CTBL-KEY,
  7314           DFHEIV99,
  7315           DFHEIV99,
  7316           DFHEIV99
  7317     MOVE EIBRESP  TO WS-RESPONSE
  7318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7319     .
  7320 0750-EXIT.
  7321     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 128
* SOCK03.cbl
  7322 0760-FIND-COMM.
  7323     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7324        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7325        OR (C1 > +3)
  7326     END-PERFORM
  7327     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7328        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7329        OR (C2 > +3)
  7330     END-PERFORM
  7331     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7332        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7333        OR (C3 > +3)
  7334     END-PERFORM
  7335     IF C1 > +3
  7336        MOVE +1                  TO C1
  7337     END-IF
  7338     IF C2 > +3
  7339        MOVE +1                  TO C2
  7340     END-IF
  7341     IF C3 > +3
  7342        MOVE +1                  TO C3
  7343     END-IF
  7344     IF C1 = +3
  7345        MOVE +18                 TO C0
  7346     ELSE
  7347        IF C1 = +2
  7348           MOVE +9               TO C0
  7349        END-IF
  7350     END-IF
  7351     IF C2 = +3
  7352        ADD +6                   TO C0
  7353     ELSE
  7354        IF C2 = +2
  7355           ADD +3                TO C0
  7356        END-IF
  7357     END-IF
  7358     ADD C3                      TO C0
  7359     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7360     .
  7361 0760-EXIT.
  7362     EXIT.
  7363 9700-DATE-LINK.
  7364
  7365* EXEC CICS LINK
  7366*         PROGRAM  ('ELDATCV')
  7367*         COMMAREA (DATE-CONVERSION-DATA)
  7368*         LENGTH   (DC-COMM-LENGTH)
  7369*    END-EXEC.
  7370     MOVE 'ELDATCV' TO DFHEIV1
  7371*    MOVE '."C                   (   #00006709' TO DFHEIV0
  7372     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7373     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7374     MOVE X'2020233030303036373039' TO DFHEIV0(25:11)
  7375     CALL 'kxdfhei1' USING DFHEIV0,
  7376           DFHEIV1,
  7377           DATE-CONVERSION-DATA,
  7378           DC-COMM-LENGTH,
  7379           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-19 08:20 Page 129
* SOCK03.cbl
  7380           DFHEIV99,
  7381           DFHEIV99,
  7382           DFHEIV99
  7383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7384
  7385 9700-EXIT.
  7386      EXIT.
  7387
  7388 9999-DFHBACK SECTION.
  7389     MOVE '9%                    "   ' TO DFHEIV0
  7390     MOVE 'SOCK03' TO DFHEIV1
  7391     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7392     GOBACK.
  7393 9999-DFHEXIT.
  7394     IF DFHEIGDJ EQUAL 0001
  7395         NEXT SENTENCE.
  7396     MOVE '9%                    "   ' TO DFHEIV0
  7397     MOVE 'SOCK03' TO DFHEIV1
  7398     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7399     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20048     Code:       31033
