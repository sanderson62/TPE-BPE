* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45******************************************************************
    46
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   3
* EL156.cbl
    48 ENVIRONMENT DIVISION.
    49
    50 DATA DIVISION.
    51
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54
    55 77  FILLER  PIC X(32)  VALUE '********************************'.
    56 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    57 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    58 77  WS-SSN  PIC X(9) VALUE ZEROS.
    59 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    60 77  C0                          PIC S999 COMP-3 VALUE +0.
    61 77  C1                          PIC S999 COMP-3 VALUE +0.
    62 77  C2                          PIC S999 COMP-3 VALUE +0.
    63 77  C3                          PIC S999 COMP-3 VALUE +0.
    64 77  s1                          PIC S999 COMP-3 VALUE +0.
    65 77  s2                          pic s999 comp-3 value +0.
    66 77  P1                          PIC S999 COMP-3 VALUE +0.
    67 77  DD-IU-SW                    PIC X   VALUE ' '.
    68     88  DD-IU-PRESENT                 VALUE 'Y'.
    69 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    70 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    71 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    72 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    73 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    74 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    75 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    76 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    77 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    78
    79*    COPY ELCSCTM.
    80******************************************************************
    81*                                                                *
    82*                                                                *
    83*                            ELCSCTM                             *
    84*                            VMOD=2.001                          *
    85*                                                                *
    86*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-MESSAGE.
    90     12  FILLER                          PIC X(30)
    91            VALUE '** LOGIC SECURITY VIOLATION -'.
    92     12  SM-READ                         PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' PGM='.
    95     12  SM-PGM                          PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' OPR='.
    98     12  SM-PROCESSOR-ID                 PIC X(4).
    99     12  FILLER                          PIC X(6)
   100            VALUE ' TERM='.
   101     12  SM-TERMID                       PIC X(4).
   102     12  FILLER                          PIC XX   VALUE SPACE.
   103     12  SM-JUL-DATE                     PIC 9(5).
   104     12  FILLER                          PIC X    VALUE SPACE.
   105     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   4
* EL156.cbl
   106
   107
   108*    COPY ELCSCRTY.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCRTY                            *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   116*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   117*        SAVED IN PI-SECURITY-ADDRESS.                           *
   118*                                                                *
   119******************************************************************
   120 01  SECURITY-CONTROL.
   121     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   122     12  FILLER                       PIC XX    VALUE 'SC'.
   123     12  SC-CREDIT-CODES.
   124         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   125             20  SC-CREDIT-DISPLAY    PIC X.
   126             20  SC-CREDIT-UPDATE     PIC X.
   127     12  SC-CLAIMS-CODES.
   128         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   129             20  SC-CLAIMS-DISPLAY    PIC X.
   130             20  SC-CLAIMS-UPDATE     PIC X.
   131
   132 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   133 01  WS-DATE-AREA.
   134     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   135     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   136     12  SAVE-DATE-CCYYMMDD.
   137         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   138         16  SAVE-DATE-YMD.
   139             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   140             20  FILLER              PIC X(04)   VALUE SPACES.
   141
   142 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   143 01  STANDARD-AREAS.
   144     12  WS-RESPONSE         PIC S9(8)   COMP.
   145         88  WS-RESP-NORMAL              VALUE +00.
   146         88  WS-RESP-ERROR               VALUE +01.
   147         88  WS-RESP-NOTFND              VALUE +13.
   148         88  WS-RESP-DUPREC              VALUE +14.
   149         88  WS-RESP-ENDFILE             VALUE +20.
   150     12  PMT-HEAD-A.
   151         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   152         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   153         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   154-        '     RESERVES  TYPE    AMOUNT'.
   155     12  PMT-HEAD-B.
   156         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   157         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   158         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   159     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   160     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   161     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   162     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   163     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   5
* EL156.cbl
   164     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   165     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   166     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   167     12  PGM-NAME            PIC X(8).
   168     12  TIME-IN             PIC S9(7).
   169     12  TIME-OUT-R  REDEFINES TIME-IN.
   170         16  FILLER          PIC X.
   171         16  TIME-OUT        PIC 99V99.
   172         16  FILLER          PIC XX.
   173     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   174     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   175     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   176     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   177     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   178     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   179     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   180     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   181     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   182     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   183     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   184     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   185     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   186     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   187     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   188     12  WS-BLANK            PIC X       VALUE ' '.
   189
   190 01  MISC-WORK-AREAS.
   191     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   192     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   193     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   194     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   195     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   196     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   197     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   198     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   199     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   200     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   201     12  W-CALLED-NAME           PIC X(08).
   202     12  W-EOB-CODES.
   203         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   204             20  W-EOB-CODE      PIC XXX.
   205             20  W-EOB-FILLER    PIC X.
   206     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   207     12  W-NAME-LAST             PIC X(15).
   208     12  W-NAME-FIRST            PIC X(15).
   209     12  W-NAME-MIDDLE.
   210         16  FILLER              PIC X.
   211         16  W-NAME-MIDDLE-2     PIC X.
   212         16  FILLER              PIC X(13).
   213     12  W-DMD-CHECK-NO.
   214         16  W-DMD-CHECK-NO-1    PIC X(4).
   215         16  W-DMD-CHECK-NO-2    PIC X.
   216         16  W-DMD-CHECK-NO-3    PIC XX.
   217
   218     12  WS-COMPUTE-FROM-DT  PIC XX.
   219     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   220     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   221     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   6
* EL156.cbl
   222     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   223     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   224     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   225         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   226         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   227     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   228         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   229     12  WS-UPDATE-SW        PIC X VALUE ' '.
   230     12  WS-GROUPING.
   231         16  WS-GROUP-1      PIC X VALUE SPACES.
   232         16  FILLER          PIC X(05) VALUE SPACES.
   233     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   234     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   235     12  WS-WORK-STATE-ACCT.
   236         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   237         16  FILLER          PIC X       VALUE '/'.
   238         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   239     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   240     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   241     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   242     12  QID.
   243         16  QID-TERM        PIC X(4)    VALUE SPACES.
   244         16  FILLER          PIC X(4)    VALUE '156A'.
   245     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   246     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   247     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   248     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   249     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   250     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   251     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   252     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   253     12  WS-STATUS           PIC X       VALUE SPACES.
   254     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   255     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   256     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   257     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   258     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   259     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   260     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   261     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   262     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   263     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   264     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   265     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   266     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   267     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   268     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   269     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   270     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   271     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   272     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   273     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   274     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   275     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   276     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   277     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   278     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   279     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   7
* EL156.cbl
   280     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   281     12  WORK-DATE-FROM.
   282         16  WDF-MONTH       PIC 99        VALUE ZERO.
   283         16  WDF-DAY         PIC 99        VALUE ZERO.
   284         16  WDF-YEAR        PIC 99        VALUE ZERO.
   285     12  WORK-DATE-THRU.
   286         16  WDT-MONTH       PIC 99        VALUE ZERO.
   287         16  WDT-DAY         PIC 99        VALUE ZERO.
   288         16  WDT-YEAR        PIC 99        VALUE ZERO.
   289     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   290     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   291     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   292     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   293     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   294     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   295     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   296     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   297     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   298     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   299     12  WS-PY-WK REDEFINES WS-PY-WORK.
   300         16  WS-PY-NUM       PIC S9(7)V99.
   301         16  WS-PY-SIGN      PIC X.
   302     12  WS-DY-WORK          PIC S9(5).
   303     12  WS-DY-WK REDEFINES WS-DY-WORK.
   304         16  WS-DY-NUM       PIC S9(4).
   305         16  WS-DY-SIGN      PIC X.
   306     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   307         88  COMP-REC-FOUND              VALUE 'Y'.
   308     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   309         88  BENEFIT-FOUND       VALUE 'Y'.
   310         88  NO-BENEFIT-FOUND    VALUE 'N'.
   311     12  WS-TERMS.
   312         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   313         16  FILLER          PIC X       VALUE '/'.
   314         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   315         16  WST-REM-DAYS-GRP.
   316             20  WST-SLASH   PIC X       VALUE '/'.
   317             20  WST-REM-DAYS
   318                             PIC --9.
   319     12  WS-ACCESS.
   320         16  FILLER          PIC XX      VALUE SPACES.
   321         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   322     12  WS-STATE-ACCESS.
   323         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   324         16  FILLER          PIC XX      VALUE SPACES.
   325     12  WS-CARR-ACCESS.
   326         16  FILLER          PIC X(3)    VALUE SPACES.
   327         16  WS-CARR         PIC X       VALUE SPACES.
   328     12  DATE-WORK.
   329         16  FILLER          PIC XX      VALUE SPACES.
   330         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   331     12  WS-SAVE-INPUT.
   332         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   333         16  WS-PAYEE        PIC XX      VALUE SPACE.
   334         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   335         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   336         16  WS-OFFLINE      PIC X       VALUE SPACE.
   337         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   8
* EL156.cbl
   338         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   339         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   340         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   341         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   342         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   343         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   344         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   345         16  WS-ETYPE        PIC X       VALUE SPACE.
   346         16  WS-CASH         PIC X       VALUE SPACE.
   347         16  WS-GROUPED      PIC X       VALUE SPACE.
   348         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   349         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   350         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   351         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   352         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   353         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   354         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   355     12  LAST-ERROR-LINE.
   356         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   357         16  FILLER              PIC X(30)
   358             VALUE ' FATAL ERRORS ENCOUNTERED'.
   359         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   360         16  FILLER              PIC X(28)
   361             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   362     12  WS-CHECK-AREA.
   363         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   364         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   365     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   366     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   367         16  FILLER              PIC XX.
   368         16  WS-A-CHECK-NUM-5    PIC 9(5).
   369     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   370         16  FILLER              PIC X.
   371         16  WS-A-CHECK-NUM-6    PIC 9(6).
   372     12  OPTION-1-SAVE-AREA.
   373         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   374         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   375     12  WS-WORK-ZIP.
   376         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   377         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   378     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   379                                 PIC 9(9).
   380     12  WS-FLI-PMTNOTE.
   381         16  WS-PMTOPTION        PIC XX.
   382         16  WS-DOCNAME          PIC X(28).
   383         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   384             20  WS-AMOUNT       PIC X(8).
   385             20  FILLER          PIC X(20).
   386         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   387             20  WS-NUM-AMT      PIC 9(6)V99.
   388             20  FILLER          PIC X(20).
   389
   390     12  WS-HAN-PMTNOTE.
   391         16  WS-HAN-PMT-CODE     PIC X.
   392         16  WS-HAN-PMT-NOTE     PIC X(39).
   393
   394     12  WS-NCL-PMT-OPTION       PIC XX.
   395         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page   9
* EL156.cbl
   396
   397     12  WS-CLAIM-SEQUENCE.
   398         16  FILLER              PIC X VALUE '('.
   399         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   400         16  FILLER              PIC X(04) VALUE ' OF '.
   401         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   402         16  FILLER              PIC X VALUE ')'.
   403
   404     12  WS-REFUND-AMT           PIC Z(7).99.
   405     12  WS-CALC-INT             PIC S9(7)V99.
   406     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   407
   408     12  SUB                     PIC 99 VALUE ZEROS.
   409
   410     12  WS-BOANOTE1.
   411         16  WS-BOANOTE1-DESC    PIC X(11).
   412         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   413         16  FILLER              PIC X(17).
   414     12  WS-BOANOTE2.
   415         16  WS-BOANOTE2-DESC    PIC X(11).
   416         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   417         16  FILLER              PIC X(17).
   418
   419     12  WS-NCLNOTE1.
   420         16  WS-NCLNOTE1-DESC    PIC X(11).
   421         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   422         16  FILLER              PIC X(17).
   423     12  WS-NCLNOTE2.
   424         16  WS-NCLNOTE2-DESC    PIC X(11).
   425         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   426         16  FILLER              PIC X(17).
   427
   428     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   429     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   430     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   431     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   432     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   433     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   434     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   435     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   436     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   437     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   438
   439     12  WS-AIG-WORK-AREAS.
   440         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   441             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   442         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   443             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   444         16  WS-FROM-DATE-MDY.
   445             20  WS-FROM-MO      PIC 99.
   446             20  WS-FROM-DA      PIC 99.
   447             20  WS-FROM-YR      PIC 99.
   448         16  WS-TEMP-DATE-MDY.
   449             20  WS-TEMP-MO      PIC 99.
   450             20  WS-TEMP-DA      PIC 99.
   451             20  WS-TEMP-YR      PIC 99.
   452         16  WS-BIN-FROM-DT      PIC XX.
   453         16  WS-TEMP-INC-MDY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  10
* EL156.cbl
   454             20  WS-TEMP-INC-MO  PIC 99.
   455             20  WS-TEMP-INC-DA  PIC 99.
   456             20  WS-TEMP-INC-YR  PIC 99.
   457         16  WS-PMT-DUE-MDY.
   458             20  WS-PMT-DUE-MO   PIC 99.
   459             20  WS-PMT-DUE-DA   PIC 99.
   460             20  WS-PMT-DUE-YR   PIC 99.
   461         16  WS-PMT-DUE-DT       PIC XX.
   462         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   463         16  WS-RETRO-ELIM-DT    PIC XX.
   464         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   465             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   466         16  WS-SAVE-DUE-DA      PIC 99.
   467         16  WS-CDAYS            PIC S9(05).
   468         16  WS-DAYS-OFF         PIC S9(05).
   469         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   470             88  ELIM-SATISFIED            VALUE 'Y'.
   471         16  WS-AIG-CHECKNO.
   472             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   473             20  WS-A-CHECKNO-3-7.
   474                 24  FILLER              PIC X(3)    VALUE SPACES.
   475                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   476                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   477         16  WS-AIG-GROUPING.
   478             20  WS-A-BENE               PIC XXX.
   479             20  FILLER                  PIC XXX.
   480         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   481             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   482             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   483         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   484                 VALUE 'UNEMPLOYMENT PAYMENT'.
   485         16  WS-CHK-THRU-DT              PIC XX.
   486         16  WS-HOLD-BIN-DATE-1          PIC XX.
   487
   488 01  MISC-CSO-AREA.
   489     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   490     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   491     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   492         88  APPROVAL-NEEDED                        VALUE 'Y'.
   493     12  WS-APPROV-NOTE                  PIC X(43)
   494         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   495     12  WS-REAUDIT-NOTE                 PIC X(43)
   496         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   497     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   498     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   499     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   500     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   501     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   502     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   503     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   504         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   505     12  WS-PAYEE-CITY-STATE     PIC X(30).
   506     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   507         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   508     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   509     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   510     12  WS-WORK-NAME            PIC X(30).
   511     12  FILLER  REDEFINES WS-WORK-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  11
* EL156.cbl
   512         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   513     12  WS-INSURED-NAME         PIC X(30).
   514     12  FILLER  REDEFINES WS-INSURED-NAME.
   515         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   516     12  WS-PAYEE-NAME           PIC X(30).
   517     12  FILLER  REDEFINES WS-PAYEE-NAME.
   518         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   519
   520 01  ERROR-MESSAGES.
   521     12  ER-0000                 PIC X(4)  VALUE '0000'.
   522     12  ER-0004                 PIC X(4)  VALUE '0004'.
   523     12  ER-0008                 PIC X(4)  VALUE '0008'.
   524     12  ER-0019                 PIC X(4)  VALUE '0019'.
   525     12  ER-0029                 PIC X(4)  VALUE '0029'.
   526     12  ER-0042                 PIC X(4)  VALUE '0042'.
   527     12  ER-0070                 PIC X(4)  VALUE '0070'.
   528     12  ER-0130                 PIC X(4)  VALUE '0130'.
   529     12  ER-0149                 PIC X(4)  VALUE '0149'.
   530     12  ER-0154                 PIC X(4)  VALUE '0154'.
   531     12  ER-0168                 PIC X(4)  VALUE '0168'.
   532     12  ER-0169                 PIC X(4)  VALUE '0169'.
   533     12  ER-0172                 PIC X(4)  VALUE '0174'.
   534     12  ER-0198                 PIC X(4)  VALUE '0198'.
   535     12  ER-0204                 PIC X(4)  VALUE '0204'.
   536     12  ER-0206                 PIC X(4)  VALUE '0206'.
   537     12  ER-0252                 PIC X(4)  VALUE '0252'.
   538     12  ER-0254                 PIC X(4)  VALUE '0254'.
   539     12  ER-0282                 PIC X(4)  VALUE '0282'.
   540     12  ER-0283                 PIC X(4)  VALUE '0283'.
   541     12  ER-0294                 PIC X(4)  VALUE '0294'.
   542     12  ER-0338                 PIC X(4)  VALUE '0338'.
   543     12  ER-0419                 PIC X(4)  VALUE '0419'.
   544     12  ER-0420                 PIC X(4)  VALUE '0420'.
   545     12  ER-0421                 PIC X(4)  VALUE '0421'.
   546     12  ER-0422                 PIC X(4)  VALUE '0422'.
   547     12  ER-0433                 PIC X(4)  VALUE '0433'.
   548     12  ER-0436                 PIC X(4)  VALUE '0436'.
   549     12  ER-0437                 PIC X(4)  VALUE '0437'.
   550     12  ER-0438                 PIC X(4)  VALUE '0438'.
   551     12  ER-0439                 PIC X(4)  VALUE '0439'.
   552     12  ER-0440                 PIC X(4)  VALUE '0440'.
   553     12  ER-0441                 PIC X(4)  VALUE '0441'.
   554     12  ER-0442                 PIC X(4)  VALUE '0442'.
   555     12  ER-0443                 PIC X(4)  VALUE '0443'.
   556     12  ER-0444                 PIC X(4)  VALUE '0444'.
   557     12  ER-0445                 PIC X(4)  VALUE '0445'.
   558     12  ER-0446                 PIC X(4)  VALUE '0446'.
   559     12  ER-0447                 PIC X(4)  VALUE '0447'.
   560     12  ER-0448                 PIC X(4)  VALUE '0448'.
   561     12  ER-0449                 PIC X(4)  VALUE '0449'.
   562     12  ER-0452                 PIC X(4)  VALUE '0452'.
   563     12  ER-0458                 PIC X(4)  VALUE '0458'.
   564     12  ER-0459                 PIC X(4)  VALUE '0459'.
   565     12  ER-0460                 PIC X(4)  VALUE '0460'.
   566     12  ER-0461                 PIC X(4)  VALUE '0461'.
   567     12  ER-0462                 PIC X(4)  VALUE '0462'.
   568     12  ER-0463                 PIC X(4)  VALUE '0463'.
   569     12  ER-0464                 PIC X(4)  VALUE '0464'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  12
* EL156.cbl
   570     12  ER-0465                 PIC X(4)  VALUE '0465'.
   571     12  ER-0466                 PIC X(4)  VALUE '0466'.
   572     12  ER-0467                 PIC X(4)  VALUE '0467'.
   573     12  ER-0468                 PIC X(4)  VALUE '0468'.
   574     12  ER-0469                 PIC X(4)  VALUE '0469'.
   575     12  ER-0473                 PIC X(4)  VALUE '0473'.
   576     12  ER-0474                 PIC X(4)  VALUE '0474'.
   577     12  ER-0475                 PIC X(4)  VALUE '0475'.
   578     12  ER-0476                 PIC X(4)  VALUE '0476'.
   579     12  ER-0477                 PIC X(4)  VALUE '0477'.
   580     12  ER-0478                 PIC X(4)  VALUE '0478'.
   581     12  ER-0479                 PIC X(4)  VALUE '0479'.
   582     12  ER-0481                 PIC X(4)  VALUE '0481'.
   583     12  ER-0491                 PIC X(4)  VALUE '0491'.
   584     12  ER-0492                 PIC X(4)  VALUE '0492'.
   585     12  ER-0493                 PIC X(4)  VALUE '0493'.
   586     12  ER-0494                 PIC X(4)  VALUE '0494'.
   587     12  ER-0495                 PIC X(4)  VALUE '0495'.
   588     12  ER-0499                 PIC X(4)  VALUE '0499'.
   589     12  ER-0500                 PIC X(4)  VALUE '0500'.
   590     12  ER-0501                 PIC X(4)  VALUE '0501'.
   591     12  ER-0502                 PIC X(4)  VALUE '0502'.
   592     12  ER-0508                 PIC X(4)  VALUE '0508'.
   593     12  ER-0513                 PIC X(4)  VALUE '0513'.
   594     12  ER-0518                 PIC X(4)  VALUE '0518'.
   595     12  ER-0524                 PIC X(4)  VALUE '0524'.
   596     12  ER-0525                 PIC X(4)  VALUE '0525'.
   597     12  ER-0526                 PIC X(4)  VALUE '0526'.
   598     12  ER-0530                 PIC X(4)  VALUE '0530'.
   599     12  ER-0540                 PIC X(4)  VALUE '0540'.
   600     12  ER-0541                 PIC X(4)  VALUE '0541'.
   601     12  ER-0542                 PIC X(4)  VALUE '0542'.
   602     12  ER-0543                 PIC X(4)  VALUE '0543'.
   603     12  ER-0545                 PIC X(4)  VALUE '0545'.
   604     12  ER-0552                 PIC X(4)  VALUE '0552'.
   605     12  ER-0555                 PIC X(4)  VALUE '0555'.
   606     12  ER-0556                 PIC X(4)  VALUE '0556'.
   607     12  ER-0557                 PIC X(4)  VALUE '0557'.
   608     12  ER-0572                 PIC X(4)  VALUE '0572'.
   609     12  ER-0573                 PIC X(4)  VALUE '0573'.
   610     12  ER-0594                 PIC X(4)  VALUE '0594'.
   611     12  ER-0616                 PIC X(4)  VALUE '0616'.
   612     12  ER-0617                 PIC X(4)  VALUE '0617'.
   613     12  ER-0618                 PIC X(4)  VALUE '0618'.
   614     12  ER-0657                 PIC X(4)  VALUE '0657'.
   615     12  ER-0658                 PIC X(4)  VALUE '0658'.
   616     12  ER-0699                 PIC X(4)  VALUE '0699'.
   617     12  ER-0730                 PIC X(4)  VALUE '0730'.
   618     12  ER-0737                 PIC X(4)  VALUE '0737'.
   619     12  ER-0760                 PIC X(4)  VALUE '0760'.
   620     12  ER-0768                 PIC X(4)  VALUE '0768'.
   621     12  ER-0769                 PIC X(4)  VALUE '0769'.
   622     12  ER-0770                 PIC X(4)  VALUE '0770'.
   623     12  ER-0802                 PIC X(4)  VALUE '0802'.
   624     12  ER-0803                 PIC X(4)  VALUE '0803'.
   625     12  ER-0819                 PIC X(4)  VALUE '0819'.
   626     12  ER-0834                 PIC X(4)  VALUE '0834'.
   627     12  ER-0836                 PIC X(4)  VALUE '0836'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  13
* EL156.cbl
   628     12  ER-0844                 PIC X(4)  VALUE '0844'.
   629     12  ER-0845                 PIC X(4)  VALUE '0845'.
   630     12  ER-0846                 PIC X(4)  VALUE '0846'.
   631     12  ER-0849                 PIC X(4)  VALUE '0849'.
   632     12  ER-0851                 PIC X(4)  VALUE '0851'.
   633     12  ER-0872                 PIC X(4)  VALUE '0872'.
   634     12  ER-0873                 PIC X(4)  VALUE '0873'.
   635     12  ER-0874                 PIC X(4)  VALUE '0874'.
   636     12  ER-0879                 PIC X(4)  VALUE '0879'.
   637     12  ER-0919                 PIC X(4)  VALUE '0919'.
   638     12  ER-0921                 PIC X(4)  VALUE '0921'.
   639     12  ER-0923                 PIC X(4)  VALUE '0923'.
   640     12  ER-0925                 PIC X(4)  VALUE '0925'.
   641     12  ER-0944                 PIC X(4)  VALUE '0944'.
   642     12  ER-0945                 PIC X(4)  VALUE '0945'.
   643     12  ER-0946                 PIC X(4)  VALUE '0946'.
   644     12  ER-0947                 PIC X(4)  VALUE '0947'.
   645     12  ER-0948                 PIC X(4)  VALUE '0948'.
   646     12  ER-0949                 PIC X(4)  VALUE '0949'.
   647     12  ER-0950                 PIC X(4)  VALUE '0950'.
   648     12  ER-0951                 PIC X(4)  VALUE '0951'.
   649     12  ER-0954                 PIC X(4)  VALUE '0954'.
   650     12  ER-0956                 PIC X(4)  VALUE '0956'.
   651     12  ER-0967                 PIC X(4)  VALUE '0967'.
   652     12  ER-0968                 PIC X(4)  VALUE '0968'.
   653     12  ER-0974                 PIC X(4)  VALUE '0974'.
   654     12  ER-0975                 PIC X(4)  VALUE '0975'.
   655     12  ER-1561                 PIC X(4)  VALUE '1561'.
   656     12  ER-1566                 PIC X(4)  VALUE '1566'.
   657     12  ER-1567                 PIC X(4)  VALUE '1567'.
   658     12  er-1657                 pic x(4)  value '1657'.
   659     12  er-1658                 pic x(4)  value '1658'.
   660     12  ER-1775                 PIC X(4)  VALUE '1775'.
   661     12  ER-1880                 PIC X(4)  VALUE '1880'.
   662     12  ER-2044                 PIC X(4)  VALUE '2044'.
   663     12  ER-3140                 PIC X(4)  VALUE '3140'.
   664     12  ER-3141                 PIC X(4)  VALUE '3141'.
   665     12  ER-3255                 PIC X(4)  VALUE '3255'.
   666     12  ER-3516                 PIC X(4)  VALUE '3516'.
   667     12  ER-3527                 PIC X(4)  VALUE '3527'.
   668     12  ER-3528                 PIC X(4)  VALUE '3528'.
   669     12  ER-3529                 PIC X(4)  VALUE '3529'.
   670     12  ER-3530                 PIC X(4)  VALUE '3530'.
   671     12  ER-3531                 PIC X(4)  VALUE '3531'.
   672     12  ER-3532                 PIC X(4)  VALUE '3532'.
   673     12  ER-3533                 PIC X(4)  VALUE '3533'.
   674     12  ER-3534                 PIC X(4)  VALUE '3534'.
   675     12  ER-3535                 PIC X(4)  VALUE '3535'.
   676     12  ER-3536                 PIC X(4)  VALUE '3536'.
   677     12  ER-3537                 PIC X(4)  VALUE '3537'.
   678     12  ER-3538                 PIC X(4)  VALUE '3538'.
   679     12  ER-3539                 PIC X(4)  VALUE '3539'.
   680     12  ER-3540                 PIC X(4)  VALUE '3540'.
   681     12  ER-3541                 PIC X(4)  VALUE '3541'.
   682     12  ER-3542                 PIC X(4)  VALUE '3542'.
   683     12  ER-3543                 PIC X(4)  VALUE '3543'.
   684     12  ER-3546                 PIC X(4)  VALUE '3546'.
   685     12  ER-3549                 PIC X(4)  VALUE '3549'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  14
* EL156.cbl
   686     12  ER-3818                 PIC X(4)  VALUE '3818'.
   687     12  ER-7540                 PIC X(4)  VALUE '7540'.
   688     12  ER-7576                 PIC X(4)  VALUE '7576'.
   689     12  ER-7579                 PIC X(4)  VALUE '7579'.
   690     12  ER-7830                 PIC X(4)  VALUE '7830'.
   691     12  ER-7831                 PIC X(4)  VALUE '7831'.
   692     12  ER-7832                 PIC X(4)  VALUE '7832'.
   693     12  ER-7833                 PIC X(4)  VALUE '7833'.
   694     12  ER-7834                 PIC X(4)  VALUE '7834'.
   695     12  ER-7835                 PIC X(4)  VALUE '7835'.
   696     12  ER-7836                 PIC X(4)  VALUE '7836'.
   697     12  ER-7837                 PIC X(4)  VALUE '7837'.
   698     12  ER-7838                 PIC X(4)  VALUE '7838'.
   699     12  ER-7841                 PIC X(4)  VALUE '7841'.
   700     12  ER-7844                 PIC X(4)  VALUE '7844'.
   701     12  ER-7845                 PIC X(4)  VALUE '7845'.
   702     12  ER-8000                 PIC X(4)  VALUE '8000'.
   703     12  ER-8051                 PIC X(4)  VALUE '8051'.
   704     12  ER-8052                 PIC X(4)  VALUE '8052'.
   705     12  ER-8053                 PIC X(4)  VALUE '8053'.
   706     12  ER-8054                 PIC X(4)  VALUE '8054'.
   707     12  ER-8055                 PIC X(4)  VALUE '8055'.
   708     12  ER-8056                 PIC X(4)  VALUE '8056'.
   709     12  ER-8057                 PIC X(4)  VALUE '8057'.
   710     12  ER-8058                 PIC X(4)  VALUE '8058'.
   711     12  ER-8059                 PIC X(4)  VALUE '8059'.
   712     12  ER-8060                 PIC X(4)  VALUE '8060'.
   713     12  ER-8061                 PIC X(4)  VALUE '8061'.
   714     12  ER-8062                 PIC X(4)  VALUE '8062'.
   715     12  ER-8063                 PIC X(4)  VALUE '8063'.
   716     12  ER-8064                 PIC X(4)  VALUE '8064'.
   717     12  ER-8065                 PIC X(4)  VALUE '8065'.
   718     12  ER-8066                 PIC X(4)  VALUE '8066'.
   719     12  ER-8146                 PIC X(4)  VALUE '8146'.
   720     12  ER-8147                 PIC X(4)  VALUE '8147'.
   721     12  ER-8152                 PIC X(4)  VALUE '8152'.
   722     12  ER-8153                 PIC X(4)  VALUE '8153'.
   723     12  ER-8154                 PIC X(4)  VALUE '8154'.
   724     12  ER-8155                 PIC X(4)  VALUE '8155'.
   725     12  ER-8310                 PIC X(4)  VALUE '8310'.
   726     12  ER-8311                 PIC X(4)  VALUE '8311'.
   727     12  ER-8312                 PIC X(4)  VALUE '8312'.
   728     12  ER-8313                 PIC X(4)  VALUE '8313'.
   729     12  ER-8314                 PIC X(4)  VALUE '8314'.
   730     12  ER-8315                 PIC X(4)  VALUE '8315'.
   731     12  ER-8316                 PIC X(4)  VALUE '8316'.
   732     12  ER-8317                 PIC X(4)  VALUE '8317'.
   733
   734 01  CSO-WORK-FIELDS.
   735     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   736       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   737
   738     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   739     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   740         88  CERT-NOTE-ADDED           VALUE 'Y'.
   741     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   742         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   743     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  15
* EL156.cbl
   744
   745     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   746
   747 01  SC-NP6-CERT-NOTE.
   748     12  FILLER                  PIC X(12)
   749               VALUE 'REM BENEFIT '.
   750     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   751     12  SC-NP6-COMM             PIC X(8)
   752               VALUE ' + 6 MO '.
   753     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   754     12  FILLER                  PIC X(12)
   755               VALUE ' = AMT PAID '.
   756     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   757
   758 01  SC-NP6-ORIG-NOTE.
   759     12  FILLER                  PIC X(63)  VALUE
   760         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   761 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   762     88  PDEF-FOUND                   VALUE 'Y'.
   763 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   764     88  ACCT-FOUND                   VALUE 'Y'.
   765 01  CTBL-KEY-SAVE               PIC X(5).
   766 01  CTBL-KEY.
   767     05  CTBL-COMPANY-CD         PIC X.
   768     05  CTBL-TABLE              PIC XXX.
   769     05  CTBL-BEN-TYPE           PIC X.
   770     05  CTBL-BEN-CODE           PIC XX.
   771 01  ERPDEF-KEY-SAVE             PIC X(18).
   772 01  ERPDEF-KEY.
   773     12  ERPDEF-COMPANY-CD       PIC X.
   774     12  ERPDEF-STATE            PIC XX.
   775     12  ERPDEF-PROD-CD          PIC XXX.
   776     12  F                       PIC X(7).
   777     12  ERPDEF-BEN-TYPE         PIC X.
   778     12  ERPDEF-BEN-CODE         PIC XX.
   779     12  ERPDEF-EXP-DT           PIC XX.
   780 01  ELCRTT-KEY.
   781     05  CTRLR-COMP-CD       PIC X.
   782     05  CTRLR-CARRIER       PIC X.
   783     05  CTRLR-GROUPING      PIC X(6).
   784     05  CTRLR-STATE         PIC X(2).
   785     05  CTRLR-ACCOUNT       PIC X(10).
   786     05  CTRLR-EFF-DT        PIC XX.
   787     05  CTRLR-CERT-NO       PIC X(11).
   788     05  CTRLR-REC-TYPE      PIC X.
   789 01  ACCESS-KEYS.
   790     12  ELARCH-KEY.
   791         16  ARCH-CO             PIC X.
   792         16  ARCH-NUMBER         PIC S9(08) COMP.
   793         16  ARCH-REC-TYPE       PIC X.
   794         16  ARCH-SEQ            PIC S9(04) COMP.
   795     12  ELMSTR-KEY.
   796         16  MSTR-COMP-CD        PIC X.
   797         16  MSTR-CARRIER        PIC X.
   798         16  MSTR-CLAIM-NO       PIC X(7).
   799         16  MSTR-CERT-NO        PIC X(11).
   800     12  ELCNTL-KEY.
   801         16  CNTL-COMP-ID        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  16
* EL156.cbl
   802         16  CNTL-REC-TYPE       PIC X.
   803         16  CNTL-ACCESS         PIC X(4).
   804         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   805     12  ELCERT-KEY.
   806         16  CERT-COMP-CD        PIC X.
   807         16  CERT-CARRIER        PIC X.
   808         16  CERT-GROUPING       PIC X(6).
   809         16  CERT-STATE          PIC XX.
   810         16  CERT-ACCOUNT        PIC X(10).
   811         16  CERT-EFF-DT         PIC XX.
   812         16  CERT-CERT-NO        PIC X(11).
   813     12  ELTRLR-KEY.
   814         16  TRLR-COMP-CD        PIC X.
   815         16  TRLR-CARRIER        PIC X.
   816         16  TRLR-CLAIM-NO       PIC X(7).
   817         16  TRLR-CERT-NO        PIC X(11).
   818         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   819     12  ELACTQ-KEY.
   820         16  ACTQ-COMP-CD        PIC X.
   821         16  ACTQ-CARRIER        PIC X.
   822         16  ACTQ-CLAIM-NO       PIC X(7).
   823         16  ACTQ-CERT-NO        PIC X(11).
   824     12  W-NOTE-KEY.
   825         16  W-NOTE-COMP-CD      PIC X.
   826         16  W-NOTE-CERT-KEY.
   827             20  W-NOTE-CARRIER  PIC X.
   828             20  W-NOTE-GROUPING PIC X(6).
   829             20  W-NOTE-STATE    PIC XX.
   830             20  W-NOTE-ACCOUNT  PIC X(10).
   831             20  W-NOTE-EFF-DT   PIC XX.
   832             20  W-NOTE-CERT-NO  PIC X(11).
   833     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   834     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   835     12  ERACCT-KEY.
   836         16  ERACCT-PARTIAL-KEY.
   837             20  ACCT-COMP-CD    PIC X.
   838             20  ACCT-CARRIER    PIC X.
   839             20  ACCT-GROUPING   PIC X(6).
   840             20  ACCT-STATE      PIC XX.
   841             20  ACCT-ACCOUNT    PIC X(10).
   842         16  ACCT-EXP-DT         PIC XX.
   843         16  FILLER              PIC X(4) VALUE SPACES.
   844     12  ELCHKQ-KEY.
   845         16  CHKQ-COMP-CD        PIC X.
   846         16  CHKQ-CONTROL        PIC S9(8) COMP.
   847         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   848     12  ELBENE-KEY.
   849         16  BENE-COMP-CD         PIC X.
   850         16  BENE-RECORD-TYPE     PIC X.
   851         16  BENE-NUMBER          PIC X(10).
   852     12  ERCOMP-KEY.
   853         16  COMP-COMP-CD        PIC X.
   854         16  COMP-CARRIER        PIC X.
   855         16  COMP-GROUP          PIC X(06).
   856         16  COMP-FIN-RESP       PIC X(10).
   857         16  COMP-ACCOUNT        PIC X(10).
   858         16  COMP-TYPE           PIC X.
   859
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  17
* EL156.cbl
   860     12  DLO035-KEY.
   861         16  DL35-PROCESS-TYPE   PIC X.
   862         16  DL35-CREDIT-CARD    PIC X(20).
   863         16  DL35-BEN-TYPE       PIC XX.
   864         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   865         16  DL35-RETURN-CODE    PIC XX.
   866
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  18
* EL156.cbl
   868*    COPY ELCDATE.
   869******************************************************************
   870*                                                                *
   871*                                                                *
   872*                            ELCDATE.                            *
   873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   874*                            VMOD=2.003
   875*                                                                *
   876*                                                                *
   877*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   878*                 LENGTH = 200                                   *
   879******************************************************************
   880
   881 01  DATE-CONVERSION-DATA.
   882     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   883     12  DC-OPTION-CODE                PIC X.
   884         88  BIN-TO-GREG                VALUE ' '.
   885         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   886         88  EDIT-GREG-TO-BIN           VALUE '2'.
   887         88  YMD-GREG-TO-BIN            VALUE '3'.
   888         88  MDY-GREG-TO-BIN            VALUE '4'.
   889         88  JULIAN-TO-BIN              VALUE '5'.
   890         88  BIN-PLUS-ELAPSED           VALUE '6'.
   891         88  FIND-CENTURY               VALUE '7'.
   892         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   893         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   894         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   895         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   896         88  JULIAN-TO-BIN-3            VALUE 'C'.
   897         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   898         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   899         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   900         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   901         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   902         88  CHECK-LEAP-YEAR            VALUE 'H'.
   903         88  BIN-3-TO-GREG              VALUE 'I'.
   904         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   905         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   906         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   907         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   908         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   909         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   910         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   911         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   912         88  THREE-CHARACTER-BIN
   913                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   914         88  GREGORIAN-TO-BIN
   915                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   916         88  BIN-TO-GREGORIAN
   917                  VALUES ' ' '1' 'I' '8' 'G'.
   918         88  JULIAN-TO-BINARY
   919                  VALUES '5' 'C' 'E' 'F'.
   920     12  DC-ERROR-CODE                 PIC X.
   921         88  NO-CONVERSION-ERROR        VALUE ' '.
   922         88  DATE-CONVERSION-ERROR
   923                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   924         88  DATE-IS-ZERO               VALUE '1'.
   925         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  19
* EL156.cbl
   926         88  DATE-IS-INVALID            VALUE '3'.
   927         88  DATE1-GREATER-DATE2        VALUE '4'.
   928         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   929         88  DATE-INVALID-OPTION        VALUE '9'.
   930         88  INVALID-CENTURY            VALUE 'A'.
   931         88  ONLY-CENTURY               VALUE 'B'.
   932         88  ONLY-LEAP-YEAR             VALUE 'C'.
   933         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   934     12  DC-END-OF-MONTH               PIC X.
   935         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   936     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   937         88  USE-NORMAL-PROCESS         VALUE ' '.
   938         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   939         88  ADJUST-UP-100-YRS          VALUE '2'.
   940     12  FILLER                        PIC X.
   941     12  DC-CONVERSION-DATES.
   942         16  DC-BIN-DATE-1             PIC XX.
   943         16  DC-BIN-DATE-2             PIC XX.
   944         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   945         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   946                       DC-GREG-DATE-1-EDIT.
   947             20  DC-EDIT1-MONTH        PIC 99.
   948             20  SLASH1-1              PIC X.
   949             20  DC-EDIT1-DAY          PIC 99.
   950             20  SLASH1-2              PIC X.
   951             20  DC-EDIT1-YEAR         PIC 99.
   952         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   953         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   954                     DC-GREG-DATE-2-EDIT.
   955             20  DC-EDIT2-MONTH        PIC 99.
   956             20  SLASH2-1              PIC X.
   957             20  DC-EDIT2-DAY          PIC 99.
   958             20  SLASH2-2              PIC X.
   959             20  DC-EDIT2-YEAR         PIC 99.
   960         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   961         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   962                     DC-GREG-DATE-1-YMD.
   963             20  DC-YMD-YEAR           PIC 99.
   964             20  DC-YMD-MONTH          PIC 99.
   965             20  DC-YMD-DAY            PIC 99.
   966         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   967         16  DC-GREG-DATE-1-MDY-R REDEFINES
   968                      DC-GREG-DATE-1-MDY.
   969             20  DC-MDY-MONTH          PIC 99.
   970             20  DC-MDY-DAY            PIC 99.
   971             20  DC-MDY-YEAR           PIC 99.
   972         16  DC-GREG-DATE-1-ALPHA.
   973             20  DC-ALPHA-MONTH        PIC X(10).
   974             20  DC-ALPHA-DAY          PIC 99.
   975             20  FILLER                PIC XX.
   976             20  DC-ALPHA-CENTURY.
   977                 24 DC-ALPHA-CEN-N     PIC 99.
   978             20  DC-ALPHA-YEAR         PIC 99.
   979         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   980         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   981         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   982         16  DC-JULIAN-DATE            PIC 9(05).
   983         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  20
* EL156.cbl
   984                                       PIC 9(05).
   985         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   986             20  DC-JULIAN-YEAR        PIC 99.
   987             20  DC-JULIAN-DAYS        PIC 999.
   988         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   989         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   990         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   991     12  DATE-CONVERSION-VARIBLES.
   992         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   993         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   994             20  FILLER                PIC 9(3).
   995             20  HOLD-CEN-1-CCYY.
   996                 24  HOLD-CEN-1-CC     PIC 99.
   997                 24  HOLD-CEN-1-YY     PIC 99.
   998             20  HOLD-CEN-1-MO         PIC 99.
   999             20  HOLD-CEN-1-DA         PIC 99.
  1000         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1001             20  HOLD-CEN-1-R-MO       PIC 99.
  1002             20  HOLD-CEN-1-R-DA       PIC 99.
  1003             20  HOLD-CEN-1-R-CCYY.
  1004                 24  HOLD-CEN-1-R-CC   PIC 99.
  1005                 24  HOLD-CEN-1-R-YY   PIC 99.
  1006             20  FILLER                PIC 9(3).
  1007         16  HOLD-CENTURY-1-X.
  1008             20  FILLER                PIC X(3)  VALUE SPACES.
  1009             20  HOLD-CEN-1-X-CCYY.
  1010                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1011                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1012             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1013             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1014         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1015             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1016             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1017             20  HOLD-CEN-1-R-X-CCYY.
  1018                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1019                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1020             20  FILLER                PIC XXX.
  1021         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1022         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1023         16  DC-JULIAN-DATE-1          PIC 9(07).
  1024         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1025             20  DC-JULIAN-1-CCYY.
  1026                 24  DC-JULIAN-1-CC    PIC 99.
  1027                 24  DC-JULIAN-1-YR    PIC 99.
  1028             20  DC-JULIAN-DA-1        PIC 999.
  1029         16  DC-JULIAN-DATE-2          PIC 9(07).
  1030         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1031             20  DC-JULIAN-2-CCYY.
  1032                 24  DC-JULIAN-2-CC    PIC 99.
  1033                 24  DC-JULIAN-2-YR    PIC 99.
  1034             20  DC-JULIAN-DA-2        PIC 999.
  1035         16  DC-GREG-DATE-A-EDIT.
  1036             20  DC-EDITA-MONTH        PIC 99.
  1037             20  SLASHA-1              PIC X VALUE '/'.
  1038             20  DC-EDITA-DAY          PIC 99.
  1039             20  SLASHA-2              PIC X VALUE '/'.
  1040             20  DC-EDITA-CCYY.
  1041                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  21
* EL156.cbl
  1042                 24  DC-EDITA-YEAR     PIC 99.
  1043         16  DC-GREG-DATE-B-EDIT.
  1044             20  DC-EDITB-MONTH        PIC 99.
  1045             20  SLASHB-1              PIC X VALUE '/'.
  1046             20  DC-EDITB-DAY          PIC 99.
  1047             20  SLASHB-2              PIC X VALUE '/'.
  1048             20  DC-EDITB-CCYY.
  1049                 24  DC-EDITB-CENT     PIC 99.
  1050                 24  DC-EDITB-YEAR     PIC 99.
  1051         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1052         16  DC-GREG-DATE-CYMD-R REDEFINES
  1053                              DC-GREG-DATE-CYMD.
  1054             20  DC-CYMD-CEN           PIC 99.
  1055             20  DC-CYMD-YEAR          PIC 99.
  1056             20  DC-CYMD-MONTH         PIC 99.
  1057             20  DC-CYMD-DAY           PIC 99.
  1058         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1059         16  DC-GREG-DATE-MDCY-R REDEFINES
  1060                              DC-GREG-DATE-MDCY.
  1061             20  DC-MDCY-MONTH         PIC 99.
  1062             20  DC-MDCY-DAY           PIC 99.
  1063             20  DC-MDCY-CEN           PIC 99.
  1064             20  DC-MDCY-YEAR          PIC 99.
  1065    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1066        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1067    12  DC-EL310-DATE                  PIC X(21).
  1068    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  22
* EL156.cbl
  1070*    COPY ELCLOGOF.
  1071******************************************************************
  1072*                                                                *
  1073*                                                                *
  1074*                            ELCLOGOF.                           *
  1075*                            VMOD=2.001                          *
  1076*                                                                *
  1077*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1078*                                                                *
  1079******************************************************************
  1080 01  CLASIC-LOGOFF.
  1081     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1082     12  LOGOFF-TEXT.
  1083         16  FILLER          PIC X(5)    VALUE SPACES.
  1084         16  LOGOFF-MSG.
  1085             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1086             20  FILLER      PIC X       VALUE SPACES.
  1087             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1088         16  FILLER          PIC X(80)
  1089           VALUE '* YOU ARE NOW LOGGED OFF'.
  1090         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1091         16  FILLER          PIC X       VALUE QUOTE.
  1092         16  LOGOFF-SYS-MSG  PIC X(17)
  1093           VALUE 'S CLAS-IC SYSTEM '.
  1094     12  TEXT-MESSAGES.
  1095         16  UNACCESS-MSG    PIC X(29)
  1096             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1097         16  PGMIDERR-MSG    PIC X(17)
  1098             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  23
* EL156.cbl
  1100*    COPY ELCCALC.
  1101******************************************************************
  1102*                                                                *
  1103*                           ELCCALC.                            *
  1104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1105*                            VMOD=2.025                          *
  1106*                                                                *
  1107*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1108*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1109*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1110*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1111*                                                                *
  1112*  PASSED TO ELRTRM                                              *
  1113*  -----------------                                             *
  1114*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1115*  ORIGINAL TERM                                                 *
  1116*  BEGINNING DATE                                                *
  1117*  ENDING DATE                                                   *
  1118*  COMPANY I.D.                                                  *
  1119*  ACCOUNT MASTER USER FIELD                                     *
  1120*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1121*  FREE LOOK DAYS                                                *
  1122*                                                                *
  1123*  RETURNED FROM ELRTRM                                          *
  1124*  ---------------------                                         *
  1125*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1126*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1127*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1128*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1129*----------------------------------------------------------------*
  1130*  PASSED TO ELRAMT                                              *
  1131*  ----------------                                              *
  1132*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1133*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1134*  ORIGINAL AMOUNT                                               *
  1135*  ALTERNATE BENEFIT (BALLON)                                    *
  1136*  A.P.R. - NET PAY ONLY                                         *
  1137*  METHOD
  1138*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1139*  COMPANY I.D.                                                  *
  1140*  BENEFIT TYPE                                                  *
  1141*                                                                *
  1142*  RETURNED FROM ELRAMT                                          *
  1143*  --------------------                                          *
  1144*  REMAINING AMOUNT 1 - CURRENT                                  *
  1145*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1146*  REMAINING AMOUNT FACTOR
  1147*----------------------------------------------------------------*
  1148*  PASSED TO ELRESV                                              *
  1149*  -----------------                                             *
  1150*  CERTIFICATE EFFECTIVE DATE                                    *
  1151*  VALUATION DATE                                                *
  1152*  PAID THRU DATE                                                *
  1153*  BENEFIT                                                       *
  1154*  INCURRED DATE                                                 *
  1155*  REPORTED DATE                                                 *
  1156*  ISSUE AGE                                                     *
  1157*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  24
* EL156.cbl
  1158*  CDT PERCENT                                                   *
  1159*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1160* *CLAIM TYPE (LIFE, A/H)                                        *
  1161* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1162* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1163*                                                                *
  1164*  RETURNED FROM ELRESV                                          *
  1165*  --------------------                                          *
  1166*  CDT TABLE USED                                                *
  1167*  CDT FACTOR USED                                               *
  1168*  PAY TO CURRENT RESERVE                                        *
  1169*  I.B.N.R. - A/H ONLY                                           *
  1170*  FUTURE (ACCRUED) AH ONLY                                      *
  1171*----------------------------------------------------------------*
  1172*  PASSED TO ELRATE                                              *
  1173*  ----------------                                              *
  1174*  CERT ISSUE DATE                                               *
  1175*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1176*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1177*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1178*  STATE CODE (CLIENT DEFINED)                                   *
  1179*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1180*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1181*  DEVIATION CODE                                                *
  1182*  ISSUE AGE                                                     *
  1183*  ORIGINAL BENEFIT AMOUNT                                       *
  1184*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1185*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1186*  BENEFIT KIND (LIFE OR A/H)                                    *
  1187*  A.P.R.                                                        *
  1188*  METHOD
  1189*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1190*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1191*  COMPANY I.D. (3 CHARACTER)                                    *
  1192*  BENEFIT CODE                                                  *
  1193*  BENEFIT OVERRIDE CODE                                         *
  1194*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1195*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1196*  JOINT INDICATOR (CSL ONLY)                                    *
  1197*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1198*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1199*                                                                *
  1200*  RETURNED FROM ELRATE                                          *
  1201*  --------------------                                          *
  1202*  CALCULATED PREMIUM                                            *
  1203*  PREMIUM RATE                                                  *
  1204*  MORTALITY CODE                                                *
  1205*  MAX ATTAINED AGE                                              *
  1206*  MAX AGE                                                       *
  1207*  MAX TERM                                                      *
  1208*  MAX MONTHLY BENEFIT                                           *
  1209*  MAX TOTAL BENIFIT                                             *
  1210*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1211*----------------------------------------------------------------*
  1212*  PASSED TO ELRFND                                              *
  1213*  ----------------                                              *
  1214*  CERT ISSUE DATE                                               *
  1215*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  25
* EL156.cbl
  1216*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1217*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1218*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1219*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1220*  STATE CODE (CLIENT DEFINED)                                   *
  1221*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1222*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1223*  DEVIATION CODE                                                *
  1224*  ISSUE AGE                                                     *
  1225*  ORIGINAL BENEFIT AMOUNT                                       *
  1226*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1227*  PROCESS TYPE (CANCEL)                                         *
  1228*  BENEFIT KIND (LIFE OR A/H)                                    *
  1229*  A.P.R.                                                        *
  1230*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1231*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1232*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1233*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1234*  COMPANY I.D. (3 CHARACTER)                                    *
  1235*  BENEFIT CODE                                                  *
  1236*  BENEFIT OVERRIDE CODE                                         *
  1237*                                                                *
  1238*  RETURNED FROM ELRFND                                          *
  1239*  --------------------                                          *
  1240*  CALCULATED REFUND                                             *
  1241*----------------------------------------------------------------*
  1242*  PASSED TO ELEARN                                              *
  1243*  ----------------                                              *
  1244*  CERT ISSUE DATE                                               *
  1245*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1246*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1247*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1248*  STATE CODE (CLIENT DEFINED)                                   *
  1249*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1250*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1251*  DEVIATION CODE                                                *
  1252*  ISSUE AGE                                                     *
  1253*  ORIGINAL BENEFIT AMOUNT                                       *
  1254*  BENEFIT KIND (LIFE OR A/H)                                    *
  1255*  A.P.R.                                                        *
  1256*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1257*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1258*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1259*  COMPANY I.D. (3 CHARACTER)                                    *
  1260*  BENEFIT CODE                                                  *
  1261*  BENEFIT OVERRIDE CODE                                         *
  1262*                                                                *
  1263*  RETURNED FROM ELEARN                                          *
  1264*  --------------------                                          *
  1265*  INDICATED  EARNINGS                                           *
  1266*----------------------------------------------------------------*
  1267*                 LENGTH = 450                                   *
  1268*                                                                *
  1269******************************************************************
  1270******************************************************************
  1271*                   C H A N G E   L O G
  1272*
  1273* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  26
* EL156.cbl
  1274*-----------------------------------------------------------------
  1275*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1276* EFFECTIVE    NUMBER
  1277*-----------------------------------------------------------------
  1278* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1279* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1280* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1281* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1282* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1283* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1284* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1285* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1286* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1287******************************************************************
  1288
  1289 01  CALCULATION-PASS-AREA.
  1290     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1291                                     COMP.
  1292
  1293     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1294       88  NO-CP-ERROR                             VALUE ZERO.
  1295       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1296                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1297       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1298       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1299       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1300       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1301       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1302       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1303       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1304       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1305       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1306       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1307       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1308       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1309       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1310       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1311       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1312       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1313       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1314
  1315     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1316       88  NO-CP-ERROR-2                           VALUE ZERO.
  1317***********************  INPUT AREAS ****************************
  1318
  1319     12  CP-CALCULATION-AREA.
  1320         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1321         16  CP-CERT-EFF-DT        PIC XX.
  1322         16  CP-VALUATION-DT       PIC XX.
  1323         16  CP-PAID-THRU-DT       PIC XX.
  1324         16  CP-BENEFIT-TYPE       PIC X.
  1325           88  CP-AH                               VALUE 'A' 'D'
  1326                                                   'I' 'U'.
  1327           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1328           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1329         16  CP-INCURRED-DT        PIC XX.
  1330         16  CP-REPORTED-DT        PIC XX.
  1331         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  27
* EL156.cbl
  1332         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1333         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1334                                     COMP-3.
  1335         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1336                                     COMP-3.
  1337         16  CP-CDT-METHOD         PIC X.
  1338           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1339           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1340           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1341         16  CP-CLAIM-TYPE         PIC X.
  1342           88  CP-AH-CLAIM                         VALUE 'A'.
  1343           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1344         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1345                                     COMP-3.
  1346         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1347                                     COMP-3.
  1348         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1349                                     COMP-3.
  1350         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1351                                     COMP-3.
  1352         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1353                                     COMP-3.
  1354         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1355                                     COMP-3.
  1356         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1357                                     COMP-3.
  1358         16  CP-REM-TERM-METHOD    PIC X.
  1359           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1360           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1361           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1362           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1363           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1364           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1365           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1366         16  CP-EARNING-METHOD     PIC X.
  1367           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1368           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1369           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1370           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1371           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1372           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1373           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1374           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1375           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1376           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1377           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1378           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1379           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1380           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1381         16  CP-PROCESS-TYPE       PIC X.
  1382           88  CP-CLAIM                            VALUE '1'.
  1383           88  CP-CANCEL                           VALUE '2'.
  1384           88  CP-ISSUE                            VALUE '3'.
  1385         16  CP-SPECIAL-CALC-CD    PIC X.
  1386           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1387           88  CP-1-MTH-INTEREST               VALUE ' '.
  1388           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1389           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  28
* EL156.cbl
  1390           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1391           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1392           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1393           88  CP-FARM-PLAN                    VALUE 'F'.
  1394           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1395           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1396           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1397           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1398           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1399           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1400           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1401           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1402           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1403           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1404                                                     'W' 'X'.
  1405           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1406           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1407           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1408           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1409           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1410           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1411           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1412           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1413           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1414           88  CP-CSL-METH-1                   VALUE '5'.
  1415           88  CP-CSL-METH-2                   VALUE '6'.
  1416           88  CP-CSL-METH-3                   VALUE '7'.
  1417           88  CP-CSL-METH-4                   VALUE '8'.
  1418
  1419         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1420                                     COMP-3.
  1421         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1422         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1423         16  CP-STATE              PIC XX          VALUE SPACE.
  1424         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1425         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1426           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1427               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1428         16  CP-R78-OPTION         PIC X.
  1429           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1430           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1431
  1432         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1433         16  CP-IBNR-RESERVE-SW    PIC X.
  1434         16  CP-CLAIM-STATUS       PIC X.
  1435         16  CP-RATE-FILE          PIC X.
  1436         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1437                                     COMP-3.
  1438
  1439         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1440         16  CP-AH-OVERRIDE-CODE   PIC X.
  1441
  1442         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1443                                     COMP-3.
  1444         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1445                                   PIC S9(5)V99 COMP-3.
  1446         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1447                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  29
* EL156.cbl
  1448         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1449                                     COMP-3.
  1450         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1451                                     COMP-3.
  1452         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1453                                  PIC S9(7)V99 COMP-3.
  1454
  1455         16  CP-PAID-FROM-DATE     PIC X(02).
  1456         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1457         16  CP-EXT-DAYS-CALC      PIC X.
  1458           88  CP-EXT-NO-CHG                   VALUE ' '.
  1459           88  CP-EXT-CHG-LF                   VALUE '1'.
  1460           88  CP-EXT-CHG-AH                   VALUE '2'.
  1461           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1462         16  CP-DOMICILE-STATE     PIC XX.
  1463         16  CP-CARRIER            PIC X.
  1464         16  CP-REIN-FLAG          PIC X.
  1465         16  CP-REM-TRM-CALC-OPTION PIC X.
  1466           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1467                      '2' '3' '4' '5'.
  1468           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1469           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1470           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1471           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1472           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1473           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1474           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1475           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1476         16  CP-SIG-SWITCH         PIC X.
  1477         16  CP-RATING-METHOD      PIC X.
  1478           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1479           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1480           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1481           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1482           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1483           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1484           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1485           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1486           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1487         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1488                                     COMP-3.
  1489         16  CP-BEN-CATEGORY       PIC X.
  1490         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1491         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1492                                   PIC S99V9(5) COMP-3.
  1493         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1494         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1495                                   PIC S99V9(5) COMP-3.
  1496         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1497         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1498         16  CP-EXPIRE-DT          PIC XX.
  1499         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1500         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1501         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1502         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1503         16  CP-DDF-SPEC-CALC      PIC X.
  1504             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1505             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  30
* EL156.cbl
  1506         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1507         16  CP-CANCEL-REASON      PIC X.
  1508         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1509         16  CP-PMT-MODE           PIC X.
  1510         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1511         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1512         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1513         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1514         16  FILLER                PIC X.
  1515
  1516***************    OUTPUT FROM ELRESV   ************************
  1517
  1518         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1519
  1520         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1521                                     COMP-3.
  1522         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1523                                     COMP-3.
  1524         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1525                                     COMP-3.
  1526         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1527                                     COMP-3.
  1528         16  FILLER                PIC X(09).
  1529***************    OUTPUT FROM ELRTRM   *************************
  1530
  1531         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1532                                     COMP-3.
  1533         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1534                                     COMP-3.
  1535         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1536                                     COMP-3.
  1537         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1538                                     COMP-3.
  1539         16  FILLER                PIC X(12).
  1540
  1541***************    OUTPUT FROM ELRAMT   *************************
  1542
  1543         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1544                                     COMP-3.
  1545         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1546                                     COMP-3.
  1547         16  FILLER                PIC X(12).
  1548
  1549***************    OUTPUT FROM ELRATE   *************************
  1550
  1551         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1552                                     COMP-3.
  1553         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1554                                     COMP-3.
  1555         16  CP-MORTALITY-CODE     PIC X(4).
  1556         16  CP-RATE-EDIT-FLAG     PIC X.
  1557             88  CP-RATES-NEED-APR                  VALUE '1'.
  1558         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1559                                     COMP-3.
  1560         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1561         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1562         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1563                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  31
* EL156.cbl
  1564         16  FILLER                PIC X(07).
  1565
  1566***************    OUTPUT FROM ELRFND   *************************
  1567
  1568         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1569                                     COMP-3.
  1570         16  CP-REFUND-TYPE-USED   PIC X.
  1571           88  CP-R-AS-R78                         VALUE '1'.
  1572           88  CP-R-AS-PRORATA                     VALUE '2'.
  1573           88  CP-R-AS-CALIF                       VALUE '3'.
  1574           88  CP-R-AS-TEXAS                       VALUE '4'.
  1575           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1576           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1577           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1578           88  CP-R-AS-MEAN                        VALUE '8'.
  1579           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1580           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1581           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1582           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1583           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1584           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1585         16  FILLER                PIC X(12).
  1586
  1587***************    OUTPUT FROM ELEARN   *************************
  1588
  1589         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1590                                     COMP-3.
  1591         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1592                                     COMP-3.
  1593         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1594                                     COMP-3.
  1595         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1598                                     COMP-3.
  1599         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1600                                     COMP-3.
  1601         16  CP-EARNING-TYPE-USED  PIC X.
  1602           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1603           88  CP-E-AS-R78                         VALUE '1'.
  1604           88  CP-E-AS-PRORATA                     VALUE '2'.
  1605           88  CP-E-AS-TEXAS                       VALUE '4'.
  1606           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1607           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1608           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1609           88  CP-E-AS-MEAN                        VALUE '8'.
  1610           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1611         16  FILLER                PIC X(12).
  1612
  1613***************    OUTPUT FROM ELPMNT   *************************
  1614
  1615         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1616                                     COMP-3.
  1617         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1618                                     COMP-3.
  1619         16  FILLER                PIC X(12).
  1620
  1621***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  32
* EL156.cbl
  1622         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1623                                     COMP-3.
  1624         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1625                                     COMP-3.
  1626         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1627                                     COMP-3.
  1628         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1629                                     COMP-3.
  1630         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1631                                     COMP-3.
  1632         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1633                                     COMP-3.
  1634         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1635             88  OPEN-RATE-FILE                   VALUE 'O'.
  1636             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1637             88  IO-ERROR                         VALUE 'E'.
  1638
  1639         16  CP-FIRST-PAY-DATE     PIC XX.
  1640
  1641         16  CP-JOINT-INDICATOR    PIC X.
  1642
  1643         16  CP-RESERVE-REMAINING-TERM
  1644                                   PIC S9(4)V9    VALUE ZERO
  1645                                     COMP-3.
  1646
  1647         16  CP-INSURED-BIRTH-DT   PIC XX.
  1648
  1649         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1650                                     COMP-3.
  1651
  1652         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1653                                     COMP-3.
  1654
  1655         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1656                                     COMP-3.
  1657
  1658         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1659                                     COMP-3.
  1660
  1661         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1662                                     COMP-3.
  1663
  1664         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1665                                     COMP-3.
  1666
  1667         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1668                                     COMP-3.
  1669
  1670         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1671             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1672
  1673         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1674                                     COMP-3.
  1675         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1676                                     COMP-3.
  1677         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1678         16  FILLER                PIC X(15).
  1679******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  33
* EL156.cbl
  1680*    COPY ELCICALC.
  1681******************************************************************
  1682*                                                                *
  1683*                           ELCCICALC.                           *
  1684*                            VMOD=2.001                          *
  1685*                                                                *
  1686*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1687*                 CALCULATION MODULE                             *
  1688*                                                                *
  1689*  PASSED TO ELCLMI                                              *
  1690*  -----------------                                             *
  1691*  STATE                                                         *
  1692*  PRODUCT                                                       *
  1693*  COVERAGE                                                      *
  1694*  EFFECTIVE DATE                                                *
  1695*  INCURRED DATE                                                 *
  1696*  ESTABLISHED DATE                                              *
  1697*  LAST PAID DATE                                                *
  1698*  REPORTED DATE                                                 *
  1699*  CLAIM PAYMENT AMOUNT                                          *
  1700*                                                                *
  1701*  RETURNED FROM ELRTRM                                          *
  1702*  ---------------------                                         *
  1703*  RETURN CODE                                                   *
  1704*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1705*  CLAIM INTEREST AMOUNT                                         *
  1706*----------------------------------------------------------------*
  1707*----------------------------------------------------------------*
  1708*                 LENGTH = 100                                   *
  1709*                                                                *
  1710******************************************************************
  1711******************************************************************
  1712*                   C H A N G E   L O G
  1713*
  1714* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1715*-----------------------------------------------------------------
  1716*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1717* EFFECTIVE    NUMBER
  1718*-----------------------------------------------------------------
  1719* 120905    2004040700004  PEMA  NEW COPYBOOK
  1720* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1721******************************************************************
  1722
  1723 01  CLAIM-INT-PASS-AREA.
  1724     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1725                                     COMP.
  1726
  1727     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1728       88  NO-CI-ERROR                             VALUE ZERO.
  1729       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1730       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1731       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1732       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1733       88  CP-AMT-LT-5000                          VALUE '4'.
  1734       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1735       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1736       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1737       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  34
* EL156.cbl
  1738***********************  INPUT AREAS ****************************
  1739
  1740     12  CP-CALCULATION-AREA.
  1741         16  CP-COMPANY-CD         PIC X.
  1742         16  CP-STATE              PIC XX.
  1743         16  CP-PRODUCT            PIC XX.
  1744         16  CP-COVERAGE           PIC XX.
  1745         16  CP-INC-DT             PIC XX.
  1746         16  CP-EST-DT             PIC XX.
  1747         16  CP-LSTPD-DT           PIC XX.
  1748         16  CP-RPT-DT             PIC XX.
  1749         16  CP-PRF-DT             PIC XX.
  1750         16  CP-EFF-DT             PIC XX.
  1751         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1752         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1753         16  FILLER                PIC X(37).
  1754
  1755***************    OUTPUT FROM ELCLMI   ************************
  1756
  1757         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1758
  1759         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1760         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1761         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1762         16  FILLER                PIC X(19).
  1763******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  35
* EL156.cbl
  1765*    COPY ELCATTR.
  1766******************************************************************
  1767*                                                                *
  1768*                            ELCATTR.                            *
  1769*                            VMOD=2.001                          *
  1770*                                                                *
  1771*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1772*                                                                *
  1773*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1774*                                                                *
  1775*                   POS 1   P=PROTECTED                          *
  1776*                           U=UNPROTECTED                        *
  1777*                           S=ASKIP                              *
  1778*                   POS 2   A=ALPHA/NUMERIC                      *
  1779*                           N=NUMERIC                            *
  1780*                   POS 3   N=NORMAL                             *
  1781*                           B=BRIGHT                             *
  1782*                           D=DARK                               *
  1783*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1784*                           OF=MODIFIED DATA TAG OFF             *
  1785*                                                                *
  1786*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1787******************************************************************
  1788 01  ATTRIBUTE-LIST.
  1789     12  AL-PABOF            PIC X       VALUE 'Y'.
  1790     12  AL-PABON            PIC X       VALUE 'Z'.
  1791     12  AL-PADOF            PIC X       VALUE '%'.
  1792     12  AL-PADON            PIC X       VALUE '_'.
  1793     12  AL-PANOF            PIC X       VALUE '-'.
  1794     12  AL-PANON            PIC X       VALUE '/'.
  1795     12  AL-SABOF            PIC X       VALUE '8'.
  1796     12  AL-SABON            PIC X       VALUE '9'.
  1797     12  AL-SADOF            PIC X       VALUE '@'.
  1798     12  AL-SADON            PIC X       VALUE QUOTE.
  1799     12  AL-SANOF            PIC X       VALUE '0'.
  1800     12  AL-SANON            PIC X       VALUE '1'.
  1801     12  AL-UABOF            PIC X       VALUE 'H'.
  1802     12  AL-UABON            PIC X       VALUE 'I'.
  1803     12  AL-UADOF            PIC X       VALUE '<'.
  1804     12  AL-UADON            PIC X       VALUE '('.
  1805     12  AL-UANOF            PIC X       VALUE ' '.
  1806     12  AL-UANON            PIC X       VALUE 'A'.
  1807     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1808     12  AL-UNBON            PIC X       VALUE 'R'.
  1809     12  AL-UNDOF            PIC X       VALUE '*'.
  1810     12  AL-UNDON            PIC X       VALUE ')'.
  1811     12  AL-UNNOF            PIC X       VALUE '&'.
  1812     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  36
* EL156.cbl
  1814*    COPY ELCEMIB.
  1815******************************************************************
  1816*                                                                *
  1817*                                                                *
  1818*                            ELCEMIB.                            *
  1819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1820*                            VMOD=2.005                          *
  1821*                                                                *
  1822*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1823*                                                                *
  1824******************************************************************
  1825 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1826     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1827     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1828     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1829     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1830     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1831     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1832     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1833     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1834     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1835         88  EMI-NO-ERRORS                    VALUE '1'.
  1836         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1837         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1838     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1839         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1840     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1841         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1842         88  EMI-AREA1-FULL                   VALUE '2'.
  1843     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1844         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1845         88  EMI-AREA2-FULL                   VALUE '2'.
  1846     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1847         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1848         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1849         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1850         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1851         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1852     12  EMI-ERROR-LINES.
  1853         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1854         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1855         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1856         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1857             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1858                 24  EMI-ERR-NUM         PIC X(4).
  1859                 24  EMI-FILLER          PIC X.
  1860                 24  EMI-SEV             PIC X.
  1861                 24  FILLER              PIC X.
  1862             20  FILLER                  PIC X(02).
  1863     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1864         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1865             20  EMI-ERROR-NUMBER    PIC X(4).
  1866             20  EMI-FILL            PIC X.
  1867             20  EMI-SEVERITY        PIC X.
  1868             20  FILLER              PIC X.
  1869             20  EMI-ERROR-TEXT.
  1870                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1871                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  37
* EL156.cbl
  1872     12  EMI-SEVERITY-SAVE           PIC X.
  1873         88  EMI-NOTE                    VALUE 'N'.
  1874         88  EMI-WARNING                 VALUE 'W'.
  1875         88  EMI-FORCABLE                VALUE 'F'.
  1876         88  EMI-FATAL                   VALUE 'X'.
  1877     12  EMI-MESSAGE-FLAG            PIC X.
  1878         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1879         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1880     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1881     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1882         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1883         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1884         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1885     12  emi-claim-no                pic x(7).
  1886     12  emi-claim-type              pic x(6).
  1887     12  FILLER                      PIC X(124)  VALUE SPACES.
  1888     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1889     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1890     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1891     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  38
* EL156.cbl
  1893*    COPY ELCLNKLT.
  1894******************************************************************
  1895*                                                                *
  1896*                                                                *
  1897*                           ELCLNKLT                             *
  1898*                            VMOD=2.003                          *
  1899*                                                                *
  1900*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1901*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1902*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1903*                                                                *
  1904*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1905*   COMPLETING THE REQUIRED FIELDS.                              *
  1906*                                                                *
  1907*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1908*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1909*                              9999 INDICATES AN UNKNOWN ABEND   *
  1910*                                   WAS DETECTED.                *
  1911*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1912*                              CODES FOUND IN THE ERROR FILE.    *
  1913******************************************************************
  1914 01  W-1523-LINKDATA.
  1915     12  W-1523-COMMON-PI-DATA.
  1916         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1917         16  FILLER              PIC  X(67).
  1918         16  W-1523-COMPANY-CD   PIC  X(01).
  1919         16  FILLER              PIC  X(10).
  1920         16  W-1523-CONTROL-IN-PROGRESS.
  1921             20  W-1523-CARRIER  PIC  X(01).
  1922             20  W-1523-GROUPING PIC  X(06).
  1923             20  W-1523-STATE    PIC  X(02).
  1924             20  W-1523-ACCOUNT  PIC  X(10).
  1925             20  W-1523-CLAIM-CERT-GRP.
  1926                 24  W-1523-CLAIM-NO
  1927                                 PIC  X(07).
  1928                 24  W-1523-CERT-NO.
  1929                     28  W-1523-CERT-PRIME
  1930                                 PIC  X(10).
  1931                     28  W-1523-CERT-SFX
  1932                                 PIC  X(01).
  1933                 24  W-1523-CERT-EFF-DT
  1934                                 PIC  X(02).
  1935         16  FILLER              PIC X(265).
  1936
  1937     12  W-1523-WORK-AREA.
  1938         16  W-1523-FORM-NUMBER  PIC  X(04).
  1939         16  W-1523-NUMBER-COPIES
  1940                                 PIC  9(01).
  1941         16  W-1523-ADDR-TYPE    PIC  X(02).
  1942         16  W-1523-FOLLOW-UP-DATE
  1943                                 PIC  X(02).
  1944         16  W-1523-RESEND-DATE  PIC  X(02).
  1945         16  W-1523-ERROR-CODE   PIC  9(04).
  1946             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1947             88  W-1523-FATAL-ERROR
  1948                                    VALUES  0006 0013 0042
  1949                                            0154 0168 0169
  1950                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  39
* EL156.cbl
  1951                                            0179 0186 0281
  1952                                            0332 2055 3697
  1953                                            3698 3699 3770
  1954                                            3771 3772 7675
  1955                                            9106 9808 9883
  1956                                            9887.
  1957             88  W-1523-STOP-ERRORS
  1958                                    VALUES  0013 0042 0154
  1959                                            0168 0169 0172
  1960                                            0281 0332 2055
  1961                                            3698 3699 7675
  1962                                            9106 9808 9883
  1963                                            9999.
  1964         16  W-1523-REASON       PIC  X(70).
  1965         16  W-1523-ARCHIVE-NUMBER
  1966                                 PIC  9(08).
  1967     12  W-1523-POINTER-AREA.
  1968         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1969         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1970         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1971         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1972         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  40
* EL156.cbl
  1974*    COPY ELCNWA.
  1975*****************************************************************
  1976*                                                               *
  1977*                                                               *
  1978*                            ELCNWA.                            *
  1979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1980*                            VMOD=2.003                         *
  1981*                                                               *
  1982*            M O V E   N A M E   W O R K   A R E A.             *
  1983*                                                               *
  1984*****************************************************************.
  1985
  1986 01  WS-NAME-WORK-AREA.
  1987     05  WS-INSURED-LAST-NAME        PIC X(15).
  1988     05  WS-INSURED-1ST-NAME         PIC X(12).
  1989     05  WS-INSURED-MID-INIT         PIC X.
  1990
  1991     05  WS-NAME-WORK.
  1992         10  WS-NW                   PIC X
  1993             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1994
  1995     05  WS-NAME-WORK2.
  1996         10  WS-NW2                  PIC X
  1997             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1998                                        NWA-INDEX0.
  1999
  2000     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2001                                     COMP-3.
  2002
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  41
* EL156.cbl
  2004*    COPY ELCDMO.
  2005******************************************************************
  2006*                                                                *
  2007*                                                                *
  2008*                            ELCDMO.                             *
  2009*                            VMOD=2.004                          *
  2010*                                                                *
  2011*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2012*        COMMUNICATION AREA                                      *
  2013*   FILE TYPE = NA                                               *
  2014*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2015*                                                                *
  2016******************************************************************
  2017 01  DMO-COMMUNICATION-AREA.
  2018     12  DM-RECORD-TYPE                  PIC  X(02).
  2019             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2020             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2021             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2022     12  DM-DIST-CODE                    PIC  X(04).
  2023     12  DM-MAIL-CODE                    PIC  X(05).
  2024     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2025     12  DM-INSURED-NAME                 PIC  X(30).
  2026     12  DM-CLAIM-NO                     PIC  X(07).
  2027     12  DM-CLAIM-TYPE                   PIC  X.
  2028
  2029     12  DM-STATUS-DATA-AREA.
  2030         16  DM-CLAIM-STATUS             PIC  X.
  2031             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2032             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2033             88  DM-CLOSED                        VALUE '3'.
  2034             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2035             88  DM-DEFAULT                       VALUE '9'.
  2036         16  DM-STATUS-DATE              PIC  X(08).
  2037******YYYYMMDD
  2038         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2039             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2040             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2041             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2042             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2043             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2044             88  DM-RE-OPENED                     VALUE 'R'.
  2045             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2046             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2047             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2048         16  DM-STAT-CARRIER             PIC X.
  2049
  2050     12  DM-DRAFT-DATA-AREA.
  2051         16  DM-PAYMENT-TYPE             PIC  X.
  2052             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2053         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2054         16  DM-PAYMENT-DATE             PIC  X(08).
  2055******YYYYMMDD
  2056         16  DM-CERT-NO                  PIC  X(11).
  2057         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2058         16  DM-CARRIER                  PIC  X.
  2059
  2060     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  42
* EL156.cbl
  2062*    COPY ELCDMDCD.
  2063******************************************************************
  2064*                                                                *
  2065*                                                                *
  2066*                            ELCDMDCD.                           *
  2067*                            VMOD=2.001                          *
  2068*                                                                *
  2069*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2070*       COMMUNICATIONS AREA                                      *
  2071*                                                                *
  2072******************************************************************
  2073 01  CD-COMMUNICATION-AREA.
  2074     12  CD-SYSTEM-ID            PIC  X(02).
  2075         88 CD-CLAIMS                      VALUE 'CL'.
  2076         88 CD-CREDIT                      VALUE 'CR'.
  2077     12  CD-RECORD-TYPE          PIC  X(02).
  2078         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2079         88 CD-EOB-CODE                    VALUE 'EO'.
  2080         88 CD-ICD9-CODE                   VALUE 'I9'.
  2081         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2082         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2083         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2084         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2085         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2086     12  CD-RECORD-KEY           PIC  X(06).
  2087         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2088     12  CD-RETURN-CODE          PIC  X(02).
  2089     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2090     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2091     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2092     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  43
* EL156.cbl
  2094*    COPY ELCDCTB.
  2095******************************************************************
  2096*                                                                *
  2097*                                                                *
  2098*                            ELCDCTB.                            *
  2099*                            VMOD=2.002                          *
  2100*                                                                *
  2101*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2102*       COMMUNICATIONS AREA                                      *
  2103*                                                                *
  2104******************************************************************
  2105 01  DCT-COMMUNICATION-AREA.
  2106     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2107     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2108     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2109     12  DCT-PRODUCT-CODE         PIC  X(02).
  2110     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2111     12  DCT-RETURN-CODE          PIC  X(02).
  2112     12  DCT-MAIL-CODE            PIC  X(05).
  2113     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2114     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  44
* EL156.cbl
  2116 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2117 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2118 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2119 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  45
* EL156.cbl
  2121*    COPY ELCINTF.
  2122******************************************************************
  2123*                                                                *
  2124*                                                                *
  2125*                            ELCINTF.                            *
  2126*                            VMOD=2.017                          *
  2127*                                                                *
  2128*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2129*                                                                *
  2130*       LENGTH = 1024                                            *
  2131*                                                                *
  2132******************************************************************
  2133*                   C H A N G E   L O G
  2134*
  2135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2136*-----------------------------------------------------------------
  2137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2138* EFFECTIVE    NUMBER
  2139*-----------------------------------------------------------------
  2140* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2141******************************************************************
  2142 01  PROGRAM-INTERFACE-BLOCK.
  2143     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2144     12  PI-CALLING-PROGRAM              PIC X(8).
  2145     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2146     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2147     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2148     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2149     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2150     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2151     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2152     12  PI-COMPANY-ID                   PIC XXX.
  2153     12  PI-COMPANY-CD                   PIC X.
  2154
  2155     12  PI-COMPANY-PASSWORD             PIC X(8).
  2156
  2157     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2158
  2159     12  PI-CONTROL-IN-PROGRESS.
  2160         16  PI-CARRIER                  PIC X.
  2161         16  PI-GROUPING                 PIC X(6).
  2162         16  PI-STATE                    PIC XX.
  2163         16  PI-ACCOUNT                  PIC X(10).
  2164         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2165                                         PIC X(10).
  2166         16  PI-CLAIM-CERT-GRP.
  2167             20  PI-CLAIM-NO             PIC X(7).
  2168             20  PI-CERT-NO.
  2169                 25  PI-CERT-PRIME       PIC X(10).
  2170                 25  PI-CERT-SFX         PIC X.
  2171             20  PI-CERT-EFF-DT          PIC XX.
  2172         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2173             20  PI-PLAN-CODE            PIC X(2).
  2174             20  PI-REVISION-NUMBER      PIC X(3).
  2175             20  PI-PLAN-EFF-DT          PIC X(2).
  2176             20  PI-PLAN-EXP-DT          PIC X(2).
  2177             20  FILLER                  PIC X(11).
  2178         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  46
* EL156.cbl
  2179             20  PI-OE-REFERENCE-1.
  2180                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2181                 25  PI-OE-REF-1-SUFF    PIC XX.
  2182
  2183     12  PI-SESSION-IN-PROGRESS          PIC X.
  2184         88  CLAIM-SESSION                   VALUE '1'.
  2185         88  CREDIT-SESSION                  VALUE '2'.
  2186         88  WARRANTY-SESSION                VALUE '3'.
  2187         88  MORTGAGE-SESSION                VALUE '4'.
  2188         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2189
  2190
  2191*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2192
  2193     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2194     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2195
  2196     12  PI-CREDIT-USER                  PIC X.
  2197         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2198         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2199
  2200     12  PI-CLAIM-USER                   PIC X.
  2201         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2202         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2203
  2204     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2205         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2206         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2207         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2208         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2209         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2210
  2211     12  PI-PROCESSOR-ID                 PIC X(4).
  2212
  2213     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2214
  2215     12  PI-MEMBER-CAPTION               PIC X(10).
  2216
  2217     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2218         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2219
  2220     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2221     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2222     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2223     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2224
  2225     12  PI-AH-OVERRIDE-L1               PIC X.
  2226     12  PI-AH-OVERRIDE-L2               PIC XX.
  2227     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2228     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2229
  2230     12  PI-NEW-SYSTEM                   PIC X(2).
  2231
  2232     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2233     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2234         88  PI-USES-PAID-TO                 VALUE '1'.
  2235     12  PI-CRDTCRD-SYSTEM.
  2236         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  47
* EL156.cbl
  2237             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2238             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2239         16  PI-CC-MONTH-END-DT          PIC XX.
  2240     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2241
  2242     12  PI-OE-REFERENCE-2.
  2243         16  PI-OE-REF-2-PRIME           PIC X(10).
  2244         16  PI-OE-REF-2-SUFF            PIC X.
  2245
  2246     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2247
  2248     12  PI-LANGUAGE-TYPE                PIC X.
  2249             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2250             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2251             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2252
  2253     12  PI-POLICY-LINKAGE-IND           PIC X.
  2254         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2255         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2256                                                   LOW-VALUES.
  2257
  2258     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2259     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2260         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2261         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2262
  2263     12  PI-PROCESSOR-CSR-IND            PIC X.
  2264         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2265         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2266
  2267     12  FILLER                          PIC X(3).
  2268
  2269     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2270
  2271     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2272         PI-SYSTEM-LEVEL.
  2273
  2274         16  PI-ENTRY-CODES.
  2275             20  PI-ENTRY-CD-1           PIC X.
  2276             20  PI-ENTRY-CD-2           PIC X.
  2277
  2278         16  PI-RETURN-CODES.
  2279             20  PI-RETURN-CD-1          PIC X.
  2280             20  PI-RETURN-CD-2          PIC X.
  2281
  2282         16  PI-UPDATE-STATUS-SAVE.
  2283             20  PI-UPDATE-BY            PIC X(4).
  2284             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2285
  2286         16  PI-LOWER-CASE-LETTERS       PIC X.
  2287             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2288
  2289*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2290*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2291*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2292
  2293         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2294             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  48
* EL156.cbl
  2295             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2296             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2297             88  ACCNT-CNTL                  VALUE '3'.
  2298             88  CARR-ACCNT-CNTL             VALUE '4'.
  2299
  2300         16  PI-PROCESSOR-CAP-LIST.
  2301             20  PI-SYSTEM-CONTROLS.
  2302                24 PI-SYSTEM-DISPLAY     PIC X.
  2303                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2304                24 PI-SYSTEM-MODIFY      PIC X.
  2305                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2306             20  FILLER                  PIC XX.
  2307             20  PI-DISPLAY-CAP          PIC X.
  2308                 88  DISPLAY-CAP             VALUE 'Y'.
  2309             20  PI-MODIFY-CAP           PIC X.
  2310                 88  MODIFY-CAP              VALUE 'Y'.
  2311             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2312                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2313             20  PI-FORCE-CAP            PIC X.
  2314                 88  FORCE-CAP               VALUE 'Y'.
  2315
  2316         16  PI-PROGRAM-CONTROLS.
  2317             20  PI-PGM-PRINT-OPT        PIC X.
  2318             20  PI-PGM-FORMAT-OPT       PIC X.
  2319             20  PI-PGM-PROCESS-OPT      PIC X.
  2320             20  PI-PGM-TOTALS-OPT       PIC X.
  2321
  2322         16  PI-HELP-INTERFACE.
  2323             20  PI-LAST-ERROR-NO        PIC X(4).
  2324             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2325
  2326         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2327             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2328
  2329         16  PI-CR-CONTROL-IN-PROGRESS.
  2330             20  PI-CR-CARRIER           PIC X.
  2331             20  PI-CR-GROUPING          PIC X(6).
  2332             20  PI-CR-STATE             PIC XX.
  2333             20  PI-CR-ACCOUNT           PIC X(10).
  2334             20  PI-CR-FIN-RESP          PIC X(10).
  2335             20  PI-CR-TYPE              PIC X.
  2336
  2337         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2338
  2339         16  PI-CR-MONTH-END-DT          PIC XX.
  2340
  2341         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2342             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2343             88  PI-ZERO-CARRIER             VALUE '1'.
  2344             88  PI-ZERO-GROUPING            VALUE '2'.
  2345             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2346
  2347         16  PI-CARRIER-SECURITY         PIC X.
  2348             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2349
  2350         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2351             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2352             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  49
* EL156.cbl
  2353
  2354         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2355             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2356                                         INDEXED BY PI-ACCESS-NDX
  2357                                         PIC X.
  2358
  2359         16  PI-GA-BILLING-CONTROL       PIC X.
  2360             88  PI-GA-BILLING               VALUE '1'.
  2361
  2362         16  PI-MAIL-PROCESSING          PIC X.
  2363             88  PI-MAIL-YES                 VALUE 'Y'.
  2364
  2365         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2366
  2367         16  PI-AR-SYSTEM.
  2368             20  PI-AR-PROCESSING-CNTL   PIC X.
  2369                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2370             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2371             20  PI-AR-MONTH-END-DT      PIC XX.
  2372
  2373         16  PI-MP-SYSTEM.
  2374             20  PI-MORTGAGE-USER            PIC X.
  2375                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2376                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2377             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2378                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2379                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2380                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2381                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2382                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2383             20  PI-MP-MONTH-END-DT          PIC XX.
  2384             20  PI-MP-REFERENCE-NO.
  2385                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2386                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2387
  2388         16  PI-LABEL-CONTROL            PIC X(01).
  2389             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2390             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2391
  2392         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2393             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2394
  2395         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2396             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2397             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2398
  2399         16  FILLER                      PIC X(14).
  2400
  2401     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2402******************************************************************
  2403     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2404         16  PI-SAVE-FORM        PIC X(12).
  2405         16  PI-ACCT-KEY         PIC X(26).
  2406         16  PI-PAYEE-NAME       PIC X(30).
  2407         16  PI-DAILY-RATE       PIC S9(3)V99.
  2408         16  PI-MONTH-END-SAVE   PIC XX.
  2409         16  PI-BENEFIT-SAVE.
  2410             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  50
* EL156.cbl
  2411             20  PI-BEN-TYPE     PIC X.
  2412         16  PI-MANUAL-SW        PIC 9.
  2413         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2414         16  PI-PASS-SW          PIC X.
  2415         16  PI-PFKEY-USED       PIC X.
  2416         16  PI-CK-ASSIGN        PIC X.
  2417         16  PI-FATAL-COUNT      PIC 99.
  2418         16  PI-FORCE-COUNT      PIC 99.
  2419         16  PI-SAVE-INPUT.
  2420             20  PI-PMTTYPE      PIC X.
  2421             20  PI-PAYEE.
  2422                 24  PI-PAYEE-TYPE PIC X.
  2423                 24  PI-PAYEE-SEQ  PIC X.
  2424                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2425                   PI-PAYEE-SEQ    PIC S9.
  2426             20  PI-PMTNOTE1     PIC X(60).
  2427             20  PI-PMTNOTE2     PIC X(60).
  2428             20  PI-OFFLINE      PIC X.
  2429             20  PI-ECHECKNO     PIC X(7).
  2430             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2431                 28  PI-ECHECKNO-N     PIC X.
  2432                 28  PI-ECHECKNO-6     PIC X(6).
  2433             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2434                 24  PI-ECHECKNO-CR    PIC XX.
  2435                 24  PI-ECHECKNO-5     PIC X(5).
  2436             20  PI-HOLDTIL      PIC 9(6).
  2437             20  PI-EPYFROM      PIC 9(6).
  2438             20  PI-EPYTHRU      PIC 9(6).
  2439             20  PI-EDAYS        PIC S9(5).
  2440             20  PI-EPYAMT       PIC S9(7)V99.
  2441             20  PI-ERESV        PIC S9(7)V99.
  2442             20  PI-EEXPENS      PIC 9(6)V99.
  2443             20  PI-ETYPE        PIC X.
  2444             20  PI-CASH         PIC X.
  2445             20  PI-GROUPED      PIC X.
  2446             20  PI-INT-RATE     PIC S99V9(5).
  2447             20  PI-AIGFROM      PIC 9(6).
  2448             20  PI-LOAN-NO      PIC X(20).
  2449             20  PI-PROOF-DATE   PIC 9(6).
  2450             20  PI-PRINT-EOB-YN PIC X.
  2451             20  PI-PRINT-CLM-FRM-YN PIC X.
  2452             20  PI-PRINT-SURVEY-YN PIC X.
  2453         16  PI-SAVE-COMPUTED.
  2454             20  PI-CCHECKNO     PIC X(7).
  2455             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2456                 28  PI-CCHECKNO-N     PIC X.
  2457                 28  PI-CCHECKNO-6     PIC X(6).
  2458             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2459                 24  PI-CCHECKNO-CR    PIC XX.
  2460                 24  PI-CCHECKNO-5     PIC X(5).
  2461             20  PI-CPYFROM      PIC XX.
  2462             20  PI-CPYTHRU      PIC XX.
  2463             20  PI-CDAYS        PIC S9(5).
  2464             20  PI-CPYAMT       PIC S9(7)V99.
  2465             20  PI-CRESV        PIC 9(6)V99.
  2466             20  PI-CEXPENS      PIC 9(6)V99.
  2467             20  PI-PMT-APPR-SW  PIC X.
  2468                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  51
* EL156.cbl
  2469                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2470                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2471         16  PI-PREV-CLMNO       PIC X(7).
  2472         16  PI-LF-COVERAGE-TYPE PIC X.
  2473         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2474         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2475         16  PI-PROVISIONAL-IND  PIC X.
  2476             88 PI-PROV-PMT      VALUE 'P'.
  2477         16  PI-PREV-TRLR-KEY    PIC X(22).
  2478         16  PI-SPLIT-PMT-SW     PIC X.
  2479         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2480         16  PI-ACTIVITY-CODE    PIC 99.
  2481         16  PI-RESET-SW         PIC X.
  2482         16  PI-SPECIAL-BEN-SW   PIC X.
  2483             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2484         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2485         16  PI-EXP-DT           PIC XX.
  2486         16  PI-LOAN-DUE-DAY     PIC 99.
  2487         16  PI-3RD-PARTY-SW     PIC X.
  2488         16  PI-LOAN-UPDATE-SW   PIC X.
  2489
  2490         16  PI-DMD-DATA.
  2491             20  PI-SV-CERT-KEY       PIC X(21).
  2492             20  PI-SV-CERT-NO        PIC X(11).
  2493             20  PI-SV-BEN            PIC X(10).
  2494             20  PI-SV-CCN            PIC X(16).
  2495             20  PI-INTEREST-PAID-IND PIC X.
  2496                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2497             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2498             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2499             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2500             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2501         16  PI-AT-EOB-CODES.
  2502             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2503         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2504         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2505         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2506         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2507         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2508         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2509         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2510         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2511         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2512         16  PI-LF-BENEFIT-CD         PIC X(2).
  2513         16  PI-EOB-CODES-EXIST PIC X.
  2514         16  PI-SET-NOTE2-MDT   PIC X.
  2515         16  PI-VFY-2ND-BENE          PIC X.
  2516         16  PI-CLM-TYPE              PIC X.
  2517         16  PI-APPROVAL-LEVEL        PIC X.
  2518         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2519         16  PI-REAUDIT-NEEDED        PIC X.
  2520         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2521         16  PI-AH-BENEFIT-CD         PIC XX.
  2522*00781          16  FILLER                   PIC X(176).
  2523*052506         16  FILLER                   PIC X(161).
  2524*031808         16  FILLER                   PIC X(154).
  2525*091808         16  FILLER                   PIC X(152).
  2526*041710         16  FILLER                   PIC X(94).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  52
* EL156.cbl
  2527         16  FILLER                   PIC X(82).
  2528
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  53
* EL156.cbl
  2530*    COPY ELCJPFX.
  2531******************************************************************
  2532*                                                                *
  2533*                                                                *
  2534*                            ELCJPFX.                            *
  2535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2536*                            VMOD=2.002                          *
  2537*                                                                *
  2538*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2539*                                                                *
  2540*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2541*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2542*        ELCNTL - CONTROL FILE                                   *
  2543*        ELMSTR - CLAIM MASTERS                                  *
  2544*        ELTRLR - ACTIVITY TRAILERS                              *
  2545*        ELCHKQ - CHECK QUE                                      *
  2546******************************************************************
  2547 01  JOURNAL-RECORD.
  2548     12  JP-USER-ID                  PIC X(4).
  2549     12  JP-FILE-ID                  PIC X(8).
  2550     12  JP-PROGRAM-ID               PIC X(8).
  2551     12  JP-RECORD-TYPE              PIC X.
  2552         88 JP-ADD              VALUE 'A'.
  2553         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2554         88 JP-AFTER-CHANGE     VALUE 'C'.
  2555         88 JP-DELETE           VALUE 'D'.
  2556         88 JP-GENERIC-DELETE   VALUE 'G'.
  2557         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2558         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2559     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2560     12  JP-RECORD-AREA
  2561
  2562
  2563                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  54
* EL156.cbl
  2565*    COPY ELCAID.
  2566******************************************************************
  2567*                                                                *
  2568*                            ELCAID.                             *
  2569*                            VMOD=2.001                          *
  2570*                                                                *
  2571*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2572*                                                                *
  2573*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2574*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2575******************************************************************
  2576
  2577 01  DFHAID.
  2578   02  DFHNULL   PIC  X  VALUE  ' '.
  2579   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2580   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2581   02  DFHPEN    PIC  X  VALUE  '='.
  2582   02  DFHOPID   PIC  X  VALUE  'W'.
  2583   02  DFHPA1    PIC  X  VALUE  '%'.
  2584   02  DFHPA2    PIC  X  VALUE  '>'.
  2585   02  DFHPA3    PIC  X  VALUE  ','.
  2586   02  DFHPF1    PIC  X  VALUE  '1'.
  2587   02  DFHPF2    PIC  X  VALUE  '2'.
  2588   02  DFHPF3    PIC  X  VALUE  '3'.
  2589   02  DFHPF4    PIC  X  VALUE  '4'.
  2590   02  DFHPF5    PIC  X  VALUE  '5'.
  2591   02  DFHPF6    PIC  X  VALUE  '6'.
  2592   02  DFHPF7    PIC  X  VALUE  '7'.
  2593   02  DFHPF8    PIC  X  VALUE  '8'.
  2594   02  DFHPF9    PIC  X  VALUE  '9'.
  2595   02  DFHPF10   PIC  X  VALUE  ':'.
  2596   02  DFHPF11   PIC  X  VALUE  '#'.
  2597   02  DFHPF12   PIC  X  VALUE  '@'.
  2598   02  DFHPF13   PIC  X  VALUE  'A'.
  2599   02  DFHPF14   PIC  X  VALUE  'B'.
  2600   02  DFHPF15   PIC  X  VALUE  'C'.
  2601   02  DFHPF16   PIC  X  VALUE  'D'.
  2602   02  DFHPF17   PIC  X  VALUE  'E'.
  2603   02  DFHPF18   PIC  X  VALUE  'F'.
  2604   02  DFHPF19   PIC  X  VALUE  'G'.
  2605   02  DFHPF20   PIC  X  VALUE  'H'.
  2606   02  DFHPF21   PIC  X  VALUE  'I'.
  2607*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2608   02  DFHPF22   PIC  X  VALUE  '['.
  2609   02  DFHPF23   PIC  X  VALUE  '.'.
  2610   02  DFHPF24   PIC  X  VALUE  '<'.
  2611   02  DFHMSRE   PIC  X  VALUE  'X'.
  2612   02  DFHSTRF   PIC  X  VALUE  'h'.
  2613   02  DFHTRIG   PIC  X  VALUE  '"'.
  2614 01  FILLER    REDEFINES DFHAID.
  2615     12  FILLER              PIC X(8).
  2616     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  55
* EL156.cbl
  2618*    COPY EL156S.
  2619 01  EL156AI.
  2620     05  FILLER            PIC  X(0012).
  2621*    -------------------------------
  2622     05  RUNDTEAL PIC S9(0004) COMP.
  2623     05  RUNDTEAF PIC  X(0001).
  2624     05  FILLER REDEFINES RUNDTEAF.
  2625         10  RUNDTEAA PIC  X(0001).
  2626     05  RUNDTEAI PIC  X(0008).
  2627*    -------------------------------
  2628     05  RUNTIMAL PIC S9(0004) COMP.
  2629     05  RUNTIMAF PIC  X(0001).
  2630     05  FILLER REDEFINES RUNTIMAF.
  2631         10  RUNTIMAA PIC  X(0001).
  2632     05  RUNTIMAI PIC  X(0005).
  2633*    -------------------------------
  2634     05  SEQUL PIC S9(0004) COMP.
  2635     05  SEQUF PIC  X(0001).
  2636     05  FILLER REDEFINES SEQUF.
  2637         10  SEQUA PIC  X(0001).
  2638     05  SEQUI PIC  X(0010).
  2639*    -------------------------------
  2640     05  CLMNOL PIC S9(0004) COMP.
  2641     05  CLMNOF PIC  X(0001).
  2642     05  FILLER REDEFINES CLMNOF.
  2643         10  CLMNOA PIC  X(0001).
  2644     05  CLMNOI PIC  X(0007).
  2645*    -------------------------------
  2646     05  CARRL PIC S9(0004) COMP.
  2647     05  CARRF PIC  X(0001).
  2648     05  FILLER REDEFINES CARRF.
  2649         10  CARRA PIC  X(0001).
  2650     05  CARRI PIC  X(0001).
  2651*    -------------------------------
  2652     05  CERTNOL PIC S9(0004) COMP.
  2653     05  CERTNOF PIC  X(0001).
  2654     05  FILLER REDEFINES CERTNOF.
  2655         10  CERTNOA PIC  X(0001).
  2656     05  CERTNOI PIC  X(0010).
  2657*    -------------------------------
  2658     05  SUFXL PIC S9(0004) COMP.
  2659     05  SUFXF PIC  X(0001).
  2660     05  FILLER REDEFINES SUFXF.
  2661         10  SUFXA PIC  X(0001).
  2662     05  SUFXI PIC  X(0001).
  2663*    -------------------------------
  2664     05  CLMTYPL PIC S9(0004) COMP.
  2665     05  CLMTYPF PIC  X(0001).
  2666     05  FILLER REDEFINES CLMTYPF.
  2667         10  CLMTYPA PIC  X(0001).
  2668     05  CLMTYPI PIC  X(0006).
  2669*    -------------------------------
  2670     05  CLMSTATL PIC S9(0004) COMP.
  2671     05  CLMSTATF PIC  X(0001).
  2672     05  FILLER REDEFINES CLMSTATF.
  2673         10  CLMSTATA PIC  X(0001).
  2674     05  CLMSTATI PIC  X(0006).
  2675*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  56
* EL156.cbl
  2676     05  LSTNMEL PIC S9(0004) COMP.
  2677     05  LSTNMEF PIC  X(0001).
  2678     05  FILLER REDEFINES LSTNMEF.
  2679         10  LSTNMEA PIC  X(0001).
  2680     05  LSTNMEI PIC  X(0015).
  2681*    -------------------------------
  2682     05  FSTNMEL PIC S9(0004) COMP.
  2683     05  FSTNMEF PIC  X(0001).
  2684     05  FILLER REDEFINES FSTNMEF.
  2685         10  FSTNMEA PIC  X(0001).
  2686     05  FSTNMEI PIC  X(0012).
  2687*    -------------------------------
  2688     05  MINITL PIC S9(0004) COMP.
  2689     05  MINITF PIC  X(0001).
  2690     05  FILLER REDEFINES MINITF.
  2691         10  MINITA PIC  X(0001).
  2692     05  MINITI PIC  X(0001).
  2693*    -------------------------------
  2694     05  PRIMHDGL PIC S9(0004) COMP.
  2695     05  PRIMHDGF PIC  X(0001).
  2696     05  FILLER REDEFINES PRIMHDGF.
  2697         10  PRIMHDGA PIC  X(0001).
  2698     05  PRIMHDGI PIC  X(0012).
  2699*    -------------------------------
  2700     05  PCERTNOL PIC S9(0004) COMP.
  2701     05  PCERTNOF PIC  X(0001).
  2702     05  FILLER REDEFINES PCERTNOF.
  2703         10  PCERTNOA PIC  X(0001).
  2704     05  PCERTNOI PIC  X(0010).
  2705*    -------------------------------
  2706     05  PSUFXL PIC S9(0004) COMP.
  2707     05  PSUFXF PIC  X(0001).
  2708     05  FILLER REDEFINES PSUFXF.
  2709         10  PSUFXA PIC  X(0001).
  2710     05  PSUFXI PIC  X(0001).
  2711*    -------------------------------
  2712     05  STATUSL PIC S9(0004) COMP.
  2713     05  STATUSF PIC  X(0001).
  2714     05  FILLER REDEFINES STATUSF.
  2715         10  STATUSA PIC  X(0001).
  2716     05  STATUSI PIC  X(0010).
  2717*    -------------------------------
  2718     05  LOANHL PIC S9(0004) COMP.
  2719     05  LOANHF PIC  X(0001).
  2720     05  FILLER REDEFINES LOANHF.
  2721         10  LOANHA PIC  X(0001).
  2722     05  LOANHI PIC  X(0014).
  2723*    -------------------------------
  2724     05  LOANNOL PIC S9(0004) COMP.
  2725     05  LOANNOF PIC  X(0001).
  2726     05  FILLER REDEFINES LOANNOF.
  2727         10  LOANNOA PIC  X(0001).
  2728     05  LOANNOI PIC  X(0025).
  2729*    -------------------------------
  2730     05  DUEDAYHL PIC S9(0004) COMP.
  2731     05  DUEDAYHF PIC  X(0001).
  2732     05  FILLER REDEFINES DUEDAYHF.
  2733         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  57
* EL156.cbl
  2734     05  DUEDAYHI PIC  X(0008).
  2735*    -------------------------------
  2736     05  DUEDAYL PIC S9(0004) COMP.
  2737     05  DUEDAYF PIC  X(0001).
  2738     05  FILLER REDEFINES DUEDAYF.
  2739         10  DUEDAYA PIC  X(0001).
  2740     05  DUEDAYI PIC  X(0002).
  2741*    -------------------------------
  2742     05  ZINTHL PIC S9(0004) COMP.
  2743     05  ZINTHF PIC  X(0001).
  2744     05  FILLER REDEFINES ZINTHF.
  2745         10  ZINTHA PIC  X(0001).
  2746     05  ZINTHI PIC  X(0009).
  2747*    -------------------------------
  2748     05  ZINTL PIC S9(0004) COMP.
  2749     05  ZINTF PIC  X(0001).
  2750     05  FILLER REDEFINES ZINTF.
  2751         10  ZINTA PIC  X(0001).
  2752     05  ZINTI PIC  99V99999.
  2753*    -------------------------------
  2754     05  PTHRHDGL PIC S9(0004) COMP.
  2755     05  PTHRHDGF PIC  X(0001).
  2756     05  FILLER REDEFINES PTHRHDGF.
  2757         10  PTHRHDGA PIC  X(0001).
  2758     05  PTHRHDGI PIC  X(0014).
  2759*    -------------------------------
  2760     05  PDTHRUL PIC S9(0004) COMP.
  2761     05  PDTHRUF PIC  X(0001).
  2762     05  FILLER REDEFINES PDTHRUF.
  2763         10  PDTHRUA PIC  X(0001).
  2764     05  PDTHRUI PIC  X(0008).
  2765*    -------------------------------
  2766     05  TOTPAIDL PIC S9(0004) COMP.
  2767     05  TOTPAIDF PIC  X(0001).
  2768     05  FILLER REDEFINES TOTPAIDF.
  2769         10  TOTPAIDA PIC  X(0001).
  2770     05  TOTPAIDI PIC  X(0010).
  2771*    -------------------------------
  2772     05  COVERL PIC S9(0004) COMP.
  2773     05  COVERF PIC  X(0001).
  2774     05  FILLER REDEFINES COVERF.
  2775         10  COVERA PIC  X(0001).
  2776     05  COVERI PIC  X(0010).
  2777*    -------------------------------
  2778     05  INCURL PIC S9(0004) COMP.
  2779     05  INCURF PIC  X(0001).
  2780     05  FILLER REDEFINES INCURF.
  2781         10  INCURA PIC  X(0001).
  2782     05  INCURI PIC  X(0008).
  2783*    -------------------------------
  2784     05  LSTDTEL PIC S9(0004) COMP.
  2785     05  LSTDTEF PIC  X(0001).
  2786     05  FILLER REDEFINES LSTDTEF.
  2787         10  LSTDTEA PIC  X(0001).
  2788     05  LSTDTEI PIC  X(0008).
  2789*    -------------------------------
  2790     05  CRTSTATL PIC S9(0004) COMP.
  2791     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  58
* EL156.cbl
  2792     05  FILLER REDEFINES CRTSTATF.
  2793         10  CRTSTATA PIC  X(0001).
  2794     05  CRTSTATI PIC  X(0010).
  2795*    -------------------------------
  2796     05  EFFECTL PIC S9(0004) COMP.
  2797     05  EFFECTF PIC  X(0001).
  2798     05  FILLER REDEFINES EFFECTF.
  2799         10  EFFECTA PIC  X(0001).
  2800     05  EFFECTI PIC  X(0008).
  2801*    -------------------------------
  2802     05  TERMSL PIC S9(0004) COMP.
  2803     05  TERMSF PIC  X(0001).
  2804     05  FILLER REDEFINES TERMSF.
  2805         10  TERMSA PIC  X(0001).
  2806     05  TERMSI PIC  X(0011).
  2807*    -------------------------------
  2808     05  STACCTL PIC S9(0004) COMP.
  2809     05  STACCTF PIC  X(0001).
  2810     05  FILLER REDEFINES STACCTF.
  2811         10  STACCTA PIC  X(0001).
  2812     05  STACCTI PIC  X(0013).
  2813*    -------------------------------
  2814     05  EXPDTEHL PIC S9(0004) COMP.
  2815     05  EXPDTEHF PIC  X(0001).
  2816     05  FILLER REDEFINES EXPDTEHF.
  2817         10  EXPDTEHA PIC  X(0001).
  2818     05  EXPDTEHI PIC  X(0014).
  2819*    -------------------------------
  2820     05  EXPDTEL PIC S9(0004) COMP.
  2821     05  EXPDTEF PIC  X(0001).
  2822     05  FILLER REDEFINES EXPDTEF.
  2823         10  EXPDTEA PIC  X(0001).
  2824     05  EXPDTEI PIC  X(0008).
  2825*    -------------------------------
  2826     05  BENECAPL PIC S9(0004) COMP.
  2827     05  BENECAPF PIC  X(0001).
  2828     05  FILLER REDEFINES BENECAPF.
  2829         10  BENECAPA PIC  X(0001).
  2830     05  BENECAPI PIC  X(0013).
  2831*    -------------------------------
  2832     05  BENEL PIC S9(0004) COMP.
  2833     05  BENEF PIC  X(0001).
  2834     05  FILLER REDEFINES BENEF.
  2835         10  BENEA PIC  X(0001).
  2836     05  BENEI PIC  X(0009).
  2837*    -------------------------------
  2838     05  FORMTYPL PIC S9(0004) COMP.
  2839     05  FORMTYPF PIC  X(0001).
  2840     05  FILLER REDEFINES FORMTYPF.
  2841         10  FORMTYPA PIC  X(0001).
  2842     05  FORMTYPI PIC  X(0001).
  2843*    -------------------------------
  2844     05  PMTTYPEL PIC S9(0004) COMP.
  2845     05  PMTTYPEF PIC  X(0001).
  2846     05  FILLER REDEFINES PMTTYPEF.
  2847         10  PMTTYPEA PIC  X(0001).
  2848     05  PMTTYPEI PIC  X(0001).
  2849*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  59
* EL156.cbl
  2850     05  PAYEEL PIC S9(0004) COMP.
  2851     05  PAYEEF PIC  X(0001).
  2852     05  FILLER REDEFINES PAYEEF.
  2853         10  PAYEEA PIC  X(0001).
  2854     05  PAYEEI PIC  X(0002).
  2855*    -------------------------------
  2856     05  CHECKNOL PIC S9(0004) COMP.
  2857     05  CHECKNOF PIC  X(0001).
  2858     05  FILLER REDEFINES CHECKNOF.
  2859         10  CHECKNOA PIC  X(0001).
  2860     05  CHECKNOI PIC  X(0007).
  2861*    -------------------------------
  2862     05  OFFLINEL PIC S9(0004) COMP.
  2863     05  OFFLINEF PIC  X(0001).
  2864     05  FILLER REDEFINES OFFLINEF.
  2865         10  OFFLINEA PIC  X(0001).
  2866     05  OFFLINEI PIC  X(0001).
  2867*    -------------------------------
  2868     05  HOLDTILL PIC S9(0004) COMP.
  2869     05  HOLDTILF PIC  X(0001).
  2870     05  FILLER REDEFINES HOLDTILF.
  2871         10  HOLDTILA PIC  X(0001).
  2872     05  HOLDTILI PIC  X(0008).
  2873*    -------------------------------
  2874     05  NOTE1L PIC S9(0004) COMP.
  2875     05  NOTE1F PIC  X(0001).
  2876     05  FILLER REDEFINES NOTE1F.
  2877         10  NOTE1A PIC  X(0001).
  2878     05  NOTE1I PIC  X(0060).
  2879*    -------------------------------
  2880     05  NOTE2L PIC S9(0004) COMP.
  2881     05  NOTE2F PIC  X(0001).
  2882     05  FILLER REDEFINES NOTE2F.
  2883         10  NOTE2A PIC  X(0001).
  2884     05  NOTE2I PIC  X(0060).
  2885*    -------------------------------
  2886     05  EOBYNL PIC S9(0004) COMP.
  2887     05  EOBYNF PIC  X(0001).
  2888     05  FILLER REDEFINES EOBYNF.
  2889         10  EOBYNA PIC  X(0001).
  2890     05  EOBYNI PIC  X(0001).
  2891*    -------------------------------
  2892     05  CLMFMYNL PIC S9(0004) COMP.
  2893     05  CLMFMYNF PIC  X(0001).
  2894     05  FILLER REDEFINES CLMFMYNF.
  2895         10  CLMFMYNA PIC  X(0001).
  2896     05  CLMFMYNI PIC  X(0001).
  2897*    -------------------------------
  2898     05  SURVYYNL PIC S9(0004) COMP.
  2899     05  SURVYYNF PIC  X(0001).
  2900     05  FILLER REDEFINES SURVYYNF.
  2901         10  SURVYYNA PIC  X(0001).
  2902     05  SURVYYNI PIC  X(0001).
  2903*    -------------------------------
  2904     05  PINTHL PIC S9(0004) COMP.
  2905     05  PINTHF PIC  X(0001).
  2906     05  FILLER REDEFINES PINTHF.
  2907         10  PINTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  60
* EL156.cbl
  2908     05  PINTHI PIC  X(0004).
  2909*    -------------------------------
  2910     05  PINTL PIC S9(0004) COMP.
  2911     05  PINTF PIC  X(0001).
  2912     05  FILLER REDEFINES PINTF.
  2913         10  PINTA PIC  X(0001).
  2914     05  PINTI PIC  X(0008).
  2915*    -------------------------------
  2916     05  PROOFDTL PIC S9(0004) COMP.
  2917     05  PROOFDTF PIC  X(0001).
  2918     05  FILLER REDEFINES PROOFDTF.
  2919         10  PROOFDTA PIC  X(0001).
  2920     05  PROOFDTI PIC  X(0008).
  2921*    -------------------------------
  2922     05  AIGFRMHL PIC S9(0004) COMP.
  2923     05  AIGFRMHF PIC  X(0001).
  2924     05  FILLER REDEFINES AIGFRMHF.
  2925         10  AIGFRMHA PIC  X(0001).
  2926     05  AIGFRMHI PIC  X(0012).
  2927*    -------------------------------
  2928     05  AIGFROML PIC S9(0004) COMP.
  2929     05  AIGFROMF PIC  X(0001).
  2930     05  FILLER REDEFINES AIGFROMF.
  2931         10  AIGFROMA PIC  X(0001).
  2932     05  AIGFROMI PIC  X(0008).
  2933*    -------------------------------
  2934     05  PMTHDGAL PIC S9(0004) COMP.
  2935     05  PMTHDGAF PIC  X(0001).
  2936     05  FILLER REDEFINES PMTHDGAF.
  2937         10  PMTHDGAA PIC  X(0001).
  2938     05  PMTHDGAI PIC  X(0066).
  2939*    -------------------------------
  2940     05  EPYFROML PIC S9(0004) COMP.
  2941     05  EPYFROMF PIC  X(0001).
  2942     05  FILLER REDEFINES EPYFROMF.
  2943         10  EPYFROMA PIC  X(0001).
  2944     05  EPYFROMI PIC  X(0008).
  2945*    -------------------------------
  2946     05  EPYTHRUL PIC S9(0004) COMP.
  2947     05  EPYTHRUF PIC  X(0001).
  2948     05  FILLER REDEFINES EPYTHRUF.
  2949         10  EPYTHRUA PIC  X(0001).
  2950     05  EPYTHRUI PIC  X(0008).
  2951*    -------------------------------
  2952     05  EDAYSL PIC S9(0004) COMP.
  2953     05  EDAYSF PIC  X(0001).
  2954     05  FILLER REDEFINES EDAYSF.
  2955         10  EDAYSA PIC  X(0001).
  2956     05  EDAYSI PIC  S9(6).
  2957*    -------------------------------
  2958     05  EPYAMTL PIC S9(0004) COMP.
  2959     05  EPYAMTF PIC  X(0001).
  2960     05  FILLER REDEFINES EPYAMTF.
  2961         10  EPYAMTA PIC  X(0001).
  2962     05  EPYAMTI PIC  S9(8)V99.
  2963*    -------------------------------
  2964     05  ERESVL PIC S9(0004) COMP.
  2965     05  ERESVF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  61
* EL156.cbl
  2966     05  FILLER REDEFINES ERESVF.
  2967         10  ERESVA PIC  X(0001).
  2968     05  ERESVI PIC  S9(7)V99.
  2969*    -------------------------------
  2970     05  ETYPEL PIC S9(0004) COMP.
  2971     05  ETYPEF PIC  X(0001).
  2972     05  FILLER REDEFINES ETYPEF.
  2973         10  ETYPEA PIC  X(0001).
  2974     05  ETYPEI PIC  X(0001).
  2975*    -------------------------------
  2976     05  EEXPENSL PIC S9(0004) COMP.
  2977     05  EEXPENSF PIC  X(0001).
  2978     05  FILLER REDEFINES EEXPENSF.
  2979         10  EEXPENSA PIC  X(0001).
  2980     05  EEXPENSI PIC  9(6)V99.
  2981*    -------------------------------
  2982     05  CPYFROML PIC S9(0004) COMP.
  2983     05  CPYFROMF PIC  X(0001).
  2984     05  FILLER REDEFINES CPYFROMF.
  2985         10  CPYFROMA PIC  X(0001).
  2986     05  CPYFROMI PIC  X(0008).
  2987*    -------------------------------
  2988     05  CPYTHRUL PIC S9(0004) COMP.
  2989     05  CPYTHRUF PIC  X(0001).
  2990     05  FILLER REDEFINES CPYTHRUF.
  2991         10  CPYTHRUA PIC  X(0001).
  2992     05  CPYTHRUI PIC  X(0008).
  2993*    -------------------------------
  2994     05  CDAYSL PIC S9(0004) COMP.
  2995     05  CDAYSF PIC  X(0001).
  2996     05  FILLER REDEFINES CDAYSF.
  2997         10  CDAYSA PIC  X(0001).
  2998     05  CDAYSI PIC  9(6).
  2999*    -------------------------------
  3000     05  CPYAMTL PIC S9(0004) COMP.
  3001     05  CPYAMTF PIC  X(0001).
  3002     05  FILLER REDEFINES CPYAMTF.
  3003         10  CPYAMTA PIC  X(0001).
  3004     05  CPYAMTI PIC  S9(8)V99.
  3005*    -------------------------------
  3006     05  CRESVL PIC S9(0004) COMP.
  3007     05  CRESVF PIC  X(0001).
  3008     05  FILLER REDEFINES CRESVF.
  3009         10  CRESVA PIC  X(0001).
  3010     05  CRESVI PIC  9(6)V99.
  3011*    -------------------------------
  3012     05  CEXPENSL PIC S9(0004) COMP.
  3013     05  CEXPENSF PIC  X(0001).
  3014     05  FILLER REDEFINES CEXPENSF.
  3015         10  CEXPENSA PIC  X(0001).
  3016     05  CEXPENSI PIC  9(6)V99.
  3017*    -------------------------------
  3018     05  ERRMSG0L PIC S9(0004) COMP.
  3019     05  ERRMSG0F PIC  X(0001).
  3020     05  FILLER REDEFINES ERRMSG0F.
  3021         10  ERRMSG0A PIC  X(0001).
  3022     05  ERRMSG0I PIC  X(0072).
  3023*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  62
* EL156.cbl
  3024     05  ERRMSG1L PIC S9(0004) COMP.
  3025     05  ERRMSG1F PIC  X(0001).
  3026     05  FILLER REDEFINES ERRMSG1F.
  3027         10  ERRMSG1A PIC  X(0001).
  3028     05  ERRMSG1I PIC  X(0072).
  3029*    -------------------------------
  3030     05  ERRMSG2L PIC S9(0004) COMP.
  3031     05  ERRMSG2F PIC  X(0001).
  3032     05  FILLER REDEFINES ERRMSG2F.
  3033         10  ERRMSG2A PIC  X(0001).
  3034     05  ERRMSG2I PIC  X(0072).
  3035*    -------------------------------
  3036     05  ENTERPFL PIC S9(0004) COMP.
  3037     05  ENTERPFF PIC  X(0001).
  3038     05  FILLER REDEFINES ENTERPFF.
  3039         10  ENTERPFA PIC  X(0001).
  3040     05  ENTERPFI PIC  99.
  3041*    -------------------------------
  3042     05  PF6TITL PIC S9(0004) COMP.
  3043     05  PF6TITF PIC  X(0001).
  3044     05  FILLER REDEFINES PF6TITF.
  3045         10  PF6TITA PIC  X(0001).
  3046     05  PF6TITI PIC  X(0016).
  3047 01  EL156AO REDEFINES EL156AI.
  3048     05  FILLER            PIC  X(0012).
  3049*    -------------------------------
  3050     05  FILLER            PIC  X(0003).
  3051     05  RUNDTEAO PIC  X(0008).
  3052*    -------------------------------
  3053     05  FILLER            PIC  X(0003).
  3054     05  RUNTIMAO PIC  99.99.
  3055*    -------------------------------
  3056     05  FILLER            PIC  X(0003).
  3057     05  SEQUO PIC  X(0010).
  3058*    -------------------------------
  3059     05  FILLER            PIC  X(0003).
  3060     05  CLMNOO PIC  X(0007).
  3061*    -------------------------------
  3062     05  FILLER            PIC  X(0003).
  3063     05  CARRO PIC  X(0001).
  3064*    -------------------------------
  3065     05  FILLER            PIC  X(0003).
  3066     05  CERTNOO PIC  X(0010).
  3067*    -------------------------------
  3068     05  FILLER            PIC  X(0003).
  3069     05  SUFXO PIC  X(0001).
  3070*    -------------------------------
  3071     05  FILLER            PIC  X(0003).
  3072     05  CLMTYPO PIC  X(0006).
  3073*    -------------------------------
  3074     05  FILLER            PIC  X(0003).
  3075     05  CLMSTATO PIC  X(0006).
  3076*    -------------------------------
  3077     05  FILLER            PIC  X(0003).
  3078     05  LSTNMEO PIC  X(0015).
  3079*    -------------------------------
  3080     05  FILLER            PIC  X(0003).
  3081     05  FSTNMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  63
* EL156.cbl
  3082*    -------------------------------
  3083     05  FILLER            PIC  X(0003).
  3084     05  MINITO PIC  X(0001).
  3085*    -------------------------------
  3086     05  FILLER            PIC  X(0003).
  3087     05  PRIMHDGO PIC  X(0012).
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  PCERTNOO PIC  X(0010).
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
  3093     05  PSUFXO PIC  X(0001).
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  STATUSO PIC  X(0010).
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  LOANHO PIC  X(0014).
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  LOANNOO PIC  X(0025).
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  DUEDAYHO PIC  X(0008).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  DUEDAYO PIC  X(0002).
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  ZINTHO PIC  X(0009).
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  ZINTO PIC  9.99999.
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  PTHRHDGO PIC  X(0014).
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  PDTHRUO PIC  X(0008).
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  TOTPAIDO PIC  Z(6).99-.
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  COVERO PIC  X(0010).
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  INCURO PIC  X(0008).
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  LSTDTEO PIC  X(0008).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  CRTSTATO PIC  X(0010).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  EFFECTO PIC  X(0008).
  3139*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  64
* EL156.cbl
  3140     05  FILLER            PIC  X(0003).
  3141     05  TERMSO PIC  X(0011).
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  STACCTO PIC  X(0013).
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  EXPDTEHO PIC  X(0014).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  EXPDTEO PIC  X(0008).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  BENECAPO PIC  X(0013).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  BENEO PIC  Z(6).99.
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  FORMTYPO PIC  X(0001).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  PMTTYPEO PIC  X(0001).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  PAYEEO PIC  X(0002).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  CHECKNOO PIC  X(0007).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  OFFLINEO PIC  X(0001).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  HOLDTILO PIC  99B99B99.
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  NOTE1O PIC  X(0060).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  NOTE2O PIC  X(0060).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  EOBYNO PIC  X(0001).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  CLMFMYNO PIC  X(0001).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  SURVYYNO PIC  X(0001).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  PINTHO PIC  X(0004).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  PINTO PIC  Z,ZZ9.99.
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  65
* EL156.cbl
  3198     05  PROOFDTO PIC  99B99B99.
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  AIGFRMHO PIC  X(0012).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  AIGFROMO PIC  99B99B99.
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  PMTHDGAO PIC  X(0066).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  EPYFROMO PIC  99B99B99.
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  EPYTHRUO PIC  99B99B99.
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  EDAYSO PIC  Z(4)9-.
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  EPYAMTO PIC  Z(6).99-.
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  ERESVO PIC  Z(5).99-.
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  ETYPEO PIC  X(0001).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  EEXPENSO PIC  Z(5).99.
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  CPYFROMO PIC  99B99B99.
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  CPYTHRUO PIC  99B99B99.
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  CDAYSO PIC  Z(4)9-.
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  CPYAMTO PIC  Z(6).99-.
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  CRESVO PIC  Z(5).99.
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  CEXPENSO PIC  Z(5).99.
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  ERRMSG0O PIC  X(0072).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  ERRMSG1O PIC  X(0072).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  ERRMSG2O PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  66
* EL156.cbl
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  ENTERPFO PIC  X(0002).
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  PF6TITO PIC  X(0016).
  3262*    -------------------------------
  3263 01  EL156BI REDEFINES EL156AI.
  3264     05  FILLER            PIC  X(0012).
  3265*    -------------------------------
  3266     05  RUNDTEBL PIC S9(0004) COMP.
  3267     05  RUNDTEBF PIC  X(0001).
  3268     05  FILLER REDEFINES RUNDTEBF.
  3269         10  RUNDTEBA PIC  X(0001).
  3270     05  RUNDTEBI PIC  X(0008).
  3271*    -------------------------------
  3272     05  RUNTIMBL PIC S9(0004) COMP.
  3273     05  RUNTIMBF PIC  X(0001).
  3274     05  FILLER REDEFINES RUNTIMBF.
  3275         10  RUNTIMBA PIC  X(0001).
  3276     05  RUNTIMBI PIC  X(0005).
  3277*    -------------------------------
  3278     05  PAYDTBL PIC S9(0004) COMP.
  3279     05  PAYDTBF PIC  X(0001).
  3280     05  FILLER REDEFINES PAYDTBF.
  3281         10  PAYDTBA PIC  X(0001).
  3282     05  PAYDTBI PIC  X(0008).
  3283*    -------------------------------
  3284     05  PAYTYPBL PIC S9(0004) COMP.
  3285     05  PAYTYPBF PIC  X(0001).
  3286     05  FILLER REDEFINES PAYTYPBF.
  3287         10  PAYTYPBA PIC  X(0001).
  3288     05  PAYTYPBI PIC  X(0015).
  3289*    -------------------------------
  3290     05  PAYAMTBL PIC S9(0004) COMP.
  3291     05  PAYAMTBF PIC  X(0001).
  3292     05  FILLER REDEFINES PAYAMTBF.
  3293         10  PAYAMTBA PIC  X(0001).
  3294     05  PAYAMTBI PIC  X(0011).
  3295*    -------------------------------
  3296     05  LOANHBL PIC S9(0004) COMP.
  3297     05  LOANHBF PIC  X(0001).
  3298     05  FILLER REDEFINES LOANHBF.
  3299         10  LOANHBA PIC  X(0001).
  3300     05  LOANHBI PIC  X(0012).
  3301*    -------------------------------
  3302     05  LOANNBL PIC S9(0004) COMP.
  3303     05  LOANNBF PIC  X(0001).
  3304     05  FILLER REDEFINES LOANNBF.
  3305         10  LOANNBA PIC  X(0001).
  3306     05  LOANNBI PIC  X(0025).
  3307*    -------------------------------
  3308     05  CKNUMHDL PIC S9(0004) COMP.
  3309     05  CKNUMHDF PIC  X(0001).
  3310     05  FILLER REDEFINES CKNUMHDF.
  3311         10  CKNUMHDA PIC  X(0001).
  3312     05  CKNUMHDI PIC  X(0012).
  3313*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  67
* EL156.cbl
  3314     05  CKNUMBL PIC S9(0004) COMP.
  3315     05  CKNUMBF PIC  X(0001).
  3316     05  FILLER REDEFINES CKNUMBF.
  3317         10  CKNUMBA PIC  X(0001).
  3318     05  CKNUMBI PIC  X(0007).
  3319*    -------------------------------
  3320     05  AGTHDGL PIC S9(0004) COMP.
  3321     05  AGTHDGF PIC  X(0001).
  3322     05  FILLER REDEFINES AGTHDGF.
  3323         10  AGTHDGA PIC  X(0001).
  3324     05  AGTHDGI PIC  X(0016).
  3325*    -------------------------------
  3326     05  NAMEBL PIC S9(0004) COMP.
  3327     05  NAMEBF PIC  X(0001).
  3328     05  FILLER REDEFINES NAMEBF.
  3329         10  NAMEBA PIC  X(0001).
  3330     05  NAMEBI PIC  X(0030).
  3331*    -------------------------------
  3332     05  NAMEB2L PIC S9(0004) COMP.
  3333     05  NAMEB2F PIC  X(0001).
  3334     05  FILLER REDEFINES NAMEB2F.
  3335         10  NAMEB2A PIC  X(0001).
  3336     05  NAMEB2I PIC  X(0030).
  3337*    -------------------------------
  3338     05  ADDR1BL PIC S9(0004) COMP.
  3339     05  ADDR1BF PIC  X(0001).
  3340     05  FILLER REDEFINES ADDR1BF.
  3341         10  ADDR1BA PIC  X(0001).
  3342     05  ADDR1BI PIC  X(0030).
  3343*    -------------------------------
  3344     05  ADDR1B2L PIC S9(0004) COMP.
  3345     05  ADDR1B2F PIC  X(0001).
  3346     05  FILLER REDEFINES ADDR1B2F.
  3347         10  ADDR1B2A PIC  X(0001).
  3348     05  ADDR1B2I PIC  X(0030).
  3349*    -------------------------------
  3350     05  ADDR2BL PIC S9(0004) COMP.
  3351     05  ADDR2BF PIC  X(0001).
  3352     05  FILLER REDEFINES ADDR2BF.
  3353         10  ADDR2BA PIC  X(0001).
  3354     05  ADDR2BI PIC  X(0030).
  3355*    -------------------------------
  3356     05  ADDR2B2L PIC S9(0004) COMP.
  3357     05  ADDR2B2F PIC  X(0001).
  3358     05  FILLER REDEFINES ADDR2B2F.
  3359         10  ADDR2B2A PIC  X(0001).
  3360     05  ADDR2B2I PIC  X(0030).
  3361*    -------------------------------
  3362     05  CITYSTBL PIC S9(0004) COMP.
  3363     05  CITYSTBF PIC  X(0001).
  3364     05  FILLER REDEFINES CITYSTBF.
  3365         10  CITYSTBA PIC  X(0001).
  3366     05  CITYSTBI PIC  X(0030).
  3367*    -------------------------------
  3368     05  CITYST2L PIC S9(0004) COMP.
  3369     05  CITYST2F PIC  X(0001).
  3370     05  FILLER REDEFINES CITYST2F.
  3371         10  CITYST2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  68
* EL156.cbl
  3372     05  CITYST2I PIC  X(0030).
  3373*    -------------------------------
  3374     05  ZIPBL PIC S9(0004) COMP.
  3375     05  ZIPBF PIC  X(0001).
  3376     05  FILLER REDEFINES ZIPBF.
  3377         10  ZIPBA PIC  X(0001).
  3378     05  ZIPBI PIC  X(0009).
  3379*    -------------------------------
  3380     05  ZIPB2L PIC S9(0004) COMP.
  3381     05  ZIPB2F PIC  X(0001).
  3382     05  FILLER REDEFINES ZIPB2F.
  3383         10  ZIPB2A PIC  X(0001).
  3384     05  ZIPB2I PIC  X(0009).
  3385*    -------------------------------
  3386     05  INTHDBL PIC S9(0004) COMP.
  3387     05  INTHDBF PIC  X(0001).
  3388     05  FILLER REDEFINES INTHDBF.
  3389         10  INTHDBA PIC  X(0001).
  3390     05  INTHDBI PIC  X(0012).
  3391*    -------------------------------
  3392     05  INTAMTBL PIC S9(0004) COMP.
  3393     05  INTAMTBF PIC  X(0001).
  3394     05  FILLER REDEFINES INTAMTBF.
  3395         10  INTAMTBA PIC  X(0001).
  3396     05  INTAMTBI PIC  X(0011).
  3397*    -------------------------------
  3398     05  PMTHDGBL PIC S9(0004) COMP.
  3399     05  PMTHDGBF PIC  X(0001).
  3400     05  FILLER REDEFINES PMTHDGBF.
  3401         10  PMTHDGBA PIC  X(0001).
  3402     05  PMTHDGBI PIC  X(0034).
  3403*    -------------------------------
  3404     05  CLMNOBL PIC S9(0004) COMP.
  3405     05  CLMNOBF PIC  X(0001).
  3406     05  FILLER REDEFINES CLMNOBF.
  3407         10  CLMNOBA PIC  X(0001).
  3408     05  CLMNOBI PIC  X(0007).
  3409*    -------------------------------
  3410     05  CARRBL PIC S9(0004) COMP.
  3411     05  CARRBF PIC  X(0001).
  3412     05  FILLER REDEFINES CARRBF.
  3413         10  CARRBA PIC  X(0001).
  3414     05  CARRBI PIC  X(0001).
  3415*    -------------------------------
  3416     05  CERTNOBL PIC S9(0004) COMP.
  3417     05  CERTNOBF PIC  X(0001).
  3418     05  FILLER REDEFINES CERTNOBF.
  3419         10  CERTNOBA PIC  X(0001).
  3420     05  CERTNOBI PIC  X(0010).
  3421*    -------------------------------
  3422     05  SUFXBL PIC S9(0004) COMP.
  3423     05  SUFXBF PIC  X(0001).
  3424     05  FILLER REDEFINES SUFXBF.
  3425         10  SUFXBA PIC  X(0001).
  3426     05  SUFXBI PIC  X(0001).
  3427*    -------------------------------
  3428     05  CLMTYPBL PIC S9(0004) COMP.
  3429     05  CLMTYPBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  69
* EL156.cbl
  3430     05  FILLER REDEFINES CLMTYPBF.
  3431         10  CLMTYPBA PIC  X(0001).
  3432     05  CLMTYPBI PIC  X(0006).
  3433*    -------------------------------
  3434     05  INCURBL PIC S9(0004) COMP.
  3435     05  INCURBF PIC  X(0001).
  3436     05  FILLER REDEFINES INCURBF.
  3437         10  INCURBA PIC  X(0001).
  3438     05  INCURBI PIC  X(0008).
  3439*    -------------------------------
  3440     05  PYFROMBL PIC S9(0004) COMP.
  3441     05  PYFROMBF PIC  X(0001).
  3442     05  FILLER REDEFINES PYFROMBF.
  3443         10  PYFROMBA PIC  X(0001).
  3444     05  PYFROMBI PIC  X(0008).
  3445*    -------------------------------
  3446     05  PYTHRUBL PIC S9(0004) COMP.
  3447     05  PYTHRUBF PIC  X(0001).
  3448     05  FILLER REDEFINES PYTHRUBF.
  3449         10  PYTHRUBA PIC  X(0001).
  3450     05  PYTHRUBI PIC  X(0008).
  3451*    -------------------------------
  3452     05  DAYSBL PIC S9(0004) COMP.
  3453     05  DAYSBF PIC  X(0001).
  3454     05  FILLER REDEFINES DAYSBF.
  3455         10  DAYSBA PIC  X(0001).
  3456     05  DAYSBI PIC  X(0005).
  3457*    -------------------------------
  3458     05  BYBL PIC S9(0004) COMP.
  3459     05  BYBF PIC  X(0001).
  3460     05  FILLER REDEFINES BYBF.
  3461         10  BYBA PIC  X(0001).
  3462     05  BYBI PIC  X(0004).
  3463*    -------------------------------
  3464     05  PROOFDBL PIC S9(0004) COMP.
  3465     05  PROOFDBF PIC  X(0001).
  3466     05  FILLER REDEFINES PROOFDBF.
  3467         10  PROOFDBA PIC  X(0001).
  3468     05  PROOFDBI PIC  X(0008).
  3469*    -------------------------------
  3470     05  ACCTBL PIC S9(0004) COMP.
  3471     05  ACCTBF PIC  X(0001).
  3472     05  FILLER REDEFINES ACCTBF.
  3473         10  ACCTBA PIC  X(0001).
  3474     05  ACCTBI PIC  X(0010).
  3475*    -------------------------------
  3476     05  STATEBL PIC S9(0004) COMP.
  3477     05  STATEBF PIC  X(0001).
  3478     05  FILLER REDEFINES STATEBF.
  3479         10  STATEBA PIC  X(0001).
  3480     05  STATEBI PIC  X(0002).
  3481*    -------------------------------
  3482     05  GROUPBL PIC S9(0004) COMP.
  3483     05  GROUPBF PIC  X(0001).
  3484     05  FILLER REDEFINES GROUPBF.
  3485         10  GROUPBA PIC  X(0001).
  3486     05  GROUPBI PIC  X(0006).
  3487*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  70
* EL156.cbl
  3488     05  ACARRBL PIC S9(0004) COMP.
  3489     05  ACARRBF PIC  X(0001).
  3490     05  FILLER REDEFINES ACARRBF.
  3491         10  ACARRBA PIC  X(0001).
  3492     05  ACARRBI PIC  X(0001).
  3493*    -------------------------------
  3494     05  ACCTNMBL PIC S9(0004) COMP.
  3495     05  ACCTNMBF PIC  X(0001).
  3496     05  FILLER REDEFINES ACCTNMBF.
  3497         10  ACCTNMBA PIC  X(0001).
  3498     05  ACCTNMBI PIC  X(0030).
  3499*    -------------------------------
  3500     05  UNDISBL PIC S9(0004) COMP.
  3501     05  UNDISBF PIC  X(0001).
  3502     05  FILLER REDEFINES UNDISBF.
  3503         10  UNDISBA PIC  X(0001).
  3504     05  UNDISBI PIC  X(0010).
  3505*    -------------------------------
  3506     05  RATEBL PIC S9(0004) COMP.
  3507     05  RATEBF PIC  X(0001).
  3508     05  FILLER REDEFINES RATEBF.
  3509         10  RATEBA PIC  X(0001).
  3510     05  RATEBI PIC  X(0006).
  3511*    -------------------------------
  3512     05  ERMSG1BL PIC S9(0004) COMP.
  3513     05  ERMSG1BF PIC  X(0001).
  3514     05  FILLER REDEFINES ERMSG1BF.
  3515         10  ERMSG1BA PIC  X(0001).
  3516     05  ERMSG1BI PIC  X(0072).
  3517*    -------------------------------
  3518     05  ENTPFBL PIC S9(0004) COMP.
  3519     05  ENTPFBF PIC  X(0001).
  3520     05  FILLER REDEFINES ENTPFBF.
  3521         10  ENTPFBA PIC  X(0001).
  3522     05  ENTPFBI PIC  99.
  3523 01  EL156BO REDEFINES EL156AI.
  3524     05  FILLER            PIC  X(0012).
  3525*    -------------------------------
  3526     05  FILLER            PIC  X(0003).
  3527     05  RUNDTEBO PIC  X(0008).
  3528*    -------------------------------
  3529     05  FILLER            PIC  X(0003).
  3530     05  RUNTIMBO PIC  99.99.
  3531*    -------------------------------
  3532     05  FILLER            PIC  X(0003).
  3533     05  PAYDTBO PIC  99B99B99.
  3534*    -------------------------------
  3535     05  FILLER            PIC  X(0003).
  3536     05  PAYTYPBO PIC  X(0015).
  3537*    -------------------------------
  3538     05  FILLER            PIC  X(0003).
  3539     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3540*    -------------------------------
  3541     05  FILLER            PIC  X(0003).
  3542     05  LOANHBO PIC  X(0012).
  3543*    -------------------------------
  3544     05  FILLER            PIC  X(0003).
  3545     05  LOANNBO PIC  X(0025).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  71
* EL156.cbl
  3546*    -------------------------------
  3547     05  FILLER            PIC  X(0003).
  3548     05  CKNUMHDO PIC  X(0012).
  3549*    -------------------------------
  3550     05  FILLER            PIC  X(0003).
  3551     05  CKNUMBO PIC  X(0007).
  3552*    -------------------------------
  3553     05  FILLER            PIC  X(0003).
  3554     05  AGTHDGO PIC  X(0016).
  3555*    -------------------------------
  3556     05  FILLER            PIC  X(0003).
  3557     05  NAMEBO PIC  X(0030).
  3558*    -------------------------------
  3559     05  FILLER            PIC  X(0003).
  3560     05  NAMEB2O PIC  X(0030).
  3561*    -------------------------------
  3562     05  FILLER            PIC  X(0003).
  3563     05  ADDR1BO PIC  X(0030).
  3564*    -------------------------------
  3565     05  FILLER            PIC  X(0003).
  3566     05  ADDR1B2O PIC  X(0030).
  3567*    -------------------------------
  3568     05  FILLER            PIC  X(0003).
  3569     05  ADDR2BO PIC  X(0030).
  3570*    -------------------------------
  3571     05  FILLER            PIC  X(0003).
  3572     05  ADDR2B2O PIC  X(0030).
  3573*    -------------------------------
  3574     05  FILLER            PIC  X(0003).
  3575     05  CITYSTBO PIC  X(0030).
  3576*    -------------------------------
  3577     05  FILLER            PIC  X(0003).
  3578     05  CITYST2O PIC  X(0030).
  3579*    -------------------------------
  3580     05  FILLER            PIC  X(0003).
  3581     05  ZIPBO PIC  ZZZZ99999.
  3582*    -------------------------------
  3583     05  FILLER            PIC  X(0003).
  3584     05  ZIPB2O PIC  ZZZZZZZZZ.
  3585*    -------------------------------
  3586     05  FILLER            PIC  X(0003).
  3587     05  INTHDBO PIC  X(0012).
  3588*    -------------------------------
  3589     05  FILLER            PIC  X(0003).
  3590     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3591*    -------------------------------
  3592     05  FILLER            PIC  X(0003).
  3593     05  PMTHDGBO PIC  X(0034).
  3594*    -------------------------------
  3595     05  FILLER            PIC  X(0003).
  3596     05  CLMNOBO PIC  X(0007).
  3597*    -------------------------------
  3598     05  FILLER            PIC  X(0003).
  3599     05  CARRBO PIC  X(0001).
  3600*    -------------------------------
  3601     05  FILLER            PIC  X(0003).
  3602     05  CERTNOBO PIC  X(0010).
  3603*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  72
* EL156.cbl
  3604     05  FILLER            PIC  X(0003).
  3605     05  SUFXBO PIC  X(0001).
  3606*    -------------------------------
  3607     05  FILLER            PIC  X(0003).
  3608     05  CLMTYPBO PIC  X(0006).
  3609*    -------------------------------
  3610     05  FILLER            PIC  X(0003).
  3611     05  INCURBO PIC  X(0008).
  3612*    -------------------------------
  3613     05  FILLER            PIC  X(0003).
  3614     05  PYFROMBO PIC  99B99B99.
  3615*    -------------------------------
  3616     05  FILLER            PIC  X(0003).
  3617     05  PYTHRUBO PIC  99B99B99.
  3618*    -------------------------------
  3619     05  FILLER            PIC  X(0003).
  3620     05  DAYSBO PIC  X(0005).
  3621*    -------------------------------
  3622     05  FILLER            PIC  X(0003).
  3623     05  BYBO PIC  X(0004).
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  PROOFDBO PIC  99B99B99.
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  ACCTBO PIC  X(0010).
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  STATEBO PIC  X(0002).
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  GROUPBO PIC  X(0006).
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  ACARRBO PIC  X(0001).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  ACCTNMBO PIC  X(0030).
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  UNDISBO PIC  ZZZ,Z99.99.
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  RATEBO PIC  ZZZ.99.
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  ERMSG1BO PIC  X(0072).
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  ENTPFBO PIC  X(0002).
  3654*    -------------------------------
  3655****************************************************************
  3656*
  3657* Copyright (c) 2007 by Clerity Solutions, Inc.
  3658* All rights reserved.
  3659*
  3660****************************************************************
  3661 01  DFHEIV.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  73
* EL156.cbl
  3662   02  DFHEIV0               PIC X(35).
  3663   02  DFHEIV1               PIC X(08).
  3664   02  DFHEIV2               PIC X(08).
  3665   02  DFHEIV3               PIC X(08).
  3666   02  DFHEIV4               PIC X(06).
  3667   02  DFHEIV5               PIC X(04).
  3668   02  DFHEIV6               PIC X(04).
  3669   02  DFHEIV7               PIC X(02).
  3670   02  DFHEIV8               PIC X(02).
  3671   02  DFHEIV9               PIC X(01).
  3672   02  DFHEIV10              PIC S9(7) COMP-3.
  3673   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3674   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3675   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3676   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3677   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3678   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3679   02  DFHEIV17              PIC X(04).
  3680   02  DFHEIV18              PIC X(04).
  3681   02  DFHEIV19              PIC X(04).
  3682   02  DFHEIV20              USAGE IS POINTER.
  3683   02  DFHEIV21              USAGE IS POINTER.
  3684   02  DFHEIV22              USAGE IS POINTER.
  3685   02  DFHEIV23              USAGE IS POINTER.
  3686   02  DFHEIV24              USAGE IS POINTER.
  3687   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3688   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3689   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3690   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3691   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3692   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3693   02  FILLER                PIC X(02).
  3694   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3695   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3696   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3697   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3698   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3699 LINKAGE  SECTION.
  3700*****************************************************************
  3701*                                                               *
  3702* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3703* All rights reserved.                                          *
  3704*                                                               *
  3705*****************************************************************
  3706 01  dfheiblk.
  3707     02  eibtime          pic s9(7) comp-3.
  3708     02  eibdate          pic s9(7) comp-3.
  3709     02  eibtrnid         pic x(4).
  3710     02  eibtaskn         pic s9(7) comp-3.
  3711     02  eibtrmid         pic x(4).
  3712     02  dfheigdi         pic s9(4) comp.
  3713     02  eibcposn         pic s9(4) comp.
  3714     02  eibcalen         pic s9(4) comp.
  3715     02  eibaid           pic x(1).
  3716     02  eibfiller1       pic x(1).
  3717     02  eibfn            pic x(2).
  3718     02  eibfiller2       pic x(2).
  3719     02  eibrcode         pic x(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  74
* EL156.cbl
  3720     02  eibfiller3       pic x(2).
  3721     02  eibds            pic x(8).
  3722     02  eibreqid         pic x(8).
  3723     02  eibrsrce         pic x(8).
  3724     02  eibsync          pic x(1).
  3725     02  eibfree          pic x(1).
  3726     02  eibrecv          pic x(1).
  3727     02  eibsend          pic x(1).
  3728     02  eibatt           pic x(1).
  3729     02  eibeoc           pic x(1).
  3730     02  eibfmh           pic x(1).
  3731     02  eibcompl         pic x(1).
  3732     02  eibsig           pic x(1).
  3733     02  eibconf          pic x(1).
  3734     02  eiberr           pic x(1).
  3735     02  eibrldbk         pic x(1).
  3736     02  eiberrcd         pic x(4).
  3737     02  eibsynrb         pic x(1).
  3738     02  eibnodat         pic x(1).
  3739     02  eibfiller5       pic x(2).
  3740     02  eibresp          pic 9(09) comp.
  3741     02  eibresp2         pic 9(09) comp.
  3742     02  dfheigdj         pic s9(4) comp.
  3743     02  dfheigdk         pic s9(4) comp.
  3744 01  DFHCOMMAREA             PIC X(1024).
  3745
  3746*    COPY ELCMSTR.
  3747******************************************************************
  3748*                                                                *
  3749*                            ELCMSTR.                            *
  3750*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3751*                            VMOD=2.012                          *
  3752*                                                                *
  3753*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3754*                                                                *
  3755*   FILE TYPE = VSAM,KSDS                                        *
  3756*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3757*                                                                *
  3758*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3759*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3760*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3761*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3762*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3763*                                                 RKP=75,LEN=21  *
  3764*                                                                *
  3765*   **** NOTE ****                                               *
  3766*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3767*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3768*                                                                *
  3769*   LOG = YES                                                    *
  3770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3771******************************************************************
  3772*                   C H A N G E   L O G
  3773*
  3774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3775*-----------------------------------------------------------------
  3776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3777* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  75
* EL156.cbl
  3778*-----------------------------------------------------------------
  3779* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3780* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3781* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3782******************************************************************
  3783 01  CLAIM-MASTER.
  3784     12  CL-RECORD-ID                PIC XX.
  3785         88  VALID-CL-ID         VALUE 'CL'.
  3786
  3787     12  CL-CONTROL-PRIMARY.
  3788         16  CL-COMPANY-CD           PIC X.
  3789         16  CL-CARRIER              PIC X.
  3790         16  CL-CLAIM-NO             PIC X(7).
  3791         16  CL-CERT-NO.
  3792             20  CL-CERT-PRIME       PIC X(10).
  3793             20  CL-CERT-SFX         PIC X.
  3794
  3795     12  CL-CONTROL-BY-NAME.
  3796         16  CL-COMPANY-CD-A1        PIC X.
  3797         16  CL-INSURED-LAST-NAME    PIC X(15).
  3798         16  CL-INSURED-NAME.
  3799             20  CL-INSURED-1ST-NAME PIC X(12).
  3800             20  CL-INSURED-MID-INIT PIC X.
  3801
  3802     12  CL-CONTROL-BY-SSN.
  3803         16  CL-COMPANY-CD-A2        PIC X.
  3804         16  CL-SOC-SEC-NO.
  3805             20  CL-SSN-STATE        PIC XX.
  3806             20  CL-SSN-ACCOUNT      PIC X(6).
  3807             20  CL-SSN-LN3          PIC X(3).
  3808
  3809     12  CL-CONTROL-BY-CERT-NO.
  3810         16  CL-COMPANY-CD-A4        PIC X.
  3811         16  CL-CERT-NO-A4.
  3812             20  CL-CERT-A4-PRIME    PIC X(10).
  3813             20  CL-CERT-A4-SFX      PIC X.
  3814
  3815     12  CL-CONTROL-BY-CCN.
  3816         16  CL-COMPANY-CD-A5        PIC X.
  3817         16  CL-CCN-A5.
  3818             20  CL-CCN.
  3819                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3820                 24  CL-CCN-PRIME-A5 PIC X(12).
  3821             20  CL-CCN-FILLER-A5    PIC X(4).
  3822
  3823     12  CL-INSURED-PROFILE-DATA.
  3824         16  CL-INSURED-BIRTH-DT     PIC XX.
  3825         16  CL-INSURED-SEX-CD       PIC X.
  3826             88  INSURED-IS-MALE        VALUE 'M'.
  3827             88  INSURED-IS-FEMALE      VALUE 'F'.
  3828             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3829         16  CL-INSURED-OCC-CD       PIC X(6).
  3830         16  FILLER                  PIC X(5).
  3831
  3832     12  CL-PROCESSING-INFO.
  3833         16  CL-PROCESSOR-ID         PIC X(4).
  3834         16  CL-CLAIM-STATUS         PIC X.
  3835             88  CLAIM-IS-OPEN          VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  76
* EL156.cbl
  3836             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3837         16  CL-CLAIM-TYPE           PIC X.
  3838*            88  AH-CLAIM               VALUE 'A'.
  3839*            88  LIFE-CLAIM             VALUE 'L'.
  3840*            88  PROPERTY-CLAIM         VALUE 'P'.
  3841*            88  IUI-CLAIM              VALUE 'I'.
  3842*            88  GAP-CLAIM              VALUE 'G'.
  3843         16  CL-CLAIM-PREM-TYPE      PIC X.
  3844             88  SINGLE-PREMIUM         VALUE '1'.
  3845             88  O-B-COVERAGE           VALUE '2'.
  3846             88  OPEN-END-COVERAGE      VALUE '3'.
  3847         16  CL-INCURRED-DT          PIC XX.
  3848         16  CL-REPORTED-DT          PIC XX.
  3849         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3850         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3851         16  CL-LAST-PMT-DT          PIC XX.
  3852         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3853         16  CL-PAID-THRU-DT         PIC XX.
  3854         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3855         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3856         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3857         16  CL-PMT-CALC-METHOD      PIC X.
  3858             88  CL-360-DAY-YR          VALUE '1'.
  3859             88  CL-365-DAY-YR          VALUE '2'.
  3860             88  CL-FULL-MONTHS         VALUE '3'.
  3861         16  CL-CAUSE-CD             PIC X(6).
  3862
  3863         16  CL-PRIME-CERT-NO.
  3864             20  CL-PRIME-CERT-PRIME PIC X(10).
  3865             20  CL-PRIME-CERT-SFX   PIC X.
  3866
  3867         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3868             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3869             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3870
  3871         16  CL-MICROFILM-NO         PIC X(10).
  3872         16  CL-PROG-FORM-TYPE       PIC X.
  3873         16  CL-LAST-ADD-ON-DT       PIC XX.
  3874
  3875         16  CL-LAST-REOPEN-DT       PIC XX.
  3876         16  CL-LAST-CLOSE-DT        PIC XX.
  3877         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3878             88  FINAL-PAID             VALUE '1'.
  3879             88  CLAIM-DENIED           VALUE '2'.
  3880             88  AUTO-CLOSE             VALUE '3'.
  3881             88  MANUAL-CLOSE           VALUE '4'.
  3882             88  BENEFITS-CHANGED       VALUE 'C'.
  3883             88  SETUP-ERRORS           VALUE 'E'.
  3884         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3885         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3886         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3887             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3888         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3889         16  FILLER                  PIC X.
  3890
  3891     12  CL-CERTIFICATE-DATA.
  3892         16  CL-CERT-ORIGIN          PIC X.
  3893             88  CERT-WAS-ONLINE        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  77
* EL156.cbl
  3894             88  CERT-WAS-CREATED       VALUE '2'.
  3895             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3896         16  CL-CERT-KEY-DATA.
  3897             20  CL-CERT-CARRIER     PIC X.
  3898             20  CL-CERT-GROUPING    PIC X(6).
  3899             20  CL-CERT-STATE       PIC XX.
  3900             20  CL-CERT-ACCOUNT.
  3901                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3902                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3903             20  CL-CERT-EFF-DT      PIC XX.
  3904
  3905     12  CL-STATUS-CONTROLS.
  3906         16  CL-PRIORITY-CD          PIC X.
  3907             88  CONFIDENTIAL-DATA      VALUE '8'.
  3908             88  HIGHEST-PRIORITY       VALUE '9'.
  3909         16  CL-SUPV-ATTN-CD         PIC X.
  3910             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3911             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3912         16  CL-PURGED-DT            PIC XX.
  3913         16  CL-RESTORED-DT          PIC XX.
  3914         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3915         16  CL-NEXT-RESEND-DT       PIC XX.
  3916         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3917         16  CL-CRITICAL-PERIOD      PIC 99.
  3918*        16  FILLER                  PIC XX.
  3919         16  CL-LAST-MAINT-DT        PIC XX.
  3920         16  CL-LAST-MAINT-USER      PIC X(4).
  3921         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3922         16  CL-LAST-MAINT-TYPE      PIC X.
  3923             88  CLAIM-SET-UP           VALUE ' '.
  3924             88  PAYMENT-MADE           VALUE '1'.
  3925             88  LETTER-SENT            VALUE '2'.
  3926             88  MASTER-WAS-ALTERED     VALUE '3'.
  3927             88  MASTER-WAS-RESTORED    VALUE '4'.
  3928             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3929             88  FILE-CONVERTED         VALUE '6'.
  3930             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3931             88  ERROR-CORRECTION       VALUE 'E'.
  3932         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3933         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3934         16  CL-BENEFICIARY          PIC X(10).
  3935         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3936         16  CL-DENIAL-TYPE          PIC X.
  3937             88  CL-TYPE-DENIAL          VALUE '1'.
  3938             88  CL-TYPE-RESCISSION      VALUE '2'.
  3939             88  CL-TYPE-REFORMATION     VALUE '3'.
  3940             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3941             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3942         16  CL-CRIT-PER-RECURRENT   PIC X.
  3943         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3944         16  CL-RTW-DT               PIC XX.
  3945
  3946     12  CL-TRAILER-CONTROLS.
  3947         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3948             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3949             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3950             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3951         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  78
* EL156.cbl
  3952         16  FILLER                  PIC XX.
  3953         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3954         16  CL-ADDRESS-TRAILER-CNT.
  3955             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3956                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3957             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3958                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3959             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3960                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3961             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3962                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3963             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3964                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3965             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3966                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3967             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3968                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3969
  3970     12  CL-CV-REFERENCE-NO.
  3971         16  CL-CV-REFNO-PRIME       PIC X(18).
  3972         16  CL-CV-REFNO-SFX         PIC XX.
  3973
  3974     12  CL-FILE-LOCATION            PIC X(4).
  3975
  3976     12  CL-PROCESS-ERRORS.
  3977         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3978             88  NO-FATAL-ERRORS        VALUE ZERO.
  3979         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3980             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3981
  3982     12  CL-PRODUCT-CD               PIC X.
  3983
  3984     12  CL-CURRENT-KEY-DATA.
  3985         16  CL-CURRENT-CARRIER      PIC X.
  3986         16  CL-CURRENT-GROUPING     PIC X(6).
  3987         16  CL-CURRENT-STATE        PIC XX.
  3988         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3989
  3990     12  CL-ASSOCIATES               PIC X.
  3991         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3992         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3993         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3994         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3995
  3996     12  CL-ACTIVITY-CODE            PIC 99.
  3997     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3998     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3999
  4000     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4001     12  CL-LAG-REPORT-CODE          PIC 9.
  4002     12  CL-LOAN-TYPE                PIC XX.
  4003     12  CL-LEGAL-STATE              PIC XX.
  4004
  4005     12  CL-YESNOSW                  PIC X.
  4006     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4007         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4008         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4009         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  79
* EL156.cbl
  4010     12  cl-insured-claim            pic x.
  4011         88  cl-claim-on-primary         value 'P'.
  4012         88  cl-claim-on-secondary       value 'S'.
  4013     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  80
* EL156.cbl
  4015*    COPY ELCCNTL.
  4016******************************************************************
  4017*                                                                *
  4018*                                                                *
  4019*                            ELCCNTL.                            *
  4020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4021*                            VMOD=2.059                          *
  4022*                                                                *
  4023*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4024*                                                                *
  4025*   FILE TYPE = VSAM,KSDS                                        *
  4026*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4027*                                                                *
  4028*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4029*       ALTERNATE INDEX = NONE                                   *
  4030*                                                                *
  4031*   LOG = YES                                                    *
  4032*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4033******************************************************************
  4034*                   C H A N G E   L O G
  4035*
  4036* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4037*-----------------------------------------------------------------
  4038*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4039* EFFECTIVE    NUMBER
  4040*-----------------------------------------------------------------
  4041* 082503                   PEMA  ADD BENEFIT GROUP
  4042* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4043* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4044* 092705    2005050300006  PEMA  ADD SPP LEASES
  4045* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4046* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4047* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4048* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4049* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4050* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4051* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4052* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4053******************************************************************
  4054*
  4055 01  CONTROL-FILE.
  4056     12  CF-RECORD-ID                       PIC XX.
  4057         88  VALID-CF-ID                        VALUE 'CF'.
  4058
  4059     12  CF-CONTROL-PRIMARY.
  4060         16  CF-COMPANY-ID                  PIC XXX.
  4061         16  CF-RECORD-TYPE                 PIC X.
  4062             88  CF-COMPANY-MASTER              VALUE '1'.
  4063             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4064             88  CF-STATE-MASTER                VALUE '3'.
  4065             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4066             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4067             88  CF-CARRIER-MASTER              VALUE '6'.
  4068             88  CF-MORTALITY-MASTER            VALUE '7'.
  4069             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4070             88  CF-TERMINAL-MASTER             VALUE '9'.
  4071             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4072             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  81
* EL156.cbl
  4073             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4074             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4075             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4076             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4077             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4078             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4079             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4080         16  CF-ACCESS-CD-GENL              PIC X(4).
  4081         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4082             20  CF-PROCESSOR               PIC X(4).
  4083         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4084             20  CF-STATE-CODE              PIC XX.
  4085             20  FILLER                     PIC XX.
  4086         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4087             20  FILLER                     PIC XX.
  4088             20  CF-HI-BEN-IN-REC           PIC XX.
  4089         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4090             20  FILLER                     PIC XXX.
  4091             20  CF-CARRIER-CNTL            PIC X.
  4092         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4093             20  FILLER                     PIC XX.
  4094             20  CF-HI-TYPE-IN-REC          PIC 99.
  4095         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4096             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4097                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4098             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4099             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4100         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4101             20  FILLER                     PIC X.
  4102             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4103         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4104             20  FILLER                     PIC XX.
  4105             20  CF-MORTGAGE-PLAN           PIC XX.
  4106         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4107
  4108     12  CF-LAST-MAINT-DT                   PIC XX.
  4109     12  CF-LAST-MAINT-BY                   PIC X(4).
  4110     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4111
  4112     12  CF-RECORD-BODY                     PIC X(728).
  4113
  4114
  4115****************************************************************
  4116*             COMPANY MASTER RECORD                            *
  4117****************************************************************
  4118
  4119     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4120         16  CF-COMPANY-ADDRESS.
  4121             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4122             20  CF-CL-IN-CARE-OF           PIC X(30).
  4123             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4124             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4125             20  CF-CL-CITY-STATE           PIC X(30).
  4126             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4127             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4128         16  CF-COMPANY-CD                  PIC X.
  4129         16  CF-COMPANY-PASSWORD            PIC X(8).
  4130         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  82
* EL156.cbl
  4131             88  ALL-SECURITY                   VALUE '1'.
  4132             88  COMPANY-VERIFY                 VALUE '2'.
  4133             88  PROCESSOR-VERIFY               VALUE '3'.
  4134             88  NO-SECURITY                    VALUE '4'.
  4135             88  ALL-BUT-TERM                   VALUE '5'.
  4136         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4137             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4138         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4139             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4140         16  CF-INFORCE-LOCATION            PIC X.
  4141             88  CERTS-ARE-ONLINE               VALUE '1'.
  4142             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4143             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4144         16  CF-LOWER-CASE-LETTERS          PIC X.
  4145         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4146             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4147             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4148             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4149             88  CF-ACCNT-CNTL                  VALUE '3'.
  4150             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4151
  4152         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4153         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4154
  4155         16  CF-LGX-CREDIT-USER             PIC X.
  4156             88  CO-IS-NOT-USER                 VALUE 'N'.
  4157             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4158
  4159         16 CF-CREDIT-CALC-CODES.
  4160             20  CF-CR-REM-TERM-CALC PIC X.
  4161               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4162               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4163               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4164               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4165               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4166               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4167               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4168             20  CF-CR-R78-METHOD           PIC X.
  4169               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4170               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4171
  4172         16  CF-CLAIM-CONTROL-COUNTS.
  4173             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4174                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4175
  4176             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4177                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4178
  4179             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4180                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4181
  4182             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4183                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4184
  4185         16  CF-CURRENT-MONTH-END           PIC XX.
  4186
  4187         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4188             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  83
* EL156.cbl
  4189             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4190             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4191             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4192                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4193                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4194             20  CF-CO-PREM-REJECT-SW       PIC X.
  4195                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4196                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4197             20  CF-CO-REF-REJECT-SW        PIC X.
  4198                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4199                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4200
  4201         16  CF-CO-REPORTING-DT             PIC XX.
  4202         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4203         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4204           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4205           88  CF-CO-MONTH-END                  VALUE '1'.
  4206
  4207         16  CF-LGX-CLAIM-USER              PIC X.
  4208             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4209             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4210
  4211         16  CF-CREDIT-EDIT-CONTROLS.
  4212             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4213             20  CF-MIN-AGE                 PIC 99.
  4214             20  CF-DEFAULT-AGE             PIC 99.
  4215             20  CF-MIN-TERM                PIC S999      COMP-3.
  4216             20  CF-MAX-TERM                PIC S999      COMP-3.
  4217             20  CF-DEFAULT-SEX             PIC X.
  4218             20  CF-JOINT-AGE-INPUT         PIC X.
  4219                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4220             20  CF-BIRTH-DATE-INPUT        PIC X.
  4221                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4222             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4223                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4224                 88  CF-ZERO-CARRIER            VALUE '1'.
  4225                 88  CF-ZERO-GROUPING           VALUE '2'.
  4226                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4227             20  CF-EDIT-SW                 PIC X.
  4228                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4229             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4230             20  CF-CR-PR-METHOD            PIC X.
  4231               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4232               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4233             20  FILLER                     PIC X.
  4234
  4235         16  CF-CREDIT-MISC-CONTROLS.
  4236             20  CF-REIN-TABLE-SW           PIC X.
  4237                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4238             20  CF-COMP-TABLE-SW           PIC X.
  4239                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4240             20  CF-EXPERIENCE-RETENTION-AGE
  4241                                            PIC S9        COMP-3.
  4242             20  CF-CONVERSION-DT           PIC XX.
  4243             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4244             20  CF-RUN-FREQUENCY-SW        PIC X.
  4245                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4246                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  84
* EL156.cbl
  4247
  4248             20  CF-CR-CHECK-NO-CONTROL.
  4249                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4250                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4251                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4252                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4253                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4254                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4255
  4256                 24  CF-CR-CHECK-COUNT       REDEFINES
  4257                     CF-CR-CHECK-COUNTER      PIC X(4).
  4258
  4259                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4260                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4261
  4262                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4263                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4264                 24  CF-MAIL-PROCESSING       PIC X.
  4265                     88  MAIL-PROCESSING          VALUE 'Y'.
  4266
  4267         16  CF-MISC-SYSTEM-CONTROL.
  4268             20  CF-SYSTEM-C                 PIC X.
  4269                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4270             20  CF-SYSTEM-D                 PIC X.
  4271                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4272             20  CF-SOC-SEC-NO-SW            PIC X.
  4273                 88  SOC-SEC-NO-USED             VALUE '1'.
  4274             20  CF-MEMBER-NO-SW             PIC X.
  4275                 88  MEMBER-NO-USED              VALUE '1'.
  4276             20  CF-TAX-ID-NUMBER            PIC X(11).
  4277             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4278             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4279                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4280                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4281                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4282                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4283             20  CF-SYSTEM-E                 PIC X.
  4284                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4285
  4286         16  CF-LGX-LIFE-USER               PIC X.
  4287             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4288             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4289
  4290         16  CF-CR-MONTH-END-DT             PIC XX.
  4291
  4292         16  CF-FILE-MAINT-DATES.
  4293             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4294                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4295             20  CF-LAST-BATCH       REDEFINES
  4296                 CF-LAST-BATCH-NO               PIC X(4).
  4297             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4298             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4299             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4300             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4301             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4302             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4303             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4304             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  85
* EL156.cbl
  4305             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4306             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4307
  4308         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4309         16  FILLER                         PIC X.
  4310
  4311         16  CF-ALT-MORT-CODE               PIC X(4).
  4312         16  CF-MEMBER-CAPTION              PIC X(10).
  4313
  4314         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4315             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4316             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4317             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4318             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4319             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4320
  4321         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4322
  4323         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4324         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4325         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4326         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4327
  4328         16  CF-AH-OVERRIDE-L1              PIC X.
  4329         16  CF-AH-OVERRIDE-L2              PIC XX.
  4330         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4331         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4332
  4333         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4334         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4335
  4336         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4337         16  CF-AR-LAST-EL860-DT            PIC XX.
  4338         16  CF-MP-MONTH-END-DT             PIC XX.
  4339
  4340         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4341         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4342             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4343
  4344         16  CF-AR-MONTH-END-DT             PIC XX.
  4345
  4346         16  CF-CRDTCRD-USER                PIC X.
  4347             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4348             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4349
  4350         16  CF-CC-MONTH-END-DT             PIC XX.
  4351
  4352         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4353
  4354         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4355             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4356             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4357             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4358         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4359         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4360         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4361         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4362             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  86
* EL156.cbl
  4363             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4364         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4365         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4366         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4367             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4368         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4369
  4370         16  CF-CL-ZIP-CODE.
  4371             20  CF-CL-ZIP-PRIME.
  4372                 24  CF-CL-ZIP-1ST          PIC X.
  4373                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4374                 24  FILLER                 PIC X(4).
  4375             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4376         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4377             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4378             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4379             20  FILLER                     PIC XXX.
  4380
  4381         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4382         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4383         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4384         16  CF-CO-OPTION-START-DATE        PIC XX.
  4385         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4386           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4387                                                      '3' '4'.
  4388           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4389           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4390           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4391           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4392           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4393           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4394
  4395         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4396
  4397         16  CF-PAYMENT-APPROVAL-LEVELS.
  4398             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4399             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4400             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4401             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4402             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4403             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4404
  4405         16  CF-END-USER-REPORTING-USER     PIC X.
  4406             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4407             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4408
  4409         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4410             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4411             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4412
  4413         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4414
  4415         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4416         16  FILLER                         PIC X.
  4417
  4418         16  CF-CREDIT-ARCHIVE-CNTL.
  4419             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4420             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  87
* EL156.cbl
  4421             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4422
  4423         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4424
  4425         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4426             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4427             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4428
  4429         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4430             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4431             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4432
  4433         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4434
  4435         16  CF-CO-ACH-ID-CODE              PIC  X.
  4436             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4437             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4438             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4439         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4440         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4441         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4442         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4443         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4444         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4445         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4446         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4447         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4448                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4449         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4450                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4451
  4452         16  CF-CO-OVER-SHORT.
  4453             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4454             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4455
  4456*         16  FILLER                         PIC X(102).
  4457         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4458             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4459             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4460
  4461         16  CF-AH-APPROVAL-DAYS.
  4462             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4463             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4464             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4465             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4466
  4467         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4468
  4469         16  FILLER                         PIC X(79).
  4470****************************************************************
  4471*             PROCESSOR/USER RECORD                            *
  4472****************************************************************
  4473
  4474     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4475         16  CF-PROCESSOR-NAME              PIC X(30).
  4476         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4477         16  CF-PROCESSOR-TITLE             PIC X(26).
  4478         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  88
* EL156.cbl
  4479                 88  MESSAGE-YES                VALUE 'Y'.
  4480                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4481
  4482*****************************************************
  4483****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4484****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4485****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4486****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4487*****************************************************
  4488
  4489         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4490             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4491             20  CF-APPLICATION-FORCE       PIC X.
  4492             20  CF-INDIVIDUAL-APP.
  4493                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4494                     28  CF-BROWSE-APP      PIC X.
  4495                     28  CF-UPDATE-APP      PIC X.
  4496
  4497         16  CF-CURRENT-TERM-ON             PIC X(4).
  4498         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4499             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4500             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4501             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4502             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4503             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4504             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4505             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4506         16  CF-PROCESSOR-CARRIER           PIC X.
  4507             88  NO-CARRIER-SECURITY            VALUE ' '.
  4508         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4509             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4510         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4511             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4512         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4513             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4514
  4515         16  CF-PROC-SYS-ACCESS-SW.
  4516             20  CF-PROC-CREDIT-CLAIMS-SW.
  4517                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4518                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4519                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4520                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4521             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4522                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4523                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4524             20  CF-PROC-LIFE-GNRLDGR-SW.
  4525                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4526                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4527                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4528                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4529             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4530                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4531                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4532         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4533             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4534             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4535         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4536
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  89
* EL156.cbl
  4537         16  CF-APPROVAL-LEVEL                  PIC X.
  4538             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4539             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4540             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4541             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4542
  4543         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4544
  4545         16  CF-LANGUAGE-TYPE                   PIC X.
  4546             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4547             88  CF-LANG-IS-FR                      VALUE 'F'.
  4548
  4549         16  CF-CSR-IND                         PIC X.
  4550         16  FILLER                             PIC X(239).
  4551
  4552****************************************************************
  4553*             PROCESSOR/REMINDERS RECORD                       *
  4554****************************************************************
  4555
  4556     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4557         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4558             20  CF-START-REMIND-DT         PIC XX.
  4559             20  CF-END-REMIND-DT           PIC XX.
  4560             20  CF-REMINDER-TEXT           PIC X(50).
  4561         16  FILLER                         PIC X(296).
  4562
  4563
  4564****************************************************************
  4565*             STATE MASTER RECORD                              *
  4566****************************************************************
  4567
  4568     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4569         16  CF-STATE-ABBREVIATION          PIC XX.
  4570         16  CF-STATE-NAME                  PIC X(25).
  4571         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4572         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4573             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4574             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4575             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4576             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4577                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4578                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4579             20  CF-ST-PREM-REJECT-SW       PIC X.
  4580                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4581                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4582             20  CF-ST-REF-REJECT-SW        PIC X.
  4583                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4584                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4585         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4586         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4587         16  CF-ST-REFUND-RULES.
  4588             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4589             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4590             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4591         16  CF-ST-FST-PMT-EXTENSION.
  4592             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4593             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4594                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  90
* EL156.cbl
  4595                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4596                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4597                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4598         16  CF-ST-STATE-CALL.
  4599             20  CF-ST-CALL-UNEARNED        PIC X.
  4600             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4601             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4602         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4603             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4604             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4605         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4606         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4607         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4608         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4609         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4610         16  FILLER                         PIC X.
  4611         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4612             20  CF-ST-BENEFIT-CD           PIC XX.
  4613             20  CF-ST-BENEFIT-KIND         PIC X.
  4614                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4615                 88  CF-ST-AH-KIND              VALUE 'A'.
  4616             20  CF-ST-REM-TERM-CALC        PIC X.
  4617                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4618                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4619                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4620                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4621                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4622                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4623                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4624                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4625
  4626             20  CF-ST-REFUND-CALC          PIC X.
  4627                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4628                 88  ST-REFD-BY-R78             VALUE '1'.
  4629                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4630                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4631                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4632                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4633                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4634                 88  ST-REFD-UTAH               VALUE '7'.
  4635                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4636                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4637                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4638
  4639             20  CF-ST-EARNING-CALC         PIC X.
  4640                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4641                 88  ST-EARN-BY-R78             VALUE '1'.
  4642                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4643                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4644                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4645                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4646                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4647                 88  ST-EARN-MEAN               VALUE '8'.
  4648                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4649
  4650             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4651                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4652                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  91
* EL156.cbl
  4653                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4654                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4655                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4656                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4657                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4658                 88  ST-OVRD-MEAN               VALUE '8'.
  4659                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4660             20  FILLER                     PIC X.
  4661
  4662         16  CF-ST-COMMISSION-CAPS.
  4663             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4664             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4665             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4666             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4667         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4668                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4669
  4670         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4671
  4672         16  CF-ST-STATUTORY-INTEREST.
  4673             20  CF-ST-STAT-DATE-FROM       PIC X.
  4674                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4675                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4676             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4677             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4678             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4679             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4680             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4681
  4682         16  CF-ST-OVER-SHORT.
  4683             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4684             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4685
  4686         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4687
  4688         16  CF-ST-RT-CALC                  PIC X.
  4689
  4690         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4691         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4692         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4693         16  CF-ST-RF-LR-CALC               PIC X.
  4694         16  CF-ST-RF-LL-CALC               PIC X.
  4695         16  CF-ST-RF-LN-CALC               PIC X.
  4696         16  CF-ST-RF-AH-CALC               PIC X.
  4697         16  CF-ST-RF-CP-CALC               PIC X.
  4698*        16  FILLER                         PIC X(206).
  4699*CIDMOD         16  FILLER                         PIC X(192).
  4700         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4701             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4702         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4703         16  CF-ST-VFY-2ND-BENE             PIC X.
  4704         16  CF-ST-CAUSAL-STATE             PIC X.
  4705         16  FILLER                         PIC X(185).
  4706
  4707****************************************************************
  4708*             BENEFIT MASTER RECORD                            *
  4709****************************************************************
  4710
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  92
* EL156.cbl
  4711     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4712         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4713             20  CF-BENEFIT-CODE            PIC XX.
  4714             20  CF-BENEFIT-NUMERIC  REDEFINES
  4715                 CF-BENEFIT-CODE            PIC XX.
  4716             20  CF-BENEFIT-ALPHA           PIC XXX.
  4717             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4718             20  CF-BENEFIT-COMMENT         PIC X(10).
  4719
  4720             20  CF-LF-COVERAGE-TYPE        PIC X.
  4721                 88  CF-REDUCING                VALUE 'R'.
  4722                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4723
  4724             20  CF-SPECIAL-CALC-CD         PIC X.
  4725                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4726                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4727                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4728                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4729                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4730                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4731                 88  CF-FARM-PLAN               VALUE 'F'.
  4732                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4733                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4734                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4735                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4736                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4737                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4738                 88  CF-PRUDENTIAL              VALUE 'P'.
  4739                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4740                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4741                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4742                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4743                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4744                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4745
  4746             20  CF-JOINT-INDICATOR         PIC X.
  4747                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4748
  4749*            20  FILLER                     PIC X(12).
  4750             20  FILLER                     PIC X(11).
  4751             20  CF-BENEFIT-CATEGORY        PIC X.
  4752             20  CF-LOAN-TYPE               PIC X(8).
  4753
  4754             20  CF-CO-REM-TERM-CALC        PIC X.
  4755                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4756                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4757                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4758                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4759                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4760
  4761             20  CF-CO-EARNINGS-CALC        PIC X.
  4762                 88  CO-EARN-BY-R78             VALUE '1'.
  4763                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4764                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4765                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4766                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4767                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4768                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  93
* EL156.cbl
  4769                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4770
  4771             20  CF-CO-REFUND-CALC          PIC X.
  4772                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4773                 88  CO-REFD-BY-R78             VALUE '1'.
  4774                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4775                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4776                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4777                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4778                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4779                 88  CO-REFD-MEAN               VALUE '8'.
  4780                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4781                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4782                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4783
  4784             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4785                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4786                 88  CO-OVRD-BY-R78             VALUE '1'.
  4787                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4788                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4789                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4790                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4791                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4792                 88  CO-OVRD-MEAN               VALUE '8'.
  4793                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4794
  4795             20  CF-CO-BEN-I-G-CD           PIC X.
  4796                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4797                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4798                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4799
  4800         16  FILLER                         PIC X(304).
  4801
  4802
  4803****************************************************************
  4804*             CARRIER MASTER RECORD                            *
  4805****************************************************************
  4806
  4807     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4808         16  CF-ADDRESS-DATA.
  4809             20  CF-MAIL-TO-NAME            PIC X(30).
  4810             20  CF-IN-CARE-OF              PIC X(30).
  4811             20  CF-ADDRESS-LINE-1          PIC X(30).
  4812             20  CF-ADDRESS-LINE-2          PIC X(30).
  4813             20  CF-CITY-STATE              PIC X(30).
  4814             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4815             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4816
  4817         16  CF-CLAIM-NO-CONTROL.
  4818             20  CF-CLAIM-NO-METHOD         PIC X.
  4819                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4820                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4821                 88  CLAIM-NO-SEQ               VALUE '3'.
  4822                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4823             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4824                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4825                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4826                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  94
* EL156.cbl
  4827
  4828         16  CF-CHECK-NO-CONTROL.
  4829             20  CF-CHECK-NO-METHOD         PIC X.
  4830                 88  CHECK-NO-MANUAL            VALUE '1'.
  4831                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4832                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4833                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4834             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4835                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4836
  4837         16  CF-DOMICILE-STATE              PIC XX.
  4838
  4839         16  CF-EXPENSE-CONTROLS.
  4840             20  CF-EXPENSE-METHOD          PIC X.
  4841                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4842                 88  DOLLARS-PER-PMT            VALUE '2'.
  4843                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4844                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4845             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4846             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4847
  4848         16  CF-CORRESPONDENCE-CONTROL.
  4849             20  CF-LETTER-RESEND-OPT       PIC X.
  4850                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4851                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4852             20  FILLER                     PIC X(4).
  4853
  4854         16  CF-RESERVE-CONTROLS.
  4855             20  CF-MANUAL-SW               PIC X.
  4856                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4857             20  CF-FUTURE-SW               PIC X.
  4858                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4859             20  CF-PTC-SW                  PIC X.
  4860                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4861             20  CF-IBNR-SW                 PIC X.
  4862                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4863             20  CF-PTC-LF-SW               PIC X.
  4864                 88  CF-LF-PTC-USED             VALUE '1'.
  4865             20  CF-CDT-ACCESS-METHOD       PIC X.
  4866                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4867                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4868                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4869             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4870
  4871         16  CF-CLAIM-CALC-METHOD           PIC X.
  4872             88  360-PLUS-MONTHS                VALUE '1'.
  4873             88  365-PLUS-MONTHS                VALUE '2'.
  4874             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4875             88  360-DAILY                      VALUE '4'.
  4876             88  365-DAILY                      VALUE '5'.
  4877
  4878         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4879         16  FILLER                         PIC X(11).
  4880
  4881         16  CF-LIMIT-AMOUNTS.
  4882             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4883             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4884             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  95
* EL156.cbl
  4885             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4886             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4887             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4888             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4889             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4890             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4891             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4892
  4893         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4894         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4895         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4896
  4897         16  CF-ZIP-CODE.
  4898             20  CF-ZIP-PRIME.
  4899                 24  CF-ZIP-1ST             PIC X.
  4900                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4901                 24  FILLER                 PIC X(4).
  4902             20  CF-ZIP-PLUS4               PIC X(4).
  4903         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4904             20  CF-CAN-POSTAL-1            PIC XXX.
  4905             20  CF-CAN-POSTAL-2            PIC XXX.
  4906             20  FILLER                     PIC XXX.
  4907
  4908         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4909         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4910         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4911
  4912         16  CF-RATING-SWITCH               PIC X.
  4913             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4914             88  CF-NO-RATING                   VALUE 'N'.
  4915
  4916         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4917
  4918         16  CF-CARRIER-OVER-SHORT.
  4919             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4920             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4921
  4922         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4923         16  CF-SECPAY-SWITCH               PIC X.
  4924             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4925             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4926         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4927         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4928         16  FILLER                         PIC X(444).
  4929*        16  FILLER                         PIC X(452).
  4930
  4931
  4932****************************************************************
  4933*             MORTALITY MASTER RECORD                          *
  4934****************************************************************
  4935
  4936     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4937         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4938                                INDEXED BY CF-MORT-NDX.
  4939             20  CF-MORT-TABLE              PIC X(5).
  4940             20  CF-MORT-TABLE-TYPE         PIC X.
  4941                 88  CF-MORT-JOINT              VALUE 'J'.
  4942                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  96
* EL156.cbl
  4943                 88  CF-MORT-COMBINED           VALUE 'C'.
  4944                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4945                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4946             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4947             20  CF-MORT-AGE-METHOD         PIC XX.
  4948                 88  CF-AGE-LAST                VALUE 'AL'.
  4949                 88  CF-AGE-NEAR                VALUE 'AN'.
  4950             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4951             20  CF-MORT-ADJUSTMENT-DIRECTION
  4952                                            PIC X.
  4953                 88  CF-MINUS                   VALUE '-'.
  4954                 88  CF-PLUS                    VALUE '+'.
  4955             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4956             20  CF-MORT-JOINT-CODE         PIC X.
  4957                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4958             20  CF-MORT-PC-Q               PIC X.
  4959                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4960             20  CF-MORT-TABLE-CODE         PIC X(4).
  4961             20  CF-MORT-COMMENTS           PIC X(15).
  4962             20  FILLER                     PIC X(14).
  4963
  4964         16  FILLER                         PIC X(251).
  4965
  4966
  4967****************************************************************
  4968*             BUSSINESS TYPE MASTER RECORD                     *
  4969****************************************************************
  4970
  4971     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4972* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4973* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4974* AND RECORD 05 IS TYPES 81-99
  4975         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4976             20  CF-BUSINESS-TITLE          PIC  X(19).
  4977             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4978                                            PIC S9V9(4) COMP-3.
  4979             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4980             20  FILLER                     PIC  X.
  4981         16  FILLER                         PIC  X(248).
  4982
  4983
  4984****************************************************************
  4985*             TERMINAL MASTER RECORD                           *
  4986****************************************************************
  4987
  4988     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4989
  4990         16  CF-COMPANY-TERMINALS.
  4991             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4992                                  PIC X(4).
  4993         16  FILLER               PIC X(248).
  4994
  4995
  4996****************************************************************
  4997*             LIFE EDIT MASTER RECORD                          *
  4998****************************************************************
  4999
  5000     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  97
* EL156.cbl
  5001         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5002             20  CF-LIFE-CODE-IN            PIC XX.
  5003             20  CF-LIFE-CODE-OUT           PIC XX.
  5004         16  FILLER                         PIC X(248).
  5005
  5006
  5007****************************************************************
  5008*             AH EDIT MASTER RECORD                            *
  5009****************************************************************
  5010
  5011     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5012         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5013             20  CF-AH-CODE-IN              PIC XXX.
  5014             20  CF-AH-CODE-OUT             PIC XX.
  5015         16  FILLER                         PIC X(248).
  5016
  5017
  5018****************************************************************
  5019*             CREDIBILITY TABLES                               *
  5020****************************************************************
  5021
  5022     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5023         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5024                             INDEXED BY CF-CRDB-NDX.
  5025             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5026             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5027             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5028         16  FILLER                         PIC  X(332).
  5029
  5030
  5031****************************************************************
  5032*             REPORT CUSTOMIZATION RECORD                      *
  5033****************************************************************
  5034
  5035     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5036         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5037             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5038             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5039             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5040**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5041****       A T-TRANSFER.                                   ****
  5042             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5043
  5044         16  FILLER                         PIC XX.
  5045
  5046         16  CF-CARRIER-CNTL-OPT.
  5047             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5048                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5049                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5050             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5051                                            PIC X.
  5052         16  CF-GROUP-CNTL-OPT.
  5053             20  CF-GROUP-OPT-SEQ           PIC 9.
  5054                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5055                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5056             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5057                                            PIC X(6).
  5058         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  98
* EL156.cbl
  5059             20  CF-STATE-OPT-SEQ           PIC 9.
  5060                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5061                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5062             20  CF-STATE-SELECT OCCURS 3 TIMES
  5063                                            PIC XX.
  5064         16  CF-ACCOUNT-CNTL-OPT.
  5065             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5066                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5067                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5068             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5069                                            PIC X(10).
  5070         16  CF-BUS-TYP-CNTL-OPT.
  5071             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5072                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5073                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5074             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5075                                            PIC XX.
  5076         16  CF-LF-TYP-CNTL-OPT.
  5077             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5078                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5079                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5080             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5081                                            PIC XX.
  5082         16  CF-AH-TYP-CNTL-OPT.
  5083             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5084                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5085                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5086             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5087                                            PIC XX.
  5088         16  CF-REPTCD1-CNTL-OPT.
  5089             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5090                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5091                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5092             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5093                                            PIC X(10).
  5094         16  CF-REPTCD2-CNTL-OPT.
  5095             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5096                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5097                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5098             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5099                                            PIC X(10).
  5100         16  CF-USER1-CNTL-OPT.
  5101             20  CF-USER1-OPT-SEQ           PIC 9.
  5102                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5103                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5104             20  CF-USER1-SELECT OCCURS 3 TIMES
  5105                                            PIC X(10).
  5106         16  CF-USER2-CNTL-OPT.
  5107             20  CF-USER2-OPT-SEQ           PIC 9.
  5108                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5109                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5110             20  CF-USER2-SELECT OCCURS 3 TIMES
  5111                                            PIC X(10).
  5112         16  CF-USER3-CNTL-OPT.
  5113             20  CF-USER3-OPT-SEQ           PIC 9.
  5114                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5115                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5116             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page  99
* EL156.cbl
  5117                                            PIC X(10).
  5118         16  CF-USER4-CNTL-OPT.
  5119             20  CF-USER4-OPT-SEQ           PIC 9.
  5120                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5121                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5122             20  CF-USER4-SELECT OCCURS 3 TIMES
  5123                                            PIC X(10).
  5124         16  CF-USER5-CNTL-OPT.
  5125             20  CF-USER5-OPT-SEQ           PIC 9.
  5126                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5127                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5128             20  CF-USER5-SELECT OCCURS 3 TIMES
  5129                                            PIC X(10).
  5130         16  CF-REINS-CNTL-OPT.
  5131             20  CF-REINS-OPT-SEQ           PIC 9.
  5132                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5133                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5134             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5135                 24  CF-REINS-PRIME         PIC XXX.
  5136                 24  CF-REINS-SUB           PIC XXX.
  5137
  5138         16  CF-AGENT-CNTL-OPT.
  5139             20  CF-AGENT-OPT-SEQ           PIC 9.
  5140                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5141                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5142             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5143                                            PIC X(10).
  5144
  5145         16  FILLER                         PIC X(43).
  5146
  5147         16  CF-LOSS-RATIO-SELECT.
  5148             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5149             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5150         16  CF-ENTRY-DATE-SELECT.
  5151             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5152             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5153         16  CF-EFFECTIVE-DATE-SELECT.
  5154             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5155             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5156
  5157         16  CF-EXCEPTION-LIST-IND          PIC X.
  5158             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5159
  5160         16  FILLER                         PIC X(318).
  5161
  5162****************************************************************
  5163*                  EXCEPTION REPORTING RECORD                  *
  5164****************************************************************
  5165
  5166     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5167         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5168             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5169
  5170         16  CF-COMBINED-LIFE-AH-OPT.
  5171             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5172             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5173             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5174             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 100
* EL156.cbl
  5175
  5176         16  CF-LIFE-OPT.
  5177             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5178             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5179             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5180             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5181             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5182             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5183             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5184             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5185             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5186             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5187
  5188         16  CF-AH-OPT.
  5189             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5190             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5191             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5192             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5193             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5194             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5195             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5196             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5197             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5198             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5199
  5200         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5201             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5202             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5203             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5204
  5205         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5206
  5207         16  FILLER                         PIC X(673).
  5208
  5209
  5210****************************************************************
  5211*             MORTGAGE SYSTEM PLAN RECORD                      *
  5212****************************************************************
  5213
  5214     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5215         16  CF-PLAN-TYPE                   PIC X.
  5216             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5217             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5218             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5219         16  CF-PLAN-ABBREV                 PIC XXX.
  5220         16  CF-PLAN-DESCRIPT               PIC X(10).
  5221         16  CF-PLAN-NOTES                  PIC X(20).
  5222         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5223         16  CF-PLAN-UNDERWRITING.
  5224             20  CF-PLAN-TERM-DATA.
  5225                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5226                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5227             20  CF-PLAN-AGE-DATA.
  5228                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5229                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5230                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5231             20  CF-PLAN-BENEFIT-DATA.
  5232                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 101
* EL156.cbl
  5233                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5234                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5235                                            PIC S9(7)V99  COMP-3.
  5236         16  CF-PLAN-POLICY-FORMS.
  5237             20  CF-POLICY-FORM             PIC X(12).
  5238             20  CF-MASTER-APPLICATION      PIC X(12).
  5239             20  CF-MASTER-POLICY           PIC X(12).
  5240         16  CF-PLAN-RATING.
  5241             20  CF-RATE-CODE               PIC X(5).
  5242             20  CF-SEX-RATING              PIC X.
  5243                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5244                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5245             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5246             20  CF-SUB-STD-TYPE            PIC X.
  5247                 88  CF-PCT-OF-PREM            VALUE '1'.
  5248                 88  CF-PCT-OF-BENE            VALUE '2'.
  5249         16  CF-PLAN-PREM-TOLERANCES.
  5250             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5251             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5252         16  CF-PLAN-PYMT-TOLERANCES.
  5253             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5254             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5255         16  CF-PLAN-MISC-DATA.
  5256             20  FILLER                     PIC X.
  5257             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5258             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5259         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5260         16  CF-PLAN-IND-GRP                PIC X.
  5261             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5262                                                     '1'.
  5263             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5264                                                     '2'.
  5265         16  CF-MIB-SEARCH-SW               PIC X.
  5266             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5267             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5268             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5269             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5270         16  CF-ALPHA-SEARCH-SW             PIC X.
  5271             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5272             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5273             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5274             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5275             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5276             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5277             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5278             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5279             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5280             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5281                                                     'A' 'B' 'C'
  5282                                                     'X' 'Y' 'Z'.
  5283         16  CF-EFF-DT-RULE-SW              PIC X.
  5284             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5285             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5286             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5287             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5288             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5289         16  FILLER                         PIC X(4).
  5290         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 102
* EL156.cbl
  5291             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5292         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5293         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5294         16  CF-PLAN-SNGL-JNT               PIC X.
  5295             88  CF-COMBINED-PLAN              VALUE 'C'.
  5296             88  CF-JNT-PLAN                   VALUE 'J'.
  5297             88  CF-SNGL-PLAN                  VALUE 'S'.
  5298         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5299         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5300         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5301         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5302         16  CF-RERATE-CNTL                 PIC  X.
  5303             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5304             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5305             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5306             88  CF-AUTO-RECALC                 VALUE '4'.
  5307         16  CF-BENEFIT-TYPE                PIC  X.
  5308             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5309             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5310         16  CF-POLICY-FEE                  PIC S999V99
  5311                                                    COMP-3.
  5312         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5313         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5314         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5315         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5316         16  FILLER                         PIC  X(32).
  5317         16  CF-TERMINATION-FORM            PIC  X(04).
  5318         16  FILLER                         PIC  X(08).
  5319         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5320                                                       COMP-3.
  5321         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5322         16  CF-ISSUE-LETTER                PIC  X(4).
  5323         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5324         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5325             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5326             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5327         16  CF-MP-REFUND-CALC              PIC X.
  5328             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5329             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5330             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5331             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5332             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5333             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5334             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5335             88  CF-MP-REFD-MEAN                VALUE '8'.
  5336         16  CF-ALT-RATE-CODE               PIC  X(5).
  5337
  5338
  5339         16  FILLER                         PIC X(498).
  5340****************************************************************
  5341*             MORTGAGE COMPANY MASTER RECORD                   *
  5342****************************************************************
  5343
  5344     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5345         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5346         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5347             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5348             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 103
* EL156.cbl
  5349             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5350             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5351             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5352
  5353         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5354         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5355         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5356         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5357         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5358
  5359         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5360             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5361         16  CF-MP-RECON-USE-IND            PIC X(1).
  5362             88  CF-MP-USE-RECON             VALUE 'Y'.
  5363         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5364             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5365         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5366             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5367             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5368         16  FILLER                         PIC X(1).
  5369         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5370             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5371         16  CF-MORTG-MIB-VERSION           PIC X.
  5372             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5373             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5374             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5375         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5376             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5377                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5378             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5379                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5380             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5381                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5382             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5383                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5384             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5385                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5386             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5387                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5388         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5389         16  FILLER                         PIC X(7).
  5390         16  CF-MORTG-DESTINATION-SYMBOL.
  5391             20  CF-MORTG-MIB-COMM          PIC X(5).
  5392             20  CF-MORTG-MIB-TERM          PIC X(5).
  5393         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5394             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5395         16  FILLER                         PIC X(03).
  5396         16  CF-MP-CHECK-NO-CONTROL.
  5397             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5398                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5399                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5400                                                ' ' LOW-VALUES.
  5401                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5402                                               VALUE '3'.
  5403         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5404         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5405         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5406             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 104
* EL156.cbl
  5407                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5408             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5409                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5410             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5411                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5412             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5413                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5414             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5415                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5416             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5417                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5418         16  CF-MORTG-BILLING-AREA.
  5419             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5420                                            PIC X.
  5421         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5422         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5423         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5424         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5425             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5426             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5427         16  FILLER                         PIC X.
  5428         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5429             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5430             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5431         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5432         16  FILLER                         PIC X(8).
  5433         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5434         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5435         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5436         16  CF-ACH-COMPANY-ID.
  5437             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5438                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5439                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5440                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5441             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5442         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5443             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5444         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5445             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5446             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5447         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5448         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5449         16  FILLER                         PIC X(536).
  5450
  5451****************************************************************
  5452*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5453****************************************************************
  5454
  5455     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5456         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5457             20  CF-FEMALE-HEIGHT.
  5458                 24  CF-FEMALE-FT           PIC 99.
  5459                 24  CF-FEMALE-IN           PIC 99.
  5460             20  CF-FEMALE-MIN-WT           PIC 999.
  5461             20  CF-FEMALE-MAX-WT           PIC 999.
  5462         16  FILLER                         PIC X(428).
  5463
  5464     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 105
* EL156.cbl
  5465         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5466             20  CF-MALE-HEIGHT.
  5467                 24  CF-MALE-FT             PIC 99.
  5468                 24  CF-MALE-IN             PIC 99.
  5469             20  CF-MALE-MIN-WT             PIC 999.
  5470             20  CF-MALE-MAX-WT             PIC 999.
  5471         16  FILLER                         PIC X(428).
  5472******************************************************************
  5473*             AUTOMATIC ACTIVITY RECORD                          *
  5474******************************************************************
  5475     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5476         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5477             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5478             20  CF-SYS-LETTER-ID           PIC X(04).
  5479             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5480             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5481             20  CF-SYS-RESET-SW            PIC X(01).
  5482             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5483             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5484
  5485         16  FILLER                         PIC X(50).
  5486
  5487         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5488             20  CF-USER-ACTIVE-SW          PIC X(01).
  5489             20  CF-USER-LETTER-ID          PIC X(04).
  5490             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5491             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5492             20  CF-USER-RESET-SW           PIC X(01).
  5493             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5494             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5495             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5496
  5497         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 106
* EL156.cbl
  5499*    COPY ELCCERT.
  5500******************************************************************
  5501*                                                                *
  5502*                            ELCCERT.                            *
  5503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5504*                            VMOD=2.013                          *
  5505*                                                                *
  5506*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5507*                                                                *
  5508*   FILE TYPE = VSAM,KSDS                                        *
  5509*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5510*                                                                *
  5511*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5512*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5513*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5514*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5515*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5516*                                                                *
  5517*   LOG = YES                                                    *
  5518*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5519******************************************************************
  5520*                   C H A N G E   L O G
  5521*
  5522* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5523*-----------------------------------------------------------------
  5524*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5525* EFFECTIVE    NUMBER
  5526*-----------------------------------------------------------------
  5527* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5528* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5529* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5530* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5531* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5532* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5533* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5534* 032612  CR2011110200001  PEMA  AHL CHANGES
  5535******************************************************************
  5536
  5537 01  CERTIFICATE-MASTER.
  5538     12  CM-RECORD-ID                      PIC XX.
  5539         88  VALID-CM-ID                      VALUE 'CM'.
  5540
  5541     12  CM-CONTROL-PRIMARY.
  5542         16  CM-COMPANY-CD                 PIC X.
  5543         16  CM-CARRIER                    PIC X.
  5544         16  CM-GROUPING.
  5545             20  CM-GROUPING-PREFIX        PIC X(3).
  5546             20  CM-GROUPING-PRIME         PIC X(3).
  5547         16  CM-STATE                      PIC XX.
  5548         16  CM-ACCOUNT.
  5549             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5550             20  CM-ACCOUNT-PRIME          PIC X(6).
  5551         16  CM-CERT-EFF-DT                PIC XX.
  5552         16  CM-CERT-NO.
  5553             20  CM-CERT-PRIME             PIC X(10).
  5554             20  CM-CERT-SFX               PIC X.
  5555
  5556     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 107
* EL156.cbl
  5557         16  CM-COMPANY-CD-A1              PIC X.
  5558         16  CM-INSURED-LAST-NAME          PIC X(15).
  5559         16  CM-INSURED-INITIALS.
  5560             20  CM-INSURED-INITIAL1       PIC X.
  5561             20  CM-INSURED-INITIAL2       PIC X.
  5562
  5563     12  CM-CONTROL-BY-SSN.
  5564         16  CM-COMPANY-CD-A2              PIC X.
  5565         16  CM-SOC-SEC-NO.
  5566             20  CM-SSN-STATE              PIC XX.
  5567             20  CM-SSN-ACCOUNT            PIC X(6).
  5568             20  CM-SSN-LN3.
  5569                 25  CM-INSURED-INITIALS-A2.
  5570                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5571                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5572                 25 CM-PART-LAST-NAME-A2         PIC X.
  5573
  5574     12  CM-CONTROL-BY-CERT-NO.
  5575         16  CM-COMPANY-CD-A4              PIC X.
  5576         16  CM-CERT-NO-A4                 PIC X(11).
  5577
  5578     12  CM-CONTROL-BY-MEMB.
  5579         16  CM-COMPANY-CD-A5              PIC X.
  5580         16  CM-MEMBER-NO.
  5581             20  CM-MEMB-STATE             PIC XX.
  5582             20  CM-MEMB-ACCOUNT           PIC X(6).
  5583             20  CM-MEMB-LN4.
  5584                 25  CM-INSURED-INITIALS-A5.
  5585                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5586                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5587                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5588
  5589     12  CM-INSURED-PROFILE-DATA.
  5590         16  CM-INSURED-FIRST-NAME.
  5591             20  CM-INSURED-1ST-INIT       PIC X.
  5592             20  FILLER                    PIC X(9).
  5593         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5594         16  CM-INSURED-SEX                PIC X.
  5595             88  CM-SEX-MALE                  VALUE 'M'.
  5596             88  CM-SEX-FEMAL                 VALUE 'F'.
  5597         16  CM-INSURED-JOINT-AGE          PIC 99.
  5598         16  CM-JOINT-INSURED-NAME.
  5599             20  CM-JT-LAST-NAME           PIC X(15).
  5600             20  CM-JT-FIRST-NAME.
  5601                 24  CM-JT-1ST-INIT        PIC X.
  5602                 24  FILLER                PIC X(9).
  5603             20  CM-JT-INITIAL             PIC X.
  5604
  5605     12  CM-LIFE-DATA.
  5606         16  CM-LF-BENEFIT-CD              PIC XX.
  5607         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5608         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5609         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5610         16  CM-LF-DEV-CODE                PIC XXX.
  5611         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5612         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5613         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5614         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 108
* EL156.cbl
  5615         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5616         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5617         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5618         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5619         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5620         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5621         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5622         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5623         16  FILLER                        PIC XX.
  5624
  5625     12  CM-AH-DATA.
  5626         16  CM-AH-BENEFIT-CD              PIC XX.
  5627         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5628         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5629         16  CM-AH-DEV-CODE                PIC XXX.
  5630         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5631         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5632         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5633         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5634         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5635         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5636         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5637         16  CM-AH-PAID-THRU-DT            PIC XX.
  5638             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5639         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5640         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5641         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5642         16  FILLER                        PIC X.
  5643
  5644     12  CM-LOAN-INFORMATION.
  5645         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5646         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5647                                           PIC S9(5)V99  COMP-3.
  5648         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5649         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5650         16  CM-PAY-FREQUENCY              PIC S99.
  5651         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5652         16  CM-RATE-CLASS                 PIC XX.
  5653         16  CM-BENEFICIARY                PIC X(25).
  5654         16  CM-POLICY-FORM-NO             PIC X(12).
  5655         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5656         16  CM-LAST-ADD-ON-DT             PIC XX.
  5657         16  CM-DEDUCTIBLE-AMOUNTS.
  5658             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5659             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5660         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5661             20  CM-RESIDENT-STATE         PIC XX.
  5662             20  CM-RATE-CODE              PIC X(4).
  5663             20  FILLER                    PIC XX.
  5664         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5665             20  CM-LOAN-OFFICER           PIC X(5).
  5666             20  FILLER                    PIC XXX.
  5667         16  CM-CSR-CODE                   PIC XXX.
  5668         16  CM-UNDERWRITING-CODE          PIC X.
  5669             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5670         16  CM-POST-CARD-IND              PIC X.
  5671         16  CM-NH-INTERFACE-SW            PIC X.
  5672         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 109
* EL156.cbl
  5673             88  CM-SING-PRM                  VALUE '1'.
  5674             88  CM-O-B-COVERAGE              VALUE '2'.
  5675             88  CM-OPEN-END                  VALUE '3'.
  5676         16  CM-IND-GRP-TYPE               PIC X.
  5677             88  CM-INDIVIDUAL                VALUE 'I'.
  5678             88  CM-GROUP                     VALUE 'G'.
  5679         16  CM-SKIP-CODE                  PIC X.
  5680             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5681             88  SKIP-JULY                    VALUE '1'.
  5682             88  SKIP-AUGUST                  VALUE '2'.
  5683             88  SKIP-SEPTEMBER               VALUE '3'.
  5684             88  SKIP-JULY-AUG                VALUE '4'.
  5685             88  SKIP-AUG-SEPT                VALUE '5'.
  5686             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5687             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5688             88  SKIP-JUNE                    VALUE '8'.
  5689             88  SKIP-JUNE-JULY               VALUE '9'.
  5690             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5691             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5692         16  CM-PAYMENT-MODE               PIC X.
  5693             88  PAY-MONTHLY                  VALUE SPACE.
  5694             88  PAY-WEEKLY                   VALUE '1'.
  5695             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5696             88  PAY-BI-WEEKLY                VALUE '3'.
  5697             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5698         16  CM-LOAN-NUMBER                PIC X(8).
  5699         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5700         16  CM-OLD-LOF                    PIC XXX.
  5701*        16  CM-LOAN-OFFICER               PIC XXX.
  5702         16  CM-REIN-TABLE                 PIC XXX.
  5703         16  CM-SPECIAL-REIN-CODE          PIC X.
  5704         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5705         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5706         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5707
  5708     12  CM-STATUS-DATA.
  5709         16  CM-ENTRY-STATUS               PIC X.
  5710         16  CM-ENTRY-DT                   PIC XX.
  5711
  5712         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5713         16  CM-LF-CANCEL-DT               PIC XX.
  5714         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5715
  5716         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5717         16  CM-LF-DEATH-DT                PIC XX.
  5718         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5719
  5720         16  CM-LF-CURRENT-STATUS          PIC X.
  5721             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5722                                                'M' '4' '5' '9'.
  5723             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5724             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5725             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5726             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5727             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5728             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5729             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5730             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 110
* EL156.cbl
  5731             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5732             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5733             88  CM-LF-DECLINED               VALUE 'D'.
  5734             88  CM-LF-VOIDED                 VALUE 'V'.
  5735
  5736         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5737         16  CM-AH-CANCEL-DT               PIC XX.
  5738         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5739
  5740         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5741         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5742         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5743
  5744         16  CM-AH-CURRENT-STATUS          PIC X.
  5745             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5746                                                'M' '4' '5' '9'.
  5747             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5748             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5749             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5750             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5751             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5752             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5753             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5754             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5755             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5756             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5757             88  CM-AH-DECLINED               VALUE 'D'.
  5758             88  CM-AH-VOIDED                 VALUE 'V'.
  5759
  5760         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5761             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5762             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5763             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5764         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5765
  5766         16  CM-ENTRY-BATCH                PIC X(6).
  5767         16  CM-LF-EXIT-BATCH              PIC X(6).
  5768         16  CM-AH-EXIT-BATCH              PIC X(6).
  5769         16  CM-LAST-MONTH-END             PIC XX.
  5770
  5771     12  CM-NOTE-SW                        PIC X.
  5772         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5773         88  CERT-NOTES-PRESENT               VALUE '1'.
  5774         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5775         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5776         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5777         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5778         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5779         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5780     12  CM-COMP-EXCP-SW                   PIC X.
  5781         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5782         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5783     12  CM-INSURED-ADDRESS-SW             PIC X.
  5784         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5785         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5786
  5787*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5788     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 111
* EL156.cbl
  5789     12  FILLER                            PIC X.
  5790
  5791*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5792     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5793     12  FILLER                            PIC X.
  5794*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5795     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5796
  5797     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5798         88  CERT-ADDED-BATCH                 VALUE ' '.
  5799         88  CERT-ADDED-ONLINE                VALUE '1'.
  5800         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5801         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5802         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5803     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5804         88  CERT-AS-LOADED                   VALUE ' '.
  5805         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5806         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5807         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5808         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5809         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5810         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5811         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5812
  5813     12  CM-ACCOUNT-COMM-PCTS.
  5814         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5815         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5816
  5817     12  CM-USER-FIELD                     PIC X.
  5818     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5819     12  CM-CLP-STATE                      PIC XX.
  5820     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5821     12  CM-USER-RESERVED                  PIC XXX.
  5822     12  FILLER REDEFINES CM-USER-RESERVED.
  5823         16  CM-AH-CLASS-CD                PIC XX.
  5824         16  F                             PIC X.
  5825******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 112
* EL156.cbl
  5827*    COPY ELCTRLR.
  5828******************************************************************
  5829*                                                                *
  5830*                            ELCTRLR.                            *
  5831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5832*                            VMOD=2.014                          *
  5833*                                                                *
  5834*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5835*                                                                *
  5836*   FILE TYPE = VSAM,KSDS                                        *
  5837*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5838*                                                                *
  5839*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5840*       ALTERNATE INDEX = NONE                                   *
  5841*                                                                *
  5842*   LOG = YES                                                    *
  5843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5844******************************************************************
  5845*                   C H A N G E   L O G
  5846*
  5847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5848*-----------------------------------------------------------------
  5849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5850* EFFECTIVE    NUMBER
  5851*-----------------------------------------------------------------
  5852* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5853* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5854* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5855* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5856* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5857* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5858* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5859* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5860* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5861* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5862* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5863* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5864* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5865* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5866* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5867* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5868******************************************************************
  5869 01  ACTIVITY-TRAILERS.
  5870     12  AT-RECORD-ID                    PIC XX.
  5871         88  VALID-AT-ID                       VALUE 'AT'.
  5872
  5873     12  AT-CONTROL-PRIMARY.
  5874         16  AT-COMPANY-CD               PIC X.
  5875         16  AT-CARRIER                  PIC X.
  5876         16  AT-CLAIM-NO                 PIC X(7).
  5877         16  AT-CERT-NO.
  5878             20  AT-CERT-PRIME           PIC X(10).
  5879             20  AT-CERT-SFX             PIC X.
  5880         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5881             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5882             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5883             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5884             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 113
* EL156.cbl
  5885             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5886             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5887             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5888             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5889             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5890             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5891             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5892             88  AT-BENEFICIARY-TRL           VALUE +91.
  5893             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5894             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5895             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5896             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5897
  5898     12  AT-TRAILER-TYPE                 PIC X.
  5899         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5900         88  PAYMENT-TR                       VALUE '2'.
  5901         88  AUTO-PAY-TR                      VALUE '3'.
  5902         88  CORRESPONDENCE-TR                VALUE '4'.
  5903         88  ADDRESS-TR                       VALUE '5'.
  5904         88  GENERAL-INFO-TR                  VALUE '6'.
  5905         88  AUTO-PROMPT-TR                   VALUE '7'.
  5906         88  DENIAL-TR                        VALUE '8'.
  5907         88  INCURRED-CHG-TR                  VALUE '9'.
  5908         88  FORM-CONTROL-TR                  VALUE 'A'.
  5909
  5910     12  AT-RECORDED-DT                  PIC XX.
  5911     12  AT-RECORDED-BY                  PIC X(4).
  5912     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5913
  5914     12  AT-TRAILER-BODY                 PIC X(165).
  5915
  5916     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5917         16  AT-RESERVE-CONTROLS.
  5918             20  AT-MANUAL-SW            PIC X.
  5919                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5920             20  AT-FUTURE-SW            PIC X.
  5921                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5922             20  AT-PTC-SW               PIC X.
  5923                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5924             20  AT-IBNR-SW              PIC X.
  5925                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5926             20  AT-PTC-LF-SW            PIC X.
  5927                 88  AT-LF-PTC-USED          VALUE '1'.
  5928             20  AT-CDT-ACCESS-METHOD    PIC X.
  5929                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5930                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5931                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5932             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5933         16  AT-LAST-COMPUTED-DT         PIC XX.
  5934         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5935         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5936         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5937         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5938         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5939         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5940         16  AT-EXPENSE-CONTROLS.
  5941             20  AT-EXPENSE-METHOD       PIC X.
  5942                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 114
* EL156.cbl
  5943                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5944                 88  PERCENT-OF-PMT           VALUE '3'.
  5945                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5946             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5947             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5948         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5949         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5950
  5951         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5952         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5953
  5954*        16  FILLER                      PIC X(53).
  5955         16  FILLER                      PIC X(47).
  5956
  5957         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5958         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5959
  5960         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5961             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5962             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5963*                    C = CLOSED
  5964*                    O = OPEN
  5965             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5966*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5967
  5968     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5969         16  AT-PAYMENT-TYPE             PIC X.
  5970             88  PARTIAL-PAYMENT                VALUE '1'.
  5971             88  FINAL-PAYMENT                  VALUE '2'.
  5972             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5973             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5974             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5975             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5976             88  VOIDED-PAYMENT                 VALUE '9'.
  5977             88  TRANSFER                       VALUE 'T'.
  5978             88  LIFE-INTEREST                  VALUE 'I'.
  5979
  5980         16  AT-CLAIM-TYPE               PIC X.
  5981             88  PAID-FOR-AH                    VALUE 'A'.
  5982             88  PAID-FOR-LIFE                  VALUE 'L'.
  5983             88  PAID-FOR-IUI                   VALUE 'I'.
  5984             88  PAID-FOR-GAP                   VALUE 'G'.
  5985         16  AT-CLAIM-PREM-TYPE          PIC X.
  5986             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5987             88  AT-O-B-COVERAGE                VALUE '2'.
  5988             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5989         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5990         16  AT-CHECK-NO                 PIC X(7).
  5991         16  AT-PAID-FROM-DT             PIC XX.
  5992         16  AT-PAID-THRU-DT             PIC XX.
  5993         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5994         16  FILLER                      PIC X.
  5995         16  AT-PAYEES-NAME              PIC X(30).
  5996         16  AT-PAYMENT-ORIGIN           PIC X.
  5997             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5998             88  ONLINE-AUTO-PMT                VALUE '2'.
  5999             88  OFFLINE-PMT                    VALUE '3'.
  6000         16  AT-CHECK-WRITTEN-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 115
* EL156.cbl
  6001         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6002         16  AT-VOID-DATA.
  6003             20  AT-VOID-DT              PIC XX.
  6004*00144       20  AT-VOID-REASON          PIC X(30).
  6005             20  AT-VOID-REASON          PIC X(26).
  6006         16  AT-PMT-APPROVED-BY          PIC X(04).
  6007         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6008         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6009         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6010                                         PIC S99V9(5)  COMP-3.
  6011         16  AT-CREDIT-INTERFACE.
  6012             20  AT-PMT-SELECT-DT        PIC XX.
  6013                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6014             20  AT-PMT-ACCEPT-DT        PIC XX.
  6015                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6016             20  AT-VOID-SELECT-DT       PIC XX.
  6017                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6018             20  AT-VOID-ACCEPT-DT       PIC XX.
  6019                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6020
  6021         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6022                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6023                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6024         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6025
  6026         16  AT-FORCE-CONTROL            PIC X.
  6027             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6028         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6029         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6030         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6031         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6032         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6033         16  AT-BENEFIT-TYPE             PIC X.
  6034
  6035         16  AT-EXPENSE-TYPE             PIC X.
  6036         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6037
  6038         16  AT-PAYEE-TYPE-CD.
  6039             20  AT-PAYEE-TYPE           PIC X.
  6040                 88  INSURED-PAID           VALUE 'I'.
  6041                 88  BENEFICIARY-PAID       VALUE 'B'.
  6042                 88  ACCOUNT-PAID           VALUE 'A'.
  6043                 88  OTHER-1-PAID           VALUE 'O'.
  6044                 88  OTHER-2-PAID           VALUE 'Q'.
  6045                 88  DOCTOR-PAID            VALUE 'P'.
  6046                 88  EMPLOYER-PAID          VALUE 'E'.
  6047             20  AT-PAYEE-SEQ            PIC X.
  6048
  6049         16  AT-CASH-PAYMENT             PIC X.
  6050         16  AT-GROUPED-PAYMENT          PIC X.
  6051         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6052         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6053         16  AT-APPROVED-LEVEL           PIC X.
  6054         16  AT-VOID-TYPE                PIC X.
  6055             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6056             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6057         16  AT-AIG-UNEMP-IND            PIC X.
  6058             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 116
* EL156.cbl
  6059         16  AT-ASSOCIATES               PIC X.
  6060             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6061             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6062
  6063         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6064         16  AT-CV-PMT-CODE              PIC X.
  6065             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6066             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6067             88  FULL-ADD-PAYMENT           VALUE '3'.
  6068             88  HALF-ADD-PAYMENT           VALUE '4'.
  6069             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6070             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6071             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6072             88  ADDL-PAYMENT               VALUE '8'.
  6073
  6074         16  AT-EOB-CODE1                PIC XXX.
  6075         16  AT-EOB-CODE2                PIC XXX.
  6076         16  AT-EOB-CODE3                PIC XXX.
  6077         16  FILLER REDEFINES AT-EOB-CODE3.
  6078             20  AT-PRINT-CLM-FORM       PIC X.
  6079             20  AT-PRINT-SURVEY         PIC X.
  6080             20  FILLER                  PIC X.
  6081         16  AT-EOB-CODE4                PIC XXX.
  6082         16  FILLER REDEFINES AT-EOB-CODE4.
  6083             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6084             20  FILLER                  PIC X.
  6085         16  AT-EOB-CODE5                PIC XXX.
  6086         16  FILLER REDEFINES AT-EOB-CODE5.
  6087             20  AT-PMT-PROOF-DT         PIC XX.
  6088             20  FILLER                  PIC X.
  6089
  6090         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6091             88  AT-PRINT-EOB            VALUE 'Y'.
  6092
  6093         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6094         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6095
  6096     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6097         16  AT-SCHEDULE-START-DT        PIC XX.
  6098         16  AT-SCHEDULE-END-DT          PIC XX.
  6099         16  AT-TERMINATED-DT            PIC XX.
  6100         16  AT-LAST-PMT-TYPE            PIC X.
  6101             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6102             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6103         16  AT-FIRST-PMT-DATA.
  6104             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6105             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6106             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6107         16  AT-REGULAR-PMT-DATA.
  6108             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6109             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6110             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6111         16  AT-AUTO-PAYEE-CD.
  6112             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6113                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6114                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6115                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6116                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 117
* EL156.cbl
  6117                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6118             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6119         16  AT-AUTO-PAY-DAY             PIC 99.
  6120         16  AT-AUTO-CASH                PIC X.
  6121             88  AT-CASH                      VALUE 'Y'.
  6122             88  AT-NON-CASH                  VALUE 'N'.
  6123*        16  FILLER                      PIC X(129).
  6124         16  AT-AUTO-END-LETTER          PIC X(4).
  6125         16  FILLER                      PIC X(125).
  6126
  6127         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6128         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6129
  6130     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6131         16  AT-LETTER-SENT-DT           PIC XX.
  6132         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6133         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6134         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6135         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6136         16  AT-LETTER-ORIGIN            PIC X.
  6137             88  ONLINE-CREATION              VALUE '1' '3'.
  6138             88  OFFLINE-CREATION             VALUE '2' '4'.
  6139             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6140             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6141         16  AT-STD-LETTER-FORM          PIC X(4).
  6142         16  AT-REASON-TEXT              PIC X(70).
  6143         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6144         16  AT-ADDRESEE-TYPE            PIC X.
  6145              88  INSURED-ADDRESEE            VALUE 'I'.
  6146              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6147              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6148              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6149              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6150              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6151              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6152         16  AT-ADDRESSEE-NAME           PIC X(30).
  6153         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6154         16  AT-RESEND-PRINT-DATE        PIC XX.
  6155         16  AT-CORR-SOL-UNSOL           PIC X.
  6156         16  AT-LETTER-PURGED-DT         PIC XX.
  6157*
  6158*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6159*
  6160         16  AT-CSO-REDEFINITION.
  6161             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6162             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6163             20  AT-LETTER-TO-BENE       PIC X(1).
  6164             20  AT-STOP-LETTER-DT       PIC X(2).
  6165             20  FILLER                  PIC X(19).
  6166*             20  FILLER                  PIC X(27).
  6167             20  AT-CSO-LETTER-STATUS    PIC X.
  6168                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6169                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6170                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6171             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6172             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6173*
  6174*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 118
* EL156.cbl
  6175*
  6176*        16  FILLER                      PIC X(26).
  6177*
  6178*        16  AT-DMD-BSR-CODE             PIC X.
  6179*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6180*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6181*
  6182*        16  AT-DMD-LETTER-STATUS        PIC X.
  6183*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6184*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6185*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6186*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6187*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6188
  6189         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6190         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6191
  6192     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6193         16  AT-ADDRESS-TYPE             PIC X.
  6194             88  INSURED-ADDRESS               VALUE 'I'.
  6195             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6196             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6197             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6198             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6199             88  OTHER-ADDRESS-1               VALUE 'O'.
  6200             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6201         16  AT-MAIL-TO-NAME             PIC X(30).
  6202         16  AT-ADDRESS-LINE-1           PIC X(30).
  6203         16  AT-ADDRESS-LINE-2           PIC X(30).
  6204         16  AT-CITY-STATE.
  6205             20  AT-CITY                 PIC X(28).
  6206             20  AT-STATE                PIC XX.
  6207         16  AT-ZIP.
  6208             20  AT-ZIP-CODE.
  6209                 24  AT-ZIP-1ST          PIC X.
  6210                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6211                 24  FILLER              PIC X(4).
  6212             20  AT-ZIP-PLUS4            PIC X(4).
  6213         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6214             20  AT-CAN-POSTAL-1         PIC XXX.
  6215             20  AT-CAN-POSTAL-2         PIC XXX.
  6216             20  FILLER                  PIC XXX.
  6217         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6218*         16  FILLER                      PIC X(23).
  6219         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6220         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6221         16  FILLER                      PIC X(13).
  6222         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6223         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6224
  6225     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6226         16  AT-INFO-LINE-1              PIC X(60).
  6227         16  FILLER REDEFINES AT-INFO-LINE-1.
  6228             20  AT-NOTE-ERROR-NO OCCURS 15
  6229                                         PIC X(4).
  6230         16  AT-INFO-LINE-2              PIC X(60).
  6231         16  AT-INFO-TRAILER-TYPE        PIC X.
  6232             88  AT-ERRORS-NOTE          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 119
* EL156.cbl
  6233             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6234             88  AT-CALL-NOTE            VALUE 'C'.
  6235             88  AT-MAINT-NOTE           VALUE 'M'.
  6236             88  AT-CERT-CHANGE          VALUE 'X'.
  6237             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6238             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6239         16  AT-CALL-TYPE                PIC X.
  6240             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6241             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6242         16  AT-NOTE-CONTINUATION        PIC X.
  6243             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6244         16  AT-EOB-CODES-EXIST          PIC X.
  6245             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6246         16  FILLER                      PIC X(35).
  6247         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6248         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6249
  6250     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6251         16  AT-PROMPT-LINE-1            PIC X(60).
  6252         16  AT-PROMPT-LINE-2            PIC X(60).
  6253         16  AT-PROMPT-START-DT          PIC XX.
  6254         16  AT-PROMPT-END-DT            PIC XX.
  6255         16  FILLER                      PIC X(35).
  6256         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6257         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6258
  6259     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6260         16  AT-DENIAL-INFO-1            PIC X(60).
  6261         16  AT-DENIAL-INFO-2            PIC X(60).
  6262         16  AT-DENIAL-DT                PIC XX.
  6263         16  AT-RETRACTION-DT            PIC XX.
  6264         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6265*         16  FILLER                      PIC X(31).
  6266         16  AT-DENIAL-PROOF-DT          PIC XX.
  6267         16  FILLER                      PIC X(29).
  6268         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6269         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6270
  6271     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6272         16  AT-OLD-INCURRED-DT          PIC XX.
  6273         16  AT-OLD-REPORTED-DT          PIC XX.
  6274         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6275         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6276         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6277         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6278         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6279         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6280         16  FILLER                      PIC X(26).
  6281         16  AT-OLD-DIAG-CODE            PIC X(6).
  6282         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6283         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6284         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6285         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6286         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6287         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6288         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6289         16  FILLER                      PIC X(25).
  6290         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 120
* EL156.cbl
  6291
  6292     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6293         16  AT-FORM-SEND-ON-DT          PIC XX.
  6294         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6295         16  AT-FORM-RE-SEND-DT          PIC XX.
  6296         16  AT-FORM-ANSWERED-DT         PIC XX.
  6297         16  AT-FORM-PRINTED-DT          PIC XX.
  6298         16  AT-FORM-REPRINT-DT          PIC XX.
  6299         16  AT-FORM-TYPE                PIC X.
  6300             88  INITIAL-FORM                  VALUE '1'.
  6301             88  PROGRESS-FORM                 VALUE '2'.
  6302         16  AT-INSTRUCT-LN-1            PIC X(28).
  6303         16  AT-INSTRUCT-LN-2            PIC X(28).
  6304         16  AT-INSTRUCT-LN-3            PIC X(28).
  6305         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6306         16  AT-FORM-ADDRESS             PIC X.
  6307             88  FORM-TO-INSURED              VALUE 'I'.
  6308             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6309             88  FORM-TO-OTHER-1              VALUE 'O'.
  6310             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6311         16  AT-RELATED-1.
  6312             20 AT-REL-CARR-1            PIC X.
  6313             20 AT-REL-CLAIM-1           PIC X(7).
  6314             20 AT-REL-CERT-1            PIC X(11).
  6315         16  AT-RELATED-2.
  6316             20 AT-REL-CARR-2            PIC X.
  6317             20 AT-REL-CLAIM-2           PIC X(7).
  6318             20 AT-REL-CERT-2            PIC X(11).
  6319         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6320         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6321         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6322         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6323         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6324         16  AT-STOP-FORM-DT             PIC X(2).
  6325
  6326         16  FILLER                      PIC X(09).
  6327         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6328         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6329******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 121
* EL156.cbl
  6331*    COPY ELCACTQ.
  6332******************************************************************
  6333*                                                                *
  6334*                            ELCACTQ.                            *
  6335*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6336*                            VMOD=2.004                          *
  6337*                                                                *
  6338*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6339*                                                                *
  6340*   FILE TYPE = VSAM,KSDS                                        *
  6341*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6342*                                                                *
  6343*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6344*       ALTERNATE INDEX = NONE                                   *
  6345*                                                                *
  6346*   LOG = YES                                                    *
  6347*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6348*                                                                *
  6349*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6350******************************************************************
  6351
  6352 01  ACTIVITY-QUE.
  6353     12  AQ-RECORD-ID                PIC XX.
  6354         88  VALID-AQ-ID                VALUE 'AQ'.
  6355
  6356     12  AQ-CONTROL-PRIMARY.
  6357         16  AQ-COMPANY-CD           PIC X.
  6358         16  AQ-CARRIER              PIC X.
  6359         16  AQ-CLAIM-NO             PIC X(7).
  6360         16  AQ-CERT-NO.
  6361             20  AQ-CERT-PRIME       PIC X(10).
  6362             20  AQ-CERT-SFX         PIC X.
  6363
  6364     12  AQ-PENDING-ACTIVITY-FLAGS.
  6365         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6366         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6367             88  PENDING-PAYMENTS       VALUE '1'.
  6368         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6369             88  PENDING-FULL-PRINT     VALUE '1'.
  6370             88  PENDING-PART-PRINT     VALUE '2'.
  6371         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6372             88  PENDING-LETTERS        VALUE '1'.
  6373         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6374             88  PENDING-RESTORE        VALUE 'C'.
  6375             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6376
  6377     12  FILLER                      PIC X(20).
  6378
  6379     12  AQ-RESEND-DATE              PIC XX.
  6380     12  AQ-FOLLOWUP-DATE            PIC XX.
  6381     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6382     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6383     12  AQ-AUTO-LETTER              PIC X(4).
  6384     12  FILLER                      PIC XX.
  6385     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6386*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 122
* EL156.cbl
  6388*    COPY ERCACCT.
  6389******************************************************************
  6390*                                                                *
  6391*                                                                *
  6392*                            ERCACCT                             *
  6393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6394*                            VMOD=2.031                          *
  6395*                                                                *
  6396*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6397*                                                                *
  6398*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6399*   VSAM ACCOUNT MASTER FILES.                                   *
  6400*                                                                *
  6401*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6402*                                                                *
  6403*   FILE TYPE = VSAM,KSDS                                        *
  6404*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6405*                                                                *
  6406*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6407*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6408*                                                                *
  6409*   LOG = NO                                                     *
  6410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6411*                                                                *
  6412*                                                                *
  6413******************************************************************
  6414*                   C H A N G E   L O G
  6415*
  6416* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6417*-----------------------------------------------------------------
  6418*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6419* EFFECTIVE    NUMBER
  6420*-----------------------------------------------------------------
  6421* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6422* 092705    2005050300006  PEMA  ADD SPP LEASES
  6423* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6424* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6425* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6426* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6427* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6428******************************************************************
  6429
  6430 01  ACCOUNT-MASTER.
  6431     12  AM-RECORD-ID                      PIC XX.
  6432         88  VALID-AM-ID                      VALUE 'AM'.
  6433
  6434     12  AM-CONTROL-PRIMARY.
  6435         16  AM-COMPANY-CD                 PIC X.
  6436         16  AM-MSTR-CNTRL.
  6437             20  AM-CONTROL-A.
  6438                 24  AM-CARRIER            PIC X.
  6439                 24  AM-GROUPING.
  6440                     28 AM-GROUPING-PREFIX PIC XXX.
  6441                     28 AM-GROUPING-PRIME  PIC XXX.
  6442                 24  AM-STATE              PIC XX.
  6443                 24  AM-ACCOUNT.
  6444                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6445                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 123
* EL156.cbl
  6446             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6447                                           PIC X(19).
  6448             20  AM-CNTRL-B.
  6449                 24  AM-EXPIRATION-DT      PIC XX.
  6450                 24  FILLER                PIC X(4).
  6451             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6452                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6453
  6454     12  AM-CONTROL-BY-VAR-GRP.
  6455         16  AM-COMPANY-CD-A1              PIC X.
  6456         16  AM-VG-CARRIER                 PIC X.
  6457         16  AM-VG-GROUPING                PIC X(6).
  6458         16  AM-VG-STATE                   PIC XX.
  6459         16  AM-VG-ACCOUNT                 PIC X(10).
  6460         16  AM-VG-DATE.
  6461             20  AM-VG-EXPIRATION-DT       PIC XX.
  6462             20  FILLER                    PIC X(4).
  6463         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6464                                           PIC 9(11)      COMP-3.
  6465     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6466         16  FILLER                        PIC X(10).
  6467         16  AM-VG-KEY3.
  6468             20  AM-VG3-ACCOUNT            PIC X(10).
  6469             20  AM-VG3-EXP-DT             PIC XX.
  6470         16  FILLER                        PIC X(4).
  6471     12  AM-MAINT-INFORMATION.
  6472         16  AM-LAST-MAINT-DT              PIC XX.
  6473         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6474         16  AM-LAST-MAINT-USER            PIC X(4).
  6475         16  FILLER                        PIC XX.
  6476
  6477     12  AM-EFFECTIVE-DT                   PIC XX.
  6478     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6479
  6480     12  AM-PREV-DATES  COMP-3.
  6481         16  AM-PREV-EXP-DT                PIC 9(11).
  6482         16  AM-PREV-EFF-DT                PIC 9(11).
  6483
  6484     12  AM-REPORT-CODE-1                  PIC X(10).
  6485     12  AM-REPORT-CODE-2                  PIC X(10).
  6486
  6487     12  AM-CITY-CODE                      PIC X(4).
  6488     12  AM-COUNTY-PARISH                  PIC X(6).
  6489
  6490     12  AM-NAME                           PIC X(30).
  6491     12  AM-PERSON                         PIC X(30).
  6492     12  AM-ADDRS                          PIC X(30).
  6493     12  AM-CITY.
  6494         16  AM-ADDR-CITY                  PIC X(28).
  6495         16  AM-ADDR-STATE                 PIC XX.
  6496     12  AM-ZIP.
  6497         16  AM-ZIP-PRIME.
  6498             20  AM-ZIP-PRI-1ST            PIC X.
  6499                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6500             20  FILLER                    PIC X(4).
  6501         16  AM-ZIP-PLUS4                  PIC X(4).
  6502     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6503         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 124
* EL156.cbl
  6504         16  AM-CAN-POSTAL-2               PIC XXX.
  6505         16  FILLER                        PIC XXX.
  6506     12  AM-TEL-NO.
  6507         16  AM-AREA-CODE                  PIC 999.
  6508         16  AM-TEL-PRE                    PIC 999.
  6509         16  AM-TEL-NBR                    PIC 9(4).
  6510     12  AM-TEL-LOC                        PIC X.
  6511         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6512         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6513
  6514     12  AM-COMM-STRUCTURE.
  6515         16  AM-DEFN-1.
  6516             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6517                 24  AM-AGT.
  6518                     28  AM-AGT-PREFIX     PIC X(4).
  6519                     28  AM-AGT-PRIME      PIC X(6).
  6520                 24  AM-COM-TYP            PIC X.
  6521                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6522                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6523                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6524                 24  AM-RECALC-LV-INDIC    PIC X.
  6525                 24  AM-RETRO-LV-INDIC     PIC X.
  6526                 24  AM-GL-CODES           PIC X.
  6527                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6528                 24  FILLER                PIC X(01).
  6529         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6530             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6531                 24  FILLER                PIC X(11).
  6532                 24  AM-L-COMA             PIC XXX.
  6533                 24  AM-J-COMA             PIC XXX.
  6534                 24  AM-A-COMA             PIC XXX.
  6535                 24  FILLER                PIC X(6).
  6536
  6537     12  AM-COMM-CHANGE-STATUS             PIC X.
  6538         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6539
  6540     12  AM-CSR-CODE                       PIC X(4).
  6541
  6542     12  AM-BILLING-STATUS                 PIC X.
  6543         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6544         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6545     12  AM-AUTO-REFUND-SW                 PIC X.
  6546         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6547         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6548     12  AM-GPCD                           PIC 99.
  6549     12  AM-IG                             PIC X.
  6550         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6551         88  AM-HAS-GROUP                     VALUE '2'.
  6552     12  AM-STATUS                         PIC X.
  6553         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6554         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6555         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6556         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6557         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6558         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6559     12  AM-REMIT-TO                       PIC 99.
  6560     12  AM-ID-NO                          PIC X(11).
  6561
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 125
* EL156.cbl
  6562     12  AM-CAL-TABLE                      PIC XX.
  6563     12  AM-LF-DEVIATION                   PIC XXX.
  6564     12  AM-AH-DEVIATION                   PIC XXX.
  6565     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6566     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6567     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6568     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6569     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6570     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6571
  6572     12  AM-USER-FIELDS.
  6573         16  AM-FLD-1                      PIC XX.
  6574         16  AM-FLD-2                      PIC XX.
  6575         16  AM-FLD-3                      PIC XX.
  6576         16  AM-FLD-4                      PIC XX.
  6577         16  AM-FLD-5                      PIC XX.
  6578
  6579     12  AM-1ST-PROD-DATE.
  6580         16  AM-1ST-PROD-YR                PIC XX.
  6581         16  AM-1ST-PROD-MO                PIC XX.
  6582         16  AM-1ST-PROD-DA                PIC XX.
  6583     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6584     12  AM-CERTS-PURGED-DATE.
  6585         16  AM-PUR-YR                     PIC XX.
  6586         16  AM-PUR-MO                     PIC XX.
  6587         16  AM-PUR-DA                     PIC XX.
  6588     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6589     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6590     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6591     12  AM-INACTIVE-DATE.
  6592         16  AM-INA-MO                     PIC 99.
  6593         16  AM-INA-DA                     PIC 99.
  6594         16  AM-INA-YR                     PIC 99.
  6595     12  AM-AR-HI-CERT-DATE                PIC XX.
  6596
  6597     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6598     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6599
  6600     12  AM-OB-PAYMENT-MODE                PIC X.
  6601         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6602         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6603         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6604         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6605
  6606     12  AM-AH-ONLY-INDICATOR              PIC X.
  6607         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6608         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6609
  6610     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6611
  6612     12  AM-OVER-SHORT.
  6613         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6614         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6615
  6616     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6617     12  AM-DCC-CLP-STATE                  PIC XX.
  6618
  6619     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 126
* EL156.cbl
  6620     12  AM-RECALC-REIN                    PIC X.
  6621
  6622     12  AM-REI-TABLE                      PIC XXX.
  6623     12  AM-REI-ET-LF                      PIC X.
  6624     12  AM-REI-ET-AH                      PIC X.
  6625     12  AM-REI-PE-LF                      PIC X.
  6626     12  AM-REI-PE-AH                      PIC X.
  6627     12  AM-REI-PRT-ST                     PIC X.
  6628     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6629     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6630     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6631     12  AM-REI-GROUP-A                    PIC X(6).
  6632     12  AM-REI-MORT                       PIC X(4).
  6633     12  AM-REI-PRT-OW                     PIC X.
  6634     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6635     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6636     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6637     12  AM-REI-GROUP-B                    PIC X(6).
  6638
  6639     12  AM-TRUST-TYPE                     PIC X(2).
  6640
  6641     12  AM-EMPLOYER-STMT-USED             PIC X.
  6642     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6643
  6644     12  AM-STD-AH-TYPE                    PIC XX.
  6645     12  AM-EARN-METHODS.
  6646         16  AM-EARN-METHOD-R              PIC X.
  6647             88 AM-REF-RL-R78                 VALUE 'R'.
  6648             88 AM-REF-RL-PR                  VALUE 'P'.
  6649             88 AM-REF-RL-MEAN                VALUE 'M'.
  6650             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6651         16  AM-EARN-METHOD-L              PIC X.
  6652             88 AM-REF-LL-R78                 VALUE 'R'.
  6653             88 AM-REF-LL-PR                  VALUE 'P'.
  6654             88 AM-REF-LL-MEAN                VALUE 'M'.
  6655             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6656         16  AM-EARN-METHOD-A              PIC X.
  6657             88 AM-REF-AH-R78                 VALUE 'R'.
  6658             88 AM-REF-AH-PR                  VALUE 'P'.
  6659             88 AM-REF-AH-MEAN                VALUE 'M'.
  6660             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6661             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6662             88 AM-REF-AH-NET                 VALUE 'N'.
  6663
  6664     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6665     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6666     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6667
  6668     12  AM-RET-Y-N                        PIC X.
  6669     12  AM-RET-P-E                        PIC X.
  6670     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6671     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6672     12  AM-RET-GRP                        PIC X(6).
  6673     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6674         16  AM-POOL-PRIME                 PIC XXX.
  6675         16  AM-POOL-SUB                   PIC XXX.
  6676     12  AM-RETRO-EARNINGS.
  6677         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 127
* EL156.cbl
  6678         16  AM-RET-EARN-L                 PIC X.
  6679         16  AM-RET-EARN-A                 PIC X.
  6680     12  AM-RET-ST-TAX-USE                 PIC X.
  6681         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6682         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6683     12  AM-RETRO-BEG-EARNINGS.
  6684         16  AM-RET-BEG-EARN-R             PIC X.
  6685         16  AM-RET-BEG-EARN-L             PIC X.
  6686         16  AM-RET-BEG-EARN-A             PIC X.
  6687     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6688     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6689
  6690     12  AM-USER-SELECT-OPTIONS.
  6691         16  AM-USER-SELECT-1              PIC X(10).
  6692         16  AM-USER-SELECT-2              PIC X(10).
  6693         16  AM-USER-SELECT-3              PIC X(10).
  6694         16  AM-USER-SELECT-4              PIC X(10).
  6695         16  AM-USER-SELECT-5              PIC X(10).
  6696
  6697     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6698
  6699     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6700
  6701     12  AM-RPT045A-SWITCH                 PIC X.
  6702         88  RPT045A-OFF                   VALUE 'N'.
  6703
  6704     12  AM-INSURANCE-LIMITS.
  6705         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6706         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6707
  6708     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6709         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6710
  6711     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6712         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6713         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6714
  6715     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6716
  6717     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6718     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6719     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6720     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6721     12  AM-DCC-UEF-STATE                  PIC XX.
  6722     12  FILLER                            PIC XXX.
  6723     12  AM-REPORT-CODE-3                  PIC X(10).
  6724*    12  FILLER                            PIC X(22).
  6725
  6726     12  AM-RESERVE-DATE.
  6727         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6728         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6729         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6730
  6731     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6732     12  AM-NOTIFICATION-TYPES.
  6733         16  AM-NOTIF-OF-LETTERS           PIC X.
  6734         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6735         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 128
* EL156.cbl
  6736         16  AM-NOTIF-OF-STATUS            PIC X.
  6737
  6738     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6739         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6740         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6741         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6742         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6743
  6744     12  AM-BENEFIT-CONTROLS.
  6745         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6746             20  AM-BENEFIT-CODE           PIC XX.
  6747             20  AM-BENEFIT-TYPE           PIC X.
  6748             20  AM-BENEFIT-REVISION       PIC XXX.
  6749             20  AM-BENEFIT-REM-TERM       PIC X.
  6750             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6751             20  FILLER                    PIC XX.
  6752         16  FILLER                        PIC X(80).
  6753
  6754     12  AM-TRANSFER-DATA.
  6755         16  AM-TRANSFERRED-FROM.
  6756             20  AM-TRNFROM-CARRIER        PIC X.
  6757             20  AM-TRNFROM-GROUPING.
  6758                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6759                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6760             20  AM-TRNFROM-STATE          PIC XX.
  6761             20  AM-TRNFROM-ACCOUNT.
  6762                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6763                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6764             20  AM-TRNFROM-DTE            PIC XX.
  6765         16  AM-TRANSFERRED-TO.
  6766             20  AM-TRNTO-CARRIER          PIC X.
  6767             20  AM-TRNTO-GROUPING.
  6768                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6769                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6770             20  AM-TRNTO-STATE            PIC XX.
  6771             20  AM-TRNTO-ACCOUNT.
  6772                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6773                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6774             20  AM-TRNTO-DTE              PIC XX.
  6775         16  FILLER                        PIC X(10).
  6776
  6777     12  AM-SAVED-REMIT-TO                 PIC 99.
  6778
  6779     12  AM-COMM-STRUCTURE-SAVED.
  6780         16  AM-DEFN-1-SAVED.
  6781             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6782                 24  AM-AGT-SV             PIC X(10).
  6783                 24  AM-COM-TYP-SV         PIC X.
  6784                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6785                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6786                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6787                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6788                 24  FILLER                PIC X.
  6789                 24  AM-GL-CODES-SV        PIC X.
  6790                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6791                 24  FILLER                PIC X.
  6792         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6793             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 129
* EL156.cbl
  6794                 24  FILLER                PIC X(11).
  6795                 24  AM-L-COMA-SV          PIC XXX.
  6796                 24  AM-J-COMA-SV          PIC XXX.
  6797                 24  AM-A-COMA-SV          PIC XXX.
  6798                 24  FILLER                PIC X(6).
  6799
  6800     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6801         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6802            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6803            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6804            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6805
  6806     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6807     12  FILLER                            PIC X(120).
  6808
  6809     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6810         16  AM-CONTROL-NAME               PIC X(30).
  6811         16  AM-EXECUTIVE-ONE.
  6812             20  AM-EXEC1-NAME             PIC X(15).
  6813             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6814                                                          COMP-3.
  6815             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6816                                                          COMP-3.
  6817         16  AM-EXECUTIVE-TWO.
  6818             20  AM-EXEC2-NAME             PIC X(15).
  6819             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6820                                                          COMP-3.
  6821             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6822                                                          COMP-3.
  6823
  6824     12  AM-RETRO-ADDITIONAL-DATA.
  6825         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6826         16  AM-RETRO-PREM-P-E             PIC X.
  6827         16  AM-RETRO-CLMS-P-I             PIC X.
  6828         16  AM-RETRO-RET-BRACKET-LF.
  6829             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6830                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6831                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6832             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6833                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6834                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6835             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6836                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6837                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6838         16  AM-RETRO-RET-BRACKET-AH.
  6839             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6840                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6841                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6842                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6843             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6844                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6845                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6846             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6847                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6848                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6849
  6850     12  AM-COMMENTS.
  6851         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 130
* EL156.cbl
  6852
  6853     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6854         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6855         16  AM-FLI-BILLING-CODE           PIC X.
  6856         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6857         16  AM-FLI-UNITED-IDENT           PIC X.
  6858         16  AM-FLI-INTEREST-LOST-DATA.
  6859             20  AM-FLI-BANK-NO            PIC X(5).
  6860             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6861             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6862             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6863         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6864             20  AM-FLI-AGT                PIC X(9).
  6865             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6866             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6867         16  FILLER                        PIC X(102).
  6868
  6869     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6870         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6871             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6872             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6873             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6874             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6875             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6876         16  FILLER                          PIC X(10).
  6877******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 131
* EL156.cbl
  6879*    COPY ELCCHKQ.
  6880******************************************************************
  6881*                                                                *
  6882*                                                                *
  6883*                            ELCCHKQ.                            *
  6884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6885*                            VMOD=2.007                          *
  6886*                                                                *
  6887*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6888*                                                                *
  6889*   FILE TYPE = VSAM,KSDS                                        *
  6890*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6891*                                                                *
  6892*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6893*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6894*                                                                *
  6895*   LOG = YES                                                    *
  6896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6897******************************************************************
  6898 01  CHECK-QUE.
  6899     12  CQ-RECORD-ID                PIC XX.
  6900         88  VALID-CQ-ID         VALUE 'CQ'.
  6901
  6902     12  CQ-CONTROL-PRIMARY.
  6903         16  CQ-COMPANY-CD           PIC X.
  6904         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6905         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6906
  6907     12  CQ-CONTROL-BY-PAYEE.
  6908         16  CQ-CONTROL-BY-NUMBER.
  6909             20  CQ-COMPANY-CD-A1     PIC X.
  6910             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6911         16  CQ-PAYEE-CARRIER        PIC X.
  6912         16  CQ-PAYEE-GROUPING       PIC X(6).
  6913         16  CQ-PAYEE-STATE          PIC XX.
  6914         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6915         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6916
  6917     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6918         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6919         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6920         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6921         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6922         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6923         16  FILLER                  PIC X(3).
  6924
  6925     12  CQ-ENTRY-TYPE               PIC X.
  6926             88  CHECK-ON-QUE           VALUE 'Q'.
  6927             88  ALIGNMENT-CHECK        VALUE 'A'.
  6928             88  SPOILED-CHECK          VALUE 'S'.
  6929             88  PAYMENT-ABORTED        VALUE 'X'.
  6930
  6931     12  CQ-CLAIM-MAST-CNTL.
  6932         16  CQ-CARRIER              PIC X.
  6933         16  CQ-CLAIM-NO             PIC X(7).
  6934         16  CQ-CERT-NO.
  6935             20  CQ-CERT-PRIME       PIC X(10).
  6936             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 132
* EL156.cbl
  6937         16  CQ-CLAIM-TYPE           PIC X.
  6938             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6939             88  CQ-AH-CLAIM            VALUE 'A'.
  6940         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6941             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6942             88  CQ-O-B-COVERAGE        VALUE '2'.
  6943             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6944
  6945     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6946     12  CQ-CHECK-NUMBER             PIC X(7).
  6947     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6948     12  CQ-PAYMENT-TYPE             PIC X.
  6949             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6950             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6951             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6952             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6953             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6954             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6955             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6956             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6957     12  CQ-VOID-INDICATOR           PIC X.
  6958             88  CHECK-IS-STOPPED          VALUE 'S'.
  6959             88  CHECK-IS-VOID             VALUE 'V'.
  6960     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6961     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6962     12  CQ-CHECK-BY-USER            PIC X(4).
  6963     12  CQ-PRE-NUMBERING-SW         PIC X.
  6964       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6965       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6966
  6967     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6968     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6969     12  CQ-LEDGER-FLAG              PIC X(01).
  6970     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6971     12  CQ-LAST-UPDATED-DT          PIC XX.
  6972     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6973     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6974
  6975     12  FILLER                      PIC X(04).
  6976
  6977******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 133
* EL156.cbl
  6979*    COPY ELCBENE.
  6980******************************************************************
  6981*                                                                *
  6982*                            ELCBENE.                            *
  6983*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6984*                            VMOD=2.006                          *
  6985*                                                                *
  6986*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6987*                                                                *
  6988*   FILE TYPE = VSAM,KSDS                                        *
  6989*   RECORD SIZE = 500   RECFORM = FIX                            *
  6990*                                                                *
  6991*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6992*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6993*                                                                *
  6994*   LOG = YES                                                    *
  6995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6996*                                                                *
  6997*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6998******************************************************************
  6999
  7000 01  BENEFICIARY-MASTER.
  7001     12  BE-RECORD-ID                PIC XX.
  7002         88  VALID-BE-ID                VALUE 'BE'.
  7003
  7004     12  BE-CONTROL-PRIMARY.
  7005         16  BE-COMPANY-CD           PIC X.
  7006         16  BE-RECORD-TYPE          PIC X.
  7007             88  BENEFICIARY-RECORD  VALUE 'B'.
  7008             88  ADJUSTOR-RECORD     VALUE 'A'.
  7009         16  BE-BENEFICIARY          PIC X(10).
  7010     12  BE-CONTROL-BY-NAME.
  7011         16  BE-COMPANY-CD-A1        PIC X.
  7012         16  BE-RECORD-TYPE-A1       PIC X.
  7013         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7014         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7015
  7016     12  BE-LAST-MAINT-DT            PIC XX.
  7017     12  BE-LAST-MAINT-BY            PIC X(4).
  7018     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7019
  7020     12  BE-ADDRESS-DATA.
  7021         16  BE-MAIL-TO-NAME         PIC X(30).
  7022         16  BE-ADDRESS-LINE-1       PIC X(30).
  7023         16  BE-ADDRESS-LINE-2       PIC X(30).
  7024         16  BE-ADDRESS-LINE-3       PIC X(30).
  7025         16  BE-CITY-STATE.
  7026             20  BE-CITY             PIC X(28).
  7027             20  BE-STATE            PIC XX.
  7028         16  BE-ZIP-CODE.
  7029             20  BE-ZIP-PRIME.
  7030                 24  BE-ZIP-1ST      PIC X.
  7031                     88  BE-CANADIAN-POST-CODE
  7032                                         VALUE 'A' THRU 'Z'.
  7033                 24  FILLER          PIC X(4).
  7034             20  BE-ZIP-PLUS4        PIC X(4).
  7035         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7036             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 134
* EL156.cbl
  7037             20  BE-CAN-POSTAL-2     PIC XXX.
  7038             20  FILLER              PIC XXX.
  7039         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7040         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7041
  7042******************************************************************
  7043*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7044*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7045******************************************************************
  7046     12  BE-CARRIER                  PIC X.
  7047
  7048     12  BE-ADDRESS-DATA2.
  7049         16  BE-MAIL-TO-NAME2        PIC X(30).
  7050         16  BE-ADDRESS-LINE-12      PIC X(30).
  7051         16  BE-ADDRESS-LINE-22      PIC X(30).
  7052         16  BE-ADDRESS-LINE-32      PIC X(30).
  7053         16  BE-CITY-STATE2.
  7054             20  BE-CITY2            PIC X(28).
  7055             20  BE-STATE2           PIC XX.
  7056         16  BE-ZIP-CODE2.
  7057             20  BE-ZIP-PRIME2.
  7058                 24  BE-ZIP-1ST2     PIC X.
  7059                     88  BE-CANADIAN-POST-CODE2
  7060                                         VALUE 'A' THRU 'Z'.
  7061                 24  FILLER          PIC X(4).
  7062             20  BE-ZIP-PLUS42       PIC X(4).
  7063         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7064             20  BE-CAN-POSTAL-12    PIC XXX.
  7065             20  BE-CAN-POSTAL-22    PIC XXX.
  7066             20  FILLER              PIC XXX.
  7067         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7068         16  BE-BILLING-STMT-DATA.
  7069             20  BE-BSR              PIC X.
  7070                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7071                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7072             20  BE-BSR-FROM         PIC X(30).
  7073             20  BE-BSR-DEPT         PIC X(30).
  7074             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7075             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7076             20  BE-OUTPUT-TYPE      PIC X.
  7077                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7078                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7079
  7080     12  FILLER                      PIC X(28).
  7081******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 135
* EL156.cbl
  7083*    COPY ELCARCH.
  7084******************************************************************
  7085*                                                                *
  7086*                            ELCARCH.                            *
  7087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7088*                            VMOD=2.007                          *
  7089*                                                                *
  7090*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7091*                                                                *
  7092*   FILE TYPE = VSAM,KSDS                                        *
  7093*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7094*                                                                *
  7095*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7096*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7097*                                                                *
  7098*   LOG = NO                                                     *
  7099*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7100*                                                                *
  7101*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7102******************************************************************
  7103 01  LETTER-ARCHIVE.
  7104     12  LA-RECORD-ID                PIC XX.
  7105         88  VALID-LA-ID                VALUE 'LA'.
  7106
  7107     12  LA-CONTROL-PRIMARY.
  7108         16  LA-COMPANY-CD           PIC X.
  7109         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7110         16  LA-RECORD-TYPE          PIC X.
  7111             88  LA-HEADER-DATA         VALUE '1'.
  7112             88  LA-ADDRESS-DATA        VALUE '2'.
  7113             88  LA-TEXT-DATA           VALUE '3'.
  7114             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7115         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7116
  7117     12  LA-CONTROL-BY-TYPE.
  7118         16  LA-COMPANY-CD-A1        PIC X.
  7119         16  LA-RECORD-TYPE-A1       PIC X.
  7120         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7121         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7122
  7123     12  LA-TEXT-RECORD.
  7124         16  LA-SKIP-CONTROL         PIC XX.
  7125             88  NO-LINES-SKIPPED       VALUE SPACES.
  7126             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7127         16  LA-TEXT-LINE            PIC X(70).
  7128
  7129     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7130         16  FILLER                  PIC XX.
  7131         16  LA-ADDRESS-LINE         PIC X(30).
  7132         16  FILLER                  PIC X(40).
  7133
  7134     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7135         16  FILLER                  PIC XX.
  7136         16  LA-CARRIER              PIC X.
  7137         16  LA-CLAIM-NO             PIC X(7).
  7138         16  LA-CERT-NO.
  7139             20  LA-CERT-PRIME       PIC X(10).
  7140             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 136
* EL156.cbl
  7141         16  LA-NO-OF-COPIES         PIC S9.
  7142         16  LA-RESEND-DATE          PIC XX.
  7143         16  LA-PROCESSOR-CD         PIC X(4).
  7144         16  LA-CREATION-DT          PIC XX.
  7145         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7146         16  LA-RESEND-PRINT-DATE    PIC XX.
  7147         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7148         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7149*
  7150* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7151*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7152*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7153*   I        20  LA-DMD-RES-ST           PIC XX.
  7154*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7155*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7156*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7157*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7158*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7159*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7160*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7161*   I        20  LA-DMD-UND-CODE         PIC XX.
  7162*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7163*   V    16  FILLER                  PIC X(15).
  7164* -----
  7165*
  7166* REINSERTED  CSO  MODS
  7167*
  7168         16  FILLER.
  7169             20  FILLER                  PIC X(29).
  7170             20  LA-CSO-LETTER-STATUS    PIC X.
  7171                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7172                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7173                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7174             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7175             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7176*
  7177
  7178     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7179         16  FILLER                  PIC XX.
  7180         16  LA4-CARRIER             PIC X.
  7181         16  LA4-CLAIM-NO            PIC X(7).
  7182         16  LA4-CERT-NO.
  7183             20  LA4-CERT-PRIME      PIC X(10).
  7184             20  LA4-CERT-SFX        PIC X.
  7185         16  LA4-NO-OF-COPIES        PIC S9.
  7186         16  LA4-RESEND-DATE         PIC XX.
  7187         16  LA4-PROCESSOR-CD        PIC X(4).
  7188         16  LA4-CREATION-DT         PIC XX.
  7189         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7190         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7191         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7192         16  LA4-FORM-TYPE           PIC X.
  7193             88  LA4-INITIAL-FORM    VALUE '1'.
  7194             88  LA4-PROGRESS-FORM   VALUE '2'.
  7195         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7196         16  LA4-STATE               PIC X(02).
  7197         16  FILLER                  PIC X(31).
  7198******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 137
* EL156.cbl
  7200*    COPY ELCDAR.
  7201******************************************************************
  7202*                                                                *
  7203*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7204*   FILE TYPE = VSAM,KSDS                                        *
  7205*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7206*   BASE CLUSTER = DLYACTV                                       *
  7207*   LOG = YES                                                    *
  7208*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7209*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7210*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7211*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7212*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7213*               BY PROGRAM "LGINFCE".                            *
  7214*                                                                *
  7215******************************************************************
  7216 01  DAILY-ACTIVITY-RECORD.
  7217     05  DA-KEY.
  7218         10  DA-COMP-CD          PIC X.
  7219         10  DA-CARRIER          PIC X.
  7220         10  DA-CLAIM-NO         PIC X(7).
  7221         10  DA-CERT-NO.
  7222             15  DA-CERT-PRIME   PIC X(10).
  7223             15  DA-CERT-SFX     PIC X.
  7224     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7225     05  DA-RECORD-TYPE          PIC X.
  7226     05  FILLER                  PIC X(2).
  7227******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 138
* EL156.cbl
  7229*    COPY ERCCOMP.
  7230******************************************************************
  7231*                                                                *
  7232*                                                                *
  7233*                            ERCCOMP                             *
  7234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7235*                            VMOD=2.019                          *
  7236*                                                                *
  7237*   ONLINE CREDIT SYSTEM                                         *
  7238*                                                                *
  7239*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7240*                                                                *
  7241*   FILE TYPE = VSAM,KSDS                                        *
  7242*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7243*                                                                *
  7244*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7245*       ALTERNATE PATH = NONE                                    *
  7246*                                                                *
  7247*   LOG = NO                                                     *
  7248*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7249*                                                                *
  7250******************************************************************
  7251*                   C H A N G E   L O G
  7252*
  7253* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7254*-----------------------------------------------------------------
  7255*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7256* EFFECTIVE    NUMBER
  7257*-----------------------------------------------------------------
  7258* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7259* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7260* 092205    2005050300006  PEMA  ADD LEASE FEE
  7261* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7262* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7263* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7264* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7265* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7266* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7267******************************************************************
  7268
  7269 01  COMPENSATION-MASTER.
  7270     12  CO-RECORD-ID                          PIC XX.
  7271         88  VALID-CO-ID                          VALUE 'CO'.
  7272
  7273     12  CO-CONTROL-PRIMARY.
  7274         16  CO-COMPANY-CD                     PIC X.
  7275         16  CO-CONTROL.
  7276             20  CO-CTL-1.
  7277                 24  CO-CARR-GROUP.
  7278                     28  CO-CARRIER            PIC X.
  7279                     28  CO-GROUPING.
  7280                         32  CO-GROUP-PREFIX   PIC XXX.
  7281                         32  CO-GROUP-PRIME    PIC XXX.
  7282                 24  CO-RESP-NO.
  7283                     28  CO-RESP-PREFIX        PIC X(4).
  7284                     28  CO-RESP-PRIME         PIC X(6).
  7285             20  CO-CTL-2.
  7286                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 139
* EL156.cbl
  7287                     28  CO-ACCT-PREFIX        PIC X(4).
  7288                     28  CO-ACCT-PRIME         PIC X(6).
  7289         16  CO-TYPE                           PIC X.
  7290             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7291             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7292             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7293
  7294     12  CO-MAINT-INFORMATION.
  7295         16  CO-LAST-MAINT-DT                  PIC XX.
  7296         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7297         16  CO-LAST-MAINT-USER                PIC X(4).
  7298     12  FILLER                                PIC XX.
  7299     12  CO-STMT-TYPE                          PIC XXX.
  7300     12  CO-COMP-TYPE                          PIC X.
  7301         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7302     12  CO-STMT-OWNER                         PIC X(4).
  7303     12  CO-BALANCE-CONTROL                    PIC X.
  7304         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7305         88  CO-NO-BALANCE                        VALUE 'N'.
  7306
  7307     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7308         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7309         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7310         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7311
  7312     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7313         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7314         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7315
  7316     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7317     12  CO-GA-DIRECT-DEP                      PIC X.
  7318     12  CO-FUTURE-SPACE                       PIC X.
  7319         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7320
  7321     12  CO-ACCT-NAME                          PIC X(30).
  7322     12  CO-MAIL-NAME                          PIC X(30).
  7323     12  CO-ADDR-1                             PIC X(30).
  7324     12  CO-ADDR-2                             PIC X(30).
  7325     12  CO-ADDR-3.
  7326         16  CO-ADDR-CITY                      PIC X(27).
  7327         16  CO-ADDR-STATE                     PIC XX.
  7328     12  CO-CSO-1099                           PIC X.
  7329     12  CO-ZIP.
  7330         16  CO-ZIP-PRIME.
  7331             20  CO-ZIP-PRI-1ST                PIC X.
  7332                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7333             20  FILLER                        PIC X(4).
  7334         16  CO-ZIP-PLUS4                      PIC X(4).
  7335     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7336         16  CO-CAN-POSTAL-1                   PIC XXX.
  7337         16  CO-CAN-POSTAL-2                   PIC XXX.
  7338         16  FILLER                            PIC XXX.
  7339     12  CO-SOC-SEC                            PIC X(13).
  7340     12  CO-TELEPHONE.
  7341         16  CO-AREA-CODE                      PIC XXX.
  7342         16  CO-PREFIX                         PIC XXX.
  7343         16  CO-PHONE                          PIC X(4).
  7344
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 140
* EL156.cbl
  7345     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7346
  7347     12  CO-AR-BAL-LEVEL                       PIC X.
  7348         88  CO-AR-REF-LVL                        VALUE '1'.
  7349         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7350         88  CO-AR-BILL-LVL                       VALUE '2'.
  7351         88  CO-AR-AGT-LVL                        VALUE '3'.
  7352         88  CO-AR-FR-LVL                         VALUE '4'.
  7353
  7354     12  CO-AR-NORMAL-PRINT                    PIC X.
  7355         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7356         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7357
  7358     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7359
  7360     12  CO-AR-REPORTING                       PIC X.
  7361         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7362         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7363
  7364     12  CO-AR-PULL-CHECK                      PIC X.
  7365         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7366         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7367
  7368     12  CO-AR-BALANCE-PRINT                   PIC X.
  7369         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7370
  7371     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7372         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7373         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7374         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7375
  7376     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7377
  7378     12  CO-USER-CODE                          PIC X.
  7379     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7380
  7381******************************************************************
  7382*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7383*    THE LAST MONTH END RUN.
  7384******************************************************************
  7385
  7386     12  CO-LAST-ACTIVITY-DATE.
  7387         16  CO-ACT-YEAR                       PIC 99.
  7388         16  CO-ACT-MONTH                      PIC 99.
  7389         16  CO-ACT-DAY                        PIC 99.
  7390
  7391     12  CO-LAST-STMT-DT.
  7392         16  CO-LAST-STMT-YEAR                 PIC 99.
  7393         16  CO-LAST-STMT-MONTH                PIC 99.
  7394         16  CO-LAST-STMT-DAY                  PIC 99.
  7395
  7396     12  CO-MO-END-TOTALS.
  7397         16  CO-MONTHLY-TOTALS.
  7398             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7399             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7400             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7401             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7402             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 141
* EL156.cbl
  7403
  7404         16  CO-AGING-TOTALS.
  7405             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7406             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7407             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7408             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7409
  7410         16  CO-YTD-TOTALS.
  7411             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7412             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7413
  7414         16  CO-OVER-UNDER-TOTALS.
  7415             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7416             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7417
  7418     12  CO-MISCELLANEOUS-TOTALS.
  7419         16  CO-FICA-TOTALS.
  7420             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7421             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7422
  7423         16  CO-CLAIM-TOTALS.
  7424             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7425             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7426
  7427******************************************************************
  7428*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7429*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7430******************************************************************
  7431
  7432     12  CO-CURRENT-TOTALS.
  7433         16  CO-CURRENT-LAST-STMT-DT.
  7434             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7435             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7436             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7437
  7438         16  CO-CURRENT-MONTHLY-TOTALS.
  7439             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7440             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7441             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7442             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7443             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7444
  7445         16  CO-CURRENT-AGING-TOTALS.
  7446             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7447             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7448             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7449             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7450
  7451         16  CO-CURRENT-YTD-TOTALS.
  7452             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7453             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7454
  7455     12  CO-PAID-COMM-TOTALS.
  7456         16  CO-YTD-PAID-COMMS.
  7457             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7458             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7459
  7460     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 142
* EL156.cbl
  7461         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7462         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7463
  7464     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7465         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7466         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7467         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7468         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7469         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7470         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7471         88  CO-FINAL-LETTER                  VALUE 'F'.
  7472         88  CO-RECONCILING                   VALUE 'R'.
  7473         88  CO-PHONE-CALL                    VALUE 'P'.
  7474         88  CO-LEGAL                         VALUE 'L'.
  7475         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7476         88  CO-WRITE-OFF                     VALUE 'W'.
  7477         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7478
  7479     12  CO-CSR-CODE                       PIC X(4).
  7480
  7481     12  CO-GA-STATUS-INFO.
  7482         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7483         16  CO-GA-TERMINATION-DT          PIC XX.
  7484         16  CO-GA-STATUS-CODE             PIC X.
  7485             88  CO-GA-ACTIVE                 VALUE 'A'.
  7486             88  CO-GA-INACTIVE               VALUE 'I'.
  7487             88  CO-GA-PENDING                VALUE 'P'.
  7488         16  CO-GA-COMMENTS.
  7489             20  CO-GA-COMMENT-1           PIC X(40).
  7490             20  CO-GA-COMMENT-2           PIC X(40).
  7491             20  CO-GA-COMMENT-3           PIC X(40).
  7492             20  CO-GA-COMMENT-4           PIC X(40).
  7493
  7494     12  CO-RPTCD2                         PIC X(10).
  7495     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7496         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7497         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7498
  7499     12  CO-TYPE-AGENT                     PIC X(01).
  7500         88  CO-CORPORATION                   VALUE 'C'.
  7501         88  CO-PARTNERSHIP                   VALUE 'P'.
  7502         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7503         88  CO-TRUST                         VALUE 'T'.
  7504         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7505
  7506     12  CO-FAXNO.
  7507         16  CO-FAX-AREA-CODE                  PIC XXX.
  7508         16  CO-FAX-PREFIX                     PIC XXX.
  7509         16  CO-FAX-PHONE                      PIC X(4).
  7510
  7511     12  CO-BANK-INFORMATION.
  7512         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7513         16  CO-BANK-TRANSIT-NON REDEFINES
  7514             CO-BANK-TRANSIT-NO                PIC 9(8).
  7515
  7516         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7517     12  CO-MISC-DEDUCT-INFO REDEFINES
  7518                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 143
* EL156.cbl
  7519         16  CO-MD-GL-ACCT                     PIC X(10).
  7520         16  CO-MD-DIV                         PIC XX.
  7521         16  CO-MD-CENTER                      PIC X(4).
  7522         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7523         16  CO-CREATE-AP-CHECK                PIC X.
  7524         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7525         16  FILLER                            PIC XXX.
  7526     12  CO-ACH-STATUS                         PIC X.
  7527         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7528         88  CO-ACH-PENDING                        VALUE 'P'.
  7529
  7530     12  CO-BILL-SW                            PIC X.
  7531     12  CO-CONTROL-NAME                       PIC X(30).
  7532     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7533     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7534     12  CO-CLP-STATE                          PIC XX.
  7535     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7536     12  CO-SPP-REFUND-EDIT                    PIC X.
  7537
  7538******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 144
* EL156.cbl
  7540*    COPY ERCDMDNT.
  7541******************************************************************
  7542*                                                                *
  7543*                            ERCDMDNT                            *
  7544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7545*                            VMOD=2.005                          *
  7546*                                                                *
  7547*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7548*                                                                *
  7549*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7550*                                                                *
  7551*        FILE TYPE= VSAM,KSDS                                    *
  7552*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7553*                                                                *
  7554*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7555*                                                                *
  7556*        LOG = YES                                               *
  7557*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7558*                                                                *
  7559******************************************************************
  7560
  7561 01  CERTIFICATE-NOTE.
  7562     12  CN-RECORD-ID                     PIC  XX.
  7563         88  VALID-CN-ID                      VALUE 'CN'.
  7564
  7565     12  CN-CONTROL-PRIMARY.
  7566         16  CN-COMPANY-CD                PIC X.
  7567         16  CN-CERT-KEY.
  7568             20  CN-CARRIER               PIC X.
  7569             20  CN-GROUPING.
  7570                 24  CN-GROUPING-PREFIX   PIC XXX.
  7571                 24  CN-GROUPING-PRIME    PIC XXX.
  7572             20  CN-STATE                 PIC XX.
  7573             20  CN-ACCOUNT.
  7574                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7575                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7576             20  CN-CERT-EFF-DT           PIC XX.
  7577             20  CN-CERT-NO.
  7578                 24  CN-CERT-PRIME        PIC X(10).
  7579                 24  CN-CERT-SFX          PIC X.
  7580
  7581     12  CN-BILLING-START-LINE-NO         PIC 99.
  7582     12  CN-BILLING-END-LINE-NO           PIC 99.
  7583
  7584     12  CN-LINES.
  7585         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7586
  7587     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7588         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7589         16  CN-CSI-GENERAL-DATA-AREA.
  7590             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7591
  7592         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7593             CN-CSI-GENERAL-DATA-AREA.
  7594             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7595             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7596             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7597             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 145
* EL156.cbl
  7598             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7599             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7600             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7601             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7602             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7603             20  FILLER                       PIC XX.
  7604             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7605             20  FILLER                       PIC X(38).
  7606
  7607         16  CN-CSI-PRODUCT-DATA-AREA.
  7608             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7609
  7610         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7611             CN-CSI-PRODUCT-DATA-AREA.
  7612             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7613             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7614             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7615             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7616             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7617             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7618             20  FILLER                   PIC XX.
  7619             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7620             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7621             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7622             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7623             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7624             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7625             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7626             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7627             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7628             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7629             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7630             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7631             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7632             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7633             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7634             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7635             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7636             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7637             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7638             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7639             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7640             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7641             20  FILLER                   PIC X(25).
  7642
  7643         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7644             CN-CSI-CREDIT-CARD-DATA.
  7645             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7646             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7647             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7648             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7649             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7650             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7651             20  FILLER                   PIC XX.
  7652             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7653             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7654             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7655             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 146
* EL156.cbl
  7656             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7657             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7658             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7659             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7660             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7661             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7662             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7663             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7664             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7665             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7666             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7667             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7668             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7669             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7670             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7671             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7672             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7673             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7674             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7675             20  FILLER                   PIC X(17).
  7676
  7677         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7678             CN-CSI-FAMILY-LEAVE-DATA.
  7679             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7680             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7681             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7682             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7683             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7684             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7685             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7686             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7687             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7688             20  CN-CSI-SL-INT-ON-PROCEEDS
  7689                                          PIC S9(5)V99  COMP-3.
  7690             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7691             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7692             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7693             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7694             20  CN-CSI-SL-POLICY-BENEFITS
  7695                                          PIC S9(5)V99  COMP-3.
  7696             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7697             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7698             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7699             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7700             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7701             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7702             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7703             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7704             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7705             20  CN-CSI-SL-STATE-NOT      PIC X.
  7706             20  FILLER                   PIC XX.
  7707
  7708         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7709             CN-CSI-SENIOR-LIFE-DATA.
  7710             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7711             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7712             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7713                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 147
* EL156.cbl
  7714             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7715             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7716             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7717             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7718             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7719             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7720             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7721             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7722             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7723             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7724             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7725             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7726             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7727             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7728             20  CN-CSI-PP-REPAIR         PIC X.
  7729             20  CN-CSI-PP-REPLACE        PIC X.
  7730             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7731             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7732             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7733             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7734             20  FILLER                   PIC X(5).
  7735
  7736         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7737             CN-CSI-PURCH-PROP-DATA.
  7738             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7739             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7740             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7741             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7742             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7743             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7744             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7745             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7746             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7747             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7748             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7749             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7750             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7751             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7752             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7753             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7754             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7755             20  CN-CSI-EW-REPLACE        PIC X.
  7756             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7757             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7758             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7759             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7760             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7761             20  FILLER                   PIC X(4).
  7762
  7763     12  CN-LAST-MAINT-DT                 PIC XX.
  7764     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7765     12  CN-LAST-MAINT-USER               PIC X(4).
  7766     12  FILLER                           PIC X(6).
  7767
  7768******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 148
* EL156.cbl
  7770*    COPY ERCCNOT.
  7771******************************************************************
  7772*                                                                *
  7773*                            ERCCNOT                             *
  7774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7775*                            VMOD=2.003                          *
  7776*                                                                *
  7777*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7778*                                                                *
  7779*        FILE TYPE= VSAM,KSDS                                    *
  7780*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7781*                                                                *
  7782*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7783*                                                                *
  7784*        LOG = YES                                               *
  7785*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7786*                                                                *
  7787******************************************************************
  7788*                   C H A N G E   L O G
  7789*
  7790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7791*-----------------------------------------------------------------
  7792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7793* EFFECTIVE    NUMBER
  7794*-----------------------------------------------------------------
  7795* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7796******************************************************************
  7797
  7798 01  CERT-NOTE-FILE.
  7799     12  CZ-RECORD-ID                PIC  XX.
  7800         88  VALID-CZ-ID                  VALUE 'CZ'.
  7801
  7802     12  CZ-CONTROL-PRIMARY.
  7803         16  CZ-COMPANY-CD           PIC X.
  7804         16  CZ-CARRIER              PIC X.
  7805         16  CZ-GROUPING.
  7806             20 CZ-GROUPING-PREFIX   PIC XXX.
  7807             20 CZ-GROUPING-PRIME    PIC XXX.
  7808         16  CZ-STATE                PIC XX.
  7809         16  CZ-ACCOUNT.
  7810             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7811             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7812         16  CZ-CERT-EFF-DT          PIC XX.
  7813         16  CZ-CERT-NO.
  7814             20  CZ-CERT-PRIME       PIC X(10).
  7815             20  CZ-CERT-SFX         PIC X.
  7816         16  CZ-RECORD-TYPE          PIC X.
  7817             88  CERT-NOTE           VALUE '1'.
  7818             88  CLAIM-CERT-NOTE     VALUE '2'.
  7819         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7820
  7821     12  CZ-LAST-MAINT-DT            PIC XX.
  7822     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7823     12  CZ-LAST-MAINT-USER          PIC X(4).
  7824
  7825     12  CZ-NOTE-INFORMATION.
  7826         16  CZ-NOTE                 PIC X(63).
  7827         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 149
* EL156.cbl
  7828******************************************************************
  7829*                            COPY ERCPDEF.
  7830******************************************************************
  7831*                                                                *
  7832*                                                                *
  7833*                            ERCPDEF.                            *
  7834*                                                                *
  7835*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7836*                                                                *
  7837*    FILE TYPE = VSAM,KSDS                                       *
  7838*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7839*                                                                *
  7840*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7841*                                                                *
  7842*    LOG = YES                                                   *
  7843*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7844******************************************************************
  7845 01  PRODUCT-MASTER.
  7846    12  PD-RECORD-ID                 PIC X(02).
  7847        88  VALID-PD-ID                  VALUE 'PD'.
  7848    12  PD-CONTROL-PRIMARY.
  7849        16  PD-COMPANY-CD            PIC X.
  7850        16  PD-STATE                 PIC XX.
  7851        16  PD-PRODUCT-CD            PIC XXX.
  7852        16  PD-FILLER                PIC X(7).
  7853        16  PD-BEN-TYPE              PIC X.
  7854        16  PD-BEN-CODE              PIC XX.
  7855        16  PD-PROD-EXP-DT           PIC XX.
  7856    12  FILLER                       PIC X(50).
  7857    12  PD-PRODUCT-DATA OCCURS 8.
  7858        16  PD-PROD-CODE             PIC X.
  7859            88  PD-PROD-LIFE           VALUE 'L'.
  7860            88  PD-PROD-PROP           VALUE 'P'.
  7861            88  PD-PROD-AH             VALUE 'A'.
  7862            88  PD-PROD-IU             VALUE 'I'.
  7863            88  PD-PROD-GAP            VALUE 'G'.
  7864        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7865        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7866        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7867        16  PD-MAX-TERM              PIC S999        COMP-3.
  7868        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7869        16  FILLER                   PIC X.
  7870        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7871        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7872        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7873        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7874        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7875        16  PD-REC-CRIT-PERIOD       PIC X.
  7876        16  PD-RTW-MOS               PIC 99.
  7877        16  FILLER                   PIC X(5).
  7878    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7879    12  PD-TERM-LIMITS OCCURS 15.
  7880        16  PD-LOW-TERM              PIC S999        COMP-3.
  7881        16  PD-HI-TERM               PIC S999        COMP-3.
  7882*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7883    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7884        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7885        16  PD-HI-AMT                PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 150
* EL156.cbl
  7886    12  PD-EARN-FACTORS.
  7887        16  FILLER OCCURS 15.
  7888            20  FILLER OCCURS 15.
  7889                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7890    12  PD-PRODUCT-DESC              PIC X(80).
  7891    12  PD-TRUNCATED                 PIC X.
  7892    12  FILLER                       PIC X(59).
  7893    12  PD-MAINT-INFORMATION.
  7894        16  PD-LAST-MAINT-DT         PIC X(02).
  7895        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7896        16  PD-LAST-MAINT-BY         PIC X(04).
  7897*                            COPY ELCCRTT.
  7898******************************************************************
  7899*                                                                *
  7900*                            ELCCRTT.                            *
  7901*                                                                *
  7902*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7903*                                                                *
  7904*   FILE TYPE = VSAM,KSDS                                        *
  7905*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7906*                                                                *
  7907*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7908*                                                                *
  7909*   LOG = YES                                                    *
  7910*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7911******************************************************************
  7912*                   C H A N G E   L O G
  7913*
  7914* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7915*-----------------------------------------------------------------
  7916*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7917* EFFECTIVE    NUMBER
  7918*-----------------------------------------------------------------
  7919* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7920* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7921* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7922* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7923* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7924******************************************************************
  7925
  7926 01  CERTIFICATE-TRAILERS.
  7927     12  CS-RECORD-ID                      PIC XX.
  7928         88  VALID-CS-ID                      VALUE 'CS'.
  7929
  7930     12  CS-CONTROL-PRIMARY.
  7931         16  CS-COMPANY-CD                 PIC X.
  7932         16  CS-CARRIER                    PIC X.
  7933         16  CS-GROUPING                   PIC X(6).
  7934         16  CS-STATE                      PIC XX.
  7935         16  CS-ACCOUNT                    PIC X(10).
  7936         16  CS-CERT-EFF-DT                PIC XX.
  7937         16  CS-CERT-NO.
  7938             20  CS-CERT-PRIME             PIC X(10).
  7939             20  CS-CERT-SFX               PIC X.
  7940         16  CS-TRAILER-TYPE               PIC X.
  7941             88  COMM-TRLR           VALUE 'A'.
  7942             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7943             88  CERT-DATA-TRLR      VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 151
* EL156.cbl
  7944
  7945     12  CS-DATA-AREA                      PIC X(516).
  7946
  7947     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7948         16  CS-BANK-COMMISSION-AREA.
  7949             20  CS-BANK-COMMS       OCCURS 10.
  7950                 24  CS-AGT                PIC X(10).
  7951                 24  CS-COM-TYP            PIC X.
  7952                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7953                 24  CS-RECALC-LV-INDIC    PIC X.
  7954                 24  FILLER                PIC X(10).
  7955         16  FILLER                        PIC X(256).
  7956
  7957     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7958****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7959****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7960         16  CS-MB-CLAIM-DATA OCCURS 2.
  7961             20  FILLER OCCURS 10.
  7962                 24  CS-CLAIM-TYPE         PIC X.
  7963                     88  CS-AH-CLM           VALUE 'A'.
  7964                     88  CS-IU-CLM           VALUE 'I'.
  7965                     88  CS-GP-CLM           VALUE 'G'.
  7966                     88  CS-LF-CLM           VALUE 'L'.
  7967                     88  CS-PR-CLM           VALUE 'P'.
  7968                 24  CS-BANK               PIC S999 COMP-3.
  7969                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7970                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7971                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7972         16  FILLER                        PIC X(216).
  7973     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7974         16  CS-VIN-NUMBER                 PIC X(17).
  7975         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7976         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7977         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7978         16  FILLER                        PIC X(496).
  7979******************************************************************
  7980 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7981                          CONTROL-FILE CERTIFICATE-MASTER
  7982                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7983                          ACCOUNT-MASTER CHECK-QUE
  7984                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7985                          DAILY-ACTIVITY-RECORD
  7986                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7987                          CERT-NOTE-FILE PRODUCT-MASTER
  7988                          CERTIFICATE-TRAILERS.
  7989 0000-DFHEXIT SECTION.
  7990     MOVE '9#                    $   ' TO DFHEIV0.
  7991     MOVE 'EL156' TO DFHEIV1.
  7992     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7993
  7994     IF EIBCALEN = 0
  7995         GO TO 8800-UNAUTHORIZED-ACCESS.
  7996
  7997     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7998     MOVE EIBTRMID               TO QID-TERM.
  7999     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8000     MOVE '2'                    TO EMI-SWITCH2.
  8001     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 152
* EL156.cbl
  8002     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8003
  8004     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8005     MOVE '5'                    TO DC-OPTION-CODE.
  8006     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8007     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8008                                    SAVE-BIN-DATE.
  8009     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8010     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8011
  8012     IF SAVE-DATE-YY > 70
  8013         MOVE 19                 TO SAVE-DATE-CC
  8014     ELSE
  8015         MOVE 20                 TO SAVE-DATE-CC.
  8016
  8017     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8018         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8019     END-IF.
  8020
  8021     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8022        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8023     ELSE
  8024        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8025     END-IF
  8026
  8027     IF PI-PRINT-CLM-FRM-YN = 'N'
  8028         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8029     ELSE
  8030         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8031     END-IF
  8032
  8033     IF PI-PRINT-SURVEY-YN = 'N'
  8034         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8035     ELSE
  8036         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8037     END-IF
  8038
  8039* EXEC CICS HANDLE CONDITION
  8040*        NOTOPEN   (9990-ABEND)
  8041*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8042*        MAPFAIL   (0400-FIRST-TIME)
  8043*        DUPREC    (6180-DUPREC)
  8044*        ERROR     (9990-ABEND)
  8045*    END-EXEC.
  8046*    MOVE '"$JL?%.               ! " #00008034' TO DFHEIV0
  8047     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8049     MOVE X'2220233030303038303334' TO DFHEIV0(25:11)
  8050     CALL 'kxdfhei1' USING DFHEIV0
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8055         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8056
  8057     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8058         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8059             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 153
* EL156.cbl
  8060             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8061             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8062             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8063             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8064             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8065             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8066             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8067             MOVE LOW-VALUES           TO EL156AI
  8068             MOVE 'Y'                  TO FIRST-ENTRY
  8069         ELSE
  8070             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8071             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8072             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8073             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8074             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8075             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8076             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8077             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8078
  8079     IF RETURNED-FROM NOT = SPACES
  8080        IF (RETURNED-FROM = 'EL614')
  8081           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8082           IF WS-SAVED-EOB-CODES NOT = SPACES
  8083              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8084           ELSE
  8085              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8086           END-IF
  8087        END-IF
  8088         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8089            MOVE 'Y'             TO FIRST-ENTRY
  8090            IF RETURNED-FROM = 'EL614'
  8091               AND (PI-PASS-SW NOT = 'C')
  8092               IF WS-SAVED-EOB-CODES NOT = SPACES
  8093                  MOVE WS-SAVED-EOB-CODES
  8094                                 TO PI-PMTNOTE2
  8095                                    WS-PMTNOTE2
  8096                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8097               ELSE
  8098                  MOVE SPACES    TO PI-PMTNOTE2
  8099                                    WS-PMTNOTE2
  8100                                    PI-EOB-CODES-EXIST
  8101               END-IF
  8102            END-IF
  8103            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8104            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8105            IF RETURNED-FROM = 'EL614'
  8106               GO TO 1000-EDIT-DATA
  8107            END-IF
  8108            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8109               (PAYEEI   = LOW-VALUES OR SPACES)
  8110               GO TO 8100-SEND-INITIAL-MAP
  8111            ELSE
  8112               GO TO 1000-EDIT-DATA.
  8113
  8114     IF EIBTRNID NOT = TRANS-ID
  8115         GO TO 0400-FIRST-TIME.
  8116
  8117     IF EIBAID = DFHCLEAR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 154
* EL156.cbl
  8118        IF PI-PASS-SW = 'C'
  8119           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8120           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8121           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8122           MOVE 'Y'            TO RETURNED-FROM-B
  8123           GO TO 1000-EDIT-DATA
  8124        ELSE
  8125           GO TO 9400-CLEAR.
  8126
  8127     IF PI-PASS-SW = 'C'
  8128         MOVE MAP-NAMEB          TO MAP-NAME
  8129         IF EIBAID = DFHPF1 OR DFHPF13
  8130             GO TO 5000-UPDATE
  8131           ELSE
  8132             IF EIBAID NOT = DFHENTER
  8133                 MOVE LOW-VALUES TO EL156BI
  8134                 MOVE MAP-NAMEB  TO MAP-NAME
  8135                 MOVE ER-0029    TO EMI-ERROR
  8136                 MOVE -1         TO  ENTPFBL
  8137                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8138                 GO TO 8200-SEND-DATAONLY.
  8139
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 155
* EL156.cbl
  8141 0200-RECEIVE.
  8142     MOVE LOW-VALUES             TO EL156AI.
  8143     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8144         MOVE ER-0008            TO EMI-ERROR
  8145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8146         IF PI-PASS-SW = 'C'
  8147             MOVE -1             TO ENTPFBL
  8148             GO TO 8200-SEND-DATAONLY
  8149         ELSE
  8150             MOVE -1             TO PMTTYPEL
  8151             GO TO 8200-SEND-DATAONLY.
  8152
  8153     IF PI-COMPANY-ID = 'DMD'
  8154         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8155
  8156     IF PI-PASS-SW = 'C'
  8157         MOVE MAP-NAMEB          TO MAP-NAME.
  8158
  8159
  8160* EXEC CICS RECEIVE
  8161*        MAP   (MAP-NAME)
  8162*        MAPSET(MAPSET-NAME)
  8163*        ASIS
  8164*        INTO  (EL156AI)
  8165*    END-EXEC.
  8166     MOVE LENGTH OF
  8167      EL156AI
  8168       TO DFHEIV11
  8169*    MOVE '8"TAI  L              ''   #00008147' TO DFHEIV0
  8170     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8171     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8172     MOVE X'2020233030303038313437' TO DFHEIV0(25:11)
  8173     CALL 'kxdfhei1' USING DFHEIV0,
  8174           MAP-NAME,
  8175           EL156AI,
  8176           DFHEIV11,
  8177           MAPSET-NAME,
  8178           DFHEIV99,
  8179           DFHEIV99
  8180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8181
  8182
  8183     IF PI-PASS-SW NOT = 'C'
  8184         GO TO 0250-MAPA.
  8185
  8186     IF ENTPFBL NOT > ZERO
  8187         MOVE MAP-NAMEB          TO MAP-NAME
  8188         MOVE ER-0029            TO EMI-ERROR
  8189         MOVE -1                 TO  ENTPFBL
  8190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8191         GO TO 8200-SEND-DATAONLY.
  8192
  8193     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8194         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8195       ELSE
  8196         MOVE MAP-NAMEB           TO MAP-NAME
  8197         MOVE ER-0029             TO EMI-ERROR
  8198         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 156
* EL156.cbl
  8199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8200         GO TO 8200-SEND-DATAONLY.
  8201
  8202     IF EIBAID = DFHPF1 OR DFHPF13
  8203         IF MODIFY-CAP
  8204            GO TO 5000-UPDATE
  8205          ELSE
  8206            MOVE 'UPDATE'           TO SM-READ
  8207            PERFORM 9995-SECURITY-VIOLATION
  8208            MOVE MAP-NAMEB          TO MAP-NAME
  8209            MOVE ER-0070            TO EMI-ERROR
  8210            MOVE -1                 TO  ENTPFBL
  8211            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8212            GO TO 8200-SEND-DATAONLY.
  8213
  8214 0250-MAPA.
  8215     IF ENTERPFL = 0
  8216         GO TO 0300-CHECK-PFKEYS.
  8217
  8218     IF EIBAID NOT = DFHENTER
  8219         MOVE ER-0004            TO EMI-ERROR
  8220         GO TO 0320-INPUT-ERROR.
  8221
  8222     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8223         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8224     ELSE
  8225         MOVE ER-0029            TO EMI-ERROR
  8226         GO TO 0320-INPUT-ERROR.
  8227
  8228 0300-CHECK-PFKEYS.
  8229     IF EIBAID = DFHPF7 OR DFHPF8
  8230         GO TO 8820-PF7-8.
  8231
  8232     IF EIBAID = DFHPF23
  8233         GO TO 8810-PF23.
  8234
  8235     IF EIBAID = DFHPF24
  8236         GO TO 9200-RETURN-MAIN-MENU.
  8237
  8238     IF EIBAID = DFHPF12
  8239         GO TO 9500-PF12.
  8240
  8241     IF EIBAID = DFHPF1
  8242        IF PI-PASS-SW = 'A' OR 'B'
  8243          GO TO 0330-BROWSE-FORWARD.
  8244
  8245     IF EIBAID = DFHPF2
  8246        IF PI-PASS-SW = 'A' OR 'B'
  8247          GO TO 0350-BROWSE-BACKWARD.
  8248
  8249     IF EIBAID = DFHPF6
  8250        IF PI-EOB-CODES-EXIST = 'Y'
  8251           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8252        ELSE
  8253           MOVE SPACES              TO WS-PMTNOTE2
  8254        END-IF
  8255         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8256         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 157
* EL156.cbl
  8257            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8258         END-IF
  8259         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8260         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8261             MOVE 'EL614'        TO PGM-NAME
  8262             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8263             GO TO 9300-XCTL
  8264         ELSE
  8265             MOVE XCTL-157       TO PGM-NAME
  8266             GO TO 9300-XCTL.
  8267
  8268     IF EIBAID = DFHPF9
  8269        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8270        MOVE XCTL-141            TO PGM-NAME
  8271        GO TO 9300-XCTL.
  8272
  8273     IF EIBAID = DFHPF10
  8274        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8275        MOVE XCTL-155            TO PGM-NAME
  8276        GO TO 9300-XCTL.
  8277
  8278     MOVE SPACES                 TO ERRMSG0O
  8279                                    ERRMSG1O
  8280                                    ERRMSG2O.
  8281
  8282     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8283         IF PI-PASS-SW NOT = 'B'
  8284             MOVE ER-0422        TO EMI-ERROR
  8285             GO TO 0320-INPUT-ERROR
  8286           ELSE
  8287             GO TO 0700-TEST-FOR-CHANGES.
  8288
  8289     IF EIBAID = DFHPF11
  8290        IF PI-PASS-SW = 'C'
  8291           MOVE ER-0029          TO EMI-ERROR
  8292           GO TO 0320-INPUT-ERROR.
  8293
  8294     IF EIBAID = DFHENTER OR DFHPF11
  8295        NEXT SENTENCE
  8296     ELSE
  8297        MOVE ER-0029             TO EMI-ERROR
  8298        GO TO 0320-INPUT-ERROR.
  8299
  8300     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8301
  8302     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8303         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8304         GO TO 1000-EDIT-DATA
  8305     ELSE
  8306         IF PI-FATAL-COUNT NOT = 0 OR
  8307            PI-FORCE-COUNT NOT = 0
  8308             GO TO 1000-EDIT-DATA
  8309         ELSE
  8310             GO TO 2000-EDIT-DONE.
  8311
  8312 0320-INPUT-ERROR.
  8313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8314
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 158
* EL156.cbl
  8315     IF ENTERPFL = 0
  8316         MOVE -1                 TO PMTTYPEL
  8317     ELSE
  8318         MOVE AL-UNBON           TO ENTERPFA
  8319         MOVE -1                 TO ENTERPFL.
  8320
  8321     GO TO 8200-SEND-DATAONLY.
  8322
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 159
* EL156.cbl
  8324 0330-BROWSE-FORWARD.
  8325
  8326     MOVE CLMNOI            TO PI-CLAIM-NO.
  8327     MOVE CARRI             TO PI-CARRIER.
  8328     MOVE CERTNOI           TO PI-CERT-PRIME.
  8329     MOVE SUFXI             TO PI-CERT-SFX.
  8330
  8331     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8332     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8333     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8334     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8335
  8336     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8337
  8338
  8339* EXEC CICS HANDLE CONDITION
  8340*         NOTFND   (0380-CLAIM-END-FILE)
  8341*         ENDFILE  (0380-CLAIM-END-FILE)
  8342*    END-EXEC.
  8343*    MOVE '"$I''                  ! # #00008309' TO DFHEIV0
  8344     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8346     MOVE X'2320233030303038333039' TO DFHEIV0(25:11)
  8347     CALL 'kxdfhei1' USING DFHEIV0
  8348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8349
  8350
  8351
  8352* EXEC CICS STARTBR
  8353*         DATASET    ('ELMSTR')
  8354*         RIDFLD     (ELMSTR-KEY)
  8355*         GTEQ
  8356*    END-EXEC.
  8357     MOVE 'ELMSTR' TO DFHEIV1
  8358     MOVE 0
  8359       TO DFHEIV11
  8360*    MOVE '&,         G          &   #00008314' TO DFHEIV0
  8361     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8363     MOVE X'2020233030303038333134' TO DFHEIV0(25:11)
  8364     CALL 'kxdfhei1' USING DFHEIV0,
  8365           DFHEIV1,
  8366           ELMSTR-KEY,
  8367           DFHEIV99,
  8368           DFHEIV11,
  8369           DFHEIV99
  8370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8371
  8372
  8373     MOVE 'Y' TO WS-BROWSE-START-SW.
  8374
  8375 0335-READNEXT.
  8376
  8377
  8378* EXEC CICS READNEXT
  8379*         DATASET    ('ELMSTR')
  8380*         RIDFLD     (ELMSTR-KEY)
  8381*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 160
* EL156.cbl
  8382*    END-EXEC.
  8383     MOVE 'ELMSTR' TO DFHEIV1
  8384     MOVE 0
  8385       TO DFHEIV11
  8386*    MOVE '&.S                   )   #00008324' TO DFHEIV0
  8387     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8388     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8389     MOVE X'2020233030303038333234' TO DFHEIV0(25:11)
  8390     CALL 'kxdfhei1' USING DFHEIV0,
  8391           DFHEIV1,
  8392           DFHEIV20,
  8393           DFHEIV99,
  8394           ELMSTR-KEY,
  8395           DFHEIV99,
  8396           DFHEIV11,
  8397           DFHEIV99,
  8398           DFHEIV99
  8399     SET ADDRESS OF CLAIM-MASTER TO
  8400         DFHEIV20
  8401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8402
  8403
  8404     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8405        GO TO 0380-CLAIM-END-FILE.
  8406
  8407     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8408        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8409        GO TO 0335-READNEXT.
  8410
  8411     IF PI-COMPANY-ID = 'CRI'
  8412         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8413            GO TO 0380-CLAIM-END-FILE.
  8414
  8415     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8416         GO TO 0335-READNEXT.
  8417
  8418     IF PI-CARRIER-SECURITY > SPACES
  8419         IF CL-CARRIER = PI-CARRIER-SECURITY
  8420             NEXT SENTENCE
  8421         ELSE
  8422             GO TO 0335-READNEXT.
  8423
  8424     IF PI-ACCOUNT-SECURITY > SPACES
  8425         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8426             NEXT SENTENCE
  8427         ELSE
  8428             GO TO 0335-READNEXT.
  8429
  8430     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8431     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8432     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8433
  8434     GO TO 0400-FIRST-TIME.
  8435
  8436 0350-BROWSE-BACKWARD.
  8437
  8438     MOVE CLMNOI            TO PI-CLAIM-NO
  8439                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 161
* EL156.cbl
  8440     MOVE CARRI             TO PI-CARRIER.
  8441     MOVE CERTNOI           TO PI-CERT-PRIME.
  8442     MOVE SUFXI             TO PI-CERT-SFX.
  8443
  8444     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8445
  8446     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8447     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8448     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8449
  8450
  8451* EXEC CICS HANDLE CONDITION
  8452*         NOTFND   (0380-CLAIM-END-FILE)
  8453*         ENDFILE  (0380-CLAIM-END-FILE)
  8454*    END-EXEC.
  8455*    MOVE '"$I''                  ! $ #00008376' TO DFHEIV0
  8456     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8458     MOVE X'2420233030303038333736' TO DFHEIV0(25:11)
  8459     CALL 'kxdfhei1' USING DFHEIV0
  8460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8461
  8462
  8463
  8464* EXEC CICS STARTBR
  8465*         DATASET    ('ELMSTR')
  8466*         RIDFLD     (ELMSTR-KEY)
  8467*         GTEQ
  8468*    END-EXEC.
  8469     MOVE 'ELMSTR' TO DFHEIV1
  8470     MOVE 0
  8471       TO DFHEIV11
  8472*    MOVE '&,         G          &   #00008381' TO DFHEIV0
  8473     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8474     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8475     MOVE X'2020233030303038333831' TO DFHEIV0(25:11)
  8476     CALL 'kxdfhei1' USING DFHEIV0,
  8477           DFHEIV1,
  8478           ELMSTR-KEY,
  8479           DFHEIV99,
  8480           DFHEIV11,
  8481           DFHEIV99
  8482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8483
  8484
  8485     MOVE 'Y' TO WS-BROWSE-START-SW.
  8486
  8487
  8488* EXEC CICS READNEXT
  8489*         DATASET    ('ELMSTR')
  8490*         RIDFLD     (ELMSTR-KEY)
  8491*         SET        (ADDRESS OF CLAIM-MASTER)
  8492*    END-EXEC.
  8493     MOVE 'ELMSTR' TO DFHEIV1
  8494     MOVE 0
  8495       TO DFHEIV11
  8496*    MOVE '&.S                   )   #00008389' TO DFHEIV0
  8497     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 162
* EL156.cbl
  8498     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8499     MOVE X'2020233030303038333839' TO DFHEIV0(25:11)
  8500     CALL 'kxdfhei1' USING DFHEIV0,
  8501           DFHEIV1,
  8502           DFHEIV20,
  8503           DFHEIV99,
  8504           ELMSTR-KEY,
  8505           DFHEIV99,
  8506           DFHEIV11,
  8507           DFHEIV99,
  8508           DFHEIV99
  8509     SET ADDRESS OF CLAIM-MASTER TO
  8510         DFHEIV20
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8512
  8513
  8514
  8515* EXEC CICS READPREV
  8516*         DATASET    ('ELMSTR')
  8517*         RIDFLD     (ELMSTR-KEY)
  8518*         SET        (ADDRESS OF CLAIM-MASTER)
  8519*    END-EXEC.
  8520     MOVE 'ELMSTR' TO DFHEIV1
  8521     MOVE 0
  8522       TO DFHEIV11
  8523*    MOVE '&0S                   )   #00008395' TO DFHEIV0
  8524     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8525     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8526     MOVE X'2020233030303038333935' TO DFHEIV0(25:11)
  8527     CALL 'kxdfhei1' USING DFHEIV0,
  8528           DFHEIV1,
  8529           DFHEIV20,
  8530           DFHEIV99,
  8531           ELMSTR-KEY,
  8532           DFHEIV99,
  8533           DFHEIV11,
  8534           DFHEIV99,
  8535           DFHEIV99
  8536     SET ADDRESS OF CLAIM-MASTER TO
  8537         DFHEIV20
  8538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8539
  8540
  8541 0360-BROWSE-BACKWARD.
  8542
  8543
  8544* EXEC CICS READPREV
  8545*         DATASET    ('ELMSTR')
  8546*         RIDFLD     (ELMSTR-KEY)
  8547*         SET        (ADDRESS OF CLAIM-MASTER)
  8548*    END-EXEC.
  8549     MOVE 'ELMSTR' TO DFHEIV1
  8550     MOVE 0
  8551       TO DFHEIV11
  8552*    MOVE '&0S                   )   #00008403' TO DFHEIV0
  8553     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 163
* EL156.cbl
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           DFHEIV1,
  8558           DFHEIV20,
  8559           DFHEIV99,
  8560           ELMSTR-KEY,
  8561           DFHEIV99,
  8562           DFHEIV11,
  8563           DFHEIV99,
  8564           DFHEIV99
  8565     SET ADDRESS OF CLAIM-MASTER TO
  8566         DFHEIV20
  8567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8568
  8569
  8570     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8571        GO TO 0380-CLAIM-END-FILE.
  8572
  8573     IF PI-COMPANY-ID = 'CRI'
  8574         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8575            GO TO 0380-CLAIM-END-FILE.
  8576
  8577     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8578         GO TO 0360-BROWSE-BACKWARD.
  8579
  8580     IF PI-CARRIER-SECURITY > SPACES
  8581         IF CL-CARRIER = PI-CARRIER-SECURITY
  8582             NEXT SENTENCE
  8583         ELSE
  8584             GO TO 0360-BROWSE-BACKWARD.
  8585
  8586     IF PI-ACCOUNT-SECURITY > SPACES
  8587         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8588             NEXT SENTENCE
  8589         ELSE
  8590             GO TO 0360-BROWSE-BACKWARD.
  8591
  8592     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8593     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8594     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8595
  8596     GO TO 0400-FIRST-TIME.
  8597
  8598 0380-CLAIM-END-FILE.
  8599
  8600     MOVE ER-0130     TO EMI-ERROR.
  8601     MOVE -1          TO CLMNOL.
  8602     MOVE AL-UABON    TO CARRA
  8603                         CLMNOA
  8604                         CERTNOA
  8605                         SUFXA.
  8606
  8607     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8608
  8609     GO TO 8200-SEND-DATAONLY.
  8610
  8611 0400-FIRST-TIME.
  8612
  8613     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 164
* EL156.cbl
  8614        MOVE 'N'         TO WS-BROWSE-START-SW
  8615
  8616* EXEC CICS ENDBR
  8617*            DATASET    ('ELMSTR')
  8618*       END-EXEC.
  8619     MOVE 'ELMSTR' TO DFHEIV1
  8620     MOVE 0
  8621       TO DFHEIV11
  8622*    MOVE '&2                    $   #00008454' TO DFHEIV0
  8623     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8624     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8625     MOVE X'2020233030303038343534' TO DFHEIV0(25:11)
  8626     CALL 'kxdfhei1' USING DFHEIV0,
  8627           DFHEIV1,
  8628           DFHEIV11,
  8629           DFHEIV99
  8630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8631
  8632
  8633     IF PI-PROCESSOR-ID = 'LGXX'
  8634         NEXT SENTENCE
  8635     ELSE
  8636
  8637* EXEC CICS READQ TS
  8638*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8639*            INTO    (SECURITY-CONTROL)
  8640*            LENGTH  (SC-COMM-LENGTH)
  8641*            ITEM    (SC-ITEM)
  8642*        END-EXEC
  8643*    MOVE '*$II   L              ''   #00008461' TO DFHEIV0
  8644     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8645     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8646     MOVE X'2020233030303038343631' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0,
  8648           PI-SECURITY-TEMP-STORE-ID,
  8649           SECURITY-CONTROL,
  8650           SC-COMM-LENGTH,
  8651           SC-ITEM,
  8652           DFHEIV99,
  8653           DFHEIV99
  8654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8655         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8656         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8657
  8658     MOVE LOW-VALUES             TO EL156AI.
  8659     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8660     MOVE 'Y'                    TO FIRST-ENTRY.
  8661     GO TO 7000-SHOW-CLAIM.
  8662
  8663 0500-CREATE-TEMP-STORAGE.
  8664     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8665
  8666
  8667* EXEC CICS WRITEQ TS
  8668*        QUEUE (QID)
  8669*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8670*        LENGTH(PI-COMM-LENGTH)
  8671*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 165
* EL156.cbl
  8672*    MOVE '*"                    ''   #00008478' TO DFHEIV0
  8673     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8674     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8675     MOVE X'2020233030303038343738' TO DFHEIV0(25:11)
  8676     CALL 'kxdfhei1' USING DFHEIV0,
  8677           QID,
  8678           PROGRAM-INTERFACE-BLOCK,
  8679           PI-COMM-LENGTH,
  8680           DFHEIV99,
  8681           DFHEIV99,
  8682           DFHEIV99
  8683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8684
  8685
  8686
  8687* EXEC CICS WRITEQ TS
  8688*        QUEUE (QID)
  8689*        FROM  (EL156AI)
  8690*        LENGTH(MAP-LENGTH)
  8691*    END-EXEC.
  8692*    MOVE '*"                    ''   #00008484' TO DFHEIV0
  8693     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8695     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  8696     CALL 'kxdfhei1' USING DFHEIV0,
  8697           QID,
  8698           EL156AI,
  8699           MAP-LENGTH,
  8700           DFHEIV99,
  8701           DFHEIV99,
  8702           DFHEIV99
  8703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8704
  8705
  8706 0599-EXIT.
  8707      EXIT.
  8708
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 166
* EL156.cbl
  8710 0600-RECOVER-TEMP-STORAGE.
  8711
  8712* EXEC CICS READQ TS
  8713*        QUEUE (QID)
  8714*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8715*        LENGTH(PI-COMM-LENGTH)
  8716*    END-EXEC.
  8717*    MOVE '*$I    L              ''   #00008495' TO DFHEIV0
  8718     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8720     MOVE X'2020233030303038343935' TO DFHEIV0(25:11)
  8721     CALL 'kxdfhei1' USING DFHEIV0,
  8722           QID,
  8723           PROGRAM-INTERFACE-BLOCK,
  8724           PI-COMM-LENGTH,
  8725           DFHEIV99,
  8726           DFHEIV99,
  8727           DFHEIV99
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8729
  8730
  8731
  8732* EXEC CICS READQ TS
  8733*        QUEUE (QID)
  8734*        INTO  (EL156AI)
  8735*        LENGTH(MAP-LENGTH)
  8736*    END-EXEC.
  8737*    MOVE '*$I    L              ''   #00008501' TO DFHEIV0
  8738     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8739     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8740     MOVE X'2020233030303038353031' TO DFHEIV0(25:11)
  8741     CALL 'kxdfhei1' USING DFHEIV0,
  8742           QID,
  8743           EL156AI,
  8744           MAP-LENGTH,
  8745           DFHEIV99,
  8746           DFHEIV99,
  8747           DFHEIV99
  8748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8749
  8750
  8751     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8752
  8753     IF PMTTYPEI NOT = LOW-VALUES
  8754         MOVE AL-UANON           TO PMTTYPEA.
  8755
  8756     IF PAYEEI NOT = LOW-VALUES
  8757         MOVE AL-UANON           TO PAYEEA.
  8758
  8759     IF NOTE1I NOT = LOW-VALUES
  8760         MOVE AL-UANON           TO NOTE1A.
  8761
  8762     IF (RETURNED-FROM = 'EL614')
  8763        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8764     END-IF
  8765*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8766*       AND (PI-EOB-CODES-EXIST = 'Y')
  8767*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 167
* EL156.cbl
  8768*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8769     IF PI-SET-NOTE2-MDT = 'Y'
  8770         MOVE AL-SANON           TO NOTE2A
  8771     END-IF
  8772
  8773     IF OFFLINEI NOT = LOW-VALUES
  8774         MOVE AL-UANON           TO OFFLINEA.
  8775
  8776*    IF GROUPEDI NOT = LOW-VALUES
  8777*        MOVE AL-UANON           TO GROUPEDA.
  8778
  8779*    IF CASHI NOT = LOW-VALUES
  8780*        MOVE AL-UANON           TO CASHA.
  8781
  8782     IF CHECKNOI NOT = LOW-VALUES
  8783         MOVE AL-UANON           TO CHECKNOA.
  8784
  8785     IF HOLDTILI NOT = LOW-VALUES
  8786         MOVE AL-UANON           TO HOLDTILA.
  8787
  8788     IF EPYFROMI NOT = LOW-VALUES
  8789         MOVE AL-UANON           TO EPYFROMA.
  8790
  8791     IF AIGFROMI NOT = LOW-VALUES
  8792         MOVE AL-UANON           TO AIGFROMA.
  8793
  8794     IF EPYTHRUI NOT = LOW-VALUES
  8795         MOVE AL-UANON           TO EPYTHRUA.
  8796
  8797     IF EDAYSI NOT = LOW-VALUES
  8798         MOVE AL-UNNON           TO EDAYSA.
  8799
  8800     IF EPYAMTL NOT = +0
  8801         MOVE AL-UNNON           TO EPYAMTA.
  8802
  8803     IF ERESVL NOT = +0
  8804         MOVE AL-UNNON           TO ERESVA.
  8805
  8806     IF EEXPENSL NOT = +0
  8807         MOVE AL-UNNON           TO EEXPENSA.
  8808
  8809     IF ETYPEI NOT = LOW-VALUES
  8810         MOVE AL-UNNON           TO ETYPEA.
  8811
  8812     IF PROOFDTI NOT = 0
  8813         MOVE AL-UNNON           TO PROOFDTA.
  8814
  8815     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8816        MOVE AL-UANON            TO EOBYNA
  8817     END-IF
  8818     IF CLMFMYNI = 'Y' OR 'N'
  8819        MOVE AL-UANON            TO CLMFMYNA
  8820     END-IF
  8821
  8822     IF SURVYYNI = 'Y' OR 'N'
  8823        IF PI-APPROVAL-LEVEL = '4'
  8824           MOVE AL-UANON         TO SURVYYNA
  8825        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 168
* EL156.cbl
  8826     END-IF
  8827
  8828     .
  8829 0699-EXIT.
  8830      EXIT.
  8831
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 169
* EL156.cbl
  8833 0700-TEST-FOR-CHANGES.
  8834     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8835         MOVE ER-0433            TO EMI-ERROR
  8836         GO TO 0750-FUNCTION-ERROR.
  8837
  8838     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8839
  8840     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8841         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8842         MOVE 'A'                TO PI-PASS-SW
  8843         GO TO 1000-EDIT-DATA.
  8844
  8845     IF PI-FATAL-COUNT NOT = 0
  8846         MOVE ER-0499            TO EMI-ERROR
  8847         GO TO 0750-FUNCTION-ERROR.
  8848
  8849     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8850         MOVE ER-0500            TO EMI-ERROR
  8851         GO TO 0750-FUNCTION-ERROR.
  8852
  8853     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8854        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8855           MOVE ER-0542          TO EMI-ERROR
  8856           MOVE -1               TO EPYAMTL
  8857           GO TO 0750-FUNCTION-ERROR.
  8858
  8859     IF PI-OFFLINE = 'Y'  OR
  8860        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8861        MOVE EIBAID              TO PI-PFKEY-USED
  8862        GO TO 5000-UPDATE.
  8863
  8864     GO TO 6000-BUILD-SCREEN-B.
  8865
  8866 0750-FUNCTION-ERROR.
  8867     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8868
  8869     IF ENTERPFL > 0
  8870         MOVE -1                 TO ENTERPFL
  8871         MOVE AL-UNBON           TO ENTERPFA
  8872         GO TO 8200-SEND-DATAONLY
  8873     ELSE
  8874         MOVE -1                 TO ENTERPFL
  8875         MOVE AL-UNNOF           TO ENTERPFA
  8876         GO TO 8200-SEND-DATAONLY.
  8877
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 170
* EL156.cbl
  8879 0800-DELETE-TS.
  8880
  8881* EXEC CICS HANDLE CONDITION
  8882*        QIDERR(0800-EXIT)
  8883*    END-EXEC.
  8884*    MOVE '"$N                   ! % #00008636' TO DFHEIV0
  8885     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8887     MOVE X'2520233030303038363336' TO DFHEIV0(25:11)
  8888     CALL 'kxdfhei1' USING DFHEIV0
  8889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8890
  8891
  8892
  8893* EXEC CICS DELETEQ TS
  8894*        QUEUE(QID)
  8895*    END-EXEC.
  8896*    MOVE '*&                    #   #00008640' TO DFHEIV0
  8897     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8898     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8899     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
  8900     CALL 'kxdfhei1' USING DFHEIV0,
  8901           QID,
  8902           DFHEIV99
  8903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8904
  8905
  8906 0800-EXIT.
  8907      EXIT.
  8908 0900-GET-DDF-FACTORS.
  8909
  8910     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8911     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8912     MOVE CL-CERT-STATE          TO ERPDEF-STATE
  8913     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8914     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8915     MOVE PI-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8916     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8917
  8918     DISPLAY ' MADE 0900 ' ERPDEF-KEY (2:15)
  8919     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8920
  8921
  8922* EXEC CICS STARTBR
  8923*        DATASET  ('ERPDEF')
  8924*        RIDFLD   (ERPDEF-KEY)
  8925*        GTEQ
  8926*        RESP     (WS-RESPONSE)
  8927*    END-EXEC
  8928     MOVE 'ERPDEF' TO DFHEIV1
  8929     MOVE 0
  8930       TO DFHEIV11
  8931*    MOVE '&,         G          &  N#00008659' TO DFHEIV0
  8932     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8933     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8934     MOVE X'204E233030303038363539' TO DFHEIV0(25:11)
  8935     CALL 'kxdfhei1' USING DFHEIV0,
  8936           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 171
* EL156.cbl
  8937           ERPDEF-KEY,
  8938           DFHEIV99,
  8939           DFHEIV11,
  8940           DFHEIV99
  8941     MOVE EIBRESP  TO WS-RESPONSE
  8942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8943
  8944     IF NOT WS-RESP-NORMAL
  8945        GO TO 0900-EXIT
  8946     END-IF
  8947
  8948     .
  8949 0900-READNEXT.
  8950
  8951
  8952* EXEC CICS READNEXT
  8953*       DATASET  ('ERPDEF')
  8954*       SET      (ADDRESS OF PRODUCT-MASTER)
  8955*       RIDFLD   (ERPDEF-KEY)
  8956*       RESP     (WS-RESPONSE)
  8957*    END-EXEC
  8958     MOVE 'ERPDEF' TO DFHEIV1
  8959     MOVE 0
  8960       TO DFHEIV11
  8961*    MOVE '&.S                   )  N#00008673' TO DFHEIV0
  8962     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8963     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8964     MOVE X'204E233030303038363733' TO DFHEIV0(25:11)
  8965     CALL 'kxdfhei1' USING DFHEIV0,
  8966           DFHEIV1,
  8967           DFHEIV20,
  8968           DFHEIV99,
  8969           ERPDEF-KEY,
  8970           DFHEIV99,
  8971           DFHEIV11,
  8972           DFHEIV99,
  8973           DFHEIV99
  8974     SET ADDRESS OF PRODUCT-MASTER TO
  8975         DFHEIV20
  8976     MOVE EIBRESP  TO WS-RESPONSE
  8977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8978
  8979     IF NOT WS-RESP-NORMAL
  8980        GO TO 0900-ENDBR
  8981     END-IF
  8982
  8983     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8984        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8985           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8986        ELSE
  8987           GO TO 0900-READNEXT
  8988        END-IF
  8989     ELSE
  8990        GO TO 0900-ENDBR
  8991     END-IF
  8992
  8993     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8994        (P1 > +8)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 172
* EL156.cbl
  8995        OR (PD-PROD-CODE (P1) = 'I')
  8996     END-PERFORM
  8997     IF P1 < +9
  8998        SET DD-IU-PRESENT        TO TRUE
  8999     END-IF
  9000
  9001     IF CM-LOAN-TERM = ZEROS
  9002        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9003     END-IF
  9004
  9005     .
  9006 0900-ENDBR.
  9007
  9008
  9009* EXEC CICS ENDBR
  9010*       DATASET  ('ERPDEF')
  9011*    END-EXEC
  9012     MOVE 'ERPDEF' TO DFHEIV1
  9013     MOVE 0
  9014       TO DFHEIV11
  9015*    MOVE '&2                    $   #00008709' TO DFHEIV0
  9016     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9018     MOVE X'2020233030303038373039' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0,
  9020           DFHEIV1,
  9021           DFHEIV11,
  9022           DFHEIV99
  9023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9024
  9025     .
  9026 0900-EXIT.
  9027     EXIT.
  9028 1000-EDIT-DATA.
  9029
  9030     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9031         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9032         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9033
  9034     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9035
  9036     IF NOT MODIFY-CAP
  9037         MOVE ER-0070            TO EMI-ERROR
  9038         MOVE -1                 TO PMTTYPEL
  9039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9040         GO TO 2000-EDIT-DONE.
  9041
  9042     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9043                         '5' AND '6'
  9044         MOVE ER-0420            TO EMI-ERROR
  9045         MOVE -1                 TO PMTTYPEL
  9046         MOVE AL-UABON           TO PMTTYPEA
  9047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9048     ELSE
  9049         MOVE AL-UANON           TO PMTTYPEA.
  9050
  9051*    IF PI-OFFLINE = 'Y'
  9052*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 173
* EL156.cbl
  9053*          MOVE ER-1880         TO EMI-ERROR
  9054*          MOVE -1              TO GROUPEDL
  9055*          MOVE AL-UABON        TO GROUPEDA
  9056*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9057*
  9058*    IF GROUPEDL > +0
  9059*       IF PI-GROUPED = 'Y' OR 'N'
  9060*          MOVE AL-UANON TO GROUPEDA
  9061*       ELSE
  9062*          MOVE ER-3140            TO EMI-ERROR
  9063*          MOVE -1                 TO GROUPEDL
  9064*          MOVE AL-UABON           TO GROUPEDA
  9065*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9066*
  9067*    IF CASHL > +0
  9068*       IF PI-CASH = 'Y' OR 'N'
  9069*          MOVE AL-UANON           TO CASHA
  9070*       ELSE
  9071*          MOVE ER-3141            TO EMI-ERROR
  9072*          MOVE -1                 TO CASHL
  9073*          MOVE AL-UABON           TO CASHA
  9074*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9075
  9076     IF LOANNOL > +0
  9077         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9078
  9079 1000-EDIT-PAYEE.
  9080
  9081     IF PI-PAYEE-SEQ NOT NUMERIC
  9082         MOVE ER-0294            TO  EMI-ERROR
  9083         MOVE -1                 TO  PAYEEL
  9084         MOVE AL-UABON           TO  PAYEEA
  9085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9086         GO TO 1000-CONT-EDIT.
  9087
  9088     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9089                         'E' OR 'O' OR 'Q'
  9090         NEXT SENTENCE
  9091     ELSE
  9092         MOVE ER-0294            TO  EMI-ERROR
  9093         MOVE -1                 TO  PAYEEL
  9094         MOVE AL-UABON           TO  PAYEEA
  9095         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9096         GO TO 1000-CONT-EDIT.
  9097
  9098     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9099        (PI-PAYEE-SEQ NOT < '1' AND
  9100         PI-PAYEE-SEQ NOT > '9'))
  9101      OR
  9102        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9103         (PI-PAYEE-SEQ NOT > '9'))
  9104         MOVE AL-UANON            TO PAYEEA
  9105     ELSE
  9106         MOVE ER-0294            TO EMI-ERROR
  9107         MOVE -1                 TO PAYEEL
  9108         MOVE AL-UABON           TO PAYEEA
  9109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9110
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 174
* EL156.cbl
  9111     IF PI-COMPANY-ID = 'DMD'
  9112         IF PI-PAYEE-TYPE = 'B' AND
  9113            PI-PAYEE-SEQ NOT = '0'
  9114               MOVE ER-7841            TO EMI-ERROR
  9115               MOVE -1                 TO PAYEEL
  9116               MOVE AL-UABON           TO PAYEEA
  9117               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9118
  9119     IF PI-COMPANY-ID = 'JHL'
  9120         IF PI-PAYEE = 'B0'
  9121             NEXT SENTENCE
  9122           ELSE
  9123
  9124* EXEC CICS HANDLE CONDITION
  9125*            ENDFILE(1950-NOT-FOUND)
  9126*            NOTFND (1950-NOT-FOUND)
  9127*        END-EXEC
  9128*    MOVE '"$''I                  ! & #00008811' TO DFHEIV0
  9129     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9131     MOVE X'2620233030303038383131' TO DFHEIV0(25:11)
  9132     CALL 'kxdfhei1' USING DFHEIV0
  9133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9134         MOVE 'N'                    TO FOUND-TOL-SW
  9135         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9136         MOVE '2'                    TO CNTL-REC-TYPE
  9137         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9138         MOVE +0                     TO CNTL-SEQ-NO
  9139         MOVE 'PROC'                 TO FILE-SWITCH
  9140         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9141         IF PI-PAYEE = 'I1' AND
  9142            APPROVAL-LEVEL-2
  9143             NEXT SENTENCE
  9144           ELSE
  9145         IF NOT PI-USER-ALMIGHTY-YES
  9146             MOVE ER-3546        TO EMI-ERROR
  9147             MOVE -1             TO PAYEEL
  9148             MOVE AL-UABON       TO PAYEEA
  9149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9150
  9151     IF PI-PAYEE-TYPE = 'E'
  9152        IF PI-PMTTYPE = '5' OR '6'
  9153            NEXT SENTENCE
  9154        ELSE
  9155            MOVE ER-3539            TO EMI-ERROR
  9156            MOVE -1                 TO PAYEEL
  9157            MOVE AL-UABON           TO PAYEEA
  9158            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9159
  9160 1000-CONT-EDIT.
  9161
  9162     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9163        IF PI-EPYAMT NOT NEGATIVE
  9164            MOVE ER-0421         TO EMI-ERROR
  9165            MOVE -1              TO OFFLINEL
  9166            MOVE AL-UABON        TO OFFLINEA
  9167            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9168        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 175
* EL156.cbl
  9169            MOVE AL-UANON        TO OFFLINEA.
  9170
  9171     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9172        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9173           CONTINUE
  9174        ELSE
  9175        IF PI-PRINT-EOB-YN = 'S' AND
  9176           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9177             CONTINUE
  9178        ELSE
  9179           MOVE ER-1561          TO EMI-ERROR
  9180           MOVE -1               TO EOBYNL
  9181           MOVE AL-UABON         TO EOBYNA
  9182           PERFORM 9900-ERROR-FORMAT
  9183                                 THRU 9900-EXIT
  9184        END-IF
  9185        END-IF
  9186
  9187        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9188            MOVE ER-1566        TO EMI-ERROR
  9189            MOVE -1             TO CLMFMYNL
  9190            MOVE AL-UABON       TO CLMFMYNA
  9191            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9192        END-IF
  9193
  9194        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9195            MOVE ER-1567        TO EMI-ERROR
  9196            MOVE -1             TO SURVYYNL
  9197            MOVE AL-UABON       TO SURVYYNA
  9198            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9199        END-IF
  9200
  9201     END-IF
  9202     IF PI-EPYAMT IS NEGATIVE
  9203         IF PI-OFFLINE NOT = 'Y'
  9204             MOVE ER-0836        TO  EMI-ERROR
  9205             MOVE -1             TO  OFFLINEL
  9206             MOVE AL-UABON       TO  OFFLINEA
  9207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9208
  9209     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9210        MOVE ER-0872             TO EMI-ERROR
  9211        MOVE -1                  TO PROOFDTL
  9212        MOVE AL-UABON            TO PROOFDTA
  9213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9214     ELSE
  9215        MOVE '4'                TO DC-OPTION-CODE
  9216        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9217        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9218        IF DATE-CONVERSION-ERROR
  9219            MOVE ER-0873        TO EMI-ERROR
  9220            MOVE -1                  TO PROOFDTL
  9221            MOVE AL-UABON            TO PROOFDTA
  9222            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9223        ELSE
  9224            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9225            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9226                MOVE ER-0873    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 176
* EL156.cbl
  9227                MOVE -1                  TO PROOFDTL
  9228                MOVE AL-UABON            TO PROOFDTA
  9229                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9230            END-IF
  9231        END-IF
  9232     END-IF.
  9233
  9234     IF PI-COMPANY-ID = 'DMD'
  9235        IF NOTE1L NOT = ZEROS
  9236            MOVE ER-7844        TO  EMI-ERROR
  9237            MOVE -1             TO  NOTE1L
  9238            MOVE AL-UABON       TO  NOTE1A
  9239            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9240
  9241     IF PI-COMPANY-ID = 'DMD'
  9242        IF NOTE2L NOT = ZEROS
  9243          GO TO 1004-DMD-EOB-CHECKS.
  9244
  9245     IF NOTE1L NOT > +0
  9246         GO TO 1005-CHECK-ERRORS.
  9247
  9248     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9249         GO TO 1005-CHECK-ERRORS.
  9250
  9251     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9252         GO TO 1003-HAN-PMT-NOTES.
  9253
  9254     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9255
  9256     IF WS-PMTOPTION NUMERIC
  9257        IF WS-PMTOPTION > '00' AND < '17'
  9258           NEXT SENTENCE
  9259        ELSE
  9260           MOVE ER-0618          TO EMI-ERROR
  9261           MOVE -1               TO NOTE1L
  9262           MOVE AL-UABON         TO NOTE1A
  9263           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9264     ELSE
  9265        GO TO 1005-CHECK-ERRORS.
  9266
  9267     IF WS-PMTOPTION = '05' AND
  9268        WS-DOCNAME = SPACES
  9269          MOVE ER-0616             TO EMI-ERROR
  9270          MOVE -1                  TO NOTE1L
  9271          MOVE AL-UABON            TO NOTE1A
  9272          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9273
  9274     IF WS-PMTOPTION = '15' OR '16'
  9275
  9276* EXEC CICS BIF DEEDIT
  9277*            FIELD (WS-AMOUNT)
  9278*            LENGTH(08)
  9279*        END-EXEC
  9280     MOVE 08
  9281       TO DFHEIV11
  9282*    MOVE '@"L                   #   #00008956' TO DFHEIV0
  9283     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9284     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 177
* EL156.cbl
  9285     MOVE X'2020233030303038393536' TO DFHEIV0(25:11)
  9286     CALL 'kxdfhei1' USING DFHEIV0,
  9287           WS-AMOUNT,
  9288           DFHEIV11
  9289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9290        IF (WS-NUM-AMT = ZEROS) OR
  9291           (WS-AMOUNT NOT NUMERIC)
  9292           MOVE ER-0617          TO EMI-ERROR
  9293           MOVE -1               TO NOTE1L
  9294           MOVE AL-UABON         TO NOTE1A
  9295           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9296
  9297     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9298
  9299     GO TO 1005-CHECK-ERRORS.
  9300
  9301 1003-HAN-PMT-NOTES.
  9302
  9303     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9304
  9305     IF WS-HAN-PMT-CODE = SPACE
  9306         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9307     ELSE
  9308     IF WS-HAN-PMT-CODE = 'A'
  9309         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9310                                 TO WS-HAN-PMT-NOTE
  9311     ELSE
  9312     IF WS-HAN-PMT-CODE = 'B'
  9313         MOVE ':FINAL PAYMENT / DECEASED'
  9314                                 TO WS-HAN-PMT-NOTE
  9315     ELSE
  9316     IF WS-HAN-PMT-CODE = 'C'
  9317         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9318                                 TO WS-HAN-PMT-NOTE
  9319     ELSE
  9320     IF WS-HAN-PMT-CODE = 'D'
  9321         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9322                                 TO WS-HAN-PMT-NOTE
  9323     ELSE
  9324     IF WS-HAN-PMT-CODE = 'E'
  9325         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9326                                 TO WS-HAN-PMT-NOTE
  9327     ELSE
  9328     IF WS-HAN-PMT-CODE = 'F'
  9329         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9330                                 TO WS-HAN-PMT-NOTE
  9331     ELSE
  9332     IF WS-HAN-PMT-CODE = 'P'
  9333         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9334
  9335     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9336     GO TO 1005-CHECK-ERRORS.
  9337
  9338 1004-DMD-EOB-CHECKS.
  9339
  9340     INITIALIZE PI-AT-EOB-CODES.
  9341
  9342     IF NOTE2I (20:21) > SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 178
* EL156.cbl
  9343         MOVE ER-7845          TO EMI-ERROR
  9344         MOVE -1               TO NOTE2L
  9345         MOVE AL-UABON         TO NOTE2A
  9346         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9347         GO TO 1005-CHECK-ERRORS
  9348      ELSE
  9349         MOVE NOTE2I             TO W-EOB-CODES.
  9350
  9351     MOVE +1                     TO W-EOB-NDX.
  9352
  9353 1004-CHECK-EACH-EOB.
  9354
  9355     IF W-EOB-NDX > +5
  9356             OR
  9357        W-EOB-CODE (W-EOB-NDX) = SPACES
  9358         GO TO 1004-CHECK-DUP-EOB.
  9359
  9360     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9361         MOVE ER-0956            TO EMI-ERROR
  9362         MOVE -1                 TO NOTE2L
  9363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9364         GO TO 1005-CHECK-ERRORS.
  9365
  9366     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9367     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9368     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9369     MOVE 'DLO023'               TO PGM-NAME.
  9370
  9371
  9372* EXEC CICS LINK
  9373*        PROGRAM    (PGM-NAME)
  9374*        COMMAREA   (CD-COMMUNICATION-AREA)
  9375*        LENGTH     (CD-RCRD-LENGTH)
  9376*    END-EXEC.
  9377*    MOVE '."C                   (   #00009041' TO DFHEIV0
  9378     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9380     MOVE X'2020233030303039303431' TO DFHEIV0(25:11)
  9381     CALL 'kxdfhei1' USING DFHEIV0,
  9382           PGM-NAME,
  9383           CD-COMMUNICATION-AREA,
  9384           CD-RCRD-LENGTH,
  9385           DFHEIV99,
  9386           DFHEIV99,
  9387           DFHEIV99,
  9388           DFHEIV99
  9389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9390
  9391
  9392     IF CD-RETURN-CODE = 'OK'
  9393         GO TO 1004-CONT.
  9394
  9395     MOVE -1                     TO NOTE2L.
  9396
  9397     IF CD-RETURN-CODE = '01'
  9398         MOVE ER-8310            TO EMI-ERROR
  9399         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9400         GO TO 1005-CHECK-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 179
* EL156.cbl
  9401
  9402     IF CD-RETURN-CODE = '02'
  9403         MOVE ER-8311            TO EMI-ERROR
  9404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9405         GO TO 1005-CHECK-ERRORS.
  9406
  9407     IF CD-RETURN-CODE = '03'
  9408         MOVE ER-8312            TO EMI-ERROR
  9409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9410         GO TO 1005-CHECK-ERRORS.
  9411
  9412     IF CD-RETURN-CODE = '04'
  9413         MOVE ER-8313            TO EMI-ERROR
  9414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9415         GO TO 1005-CHECK-ERRORS.
  9416
  9417     IF CD-RETURN-CODE = '05'
  9418         MOVE ER-8314            TO EMI-ERROR
  9419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9420         GO TO 1005-CHECK-ERRORS.
  9421
  9422     IF CD-RETURN-CODE = '06'
  9423         MOVE ER-8315            TO EMI-ERROR
  9424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425         GO TO 1005-CHECK-ERRORS.
  9426
  9427     IF CD-RETURN-CODE = 'E1'
  9428         MOVE ER-8316            TO EMI-ERROR
  9429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9430         GO TO 1005-CHECK-ERRORS.
  9431
  9432     IF CD-RETURN-CODE = 'N1'
  9433         MOVE ER-8317            TO EMI-ERROR
  9434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9435         GO TO 1005-CHECK-ERRORS.
  9436
  9437 1004-CONT.
  9438     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9439
  9440     ADD +1 TO W-EOB-NDX.
  9441     GO TO 1004-CHECK-EACH-EOB.
  9442
  9443 1004-CHECK-DUP-EOB.
  9444     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9445         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9446                               PI-AT-EOB-CODE (3) OR
  9447                               PI-AT-EOB-CODE (4) OR
  9448                               PI-AT-EOB-CODE (5)))
  9449                  OR
  9450        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9451         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9452                               PI-AT-EOB-CODE (4) OR
  9453                               PI-AT-EOB-CODE (5)))
  9454                  OR
  9455        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9456         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9457                               PI-AT-EOB-CODE (5)))
  9458                  OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 180
* EL156.cbl
  9459        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9460         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9461            MOVE ER-8000            TO EMI-ERROR
  9462            MOVE AL-UABON           TO NOTE2A
  9463            MOVE -1                 TO NOTE2L
  9464            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9465            GO TO 1005-CHECK-ERRORS.
  9466
  9467 1005-CHECK-ERRORS.
  9468*    IF PI-COMPANY-ID NOT = 'DMD'
  9469        GO TO 1006-CHECK-ERRORS.
  9470
  9471*********  DMD CODE START ******************
  9472*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9473*       GO TO 1006-CHECK-ERRORS.
  9474*
  9475*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9476*
  9477*    COMPUTE W-PAYMENT-TOTAL
  9478*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9479*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9480*               AND
  9481*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9482*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9483*          MOVE ER-0967    TO EMI-ERROR
  9484*          MOVE -1         TO PMTTYPEL
  9485*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9486*
  9487*    GO TO 1006-CHECK-ERRORS.
  9488*********  DMD CODE END ******************
  9489
  9490 1006-CHECK-ERRORS.
  9491     IF NOT EMI-NO-ERRORS
  9492        GO TO 2000-EDIT-DONE.
  9493
  9494
  9495* EXEC CICS HANDLE CONDITION
  9496*        NOTFND(1950-NOT-FOUND)
  9497*    END-EXEC.
  9498*    MOVE '"$I                   ! '' #00009149' TO DFHEIV0
  9499     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9501     MOVE X'2720233030303039313439' TO DFHEIV0(25:11)
  9502     CALL 'kxdfhei1' USING DFHEIV0
  9503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9504
  9505
  9506     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9507     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9508     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9509     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9510     MOVE 'MSTR'                 TO FILE-SWITCH.
  9511
  9512     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9513
  9514     IF PI-COMPANY-ID = 'DMD'
  9515         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9516
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 181
* EL156.cbl
  9517     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9518        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9519           MOVE ER-0873    TO EMI-ERROR
  9520           MOVE -1                  TO PROOFDTL
  9521           MOVE AL-UABON            TO PROOFDTA
  9522           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9523        END-IF
  9524     END-IF
  9525     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9526     MOVE +95                    TO TRLR-SEQ-NO
  9527
  9528* EXEC CICS READ
  9529*       DATASET  ('ELTRLR')
  9530*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9531*       RIDFLD   (ELTRLR-KEY)
  9532*       RESP     (WS-RESPONSE)
  9533*    END-EXEC
  9534     MOVE 'ELTRLR' TO DFHEIV1
  9535*    MOVE '&"S        E          (  N#00009174' TO DFHEIV0
  9536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9538     MOVE X'204E233030303039313734' TO DFHEIV0(25:11)
  9539     CALL 'kxdfhei1' USING DFHEIV0,
  9540           DFHEIV1,
  9541           DFHEIV20,
  9542           DFHEIV99,
  9543           ELTRLR-KEY,
  9544           DFHEIV99,
  9545           DFHEIV99,
  9546           DFHEIV99
  9547     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9548         DFHEIV20
  9549     MOVE EIBRESP  TO WS-RESPONSE
  9550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9551
  9552     if ws-resp-normal
  9553        perform varying s1 from +1 by +1 until
  9554           at-note-error-no (s1) = spaces
  9555           if at-note-error-no (s1) = '1662'
  9556              continue
  9557           else
  9558              move at-note-error-no (s1)
  9559                                 to emi-error
  9560              if at-note-error-no (s1) = '1653'
  9561                 evaluate true
  9562                    when cl-claim-type = 'L'
  9563                       move '  LF  '
  9564                                 to emi-claim-type
  9565                    when cl-claim-type = 'I'
  9566                       move '  IU  '
  9567                                 to emi-claim-type
  9568                    when other
  9569                       move '  AH  '
  9570                                 to emi-claim-type
  9571                 end-evaluate
  9572              end-if
  9573              PERFORM 9900-ERROR-FORMAT
  9574                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 182
* EL156.cbl
  9575           end-if
  9576        end-perform
  9577     end-if
  9578     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9579         IF PI-PMTTYPE = '5' OR '6'
  9580             NEXT SENTENCE
  9581         ELSE
  9582             MOVE ER-0555             TO EMI-ERROR
  9583             MOVE -1                  TO PMTTYPEL
  9584             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9585
  9586     IF CL-LAST-CLOSE-REASON = '2'
  9587         IF CL-CLAIM-STATUS = 'C'
  9588             MOVE ER-0760        TO  EMI-ERROR
  9589             MOVE -1             TO  PMTTYPEL
  9590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9591
  9592     IF PI-ACTIVITY-CODE = 9
  9593         MOVE ER-3538            TO  EMI-ERROR
  9594         MOVE -1                 TO  PMTTYPEL
  9595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9596
  9597     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9598         GO TO 1008-READ-CERT.
  9599**********************AIG LOGIC STARTS *********************
  9600     IF CL-CERT-PRIME = 'INCOMPLETE'
  9601         MOVE ER-3540            TO  EMI-ERROR
  9602         MOVE -1                 TO  PMTTYPEL
  9603         MOVE AL-UABON           TO  PMTTYPEA
  9604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9605         GO TO 2000-EDIT-DONE.
  9606
  9607     IF PI-PMTTYPE = '4'
  9608         IF PI-EPYAMT IS NEGATIVE
  9609             IF PI-ECHECKNO-CR = 'CR'
  9610                 NEXT SENTENCE
  9611             ELSE
  9612                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9613
  9614     IF PI-PMTTYPE = '4'
  9615         IF PI-ECHECKNO-CR = 'CR'
  9616             IF PI-EPYAMT IS NEGATIVE
  9617                 NEXT SENTENCE
  9618             ELSE
  9619                 MOVE ER-0834    TO  EMI-ERROR
  9620                 MOVE -1         TO  EPYAMTL
  9621                 MOVE AL-UNBON   TO  EPYAMTA
  9622                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9623
  9624     IF PI-PMTTYPE = '4'
  9625         IF PI-EPYAMT IS NEGATIVE
  9626             IF PI-OFFLINE = 'Y'
  9627                 NEXT SENTENCE
  9628             ELSE
  9629                 MOVE 'Y'        TO  PI-OFFLINE
  9630                                     WS-OFFLINE
  9631                                     OFFLINEO
  9632                 MOVE AL-UANON   TO  OFFLINEA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 183
* EL156.cbl
  9633
  9634*    IF PI-PMTTYPE = '4'
  9635*        IF PI-EPYAMT IS NEGATIVE
  9636*            IF PI-CASH = 'Y'
  9637*                NEXT SENTENCE
  9638*            ELSE
  9639*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9640*                MOVE AL-UANON   TO  CASHA
  9641*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9642*
  9643*    IF PI-CASH NOT = 'Y' AND 'N'
  9644*         IF PI-OFFLINE = 'Y'  AND
  9645*            PI-ECHECKNO-CR = 'CR'
  9646*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9647*              MOVE AL-UANON     TO  CASHA
  9648*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9649*
  9650*    IF PI-CASH NOT = 'Y' AND 'N'
  9651*        IF PI-PMTTYPE = '5' OR '6'
  9652*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9653*            MOVE AL-UANON       TO  CASHA
  9654*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9655*
  9656*    IF PI-CASH NOT = 'Y' AND 'N'
  9657*       IF CL-ASSOCIATES = 'N' OR 'A'
  9658*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9659*           MOVE AL-UANON        TO  CASHA
  9660*       ELSE
  9661*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9662*           MOVE AL-UANON        TO  CASHA.
  9663*
  9664*    IF PI-PMTTYPE = '5' OR '6'
  9665*        IF PI-CASH = 'N'
  9666*            MOVE ER-0819        TO  EMI-ERROR
  9667*            MOVE AL-UANON       TO  CASHA
  9668*            MOVE -1             TO  CASHL
  9669*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9670*
  9671*    IF CL-ASSOCIATES = 'N' OR 'A'
  9672*       IF CASHI = 'N'
  9673*        MOVE ER-3537            TO  EMI-ERROR
  9674*        MOVE AL-UANON           TO  CASHA
  9675*        MOVE -1                 TO  CASHL
  9676*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9677
  9678 1007-DEFAULT-AIG-CHECKNO.
  9679
  9680     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9681         MOVE ER-3532            TO  EMI-ERROR
  9682         MOVE -1                 TO  PMTTYPEL
  9683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9684**********************AIG LOGIC ENDS ***********************
  9685
  9686 1008-READ-CERT.
  9687
  9688     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9689     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9690     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 184
* EL156.cbl
  9691     MOVE CL-CERT-STATE          TO CERT-STATE.
  9692     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9693     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9694     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9695     MOVE 'CERT'                 TO FILE-SWITCH.
  9696
  9697     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9698
  9699     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9700         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9701     ELSE
  9702         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9703
  9704*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9705*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9706
  9707     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9708         MOVE ER-0458            TO EMI-ERROR
  9709         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9710
  9711     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9712         MOVE ER-0459            TO EMI-ERROR
  9713         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9714
  9715     IF CL-REPORTED-DT = LOW-VALUES
  9716        MOVE ER-0530             TO EMI-ERROR
  9717        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9718
  9719     IF PI-COMPANY-ID = 'NCL'
  9720        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9721            MOVE ER-0770            TO EMI-ERROR
  9722            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9723
  9724     IF PI-COMPANY-ID = 'NCL'
  9725        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9726            MOVE ER-0737            TO EMI-ERROR
  9727            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9728
  9729     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9730         MOVE ER-0768            TO  EMI-ERROR
  9731         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9732
  9733     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9734         MOVE ER-0769            TO  EMI-ERROR
  9735         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9736
  9737     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9738         GO TO 1020-DO-LIFE-EDITS
  9739     ELSE
  9740         GO TO 1030-DO-AH-EDITS.
  9741
  9742 1010-GENERAL-ERROR.
  9743     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9744
  9745     IF EMI-MESSAGE-FORMATTED
  9746         MOVE -1                 TO PMTTYPEL.
  9747
  9748 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 185
* EL156.cbl
  9749     EXIT.
  9750
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 186
* EL156.cbl
  9752 1020-DO-LIFE-EDITS.
  9753     IF CM-LF-BENEFIT-CD = '00'
  9754         IF PI-PMTTYPE = '5' OR '6'
  9755             MOVE ER-0658        TO EMI-ERROR
  9756             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9757         ELSE
  9758             MOVE ER-1775        TO EMI-ERROR
  9759             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9760
  9761     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9762     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9763         MOVE ER-0460            TO EMI-ERROR
  9764         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9765
  9766     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9767     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9768     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9769     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9770     MOVE '4'                    TO  CNTL-REC-TYPE.
  9771     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9772     MOVE 'BENE'                 TO  FILE-SWITCH.
  9773     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9774     IF NO-BENEFIT-FOUND
  9775         GO TO 1950-NOT-FOUND.
  9776
  9777     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9778
  9779     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9780         IF PI-PMTTYPE = '4'
  9781             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9782                PI-LF-COVERAGE-TYPE = 'P'
  9783                 NEXT SENTENCE
  9784             ELSE
  9785                 MOVE ER-0461        TO EMI-ERROR
  9786                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9787         ELSE
  9788            NEXT SENTENCE
  9789     ELSE
  9790         IF PI-PMTTYPE = '2'
  9791            IF NOT CM-O-B-COVERAGE
  9792              AND CM-LF-CURRENT-STATUS = '7'
  9793                MOVE ER-0462     TO EMI-ERROR
  9794                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9795
  9796     IF PI-PMTTYPE = '2'
  9797         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9798            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9799             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9800             MOVE ER-0730            TO  EMI-ERROR
  9801             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9802             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9803
  9804     IF PI-PMTTYPE = '2'
  9805         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9806            PI-LF-COVERAGE-TYPE = 'P'
  9807             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9808                 MOVE ER-0462    TO  EMI-ERROR
  9809                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 187
* EL156.cbl
  9810
  9811     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9812       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9813         MOVE ER-0466            TO EMI-ERROR
  9814         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9815
  9816     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9817         IF PI-PMTTYPE = '3'
  9818             MOVE 0436           TO EMI-ERROR
  9819             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9820             GO TO 1045-EDIT-PAYEE-ADDR
  9821         ELSE
  9822             GO TO 1045-EDIT-PAYEE-ADDR.
  9823
  9824     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9825        PI-LF-COVERAGE-TYPE = 'P'
  9826         IF PI-PMTTYPE = '3'
  9827             MOVE ER-0436          TO  EMI-ERROR
  9828             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9829         ELSE
  9830             NEXT SENTENCE
  9831     ELSE
  9832         IF PI-PMTTYPE = '1' OR '3'
  9833             MOVE ER-0436            TO EMI-ERROR
  9834             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9835*
  9836     IF PI-COMPANY-ID = 'CID' AND
  9837        CL-CERT-STATE = 'SC'  AND
  9838        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9839           MOVE ER-0879    TO  EMI-ERROR
  9840           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9841           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9842     END-IF.
  9843     IF PI-COMPANY-ID = 'AHL'
  9844        evaluate true
  9845           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9846              MOVE ER-0879       TO  EMI-ERROR
  9847              PERFORM 1040-PMTTYPE-ERROR
  9848                                 THRU 1040-EXIT
  9849              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9850           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9851                 '6D' OR '6H' OR '6R'
  9852              MOVE ER-0879       TO  EMI-ERROR
  9853              PERFORM 1040-PMTTYPE-ERROR
  9854                                 THRU 1040-EXIT
  9855              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9856           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9857              MOVE ER-0879       TO  EMI-ERROR
  9858              PERFORM 1040-PMTTYPE-ERROR
  9859                                 THRU 1040-EXIT
  9860              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9861        end-evaluate
  9862     END-IF
  9863     GO TO 1045-EDIT-PAYEE-ADDR.
  9864
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 188
* EL156.cbl
  9866 1030-DO-AH-EDITS.
  9867     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9868     IF CM-AH-BENEFIT-CD = '00'
  9869         IF PI-PMTTYPE = '5' OR '6'
  9870             MOVE ER-0658        TO EMI-ERROR
  9871             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9872         ELSE
  9873             MOVE ER-1775        TO EMI-ERROR
  9874             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9875
  9876     IF CL-TOTAL-PAID-AMT = ZEROS
  9877         IF PI-PMTTYPE = '4'
  9878             MOVE ER-0438        TO EMI-ERROR
  9879             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9880
  9881     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9882         IF PI-PMTTYPE = '3'
  9883             MOVE ER-0463        TO EMI-ERROR
  9884             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9885         ELSE
  9886             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9887              AND CM-LF-CURRENT-STATUS = '7'
  9888                 MOVE ER-0465    TO EMI-ERROR
  9889                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9890
  9891     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9892         IF PI-PMTTYPE = '3'
  9893             MOVE ER-0464        TO EMI-ERROR
  9894             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9895         ELSE
  9896             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9897                 MOVE ER-0469    TO EMI-ERROR
  9898                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9899
  9900     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9901         IF PI-PMTTYPE = '3'
  9902             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9903                 MOVE ER-0467    TO EMI-ERROR
  9904                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9905             ELSE
  9906                 NEXT SENTENCE
  9907         ELSE
  9908             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9909                 MOVE ER-0468    TO EMI-ERROR
  9910                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9911
  9912     GO TO 1045-EDIT-PAYEE-ADDR.
  9913
  9914 1040-PMTTYPE-ERROR.
  9915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9916
  9917     IF EMI-MESSAGE-FORMATTED
  9918         MOVE -1                 TO PMTTYPEL
  9919         MOVE AL-UABON           TO PMTTYPEA.
  9920
  9921 1040-EXIT.
  9922     EXIT.
  9923
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 189
* EL156.cbl
  9925 1045-EDIT-PAYEE-ADDR.
  9926
  9927     IF PI-OFFLINE = 'N' AND
  9928        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9929           < PI-PAYEE-SEQ-NUM)
  9930        OR
  9931         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9932         (PI-PAYEE-TYPE = 'B')                 AND
  9933         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9934        OR
  9935         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9936           < PI-PAYEE-SEQ-NUM)
  9937        OR
  9938         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9939           < PI-PAYEE-SEQ-NUM)
  9940        OR
  9941         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9942           < PI-PAYEE-SEQ-NUM)
  9943        OR
  9944         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9945           < PI-PAYEE-SEQ-NUM)
  9946        OR
  9947         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9948           < PI-PAYEE-SEQ-NUM))
  9949             MOVE ER-0437        TO EMI-ERROR
  9950             MOVE -1             TO PAYEEL
  9951             MOVE AL-UABON       TO PAYEEA
  9952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9953
  9954     IF PI-OFFLINE    = 'N' AND
  9955        PI-PAYEE-TYPE = 'B' AND
  9956        PI-PAYEE-SEQ  = '0'
  9957         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9958         IF BENE-FOUND-SW = 'N'
  9959             MOVE ER-0437        TO EMI-ERROR
  9960             MOVE -1             TO PAYEEL
  9961             MOVE AL-UABON       TO PAYEEA
  9962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9963
  9964     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9965        IF PI-OFFLINE    = 'N'  AND
  9966           PI-PAYEE-TYPE = 'B'  AND
  9967           PI-PAYEE-SEQ  = '9'
  9968             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9969             IF BENE-FOUND-SW = 'N'
  9970                MOVE ER-0437        TO EMI-ERROR
  9971                MOVE -1             TO PAYEEL
  9972                MOVE AL-UABON       TO PAYEEA
  9973                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9974
  9975*    IF PI-COMPANY-ID = 'CRI'
  9976*        IF CL-CLAIM-TYPE = 'L'
  9977*            MOVE 'N'                TO  WS-GROUPED
  9978*                                        PI-GROUPED
  9979*                                        GROUPEDI
  9980*            MOVE AL-UANON           TO  GROUPEDA
  9981*            GO TO 1050-EDIT-CHECK-NO
  9982*        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 190
* EL156.cbl
  9983*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9984*            IF WS-GROUP-1 = 'C'
  9985*                NEXT SENTENCE
  9986*            ELSE
  9987*                MOVE 'N'            TO  WS-GROUPED
  9988*                                        PI-GROUPED
  9989*                                        GROUPEDI
  9990*                MOVE AL-UANON       TO  GROUPEDA
  9991*                GO TO 1050-EDIT-CHECK-NO.
  9992
  9993*     IF PI-GROUPED = 'Y'
  9994*        IF PI-PAYEE-TYPE = 'B' OR 'A'
  9995*           NEXT SENTENCE
  9996*        ELSE
  9997*           MOVE ER-0437        TO EMI-ERROR
  9998*           MOVE -1             TO PAYEEL
  9999**02180            MOVE AL-UABON       TO PAYEEA
 10000*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10001*
 10002*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10003*        (PI-GROUPED    = ' ')
 10004*        NEXT SENTENCE
 10005*     ELSE
 10006*
 10007     GO TO 1050-EDIT-CHECK-NO.
 10008*     IF PI-COMPANY-ID = 'CRI'
 10009*        MOVE 'N'           TO GROUPEDI
 10010*                              PI-GROUPED
 10011*                              WS-GROUPED
 10012*        MOVE AL-UANON      TO GROUPEDA.
 10013*
 10014*     IF PI-COMPANY-ID = 'CRI'
 10015*        IF PI-PAYEE-TYPE = 'B'
 10016*           IF BENE-FOUND-SW = 'Y'
 10017*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10018*                 MOVE 'Y'           TO GROUPEDI
 10019*                                       PI-GROUPED
 10020*                                       WS-GROUPED
 10021*                 MOVE AL-UANON      TO GROUPEDA
 10022*              ELSE
 10023*                 NEXT SENTENCE
 10024*           ELSE
 10025*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10026*              IF BENE-FOUND-SW = 'Y'
 10027*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10028*                    MOVE 'Y'      TO GROUPEDI
 10029*                                     PI-GROUPED
 10030*                                     WS-GROUPED
 10031*                    MOVE AL-UANON TO GROUPEDA.
 10032*
 10033
 10034     IF PI-COMPANY-ID NOT = 'CRI'
 10035        GO TO 1050-EDIT-CHECK-NO.
 10036
 10037*************** CRI CODE START ******************
 10038     IF PI-PAYEE-TYPE NOT = 'A'
 10039        GO TO 1050-EDIT-CHECK-NO.
 10040
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 191
* EL156.cbl
 10041     MOVE LOW-VALUES             TO ERACCT-KEY.
 10042     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10043     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10044     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10045     MOVE PI-STATE               TO ACCT-STATE.
 10046     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10047     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10048     MOVE 'ACCT'                 TO FILE-SWITCH.
 10049
 10050     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10051     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10052
 10053
 10054* EXEC CICS HANDLE CONDITION
 10055*         NOTFND   (1950-NOT-FOUND)
 10056*         ENDFILE  (1950-NOT-FOUND)
 10057*    END-EXEC.
 10058*    MOVE '"$I''                  ! ( #00009682' TO DFHEIV0
 10059     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10061     MOVE X'2820233030303039363832' TO DFHEIV0(25:11)
 10062     CALL 'kxdfhei1' USING DFHEIV0
 10063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10064
 10065
 10066
 10067* EXEC CICS STARTBR
 10068*         DATASET   ('ERACCT')
 10069*         RIDFLD    (ERACCT-KEY)
 10070*         GTEQ
 10071*    END-EXEC.
 10072     MOVE 'ERACCT' TO DFHEIV1
 10073     MOVE 0
 10074       TO DFHEIV11
 10075*    MOVE '&,         G          &   #00009687' TO DFHEIV0
 10076     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10077     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10078     MOVE X'2020233030303039363837' TO DFHEIV0(25:11)
 10079     CALL 'kxdfhei1' USING DFHEIV0,
 10080           DFHEIV1,
 10081           ERACCT-KEY,
 10082           DFHEIV99,
 10083           DFHEIV11,
 10084           DFHEIV99
 10085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10086
 10087
 10088 1046-READNEXT-ERACCT.
 10089
 10090
 10091* EXEC CICS READNEXT
 10092*         DATASET   ('ERACCT')
 10093*         RIDFLD    (ERACCT-KEY)
 10094*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10095*    END-EXEC.
 10096     MOVE 'ERACCT' TO DFHEIV1
 10097     MOVE 0
 10098       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 192
* EL156.cbl
 10099*    MOVE '&.S                   )   #00009695' TO DFHEIV0
 10100     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10101     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10102     MOVE X'2020233030303039363935' TO DFHEIV0(25:11)
 10103     CALL 'kxdfhei1' USING DFHEIV0,
 10104           DFHEIV1,
 10105           DFHEIV20,
 10106           DFHEIV99,
 10107           ERACCT-KEY,
 10108           DFHEIV99,
 10109           DFHEIV11,
 10110           DFHEIV99,
 10111           DFHEIV99
 10112     SET ADDRESS OF ACCOUNT-MASTER TO
 10113         DFHEIV20
 10114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10115
 10116
 10117     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10118        IF WS-ERACCT-HOLD-RECORD = SPACES
 10119           GO TO 1950-NOT-FOUND
 10120        ELSE
 10121           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10122           GO TO 1048-CONTINUE.
 10123
 10124     IF ACCT-EXP-DT = HIGH-VALUES
 10125        NEXT SENTENCE
 10126     ELSE
 10127        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10128        GO TO 1046-READNEXT-ERACCT.
 10129
 10130 1048-CONTINUE.
 10131
 10132*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10133*       MOVE 'Y'                 TO GROUPEDI
 10134*                                   PI-GROUPED
 10135*                                   WS-GROUPED
 10136*       MOVE AL-UANON            TO GROUPEDA.
 10137*************** CRI CODE END ******************
 10138
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 193
* EL156.cbl
 10140 1050-EDIT-CHECK-NO.
 10141
 10142     IF PI-OFFLINE = 'Y'
 10143         IF PI-ECHECKNO = SPACES
 10144              MOVE ER-0439        TO EMI-ERROR
 10145              GO TO 1090-CHECK-NO-ERROR
 10146           ELSE
 10147*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10148*           IF PI-ECHECKNO-N = 'N' AND
 10149*              PI-CASH       = 'Y'
 10150*                MOVE ER-3535        TO EMI-ERROR
 10151*                GO TO 1090-CHECK-NO-ERROR
 10152*             ELSE
 10153*                MOVE AL-UANON    TO CHECKNOA
 10154*                GO TO 1100-EDIT-HOLDTIL
 10155*         ELSE
 10156            MOVE AL-UANON    TO CHECKNOA
 10157            GO TO 1100-EDIT-HOLDTIL.
 10158
 10159     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10160     MOVE '6'                    TO CNTL-REC-TYPE.
 10161
 10162     IF CONTROL-IS-ACTUAL-CARRIER
 10163         MOVE PI-CARRIER         TO WS-CARR
 10164     ELSE
 10165         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10166
 10167     IF PI-COMPANY-ID = 'FIA'
 10168         MOVE PI-CARRIER         TO WS-CARR.
 10169
 10170     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10171     MOVE 0                      TO CNTL-SEQ-NO.
 10172     MOVE 'CARR'                 TO FILE-SWITCH.
 10173
 10174     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10175
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 194
* EL156.cbl
 10177     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10178         GO TO 1051-EDIT-CHECKNO-CONT.
 10179
 10180**********************AIG LOGIC STARTS**********************
 10181     IF PI-ECHECKNO = SPACES
 10182         IF CHECK-NO-MANUAL
 10183             MOVE ER-0441        TO EMI-ERROR
 10184             GO TO 1090-CHECK-NO-ERROR
 10185         ELSE
 10186             MOVE AL-UANOF       TO CHECKNOA
 10187             GO TO 1100-EDIT-HOLDTIL.
 10188
 10189     IF PI-ECHECKNO NOT = SPACES
 10190         IF CHECK-NO-MANUAL
 10191             MOVE AL-UANON       TO CHECKNOA
 10192             GO TO 1100-EDIT-HOLDTIL.
 10193
 10194     IF PI-ECHECKNO-CR = 'CR'
 10195        IF PI-OFFLINE = 'Y'
 10196            MOVE AL-UANON       TO CHECKNOA
 10197            GO TO 1100-EDIT-HOLDTIL
 10198        ELSE
 10199            MOVE ER-3534        TO EMI-ERROR
 10200            GO TO 1090-CHECK-NO-ERROR.
 10201
 10202     IF PI-ECHECKNO-N = 'N'
 10203        IF PI-CASH = 'N'
 10204            MOVE AL-UANON       TO CHECKNOA
 10205            GO TO 1100-EDIT-HOLDTIL
 10206        ELSE
 10207            MOVE ER-3535          TO EMI-ERROR
 10208            GO TO 1090-CHECK-NO-ERROR.
 10209
 10210     MOVE ER-0442        TO EMI-ERROR
 10211     GO TO 1090-CHECK-NO-ERROR.
 10212**********************AIG LOGIC ENDS************************
 10213
 10214 1051-EDIT-CHECKNO-CONT.
 10215
 10216     IF PI-COMPANY-ID = 'DMD'
 10217        IF PI-ECHECKNO NOT = SPACES
 10218           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10219              MOVE ER-0442        TO EMI-ERROR
 10220              GO TO 1090-CHECK-NO-ERROR
 10221            ELSE
 10222              GO TO 1100-EDIT-HOLDTIL
 10223          ELSE
 10224           GO TO 1100-EDIT-HOLDTIL.
 10225
 10226     IF PI-ECHECKNO = SPACES
 10227         IF CHECK-NO-MANUAL
 10228             MOVE ER-0441        TO EMI-ERROR
 10229             GO TO 1090-CHECK-NO-ERROR
 10230         ELSE
 10231             MOVE AL-UANOF       TO CHECKNOA
 10232             GO TO 1100-EDIT-HOLDTIL
 10233     ELSE
 10234         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 195
* EL156.cbl
 10235             MOVE AL-UANON       TO CHECKNOA
 10236             GO TO 1100-EDIT-HOLDTIL
 10237         ELSE
 10238             MOVE ER-0442        TO EMI-ERROR
 10239             GO TO 1090-CHECK-NO-ERROR.
 10240
 10241 1090-CHECK-NO-ERROR.
 10242     MOVE -1                     TO CHECKNOL.
 10243     MOVE AL-UABON               TO CHECKNOA.
 10244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10245
 10246     GO TO 2000-EDIT-DONE.
 10247
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 196
* EL156.cbl
 10249 1100-EDIT-HOLDTIL.
 10250     MOVE AL-UANON               TO HOLDTILA.
 10251
 10252     IF PI-HOLDTIL = ZEROS
 10253        IF PI-OFFLINE = 'Y'
 10254           MOVE ER-0572          TO EMI-ERROR
 10255           GO TO 1105-HOLDTIL-ERROR
 10256        ELSE
 10257           GO TO 1110-EDIT-PAID-FROM.
 10258
 10259     MOVE '4'                    TO DC-OPTION-CODE.
 10260     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10261     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10262
 10263     IF DATE-CONVERSION-ERROR
 10264         MOVE ER-0446            TO EMI-ERROR
 10265         GO TO 1105-HOLDTIL-ERROR
 10266     END-IF
 10267     IF PI-OFFLINE = 'Y'
 10268        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10269           MOVE ER-0446            TO EMI-ERROR
 10270           GO TO 1105-HOLDTIL-ERROR
 10271        END-IF
 10272     END-IF
 10273
 10274     IF PI-OFFLINE = 'Y'
 10275        GO TO 1110-EDIT-PAID-FROM.
 10276
 10277     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10278     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10279     MOVE '1'                    TO DC-OPTION-CODE.
 10280     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10281
 10282     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10283         MOVE ER-0447            TO EMI-ERROR
 10284         GO TO 1105-HOLDTIL-ERROR.
 10285
 10286     GO TO 1110-EDIT-PAID-FROM.
 10287
 10288 1105-HOLDTIL-ERROR.
 10289     MOVE -1                     TO HOLDTILL.
 10290     MOVE AL-UNBON               TO HOLDTILA.
 10291     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10292
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 197
* EL156.cbl
 10294 1110-EDIT-PAID-FROM.
 10295     MOVE AL-UANON               TO EPYFROMA.
 10296
 10297     IF PI-EPYFROM = ZEROS
 10298         GO TO 1120-CALCULATE-PAID-FROM.
 10299
 10300     IF PI-PMTTYPE = '5' OR '6'
 10301         MOVE ER-0448            TO EMI-ERROR
 10302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10303         MOVE AL-UNBON           TO EPYFROMA
 10304         MOVE -1                 TO EPYFROML
 10305         GO TO 1150-EDIT-PAID-THRU.
 10306
 10307     MOVE '4'                    TO DC-OPTION-CODE.
 10308     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10309     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10310
 10311     IF DATE-CONVERSION-ERROR
 10312         MOVE ER-0449            TO EMI-ERROR
 10313         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10314         MOVE AL-UNBON           TO EPYFROMA
 10315         MOVE -1                 TO EPYFROML
 10316     ELSE
 10317         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10318
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 198
* EL156.cbl
 10320 1120-CALCULATE-PAID-FROM.
 10321     IF PI-PMTTYPE = '5' OR '6'
 10322         GO TO 1150-EDIT-PAID-THRU.
 10323
 10324*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10325*       IF PI-PMTTYPE = '4'
 10326*         GO TO 1150-EDIT-PAID-THRU.
 10327
 10328     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10329         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10330         MOVE ' '                TO DC-OPTION-CODE
 10331         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10332         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10333         GO TO 1145-TEST-PAID-FROM.
 10334
 10335     IF PI-PMTTYPE = '4'
 10336        GO TO 1150-EDIT-PAID-THRU.
 10337
 10338     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10339     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10340     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10341     MOVE '5'                    TO CNTL-REC-TYPE.
 10342     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10343     MOVE 'BENE'                 TO FILE-SWITCH.
 10344
 10345     IF WS-BEN-CD = ZEROS
 10346         GO TO 1950-NOT-FOUND.
 10347
 10348     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10349
 10350     IF NO-BENEFIT-FOUND
 10351         GO TO 1950-NOT-FOUND.
 10352
 10353     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10354     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10355
 10356     IF PI-BEN-DAYS NOT NUMERIC
 10357        MOVE ZEROS               TO PI-BEN-DAYS.
 10358
 10359     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10360
 10361     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10362        (CL-TOTAL-PAID-AMT > ZEROS)
 10363         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10364         MOVE '6'                 TO DC-OPTION-CODE
 10365         MOVE +0                  TO DC-ELAPSED-MONTHS
 10366         MOVE +1                  TO DC-ELAPSED-DAYS
 10367         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10368         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10369         GO TO 1145-TEST-PAID-FROM.
 10370
 10371******************************************************************
 10372****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10373****** SPECIAL ENTERED DATE.
 10374******************************************************************
 10375
 10376     IF PI-AIGFROM = ZEROS
 10377         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 199
* EL156.cbl
 10378
 10379     MOVE AL-UANON TO AIGFROMA.
 10380
 10381     MOVE '4'                    TO DC-OPTION-CODE.
 10382     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10383     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10384
 10385     IF DATE-CONVERSION-ERROR
 10386         MOVE ER-0449            TO EMI-ERROR
 10387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10388         MOVE AL-UNBON           TO AIGFROMA
 10389         MOVE -1                 TO AIGFROML
 10390         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10391     ELSE
 10392         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10393         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10394
 10395     GO TO 1140-CONTINUE-PAID-FROM.
 10396
 10397 1130-CONTINUE-PAID-FROM.
 10398
 10399     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10400        (CL-TOTAL-PAID-AMT = ZEROS)
 10401           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10402
 10403 1140-CONTINUE-PAID-FROM.
 10404
 10405     IF PI-BEN-TYPE = 'R'
 10406         IF PI-BEN-DAYS = ZEROS
 10407             NEXT SENTENCE
 10408         ELSE
 10409         IF PI-COMPANY-ID NOT = 'DMD'
 10410             SUBTRACT 1 FROM PI-BEN-DAYS.
 10411
 10412     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10413
 10414     IF PI-COMPANY-ID = 'DMD'
 10415         MOVE -1                 TO DC-ELAPSED-DAYS
 10416         MOVE +0                 TO DC-ELAPSED-MONTHS
 10417         MOVE '6'                TO DC-OPTION-CODE
 10418         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10419         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10420         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10421                               REMAINDER DC-ELAPSED-DAYS
 10422      ELSE
 10423         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10424         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10425
 10426     MOVE '6'                    TO DC-OPTION-CODE.
 10427     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10428     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10429
 10430     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10431
 10432     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10433         MOVE ER-0541            TO EMI-ERROR
 10434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10435         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 200
* EL156.cbl
 10436         MOVE AL-UNBON           TO EPYFROMA.
 10437
 10438     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10439        (PI-BENEFIT-SAVE = '60E')
 10440        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10441           (CL-TOTAL-PAID-AMT = ZEROS)
 10442             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10443             MOVE 30                  TO DC-ELAPSED-DAYS
 10444             MOVE +0                  TO DC-ELAPSED-MONTHS
 10445             MOVE '6'                 TO DC-OPTION-CODE
 10446             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10447
 10448     IF PI-BEN-TYPE = 'R'
 10449         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10450     ELSE
 10451         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10452         IF WS-SV-EPYFROM = LOW-VALUES
 10453            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10454
 10455     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10456         IF WS-USE-AIG-PAYFROM   OR
 10457            WS-AIG-RECALC-PAYFROM
 10458              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10459                                      DC-BIN-DATE-1
 10460              MOVE ' '            TO  DC-OPTION-CODE
 10461              MOVE +0             TO  DC-ELAPSED-MONTHS
 10462                                      DC-ELAPSED-DAYS
 10463              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10464              IF NO-CONVERSION-ERROR
 10465                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10466
 10467     IF PI-CPYFROM < CL-INCURRED-DT
 10468        MOVE -1                  TO EPYFROML
 10469        MOVE ER-3542             TO EMI-ERROR
 10470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10471
 10472     IF CM-ENTRY-DT < CL-INCURRED-DT
 10473        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10474        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10475        MOVE +0                     TO DC-ELAPSED-DAYS
 10476        MOVE +0                     TO DC-ELAPSED-MONTHS
 10477        MOVE '1'                    TO DC-OPTION-CODE
 10478        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10479        ELSE
 10480        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10481
 10482     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10483         NEXT SENTENCE
 10484     ELSE
 10485         IF DC-ELAPSED-MONTHS < 2
 10486             MOVE ER-3255        TO EMI-ERROR
 10487             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10488
 10489 1145-TEST-PAID-FROM.
 10490     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10491         GO TO 1150-EDIT-PAID-THRU.
 10492
 10493     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 201
* EL156.cbl
 10494         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10495         MOVE ' '                TO DC-OPTION-CODE
 10496         MOVE +0                 TO DC-ELAPSED-MONTHS
 10497                                    DC-ELAPSED-DAYS
 10498         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10499         IF NO-CONVERSION-ERROR
 10500             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10501         ELSE
 10502             MOVE SPACES             TO EMI-DATE-FIELD.
 10503
 10504     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10505         IF CL-TOTAL-PAID-AMT = ZEROS
 10506             MOVE ER-3543            TO EMI-ERROR
 10507             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10508             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10509             IF EMI-MESSAGE-FORMATTED
 10510                MOVE -1             TO EPYFROML
 10511                MOVE AL-UNBON       TO EPYFROMA
 10512             ELSE
 10513                NEXT SENTENCE
 10514         ELSE
 10515             MOVE ER-0452            TO EMI-ERROR
 10516             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10517             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10518             IF EMI-MESSAGE-FORMATTED
 10519                MOVE -1             TO EPYFROML
 10520                MOVE AL-UNBON       TO EPYFROMA.
 10521
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 202
* EL156.cbl
 10523 1150-EDIT-PAID-THRU.
 10524
 10525     MOVE AL-UANON               TO EPYTHRUA.
 10526
 10527     IF PI-EPYTHRU = ZEROS
 10528         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10529             GO TO 1200-EDIT-FIND-TOLERANCES
 10530         ELSE
 10531            IF (PI-PMTTYPE = '3') OR
 10532               (PI-PMTTYPE = '2' AND
 10533                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10534               GO TO 1152-CHECK-TYPE
 10535            ELSE
 10536               MOVE ER-0473      TO EMI-ERROR
 10537               GO TO 1170-PAID-THRU-FATAL-ERROR
 10538     ELSE
 10539         IF PI-PMTTYPE = '5' OR '6'
 10540             MOVE ER-0474        TO EMI-ERROR
 10541             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10542
 10543     MOVE '4'                    TO DC-OPTION-CODE.
 10544     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10545     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10546
 10547     IF DATE-CONVERSION-ERROR
 10548         MOVE ER-0475            TO EMI-ERROR
 10549         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10550
 10551     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10552
 10553     IF PI-COMPANY-ID = 'DMD'
 10554         IF PI-PMTTYPE NOT = '2'
 10555                 AND
 10556            WS-EXP-DT > WS-SV-EPYTHRU
 10557             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10558             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10559             MOVE '1'              TO DC-OPTION-CODE
 10560             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10561             IF DATE-CONVERSION-ERROR
 10562                 MOVE ER-0944      TO EMI-ERROR
 10563                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10564             ELSE
 10565                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10566                    DC-ELAPSED-DAYS   = 1
 10567                     MOVE ER-0945  TO EMI-ERROR
 10568                     MOVE -1       TO EPYTHRUL
 10569                     MOVE AL-UABON TO EPYTHRUA
 10570                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10571
 10572     IF PI-PMTTYPE = '4'
 10573         NEXT SENTENCE
 10574     ELSE
 10575         IF WS-SV-EPYTHRU = WS-EXP-DT
 10576             IF PI-PMTTYPE NOT = '2' AND '3'
 10577                 MOVE ER-3541    TO EMI-ERROR
 10578                 MOVE -1         TO PMTTYPEL
 10579                 MOVE AL-UABON   TO PMTTYPEA
 10580                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 203
* EL156.cbl
 10581
 10582     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10583         MOVE ER-0501            TO EMI-ERROR
 10584         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10585
 10586     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10587        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10588*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10589*              MOVE ER-0540         TO EMI-ERROR
 10590*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10591*              MOVE -1              TO EPYTHRUL
 10592*              MOVE AL-UNBON        TO EPYTHRUA
 10593*          ELSE
 10594*          IF PI-COMPANY-ID = 'DMD'
 10595*              MOVE ER-7540         TO EMI-ERROR
 10596*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10597*              MOVE -1              TO EPYTHRUL
 10598*              MOVE AL-UNBON        TO EPYTHRUA
 10599*          ELSE
 10600               IF PI-PMTTYPE NOT = '2' AND '3'
 10601                  IF PI-COMPANY-ID = '???'
 10602                      MOVE ER-7540  TO EMI-ERROR
 10603                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10604                      MOVE -1       TO EPYTHRUL
 10605                      MOVE AL-UNBON TO EPYTHRUA
 10606                  ELSE
 10607                      MOVE ER-0540  TO EMI-ERROR
 10608                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10609                      MOVE -1       TO EPYTHRUL
 10610                      MOVE AL-UNBON TO EPYTHRUA.
 10611
 10612     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10613            OR
 10614        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10615         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10616            OR
 10617        (PI-CPYFROM NOT = LOW-VALUES AND
 10618         PI-CPYFROM < CL-PAID-THRU-DT)
 10619        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10620
 10621 1152-CHECK-TYPE.
 10622     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10623        OR (PI-PMTTYPE = '5' OR '6')
 10624         GO TO 1160-EDIT-PAID-THRU-AH.
 10625
 10626 1155-EDIT-PAID-THRU-LIFE.
 10627     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10628     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10629     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10630     MOVE '4'                    TO CNTL-REC-TYPE.
 10631     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10632     MOVE 'BENE'                 TO FILE-SWITCH.
 10633
 10634     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10635
 10636     IF NO-BENEFIT-FOUND
 10637         GO TO 1950-NOT-FOUND.
 10638
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 204
* EL156.cbl
 10639     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10640
 10641     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10642
 10643     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10644        PI-LF-COVERAGE-TYPE = 'P'
 10645         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10646         GO TO 1200-EDIT-FIND-TOLERANCES.
 10647
 10648     IF PI-EPYTHRU = ZEROS
 10649        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10650
 10651     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10652         MOVE ER-0476            TO EMI-ERROR
 10653         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10654
 10655     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10656*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10657     move cl-critical-period    to dc-elapsed-months
 10658     MOVE +0                    TO DC-ELAPSED-DAYS.
 10659     MOVE '6'                   TO DC-OPTION-CODE.
 10660     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10661
 10662     IF (NO-CONVERSION-ERROR AND
 10663         WS-SPECIAL-CALC-CD = 'C')
 10664        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10665            MOVE ER-0657 TO EMI-ERROR
 10666            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10667
 10668     IF PI-COMPANY-ID = 'NCL'
 10669         IF WS-SPECIAL-CALC-CD = 'C' AND
 10670            cl-critical-period = zeros
 10671*           CM-LF-CRITICAL-PERIOD = +0
 10672             MOVE ER-0844       TO EMI-ERROR
 10673             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10674
 10675     GO TO 1200-EDIT-FIND-TOLERANCES.
 10676
 10677 1160-EDIT-PAID-THRU-AH.
 10678     IF PI-EPYTHRU = ZEROS
 10679        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10680                                    WS-SV-EPYTHRU
 10681     ELSE
 10682        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10683
 10684     IF WS-SV-EPYTHRU < PI-CPYFROM
 10685         MOVE ER-0508            TO EMI-ERROR
 10686         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10687
 10688     IF PI-PMTTYPE = '3'
 10689        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10690         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10691             MOVE ER-0477        TO EMI-ERROR
 10692             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10693         ELSE
 10694             NEXT SENTENCE
 10695     ELSE
 10696         IF WS-SV-EPYTHRU > WS-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 205
* EL156.cbl
 10697             MOVE ER-0557        TO EMI-ERROR
 10698             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10699
 10700     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10701         PI-PMTTYPE NOT = '3'
 10702         MOVE ER-0541        TO EMI-ERROR
 10703         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10704
 10705     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10706        (PI-PMTTYPE NOT = '3')
 10707         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10708             MOVE ER-0478        TO EMI-ERROR
 10709             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10710
 10711     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10712        (PI-PMTTYPE NOT = '4')
 10713         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10714             MOVE ER-0479        TO EMI-ERROR
 10715             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10716
 10717     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10718         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10719             MOVE ER-0545        TO EMI-ERROR
 10720             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10721
 10722     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10723         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10724             MOVE ER-0481        TO EMI-ERROR
 10725             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10726
 10727*    IF PI-COMPANY-ID = 'NCL'
 10728*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10729*           CM-AH-CRITICAL-PERIOD = +0
 10730*            MOVE ER-0844        TO  EMI-ERROR
 10731*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10732
 10733*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10734     if (cl-critical-period = zeros)
 10735        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10736          GO TO 1200-EDIT-FIND-TOLERANCES.
 10737
 10738     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10739     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10740     MOVE '1'        TO DC-OPTION-CODE.
 10741     MOVE +0         TO DC-ELAPSED-DAYS
 10742                        DC-ELAPSED-MONTHS.
 10743     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10744
 10745*    IF NO-CONVERSION-ERROR
 10746*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10747*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10748*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10749*           MOVE ER-0657 TO EMI-ERROR
 10750*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10751
 10752     GO TO 1200-EDIT-FIND-TOLERANCES.
 10753
 10754 1165-PAID-THRU-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 206
* EL156.cbl
 10755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10756
 10757     IF EMI-MESSAGE-FORMATTED
 10758         MOVE -1                 TO EPYTHRUL
 10759         MOVE AL-UNBON           TO EPYTHRUA.
 10760
 10761 1165-EXIT.
 10762     EXIT.
 10763
 10764 1166-CHECK-ALL-TRLRS.
 10765
 10766     IF PI-PMTTYPE = '4'
 10767        GO TO 1166-TRLR-EXIT.
 10768
 10769     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10770
 10771     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10772        WS-SV-EPYFROM = LOW-VALUES
 10773          GO TO 1166-END-CHECK.
 10774
 10775
 10776* EXEC CICS HANDLE CONDITION
 10777*        ENDFILE   (1166-END-CHECK)
 10778*        NOTFND    (1166-END-CHECK)
 10779*    END-EXEC.
 10780*    MOVE '"$''I                  ! ) #00010359' TO DFHEIV0
 10781     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10783     MOVE X'2920233030303130333539' TO DFHEIV0(25:11)
 10784     CALL 'kxdfhei1' USING DFHEIV0
 10785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10786
 10787
 10788     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10789     MOVE +100                   TO TRLR-SEQ-NO.
 10790
 10791
 10792* EXEC CICS STARTBR
 10793*         DATASET    ('ELTRLR')
 10794*         RIDFLD     (ELTRLR-KEY)
 10795*         GTEQ
 10796*    END-EXEC.
 10797     MOVE 'ELTRLR' TO DFHEIV1
 10798     MOVE 0
 10799       TO DFHEIV11
 10800*    MOVE '&,         G          &   #00010367' TO DFHEIV0
 10801     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10803     MOVE X'2020233030303130333637' TO DFHEIV0(25:11)
 10804     CALL 'kxdfhei1' USING DFHEIV0,
 10805           DFHEIV1,
 10806           ELTRLR-KEY,
 10807           DFHEIV99,
 10808           DFHEIV11,
 10809           DFHEIV99
 10810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10811
 10812
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 207
* EL156.cbl
 10813     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10814
 10815 1166-READ-TRLR-NEXT.
 10816
 10817
 10818* EXEC CICS READNEXT
 10819*         DATASET    ('ELTRLR')
 10820*         RIDFLD     (ELTRLR-KEY)
 10821*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10822*    END-EXEC.
 10823     MOVE 'ELTRLR' TO DFHEIV1
 10824     MOVE 0
 10825       TO DFHEIV11
 10826*    MOVE '&.S                   )   #00010377' TO DFHEIV0
 10827     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10828     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10829     MOVE X'2020233030303130333737' TO DFHEIV0(25:11)
 10830     CALL 'kxdfhei1' USING DFHEIV0,
 10831           DFHEIV1,
 10832           DFHEIV20,
 10833           DFHEIV99,
 10834           ELTRLR-KEY,
 10835           DFHEIV99,
 10836           DFHEIV11,
 10837           DFHEIV99,
 10838           DFHEIV99
 10839     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10840         DFHEIV20
 10841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10842
 10843
 10844     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10845        TRLR-CARRIER  = MSTR-CARRIER  AND
 10846        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10847        TRLR-CERT-NO  = MSTR-CERT-NO
 10848          NEXT SENTENCE
 10849      ELSE
 10850          GO TO 1166-END-CHECK.
 10851
 10852* **  BYPASS ALL NON-PAYMENT TRAILERS
 10853
 10854     IF AT-TRAILER-TYPE = '2'
 10855        NEXT SENTENCE
 10856     ELSE
 10857        GO TO 1166-READ-TRLR-NEXT.
 10858
 10859* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10860
 10861     IF AT-PAYMENT-TYPE = '1' OR '2'
 10862        NEXT SENTENCE
 10863     ELSE
 10864        GO TO 1166-READ-TRLR-NEXT.
 10865
 10866* **  BYPASS ALL VOID PAYMENTS
 10867
 10868     IF AT-VOID-DT NOT = LOW-VALUES
 10869        GO TO 1166-READ-TRLR-NEXT.
 10870
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 208
* EL156.cbl
 10871     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10872        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10873          GO TO 1166-READ-TRLR-NEXT.
 10874
 10875     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10876         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10877            OR
 10878        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10879         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10880        NEXT SENTENCE
 10881     ELSE
 10882         IF CL-TOTAL-PAID-AMT > ZEROS
 10883             MOVE ER-0502            TO EMI-ERROR
 10884             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10885             MOVE -1                 TO EPYTHRUL
 10886             MOVE AL-UNBON           TO EPYTHRUA.
 10887
 10888     GO TO 1166-READ-TRLR-NEXT.
 10889
 10890 1166-END-CHECK.
 10891
 10892     IF WS-BROWSE-TRLR-SW = 'Y'
 10893
 10894* EXEC CICS ENDBR
 10895*            DATASET   ('ELTRLR')
 10896*       END-EXEC.
 10897     MOVE 'ELTRLR' TO DFHEIV1
 10898     MOVE 0
 10899       TO DFHEIV11
 10900*    MOVE '&2                    $   #00010432' TO DFHEIV0
 10901     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10902     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10903     MOVE X'2020233030303130343332' TO DFHEIV0(25:11)
 10904     CALL 'kxdfhei1' USING DFHEIV0,
 10905           DFHEIV1,
 10906           DFHEIV11,
 10907           DFHEIV99
 10908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10909
 10910
 10911     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10912
 10913 1166-TRLR-EXIT.
 10914     EXIT.
 10915
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 209
* EL156.cbl
 10917 1170-PAID-THRU-FATAL-ERROR.
 10918     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10919
 10920     MOVE -1                     TO EPYTHRUL.
 10921     MOVE AL-UNBON               TO EPYTHRUA.
 10922
 10923 1200-EDIT-FIND-TOLERANCES.
 10924
 10925* EXEC CICS HANDLE CONDITION
 10926*        ENDFILE(1950-NOT-FOUND)
 10927*        NOTFND (1950-NOT-FOUND)
 10928*    END-EXEC.
 10929*    MOVE '"$''I                  ! * #00010449' TO DFHEIV0
 10930     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10932     MOVE X'2A20233030303130343439' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0
 10934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10935
 10936
 10937     IF PI-PROCESSOR-ID = 'LGXX'
 10938        GO TO 1240-FIND-ACCT-TOLERANCES.
 10939
 10940     MOVE 'N'                    TO FOUND-TOL-SW.
 10941     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10942     MOVE '2'                    TO CNTL-REC-TYPE.
 10943     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10944     MOVE +0                     TO CNTL-SEQ-NO.
 10945     MOVE 'PROC'                 TO FILE-SWITCH.
 10946
 10947     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10948
 10949     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10950     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10951                                    PI-MAX-PMT-TOL.
 10952     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10953
 10954     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10955         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10956
 10957     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10958     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10959                                    PI-MAX-LF-PMT-TOL.
 10960
 10961     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10962         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10963
 10964     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10965                                    PI-MAX-EXP-PMT.
 10966
 10967 1240-FIND-ACCT-TOLERANCES.
 10968
 10969     IF WS-PMT-TOL NOT = +0
 10970         MOVE 'Y'                TO FOUND-TOL-SW.
 10971
 10972     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10973         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10974         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 210
* EL156.cbl
 10975         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10976         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10977         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10978         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10979     ELSE
 10980         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10981         MOVE PI-CARRIER             TO ACCT-CARRIER
 10982         MOVE PI-GROUPING            TO ACCT-GROUPING
 10983         MOVE PI-STATE               TO ACCT-STATE
 10984         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10985         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10986
 10987     MOVE 'ACCT'                 TO FILE-SWITCH.
 10988
 10989     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10990     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10991
 10992
 10993* EXEC CICS HANDLE CONDITION
 10994*         NOTFND   (1950-NOT-FOUND)
 10995*         ENDFILE  (1950-NOT-FOUND)
 10996*    END-EXEC.
 10997*    MOVE '"$I''                  ! + #00010509' TO DFHEIV0
 10998     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11000     MOVE X'2B20233030303130353039' TO DFHEIV0(25:11)
 11001     CALL 'kxdfhei1' USING DFHEIV0
 11002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11003
 11004
 11005
 11006* EXEC CICS STARTBR
 11007*        DATASET('ERACCT')
 11008*        RIDFLD (ERACCT-KEY)
 11009*        GTEQ
 11010*    END-EXEC.
 11011     MOVE 'ERACCT' TO DFHEIV1
 11012     MOVE 0
 11013       TO DFHEIV11
 11014*    MOVE '&,         G          &   #00010514' TO DFHEIV0
 11015     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11017     MOVE X'2020233030303130353134' TO DFHEIV0(25:11)
 11018     CALL 'kxdfhei1' USING DFHEIV0,
 11019           DFHEIV1,
 11020           ERACCT-KEY,
 11021           DFHEIV99,
 11022           DFHEIV11,
 11023           DFHEIV99
 11024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11025
 11026
 11027 1245-FIND-ACCT-TOLERANCES-LOOP.
 11028
 11029
 11030* EXEC CICS READNEXT
 11031*        DATASET('ERACCT')
 11032*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 211
* EL156.cbl
 11033*        RIDFLD (ERACCT-KEY)
 11034*    END-EXEC.
 11035     MOVE 'ERACCT' TO DFHEIV1
 11036     MOVE 0
 11037       TO DFHEIV11
 11038*    MOVE '&.S                   )   #00010522' TO DFHEIV0
 11039     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11040     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11041     MOVE X'2020233030303130353232' TO DFHEIV0(25:11)
 11042     CALL 'kxdfhei1' USING DFHEIV0,
 11043           DFHEIV1,
 11044           DFHEIV20,
 11045           DFHEIV99,
 11046           ERACCT-KEY,
 11047           DFHEIV99,
 11048           DFHEIV11,
 11049           DFHEIV99,
 11050           DFHEIV99
 11051     SET ADDRESS OF ACCOUNT-MASTER TO
 11052         DFHEIV20
 11053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11054
 11055
 11056     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11057        IF WS-ERACCT-HOLD-RECORD = SPACES
 11058           GO TO 1950-NOT-FOUND
 11059        ELSE
 11060           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11061           GO TO 1250-CONTINUE.
 11062
 11063     IF ACCT-EXP-DT = HIGH-VALUES
 11064        NEXT SENTENCE
 11065     ELSE
 11066        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11067        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11068
 11069 1250-CONTINUE.
 11070
 11071     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11072
 11073     IF FOUND-TOL-SW = 'N'
 11074         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11075
 11076********* 1260-FIND-STATE-TOLERANCES.
 11077
 11078     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11079     MOVE PI-STATE               TO WS-ST-ACCESS.
 11080     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11081     MOVE '3'                    TO CNTL-REC-TYPE.
 11082     MOVE +0                     TO CNTL-SEQ-NO.
 11083     MOVE 'STAT'                 TO FILE-SWITCH.
 11084
 11085     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11086
 11087     IF WS-PMT-TOL = +0
 11088         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11089
 11090     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 212
* EL156.cbl
 11091     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11092     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11093     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11094     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11095
 11096****USE THIS ROUTINE TO CHECK PAYEE NAME EQUAL TO DECEASED
 11097     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 11098*        PI-VFY-2ND-BENE = 'Y' AND
 11099        PI-PAYEE-TYPE <> 'B'
 11100           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11101     END-IF.
 11102
 11103     IF PI-PMTTYPE      = '2'  AND
 11104        PI-SPLIT-PMT-SW = 'Y'  AND
 11105        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11106          MOVE ER-3530                TO EMI-ERROR
 11107          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11108
 11109********* 1280-FIND-BENEFIT-TOLERANCES.
 11110
 11111     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11112        OR (PI-PMTTYPE = '5' OR '6')
 11113         GO TO 1300-FIND-CARR-TOLERANCES.
 11114
 11115     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11116     MOVE '4'                    TO CNTL-REC-TYPE.
 11117     MOVE +0                     TO CNTL-SEQ-NO.
 11118     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11119     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11120     MOVE 'BENE'                 TO FILE-SWITCH.
 11121
 11122     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11123
 11124     IF NO-BENEFIT-FOUND
 11125         GO TO 1950-NOT-FOUND.
 11126
 11127     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11128     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11129     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11130
 11131
 11132* EXEC CICS HANDLE CONDITION
 11133*        NOTFND(1950-NOT-FOUND)
 11134*    END-EXEC.
 11135*    MOVE '"$I                   ! , #00010603' TO DFHEIV0
 11136     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11137     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11138     MOVE X'2C20233030303130363033' TO DFHEIV0(25:11)
 11139     CALL 'kxdfhei1' USING DFHEIV0
 11140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11141
 11142
 11143 1300-FIND-CARR-TOLERANCES.
 11144     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11145     MOVE '6'                    TO CNTL-REC-TYPE.
 11146
 11147     IF CONTROL-IS-ACTUAL-CARRIER
 11148         MOVE PI-CARRIER               TO WS-CARR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 213
* EL156.cbl
 11149     ELSE
 11150         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11151
 11152     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11153     MOVE +0                     TO CNTL-SEQ-NO.
 11154     MOVE 'CARR'                 TO FILE-SWITCH.
 11155
 11156     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11157
 11158     IF WS-DAYS-TOL = +0
 11159         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11160
 11161     IF WS-PMT-TOL = +0
 11162         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11163
 11164     IF WS-MAX-DAYS-TOL = +0
 11165         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11166
 11167     IF WS-MAX-PMT-TOL = +0
 11168         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11169                                    PI-MAX-PMT-TOL.
 11170
 11171     IF WS-MAX-LF-PMT-TOL = +0
 11172        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11173                                    PI-MAX-LF-PMT-TOL.
 11174
 11175     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11176
 11177********* 1320-FIND-COMP-TOLERANCES.
 11178
 11179     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11180     MOVE '1'                    TO CNTL-REC-TYPE.
 11181     MOVE SPACES                 TO CNTL-ACCESS.
 11182     MOVE +0                     TO CNTL-SEQ-NO.
 11183     MOVE 'COMP'                 TO FILE-SWITCH.
 11184
 11185     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11186
 11187     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11188     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11189
 11190     IF WS-PMT-TOL NOT = +0
 11191        IF WS-TOL-SEVERITY NOT = ' '
 11192         GO TO 1360-EDIT-DAYS.
 11193
 11194     IF WS-PMT-TOL = +0
 11195         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11196
 11197     IF WS-TOL-SEVERITY = ' '
 11198         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11199
 11200 1360-EDIT-DAYS.
 11201     IF PI-PMTTYPE NOT = '4'
 11202        IF PI-EDAYS NEGATIVE OR
 11203           PI-EPYAMT NEGATIVE
 11204          MOVE ER-0513             TO EMI-ERROR
 11205          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11206          MOVE -1                  TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 214
* EL156.cbl
 11207
 11208     IF PI-PMTTYPE = '5' OR '6'
 11209        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11210
 11211     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11212        IF PI-PMTTYPE = '4'
 11213          MOVE PI-EDAYS          TO PI-CDAYS.
 11214
 11215     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11216         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11217
 11218     IF PI-PMTTYPE = '4'
 11219        MOVE PI-EDAYS            TO PI-CDAYS
 11220        GO TO 1400-EDIT-PAYMENT.
 11221
 11222     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11223        GO TO 1500-EDIT-EXPENSES.
 11224
 11225*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11226*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11227*          CM-AH-BENEFIT-CD = '23'              AND
 11228*          CL-CERT-STATE    = '04'              AND
 11229*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11230*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11231*            GO TO 1362-CHECK-MAX-DAYS.
 11232
 11233     IF PI-EDAYS = ZEROS
 11234*        IF PI-COMPANY-ID = 'DMD'
 11235*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11236*            MOVE -1             TO DC-ELAPSED-DAYS
 11237*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11238*            MOVE '6'            TO DC-OPTION-CODE
 11239*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11240*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11241*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11242*            MOVE '1'            TO DC-OPTION-CODE
 11243*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11244*            IF NO-CONVERSION-ERROR
 11245*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11246*                                 + DC-ODD-DAYS-OVER
 11247*               MOVE 6           TO EDAYSL
 11248*               MOVE AL-UNNON    TO EDAYSA
 11249*            ELSE
 11250*                NEXT SENTENCE
 11251*       ELSE
 11252            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11253            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11254            MOVE '1'             TO DC-OPTION-CODE
 11255            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11256            IF NO-CONVERSION-ERROR
 11257                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11258                ADD 1                 TO PI-EDAYS
 11259                MOVE AL-UNNON         TO EDAYSA.
 11260
 11261*    IF PI-COMPANY-ID = 'DMD'
 11262*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11263*        MOVE -1                 TO DC-ELAPSED-DAYS
 11264*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 215
* EL156.cbl
 11265*        MOVE '6'                TO DC-OPTION-CODE
 11266*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11267*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11268*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11269*        MOVE '1'                TO DC-OPTION-CODE
 11270*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11271*    ELSE
 11272         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11273         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11274         MOVE '1'                TO DC-OPTION-CODE.
 11275         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11276
 11277     IF NO-CONVERSION-ERROR
 11278        IF PI-COMPANY-ID = 'DMD'
 11279            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11280                             + DC-ODD-DAYS-OVER
 11281        ELSE
 11282            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11283            ADD 1                TO PI-CDAYS.
 11284
 11285     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11286        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11287        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11288
 11289     IF PI-EDAYS NOT NUMERIC
 11290         MOVE ER-0491            TO EMI-ERROR
 11291         GO TO 1370-DAYS-ERROR.
 11292
 11293     IF CL-NO-OF-PMTS-MADE = 0
 11294        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11295        AND CL-CERT-STATE = 'MI'
 11296        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11297            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11298     END-IF.
 11299
 11300 1362-CHECK-MAX-DAYS.
 11301
 11302     IF WS-MAX-DAYS-TOL = +999
 11303         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11304
 11305     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11306         IF PI-EDAYS = ZEROS
 11307             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11308         ELSE
 11309             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11310
 11311     IF WS-MAX-DAYS-TOL NOT = ZERO
 11312        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11313           PI-CDAYS > WS-MAX-DAYS-TOL
 11314             MOVE ER-0492          TO EMI-ERROR
 11315             GO TO 1370-DAYS-ERROR.
 11316
 11317 1365-SKIP-MAX-DAYS-EDIT.
 11318     IF PI-EDAYS = ZEROS
 11319        GO TO 1400-EDIT-PAYMENT.
 11320
 11321     IF WS-DAYS-TOL NOT = ZERO
 11322        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 216
* EL156.cbl
 11323           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 11324                MOVE ER-0493     TO EMI-ERROR
 11325                GO TO 1370-DAYS-ERROR.
 11326
 11327     GO TO 1400-EDIT-PAYMENT.
 11328
 11329 1370-DAYS-ERROR.
 11330     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11331
 11332     IF EMI-MESSAGE-FORMATTED
 11333         MOVE -1                 TO EDAYSL
 11334         MOVE AL-UABON           TO EDAYSA.
 11335
 11336     GO TO 1400-EDIT-PAYMENT.
 11337
 11338 1380-EDIT-EXPENSE-PMT-AMT.
 11339     IF PI-PMTTYPE = '5' OR '6'
 11340         NEXT SENTENCE
 11341     ELSE
 11342         GO TO 1400-EDIT-PAYMENT.
 11343
 11344     IF WS-MAX-EXP-PMT NOT = ZEROS
 11345        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11346            MOVE ER-3529            TO EMI-ERROR
 11347            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11348
 11349     GO TO 1500-EDIT-EXPENSES.
 11350
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 217
* EL156.cbl
 11352
 11353 1390-CHECK-PAYMENT-DAYS.
 11354
 11355     IF PI-EDAYS = 0
 11356         MOVE PI-CDAYS TO WS-PD-DAYS
 11357     ELSE
 11358         MOVE PI-EDAYS TO WS-PD-DAYS
 11359     END-IF.
 11360
 11361     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11362         IF WS-PD-DAYS = 14
 11363            GO TO 1390-EXIT
 11364         END-IF
 11365     END-IF.
 11366
 11367     IF PI-COMPANY-ID = 'AHL'  AND
 11368        CM-AH-BENEFIT-CD = '1K'
 11369         IF WS-PD-DAYS = 14
 11370            GO TO 1390-EXIT
 11371         END-IF
 11372     END-IF.
 11373
 11374     IF WS-PD-DAYS < 30
 11375         MOVE ER-3549              TO EMI-ERROR
 11376         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11377     END-IF.
 11378
 11379 1390-EXIT.
 11380      EXIT.
 11381
 11382 1400-EDIT-PAYMENT.
 11383*    IF PI-COMPANY-ID = 'DMD'
 11384*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11385*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11386
 11387     IF PI-COMPANY-ID = 'DCC'
 11388        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11389        MOVE PI-CARRIER          TO ACCT-CARRIER
 11390        MOVE PI-GROUPING         TO ACCT-GROUPING
 11391        MOVE PI-STATE            TO ACCT-STATE
 11392        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11393        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11394        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11395        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11396
 11397
 11398* EXEC CICS READ
 11399*          DATASET ('ERACCT')
 11400*          RIDFLD  (ERACCT-KEY)
 11401*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11402*          GTEQ
 11403*          resp    (WS-RESPONSE)
 11404*       END-EXEC
 11405     MOVE 'ERACCT' TO DFHEIV1
 11406*    MOVE '&"S        G          (  N#00010861' TO DFHEIV0
 11407     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11409     MOVE X'204E233030303130383631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 218
* EL156.cbl
 11410     CALL 'kxdfhei1' USING DFHEIV0,
 11411           DFHEIV1,
 11412           DFHEIV20,
 11413           DFHEIV99,
 11414           ERACCT-KEY,
 11415           DFHEIV99,
 11416           DFHEIV99,
 11417           DFHEIV99
 11418     SET ADDRESS OF ACCOUNT-MASTER TO
 11419         DFHEIV20
 11420     MOVE EIBRESP  TO WS-RESPONSE
 11421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11422        IF WS-RESP-NORMAL
 11423           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11424           and pi-cert-eff-dt < am-expiration-dt
 11425           and pi-cert-eff-dt >= am-effective-dt
 11426           move am-dcc-product-code to pi-dcc-product-code
 11427        else
 11428           move spaces           to pi-dcc-product-code
 11429        end-if
 11430        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11431           MOVE ' '              TO WS-PDEF-RECORD-SW
 11432           PERFORM 0900-GET-DDF-FACTORS
 11433                                 THRU 0900-EXIT
 11434           IF PDEF-FOUND
 11435              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11436                 (P1 > +8)
 11437                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11438              END-PERFORM
 11439              IF P1 < +9
 11440                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11441                    MOVE PD-MAX-AMT (P1)
 11442                                 TO CM-AH-BENEFIT-AMT
 11443                 end-if
 11444              END-IF
 11445           END-IF
 11446        end-if
 11447     END-IF
 11448     IF PI-PMTTYPE NOT = '4'
 11449        GO TO 1405-CALC-PAYMENT.
 11450
 11451     IF PI-EDAYS NOT NUMERIC
 11452         MOVE PI-EPYAMT           TO PI-CPYAMT
 11453         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11454         GO TO 1430-CHECK-AH-TOLERANCE.
 11455
 11456*    IF PI-COMPANY-ID = 'FIA'
 11457*       IF CERT-ACCOUNT = '0000011043'
 11458*        COMPUTE PI-DAILY-RATE ROUNDED =
 11459*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11460*        COMPUTE PI-CPYAMT ROUNDED =
 11461*                          PI-DAILY-RATE * PI-EDAYS
 11462*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11463*        GO TO 1430-CHECK-AH-TOLERANCE.
 11464
 11465     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11466         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11467         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 219
* EL156.cbl
 11468         GO TO 1420-CHECK-AIG-BENEFIT.
 11469
 11470     IF WS-CALC-METHOD = '2' OR  '5'
 11471         COMPUTE PI-DAILY-RATE ROUNDED =
 11472                        (CM-AH-BENEFIT-AMT * 12) / 365
 11473         COMPUTE PI-CPYAMT ROUNDED =
 11474                           PI-DAILY-RATE * PI-EDAYS
 11475        GO TO 1420-CHECK-AIG-BENEFIT.
 11476
 11477     IF WS-CALC-METHOD = '3'
 11478         COMPUTE PI-DAILY-RATE =
 11479                         (CM-AH-BENEFIT-AMT * 12) / 365
 11480         COMPUTE PI-CPYAMT ROUNDED =
 11481                           PI-DAILY-RATE * PI-EDAYS
 11482        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 220
* EL156.cbl
 11484*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11485
 11486****************************************************************
 11487****************************************************************
 11488*                  CALCULATED FROM      PAYMENT      PAYMENT
 11489*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11490* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11491*1-01-83  1-15-83    0    15     15        15           15
 11492*1-01-83  1-30-83    0    30     30        30           30
 11493*1-01-83  1-31-83    1     0     31        30           30
 11494*1-01-83  2-01-83    1     1     32        31           31
 11495*1-01-83  2-15-83    1    15     46        45           45
 11496*1-01-83  2-28-83    2     0     59        60           60
 11497*1-01-83  3-01-83    2     1     60        61           61
 11498*1-01-83  3-31-83    3     0     90        90           90
 11499*1-15-83  1-31-83    0    17     17        17           16
 11500*1-15-83  2-01-83    0    18     18        18           17
 11501*1-15-83  2-28-83    1    14     45        44           46
 11502*1-21-83  3-09-83    1    20     48        50           49
 11503*2-05-83  3-06-83    1     2     30        32           32
 11504*2-05-83  3-23-83    1    19     47        49           49
 11505*2-15-83  2-28-83    0    14     14        14           16
 11506*2-15-83  3-01-83    0    15     15        15           17
 11507*2-21-83  3-19-83    0    27     27        27           29
 11508*2-21-83  3-20-83    1     0     28        30           30
 11509*2-21-83  4-10-83    1    18     49        30           50
 11510*2-21-83  5-19-83    2    27     88        87           89
 11511*2-21-83  5-22-83    3     2     91        92           92
 11512*3-21-83  5-19-83    1    30     60        60           59
 11513****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 221
* EL156.cbl
 11515 1405-CALC-PAYMENT.
 11516     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11517     MOVE ' '                    TO DC-OPTION-CODE.
 11518     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11519     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11520     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11521
 11522     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11523     MOVE ' '                    TO DC-OPTION-CODE.
 11524     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11525     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11526     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11527
 11528     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11529     MOVE -1                     TO DC-ELAPSED-DAYS.
 11530     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11531     MOVE '6'                    TO DC-OPTION-CODE.
 11532     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11533     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11534
 11535     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11536     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11537     MOVE '1'                    TO DC-OPTION-CODE.
 11538     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11539
 11540     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11541     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11542     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11543
 11544******************************************************************
 11545*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11546*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11547*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11548******************************************************************
 11549
 11550     IF WS-CALC-METHOD = '1'           AND
 11551        DC-ELAPSED-MONTHS > ZERO AND
 11552        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11553        WDF-DAY > WDT-DAY
 11554          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11555          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11556          MOVE -1                  TO DC-ELAPSED-MONTHS
 11557          MOVE '6'                 TO DC-OPTION-CODE
 11558          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11559          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11560          COMPUTE WS-SAVE-ODD-DAYS =
 11561          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11562          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11563
 11564     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11565     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11566     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11567
 11568     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11569     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11570
 11571*    IF PI-COMPANY-ID = 'FIA'
 11572*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 222
* EL156.cbl
 11573*        COMPUTE PI-DAILY-RATE ROUNDED =
 11574*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11575*        COMPUTE PI-CPYAMT ROUNDED =
 11576*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11577*        GO TO 1420-CHECK-AIG-BENEFIT.
 11578
 11579*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11580*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11581*          CM-AH-BENEFIT-CD = '23'               AND
 11582*          CL-CERT-STATE    = '04'               AND
 11583*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11584*            COMPUTE WS-DAILY-RATE ROUNDED =
 11585*                               CM-AH-BENEFIT-AMT / 30
 11586*            COMPUTE PI-CPYAMT ROUNDED =
 11587*                               (WS-DAILY-RATE * PI-CDAYS)
 11588*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11589*            GO TO 1420-CHECK-AIG-BENEFIT.
 11590
 11591     IF WS-CALC-METHOD = '1'
 11592         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11593         COMPUTE PI-CPYAMT ROUNDED =
 11594             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11595             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11596         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11597         GO TO 1420-CHECK-AIG-BENEFIT.
 11598
 11599     IF WS-CALC-METHOD = '2'
 11600         COMPUTE PI-DAILY-RATE ROUNDED =
 11601                          (CM-AH-BENEFIT-AMT * 12) / 365
 11602         COMPUTE PI-CPYAMT ROUNDED =
 11603             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11604             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11605         GO TO 1420-CHECK-AIG-BENEFIT.
 11606
 11607     IF WS-CALC-METHOD = '4'
 11608         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11609         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11610         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11611         COMPUTE PI-CPYAMT ROUNDED =
 11612                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11613         GO TO 1420-CHECK-AIG-BENEFIT.
 11614
 11615     IF WS-CALC-METHOD = '5'
 11616         COMPUTE PI-DAILY-RATE ROUNDED =
 11617                            (CM-AH-BENEFIT-AMT * 12) / 365
 11618         COMPUTE PI-CPYAMT ROUNDED =
 11619                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11620         GO TO 1420-CHECK-AIG-BENEFIT.
 11621
 11622     IF WS-CALC-METHOD NOT = '3'
 11623        GO TO 1410-CHECK-PAYMENT.
 11624
 11625******   CALCULATION METHOD  3  ROUTINE
 11626     COMPUTE PI-DAILY-RATE =
 11627                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11628
 11629******CHECK TO SEE IF WITHIN SAME MONTH
 11630     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 223
* EL156.cbl
 11631        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11632                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11633         GO TO 1420-CHECK-AIG-BENEFIT.
 11634
 11635******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11636     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11637             SAVE-ODD-DAYS-OVER = ZEROS
 11638      COMPUTE PI-CPYAMT  ROUNDED =
 11639                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11640      GO TO 1420-CHECK-AIG-BENEFIT.
 11641
 11642******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11643******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11644     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11645        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11646        IF WDF-MONTH > 12
 11647           ADD 1                 TO WDF-YEAR
 11648           SUBTRACT 12         FROM WDF-MONTH.
 11649
 11650******CONVERT THE NEW FROM MONTH TO BINARY
 11651     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11652        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11653        MOVE '4'              TO DC-OPTION-CODE
 11654        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11655        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11656
 11657     IF WDF-MONTH = WDT-MONTH AND
 11658        WDF-YEAR  = WDT-YEAR
 11659          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11660                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11661                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11662        ELSE
 11663          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11664          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11665          COMPUTE PI-CPYAMT ROUNDED =
 11666       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11667       +
 11668       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11669       +
 11670       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11671
 11672     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 224
* EL156.cbl
 11674 1410-CHECK-PAYMENT.
 11675******PAYMENT OPTION 6
 11676******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11677     IF SAVE-ELAPSED-MONTHS > ZERO
 11678        IF SAVE-ODD-DAYS-OVER = ZEROS
 11679           GO TO 1412-CHECK-TO-DAY
 11680        ELSE
 11681           IF WDF-DAY > WDT-DAY
 11682              IF WDF-MONTH = 02
 11683                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11684                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11685                  GO TO 1412-CHECK-TO-DAY
 11686              ELSE
 11687                  IF FROM-DAYS-IN-MONTH = 31
 11688                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11689                     GO TO 1412-CHECK-TO-DAY
 11690                  ELSE
 11691                     GO TO 1412-CHECK-TO-DAY
 11692           ELSE
 11693               GO TO 1412-CHECK-TO-DAY.
 11694
 11695     IF WDF-MONTH NOT = WDT-MONTH
 11696        IF WDF-MONTH = 02
 11697           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11698           IF WDF-DAY = 29
 11699              ADD 1              TO SAVE-ODD-DAYS-OVER
 11700           ELSE
 11701              ADD 2              TO SAVE-ODD-DAYS-OVER
 11702        ELSE
 11703           IF FROM-DAYS-IN-MONTH = 31
 11704              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11705
 11706 1412-CHECK-TO-DAY.
 11707        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11708           IF WDT-DAY = 28
 11709              ADD 2              TO SAVE-ODD-DAYS-OVER
 11710           ELSE
 11711              IF WDT-DAY = 29
 11712                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11713              ELSE
 11714                 NEXT SENTENCE
 11715        ELSE
 11716           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11717              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11718
 11719     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11720     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11721     COMPUTE PI-CPYAMT ROUNDED =
 11722         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11723         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11724
 11725     GO TO 1420-CHECK-AIG-BENEFIT.
 11726
 11727 1415-CHECK-LEAP-YEAR.
 11728     IF FROM-DAYS-IN-MONTH = 29
 11729        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11730
 11731 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 225
* EL156.cbl
 11732     EXIT.
 11733
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 226
* EL156.cbl
 11735 1420-CHECK-AIG-BENEFIT.
 11736
 11737     IF WS-SPECIAL-CALC-CD = 'Q'
 11738         GO TO 1425-CHECK-WHOLE-MONTH.
 11739
 11740*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11741*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11742*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11743*       (PI-PMTTYPE = '1' OR '2')
 11744*        NEXT SENTENCE
 11745*    ELSE
 11746         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11747         GO TO 1430-CHECK-AH-TOLERANCE.
 11748
 11749******************AIG LOGIC STARTS**********************
 11750*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11751*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11752*    MOVE ER-3533      TO EMI-ERROR.
 11753*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11754*    GO TO 1430-CHECK-AH-TOLERANCE.
 11755******************AIG LOGIC ENDS************************
 11756
 11757 1425-CHECK-WHOLE-MONTH.
 11758******************************************************************
 11759****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11760****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11761****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11762****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11763****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11764****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11765****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11766****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11767****          PAID * MONTHLY BENEFIT.                         ****
 11768******************************************************************
 11769
 11770     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11771
 11772     IF CL-NO-OF-PMTS-MADE > +0
 11773         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11774
 11775     IF PI-CDAYS < WS-BEN-DAYS
 11776         GO TO 1430-CHECK-AH-TOLERANCE.
 11777
 11778     IF PI-CDAYS = WS-BEN-DAYS
 11779         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11780         GO TO 1430-CHECK-AH-TOLERANCE.
 11781
 11782*    IF PI-COMPANY-ID = 'ACM'
 11783*       NEXT SENTENCE
 11784*    ELSE
 11785        GO TO 1425-NOT-ACM-W15C.
 11786
 11787*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11788*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11789*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11790*    MOVE '6'                    TO  DC-OPTION-CODE.
 11791*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11792*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 227
* EL156.cbl
 11793*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11794*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11795*       MOVE '1'                 TO  DC-OPTION-CODE
 11796*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11797*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11798*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11799*       IF NO-CONVERSION-ERROR
 11800*          IF (DC-ELAPSED-MONTHS > +0) OR
 11801*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11802*             NEXT SENTENCE
 11803*          ELSE
 11804*             MOVE +0            TO  PI-CPYAMT
 11805*             MOVE ER-0846       TO  EMI-ERROR
 11806*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11807*             GO TO 1430-CHECK-AH-TOLERANCE
 11808*       ELSE
 11809*           MOVE ER-0846         TO  EMI-ERROR
 11810*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11811*           GO TO 1430-CHECK-AH-TOLERANCE.
 11812*
 11813*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11814*       ADD +1 TO DC-ELAPSED-MONTHS.
 11815*
 11816*    COMPUTE PI-CPYAMT ROUNDED =
 11817*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11818*
 11819*    GO TO 1430-CHECK-AH-TOLERANCE.
 11820
 11821 1425-NOT-ACM-W15C.
 11822
 11823     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11824     MOVE '6'                        TO  DC-OPTION-CODE.
 11825     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11826     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11827
 11828     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11829     IF NO-CONVERSION-ERROR
 11830         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11831     ELSE
 11832         MOVE ER-0846                TO  EMI-ERROR
 11833         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11834         GO TO 1430-CHECK-AH-TOLERANCE.
 11835
 11836     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11837     MOVE '1'                        TO  DC-OPTION-CODE.
 11838     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11839     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11840     IF NO-CONVERSION-ERROR
 11841         IF DC-ODD-DAYS-OVER = +0
 11842             NEXT SENTENCE
 11843         ELSE
 11844             MOVE ER-0846            TO  EMI-ERROR
 11845             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11846             GO TO 1430-CHECK-AH-TOLERANCE
 11847     ELSE
 11848         MOVE ER-0846                TO  EMI-ERROR
 11849         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11850         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 228
* EL156.cbl
 11851
 11852     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11853         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11854
 11855     GO TO 1430-CHECK-AH-TOLERANCE.
 11856
 11857 1425-CONT-WHOLE-MONTH-PMTS.
 11858******************************************************************
 11859****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11860****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11861****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11862******************************************************************
 11863
 11864     IF PI-COMPANY-ID = 'ACM'
 11865        NEXT SENTENCE
 11866     ELSE
 11867        IF DC-ODD-DAYS-OVER = +0
 11868            NEXT SENTENCE
 11869        ELSE
 11870            MOVE ER-0845            TO  EMI-ERROR
 11871            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11872            GO TO 1430-CHECK-AH-TOLERANCE.
 11873
 11874     COMPUTE PI-CPYAMT ROUNDED =
 11875                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11876
 11877 1430-CHECK-AH-TOLERANCE.
 11878     IF PI-PMT-APPR-SW = 'G'
 11879         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11880
 11881*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11882*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11883*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11884*
 11885*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11886*      IF WDF-MONTH = 02
 11887*        IF SAVE-ELAPSED-MONTHS = 0
 11888*          NEXT SENTENCE
 11889*        ELSE
 11890*          IF SAVE-ODD-DAYS-OVER > 0
 11891*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11892*            COMPUTE WS-PMT-MOS ROUNDED =
 11893*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11894*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11895*                                     WS-PMT-MOS
 11896*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11897*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11898*          ELSE
 11899*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11900*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11901*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11902*                                     WS-PMT-MOS.
 11903
 11904     IF WS-MAX-PMT-TOL NOT = ZERO
 11905        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11906           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11907            MOVE ER-0494         TO  EMI-ERROR
 11908            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 229
* EL156.cbl
 11909            GO TO 1500-EDIT-EXPENSES.
 11910
 11911 1430-CONT-CHECK-AH-TOLERANCE.
 11912
 11913     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11914        GO TO 1500-EDIT-EXPENSES.
 11915
 11916     IF CM-O-B-COVERAGE
 11917        GO TO 1500-EDIT-EXPENSES.
 11918
 11919     IF PI-COMPANY-ID = 'NCL'
 11920       IF FOUND-TOL-SW = 'Y'
 11921         IF WS-PMT-TOL NOT = ZERO
 11922           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11923              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11924                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11925                  IF WS-NCL-PMT-OPTION = SPACES
 11926                      MOVE ER-0699 TO EMI-ERROR
 11927                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11928                  ELSE
 11929                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11930                      NEXT SENTENCE
 11931                  ELSE
 11932                  IF NOT WS-VALID-NCL-OPTION
 11933                      MOVE ER-0699 TO EMI-ERROR
 11934                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11935
 11936     if pi-company-id = 'DCC'
 11937        and pdef-found
 11938        and pi-cpyamt < pi-epyamt
 11939           move er-1657          to emi-error
 11940           perform 1490-payment-error
 11941                                 thru 1490-exit
 11942     else
 11943        IF WS-PMT-TOL NOT = ZERO
 11944           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 11945              or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11946              MOVE ER-0495       TO EMI-ERROR
 11947              PERFORM 1490-PAYMENT-ERROR
 11948                                 THRU 1490-EXIT
 11949           end-if
 11950        end-if
 11951     end-if
 11952
 11953     GO TO 1500-EDIT-EXPENSES.
 11954
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 230
* EL156.cbl
 11956 1440-COMPUTE-LIFE-REMAINING.
 11957
 11958     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11959        IF PI-PMTTYPE = '4'
 11960          MOVE PI-EPYAMT TO PI-CPYAMT
 11961          GO TO 1460-TEST-TYPE.
 11962
 11963     IF WS-LF-COVERAGE-TYPE = 'L'
 11964        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11965                          - CL-TOTAL-PAID-AMT
 11966        GO TO 1450-CHECK-MAX.
 11967
 11968     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11969        PI-LF-COVERAGE-TYPE = 'P'
 11970          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11971                              CM-LF-ITD-DEATH-AMT
 11972          GO TO 1450-CHECK-MAX.
 11973
 11974     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11975     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11976     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11977     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11978     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11979     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11980     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11981     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11982     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11983
 11984     PERFORM 9800-LINK-REM-TERM.
 11985
 11986     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11987     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11988     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11989     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 11990     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 11991     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 11992     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 11993     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 11994     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 11995     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 11996     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11997     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11998     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 11999     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12000     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12001     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12002     IF PI-COMPANY-ID = 'DCC'
 12003        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12004        MOVE PI-CARRIER          TO ACCT-CARRIER
 12005        MOVE PI-GROUPING         TO ACCT-GROUPING
 12006        MOVE PI-STATE            TO ACCT-STATE
 12007        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12008        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12009        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12010        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12011
 12012
 12013* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 231
* EL156.cbl
 12014*          DATASET ('ERACCT')
 12015*          RIDFLD  (ERACCT-KEY)
 12016*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12017*          GTEQ
 12018*          resp    (WS-RESPONSE)
 12019*       END-EXEC
 12020     MOVE 'ERACCT' TO DFHEIV1
 12021*    MOVE '&"S        G          (  N#00011458' TO DFHEIV0
 12022     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12024     MOVE X'204E233030303131343538' TO DFHEIV0(25:11)
 12025     CALL 'kxdfhei1' USING DFHEIV0,
 12026           DFHEIV1,
 12027           DFHEIV20,
 12028           DFHEIV99,
 12029           ERACCT-KEY,
 12030           DFHEIV99,
 12031           DFHEIV99,
 12032           DFHEIV99
 12033     SET ADDRESS OF ACCOUNT-MASTER TO
 12034         DFHEIV20
 12035     MOVE EIBRESP  TO WS-RESPONSE
 12036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12037        IF WS-RESP-NORMAL
 12038           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12039           and (pi-cert-eff-dt < am-expiration-dt)
 12040           and (pi-cert-eff-dt >= am-effective-dt)
 12041           move am-dcc-product-code to pi-dcc-product-code
 12042        else
 12043           move spaces           to pi-dcc-product-code
 12044        end-if
 12045        if pi-dcc-product-code not = spaces
 12046           MOVE ' '              TO WS-PDEF-RECORD-SW
 12047           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12048           PERFORM 0900-GET-DDF-FACTORS
 12049                                 THRU 0900-EXIT
 12050           IF PDEF-FOUND
 12051              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12052                 (P1 > +8)
 12053                 OR (PD-PROD-CODE (P1) = 'L')
 12054              END-PERFORM
 12055              IF P1 < +9
 12056                 MOVE PD-MAX-AMT (P1)
 12057                                 TO CP-R-MAX-TOT-BEN
 12058              END-IF
 12059           END-IF
 12060        end-if
 12061     END-IF
 12062
 12063* EXEC CICS LINK
 12064*       PROGRAM  (LINK-REMAMT)
 12065*       COMMAREA (CALCULATION-PASS-AREA)
 12066*       LENGTH   (CP-COMM-LENGTH)
 12067*    END-EXEC.
 12068*    MOVE '."C                   (   #00011490' TO DFHEIV0
 12069     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12071     MOVE X'2020233030303131343930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 232
* EL156.cbl
 12072     CALL 'kxdfhei1' USING DFHEIV0,
 12073           LINK-REMAMT,
 12074           CALCULATION-PASS-AREA,
 12075           CP-COMM-LENGTH,
 12076           DFHEIV99,
 12077           DFHEIV99,
 12078           DFHEIV99,
 12079           DFHEIV99
 12080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12081
 12082
 12083     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12084
 12085     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12086     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12087
 12088     IF PI-COMPANY-ID = 'BOA' AND
 12089        PI-PMTTYPE    = '2'   AND
 12090        PI-OFFLINE    = 'N'
 12091           GO TO 1441-COMPUTE-BOA-INTEREST.
 12092
 12093     IF PI-COMPANY-ID = 'NCL' AND
 12094        PI-PMTTYPE    = '2'   AND
 12095        PI-OFFLINE    = 'N'
 12096          GO TO 1442-COMPUTE-NCL-INTEREST
 12097       ELSE
 12098          GO TO 1445-CONTINUE.
 12099
 12100 1441-COMPUTE-BOA-INTEREST.
 12101     MOVE +0             TO WS-CALC-INT.
 12102
 12103     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12104     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12105     MOVE +0             TO DC-ELAPSED-MONTHS
 12106                            DC-ELAPSED-DAYS.
 12107     MOVE '1'            TO DC-OPTION-CODE.
 12108     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12109     IF NO-CONVERSION-ERROR
 12110         NEXT SENTENCE
 12111     ELSE
 12112         GO TO 1445-CONTINUE.
 12113
 12114     IF (PI-INT-RATE NOT > ZEROS)  AND
 12115        (DC-ELAPSED-DAYS > +30)
 12116         MOVE ER-3531            TO EMI-ERROR
 12117         MOVE -1                 TO PINTL
 12118         MOVE AL-UNBON           TO PINTA
 12119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12120
 12121     IF PI-EPYAMT NOT > ZEROS
 12122         GO TO 1445-CONTINUE.
 12123
 12124     IF (PI-INT-RATE NOT > ZEROS)  OR
 12125        (DC-ELAPSED-DAYS NOT > +30)
 12126         MOVE PI-EPYAMT TO PI-CPYAMT
 12127         GO TO 1441-FORMAT-NOTE.
 12128
 12129     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 233
* EL156.cbl
 12130                                 *  PI-INT-RATE
 12131                                 *  DC-ELAPSED-DAYS
 12132                                 /  365
 12133                                 /  100.
 12134
 12135     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12136
 12137 1441-FORMAT-NOTE.
 12138
 12139     MOVE SPACES        TO WS-BOANOTE1.
 12140     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12141     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12142     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12143     MOVE AL-UANON      TO NOTE1A.
 12144
 12145     IF WS-CALC-INT > ZEROS
 12146         MOVE SPACES        TO WS-BOANOTE2
 12147         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12148         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12149         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12150         MOVE AL-UANON      TO NOTE2A.
 12151
 12152     GO TO 1445-CONTINUE.
 12153
 12154 1442-COMPUTE-NCL-INTEREST.
 12155     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12156     MOVE PI-STATE               TO WS-ST-ACCESS.
 12157     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12158     MOVE '3'                    TO CNTL-REC-TYPE.
 12159     MOVE +0                     TO CNTL-SEQ-NO.
 12160     MOVE 'STAT'                 TO FILE-SWITCH.
 12161
 12162     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12163
 12164     MOVE +0                 TO WS-CALC-INT.
 12165
 12166     IF ST-STAT-FROM-INCURRED
 12167         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12168       ELSE
 12169     IF ST-STAT-FROM-REPORTED
 12170         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12171       ELSE
 12172         GO TO 1445-CONTINUE.
 12173
 12174     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12175     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12176     MOVE +0                 TO DC-ELAPSED-MONTHS
 12177                                DC-ELAPSED-DAYS.
 12178     MOVE '1'                TO DC-OPTION-CODE.
 12179     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12180     IF NO-CONVERSION-ERROR
 12181         NEXT SENTENCE
 12182     ELSE
 12183         GO TO 1445-CONTINUE.
 12184
 12185     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12186        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12187         GO TO 1445-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 234
* EL156.cbl
 12188
 12189     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12190                                 *  CF-ST-STAT-INTEREST.
 12191
 12192     MOVE SPACES              TO WS-NCLNOTE1.
 12193     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12194     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12195     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12196                                 PI-PMTNOTE1
 12197                                 NOTE1I.
 12198     MOVE AL-UANON            TO NOTE1A.
 12199
 12200     IF WS-CALC-INT > ZEROS
 12201         MOVE SPACES          TO WS-NCLNOTE2
 12202         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12203         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12204         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12205                                 PI-PMTNOTE2
 12206                                 NOTE2I
 12207         MOVE AL-UANON        TO NOTE2A.
 12208
 12209     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12210
 12211 1445-CONTINUE.
 12212
 12213     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12214        GO TO 1460-TEST-TYPE.
 12215
 12216     IF CM-O-B-COVERAGE
 12217        GO TO 1460-TEST-TYPE.
 12218
 12219     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12220         GO TO 1450-CHECK-MAX.
 12221
 12222     if pi-company-id = 'DCC'
 12223        and pdef-found
 12224        and pi-epyamt > pd-max-amt (p1)
 12225        move er-1657             to emi-error
 12226        perform 1490-payment-error
 12227                                 thru 1490-exit
 12228        go to 1460-test-type
 12229     else
 12230        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12231           > PI-EPYAMT)
 12232                         OR
 12233           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12234           < PI-EPYAMT)
 12235           MOVE ER-0594          TO EMI-ERROR
 12236           PERFORM 1490-PAYMENT-ERROR
 12237                                 THRU 1490-EXIT
 12238           GO TO 1460-TEST-TYPE
 12239        end-if
 12240     end-if
 12241     .
 12242 1450-CHECK-MAX.
 12243
 12244     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12245        PI-LF-COVERAGE-TYPE = 'P'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 235
* EL156.cbl
 12246         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12247                                   CM-LF-ITD-DEATH-AMT
 12248     ELSE
 12249         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12250                                   CL-TOTAL-PAID-AMT.
 12251
 12252     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12253          MOVE ER-0543           TO EMI-ERROR
 12254          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12255
 12256 1460-TEST-TYPE.
 12257
 12258     IF PI-PMT-APPR-SW = 'G'
 12259       NEXT SENTENCE
 12260     ELSE
 12261       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12262         IF PI-EPYAMT = ZERO
 12263             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12264                 MOVE ER-0494    TO  EMI-ERROR
 12265                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12266                 GO TO 1500-EDIT-EXPENSES
 12267             ELSE
 12268                 NEXT SENTENCE
 12269         ELSE
 12270             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12271                 MOVE ER-0494    TO  EMI-ERROR
 12272                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12273                 GO TO 1500-EDIT-EXPENSES.
 12274
 12275     IF PI-PMTTYPE NOT = '2' OR
 12276        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12277         GO TO 1500-EDIT-EXPENSES.
 12278
 12279     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12280     MOVE ER-0526                TO EMI-ERROR.
 12281     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12282
 12283     IF EMI-ERROR-NUMBER (1) = '0526'
 12284        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12285
 12286     IF EMI-ERROR-NUMBER (2) = '0526'
 12287        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12288
 12289     GO TO 1500-EDIT-EXPENSES.
 12290
 12291 1490-PAYMENT-ERROR.
 12292     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12293
 12294     IF EMI-MESSAGE-FORMATTED
 12295         MOVE -1                 TO EPYAMTL
 12296         MOVE AL-UNBON           TO EPYAMTA.
 12297
 12298 1490-EXIT.
 12299      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 236
* EL156.cbl
 12301 1500-EDIT-EXPENSES.
 12302     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12303         GO TO 1500-SKIP-ERROR-0556.
 12304
 12305 1500-CONTINUE-ON.
 12306
 12307     IF CM-O-B-COVERAGE
 12308        MOVE ER-0556             TO EMI-ERROR
 12309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12310
 12311 1500-SKIP-ERROR-0556.
 12312     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12313        IF PI-EEXPENS NOT = ZEROS
 12314           MOVE ER-0524          TO EMI-ERROR
 12315           GO TO 1590-EXPENSE-ERROR
 12316        ELSE
 12317           GO TO 1600-EDIT-RESERVES.
 12318
 12319     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12320     MOVE '6'                    TO CNTL-REC-TYPE.
 12321
 12322     IF CONTROL-IS-ACTUAL-CARRIER
 12323         MOVE PI-CARRIER         TO WS-CARR
 12324     ELSE
 12325         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12326
 12327     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12328     MOVE +0                     TO CNTL-SEQ-NO.
 12329     MOVE 'CARR'                 TO FILE-SWITCH.
 12330
 12331     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12332
 12333     IF EXPENSE-CALC-MANUAL
 12334        GO TO 1600-EDIT-RESERVES.
 12335
 12336     IF DOLLARS-PER-PMT
 12337        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12338        GO TO 1600-EDIT-RESERVES.
 12339
 12340     IF DOLLARS-PER-MONTH AND
 12341        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12342       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12343       GO TO 1600-EDIT-RESERVES.
 12344
 12345     IF PERCENT-OF-PAYMENT
 12346        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12347
 12348     GO TO 1600-EDIT-RESERVES.
 12349
 12350 1590-EXPENSE-ERROR.
 12351     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12352
 12353     IF EMI-MESSAGE-FORMATTED
 12354        MOVE -1                  TO EEXPENSL
 12355        MOVE AL-UNBON            TO EEXPENSA.
 12356
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 237
* EL156.cbl
 12358 1600-EDIT-RESERVES.
 12359     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12360        IF PI-ERESV = ZEROS
 12361           GO TO 1700-EDIT-EXPENSE-TYPE
 12362        ELSE
 12363           MOVE ER-0525          TO EMI-ERROR
 12364           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12365           GO TO 1700-EDIT-EXPENSE-TYPE.
 12366
 12367     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12368     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12369     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12370
 12371     IF NOT AT-MANUAL-RESERVES-USED
 12372        IF PI-ERESV NOT = ZEROS
 12373           MOVE ER-0518          TO EMI-ERROR
 12374           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12375
 12376     IF AT-MANUAL-RESERVES-USED
 12377        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12378        GO TO 1700-EDIT-EXPENSE-TYPE.
 12379
 12380     IF AT-FUTURE-RESERVES-USED
 12381        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12382
 12383     IF AT-FUTURE-RESERVES-USED
 12384        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12385
 12386     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12387        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12388
 12389     IF AT-IBNR-RESERVES-USED
 12390        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12391
 12392     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12393     GO TO 1700-EDIT-EXPENSE-TYPE.
 12394
 12395 1690-RESERVE-ERROR.
 12396     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12397
 12398     IF EMI-MESSAGE-FORMATTED
 12399        MOVE AL-UNBON            TO ERESVA
 12400        MOVE -1                  TO ERESVL.
 12401
 12402 1690-EXIT.
 12403      EXIT.
 12404
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 238
* EL156.cbl
 12406 1700-EDIT-EXPENSE-TYPE.
 12407     IF PI-PMTTYPE NOT = '5' AND '6'
 12408        GO TO 2000-EDIT-DONE.
 12409
 12410     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12411                   '6' OR '7' OR '8' OR '9'
 12412        GO TO 2000-EDIT-DONE.
 12413
 12414 1705-EXPENSE-ERROR.
 12415     MOVE ER-0573                TO EMI-ERROR.
 12416     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12417
 12418     IF EMI-MESSAGE-FORMATTED
 12419        MOVE AL-UABON            TO ETYPEA
 12420        MOVE -1                  TO ETYPEL.
 12421
 12422     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 239
* EL156.cbl
 12424 1950-NOT-FOUND.
 12425     IF FILE-SWITCH = 'MSTR'
 12426        MOVE ER-0204             TO EMI-ERROR.
 12427
 12428     IF FILE-SWITCH = 'CARR'
 12429        MOVE ER-0252             TO EMI-ERROR.
 12430
 12431     IF FILE-SWITCH = 'COMP'
 12432        MOVE ER-0254             TO EMI-ERROR.
 12433
 12434     IF FILE-SWITCH = 'STAT'
 12435        MOVE ER-0149             TO EMI-ERROR.
 12436
 12437     IF FILE-SWITCH = 'PROC'
 12438        MOVE ER-0019             TO EMI-ERROR.
 12439
 12440     IF FILE-SWITCH = 'ACCT'
 12441        MOVE ER-0198             TO EMI-ERROR.
 12442
 12443     IF FILE-SWITCH = 'BENE'
 12444        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12445           MOVE ER-0282          TO EMI-ERROR
 12446        ELSE
 12447           MOVE ER-0283          TO EMI-ERROR.
 12448
 12449     MOVE -1                     TO PMTTYPEL.
 12450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12451
 12452     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12453                                     WS-FORCE-CTR.
 12454
 12455     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12456                                     WS-FATAL-CTR.
 12457
 12458     GO TO 8200-SEND-DATAONLY.
 12459
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 240
* EL156.cbl
 12461 2000-EDIT-DONE.
 12462     if pi-company-id = 'DCC'
 12463        and cl-critical-period > 0
 12464        perform 2210-dcc-max-benes thru 2210-exit
 12465     else
 12466     IF (WS-SPECIAL-CALC-CD = 'C')
 12467*       AND (CM-AH-CRITICAL-PERIOD) > 0
 12468        and (cl-critical-period > 0)
 12469        IF CM-AH-BENEFIT-AMT NOT = ZERO
 12470           IF PI-EPYAMT > ZEROS
 12471              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12472                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12473           ELSE
 12474              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12475                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12476           END-IF
 12477*          IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 12478           if ws-crit-period-days > cl-critical-period
 12479              MOVE ER-0657          TO EMI-ERROR
 12480              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12481           END-IF
 12482        END-IF
 12483     END-IF
 12484     end-if
 12485     IF PI-HOLDTIL NOT = ZEROS
 12486        MOVE PI-HOLDTIL          TO HOLDTILO
 12487        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12488
 12489     IF PI-EPYFROM NOT = ZEROS
 12490        MOVE PI-EPYFROM          TO EPYFROMO
 12491        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12492
 12493     IF PI-EPYTHRU NOT = ZEROS
 12494        MOVE PI-EPYTHRU            TO EPYTHRUO
 12495        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12496        IF PI-USES-PAID-TO
 12497           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12498           MOVE '4'                TO DC-OPTION-CODE
 12499           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12500           IF NO-CONVERSION-ERROR
 12501              MOVE +1              TO DC-ELAPSED-DAYS
 12502              MOVE +0              TO DC-ELAPSED-MONTHS
 12503              MOVE '6'             TO DC-OPTION-CODE
 12504              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12505              IF NO-CONVERSION-ERROR
 12506                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12507
 12508     MOVE PI-EDAYS               TO EDAYSO.
 12509
 12510     IF PI-AIGFROM NOT = ZEROS
 12511        MOVE PI-AIGFROM          TO AIGFROMO
 12512        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12513
 12514     MOVE PI-EPYAMT              TO EPYAMTO.
 12515     MOVE PI-ERESV               TO ERESVO.
 12516     MOVE PI-EEXPENS             TO EEXPENSO.
 12517
 12518     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 241
* EL156.cbl
 12519     MOVE SPACES                 TO DC-OPTION-CODE.
 12520     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12521
 12522     IF DATE-CONVERSION-ERROR
 12523        MOVE SPACES              TO CPYFROMI
 12524     ELSE
 12525        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12526        IF PI-EPYFROM = ZEROS
 12527           MOVE AL-UANON             TO EPYFROMA
 12528           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12529           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12530
 12531     IF PI-USES-PAID-TO
 12532        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12533        MOVE +1                            TO DC-ELAPSED-DAYS
 12534        MOVE +0                            TO DC-ELAPSED-MONTHS
 12535        MOVE '6'                           TO DC-OPTION-CODE
 12536        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12537        IF NO-CONVERSION-ERROR
 12538           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12539           IF PI-EPYTHRU = ZEROS
 12540              MOVE AL-UANON                TO EPYTHRUA
 12541              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12542              MOVE ' '                     TO DC-OPTION-CODE
 12543              MOVE +0                      TO DC-ELAPSED-DAYS
 12544                                              DC-ELAPSED-MONTHS
 12545              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12546              IF NO-CONVERSION-ERROR
 12547                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12548                  GO TO 2001-CONTINUE
 12549              ELSE
 12550                  GO TO 2001-CONTINUE
 12551           ELSE
 12552              GO TO 2001-CONTINUE.
 12553
 12554     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12555     MOVE SPACES                 TO DC-OPTION-CODE.
 12556     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12557
 12558     IF DATE-CONVERSION-ERROR
 12559        MOVE SPACES              TO CPYTHRUI
 12560     ELSE
 12561        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12562        IF PI-EPYTHRU = ZEROS
 12563           MOVE AL-UANON TO EPYTHRUA
 12564           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12565           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12566
 12567 2001-CONTINUE.
 12568
 12569     MOVE PI-CDAYS               TO CDAYSO.
 12570
 12571     IF PI-EDAYS = ZEROS
 12572        MOVE AL-UNNON TO EDAYSA
 12573        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12574
 12575     MOVE PI-CPYAMT              TO CPYAMTO.
 12576
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 242
* EL156.cbl
 12577     IF PI-EPYAMT = ZEROS
 12578        MOVE AL-UNNON            TO EPYAMTA
 12579        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12580
 12581     MOVE PI-CRESV               TO CRESVO.
 12582     MOVE PI-CEXPENS             TO CEXPENSO.
 12583
 12584     IF PI-EEXPENS = ZEROS
 12585        MOVE AL-UNNON TO EEXPENSA
 12586        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12587
 12588     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12589        AND (CL-CLAIM-TYPE = 'L')
 12590        AND (PI-OFFLINE NOT EQUAL 'Y')
 12591        IF PI-PMTTYPE = '2' OR '4'
 12592           PERFORM 2200-CALC-INTEREST
 12593                                 THRU 2200-EXIT
 12594        END-IF
 12595     END-IF
 12596     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12597     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12598     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12599
 12600     IF EMI-FATAL-CTR = ZEROS
 12601        MOVE 'B'                 TO PI-PASS-SW.
 12602
 12603     IF NOT EMI-MESSAGE-FORMATTED
 12604         MOVE -1                 TO EPYFROML
 12605     ELSE
 12606         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12607            EMI-ERROR-NUMBER (2) = SPACES
 12608             MOVE -1             TO EPYFROML.
 12609
 12610     GO TO 8200-SEND-DATAONLY.
 12611
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 243
* EL156.cbl
 12613 2200-CALC-INTEREST.
 12614     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12615        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12616        MOVE '4'                 TO DC-OPTION-CODE
 12617        PERFORM 9700-LINK-DATE-CONVERT
 12618        IF DATE-CONVERSION-ERROR
 12619            MOVE LOW-VALUES      TO CP-PRF-DT
 12620        ELSE
 12621           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12622        END-IF
 12623     END-IF
 12624     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12625        IN CLAIM-INT-PASS-AREA
 12626     MOVE CL-CERT-STATE          TO CP-STATE
 12627        IN CLAIM-INT-PASS-AREA
 12628     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12629     MOVE 'LF'                   TO CP-COVERAGE
 12630     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12631     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12632     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12633     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12634     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12635     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12636
 12637* EXEC CICS LINK
 12638*       PROGRAM   ('ELCLMI')
 12639*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12640*       LENGTH    (CP-CLAIM-LENGTH)
 12641*    END-EXEC
 12642     MOVE 'ELCLMI' TO DFHEIV1
 12643*    MOVE '."C                   (   #00012049' TO DFHEIV0
 12644     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12645     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12646     MOVE X'2020233030303132303439' TO DFHEIV0(25:11)
 12647     CALL 'kxdfhei1' USING DFHEIV0,
 12648           DFHEIV1,
 12649           CLAIM-INT-PASS-AREA,
 12650           CP-CLAIM-LENGTH,
 12651           DFHEIV99,
 12652           DFHEIV99,
 12653           DFHEIV99,
 12654           DFHEIV99
 12655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12656     MOVE AL-PANOF               TO PINTHA
 12657                                    PINTA
 12658     IF NO-CI-ERROR
 12659        MOVE CP-CLM-INT-AMT      TO PINTO
 12660                                    PI-INT-AMT
 12661        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12662        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12663        MOVE AL-PANOF            TO PINTHA
 12664                                    PINTA
 12665     ELSE
 12666        IF CI-RETURN-CODE = '8'
 12667           MOVE ER-3818          TO EMI-ERROR
 12668           MOVE -1               TO ZINTL
 12669           PERFORM 9900-ERROR-FORMAT
 12670                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 244
* EL156.cbl
 12671           GO TO 2200-EXIT
 12672        ELSE
 12673           MOVE ZEROS            TO PINTO
 12674                                    PI-INT-AMT
 12675                                    PI-INT-DAYS
 12676                                    PI-INT-RATE-USED
 12677        END-IF
 12678     END-IF
 12679     IF PI-INT-AMT NOT = ZEROS
 12680        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12681           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12682           CONTINUE
 12683        ELSE
 12684           MOVE CL-SOC-SEC-NO (1:3)
 12685                                 TO WS-SSN (1:3)
 12686           MOVE CL-SOC-SEC-NO (5:2)
 12687                                 TO WS-SSN (4:2)
 12688           MOVE CL-SOC-SEC-NO (8:4)
 12689                                 TO WS-SSN (6:4)
 12690           IF (WS-SSN NUMERIC)
 12691              AND (WS-SSN NOT = ZEROS)
 12692              CONTINUE
 12693           ELSE
 12694              MOVE ER-2044       TO EMI-ERROR
 12695              PERFORM 9900-ERROR-FORMAT
 12696                                 THRU 9900-EXIT
 12697           END-IF
 12698        END-IF
 12699        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12700        MOVE +51                 TO TRLR-SEQ-NO
 12701
 12702* EXEC CICS READ
 12703*          DATASET  ('ELTRLR')
 12704*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12705*          RIDFLD   (ELTRLR-KEY)
 12706*          RESP     (WS-RESPONSE)
 12707*       END-EXEC
 12708     MOVE 'ELTRLR' TO DFHEIV1
 12709*    MOVE '&"S        E          (  N#00012099' TO DFHEIV0
 12710     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12712     MOVE X'204E233030303132303939' TO DFHEIV0(25:11)
 12713     CALL 'kxdfhei1' USING DFHEIV0,
 12714           DFHEIV1,
 12715           DFHEIV20,
 12716           DFHEIV99,
 12717           ELTRLR-KEY,
 12718           DFHEIV99,
 12719           DFHEIV99,
 12720           DFHEIV99
 12721     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12722         DFHEIV20
 12723     MOVE EIBRESP  TO WS-RESPONSE
 12724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12725        IF (NOT WS-RESP-NORMAL)
 12726                    OR
 12727           ((WS-RESP-NORMAL)
 12728           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 245
* EL156.cbl
 12729           OR (AT-CITY-STATE = SPACES)))
 12730           MOVE ER-0874          TO EMI-ERROR
 12731           PERFORM 9900-ERROR-FORMAT
 12732                                 THRU 9900-EXIT
 12733        END-IF
 12734     END-IF
 12735     .
 12736 2200-EXIT.
 12737     EXIT.
 12738 2210-dcc-max-benes.
 12739
 12740     move cm-ah-benefit-amt      to ws-monthly-benefit
 12741     if pdef-found
 12742        and pd-max-amt (p1) < ws-monthly-benefit
 12743        move pd-max-amt (p1)     to ws-monthly-benefit
 12744     end-if
 12745
 12746     move cl-cert-key-data       to elcrtt-key (2:21)
 12747     move cl-company-cd          to ctrlr-comp-cd
 12748     move cl-cert-no             to ctrlr-cert-no
 12749     move 'B'                    to ctrlr-rec-type
 12750
 12751
 12752* EXEC CICS READ
 12753*       DATASET  ('ELCRTT')
 12754*       set      (address of CERTIFICATE-TRAILERS)
 12755*       RIDFLD   (ELCRTT-KEY)
 12756*       RESP     (WS-RESPONSE)
 12757*    END-EXEC
 12758     MOVE 'ELCRTT' TO DFHEIV1
 12759*    MOVE '&"S        E          (  N#00012131' TO DFHEIV0
 12760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12761     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12762     MOVE X'204E233030303132313331' TO DFHEIV0(25:11)
 12763     CALL 'kxdfhei1' USING DFHEIV0,
 12764           DFHEIV1,
 12765           DFHEIV20,
 12766           DFHEIV99,
 12767           ELCRTT-KEY,
 12768           DFHEIV99,
 12769           DFHEIV99,
 12770           DFHEIV99
 12771     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12772         DFHEIV20
 12773     MOVE EIBRESP  TO WS-RESPONSE
 12774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12775     IF not WS-RESP-NORMAL
 12776        go to 2210-exit
 12777     end-if
 12778
 12779*    if instypei = 'P'
 12780*       move +1 to s1
 12781*    else
 12782*       MOVE +2 to s1
 12783*    end-if
 12784
 12785     move +1 to s1
 12786     evaluate cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 246
* EL156.cbl
 12787        when 'A'
 12788           move +1 to s2
 12789        when 'I'
 12790           move +2 to s2
 12791        when 'G'
 12792           move +3 to s2
 12793        when 'L'
 12794           move +4 to s2
 12795        when 'P'
 12796           move +5 to s2
 12797     end-evaluate
 12798
 12799     if pi-epyamt > zeros
 12800        compute ws-crit-period-days =
 12801           (cs-total-paid (s1 s2) + PI-EPYAMT)
 12802           / ws-monthly-benefit
 12803     else
 12804        compute ws-crit-period-days =
 12805           (cs-total-paid (s1 s2) + PI-CPYAMT)
 12806           / ws-monthly-benefit
 12807     end-if
 12808
 12809     if ws-crit-period-days > pd-crit-period (p1)
 12810        move er-1658             to emi-error
 12811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12812     end-if
 12813
 12814     .
 12815 2210-exit.
 12816     exit.
 12817
 12818 2220-update-elcrtt.
 12819
 12820
 12821* EXEC CICS GETMAIN
 12822*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 12823*       LENGTH   (ELCRTT-LENGTH)
 12824*       INITIMG  (GETMAIN-SPACE)
 12825*    END-EXEC
 12826*    MOVE ',"IL                  $   #00012182' TO DFHEIV0
 12827     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12829     MOVE X'2020233030303132313832' TO DFHEIV0(25:11)
 12830     CALL 'kxdfhei1' USING DFHEIV0,
 12831           DFHEIV20,
 12832           ELCRTT-LENGTH,
 12833           GETMAIN-SPACE
 12834     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12835         DFHEIV20
 12836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12837
 12838     move cl-cert-key-data       to elcrtt-key (2:21)
 12839     move cl-company-cd          to ctrlr-comp-cd
 12840     move cl-cert-no             to ctrlr-cert-no
 12841     move 'B'                    to ctrlr-rec-type
 12842
 12843
 12844* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 247
* EL156.cbl
 12845*       UPDATE
 12846*       DATASET  (ELCRTT-DSID)
 12847*       into     (CERTIFICATE-TRAILERS)
 12848*       RIDFLD   (ELCRTT-KEY)
 12849*       RESP     (WS-RESPONSE)
 12850*    END-EXEC
 12851     MOVE LENGTH OF
 12852      CERTIFICATE-TRAILERS
 12853       TO DFHEIV11
 12854*    MOVE '&"IL       EU         (  N#00012193' TO DFHEIV0
 12855     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12856     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12857     MOVE X'204E233030303132313933' TO DFHEIV0(25:11)
 12858     CALL 'kxdfhei1' USING DFHEIV0,
 12859           ELCRTT-DSID,
 12860           CERTIFICATE-TRAILERS,
 12861           DFHEIV11,
 12862           ELCRTT-KEY,
 12863           DFHEIV99,
 12864           DFHEIV99,
 12865           DFHEIV99
 12866     MOVE EIBRESP  TO WS-RESPONSE
 12867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12868
 12869     IF WS-RESP-NORMAL
 12870        perform 2225-upd-crt-trlr thru 2225-exit
 12871
 12872* EXEC CICS REWRITE
 12873*          DATASET  (ELCRTT-DSID)
 12874*          from     (CERTIFICATE-TRAILERS)
 12875*          RESP     (WS-RESPONSE)
 12876*       END-EXEC
 12877     MOVE LENGTH OF
 12878      CERTIFICATE-TRAILERS
 12879       TO DFHEIV11
 12880*    MOVE '&& L                  %  N#00012203' TO DFHEIV0
 12881     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12882     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12883     MOVE X'204E233030303132323033' TO DFHEIV0(25:11)
 12884     CALL 'kxdfhei1' USING DFHEIV0,
 12885           ELCRTT-DSID,
 12886           CERTIFICATE-TRAILERS,
 12887           DFHEIV11,
 12888           DFHEIV99
 12889     MOVE EIBRESP  TO WS-RESPONSE
 12890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12891     else
 12892        if ws-resp-notfnd
 12893           move 'CS'             to certificate-trailers
 12894           move cl-company-cd    to cs-company-cd
 12895           move cl-cert-key-data to cs-control-primary (2:21)
 12896           move cl-cert-no       to cs-cert-no
 12897           move 'B'              to cs-trailer-type
 12898           perform varying s1 from +1 by +1 until s1 > +2
 12899              perform varying s2 from +1 by +1 until s2 > +10
 12900                 move zeros      to cs-bank (s1 s2)
 12901                                    cs-no-of-claims (s1 s2)
 12902                                    cs-days-paid (s1 s2)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 248
* EL156.cbl
 12903                                    cs-total-paid (s1 s2)
 12904              end-perform
 12905           end-perform
 12906           perform 2225-upd-crt-trlr
 12907                                 thru 2225-exit
 12908
 12909* EXEC CICS WRITE
 12910*             DATASET  (ELCRTT-DSID)
 12911*             from     (CERTIFICATE-TRAILERS)
 12912*             RIDFLD   (cs-control-primary)
 12913*             RESP     (WS-RESPONSE)
 12914*          END-EXEC
 12915     MOVE LENGTH OF
 12916      CERTIFICATE-TRAILERS
 12917       TO DFHEIV11
 12918*    MOVE '&$ L                  ''  N#00012225' TO DFHEIV0
 12919     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12920     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12921     MOVE X'204E233030303132323235' TO DFHEIV0(25:11)
 12922     CALL 'kxdfhei1' USING DFHEIV0,
 12923           ELCRTT-DSID,
 12924           CERTIFICATE-TRAILERS,
 12925           DFHEIV11,
 12926           cs-control-primary,
 12927           DFHEIV99,
 12928           DFHEIV99
 12929     MOVE EIBRESP  TO WS-RESPONSE
 12930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12931        end-if
 12932     END-IF
 12933
 12934     .
 12935 2220-exit.
 12936     exit.
 12937
 12938 2225-upd-crt-trlr.
 12939
 12940*    if instypei = 'P'
 12941*       move +1 to s1
 12942*    else
 12943*       MOVE +2 to s1
 12944*    end-if
 12945
 12946     move +1 to s1
 12947     evaluate cl-claim-type
 12948        when 'A'
 12949           move +1 to s2
 12950        when 'I'
 12951           move +2 to s2
 12952        when 'G'
 12953           move +3 to s2
 12954        when 'L'
 12955           move +4 to s2
 12956        when 'P'
 12957           move +5 to s2
 12958     end-evaluate
 12959
 12960     compute cs-total-paid (s1 s2) = cs-total-paid (s1 s2) +
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 249
* EL156.cbl
 12961        at-amount-paid
 12962     compute cs-days-paid (s1 s2) = cs-days-paid (s1 s2) +
 12963        at-days-in-period
 12964
 12965     .
 12966 2225-exit.
 12967     exit.
 12968 3000-MOVE-INPUT-TO-SAVE-AREA.
 12969     IF PMTTYPEL > 0
 12970         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12971
 12972     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12973
 12974     IF WS-PMTTYPE = '9'
 12975         MOVE 'P'                TO PI-PROVISIONAL-IND
 12976         MOVE '1'                TO WS-PMTTYPE.
 12977
 12978     IF PAYEEL > 0
 12979         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12980         MOVE PAYEEI             TO WS-PAYEE.
 12981
 12982     IF NOTE1L > +0
 12983         MOVE NOTE1I             TO WS-PMTNOTE1
 12984                                    WS-FLI-PMTNOTE
 12985                                    WS-HAN-PMTNOTE.
 12986
 12987     IF NOTE2L > +0
 12988         MOVE NOTE2I             TO WS-PMTNOTE2.
 12989
 12990     IF OFFLINEL > 0
 12991         MOVE OFFLINEI           TO WS-OFFLINE.
 12992
 12993     IF PROOFDTL > 0
 12994         MOVE PROOFDTI            TO DATE-WORK
 12995         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12996         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 12997         MOVE '4'                 TO DC-OPTION-CODE
 12998         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 12999         IF NO-CONVERSION-ERROR
 13000            MOVE NUM-WORK         TO PROOFDTO
 13001            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13002            MOVE NUM-WORK         TO WS-PROOF-DATE
 13003         ELSE
 13004            MOVE ZEROS            TO WS-PROOF-DATE
 13005         END-IF
 13006     END-IF.
 13007
 13008     IF EOBYNL > +0
 13009         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13010         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13011     END-IF
 13012
 13013     IF CLMFMYNL > +0
 13014         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13015         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13016     END-IF
 13017
 13018     IF SURVYYNL > +0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 250
* EL156.cbl
 13019         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13020         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13021     END-IF
 13022*    IF GROUPEDL > +0
 13023*        MOVE GROUPEDI           TO WS-GROUPED.
 13024*
 13025*    IF CASHL > +0
 13026*       MOVE CASHI               TO WS-CASH.
 13027     IF LOANNOL > +0
 13028         MOVE LOANNOI            TO WS-LOAN-NO.
 13029
 13030     IF CHECKNOL > 0
 13031         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13032
 13033     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13034         IF WS-AIG-CREDIT-ENTERED
 13035             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13036             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13037             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13038             MOVE AL-UANON         TO CHECKNOA.
 13039
 13040     IF HOLDTILL > 0
 13041         MOVE HOLDTILI           TO DATE-WORK
 13042         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13043         MOVE NUM-WORK           TO WS-HOLDTIL.
 13044
 13045     IF ZINTL > +0
 13046
 13047* EXEC CICS BIF DEEDIT
 13048*           FIELD   (ZINTI)
 13049*           LENGTH  (07)
 13050*       END-EXEC
 13051     MOVE 07
 13052       TO DFHEIV11
 13053*    MOVE '@"L                   #   #00012346' TO DFHEIV0
 13054     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13056     MOVE X'2020233030303132333436' TO DFHEIV0(25:11)
 13057     CALL 'kxdfhei1' USING DFHEIV0,
 13058           ZINTI,
 13059           DFHEIV11
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13061        IF ZINTI NOT NUMERIC
 13062           MOVE ER-0419          TO EMI-ERROR
 13063           PERFORM 9900-ERROR-FORMAT
 13064           MOVE AL-UABON         TO ZINTA
 13065           MOVE -1               TO ZINTL
 13066        ELSE
 13067           MOVE ZINTI            TO CP-INT-RATE
 13068                                    WS-INT-RATE
 13069           MOVE CP-INT-RATE      TO ZINTO
 13070           MOVE AL-UNNON         TO ZINTA
 13071        END-IF
 13072     ELSE
 13073        MOVE ZEROS               TO CP-INT-RATE
 13074     END-IF
 13075     IF EPYFROML > 0
 13076         MOVE EPYFROMI           TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 251
* EL156.cbl
 13077         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13078         MOVE NUM-WORK           TO WS-EPYFROM.
 13079
 13080     IF AIGFROML > 0
 13081         MOVE AIGFROMI           TO DATE-WORK
 13082         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13083         MOVE NUM-WORK           TO WS-AIGFROM
 13084     ELSE
 13085         IF (AIGFROMI = LOW-VALUES) AND
 13086            (PI-AIGFROM NOT = ZEROS)
 13087              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13088
 13089     IF EPYTHRUL > +0
 13090        MOVE EPYTHRUI           TO DATE-WORK
 13091        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13092        MOVE NUM-WORK           TO WS-EPYTHRU
 13093        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13094        MOVE '4'                TO DC-OPTION-CODE
 13095        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13096        IF NO-CONVERSION-ERROR
 13097           IF PI-USES-PAID-TO
 13098              MOVE '6'                TO DC-OPTION-CODE
 13099              MOVE -1                 TO DC-ELAPSED-DAYS
 13100              MOVE +0                 TO DC-ELAPSED-MONTHS
 13101              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13102              IF NO-CONVERSION-ERROR
 13103                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13104                 MOVE ' '             TO DC-OPTION-CODE
 13105                 MOVE +0              TO DC-ELAPSED-DAYS
 13106                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13107              IF NO-CONVERSION-ERROR
 13108                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13109
 13110*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13111*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13112     IF EDAYSL > 0
 13113
 13114* EXEC CICS BIF DEEDIT
 13115*            FIELD(EDAYSI)
 13116*            LENGTH(6)
 13117*        END-EXEC
 13118     MOVE 6
 13119       TO DFHEIV11
 13120*    MOVE '@"L                   #   #00012402' TO DFHEIV0
 13121     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13122     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13123     MOVE X'2020233030303132343032' TO DFHEIV0(25:11)
 13124     CALL 'kxdfhei1' USING DFHEIV0,
 13125           EDAYSI,
 13126           DFHEIV11
 13127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13128         MOVE EDAYSI             TO WS-DY-WORK
 13129         IF WS-DY-SIGN = SPACES
 13130            MOVE WS-DY-NUM       TO WS-EDAYS
 13131            ADD 0                TO WS-EDAYS
 13132         ELSE
 13133            MOVE EDAYSI          TO WS-EDAYS
 13134            ADD 0                TO WS-EDAYS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 252
* EL156.cbl
 13135
 13136*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13137*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13138     IF EPYAMTL > 0
 13139
 13140* EXEC CICS BIF DEEDIT
 13141*            FIELD(EPYAMTI)
 13142*            LENGTH(10)
 13143*        END-EXEC
 13144     MOVE 10
 13145       TO DFHEIV11
 13146*    MOVE '@"L                   #   #00012417' TO DFHEIV0
 13147     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13148     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13149     MOVE X'2020233030303132343137' TO DFHEIV0(25:11)
 13150     CALL 'kxdfhei1' USING DFHEIV0,
 13151           EPYAMTI,
 13152           DFHEIV11
 13153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13154         MOVE EPYAMTI            TO WS-PY-WORK
 13155         IF WS-PY-SIGN = SPACES
 13156            MOVE WS-PY-NUM       TO WS-EPYAMT
 13157            ADD 0                TO WS-EPYAMT
 13158         ELSE
 13159            MOVE EPYAMTI         TO WS-EPYAMT
 13160            ADD 0                TO WS-EPYAMT.
 13161
 13162     IF ERESVL > 0
 13163
 13164* EXEC CICS BIF DEEDIT
 13165*            FIELD(ERESVI)
 13166*            LENGTH(9)
 13167*        END-EXEC
 13168     MOVE 9
 13169       TO DFHEIV11
 13170*    MOVE '@"L                   #   #00012430' TO DFHEIV0
 13171     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13172     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13173     MOVE X'2020233030303132343330' TO DFHEIV0(25:11)
 13174     CALL 'kxdfhei1' USING DFHEIV0,
 13175           ERESVI,
 13176           DFHEIV11
 13177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13178         MOVE ERESVI TO WS-ERESV.
 13179
 13180     IF EEXPENSL > 0
 13181
 13182* EXEC CICS BIF DEEDIT
 13183*            FIELD(EEXPENSI)
 13184*            LENGTH(8)
 13185*        END-EXEC
 13186     MOVE 8
 13187       TO DFHEIV11
 13188*    MOVE '@"L                   #   #00012437' TO DFHEIV0
 13189     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13190     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13191     MOVE X'2020233030303132343337' TO DFHEIV0(25:11)
 13192     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 253
* EL156.cbl
 13193           EEXPENSI,
 13194           DFHEIV11
 13195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13196         MOVE EEXPENSI           TO WS-EEXPENS.
 13197
 13198     IF ETYPEL > ZEROS
 13199         MOVE ETYPEI             TO WS-ETYPE.
 13200
 13201     IF PI-COMPANY-ID = 'BOA'
 13202        IF PINTL > ZEROS
 13203
 13204* EXEC CICS BIF DEEDIT
 13205*            FIELD (PINTI)
 13206*            LENGTH(05)
 13207*          END-EXEC
 13208     MOVE 05
 13209       TO DFHEIV11
 13210*    MOVE '@"L                   #   #00012448' TO DFHEIV0
 13211     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13212     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13213     MOVE X'2020233030303132343438' TO DFHEIV0(25:11)
 13214     CALL 'kxdfhei1' USING DFHEIV0,
 13215           PINTI,
 13216           DFHEIV11
 13217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13218           IF PINTI NUMERIC
 13219               MOVE AL-UNNON     TO PINTA
 13220               MOVE PINTI        TO WS-INT-RATE
 13221               MOVE WS-INT-RATE  TO PINTO.
 13222
 13223 3000-EXIT.
 13224     EXIT.
 13225
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 254
* EL156.cbl
 13227 3050-REBUILD-ENTERED.
 13228
 13229     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13230
 13231     IF PI-PROV-PMT
 13232         MOVE '9'           TO PMTTYPEO
 13233     ELSE
 13234         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13235
 13236     MOVE PI-PAYEE          TO PAYEEO.
 13237     MOVE PI-PMTNOTE1       TO NOTE1O.
 13238     MOVE PI-PMTNOTE2       TO NOTE2O.
 13239     MOVE PI-OFFLINE        TO OFFLINEO.
 13240     IF PI-PROOF-DATE NOT = ZEROS
 13241         MOVE PI-PROOF-DATE TO PROOFDTO
 13242         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13243     END-IF.
 13244*    MOVE PI-GROUPED        TO GROUPEDO.
 13245
 13246*    MOVE PI-CASH           TO CASHO.
 13247
 13248     IF PI-INT-RATE > ZEROS
 13249         MOVE PI-INT-RATE   TO PINTO.
 13250
 13251     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13252        IF PI-INT-AMT > ZEROS
 13253           MOVE PI-INT-AMT       TO PINTO
 13254           MOVE AL-PANOF         TO PINTA
 13255                                    PINTHA
 13256        END-IF
 13257     END-IF
 13258     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13259     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13260     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13261     IF PI-HOLDTIL NOT = ZEROS
 13262        MOVE PI-HOLDTIL          TO HOLDTILO
 13263        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13264
 13265     IF PI-EPYFROM NOT = ZEROS
 13266        MOVE PI-EPYFROM          TO EPYFROMO
 13267        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13268
 13269     IF PI-AIGFROM NOT = ZEROS
 13270        MOVE PI-AIGFROM          TO AIGFROMO
 13271        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13272
 13273     IF PI-EPYTHRU NOT = ZEROS
 13274        MOVE PI-EPYTHRU          TO EPYTHRUO
 13275        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13276        IF PI-USES-PAID-TO
 13277           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13278           MOVE '4'                TO DC-OPTION-CODE
 13279           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13280           IF NO-CONVERSION-ERROR
 13281              MOVE +1 TO DC-ELAPSED-DAYS
 13282              MOVE +0 TO DC-ELAPSED-MONTHS
 13283              MOVE '6' TO DC-OPTION-CODE
 13284              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 255
* EL156.cbl
 13285              IF NO-CONVERSION-ERROR
 13286                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13287
 13288     IF PI-EDAYS NOT = ZEROS
 13289        MOVE PI-EDAYS TO EDAYSO.
 13290
 13291     IF PI-EPYAMT NOT = ZEROS
 13292        MOVE PI-EPYAMT TO EPYAMTO.
 13293
 13294     IF PI-ERESV NOT = ZEROS
 13295        MOVE PI-ERESV TO ERESVO.
 13296
 13297     IF PI-EEXPENS NOT = ZEROS
 13298        MOVE PI-EEXPENS TO EEXPENSO.
 13299
 13300     MOVE PI-ETYPE TO ETYPEO.
 13301
 13302     IF PI-ECHECKNO NOT = SPACES
 13303        MOVE PI-ECHECKNO         TO CHECKNOO
 13304     ELSE
 13305        MOVE PI-CCHECKNO         TO CHECKNOO.
 13306
 13307     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13308     MOVE SPACES                 TO DC-OPTION-CODE.
 13309     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13310
 13311     IF DATE-CONVERSION-ERROR
 13312        MOVE SPACES              TO CPYFROMI
 13313     ELSE
 13314        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13315
 13316     IF PI-USES-PAID-TO
 13317        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13318        MOVE +1                  TO DC-ELAPSED-DAYS
 13319        MOVE +0                  TO DC-ELAPSED-MONTHS
 13320        MOVE '6'                 TO DC-OPTION-CODE
 13321        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13322        IF NO-CONVERSION-ERROR
 13323           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13324           GO TO 3051-CONTINUE.
 13325
 13326     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13327     MOVE SPACES                 TO DC-OPTION-CODE.
 13328     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13329
 13330     IF DATE-CONVERSION-ERROR
 13331        MOVE SPACES              TO CPYTHRUI
 13332     ELSE
 13333        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13334
 13335 3051-CONTINUE.
 13336
 13337     IF PI-CDAYS NOT = ZEROS
 13338        MOVE PI-CDAYS TO CDAYSO.
 13339
 13340     IF PI-CPYAMT NOT = ZEROS
 13341        MOVE PI-CPYAMT TO CPYAMTO.
 13342
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 256
* EL156.cbl
 13343     IF PI-CRESV NOT = ZEROS
 13344        MOVE PI-CRESV TO CRESVO.
 13345
 13346     IF PI-CEXPENS NOT = ZEROS
 13347        MOVE PI-CEXPENS TO CEXPENSO.
 13348
 13349 3059-EXIT.
 13350     EXIT.
 13351
 13352 3100-DEEDIT-DATE.
 13353
 13354* EXEC CICS BIF DEEDIT
 13355*        FIELD(DATE-WORK)
 13356*        LENGTH(8)
 13357*    END-EXEC.
 13358     MOVE 8
 13359       TO DFHEIV11
 13360*    MOVE '@"L                   #   #00012587' TO DFHEIV0
 13361     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13362     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13363     MOVE X'2020233030303132353837' TO DFHEIV0(25:11)
 13364     CALL 'kxdfhei1' USING DFHEIV0,
 13365           DATE-WORK,
 13366           DFHEIV11
 13367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13368
 13369
 13370 3100-EXIT.
 13371     EXIT.
 13372
 13373 3200-CALC-AIG-DAYS.
 13374
 13375     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13376
 13377     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13378     MOVE ' '                    TO DC-OPTION-CODE.
 13379     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13380     IF NO-CONVERSION-ERROR
 13381         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13382     ELSE
 13383         GO TO 3290-ERROR.
 13384
 13385     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13386         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13387                                WS-BIN-FROM-DT
 13388     ELSE
 13389         IF CL-TOTAL-PAID-AMT > ZEROS
 13390             IF WS-SV-EPYFROM = LOW-VALUES
 13391                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13392                                        WS-BIN-FROM-DT
 13393             ELSE
 13394                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13395                                        WS-BIN-FROM-DT
 13396         ELSE
 13397             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13398                                        WS-BIN-FROM-DT.
 13399
 13400 3210-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 257
* EL156.cbl
 13401
 13402     MOVE ' '                    TO DC-OPTION-CODE.
 13403     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13404     IF DATE-CONVERSION-ERROR
 13405         GO TO 3290-ERROR.
 13406
 13407     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13408
 13409     IF PI-LOAN-DUE-DAY = 31
 13410         MOVE 30              TO WS-PMT-DUE-DA
 13411                                 WS-SAVE-DUE-DA
 13412     ELSE
 13413         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13414                                 WS-SAVE-DUE-DA.
 13415
 13416     IF (PI-LOAN-DUE-DAY > 28) AND
 13417        (WS-PMT-DUE-MO = 2)
 13418         MOVE 'Y'                TO WS-DUE-DAY-SW
 13419         MOVE 28                 TO WS-PMT-DUE-DA.
 13420
 13421     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13422     MOVE '4'                    TO DC-OPTION-CODE.
 13423     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13424     IF NO-CONVERSION-ERROR
 13425         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13426     ELSE
 13427         GO TO 3290-ERROR.
 13428
 13429*--------------------------------------------------------------*
 13430*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13431*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13432*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13433*                                                              *
 13434*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13435*             INCURRED DATE      - 04/15/91                    *
 13436*             PMT DUE DATE       - 04/03/91                    *
 13437*             PMT DUE DATE       - 05/03/91                    *
 13438*--------------------------------------------------------------*
 13439
 13440     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13441        (WS-SV-AIGFROM = LOW-VALUES)
 13442         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13443            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13444             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13445             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13446             IF NO-CONVERSION-ERROR
 13447                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13448                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13449             ELSE
 13450                 GO TO 3290-ERROR.
 13451
 13452     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13453        (WS-SV-AIGFROM = LOW-VALUES)
 13454         GO TO 3205-CONT-CALC-PMT.
 13455
 13456     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13457     MOVE ' '                    TO DC-OPTION-CODE.
 13458     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 258
* EL156.cbl
 13459     IF NO-CONVERSION-ERROR
 13460         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13461     ELSE
 13462         GO TO 3290-ERROR.
 13463
 13464     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13465        (WS-PMT-DUE-DA < WS-FROM-DA)
 13466          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13467          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13468          IF NO-CONVERSION-ERROR
 13469              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13470              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13471          ELSE
 13472              GO TO 3290-ERROR.
 13473
 13474 3205-CONT-CALC-PMT.
 13475
 13476*--------------------------------------------------------------*
 13477*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13478*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13479*--------------------------------------------------------------*
 13480
 13481     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13482        PI-PMTTYPE = '2'
 13483          NEXT SENTENCE
 13484     ELSE
 13485        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13486           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13487             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13488             MOVE ER-3527            TO EMI-ERROR
 13489             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13490             MOVE -1                 TO EPYTHRUL
 13491             MOVE AL-UNBON           TO EPYTHRUA
 13492                                        EPYFROMA
 13493             GO TO 3299-EXIT.
 13494
 13495*--------------------------------------------------------------*
 13496*    CALCULATE RETRO ELIMINATION DATE                          *
 13497*--------------------------------------------------------------*
 13498
 13499     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13500         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13501     ELSE
 13502         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13503
 13504     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13505     MOVE +0             TO DC-ELAPSED-MONTHS.
 13506     MOVE '6'            TO DC-OPTION-CODE.
 13507     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13508     IF NO-CONVERSION-ERROR
 13509         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13510     ELSE
 13511         GO TO 3290-ERROR.
 13512
 13513 3210-CHECK-PMT-DATE.
 13514
 13515*--------------------------------------------------------------*
 13516*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 259
* EL156.cbl
 13517*    THE ENTERED PAY FROM DATE                                 *
 13518*--------------------------------------------------------------*
 13519
 13520     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13521         NEXT SENTENCE
 13522     ELSE
 13523         GO TO 3220-COMPUTE-DAYS.
 13524
 13525     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13526     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13527     IF NO-CONVERSION-ERROR
 13528         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13529         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13530         GO TO 3210-CHECK-PMT-DATE
 13531     ELSE
 13532         GO TO 3290-ERROR.
 13533
 13534 3220-COMPUTE-DAYS.
 13535
 13536     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13537     MOVE ZEROS         TO WS-CDAYS.
 13538     MOVE 'N'           TO WS-ELIMINATION-SW.
 13539
 13540*--------------------------------------------------------------*
 13541*    COMPUTE CALIFORNIA DUE DAYS                               *
 13542*--------------------------------------------------------------*
 13543
 13544     IF CL-TOTAL-PAID-AMT > ZEROS
 13545         MOVE 'Y' TO WS-ELIMINATION-SW
 13546         GO TO 3240-FIRST-PMT-DUE
 13547     ELSE
 13548        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13549            NEXT SENTENCE
 13550        ELSE
 13551            GO TO 3240-FIRST-PMT-DUE.
 13552
 13553 3230-NEXT-PMT-DUE.
 13554
 13555     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13556     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13557     IF NO-CONVERSION-ERROR
 13558         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13559         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13560     ELSE
 13561         GO TO 3290-ERROR.
 13562
 13563 3240-FIRST-PMT-DUE.
 13564
 13565     IF CL-TOTAL-PAID-AMT > ZEROS
 13566         NEXT SENTENCE
 13567     ELSE
 13568        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13569            GO TO 3230-NEXT-PMT-DUE.
 13570
 13571     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13572         GO TO 3250-VERIFY-ELIMINATION.
 13573
 13574     ADD +30 TO WS-CDAYS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 260
* EL156.cbl
 13575     MOVE 'Y' TO WS-ELIMINATION-SW.
 13576     GO TO 3230-NEXT-PMT-DUE.
 13577
 13578 3250-VERIFY-ELIMINATION.
 13579
 13580     IF ELIM-SATISFIED
 13581         GO TO 3260-END-CALC.
 13582
 13583     IF PI-PMTTYPE = '1'
 13584         MOVE ZEROS TO WS-CDAYS
 13585         GO TO 3260-END-CALC.
 13586
 13587     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13588         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13589     ELSE
 13590         IF CL-TOTAL-PAID-AMT > ZEROS
 13591             IF WS-SV-EPYFROM = LOW-VALUES
 13592                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13593             ELSE
 13594                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13595         ELSE
 13596             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13597
 13598     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13599     MOVE '1'                    TO DC-OPTION-CODE.
 13600     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13601     IF NO-CONVERSION-ERROR
 13602         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13603     ELSE
 13604         GO TO 3290-ERROR.
 13605
 13606     IF CL-TOTAL-PAID-AMT > ZEROS
 13607         MOVE WS-DAYS-OFF TO WS-CDAYS
 13608     ELSE
 13609         IF PI-BEN-DAYS > WS-DAYS-OFF
 13610             MOVE ZEROS TO WS-CDAYS
 13611         ELSE
 13612             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13613
 13614 3260-END-CALC.
 13615
 13616     MOVE WS-CDAYS TO PI-CDAYS.
 13617
 13618     IF PI-EDAYS = ZEROS
 13619         MOVE PI-CDAYS TO PI-EDAYS
 13620         MOVE AL-UNNON TO EDAYSA.
 13621
 13622     GO TO 3299-EXIT.
 13623
 13624 3290-ERROR.
 13625
 13626     MOVE ER-3528            TO EMI-ERROR.
 13627     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13628     MOVE -1                 TO CDAYSL.
 13629     MOVE AL-UNBON           TO CDAYSA.
 13630
 13631 3299-EXIT.
 13632     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 261
* EL156.cbl
 13633
 13634 3300-BUMP-DATE.
 13635
 13636     IF WS-RESTORE-DUE-DAY
 13637         MOVE 'N'              TO WS-DUE-DAY-SW
 13638         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13639         ADD 1                 TO WS-PMT-DUE-MO
 13640         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13641         MOVE '4'              TO DC-OPTION-CODE
 13642         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13643         IF NO-CONVERSION-ERROR
 13644             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13645             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13646             GO TO 3399-EXIT
 13647         ELSE
 13648             MOVE '9'          TO DC-ERROR-CODE
 13649             GO TO 3399-EXIT.
 13650
 13651     IF (WS-PMT-DUE-MO = 1) AND
 13652        (WS-SAVE-DUE-DA > 28)
 13653           MOVE 'Y' TO WS-DUE-DAY-SW.
 13654
 13655     MOVE +0                 TO DC-ELAPSED-DAYS.
 13656     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13657     MOVE '6'                TO DC-OPTION-CODE.
 13658     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13659
 13660 3399-EXIT.
 13661     EXIT.
 13662
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 262
* EL156.cbl
 13664 3400-COMPUTE-EXPIRY.
 13665
 13666     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13667     MOVE +0                    TO DC-ELAPSED-DAYS
 13668                                   DC-ODD-DAYS-OVER.
 13669     MOVE '1'                   TO DC-END-OF-MONTH.
 13670     MOVE '6'                   TO DC-OPTION-CODE.
 13671
 13672     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13673         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13674     ELSE
 13675         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13676
 13677     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13678     IF NO-CONVERSION-ERROR
 13679         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13680     ELSE
 13681         GO TO 3390-CONTINUE.
 13682
 13683     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13684         GO TO 3390-CONTINUE.
 13685
 13686     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13687     MOVE '4'                    TO CNTL-REC-TYPE.
 13688     MOVE +0                     TO CNTL-SEQ-NO.
 13689     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13690     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13691     MOVE 'BENE'                 TO FILE-SWITCH.
 13692
 13693     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13694
 13695     IF NO-BENEFIT-FOUND
 13696         GO TO 3390-CONTINUE.
 13697
 13698     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13699        IF (PI-OFFLINE = 'Y') OR
 13700           (PI-PMTTYPE = '7')
 13701           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13702                                     THRU 9870-EXIT
 13703           IF ERROR-ON-OUTPUT
 13704             MOVE -1                 TO ENTERPFL
 13705             MOVE AL-UANON           TO ENTERPFA
 13706             MOVE MAP-NAMEA          TO MAP-NAME
 13707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13708             GO TO 8200-SEND-DATAONLY.
 13709
 13710     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13711        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13712        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 13713          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 13714          MOVE +0        TO DC-ELAPSED-DAYS
 13715          MOVE +1        TO DC-ELAPSED-MONTHS
 13716          MOVE 6         TO DC-OPTION-CODE
 13717          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13718          IF NO-CONVERSION-ERROR
 13719              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 13720
 13721 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 263
* EL156.cbl
 13722
 13723      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13724         MOVE CM-AH-LOAN-EXPIRE-DT
 13725                                 TO DC-BIN-DATE-1
 13726      ELSE
 13727         MOVE CM-LF-LOAN-EXPIRE-DT
 13728                                 TO DC-BIN-DATE-1
 13729      END-IF
 13730
 13731      MOVE ' '                    TO DC-OPTION-CODE.
 13732      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13733      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 13734      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 13735
 13736 3499-EXIT.
 13737     EXIT.
 13738
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 264
* EL156.cbl
 13740
 13741 3600-CHECK-VERIFICATION.
 13742
 13743     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13744
 13745     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13746
 13747     IF PI-PAYEE-TYPE = 'I'
 13748        GO TO 3600-READ-TRAILER.
 13749
 13750     IF PI-PAYEE-TYPE = 'B'
 13751        ADD +10                  TO TRLR-SEQ-NO
 13752        GO TO 3600-READ-TRAILER.
 13753
 13754     IF PI-PAYEE-TYPE = 'A'
 13755        ADD +20                  TO TRLR-SEQ-NO
 13756        GO TO 3600-READ-TRAILER.
 13757
 13758     IF PI-PAYEE-TYPE = 'O'
 13759        ADD +50                  TO TRLR-SEQ-NO
 13760        GO TO 3600-READ-TRAILER.
 13761
 13762     IF PI-PAYEE-TYPE = 'Q'
 13763        ADD +60                  TO TRLR-SEQ-NO
 13764        GO TO 3600-READ-TRAILER.
 13765
 13766     IF PI-PAYEE-TYPE = 'P'
 13767        ADD +30                  TO TRLR-SEQ-NO
 13768        GO TO 3600-READ-TRAILER.
 13769
 13770     IF PI-PAYEE-TYPE = 'E'
 13771        ADD +40                  TO TRLR-SEQ-NO.
 13772
 13773 3600-READ-TRAILER.
 13774
 13775
 13776* EXEC CICS HANDLE CONDITION
 13777*         NOTFND(3600-CONTINUE)
 13778*    END-EXEC.
 13779*    MOVE '"$I                   ! - #00012997' TO DFHEIV0
 13780     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13782     MOVE X'2D20233030303132393937' TO DFHEIV0(25:11)
 13783     CALL 'kxdfhei1' USING DFHEIV0
 13784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13785
 13786
 13787     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13788
 13789 3600-CONTINUE.
 13790
 13791     IF PI-VFY-2ND-BENE = 'Y'
 13792       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 13793         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 13794           MOVE ER-7576            TO EMI-ERROR
 13795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13796           MOVE -1                 TO PAYEEL
 13797           MOVE AL-UABON           TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 265
* EL156.cbl
 13798           GO TO 3600-EXIT
 13799         END-IF
 13800       END-IF
 13801     END-IF.
 13802
 13803     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13804     MOVE 1 TO WS-SUB2
 13805     MOVE SPACES TO WS-PAYEE-NAME
 13806     PERFORM VARYING WS-SUB FROM 1 BY 1
 13807             UNTIL WS-SUB > 30
 13808         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13809            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13810                 WS-PAYEE-NAME-X (WS-SUB2)
 13811            ADD +1 TO WS-SUB2
 13812         END-IF
 13813     END-PERFORM.
 13814
 13815     STRING CL-INSURED-1ST-NAME
 13816            CL-INSURED-MID-INIT
 13817            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13818     MOVE 1 TO WS-SUB2
 13819     MOVE SPACES TO WS-INSURED-NAME
 13820     PERFORM VARYING WS-SUB FROM 1 BY 1
 13821             UNTIL WS-SUB > 30
 13822         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13823            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13824                 WS-INSURED-NAME-X (WS-SUB2)
 13825            ADD +1 TO WS-SUB2
 13826         END-IF
 13827     END-PERFORM.
 13828
 13829     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13830        MOVE ER-7579            TO EMI-ERROR
 13831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13832        MOVE -1                 TO PAYEEL
 13833        MOVE AL-UABON           TO PAYEEA
 13834     END-IF.
 13835
 13836 3600-EXIT.
 13837     EXIT.
 13838
 13839 5000-UPDATE.
 13840
 13841     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13842
 13843     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13844
 13845     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13846        PI-OFFLINE = 'Y'
 13847        NEXT SENTENCE
 13848     ELSE
 13849        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13850
 13851*    IF PI-COMPANY-ID = 'CRI'
 13852*       IF PI-PMTTYPE = '1' OR  '2'
 13853*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13854*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13855*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 266
* EL156.cbl
 13856
 13857*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13858*       IF PI-PMTTYPE = '1'
 13859*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13860*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13861
 13862     IF PI-PMTTYPE      = '2' AND
 13863        PI-SPLIT-PMT-SW = 'Y' AND
 13864        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13865          MOVE ER-3530                TO EMI-ERROR
 13866          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13867
 13868     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13869        AND (CL-CLAIM-TYPE = 'L')
 13870        IF PI-PMTTYPE = '2' OR '4'
 13871           IF PI-INT-AMT NOT = ZEROS
 13872              PERFORM 7110-BUILD-PMT-TRLR
 13873                                 THRU 7130-EXIT
 13874           ELSE
 13875              IF PI-PMTTYPE = '2'
 13876                 PERFORM 7140-BUILD-NOTE-TRLR
 13877                                 THRU 7170-EXIT
 13878              END-IF
 13879           END-IF
 13880        END-IF
 13881     END-IF
 13882*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13883*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13884*            MOVE 'N'                 TO  WS-LETTER-SW.
 13885
 13886*    IF PI-COMPANY-ID = 'DMD'
 13887*        IF CL-NO-OF-PMTS-MADE = +1
 13888*                OR
 13889*           PI-PMTTYPE = '2'
 13890*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13891
 13892     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13893
 13894*    IF PI-COMPANY-ID = 'DMD'
 13895*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13896*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13897
 13898
 13899* EXEC CICS REWRITE
 13900*         DATASET('ELMSTR')
 13901*         FROM(CLAIM-MASTER)
 13902*     END-EXEC.
 13903     MOVE LENGTH OF
 13904      CLAIM-MASTER
 13905       TO DFHEIV11
 13906     MOVE 'ELMSTR' TO DFHEIV1
 13907*    MOVE '&& L                  %   #00013112' TO DFHEIV0
 13908     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13909     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13910     MOVE X'2020233030303133313132' TO DFHEIV0(25:11)
 13911     CALL 'kxdfhei1' USING DFHEIV0,
 13912           DFHEIV1,
 13913           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 267
* EL156.cbl
 13914           DFHEIV11,
 13915           DFHEIV99
 13916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13917
 13918
 13919     IF WS-LETTER-SW = 'N'
 13920         GO TO 5000-END-UPDATE.
 13921
 13922 5000-GENERATE-AUTO-LETTER.
 13923
 13924
 13925* EXEC CICS LINK
 13926*        PROGRAM    (LINK-1523)
 13927*        COMMAREA   (W-1523-LINKDATA)
 13928*        LENGTH     (W-1523-COMM-LENGTH)
 13929*    END-EXEC.
 13930*    MOVE '."C                   (   #00013122' TO DFHEIV0
 13931     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13933     MOVE X'2020233030303133313232' TO DFHEIV0(25:11)
 13934     CALL 'kxdfhei1' USING DFHEIV0,
 13935           LINK-1523,
 13936           W-1523-LINKDATA,
 13937           W-1523-COMM-LENGTH,
 13938           DFHEIV99,
 13939           DFHEIV99,
 13940           DFHEIV99,
 13941           DFHEIV99
 13942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13943
 13944
 13945     IF W-1523-FATAL-ERROR
 13946         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13948         MOVE ER-0802                TO  EMI-ERROR
 13949         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13950
 13951     IF W-1523-ERROR-CODE = 0191
 13952         MOVE ER-0803                TO  EMI-ERROR
 13953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13954
 13955     IF PI-COMPANY-ID      = 'HAN' AND
 13956        PI-PMTTYPE         = '1'   AND
 13957        PI-3RD-PARTY-SW    = 'Y'   AND
 13958        W-1523-FORM-NUMBER = 'EOB1'
 13959           MOVE LOW-VALUES              TO W-1523-LINKDATA
 13960           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 13961           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 13962           GO TO 5000-GENERATE-AUTO-LETTER.
 13963
 13964 5000-END-UPDATE.
 13965
 13966     MOVE ER-0000                TO EMI-ERROR.
 13967     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13968     GO TO 7000-SHOW-CLAIM.
 13969
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 268
* EL156.cbl
 13971 5000-MOVE-NAME.
 13972     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13973     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13974     MOVE CL-INSURED-MID-INIT    TO MINITO.
 13975
 13976 5000-EXIT.
 13977     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 269
* EL156.cbl
 13979 5300-CREATE-DMO.
 13980
 13981     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 13982     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 13983     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 13984
 13985
 13986* EXEC CICS HANDLE CONDITION
 13987*         NOTFND   (5300-NOTE-NOT-FOUND)
 13988*    END-EXEC.
 13989*    MOVE '"$I                   ! . #00013168' TO DFHEIV0
 13990     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13992     MOVE X'2E20233030303133313638' TO DFHEIV0(25:11)
 13993     CALL 'kxdfhei1' USING DFHEIV0
 13994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13995
 13996
 13997
 13998* EXEC CICS READ
 13999*         DATASET('ERNOTE')
 14000*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14001*         RIDFLD (W-NOTE-KEY)
 14002*    END-EXEC.
 14003     MOVE 'ERNOTE' TO DFHEIV1
 14004*    MOVE '&"S        E          (   #00013172' TO DFHEIV0
 14005     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14006     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14007     MOVE X'2020233030303133313732' TO DFHEIV0(25:11)
 14008     CALL 'kxdfhei1' USING DFHEIV0,
 14009           DFHEIV1,
 14010           DFHEIV20,
 14011           DFHEIV99,
 14012           W-NOTE-KEY,
 14013           DFHEIV99,
 14014           DFHEIV99,
 14015           DFHEIV99
 14016     SET ADDRESS OF CERTIFICATE-NOTE TO
 14017         DFHEIV20
 14018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14019
 14020
 14021     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14022     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14023     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14024
 14025     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14026         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14027     ELSE
 14028         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14029
 14030     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14031     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14032     MOVE 'DLO006'               TO PGM-NAME.
 14033
 14034
 14035* EXEC CICS LINK
 14036*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 270
* EL156.cbl
 14037*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14038*        LENGTH     (DCT-RCRD-LENGTH)
 14039*    END-EXEC.
 14040*    MOVE '."C                   (   #00013191' TO DFHEIV0
 14041     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14043     MOVE X'2020233030303133313931' TO DFHEIV0(25:11)
 14044     CALL 'kxdfhei1' USING DFHEIV0,
 14045           PGM-NAME,
 14046           DCT-COMMUNICATION-AREA,
 14047           DCT-RCRD-LENGTH,
 14048           DFHEIV99,
 14049           DFHEIV99,
 14050           DFHEIV99,
 14051           DFHEIV99
 14052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14053
 14054
 14055     IF DCT-RETURN-CODE = 'OK'
 14056         GO TO 5300-CONT.
 14057
 14058     IF DCT-RETURN-CODE = '01' OR '02'
 14059         GO TO 5300-EXIT.
 14060
 14061     IF DCT-RETURN-CODE = '03'
 14062         MOVE ER-0951            TO EMI-ERROR
 14063         GO TO 5300-BAD-EXIT.
 14064
 14065     IF DCT-RETURN-CODE = '04'
 14066         MOVE ER-0946            TO EMI-ERROR
 14067         GO TO 5300-BAD-EXIT.
 14068
 14069     IF DCT-RETURN-CODE = '05'
 14070         MOVE ER-0947            TO EMI-ERROR
 14071         GO TO 5300-BAD-EXIT.
 14072
 14073     IF DCT-RETURN-CODE = '06'
 14074         MOVE ER-0921            TO EMI-ERROR
 14075         GO TO 5300-BAD-EXIT.
 14076
 14077     IF DCT-RETURN-CODE = '07'
 14078         MOVE ER-0849            TO EMI-ERROR
 14079         GO TO 5300-BAD-EXIT.
 14080
 14081     IF DCT-RETURN-CODE = '08'
 14082         MOVE ER-0948            TO EMI-ERROR
 14083         GO TO 5300-BAD-EXIT.
 14084
 14085     IF DCT-RETURN-CODE = 'N1'
 14086         MOVE ER-0950            TO EMI-ERROR
 14087         GO TO 5300-BAD-EXIT.
 14088
 14089     IF DCT-RETURN-CODE = 'E1'
 14090         MOVE ER-0974            TO EMI-ERROR
 14091         GO TO 5300-BAD-EXIT.
 14092
 14093     IF DCT-RETURN-CODE = 'E2'
 14094         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 271
* EL156.cbl
 14095         GO TO 5300-BAD-EXIT.
 14096
 14097     IF DCT-RETURN-CODE NOT = 'OK'
 14098         MOVE ER-0949            TO EMI-ERROR
 14099         GO TO 5300-BAD-EXIT.
 14100
 14101 5300-CONT.
 14102
 14103     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14104     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14105     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14106     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14107     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14108     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14109     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14110     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14111
 14112     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14113     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14114     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14115     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14116     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14117
 14118     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14119
 14120     IF PI-PMTTYPE = '2'
 14121         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14122         MOVE '4'                TO DM-CLAIM-STATUS
 14123     ELSE
 14124         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14125         MOVE '2'                TO DM-CLAIM-STATUS.
 14126
 14127     MOVE 'DLO025'               TO PGM-NAME.
 14128
 14129
 14130* EXEC CICS LINK
 14131*        PROGRAM    (PGM-NAME)
 14132*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14133*        LENGTH     (DM-DMO-LENGTH)
 14134*    END-EXEC.
 14135*    MOVE '."C                   (   #00013271' TO DFHEIV0
 14136     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14138     MOVE X'2020233030303133323731' TO DFHEIV0(25:11)
 14139     CALL 'kxdfhei1' USING DFHEIV0,
 14140           PGM-NAME,
 14141           DMO-COMMUNICATION-AREA,
 14142           DM-DMO-LENGTH,
 14143           DFHEIV99,
 14144           DFHEIV99,
 14145           DFHEIV99,
 14146           DFHEIV99
 14147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14148
 14149
 14150     IF DM-RETURN-CODE = 'OK'
 14151         GO TO 5300-EXIT.
 14152
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 272
* EL156.cbl
 14153     IF DM-RETURN-CODE = '01'
 14154         MOVE ER-8051            TO EMI-ERROR
 14155         GO TO 5300-BAD-EXIT.
 14156
 14157     IF DM-RETURN-CODE = '02'
 14158         MOVE ER-8052            TO EMI-ERROR
 14159         GO TO 5300-BAD-EXIT.
 14160
 14161     IF DM-RETURN-CODE = '03'
 14162         MOVE ER-8053            TO EMI-ERROR
 14163         GO TO 5300-BAD-EXIT.
 14164
 14165     IF DM-RETURN-CODE = '04'
 14166         MOVE ER-8054            TO EMI-ERROR
 14167         GO TO 5300-BAD-EXIT.
 14168
 14169     IF DM-RETURN-CODE = '05'
 14170         MOVE ER-8055            TO EMI-ERROR
 14171         GO TO 5300-BAD-EXIT.
 14172
 14173     IF DM-RETURN-CODE = '06'
 14174         MOVE ER-8056            TO EMI-ERROR
 14175         GO TO 5300-BAD-EXIT.
 14176
 14177     IF DM-RETURN-CODE = '07'
 14178         MOVE ER-8057            TO EMI-ERROR
 14179         GO TO 5300-BAD-EXIT.
 14180
 14181     IF DM-RETURN-CODE = '08'
 14182         MOVE ER-8058            TO EMI-ERROR
 14183         GO TO 5300-BAD-EXIT.
 14184
 14185     IF DM-RETURN-CODE = '09'
 14186         MOVE ER-8059            TO EMI-ERROR
 14187         GO TO 5300-BAD-EXIT.
 14188
 14189     IF DM-RETURN-CODE = '10'
 14190         MOVE ER-8060            TO EMI-ERROR
 14191         GO TO 5300-BAD-EXIT.
 14192
 14193     IF DM-RETURN-CODE = '11'
 14194         MOVE ER-8061            TO EMI-ERROR
 14195         GO TO 5300-BAD-EXIT.
 14196
 14197     IF DM-RETURN-CODE = '12'
 14198         MOVE ER-8062            TO EMI-ERROR
 14199         GO TO 5300-BAD-EXIT.
 14200
 14201     IF DM-RETURN-CODE = '13'
 14202         MOVE ER-8063            TO EMI-ERROR
 14203         GO TO 5300-BAD-EXIT.
 14204
 14205     IF DM-RETURN-CODE = '14'
 14206         MOVE ER-8064            TO EMI-ERROR
 14207         GO TO 5300-BAD-EXIT.
 14208
 14209     IF DM-RETURN-CODE = '15'
 14210         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 273
* EL156.cbl
 14211         GO TO 5300-BAD-EXIT.
 14212
 14213     IF DM-RETURN-CODE = '16'
 14214         MOVE ER-8154            TO EMI-ERROR
 14215         GO TO 5300-BAD-EXIT.
 14216
 14217     IF DM-RETURN-CODE = '17'
 14218         MOVE ER-8155            TO EMI-ERROR
 14219         GO TO 5300-BAD-EXIT.
 14220
 14221     IF DM-RETURN-CODE = 'N1'
 14222         MOVE ER-8152            TO EMI-ERROR
 14223         GO TO 5300-BAD-EXIT.
 14224
 14225     IF DM-RETURN-CODE = 'E1'
 14226         MOVE ER-8153            TO EMI-ERROR
 14227         GO TO 5300-BAD-EXIT.
 14228
 14229     MOVE ER-8066            TO EMI-ERROR.
 14230     GO TO 5300-BAD-EXIT.
 14231
 14232 5300-NOTE-NOT-FOUND.
 14233
 14234     MOVE ER-0954                TO EMI-ERROR.
 14235     GO TO 5300-BAD-EXIT.
 14236
 14237 5300-BAD-EXIT.
 14238
 14239* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14240*    MOVE '6"R                   !   #00013365' TO DFHEIV0
 14241     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14243     MOVE X'2020233030303133333635' TO DFHEIV0(25:11)
 14244     CALL 'kxdfhei1' USING DFHEIV0
 14245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14246
 14247     IF MAP-NAME = 'EL156A'
 14248         MOVE -1             TO ENTERPFL
 14249       ELSE
 14250         MOVE LOW-VALUES     TO EL156BI
 14251         MOVE -1             TO ENTPFBL.
 14252
 14253     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14254     GO TO 8200-SEND-DATAONLY.
 14255
 14256 5300-EXIT.
 14257     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 274
* EL156.cbl
 14259 5350-FORMAT-LAST-NAME-1ST.
 14260*****************************************************************
 14261*             M O V E   N A M E   R O U T I N E                 *
 14262*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14263*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14264*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14265*                  FIELD                   VALUE                *
 14266*           W-NAME-LAST    (CL15)      SMITH                    *
 14267*           W-NAME-FIRST   (CL15)      JOHN                     *
 14268*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14269*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14270*     CONTAIN                                                   *
 14271*                SMITH, JOHN ALLEN                              *
 14272*     OR                                                        *
 14273*                SMITH, JOHN A.                                 *
 14274*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14275*     COPYBOOK, ELCNWA.                                         *
 14276*****************************************************************.
 14277
 14278     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14279     MOVE ZERO                   TO  WS-NAME-SW.
 14280     SET NWA-INDEX               TO +1.
 14281
 14282     IF W-NAME-LAST   = SPACES AND
 14283        W-NAME-MIDDLE = SPACES
 14284         MOVE +1                 TO WS-NAME-SW.
 14285
 14286     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14287     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14288
 14289     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14290     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14291
 14292     SET NWA-INDEX UP BY +1.
 14293
 14294     IF W-NAME-MIDDLE NOT = SPACES
 14295         IF W-NAME-MIDDLE-2 = SPACES
 14296             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14297             SET NWA-INDEX UP BY +1
 14298             MOVE '.'            TO WS-NW (NWA-INDEX)
 14299             SET NWA-INDEX UP BY +2
 14300         ELSE
 14301             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14302             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14303
 14304 5350-EXIT.
 14305     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 275
* EL156.cbl
 14307 5360-MOVE-NAME.
 14308
 14309     IF WS-NAME-SW > +1
 14310         GO TO 5360-EXIT.
 14311
 14312     IF WS-NAME-WORK2 = SPACES
 14313         GO TO 5360-EXIT.
 14314
 14315     SET NWA-INDEX2            TO +1.
 14316     SET NWA-INDEX3            TO +2.
 14317
 14318 5360-MOVE-NAME-CYCLE.
 14319
 14320     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14321
 14322     IF NWA-INDEX < +30
 14323         SET NWA-INDEX UP BY +1
 14324     ELSE
 14325         ADD +2                TO  WS-NAME-SW
 14326         GO TO 5360-EXIT.
 14327
 14328     IF NWA-INDEX2 < +20
 14329         SET NWA-INDEX3 UP BY +1
 14330         SET NWA-INDEX2 UP BY +1.
 14331
 14332     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14333        WS-NW2 (NWA-INDEX3) = SPACES
 14334         IF WS-NAME-SW = ZERO
 14335             MOVE ','            TO  WS-NW (NWA-INDEX)
 14336             SET NWA-INDEX UP BY +2
 14337             MOVE +1             TO  WS-NAME-SW
 14338             GO TO 5360-EXIT
 14339         ELSE
 14340             GO TO 5360-EXIT.
 14341
 14342     GO TO 5360-MOVE-NAME-CYCLE.
 14343
 14344 5360-EXIT.
 14345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 276
* EL156.cbl
 14347 6000-BUILD-SCREEN-B.
 14348     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14349     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14350     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14351     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14352
 14353     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14354
 14355 6050-BUILD-SCREEN.
 14356     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14357     MOVE LOW-VALUES             TO EL156BI.
 14358     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14359
 14360     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14361
 14362     IF PI-PAYEE-TYPE = 'I'
 14363        GO TO 6060-READ-TRAILER.
 14364
 14365     IF PI-PAYEE-TYPE = 'B'
 14366        ADD +10                  TO TRLR-SEQ-NO
 14367        GO TO 6060-READ-TRAILER.
 14368
 14369     IF PI-PAYEE-TYPE = 'A'
 14370        ADD +20                  TO TRLR-SEQ-NO
 14371        GO TO 6060-READ-TRAILER.
 14372
 14373     IF PI-PAYEE-TYPE = 'O'
 14374        ADD +50                  TO TRLR-SEQ-NO
 14375        GO TO 6060-READ-TRAILER.
 14376
 14377     IF PI-PAYEE-TYPE = 'Q'
 14378        ADD +60                  TO TRLR-SEQ-NO
 14379        GO TO 6060-READ-TRAILER.
 14380
 14381     IF PI-PAYEE-TYPE = 'P'
 14382        ADD +30                  TO TRLR-SEQ-NO
 14383        GO TO 6060-READ-TRAILER.
 14384
 14385     IF PI-PAYEE-TYPE = 'E'
 14386        ADD +40                  TO TRLR-SEQ-NO.
 14387
 14388 6060-READ-TRAILER.
 14389
 14390     IF PI-PAYEE-TYPE    = 'A' AND
 14391        PI-PAYEE-SEQ-NUM = 0
 14392          GO TO 6061-READ-ACCOUNT.
 14393
 14394     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14395        (PI-PAYEE-TYPE    = 'B')             AND
 14396        (PI-PAYEE-SEQ-NUM = 9)
 14397          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14398          IF BENE-FOUND-SW = 'N'
 14399            GO TO 6065-NOT-FOUND
 14400          ELSE
 14401            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14402            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14403            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14404*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 277
* EL156.cbl
 14405            STRING BE-CITY ' ' BE-STATE
 14406               DELIMITED BY '  ' INTO CITYSTBO
 14407            END-STRING
 14408            MOVE BE-ZIP-CODE       TO ZIPBO
 14409            GO TO 6061-READ-ACCOUNT.
 14410
 14411     IF PI-PAYEE-TYPE    = 'B' AND
 14412        PI-PAYEE-SEQ-NUM = 0
 14413          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14414          IF BENE-FOUND-SW = 'N'
 14415            GO TO 6065-NOT-FOUND
 14416          ELSE
 14417            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14418            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14419            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14420*           MOVE BE-CITY-STATE     TO CITYSTBO
 14421            STRING BE-CITY ' ' BE-STATE
 14422               DELIMITED BY '  ' INTO CITYSTBO
 14423            END-STRING
 14424            MOVE BE-ZIP-CODE       TO ZIPBO
 14425            GO TO 6061-READ-ACCOUNT.
 14426
 14427
 14428* EXEC CICS HANDLE CONDITION
 14429*         NOTFND(6065-NOT-FOUND)
 14430*     END-EXEC.
 14431*    MOVE '"$I                   ! / #00013546' TO DFHEIV0
 14432     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14434     MOVE X'2F20233030303133353436' TO DFHEIV0(25:11)
 14435     CALL 'kxdfhei1' USING DFHEIV0
 14436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14437
 14438
 14439     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14440
 14441     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14442     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14443     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14444     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14445*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14446     STRING AT-CITY ' ' AT-STATE
 14447        DELIMITED BY '  ' INTO CITYSTBO
 14448     END-STRING
 14449     MOVE AT-ZIP-CODE            TO ZIPBO.
 14450
 14451 6061-READ-ACCOUNT.
 14452
 14453* EXEC CICS HANDLE CONDITION
 14454*         NOTFND(6068-ACCT-NOT-FND)
 14455*     END-EXEC.
 14456*    MOVE '"$I                   ! 0 #00013563' TO DFHEIV0
 14457     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14459     MOVE X'3020233030303133353633' TO DFHEIV0(25:11)
 14460     CALL 'kxdfhei1' USING DFHEIV0
 14461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14462
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 278
* EL156.cbl
 14463
 14464
 14465* EXEC CICS READ
 14466*         DATASET('ERACCT')
 14467*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14468*         RIDFLD (PI-ACCT-KEY)
 14469*     END-EXEC.
 14470     MOVE 'ERACCT' TO DFHEIV1
 14471*    MOVE '&"S        E          (   #00013567' TO DFHEIV0
 14472     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14473     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14474     MOVE X'2020233030303133353637' TO DFHEIV0(25:11)
 14475     CALL 'kxdfhei1' USING DFHEIV0,
 14476           DFHEIV1,
 14477           DFHEIV20,
 14478           DFHEIV99,
 14479           PI-ACCT-KEY,
 14480           DFHEIV99,
 14481           DFHEIV99,
 14482           DFHEIV99
 14483     SET ADDRESS OF ACCOUNT-MASTER TO
 14484         DFHEIV20
 14485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14486
 14487
 14488     MOVE AM-CARRIER             TO ACARRBO.
 14489     MOVE AM-GROUPING            TO GROUPBO.
 14490     MOVE AM-STATE               TO STATEBO.
 14491     MOVE AM-ACCOUNT             TO ACCTBO.
 14492     MOVE AM-NAME                TO ACCTNMBO.
 14493
 14494     IF PI-PAYEE-TYPE = 'A' AND
 14495        PI-PAYEE-SEQ-NUM = 0
 14496          MOVE AM-NAME             TO NAMEBO
 14497                                      PI-PAYEE-NAME
 14498          MOVE AM-ADDRS            TO ADDR1BO
 14499          MOVE SPACES              TO ADDR2BO
 14500*         MOVE AM-CITY             TO CITYSTBO
 14501          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14502             DELIMITED BY '  ' INTO CITYSTBO
 14503          END-STRING
 14504          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14505          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14506          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14507          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14508
 14509     IF CITYSTBO EQUAL SPACES
 14510         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14511         GO TO 6070-FORMAT-DATA
 14512     END-IF.
 14513
 14514     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14515     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14516     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14517     PERFORM VARYING WS-SUB FROM 30 BY -1
 14518          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14519        IF WS-END-SUB = 0  AND
 14520           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 279
* EL156.cbl
 14521            CONTINUE
 14522        ELSE
 14523            IF WS-END-SUB = 0
 14524                MOVE WS-SUB TO WS-END-SUB
 14525            ELSE
 14526                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14527                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14528                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14529                END-IF
 14530            END-IF
 14531        END-IF
 14532        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14533            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14534            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14535        END-IF
 14536     END-PERFORM.
 14537
 14538     IF WS-BEG-SUB > 0
 14539         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14540         IF WS-STATE-LENGTH = 2
 14541             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14542                  TO PI-CHECK-STATE-FOR-AK
 14543         ELSE
 14544             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14545                'ALASKA'
 14546                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14547             ELSE
 14548                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14549             END-IF
 14550         END-IF
 14551     ELSE
 14552         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14553     END-IF.
 14554
 14555     GO TO 6070-FORMAT-DATA.
 14556
 14557 6065-NOT-FOUND.
 14558     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14559     GO TO 6061-READ-ACCOUNT.
 14560
 14561 6068-ACCT-NOT-FND.
 14562     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14563
 14564 6070-FORMAT-DATA.
 14565     IF PI-HOLDTIL = ZEROS
 14566        MOVE SAVE-DATE           TO PAYDTBI
 14567       ELSE
 14568        MOVE PI-HOLDTIL          TO PAYDTBO
 14569        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14570
 14571     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14572     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14573
 14574     IF EIBAID = DFHPF3 OR DFHPF4
 14575        NEXT SENTENCE
 14576     ELSE
 14577       GO TO 6071-CONTINUE.
 14578
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 280
* EL156.cbl
 14579     MOVE PI-EPYFROM          TO PYFROMBO.
 14580     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14581
 14582     IF NOT PI-USES-PAID-TO
 14583        MOVE PI-EPYTHRU          TO PYTHRUBO
 14584        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14585     ELSE
 14586        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14587        MOVE '4'              TO DC-OPTION-CODE
 14588        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14589        IF NO-CONVERSION-ERROR
 14590           MOVE +1            TO DC-ELAPSED-DAYS
 14591           MOVE +0            TO DC-ELAPSED-MONTHS
 14592           MOVE '6'           TO DC-OPTION-CODE
 14593           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14594           IF NO-CONVERSION-ERROR
 14595              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14596
 14597     MOVE PI-EDAYS            TO DAYSBO.
 14598     MOVE PI-EPYAMT           TO PAYAMTBO.
 14599     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14600        IF PI-INT-AMT > ZEROS
 14601           MOVE PI-INT-AMT       TO INTAMTBO
 14602        END-IF
 14603     END-IF
 14604     GO TO 6072-SET-TYPE.
 14605
 14606 6071-CONTINUE.
 14607
 14608     IF PI-CPYFROM NOT = LOW-VALUES
 14609        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14610        MOVE SPACES              TO DC-OPTION-CODE
 14611        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14612        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14613
 14614     IF PI-CPYTHRU NOT = LOW-VALUES
 14615        IF NOT PI-USES-PAID-TO
 14616           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14617           MOVE SPACES             TO DC-OPTION-CODE
 14618           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14619           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14620        ELSE
 14621           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14622           MOVE '6'                TO DC-OPTION-CODE
 14623           MOVE +1                 TO DC-ELAPSED-DAYS
 14624           MOVE +0                 TO DC-ELAPSED-MONTHS
 14625           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14626           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14627
 14628     MOVE PI-CDAYS               TO DAYSBO.
 14629     MOVE PI-CPYAMT              TO PAYAMTBO.
 14630     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14631        IF PI-INT-AMT > ZEROS
 14632           MOVE PI-INT-AMT       TO INTAMTBO
 14633        END-IF
 14634     END-IF
 14635     .
 14636 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 281
* EL156.cbl
 14637     IF PI-PMTTYPE = '1'
 14638        MOVE 'PARTIAL'           TO PAYTYPBO.
 14639
 14640     IF PI-PMTTYPE = '2'
 14641        MOVE 'FINAL'             TO PAYTYPBO.
 14642
 14643     IF PI-PMTTYPE = '3'
 14644        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14645
 14646     IF PI-PMTTYPE = '4'
 14647        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14648
 14649     IF PI-PMTTYPE = '5'
 14650        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14651
 14652     IF PI-PMTTYPE = '6'
 14653        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14654
 14655     IF PI-PROV-PMT
 14656        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14657
 14658     IF PI-ECHECKNO NOT = SPACES
 14659        MOVE PI-ECHECKNO         TO CKNUMBO
 14660     ELSE
 14661        MOVE PI-CCHECKNO         TO CKNUMBO.
 14662
 14663     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14664        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14665        MOVE +91                 TO  TRLR-SEQ-NO
 14666
 14667* EXEC CICS READ
 14668*           DATASET  ('ELTRLR')
 14669*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14670*           RIDFLD   (ELTRLR-KEY)
 14671*           RESP     (WS-RESPONSE)
 14672*       END-EXEC
 14673     MOVE 'ELTRLR' TO DFHEIV1
 14674*    MOVE '&"S        E          (  N#00013751' TO DFHEIV0
 14675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14677     MOVE X'204E233030303133373531' TO DFHEIV0(25:11)
 14678     CALL 'kxdfhei1' USING DFHEIV0,
 14679           DFHEIV1,
 14680           DFHEIV20,
 14681           DFHEIV99,
 14682           ELTRLR-KEY,
 14683           DFHEIV99,
 14684           DFHEIV99,
 14685           DFHEIV99
 14686     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14687         DFHEIV20
 14688     MOVE EIBRESP  TO WS-RESPONSE
 14689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14690
 14691        IF WS-RESP-NORMAL
 14692           MOVE AT-INFO-LINE-1   TO  LOANNBO
 14693        ELSE
 14694           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 282
* EL156.cbl
 14695        END-IF
 14696     END-IF
 14697
 14698*       MOVE PI-LOAN-NO          TO LOANNBO
 14699
 14700     IF CKNUMBO = SPACES
 14701         MOVE SPACES             TO CKNUMHDO.
 14702
 14703     MOVE CL-CLAIM-NO            TO CLMNOBO.
 14704     MOVE CL-CARRIER             TO CARRBO.
 14705     MOVE CL-CERT-PRIME          TO CERTNOBO.
 14706     MOVE CL-CERT-SFX            TO SUFXBO.
 14707
 14708     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14709        EVALUATE CL-CLAIM-TYPE
 14710           WHEN 'I'
 14711              MOVE '  IU  '      TO CLMTYPBO
 14712           WHEN 'G'
 14713              MOVE ' GAP  '      TO CLMTYPBO
 14714           WHEN OTHER
 14715              MOVE PI-AH-OVERRIDE-L6
 14716                                 TO CLMTYPBO
 14717        END-EVALUATE
 14718        MOVE ZEROS               TO UNDISBO
 14719*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 14720        IF PI-PMTTYPE = '5' OR '6'
 14721           GO TO 6073-GET-NOTIFY-DATA
 14722        ELSE
 14723           MOVE PI-DAILY-RATE    TO RATEBO
 14724           GO TO 6073-GET-NOTIFY-DATA.
 14725
 14726     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 14727
 14728     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 14729        MOVE ZEROS               TO UNDISBO
 14730     ELSE
 14731        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 14732
 14733 6073-GET-NOTIFY-DATA.
 14734
 14735     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 14736
 14737     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 14738         MOVE SPACES             TO  NAMEB2O
 14739                                     ADDR1B2O
 14740                                     ADDR2B2O
 14741                                     CITYST2O
 14742                                     AGTHDGO
 14743         MOVE ZEROS              TO  ZIPB2O
 14744         GO TO 6080-SET-INCURRED.
 14745
 14746     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 14747     MOVE +29                    TO  TRLR-SEQ-NO.
 14748
 14749
 14750* EXEC CICS HANDLE CONDITION
 14751*        NOTFND   (6074-GET-COMP-DATA)
 14752*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 283
* EL156.cbl
 14753*    MOVE '"$I                   ! 1 #00013816' TO DFHEIV0
 14754     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14756     MOVE X'3120233030303133383136' TO DFHEIV0(25:11)
 14757     CALL 'kxdfhei1' USING DFHEIV0
 14758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14759
 14760
 14761     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14762
 14763     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 14764     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 14765     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 14766*    MOVE AT-CITY-STATE          TO  CITYST2O.
 14767     STRING AT-CITY ' ' AT-STATE
 14768        DELIMITED BY '  ' INTO CITYST2O
 14769     END-STRING
 14770     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 14771     GO TO 6080-SET-INCURRED.
 14772
 14773 6074-GET-COMP-DATA.
 14774
 14775     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 14776         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 14777
 14778     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 14779         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 14780                                         ADDR1B2O
 14781                                         ADDR2B2O
 14782                                         CITYST2O
 14783         MOVE ZEROS                  TO  ZIPB2O
 14784         GO TO 6080-SET-INCURRED.
 14785
 14786     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 14787     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 14788     MOVE AM-CARRIER             TO  COMP-CARRIER.
 14789     MOVE AM-GROUPING            TO  COMP-GROUP.
 14790     MOVE 'A'                    TO  COMP-TYPE.
 14791     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14792                                 TO  COMP-FIN-RESP.
 14793
 14794     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 14795         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 14796                                       'G' OR 'B'
 14797             MOVE 'G'            TO  COMP-TYPE
 14798             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14799         ELSE
 14800             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14801                                 TO  COMP-ACCOUNT
 14802     ELSE
 14803         MOVE 'G'                TO  COMP-TYPE
 14804         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14805
 14806     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14807
 14808     IF COMP-REC-FOUND
 14809         MOVE CO-ACCT-NAME       TO  NAMEB2O
 14810         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 284
* EL156.cbl
 14811         MOVE CO-ADDR-2          TO  ADDR2B2O
 14812*        MOVE CO-ADDR-3          TO  CITYST2O
 14813         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14814            DELIMITED BY '  ' INTO CITYST2O
 14815         END-STRING
 14816         MOVE CO-ZIP             TO  ZIPB2O
 14817     ELSE
 14818         MOVE 'NO COMP ADDRESS AVAILABLE'
 14819                                 TO  NAMEB2O
 14820                                     ADDR1B2O
 14821                                     ADDR2B2O
 14822                                     CITYST2O
 14823         MOVE ZEROS               TO ZIPB2O.
 14824
 14825 6080-SET-INCURRED.
 14826     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14827     MOVE SPACES                 TO DC-OPTION-CODE.
 14828     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14829     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14830     MOVE PI-PROCESSOR-ID        TO BYBO.
 14831     MOVE MAP-NAMEB              TO MAP-NAME.
 14832     MOVE 'C'                    TO PI-PASS-SW.
 14833     MOVE EIBAID                 TO PI-PFKEY-USED.
 14834     MOVE -1                     TO ENTPFBL.
 14835     GO TO 8100-SEND-INITIAL-MAP.
 14836
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 285
* EL156.cbl
 14838 6100-BUILD-PAYMENT-TRAILER.
 14839
 14840     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14841       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14842         GO TO 6105-STATE-CHECK-NUMBER
 14843     END-IF.
 14844
 14845     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14846     MOVE '6'                    TO CNTL-REC-TYPE.
 14847
 14848     IF CONTROL-IS-ACTUAL-CARRIER
 14849         MOVE PI-CARRIER         TO WS-CARR
 14850     ELSE
 14851         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14852
 14853     IF PI-COMPANY-ID = 'FIA'
 14854         MOVE PI-CARRIER         TO  WS-CARR.
 14855
 14856     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14857     MOVE 0                      TO CNTL-SEQ-NO.
 14858     MOVE 'CARR'                 TO FILE-SWITCH.
 14859
 14860     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14861
 14862     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14863         IF PI-OFFLINE     = 'Y' AND
 14864            PI-ECHECKNO-CR = 'CR'
 14865              GO TO 6110-READ-CONTROL
 14866         ELSE
 14867            IF PI-CASH = 'N'
 14868                GO TO 6110-READ-CONTROL.
 14869
 14870     IF CHECK-NO-MANUAL    OR
 14871        CHECK-NO-AT-PRINT  OR
 14872        PI-OFFLINE = 'Y'
 14873          GO TO 6130-BUILD-TRAILER.
 14874
 14875     IF PI-COMPANY-ID = 'FIA'
 14876         NEXT SENTENCE
 14877     ELSE
 14878         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14879             GO TO 6110-READ-CONTROL.
 14880
 14881     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14882
 14883     IF CHECK-CNT-RESET-VALUE
 14884        MOVE +1                  TO CF-CHECK-COUNTER
 14885     ELSE
 14886        ADD +1                   TO CF-CHECK-COUNTER.
 14887
 14888     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14889
 14890     IF CHECK-NO-CARR-SEQ
 14891        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14892
 14893     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14894
 14895     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 286
* EL156.cbl
 14896     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 14897        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 14898         MOVE 'Y' TO PI-REAUDIT-NEEDED
 14899         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 14900            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 14901         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 14902                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 14903     END-IF.
 14904
 14905     GO TO 6120-REWRITE.
 14906
 14907 6105-STATE-CHECK-NUMBER.
 14908     IF CHECK-NO-MANUAL    OR
 14909        CHECK-NO-AT-PRINT  OR
 14910        PI-OFFLINE = 'Y'
 14911           GO TO 6130-BUILD-TRAILER
 14912     END-IF.
 14913
 14914     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 14915     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 14916     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 14917     MOVE '3'                TO CNTL-REC-TYPE.
 14918     MOVE +0                 TO CNTL-SEQ-NO.
 14919     MOVE 'STAT'             TO FILE-SWITCH.
 14920     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14921
 14922     IF CF-ST-CHECK-CNT-RESET
 14923         MOVE +1             TO CF-ST-CHECK-COUNTER
 14924     ELSE
 14925         ADD +1              TO CF-ST-CHECK-COUNTER
 14926     END-IF.
 14927
 14928     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 14929     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 14930     GO TO 6120-REWRITE.
 14931
 14932 6110-READ-CONTROL.
 14933     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14934     MOVE '1'                    TO CNTL-REC-TYPE.
 14935     MOVE SPACES                 TO CNTL-ACCESS.
 14936     MOVE 0                      TO CNTL-SEQ-NO.
 14937
 14938     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14939
 14940     IF CO-CHECK-COUNT-RESET
 14941        MOVE +1                  TO CF-CO-CHECK-COUNTER
 14942     ELSE
 14943        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14944
 14945     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14946
 14947     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14948         IF PI-OFFLINE     = 'Y'  AND
 14949            PI-ECHECKNO-CR = 'CR'
 14950              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 14951              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14952              MOVE AL-UANON           TO CHECKNOA
 14953              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 287
* EL156.cbl
 14954         ELSE
 14955         IF PI-CASH = 'N'
 14956             MOVE 'N'                TO PI-ECHECKNO-N
 14957             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 14958             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14959             MOVE AL-UANON           TO CHECKNOA
 14960             GO TO 6120-REWRITE.
 14961
 14962     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 14963
 14964 6120-REWRITE.
 14965
 14966* EXEC CICS REWRITE
 14967*         DATASET('ELCNTL')
 14968*         FROM(CONTROL-FILE)
 14969*     END-EXEC.
 14970     MOVE LENGTH OF
 14971      CONTROL-FILE
 14972       TO DFHEIV11
 14973     MOVE 'ELCNTL' TO DFHEIV1
 14974*    MOVE '&& L                  %   #00014024' TO DFHEIV0
 14975     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14976     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14977     MOVE X'2020233030303134303234' TO DFHEIV0(25:11)
 14978     CALL 'kxdfhei1' USING DFHEIV0,
 14979           DFHEIV1,
 14980           CONTROL-FILE,
 14981           DFHEIV11,
 14982           DFHEIV99
 14983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14984
 14985
 14986     MOVE 'Y'                    TO PI-CK-ASSIGN.
 14987
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 288
* EL156.cbl
 14989 6130-BUILD-TRAILER.
 14990
 14991
 14992* EXEC CICS GETMAIN
 14993*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14994*         LENGTH    (200)
 14995*         INITIMG   (GETMAIN-SPACE)
 14996*     END-EXEC.
 14997     MOVE 200
 14998       TO DFHEIV11
 14999*    MOVE ',"IL                  $   #00014034' TO DFHEIV0
 15000     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15001     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15002     MOVE X'2020233030303134303334' TO DFHEIV0(25:11)
 15003     CALL 'kxdfhei1' USING DFHEIV0,
 15004           DFHEIV20,
 15005           DFHEIV11,
 15006           GETMAIN-SPACE
 15007     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15008         DFHEIV20
 15009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15010
 15011
 15012     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15013                                    AT-PREV-PAID-THRU-DT.
 15014     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15015     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15016     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15017     MOVE 'AT'                   TO AT-RECORD-ID.
 15018     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15019
 15020     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15021        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15022           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15023     ELSE
 15024           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15025           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15026
 15027     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15028         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15029             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15030             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15031           ELSE
 15032             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15033             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15034
 15035     MOVE '2'                    TO AT-TRAILER-TYPE.
 15036     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15037                                    AT-PAYMENT-LAST-MAINT-DT.
 15038     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15039                                    AT-PAYMENT-LAST-UPDATED-BY.
 15040     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15041     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15042     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15043     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15044
 15045     IF PI-PMT-APPROVED
 15046        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 289
* EL156.cbl
 15047           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15048
 15049     IF PI-PFKEY-USED = DFHPF5
 15050        GO TO 6140-PF5-ENTERED.
 15051
 15052     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15053     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15054
 15055     IF PI-AIG-SPECIAL-BENEFIT
 15056         IF WS-1ST-SPECIAL-PMT
 15057             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15058             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15059                                        AT-AMOUNT-PAID
 15060         ELSE
 15061             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15062
 15063     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15064
 15065     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15066     MOVE '4'                    TO DC-OPTION-CODE.
 15067     PERFORM 9700-LINK-DATE-CONVERT.
 15068
 15069     IF DATE-CONVERSION-ERROR
 15070        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15071     ELSE
 15072        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15073
 15074     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15075     MOVE '4'                    TO DC-OPTION-CODE.
 15076     PERFORM 9700-LINK-DATE-CONVERT.
 15077
 15078     IF DATE-CONVERSION-ERROR
 15079        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15080     ELSE
 15081        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15082
 15083     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15084     GO TO 6150-FINISH-MOVE.
 15085
 15086 6140-PF5-ENTERED.
 15087     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15088     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15089
 15090     IF PI-AIG-SPECIAL-BENEFIT
 15091         IF WS-1ST-SPECIAL-PMT
 15092             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15093             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15094                                        AT-AMOUNT-PAID
 15095         ELSE
 15096             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15097
 15098     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15099     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15100     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15101
 15102 6150-FINISH-MOVE.
 15103
 15104     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 290
* EL156.cbl
 15105         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15106     ELSE
 15107         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15108
 15109     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15110     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15111
 15112*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15113*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15114
 15115     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15116         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15117
 15118     IF PI-OFFLINE = 'N'
 15119        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15120        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15121     ELSE
 15122        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15123        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15124
 15125     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15126
 15127     IF WS-2ND-SPECIAL-PMT
 15128         MOVE 'Y'                TO AT-CASH-PAYMENT
 15129         MOVE SPACES             TO AT-CHECK-NO
 15130         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15131         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15132         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15133         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15134
 15135     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15136                                    AT-TO-BE-WRITTEN-DT.
 15137
 15138     IF PI-HOLDTIL NOT = ZEROS
 15139        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15140        MOVE '4'                 TO DC-OPTION-CODE
 15141        PERFORM 9700-LINK-DATE-CONVERT
 15142        IF PI-OFFLINE = 'N'
 15143           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15144        ELSE
 15145           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15146
 15147     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15148     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15149                                    AT-CHECK-QUE-SEQUENCE.
 15150
 15151     IF PI-PFKEY-USED = DFHPF4
 15152        MOVE '1'                 TO AT-FORCE-CONTROL.
 15153
 15154     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15155        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15156        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15157        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15158
 15159     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15160                                    AT-VOID-SELECT-DT
 15161                                    AT-VOID-ACCEPT-DT
 15162                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 291
* EL156.cbl
 15163     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15164        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15165        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15166        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15167        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15168     ELSE
 15169        MOVE ZEROS               TO AT-DAILY-RATE
 15170                                    AT-ELIMINATION-DAYS
 15171        MOVE SPACES              TO AT-BENEFIT-TYPE
 15172     END-IF
 15173     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15174     MOVE '4'                    TO DC-OPTION-CODE.
 15175     PERFORM 9700-LINK-DATE-CONVERT.
 15176     IF DATE-CONVERSION-ERROR
 15177         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15178     ELSE
 15179         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15180     END-IF.
 15181     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15182     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15183     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15184     IF PI-REAUDIT-NEEDED = 'Y'
 15185         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15186         MOVE 'Y' TO WS-NEED-APPROVAL
 15187         GO TO 6170-WRITE
 15188     END-IF.
 15189*******************************************************
 15190     IF NOT PI-PMT-GRADUATED
 15191         GO TO 6170-WRITE.
 15192
 15193     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15194     MOVE '1'                    TO CNTL-REC-TYPE.
 15195     MOVE SPACES                 TO CNTL-ACCESS.
 15196     MOVE +0                     TO CNTL-SEQ-NO.
 15197     MOVE 'COMP'                 TO FILE-SWITCH.
 15198
 15199     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15200
 15201     IF PAID-FOR-LIFE
 15202         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15203             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15204                                     WS-PMT-APPROVAL-SW
 15205             GO TO 6170-WRITE.
 15206
 15207*05999      IF PAID-FOR-AH
 15208     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15209         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15210             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15211                                     WS-PMT-APPROVAL-SW
 15212             GO TO 6170-WRITE.
 15213
 15214     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15215
 15216******A&H Limits are set as a monthly payment.  Calculate the mont
 15217******equivalent of the amount paid today
 15218     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15219        PI-SAVE-ODD-DAYS-OVER > 0
 15220           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 292
* EL156.cbl
 15221                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15222           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15223                                  WS-CALC-PMT-MONTHS
 15224     ELSE
 15225           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15226     END-IF.
 15227*06007      IF ((PAID-FOR-AH) AND
 15228     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15229*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15230        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15231              OR
 15232        ((PAID-FOR-LIFE) AND
 15233        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15234            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15235       ELSE
 15236*06014      IF ((PAID-FOR-AH)  AND
 15237         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15238*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15239           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15240              OR
 15241        ((PAID-FOR-LIFE) AND
 15242        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15243            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15244         ELSE
 15245*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15246           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15247               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15248              OR
 15249          ((PAID-FOR-LIFE) AND
 15250          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15251            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15252       ELSE
 15253            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 15254
 15255     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15256        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15257        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15258            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15259        END-IF
 15260     ELSE
 15261     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15262        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15263        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15264            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15265        END-IF
 15266     ELSE
 15267     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15268        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15269        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15270            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15271        END-IF
 15272     ELSE
 15273     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15274            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 15275
 15276     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15277
 15278     IF NOT PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 293
* EL156.cbl
 15279         GO TO 6170-WRITE.
 15280
 15281
 15282* EXEC CICS HANDLE CONDITION
 15283*        NOTFND   (6170-WRITE)
 15284*    END-EXEC.
 15285*    MOVE '"$I                   ! 2 #00014309' TO DFHEIV0
 15286     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15288     MOVE X'3220233030303134333039' TO DFHEIV0(25:11)
 15289     CALL 'kxdfhei1' USING DFHEIV0
 15290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15291
 15292
 15293     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15294     MOVE '2'                    TO CNTL-REC-TYPE.
 15295     MOVE +0                     TO CNTL-SEQ-NO.
 15296     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15297
 15298
 15299* EXEC CICS READ
 15300*         DATASET  ('ELCNTL')
 15301*         SET      (ADDRESS OF CONTROL-FILE)
 15302*         RIDFLD   (ELCNTL-KEY)
 15303*    END-EXEC.
 15304     MOVE 'ELCNTL' TO DFHEIV1
 15305*    MOVE '&"S        E          (   #00014318' TO DFHEIV0
 15306     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15308     MOVE X'2020233030303134333138' TO DFHEIV0(25:11)
 15309     CALL 'kxdfhei1' USING DFHEIV0,
 15310           DFHEIV1,
 15311           DFHEIV20,
 15312           DFHEIV99,
 15313           ELCNTL-KEY,
 15314           DFHEIV99,
 15315           DFHEIV99,
 15316           DFHEIV99
 15317     SET ADDRESS OF CONTROL-FILE TO
 15318         DFHEIV20
 15319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15320
 15321
 15322     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15323
 15324     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15325                         OR '4'
 15326         NEXT SENTENCE
 15327     ELSE
 15328         MOVE 'Y' TO WS-NEED-APPROVAL
 15329         GO TO 6170-WRITE.
 15330
 15331     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15332         MOVE 'Y' TO WS-NEED-APPROVAL
 15333         IF WS-APPROVAL-LEVEL = '1'
 15334             MOVE '2'        TO  AT-APPROVED-LEVEL
 15335                            WS-SAVE-APPROVED-LEVEL
 15336             GO TO 6170-WRITE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 294
* EL156.cbl
 15337         ELSE
 15338             IF WS-APPROVAL-LEVEL = '2'
 15339                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15340                                WS-SAVE-APPROVED-LEVEL
 15341                 GO TO 6170-WRITE
 15342             ELSE IF WS-APPROVAL-LEVEL = '3'
 15343                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15344                                WS-SAVE-APPROVED-LEVEL
 15345                 GO TO 6170-WRITE.
 15346
 15347     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15348                             WS-PMT-APPROVAL-SW.
 15349     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15350                             AT-APPROVAL-LEVEL-REQD.
 15351
 15352*******************************************************
 15353
 15354 6170-WRITE.
 15355
 15356     if pi-company-id = 'DCC'
 15357        MOVE ' '                 TO WS-PDEF-RECORD-SW
 15358        PERFORM 0900-GET-DDF-FACTORS
 15359                                 THRU 0900-EXIT
 15360        IF PDEF-FOUND
 15361           perform 2220-update-elcrtt
 15362                                 thru 2220-exit
 15363        end-if
 15364     end-if
 15365     IF PI-COMPANY-ID = 'DMD'
 15366        IF PI-AT-EOB-CODES NOT = SPACES
 15367           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15368           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15369           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15370           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15371           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15372
 15373
 15374* EXEC CICS HANDLE CONDITION
 15375*        DUPREC    (6180-DUPREC)
 15376*    END-EXEC.
 15377*    MOVE '"$%                   ! 3 #00014375' TO DFHEIV0
 15378     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15380     MOVE X'3320233030303134333735' TO DFHEIV0(25:11)
 15381     CALL 'kxdfhei1' USING DFHEIV0
 15382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15383
 15384
 15385
 15386* EXEC CICS WRITE
 15387*         DATASET       ('ELTRLR')
 15388*         FROM          (ACTIVITY-TRAILERS)
 15389*         RIDFLD        (AT-CONTROL-PRIMARY)
 15390*     END-EXEC.
 15391     MOVE LENGTH OF
 15392      ACTIVITY-TRAILERS
 15393       TO DFHEIV11
 15394     MOVE 'ELTRLR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 295
* EL156.cbl
 15395*    MOVE '&$ L                  ''   #00014379' TO DFHEIV0
 15396     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15397     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15398     MOVE X'2020233030303134333739' TO DFHEIV0(25:11)
 15399     CALL 'kxdfhei1' USING DFHEIV0,
 15400           DFHEIV1,
 15401           ACTIVITY-TRAILERS,
 15402           DFHEIV11,
 15403           AT-CONTROL-PRIMARY,
 15404           DFHEIV99,
 15405           DFHEIV99
 15406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15407
 15408
 15409     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15410        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15411*06088           GO TO 6199-EXIT.
 15412           GO TO 6176-APPROVAL-NOTE.
 15413
 15414
 15415* EXEC CICS GETMAIN
 15416*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15417*         LENGTH    (200)
 15418*         INITIMG   (GETMAIN-SPACE)
 15419*     END-EXEC.
 15420     MOVE 200
 15421       TO DFHEIV11
 15422*    MOVE ',"IL                  $   #00014390' TO DFHEIV0
 15423     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15425     MOVE X'2020233030303134333930' TO DFHEIV0(25:11)
 15426     CALL 'kxdfhei1' USING DFHEIV0,
 15427           DFHEIV20,
 15428           DFHEIV11,
 15429           GETMAIN-SPACE
 15430     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15431         DFHEIV20
 15432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15433
 15434
 15435     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15436
 15437     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15438     MOVE 'AT'                   TO AT-RECORD-ID.
 15439     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15440     MOVE '6'                    TO AT-TRAILER-TYPE.
 15441     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15442                                    AT-GEN-INFO-LAST-MAINT-DT
 15443     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15444                                    AT-GEN-INFO-LAST-UPDATED-BY
 15445     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15446
 15447     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15448     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15449     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15450
 15451     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15452
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 296
* EL156.cbl
 15453 6175-WRITE.
 15454
 15455
 15456* EXEC CICS HANDLE CONDITION
 15457*        DUPREC    (6190-DUPREC)
 15458*    END-EXEC.
 15459*    MOVE '"$%                   ! 4 #00014416' TO DFHEIV0
 15460     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15462     MOVE X'3420233030303134343136' TO DFHEIV0(25:11)
 15463     CALL 'kxdfhei1' USING DFHEIV0
 15464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15465
 15466
 15467
 15468* EXEC CICS WRITE
 15469*         DATASET     ('ELTRLR')
 15470*         FROM        (ACTIVITY-TRAILERS)
 15471*         RIDFLD      (AT-CONTROL-PRIMARY)
 15472*     END-EXEC.
 15473     MOVE LENGTH OF
 15474      ACTIVITY-TRAILERS
 15475       TO DFHEIV11
 15476     MOVE 'ELTRLR' TO DFHEIV1
 15477*    MOVE '&$ L                  ''   #00014420' TO DFHEIV0
 15478     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15479     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15480     MOVE X'2020233030303134343230' TO DFHEIV0(25:11)
 15481     CALL 'kxdfhei1' USING DFHEIV0,
 15482           DFHEIV1,
 15483           ACTIVITY-TRAILERS,
 15484           DFHEIV11,
 15485           AT-CONTROL-PRIMARY,
 15486           DFHEIV99,
 15487           DFHEIV99
 15488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15489
 15490
 15491 6176-APPROVAL-NOTE.
 15492
 15493     IF NOT APPROVAL-NEEDED
 15494         GO TO 6199-EXIT.
 15495
 15496
 15497* EXEC CICS GETMAIN
 15498*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15499*        LENGTH    (200)
 15500*        INITIMG   (GETMAIN-SPACE)
 15501*    END-EXEC.
 15502     MOVE 200
 15503       TO DFHEIV11
 15504*    MOVE ',"IL                  $   #00014431' TO DFHEIV0
 15505     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15507     MOVE X'2020233030303134343331' TO DFHEIV0(25:11)
 15508     CALL 'kxdfhei1' USING DFHEIV0,
 15509           DFHEIV20,
 15510           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 297
* EL156.cbl
 15511           GETMAIN-SPACE
 15512     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15513         DFHEIV20
 15514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15515
 15516
 15517     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15518
 15519     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15520     MOVE 'AT'               TO AT-RECORD-ID
 15521     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15522     MOVE '6'                TO AT-TRAILER-TYPE
 15523     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15524                                AT-GEN-INFO-LAST-MAINT-DT
 15525     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15526                                AT-GEN-INFO-LAST-UPDATED-BY
 15527     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15528
 15529     IF PI-REAUDIT-NEEDED = 'Y'
 15530         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15531     ELSE
 15532         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15533     END-IF
 15534     MOVE SPACES             TO AT-INFO-LINE-2
 15535
 15536     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15537 6177-WRITE.
 15538
 15539
 15540* EXEC CICS HANDLE CONDITION
 15541*        DUPREC    (6185-DUPREC)
 15542*    END-EXEC.
 15543*    MOVE '"$%                   ! 5 #00014459' TO DFHEIV0
 15544     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15546     MOVE X'3520233030303134343539' TO DFHEIV0(25:11)
 15547     CALL 'kxdfhei1' USING DFHEIV0
 15548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15549
 15550
 15551
 15552* EXEC CICS WRITE
 15553*         DATASET     ('ELTRLR')
 15554*         FROM        (ACTIVITY-TRAILERS)
 15555*         RIDFLD      (AT-CONTROL-PRIMARY)
 15556*     END-EXEC.
 15557     MOVE LENGTH OF
 15558      ACTIVITY-TRAILERS
 15559       TO DFHEIV11
 15560     MOVE 'ELTRLR' TO DFHEIV1
 15561*    MOVE '&$ L                  ''   #00014463' TO DFHEIV0
 15562     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15563     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15564     MOVE X'2020233030303134343633' TO DFHEIV0(25:11)
 15565     CALL 'kxdfhei1' USING DFHEIV0,
 15566           DFHEIV1,
 15567           ACTIVITY-TRAILERS,
 15568           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 298
* EL156.cbl
 15569           AT-CONTROL-PRIMARY,
 15570           DFHEIV99,
 15571           DFHEIV99
 15572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15573
 15574
 15575
 15576     GO TO 6199-EXIT.
 15577
 15578 6180-DUPREC.
 15579
 15580     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15581     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15582     GO TO 6170-WRITE.
 15583
 15584 6185-DUPREC.
 15585     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15586     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15587     GO TO 6177-WRITE.
 15588
 15589 6190-DUPREC.
 15590     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15591     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15592     GO TO 6175-WRITE.
 15593
 15594 6199-EXIT.
 15595      EXIT.
 15596
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 299
* EL156.cbl
 15598 6200-UPDATE-CLAIM-MSTR.
 15599     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15600     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15601     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15602     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15603
 15604     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15605
 15606     MOVE ZEROS                  TO W-INTEREST.
 15607
 15608     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15609        IF (PI-OFFLINE = 'Y') OR
 15610           (PI-PMTTYPE = '7')
 15611           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15612                                 THRU 9870-EXIT
 15613        END-IF
 15614     END-IF
 15615     IF NOT ERROR-ON-OUTPUT
 15616        CONTINUE
 15617     ELSE
 15618
 15619* EXEC CICS REWRITE
 15620*          DATASET('ELMSTR')
 15621*          FROM(CLAIM-MASTER)
 15622*       END-EXEC
 15623     MOVE LENGTH OF
 15624      CLAIM-MASTER
 15625       TO DFHEIV11
 15626     MOVE 'ELMSTR' TO DFHEIV1
 15627*    MOVE '&& L                  %   #00014512' TO DFHEIV0
 15628     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15629     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15630     MOVE X'2020233030303134353132' TO DFHEIV0(25:11)
 15631     CALL 'kxdfhei1' USING DFHEIV0,
 15632           DFHEIV1,
 15633           CLAIM-MASTER,
 15634           DFHEIV11,
 15635           DFHEIV99
 15636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15637
 15638        MOVE -1                  TO ENTPFBL
 15639        MOVE AL-UANON            TO ENTPFBA
 15640        MOVE MAP-NAMEB           TO MAP-NAME
 15641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15642        GO TO 8200-SEND-DATAONLY
 15643     END-IF
 15644
 15645     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15646
 15647     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15648
 15649     IF PI-AIG-SPECIAL-BENEFIT
 15650         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15651
 15652     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15653
 15654     IF PI-SPECIAL-BEN-SW = 'Y'
 15655         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 300
* EL156.cbl
 15656         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15657
 15658     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15659         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15660     ELSE
 15661         IF PI-PMTTYPE NOT = '4'
 15662            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15663
 15664     IF PI-PMTTYPE = '5' OR '6'
 15665        GO TO  6250-SET-MAINT.
 15666
 15667     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 15668                                         CL-LAG-REPORT-CODE.
 15669
 15670     IF CL-ACTIVITY-CODE = 09
 15671         GO TO 6200-CONT-UPDATE.
 15672
 15673     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15674         IF CL-ACTIVITY-CODE = 11
 15675             GO TO 6200-CONT-UPDATE.
 15676
 15677     IF WS-ACT-REC-FOUND-SW = 'N'
 15678         GO TO 6200-CONT-UPDATE.
 15679
 15680     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 15681         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 15682         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 15683         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 15684
 15685     IF WS-UPDATE-SW = 'Y'
 15686         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 15687                                         CL-NEXT-FOLLOWUP-DT.
 15688
 15689 6200-CONT-UPDATE.
 15690
 15691     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15692       IF CLAIM-IS-CLOSED
 15693         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15694           IF WS-OPEN-CLOSE-SW = '2'
 15695             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 15696                                        CL-LAST-CLOSE-DT.
 15697
 15698     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 15699        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 15700        MOVE 'O'                 TO CL-CLAIM-STATUS.
 15701
 15702     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 15703        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 15704        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 15705        MOVE 'C'                 TO CL-CLAIM-STATUS
 15706        IF PI-PMTTYPE = '2'
 15707           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15708           CONTINUE
 15709        ELSE
 15710           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15711        END-IF
 15712     ELSE
 15713        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 301
* EL156.cbl
 15714           IF PI-PMTTYPE = '2' AND
 15715              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15716              CONTINUE
 15717           ELSE
 15718              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15719           END-IF
 15720        END-IF
 15721     END-IF
 15722
 15723     IF PI-PMTTYPE = '4'
 15724        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 15725
 15726     IF PI-COMPANY-ID = 'CVL'
 15727         IF PI-LOAN-UPDATE-SW = 'Y'
 15728             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 15729             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 15730             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 15731             MOVE CL-CERT-STATE      TO  CERT-STATE
 15732             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 15733             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 15734             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 15735             MOVE 'CERT'             TO  FILE-SWITCH
 15736             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 15737             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 15738             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 15739
 15740     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 15741        GO TO 6220-USE-COMPUTED.
 15742
 15743     IF (PI-PMTTYPE = '4')  AND
 15744        (PI-EPYAMT < ZEROS)
 15745          COMPUTE CL-NO-OF-DAYS-PAID =
 15746                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 15747          IF CL-NO-OF-DAYS-PAID < +0
 15748              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15749          ELSE
 15750              NEXT SENTENCE
 15751     ELSE
 15752          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 15753
 15754     IF PI-PROCESSOR-ID = 'FIX '
 15755        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15756           NEXT SENTENCE
 15757        ELSE
 15758           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 15759     ELSE
 15760        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 15761
 15762     IF PI-PMTTYPE = '4'
 15763        GO TO 6250-SET-MAINT.
 15764
 15765     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15766
 15767     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15768     MOVE '4'                    TO DC-OPTION-CODE.
 15769     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15770     IF DATE-CONVERSION-ERROR
 15771        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 302
* EL156.cbl
 15772     ELSE
 15773        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 15774           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 15775           IF PI-AIG-SPECIAL-BENEFIT
 15776               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 15777           ELSE
 15778               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 15779
 15780     GO TO 6250-SET-MAINT.
 15781
 15782 6220-USE-COMPUTED.
 15783
 15784     IF (PI-PMTTYPE = '4')  AND
 15785        (PI-CPYAMT < ZEROS)
 15786          COMPUTE CL-NO-OF-DAYS-PAID =
 15787                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 15788          IF CL-NO-OF-DAYS-PAID < +0
 15789              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15790          ELSE
 15791              NEXT SENTENCE
 15792     ELSE
 15793          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 15794
 15795     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 15796
 15797     IF PI-PMTTYPE = '4'
 15798        GO TO 6250-SET-MAINT.
 15799
 15800     IF PI-AIG-SPECIAL-BENEFIT
 15801         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 15802     ELSE
 15803         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 15804
 15805     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15806
 15807     IF PI-CPYTHRU > CL-PAID-THRU-DT
 15808        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 15809
 15810 6250-SET-MAINT.
 15811     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 15812
 15813     IF PI-PROCESSOR-ID = 'FIX '
 15814        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 15815           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 15816        ELSE
 15817           NEXT SENTENCE
 15818     ELSE
 15819        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 15820
 15821     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 15822     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 15823     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 15824
 15825 6299-EXIT.
 15826      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 303
* EL156.cbl
 15828 6300-UPDATE-CERT.
 15829
 15830*  ADD CERTNOTE FOR SC NP+6
 15831     IF PI-COMPANY-ID = 'CID' AND
 15832       (PI-PMTTYPE = '2' OR '3') AND
 15833        CL-CERT-STATE = 'SC'  AND
 15834        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15835           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15836     END-IF.
 15837
 15838     IF PI-COMPANY-ID = 'AHL' AND
 15839       (PI-PMTTYPE = '2' OR '3') AND
 15840        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 15841           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 15842           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15843     END-IF.
 15844
 15845     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15846     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15847     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15848     MOVE CL-CERT-STATE    TO CERT-STATE.
 15849     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15850     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15851     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15852     MOVE 'CERT'           TO FILE-SWITCH.
 15853
 15854     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15855
 15856     IF CERT-NOTE-ADDED
 15857        IF CM-NOTE-SW = ' '
 15858           MOVE '4'             TO CM-NOTE-SW
 15859        ELSE
 15860           IF CM-NOTE-SW = '1'
 15861               MOVE '5'           TO CM-NOTE-SW
 15862           ELSE
 15863              IF CM-NOTE-SW = '2'
 15864                 MOVE '6'         TO CM-NOTE-SW
 15865              ELSE
 15866                 IF CM-NOTE-SW = '3'
 15867                    MOVE '7'      TO CM-NOTE-SW
 15868                 END-IF
 15869              END-IF
 15870           END-IF
 15871        END-IF
 15872     END-IF.
 15873
 15874     IF PI-COMPANY-ID = 'CVL'
 15875         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15876         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15877
 15878     IF PI-PMTTYPE NOT = '4'
 15879        GO TO 6340-UPDATE-CERT.
 15880
 15881     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15882        IF PI-PFKEY-USED = DFHPF5
 15883           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15884        ELSE
 15885           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 304
* EL156.cbl
 15886
 15887*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15888*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15889*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15890*               PI-LF-COVERAGE-TYPE = 'P'
 15891*                GO TO 6350-REWRITE-CERT.
 15892
 15893     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15894       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15895          PI-LF-COVERAGE-TYPE = 'P'
 15896           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15897                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15898                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15899                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15900                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 15901                GO TO 6350-REWRITE-CERT
 15902            ELSE
 15903                GO TO 6350-REWRITE-CERT.
 15904
 15905     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15906         GO TO 6350-REWRITE-CERT.
 15907
 15908     IF NOT CM-AH-LUMP-SUM-DISAB
 15909        GO TO 6380-UNLOCK-CERT.
 15910
 15911     IF PI-PFKEY-USED = DFHPF5
 15912        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 15913                                    CM-AH-ITD-AH-PMT
 15914        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15915        GO TO 6350-REWRITE-CERT
 15916     ELSE
 15917        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 15918                                    CM-AH-ITD-AH-PMT
 15919        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15920        GO TO 6350-REWRITE-CERT.
 15921
 15922 6340-UPDATE-CERT.
 15923
 15924     IF CL-CLAIM-TYPE = 'L'
 15925         IF PI-PFKEY-USED = DFHPF5
 15926             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 15927         ELSE
 15928             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 15929
 15930     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15931         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15932             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15933                PI-LF-COVERAGE-TYPE = 'P'
 15934                 GO TO 6350-REWRITE-CERT.
 15935
 15936     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15937       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15938          PI-LF-COVERAGE-TYPE = 'P'
 15939           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15940                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15941                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15942                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15943                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 305
* EL156.cbl
 15944                GO TO 6350-REWRITE-CERT.
 15945
 15946     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15947         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 15948            PI-LF-COVERAGE-TYPE NOT = 'P'
 15949             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 15950             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 15951             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 15952             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 15953             GO TO 6350-REWRITE-CERT.
 15954
 15955     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15956         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 15957         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 15958         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 15959         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 15960         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 15961         IF PI-PFKEY-USED = DFHPF5
 15962             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 15963                                        CM-AH-ITD-AH-PMT
 15964             GO TO 6350-REWRITE-CERT
 15965         ELSE
 15966             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 15967                                        CM-AH-ITD-AH-PMT
 15968             GO TO 6350-REWRITE-CERT.
 15969
 15970 6350-REWRITE-CERT.
 15971
 15972
 15973* EXEC CICS REWRITE
 15974*         DATASET  ('ELCERT')
 15975*         FROM(CERTIFICATE-MASTER)
 15976*     END-EXEC.
 15977     MOVE LENGTH OF
 15978      CERTIFICATE-MASTER
 15979       TO DFHEIV11
 15980     MOVE 'ELCERT' TO DFHEIV1
 15981*    MOVE '&& L                  %   #00014851' TO DFHEIV0
 15982     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15983     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15984     MOVE X'2020233030303134383531' TO DFHEIV0(25:11)
 15985     CALL 'kxdfhei1' USING DFHEIV0,
 15986           DFHEIV1,
 15987           CERTIFICATE-MASTER,
 15988           DFHEIV11,
 15989           DFHEIV99
 15990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15991
 15992
 15993     GO TO 6399-EXIT.
 15994
 15995 6380-UNLOCK-CERT.
 15996
 15997* EXEC CICS UNLOCK
 15998*         DATASET  ('ELCERT')
 15999*     END-EXEC.
 16000     MOVE 'ELCERT' TO DFHEIV1
 16001*    MOVE '&*                    #   #00014859' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 306
* EL156.cbl
 16002     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16003     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16004     MOVE X'2020233030303134383539' TO DFHEIV0(25:11)
 16005     CALL 'kxdfhei1' USING DFHEIV0,
 16006           DFHEIV1,
 16007           DFHEIV99
 16008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16009
 16010
 16011 6399-EXIT.
 16012      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 307
* EL156.cbl
 16014 6400-UPDATE-ZERO-TRAILER.
 16015     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16016     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16017
 16018     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16019
 16020     IF PI-EPYAMT NOT = ZEROS
 16021         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16022     ELSE
 16023         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16024
 16025     IF PI-ERESV NOT = ZEROS
 16026        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16027
 16028     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16029        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16030
 16031     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16032        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16033     ELSE
 16034        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16035
 16036     IF PI-PMTTYPE = '5'
 16037        IF PI-EPYAMT = ZEROS
 16038           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16039        ELSE
 16040           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16041
 16042     IF PI-PMTTYPE = '6'
 16043        IF PI-EPYAMT = ZEROS
 16044           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16045        ELSE
 16046           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16047
 16048 6420-CHECK-OPEN-CLOSE.
 16049     IF PI-PMTTYPE = '5' OR '6'
 16050        GO TO 6450-REWRITE.
 16051
 16052     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16053         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16054             IF CLAIM-IS-CLOSED
 16055                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16056                 MOVE 1          TO  SUB-1
 16057                 GO TO 6440-AIG-LOOP.
 16058
 16059     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16060        GO TO 6450-REWRITE.
 16061
 16062     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16063        GO TO 6450-REWRITE.
 16064
 16065     MOVE 1                      TO SUB-1.
 16066
 16067 6430-LOOP.
 16068     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16069        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16070        IF PI-PMTTYPE = '1' OR '4'
 16071           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 308
* EL156.cbl
 16072           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16073           GO TO 6450-REWRITE
 16074        ELSE
 16075           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16076           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16077           GO TO 6450-REWRITE.
 16078
 16079     IF SUB-1 = 6
 16080      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16081      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16082      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16083      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16084      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16085      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16086      GO TO 6430-LOOP.
 16087
 16088     ADD 1                       TO SUB-1.
 16089     GO TO 6430-LOOP.
 16090
 16091
 16092 6440-AIG-LOOP.
 16093
 16094     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16095       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16096       IF WS-OPEN-CLOSE-SW = '1'
 16097         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16098         IF PI-PMTTYPE = '2'
 16099           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16100           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16101         ELSE
 16102           IF PI-PMTTYPE = '3'
 16103             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16104             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16105           ELSE
 16106             IF PI-PMTTYPE = '4'
 16107               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16108               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16109             ELSE
 16110               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16111               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16112       ELSE
 16113         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16114         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16115         GO TO 6450-REWRITE.
 16116
 16117     IF SUB-1 = 6
 16118      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16119      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16120      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16121      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16122      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16123      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16124      GO TO 6440-AIG-LOOP.
 16125
 16126     ADD 1                       TO SUB-1.
 16127     GO TO 6440-AIG-LOOP.
 16128
 16129 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 309
* EL156.cbl
 16130     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16131     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16132     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16133
 16134     IF PI-COMPANY-ID = 'DMD'
 16135         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16136         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16137         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16138         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16139         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16140
 16141
 16142* EXEC CICS REWRITE
 16143*         DATASET  ('ELTRLR')
 16144*         FROM     (ACTIVITY-TRAILERS)
 16145*     END-EXEC.
 16146     MOVE LENGTH OF
 16147      ACTIVITY-TRAILERS
 16148       TO DFHEIV11
 16149     MOVE 'ELTRLR' TO DFHEIV1
 16150*    MOVE '&& L                  %   #00014993' TO DFHEIV0
 16151     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16152     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16153     MOVE X'2020233030303134393933' TO DFHEIV0(25:11)
 16154     CALL 'kxdfhei1' USING DFHEIV0,
 16155           DFHEIV1,
 16156           ACTIVITY-TRAILERS,
 16157           DFHEIV11,
 16158           DFHEIV99
 16159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16160
 16161
 16162 6499-EXIT.
 16163      EXIT.
 16164
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 310
* EL156.cbl
 16166 6500-READ-DLO035.
 16167     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16168     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16169     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16170     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16171
 16172
 16173* EXEC CICS LINK
 16174*        PROGRAM    ('DLO035')
 16175*        COMMAREA   (DLO035-KEY)
 16176*        LENGTH     (DL35-LENGTH)
 16177*    END-EXEC.
 16178     MOVE 'DLO035' TO DFHEIV1
 16179*    MOVE '."C                   (   #00015008' TO DFHEIV0
 16180     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16181     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16182     MOVE X'2020233030303135303038' TO DFHEIV0(25:11)
 16183     CALL 'kxdfhei1' USING DFHEIV0,
 16184           DFHEIV1,
 16185           DLO035-KEY,
 16186           DL35-LENGTH,
 16187           DFHEIV99,
 16188           DFHEIV99,
 16189           DFHEIV99,
 16190           DFHEIV99
 16191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16192
 16193
 16194     IF DL35-RETURN-CODE = 'OK'
 16195         GO TO 6500-EXIT.
 16196
 16197     IF DL35-RETURN-CODE = '01'
 16198         MOVE ER-7830            TO EMI-ERROR
 16199         GO TO 6500-BAD-EXIT.
 16200
 16201     IF DL35-RETURN-CODE = '02'
 16202         MOVE ER-7831            TO EMI-ERROR
 16203         GO TO 6500-BAD-EXIT.
 16204
 16205     IF DL35-RETURN-CODE = '03'
 16206         MOVE ER-7832            TO EMI-ERROR
 16207         GO TO 6500-BAD-EXIT.
 16208
 16209     IF DL35-RETURN-CODE = '04'
 16210         MOVE ER-7833            TO EMI-ERROR
 16211         GO TO 6500-BAD-EXIT.
 16212
 16213     IF DL35-RETURN-CODE = '05'
 16214         MOVE ER-7834            TO EMI-ERROR
 16215         GO TO 6500-BAD-EXIT.
 16216
 16217     IF DL35-RETURN-CODE = '06'
 16218         MOVE ER-7835            TO EMI-ERROR
 16219         GO TO 6500-BAD-EXIT.
 16220
 16221     IF DL35-RETURN-CODE = '07'
 16222         MOVE ER-7836            TO EMI-ERROR
 16223         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 311
* EL156.cbl
 16224
 16225     IF DL35-RETURN-CODE = 'E1'
 16226         MOVE ER-7837            TO EMI-ERROR
 16227         GO TO 6500-BAD-EXIT.
 16228
 16229     IF DL35-RETURN-CODE NOT = 'OK'
 16230         MOVE ER-7838            TO EMI-ERROR
 16231         GO TO 6500-BAD-EXIT.
 16232
 16233 6500-EXIT.
 16234      EXIT.
 16235
 16236 6500-BAD-EXIT.
 16237
 16238* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16239*    MOVE '6"R                   !   #00015057' TO DFHEIV0
 16240     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16242     MOVE X'2020233030303135303537' TO DFHEIV0(25:11)
 16243     CALL 'kxdfhei1' USING DFHEIV0
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246     MOVE -1                 TO PMTTYPEL.
 16247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16248     GO TO 8200-SEND-DATAONLY.
 16249
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 312
* EL156.cbl
 16251 6600-UPDATE-DLO035.
 16252     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16253     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16254     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16255     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16256
 16257
 16258* EXEC CICS LINK
 16259*        PROGRAM    ('DLO035')
 16260*        COMMAREA   (DLO035-KEY)
 16261*        LENGTH     (DL35-LENGTH)
 16262*    END-EXEC.
 16263     MOVE 'DLO035' TO DFHEIV1
 16264*    MOVE '."C                   (   #00015069' TO DFHEIV0
 16265     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16267     MOVE X'2020233030303135303639' TO DFHEIV0(25:11)
 16268     CALL 'kxdfhei1' USING DFHEIV0,
 16269           DFHEIV1,
 16270           DLO035-KEY,
 16271           DL35-LENGTH,
 16272           DFHEIV99,
 16273           DFHEIV99,
 16274           DFHEIV99,
 16275           DFHEIV99
 16276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16277
 16278
 16279     IF DL35-RETURN-CODE = 'OK'
 16280         GO TO 6600-EXIT.
 16281
 16282     IF DL35-RETURN-CODE = '01'
 16283         MOVE ER-7830            TO EMI-ERROR
 16284         GO TO 6500-BAD-EXIT.
 16285
 16286     IF DL35-RETURN-CODE = '02'
 16287         MOVE ER-7831            TO EMI-ERROR
 16288         GO TO 6500-BAD-EXIT.
 16289
 16290     IF DL35-RETURN-CODE = '03'
 16291         MOVE ER-7832            TO EMI-ERROR
 16292         GO TO 6500-BAD-EXIT.
 16293
 16294     IF DL35-RETURN-CODE = '04'
 16295         MOVE ER-7833            TO EMI-ERROR
 16296         GO TO 6500-BAD-EXIT.
 16297
 16298     IF DL35-RETURN-CODE = '05'
 16299         MOVE ER-7834            TO EMI-ERROR
 16300         GO TO 6500-BAD-EXIT.
 16301
 16302     IF DL35-RETURN-CODE = '06'
 16303         MOVE ER-7835            TO EMI-ERROR
 16304         GO TO 6500-BAD-EXIT.
 16305
 16306     IF DL35-RETURN-CODE = '07'
 16307         MOVE ER-7836            TO EMI-ERROR
 16308         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 313
* EL156.cbl
 16309
 16310     IF DL35-RETURN-CODE = 'E1'
 16311         MOVE ER-7837            TO EMI-ERROR
 16312         GO TO 6500-BAD-EXIT.
 16313
 16314     IF DL35-RETURN-CODE NOT = 'OK'
 16315         MOVE ER-7838            TO EMI-ERROR
 16316         GO TO 6500-BAD-EXIT.
 16317
 16318 6600-EXIT.
 16319      EXIT.
 16320
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 314
* EL156.cbl
 16322 6700-UPDATE-ACTQ.
 16323***************************************************************
 16324*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16325*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16326*    ONE ALREADY THERE.                                       *
 16327***************************************************************
 16328
 16329
 16330* EXEC CICS HANDLE CONDITION
 16331*         NOTFND(6720-BUILD-NEW-RECORD)
 16332*     END-EXEC.
 16333*    MOVE '"$I                   ! 6 #00015125' TO DFHEIV0
 16334     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16336     MOVE X'3620233030303135313235' TO DFHEIV0(25:11)
 16337     CALL 'kxdfhei1' USING DFHEIV0
 16338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16339
 16340
 16341
 16342* EXEC CICS READ
 16343*         DATASET('ELACTQ')
 16344*         RIDFLD (ELMSTR-KEY)
 16345*         SET    (ADDRESS OF ACTIVITY-QUE)
 16346*         UPDATE
 16347*     END-EXEC.
 16348     MOVE 'ELACTQ' TO DFHEIV1
 16349*    MOVE '&"S        EU         (   #00015129' TO DFHEIV0
 16350     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16351     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16352     MOVE X'2020233030303135313239' TO DFHEIV0(25:11)
 16353     CALL 'kxdfhei1' USING DFHEIV0,
 16354           DFHEIV1,
 16355           DFHEIV20,
 16356           DFHEIV99,
 16357           ELMSTR-KEY,
 16358           DFHEIV99,
 16359           DFHEIV99,
 16360           DFHEIV99
 16361     SET ADDRESS OF ACTIVITY-QUE TO
 16362         DFHEIV20
 16363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16364
 16365
 16366     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16367
 16368     IF PI-AIG-SPECIAL-BENEFIT AND
 16369        PI-CASH = 'Y'
 16370         ADD 2                   TO AQ-PAYMENT-COUNTER
 16371     ELSE
 16372         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16373
 16374     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16375         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16376
 16377     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16378
 16379     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 315
* EL156.cbl
 16380         IF WS-PMT-APPROVAL-SW = 'A'
 16381             NEXT SENTENCE
 16382         ELSE
 16383            IF PI-AIG-SPECIAL-BENEFIT AND
 16384               PI-CASH = 'Y'
 16385                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16386                                     WS-PMT-UNAPPROVED-CNT
 16387            ELSE
 16388                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16389                                     WS-PMT-UNAPPROVED-CNT
 16390     ELSE
 16391         IF PI-PMT-APPR-SW = 'Y'
 16392            IF PI-AIG-SPECIAL-BENEFIT AND
 16393               PI-CASH = 'Y'
 16394                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16395                                     WS-PMT-UNAPPROVED-CNT
 16396            ELSE
 16397                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16398                                     WS-PMT-UNAPPROVED-CNT.
 16399
 16400     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16401         MOVE ER-3536 TO EMI-ERROR
 16402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16403
 16404     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16405
 16406
 16407* EXEC CICS REWRITE
 16408*         DATASET('ELACTQ')
 16409*         FROM   (ACTIVITY-QUE)
 16410*     END-EXEC.
 16411     MOVE LENGTH OF
 16412      ACTIVITY-QUE
 16413       TO DFHEIV11
 16414     MOVE 'ELACTQ' TO DFHEIV1
 16415*    MOVE '&& L                  %   #00015176' TO DFHEIV0
 16416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16418     MOVE X'2020233030303135313736' TO DFHEIV0(25:11)
 16419     CALL 'kxdfhei1' USING DFHEIV0,
 16420           DFHEIV1,
 16421           ACTIVITY-QUE,
 16422           DFHEIV11,
 16423           DFHEIV99
 16424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16425
 16426
 16427     GO TO 6799-EXIT.
 16428
 16429 6720-BUILD-NEW-RECORD.
 16430
 16431* EXEC CICS GETMAIN
 16432*         SET    (ADDRESS OF ACTIVITY-QUE)
 16433*         LENGTH (60)
 16434*         INITIMG(GETMAIN-SPACE)
 16435*     END-EXEC.
 16436     MOVE 60
 16437       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 316
* EL156.cbl
 16438*    MOVE ',"IL                  $   #00015184' TO DFHEIV0
 16439     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16440     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16441     MOVE X'2020233030303135313834' TO DFHEIV0(25:11)
 16442     CALL 'kxdfhei1' USING DFHEIV0,
 16443           DFHEIV20,
 16444           DFHEIV11,
 16445           GETMAIN-SPACE
 16446     SET ADDRESS OF ACTIVITY-QUE TO
 16447         DFHEIV20
 16448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16449
 16450
 16451     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16452
 16453     IF PI-AIG-SPECIAL-BENEFIT AND
 16454        PI-CASH = 'Y'
 16455         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16456     ELSE
 16457         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16458
 16459     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16460     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16461     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16462     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16463                                    AQ-FOLLOWUP-DATE.
 16464     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16465     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16466
 16467     IF PI-PMT-GRADUATED
 16468         IF WS-PMT-APPROVAL-SW = 'A'
 16469             NEXT SENTENCE
 16470         ELSE
 16471            IF PI-AIG-SPECIAL-BENEFIT AND
 16472               PI-CASH = 'Y'
 16473                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16474            ELSE
 16475                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16476     ELSE
 16477         IF PI-PMT-APPR-SW = 'Y'
 16478            IF PI-AIG-SPECIAL-BENEFIT AND
 16479               PI-CASH = 'Y'
 16480                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16481            ELSE
 16482                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16483
 16484     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16485         MOVE ER-3536 TO EMI-ERROR
 16486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16487
 16488
 16489* EXEC CICS WRITE
 16490*         DATASET('ELACTQ')
 16491*         RIDFLD (ELMSTR-KEY)
 16492*         FROM   (ACTIVITY-QUE)
 16493*     END-EXEC.
 16494     MOVE LENGTH OF
 16495      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 317
* EL156.cbl
 16496       TO DFHEIV11
 16497     MOVE 'ELACTQ' TO DFHEIV1
 16498*    MOVE '&$ L                  ''   #00015227' TO DFHEIV0
 16499     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16501     MOVE X'2020233030303135323237' TO DFHEIV0(25:11)
 16502     CALL 'kxdfhei1' USING DFHEIV0,
 16503           DFHEIV1,
 16504           ACTIVITY-QUE,
 16505           DFHEIV11,
 16506           ELMSTR-KEY,
 16507           DFHEIV99,
 16508           DFHEIV99
 16509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16510
 16511
 16512 6799-EXIT.
 16513      EXIT.
 16514
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 318
* EL156.cbl
 16516 6800-BUILD-FORM-TRAILER.
 16517
 16518
 16519* EXEC CICS GETMAIN
 16520*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16521*         LENGTH   (200)
 16522*         INITIMG  (GETMAIN-SPACE)
 16523*    END-EXEC.
 16524     MOVE 200
 16525       TO DFHEIV11
 16526*    MOVE ',"IL                  $   #00015239' TO DFHEIV0
 16527     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16528     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16529     MOVE X'2020233030303135323339' TO DFHEIV0(25:11)
 16530     CALL 'kxdfhei1' USING DFHEIV0,
 16531           DFHEIV20,
 16532           DFHEIV11,
 16533           GETMAIN-SPACE
 16534     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16535         DFHEIV20
 16536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16537
 16538
 16539     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16540
 16541     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16542     MOVE 'AT'                   TO AT-RECORD-ID.
 16543     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16544
 16545     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16546     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16547                                    AT-FORM-LAST-MAINT-DT
 16548                                    AT-FORM-SEND-ON-DT.
 16549     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16550                                    AT-FORM-LAST-UPDATED-BY.
 16551     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16552     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16553     MOVE '6'                    TO DC-OPTION-CODE.
 16554     MOVE +29                    TO DC-ELAPSED-DAYS.
 16555     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16556     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16557     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16558
 16559     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16560         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16561
 16562     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16563                                    AT-FORM-RE-SEND-DT
 16564                                    AT-EMP-FORM-ANSWERED-DT
 16565                                    AT-PHY-FORM-ANSWERED-DT
 16566                                    AT-EMP-FORM-SEND-ON-DT
 16567                                    AT-PHY-FORM-SEND-ON-DT
 16568                                    AT-FORM-PRINTED-DT
 16569                                    AT-FORM-REPRINT-DT.
 16570     MOVE '2'                    TO AT-FORM-TYPE.
 16571
 16572     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16573     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 319
* EL156.cbl
 16574
 16575     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16576         NEXT SENTENCE
 16577     ELSE
 16578         IF CL-PROG-FORM-TYPE NOT = 'S'
 16579            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16580
 16581
 16582* EXEC CICS WRITE
 16583*         DATASET  ('ELTRLR')
 16584*         FROM     (ACTIVITY-TRAILERS)
 16585*         RIDFLD   (AT-CONTROL-PRIMARY)
 16586*     END-EXEC.
 16587     MOVE LENGTH OF
 16588      ACTIVITY-TRAILERS
 16589       TO DFHEIV11
 16590     MOVE 'ELTRLR' TO DFHEIV1
 16591*    MOVE '&$ L                  ''   #00015287' TO DFHEIV0
 16592     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16593     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16594     MOVE X'2020233030303135323837' TO DFHEIV0(25:11)
 16595     CALL 'kxdfhei1' USING DFHEIV0,
 16596           DFHEIV1,
 16597           ACTIVITY-TRAILERS,
 16598           DFHEIV11,
 16599           AT-CONTROL-PRIMARY,
 16600           DFHEIV99,
 16601           DFHEIV99
 16602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16603
 16604
 16605 6899-EXIT.
 16606      EXIT.
 16607
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 320
* EL156.cbl
 16609 6900-BUILD-ARCHIVE-HEADER.
 16610
 16611     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16612     MOVE '1'                    TO CNTL-REC-TYPE.
 16613     MOVE +0                     TO CNTL-SEQ-NO.
 16614     MOVE SPACES                 TO CNTL-ACCESS.
 16615
 16616
 16617* EXEC CICS READ
 16618*         DATASET  ('ELCNTL')
 16619*         SET      (ADDRESS OF CONTROL-FILE)
 16620*         RIDFLD   (ELCNTL-KEY)
 16621*         UPDATE
 16622*    END-EXEC.
 16623     MOVE 'ELCNTL' TO DFHEIV1
 16624*    MOVE '&"S        EU         (   #00015304' TO DFHEIV0
 16625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16626     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16627     MOVE X'2020233030303135333034' TO DFHEIV0(25:11)
 16628     CALL 'kxdfhei1' USING DFHEIV0,
 16629           DFHEIV1,
 16630           DFHEIV20,
 16631           DFHEIV99,
 16632           ELCNTL-KEY,
 16633           DFHEIV99,
 16634           DFHEIV99,
 16635           DFHEIV99
 16636     SET ADDRESS OF CONTROL-FILE TO
 16637         DFHEIV20
 16638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16639
 16640
 16641     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16642     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16643
 16644
 16645* EXEC CICS REWRITE
 16646*         FROM     (CONTROL-FILE)
 16647*         DATASET  ('ELCNTL')
 16648*    END-EXEC.
 16649     MOVE LENGTH OF
 16650      CONTROL-FILE
 16651       TO DFHEIV11
 16652     MOVE 'ELCNTL' TO DFHEIV1
 16653*    MOVE '&& L                  %   #00015314' TO DFHEIV0
 16654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16656     MOVE X'2020233030303135333134' TO DFHEIV0(25:11)
 16657     CALL 'kxdfhei1' USING DFHEIV0,
 16658           DFHEIV1,
 16659           CONTROL-FILE,
 16660           DFHEIV11,
 16661           DFHEIV99
 16662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16663
 16664
 16665
 16666* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 321
* EL156.cbl
 16667*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 16668*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 16669*    END-EXEC.
 16670*    MOVE '"$$%                  ! 7 #00015319' TO DFHEIV0
 16671     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 16672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16673     MOVE X'3720233030303135333139' TO DFHEIV0(25:11)
 16674     CALL 'kxdfhei1' USING DFHEIV0
 16675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16676
 16677
 16678
 16679* EXEC CICS GETMAIN
 16680*         SET     (ADDRESS OF LETTER-ARCHIVE)
 16681*         LENGTH  (ELARCH-LENGTH)
 16682*         INITIMG (GETMAIN-SPACE)
 16683*    END-EXEC.
 16684*    MOVE ',"IL                  $   #00015324' TO DFHEIV0
 16685     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16686     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16687     MOVE X'2020233030303135333234' TO DFHEIV0(25:11)
 16688     CALL 'kxdfhei1' USING DFHEIV0,
 16689           DFHEIV20,
 16690           ELARCH-LENGTH,
 16691           GETMAIN-SPACE
 16692     SET ADDRESS OF LETTER-ARCHIVE TO
 16693         DFHEIV20
 16694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16695
 16696
 16697     MOVE 'LA'                   TO LA-RECORD-ID.
 16698     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 16699                                    LA-ARCHIVE-NO-A1.
 16700     MOVE '4'                    TO LA-RECORD-TYPE
 16701                                    LA-RECORD-TYPE-A1.
 16702     MOVE +0                     TO LA-LINE-SEQ-NO
 16703                                    LA-LINE-SEQ-NO-A1.
 16704     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 16705                                    LA-COMPANY-CD-A1.
 16706     MOVE CL-CARRIER             TO LA4-CARRIER.
 16707     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 16708     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 16709     MOVE CL-CERT-STATE          TO LA4-STATE.
 16710     MOVE +0                     TO LA4-NO-OF-COPIES.
 16711     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 16712     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 16713     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 16714                                    LA4-INITIAL-PRINT-DATE
 16715                                    LA4-RESEND-PRINT-DATE
 16716                                    LA4-FORM-REM-PRINT-DT.
 16717     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 16718     MOVE '2'                    TO LA4-FORM-TYPE.
 16719
 16720
 16721* EXEC CICS WRITE
 16722*         DATASET  ('ELARCH')
 16723*         FROM     (LETTER-ARCHIVE)
 16724*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 322
* EL156.cbl
 16725*    END-EXEC.
 16726     MOVE LENGTH OF
 16727      LETTER-ARCHIVE
 16728       TO DFHEIV11
 16729     MOVE 'ELARCH' TO DFHEIV1
 16730*    MOVE '&$ L                  ''   #00015353' TO DFHEIV0
 16731     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16732     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16733     MOVE X'2020233030303135333533' TO DFHEIV0(25:11)
 16734     CALL 'kxdfhei1' USING DFHEIV0,
 16735           DFHEIV1,
 16736           LETTER-ARCHIVE,
 16737           DFHEIV11,
 16738           LA-CONTROL-PRIMARY,
 16739           DFHEIV99,
 16740           DFHEIV99
 16741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16742
 16743
 16744 6999-EXIT.
 16745      EXIT.
 16746
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 323
* EL156.cbl
 16748 7000-SHOW-CLAIM.
 16749     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 16750     MOVE 'A'                    TO PI-PASS-SW.
 16751     MOVE LOW-VALUES             TO PI-CPYFROM
 16752                                    PI-MONTH-END-SAVE
 16753                                    PI-CPYTHRU.
 16754
 16755     MOVE ZEROS                  TO PI-FATAL-COUNT
 16756                                    PI-DAILY-RATE
 16757                                    PI-BEN-DAYS
 16758                                    PI-MANUAL-SW
 16759                                    PI-SAVE-CURSOR
 16760                                    PI-FORCE-COUNT
 16761                                    PI-HOLDTIL
 16762                                    PI-EPYFROM
 16763                                    PI-EPYTHRU
 16764                                    PI-EDAYS
 16765                                    PI-EPYAMT
 16766                                    PI-ERESV
 16767                                    PI-EEXPENS
 16768                                    PI-CDAYS
 16769                                    PI-CPYAMT
 16770                                    PI-CRESV
 16771                                    PI-CEXPENS
 16772                                    PI-INT-RATE
 16773                                    PI-AIGFROM.
 16774     MOVE ZEROS                  TO PI-PROOF-DATE.
 16775     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 16776                                    PI-REM-BEN-AMT
 16777                                    PI-MO-BEN-AMT.
 16778
 16779     MOVE LOW-VALUES             TO EL156AI.
 16780     MOVE MAP-NAMEA              TO MAP-NAME.
 16781
 16782* EXEC CICS HANDLE CONDITION
 16783*        NOTFND   (7010-BUILD-MAP)
 16784*    END-EXEC.
 16785*    MOVE '"$I                   ! 8 #00015396' TO DFHEIV0
 16786     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16788     MOVE X'3820233030303135333936' TO DFHEIV0(25:11)
 16789     CALL 'kxdfhei1' USING DFHEIV0
 16790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16791
 16792
 16793     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16794     MOVE '2'                    TO CNTL-REC-TYPE.
 16795     MOVE +0                     TO CNTL-SEQ-NO.
 16796     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16797
 16798
 16799* EXEC CICS READ
 16800*         DATASET  ('ELCNTL')
 16801*         SET      (ADDRESS OF CONTROL-FILE)
 16802*         RIDFLD   (ELCNTL-KEY)
 16803*    END-EXEC.
 16804     MOVE 'ELCNTL' TO DFHEIV1
 16805*    MOVE '&"S        E          (   #00015405' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 324
* EL156.cbl
 16806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16808     MOVE X'2020233030303135343035' TO DFHEIV0(25:11)
 16809     CALL 'kxdfhei1' USING DFHEIV0,
 16810           DFHEIV1,
 16811           DFHEIV20,
 16812           DFHEIV99,
 16813           ELCNTL-KEY,
 16814           DFHEIV99,
 16815           DFHEIV99,
 16816           DFHEIV99
 16817     SET ADDRESS OF CONTROL-FILE TO
 16818         DFHEIV20
 16819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16820
 16821
 16822     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 16823
 16824     IF PI-APPROVAL-LEVEL = '4'
 16825         MOVE AL-UANON      TO SURVYYNA
 16826     END-IF.
 16827
 16828
 16829     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16830     MOVE '1'                    TO CNTL-REC-TYPE.
 16831     MOVE SPACES                 TO CNTL-ACCESS.
 16832     MOVE +0                     TO CNTL-SEQ-NO.
 16833
 16834
 16835* EXEC CICS READ
 16836*         DATASET  ('ELCNTL')
 16837*         SET      (ADDRESS OF CONTROL-FILE)
 16838*         RIDFLD   (ELCNTL-KEY)
 16839*    END-EXEC.
 16840     MOVE 'ELCNTL' TO DFHEIV1
 16841*    MOVE '&"S        E          (   #00015423' TO DFHEIV0
 16842     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16844     MOVE X'2020233030303135343233' TO DFHEIV0(25:11)
 16845     CALL 'kxdfhei1' USING DFHEIV0,
 16846           DFHEIV1,
 16847           DFHEIV20,
 16848           DFHEIV99,
 16849           ELCNTL-KEY,
 16850           DFHEIV99,
 16851           DFHEIV99,
 16852           DFHEIV99
 16853     SET ADDRESS OF CONTROL-FILE TO
 16854         DFHEIV20
 16855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16856
 16857
 16858     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 16859
 16860 7010-BUILD-MAP.
 16861
 16862
 16863* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 325
* EL156.cbl
 16864*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16865*    END-EXEC.
 16866*    MOVE '"$I                   ! 9 #00015433' TO DFHEIV0
 16867     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16869     MOVE X'3920233030303135343333' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0
 16871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16872
 16873
 16874     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16875     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16876     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16877     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16878     MOVE 'MSTR'                 TO FILE-SWITCH.
 16879
 16880     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16881
 16882     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16883     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16884     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16885     MOVE CL-CCN                 TO PI-SV-CCN.
 16886
 16887     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 16888     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 16889     MOVE CL-CLAIM-NO            TO CLMNOO.
 16890     MOVE CL-CARRIER             TO CARRO.
 16891     MOVE CL-CERT-PRIME          TO CERTNOO.
 16892     MOVE CL-CERT-SFX            TO SUFXO.
 16893
 16894     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 16895        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 16896        CONTINUE
 16897     ELSE
 16898        MOVE AL-SADOF            TO ZINTHA
 16899                                    ZINTA
 16900                                    PINTHA
 16901                                    PINTA
 16902     END-IF
 16903     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 16904     EVALUATE TRUE
 16905     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 16906         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 16907     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16908         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 16909
 16910     WHEN CL-CLAIM-TYPE = 'I'
 16911         MOVE '  IU  '           TO CLMTYPO
 16912     WHEN CL-CLAIM-TYPE = 'G'
 16913         MOVE ' GAP  '           TO CLMTYPO
 16914     END-EVALUATE.
 16915     IF CLAIM-IS-OPEN
 16916         MOVE ' OPEN'            TO CLMSTATO
 16917     ELSE
 16918         MOVE 'CLOSED'           TO CLMSTATO.
 16919
 16920     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 16921
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 326
* EL156.cbl
 16922     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 16923         MOVE SPACES             TO  PCERTNOO
 16924                                     PSUFXO
 16925                                     PRIMHDGO
 16926                                     SEQUO
 16927         MOVE AL-SADOF           TO  PCERTNOA
 16928                                     PSUFXA
 16929                                     PRIMHDGA
 16930                                     SEQUA
 16931     ELSE
 16932         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 16933         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 16934         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 16935         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 16936         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 16937         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 16938         MOVE AL-SANON               TO  PCERTNOA
 16939                                         PSUFXA
 16940                                         PRIMHDGA
 16941         MOVE AL-SABON               TO  SEQUA.
 16942
 16943     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 16944
 16945     IF CL-NO-OF-PMTS-MADE = 0 AND
 16946        CL-TOTAL-PAID-AMT = 0
 16947         NEXT SENTENCE
 16948     ELSE
 16949         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 16950             IF NOT PI-USES-PAID-TO
 16951                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16952                 MOVE ' '                 TO DC-OPTION-CODE
 16953                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16954                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 16955             ELSE
 16956                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 16957                 MOVE '6'                 TO DC-OPTION-CODE
 16958                 MOVE +1                  TO DC-ELAPSED-DAYS
 16959                 MOVE +0                  TO DC-ELAPSED-MONTHS
 16960                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16961                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 16962
 16963     IF MAP-NAME = 'EL156A'
 16964        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 16965           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16966             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 16967           end-if
 16968        end-if
 16969     end-if
 16970     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 16971         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 16972         MOVE ' '                TO DC-OPTION-CODE
 16973         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16974         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 16975
 16976     IF CL-INCURRED-DT NOT = LOW-VALUES
 16977         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 16978         MOVE ' '                TO DC-OPTION-CODE
 16979         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 327
* EL156.cbl
 16980         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 16981
 16982     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 16983
 16984     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 16985         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 16986         MOVE ' '                TO DC-OPTION-CODE
 16987         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16988         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 16989
 16990     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16991         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 16992         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 16993     ELSE
 16994         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 16995         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 16996
 16997     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 16998     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 16999     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17000     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17001                                    PI-GROUPING.
 17002     MOVE CL-CERT-STATE          TO CERT-STATE
 17003                                    PI-STATE.
 17004     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17005                                    PI-ACCOUNT.
 17006     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17007     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17008     MOVE 'CERT'                 TO FILE-SWITCH.
 17009
 17010     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17011     if pi-company-id = 'DCC'
 17012        perform 7975-read-acct   thru 7975-exit
 17013     end-if
 17014     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17015     MOVE PI-STATE               TO WS-ST-ACCESS.
 17016     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17017     MOVE '3'                    TO CNTL-REC-TYPE.
 17018     MOVE +0                     TO CNTL-SEQ-NO.
 17019     MOVE 'STAT'                 TO FILE-SWITCH.
 17020
 17021     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17022
 17023     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17024     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17025
 17026     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17027        GO TO 7020-BYPASS-BENEFIT.
 17028
 17029     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17030     MOVE '4'                    TO CNTL-REC-TYPE.
 17031     MOVE +0                     TO CNTL-SEQ-NO.
 17032     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17033     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17034     MOVE 'BENE'                 TO FILE-SWITCH.
 17035
 17036     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17037
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 328
* EL156.cbl
 17038     IF NO-BENEFIT-FOUND
 17039        GO TO 7020-BYPASS-BENEFIT.
 17040
 17041     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17042     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17043     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17044
 17045 7020-BYPASS-BENEFIT.
 17046
 17047*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17048*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17049*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17050
 17051     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17052         GO TO 7021-GO-TO-LIFE.
 17053     move zeros                  to PI-MAX-BENEFIT-AMT
 17054     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17055
 17056     IF (PI-COMPANY-ID = 'DCC')
 17057        and (acct-found)
 17058        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17059        MOVE ' '                 TO WS-PDEF-RECORD-SW
 17060        PERFORM 0900-GET-DDF-FACTORS
 17061                                 THRU 0900-EXIT
 17062        IF PDEF-FOUND
 17063           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17064              (P1 > +8)
 17065              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17066           END-PERFORM
 17067           IF P1 < +9
 17068              MOVE PD-MAX-AMT (P1)
 17069                                 TO PI-MAX-BENEFIT-AMT
 17070           END-IF
 17071        END-IF
 17072     end-if
 17073     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17074     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17075     if (pi-max-benefit-amt not = zeros)
 17076        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17077        move pi-max-benefit-amt  to beneo
 17078     else
 17079        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17080     end-if
 17081     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17082     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17083                                    CP-ORIGINAL-TERM.
 17084     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17085
 17086*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17087*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17088*    ELSE
 17089         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17090
 17091     MOVE ' '                    TO DC-OPTION-CODE.
 17092     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17093     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17094
 17095     IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 329
* EL156.cbl
 17096         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17097         GO TO 7023-BYPASS-REMAINING-TERM.
 17098
 17099     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17100     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17101     GO TO 7022-AROUND-LIFE.
 17102
 17103 7021-GO-TO-LIFE.
 17104
 17105     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17106     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17107     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17108                                    CP-ORIGINAL-TERM.
 17109     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17110     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17111     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17112     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17113
 17114     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17115         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17116     ELSE
 17117         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17118
 17119     MOVE ' '                    TO DC-OPTION-CODE.
 17120     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17121     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17122
 17123 7022-AROUND-LIFE.
 17124
 17125     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17126     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17127     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17128     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17129     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17130     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17131     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17132
 17133     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17134
 17135     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17136        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17137           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17138
 17139     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17140        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17141           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17142
 17143 7023-BYPASS-REMAINING-TERM.
 17144     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17145       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17146          MOVE ZEROS                  TO BENEO
 17147       ELSE
 17148          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17149          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17150          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17151          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17152          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17153          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 330
* EL156.cbl
 17154          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17155          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17156          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17157          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17158          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17159          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17160          IF (PI-COMPANY-ID = 'DCC')
 17161             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17162             MOVE ' '            TO WS-PDEF-RECORD-SW
 17163             PERFORM 0900-GET-DDF-FACTORS
 17164                                 THRU 0900-EXIT
 17165             IF PDEF-FOUND
 17166                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17167                   (P1 > +8)
 17168                   OR (PD-PROD-CODE (P1) = 'L')
 17169                END-PERFORM
 17170                IF P1 < +9
 17171                   MOVE PD-MAX-AMT (P1)
 17172                                 TO CP-R-MAX-TOT-BEN
 17173                END-IF
 17174             END-IF
 17175          END-IF
 17176
 17177* EXEC CICS LINK
 17178*            PROGRAM  (LINK-REMAMT)
 17179*            COMMAREA (CALCULATION-PASS-AREA)
 17180*            LENGTH   (CP-COMM-LENGTH)
 17181*         END-EXEC
 17182*    MOVE '."C                   (   #00015739' TO DFHEIV0
 17183     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17185     MOVE X'2020233030303135373339' TO DFHEIV0(25:11)
 17186     CALL 'kxdfhei1' USING DFHEIV0,
 17187           LINK-REMAMT,
 17188           CALCULATION-PASS-AREA,
 17189           CP-COMM-LENGTH,
 17190           DFHEIV99,
 17191           DFHEIV99,
 17192           DFHEIV99,
 17193           DFHEIV99
 17194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17195          MOVE CP-REMAINING-AMT       TO BENEO
 17196       end-if
 17197     end-if
 17198     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17199     MOVE +95                    TO TRLR-SEQ-NO
 17200
 17201* EXEC CICS READ
 17202*       DATASET  ('ELTRLR')
 17203*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17204*       RIDFLD   (ELTRLR-KEY)
 17205*       RESP     (WS-RESPONSE)
 17206*    END-EXEC
 17207     MOVE 'ELTRLR' TO DFHEIV1
 17208*    MOVE '&"S        E          (  N#00015749' TO DFHEIV0
 17209     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17211     MOVE X'204E233030303135373439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 331
* EL156.cbl
 17212     CALL 'kxdfhei1' USING DFHEIV0,
 17213           DFHEIV1,
 17214           DFHEIV20,
 17215           DFHEIV99,
 17216           ELTRLR-KEY,
 17217           DFHEIV99,
 17218           DFHEIV99,
 17219           DFHEIV99
 17220     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17221         DFHEIV20
 17222     MOVE EIBRESP  TO WS-RESPONSE
 17223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17224
 17225     if ws-resp-normal
 17226        perform varying s1 from +1 by +1 until
 17227           at-note-error-no (s1) = spaces
 17228           move at-note-error-no (s1)
 17229                                 to emi-error
 17230           if at-note-error-no (s1) = '1653'
 17231              evaluate true
 17232                 when cl-claim-type = 'L'
 17233                    move '  LF  '
 17234                                 to emi-claim-type
 17235                 when cl-claim-type = 'I'
 17236                    move '  IU  '
 17237                                 to emi-claim-type
 17238                 when other
 17239                    move '  AH  '
 17240                                 to emi-claim-type
 17241              end-evaluate
 17242           end-if
 17243           PERFORM 9900-ERROR-FORMAT
 17244                                 THRU 9900-EXIT
 17245        end-perform
 17246     end-if
 17247     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17248         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17249            WS-LF-COVERAGE-TYPE = 'P'
 17250             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17251                                        CM-LF-ITD-DEATH-AMT
 17252             MOVE WS-REMAINING-AMT  TO  BENEO.
 17253
 17254     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17255     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17256     MOVE WS-TERMS               TO TERMSO.
 17257
 17258     IF WS-STATUS = '6' OR '7' OR '8'
 17259         MOVE AL-SABOF           TO CRTSTATA.
 17260
 17261     IF WS-STATUS = '1' OR '4'
 17262        IF CP-REMAINING-TERM-3 = ZEROS
 17263           MOVE 'EXPIRED'        TO CRTSTATO
 17264        ELSE
 17265           MOVE 'ACTIVE  '       TO CRTSTATO.
 17266
 17267     IF WS-STATUS = '2'
 17268         MOVE 'PEND    '         TO CRTSTATO.
 17269
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 332
* EL156.cbl
 17270     IF WS-STATUS = '3'
 17271         MOVE 'RESTORE '         TO CRTSTATO.
 17272
 17273     IF WS-STATUS = '5'
 17274         MOVE 'REISSUE '         TO CRTSTATO.
 17275
 17276     IF WS-STATUS = '6'
 17277         MOVE 'LMP DIS'          TO CRTSTATO.
 17278
 17279     IF WS-STATUS = '7'
 17280         MOVE 'DEATH'            TO CRTSTATO.
 17281
 17282     IF WS-STATUS = '8'
 17283         MOVE 'CANCEL'           TO CRTSTATO.
 17284
 17285     IF WS-STATUS = '9'
 17286         MOVE 'RE-ONLY '         TO CRTSTATO.
 17287
 17288     IF WS-STATUS = 'V'
 17289         MOVE 'VOID  '           TO CRTSTATO.
 17290
 17291     IF WS-STATUS = 'D'
 17292         MOVE 'DECLINE '         TO CRTSTATO.
 17293
 17294     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17295         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17296         MOVE '5'                TO CNTL-REC-TYPE
 17297     ELSE
 17298         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17299         MOVE '4'                TO CNTL-REC-TYPE.
 17300
 17301     MOVE '** NONE **'           TO COVERO.
 17302     MOVE AL-SABON               TO COVERA.
 17303
 17304     IF PI-COMPANY-ID = 'CVL'
 17305         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17306             MOVE CM-BENEFICIARY TO LOANNOO
 17307             MOVE AL-UANON       TO LOANNOA.
 17308
 17309     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17310        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17311        MOVE +91                 TO  TRLR-SEQ-NO
 17312
 17313* EXEC CICS READ
 17314*           DATASET  ('ELTRLR')
 17315*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17316*           RIDFLD   (ELTRLR-KEY)
 17317*           RESP     (WS-RESPONSE)
 17318*       END-EXEC
 17319     MOVE 'ELTRLR' TO DFHEIV1
 17320*    MOVE '&"S        E          (  N#00015843' TO DFHEIV0
 17321     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17323     MOVE X'204E233030303135383433' TO DFHEIV0(25:11)
 17324     CALL 'kxdfhei1' USING DFHEIV0,
 17325           DFHEIV1,
 17326           DFHEIV20,
 17327           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 333
* EL156.cbl
 17328           ELTRLR-KEY,
 17329           DFHEIV99,
 17330           DFHEIV99,
 17331           DFHEIV99
 17332     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17333         DFHEIV20
 17334     MOVE EIBRESP  TO WS-RESPONSE
 17335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17336
 17337        IF WS-RESP-NORMAL
 17338           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17339        ELSE
 17340           MOVE SPACES           TO  LOANNOO
 17341        END-IF
 17342*052506
 17343*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17344*052506
 17345     END-IF
 17346
 17347     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17348        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17349
 17350     IF WS-BEN-CD = ZEROS
 17351         GO TO 7050-SHOW-CONTINUE.
 17352
 17353     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17354     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17355     MOVE +0                     TO CNTL-SEQ-NO.
 17356     MOVE 'BENE'                 TO FILE-SWITCH.
 17357
 17358     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17359
 17360     IF BENEFIT-FOUND
 17361         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17362         MOVE AL-SANON                    TO COVERA.
 17363
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 334
* EL156.cbl
 17365 7050-SHOW-CONTINUE.
 17366
 17367     IF PI-COMPANY-ID = 'DMD'
 17368         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17369
 17370     MOVE -1                     TO PMTTYPEL.
 17371     GO TO 8100-SEND-INITIAL-MAP.
 17372
 17373 7100-SHOW-RECORD-NOT-FOUND.
 17374     IF FILE-SWITCH = 'MSTR'
 17375         MOVE ER-0204            TO EMI-ERROR.
 17376
 17377     IF FILE-SWITCH = 'CERT'
 17378         MOVE ER-0206            TO EMI-ERROR.
 17379
 17380     IF FILE-SWITCH = 'STAT'
 17381         MOVE ER-0149            TO EMI-ERROR.
 17382
 17383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17384
 17385     MOVE -1                     TO PMTTYPEL.
 17386     GO TO 8100-SEND-INITIAL-MAP
 17387
 17388     .
 17389 7110-BUILD-PMT-TRLR.
 17390     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17391     MOVE +51                    TO TRLR-SEQ-NO
 17392
 17393* EXEC CICS READ
 17394*        DATASET  ('ELTRLR')
 17395*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17396*        RIDFLD   (ELTRLR-KEY)
 17397*        RESP     (WS-RESPONSE)
 17398*    END-EXEC
 17399     MOVE 'ELTRLR' TO DFHEIV1
 17400*    MOVE '&"S        E          (  N#00015905' TO DFHEIV0
 17401     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17403     MOVE X'204E233030303135393035' TO DFHEIV0(25:11)
 17404     CALL 'kxdfhei1' USING DFHEIV0,
 17405           DFHEIV1,
 17406           DFHEIV20,
 17407           DFHEIV99,
 17408           ELTRLR-KEY,
 17409           DFHEIV99,
 17410           DFHEIV99,
 17411           DFHEIV99
 17412     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17413         DFHEIV20
 17414     MOVE EIBRESP  TO WS-RESPONSE
 17415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17416     IF WS-RESP-NORMAL
 17417        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 17418     END-IF
 17419     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17420
 17421* EXEC CICS GETMAIN
 17422*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 335
* EL156.cbl
 17423*         LENGTH    (200)
 17424*         INITIMG   (GETMAIN-SPACE)
 17425*     END-EXEC
 17426     MOVE 200
 17427       TO DFHEIV11
 17428*    MOVE ',"IL                  $   #00015915' TO DFHEIV0
 17429     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17430     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17431     MOVE X'2020233030303135393135' TO DFHEIV0(25:11)
 17432     CALL 'kxdfhei1' USING DFHEIV0,
 17433           DFHEIV20,
 17434           DFHEIV11,
 17435           GETMAIN-SPACE
 17436     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17437         DFHEIV20
 17438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17439     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17440                                    AT-PREV-PAID-THRU-DT
 17441     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17442     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17443     MOVE 'AT'                   TO AT-RECORD-ID
 17444     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17445     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17446     MOVE '2'                    TO AT-TRAILER-TYPE
 17447     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17448                                    AT-PAYMENT-LAST-MAINT-DT
 17449     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17450                                    AT-PAYMENT-LAST-UPDATED-BY
 17451     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17452     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17453     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17454     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17455     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17456     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17457     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17458     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17459     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17460     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17461     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17462     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17463     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17464     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17465     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17466     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17467                                    AT-TO-BE-WRITTEN-DT
 17468     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17469                                    AT-CHECK-QUE-SEQUENCE
 17470                                    AT-ADDL-RESERVE
 17471     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17472                                    AT-VOID-SELECT-DT
 17473                                    AT-VOID-ACCEPT-DT
 17474                                    AT-VOID-DT
 17475                                    AT-PMT-PROOF-DT
 17476                                    AT-INT-PMT-SELECT-DT
 17477     MOVE ZEROS                  TO AT-DAILY-RATE
 17478                                    AT-ELIMINATION-DAYS
 17479     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17480*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 336
* EL156.cbl
 17481*        DUPREC    (7120-DUPREC)
 17482*    END-EXEC
 17483     .
 17484 7115-WRITE-INT-TRLR.
 17485
 17486* EXEC CICS WRITE
 17487*         DATASET       ('ELTRLR')
 17488*         FROM          (ACTIVITY-TRAILERS)
 17489*         RIDFLD        (AT-CONTROL-PRIMARY)
 17490*         RESP          (WS-RESPONSE)
 17491*     END-EXEC
 17492     MOVE LENGTH OF
 17493      ACTIVITY-TRAILERS
 17494       TO DFHEIV11
 17495     MOVE 'ELTRLR' TO DFHEIV1
 17496*    MOVE '&$ L                  ''  N#00015966' TO DFHEIV0
 17497     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17499     MOVE X'204E233030303135393636' TO DFHEIV0(25:11)
 17500     CALL 'kxdfhei1' USING DFHEIV0,
 17501           DFHEIV1,
 17502           ACTIVITY-TRAILERS,
 17503           DFHEIV11,
 17504           AT-CONTROL-PRIMARY,
 17505           DFHEIV99,
 17506           DFHEIV99
 17507     MOVE EIBRESP  TO WS-RESPONSE
 17508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17509      IF WS-RESP-DUPREC
 17510         GO TO 7120-DUPREC
 17511      END-IF
 17512     GO TO 7130-EXIT
 17513     .
 17514 7120-DUPREC.
 17515     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17516     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17517     GO TO 7115-WRITE-INT-TRLR
 17518     .
 17519 7130-EXIT.
 17520      EXIT.
 17521 7140-BUILD-NOTE-TRLR.
 17522
 17523
 17524* EXEC CICS GETMAIN
 17525*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17526*         LENGTH    (200)
 17527*         INITIMG   (GETMAIN-SPACE)
 17528*     END-EXEC
 17529     MOVE 200
 17530       TO DFHEIV11
 17531*    MOVE ',"IL                  $   #00015986' TO DFHEIV0
 17532     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17533     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17534     MOVE X'2020233030303135393836' TO DFHEIV0(25:11)
 17535     CALL 'kxdfhei1' USING DFHEIV0,
 17536           DFHEIV20,
 17537           DFHEIV11,
 17538           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 337
* EL156.cbl
 17539     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17540         DFHEIV20
 17541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17542     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17543     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17544     MOVE 'AT'                   TO AT-RECORD-ID
 17545     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17546     MOVE '6'                    TO AT-TRAILER-TYPE
 17547     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17548                                    AT-GEN-INFO-LAST-MAINT-DT
 17549     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17550                                    AT-GEN-INFO-LAST-UPDATED-BY
 17551     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17552     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17553     .
 17554 7150-WRITE.
 17555
 17556* EXEC CICS HANDLE CONDITION
 17557*        DUPREC    (7160-DUPREC)
 17558*    END-EXEC
 17559*    MOVE '"$%                   ! : #00016004' TO DFHEIV0
 17560     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17562     MOVE X'3A20233030303136303034' TO DFHEIV0(25:11)
 17563     CALL 'kxdfhei1' USING DFHEIV0
 17564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17565
 17566* EXEC CICS WRITE
 17567*         DATASET     ('ELTRLR')
 17568*         FROM        (ACTIVITY-TRAILERS)
 17569*         RIDFLD      (AT-CONTROL-PRIMARY)
 17570*         RESP        (WS-RESPONSE)
 17571*     END-EXEC
 17572     MOVE LENGTH OF
 17573      ACTIVITY-TRAILERS
 17574       TO DFHEIV11
 17575     MOVE 'ELTRLR' TO DFHEIV1
 17576*    MOVE '&$ L                  ''  N#00016007' TO DFHEIV0
 17577     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17578     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17579     MOVE X'204E233030303136303037' TO DFHEIV0(25:11)
 17580     CALL 'kxdfhei1' USING DFHEIV0,
 17581           DFHEIV1,
 17582           ACTIVITY-TRAILERS,
 17583           DFHEIV11,
 17584           AT-CONTROL-PRIMARY,
 17585           DFHEIV99,
 17586           DFHEIV99
 17587     MOVE EIBRESP  TO WS-RESPONSE
 17588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17589      IF WS-RESP-DUPREC
 17590         GO TO 7160-DUPREC
 17591      END-IF
 17592     GO TO 7170-EXIT
 17593     .
 17594 7160-DUPREC.
 17595     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17596     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 338
* EL156.cbl
 17597     GO TO 7150-WRITE
 17598     .
 17599 7170-EXIT.
 17600      EXIT.
 17601
 17602 7180-ADD-CERT-NOTE.
 17603*ADD CERT NOTE FOR SC NP+6
 17604
 17605
 17606* EXEC CICS GETMAIN
 17607*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17608*         LENGTH    (150)
 17609*         INITIMG   (GETMAIN-SPACE)
 17610*     END-EXEC.
 17611     MOVE 150
 17612       TO DFHEIV11
 17613*    MOVE ',"IL                  $   #00016029' TO DFHEIV0
 17614     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17615     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17616     MOVE X'2020233030303136303239' TO DFHEIV0(25:11)
 17617     CALL 'kxdfhei1' USING DFHEIV0,
 17618           DFHEIV20,
 17619           DFHEIV11,
 17620           GETMAIN-SPACE
 17621     SET ADDRESS OF CERT-NOTE-FILE TO
 17622         DFHEIV20
 17623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17624
 17625
 17626     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17627     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17628     MOVE +1                     TO WRK-NOTE-SEQ.
 17629     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17630     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17631     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17632     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17633     MOVE CL-CERT-STATE          TO CZ-STATE.
 17634     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17635     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17636     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17637     MOVE '2'                    TO CZ-RECORD-TYPE.
 17638     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17639     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17640     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17641     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17642     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17643     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17644     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17645     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17646     IF PI-COMPANY-ID = 'AHL'
 17647        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17648           CONTINUE
 17649        ELSE
 17650           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17651              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17652           ELSE
 17653              MOVE ' + 2 MO '    TO SC-NP6-COMM
 17654           END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 339
* EL156.cbl
 17655        END-IF
 17656     END-IF
 17657     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 17658     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 17659
 17660 7181-WRITE.
 17661
 17662
 17663* EXEC CICS WRITE
 17664*         DATASET     ('ERCNOT')
 17665*         FROM        (CERT-NOTE-FILE)
 17666*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17667*         RESP        (WS-RESPONSE)
 17668*    END-EXEC.
 17669     MOVE LENGTH OF
 17670      CERT-NOTE-FILE
 17671       TO DFHEIV11
 17672     MOVE 'ERCNOT' TO DFHEIV1
 17673*    MOVE '&$ L                  ''  N#00016071' TO DFHEIV0
 17674     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17675     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17676     MOVE X'204E233030303136303731' TO DFHEIV0(25:11)
 17677     CALL 'kxdfhei1' USING DFHEIV0,
 17678           DFHEIV1,
 17679           CERT-NOTE-FILE,
 17680           DFHEIV11,
 17681           CZ-CONTROL-PRIMARY,
 17682           DFHEIV99,
 17683           DFHEIV99
 17684     MOVE EIBRESP  TO WS-RESPONSE
 17685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17686
 17687
 17688     IF WS-RESP-DUPREC
 17689         GO TO 7182-DUPREC
 17690     END-IF.
 17691
 17692     SET CERT-NOTE-ADDED TO TRUE.
 17693
 17694     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 17695         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 17696     END-IF.
 17697
 17698     GO TO 7189-EXIT.
 17699
 17700 7182-DUPREC.
 17701
 17702     ADD +1                      TO  WRK-NOTE-SEQ.
 17703     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17704     GO TO 7181-WRITE.
 17705
 17706 7189-EXIT.
 17707      EXIT.
 17708
 17709 7190-ADD-ORIG-NOTE.
 17710
 17711
 17712* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 340
* EL156.cbl
 17713*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17714*         LENGTH    (150)
 17715*         INITIMG   (GETMAIN-SPACE)
 17716*     END-EXEC.
 17717     MOVE 150
 17718       TO DFHEIV11
 17719*    MOVE ',"IL                  $   #00016101' TO DFHEIV0
 17720     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17722     MOVE X'2020233030303136313031' TO DFHEIV0(25:11)
 17723     CALL 'kxdfhei1' USING DFHEIV0,
 17724           DFHEIV20,
 17725           DFHEIV11,
 17726           GETMAIN-SPACE
 17727     SET ADDRESS OF CERT-NOTE-FILE TO
 17728         DFHEIV20
 17729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17730
 17731
 17732     ADD +1                      TO WRK-NOTE-SEQ.
 17733     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17734     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17735     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17736     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17737     MOVE CL-CERT-STATE          TO CZ-STATE.
 17738     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17739     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17740     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17741     MOVE '2'                    TO CZ-RECORD-TYPE.
 17742     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17743     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17744     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17745     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17746     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17747     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 17748
 17749 7191-WRITE.
 17750
 17751
 17752* EXEC CICS WRITE
 17753*         DATASET     ('ERCNOT')
 17754*         FROM        (CERT-NOTE-FILE)
 17755*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17756*         RESP        (WS-RESPONSE)
 17757*    END-EXEC.
 17758     MOVE LENGTH OF
 17759      CERT-NOTE-FILE
 17760       TO DFHEIV11
 17761     MOVE 'ERCNOT' TO DFHEIV1
 17762*    MOVE '&$ L                  ''  N#00016126' TO DFHEIV0
 17763     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17764     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17765     MOVE X'204E233030303136313236' TO DFHEIV0(25:11)
 17766     CALL 'kxdfhei1' USING DFHEIV0,
 17767           DFHEIV1,
 17768           CERT-NOTE-FILE,
 17769           DFHEIV11,
 17770           CZ-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 341
* EL156.cbl
 17771           DFHEIV99,
 17772           DFHEIV99
 17773     MOVE EIBRESP  TO WS-RESPONSE
 17774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17775
 17776
 17777     IF WS-RESP-DUPREC
 17778         GO TO 7192-DUPREC
 17779     END-IF.
 17780
 17781     GO TO 7199-EXIT.
 17782
 17783 7192-DUPREC.
 17784
 17785     ADD +1                      TO  WRK-NOTE-SEQ.
 17786     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17787     GO TO 7191-WRITE.
 17788
 17789 7199-EXIT.
 17790      EXIT.
 17791 7200-FIND-BENEFIT.
 17792     MOVE 'N' TO WS-BEN-SEARCH-SW.
 17793
 17794
 17795* EXEC CICS HANDLE CONDITION
 17796*        ENDFILE(7200-EXIT)
 17797*        NOTFND(7200-EXIT)
 17798*    END-EXEC.
 17799*    MOVE '"$''I                  ! ; #00016150' TO DFHEIV0
 17800     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17802     MOVE X'3B20233030303136313530' TO DFHEIV0(25:11)
 17803     CALL 'kxdfhei1' USING DFHEIV0
 17804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17805
 17806
 17807
 17808* EXEC CICS READ
 17809*        DATASET('ELCNTL')
 17810*        SET(ADDRESS OF CONTROL-FILE)
 17811*        RIDFLD(ELCNTL-KEY)
 17812*        GTEQ
 17813*    END-EXEC.
 17814     MOVE 'ELCNTL' TO DFHEIV1
 17815*    MOVE '&"S        G          (   #00016155' TO DFHEIV0
 17816     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17817     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17818     MOVE X'2020233030303136313535' TO DFHEIV0(25:11)
 17819     CALL 'kxdfhei1' USING DFHEIV0,
 17820           DFHEIV1,
 17821           DFHEIV20,
 17822           DFHEIV99,
 17823           ELCNTL-KEY,
 17824           DFHEIV99,
 17825           DFHEIV99,
 17826           DFHEIV99
 17827     SET ADDRESS OF CONTROL-FILE TO
 17828         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 342
* EL156.cbl
 17829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17830
 17831
 17832     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 17833        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 17834           GO TO 7200-EXIT.
 17835
 17836     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 17837         VARYING SUB-1 FROM 1 BY 1 UNTIL
 17838            ((SUB-1 > 8) OR
 17839            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 17840
 17841     IF SUB-1 NOT = 9
 17842         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 17843
 17844     GO TO 7200-EXIT.
 17845
 17846 7200-BENEFIT-DUMMY.
 17847
 17848 7200-DUMMY-EXIT.
 17849     EXIT.
 17850
 17851 7200-EXIT.
 17852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 343
* EL156.cbl
 17854*052506
 17855*052506 7250-FIND-LETTER-TRLR.
 17856*052506     EXEC CICS HANDLE CONDITION
 17857*052506         ENDFILE  (7250-END)
 17858*052506         NOTFND   (7250-END)
 17859*052506     END-EXEC.
 17860*052506
 17861*052506     EXEC CICS STARTBR
 17862*052506         DATASET   ('ELTRLR')
 17863*052506         RIDFLD    (ELTRLR-KEY)
 17864*052506         GTEQ
 17865*052506     END-EXEC.
 17866*052506
 17867*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 17868*052506
 17869*052506 7250-FIND-LOOP.
 17870*052506     EXEC CICS READNEXT
 17871*052506         DATASET   ('ELTRLR')
 17872*052506         RIDFLD    (ELTRLR-KEY)
 17873*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17874*052506     END-EXEC.
 17875*052506
 17876*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17877*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17878*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17879*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 17880*052506        GO TO 7250-END
 17881*052506     END-IF.
 17882*052506
 17883*052506     IF AT-TRAILER-TYPE NOT = '4'
 17884*052506         GO TO 7250-FIND-LOOP
 17885*052506     END-IF.
 17886*052506
 17887*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 17888*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 17889*052506     END-IF.
 17890*052506
 17891*052506     GO TO 7250-FIND-LOOP.
 17892*052506
 17893*052506 7250-END.
 17894*052506
 17895*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 17896*051506         MOVE SPACES             TO  DC-OPTION-CODE
 17897*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 17898*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17899*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 17900*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 17901*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 17902*052506     END-IF.
 17903*052506
 17904*052506     EXEC CICS ENDBR
 17905*052506          DATASET    ('ELTRLR')
 17906*052506     END-EXEC.
 17907*052506
 17908*052506 7250-EXIT.
 17909*052506     EXIT.
 17910*052506     EJECT
 17911*052506
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 344
* EL156.cbl
 17912 7300-CHECK-AUTO-ACTIVITY.
 17913
 17914     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 17915         NEXT SENTENCE
 17916     ELSE
 17917         GO TO 7399-EXIT.
 17918
 17919     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 17920
 17921     IF WS-ACT-REC-FOUND-SW = 'N'
 17922         GO TO 7399-EXIT.
 17923
 17924     IF PI-ACTIVITY-CODE = 09
 17925         GO TO 7300-CONT-AUTO-ACTIVITY.
 17926
 17927     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 17928        (PI-ACTIVITY-CODE = 11)
 17929         GO TO 7300-CONT-AUTO-ACTIVITY.
 17930
 17931     IF PI-PROVISIONAL-IND = 'P'
 17932         IF PI-PMTTYPE = '1'
 17933             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 17934                 MOVE 'N'    TO  PI-RESET-SW
 17935                 GO TO 7399-EXIT.
 17936
 17937     IF PI-PMTTYPE = '1'
 17938         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 17939             MOVE 'N'        TO  PI-RESET-SW
 17940             GO TO 7399-EXIT.
 17941
 17942     IF PI-PMTTYPE = '2' OR '3'
 17943         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 17944             MOVE 'N'        TO  PI-RESET-SW
 17945             GO TO 7399-EXIT.
 17946
 17947     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17948         IF PI-PROVISIONAL-IND = 'P'
 17949             NEXT SENTENCE
 17950         ELSE
 17951             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 17952
 17953 7300-CONT-AUTO-ACTIVITY.
 17954
 17955     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 17956         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 17957         MOVE '4'            TO DC-OPTION-CODE
 17958         MOVE +0             TO DC-ELAPSED-DAYS
 17959                                DC-ELAPSED-MONTHS
 17960         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17961         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 17962         IF PI-USES-PAID-TO
 17963             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17964             IF NO-CONVERSION-ERROR
 17965                 MOVE +1     TO DC-ELAPSED-DAYS
 17966                 MOVE +0     TO DC-ELAPSED-MONTHS
 17967                 MOVE '6'    TO DC-OPTION-CODE
 17968                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17969                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 345
* EL156.cbl
 17970                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 17971
 17972     IF PI-PFKEY-USED = DFHPF5
 17973         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 17974         IF PI-USES-PAID-TO
 17975             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 17976             MOVE +1                  TO DC-ELAPSED-DAYS
 17977             MOVE +0                  TO DC-ELAPSED-MONTHS
 17978             MOVE '6'                 TO DC-OPTION-CODE
 17979             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17980             IF NO-CONVERSION-ERROR
 17981                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 17982
 17983     IF WS-CHK-THRU-DT < PI-EXP-DT
 17984         NEXT SENTENCE
 17985     ELSE
 17986         MOVE 03                     TO  WS-ACTIVITY-CODE
 17987         GO TO 7390-PROCESS-ACTIVITY.
 17988
 17989     IF PI-PROV-PMT
 17990         MOVE 09                     TO  WS-ACTIVITY-CODE
 17991     ELSE
 17992        IF PI-PMTTYPE = '1'
 17993            MOVE 02                  TO  WS-ACTIVITY-CODE
 17994        ELSE
 17995        IF PI-PMTTYPE = '2' OR '3'
 17996            MOVE 07                  TO  WS-ACTIVITY-CODE
 17997        ELSE
 17998        IF PI-PMTTYPE = '4'
 17999            MOVE 00                  TO  WS-ACTIVITY-CODE
 18000        ELSE
 18001            MOVE 'N'                 TO  PI-RESET-SW
 18002            GO TO 7399-EXIT.
 18003
 18004 7390-PROCESS-ACTIVITY.
 18005
 18006     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 18007
 18008 7399-EXIT.
 18009     EXIT.
 18010
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 346
* EL156.cbl
 18012 7400-CHECK-AUTO-ACTIVITY.
 18013
 18014
 18015* EXEC CICS HANDLE CONDITION
 18016*        NOTFND   (7400-NOT-FOUND)
 18017*    END-EXEC.
 18018*    MOVE '"$I                   ! < #00016344' TO DFHEIV0
 18019     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18021     MOVE X'3C20233030303136333434' TO DFHEIV0(25:11)
 18022     CALL 'kxdfhei1' USING DFHEIV0
 18023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18024
 18025
 18026     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18027     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18028     MOVE SPACES                 TO  CNTL-ACCESS.
 18029     MOVE +0                     TO  CNTL-SEQ-NO.
 18030
 18031
 18032* EXEC CICS READ
 18033*        DATASET   ('ELCNTL')
 18034*        RIDFLD    (ELCNTL-KEY)
 18035*        SET       (ADDRESS OF CONTROL-FILE)
 18036*    END-EXEC.
 18037     MOVE 'ELCNTL' TO DFHEIV1
 18038*    MOVE '&"S        E          (   #00016353' TO DFHEIV0
 18039     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18041     MOVE X'2020233030303136333533' TO DFHEIV0(25:11)
 18042     CALL 'kxdfhei1' USING DFHEIV0,
 18043           DFHEIV1,
 18044           DFHEIV20,
 18045           DFHEIV99,
 18046           ELCNTL-KEY,
 18047           DFHEIV99,
 18048           DFHEIV99,
 18049           DFHEIV99
 18050     SET ADDRESS OF CONTROL-FILE TO
 18051         DFHEIV20
 18052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18053
 18054
 18055     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18056     GO TO 7400-EXIT.
 18057
 18058 7400-NOT-FOUND.
 18059     MOVE 'N'                        TO  PI-RESET-SW
 18060                                         WS-LETTER-SW
 18061                                         WS-ACT-REC-FOUND-SW.
 18062
 18063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18064
 18065 7400-EXIT.
 18066     EXIT.
 18067
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 347
* EL156.cbl
 18069 7450-FORMAT-AUTO-LETTER.
 18070
 18071     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18072         MOVE 'Y'                    TO PI-RESET-SW
 18073         GO TO 7450-CONTINUE-PROCESS.
 18074
 18075     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18076
 18077     IF SUB > 9
 18078         SUBTRACT 9 FROM SUB
 18079         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18080     ELSE
 18081         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18082
 18083 7450-CONTINUE-PROCESS.
 18084
 18085     IF WS-ACTIVITY-CODE = ZEROS
 18086         MOVE 'N'                    TO  WS-LETTER-SW
 18087         GO TO 7499-EXIT.
 18088
 18089     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18090
 18091     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18092         MOVE 'N'                    TO  PI-RESET-SW
 18093                                         WS-LETTER-SW
 18094         GO TO 7499-EXIT.
 18095
 18096     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18097         MOVE 'N'                    TO  WS-LETTER-SW
 18098         GO TO 7499-EXIT.
 18099
 18100     MOVE 'Y'                        TO  WS-LETTER-SW.
 18101     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18102     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18103
 18104     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18105
 18106     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18107         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18108         MOVE '6'                    TO  DC-OPTION-CODE
 18109         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18110         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18111         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18112         IF NO-CONVERSION-ERROR
 18113             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18114         ELSE
 18115              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18116
 18117     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18118         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18119         MOVE '6'                    TO  DC-OPTION-CODE
 18120         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18121         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18122         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18123         IF NO-CONVERSION-ERROR
 18124             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18125         ELSE
 18126             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 348
* EL156.cbl
 18127
 18128 7499-EXIT.
 18129     EXIT.
 18130
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 349
* EL156.cbl
 18132 7500-RESET-AUTO-ACTIVITY.
 18133
 18134     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18135     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18136     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18137     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18138     MOVE +100                   TO  TRLR-SEQ-NO.
 18139
 18140 7500-STARTBR-TRLR.
 18141
 18142
 18143* EXEC CICS HANDLE CONDITION
 18144*        ENDFILE  (7590-END)
 18145*        NOTFND   (7590-END)
 18146*    END-EXEC.
 18147*    MOVE '"$''I                  ! = #00016446' TO DFHEIV0
 18148     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18150     MOVE X'3D20233030303136343436' TO DFHEIV0(25:11)
 18151     CALL 'kxdfhei1' USING DFHEIV0
 18152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18153
 18154
 18155
 18156* EXEC CICS STARTBR
 18157*        DATASET   ('ELTRLR')
 18158*        RIDFLD    (ELTRLR-KEY)
 18159*        GTEQ
 18160*    END-EXEC.
 18161     MOVE 'ELTRLR' TO DFHEIV1
 18162     MOVE 0
 18163       TO DFHEIV11
 18164*    MOVE '&,         G          &   #00016451' TO DFHEIV0
 18165     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18166     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18167     MOVE X'2020233030303136343531' TO DFHEIV0(25:11)
 18168     CALL 'kxdfhei1' USING DFHEIV0,
 18169           DFHEIV1,
 18170           ELTRLR-KEY,
 18171           DFHEIV99,
 18172           DFHEIV11,
 18173           DFHEIV99
 18174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18175
 18176
 18177     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18178
 18179 7500-READ-NEXT.
 18180
 18181
 18182* EXEC CICS READNEXT
 18183*        DATASET   ('ELTRLR')
 18184*        RIDFLD    (ELTRLR-KEY)
 18185*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18186*    END-EXEC.
 18187     MOVE 'ELTRLR' TO DFHEIV1
 18188     MOVE 0
 18189       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 350
* EL156.cbl
 18190*    MOVE '&.S                   )   #00016461' TO DFHEIV0
 18191     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18192     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18193     MOVE X'2020233030303136343631' TO DFHEIV0(25:11)
 18194     CALL 'kxdfhei1' USING DFHEIV0,
 18195           DFHEIV1,
 18196           DFHEIV20,
 18197           DFHEIV99,
 18198           ELTRLR-KEY,
 18199           DFHEIV99,
 18200           DFHEIV11,
 18201           DFHEIV99,
 18202           DFHEIV99
 18203     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18204         DFHEIV20
 18205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18206
 18207
 18208     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18209        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18210        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18211        PI-CERT-NO    NOT = TRLR-CERT-NO
 18212         GO TO 7590-END.
 18213
 18214     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18215         GO TO 7500-READ-NEXT.
 18216
 18217     IF AT-TRAILER-TYPE NOT = '4'
 18218         GO TO 7500-READ-NEXT.
 18219
 18220     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18221         GO TO 7500-READ-NEXT.
 18222
 18223     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18224        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18225         GO TO 7500-READ-NEXT.
 18226
 18227     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18228        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18229        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18230         GO TO 7500-READ-NEXT.
 18231
 18232     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18233                         AND
 18234        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18235                         AND
 18236        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18237            GO TO 7500-READ-NEXT.
 18238
 18239     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18240
 18241
 18242* EXEC CICS ENDBR
 18243*        DATASET   ('ELTRLR')
 18244*    END-EXEC.
 18245     MOVE 'ELTRLR' TO DFHEIV1
 18246     MOVE 0
 18247       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 351
* EL156.cbl
 18248*    MOVE '&2                    $   #00016500' TO DFHEIV0
 18249     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18250     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18251     MOVE X'2020233030303136353030' TO DFHEIV0(25:11)
 18252     CALL 'kxdfhei1' USING DFHEIV0,
 18253           DFHEIV1,
 18254           DFHEIV11,
 18255           DFHEIV99
 18256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18257
 18258
 18259     MOVE 'N'                        TO  WS-BROWSE-SW.
 18260
 18261
 18262* EXEC CICS READ
 18263*        DATASET   ('ELTRLR')
 18264*        RIDFLD    (ELTRLR-KEY)
 18265*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18266*        UPDATE
 18267*    END-EXEC.
 18268     MOVE 'ELTRLR' TO DFHEIV1
 18269*    MOVE '&"S        EU         (   #00016506' TO DFHEIV0
 18270     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18271     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18272     MOVE X'2020233030303136353036' TO DFHEIV0(25:11)
 18273     CALL 'kxdfhei1' USING DFHEIV0,
 18274           DFHEIV1,
 18275           DFHEIV20,
 18276           DFHEIV99,
 18277           ELTRLR-KEY,
 18278           DFHEIV99,
 18279           DFHEIV99,
 18280           DFHEIV99
 18281     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18282         DFHEIV20
 18283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18284
 18285
 18286     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18287
 18288     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18289         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18290     ELSE
 18291         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18292             NEXT SENTENCE
 18293         ELSE
 18294             GO TO 7500-REWRITE-TRLR.
 18295
 18296     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18297
 18298     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18299     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18300     MOVE '1'                        TO  ARCH-REC-TYPE.
 18301     MOVE +0                         TO  ARCH-SEQ.
 18302
 18303     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18304
 18305 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 352
* EL156.cbl
 18306
 18307
 18308* EXEC CICS REWRITE
 18309*        DATASET   ('ELTRLR')
 18310*        FROM      (ACTIVITY-TRAILERS)
 18311*    END-EXEC.
 18312     MOVE LENGTH OF
 18313      ACTIVITY-TRAILERS
 18314       TO DFHEIV11
 18315     MOVE 'ELTRLR' TO DFHEIV1
 18316*    MOVE '&& L                  %   #00016534' TO DFHEIV0
 18317     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18318     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18319     MOVE X'2020233030303136353334' TO DFHEIV0(25:11)
 18320     CALL 'kxdfhei1' USING DFHEIV0,
 18321           DFHEIV1,
 18322           ACTIVITY-TRAILERS,
 18323           DFHEIV11,
 18324           DFHEIV99
 18325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18326
 18327
 18328     GO TO 7500-STARTBR-TRLR.
 18329
 18330 7590-END.
 18331
 18332     IF WS-BROWSE-SW = 'Y'
 18333         MOVE 'N'                    TO  WS-BROWSE-SW
 18334
 18335* EXEC CICS ENDBR
 18336*            DATASET   ('ELTRLR')
 18337*        END-EXEC.
 18338     MOVE 'ELTRLR' TO DFHEIV1
 18339     MOVE 0
 18340       TO DFHEIV11
 18341*    MOVE '&2                    $   #00016545' TO DFHEIV0
 18342     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18344     MOVE X'2020233030303136353435' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0,
 18346           DFHEIV1,
 18347           DFHEIV11,
 18348           DFHEIV99
 18349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18350
 18351
 18352 7599-EXIT.
 18353     EXIT.
 18354
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 353
* EL156.cbl
 18356 7600-READ-ARCH-UPDATE.
 18357
 18358
 18359* EXEC CICS HANDLE CONDITION
 18360*        NOTFND   (7699-EXIT)
 18361*    END-EXEC.
 18362*    MOVE '"$I                   ! > #00016555' TO DFHEIV0
 18363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18365     MOVE X'3E20233030303136353535' TO DFHEIV0(25:11)
 18366     CALL 'kxdfhei1' USING DFHEIV0
 18367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18368
 18369
 18370
 18371* EXEC CICS READ
 18372*        DATASET   ('ELARCH')
 18373*        RIDFLD    (ELARCH-KEY)
 18374*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18375*        UPDATE
 18376*    END-EXEC.
 18377     MOVE 'ELARCH' TO DFHEIV1
 18378*    MOVE '&"S        EU         (   #00016559' TO DFHEIV0
 18379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18380     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18381     MOVE X'2020233030303136353539' TO DFHEIV0(25:11)
 18382     CALL 'kxdfhei1' USING DFHEIV0,
 18383           DFHEIV1,
 18384           DFHEIV20,
 18385           DFHEIV99,
 18386           ELARCH-KEY,
 18387           DFHEIV99,
 18388           DFHEIV99,
 18389           DFHEIV99
 18390     SET ADDRESS OF LETTER-ARCHIVE TO
 18391         DFHEIV20
 18392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18393
 18394
 18395     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18396
 18397
 18398* EXEC CICS REWRITE
 18399*        DATASET   ('ELARCH')
 18400*        FROM      (LETTER-ARCHIVE)
 18401*    END-EXEC.
 18402     MOVE LENGTH OF
 18403      LETTER-ARCHIVE
 18404       TO DFHEIV11
 18405     MOVE 'ELARCH' TO DFHEIV1
 18406*    MOVE '&& L                  %   #00016568' TO DFHEIV0
 18407     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18408     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18409     MOVE X'2020233030303136353638' TO DFHEIV0(25:11)
 18410     CALL 'kxdfhei1' USING DFHEIV0,
 18411           DFHEIV1,
 18412           LETTER-ARCHIVE,
 18413           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 354
* EL156.cbl
 18414           DFHEIV99
 18415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18416
 18417
 18418 7699-EXIT.
 18419     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 355
* EL156.cbl
 18421 7700-GET-DCT.
 18422
 18423     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18424     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18425     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18426     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18427                                    PI-MAX-BENEFIT-AMT
 18428                                    PI-MAX-BENEFIT-PYMT
 18429                                    PI-MIN-PAYMENT-AMT
 18430                                    PI-TIME-OF-LOSS-BAL.
 18431
 18432
 18433* EXEC CICS HANDLE CONDITION
 18434*         NOTFND (5300-NOTE-NOT-FOUND)
 18435*     END-EXEC.
 18436*    MOVE '"$I                   ! ? #00016587' TO DFHEIV0
 18437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18439     MOVE X'3F20233030303136353837' TO DFHEIV0(25:11)
 18440     CALL 'kxdfhei1' USING DFHEIV0
 18441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18442
 18443
 18444
 18445* EXEC CICS READ
 18446*         DATASET('ERNOTE')
 18447*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18448*         RIDFLD (W-NOTE-KEY)
 18449*     END-EXEC.
 18450     MOVE 'ERNOTE' TO DFHEIV1
 18451*    MOVE '&"S        E          (   #00016591' TO DFHEIV0
 18452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18454     MOVE X'2020233030303136353931' TO DFHEIV0(25:11)
 18455     CALL 'kxdfhei1' USING DFHEIV0,
 18456           DFHEIV1,
 18457           DFHEIV20,
 18458           DFHEIV99,
 18459           W-NOTE-KEY,
 18460           DFHEIV99,
 18461           DFHEIV99,
 18462           DFHEIV99
 18463     SET ADDRESS OF CERTIFICATE-NOTE TO
 18464         DFHEIV20
 18465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18466
 18467
 18468     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18469     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18470     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18471     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18472     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18473
 18474     IF PI-PAYEE-TYPE NOT = 'B'
 18475         GO TO 7700-EXIT.
 18476
 18477     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18478     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 356
* EL156.cbl
 18479     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18480
 18481     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18482         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18483     ELSE
 18484         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18485
 18486     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18487     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18488     MOVE 'DLO006'               TO PGM-NAME.
 18489
 18490
 18491* EXEC CICS LINK
 18492*        PROGRAM    (PGM-NAME)
 18493*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18494*        LENGTH     (DCT-RCRD-LENGTH)
 18495*    END-EXEC.
 18496*    MOVE '."C                   (   #00016619' TO DFHEIV0
 18497     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18499     MOVE X'2020233030303136363139' TO DFHEIV0(25:11)
 18500     CALL 'kxdfhei1' USING DFHEIV0,
 18501           PGM-NAME,
 18502           DCT-COMMUNICATION-AREA,
 18503           DCT-RCRD-LENGTH,
 18504           DFHEIV99,
 18505           DFHEIV99,
 18506           DFHEIV99,
 18507           DFHEIV99
 18508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18509
 18510
 18511     IF DCT-RETURN-CODE = 'OK'
 18512         GO TO 7700-CONT.
 18513
 18514     IF DCT-RETURN-CODE = '01' OR '02'
 18515         GO TO 7700-SET-TO-YES.
 18516
 18517     IF DCT-RETURN-CODE = '03'
 18518
 18519* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18520*    MOVE '6"R                   !   #00016632' TO DFHEIV0
 18521     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18523     MOVE X'2020233030303136363332' TO DFHEIV0(25:11)
 18524     CALL 'kxdfhei1' USING DFHEIV0
 18525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18526         MOVE ER-0951            TO EMI-ERROR
 18527         MOVE -1                 TO PMTTYPEL
 18528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18529         GO TO 8200-SEND-DATAONLY.
 18530
 18531     IF DCT-RETURN-CODE = '04'
 18532
 18533* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18534*    MOVE '6"R                   !   #00016639' TO DFHEIV0
 18535     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 357
* EL156.cbl
 18537     MOVE X'2020233030303136363339' TO DFHEIV0(25:11)
 18538     CALL 'kxdfhei1' USING DFHEIV0
 18539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18540         MOVE ER-0946            TO EMI-ERROR
 18541         MOVE -1                 TO PMTTYPEL
 18542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18543         GO TO 8200-SEND-DATAONLY.
 18544
 18545     IF DCT-RETURN-CODE = '05'
 18546
 18547* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18548*    MOVE '6"R                   !   #00016646' TO DFHEIV0
 18549     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18551     MOVE X'2020233030303136363436' TO DFHEIV0(25:11)
 18552     CALL 'kxdfhei1' USING DFHEIV0
 18553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18554         MOVE ER-0947            TO EMI-ERROR
 18555         MOVE -1                 TO PMTTYPEL
 18556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18557         GO TO 8200-SEND-DATAONLY.
 18558
 18559     IF DCT-RETURN-CODE = '06'
 18560
 18561* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18562*    MOVE '6"R                   !   #00016653' TO DFHEIV0
 18563     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18565     MOVE X'2020233030303136363533' TO DFHEIV0(25:11)
 18566     CALL 'kxdfhei1' USING DFHEIV0
 18567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18568         MOVE ER-0921            TO EMI-ERROR
 18569         MOVE -1                 TO PMTTYPEL
 18570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18571         GO TO 8200-SEND-DATAONLY.
 18572
 18573     IF DCT-RETURN-CODE = '07'
 18574
 18575* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18576*    MOVE '6"R                   !   #00016660' TO DFHEIV0
 18577     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18579     MOVE X'2020233030303136363630' TO DFHEIV0(25:11)
 18580     CALL 'kxdfhei1' USING DFHEIV0
 18581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18582         MOVE ER-0919            TO EMI-ERROR
 18583         MOVE -1                 TO PMTTYPEL
 18584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18585         GO TO 8200-SEND-DATAONLY.
 18586
 18587     IF DCT-RETURN-CODE = '08'
 18588
 18589* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18590*    MOVE '6"R                   !   #00016667' TO DFHEIV0
 18591     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18593     MOVE X'2020233030303136363637' TO DFHEIV0(25:11)
 18594     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 358
* EL156.cbl
 18595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18596         MOVE ER-0948            TO EMI-ERROR
 18597         MOVE -1                 TO PMTTYPEL
 18598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18599         GO TO 8200-SEND-DATAONLY.
 18600
 18601     IF DCT-RETURN-CODE = 'N1'
 18602
 18603* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18604*    MOVE '6"R                   !   #00016674' TO DFHEIV0
 18605     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18607     MOVE X'2020233030303136363734' TO DFHEIV0(25:11)
 18608     CALL 'kxdfhei1' USING DFHEIV0
 18609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18610         MOVE ER-0950            TO EMI-ERROR
 18611         MOVE -1                 TO PMTTYPEL
 18612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18613         GO TO 8200-SEND-DATAONLY.
 18614
 18615     IF DCT-RETURN-CODE = 'E1'
 18616
 18617* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18618*    MOVE '6"R                   !   #00016681' TO DFHEIV0
 18619     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18621     MOVE X'2020233030303136363831' TO DFHEIV0(25:11)
 18622     CALL 'kxdfhei1' USING DFHEIV0
 18623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18624         MOVE ER-0974            TO EMI-ERROR
 18625         MOVE -1                 TO PMTTYPEL
 18626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18627         GO TO 8200-SEND-DATAONLY.
 18628
 18629     IF DCT-RETURN-CODE = 'E2'
 18630
 18631* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18632*    MOVE '6"R                   !   #00016688' TO DFHEIV0
 18633     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18635     MOVE X'2020233030303136363838' TO DFHEIV0(25:11)
 18636     CALL 'kxdfhei1' USING DFHEIV0
 18637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18638         MOVE ER-0975            TO EMI-ERROR
 18639         MOVE -1                 TO PMTTYPEL
 18640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18641         GO TO 8200-SEND-DATAONLY.
 18642
 18643     IF DCT-RETURN-CODE NOT = 'OK'
 18644
 18645* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18646*    MOVE '6"R                   !   #00016695' TO DFHEIV0
 18647     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18649     MOVE X'2020233030303136363935' TO DFHEIV0(25:11)
 18650     CALL 'kxdfhei1' USING DFHEIV0
 18651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18652         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 359
* EL156.cbl
 18653         MOVE -1                 TO PMTTYPEL
 18654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18655         GO TO 8200-SEND-DATAONLY.
 18656
 18657 7700-CONT.
 18658
 18659*    MOVE 'N'                    TO CASHO.
 18660*    MOVE +1                     TO CASHL.
 18661*    MOVE AL-UANON               TO CASHA.
 18662
 18663     IF PI-OFFLINE = 'Y'
 18664         GO TO 7700-EXIT.
 18665
 18666     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 18667     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 18668     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 18669     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 18670     MOVE +7                     TO CHECKNOL.
 18671     MOVE AL-UANON               TO CHECKNOA.
 18672     GO TO 7700-EXIT.
 18673
 18674 7700-SET-TO-YES.
 18675
 18676*    MOVE 'Y'                    TO CASHO.
 18677*    MOVE +1                     TO CASHL.
 18678*    MOVE AL-UANON               TO CASHA.
 18679
 18680 7700-EXIT.
 18681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 360
* EL156.cbl
 18683 7800-READ-COMP-MSTR.
 18684
 18685
 18686* EXEC CICS HANDLE CONDITION
 18687*        NOTFND   (7800-COMP-NOTFND)
 18688*    END-EXEC.
 18689*    MOVE '"$I                   ! @ #00016729' TO DFHEIV0
 18690     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18692     MOVE X'4020233030303136373239' TO DFHEIV0(25:11)
 18693     CALL 'kxdfhei1' USING DFHEIV0
 18694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18695
 18696
 18697
 18698* EXEC CICS READ
 18699*        DATASET   ('ERCOMP')
 18700*        RIDFLD    (ERCOMP-KEY)
 18701*        SET       (ADDRESS OF COMPENSATION-MASTER)
 18702*    END-EXEC.
 18703     MOVE 'ERCOMP' TO DFHEIV1
 18704*    MOVE '&"S        E          (   #00016733' TO DFHEIV0
 18705     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18706     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18707     MOVE X'2020233030303136373333' TO DFHEIV0(25:11)
 18708     CALL 'kxdfhei1' USING DFHEIV0,
 18709           DFHEIV1,
 18710           DFHEIV20,
 18711           DFHEIV99,
 18712           ERCOMP-KEY,
 18713           DFHEIV99,
 18714           DFHEIV99,
 18715           DFHEIV99
 18716     SET ADDRESS OF COMPENSATION-MASTER TO
 18717         DFHEIV20
 18718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18719
 18720
 18721     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 18722     GO TO 7800-COMP-EXIT.
 18723
 18724 7800-COMP-NOTFND.
 18725     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 18726
 18727 7800-COMP-EXIT.
 18728     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 361
* EL156.cbl
 18730 7900-READ-CLAIM.
 18731
 18732* EXEC CICS READ
 18733*        DATASET  ('ELMSTR')
 18734*        SET      (ADDRESS OF CLAIM-MASTER)
 18735*        RIDFLD   (ELMSTR-KEY)
 18736*    END-EXEC.
 18737     MOVE 'ELMSTR' TO DFHEIV1
 18738*    MOVE '&"S        E          (   #00016749' TO DFHEIV0
 18739     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18740     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18741     MOVE X'2020233030303136373439' TO DFHEIV0(25:11)
 18742     CALL 'kxdfhei1' USING DFHEIV0,
 18743           DFHEIV1,
 18744           DFHEIV20,
 18745           DFHEIV99,
 18746           ELMSTR-KEY,
 18747           DFHEIV99,
 18748           DFHEIV99,
 18749           DFHEIV99
 18750     SET ADDRESS OF CLAIM-MASTER TO
 18751         DFHEIV20
 18752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18753
 18754
 18755 7900-EXIT.
 18756      EXIT.
 18757
 18758 7910-READ-CLAIM-UPDATE.
 18759
 18760* EXEC CICS READ
 18761*        DATASET  ('ELMSTR')
 18762*        SET      (ADDRESS OF CLAIM-MASTER)
 18763*        RIDFLD   (ELMSTR-KEY)
 18764*        UPDATE
 18765*    END-EXEC.
 18766     MOVE 'ELMSTR' TO DFHEIV1
 18767*    MOVE '&"S        EU         (   #00016759' TO DFHEIV0
 18768     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18769     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18770     MOVE X'2020233030303136373539' TO DFHEIV0(25:11)
 18771     CALL 'kxdfhei1' USING DFHEIV0,
 18772           DFHEIV1,
 18773           DFHEIV20,
 18774           DFHEIV99,
 18775           ELMSTR-KEY,
 18776           DFHEIV99,
 18777           DFHEIV99,
 18778           DFHEIV99
 18779     SET ADDRESS OF CLAIM-MASTER TO
 18780         DFHEIV20
 18781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18782
 18783
 18784 7910-EXIT.
 18785      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 362
* EL156.cbl
 18787 7920-READ-BENE.
 18788     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 18789     MOVE 'B'                TO BENE-RECORD-TYPE.
 18790     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 18791
 18792     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18793        IF PI-PAYEE-TYPE    = 'B' AND
 18794           PI-PAYEE-SEQ-NUM = 9
 18795             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 18796             MOVE WS-A-BENE           TO BENE-NUMBER.
 18797
 18798
 18799* EXEC CICS HANDLE CONDITION
 18800*        NOTFND   (7920-NOT-FOUND)
 18801*    END-EXEC.
 18802*    MOVE '"$I                   ! A #00016780' TO DFHEIV0
 18803     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18805     MOVE X'4120233030303136373830' TO DFHEIV0(25:11)
 18806     CALL 'kxdfhei1' USING DFHEIV0
 18807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18808
 18809
 18810
 18811* EXEC CICS READ
 18812*        DATASET  ('ELBENE')
 18813*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 18814*        RIDFLD   (ELBENE-KEY)
 18815*    END-EXEC.
 18816     MOVE 'ELBENE' TO DFHEIV1
 18817*    MOVE '&"S        E          (   #00016784' TO DFHEIV0
 18818     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18820     MOVE X'2020233030303136373834' TO DFHEIV0(25:11)
 18821     CALL 'kxdfhei1' USING DFHEIV0,
 18822           DFHEIV1,
 18823           DFHEIV20,
 18824           DFHEIV99,
 18825           ELBENE-KEY,
 18826           DFHEIV99,
 18827           DFHEIV99,
 18828           DFHEIV99
 18829     SET ADDRESS OF BENEFICIARY-MASTER TO
 18830         DFHEIV20
 18831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18832
 18833
 18834     MOVE 'Y' TO BENE-FOUND-SW.
 18835     GO TO 7920-EXIT.
 18836
 18837 7920-NOT-FOUND.
 18838     MOVE 'N'                    TO BENE-FOUND-SW.
 18839
 18840 7920-EXIT.
 18841      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 363
* EL156.cbl
 18843 7930-READ-CONTROL.
 18844
 18845* EXEC CICS READ
 18846*        DATASET  ('ELCNTL')
 18847*        SET      (ADDRESS OF CONTROL-FILE)
 18848*        RIDFLD   (ELCNTL-KEY)
 18849*    END-EXEC.
 18850     MOVE 'ELCNTL' TO DFHEIV1
 18851*    MOVE '&"S        E          (   #00016800' TO DFHEIV0
 18852     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18854     MOVE X'2020233030303136383030' TO DFHEIV0(25:11)
 18855     CALL 'kxdfhei1' USING DFHEIV0,
 18856           DFHEIV1,
 18857           DFHEIV20,
 18858           DFHEIV99,
 18859           ELCNTL-KEY,
 18860           DFHEIV99,
 18861           DFHEIV99,
 18862           DFHEIV99
 18863     SET ADDRESS OF CONTROL-FILE TO
 18864         DFHEIV20
 18865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18866
 18867
 18868 7930-EXIT.
 18869      EXIT.
 18870
 18871 7940-READ-CONTROL-UPDATE.
 18872
 18873* EXEC CICS READ
 18874*        DATASET  ('ELCNTL')
 18875*        SET      (ADDRESS OF CONTROL-FILE)
 18876*        RIDFLD   (ELCNTL-KEY)
 18877*        UPDATE
 18878*    END-EXEC.
 18879     MOVE 'ELCNTL' TO DFHEIV1
 18880*    MOVE '&"S        EU         (   #00016810' TO DFHEIV0
 18881     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18882     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18883     MOVE X'2020233030303136383130' TO DFHEIV0(25:11)
 18884     CALL 'kxdfhei1' USING DFHEIV0,
 18885           DFHEIV1,
 18886           DFHEIV20,
 18887           DFHEIV99,
 18888           ELCNTL-KEY,
 18889           DFHEIV99,
 18890           DFHEIV99,
 18891           DFHEIV99
 18892     SET ADDRESS OF CONTROL-FILE TO
 18893         DFHEIV20
 18894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18895
 18896
 18897 7940-EXIT.
 18898      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 364
* EL156.cbl
 18900 7950-READ-TRAILER.
 18901
 18902* EXEC CICS READ
 18903*        DATASET  ('ELTRLR')
 18904*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18905*        RIDFLD   (ELTRLR-KEY)
 18906*    END-EXEC.
 18907     MOVE 'ELTRLR' TO DFHEIV1
 18908*    MOVE '&"S        E          (   #00016821' TO DFHEIV0
 18909     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18911     MOVE X'2020233030303136383231' TO DFHEIV0(25:11)
 18912     CALL 'kxdfhei1' USING DFHEIV0,
 18913           DFHEIV1,
 18914           DFHEIV20,
 18915           DFHEIV99,
 18916           ELTRLR-KEY,
 18917           DFHEIV99,
 18918           DFHEIV99,
 18919           DFHEIV99
 18920     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18921         DFHEIV20
 18922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18923
 18924
 18925 7950-EXIT.
 18926      EXIT.
 18927
 18928 7960-READ-TRAILER-UPDATE.
 18929
 18930* EXEC CICS READ
 18931*        DATASET  ('ELTRLR')
 18932*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18933*        RIDFLD   (ELTRLR-KEY)
 18934*        UPDATE
 18935*    END-EXEC.
 18936     MOVE 'ELTRLR' TO DFHEIV1
 18937*    MOVE '&"S        EU         (   #00016831' TO DFHEIV0
 18938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18939     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18940     MOVE X'2020233030303136383331' TO DFHEIV0(25:11)
 18941     CALL 'kxdfhei1' USING DFHEIV0,
 18942           DFHEIV1,
 18943           DFHEIV20,
 18944           DFHEIV99,
 18945           ELTRLR-KEY,
 18946           DFHEIV99,
 18947           DFHEIV99,
 18948           DFHEIV99
 18949     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18950         DFHEIV20
 18951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18952
 18953
 18954 7960-EXIT.
 18955      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 365
* EL156.cbl
 18957 7970-READ-CERT.
 18958
 18959* EXEC CICS READ
 18960*        DATASET  ('ELCERT')
 18961*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 18962*        RIDFLD   (ELCERT-KEY)
 18963*    END-EXEC.
 18964     MOVE 'ELCERT' TO DFHEIV1
 18965*    MOVE '&"S        E          (   #00016842' TO DFHEIV0
 18966     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18968     MOVE X'2020233030303136383432' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0,
 18970           DFHEIV1,
 18971           DFHEIV20,
 18972           DFHEIV99,
 18973           ELCERT-KEY,
 18974           DFHEIV99,
 18975           DFHEIV99,
 18976           DFHEIV99
 18977     SET ADDRESS OF CERTIFICATE-MASTER TO
 18978         DFHEIV20
 18979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18980
 18981
 18982 7970-EXIT.
 18983      EXIT.
 18984 7975-read-acct.
 18985
 18986     move spaces              to WS-ACCT-RECORD-SW
 18987                                 pi-dcc-product-code
 18988
 18989     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 18990     MOVE PI-CARRIER          TO ACCT-CARRIER
 18991     MOVE PI-GROUPING         TO ACCT-GROUPING
 18992     MOVE PI-STATE            TO ACCT-STATE
 18993     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 18994     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 18995     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 18996     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 18997
 18998
 18999* EXEC CICS READ
 19000*       DATASET ('ERACCT')
 19001*       RIDFLD  (ERACCT-KEY)
 19002*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19003*       GTEQ
 19004*       resp    (WS-RESPONSE)
 19005*    END-EXEC
 19006     MOVE 'ERACCT' TO DFHEIV1
 19007*    MOVE '&"S        G          (  N#00016864' TO DFHEIV0
 19008     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19010     MOVE X'204E233030303136383634' TO DFHEIV0(25:11)
 19011     CALL 'kxdfhei1' USING DFHEIV0,
 19012           DFHEIV1,
 19013           DFHEIV20,
 19014           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 366
* EL156.cbl
 19015           ERACCT-KEY,
 19016           DFHEIV99,
 19017           DFHEIV99,
 19018           DFHEIV99
 19019     SET ADDRESS OF ACCOUNT-MASTER TO
 19020         DFHEIV20
 19021     MOVE EIBRESP  TO WS-RESPONSE
 19022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19023     IF WS-RESP-NORMAL
 19024        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19025        and pi-cert-eff-dt < am-expiration-dt
 19026        and pi-cert-eff-dt >= am-effective-dt
 19027        move am-dcc-product-code to pi-dcc-product-code
 19028        set acct-found to true
 19029     end-if
 19030
 19031     .
 19032 7975-exit.
 19033     exit.
 19034 7980-READ-CERT-UPDATE.
 19035
 19036* EXEC CICS READ
 19037*        DATASET  ('ELCERT')
 19038*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19039*        RIDFLD   (ELCERT-KEY)
 19040*        UPDATE
 19041*    END-EXEC.
 19042     MOVE 'ELCERT' TO DFHEIV1
 19043*    MOVE '&"S        EU         (   #00016883' TO DFHEIV0
 19044     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19045     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19046     MOVE X'2020233030303136383833' TO DFHEIV0(25:11)
 19047     CALL 'kxdfhei1' USING DFHEIV0,
 19048           DFHEIV1,
 19049           DFHEIV20,
 19050           DFHEIV99,
 19051           ELCERT-KEY,
 19052           DFHEIV99,
 19053           DFHEIV99,
 19054           DFHEIV99
 19055     SET ADDRESS OF CERTIFICATE-MASTER TO
 19056         DFHEIV20
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19058
 19059
 19060 7980-EXIT.
 19061      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 367
* EL156.cbl
 19063 8000-LOAD-ERROR-MESSAGES.
 19064     IF PI-PASS-SW = 'C'
 19065        MOVE EMI-LINE1           TO ERMSG1BO
 19066     ELSE
 19067        MOVE EMI-LINE1           TO ERRMSG1O
 19068        MOVE EMI-LINE2           TO ERRMSG2O.
 19069
 19070 8000-EXIT.
 19071     EXIT.
 19072
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 368
* EL156.cbl
 19074
 19075 8010-DMD-ERROR-CHECKS.
 19076     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19077
 19078     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19079         GO TO 8051-ISSUE-ERROR.
 19080
 19081     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19082     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19083     MOVE '3'                    TO DC-OPTION-CODE.
 19084     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19085     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19086         GO TO 8051-ISSUE-ERROR.
 19087
 19088     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19089       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19090                           OR
 19091          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19092           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19093             MOVE ER-0851         TO EMI-ERROR
 19094             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19095       END-IF
 19096       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19097             MOVE ER-8147         TO EMI-ERROR
 19098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19099
 19100     GO TO 8090-EXIT.
 19101
 19102 8051-ISSUE-ERROR.
 19103     MOVE ER-8146            TO EMI-ERROR.
 19104     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19105     GO TO 8090-EXIT.
 19106
 19107 8090-EXIT.
 19108      EXIT.
 19109
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 369
* EL156.cbl
 19111 8100-SEND-INITIAL-MAP.
 19112
 19113     MOVE SAVE-DATE              TO RUNDTEAO.
 19114     MOVE EIBTIME                TO TIME-IN.
 19115     MOVE TIME-OUT               TO RUNTIMAO.
 19116     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19117
 19118     IF MAP-NAME = 'EL156A'
 19119        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19120           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19121        END-IF
 19122     END-IF
 19123*    IF MAP-NAME = 'EL156A'
 19124*       IF PI-COMPANY-ID = 'CRI'
 19125*          NEXT SENTENCE
 19126*       ELSE
 19127*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19128
 19129     IF MAP-NAME = 'EL156A'
 19130        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19131           NEXT SENTENCE
 19132        ELSE
 19133           MOVE AL-SADOF TO  PINTA    PINTHA.
 19134
 19135     IF MAP-NAME = 'EL156A'
 19136        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19137            NEXT SENTENCE
 19138        ELSE
 19139           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19140
 19141*    IF MAP-NAME = 'EL156A'
 19142*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19143*          NEXT SENTENCE
 19144*       ELSE
 19145*          MOVE AL-SADOF TO CASHHA CASHA.
 19146
 19147     IF MAP-NAME = 'EL156A'
 19148        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19149           NEXT SENTENCE
 19150        ELSE
 19151           MOVE AL-SADOF        TO  LOANHA
 19152                                    LOANNOA.
 19153
 19154     IF MAP-NAME = 'EL156A'
 19155        MOVE -1                 TO  ENTERPFL
 19156        IF PI-USES-PAID-TO
 19157           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19158           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19159           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19160        ELSE
 19161           NEXT SENTENCE
 19162     ELSE
 19163        IF MAP-NAME = 'EL156B'
 19164           IF PI-USES-PAID-TO
 19165              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19166              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19167
 19168
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 370
* EL156.cbl
 19169* EXEC CICS SEND
 19170*        MAP   (MAP-NAME)
 19171*        MAPSET(MAPSET-NAME)
 19172*        FROM  (EL156AI)
 19173*        ERASE
 19174*        CURSOR
 19175*    END-EXEC.
 19176     MOVE LENGTH OF
 19177      EL156AI
 19178       TO DFHEIV12
 19179     MOVE -1
 19180       TO DFHEIV11
 19181*    MOVE '8$     CT  E    H L F ,   #00016998' TO DFHEIV0
 19182     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19183     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19184     MOVE X'2020233030303136393938' TO DFHEIV0(25:11)
 19185     CALL 'kxdfhei1' USING DFHEIV0,
 19186           MAP-NAME,
 19187           EL156AI,
 19188           DFHEIV12,
 19189           MAPSET-NAME,
 19190           DFHEIV99,
 19191           DFHEIV99,
 19192           DFHEIV99,
 19193           DFHEIV11,
 19194           DFHEIV99,
 19195           DFHEIV99,
 19196           DFHEIV99
 19197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19198
 19199
 19200     GO TO 9100-RETURN-TRAN.
 19201
 19202 8200-SEND-DATAONLY.
 19203
 19204     IF FIRST-ENTRY = 'Y'
 19205         GO TO 8100-SEND-INITIAL-MAP.
 19206
 19207     IF RETURNED-FROM-B = 'Y'
 19208         GO TO 8100-SEND-INITIAL-MAP.
 19209
 19210     MOVE SAVE-DATE              TO RUNDTEAO.
 19211     MOVE EIBTIME                TO TIME-IN.
 19212     MOVE TIME-OUT               TO RUNTIMAO.
 19213
 19214     IF EIBAID = DFHPF11
 19215        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19217        MOVE 'EL001   '          TO RETURNED-FROM
 19218        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19219        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19220        GO TO 8100-SEND-INITIAL-MAP.
 19221
 19222     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19223
 19224     IF MAP-NAME =  'EL156A'
 19225        MOVE -1                 TO  ENTERPFL
 19226        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 371
* EL156.cbl
 19227           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19228           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19229           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19230        ELSE
 19231           NEXT SENTENCE
 19232     ELSE
 19233        IF MAP-NAME = 'EL156B'
 19234           IF PI-USES-PAID-TO
 19235              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19236              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19237
 19238     IF MAP-NAME =  'EL156A'
 19239        IF PI-COMPANY-ID = 'BOA'
 19240            IF PI-INT-RATE NUMERIC
 19241                MOVE PI-INT-RATE TO PINTO.
 19242     IF MAP-NAME = 'EL156A'
 19243        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19244           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19245*          MOVE 'Y'              TO EOBYNO
 19246        END-IF
 19247     END-IF
 19248
 19249
 19250* EXEC CICS SEND
 19251*        MAP   (MAP-NAME)
 19252*        MAPSET(MAPSET-NAME)
 19253*        FROM  (EL156AI)
 19254*        DATAONLY
 19255*        CURSOR
 19256*    END-EXEC.
 19257     MOVE LENGTH OF
 19258      EL156AI
 19259       TO DFHEIV12
 19260     MOVE -1
 19261       TO DFHEIV11
 19262*    MOVE '8$D    CT       H L F ,   #00017055' TO DFHEIV0
 19263     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19264     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19265     MOVE X'2020233030303137303535' TO DFHEIV0(25:11)
 19266     CALL 'kxdfhei1' USING DFHEIV0,
 19267           MAP-NAME,
 19268           EL156AI,
 19269           DFHEIV12,
 19270           MAPSET-NAME,
 19271           DFHEIV99,
 19272           DFHEIV99,
 19273           DFHEIV99,
 19274           DFHEIV11,
 19275           DFHEIV99,
 19276           DFHEIV99,
 19277           DFHEIV99
 19278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19279
 19280
 19281     GO TO 9100-RETURN-TRAN.
 19282
 19283 8300-SEND-TEXT.
 19284
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 372
* EL156.cbl
 19285* EXEC CICS SEND TEXT
 19286*        FROM(LOGOFF-TEXT)
 19287*        LENGTH(LOGOFF-LENGTH)
 19288*        ERASE
 19289*        FREEKB
 19290*    END-EXEC.
 19291*    MOVE '8&      T  E F  H   F -   #00017066' TO DFHEIV0
 19292     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19293     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19294     MOVE X'2020233030303137303636' TO DFHEIV0(25:11)
 19295     CALL 'kxdfhei1' USING DFHEIV0,
 19296           LOGOFF-TEXT,
 19297           LOGOFF-LENGTH,
 19298           DFHEIV99,
 19299           DFHEIV99,
 19300           DFHEIV99,
 19301           DFHEIV99,
 19302           DFHEIV99,
 19303           DFHEIV99,
 19304           DFHEIV99,
 19305           DFHEIV99,
 19306           DFHEIV99,
 19307           DFHEIV99
 19308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19309
 19310
 19311
 19312* EXEC CICS RETURN
 19313*    END-EXEC.
 19314*    MOVE '.(                    ''   #00017073' TO DFHEIV0
 19315     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19316     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19317     MOVE X'2020233030303137303733' TO DFHEIV0(25:11)
 19318     CALL 'kxdfhei1' USING DFHEIV0,
 19319           DFHEIV99,
 19320           DFHEIV99,
 19321           DFHEIV99,
 19322           DFHEIV99,
 19323           DFHEIV99,
 19324           DFHEIV99
 19325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19326
 19327
 19328 8500-FILE-NOTOPEN.
 19329     IF FILE-SWITCH = 'MSTR'
 19330         MOVE ER-0154            TO EMI-ERROR.
 19331     IF FILE-SWITCH = 'TRLR'
 19332         MOVE ER-0172            TO EMI-ERROR.
 19333     IF FILE-SWITCH = 'CERT'
 19334         MOVE ER-0169            TO EMI-ERROR.
 19335     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19336                      'PROC' OR 'STAT'
 19337         MOVE ER-0042            TO EMI-ERROR.
 19338     IF FILE-SWITCH = 'ACTQ'
 19339         MOVE ER-0338            TO EMI-ERROR.
 19340     IF FILE-SWITCH = 'ACCT'
 19341         MOVE ER-0168            TO EMI-ERROR.
 19342
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 373
* EL156.cbl
 19343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19344     MOVE -1                     TO PMTTYPEL.
 19345
 19346     IF FIRST-ENTRY = 'Y'
 19347         GO TO 8100-SEND-INITIAL-MAP.
 19348
 19349     GO TO 8200-SEND-DATAONLY.
 19350
 19351 8600-PGRM-NOT-FOUND.
 19352
 19353     MOVE ER-0923                TO EMI-ERROR.
 19354     MOVE -1                     TO ENTPFBL.
 19355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19356
 19357     IF FIRST-ENTRY = 'Y'
 19358         GO TO 8100-SEND-INITIAL-MAP
 19359     ELSE
 19360         GO TO 8200-SEND-DATAONLY.
 19361
 19362 8800-UNAUTHORIZED-ACCESS.
 19363     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19364     GO TO 8300-SEND-TEXT.
 19365
 19366 8810-PF23.
 19367     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19368     MOVE XCTL-005               TO PGM-NAME.
 19369     GO TO 9300-XCTL.
 19370
 19371 8820-PF7-8.
 19372     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19373     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19374                                    PI-SAVED-PROGRAM-2
 19375                                    PI-SAVED-PROGRAM-3
 19376                                    PI-SAVED-PROGRAM-4
 19377                                    PI-SAVED-PROGRAM-5
 19378                                    PI-SAVED-PROGRAM-6
 19379                                    PI-RETURN-TO-PROGRAM.
 19380     IF EIBAID = DFHPF8
 19381        MOVE XCTL-132            TO PGM-NAME
 19382     ELSE
 19383        MOVE XCTL-130            TO PGM-NAME.
 19384
 19385     GO TO 9300-XCTL.
 19386
 19387 9100-RETURN-TRAN.
 19388     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19389     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19390
 19391
 19392* EXEC CICS RETURN
 19393*        TRANSID(TRANS-ID)
 19394*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19395*        LENGTH(PI-COMM-LENGTH)
 19396*    END-EXEC.
 19397*    MOVE '.(CT                  ''   #00017139' TO DFHEIV0
 19398     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19400     MOVE X'2020233030303137313339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 374
* EL156.cbl
 19401     CALL 'kxdfhei1' USING DFHEIV0,
 19402           TRANS-ID,
 19403           PROGRAM-INTERFACE-BLOCK,
 19404           PI-COMM-LENGTH,
 19405           DFHEIV99,
 19406           DFHEIV99,
 19407           DFHEIV99
 19408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19409
 19410
 19411 9200-RETURN-MAIN-MENU.
 19412     MOVE XCTL-126               TO PGM-NAME.
 19413     GO TO 9300-XCTL.
 19414
 19415 9300-XCTL.
 19416
 19417* EXEC CICS XCTL
 19418*        PROGRAM(PGM-NAME)
 19419*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19420*        LENGTH(PI-COMM-LENGTH)
 19421*    END-EXEC.
 19422*    MOVE '.$C                   %   #00017150' TO DFHEIV0
 19423     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19425     MOVE X'2020233030303137313530' TO DFHEIV0(25:11)
 19426     CALL 'kxdfhei1' USING DFHEIV0,
 19427           PGM-NAME,
 19428           PROGRAM-INTERFACE-BLOCK,
 19429           PI-COMM-LENGTH,
 19430           DFHEIV99
 19431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19432
 19433
 19434 9400-CLEAR.
 19435     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19436     GO TO 9300-XCTL.
 19437
 19438 9500-PF12.
 19439     MOVE XCTL-010               TO PGM-NAME.
 19440     GO TO 9300-XCTL.
 19441
 19442 9700-LINK-DATE-CONVERT.
 19443     MOVE LINK-ELDATCV           TO PGM-NAME.
 19444
 19445* EXEC CICS LINK
 19446*        PROGRAM   (PGM-NAME)
 19447*        COMMAREA  (DATE-CONVERSION-DATA)
 19448*        LENGTH    (DC-COMM-LENGTH)
 19449*    END-EXEC.
 19450*    MOVE '."C                   (   #00017166' TO DFHEIV0
 19451     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19453     MOVE X'2020233030303137313636' TO DFHEIV0(25:11)
 19454     CALL 'kxdfhei1' USING DFHEIV0,
 19455           PGM-NAME,
 19456           DATE-CONVERSION-DATA,
 19457           DC-COMM-LENGTH,
 19458           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 375
* EL156.cbl
 19459           DFHEIV99,
 19460           DFHEIV99,
 19461           DFHEIV99
 19462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19463
 19464
 19465 9700-EXIT.
 19466     EXIT.
 19467
 19468 9800-LINK-REM-TERM.
 19469     MOVE LINK-REMTERM TO PGM-NAME.
 19470
 19471
 19472* EXEC CICS LINK
 19473*        PROGRAM   (PGM-NAME)
 19474*        COMMAREA  (CALCULATION-PASS-AREA)
 19475*        LENGTH    (CP-COMM-LENGTH)
 19476*    END-EXEC.
 19477*    MOVE '."C                   (   #00017178' TO DFHEIV0
 19478     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19480     MOVE X'2020233030303137313738' TO DFHEIV0(25:11)
 19481     CALL 'kxdfhei1' USING DFHEIV0,
 19482           PGM-NAME,
 19483           CALCULATION-PASS-AREA,
 19484           CP-COMM-LENGTH,
 19485           DFHEIV99,
 19486           DFHEIV99,
 19487           DFHEIV99,
 19488           DFHEIV99
 19489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19490
 19491
 19492 9800-EXIT.
 19493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 376
* EL156.cbl
 19495 9830-DMD-REMAINING-TERM.
 19496
 19497     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19498         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19499
 19500     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19501                              CM-PMT-EXTENSION-DAYS.
 19502
 19503     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19504                                  CL-NO-OF-DAYS-PAID.
 19505
 19506     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19507         GIVING W-REM REMAINDER W-REM-DAYS.
 19508
 19509     MOVE W-REM                  TO WST-REM.
 19510
 19511     IF W-REM-DAYS > ZEROS
 19512         MOVE '/'                TO WST-SLASH
 19513         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19514     ELSE
 19515         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19516
 19517 9830-EXIT.
 19518     EXIT.
 19519
 19520 9870-OUTPUT-ACTIVITY-RECORD.
 19521
 19522
 19523* EXEC CICS GETMAIN
 19524*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19525*         LENGTH(25)
 19526*         INITIMG(WS-BLANK)
 19527*    END-EXEC.
 19528     MOVE 25
 19529       TO DFHEIV11
 19530*    MOVE ',"IL                  $   #00017214' TO DFHEIV0
 19531     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19532     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19533     MOVE X'2020233030303137323134' TO DFHEIV0(25:11)
 19534     CALL 'kxdfhei1' USING DFHEIV0,
 19535           DFHEIV20,
 19536           DFHEIV11,
 19537           WS-BLANK
 19538     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19539         DFHEIV20
 19540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19541
 19542
 19543     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19544     MOVE ELMSTR-KEY             TO DA-KEY.
 19545     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19546
 19547     IF PI-PMTTYPE EQUAL '7'
 19548         MOVE 'V'                TO DA-RECORD-TYPE
 19549     ELSE
 19550         MOVE 'P'                TO DA-RECORD-TYPE.
 19551
 19552
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 377
* EL156.cbl
 19553* EXEC CICS HANDLE CONDITION
 19554*         NOTOPEN(9870-NOTOPEN)
 19555*         DUPREC(9870-EXIT)
 19556*    END-EXEC.
 19557*    MOVE '"$J%                  ! B #00017229' TO DFHEIV0
 19558     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19560     MOVE X'4220233030303137323239' TO DFHEIV0(25:11)
 19561     CALL 'kxdfhei1' USING DFHEIV0
 19562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19563
 19564
 19565
 19566* EXEC CICS WRITE
 19567*         DATASET('DLYACTV')
 19568*         RIDFLD(DA-KEY)
 19569*         FROM(DAILY-ACTIVITY-RECORD)
 19570*         LENGTH(25)
 19571*    END-EXEC.
 19572     MOVE 'DLYACTV' TO DFHEIV1
 19573     MOVE 25
 19574       TO DFHEIV11
 19575*    MOVE '&$ L                  ''   #00017234' TO DFHEIV0
 19576     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19578     MOVE X'2020233030303137323334' TO DFHEIV0(25:11)
 19579     CALL 'kxdfhei1' USING DFHEIV0,
 19580           DFHEIV1,
 19581           DAILY-ACTIVITY-RECORD,
 19582           DFHEIV11,
 19583           DA-KEY,
 19584           DFHEIV99,
 19585           DFHEIV99
 19586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19587
 19588     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19589     GO TO 9870-EXIT.
 19590
 19591 9870-NOTOPEN.
 19592
 19593     MOVE '2955'                 TO EMI-ERROR.
 19594     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19595
 19596 9870-EXIT.
 19597     EXIT.
 19598
 19599 9900-ERROR-FORMAT.
 19600
 19601     IF EMI-ERROR = ER-0923
 19602         MOVE PGM-NAME           TO W-CALLED-NAME.
 19603
 19604     MOVE LINK-001      TO PGM-NAME.
 19605     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19606
 19607
 19608* EXEC CICS LINK
 19609*        PROGRAM (PGM-NAME)
 19610*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 378
* EL156.cbl
 19611*        LENGTH  (EMI-COMM-LENGTH)
 19612*    END-EXEC.
 19613*    MOVE '."C                   (   #00017259' TO DFHEIV0
 19614     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19616     MOVE X'2020233030303137323539' TO DFHEIV0(25:11)
 19617     CALL 'kxdfhei1' USING DFHEIV0,
 19618           PGM-NAME,
 19619           ERROR-MESSAGE-INTERFACE-BLOCK,
 19620           EMI-COMM-LENGTH,
 19621           DFHEIV99,
 19622           DFHEIV99,
 19623           DFHEIV99,
 19624           DFHEIV99
 19625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19626
 19627
 19628     IF EMI-ERROR = ER-0923
 19629         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19630
 19631 9900-EXIT.
 19632     EXIT.
 19633
 19634 9990-ABEND.
 19635     MOVE LINK-004               TO PGM-NAME.
 19636     MOVE DFHEIBLK               TO EMI-LINE1.
 19637
 19638* EXEC CICS LINK
 19639*        PROGRAM   (PGM-NAME)
 19640*        COMMAREA  (EMI-LINE1)
 19641*        LENGTH    (64)
 19642*    END-EXEC.
 19643     MOVE 64
 19644       TO DFHEIV11
 19645*    MOVE '."C                   (   #00017274' TO DFHEIV0
 19646     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19648     MOVE X'2020233030303137323734' TO DFHEIV0(25:11)
 19649     CALL 'kxdfhei1' USING DFHEIV0,
 19650           PGM-NAME,
 19651           EMI-LINE1,
 19652           DFHEIV11,
 19653           DFHEIV99,
 19654           DFHEIV99,
 19655           DFHEIV99,
 19656           DFHEIV99
 19657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19658
 19659
 19660     MOVE 'EL156A'               TO  MAP-NAME.
 19661     MOVE LOW-VALUES             TO  EL156AO.
 19662     GO TO 8100-SEND-INITIAL-MAP.
 19663
 19664 9995-SECURITY-VIOLATION.
 19665*    COPY ELCSCTP.
 19666******************************************************************
 19667*                                                                *
 19668*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 379
* EL156.cbl
 19669*                            VMOD=2.001                          *
 19670*                                                                *
 19671*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 19672******************************************************************
 19673
 19674
 19675     MOVE EIBDATE          TO SM-JUL-DATE.
 19676     MOVE EIBTRMID         TO SM-TERMID.
 19677     MOVE THIS-PGM         TO SM-PGM.
 19678     MOVE EIBTIME          TO TIME-IN.
 19679     MOVE TIME-OUT         TO SM-TIME.
 19680     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 19681
 19682
 19683* EXEC CICS LINK
 19684*         PROGRAM  ('EL003')
 19685*         COMMAREA (SECURITY-MESSAGE)
 19686*         LENGTH   (80)
 19687*    END-EXEC.
 19688     MOVE 'EL003' TO DFHEIV1
 19689     MOVE 80
 19690       TO DFHEIV11
 19691*    MOVE '."C                   (   #00017302' TO DFHEIV0
 19692     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19694     MOVE X'2020233030303137333032' TO DFHEIV0(25:11)
 19695     CALL 'kxdfhei1' USING DFHEIV0,
 19696           DFHEIV1,
 19697           SECURITY-MESSAGE,
 19698           DFHEIV11,
 19699           DFHEIV99,
 19700           DFHEIV99,
 19701           DFHEIV99,
 19702           DFHEIV99
 19703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19704
 19705
 19706******************************************************************
 19707
 19708
 19709
 19710 9999-DFHBACK SECTION.
 19711     MOVE '9%                    "   ' TO DFHEIV0
 19712     MOVE 'EL156' TO DFHEIV1
 19713     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19714     GOBACK.
 19715 9999-DFHEXIT.
 19716     IF DFHEIGDJ EQUAL 0001
 19717         NEXT SENTENCE
 19718     ELSE IF DFHEIGDJ EQUAL 2
 19719         GO TO 9990-ABEND,
 19720               8600-PGRM-NOT-FOUND,
 19721               0400-FIRST-TIME,
 19722               6180-DUPREC,
 19723               9990-ABEND
 19724         DEPENDING ON DFHEIGDI
 19725     ELSE IF DFHEIGDJ EQUAL 3
 19726         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 380
* EL156.cbl
 19727               0380-CLAIM-END-FILE
 19728         DEPENDING ON DFHEIGDI
 19729     ELSE IF DFHEIGDJ EQUAL 4
 19730         GO TO 0380-CLAIM-END-FILE,
 19731               0380-CLAIM-END-FILE
 19732         DEPENDING ON DFHEIGDI
 19733     ELSE IF DFHEIGDJ EQUAL 5
 19734         GO TO 0800-EXIT
 19735         DEPENDING ON DFHEIGDI
 19736     ELSE IF DFHEIGDJ EQUAL 6
 19737         GO TO 1950-NOT-FOUND,
 19738               1950-NOT-FOUND
 19739         DEPENDING ON DFHEIGDI
 19740     ELSE IF DFHEIGDJ EQUAL 7
 19741         GO TO 1950-NOT-FOUND
 19742         DEPENDING ON DFHEIGDI
 19743     ELSE IF DFHEIGDJ EQUAL 8
 19744         GO TO 1950-NOT-FOUND,
 19745               1950-NOT-FOUND
 19746         DEPENDING ON DFHEIGDI
 19747     ELSE IF DFHEIGDJ EQUAL 9
 19748         GO TO 1166-END-CHECK,
 19749               1166-END-CHECK
 19750         DEPENDING ON DFHEIGDI
 19751     ELSE IF DFHEIGDJ EQUAL 10
 19752         GO TO 1950-NOT-FOUND,
 19753               1950-NOT-FOUND
 19754         DEPENDING ON DFHEIGDI
 19755     ELSE IF DFHEIGDJ EQUAL 11
 19756         GO TO 1950-NOT-FOUND,
 19757               1950-NOT-FOUND
 19758         DEPENDING ON DFHEIGDI
 19759     ELSE IF DFHEIGDJ EQUAL 12
 19760         GO TO 1950-NOT-FOUND
 19761         DEPENDING ON DFHEIGDI
 19762     ELSE IF DFHEIGDJ EQUAL 13
 19763         GO TO 3600-CONTINUE
 19764         DEPENDING ON DFHEIGDI
 19765     ELSE IF DFHEIGDJ EQUAL 14
 19766         GO TO 5300-NOTE-NOT-FOUND
 19767         DEPENDING ON DFHEIGDI
 19768     ELSE IF DFHEIGDJ EQUAL 15
 19769         GO TO 6065-NOT-FOUND
 19770         DEPENDING ON DFHEIGDI
 19771     ELSE IF DFHEIGDJ EQUAL 16
 19772         GO TO 6068-ACCT-NOT-FND
 19773         DEPENDING ON DFHEIGDI
 19774     ELSE IF DFHEIGDJ EQUAL 17
 19775         GO TO 6074-GET-COMP-DATA
 19776         DEPENDING ON DFHEIGDI
 19777     ELSE IF DFHEIGDJ EQUAL 18
 19778         GO TO 6170-WRITE
 19779         DEPENDING ON DFHEIGDI
 19780     ELSE IF DFHEIGDJ EQUAL 19
 19781         GO TO 6180-DUPREC
 19782         DEPENDING ON DFHEIGDI
 19783     ELSE IF DFHEIGDJ EQUAL 20
 19784         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:09 Page 381
* EL156.cbl
 19785         DEPENDING ON DFHEIGDI
 19786     ELSE IF DFHEIGDJ EQUAL 21
 19787         GO TO 6185-DUPREC
 19788         DEPENDING ON DFHEIGDI
 19789     ELSE IF DFHEIGDJ EQUAL 22
 19790         GO TO 6720-BUILD-NEW-RECORD
 19791         DEPENDING ON DFHEIGDI
 19792     ELSE IF DFHEIGDJ EQUAL 23
 19793         GO TO 6900-BUILD-ARCHIVE-HEADER,
 19794               6900-BUILD-ARCHIVE-HEADER
 19795         DEPENDING ON DFHEIGDI
 19796     ELSE IF DFHEIGDJ EQUAL 24
 19797         GO TO 7010-BUILD-MAP
 19798         DEPENDING ON DFHEIGDI
 19799     ELSE IF DFHEIGDJ EQUAL 25
 19800         GO TO 7100-SHOW-RECORD-NOT-FOUND
 19801         DEPENDING ON DFHEIGDI
 19802     ELSE IF DFHEIGDJ EQUAL 26
 19803         GO TO 7160-DUPREC
 19804         DEPENDING ON DFHEIGDI
 19805     ELSE IF DFHEIGDJ EQUAL 27
 19806         GO TO 7200-EXIT,
 19807               7200-EXIT
 19808         DEPENDING ON DFHEIGDI
 19809     ELSE IF DFHEIGDJ EQUAL 28
 19810         GO TO 7400-NOT-FOUND
 19811         DEPENDING ON DFHEIGDI
 19812     ELSE IF DFHEIGDJ EQUAL 29
 19813         GO TO 7590-END,
 19814               7590-END
 19815         DEPENDING ON DFHEIGDI
 19816     ELSE IF DFHEIGDJ EQUAL 30
 19817         GO TO 7699-EXIT
 19818         DEPENDING ON DFHEIGDI
 19819     ELSE IF DFHEIGDJ EQUAL 31
 19820         GO TO 5300-NOTE-NOT-FOUND
 19821         DEPENDING ON DFHEIGDI
 19822     ELSE IF DFHEIGDJ EQUAL 32
 19823         GO TO 7800-COMP-NOTFND
 19824         DEPENDING ON DFHEIGDI
 19825     ELSE IF DFHEIGDJ EQUAL 33
 19826         GO TO 7920-NOT-FOUND
 19827         DEPENDING ON DFHEIGDI
 19828     ELSE IF DFHEIGDJ EQUAL 34
 19829         GO TO 9870-NOTOPEN,
 19830               9870-EXIT
 19831         DEPENDING ON DFHEIGDI.
 19832     MOVE '9%                    "   ' TO DFHEIV0
 19833     MOVE 'EL156' TO DFHEIV1
 19834     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19835     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12044     Code:       72994
