* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1276.cbl
* Options: int("EL1276.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1276.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1276.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1276.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1276.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:59:22.
     7*                            VMOD=2.004.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1276.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*                                                                *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25*
    26*REMARKS.    TRANSACTION - EXX6 - CERTIFICATE AND BILLING NOTES.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL127FO FILLER
    38* 092309    2008100900003  AJRA  CERT NOTES MOVED TO NEW SCREEN
    39* 110811  CR2011110800002  PEMA CORRECT SECURITY ISSUE
    40******************************************************************
    41 ENVIRONMENT DIVISION.
    42
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1276.cbl
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL1276 WORKING STORAGE    *'.
    49 77  FILLER  PIC X(32)  VALUE '************ V/M 2.004 *********'.
    50
    51*    COPY ELCSCTM.
    52******************************************************************
    53*                                                                *
    54*                                                                *
    55*                            ELCSCTM                             *
    56*                            VMOD=2.001                          *
    57*                                                                *
    58*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    59*                                                                *
    60******************************************************************
    61 01  SECURITY-MESSAGE.
    62     12  FILLER                          PIC X(30)
    63            VALUE '** LOGIC SECURITY VIOLATION -'.
    64     12  SM-READ                         PIC X(6).
    65     12  FILLER                          PIC X(5)
    66            VALUE ' PGM='.
    67     12  SM-PGM                          PIC X(6).
    68     12  FILLER                          PIC X(5)
    69            VALUE ' OPR='.
    70     12  SM-PROCESSOR-ID                 PIC X(4).
    71     12  FILLER                          PIC X(6)
    72            VALUE ' TERM='.
    73     12  SM-TERMID                       PIC X(4).
    74     12  FILLER                          PIC XX   VALUE SPACE.
    75     12  SM-JUL-DATE                     PIC 9(5).
    76     12  FILLER                          PIC X    VALUE SPACE.
    77     12  SM-TIME                         PIC 99.99.
    78
    79
    80*    COPY ELCSCRTY.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCRTY                            *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    88*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    89*        SAVED IN PI-SECURITY-ADDRESS.                           *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-CONTROL.
    93     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    94     12  FILLER                       PIC XX    VALUE 'SC'.
    95     12  SC-CREDIT-CODES.
    96         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    97             20  SC-CREDIT-DISPLAY    PIC X.
    98             20  SC-CREDIT-UPDATE     PIC X.
    99     12  SC-CLAIMS-CODES.
   100         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   101             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1276.cbl
   102             20  SC-CLAIMS-UPDATE     PIC X.
   103
   104 01  WS-DATE-AREA.
   105     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   106     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   107
   108 01  STANDARD-AREAS.
   109     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   110     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   111     12  MAP-NAME                    PIC X(8)    VALUE 'EL127F'.
   112     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL1276S'.
   113     12  SCREEN-NUMBER               PIC X(4)    VALUE '127F'.
   114     12  TRANS-ID                    PIC X(4)    VALUE 'EXX6'.
   115     12  THIS-PGM                    PIC X(8)    VALUE 'EL1276'.
   116     12  PGM-NAME                    PIC X(8).
   117     12  TIME-IN                     PIC S9(7).
   118     12  TIME-OUT-R  REDEFINES TIME-IN.
   119         16  FILLER                  PIC X.
   120         16  TIME-OUT                PIC 99V99.
   121         16  FILLER                  PIC XX.
   122     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   123     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   124     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   125     12  PGM-1279                    PIC X(8)    VALUE 'EL1279'.
   126     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   127     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   128     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   129     12  ERNOTE-ID                   PIC X(8)    VALUE 'ERNOTE'.
   130     12  ELCERT-ID                   PIC X(8)    VALUE 'ELCERT'.
   131     12  WS-RECORD-LENGTHS   COMP.
   132         16  WS-ERNOTE-RECORD-LENGTH  PIC S9(4)  VALUE +825.
   133         16  WS-ELCERT-RECORD-LENGTH  PIC S9(4)  VALUE +450.
   134         16  WS-JOURNAL-RECORD-LENGTH PIC S9(4)  VALUE ZEROS.
   135
   136     12  DEEDIT-FIELD                PIC X(15).
   137     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   138
   139     12  RETURN-FROM                 PIC X(8).
   140     12  QID.
   141         16  QID-TERM                PIC X(4).
   142         16  FILLER                  PIC X(4)    VALUE '127F'.
   143     12  WS-SUB1                     PIC  S99  COMP.
   144     12  WS-NOTE-LINE-SW             PIC  X      VALUE SPACE.
   145         88  NOTE-LINES-PRESENT                  VALUE 'Y'.
   146     12  WS-RECORD-FOUND-SW          PIC  X      VALUE SPACE.
   147         88  RECORD-FOUND                        VALUE 'Y'.
   148         88  RECORD-NOT-FOUND                    VALUE 'N'.
   149     12  WS-DUPREC-SW                PIC  X      VALUE SPACE.
   150         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   151
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1276.cbl
   153     12  ERROR-MESSAGES.
   154         16  ER-0000                 PIC  X(4)   VALUE '0000'.
   155         16  ER-0004                 PIC  X(4)   VALUE '0004'.
   156         16  ER-0008                 PIC  X(4)   VALUE '0008'.
   157         16  ER-0023                 PIC  X(4)   VALUE '0023'.
   158         16  ER-0029                 PIC  X(4)   VALUE '0029'.
   159         16  ER-0070                 PIC  X(4)   VALUE '0070'.
   160         16  ER-0142                 PIC  X(4)   VALUE '0142'.
   161         16  ER-2520                 PIC  X(4)   VALUE '2520'.
   162         16  ER-2521                 PIC  X(4)   VALUE '2521'.
   163         16  ER-2522                 PIC  X(4)   VALUE '2522'.
   164         16  ER-2523                 PIC  X(4)   VALUE '2523'.
   165         16  ER-2524                 PIC  X(4)   VALUE '2524'.
   166         16  ER-2525                 PIC  X(4)   VALUE '2525'.
   167         16  ER-2528                 PIC  X(4)   VALUE '2528'.
   168         16  ER-2706                 PIC  X(4)   VALUE '2706'.
   169
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1276.cbl
   171
   172 01  WS-CM-CONTROL-PRIMARY.
   173     05  WS-CM-COMPANY-CD            PIC  X.
   174     05  WS-CM-CARRIER               PIC  X.
   175     05  WS-CM-GROUPING              PIC  X(6).
   176     05  WS-CM-STATE                 PIC  XX.
   177     05  WS-CM-ACCOUNT               PIC  X(10).
   178     05  WS-CM-CERT-EFF-DT           PIC  XX.
   179     05  WS-CM-CERT-NO.
   180         10  WS-CM-CERT-PRIME        PIC  X(10).
   181         10  WS-CM-CERT-SFX          PIC  X.
   182
   183*    COPY ELCDATE.
   184******************************************************************
   185*                                                                *
   186*                                                                *
   187*                            ELCDATE.                            *
   188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   189*                            VMOD=2.003
   190*                                                                *
   191*                                                                *
   192*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   193*                 LENGTH = 200                                   *
   194******************************************************************
   195
   196 01  DATE-CONVERSION-DATA.
   197     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   198     12  DC-OPTION-CODE                PIC X.
   199         88  BIN-TO-GREG                VALUE ' '.
   200         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   201         88  EDIT-GREG-TO-BIN           VALUE '2'.
   202         88  YMD-GREG-TO-BIN            VALUE '3'.
   203         88  MDY-GREG-TO-BIN            VALUE '4'.
   204         88  JULIAN-TO-BIN              VALUE '5'.
   205         88  BIN-PLUS-ELAPSED           VALUE '6'.
   206         88  FIND-CENTURY               VALUE '7'.
   207         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   208         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   209         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   210         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   211         88  JULIAN-TO-BIN-3            VALUE 'C'.
   212         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   213         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   214         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   215         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   216         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   217         88  CHECK-LEAP-YEAR            VALUE 'H'.
   218         88  BIN-3-TO-GREG              VALUE 'I'.
   219         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   220         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   221         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   222         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   223         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   224         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   225         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   226         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   227         88  THREE-CHARACTER-BIN
   228                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1276.cbl
   229         88  GREGORIAN-TO-BIN
   230                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   231         88  BIN-TO-GREGORIAN
   232                  VALUES ' ' '1' 'I' '8' 'G'.
   233         88  JULIAN-TO-BINARY
   234                  VALUES '5' 'C' 'E' 'F'.
   235     12  DC-ERROR-CODE                 PIC X.
   236         88  NO-CONVERSION-ERROR        VALUE ' '.
   237         88  DATE-CONVERSION-ERROR
   238                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   239         88  DATE-IS-ZERO               VALUE '1'.
   240         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   241         88  DATE-IS-INVALID            VALUE '3'.
   242         88  DATE1-GREATER-DATE2        VALUE '4'.
   243         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   244         88  DATE-INVALID-OPTION        VALUE '9'.
   245         88  INVALID-CENTURY            VALUE 'A'.
   246         88  ONLY-CENTURY               VALUE 'B'.
   247         88  ONLY-LEAP-YEAR             VALUE 'C'.
   248         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   249     12  DC-END-OF-MONTH               PIC X.
   250         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   251     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   252         88  USE-NORMAL-PROCESS         VALUE ' '.
   253         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   254         88  ADJUST-UP-100-YRS          VALUE '2'.
   255     12  FILLER                        PIC X.
   256     12  DC-CONVERSION-DATES.
   257         16  DC-BIN-DATE-1             PIC XX.
   258         16  DC-BIN-DATE-2             PIC XX.
   259         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   260         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   261                       DC-GREG-DATE-1-EDIT.
   262             20  DC-EDIT1-MONTH        PIC 99.
   263             20  SLASH1-1              PIC X.
   264             20  DC-EDIT1-DAY          PIC 99.
   265             20  SLASH1-2              PIC X.
   266             20  DC-EDIT1-YEAR         PIC 99.
   267         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   268         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   269                     DC-GREG-DATE-2-EDIT.
   270             20  DC-EDIT2-MONTH        PIC 99.
   271             20  SLASH2-1              PIC X.
   272             20  DC-EDIT2-DAY          PIC 99.
   273             20  SLASH2-2              PIC X.
   274             20  DC-EDIT2-YEAR         PIC 99.
   275         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   276         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   277                     DC-GREG-DATE-1-YMD.
   278             20  DC-YMD-YEAR           PIC 99.
   279             20  DC-YMD-MONTH          PIC 99.
   280             20  DC-YMD-DAY            PIC 99.
   281         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   282         16  DC-GREG-DATE-1-MDY-R REDEFINES
   283                      DC-GREG-DATE-1-MDY.
   284             20  DC-MDY-MONTH          PIC 99.
   285             20  DC-MDY-DAY            PIC 99.
   286             20  DC-MDY-YEAR           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1276.cbl
   287         16  DC-GREG-DATE-1-ALPHA.
   288             20  DC-ALPHA-MONTH        PIC X(10).
   289             20  DC-ALPHA-DAY          PIC 99.
   290             20  FILLER                PIC XX.
   291             20  DC-ALPHA-CENTURY.
   292                 24 DC-ALPHA-CEN-N     PIC 99.
   293             20  DC-ALPHA-YEAR         PIC 99.
   294         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   295         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   296         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   297         16  DC-JULIAN-DATE            PIC 9(05).
   298         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   299                                       PIC 9(05).
   300         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   301             20  DC-JULIAN-YEAR        PIC 99.
   302             20  DC-JULIAN-DAYS        PIC 999.
   303         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   304         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   305         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   306     12  DATE-CONVERSION-VARIBLES.
   307         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   308         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   309             20  FILLER                PIC 9(3).
   310             20  HOLD-CEN-1-CCYY.
   311                 24  HOLD-CEN-1-CC     PIC 99.
   312                 24  HOLD-CEN-1-YY     PIC 99.
   313             20  HOLD-CEN-1-MO         PIC 99.
   314             20  HOLD-CEN-1-DA         PIC 99.
   315         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   316             20  HOLD-CEN-1-R-MO       PIC 99.
   317             20  HOLD-CEN-1-R-DA       PIC 99.
   318             20  HOLD-CEN-1-R-CCYY.
   319                 24  HOLD-CEN-1-R-CC   PIC 99.
   320                 24  HOLD-CEN-1-R-YY   PIC 99.
   321             20  FILLER                PIC 9(3).
   322         16  HOLD-CENTURY-1-X.
   323             20  FILLER                PIC X(3)  VALUE SPACES.
   324             20  HOLD-CEN-1-X-CCYY.
   325                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   326                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   327             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   328             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   329         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   330             20  HOLD-CEN-1-R-X-MO     PIC XX.
   331             20  HOLD-CEN-1-R-X-DA     PIC XX.
   332             20  HOLD-CEN-1-R-X-CCYY.
   333                 24  HOLD-CEN-1-R-X-CC PIC XX.
   334                 24  HOLD-CEN-1-R-X-YY PIC XX.
   335             20  FILLER                PIC XXX.
   336         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   337         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   338         16  DC-JULIAN-DATE-1          PIC 9(07).
   339         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   340             20  DC-JULIAN-1-CCYY.
   341                 24  DC-JULIAN-1-CC    PIC 99.
   342                 24  DC-JULIAN-1-YR    PIC 99.
   343             20  DC-JULIAN-DA-1        PIC 999.
   344         16  DC-JULIAN-DATE-2          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1276.cbl
   345         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   346             20  DC-JULIAN-2-CCYY.
   347                 24  DC-JULIAN-2-CC    PIC 99.
   348                 24  DC-JULIAN-2-YR    PIC 99.
   349             20  DC-JULIAN-DA-2        PIC 999.
   350         16  DC-GREG-DATE-A-EDIT.
   351             20  DC-EDITA-MONTH        PIC 99.
   352             20  SLASHA-1              PIC X VALUE '/'.
   353             20  DC-EDITA-DAY          PIC 99.
   354             20  SLASHA-2              PIC X VALUE '/'.
   355             20  DC-EDITA-CCYY.
   356                 24  DC-EDITA-CENT     PIC 99.
   357                 24  DC-EDITA-YEAR     PIC 99.
   358         16  DC-GREG-DATE-B-EDIT.
   359             20  DC-EDITB-MONTH        PIC 99.
   360             20  SLASHB-1              PIC X VALUE '/'.
   361             20  DC-EDITB-DAY          PIC 99.
   362             20  SLASHB-2              PIC X VALUE '/'.
   363             20  DC-EDITB-CCYY.
   364                 24  DC-EDITB-CENT     PIC 99.
   365                 24  DC-EDITB-YEAR     PIC 99.
   366         16  DC-GREG-DATE-CYMD         PIC 9(08).
   367         16  DC-GREG-DATE-CYMD-R REDEFINES
   368                              DC-GREG-DATE-CYMD.
   369             20  DC-CYMD-CEN           PIC 99.
   370             20  DC-CYMD-YEAR          PIC 99.
   371             20  DC-CYMD-MONTH         PIC 99.
   372             20  DC-CYMD-DAY           PIC 99.
   373         16  DC-GREG-DATE-MDCY         PIC 9(08).
   374         16  DC-GREG-DATE-MDCY-R REDEFINES
   375                              DC-GREG-DATE-MDCY.
   376             20  DC-MDCY-MONTH         PIC 99.
   377             20  DC-MDCY-DAY           PIC 99.
   378             20  DC-MDCY-CEN           PIC 99.
   379             20  DC-MDCY-YEAR          PIC 99.
   380    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   381        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   382    12  DC-EL310-DATE                  PIC X(21).
   383    12  FILLER                         PIC X(28).
   384
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1276.cbl
   386*    COPY ELCLOGOF.
   387******************************************************************
   388*                                                                *
   389*                                                                *
   390*                            ELCLOGOF.                           *
   391*                            VMOD=2.001                          *
   392*                                                                *
   393*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   394*                                                                *
   395******************************************************************
   396 01  CLASIC-LOGOFF.
   397     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   398     12  LOGOFF-TEXT.
   399         16  FILLER          PIC X(5)    VALUE SPACES.
   400         16  LOGOFF-MSG.
   401             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   402             20  FILLER      PIC X       VALUE SPACES.
   403             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   404         16  FILLER          PIC X(80)
   405           VALUE '* YOU ARE NOW LOGGED OFF'.
   406         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   407         16  FILLER          PIC X       VALUE QUOTE.
   408         16  LOGOFF-SYS-MSG  PIC X(17)
   409           VALUE 'S CLAS-IC SYSTEM '.
   410     12  TEXT-MESSAGES.
   411         16  UNACCESS-MSG    PIC X(29)
   412             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   413         16  PGMIDERR-MSG    PIC X(17)
   414             VALUE 'PROGRAM NOT FOUND'.
   415
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1276.cbl
   417*    COPY ELCATTR.
   418******************************************************************
   419*                                                                *
   420*                            ELCATTR.                            *
   421*                            VMOD=2.001                          *
   422*                                                                *
   423*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   424*                                                                *
   425*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   426*                                                                *
   427*                   POS 1   P=PROTECTED                          *
   428*                           U=UNPROTECTED                        *
   429*                           S=ASKIP                              *
   430*                   POS 2   A=ALPHA/NUMERIC                      *
   431*                           N=NUMERIC                            *
   432*                   POS 3   N=NORMAL                             *
   433*                           B=BRIGHT                             *
   434*                           D=DARK                               *
   435*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   436*                           OF=MODIFIED DATA TAG OFF             *
   437*                                                                *
   438*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   439******************************************************************
   440 01  ATTRIBUTE-LIST.
   441     12  AL-PABOF            PIC X       VALUE 'Y'.
   442     12  AL-PABON            PIC X       VALUE 'Z'.
   443     12  AL-PADOF            PIC X       VALUE '%'.
   444     12  AL-PADON            PIC X       VALUE '_'.
   445     12  AL-PANOF            PIC X       VALUE '-'.
   446     12  AL-PANON            PIC X       VALUE '/'.
   447     12  AL-SABOF            PIC X       VALUE '8'.
   448     12  AL-SABON            PIC X       VALUE '9'.
   449     12  AL-SADOF            PIC X       VALUE '@'.
   450     12  AL-SADON            PIC X       VALUE QUOTE.
   451     12  AL-SANOF            PIC X       VALUE '0'.
   452     12  AL-SANON            PIC X       VALUE '1'.
   453     12  AL-UABOF            PIC X       VALUE 'H'.
   454     12  AL-UABON            PIC X       VALUE 'I'.
   455     12  AL-UADOF            PIC X       VALUE '<'.
   456     12  AL-UADON            PIC X       VALUE '('.
   457     12  AL-UANOF            PIC X       VALUE ' '.
   458     12  AL-UANON            PIC X       VALUE 'A'.
   459     12  AL-UNBOF            PIC X       VALUE 'Q'.
   460     12  AL-UNBON            PIC X       VALUE 'R'.
   461     12  AL-UNDOF            PIC X       VALUE '*'.
   462     12  AL-UNDON            PIC X       VALUE ')'.
   463     12  AL-UNNOF            PIC X       VALUE '&'.
   464     12  AL-UNNON            PIC X       VALUE 'J'.
   465
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1276.cbl
   467*    COPY ELCEMIB.
   468******************************************************************
   469*                                                                *
   470*                                                                *
   471*                            ELCEMIB.                            *
   472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   473*                            VMOD=2.005                          *
   474*                                                                *
   475*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   476*                                                                *
   477******************************************************************
   478 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   479     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   480     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   481     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   482     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   483     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   484     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   485     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   486     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   487     12  EMI-SWITCH1             PIC X        VALUE '1'.
   488         88  EMI-NO-ERRORS                    VALUE '1'.
   489         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   490         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   491     12  EMI-SWITCH2             PIC X        VALUE '1'.
   492         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   493     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   494         88  EMI-AREA1-EMPTY                  VALUE '1'.
   495         88  EMI-AREA1-FULL                   VALUE '2'.
   496     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   497         88  EMI-AREA2-EMPTY                  VALUE '1'.
   498         88  EMI-AREA2-FULL                   VALUE '2'.
   499     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   500         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   501         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   502         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   503         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   504         88  EMI-BYPASS-FATALS                VALUE 'X'.
   505     12  EMI-ERROR-LINES.
   506         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   507         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   508         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   509         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   510             20  EMI-ERR-CODES OCCURS 10 TIMES.
   511                 24  EMI-ERR-NUM         PIC X(4).
   512                 24  EMI-FILLER          PIC X.
   513                 24  EMI-SEV             PIC X.
   514                 24  FILLER              PIC X.
   515             20  FILLER                  PIC X(02).
   516     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   517         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   518             20  EMI-ERROR-NUMBER    PIC X(4).
   519             20  EMI-FILL            PIC X.
   520             20  EMI-SEVERITY        PIC X.
   521             20  FILLER              PIC X.
   522             20  EMI-ERROR-TEXT.
   523                 24  EMI-TEXT-VARIABLE   PIC X(10).
   524                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1276.cbl
   525     12  EMI-SEVERITY-SAVE           PIC X.
   526         88  EMI-NOTE                    VALUE 'N'.
   527         88  EMI-WARNING                 VALUE 'W'.
   528         88  EMI-FORCABLE                VALUE 'F'.
   529         88  EMI-FATAL                   VALUE 'X'.
   530     12  EMI-MESSAGE-FLAG            PIC X.
   531         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   532         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   533     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   534     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   535         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   536         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   537         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   538     12  FILLER                      PIC X(137)  VALUE SPACES.
   539     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   540     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   541     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   542     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   543
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1276.cbl
   545*    COPY ELCINTF.
   546******************************************************************
   547*                                                                *
   548*                                                                *
   549*                            ELCINTF.                            *
   550*                            VMOD=2.017                          *
   551*                                                                *
   552*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   553*                                                                *
   554*       LENGTH = 1024                                            *
   555*                                                                *
   556******************************************************************
   557 01  PROGRAM-INTERFACE-BLOCK.
   558     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   559     12  PI-CALLING-PROGRAM              PIC X(8).
   560     12  PI-SAVED-PROGRAM-1              PIC X(8).
   561     12  PI-SAVED-PROGRAM-2              PIC X(8).
   562     12  PI-SAVED-PROGRAM-3              PIC X(8).
   563     12  PI-SAVED-PROGRAM-4              PIC X(8).
   564     12  PI-SAVED-PROGRAM-5              PIC X(8).
   565     12  PI-SAVED-PROGRAM-6              PIC X(8).
   566     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   567     12  PI-COMPANY-ID                   PIC XXX.
   568     12  PI-COMPANY-CD                   PIC X.
   569
   570     12  PI-COMPANY-PASSWORD             PIC X(8).
   571
   572     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   573
   574     12  PI-CONTROL-IN-PROGRESS.
   575         16  PI-CARRIER                  PIC X.
   576         16  PI-GROUPING                 PIC X(6).
   577         16  PI-STATE                    PIC XX.
   578         16  PI-ACCOUNT                  PIC X(10).
   579         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   580                                         PIC X(10).
   581         16  PI-CLAIM-CERT-GRP.
   582             20  PI-CLAIM-NO             PIC X(7).
   583             20  PI-CERT-NO.
   584                 25  PI-CERT-PRIME       PIC X(10).
   585                 25  PI-CERT-SFX         PIC X.
   586             20  PI-CERT-EFF-DT          PIC XX.
   587         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   588             20  PI-PLAN-CODE            PIC X(2).
   589             20  PI-REVISION-NUMBER      PIC X(3).
   590             20  PI-PLAN-EFF-DT          PIC X(2).
   591             20  PI-PLAN-EXP-DT          PIC X(2).
   592             20  FILLER                  PIC X(11).
   593         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   594             20  PI-OE-REFERENCE-1.
   595                 25  PI-OE-REF-1-PRIME   PIC X(18).
   596                 25  PI-OE-REF-1-SUFF    PIC XX.
   597
   598     12  PI-SESSION-IN-PROGRESS          PIC X.
   599         88  CLAIM-SESSION                   VALUE '1'.
   600         88  CREDIT-SESSION                  VALUE '2'.
   601         88  WARRANTY-SESSION                VALUE '3'.
   602         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1276.cbl
   603         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   604
   605
   606*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   607
   608     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   609     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   610
   611     12  PI-CREDIT-USER                  PIC X.
   612         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   613         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   614
   615     12  PI-CLAIM-USER                   PIC X.
   616         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   617         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   618
   619     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   620         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   621         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   622         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   623         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   624         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   625
   626     12  PI-PROCESSOR-ID                 PIC X(4).
   627
   628     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   629
   630     12  PI-MEMBER-CAPTION               PIC X(10).
   631
   632     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   633         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   634
   635     12  PI-LIFE-OVERRIDE-L1             PIC X.
   636     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   637     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   638     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   639
   640     12  PI-AH-OVERRIDE-L1               PIC X.
   641     12  PI-AH-OVERRIDE-L2               PIC XX.
   642     12  PI-AH-OVERRIDE-L6               PIC X(6).
   643     12  PI-AH-OVERRIDE-L12              PIC X(12).
   644
   645     12  PI-NEW-SYSTEM                   PIC X(2).
   646
   647     12  PI-PRIMARY-CERT-NO              PIC X(11).
   648     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   649         88  PI-USES-PAID-TO                 VALUE '1'.
   650     12  PI-CRDTCRD-SYSTEM.
   651         16  PI-CRDTCRD-USER             PIC X.
   652             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   653             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   654         16  PI-CC-MONTH-END-DT          PIC XX.
   655     12  PI-PROCESSOR-PRINTER            PIC X(4).
   656
   657     12  PI-OE-REFERENCE-2.
   658         16  PI-OE-REF-2-PRIME           PIC X(10).
   659         16  PI-OE-REF-2-SUFF            PIC X.
   660
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1276.cbl
   661     12  PI-REM-TRM-CALC-OPTION          PIC X.
   662
   663     12  PI-LANGUAGE-TYPE                PIC X.
   664             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   665             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   666             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   667
   668     12  PI-POLICY-LINKAGE-IND           PIC X.
   669         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   670         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   671                                                   LOW-VALUES.
   672
   673     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   674     12  PI-CLAIM-PW-SESSION             PIC X(1).
   675         88  PI-CLAIM-CREDIT                 VALUE '1'.
   676         88  PI-CLAIM-CONVEN                 VALUE '2'.
   677     12  FILLER                          PIC X(4).
   678
   679     12  PI-SYSTEM-LEVEL                 PIC X(145).
   680
   681     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   682         PI-SYSTEM-LEVEL.
   683
   684         16  PI-ENTRY-CODES.
   685             20  PI-ENTRY-CD-1           PIC X.
   686             20  PI-ENTRY-CD-2           PIC X.
   687
   688         16  PI-RETURN-CODES.
   689             20  PI-RETURN-CD-1          PIC X.
   690             20  PI-RETURN-CD-2          PIC X.
   691
   692         16  PI-UPDATE-STATUS-SAVE.
   693             20  PI-UPDATE-BY            PIC X(4).
   694             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   695
   696         16  PI-LOWER-CASE-LETTERS       PIC X.
   697             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   698
   699*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   700*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   701*            88  CARRIER-CLM-CNTL            VALUE '2'.
   702
   703         16  PI-CERT-ACCESS-CONTROL      PIC X.
   704             88  ST-ACCNT-CNTL               VALUE ' '.
   705             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   706             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   707             88  ACCNT-CNTL                  VALUE '3'.
   708             88  CARR-ACCNT-CNTL             VALUE '4'.
   709
   710         16  PI-PROCESSOR-CAP-LIST.
   711             20  PI-SYSTEM-CONTROLS.
   712                24 PI-SYSTEM-DISPLAY     PIC X.
   713                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   714                24 PI-SYSTEM-MODIFY      PIC X.
   715                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   716             20  FILLER                  PIC XX.
   717             20  PI-DISPLAY-CAP          PIC X.
   718                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1276.cbl
   719             20  PI-MODIFY-CAP           PIC X.
   720                 88  MODIFY-CAP              VALUE 'Y'.
   721             20  PI-MSG-AT-LOGON-CAP     PIC X.
   722                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   723             20  PI-FORCE-CAP            PIC X.
   724                 88  FORCE-CAP               VALUE 'Y'.
   725
   726         16  PI-PROGRAM-CONTROLS.
   727             20  PI-PGM-PRINT-OPT        PIC X.
   728             20  PI-PGM-FORMAT-OPT       PIC X.
   729             20  PI-PGM-PROCESS-OPT      PIC X.
   730             20  PI-PGM-TOTALS-OPT       PIC X.
   731
   732         16  PI-HELP-INTERFACE.
   733             20  PI-LAST-ERROR-NO        PIC X(4).
   734             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   735
   736         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   737             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   738
   739         16  PI-CR-CONTROL-IN-PROGRESS.
   740             20  PI-CR-CARRIER           PIC X.
   741             20  PI-CR-GROUPING          PIC X(6).
   742             20  PI-CR-STATE             PIC XX.
   743             20  PI-CR-ACCOUNT           PIC X(10).
   744             20  PI-CR-FIN-RESP          PIC X(10).
   745             20  PI-CR-TYPE              PIC X.
   746
   747         16  PI-CR-BATCH-NUMBER          PIC X(6).
   748
   749         16  PI-CR-MONTH-END-DT          PIC XX.
   750
   751         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   752             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   753             88  PI-ZERO-CARRIER             VALUE '1'.
   754             88  PI-ZERO-GROUPING            VALUE '2'.
   755             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   756
   757         16  PI-CARRIER-SECURITY         PIC X.
   758             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   759
   760         16  PI-ACCOUNT-SECURITY         PIC X(10).
   761             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   762             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   763
   764         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   765             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   766                                         INDEXED BY PI-ACCESS-NDX
   767                                         PIC X.
   768
   769         16  PI-GA-BILLING-CONTROL       PIC X.
   770             88  PI-GA-BILLING               VALUE '1'.
   771
   772         16  PI-MAIL-PROCESSING          PIC X.
   773             88  PI-MAIL-YES                 VALUE 'Y'.
   774
   775         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   776
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1276.cbl
   777         16  PI-AR-SYSTEM.
   778             20  PI-AR-PROCESSING-CNTL   PIC X.
   779                 88  PI-AR-PROCESSING        VALUE 'Y'.
   780             20  PI-AR-SUMMARY-CODE      PIC X(6).
   781             20  PI-AR-MONTH-END-DT      PIC XX.
   782
   783         16  PI-MP-SYSTEM.
   784             20  PI-MORTGAGE-USER            PIC X.
   785                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   786                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   787             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   788                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   789                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   790                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   791                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   792                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   793             20  PI-MP-MONTH-END-DT          PIC XX.
   794             20  PI-MP-REFERENCE-NO.
   795                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   796                 24  PI-MP-REFERENCE-SFX     PIC XX.
   797
   798         16  PI-LABEL-CONTROL            PIC X(01).
   799             88  PI-CREATE-LABELS                    VALUE 'Y'.
   800             88  PI-BYPASS-LABELS                    VALUE 'N'.
   801
   802         16  PI-BILL-GROUPING-CODE       PIC X(01).
   803             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   804
   805         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   806             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   807             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   808
   809         16  FILLER                      PIC X(14).
   810
   811     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   812******************************************************************
   813     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   814         16  FILLER              PIC X(328).
   815         16  PI-CURR-NOTE-REC-TYPE PIC X.
   816             88 PI-CERT-NOTE                 VALUE '1'.
   817             88 PI-CLAIM-NOTE                VALUE '2'.
   818         16  PI-BILLING-NOTES-EXIST PIC X.
   819         16  PI-CERT-NOTES-EXIST    PIC X.
   820         16  PI-CLAIM-NOTES-EXIST   PIC X.
   821
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1276.cbl
   823
   824*    COPY ELCJPFX.
   825******************************************************************
   826*                                                                *
   827*                                                                *
   828*                            ELCJPFX.                            *
   829*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   830*                            VMOD=2.002                          *
   831*                                                                *
   832*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   833*                                                                *
   834*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   835*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   836*        ELCNTL - CONTROL FILE                                   *
   837*        ELMSTR - CLAIM MASTERS                                  *
   838*        ELTRLR - ACTIVITY TRAILERS                              *
   839*        ELCHKQ - CHECK QUE                                      *
   840******************************************************************
   841 01  JOURNAL-RECORD.
   842     12  JP-USER-ID                  PIC X(4).
   843     12  JP-FILE-ID                  PIC X(8).
   844     12  JP-PROGRAM-ID               PIC X(8).
   845     12  JP-RECORD-TYPE              PIC X.
   846         88 JP-ADD              VALUE 'A'.
   847         88 JP-BEFORE-CHANGE    VALUE 'B'.
   848         88 JP-AFTER-CHANGE     VALUE 'C'.
   849         88 JP-DELETE           VALUE 'D'.
   850         88 JP-GENERIC-DELETE   VALUE 'G'.
   851         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   852         88 JP-KEY-CHG-ADD      VALUE 'N'.
   853     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   854     12  JP-RECORD-AREA
   855
   856
   857                                     PIC X(523).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1276.cbl
   859
   860*    COPY ELCAID.
   861******************************************************************
   862*                                                                *
   863*                            ELCAID.                             *
   864*                            VMOD=2.001                          *
   865*                                                                *
   866*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   867*                                                                *
   868*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   869*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   870******************************************************************
   871
   872 01  DFHAID.
   873   02  DFHNULL   PIC  X  VALUE  ' '.
   874   02  DFHENTER  PIC  X  VALUE  QUOTE.
   875   02  DFHCLEAR  PIC  X  VALUE  '_'.
   876   02  DFHPEN    PIC  X  VALUE  '='.
   877   02  DFHOPID   PIC  X  VALUE  'W'.
   878   02  DFHPA1    PIC  X  VALUE  '%'.
   879   02  DFHPA2    PIC  X  VALUE  '>'.
   880   02  DFHPA3    PIC  X  VALUE  ','.
   881   02  DFHPF1    PIC  X  VALUE  '1'.
   882   02  DFHPF2    PIC  X  VALUE  '2'.
   883   02  DFHPF3    PIC  X  VALUE  '3'.
   884   02  DFHPF4    PIC  X  VALUE  '4'.
   885   02  DFHPF5    PIC  X  VALUE  '5'.
   886   02  DFHPF6    PIC  X  VALUE  '6'.
   887   02  DFHPF7    PIC  X  VALUE  '7'.
   888   02  DFHPF8    PIC  X  VALUE  '8'.
   889   02  DFHPF9    PIC  X  VALUE  '9'.
   890   02  DFHPF10   PIC  X  VALUE  ':'.
   891   02  DFHPF11   PIC  X  VALUE  '#'.
   892   02  DFHPF12   PIC  X  VALUE  '@'.
   893   02  DFHPF13   PIC  X  VALUE  'A'.
   894   02  DFHPF14   PIC  X  VALUE  'B'.
   895   02  DFHPF15   PIC  X  VALUE  'C'.
   896   02  DFHPF16   PIC  X  VALUE  'D'.
   897   02  DFHPF17   PIC  X  VALUE  'E'.
   898   02  DFHPF18   PIC  X  VALUE  'F'.
   899   02  DFHPF19   PIC  X  VALUE  'G'.
   900   02  DFHPF20   PIC  X  VALUE  'H'.
   901   02  DFHPF21   PIC  X  VALUE  'I'.
   902*00039    02  DFHPF22   PIC  X  VALUE  ''.
   903   02  DFHPF22   PIC  X  VALUE  '['.
   904   02  DFHPF23   PIC  X  VALUE  '.'.
   905   02  DFHPF24   PIC  X  VALUE  '<'.
   906   02  DFHMSRE   PIC  X  VALUE  'X'.
   907   02  DFHSTRF   PIC  X  VALUE  'h'.
   908   02  DFHTRIG   PIC  X  VALUE  '"'.
   909 01  FILLER    REDEFINES DFHAID.
   910     12  FILLER                      PIC X(8).
   911     12  PF-VALUES                   PIC X       OCCURS 24 TIMES.
   912
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1276.cbl
   914*    COPY EL1276S.
   915 01  EL127FI.
   916     05  FILLER            PIC  X(0012).
   917*    -------------------------------
   918     05  FDATEL PIC S9(0004) COMP.
   919     05  FDATEF PIC  X(0001).
   920     05  FILLER REDEFINES FDATEF.
   921         10  FDATEA PIC  X(0001).
   922     05  FDATEI PIC  X(0008).
   923*    -------------------------------
   924     05  FTIMEL PIC S9(0004) COMP.
   925     05  FTIMEF PIC  X(0001).
   926     05  FILLER REDEFINES FTIMEF.
   927         10  FTIMEA PIC  X(0001).
   928     05  FTIMEI PIC  X(0005).
   929*    -------------------------------
   930     05  CMPNYIDL PIC S9(0004) COMP.
   931     05  CMPNYIDF PIC  X(0001).
   932     05  FILLER REDEFINES CMPNYIDF.
   933         10  CMPNYIDA PIC  X(0001).
   934     05  CMPNYIDI PIC  X(0003).
   935*    -------------------------------
   936     05  USERIDL PIC S9(0004) COMP.
   937     05  USERIDF PIC  X(0001).
   938     05  FILLER REDEFINES USERIDF.
   939         10  USERIDA PIC  X(0001).
   940     05  USERIDI PIC  X(0004).
   941*    -------------------------------
   942     05  FMAINTL PIC S9(0004) COMP.
   943     05  FMAINTF PIC  X(0001).
   944     05  FILLER REDEFINES FMAINTF.
   945         10  FMAINTA PIC  X(0001).
   946     05  FMAINTI PIC  X(0001).
   947*    -------------------------------
   948     05  FCERTL PIC S9(0004) COMP.
   949     05  FCERTF PIC  X(0001).
   950     05  FILLER REDEFINES FCERTF.
   951         10  FCERTA PIC  X(0001).
   952     05  FCERTI PIC  X(0010).
   953*    -------------------------------
   954     05  FCRTSFXL PIC S9(0004) COMP.
   955     05  FCRTSFXF PIC  X(0001).
   956     05  FILLER REDEFINES FCRTSFXF.
   957         10  FCRTSFXA PIC  X(0001).
   958     05  FCRTSFXI PIC  X(0001).
   959*    -------------------------------
   960     05  FACOUNTL PIC S9(0004) COMP.
   961     05  FACOUNTF PIC  X(0001).
   962     05  FILLER REDEFINES FACOUNTF.
   963         10  FACOUNTA PIC  X(0001).
   964     05  FACOUNTI PIC  X(0010).
   965*    -------------------------------
   966     05  FSTL PIC S9(0004) COMP.
   967     05  FSTF PIC  X(0001).
   968     05  FILLER REDEFINES FSTF.
   969         10  FSTA PIC  X(0001).
   970     05  FSTI PIC  X(0002).
   971*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1276.cbl
   972     05  FCARRIRL PIC S9(0004) COMP.
   973     05  FCARRIRF PIC  X(0001).
   974     05  FILLER REDEFINES FCARRIRF.
   975         10  FCARRIRA PIC  X(0001).
   976     05  FCARRIRI PIC  X(0001).
   977*    -------------------------------
   978     05  FGROUPL PIC S9(0004) COMP.
   979     05  FGROUPF PIC  X(0001).
   980     05  FILLER REDEFINES FGROUPF.
   981         10  FGROUPA PIC  X(0001).
   982     05  FGROUPI PIC  X(0006).
   983*    -------------------------------
   984     05  FEFFDTL PIC S9(0004) COMP.
   985     05  FEFFDTF PIC  X(0001).
   986     05  FILLER REDEFINES FEFFDTF.
   987         10  FEFFDTA PIC  X(0001).
   988     05  FEFFDTI PIC  X(0008).
   989*    -------------------------------
   990     05  FBSTARTL PIC S9(0004) COMP.
   991     05  FBSTARTF PIC  X(0001).
   992     05  FILLER REDEFINES FBSTARTF.
   993         10  FBSTARTA PIC  X(0001).
   994     05  FBSTARTI PIC  X(0002).
   995*    -------------------------------
   996     05  MAINTONL PIC S9(0004) COMP.
   997     05  MAINTONF PIC  X(0001).
   998     05  FILLER REDEFINES MAINTONF.
   999         10  MAINTONA PIC  X(0001).
  1000     05  MAINTONI PIC  X(0008).
  1001*    -------------------------------
  1002     05  MAINTATL PIC S9(0004) COMP.
  1003     05  MAINTATF PIC  X(0001).
  1004     05  FILLER REDEFINES MAINTATF.
  1005         10  MAINTATA PIC  X(0001).
  1006     05  MAINTATI PIC  X(0005).
  1007*    -------------------------------
  1008     05  MAINTBYL PIC S9(0004) COMP.
  1009     05  MAINTBYF PIC  X(0001).
  1010     05  FILLER REDEFINES MAINTBYF.
  1011         10  MAINTBYA PIC  X(0001).
  1012     05  MAINTBYI PIC  X(0004).
  1013*    -------------------------------
  1014     05  FBENDL PIC S9(0004) COMP.
  1015     05  FBENDF PIC  X(0001).
  1016     05  FILLER REDEFINES FBENDF.
  1017         10  FBENDA PIC  X(0001).
  1018     05  FBENDI PIC  X(0002).
  1019*    -------------------------------
  1020     05  FCERTYNL PIC S9(0004) COMP.
  1021     05  FCERTYNF PIC  X(0001).
  1022     05  FILLER REDEFINES FCERTYNF.
  1023         10  FCERTYNA PIC  X(0001).
  1024     05  FCERTYNI PIC  X(0003).
  1025*    -------------------------------
  1026     05  FCLMYNL PIC S9(0004) COMP.
  1027     05  FCLMYNF PIC  X(0001).
  1028     05  FILLER REDEFINES FCLMYNF.
  1029         10  FCLMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1276.cbl
  1030     05  FCLMYNI PIC  X(0003).
  1031*    -------------------------------
  1032     05  FNLINE1L PIC S9(0004) COMP.
  1033     05  FNLINE1F PIC  X(0001).
  1034     05  FILLER REDEFINES FNLINE1F.
  1035         10  FNLINE1A PIC  X(0001).
  1036     05  FNLINE1I PIC  X(0077).
  1037*    -------------------------------
  1038     05  FNLINE2L PIC S9(0004) COMP.
  1039     05  FNLINE2F PIC  X(0001).
  1040     05  FILLER REDEFINES FNLINE2F.
  1041         10  FNLINE2A PIC  X(0001).
  1042     05  FNLINE2I PIC  X(0077).
  1043*    -------------------------------
  1044     05  FNLINE3L PIC S9(0004) COMP.
  1045     05  FNLINE3F PIC  X(0001).
  1046     05  FILLER REDEFINES FNLINE3F.
  1047         10  FNLINE3A PIC  X(0001).
  1048     05  FNLINE3I PIC  X(0077).
  1049*    -------------------------------
  1050     05  FNLINE4L PIC S9(0004) COMP.
  1051     05  FNLINE4F PIC  X(0001).
  1052     05  FILLER REDEFINES FNLINE4F.
  1053         10  FNLINE4A PIC  X(0001).
  1054     05  FNLINE4I PIC  X(0077).
  1055*    -------------------------------
  1056     05  FNLINE5L PIC S9(0004) COMP.
  1057     05  FNLINE5F PIC  X(0001).
  1058     05  FILLER REDEFINES FNLINE5F.
  1059         10  FNLINE5A PIC  X(0001).
  1060     05  FNLINE5I PIC  X(0077).
  1061*    -------------------------------
  1062     05  FNLINE6L PIC S9(0004) COMP.
  1063     05  FNLINE6F PIC  X(0001).
  1064     05  FILLER REDEFINES FNLINE6F.
  1065         10  FNLINE6A PIC  X(0001).
  1066     05  FNLINE6I PIC  X(0077).
  1067*    -------------------------------
  1068     05  FNLINE7L PIC S9(0004) COMP.
  1069     05  FNLINE7F PIC  X(0001).
  1070     05  FILLER REDEFINES FNLINE7F.
  1071         10  FNLINE7A PIC  X(0001).
  1072     05  FNLINE7I PIC  X(0077).
  1073*    -------------------------------
  1074     05  FNLINE8L PIC S9(0004) COMP.
  1075     05  FNLINE8F PIC  X(0001).
  1076     05  FILLER REDEFINES FNLINE8F.
  1077         10  FNLINE8A PIC  X(0001).
  1078     05  FNLINE8I PIC  X(0077).
  1079*    -------------------------------
  1080     05  FNLINE9L PIC S9(0004) COMP.
  1081     05  FNLINE9F PIC  X(0001).
  1082     05  FILLER REDEFINES FNLINE9F.
  1083         10  FNLINE9A PIC  X(0001).
  1084     05  FNLINE9I PIC  X(0077).
  1085*    -------------------------------
  1086     05  FNLINEAL PIC S9(0004) COMP.
  1087     05  FNLINEAF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1276.cbl
  1088     05  FILLER REDEFINES FNLINEAF.
  1089         10  FNLINEAA PIC  X(0001).
  1090     05  FNLINEAI PIC  X(0077).
  1091*    -------------------------------
  1092     05  FERRMSGL PIC S9(0004) COMP.
  1093     05  FERRMSGF PIC  X(0001).
  1094     05  FILLER REDEFINES FERRMSGF.
  1095         10  FERRMSGA PIC  X(0001).
  1096     05  FERRMSGI PIC  X(0077).
  1097*    -------------------------------
  1098     05  FPFENTRL PIC S9(0004) COMP.
  1099     05  FPFENTRF PIC  X(0001).
  1100     05  FILLER REDEFINES FPFENTRF.
  1101         10  FPFENTRA PIC  X(0001).
  1102     05  FPFENTRI PIC  99.
  1103 01  EL127FO REDEFINES EL127FI.
  1104     05  FILLER            PIC  X(0012).
  1105*    -------------------------------
  1106     05  FILLER            PIC  X(0003).
  1107     05  FDATEO PIC  X(0008).
  1108*    -------------------------------
  1109     05  FILLER            PIC  X(0003).
  1110     05  FTIMEO PIC  99.99.
  1111*    -------------------------------
  1112     05  FILLER            PIC  X(0003).
  1113     05  CMPNYIDO PIC  X(0003).
  1114*    -------------------------------
  1115     05  FILLER            PIC  X(0003).
  1116     05  USERIDO PIC  X(0004).
  1117*    -------------------------------
  1118     05  FILLER            PIC  X(0003).
  1119     05  FMAINTO PIC  X(0001).
  1120*    -------------------------------
  1121     05  FILLER            PIC  X(0003).
  1122     05  FCERTO PIC  X(0010).
  1123*    -------------------------------
  1124     05  FILLER            PIC  X(0003).
  1125     05  FCRTSFXO PIC  X(0001).
  1126*    -------------------------------
  1127     05  FILLER            PIC  X(0003).
  1128     05  FACOUNTO PIC  X(0010).
  1129*    -------------------------------
  1130     05  FILLER            PIC  X(0003).
  1131     05  FSTO PIC  X(0002).
  1132*    -------------------------------
  1133     05  FILLER            PIC  X(0003).
  1134     05  FCARRIRO PIC  X(0001).
  1135*    -------------------------------
  1136     05  FILLER            PIC  X(0003).
  1137     05  FGROUPO PIC  X(0006).
  1138*    -------------------------------
  1139     05  FILLER            PIC  X(0003).
  1140     05  FEFFDTO PIC  X(0008).
  1141*    -------------------------------
  1142     05  FILLER            PIC  X(0003).
  1143     05  FBSTARTO PIC  99.
  1144*    -------------------------------
  1145     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1276.cbl
  1146     05  MAINTONO PIC  X(0008).
  1147*    -------------------------------
  1148     05  FILLER            PIC  X(0003).
  1149     05  MAINTATO PIC  99.99.
  1150*    -------------------------------
  1151     05  FILLER            PIC  X(0003).
  1152     05  MAINTBYO PIC  X(0004).
  1153*    -------------------------------
  1154     05  FILLER            PIC  X(0003).
  1155     05  FBENDO PIC  99.
  1156*    -------------------------------
  1157     05  FILLER            PIC  X(0003).
  1158     05  FCERTYNO PIC  X(0003).
  1159*    -------------------------------
  1160     05  FILLER            PIC  X(0003).
  1161     05  FCLMYNO PIC  X(0003).
  1162*    -------------------------------
  1163     05  FILLER            PIC  X(0003).
  1164     05  FNLINE1O PIC  X(0077).
  1165*    -------------------------------
  1166     05  FILLER            PIC  X(0003).
  1167     05  FNLINE2O PIC  X(0077).
  1168*    -------------------------------
  1169     05  FILLER            PIC  X(0003).
  1170     05  FNLINE3O PIC  X(0077).
  1171*    -------------------------------
  1172     05  FILLER            PIC  X(0003).
  1173     05  FNLINE4O PIC  X(0077).
  1174*    -------------------------------
  1175     05  FILLER            PIC  X(0003).
  1176     05  FNLINE5O PIC  X(0077).
  1177*    -------------------------------
  1178     05  FILLER            PIC  X(0003).
  1179     05  FNLINE6O PIC  X(0077).
  1180*    -------------------------------
  1181     05  FILLER            PIC  X(0003).
  1182     05  FNLINE7O PIC  X(0077).
  1183*    -------------------------------
  1184     05  FILLER            PIC  X(0003).
  1185     05  FNLINE8O PIC  X(0077).
  1186*    -------------------------------
  1187     05  FILLER            PIC  X(0003).
  1188     05  FNLINE9O PIC  X(0077).
  1189*    -------------------------------
  1190     05  FILLER            PIC  X(0003).
  1191     05  FNLINEAO PIC  X(0077).
  1192*    -------------------------------
  1193     05  FILLER            PIC  X(0003).
  1194     05  FERRMSGO PIC  X(0077).
  1195*    -------------------------------
  1196     05  FILLER            PIC  X(0003).
  1197     05  FPFENTRO PIC  X(0002).
  1198*    -------------------------------
  1199
  1200 01  FILLER REDEFINES EL127FO.
  1201     05  FILLER                      PIC X(155).
  1202     05  DNOTE-LINES   OCCURS 10 TIMES.
  1203         10  DNOTE-LINE-LENGTH       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1276.cbl
  1204         10  DNOTE-LINE-ATTRB        PIC X.
  1205         10  DNOTE-LINE              PIC X(77).
  1206     05  FILLER                      PIC X(85).
  1207
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1276.cbl
  1209
  1210****************************************************************
  1211*
  1212* Copyright (c) 2007 by Clerity Solutions, Inc.
  1213* All rights reserved.
  1214*
  1215****************************************************************
  1216 01  DFHEIV.
  1217   02  DFHEIV0               PIC X(35).
  1218   02  DFHEIV1               PIC X(08).
  1219   02  DFHEIV2               PIC X(08).
  1220   02  DFHEIV3               PIC X(08).
  1221   02  DFHEIV4               PIC X(06).
  1222   02  DFHEIV5               PIC X(04).
  1223   02  DFHEIV6               PIC X(04).
  1224   02  DFHEIV7               PIC X(02).
  1225   02  DFHEIV8               PIC X(02).
  1226   02  DFHEIV9               PIC X(01).
  1227   02  DFHEIV10              PIC S9(7) COMP-3.
  1228   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1229   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1230   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1231   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1232   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1233   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1234   02  DFHEIV17              PIC X(04).
  1235   02  DFHEIV18              PIC X(04).
  1236   02  DFHEIV19              PIC X(04).
  1237   02  DFHEIV20              USAGE IS POINTER.
  1238   02  DFHEIV21              USAGE IS POINTER.
  1239   02  DFHEIV22              USAGE IS POINTER.
  1240   02  DFHEIV23              USAGE IS POINTER.
  1241   02  DFHEIV24              USAGE IS POINTER.
  1242   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1243   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1244   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1245   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1246   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1247   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1248   02  FILLER                PIC X(02).
  1249   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1250   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1251   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1252   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1253   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1254 LINKAGE  SECTION.
  1255*****************************************************************
  1256*                                                               *
  1257* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1258* All rights reserved.                                          *
  1259*                                                               *
  1260*****************************************************************
  1261 01  dfheiblk.
  1262     02  eibtime          pic s9(7) comp-3.
  1263     02  eibdate          pic s9(7) comp-3.
  1264     02  eibtrnid         pic x(4).
  1265     02  eibtaskn         pic s9(7) comp-3.
  1266     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1276.cbl
  1267     02  dfheigdi         pic s9(4) comp.
  1268     02  eibcposn         pic s9(4) comp.
  1269     02  eibcalen         pic s9(4) comp.
  1270     02  eibaid           pic x(1).
  1271     02  eibfiller1       pic x(1).
  1272     02  eibfn            pic x(2).
  1273     02  eibfiller2       pic x(2).
  1274     02  eibrcode         pic x(6).
  1275     02  eibfiller3       pic x(2).
  1276     02  eibds            pic x(8).
  1277     02  eibreqid         pic x(8).
  1278     02  eibrsrce         pic x(8).
  1279     02  eibsync          pic x(1).
  1280     02  eibfree          pic x(1).
  1281     02  eibrecv          pic x(1).
  1282     02  eibsend          pic x(1).
  1283     02  eibatt           pic x(1).
  1284     02  eibeoc           pic x(1).
  1285     02  eibfmh           pic x(1).
  1286     02  eibcompl         pic x(1).
  1287     02  eibsig           pic x(1).
  1288     02  eibconf          pic x(1).
  1289     02  eiberr           pic x(1).
  1290     02  eibrldbk         pic x(1).
  1291     02  eiberrcd         pic x(4).
  1292     02  eibsynrb         pic x(1).
  1293     02  eibnodat         pic x(1).
  1294     02  eibfiller5       pic x(2).
  1295     02  eibresp          pic 9(09) comp.
  1296     02  eibresp2         pic 9(09) comp.
  1297     02  dfheigdj         pic s9(4) comp.
  1298     02  dfheigdk         pic s9(4) comp.
  1299 01  DFHCOMMAREA                     PIC X(1024).
  1300
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1276.cbl
  1302
  1303*    COPY ERCNOTE.
  1304******************************************************************
  1305*                                                                *
  1306*                                                                *
  1307*                            ERCNOTE                             *
  1308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1309*                            VMOD=2.003                          *
  1310*                                                                *
  1311*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  1312*                                                                *
  1313*        FILE TYPE= VSAM,KSDS                                    *
  1314*        RECORD SIZE = 825    RECFORM = FIXED                    *
  1315*                                                                *
  1316*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  1317*                                                                *
  1318*        LOG = YES                                               *
  1319*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1320*                                                                *
  1321******************************************************************
  1322*                   C H A N G E   L O G
  1323*
  1324* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1325*-----------------------------------------------------------------
  1326*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1327* EFFECTIVE    NUMBER
  1328*-----------------------------------------------------------------
  1329* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  1330*                                FILE WILL CONTAIN BILLING NOTES O
  1331******************************************************************
  1332
  1333 01  CERTIFICATE-NOTE.
  1334     12  CN-RECORD-ID                PIC  XX.
  1335         88  VALID-CN-ID                  VALUE 'CN'.
  1336
  1337     12  CN-CONTROL-PRIMARY.
  1338         16  CN-COMPANY-CD           PIC X.
  1339         16  CN-CARRIER              PIC X.
  1340         16  CN-GROUPING.
  1341             20 CN-GROUPING-PREFIX   PIC XXX.
  1342             20 CN-GROUPING-PRIME    PIC XXX.
  1343         16  CN-STATE                PIC XX.
  1344         16  CN-ACCOUNT.
  1345             20 CN-ACCOUNT-PREFIX    PIC X(4).
  1346             20 CN-ACCOUNT-PRIME     PIC X(6).
  1347         16  CN-CERT-EFF-DT          PIC XX.
  1348         16  CN-CERT-NO.
  1349             20  CN-CERT-PRIME       PIC X(10).
  1350             20  CN-CERT-SFX         PIC X.
  1351
  1352     12  CN-BILLING-START-LINE-NO    PIC 99.
  1353     12  CN-BILLING-END-LINE-NO      PIC 99.
  1354
  1355     12  CN-LINES.
  1356         16  CN-LINE OCCURS 10       PIC X(77).
  1357
  1358     12  CN-LAST-MAINT-DT            PIC XX.
  1359     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1276.cbl
  1360     12  CN-LAST-MAINT-USER          PIC X(4).
  1361     12  FILLER                      PIC X(6).
  1362******************************************************************
  1363
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1276.cbl
  1365
  1366*    COPY ELCCERT.
  1367******************************************************************
  1368*                                                                *
  1369*                            ELCCERT.                            *
  1370*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1371*                            VMOD=2.013                          *
  1372*                                                                *
  1373*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1374*                                                                *
  1375*   FILE TYPE = VSAM,KSDS                                        *
  1376*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1377*                                                                *
  1378*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1379*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1380*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1381*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1382*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1383*                                                                *
  1384*   LOG = YES                                                    *
  1385*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1386******************************************************************
  1387*                   C H A N G E   L O G
  1388*
  1389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1390*-----------------------------------------------------------------
  1391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1392* EFFECTIVE    NUMBER
  1393*-----------------------------------------------------------------
  1394* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1395* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1396* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1397* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1398* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1399* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1400* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1401******************************************************************
  1402
  1403 01  CERTIFICATE-MASTER.
  1404     12  CM-RECORD-ID                      PIC XX.
  1405         88  VALID-CM-ID                      VALUE 'CM'.
  1406
  1407     12  CM-CONTROL-PRIMARY.
  1408         16  CM-COMPANY-CD                 PIC X.
  1409         16  CM-CARRIER                    PIC X.
  1410         16  CM-GROUPING.
  1411             20  CM-GROUPING-PREFIX        PIC X(3).
  1412             20  CM-GROUPING-PRIME         PIC X(3).
  1413         16  CM-STATE                      PIC XX.
  1414         16  CM-ACCOUNT.
  1415             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1416             20  CM-ACCOUNT-PRIME          PIC X(6).
  1417         16  CM-CERT-EFF-DT                PIC XX.
  1418         16  CM-CERT-NO.
  1419             20  CM-CERT-PRIME             PIC X(10).
  1420             20  CM-CERT-SFX               PIC X.
  1421
  1422     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1276.cbl
  1423         16  CM-COMPANY-CD-A1              PIC X.
  1424         16  CM-INSURED-LAST-NAME          PIC X(15).
  1425         16  CM-INSURED-INITIALS.
  1426             20  CM-INSURED-INITIAL1       PIC X.
  1427             20  CM-INSURED-INITIAL2       PIC X.
  1428
  1429     12  CM-CONTROL-BY-SSN.
  1430         16  CM-COMPANY-CD-A2              PIC X.
  1431         16  CM-SOC-SEC-NO.
  1432             20  CM-SSN-STATE              PIC XX.
  1433             20  CM-SSN-ACCOUNT            PIC X(6).
  1434             20  CM-SSN-LN3.
  1435                 25  CM-INSURED-INITIALS-A2.
  1436                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1437                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1438                 25 CM-PART-LAST-NAME-A2         PIC X.
  1439
  1440     12  CM-CONTROL-BY-CERT-NO.
  1441         16  CM-COMPANY-CD-A4              PIC X.
  1442         16  CM-CERT-NO-A4                 PIC X(11).
  1443
  1444     12  CM-CONTROL-BY-MEMB.
  1445         16  CM-COMPANY-CD-A5              PIC X.
  1446         16  CM-MEMBER-NO.
  1447             20  CM-MEMB-STATE             PIC XX.
  1448             20  CM-MEMB-ACCOUNT           PIC X(6).
  1449             20  CM-MEMB-LN4.
  1450                 25  CM-INSURED-INITIALS-A5.
  1451                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1452                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1453                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1454
  1455     12  CM-INSURED-PROFILE-DATA.
  1456         16  CM-INSURED-FIRST-NAME.
  1457             20  CM-INSURED-1ST-INIT       PIC X.
  1458             20  FILLER                    PIC X(9).
  1459         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1460         16  CM-INSURED-SEX                PIC X.
  1461             88  CM-SEX-MALE                  VALUE 'M'.
  1462             88  CM-SEX-FEMAL                 VALUE 'F'.
  1463         16  CM-INSURED-JOINT-AGE          PIC 99.
  1464         16  CM-JOINT-INSURED-NAME.
  1465             20  CM-JT-LAST-NAME           PIC X(15).
  1466             20  CM-JT-FIRST-NAME.
  1467                 24  CM-JT-1ST-INIT        PIC X.
  1468                 24  FILLER                PIC X(9).
  1469             20  CM-JT-INITIAL             PIC X.
  1470
  1471     12  CM-LIFE-DATA.
  1472         16  CM-LF-BENEFIT-CD              PIC XX.
  1473         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1474         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1475         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1476         16  CM-LF-DEV-CODE                PIC XXX.
  1477         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1478         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1479         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1480         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1276.cbl
  1481         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1482         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1483         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1484         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1485         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1486         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1487         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1488         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1489         16  FILLER                        PIC XX.
  1490
  1491     12  CM-AH-DATA.
  1492         16  CM-AH-BENEFIT-CD              PIC XX.
  1493         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1494         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1495         16  CM-AH-DEV-CODE                PIC XXX.
  1496         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1497         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1498         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1499         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1500         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1501         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1502         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1503         16  CM-AH-PAID-THRU-DT            PIC XX.
  1504             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1505         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1506         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1507         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1508         16  FILLER                        PIC X.
  1509
  1510     12  CM-LOAN-INFORMATION.
  1511         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1512         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1513                                           PIC S9(5)V99  COMP-3.
  1514         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1515         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1516         16  CM-PAY-FREQUENCY              PIC S99.
  1517         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1518         16  CM-RATE-CLASS                 PIC XX.
  1519         16  CM-BENEFICIARY                PIC X(25).
  1520         16  CM-POLICY-FORM-NO             PIC X(12).
  1521         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1522         16  CM-LAST-ADD-ON-DT             PIC XX.
  1523         16  CM-DEDUCTIBLE-AMOUNTS.
  1524             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1525             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1526         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1527             20  CM-RESIDENT-STATE         PIC XX.
  1528             20  CM-RATE-CODE              PIC X(4).
  1529             20  FILLER                    PIC XX.
  1530         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1531             20  CM-LOAN-OFFICER           PIC X(5).
  1532             20  FILLER                    PIC XXX.
  1533         16  CM-CSR-CODE                   PIC XXX.
  1534         16  CM-UNDERWRITING-CODE          PIC X.
  1535             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1536         16  CM-POST-CARD-IND              PIC X.
  1537         16  CM-NH-INTERFACE-SW            PIC X.
  1538         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1276.cbl
  1539             88  CM-SING-PRM                  VALUE '1'.
  1540             88  CM-O-B-COVERAGE              VALUE '2'.
  1541             88  CM-OPEN-END                  VALUE '3'.
  1542         16  CM-IND-GRP-TYPE               PIC X.
  1543             88  CM-INDIVIDUAL                VALUE 'I'.
  1544             88  CM-GROUP                     VALUE 'G'.
  1545         16  CM-SKIP-CODE                  PIC X.
  1546             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1547             88  SKIP-JULY                    VALUE '1'.
  1548             88  SKIP-AUGUST                  VALUE '2'.
  1549             88  SKIP-SEPTEMBER               VALUE '3'.
  1550             88  SKIP-JULY-AUG                VALUE '4'.
  1551             88  SKIP-AUG-SEPT                VALUE '5'.
  1552             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1553             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1554             88  SKIP-JUNE                    VALUE '8'.
  1555             88  SKIP-JUNE-JULY               VALUE '9'.
  1556             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1557             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1558         16  CM-PAYMENT-MODE               PIC X.
  1559             88  PAY-MONTHLY                  VALUE SPACE.
  1560             88  PAY-WEEKLY                   VALUE '1'.
  1561             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1562             88  PAY-BI-WEEKLY                VALUE '3'.
  1563             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1564         16  CM-LOAN-NUMBER                PIC X(8).
  1565         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1566         16  CM-OLD-LOF                    PIC XXX.
  1567*        16  CM-LOAN-OFFICER               PIC XXX.
  1568         16  CM-REIN-TABLE                 PIC XXX.
  1569         16  CM-SPECIAL-REIN-CODE          PIC X.
  1570         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1571         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1572         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1573
  1574     12  CM-STATUS-DATA.
  1575         16  CM-ENTRY-STATUS               PIC X.
  1576         16  CM-ENTRY-DT                   PIC XX.
  1577
  1578         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1579         16  CM-LF-CANCEL-DT               PIC XX.
  1580         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1581
  1582         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1583         16  CM-LF-DEATH-DT                PIC XX.
  1584         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1585
  1586         16  CM-LF-CURRENT-STATUS          PIC X.
  1587             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1588                                                'M' '4' '5' '9'.
  1589             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1590             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1591             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1592             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1593             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1594             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1595             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1596             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1276.cbl
  1597             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1598             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1599             88  CM-LF-DECLINED               VALUE 'D'.
  1600             88  CM-LF-VOIDED                 VALUE 'V'.
  1601
  1602         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1603         16  CM-AH-CANCEL-DT               PIC XX.
  1604         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1605
  1606         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1607         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1608         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1609
  1610         16  CM-AH-CURRENT-STATUS          PIC X.
  1611             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1612                                                'M' '4' '5' '9'.
  1613             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1614             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1615             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1616             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1617             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1618             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1619             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1620             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1621             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1622             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1623             88  CM-AH-DECLINED               VALUE 'D'.
  1624             88  CM-AH-VOIDED                 VALUE 'V'.
  1625
  1626         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1627             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1628             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1629             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1630         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1631
  1632         16  CM-ENTRY-BATCH                PIC X(6).
  1633         16  CM-LF-EXIT-BATCH              PIC X(6).
  1634         16  CM-AH-EXIT-BATCH              PIC X(6).
  1635         16  CM-LAST-MONTH-END             PIC XX.
  1636
  1637     12  CM-NOTE-SW                        PIC X.
  1638         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1639         88  CERT-NOTES-PRESENT               VALUE '1'.
  1640         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1641         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1642         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1643         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1644         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1645         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1646     12  CM-COMP-EXCP-SW                   PIC X.
  1647         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1648         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1649     12  CM-INSURED-ADDRESS-SW             PIC X.
  1650         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1651         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1652
  1653*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1654     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1276.cbl
  1655     12  FILLER                            PIC X.
  1656
  1657*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1658     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1659     12  FILLER                            PIC X.
  1660*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1661     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1662
  1663     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1664         88  CERT-ADDED-BATCH                 VALUE ' '.
  1665         88  CERT-ADDED-ONLINE                VALUE '1'.
  1666         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1667         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1668         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1669     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1670         88  CERT-AS-LOADED                   VALUE ' '.
  1671         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1672         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1673         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1674         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1675         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1676         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1677         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1678
  1679     12  CM-ACCOUNT-COMM-PCTS.
  1680         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1681         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1682
  1683     12  CM-USER-FIELD                     PIC X.
  1684     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1685     12  CM-CLP-STATE                      PIC XX.
  1686     12  CM-USER-RESERVED                  PIC XXX.
  1687******************************************************************
  1688
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1276.cbl
  1690
  1691 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CERTIFICATE-NOTE
  1692                          CERTIFICATE-MASTER.
  1693 0000-DFHEXIT SECTION.
  1694     MOVE '9#                    $   ' TO DFHEIV0.
  1695     MOVE 'EL1276' TO DFHEIV1.
  1696     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1697
  1698     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1699     MOVE '5'                    TO  DC-OPTION-CODE.
  1700     PERFORM 9700-DATE-LINK.
  1701     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1702     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1703
  1704     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1705     MOVE 1                      TO  EMI-NUMBER-OF-LINES.
  1706     MOVE EIBTRMID               TO  QID-TERM.
  1707
  1708     IF EIBCALEN = 0
  1709         GO TO 8800-UNAUTHORIZED-ACCESS.
  1710
  1711     IF PI-CALLING-PROGRAM = PGM-1279
  1712         MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  1713     END-IF.
  1714
  1715     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1716         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1717             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1718             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1719             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1720             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1721             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1722             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1723             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1724             MOVE THIS-PGM TO PI-CALLING-PROGRAM
  1725         ELSE
  1726             MOVE PI-CALLING-PROGRAM   TO RETURN-FROM
  1727             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1728             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1729             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1730             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1731             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1732             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1733             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1734             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1735
  1736
  1737* EXEC CICS HANDLE AID
  1738*         CLEAR(9400-CLEAR)
  1739*    END-EXEC.
  1740*    MOVE '"&=                  V! " #00001732' TO DFHEIV0
  1741     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  1742     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  1743     MOVE X'2220233030303031373332' TO DFHEIV0(25:11)
  1744     CALL 'kxdfhei1' USING DFHEIV0
  1745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1746
  1747*     IF EIBAID = DFHCLEAR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1276.cbl
  1748*         GO TO 9400-CLEAR.
  1749
  1750     IF PI-PROCESSOR-ID = 'LGXX'
  1751         NEXT SENTENCE
  1752     ELSE
  1753
  1754* EXEC CICS READQ TS
  1755*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1756*            INTO    (SECURITY-CONTROL)
  1757*            LENGTH  (SC-COMM-LENGTH)
  1758*            ITEM    (SC-ITEM)
  1759*        END-EXEC
  1760*    MOVE '*$II   L              ''   #00001741' TO DFHEIV0
  1761     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1762     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1763     MOVE X'2020233030303031373431' TO DFHEIV0(25:11)
  1764     CALL 'kxdfhei1' USING DFHEIV0,
  1765           PI-SECURITY-TEMP-STORE-ID,
  1766           SECURITY-CONTROL,
  1767           SC-COMM-LENGTH,
  1768           SC-ITEM,
  1769           DFHEIV99,
  1770           DFHEIV99
  1771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1772         MOVE SC-CREDIT-DISPLAY (32)   TO  PI-DISPLAY-CAP
  1773         MOVE SC-CREDIT-UPDATE  (32)   TO  PI-MODIFY-CAP
  1774         IF NOT DISPLAY-CAP
  1775             MOVE 'READ'               TO  SM-READ
  1776             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1777             MOVE ER-0070              TO  EMI-ERROR
  1778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1779             GO TO 8100-SEND-INITIAL-MAP.
  1780
  1781     IF  EIBTRNID NOT = TRANS-ID
  1782         MOVE LOW-VALUES         TO  EL127FI
  1783         PERFORM 7000-FORMAT-SCREEN
  1784         GO TO 8100-SEND-INITIAL-MAP.
  1785
  1786
  1787* EXEC CICS    HANDLE    CONDITION
  1788*         PGMIDERR          (9600-PGMID-ERROR)
  1789*         ERROR             (9990-ABEND)
  1790*         END-EXEC.
  1791*    MOVE '"$L.                  ! # #00001761' TO DFHEIV0
  1792     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1794     MOVE X'2320233030303031373631' TO DFHEIV0(25:11)
  1795     CALL 'kxdfhei1' USING DFHEIV0
  1796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1797
  1798
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1276.cbl
  1800
  1801 0200-RECEIVE.
  1802     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1803         MOVE ER-0008            TO  EMI-ERROR
  1804         PERFORM 9900-ERROR-FORMAT
  1805         MOVE -1                 TO  FMAINTL
  1806         GO TO 8200-SEND-DATAONLY.
  1807
  1808
  1809* EXEC CICS RECEIVE
  1810*        MAP      (MAP-NAME)
  1811*        MAPSET   (MAPSET-NAME)
  1812*        INTO     (EL127FI)
  1813*    END-EXEC.
  1814     MOVE LENGTH OF
  1815      EL127FI
  1816       TO DFHEIV11
  1817*    MOVE '8"T I  L              ''   #00001775' TO DFHEIV0
  1818     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1819     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1820     MOVE X'2020233030303031373735' TO DFHEIV0(25:11)
  1821     CALL 'kxdfhei1' USING DFHEIV0,
  1822           MAP-NAME,
  1823           EL127FI,
  1824           DFHEIV11,
  1825           MAPSET-NAME,
  1826           DFHEIV99,
  1827           DFHEIV99
  1828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1829
  1830
  1831     IF FPFENTRL = 0
  1832         GO TO 0300-CHECK-PFKEYS.
  1833
  1834     IF EIBAID NOT = DFHENTER
  1835         MOVE ER-0004            TO  EMI-ERROR
  1836         GO TO 0320-INPUT-ERROR.
  1837
  1838     IF  FPFENTRI NUMERIC
  1839         IF  FPFENTRI = '12' OR '23' OR '24'
  1840             MOVE PF-VALUES (FPFENTRI)   TO  EIBAID
  1841         ELSE
  1842             MOVE ER-0029                TO  EMI-ERROR
  1843             GO TO 0320-INPUT-ERROR.
  1844
  1845 0300-CHECK-PFKEYS.
  1846     IF EIBAID = DFHPF23
  1847         GO TO 8810-PF23.
  1848
  1849     IF EIBAID = DFHPF24
  1850         GO TO 9200-RETURN-MAIN-MENU.
  1851
  1852     IF EIBAID = DFHPF12
  1853         GO TO 9500-PF12.
  1854
  1855     IF EIBAID = DFHPF5
  1856         MOVE PGM-1279         TO PGM-NAME
  1857         SET PI-CERT-NOTE     TO TRUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1276.cbl
  1858         GO TO 9300-XCTL
  1859     END-IF.
  1860
  1861     IF EIBAID = DFHPF6
  1862         MOVE PGM-1279         TO PGM-NAME
  1863         SET PI-CLAIM-NOTE     TO TRUE
  1864         GO TO 9300-XCTL
  1865     END-IF.
  1866
  1867     IF EIBAID = DFHENTER
  1868         GO TO 400-EDIT-INPUT-DATA.
  1869
  1870     MOVE ER-0029                TO  EMI-ERROR.
  1871
  1872 0320-INPUT-ERROR.
  1873     PERFORM 9900-ERROR-FORMAT.
  1874     MOVE AL-UNBON               TO  FPFENTRA.
  1875
  1876     IF FPFENTRL = 0
  1877         MOVE -1                 TO  FMAINTL
  1878     ELSE
  1879         MOVE -1                 TO  FPFENTRL.
  1880
  1881     GO TO 8200-SEND-DATAONLY.
  1882
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1276.cbl
  1884
  1885 400-EDIT-INPUT-DATA.
  1886     IF FMAINTI = 'A' OR 'C' OR 'D'
  1887         NEXT SENTENCE
  1888     ELSE
  1889         MOVE ER-0023            TO  EMI-ERROR
  1890         MOVE -1                 TO  FMAINTL
  1891         MOVE AL-UABON           TO  FMAINTA
  1892         PERFORM 9900-ERROR-FORMAT
  1893         GO TO 8200-SEND-DATAONLY.
  1894     IF NOT MODIFY-CAP
  1895        MOVE 'UPDATE'            TO SM-READ
  1896        PERFORM 9995-SECURITY-VIOLATION
  1897                                 THRU 9995-EXIT
  1898        MOVE ER-0070             TO EMI-ERROR
  1899        PERFORM 9900-ERROR-FORMAT
  1900                                 THRU 9900-EXIT
  1901        GO TO 8100-SEND-INITIAL-MAP
  1902     END-IF
  1903     IF FMAINTI = 'D'
  1904         GO TO 410-CHECK-ERRORS.
  1905
  1906     IF FBSTARTL GREATER THAN ZERO
  1907        IF FBSTARTI NOT NUMERIC
  1908            MOVE ER-2520         TO  EMI-ERROR
  1909            MOVE AL-UNBON        TO  FBSTARTA
  1910            MOVE -1              TO  FBSTARTL
  1911            PERFORM 9900-ERROR-FORMAT
  1912        ELSE
  1913            IF FBSTARTI LESS '01' OR GREATER '10'
  1914                MOVE ER-2520     TO  EMI-ERROR
  1915                MOVE -1          TO  FBSTARTL
  1916                PERFORM 9900-ERROR-FORMAT.
  1917
  1918     IF FBENDL GREATER THAN ZERO
  1919        IF FBENDI NOT NUMERIC
  1920            MOVE ER-2521         TO  EMI-ERROR
  1921            MOVE AL-UNBON        TO  FBENDA
  1922            MOVE -1              TO  FBENDL
  1923            PERFORM 9900-ERROR-FORMAT
  1924        ELSE
  1925            IF FBENDI LESS '01' OR GREATER '10'
  1926                MOVE ER-2521     TO  EMI-ERROR
  1927                MOVE -1          TO  FBENDL
  1928                PERFORM 9900-ERROR-FORMAT.
  1929
  1930     IF FBENDL GREATER THAN ZEROS
  1931        IF FBSTARTL = ZEROS
  1932            MOVE ER-2524         TO  EMI-ERROR
  1933            MOVE -1              TO  FBSTARTL
  1934            PERFORM 9900-ERROR-FORMAT
  1935            GO TO 410-CHECK-ERRORS.
  1936
  1937     IF FBSTARTL = ZERO OR
  1938        FBENDL   = ZERO
  1939           GO TO 410-CHECK-ERRORS.
  1940
  1941     IF FBSTARTI GREATER THAN FBENDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1276.cbl
  1942         MOVE ER-2522            TO  EMI-ERROR
  1943         MOVE -1                 TO  FBSTARTL
  1944         PERFORM 9900-ERROR-FORMAT.
  1945
  1946 410-CHECK-ERRORS.
  1947     IF EMI-ERROR = ZEROS
  1948        NEXT SENTENCE
  1949     ELSE
  1950         GO TO 8200-SEND-DATAONLY.
  1951
  1952     IF FMAINTI = 'A'
  1953         GO TO 1000-ADD-RECORD.
  1954
  1955     IF FMAINTI = 'C'
  1956         GO TO 2000-CHANGE-RECORD.
  1957
  1958     GO TO 3000-DELETE-RECORD.
  1959
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1276.cbl
  1961
  1962 1000-ADD-RECORD       SECTION.
  1963
  1964
  1965* EXEC CICS GETMAIN
  1966*        SET      (ADDRESS OF CERTIFICATE-NOTE)
  1967*        LENGTH   (825)
  1968*        INITIMG  (GETMAIN-SPACE)
  1969*    END-EXEC.
  1970     MOVE 825
  1971       TO DFHEIV11
  1972*    MOVE ',"IL                  $   #00001914' TO DFHEIV0
  1973     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1974     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1975     MOVE X'2020233030303031393134' TO DFHEIV0(25:11)
  1976     CALL 'kxdfhei1' USING DFHEIV0,
  1977           DFHEIV20,
  1978           DFHEIV11,
  1979           GETMAIN-SPACE
  1980     SET ADDRESS OF CERTIFICATE-NOTE TO
  1981         DFHEIV20
  1982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1983
  1984
  1985     MOVE  SPACES                TO  CERTIFICATE-NOTE.
  1986
  1987     MOVE  'CN'                  TO  CN-RECORD-ID.
  1988
  1989     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  1990     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  1991     MOVE  PI-STATE              TO  WS-CM-STATE.
  1992     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  1993     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  1994     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  1995     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  1996     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  1997
  1998     MOVE  WS-CM-CONTROL-PRIMARY TO  CN-CONTROL-PRIMARY.
  1999
  2000     IF FBSTARTL GREATER ZERO
  2001         MOVE FBSTARTI           TO  CN-BILLING-START-LINE-NO
  2002     ELSE
  2003         MOVE ZEROS              TO  CN-BILLING-START-LINE-NO.
  2004
  2005     IF FBENDL GREATER ZERO
  2006         MOVE FBENDI             TO  CN-BILLING-END-LINE-NO
  2007     ELSE
  2008         MOVE ZEROS              TO  CN-BILLING-END-LINE-NO.
  2009
  2010     IF FBENDL = ZEROS
  2011         IF FBSTARTL GREATER ZERO
  2012            MOVE FBSTARTI        TO  CN-BILLING-END-LINE-NO.
  2013
  2014     MOVE +0                     TO  WS-SUB1.
  2015
  2016 1100-BUILD-NOTE-LINES.
  2017     ADD +1                      TO  WS-SUB1.
  2018
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1276.cbl
  2019     IF WS-SUB1 GREATER +10
  2020        GO TO 1700-WRITE-RECORD.
  2021
  2022     IF DNOTE-LINE-LENGTH (WS-SUB1) GREATER ZERO
  2023         MOVE DNOTE-LINE   (WS-SUB1) TO  CN-LINE (WS-SUB1)
  2024         MOVE 'Y'                    TO  WS-NOTE-LINE-SW
  2025       ELSE
  2026         MOVE SPACES                 TO  CN-LINE (WS-SUB1).
  2027
  2028     GO TO 1100-BUILD-NOTE-LINES.
  2029
  2030 1700-WRITE-RECORD.
  2031     IF NOTE-LINES-PRESENT
  2032         NEXT SENTENCE
  2033     ELSE
  2034         MOVE ER-2523            TO  EMI-ERROR
  2035         MOVE -1                 TO  FMAINTL
  2036         PERFORM 9900-ERROR-FORMAT
  2037         GO TO 8200-SEND-DATAONLY.
  2038
  2039     MOVE PI-PROCESSOR-ID        TO  CN-LAST-MAINT-USER.
  2040     MOVE EIBTIME                TO  CN-LAST-MAINT-HHMMSS.
  2041     MOVE SAVE-BIN-DATE          TO  CN-LAST-MAINT-DT.
  2042
  2043     MOVE 'A'                    TO  JP-RECORD-TYPE.
  2044     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2045
  2046     PERFORM 6400-WRITE-NOTE-RECORD.
  2047
  2048     IF DUPLICATE-RECORD-FOUND
  2049         GO TO 1800-DUPLICATE-RECORD.
  2050
  2051     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2052             WS-ERNOTE-RECORD-LENGTH  +  23.
  2053
  2054     PERFORM 8400-LOG-JOURNAL-RECORD.
  2055     MOVE ER-0000                TO  EMI-ERROR.
  2056     PERFORM 9900-ERROR-FORMAT.
  2057     PERFORM 7000-FORMAT-SCREEN.
  2058     PERFORM 4000-CERTIFICATE-UPDATE.
  2059     GO TO 8100-SEND-INITIAL-MAP.
  2060
  2061 1800-DUPLICATE-RECORD.
  2062     MOVE ER-2525                TO  EMI-ERROR.
  2063     PERFORM 9900-ERROR-FORMAT.
  2064     PERFORM 7000-FORMAT-SCREEN.
  2065     GO TO 8100-SEND-INITIAL-MAP.
  2066
  2067 1900-EXIT.
  2068     EXIT.
  2069
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1276.cbl
  2071
  2072 2000-CHANGE-RECORD   SECTION.
  2073
  2074     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  2075     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  2076     MOVE  PI-STATE              TO  WS-CM-STATE.
  2077     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  2078     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  2079     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  2080     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  2081     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  2082
  2083     PERFORM 6300-READ-NOTE-FILE-UPDT.
  2084
  2085     IF RECORD-NOT-FOUND
  2086         GO TO 1000-ADD-RECORD.
  2087
  2088     MOVE 'B'                    TO  JP-RECORD-TYPE.
  2089     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2090
  2091     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2092             WS-ERNOTE-RECORD-LENGTH  +  23.
  2093
  2094     PERFORM 8400-LOG-JOURNAL-RECORD.
  2095
  2096     IF FBSTARTL GREATER ZERO
  2097         MOVE FBSTARTI           TO  CN-BILLING-START-LINE-NO
  2098     ELSE
  2099         MOVE ZEROS              TO  CN-BILLING-START-LINE-NO.
  2100
  2101     IF FBENDL GREATER ZERO
  2102         MOVE FBENDI             TO  CN-BILLING-END-LINE-NO
  2103     ELSE
  2104         MOVE ZEROS              TO  CN-BILLING-END-LINE-NO.
  2105
  2106     MOVE +0                     TO  WS-SUB1.
  2107
  2108 2100-BUILD-NOTE-LINES.
  2109     ADD +1                      TO  WS-SUB1.
  2110
  2111     IF WS-SUB1 GREATER 10
  2112        GO TO 2700-REWRITE-RECORD.
  2113
  2114     IF DNOTE-LINE-LENGTH (WS-SUB1) GREATER ZERO
  2115         MOVE DNOTE-LINE   (WS-SUB1) TO  CN-LINE (WS-SUB1)
  2116         MOVE 'Y'                    TO  WS-NOTE-LINE-SW
  2117     ELSE
  2118         MOVE SPACES                 TO  CN-LINE (WS-SUB1).
  2119
  2120     GO TO 2100-BUILD-NOTE-LINES.
  2121
  2122 2700-REWRITE-RECORD.
  2123     IF NOTE-LINES-PRESENT
  2124         NEXT SENTENCE
  2125     ELSE
  2126         MOVE ER-2523            TO  EMI-ERROR
  2127         MOVE -1                 TO  FMAINTL
  2128         PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1276.cbl
  2129         GO TO 8200-SEND-DATAONLY.
  2130
  2131     MOVE PI-PROCESSOR-ID        TO  CN-LAST-MAINT-USER.
  2132     MOVE EIBTIME                TO  CN-LAST-MAINT-HHMMSS.
  2133     MOVE SAVE-BIN-DATE          TO  CN-LAST-MAINT-DT.
  2134
  2135     MOVE 'C'                    TO  JP-RECORD-TYPE.
  2136     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2137
  2138     PERFORM 6500-REWRITE-NOTE-RECORD.
  2139
  2140     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2141             WS-ERNOTE-RECORD-LENGTH  +  23.
  2142
  2143     PERFORM 8400-LOG-JOURNAL-RECORD.
  2144
  2145     MOVE ER-0000                TO  EMI-ERROR.
  2146     PERFORM 9900-ERROR-FORMAT.
  2147     PERFORM 7000-FORMAT-SCREEN.
  2148     PERFORM 4000-CERTIFICATE-UPDATE.
  2149     GO TO 8100-SEND-INITIAL-MAP.
  2150
  2151 2900-EXIT.
  2152     EXIT.
  2153
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1276.cbl
  2155
  2156 3000-DELETE-RECORD    SECTION.
  2157
  2158     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  2159     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  2160     MOVE  PI-STATE              TO  WS-CM-STATE.
  2161     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  2162     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  2163     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  2164     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  2165     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  2166
  2167     PERFORM 6300-READ-NOTE-FILE-UPDT.
  2168
  2169     IF RECORD-NOT-FOUND
  2170        GO TO 3600-RECORD-PREVS-DELETED.
  2171
  2172     MOVE 'D'                    TO  JP-RECORD-TYPE.
  2173     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2174
  2175     PERFORM 6600-DELETE-NOTE-RECORD.
  2176
  2177     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2178             WS-ERNOTE-RECORD-LENGTH  +  23.
  2179
  2180     PERFORM 8400-LOG-JOURNAL-RECORD.
  2181     PERFORM 4000-CERTIFICATE-UPDATE.
  2182
  2183 3500-RECORD-DELETED.
  2184     MOVE SPACE                  TO  FMAINTO.
  2185     MOVE ER-0000                TO  EMI-ERROR.
  2186     MOVE -1                     TO  FMAINTL.
  2187     PERFORM 9900-ERROR-FORMAT.
  2188     GO TO 8200-SEND-DATAONLY.
  2189
  2190 3600-RECORD-PREVS-DELETED.
  2191     MOVE ER-2528                TO  EMI-ERROR.
  2192     MOVE -1                     TO  FMAINTL.
  2193     PERFORM 9900-ERROR-FORMAT.
  2194     GO TO 8200-SEND-DATAONLY.
  2195
  2196 3900-EXIT.
  2197     EXIT.
  2198
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1276.cbl
  2200
  2201 4000-CERTIFICATE-UPDATE         SECTION.
  2202
  2203
  2204* EXEC CICS HANDLE CONDITION
  2205*        NOTFND   (4400-NOT-FOUND)
  2206*    END-EXEC.
  2207*    MOVE '"$I                   ! $ #00002138' TO DFHEIV0
  2208     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2209     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2210     MOVE X'2420233030303032313338' TO DFHEIV0(25:11)
  2211     CALL 'kxdfhei1' USING DFHEIV0
  2212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2213
  2214
  2215
  2216* EXEC CICS READ
  2217*        EQUAL
  2218*        DATASET   (ELCERT-ID)
  2219*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  2220*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2221*        UPDATE
  2222*    END-EXEC.
  2223*    MOVE '&"S        EU         (   #00002142' TO DFHEIV0
  2224     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2225     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2226     MOVE X'2020233030303032313432' TO DFHEIV0(25:11)
  2227     CALL 'kxdfhei1' USING DFHEIV0,
  2228           ELCERT-ID,
  2229           DFHEIV20,
  2230           DFHEIV99,
  2231           WS-CM-CONTROL-PRIMARY,
  2232           DFHEIV99,
  2233           DFHEIV99,
  2234           DFHEIV99
  2235     SET ADDRESS OF CERTIFICATE-MASTER TO
  2236         DFHEIV20
  2237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2238
  2239
  2240     IF FMAINTI = 'D'
  2241       IF CM-NOTE-SW = '2'
  2242         MOVE SPACE              TO  CM-NOTE-SW
  2243       ELSE
  2244         IF CM-NOTE-SW = '3'
  2245            MOVE '1'             TO  CM-NOTE-SW
  2246         ELSE
  2247           IF CM-NOTE-SW = '6'
  2248              MOVE '4'           TO  CM-NOTE-SW
  2249           ELSE
  2250             IF CM-NOTE-SW = '7'
  2251                MOVE '5'         TO  CM-NOTE-SW
  2252             END-IF
  2253           END-IF
  2254         END-IF
  2255       END-IF
  2256       MOVE 'N'                  TO  PI-BILLING-NOTES-EXIST
  2257       GO TO 4200-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1276.cbl
  2258     END-IF.
  2259
  2260     IF CM-NOTE-SW = ' '
  2261         MOVE '2'                TO  CM-NOTE-SW
  2262     ELSE
  2263       IF CM-NOTE-SW = '1'
  2264          MOVE '3'               TO  CM-NOTE-SW
  2265       ELSE
  2266         IF CM-NOTE-SW = '4'
  2267            MOVE '6'             TO  CM-NOTE-SW
  2268         ELSE
  2269           IF CM-NOTE-SW = '5'
  2270              MOVE '7'           TO  CM-NOTE-SW
  2271           END-IF
  2272         END-IF
  2273       END-IF
  2274     END-IF.
  2275     MOVE 'Y'                    TO  PI-BILLING-NOTES-EXIST
  2276     GO TO 4200-REWRITE-CERT-MASTER.
  2277
  2278     MOVE 'B'                    TO  JP-RECORD-TYPE.
  2279     MOVE CERTIFICATE-MASTER     TO  JP-RECORD-AREA.
  2280
  2281     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2282             WS-ELCERT-RECORD-LENGTH  +  23.
  2283
  2284     PERFORM 8400-LOG-JOURNAL-RECORD.
  2285
  2286*00619      IF CN-BILLING-START-LINE-NO = ZERO
  2287*00620          MOVE '1'                TO  CM-NOTE-SW
  2288*00621          GO TO 4200-REWRITE-CERT-MASTER.
  2289*00622
  2290*00623      MOVE +0                     TO  WS-SUB1.
  2291*00624      MOVE +2                     TO  CM-NOTE-SW.
  2292*00625
  2293*00626  4100-CHECK-NOTE-LINE.
  2294*00627      ADD +1  TO  WS-SUB1.
  2295*00628
  2296*00629      IF WS-SUB1 GREATER +10
  2297*00630          GO TO 4200-REWRITE-CERT-MASTER.
  2298*00631
  2299*00632      IF WS-SUB1 LESS    CN-BILLING-START-LINE-NO  OR
  2300*00633                 GREATER CN-BILLING-END-LINE-NO
  2301*00634          NEXT SENTENCE
  2302*00635      ELSE
  2303*00636          GO TO 4100-CHECK-NOTE-LINE.
  2304*00637
  2305*00638      IF CN-LINE (WS-SUB1) GREATER THAN SPACES
  2306*00639          MOVE  3                 TO  CM-NOTE-SW
  2307*00640          GO TO 4200-REWRITE-CERT-MASTER
  2308*00641      ELSE
  2309*00642          GO TO 4100-CHECK-NOTE-LINE.
  2310
  2311 4200-REWRITE-CERT-MASTER.
  2312     MOVE 'C'                    TO  JP-RECORD-TYPE.
  2313     MOVE CERTIFICATE-MASTER     TO  JP-RECORD-AREA.
  2314
  2315
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1276.cbl
  2316* EXEC CICS REWRITE
  2317*        FROM      (CERTIFICATE-MASTER)
  2318*        DATASET   (ELCERT-ID)
  2319*    END-EXEC.
  2320     MOVE LENGTH OF
  2321      CERTIFICATE-MASTER
  2322       TO DFHEIV11
  2323*    MOVE '&& L                  %   #00002225' TO DFHEIV0
  2324     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2325     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2326     MOVE X'2020233030303032323235' TO DFHEIV0(25:11)
  2327     CALL 'kxdfhei1' USING DFHEIV0,
  2328           ELCERT-ID,
  2329           CERTIFICATE-MASTER,
  2330           DFHEIV11,
  2331           DFHEIV99
  2332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2333
  2334
  2335     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2336             WS-ELCERT-RECORD-LENGTH  +  23.
  2337
  2338     PERFORM 8400-LOG-JOURNAL-RECORD.
  2339
  2340     GO TO 4500-EXIT.
  2341
  2342 4400-NOT-FOUND.
  2343     MOVE -1                     TO  FMAINTL.
  2344     MOVE ER-0142                TO  EMI-ERROR.
  2345     PERFORM 9900-ERROR-FORMAT.
  2346     GO TO 8200-SEND-DATAONLY.
  2347
  2348 4500-EXIT.
  2349     EXIT.
  2350
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1276.cbl
  2352
  2353 6200-READ-NOTE-FILE             SECTION.
  2354
  2355
  2356* EXEC CICS HANDLE CONDITION
  2357*        NOTFND   (6250-NOT-FOUND)
  2358*    END-EXEC.
  2359*    MOVE '"$I                   ! % #00002250' TO DFHEIV0
  2360     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2362     MOVE X'2520233030303032323530' TO DFHEIV0(25:11)
  2363     CALL 'kxdfhei1' USING DFHEIV0
  2364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2365
  2366
  2367
  2368* EXEC CICS READ
  2369*        EQUAL
  2370*        DATASET   (ERNOTE-ID)
  2371*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  2372*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2373*    END-EXEC.
  2374*    MOVE '&"S        E          (   #00002254' TO DFHEIV0
  2375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2377     MOVE X'2020233030303032323534' TO DFHEIV0(25:11)
  2378     CALL 'kxdfhei1' USING DFHEIV0,
  2379           ERNOTE-ID,
  2380           DFHEIV20,
  2381           DFHEIV99,
  2382           WS-CM-CONTROL-PRIMARY,
  2383           DFHEIV99,
  2384           DFHEIV99,
  2385           DFHEIV99
  2386     SET ADDRESS OF CERTIFICATE-NOTE TO
  2387         DFHEIV20
  2388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2389
  2390
  2391     GO TO 6290-EXIT.
  2392
  2393 6250-NOT-FOUND.
  2394     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2395
  2396 6290-EXIT.
  2397      EXIT.
  2398
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1276.cbl
  2400
  2401 6300-READ-NOTE-FILE-UPDT        SECTION.
  2402
  2403
  2404* EXEC CICS HANDLE CONDITION
  2405*        NOTFND   (6350-NOT-FOUND)
  2406*    END-EXEC.
  2407*    MOVE '"$I                   ! & #00002273' TO DFHEIV0
  2408     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2410     MOVE X'2620233030303032323733' TO DFHEIV0(25:11)
  2411     CALL 'kxdfhei1' USING DFHEIV0
  2412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2413
  2414
  2415
  2416* EXEC CICS READ
  2417*        EQUAL
  2418*        DATASET   (ERNOTE-ID)
  2419*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  2420*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2421*        UPDATE
  2422*    END-EXEC.
  2423*    MOVE '&"S        EU         (   #00002277' TO DFHEIV0
  2424     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2425     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2426     MOVE X'2020233030303032323737' TO DFHEIV0(25:11)
  2427     CALL 'kxdfhei1' USING DFHEIV0,
  2428           ERNOTE-ID,
  2429           DFHEIV20,
  2430           DFHEIV99,
  2431           WS-CM-CONTROL-PRIMARY,
  2432           DFHEIV99,
  2433           DFHEIV99,
  2434           DFHEIV99
  2435     SET ADDRESS OF CERTIFICATE-NOTE TO
  2436         DFHEIV20
  2437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2438
  2439
  2440        GO TO 6390-EXIT.
  2441
  2442 6350-NOT-FOUND.
  2443     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2444
  2445 6390-EXIT.
  2446      EXIT.
  2447
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1276.cbl
  2449
  2450 6400-WRITE-NOTE-RECORD          SECTION.
  2451
  2452
  2453* EXEC CICS HANDLE CONDITION
  2454*        DUPREC   (6450-DUPLICATE-RECORD)
  2455*    END-EXEC.
  2456*    MOVE '"$%                   ! '' #00002297' TO DFHEIV0
  2457     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  2458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2459     MOVE X'2720233030303032323937' TO DFHEIV0(25:11)
  2460     CALL 'kxdfhei1' USING DFHEIV0
  2461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2462
  2463
  2464
  2465* EXEC CICS WRITE
  2466*        FROM      (CERTIFICATE-NOTE)
  2467*        DATASET   (ERNOTE-ID)
  2468*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2469*    END-EXEC.
  2470     MOVE LENGTH OF
  2471      CERTIFICATE-NOTE
  2472       TO DFHEIV11
  2473*    MOVE '&$ L                  ''   #00002301' TO DFHEIV0
  2474     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2475     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2476     MOVE X'2020233030303032333031' TO DFHEIV0(25:11)
  2477     CALL 'kxdfhei1' USING DFHEIV0,
  2478           ERNOTE-ID,
  2479           CERTIFICATE-NOTE,
  2480           DFHEIV11,
  2481           WS-CM-CONTROL-PRIMARY,
  2482           DFHEIV99,
  2483           DFHEIV99
  2484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2485
  2486
  2487        GO TO 6490-EXIT.
  2488
  2489 6450-DUPLICATE-RECORD.
  2490     MOVE 'Y'                    TO  WS-DUPREC-SW.
  2491
  2492 6490-EXIT.
  2493     EXIT.
  2494
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1276.cbl
  2496
  2497 6500-REWRITE-NOTE-RECORD        SECTION.
  2498
  2499
  2500* EXEC CICS REWRITE
  2501*        FROM      (CERTIFICATE-NOTE)
  2502*        DATASET   (ERNOTE-ID)
  2503*    END-EXEC.
  2504     MOVE LENGTH OF
  2505      CERTIFICATE-NOTE
  2506       TO DFHEIV11
  2507*    MOVE '&& L                  %   #00002319' TO DFHEIV0
  2508     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2509     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2510     MOVE X'2020233030303032333139' TO DFHEIV0(25:11)
  2511     CALL 'kxdfhei1' USING DFHEIV0,
  2512           ERNOTE-ID,
  2513           CERTIFICATE-NOTE,
  2514           DFHEIV11,
  2515           DFHEIV99
  2516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2517
  2518
  2519
  2520 6590-EXIT.
  2521     EXIT.
  2522
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1276.cbl
  2524
  2525 6600-DELETE-NOTE-RECORD         SECTION.
  2526
  2527
  2528* EXEC CICS HANDLE CONDITION
  2529*        NOTFND (6650-RECORD-PREVS-DELETED)
  2530*    END-EXEC.
  2531*    MOVE '"$I                   ! ( #00002332' TO DFHEIV0
  2532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2534     MOVE X'2820233030303032333332' TO DFHEIV0(25:11)
  2535     CALL 'kxdfhei1' USING DFHEIV0
  2536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2537
  2538
  2539
  2540* EXEC CICS DELETE
  2541*        DATASET   (ERNOTE-ID)
  2542*    END-EXEC.
  2543*    MOVE '&(                    &   #00002336' TO DFHEIV0
  2544     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2545     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2546     MOVE X'2020233030303032333336' TO DFHEIV0(25:11)
  2547     CALL 'kxdfhei1' USING DFHEIV0,
  2548           ERNOTE-ID,
  2549           DFHEIV99,
  2550           DFHEIV99,
  2551           DFHEIV99,
  2552           DFHEIV99
  2553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2554
  2555
  2556     GO TO 6690-EXIT.
  2557
  2558 6650-RECORD-PREVS-DELETED.
  2559     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2560
  2561 6690-EXIT.
  2562     EXIT.
  2563
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1276.cbl
  2565
  2566 7000-FORMAT-SCREEN              SECTION.
  2567
  2568     MOVE LOW-VALUES             TO  EL127FI.
  2569
  2570     MOVE  PI-CARRIER            TO  FCARRIRO.
  2571     MOVE  PI-GROUPING           TO  FGROUPO.
  2572     MOVE  PI-STATE              TO  FSTO
  2573     MOVE  PI-ACCOUNT            TO  FACOUNTO.
  2574     MOVE  PI-CERT-PRIME         TO  FCERTO.
  2575     MOVE  PI-CERT-SFX           TO  FCRTSFXO.
  2576     MOVE  ' '                   TO  DC-OPTION-CODE.
  2577     MOVE  PI-CERT-EFF-DT        TO  DC-BIN-DATE-1.
  2578     PERFORM 9700-DATE-LINK.
  2579     MOVE DC-GREG-DATE-1-EDIT    TO  FEFFDTO.
  2580     IF PI-CERT-NOTES-EXIST EQUAL 'Y'
  2581         MOVE 'YES'              TO  FCERTYNO
  2582     ELSE
  2583         MOVE 'NO '              TO  FCERTYNO
  2584     END-IF.
  2585     IF PI-CLAIM-NOTES-EXIST EQUAL 'Y'
  2586         MOVE 'YES'              TO  FCLMYNO
  2587     ELSE
  2588         MOVE 'NO '              TO  FCLMYNO
  2589     END-IF.
  2590
  2591     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  2592     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  2593     MOVE  PI-STATE              TO  WS-CM-STATE.
  2594     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  2595     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  2596     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  2597     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  2598     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  2599
  2600     PERFORM 6200-READ-NOTE-FILE.
  2601
  2602     IF RECORD-NOT-FOUND
  2603        MOVE 'A'                 TO  FMAINTI
  2604        MOVE AL-UANON            TO  FMAINTA
  2605        GO TO 7900-EXIT.
  2606
  2607     MOVE 'C'                    TO  FMAINTO.
  2608     MOVE AL-UANON               TO  FMAINTA.
  2609
  2610     IF CN-LAST-MAINT-DT = SPACES
  2611         MOVE EIBTIME            TO  CN-LAST-MAINT-HHMMSS
  2612         MOVE SAVE-BIN-DATE      TO  CN-LAST-MAINT-DT.
  2613
  2614     IF CN-LAST-MAINT-DT NOT = SPACES AND LOW-VALUES
  2615         MOVE  ' '               TO  DC-OPTION-CODE
  2616         MOVE  CN-LAST-MAINT-DT  TO  DC-BIN-DATE-1
  2617         PERFORM 9700-DATE-LINK
  2618         MOVE DC-GREG-DATE-1-EDIT TO  MAINTONO.
  2619
  2620     IF CN-LAST-MAINT-HHMMSS NUMERIC
  2621         MOVE CN-LAST-MAINT-HHMMSS TO TIME-IN
  2622         MOVE TIME-OUT             TO MAINTATO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1276.cbl
  2623       ELSE
  2624         MOVE ZEROS                TO TIME-IN
  2625         MOVE TIME-OUT             TO MAINTATO.
  2626
  2627     MOVE CN-LAST-MAINT-USER       TO MAINTBYO.
  2628
  2629     IF CN-BILLING-START-LINE-NO GREATER THAN ZEROS
  2630         MOVE CN-BILLING-START-LINE-NO   TO  FBSTARTO
  2631         MOVE AL-UNNON                   TO  FBSTARTA.
  2632
  2633     IF CN-BILLING-END-LINE-NO GREATER THAN ZEROS
  2634         MOVE CN-BILLING-END-LINE-NO     TO  FBENDO
  2635         MOVE AL-UNNON                   TO  FBENDA.
  2636
  2637     MOVE +0                     TO  WS-SUB1.
  2638
  2639 7100-BUILD-NOTE-LINES.
  2640     ADD +1 TO  WS-SUB1.
  2641
  2642     IF WS-SUB1 GREATER THAN +10
  2643        GO TO 7900-EXIT.
  2644
  2645     MOVE  CN-LINE (WS-SUB1)     TO  DNOTE-LINE       (WS-SUB1).
  2646     MOVE  AL-UANON              TO  DNOTE-LINE-ATTRB (WS-SUB1).
  2647
  2648     GO TO 7100-BUILD-NOTE-LINES.
  2649
  2650 7900-EXIT.
  2651     EXIT.
  2652
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1276.cbl
  2654
  2655 8100-SEND-INITIAL-MAP SECTION.
  2656
  2657     MOVE SAVE-DATE              TO  FDATEO.
  2658     MOVE EIBTIME                TO  TIME-IN.
  2659     MOVE TIME-OUT               TO  FTIMEO.
  2660     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2661     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2662     MOVE -1                     TO  FMAINTL.
  2663     MOVE EMI-MESSAGE-AREA (1)   TO  FERRMSGO.
  2664
  2665* EXEC CICS SEND
  2666*        MAP      (MAP-NAME)
  2667*        MAPSET   (MAPSET-NAME)
  2668*        FROM     (EL127FO)
  2669*        ERASE
  2670*        CURSOR
  2671*    END-EXEC.
  2672     MOVE LENGTH OF
  2673      EL127FO
  2674       TO DFHEIV12
  2675     MOVE -1
  2676       TO DFHEIV11
  2677*    MOVE '8$     CT  E    H L F ,   #00002448' TO DFHEIV0
  2678     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2679     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2680     MOVE X'2020233030303032343438' TO DFHEIV0(25:11)
  2681     CALL 'kxdfhei1' USING DFHEIV0,
  2682           MAP-NAME,
  2683           EL127FO,
  2684           DFHEIV12,
  2685           MAPSET-NAME,
  2686           DFHEIV99,
  2687           DFHEIV99,
  2688           DFHEIV99,
  2689           DFHEIV11,
  2690           DFHEIV99,
  2691           DFHEIV99,
  2692           DFHEIV99
  2693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2694
  2695
  2696     GO TO 9100-RETURN-TRAN.
  2697
  2698 8200-SEND-DATAONLY     SECTION.
  2699
  2700     MOVE SAVE-DATE              TO  FDATEO.
  2701     MOVE EIBTIME                TO  TIME-IN.
  2702     MOVE TIME-OUT               TO  FTIMEO.
  2703     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2704     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2705     MOVE EMI-MESSAGE-AREA (1)   TO  FERRMSGO.
  2706
  2707* EXEC CICS SEND
  2708*        MAP      (MAP-NAME)
  2709*        MAPSET   (MAPSET-NAME)
  2710*        FROM     (EL127FO)
  2711*        DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1276.cbl
  2712*        ERASEAUP
  2713*        CURSOR
  2714*    END-EXEC.
  2715     MOVE LENGTH OF
  2716      EL127FO
  2717       TO DFHEIV12
  2718     MOVE -1
  2719       TO DFHEIV11
  2720*    MOVE '8$D    CT  A    H L F ,   #00002466' TO DFHEIV0
  2721     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  2722     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2723     MOVE X'2020233030303032343636' TO DFHEIV0(25:11)
  2724     CALL 'kxdfhei1' USING DFHEIV0,
  2725           MAP-NAME,
  2726           EL127FO,
  2727           DFHEIV12,
  2728           MAPSET-NAME,
  2729           DFHEIV99,
  2730           DFHEIV99,
  2731           DFHEIV99,
  2732           DFHEIV11,
  2733           DFHEIV99,
  2734           DFHEIV99,
  2735           DFHEIV99
  2736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2737
  2738
  2739     GO TO 9100-RETURN-TRAN.
  2740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1276.cbl
  2742
  2743 8300-SEND-TEXT         SECTION.
  2744
  2745* EXEC CICS SEND TEXT
  2746*        FROM     (LOGOFF-TEXT)
  2747*        LENGTH   (LOGOFF-LENGTH)
  2748*        ERASE
  2749*        FREEKB
  2750*    END-EXEC.
  2751*    MOVE '8&      T  E F  H   F -   #00002480' TO DFHEIV0
  2752     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2753     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2754     MOVE X'2020233030303032343830' TO DFHEIV0(25:11)
  2755     CALL 'kxdfhei1' USING DFHEIV0,
  2756           LOGOFF-TEXT,
  2757           LOGOFF-LENGTH,
  2758           DFHEIV99,
  2759           DFHEIV99,
  2760           DFHEIV99,
  2761           DFHEIV99,
  2762           DFHEIV99,
  2763           DFHEIV99,
  2764           DFHEIV99,
  2765           DFHEIV99,
  2766           DFHEIV99,
  2767           DFHEIV99
  2768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2769
  2770
  2771
  2772* EXEC CICS RETURN
  2773*    END-EXEC.
  2774*    MOVE '.(                    &   #00002487' TO DFHEIV0
  2775     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2777     MOVE X'2020233030303032343837' TO DFHEIV0(25:11)
  2778     CALL 'kxdfhei1' USING DFHEIV0,
  2779           DFHEIV99,
  2780           DFHEIV99,
  2781           DFHEIV99,
  2782           DFHEIV99,
  2783           DFHEIV99
  2784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2785
  2786
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1276.cbl
  2788
  2789 8400-LOG-JOURNAL-RECORD         SECTION.
  2790
  2791*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2792*    MOVE ERNOTE-ID              TO  JP-FILE-ID.
  2793*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2794*    EXEC CICS JOURNAL
  2795*        JFILEID     (PI-JOURNAL-FILE-ID)
  2796*        JTYPEID     ('ER')
  2797*        FROM        (JOURNAL-RECORD)
  2798*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  2799*    END-EXEC.
  2800
  2801 8400-EXIT.
  2802     EXIT.
  2803
  2804 8600-DEEDIT           SECTION.
  2805
  2806* EXEC CICS BIF DEEDIT
  2807*         FIELD   (DEEDIT-FIELD)
  2808*         LENGTH  (15)
  2809*    END-EXEC.
  2810     MOVE 15
  2811       TO DFHEIV11
  2812*    MOVE '@"L                   #   #00002508' TO DFHEIV0
  2813     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2814     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2815     MOVE X'2020233030303032353038' TO DFHEIV0(25:11)
  2816     CALL 'kxdfhei1' USING DFHEIV0,
  2817           DEEDIT-FIELD,
  2818           DFHEIV11
  2819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2820
  2821
  2822 8800-UNAUTHORIZED-ACCESS        SECTION.
  2823     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  2824     GO TO 8300-SEND-TEXT.
  2825
  2826 8810-PF23              SECTION.
  2827     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2828     MOVE XCTL-005               TO  PGM-NAME.
  2829     GO TO 9300-XCTL.
  2830
  2831 9100-RETURN-TRAN       SECTION.
  2832     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2833     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2834
  2835* EXEC CICS RETURN
  2836*        TRANSID    (TRANS-ID)
  2837*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2838*        LENGTH     (PI-COMM-LENGTH)
  2839*    END-EXEC.
  2840*    MOVE '.(CT                  &   #00002525' TO DFHEIV0
  2841     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2842     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2843     MOVE X'2020233030303032353235' TO DFHEIV0(25:11)
  2844     CALL 'kxdfhei1' USING DFHEIV0,
  2845           TRANS-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL1276.cbl
  2846           PROGRAM-INTERFACE-BLOCK,
  2847           PI-COMM-LENGTH,
  2848           DFHEIV99,
  2849           DFHEIV99
  2850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2851
  2852
  2853 9200-RETURN-MAIN-MENU SECTION.
  2854     MOVE XCTL-626               TO  PGM-NAME.
  2855     GO TO 9300-XCTL.
  2856
  2857 9300-XCTL             SECTION.
  2858
  2859* EXEC CICS XCTL
  2860*        PROGRAM    (PGM-NAME)
  2861*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2862*        LENGTH     (PI-COMM-LENGTH)
  2863*    END-EXEC.
  2864*    MOVE '.$C                   $   #00002536' TO DFHEIV0
  2865     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2866     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2867     MOVE X'2020233030303032353336' TO DFHEIV0(25:11)
  2868     CALL 'kxdfhei1' USING DFHEIV0,
  2869           PGM-NAME,
  2870           PROGRAM-INTERFACE-BLOCK,
  2871           PI-COMM-LENGTH
  2872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2873
  2874
  2875 9400-CLEAR            SECTION.
  2876     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  2877     GO TO 9300-XCTL.
  2878
  2879 9500-PF12             SECTION.
  2880     MOVE XCTL-010               TO  PGM-NAME.
  2881     GO TO 9300-XCTL.
  2882
  2883 9600-PGMID-ERROR      SECTION.
  2884
  2885* EXEC CICS HANDLE CONDITION
  2886*        PGMIDERR    (8300-SEND-TEXT)
  2887*    END-EXEC.
  2888*    MOVE '"$L                   ! ) #00002551' TO DFHEIV0
  2889     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2891     MOVE X'2920233030303032353531' TO DFHEIV0(25:11)
  2892     CALL 'kxdfhei1' USING DFHEIV0
  2893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2894
  2895
  2896     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  2897     MOVE ' '                    TO  PI-ENTRY-CD-1.
  2898     MOVE XCTL-005               TO  PGM-NAME.
  2899     MOVE PGM-NAME               TO  LOGOFF-PGM.
  2900     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2901     GO TO 9300-XCTL.
  2902
  2903 9700-DATE-LINK         SECTION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL1276.cbl
  2904     MOVE LINK-ELDATCV           TO  PGM-NAME
  2905
  2906* EXEC CICS LINK
  2907*        PROGRAM    (PGM-NAME)
  2908*        COMMAREA   (DATE-CONVERSION-DATA)
  2909*        LENGTH     (DC-COMM-LENGTH)
  2910*    END-EXEC.
  2911*    MOVE '."C                   ''   #00002564' TO DFHEIV0
  2912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2914     MOVE X'2020233030303032353634' TO DFHEIV0(25:11)
  2915     CALL 'kxdfhei1' USING DFHEIV0,
  2916           PGM-NAME,
  2917           DATE-CONVERSION-DATA,
  2918           DC-COMM-LENGTH,
  2919           DFHEIV99,
  2920           DFHEIV99,
  2921           DFHEIV99
  2922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2923
  2924
  2925 9900-ERROR-FORMAT       SECTION.
  2926     IF NOT EMI-ERRORS-COMPLETE
  2927         MOVE LINK-001           TO  PGM-NAME
  2928
  2929* EXEC CICS LINK
  2930*            PROGRAM    (PGM-NAME)
  2931*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2932*            LENGTH     (EMI-COMM-LENGTH)
  2933*        END-EXEC.
  2934*    MOVE '."C                   ''   #00002573' TO DFHEIV0
  2935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2937     MOVE X'2020233030303032353733' TO DFHEIV0(25:11)
  2938     CALL 'kxdfhei1' USING DFHEIV0,
  2939           PGM-NAME,
  2940           ERROR-MESSAGE-INTERFACE-BLOCK,
  2941           EMI-COMM-LENGTH,
  2942           DFHEIV99,
  2943           DFHEIV99,
  2944           DFHEIV99
  2945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2946
  2947
  2948 9900-EXIT.
  2949     EXIT.
  2950
  2951 9990-ABEND             SECTION.
  2952     MOVE LINK-004               TO  PGM-NAME.
  2953     MOVE DFHEIBLK               TO  EMI-LINE1
  2954
  2955
  2956* EXEC CICS LINK
  2957*        PROGRAM   (PGM-NAME)
  2958*        COMMAREA  (EMI-LINE1)
  2959*        LENGTH    (72)
  2960*    END-EXEC.
  2961     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL1276.cbl
  2962       TO DFHEIV11
  2963*    MOVE '."C                   ''   #00002586' TO DFHEIV0
  2964     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2966     MOVE X'2020233030303032353836' TO DFHEIV0(25:11)
  2967     CALL 'kxdfhei1' USING DFHEIV0,
  2968           PGM-NAME,
  2969           EMI-LINE1,
  2970           DFHEIV11,
  2971           DFHEIV99,
  2972           DFHEIV99,
  2973           DFHEIV99
  2974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2975
  2976
  2977     MOVE -1                     TO  FMAINTL.
  2978     GO TO 8200-SEND-DATAONLY.
  2979
  2980 9995-SECURITY-VIOLATION.
  2981*    COPY ELCSCTP.
  2982******************************************************************
  2983*                                                                *
  2984*                            ELCSCTP                             *
  2985*                            VMOD=2.001                          *
  2986*                                                                *
  2987*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2988******************************************************************
  2989
  2990
  2991     MOVE EIBDATE          TO SM-JUL-DATE.
  2992     MOVE EIBTRMID         TO SM-TERMID.
  2993     MOVE THIS-PGM         TO SM-PGM.
  2994     MOVE EIBTIME          TO TIME-IN.
  2995     MOVE TIME-OUT         TO SM-TIME.
  2996     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2997
  2998
  2999* EXEC CICS LINK
  3000*         PROGRAM  ('EL003')
  3001*         COMMAREA (SECURITY-MESSAGE)
  3002*         LENGTH   (80)
  3003*    END-EXEC.
  3004     MOVE 'EL003' TO DFHEIV1
  3005     MOVE 80
  3006       TO DFHEIV11
  3007*    MOVE '."C                   ''   #00002613' TO DFHEIV0
  3008     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3010     MOVE X'2020233030303032363133' TO DFHEIV0(25:11)
  3011     CALL 'kxdfhei1' USING DFHEIV0,
  3012           DFHEIV1,
  3013           SECURITY-MESSAGE,
  3014           DFHEIV11,
  3015           DFHEIV99,
  3016           DFHEIV99,
  3017           DFHEIV99
  3018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3019
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL1276.cbl
  3020
  3021******************************************************************
  3022
  3023
  3024 9995-EXIT.
  3025     EXIT.
  3026
  3027
  3028 9999-DFHBACK SECTION.
  3029     MOVE '9%                    "   ' TO DFHEIV0
  3030     MOVE 'EL1276' TO DFHEIV1
  3031     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3032     GOBACK.
  3033 9999-DFHEXIT.
  3034     IF DFHEIGDJ EQUAL 0001
  3035         NEXT SENTENCE
  3036     ELSE IF DFHEIGDJ EQUAL 2
  3037         GO TO 9400-CLEAR
  3038         DEPENDING ON DFHEIGDI
  3039     ELSE IF DFHEIGDJ EQUAL 3
  3040         GO TO 9600-PGMID-ERROR,
  3041               9990-ABEND
  3042         DEPENDING ON DFHEIGDI
  3043     ELSE IF DFHEIGDJ EQUAL 4
  3044         GO TO 4400-NOT-FOUND
  3045         DEPENDING ON DFHEIGDI
  3046     ELSE IF DFHEIGDJ EQUAL 5
  3047         GO TO 6250-NOT-FOUND
  3048         DEPENDING ON DFHEIGDI
  3049     ELSE IF DFHEIGDJ EQUAL 6
  3050         GO TO 6350-NOT-FOUND
  3051         DEPENDING ON DFHEIGDI
  3052     ELSE IF DFHEIGDJ EQUAL 7
  3053         GO TO 6450-DUPLICATE-RECORD
  3054         DEPENDING ON DFHEIGDI
  3055     ELSE IF DFHEIGDJ EQUAL 8
  3056         GO TO 6650-RECORD-PREVS-DELETED
  3057         DEPENDING ON DFHEIGDI
  3058     ELSE IF DFHEIGDJ EQUAL 9
  3059         GO TO 8300-SEND-TEXT
  3060         DEPENDING ON DFHEIGDI.
  3061     MOVE '9%                    "   ' TO DFHEIV0
  3062     MOVE 'EL1276' TO DFHEIV1
  3063     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3064     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5084     Code:        7122
