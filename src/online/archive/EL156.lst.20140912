* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56******************************************************************
    57
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL156.cbl
    59 ENVIRONMENT DIVISION.
    60
    61 DATA DIVISION.
    62
    63 WORKING-STORAGE SECTION.
    64 01  DFH-START PIC X(04).
    65
    66 77  FILLER  PIC X(32)  VALUE '********************************'.
    67 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    68 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    69 77  WS-SSN  PIC X(9) VALUE ZEROS.
    70 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    71 77  C0                          PIC S999 COMP-3 VALUE +0.
    72 77  C1                          PIC S999 COMP-3 VALUE +0.
    73 77  C2                          PIC S999 COMP-3 VALUE +0.
    74 77  C3                          PIC S999 COMP-3 VALUE +0.
    75 77  s1                          PIC S999 COMP-3 VALUE +0.
    76 77  s2                          pic s999 comp-3 value +0.
    77 77  P1                          PIC S999 COMP-3 VALUE +0.
    78 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    79 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    80 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    81 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    82 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    83 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    84 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    85 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    86 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    87 77  ws-max-bens                 pic s999 comp-3 value +0.
    88 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    89 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    90 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    91 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    92 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    93
    94*    COPY ELCSCTM.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCSCTM                             *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   102*                                                                *
   103******************************************************************
   104 01  SECURITY-MESSAGE.
   105     12  FILLER                          PIC X(30)
   106            VALUE '** LOGIC SECURITY VIOLATION -'.
   107     12  SM-READ                         PIC X(6).
   108     12  FILLER                          PIC X(5)
   109            VALUE ' PGM='.
   110     12  SM-PGM                          PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' OPR='.
   113     12  SM-PROCESSOR-ID                 PIC X(4).
   114     12  FILLER                          PIC X(6)
   115            VALUE ' TERM='.
   116     12  SM-TERMID                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL156.cbl
   117     12  FILLER                          PIC XX   VALUE SPACE.
   118     12  SM-JUL-DATE                     PIC 9(5).
   119     12  FILLER                          PIC X    VALUE SPACE.
   120     12  SM-TIME                         PIC 99.99.
   121
   122
   123*    COPY ELCSCRTY.
   124******************************************************************
   125*                                                                *
   126*                                                                *
   127*                            ELCSCRTY                            *
   128*                            VMOD=2.001                          *
   129*                                                                *
   130*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   131*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   132*        SAVED IN PI-SECURITY-ADDRESS.                           *
   133*                                                                *
   134******************************************************************
   135 01  SECURITY-CONTROL.
   136     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   137     12  FILLER                       PIC XX    VALUE 'SC'.
   138     12  SC-CREDIT-CODES.
   139         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   140             20  SC-CREDIT-DISPLAY    PIC X.
   141             20  SC-CREDIT-UPDATE     PIC X.
   142     12  SC-CLAIMS-CODES.
   143         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   144             20  SC-CLAIMS-DISPLAY    PIC X.
   145             20  SC-CLAIMS-UPDATE     PIC X.
   146
   147 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   148 01  WS-DATE-AREA.
   149     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   150     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   151     12  SAVE-DATE-CCYYMMDD.
   152         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   153         16  SAVE-DATE-YMD.
   154             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   155             20  FILLER              PIC X(04)   VALUE SPACES.
   156
   157 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   158 01  STANDARD-AREAS.
   159     12  WS-RESPONSE         PIC S9(8)   COMP.
   160         88  WS-RESP-NORMAL              VALUE +00.
   161         88  WS-RESP-ERROR               VALUE +01.
   162         88  WS-RESP-NOTFND              VALUE +13.
   163         88  WS-RESP-DUPREC              VALUE +14.
   164         88  WS-RESP-ENDFILE             VALUE +20.
   165     12  PMT-HEAD-A.
   166         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   167         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   168         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   169-        '     RESERVES  TYPE    AMOUNT'.
   170     12  PMT-HEAD-B.
   171         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   172         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   173         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   174     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL156.cbl
   175     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   176     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   177     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   178     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   179     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   180     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   181     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   182     12  PGM-NAME            PIC X(8).
   183     12  TIME-IN             PIC S9(7).
   184     12  TIME-OUT-R  REDEFINES TIME-IN.
   185         16  FILLER          PIC X.
   186         16  TIME-OUT        PIC 99V99.
   187         16  FILLER          PIC XX.
   188     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   189     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   190     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   191     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   192     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   193     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   194     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   195     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   196     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   197     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   198     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   199     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   200     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   201     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   202     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   203     12  WS-BLANK            PIC X       VALUE ' '.
   204
   205 01  MISC-WORK-AREAS.
   206     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   207     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   208     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   209     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   210     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   211     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   212     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   213     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   214     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   215     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   216     12  W-CALLED-NAME           PIC X(08).
   217     12  W-EOB-CODES.
   218         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   219             20  W-EOB-CODE      PIC XXX.
   220             20  W-EOB-FILLER    PIC X.
   221     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   222     12  W-NAME-LAST             PIC X(15).
   223     12  W-NAME-FIRST            PIC X(15).
   224     12  W-NAME-MIDDLE.
   225         16  FILLER              PIC X.
   226         16  W-NAME-MIDDLE-2     PIC X.
   227         16  FILLER              PIC X(13).
   228     12  W-DMD-CHECK-NO.
   229         16  W-DMD-CHECK-NO-1    PIC X(4).
   230         16  W-DMD-CHECK-NO-2    PIC X.
   231         16  W-DMD-CHECK-NO-3    PIC XX.
   232
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL156.cbl
   233     12  WS-COMPUTE-FROM-DT  PIC XX.
   234     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   235     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   236     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   237     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   238     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   239     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   240         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   241         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   242     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   243         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   244     12  WS-UPDATE-SW        PIC X VALUE ' '.
   245     12  WS-GROUPING.
   246         16  WS-GROUP-1      PIC X VALUE SPACES.
   247         16  FILLER          PIC X(05) VALUE SPACES.
   248     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   249     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   250     12  WS-WORK-STATE-ACCT.
   251         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   252         16  FILLER          PIC X       VALUE '/'.
   253         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   254     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   255     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   256     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   257     12  QID.
   258         16  QID-TERM        PIC X(4)    VALUE SPACES.
   259         16  FILLER          PIC X(4)    VALUE '156A'.
   260     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   261     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   262     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   263     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   264     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   265     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   266     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   267     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   268     12  WS-STATUS           PIC X       VALUE SPACES.
   269     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   270     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   271     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   272     12  ws-extended-exp-dt  pic xx      value low-values.
   273     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   274     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   275     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   276     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   277     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   278     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   279     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   280     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   281     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   282     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   283     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   284     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   285     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   286     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   287     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   288     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   289     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   290     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL156.cbl
   291     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   292     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   293     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   294     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   295     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   296     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   297     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   298     12  WORK-DATE-FROM.
   299         16  WDF-MONTH       PIC 99        VALUE ZERO.
   300         16  WDF-DAY         PIC 99        VALUE ZERO.
   301         16  WDF-YEAR        PIC 99        VALUE ZERO.
   302     12  WORK-DATE-THRU.
   303         16  WDT-MONTH       PIC 99        VALUE ZERO.
   304         16  WDT-DAY         PIC 99        VALUE ZERO.
   305         16  WDT-YEAR        PIC 99        VALUE ZERO.
   306     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   307     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   308     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   309     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   310     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   311     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   312     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   313     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   314     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   315     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   316     12  WS-PY-WK REDEFINES WS-PY-WORK.
   317         16  WS-PY-NUM       PIC S9(7)V99.
   318         16  WS-PY-SIGN      PIC X.
   319     12  WS-DY-WORK          PIC S9(5).
   320     12  WS-DY-WK REDEFINES WS-DY-WORK.
   321         16  WS-DY-NUM       PIC S9(4).
   322         16  WS-DY-SIGN      PIC X.
   323     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   324         88  COMP-REC-FOUND              VALUE 'Y'.
   325     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   326         88  BENEFIT-FOUND       VALUE 'Y'.
   327         88  NO-BENEFIT-FOUND    VALUE 'N'.
   328     12  WS-TERMS.
   329         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   330         16  FILLER          PIC X       VALUE '/'.
   331         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   332         16  WST-REM-DAYS-GRP.
   333             20  WST-SLASH   PIC X       VALUE '/'.
   334             20  WST-REM-DAYS
   335                             PIC --9.
   336     12  WS-ACCESS.
   337         16  FILLER          PIC XX      VALUE SPACES.
   338         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   339     12  WS-STATE-ACCESS.
   340         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   341         16  FILLER          PIC XX      VALUE SPACES.
   342     12  WS-CARR-ACCESS.
   343         16  FILLER          PIC X(3)    VALUE SPACES.
   344         16  WS-CARR         PIC X       VALUE SPACES.
   345     12  DATE-WORK.
   346         16  FILLER          PIC XX      VALUE SPACES.
   347         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   348     12  WS-SAVE-INPUT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL156.cbl
   349         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   350         16  WS-PAYEE        PIC XX      VALUE SPACE.
   351         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   352         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   353         16  WS-OFFLINE      PIC X       VALUE SPACE.
   354         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   355         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   356         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   357         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   358         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   359         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   360         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   361         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   362         16  WS-ETYPE        PIC X       VALUE SPACE.
   363         16  WS-CASH         PIC X       VALUE SPACE.
   364         16  WS-GROUPED      PIC X       VALUE SPACE.
   365         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   366         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   367         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   368         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   369         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   370         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   371         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   372         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   373     12  LAST-ERROR-LINE.
   374         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   375         16  FILLER              PIC X(30)
   376             VALUE ' FATAL ERRORS ENCOUNTERED'.
   377         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   378         16  FILLER              PIC X(28)
   379             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   380     12  WS-CHECK-AREA.
   381         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   382         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   383     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   384     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   385         16  FILLER              PIC XX.
   386         16  WS-A-CHECK-NUM-5    PIC 9(5).
   387     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   388         16  FILLER              PIC X.
   389         16  WS-A-CHECK-NUM-6    PIC 9(6).
   390     12  OPTION-1-SAVE-AREA.
   391         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   392         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   393     12  WS-WORK-ZIP.
   394         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   395         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   396     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   397                                 PIC 9(9).
   398     12  WS-FLI-PMTNOTE.
   399         16  WS-PMTOPTION        PIC XX.
   400         16  WS-DOCNAME          PIC X(28).
   401         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   402             20  WS-AMOUNT       PIC X(8).
   403             20  FILLER          PIC X(20).
   404         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   405             20  WS-NUM-AMT      PIC 9(6)V99.
   406             20  FILLER          PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL156.cbl
   407
   408     12  WS-HAN-PMTNOTE.
   409         16  WS-HAN-PMT-CODE     PIC X.
   410         16  WS-HAN-PMT-NOTE     PIC X(39).
   411
   412     12  WS-NCL-PMT-OPTION       PIC XX.
   413         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   414
   415     12  WS-CLAIM-SEQUENCE.
   416         16  FILLER              PIC X VALUE '('.
   417         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   418         16  FILLER              PIC X(04) VALUE ' OF '.
   419         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   420         16  FILLER              PIC X VALUE ')'.
   421
   422     12  WS-REFUND-AMT           PIC Z(7).99.
   423     12  WS-CALC-INT             PIC S9(7)V99.
   424     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   425
   426     12  SUB                     PIC 99 VALUE ZEROS.
   427
   428     12  WS-BOANOTE1.
   429         16  WS-BOANOTE1-DESC    PIC X(11).
   430         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   431         16  FILLER              PIC X(17).
   432     12  WS-BOANOTE2.
   433         16  WS-BOANOTE2-DESC    PIC X(11).
   434         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   435         16  FILLER              PIC X(17).
   436
   437     12  WS-NCLNOTE1.
   438         16  WS-NCLNOTE1-DESC    PIC X(11).
   439         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   440         16  FILLER              PIC X(17).
   441     12  WS-NCLNOTE2.
   442         16  WS-NCLNOTE2-DESC    PIC X(11).
   443         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   444         16  FILLER              PIC X(17).
   445
   446     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   447     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   448     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   449     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   450     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   451     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   452     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   453     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   454     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   455     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   456
   457     12  WS-AIG-WORK-AREAS.
   458         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   459             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   460         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   461             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   462         16  WS-FROM-DATE-MDY.
   463             20  WS-FROM-MO      PIC 99.
   464             20  WS-FROM-DA      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL156.cbl
   465             20  WS-FROM-YR      PIC 99.
   466         16  WS-TEMP-DATE-MDY.
   467             20  WS-TEMP-MO      PIC 99.
   468             20  WS-TEMP-DA      PIC 99.
   469             20  WS-TEMP-YR      PIC 99.
   470         16  WS-BIN-FROM-DT      PIC XX.
   471         16  WS-TEMP-INC-MDY.
   472             20  WS-TEMP-INC-MO  PIC 99.
   473             20  WS-TEMP-INC-DA  PIC 99.
   474             20  WS-TEMP-INC-YR  PIC 99.
   475         16  WS-PMT-DUE-MDY.
   476             20  WS-PMT-DUE-MO   PIC 99.
   477             20  WS-PMT-DUE-DA   PIC 99.
   478             20  WS-PMT-DUE-YR   PIC 99.
   479         16  WS-PMT-DUE-DT       PIC XX.
   480         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   481         16  WS-RETRO-ELIM-DT    PIC XX.
   482         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   483             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   484         16  WS-SAVE-DUE-DA      PIC 99.
   485         16  WS-CDAYS            PIC S9(05).
   486         16  WS-DAYS-OFF         PIC S9(05).
   487         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   488             88  ELIM-SATISFIED            VALUE 'Y'.
   489         16  WS-AIG-CHECKNO.
   490             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   491             20  WS-A-CHECKNO-3-7.
   492                 24  FILLER              PIC X(3)    VALUE SPACES.
   493                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   494                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   495         16  WS-AIG-GROUPING.
   496             20  WS-A-BENE               PIC XXX.
   497             20  FILLER                  PIC XXX.
   498         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   499             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   500             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   501         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   502                 VALUE 'UNEMPLOYMENT PAYMENT'.
   503         16  WS-CHK-THRU-DT              PIC XX.
   504         16  WS-HOLD-BIN-DATE-1          PIC XX.
   505
   506 01  MISC-CSO-AREA.
   507     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   508     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   509     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   510         88  APPROVAL-NEEDED                        VALUE 'Y'.
   511     12  WS-APPROV-NOTE                  PIC X(43)
   512         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   513     12  WS-3550-APPROV-NOTE             PIC X(43)
   514         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   515     12  WS-REAUDIT-NOTE                 PIC X(43)
   516         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   517     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   518     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   519     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   520     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   521     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   522     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL156.cbl
   523     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   524         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   525     12  WS-PAYEE-CITY-STATE     PIC X(30).
   526     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   527         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   528     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   529     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   530     12  WS-WORK-NAME            PIC X(30).
   531     12  FILLER  REDEFINES WS-WORK-NAME.
   532         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   533     12  WS-INSURED-NAME         PIC X(30).
   534     12  FILLER  REDEFINES WS-INSURED-NAME.
   535         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   536     12  WS-PAYEE-NAME           PIC X(30).
   537     12  FILLER  REDEFINES WS-PAYEE-NAME.
   538         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   539
   540 01  ERROR-MESSAGES.
   541     12  ER-0000                 PIC X(4)  VALUE '0000'.
   542     12  ER-0004                 PIC X(4)  VALUE '0004'.
   543     12  ER-0008                 PIC X(4)  VALUE '0008'.
   544     12  ER-0019                 PIC X(4)  VALUE '0019'.
   545     12  ER-0029                 PIC X(4)  VALUE '0029'.
   546     12  ER-0042                 PIC X(4)  VALUE '0042'.
   547     12  ER-0070                 PIC X(4)  VALUE '0070'.
   548     12  ER-0130                 PIC X(4)  VALUE '0130'.
   549     12  ER-0149                 PIC X(4)  VALUE '0149'.
   550     12  ER-0154                 PIC X(4)  VALUE '0154'.
   551     12  ER-0168                 PIC X(4)  VALUE '0168'.
   552     12  ER-0169                 PIC X(4)  VALUE '0169'.
   553     12  ER-0172                 PIC X(4)  VALUE '0174'.
   554     12  ER-0198                 PIC X(4)  VALUE '0198'.
   555     12  ER-0204                 PIC X(4)  VALUE '0204'.
   556     12  ER-0206                 PIC X(4)  VALUE '0206'.
   557     12  ER-0252                 PIC X(4)  VALUE '0252'.
   558     12  ER-0254                 PIC X(4)  VALUE '0254'.
   559     12  ER-0282                 PIC X(4)  VALUE '0282'.
   560     12  ER-0283                 PIC X(4)  VALUE '0283'.
   561     12  ER-0294                 PIC X(4)  VALUE '0294'.
   562     12  ER-0338                 PIC X(4)  VALUE '0338'.
   563     12  ER-0419                 PIC X(4)  VALUE '0419'.
   564     12  ER-0420                 PIC X(4)  VALUE '0420'.
   565     12  ER-0421                 PIC X(4)  VALUE '0421'.
   566     12  ER-0422                 PIC X(4)  VALUE '0422'.
   567     12  ER-0433                 PIC X(4)  VALUE '0433'.
   568     12  ER-0436                 PIC X(4)  VALUE '0436'.
   569     12  ER-0437                 PIC X(4)  VALUE '0437'.
   570     12  ER-0438                 PIC X(4)  VALUE '0438'.
   571     12  ER-0439                 PIC X(4)  VALUE '0439'.
   572     12  ER-0440                 PIC X(4)  VALUE '0440'.
   573     12  ER-0441                 PIC X(4)  VALUE '0441'.
   574     12  ER-0442                 PIC X(4)  VALUE '0442'.
   575     12  ER-0443                 PIC X(4)  VALUE '0443'.
   576     12  ER-0444                 PIC X(4)  VALUE '0444'.
   577     12  ER-0445                 PIC X(4)  VALUE '0445'.
   578     12  ER-0446                 PIC X(4)  VALUE '0446'.
   579     12  ER-0447                 PIC X(4)  VALUE '0447'.
   580     12  ER-0448                 PIC X(4)  VALUE '0448'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL156.cbl
   581     12  ER-0449                 PIC X(4)  VALUE '0449'.
   582     12  ER-0452                 PIC X(4)  VALUE '0452'.
   583     12  ER-0458                 PIC X(4)  VALUE '0458'.
   584     12  ER-0459                 PIC X(4)  VALUE '0459'.
   585     12  ER-0460                 PIC X(4)  VALUE '0460'.
   586     12  ER-0461                 PIC X(4)  VALUE '0461'.
   587     12  ER-0462                 PIC X(4)  VALUE '0462'.
   588     12  ER-0463                 PIC X(4)  VALUE '0463'.
   589     12  ER-0464                 PIC X(4)  VALUE '0464'.
   590     12  ER-0465                 PIC X(4)  VALUE '0465'.
   591     12  ER-0466                 PIC X(4)  VALUE '0466'.
   592     12  ER-0467                 PIC X(4)  VALUE '0467'.
   593     12  ER-0468                 PIC X(4)  VALUE '0468'.
   594     12  ER-0469                 PIC X(4)  VALUE '0469'.
   595     12  ER-0473                 PIC X(4)  VALUE '0473'.
   596     12  ER-0474                 PIC X(4)  VALUE '0474'.
   597     12  ER-0475                 PIC X(4)  VALUE '0475'.
   598     12  ER-0476                 PIC X(4)  VALUE '0476'.
   599     12  ER-0477                 PIC X(4)  VALUE '0477'.
   600     12  ER-0478                 PIC X(4)  VALUE '0478'.
   601     12  ER-0479                 PIC X(4)  VALUE '0479'.
   602     12  ER-0481                 PIC X(4)  VALUE '0481'.
   603     12  ER-0491                 PIC X(4)  VALUE '0491'.
   604     12  ER-0492                 PIC X(4)  VALUE '0492'.
   605     12  ER-0493                 PIC X(4)  VALUE '0493'.
   606     12  ER-0494                 PIC X(4)  VALUE '0494'.
   607     12  ER-0495                 PIC X(4)  VALUE '0495'.
   608     12  ER-0499                 PIC X(4)  VALUE '0499'.
   609     12  ER-0500                 PIC X(4)  VALUE '0500'.
   610     12  ER-0501                 PIC X(4)  VALUE '0501'.
   611     12  ER-0502                 PIC X(4)  VALUE '0502'.
   612     12  ER-0508                 PIC X(4)  VALUE '0508'.
   613     12  ER-0513                 PIC X(4)  VALUE '0513'.
   614     12  ER-0518                 PIC X(4)  VALUE '0518'.
   615     12  ER-0524                 PIC X(4)  VALUE '0524'.
   616     12  ER-0525                 PIC X(4)  VALUE '0525'.
   617     12  ER-0526                 PIC X(4)  VALUE '0526'.
   618     12  ER-0530                 PIC X(4)  VALUE '0530'.
   619     12  ER-0540                 PIC X(4)  VALUE '0540'.
   620     12  ER-0541                 PIC X(4)  VALUE '0541'.
   621     12  ER-0542                 PIC X(4)  VALUE '0542'.
   622     12  ER-0543                 PIC X(4)  VALUE '0543'.
   623     12  ER-0545                 PIC X(4)  VALUE '0545'.
   624     12  ER-0552                 PIC X(4)  VALUE '0552'.
   625     12  ER-0555                 PIC X(4)  VALUE '0555'.
   626     12  ER-0556                 PIC X(4)  VALUE '0556'.
   627     12  ER-0557                 PIC X(4)  VALUE '0557'.
   628     12  ER-0572                 PIC X(4)  VALUE '0572'.
   629     12  ER-0573                 PIC X(4)  VALUE '0573'.
   630     12  ER-0594                 PIC X(4)  VALUE '0594'.
   631     12  ER-0616                 PIC X(4)  VALUE '0616'.
   632     12  ER-0617                 PIC X(4)  VALUE '0617'.
   633     12  ER-0618                 PIC X(4)  VALUE '0618'.
   634     12  ER-0657                 PIC X(4)  VALUE '0657'.
   635     12  ER-0658                 PIC X(4)  VALUE '0658'.
   636     12  ER-0699                 PIC X(4)  VALUE '0699'.
   637     12  ER-0730                 PIC X(4)  VALUE '0730'.
   638     12  ER-0737                 PIC X(4)  VALUE '0737'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL156.cbl
   639     12  ER-0760                 PIC X(4)  VALUE '0760'.
   640     12  ER-0768                 PIC X(4)  VALUE '0768'.
   641     12  ER-0769                 PIC X(4)  VALUE '0769'.
   642     12  ER-0770                 PIC X(4)  VALUE '0770'.
   643     12  ER-0802                 PIC X(4)  VALUE '0802'.
   644     12  ER-0803                 PIC X(4)  VALUE '0803'.
   645     12  ER-0819                 PIC X(4)  VALUE '0819'.
   646     12  ER-0834                 PIC X(4)  VALUE '0834'.
   647     12  ER-0836                 PIC X(4)  VALUE '0836'.
   648     12  ER-0844                 PIC X(4)  VALUE '0844'.
   649     12  ER-0845                 PIC X(4)  VALUE '0845'.
   650     12  ER-0846                 PIC X(4)  VALUE '0846'.
   651     12  ER-0849                 PIC X(4)  VALUE '0849'.
   652     12  ER-0851                 PIC X(4)  VALUE '0851'.
   653     12  ER-0872                 PIC X(4)  VALUE '0872'.
   654     12  ER-0873                 PIC X(4)  VALUE '0873'.
   655     12  ER-0874                 PIC X(4)  VALUE '0874'.
   656     12  ER-0879                 PIC X(4)  VALUE '0879'.
   657     12  ER-0919                 PIC X(4)  VALUE '0919'.
   658     12  ER-0921                 PIC X(4)  VALUE '0921'.
   659     12  ER-0923                 PIC X(4)  VALUE '0923'.
   660     12  ER-0925                 PIC X(4)  VALUE '0925'.
   661     12  ER-0944                 PIC X(4)  VALUE '0944'.
   662     12  ER-0945                 PIC X(4)  VALUE '0945'.
   663     12  ER-0946                 PIC X(4)  VALUE '0946'.
   664     12  ER-0947                 PIC X(4)  VALUE '0947'.
   665     12  ER-0948                 PIC X(4)  VALUE '0948'.
   666     12  ER-0949                 PIC X(4)  VALUE '0949'.
   667     12  ER-0950                 PIC X(4)  VALUE '0950'.
   668     12  ER-0951                 PIC X(4)  VALUE '0951'.
   669     12  ER-0954                 PIC X(4)  VALUE '0954'.
   670     12  ER-0956                 PIC X(4)  VALUE '0956'.
   671     12  ER-0967                 PIC X(4)  VALUE '0967'.
   672     12  ER-0968                 PIC X(4)  VALUE '0968'.
   673     12  ER-0974                 PIC X(4)  VALUE '0974'.
   674     12  ER-0975                 PIC X(4)  VALUE '0975'.
   675     12  ER-1561                 PIC X(4)  VALUE '1561'.
   676     12  ER-1566                 PIC X(4)  VALUE '1566'.
   677     12  ER-1567                 PIC X(4)  VALUE '1567'.
   678     12  ER-1569                 PIC X(4)  VALUE '1569'.
   679     12  er-1657                 pic x(4)  value '1657'.
   680     12  er-1658                 pic x(4)  value '1658'.
   681     12  er-1667                 pic x(4)  value '1667'.
   682     12  er-1670                 pic x(4)  value '1670'.
   683     12  er-1671                 pic x(4)  value '1671'.
   684     12  er-1672                 pic x(4)  value '1672'.
   685     12  er-1673                 pic x(4)  value '1673'.
   686     12  er-1674                 pic x(4)  value '1674'.
   687     12  er-1677                 pic x(4)  value '1677'.
   688     12  ER-1775                 PIC X(4)  VALUE '1775'.
   689     12  ER-1880                 PIC X(4)  VALUE '1880'.
   690     12  ER-2044                 PIC X(4)  VALUE '2044'.
   691     12  ER-3140                 PIC X(4)  VALUE '3140'.
   692     12  ER-3141                 PIC X(4)  VALUE '3141'.
   693     12  ER-3255                 PIC X(4)  VALUE '3255'.
   694     12  ER-3516                 PIC X(4)  VALUE '3516'.
   695     12  ER-3527                 PIC X(4)  VALUE '3527'.
   696     12  ER-3528                 PIC X(4)  VALUE '3528'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL156.cbl
   697     12  ER-3529                 PIC X(4)  VALUE '3529'.
   698     12  ER-3530                 PIC X(4)  VALUE '3530'.
   699     12  ER-3531                 PIC X(4)  VALUE '3531'.
   700     12  ER-3532                 PIC X(4)  VALUE '3532'.
   701     12  ER-3533                 PIC X(4)  VALUE '3533'.
   702     12  ER-3534                 PIC X(4)  VALUE '3534'.
   703     12  ER-3535                 PIC X(4)  VALUE '3535'.
   704     12  ER-3536                 PIC X(4)  VALUE '3536'.
   705     12  ER-3537                 PIC X(4)  VALUE '3537'.
   706     12  ER-3538                 PIC X(4)  VALUE '3538'.
   707     12  ER-3539                 PIC X(4)  VALUE '3539'.
   708     12  ER-3540                 PIC X(4)  VALUE '3540'.
   709     12  ER-3541                 PIC X(4)  VALUE '3541'.
   710     12  ER-3542                 PIC X(4)  VALUE '3542'.
   711     12  ER-3543                 PIC X(4)  VALUE '3543'.
   712     12  ER-3546                 PIC X(4)  VALUE '3546'.
   713     12  ER-3549                 PIC X(4)  VALUE '3549'.
   714     12  ER-3818                 PIC X(4)  VALUE '3818'.
   715     12  ER-7540                 PIC X(4)  VALUE '7540'.
   716     12  ER-7576                 PIC X(4)  VALUE '7576'.
   717     12  ER-7579                 PIC X(4)  VALUE '7579'.
   718     12  ER-7580                 PIC X(4)  VALUE '7580'.
   719     12  ER-7583                 PIC X(4)  VALUE '7583'.
   720     12  ER-7830                 PIC X(4)  VALUE '7830'.
   721     12  ER-7831                 PIC X(4)  VALUE '7831'.
   722     12  ER-7832                 PIC X(4)  VALUE '7832'.
   723     12  ER-7833                 PIC X(4)  VALUE '7833'.
   724     12  ER-7834                 PIC X(4)  VALUE '7834'.
   725     12  ER-7835                 PIC X(4)  VALUE '7835'.
   726     12  ER-7836                 PIC X(4)  VALUE '7836'.
   727     12  ER-7837                 PIC X(4)  VALUE '7837'.
   728     12  ER-7838                 PIC X(4)  VALUE '7838'.
   729     12  ER-7841                 PIC X(4)  VALUE '7841'.
   730     12  ER-7844                 PIC X(4)  VALUE '7844'.
   731     12  ER-7845                 PIC X(4)  VALUE '7845'.
   732     12  ER-8000                 PIC X(4)  VALUE '8000'.
   733     12  ER-8051                 PIC X(4)  VALUE '8051'.
   734     12  ER-8052                 PIC X(4)  VALUE '8052'.
   735     12  ER-8053                 PIC X(4)  VALUE '8053'.
   736     12  ER-8054                 PIC X(4)  VALUE '8054'.
   737     12  ER-8055                 PIC X(4)  VALUE '8055'.
   738     12  ER-8056                 PIC X(4)  VALUE '8056'.
   739     12  ER-8057                 PIC X(4)  VALUE '8057'.
   740     12  ER-8058                 PIC X(4)  VALUE '8058'.
   741     12  ER-8059                 PIC X(4)  VALUE '8059'.
   742     12  ER-8060                 PIC X(4)  VALUE '8060'.
   743     12  ER-8061                 PIC X(4)  VALUE '8061'.
   744     12  ER-8062                 PIC X(4)  VALUE '8062'.
   745     12  ER-8063                 PIC X(4)  VALUE '8063'.
   746     12  ER-8064                 PIC X(4)  VALUE '8064'.
   747     12  ER-8065                 PIC X(4)  VALUE '8065'.
   748     12  ER-8066                 PIC X(4)  VALUE '8066'.
   749     12  ER-8146                 PIC X(4)  VALUE '8146'.
   750     12  ER-8147                 PIC X(4)  VALUE '8147'.
   751     12  ER-8152                 PIC X(4)  VALUE '8152'.
   752     12  ER-8153                 PIC X(4)  VALUE '8153'.
   753     12  ER-8154                 PIC X(4)  VALUE '8154'.
   754     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL156.cbl
   755     12  ER-8310                 PIC X(4)  VALUE '8310'.
   756     12  ER-8311                 PIC X(4)  VALUE '8311'.
   757     12  ER-8312                 PIC X(4)  VALUE '8312'.
   758     12  ER-8313                 PIC X(4)  VALUE '8313'.
   759     12  ER-8314                 PIC X(4)  VALUE '8314'.
   760     12  ER-8315                 PIC X(4)  VALUE '8315'.
   761     12  ER-8316                 PIC X(4)  VALUE '8316'.
   762     12  ER-8317                 PIC X(4)  VALUE '8317'.
   763
   764 01  CSO-WORK-FIELDS.
   765     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   766       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   767
   768     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   769     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   770         88  CERT-NOTE-ADDED           VALUE 'Y'.
   771     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   772         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   773     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   774
   775     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   776
   777 01  SC-NP6-CERT-NOTE.
   778     12  FILLER                  PIC X(12)
   779               VALUE 'REM BENEFIT '.
   780     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   781     12  SC-NP6-COMM             PIC X(8)
   782               VALUE ' + 6 MO '.
   783     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   784     12  FILLER                  PIC X(12)
   785               VALUE ' = AMT PAID '.
   786     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   787
   788 01  SC-NP6-ORIG-NOTE.
   789     12  FILLER                  PIC X(63)  VALUE
   790         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   791 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   792     88  PDEF-FOUND                   VALUE 'Y'.
   793 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   794     88  ACCT-FOUND                   VALUE 'Y'.
   795 01  CTBL-KEY-SAVE               PIC X(5).
   796 01  CTBL-KEY.
   797     05  CTBL-COMPANY-CD         PIC X.
   798     05  CTBL-TABLE              PIC XXX.
   799     05  CTBL-BEN-TYPE           PIC X.
   800     05  CTBL-BEN-CODE           PIC XX.
   801 01  ERPDEF-KEY-SAVE             PIC X(18).
   802 01  ERPDEF-KEY.
   803     12  ERPDEF-COMPANY-CD       PIC X.
   804     12  ERPDEF-STATE            PIC XX.
   805     12  ERPDEF-PROD-CD          PIC XXX.
   806     12  F                       PIC X(7).
   807     12  ERPDEF-BEN-TYPE         PIC X.
   808     12  ERPDEF-BEN-CODE         PIC XX.
   809     12  ERPDEF-EXP-DT           PIC XX.
   810 01  ELCRTT-KEY.
   811     05  CTRLR-COMP-CD       PIC X.
   812     05  CTRLR-CARRIER       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL156.cbl
   813     05  CTRLR-GROUPING      PIC X(6).
   814     05  CTRLR-STATE         PIC X(2).
   815     05  CTRLR-ACCOUNT       PIC X(10).
   816     05  CTRLR-EFF-DT        PIC XX.
   817     05  CTRLR-CERT-NO       PIC X(11).
   818     05  CTRLR-REC-TYPE      PIC X.
   819 01  ACCESS-KEYS.
   820     12  ELARCH-KEY.
   821         16  ARCH-CO             PIC X.
   822         16  ARCH-NUMBER         PIC S9(08) COMP.
   823         16  ARCH-REC-TYPE       PIC X.
   824         16  ARCH-SEQ            PIC S9(04) COMP.
   825     12  ELMSTR-KEY.
   826         16  MSTR-COMP-CD        PIC X.
   827         16  MSTR-CARRIER        PIC X.
   828         16  MSTR-CLAIM-NO       PIC X(7).
   829         16  MSTR-CERT-NO        PIC X(11).
   830     12  ELCNTL-KEY.
   831         16  CNTL-COMP-ID        PIC X(3).
   832         16  CNTL-REC-TYPE       PIC X.
   833         16  CNTL-ACCESS         PIC X(4).
   834         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   835     12  ELCERT-KEY.
   836         16  CERT-COMP-CD        PIC X.
   837         16  CERT-CARRIER        PIC X.
   838         16  CERT-GROUPING       PIC X(6).
   839         16  CERT-STATE          PIC XX.
   840         16  CERT-ACCOUNT        PIC X(10).
   841         16  CERT-EFF-DT         PIC XX.
   842         16  CERT-CERT-NO        PIC X(11).
   843     12  ELTRLR-KEY.
   844         16  TRLR-COMP-CD        PIC X.
   845         16  TRLR-CARRIER        PIC X.
   846         16  TRLR-CLAIM-NO       PIC X(7).
   847         16  TRLR-CERT-NO        PIC X(11).
   848         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   849     12  ELACTQ-KEY.
   850         16  ACTQ-COMP-CD        PIC X.
   851         16  ACTQ-CARRIER        PIC X.
   852         16  ACTQ-CLAIM-NO       PIC X(7).
   853         16  ACTQ-CERT-NO        PIC X(11).
   854     12  W-NOTE-KEY.
   855         16  W-NOTE-COMP-CD      PIC X.
   856         16  W-NOTE-CERT-KEY.
   857             20  W-NOTE-CARRIER  PIC X.
   858             20  W-NOTE-GROUPING PIC X(6).
   859             20  W-NOTE-STATE    PIC XX.
   860             20  W-NOTE-ACCOUNT  PIC X(10).
   861             20  W-NOTE-EFF-DT   PIC XX.
   862             20  W-NOTE-CERT-NO  PIC X(11).
   863     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   864     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   865     12  ERACCT-KEY.
   866         16  ERACCT-PARTIAL-KEY.
   867             20  ACCT-COMP-CD    PIC X.
   868             20  ACCT-CARRIER    PIC X.
   869             20  ACCT-GROUPING   PIC X(6).
   870             20  ACCT-STATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL156.cbl
   871             20  ACCT-ACCOUNT    PIC X(10).
   872         16  ACCT-EXP-DT         PIC XX.
   873         16  FILLER              PIC X(4) VALUE SPACES.
   874     12  ELCHKQ-KEY.
   875         16  CHKQ-COMP-CD        PIC X.
   876         16  CHKQ-CONTROL        PIC S9(8) COMP.
   877         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   878     12  ELBENE-KEY.
   879         16  BENE-COMP-CD         PIC X.
   880         16  BENE-RECORD-TYPE     PIC X.
   881         16  BENE-NUMBER          PIC X(10).
   882     12  ERCOMP-KEY.
   883         16  COMP-COMP-CD        PIC X.
   884         16  COMP-CARRIER        PIC X.
   885         16  COMP-GROUP          PIC X(06).
   886         16  COMP-FIN-RESP       PIC X(10).
   887         16  COMP-ACCOUNT        PIC X(10).
   888         16  COMP-TYPE           PIC X.
   889
   890     12  DLO035-KEY.
   891         16  DL35-PROCESS-TYPE   PIC X.
   892         16  DL35-CREDIT-CARD    PIC X(20).
   893         16  DL35-BEN-TYPE       PIC XX.
   894         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   895         16  DL35-RETURN-CODE    PIC XX.
   896
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL156.cbl
   898*    COPY ELCDATE.
   899******************************************************************
   900*                                                                *
   901*                                                                *
   902*                            ELCDATE.                            *
   903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   904*                            VMOD=2.003
   905*                                                                *
   906*                                                                *
   907*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   908*                 LENGTH = 200                                   *
   909******************************************************************
   910
   911 01  DATE-CONVERSION-DATA.
   912     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   913     12  DC-OPTION-CODE                PIC X.
   914         88  BIN-TO-GREG                VALUE ' '.
   915         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   916         88  EDIT-GREG-TO-BIN           VALUE '2'.
   917         88  YMD-GREG-TO-BIN            VALUE '3'.
   918         88  MDY-GREG-TO-BIN            VALUE '4'.
   919         88  JULIAN-TO-BIN              VALUE '5'.
   920         88  BIN-PLUS-ELAPSED           VALUE '6'.
   921         88  FIND-CENTURY               VALUE '7'.
   922         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   923         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   924         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   925         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   926         88  JULIAN-TO-BIN-3            VALUE 'C'.
   927         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   928         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   929         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   930         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   931         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   932         88  CHECK-LEAP-YEAR            VALUE 'H'.
   933         88  BIN-3-TO-GREG              VALUE 'I'.
   934         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   935         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   936         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   937         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   938         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   939         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   940         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   941         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   942         88  THREE-CHARACTER-BIN
   943                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   944         88  GREGORIAN-TO-BIN
   945                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   946         88  BIN-TO-GREGORIAN
   947                  VALUES ' ' '1' 'I' '8' 'G'.
   948         88  JULIAN-TO-BINARY
   949                  VALUES '5' 'C' 'E' 'F'.
   950     12  DC-ERROR-CODE                 PIC X.
   951         88  NO-CONVERSION-ERROR        VALUE ' '.
   952         88  DATE-CONVERSION-ERROR
   953                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   954         88  DATE-IS-ZERO               VALUE '1'.
   955         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL156.cbl
   956         88  DATE-IS-INVALID            VALUE '3'.
   957         88  DATE1-GREATER-DATE2        VALUE '4'.
   958         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   959         88  DATE-INVALID-OPTION        VALUE '9'.
   960         88  INVALID-CENTURY            VALUE 'A'.
   961         88  ONLY-CENTURY               VALUE 'B'.
   962         88  ONLY-LEAP-YEAR             VALUE 'C'.
   963         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   964     12  DC-END-OF-MONTH               PIC X.
   965         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   966     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   967         88  USE-NORMAL-PROCESS         VALUE ' '.
   968         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   969         88  ADJUST-UP-100-YRS          VALUE '2'.
   970     12  FILLER                        PIC X.
   971     12  DC-CONVERSION-DATES.
   972         16  DC-BIN-DATE-1             PIC XX.
   973         16  DC-BIN-DATE-2             PIC XX.
   974         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   975         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   976                       DC-GREG-DATE-1-EDIT.
   977             20  DC-EDIT1-MONTH        PIC 99.
   978             20  SLASH1-1              PIC X.
   979             20  DC-EDIT1-DAY          PIC 99.
   980             20  SLASH1-2              PIC X.
   981             20  DC-EDIT1-YEAR         PIC 99.
   982         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   983         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   984                     DC-GREG-DATE-2-EDIT.
   985             20  DC-EDIT2-MONTH        PIC 99.
   986             20  SLASH2-1              PIC X.
   987             20  DC-EDIT2-DAY          PIC 99.
   988             20  SLASH2-2              PIC X.
   989             20  DC-EDIT2-YEAR         PIC 99.
   990         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   991         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   992                     DC-GREG-DATE-1-YMD.
   993             20  DC-YMD-YEAR           PIC 99.
   994             20  DC-YMD-MONTH          PIC 99.
   995             20  DC-YMD-DAY            PIC 99.
   996         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   997         16  DC-GREG-DATE-1-MDY-R REDEFINES
   998                      DC-GREG-DATE-1-MDY.
   999             20  DC-MDY-MONTH          PIC 99.
  1000             20  DC-MDY-DAY            PIC 99.
  1001             20  DC-MDY-YEAR           PIC 99.
  1002         16  DC-GREG-DATE-1-ALPHA.
  1003             20  DC-ALPHA-MONTH        PIC X(10).
  1004             20  DC-ALPHA-DAY          PIC 99.
  1005             20  FILLER                PIC XX.
  1006             20  DC-ALPHA-CENTURY.
  1007                 24 DC-ALPHA-CEN-N     PIC 99.
  1008             20  DC-ALPHA-YEAR         PIC 99.
  1009         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1010         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1011         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1012         16  DC-JULIAN-DATE            PIC 9(05).
  1013         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL156.cbl
  1014                                       PIC 9(05).
  1015         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1016             20  DC-JULIAN-YEAR        PIC 99.
  1017             20  DC-JULIAN-DAYS        PIC 999.
  1018         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1019         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1020         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1021     12  DATE-CONVERSION-VARIBLES.
  1022         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1023         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1024             20  FILLER                PIC 9(3).
  1025             20  HOLD-CEN-1-CCYY.
  1026                 24  HOLD-CEN-1-CC     PIC 99.
  1027                 24  HOLD-CEN-1-YY     PIC 99.
  1028             20  HOLD-CEN-1-MO         PIC 99.
  1029             20  HOLD-CEN-1-DA         PIC 99.
  1030         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1031             20  HOLD-CEN-1-R-MO       PIC 99.
  1032             20  HOLD-CEN-1-R-DA       PIC 99.
  1033             20  HOLD-CEN-1-R-CCYY.
  1034                 24  HOLD-CEN-1-R-CC   PIC 99.
  1035                 24  HOLD-CEN-1-R-YY   PIC 99.
  1036             20  FILLER                PIC 9(3).
  1037         16  HOLD-CENTURY-1-X.
  1038             20  FILLER                PIC X(3)  VALUE SPACES.
  1039             20  HOLD-CEN-1-X-CCYY.
  1040                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1041                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1042             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1043             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1044         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1045             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1046             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1047             20  HOLD-CEN-1-R-X-CCYY.
  1048                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1049                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1050             20  FILLER                PIC XXX.
  1051         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1052         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1053         16  DC-JULIAN-DATE-1          PIC 9(07).
  1054         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1055             20  DC-JULIAN-1-CCYY.
  1056                 24  DC-JULIAN-1-CC    PIC 99.
  1057                 24  DC-JULIAN-1-YR    PIC 99.
  1058             20  DC-JULIAN-DA-1        PIC 999.
  1059         16  DC-JULIAN-DATE-2          PIC 9(07).
  1060         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1061             20  DC-JULIAN-2-CCYY.
  1062                 24  DC-JULIAN-2-CC    PIC 99.
  1063                 24  DC-JULIAN-2-YR    PIC 99.
  1064             20  DC-JULIAN-DA-2        PIC 999.
  1065         16  DC-GREG-DATE-A-EDIT.
  1066             20  DC-EDITA-MONTH        PIC 99.
  1067             20  SLASHA-1              PIC X VALUE '/'.
  1068             20  DC-EDITA-DAY          PIC 99.
  1069             20  SLASHA-2              PIC X VALUE '/'.
  1070             20  DC-EDITA-CCYY.
  1071                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL156.cbl
  1072                 24  DC-EDITA-YEAR     PIC 99.
  1073         16  DC-GREG-DATE-B-EDIT.
  1074             20  DC-EDITB-MONTH        PIC 99.
  1075             20  SLASHB-1              PIC X VALUE '/'.
  1076             20  DC-EDITB-DAY          PIC 99.
  1077             20  SLASHB-2              PIC X VALUE '/'.
  1078             20  DC-EDITB-CCYY.
  1079                 24  DC-EDITB-CENT     PIC 99.
  1080                 24  DC-EDITB-YEAR     PIC 99.
  1081         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1082         16  DC-GREG-DATE-CYMD-R REDEFINES
  1083                              DC-GREG-DATE-CYMD.
  1084             20  DC-CYMD-CEN           PIC 99.
  1085             20  DC-CYMD-YEAR          PIC 99.
  1086             20  DC-CYMD-MONTH         PIC 99.
  1087             20  DC-CYMD-DAY           PIC 99.
  1088         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1089         16  DC-GREG-DATE-MDCY-R REDEFINES
  1090                              DC-GREG-DATE-MDCY.
  1091             20  DC-MDCY-MONTH         PIC 99.
  1092             20  DC-MDCY-DAY           PIC 99.
  1093             20  DC-MDCY-CEN           PIC 99.
  1094             20  DC-MDCY-YEAR          PIC 99.
  1095    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1096        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1097    12  DC-EL310-DATE                  PIC X(21).
  1098    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL156.cbl
  1100*    COPY ELCLOGOF.
  1101******************************************************************
  1102*                                                                *
  1103*                                                                *
  1104*                            ELCLOGOF.                           *
  1105*                            VMOD=2.001                          *
  1106*                                                                *
  1107*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1108*                                                                *
  1109******************************************************************
  1110 01  CLASIC-LOGOFF.
  1111     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1112     12  LOGOFF-TEXT.
  1113         16  FILLER          PIC X(5)    VALUE SPACES.
  1114         16  LOGOFF-MSG.
  1115             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1116             20  FILLER      PIC X       VALUE SPACES.
  1117             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1118         16  FILLER          PIC X(80)
  1119           VALUE '* YOU ARE NOW LOGGED OFF'.
  1120         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1121         16  FILLER          PIC X       VALUE QUOTE.
  1122         16  LOGOFF-SYS-MSG  PIC X(17)
  1123           VALUE 'S CLAS-IC SYSTEM '.
  1124     12  TEXT-MESSAGES.
  1125         16  UNACCESS-MSG    PIC X(29)
  1126             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1127         16  PGMIDERR-MSG    PIC X(17)
  1128             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL156.cbl
  1130*    COPY ELCCALC.
  1131******************************************************************
  1132*                                                                *
  1133*                           ELCCALC.                            *
  1134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1135*                            VMOD=2.025                          *
  1136*                                                                *
  1137*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1138*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1139*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1140*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1141*                                                                *
  1142*  PASSED TO ELRTRM                                              *
  1143*  -----------------                                             *
  1144*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1145*  ORIGINAL TERM                                                 *
  1146*  BEGINNING DATE                                                *
  1147*  ENDING DATE                                                   *
  1148*  COMPANY I.D.                                                  *
  1149*  ACCOUNT MASTER USER FIELD                                     *
  1150*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1151*  FREE LOOK DAYS                                                *
  1152*                                                                *
  1153*  RETURNED FROM ELRTRM                                          *
  1154*  ---------------------                                         *
  1155*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1156*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1157*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1158*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1159*----------------------------------------------------------------*
  1160*  PASSED TO ELRAMT                                              *
  1161*  ----------------                                              *
  1162*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1163*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1164*  ORIGINAL AMOUNT                                               *
  1165*  ALTERNATE BENEFIT (BALLON)                                    *
  1166*  A.P.R. - NET PAY ONLY                                         *
  1167*  METHOD
  1168*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1169*  COMPANY I.D.                                                  *
  1170*  BENEFIT TYPE                                                  *
  1171*                                                                *
  1172*  RETURNED FROM ELRAMT                                          *
  1173*  --------------------                                          *
  1174*  REMAINING AMOUNT 1 - CURRENT                                  *
  1175*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1176*  REMAINING AMOUNT FACTOR
  1177*----------------------------------------------------------------*
  1178*  PASSED TO ELRESV                                              *
  1179*  -----------------                                             *
  1180*  CERTIFICATE EFFECTIVE DATE                                    *
  1181*  VALUATION DATE                                                *
  1182*  PAID THRU DATE                                                *
  1183*  BENEFIT                                                       *
  1184*  INCURRED DATE                                                 *
  1185*  REPORTED DATE                                                 *
  1186*  ISSUE AGE                                                     *
  1187*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL156.cbl
  1188*  CDT PERCENT                                                   *
  1189*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1190* *CLAIM TYPE (LIFE, A/H)                                        *
  1191* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1192* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1193*                                                                *
  1194*  RETURNED FROM ELRESV                                          *
  1195*  --------------------                                          *
  1196*  CDT TABLE USED                                                *
  1197*  CDT FACTOR USED                                               *
  1198*  PAY TO CURRENT RESERVE                                        *
  1199*  I.B.N.R. - A/H ONLY                                           *
  1200*  FUTURE (ACCRUED) AH ONLY                                      *
  1201*----------------------------------------------------------------*
  1202*  PASSED TO ELRATE                                              *
  1203*  ----------------                                              *
  1204*  CERT ISSUE DATE                                               *
  1205*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1206*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1207*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1208*  STATE CODE (CLIENT DEFINED)                                   *
  1209*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1210*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1211*  DEVIATION CODE                                                *
  1212*  ISSUE AGE                                                     *
  1213*  ORIGINAL BENEFIT AMOUNT                                       *
  1214*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1215*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1216*  BENEFIT KIND (LIFE OR A/H)                                    *
  1217*  A.P.R.                                                        *
  1218*  METHOD
  1219*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1220*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1221*  COMPANY I.D. (3 CHARACTER)                                    *
  1222*  BENEFIT CODE                                                  *
  1223*  BENEFIT OVERRIDE CODE                                         *
  1224*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1225*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1226*  JOINT INDICATOR (CSL ONLY)                                    *
  1227*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1228*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1229*                                                                *
  1230*  RETURNED FROM ELRATE                                          *
  1231*  --------------------                                          *
  1232*  CALCULATED PREMIUM                                            *
  1233*  PREMIUM RATE                                                  *
  1234*  MORTALITY CODE                                                *
  1235*  MAX ATTAINED AGE                                              *
  1236*  MAX AGE                                                       *
  1237*  MAX TERM                                                      *
  1238*  MAX MONTHLY BENEFIT                                           *
  1239*  MAX TOTAL BENIFIT                                             *
  1240*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1241*----------------------------------------------------------------*
  1242*  PASSED TO ELRFND                                              *
  1243*  ----------------                                              *
  1244*  CERT ISSUE DATE                                               *
  1245*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL156.cbl
  1246*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1247*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1248*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1249*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1250*  STATE CODE (CLIENT DEFINED)                                   *
  1251*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1252*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1253*  DEVIATION CODE                                                *
  1254*  ISSUE AGE                                                     *
  1255*  ORIGINAL BENEFIT AMOUNT                                       *
  1256*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1257*  PROCESS TYPE (CANCEL)                                         *
  1258*  BENEFIT KIND (LIFE OR A/H)                                    *
  1259*  A.P.R.                                                        *
  1260*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1261*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1262*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1263*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1264*  COMPANY I.D. (3 CHARACTER)                                    *
  1265*  BENEFIT CODE                                                  *
  1266*  BENEFIT OVERRIDE CODE                                         *
  1267*                                                                *
  1268*  RETURNED FROM ELRFND                                          *
  1269*  --------------------                                          *
  1270*  CALCULATED REFUND                                             *
  1271*----------------------------------------------------------------*
  1272*  PASSED TO ELEARN                                              *
  1273*  ----------------                                              *
  1274*  CERT ISSUE DATE                                               *
  1275*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1276*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1277*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1278*  STATE CODE (CLIENT DEFINED)                                   *
  1279*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1280*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1281*  DEVIATION CODE                                                *
  1282*  ISSUE AGE                                                     *
  1283*  ORIGINAL BENEFIT AMOUNT                                       *
  1284*  BENEFIT KIND (LIFE OR A/H)                                    *
  1285*  A.P.R.                                                        *
  1286*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1287*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1288*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1289*  COMPANY I.D. (3 CHARACTER)                                    *
  1290*  BENEFIT CODE                                                  *
  1291*  BENEFIT OVERRIDE CODE                                         *
  1292*                                                                *
  1293*  RETURNED FROM ELEARN                                          *
  1294*  --------------------                                          *
  1295*  INDICATED  EARNINGS                                           *
  1296*----------------------------------------------------------------*
  1297*                 LENGTH = 450                                   *
  1298*                                                                *
  1299******************************************************************
  1300******************************************************************
  1301*                   C H A N G E   L O G
  1302*
  1303* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL156.cbl
  1304*-----------------------------------------------------------------
  1305*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1306* EFFECTIVE    NUMBER
  1307*-----------------------------------------------------------------
  1308* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1309* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1310* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1311* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1312* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1313* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1314* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1315* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1316* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1317******************************************************************
  1318
  1319 01  CALCULATION-PASS-AREA.
  1320     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1321                                     COMP.
  1322
  1323     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1324       88  NO-CP-ERROR                             VALUE ZERO.
  1325       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1326                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1327       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1328       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1329       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1330       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1331       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1332       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1333       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1334       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1335       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1336       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1337       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1338       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1339       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1340       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1341       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1342       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1343       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1344
  1345     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1346       88  NO-CP-ERROR-2                           VALUE ZERO.
  1347***********************  INPUT AREAS ****************************
  1348
  1349     12  CP-CALCULATION-AREA.
  1350         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1351         16  CP-CERT-EFF-DT        PIC XX.
  1352         16  CP-VALUATION-DT       PIC XX.
  1353         16  CP-PAID-THRU-DT       PIC XX.
  1354         16  CP-BENEFIT-TYPE       PIC X.
  1355           88  CP-AH                               VALUE 'A' 'D'
  1356                                                   'I' 'U'.
  1357           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1358           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1359         16  CP-INCURRED-DT        PIC XX.
  1360         16  CP-REPORTED-DT        PIC XX.
  1361         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL156.cbl
  1362         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1363         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1364                                     COMP-3.
  1365         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1366                                     COMP-3.
  1367         16  CP-CDT-METHOD         PIC X.
  1368           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1369           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1370           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1371         16  CP-CLAIM-TYPE         PIC X.
  1372           88  CP-AH-CLAIM                         VALUE 'A'.
  1373           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1374         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1375                                     COMP-3.
  1376         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1377                                     COMP-3.
  1378         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1379                                     COMP-3.
  1380         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1383                                     COMP-3.
  1384         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-REM-TERM-METHOD    PIC X.
  1389           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1390           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1391           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1392           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1393           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1394           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1395           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1396         16  CP-EARNING-METHOD     PIC X.
  1397           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1398           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1399           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1400           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1401           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1402           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1403           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1404           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1405           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1406           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1407           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1408           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1409           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1410           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1411         16  CP-PROCESS-TYPE       PIC X.
  1412           88  CP-CLAIM                            VALUE '1'.
  1413           88  CP-CANCEL                           VALUE '2'.
  1414           88  CP-ISSUE                            VALUE '3'.
  1415         16  CP-SPECIAL-CALC-CD    PIC X.
  1416           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1417           88  CP-1-MTH-INTEREST               VALUE ' '.
  1418           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1419           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL156.cbl
  1420           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1421           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1422           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1423           88  CP-FARM-PLAN                    VALUE 'F'.
  1424           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1425           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1426           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1427           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1428           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1429           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1430           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1431           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1432           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1433           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1434                                                     'W' 'X'.
  1435           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1436           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1437           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1438           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1439           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1440           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1441           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1442           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1443           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1444           88  CP-CSL-METH-1                   VALUE '5'.
  1445           88  CP-CSL-METH-2                   VALUE '6'.
  1446           88  CP-CSL-METH-3                   VALUE '7'.
  1447           88  CP-CSL-METH-4                   VALUE '8'.
  1448
  1449         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1450                                     COMP-3.
  1451         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1452         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1453         16  CP-STATE              PIC XX          VALUE SPACE.
  1454         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1455         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1456           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1457               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1458         16  CP-R78-OPTION         PIC X.
  1459           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1460           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1461
  1462         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1463         16  CP-IBNR-RESERVE-SW    PIC X.
  1464         16  CP-CLAIM-STATUS       PIC X.
  1465         16  CP-RATE-FILE          PIC X.
  1466         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1467                                     COMP-3.
  1468
  1469         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1470         16  CP-AH-OVERRIDE-CODE   PIC X.
  1471
  1472         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1473                                     COMP-3.
  1474         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1475                                   PIC S9(5)V99 COMP-3.
  1476         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1477                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL156.cbl
  1478         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1479                                     COMP-3.
  1480         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1481                                     COMP-3.
  1482         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1483                                  PIC S9(7)V99 COMP-3.
  1484
  1485         16  CP-PAID-FROM-DATE     PIC X(02).
  1486         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1487         16  CP-EXT-DAYS-CALC      PIC X.
  1488           88  CP-EXT-NO-CHG                   VALUE ' '.
  1489           88  CP-EXT-CHG-LF                   VALUE '1'.
  1490           88  CP-EXT-CHG-AH                   VALUE '2'.
  1491           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1492         16  CP-DOMICILE-STATE     PIC XX.
  1493         16  CP-CARRIER            PIC X.
  1494         16  CP-REIN-FLAG          PIC X.
  1495         16  CP-REM-TRM-CALC-OPTION PIC X.
  1496           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1497                      '2' '3' '4' '5'.
  1498           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1499           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1500           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1501           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1502           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1503           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1504           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1505           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1506         16  CP-SIG-SWITCH         PIC X.
  1507         16  CP-RATING-METHOD      PIC X.
  1508           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1509           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1510           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1511           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1512           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1513           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1514           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1515           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1516           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1517         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1518                                     COMP-3.
  1519         16  CP-BEN-CATEGORY       PIC X.
  1520         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1521         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1522                                   PIC S99V9(5) COMP-3.
  1523         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1524         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1525                                   PIC S99V9(5) COMP-3.
  1526         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1527         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1528         16  CP-EXPIRE-DT          PIC XX.
  1529         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1530         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1531         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1532         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1533         16  CP-DDF-SPEC-CALC      PIC X.
  1534             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1535             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL156.cbl
  1536         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1537         16  CP-CANCEL-REASON      PIC X.
  1538         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1539         16  CP-PMT-MODE           PIC X.
  1540         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1541         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1542         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1543         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1544         16  FILLER                PIC X.
  1545
  1546***************    OUTPUT FROM ELRESV   ************************
  1547
  1548         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1549
  1550         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1551                                     COMP-3.
  1552         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1553                                     COMP-3.
  1554         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1555                                     COMP-3.
  1556         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1557                                     COMP-3.
  1558         16  FILLER                PIC X(09).
  1559***************    OUTPUT FROM ELRTRM   *************************
  1560
  1561         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1562                                     COMP-3.
  1563         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1564                                     COMP-3.
  1565         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1568                                     COMP-3.
  1569         16  FILLER                PIC X(12).
  1570
  1571***************    OUTPUT FROM ELRAMT   *************************
  1572
  1573         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1576                                     COMP-3.
  1577         16  FILLER                PIC X(12).
  1578
  1579***************    OUTPUT FROM ELRATE   *************************
  1580
  1581         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1582                                     COMP-3.
  1583         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1584                                     COMP-3.
  1585         16  CP-MORTALITY-CODE     PIC X(4).
  1586         16  CP-RATE-EDIT-FLAG     PIC X.
  1587             88  CP-RATES-NEED-APR                  VALUE '1'.
  1588         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1589                                     COMP-3.
  1590         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1591         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1592         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1593                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL156.cbl
  1594         16  FILLER                PIC X(07).
  1595
  1596***************    OUTPUT FROM ELRFND   *************************
  1597
  1598         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1599                                     COMP-3.
  1600         16  CP-REFUND-TYPE-USED   PIC X.
  1601           88  CP-R-AS-R78                         VALUE '1'.
  1602           88  CP-R-AS-PRORATA                     VALUE '2'.
  1603           88  CP-R-AS-CALIF                       VALUE '3'.
  1604           88  CP-R-AS-TEXAS                       VALUE '4'.
  1605           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1606           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1607           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1608           88  CP-R-AS-MEAN                        VALUE '8'.
  1609           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1610           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1611           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1612           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1613           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1614           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1615         16  FILLER                PIC X(12).
  1616
  1617***************    OUTPUT FROM ELEARN   *************************
  1618
  1619         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1620                                     COMP-3.
  1621         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1622                                     COMP-3.
  1623         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-EARNING-TYPE-USED  PIC X.
  1632           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1633           88  CP-E-AS-R78                         VALUE '1'.
  1634           88  CP-E-AS-PRORATA                     VALUE '2'.
  1635           88  CP-E-AS-TEXAS                       VALUE '4'.
  1636           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1637           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1638           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1639           88  CP-E-AS-MEAN                        VALUE '8'.
  1640           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1641         16  FILLER                PIC X(12).
  1642
  1643***************    OUTPUT FROM ELPMNT   *************************
  1644
  1645         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1646                                     COMP-3.
  1647         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1648                                     COMP-3.
  1649         16  FILLER                PIC X(12).
  1650
  1651***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL156.cbl
  1652         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1653                                     COMP-3.
  1654         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1655                                     COMP-3.
  1656         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1657                                     COMP-3.
  1658         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1659                                     COMP-3.
  1660         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1661                                     COMP-3.
  1662         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1663                                     COMP-3.
  1664         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1665             88  OPEN-RATE-FILE                   VALUE 'O'.
  1666             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1667             88  IO-ERROR                         VALUE 'E'.
  1668
  1669         16  CP-FIRST-PAY-DATE     PIC XX.
  1670
  1671         16  CP-JOINT-INDICATOR    PIC X.
  1672
  1673         16  CP-RESERVE-REMAINING-TERM
  1674                                   PIC S9(4)V9    VALUE ZERO
  1675                                     COMP-3.
  1676
  1677         16  CP-INSURED-BIRTH-DT   PIC XX.
  1678
  1679         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1680                                     COMP-3.
  1681
  1682         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1683                                     COMP-3.
  1684
  1685         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1686                                     COMP-3.
  1687
  1688         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1689                                     COMP-3.
  1690
  1691         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1692                                     COMP-3.
  1693
  1694         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1695                                     COMP-3.
  1696
  1697         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1698                                     COMP-3.
  1699
  1700         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1701             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1702
  1703         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1704                                     COMP-3.
  1705         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1706                                     COMP-3.
  1707         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1708         16  FILLER                PIC X(15).
  1709******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL156.cbl
  1710*    COPY ELCICALC.
  1711******************************************************************
  1712*                                                                *
  1713*                           ELCCICALC.                           *
  1714*                            VMOD=2.001                          *
  1715*                                                                *
  1716*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1717*                 CALCULATION MODULE                             *
  1718*                                                                *
  1719*  PASSED TO ELCLMI                                              *
  1720*  -----------------                                             *
  1721*  STATE                                                         *
  1722*  PRODUCT                                                       *
  1723*  COVERAGE                                                      *
  1724*  EFFECTIVE DATE                                                *
  1725*  INCURRED DATE                                                 *
  1726*  ESTABLISHED DATE                                              *
  1727*  LAST PAID DATE                                                *
  1728*  REPORTED DATE                                                 *
  1729*  CLAIM PAYMENT AMOUNT                                          *
  1730*                                                                *
  1731*  RETURNED FROM ELRTRM                                          *
  1732*  ---------------------                                         *
  1733*  RETURN CODE                                                   *
  1734*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1735*  CLAIM INTEREST AMOUNT                                         *
  1736*----------------------------------------------------------------*
  1737*----------------------------------------------------------------*
  1738*                 LENGTH = 100                                   *
  1739*                                                                *
  1740******************************************************************
  1741******************************************************************
  1742*                   C H A N G E   L O G
  1743*
  1744* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1745*-----------------------------------------------------------------
  1746*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1747* EFFECTIVE    NUMBER
  1748*-----------------------------------------------------------------
  1749* 120905    2004040700004  PEMA  NEW COPYBOOK
  1750* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1751******************************************************************
  1752
  1753 01  CLAIM-INT-PASS-AREA.
  1754     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1755                                     COMP.
  1756
  1757     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1758       88  NO-CI-ERROR                             VALUE ZERO.
  1759       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1760       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1761       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1762       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1763       88  CP-AMT-LT-5000                          VALUE '4'.
  1764       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1765       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1766       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1767       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL156.cbl
  1768***********************  INPUT AREAS ****************************
  1769
  1770     12  CP-CALCULATION-AREA.
  1771         16  CP-COMPANY-CD         PIC X.
  1772         16  CP-STATE              PIC XX.
  1773         16  CP-PRODUCT            PIC XX.
  1774         16  CP-COVERAGE           PIC XX.
  1775         16  CP-INC-DT             PIC XX.
  1776         16  CP-EST-DT             PIC XX.
  1777         16  CP-LSTPD-DT           PIC XX.
  1778         16  CP-RPT-DT             PIC XX.
  1779         16  CP-PRF-DT             PIC XX.
  1780         16  CP-EFF-DT             PIC XX.
  1781         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1782         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1783         16  FILLER                PIC X(37).
  1784
  1785***************    OUTPUT FROM ELCLMI   ************************
  1786
  1787         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1788
  1789         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1790         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1791         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1792         16  FILLER                PIC X(19).
  1793******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL156.cbl
  1795*    COPY ELCATTR.
  1796******************************************************************
  1797*                                                                *
  1798*                            ELCATTR.                            *
  1799*                            VMOD=2.001                          *
  1800*                                                                *
  1801*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1802*                                                                *
  1803*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1804*                                                                *
  1805*                   POS 1   P=PROTECTED                          *
  1806*                           U=UNPROTECTED                        *
  1807*                           S=ASKIP                              *
  1808*                   POS 2   A=ALPHA/NUMERIC                      *
  1809*                           N=NUMERIC                            *
  1810*                   POS 3   N=NORMAL                             *
  1811*                           B=BRIGHT                             *
  1812*                           D=DARK                               *
  1813*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1814*                           OF=MODIFIED DATA TAG OFF             *
  1815*                                                                *
  1816*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1817******************************************************************
  1818 01  ATTRIBUTE-LIST.
  1819     12  AL-PABOF            PIC X       VALUE 'Y'.
  1820     12  AL-PABON            PIC X       VALUE 'Z'.
  1821     12  AL-PADOF            PIC X       VALUE '%'.
  1822     12  AL-PADON            PIC X       VALUE '_'.
  1823     12  AL-PANOF            PIC X       VALUE '-'.
  1824     12  AL-PANON            PIC X       VALUE '/'.
  1825     12  AL-SABOF            PIC X       VALUE '8'.
  1826     12  AL-SABON            PIC X       VALUE '9'.
  1827     12  AL-SADOF            PIC X       VALUE '@'.
  1828     12  AL-SADON            PIC X       VALUE QUOTE.
  1829     12  AL-SANOF            PIC X       VALUE '0'.
  1830     12  AL-SANON            PIC X       VALUE '1'.
  1831     12  AL-UABOF            PIC X       VALUE 'H'.
  1832     12  AL-UABON            PIC X       VALUE 'I'.
  1833     12  AL-UADOF            PIC X       VALUE '<'.
  1834     12  AL-UADON            PIC X       VALUE '('.
  1835     12  AL-UANOF            PIC X       VALUE ' '.
  1836     12  AL-UANON            PIC X       VALUE 'A'.
  1837     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1838     12  AL-UNBON            PIC X       VALUE 'R'.
  1839     12  AL-UNDOF            PIC X       VALUE '*'.
  1840     12  AL-UNDON            PIC X       VALUE ')'.
  1841     12  AL-UNNOF            PIC X       VALUE '&'.
  1842     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL156.cbl
  1844*    COPY ELCEMIB.
  1845******************************************************************
  1846*                                                                *
  1847*                                                                *
  1848*                            ELCEMIB.                            *
  1849*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1850*                            VMOD=2.005                          *
  1851*                                                                *
  1852*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1853*                                                                *
  1854******************************************************************
  1855 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1856     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1857     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1858     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1859     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1860     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1861     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1862     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1863     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1864     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1865         88  EMI-NO-ERRORS                    VALUE '1'.
  1866         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1867         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1868     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1869         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1870     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1871         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1872         88  EMI-AREA1-FULL                   VALUE '2'.
  1873     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1874         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1875         88  EMI-AREA2-FULL                   VALUE '2'.
  1876     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1877         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1878         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1879         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1880         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1881         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1882     12  EMI-ERROR-LINES.
  1883         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1884         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1885         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1886         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1887             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1888                 24  EMI-ERR-NUM         PIC X(4).
  1889                 24  EMI-FILLER          PIC X.
  1890                 24  EMI-SEV             PIC X.
  1891                 24  FILLER              PIC X.
  1892             20  FILLER                  PIC X(02).
  1893     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1894         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1895             20  EMI-ERROR-NUMBER    PIC X(4).
  1896             20  EMI-FILL            PIC X.
  1897             20  EMI-SEVERITY        PIC X.
  1898             20  FILLER              PIC X.
  1899             20  EMI-ERROR-TEXT.
  1900                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1901                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL156.cbl
  1902     12  EMI-SEVERITY-SAVE           PIC X.
  1903         88  EMI-NOTE                    VALUE 'N'.
  1904         88  EMI-WARNING                 VALUE 'W'.
  1905         88  EMI-FORCABLE                VALUE 'F'.
  1906         88  EMI-FATAL                   VALUE 'X'.
  1907     12  EMI-MESSAGE-FLAG            PIC X.
  1908         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1909         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1910     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1911     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1912         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1913         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1914         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1915     12  emi-claim-no                pic x(7).
  1916     12  emi-claim-type              pic x(6).
  1917     12  FILLER                      PIC X(124)  VALUE SPACES.
  1918     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1919     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1920     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1921     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL156.cbl
  1923*    COPY ELCLNKLT.
  1924******************************************************************
  1925*                                                                *
  1926*                                                                *
  1927*                           ELCLNKLT                             *
  1928*                            VMOD=2.003                          *
  1929*                                                                *
  1930*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1931*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1932*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1933*                                                                *
  1934*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1935*   COMPLETING THE REQUIRED FIELDS.                              *
  1936*                                                                *
  1937*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1938*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1939*                              9999 INDICATES AN UNKNOWN ABEND   *
  1940*                                   WAS DETECTED.                *
  1941*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1942*                              CODES FOUND IN THE ERROR FILE.    *
  1943******************************************************************
  1944 01  W-1523-LINKDATA.
  1945     12  W-1523-COMMON-PI-DATA.
  1946         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1947         16  FILLER              PIC  X(67).
  1948         16  W-1523-COMPANY-CD   PIC  X(01).
  1949         16  FILLER              PIC  X(10).
  1950         16  W-1523-CONTROL-IN-PROGRESS.
  1951             20  W-1523-CARRIER  PIC  X(01).
  1952             20  W-1523-GROUPING PIC  X(06).
  1953             20  W-1523-STATE    PIC  X(02).
  1954             20  W-1523-ACCOUNT  PIC  X(10).
  1955             20  W-1523-CLAIM-CERT-GRP.
  1956                 24  W-1523-CLAIM-NO
  1957                                 PIC  X(07).
  1958                 24  W-1523-CERT-NO.
  1959                     28  W-1523-CERT-PRIME
  1960                                 PIC  X(10).
  1961                     28  W-1523-CERT-SFX
  1962                                 PIC  X(01).
  1963                 24  W-1523-CERT-EFF-DT
  1964                                 PIC  X(02).
  1965         16  FILLER              PIC X(265).
  1966
  1967     12  W-1523-WORK-AREA.
  1968         16  W-1523-FORM-NUMBER  PIC  X(04).
  1969         16  W-1523-NUMBER-COPIES
  1970                                 PIC  9(01).
  1971         16  W-1523-ADDR-TYPE    PIC  X(02).
  1972         16  W-1523-FOLLOW-UP-DATE
  1973                                 PIC  X(02).
  1974         16  W-1523-RESEND-DATE  PIC  X(02).
  1975         16  W-1523-ERROR-CODE   PIC  9(04).
  1976             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1977             88  W-1523-FATAL-ERROR
  1978                                    VALUES  0006 0013 0042
  1979                                            0154 0168 0169
  1980                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL156.cbl
  1981                                            0179 0186 0281
  1982                                            0332 2055 3697
  1983                                            3698 3699 3770
  1984                                            3771 3772 7675
  1985                                            9106 9808 9883
  1986                                            9887.
  1987             88  W-1523-STOP-ERRORS
  1988                                    VALUES  0013 0042 0154
  1989                                            0168 0169 0172
  1990                                            0281 0332 2055
  1991                                            3698 3699 7675
  1992                                            9106 9808 9883
  1993                                            9999.
  1994         16  W-1523-REASON       PIC  X(70).
  1995         16  W-1523-ARCHIVE-NUMBER
  1996                                 PIC  9(08).
  1997     12  W-1523-POINTER-AREA.
  1998         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1999         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2000         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2001         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2002         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL156.cbl
  2004*    COPY ELCNWA.
  2005*****************************************************************
  2006*                                                               *
  2007*                                                               *
  2008*                            ELCNWA.                            *
  2009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2010*                            VMOD=2.003                         *
  2011*                                                               *
  2012*            M O V E   N A M E   W O R K   A R E A.             *
  2013*                                                               *
  2014*****************************************************************.
  2015
  2016 01  WS-NAME-WORK-AREA.
  2017     05  WS-INSURED-LAST-NAME        PIC X(15).
  2018     05  WS-INSURED-1ST-NAME         PIC X(12).
  2019     05  WS-INSURED-MID-INIT         PIC X.
  2020
  2021     05  WS-NAME-WORK.
  2022         10  WS-NW                   PIC X
  2023             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2024
  2025     05  WS-NAME-WORK2.
  2026         10  WS-NW2                  PIC X
  2027             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2028                                        NWA-INDEX0.
  2029
  2030     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2031                                     COMP-3.
  2032
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL156.cbl
  2034*    COPY ELCDMO.
  2035******************************************************************
  2036*                                                                *
  2037*                                                                *
  2038*                            ELCDMO.                             *
  2039*                            VMOD=2.004                          *
  2040*                                                                *
  2041*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2042*        COMMUNICATION AREA                                      *
  2043*   FILE TYPE = NA                                               *
  2044*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2045*                                                                *
  2046******************************************************************
  2047 01  DMO-COMMUNICATION-AREA.
  2048     12  DM-RECORD-TYPE                  PIC  X(02).
  2049             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2050             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2051             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2052     12  DM-DIST-CODE                    PIC  X(04).
  2053     12  DM-MAIL-CODE                    PIC  X(05).
  2054     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2055     12  DM-INSURED-NAME                 PIC  X(30).
  2056     12  DM-CLAIM-NO                     PIC  X(07).
  2057     12  DM-CLAIM-TYPE                   PIC  X.
  2058
  2059     12  DM-STATUS-DATA-AREA.
  2060         16  DM-CLAIM-STATUS             PIC  X.
  2061             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2062             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2063             88  DM-CLOSED                        VALUE '3'.
  2064             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2065             88  DM-DEFAULT                       VALUE '9'.
  2066         16  DM-STATUS-DATE              PIC  X(08).
  2067******YYYYMMDD
  2068         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2069             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2070             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2071             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2072             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2073             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2074             88  DM-RE-OPENED                     VALUE 'R'.
  2075             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2076             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2077             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2078         16  DM-STAT-CARRIER             PIC X.
  2079
  2080     12  DM-DRAFT-DATA-AREA.
  2081         16  DM-PAYMENT-TYPE             PIC  X.
  2082             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2083         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2084         16  DM-PAYMENT-DATE             PIC  X(08).
  2085******YYYYMMDD
  2086         16  DM-CERT-NO                  PIC  X(11).
  2087         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2088         16  DM-CARRIER                  PIC  X.
  2089
  2090     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL156.cbl
  2092*    COPY ELCDMDCD.
  2093******************************************************************
  2094*                                                                *
  2095*                                                                *
  2096*                            ELCDMDCD.                           *
  2097*                            VMOD=2.001                          *
  2098*                                                                *
  2099*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2100*       COMMUNICATIONS AREA                                      *
  2101*                                                                *
  2102******************************************************************
  2103 01  CD-COMMUNICATION-AREA.
  2104     12  CD-SYSTEM-ID            PIC  X(02).
  2105         88 CD-CLAIMS                      VALUE 'CL'.
  2106         88 CD-CREDIT                      VALUE 'CR'.
  2107     12  CD-RECORD-TYPE          PIC  X(02).
  2108         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2109         88 CD-EOB-CODE                    VALUE 'EO'.
  2110         88 CD-ICD9-CODE                   VALUE 'I9'.
  2111         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2112         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2113         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2114         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2115         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2116     12  CD-RECORD-KEY           PIC  X(06).
  2117         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2118     12  CD-RETURN-CODE          PIC  X(02).
  2119     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2120     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2121     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2122     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL156.cbl
  2124*    COPY ELCDCTB.
  2125******************************************************************
  2126*                                                                *
  2127*                                                                *
  2128*                            ELCDCTB.                            *
  2129*                            VMOD=2.002                          *
  2130*                                                                *
  2131*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2132*       COMMUNICATIONS AREA                                      *
  2133*                                                                *
  2134******************************************************************
  2135 01  DCT-COMMUNICATION-AREA.
  2136     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2137     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2138     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2139     12  DCT-PRODUCT-CODE         PIC  X(02).
  2140     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2141     12  DCT-RETURN-CODE          PIC  X(02).
  2142     12  DCT-MAIL-CODE            PIC  X(05).
  2143     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2144     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL156.cbl
  2146 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2147 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2148 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2149 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL156.cbl
  2151*    COPY ELCINTF.
  2152******************************************************************
  2153*                                                                *
  2154*                                                                *
  2155*                            ELCINTF.                            *
  2156*                            VMOD=2.017                          *
  2157*                                                                *
  2158*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2159*                                                                *
  2160*       LENGTH = 1024                                            *
  2161*                                                                *
  2162******************************************************************
  2163*                   C H A N G E   L O G
  2164*
  2165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2166*-----------------------------------------------------------------
  2167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2168* EFFECTIVE    NUMBER
  2169*-----------------------------------------------------------------
  2170* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2171******************************************************************
  2172 01  PROGRAM-INTERFACE-BLOCK.
  2173     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2174     12  PI-CALLING-PROGRAM              PIC X(8).
  2175     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2176     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2177     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2178     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2179     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2180     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2181     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2182     12  PI-COMPANY-ID                   PIC XXX.
  2183     12  PI-COMPANY-CD                   PIC X.
  2184
  2185     12  PI-COMPANY-PASSWORD             PIC X(8).
  2186
  2187     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2188
  2189     12  PI-CONTROL-IN-PROGRESS.
  2190         16  PI-CARRIER                  PIC X.
  2191         16  PI-GROUPING                 PIC X(6).
  2192         16  PI-STATE                    PIC XX.
  2193         16  PI-ACCOUNT                  PIC X(10).
  2194         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2195                                         PIC X(10).
  2196         16  PI-CLAIM-CERT-GRP.
  2197             20  PI-CLAIM-NO             PIC X(7).
  2198             20  PI-CERT-NO.
  2199                 25  PI-CERT-PRIME       PIC X(10).
  2200                 25  PI-CERT-SFX         PIC X.
  2201             20  PI-CERT-EFF-DT          PIC XX.
  2202         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2203             20  PI-PLAN-CODE            PIC X(2).
  2204             20  PI-REVISION-NUMBER      PIC X(3).
  2205             20  PI-PLAN-EFF-DT          PIC X(2).
  2206             20  PI-PLAN-EXP-DT          PIC X(2).
  2207             20  FILLER                  PIC X(11).
  2208         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL156.cbl
  2209             20  PI-OE-REFERENCE-1.
  2210                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2211                 25  PI-OE-REF-1-SUFF    PIC XX.
  2212
  2213     12  PI-SESSION-IN-PROGRESS          PIC X.
  2214         88  CLAIM-SESSION                   VALUE '1'.
  2215         88  CREDIT-SESSION                  VALUE '2'.
  2216         88  WARRANTY-SESSION                VALUE '3'.
  2217         88  MORTGAGE-SESSION                VALUE '4'.
  2218         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2219
  2220
  2221*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2222
  2223     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2224     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2225
  2226     12  PI-CREDIT-USER                  PIC X.
  2227         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2228         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2229
  2230     12  PI-CLAIM-USER                   PIC X.
  2231         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2232         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2233
  2234     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2235         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2236         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2237         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2238         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2239         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2240
  2241     12  PI-PROCESSOR-ID                 PIC X(4).
  2242
  2243     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2244
  2245     12  PI-MEMBER-CAPTION               PIC X(10).
  2246
  2247     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2248         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2249
  2250     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2251     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2252     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2253     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2254
  2255     12  PI-AH-OVERRIDE-L1               PIC X.
  2256     12  PI-AH-OVERRIDE-L2               PIC XX.
  2257     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2258     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2259
  2260     12  PI-NEW-SYSTEM                   PIC X(2).
  2261
  2262     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2263     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2264         88  PI-USES-PAID-TO                 VALUE '1'.
  2265     12  PI-CRDTCRD-SYSTEM.
  2266         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL156.cbl
  2267             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2268             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2269         16  PI-CC-MONTH-END-DT          PIC XX.
  2270     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2271
  2272     12  PI-OE-REFERENCE-2.
  2273         16  PI-OE-REF-2-PRIME           PIC X(10).
  2274         16  PI-OE-REF-2-SUFF            PIC X.
  2275
  2276     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2277
  2278     12  PI-LANGUAGE-TYPE                PIC X.
  2279             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2280             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2281             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2282
  2283     12  PI-POLICY-LINKAGE-IND           PIC X.
  2284         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2285         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2286                                                   LOW-VALUES.
  2287
  2288     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2289     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2290         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2291         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2292
  2293     12  PI-PROCESSOR-CSR-IND            PIC X.
  2294         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2295         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2296
  2297     12  FILLER                          PIC X(3).
  2298
  2299     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2300
  2301     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2302         PI-SYSTEM-LEVEL.
  2303
  2304         16  PI-ENTRY-CODES.
  2305             20  PI-ENTRY-CD-1           PIC X.
  2306             20  PI-ENTRY-CD-2           PIC X.
  2307
  2308         16  PI-RETURN-CODES.
  2309             20  PI-RETURN-CD-1          PIC X.
  2310             20  PI-RETURN-CD-2          PIC X.
  2311
  2312         16  PI-UPDATE-STATUS-SAVE.
  2313             20  PI-UPDATE-BY            PIC X(4).
  2314             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2315
  2316         16  PI-LOWER-CASE-LETTERS       PIC X.
  2317             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2318
  2319*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2320*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2321*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2322
  2323         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2324             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL156.cbl
  2325             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2326             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2327             88  ACCNT-CNTL                  VALUE '3'.
  2328             88  CARR-ACCNT-CNTL             VALUE '4'.
  2329
  2330         16  PI-PROCESSOR-CAP-LIST.
  2331             20  PI-SYSTEM-CONTROLS.
  2332                24 PI-SYSTEM-DISPLAY     PIC X.
  2333                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2334                24 PI-SYSTEM-MODIFY      PIC X.
  2335                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2336             20  FILLER                  PIC XX.
  2337             20  PI-DISPLAY-CAP          PIC X.
  2338                 88  DISPLAY-CAP             VALUE 'Y'.
  2339             20  PI-MODIFY-CAP           PIC X.
  2340                 88  MODIFY-CAP              VALUE 'Y'.
  2341             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2342                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2343             20  PI-FORCE-CAP            PIC X.
  2344                 88  FORCE-CAP               VALUE 'Y'.
  2345
  2346         16  PI-PROGRAM-CONTROLS.
  2347             20  PI-PGM-PRINT-OPT        PIC X.
  2348             20  PI-PGM-FORMAT-OPT       PIC X.
  2349             20  PI-PGM-PROCESS-OPT      PIC X.
  2350             20  PI-PGM-TOTALS-OPT       PIC X.
  2351
  2352         16  PI-HELP-INTERFACE.
  2353             20  PI-LAST-ERROR-NO        PIC X(4).
  2354             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2355
  2356         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2357             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2358
  2359         16  PI-CR-CONTROL-IN-PROGRESS.
  2360             20  PI-CR-CARRIER           PIC X.
  2361             20  PI-CR-GROUPING          PIC X(6).
  2362             20  PI-CR-STATE             PIC XX.
  2363             20  PI-CR-ACCOUNT           PIC X(10).
  2364             20  PI-CR-FIN-RESP          PIC X(10).
  2365             20  PI-CR-TYPE              PIC X.
  2366
  2367         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2368
  2369         16  PI-CR-MONTH-END-DT          PIC XX.
  2370
  2371         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2372             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2373             88  PI-ZERO-CARRIER             VALUE '1'.
  2374             88  PI-ZERO-GROUPING            VALUE '2'.
  2375             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2376
  2377         16  PI-CARRIER-SECURITY         PIC X.
  2378             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2379
  2380         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2381             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2382             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL156.cbl
  2383
  2384         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2385             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2386                                         INDEXED BY PI-ACCESS-NDX
  2387                                         PIC X.
  2388
  2389         16  PI-GA-BILLING-CONTROL       PIC X.
  2390             88  PI-GA-BILLING               VALUE '1'.
  2391
  2392         16  PI-MAIL-PROCESSING          PIC X.
  2393             88  PI-MAIL-YES                 VALUE 'Y'.
  2394
  2395         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2396
  2397         16  PI-AR-SYSTEM.
  2398             20  PI-AR-PROCESSING-CNTL   PIC X.
  2399                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2400             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2401             20  PI-AR-MONTH-END-DT      PIC XX.
  2402
  2403         16  PI-MP-SYSTEM.
  2404             20  PI-MORTGAGE-USER            PIC X.
  2405                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2406                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2407             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2408                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2409                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2410                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2411                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2412                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2413             20  PI-MP-MONTH-END-DT          PIC XX.
  2414             20  PI-MP-REFERENCE-NO.
  2415                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2416                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2417
  2418         16  PI-LABEL-CONTROL            PIC X(01).
  2419             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2420             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2421
  2422         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2423             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2424
  2425         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2426             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2427             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2428
  2429         16  FILLER                      PIC X(14).
  2430
  2431     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2432******************************************************************
  2433     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2434         16  PI-SAVE-FORM        PIC X(12).
  2435         16  PI-ACCT-KEY         PIC X(26).
  2436         16  PI-PAYEE-NAME       PIC X(30).
  2437         16  PI-DAILY-RATE       PIC S9(3)V99.
  2438         16  PI-MONTH-END-SAVE   PIC XX.
  2439         16  PI-BENEFIT-SAVE.
  2440             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL156.cbl
  2441             20  PI-BEN-TYPE     PIC X.
  2442         16  PI-MANUAL-SW        PIC 9.
  2443         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2444         16  PI-PASS-SW          PIC X.
  2445         16  PI-PFKEY-USED       PIC X.
  2446         16  PI-CK-ASSIGN        PIC X.
  2447         16  PI-FATAL-COUNT      PIC 99.
  2448         16  PI-FORCE-COUNT      PIC 99.
  2449         16  PI-SAVE-INPUT.
  2450             20  PI-PMTTYPE      PIC X.
  2451             20  PI-PAYEE.
  2452                 24  PI-PAYEE-TYPE PIC X.
  2453                 24  PI-PAYEE-SEQ  PIC X.
  2454                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2455                   PI-PAYEE-SEQ    PIC S9.
  2456             20  PI-PMTNOTE1     PIC X(60).
  2457             20  PI-PMTNOTE2     PIC X(60).
  2458             20  PI-OFFLINE      PIC X.
  2459             20  PI-ECHECKNO     PIC X(7).
  2460             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2461                 28  PI-ECHECKNO-N     PIC X.
  2462                 28  PI-ECHECKNO-6     PIC X(6).
  2463             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2464                 24  PI-ECHECKNO-CR    PIC XX.
  2465                 24  PI-ECHECKNO-5     PIC X(5).
  2466             20  PI-HOLDTIL      PIC 9(6).
  2467             20  PI-EPYFROM      PIC 9(6).
  2468             20  PI-EPYTHRU      PIC 9(6).
  2469             20  PI-EDAYS        PIC S9(5).
  2470             20  PI-EPYAMT       PIC S9(7)V99.
  2471             20  PI-ERESV        PIC S9(7)V99.
  2472             20  PI-EEXPENS      PIC 9(6)V99.
  2473             20  PI-ETYPE        PIC X.
  2474             20  PI-CASH         PIC X.
  2475             20  PI-GROUPED      PIC X.
  2476             20  PI-INT-RATE     PIC S99V9(5).
  2477             20  PI-AIGFROM      PIC 9(6).
  2478             20  PI-LOAN-NO      PIC X(20).
  2479             20  PI-PROOF-DATE   PIC 9(6).
  2480             20  PI-PRINT-EOB-YN PIC X.
  2481             20  PI-PRINT-CLM-FRM-YN PIC X.
  2482             20  PI-PRINT-SURVEY-YN PIC X.
  2483             20  PI-SPECIAL-RELEASE-YN PIC X.
  2484         16  PI-SAVE-COMPUTED.
  2485             20  PI-CCHECKNO     PIC X(7).
  2486             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2487                 28  PI-CCHECKNO-N     PIC X.
  2488                 28  PI-CCHECKNO-6     PIC X(6).
  2489             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2490                 24  PI-CCHECKNO-CR    PIC XX.
  2491                 24  PI-CCHECKNO-5     PIC X(5).
  2492             20  PI-CPYFROM      PIC XX.
  2493             20  PI-CPYTHRU      PIC XX.
  2494             20  PI-CDAYS        PIC S9(5).
  2495             20  PI-CPYAMT       PIC S9(7)V99.
  2496             20  PI-CRESV        PIC 9(6)V99.
  2497             20  PI-CEXPENS      PIC 9(6)V99.
  2498             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL156.cbl
  2499                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2500                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2501                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2502         16  PI-PREV-CLMNO       PIC X(7).
  2503         16  PI-LF-COVERAGE-TYPE PIC X.
  2504         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2505         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2506         16  PI-PROVISIONAL-IND  PIC X.
  2507             88 PI-PROV-PMT      VALUE 'P'.
  2508         16  PI-PREV-TRLR-KEY    PIC X(22).
  2509         16  PI-SPLIT-PMT-SW     PIC X.
  2510         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2511         16  PI-ACTIVITY-CODE    PIC 99.
  2512         16  PI-RESET-SW         PIC X.
  2513         16  PI-SPECIAL-BEN-SW   PIC X.
  2514             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2515         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2516         16  PI-EXP-DT           PIC XX.
  2517         16  PI-LOAN-DUE-DAY     PIC 99.
  2518         16  PI-3RD-PARTY-SW     PIC X.
  2519         16  PI-LOAN-UPDATE-SW   PIC X.
  2520
  2521         16  PI-DMD-DATA.
  2522             20  PI-SV-CERT-KEY       PIC X(21).
  2523             20  PI-SV-CERT-NO        PIC X(11).
  2524             20  PI-SV-BEN            PIC X(10).
  2525             20  PI-SV-CCN            PIC X(16).
  2526             20  PI-INTEREST-PAID-IND PIC X.
  2527                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2528             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2529             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2530             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2531             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2532         16  PI-AT-EOB-CODES.
  2533             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2534         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2535         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2536         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2537         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2538         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2539         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2540         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2541         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2542         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2543         16  PI-LF-BENEFIT-CD         PIC X(2).
  2544         16  PI-EOB-CODES-EXIST PIC X.
  2545         16  PI-SET-NOTE2-MDT   PIC X.
  2546         16  PI-VFY-2ND-BENE          PIC X.
  2547         16  PI-CLM-TYPE              PIC X.
  2548         16  PI-APPROVAL-LEVEL        PIC X.
  2549         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2550         16  PI-REAUDIT-NEEDED        PIC X.
  2551         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2552         16  PI-AH-BENEFIT-CD         PIC XX.
  2553         16  pi-ah-term               pic s999 comp-3.
  2554         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2555         16  pi-max-ext               pic 999.
  2556         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL156.cbl
  2557         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2558         16  PI-JOINT-COV-IND         PIC X.
  2559             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2560             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2561         16  PI-JOINT-INSURED-IND     PIC X.
  2562             88  PI-JOINT-INSURED        VALUE 'Y'.
  2563             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2564*00781          16  FILLER                   PIC X(176).
  2565*052506         16  FILLER                   PIC X(161).
  2566*031808         16  FILLER                   PIC X(154).
  2567*091808         16  FILLER                   PIC X(152).
  2568*041710         16  FILLER                   PIC X(94).
  2569         16  FILLER                   PIC X(67).
  2570
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL156.cbl
  2572*    COPY ELCJPFX.
  2573******************************************************************
  2574*                                                                *
  2575*                                                                *
  2576*                            ELCJPFX.                            *
  2577*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2578*                            VMOD=2.002                          *
  2579*                                                                *
  2580*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2581*                                                                *
  2582*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2583*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2584*        ELCNTL - CONTROL FILE                                   *
  2585*        ELMSTR - CLAIM MASTERS                                  *
  2586*        ELTRLR - ACTIVITY TRAILERS                              *
  2587*        ELCHKQ - CHECK QUE                                      *
  2588******************************************************************
  2589 01  JOURNAL-RECORD.
  2590     12  jp-date                     pic s9(5) comp-3.
  2591     12  jp-time                     pic s9(7) comp-3.
  2592     12  JP-USER-ID                  PIC X(4).
  2593     12  JP-FILE-ID                  PIC X(8).
  2594     12  JP-PROGRAM-ID               PIC X(8).
  2595     12  JP-RECORD-TYPE              PIC X.
  2596         88 JP-ADD              VALUE 'A'.
  2597         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2598         88 JP-AFTER-CHANGE     VALUE 'C'.
  2599         88 JP-DELETE           VALUE 'D'.
  2600         88 JP-GENERIC-DELETE   VALUE 'G'.
  2601         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2602         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2603     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2604     12  JP-RECORD-AREA
  2605
  2606
  2607                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL156.cbl
  2609*    COPY ELCAID.
  2610******************************************************************
  2611*                                                                *
  2612*                            ELCAID.                             *
  2613*                            VMOD=2.001                          *
  2614*                                                                *
  2615*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2616*                                                                *
  2617*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2618*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2619******************************************************************
  2620
  2621 01  DFHAID.
  2622   02  DFHNULL   PIC  X  VALUE  ' '.
  2623   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2624   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2625   02  DFHPEN    PIC  X  VALUE  '='.
  2626   02  DFHOPID   PIC  X  VALUE  'W'.
  2627   02  DFHPA1    PIC  X  VALUE  '%'.
  2628   02  DFHPA2    PIC  X  VALUE  '>'.
  2629   02  DFHPA3    PIC  X  VALUE  ','.
  2630   02  DFHPF1    PIC  X  VALUE  '1'.
  2631   02  DFHPF2    PIC  X  VALUE  '2'.
  2632   02  DFHPF3    PIC  X  VALUE  '3'.
  2633   02  DFHPF4    PIC  X  VALUE  '4'.
  2634   02  DFHPF5    PIC  X  VALUE  '5'.
  2635   02  DFHPF6    PIC  X  VALUE  '6'.
  2636   02  DFHPF7    PIC  X  VALUE  '7'.
  2637   02  DFHPF8    PIC  X  VALUE  '8'.
  2638   02  DFHPF9    PIC  X  VALUE  '9'.
  2639   02  DFHPF10   PIC  X  VALUE  ':'.
  2640   02  DFHPF11   PIC  X  VALUE  '#'.
  2641   02  DFHPF12   PIC  X  VALUE  '@'.
  2642   02  DFHPF13   PIC  X  VALUE  'A'.
  2643   02  DFHPF14   PIC  X  VALUE  'B'.
  2644   02  DFHPF15   PIC  X  VALUE  'C'.
  2645   02  DFHPF16   PIC  X  VALUE  'D'.
  2646   02  DFHPF17   PIC  X  VALUE  'E'.
  2647   02  DFHPF18   PIC  X  VALUE  'F'.
  2648   02  DFHPF19   PIC  X  VALUE  'G'.
  2649   02  DFHPF20   PIC  X  VALUE  'H'.
  2650   02  DFHPF21   PIC  X  VALUE  'I'.
  2651*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2652   02  DFHPF22   PIC  X  VALUE  '['.
  2653   02  DFHPF23   PIC  X  VALUE  '.'.
  2654   02  DFHPF24   PIC  X  VALUE  '<'.
  2655   02  DFHMSRE   PIC  X  VALUE  'X'.
  2656   02  DFHSTRF   PIC  X  VALUE  'h'.
  2657   02  DFHTRIG   PIC  X  VALUE  '"'.
  2658 01  FILLER    REDEFINES DFHAID.
  2659     12  FILLER              PIC X(8).
  2660     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL156.cbl
  2662*    COPY EL156S.
  2663 01  EL156AI.
  2664     05  FILLER            PIC  X(0012).
  2665*    -------------------------------
  2666     05  RUNDTEAL PIC S9(0004) COMP.
  2667     05  RUNDTEAF PIC  X(0001).
  2668     05  FILLER REDEFINES RUNDTEAF.
  2669         10  RUNDTEAA PIC  X(0001).
  2670     05  RUNDTEAI PIC  X(0008).
  2671*    -------------------------------
  2672     05  RUNTIMAL PIC S9(0004) COMP.
  2673     05  RUNTIMAF PIC  X(0001).
  2674     05  FILLER REDEFINES RUNTIMAF.
  2675         10  RUNTIMAA PIC  X(0001).
  2676     05  RUNTIMAI PIC  X(0005).
  2677*    -------------------------------
  2678     05  SEQUL PIC S9(0004) COMP.
  2679     05  SEQUF PIC  X(0001).
  2680     05  FILLER REDEFINES SEQUF.
  2681         10  SEQUA PIC  X(0001).
  2682     05  SEQUI PIC  X(0010).
  2683*    -------------------------------
  2684     05  CLMNOL PIC S9(0004) COMP.
  2685     05  CLMNOF PIC  X(0001).
  2686     05  FILLER REDEFINES CLMNOF.
  2687         10  CLMNOA PIC  X(0001).
  2688     05  CLMNOI PIC  X(0007).
  2689*    -------------------------------
  2690     05  CARRL PIC S9(0004) COMP.
  2691     05  CARRF PIC  X(0001).
  2692     05  FILLER REDEFINES CARRF.
  2693         10  CARRA PIC  X(0001).
  2694     05  CARRI PIC  X(0001).
  2695*    -------------------------------
  2696     05  CERTNOL PIC S9(0004) COMP.
  2697     05  CERTNOF PIC  X(0001).
  2698     05  FILLER REDEFINES CERTNOF.
  2699         10  CERTNOA PIC  X(0001).
  2700     05  CERTNOI PIC  X(0010).
  2701*    -------------------------------
  2702     05  SUFXL PIC S9(0004) COMP.
  2703     05  SUFXF PIC  X(0001).
  2704     05  FILLER REDEFINES SUFXF.
  2705         10  SUFXA PIC  X(0001).
  2706     05  SUFXI PIC  X(0001).
  2707*    -------------------------------
  2708     05  CLMTYPL PIC S9(0004) COMP.
  2709     05  CLMTYPF PIC  X(0001).
  2710     05  FILLER REDEFINES CLMTYPF.
  2711         10  CLMTYPA PIC  X(0001).
  2712     05  CLMTYPI PIC  X(0006).
  2713*    -------------------------------
  2714     05  CLMSTATL PIC S9(0004) COMP.
  2715     05  CLMSTATF PIC  X(0001).
  2716     05  FILLER REDEFINES CLMSTATF.
  2717         10  CLMSTATA PIC  X(0001).
  2718     05  CLMSTATI PIC  X(0006).
  2719*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL156.cbl
  2720     05  LSTNMEL PIC S9(0004) COMP.
  2721     05  LSTNMEF PIC  X(0001).
  2722     05  FILLER REDEFINES LSTNMEF.
  2723         10  LSTNMEA PIC  X(0001).
  2724     05  LSTNMEI PIC  X(0015).
  2725*    -------------------------------
  2726     05  FSTNMEL PIC S9(0004) COMP.
  2727     05  FSTNMEF PIC  X(0001).
  2728     05  FILLER REDEFINES FSTNMEF.
  2729         10  FSTNMEA PIC  X(0001).
  2730     05  FSTNMEI PIC  X(0012).
  2731*    -------------------------------
  2732     05  MINITL PIC S9(0004) COMP.
  2733     05  MINITF PIC  X(0001).
  2734     05  FILLER REDEFINES MINITF.
  2735         10  MINITA PIC  X(0001).
  2736     05  MINITI PIC  X(0001).
  2737*    -------------------------------
  2738     05  PRIMHDGL PIC S9(0004) COMP.
  2739     05  PRIMHDGF PIC  X(0001).
  2740     05  FILLER REDEFINES PRIMHDGF.
  2741         10  PRIMHDGA PIC  X(0001).
  2742     05  PRIMHDGI PIC  X(0012).
  2743*    -------------------------------
  2744     05  PCERTNOL PIC S9(0004) COMP.
  2745     05  PCERTNOF PIC  X(0001).
  2746     05  FILLER REDEFINES PCERTNOF.
  2747         10  PCERTNOA PIC  X(0001).
  2748     05  PCERTNOI PIC  X(0010).
  2749*    -------------------------------
  2750     05  PSUFXL PIC S9(0004) COMP.
  2751     05  PSUFXF PIC  X(0001).
  2752     05  FILLER REDEFINES PSUFXF.
  2753         10  PSUFXA PIC  X(0001).
  2754     05  PSUFXI PIC  X(0001).
  2755*    -------------------------------
  2756     05  STATUSL PIC S9(0004) COMP.
  2757     05  STATUSF PIC  X(0001).
  2758     05  FILLER REDEFINES STATUSF.
  2759         10  STATUSA PIC  X(0001).
  2760     05  STATUSI PIC  X(0010).
  2761*    -------------------------------
  2762     05  LOANHL PIC S9(0004) COMP.
  2763     05  LOANHF PIC  X(0001).
  2764     05  FILLER REDEFINES LOANHF.
  2765         10  LOANHA PIC  X(0001).
  2766     05  LOANHI PIC  X(0014).
  2767*    -------------------------------
  2768     05  LOANNOL PIC S9(0004) COMP.
  2769     05  LOANNOF PIC  X(0001).
  2770     05  FILLER REDEFINES LOANNOF.
  2771         10  LOANNOA PIC  X(0001).
  2772     05  LOANNOI PIC  X(0025).
  2773*    -------------------------------
  2774     05  DUEDAYHL PIC S9(0004) COMP.
  2775     05  DUEDAYHF PIC  X(0001).
  2776     05  FILLER REDEFINES DUEDAYHF.
  2777         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL156.cbl
  2778     05  DUEDAYHI PIC  X(0008).
  2779*    -------------------------------
  2780     05  DUEDAYL PIC S9(0004) COMP.
  2781     05  DUEDAYF PIC  X(0001).
  2782     05  FILLER REDEFINES DUEDAYF.
  2783         10  DUEDAYA PIC  X(0001).
  2784     05  DUEDAYI PIC  X(0002).
  2785*    -------------------------------
  2786     05  ZINTHL PIC S9(0004) COMP.
  2787     05  ZINTHF PIC  X(0001).
  2788     05  FILLER REDEFINES ZINTHF.
  2789         10  ZINTHA PIC  X(0001).
  2790     05  ZINTHI PIC  X(0009).
  2791*    -------------------------------
  2792     05  ZINTL PIC S9(0004) COMP.
  2793     05  ZINTF PIC  X(0001).
  2794     05  FILLER REDEFINES ZINTF.
  2795         10  ZINTA PIC  X(0001).
  2796     05  ZINTI PIC  99V99999.
  2797*    -------------------------------
  2798     05  PTHRHDGL PIC S9(0004) COMP.
  2799     05  PTHRHDGF PIC  X(0001).
  2800     05  FILLER REDEFINES PTHRHDGF.
  2801         10  PTHRHDGA PIC  X(0001).
  2802     05  PTHRHDGI PIC  X(0014).
  2803*    -------------------------------
  2804     05  PDTHRUL PIC S9(0004) COMP.
  2805     05  PDTHRUF PIC  X(0001).
  2806     05  FILLER REDEFINES PDTHRUF.
  2807         10  PDTHRUA PIC  X(0001).
  2808     05  PDTHRUI PIC  X(0008).
  2809*    -------------------------------
  2810     05  TOTPAIDL PIC S9(0004) COMP.
  2811     05  TOTPAIDF PIC  X(0001).
  2812     05  FILLER REDEFINES TOTPAIDF.
  2813         10  TOTPAIDA PIC  X(0001).
  2814     05  TOTPAIDI PIC  X(0010).
  2815*    -------------------------------
  2816     05  COVERL PIC S9(0004) COMP.
  2817     05  COVERF PIC  X(0001).
  2818     05  FILLER REDEFINES COVERF.
  2819         10  COVERA PIC  X(0001).
  2820     05  COVERI PIC  X(0010).
  2821*    -------------------------------
  2822     05  INCURL PIC S9(0004) COMP.
  2823     05  INCURF PIC  X(0001).
  2824     05  FILLER REDEFINES INCURF.
  2825         10  INCURA PIC  X(0001).
  2826     05  INCURI PIC  X(0008).
  2827*    -------------------------------
  2828     05  LSTDTEL PIC S9(0004) COMP.
  2829     05  LSTDTEF PIC  X(0001).
  2830     05  FILLER REDEFINES LSTDTEF.
  2831         10  LSTDTEA PIC  X(0001).
  2832     05  LSTDTEI PIC  X(0008).
  2833*    -------------------------------
  2834     05  CRTSTATL PIC S9(0004) COMP.
  2835     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL156.cbl
  2836     05  FILLER REDEFINES CRTSTATF.
  2837         10  CRTSTATA PIC  X(0001).
  2838     05  CRTSTATI PIC  X(0010).
  2839*    -------------------------------
  2840     05  EFFECTL PIC S9(0004) COMP.
  2841     05  EFFECTF PIC  X(0001).
  2842     05  FILLER REDEFINES EFFECTF.
  2843         10  EFFECTA PIC  X(0001).
  2844     05  EFFECTI PIC  X(0008).
  2845*    -------------------------------
  2846     05  TERMSL PIC S9(0004) COMP.
  2847     05  TERMSF PIC  X(0001).
  2848     05  FILLER REDEFINES TERMSF.
  2849         10  TERMSA PIC  X(0001).
  2850     05  TERMSI PIC  X(0011).
  2851*    -------------------------------
  2852     05  STACCTL PIC S9(0004) COMP.
  2853     05  STACCTF PIC  X(0001).
  2854     05  FILLER REDEFINES STACCTF.
  2855         10  STACCTA PIC  X(0001).
  2856     05  STACCTI PIC  X(0013).
  2857*    -------------------------------
  2858     05  EXPDTEHL PIC S9(0004) COMP.
  2859     05  EXPDTEHF PIC  X(0001).
  2860     05  FILLER REDEFINES EXPDTEHF.
  2861         10  EXPDTEHA PIC  X(0001).
  2862     05  EXPDTEHI PIC  X(0014).
  2863*    -------------------------------
  2864     05  EXPDTEL PIC S9(0004) COMP.
  2865     05  EXPDTEF PIC  X(0001).
  2866     05  FILLER REDEFINES EXPDTEF.
  2867         10  EXPDTEA PIC  X(0001).
  2868     05  EXPDTEI PIC  X(0008).
  2869*    -------------------------------
  2870     05  BENECAPL PIC S9(0004) COMP.
  2871     05  BENECAPF PIC  X(0001).
  2872     05  FILLER REDEFINES BENECAPF.
  2873         10  BENECAPA PIC  X(0001).
  2874     05  BENECAPI PIC  X(0013).
  2875*    -------------------------------
  2876     05  BENEL PIC S9(0004) COMP.
  2877     05  BENEF PIC  X(0001).
  2878     05  FILLER REDEFINES BENEF.
  2879         10  BENEA PIC  X(0001).
  2880     05  BENEI PIC  X(0009).
  2881*    -------------------------------
  2882     05  FORMTYPL PIC S9(0004) COMP.
  2883     05  FORMTYPF PIC  X(0001).
  2884     05  FILLER REDEFINES FORMTYPF.
  2885         10  FORMTYPA PIC  X(0001).
  2886     05  FORMTYPI PIC  X(0001).
  2887*    -------------------------------
  2888     05  PMTTYPEL PIC S9(0004) COMP.
  2889     05  PMTTYPEF PIC  X(0001).
  2890     05  FILLER REDEFINES PMTTYPEF.
  2891         10  PMTTYPEA PIC  X(0001).
  2892     05  PMTTYPEI PIC  X(0001).
  2893*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL156.cbl
  2894     05  PAYEEL PIC S9(0004) COMP.
  2895     05  PAYEEF PIC  X(0001).
  2896     05  FILLER REDEFINES PAYEEF.
  2897         10  PAYEEA PIC  X(0001).
  2898     05  PAYEEI PIC  X(0002).
  2899*    -------------------------------
  2900     05  CHECKNOL PIC S9(0004) COMP.
  2901     05  CHECKNOF PIC  X(0001).
  2902     05  FILLER REDEFINES CHECKNOF.
  2903         10  CHECKNOA PIC  X(0001).
  2904     05  CHECKNOI PIC  X(0007).
  2905*    -------------------------------
  2906     05  OFFLINEL PIC S9(0004) COMP.
  2907     05  OFFLINEF PIC  X(0001).
  2908     05  FILLER REDEFINES OFFLINEF.
  2909         10  OFFLINEA PIC  X(0001).
  2910     05  OFFLINEI PIC  X(0001).
  2911*    -------------------------------
  2912     05  HOLDTILL PIC S9(0004) COMP.
  2913     05  HOLDTILF PIC  X(0001).
  2914     05  FILLER REDEFINES HOLDTILF.
  2915         10  HOLDTILA PIC  X(0001).
  2916     05  HOLDTILI PIC  X(0008).
  2917*    -------------------------------
  2918     05  NOTE1L PIC S9(0004) COMP.
  2919     05  NOTE1F PIC  X(0001).
  2920     05  FILLER REDEFINES NOTE1F.
  2921         10  NOTE1A PIC  X(0001).
  2922     05  NOTE1I PIC  X(0060).
  2923*    -------------------------------
  2924     05  NOTE2L PIC S9(0004) COMP.
  2925     05  NOTE2F PIC  X(0001).
  2926     05  FILLER REDEFINES NOTE2F.
  2927         10  NOTE2A PIC  X(0001).
  2928     05  NOTE2I PIC  X(0060).
  2929*    -------------------------------
  2930     05  EOBYNL PIC S9(0004) COMP.
  2931     05  EOBYNF PIC  X(0001).
  2932     05  FILLER REDEFINES EOBYNF.
  2933         10  EOBYNA PIC  X(0001).
  2934     05  EOBYNI PIC  X(0001).
  2935*    -------------------------------
  2936     05  CLMFMYNL PIC S9(0004) COMP.
  2937     05  CLMFMYNF PIC  X(0001).
  2938     05  FILLER REDEFINES CLMFMYNF.
  2939         10  CLMFMYNA PIC  X(0001).
  2940     05  CLMFMYNI PIC  X(0001).
  2941*    -------------------------------
  2942     05  SURVYYNL PIC S9(0004) COMP.
  2943     05  SURVYYNF PIC  X(0001).
  2944     05  FILLER REDEFINES SURVYYNF.
  2945         10  SURVYYNA PIC  X(0001).
  2946     05  SURVYYNI PIC  X(0001).
  2947*    -------------------------------
  2948     05  SPRELYNL PIC S9(0004) COMP.
  2949     05  SPRELYNF PIC  X(0001).
  2950     05  FILLER REDEFINES SPRELYNF.
  2951         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL156.cbl
  2952     05  SPRELYNI PIC  X(0001).
  2953*    -------------------------------
  2954     05  PINTHL PIC S9(0004) COMP.
  2955     05  PINTHF PIC  X(0001).
  2956     05  FILLER REDEFINES PINTHF.
  2957         10  PINTHA PIC  X(0001).
  2958     05  PINTHI PIC  X(0004).
  2959*    -------------------------------
  2960     05  PINTL PIC S9(0004) COMP.
  2961     05  PINTF PIC  X(0001).
  2962     05  FILLER REDEFINES PINTF.
  2963         10  PINTA PIC  X(0001).
  2964     05  PINTI PIC  X(0008).
  2965*    -------------------------------
  2966     05  PROOFDTL PIC S9(0004) COMP.
  2967     05  PROOFDTF PIC  X(0001).
  2968     05  FILLER REDEFINES PROOFDTF.
  2969         10  PROOFDTA PIC  X(0001).
  2970     05  PROOFDTI PIC  X(0008).
  2971*    -------------------------------
  2972     05  AIGFRMHL PIC S9(0004) COMP.
  2973     05  AIGFRMHF PIC  X(0001).
  2974     05  FILLER REDEFINES AIGFRMHF.
  2975         10  AIGFRMHA PIC  X(0001).
  2976     05  AIGFRMHI PIC  X(0012).
  2977*    -------------------------------
  2978     05  AIGFROML PIC S9(0004) COMP.
  2979     05  AIGFROMF PIC  X(0001).
  2980     05  FILLER REDEFINES AIGFROMF.
  2981         10  AIGFROMA PIC  X(0001).
  2982     05  AIGFROMI PIC  X(0008).
  2983*    -------------------------------
  2984     05  PMTHDGAL PIC S9(0004) COMP.
  2985     05  PMTHDGAF PIC  X(0001).
  2986     05  FILLER REDEFINES PMTHDGAF.
  2987         10  PMTHDGAA PIC  X(0001).
  2988     05  PMTHDGAI PIC  X(0066).
  2989*    -------------------------------
  2990     05  EPYFROML PIC S9(0004) COMP.
  2991     05  EPYFROMF PIC  X(0001).
  2992     05  FILLER REDEFINES EPYFROMF.
  2993         10  EPYFROMA PIC  X(0001).
  2994     05  EPYFROMI PIC  X(0008).
  2995*    -------------------------------
  2996     05  EPYTHRUL PIC S9(0004) COMP.
  2997     05  EPYTHRUF PIC  X(0001).
  2998     05  FILLER REDEFINES EPYTHRUF.
  2999         10  EPYTHRUA PIC  X(0001).
  3000     05  EPYTHRUI PIC  X(0008).
  3001*    -------------------------------
  3002     05  EDAYSL PIC S9(0004) COMP.
  3003     05  EDAYSF PIC  X(0001).
  3004     05  FILLER REDEFINES EDAYSF.
  3005         10  EDAYSA PIC  X(0001).
  3006     05  EDAYSI PIC  S9(6).
  3007*    -------------------------------
  3008     05  EPYAMTL PIC S9(0004) COMP.
  3009     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL156.cbl
  3010     05  FILLER REDEFINES EPYAMTF.
  3011         10  EPYAMTA PIC  X(0001).
  3012     05  EPYAMTI PIC  S9(8)V99.
  3013*    -------------------------------
  3014     05  ERESVL PIC S9(0004) COMP.
  3015     05  ERESVF PIC  X(0001).
  3016     05  FILLER REDEFINES ERESVF.
  3017         10  ERESVA PIC  X(0001).
  3018     05  ERESVI PIC  S9(7)V99.
  3019*    -------------------------------
  3020     05  ETYPEL PIC S9(0004) COMP.
  3021     05  ETYPEF PIC  X(0001).
  3022     05  FILLER REDEFINES ETYPEF.
  3023         10  ETYPEA PIC  X(0001).
  3024     05  ETYPEI PIC  X(0001).
  3025*    -------------------------------
  3026     05  EEXPENSL PIC S9(0004) COMP.
  3027     05  EEXPENSF PIC  X(0001).
  3028     05  FILLER REDEFINES EEXPENSF.
  3029         10  EEXPENSA PIC  X(0001).
  3030     05  EEXPENSI PIC  9(6)V99.
  3031*    -------------------------------
  3032     05  CPYFROML PIC S9(0004) COMP.
  3033     05  CPYFROMF PIC  X(0001).
  3034     05  FILLER REDEFINES CPYFROMF.
  3035         10  CPYFROMA PIC  X(0001).
  3036     05  CPYFROMI PIC  X(0008).
  3037*    -------------------------------
  3038     05  CPYTHRUL PIC S9(0004) COMP.
  3039     05  CPYTHRUF PIC  X(0001).
  3040     05  FILLER REDEFINES CPYTHRUF.
  3041         10  CPYTHRUA PIC  X(0001).
  3042     05  CPYTHRUI PIC  X(0008).
  3043*    -------------------------------
  3044     05  CDAYSL PIC S9(0004) COMP.
  3045     05  CDAYSF PIC  X(0001).
  3046     05  FILLER REDEFINES CDAYSF.
  3047         10  CDAYSA PIC  X(0001).
  3048     05  CDAYSI PIC  9(6).
  3049*    -------------------------------
  3050     05  CPYAMTL PIC S9(0004) COMP.
  3051     05  CPYAMTF PIC  X(0001).
  3052     05  FILLER REDEFINES CPYAMTF.
  3053         10  CPYAMTA PIC  X(0001).
  3054     05  CPYAMTI PIC  S9(8)V99.
  3055*    -------------------------------
  3056     05  CRESVL PIC S9(0004) COMP.
  3057     05  CRESVF PIC  X(0001).
  3058     05  FILLER REDEFINES CRESVF.
  3059         10  CRESVA PIC  X(0001).
  3060     05  CRESVI PIC  9(6)V99.
  3061*    -------------------------------
  3062     05  CEXPENSL PIC S9(0004) COMP.
  3063     05  CEXPENSF PIC  X(0001).
  3064     05  FILLER REDEFINES CEXPENSF.
  3065         10  CEXPENSA PIC  X(0001).
  3066     05  CEXPENSI PIC  9(6)V99.
  3067*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL156.cbl
  3068     05  ERRMSG0L PIC S9(0004) COMP.
  3069     05  ERRMSG0F PIC  X(0001).
  3070     05  FILLER REDEFINES ERRMSG0F.
  3071         10  ERRMSG0A PIC  X(0001).
  3072     05  ERRMSG0I PIC  X(0072).
  3073*    -------------------------------
  3074     05  ERRMSG1L PIC S9(0004) COMP.
  3075     05  ERRMSG1F PIC  X(0001).
  3076     05  FILLER REDEFINES ERRMSG1F.
  3077         10  ERRMSG1A PIC  X(0001).
  3078     05  ERRMSG1I PIC  X(0072).
  3079*    -------------------------------
  3080     05  ERRMSG2L PIC S9(0004) COMP.
  3081     05  ERRMSG2F PIC  X(0001).
  3082     05  FILLER REDEFINES ERRMSG2F.
  3083         10  ERRMSG2A PIC  X(0001).
  3084     05  ERRMSG2I PIC  X(0072).
  3085*    -------------------------------
  3086     05  ENTERPFL PIC S9(0004) COMP.
  3087     05  ENTERPFF PIC  X(0001).
  3088     05  FILLER REDEFINES ENTERPFF.
  3089         10  ENTERPFA PIC  X(0001).
  3090     05  ENTERPFI PIC  99.
  3091*    -------------------------------
  3092     05  PF6TITL PIC S9(0004) COMP.
  3093     05  PF6TITF PIC  X(0001).
  3094     05  FILLER REDEFINES PF6TITF.
  3095         10  PF6TITA PIC  X(0001).
  3096     05  PF6TITI PIC  X(0016).
  3097 01  EL156AO REDEFINES EL156AI.
  3098     05  FILLER            PIC  X(0012).
  3099*    -------------------------------
  3100     05  FILLER            PIC  X(0003).
  3101     05  RUNDTEAO PIC  X(0008).
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  RUNTIMAO PIC  99.99.
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  SEQUO PIC  X(0010).
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  CLMNOO PIC  X(0007).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  CARRO PIC  X(0001).
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  CERTNOO PIC  X(0010).
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  SUFXO PIC  X(0001).
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  CLMTYPO PIC  X(0006).
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL156.cbl
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  LSTNMEO PIC  X(0015).
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  FSTNMEO PIC  X(0012).
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  MINITO PIC  X(0001).
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
  3137     05  PRIMHDGO PIC  X(0012).
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  PCERTNOO PIC  X(0010).
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  PSUFXO PIC  X(0001).
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  STATUSO PIC  X(0010).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  LOANHO PIC  X(0014).
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  LOANNOO PIC  X(0025).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  DUEDAYHO PIC  X(0008).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  DUEDAYO PIC  X(0002).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  ZINTHO PIC  X(0009).
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  ZINTO PIC  9.99999.
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  PTHRHDGO PIC  X(0014).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  PDTHRUO PIC  X(0008).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  TOTPAIDO PIC  Z(6).99-.
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  COVERO PIC  X(0010).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  INCURO PIC  X(0008).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  LSTDTEO PIC  X(0008).
  3183*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL156.cbl
  3184     05  FILLER            PIC  X(0003).
  3185     05  CRTSTATO PIC  X(0010).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  EFFECTO PIC  X(0008).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  TERMSO PIC  X(0011).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  STACCTO PIC  X(0013).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  EXPDTEHO PIC  X(0014).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  EXPDTEO PIC  X(0008).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  BENECAPO PIC  X(0013).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  BENEO PIC  Z(6).99.
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  FORMTYPO PIC  X(0001).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PMTTYPEO PIC  X(0001).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PAYEEO PIC  X(0002).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  CHECKNOO PIC  X(0007).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  OFFLINEO PIC  X(0001).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  HOLDTILO PIC  99B99B99.
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  NOTE1O PIC  X(0060).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  NOTE2O PIC  X(0060).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  EOBYNO PIC  X(0001).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  CLMFMYNO PIC  X(0001).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  SURVYYNO PIC  X(0001).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL156.cbl
  3242     05  SPRELYNO PIC  X(0001).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  PINTHO PIC  X(0004).
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  PINTO PIC  Z,ZZ9.99.
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  PROOFDTO PIC  99B99B99.
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  AIGFRMHO PIC  X(0012).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  AIGFROMO PIC  99B99B99.
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  PMTHDGAO PIC  X(0066).
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  EPYFROMO PIC  99B99B99.
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  EPYTHRUO PIC  99B99B99.
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  EDAYSO PIC  Z(4)9-.
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  EPYAMTO PIC  Z(6).99-.
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  ERESVO PIC  Z(5).99-.
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  ETYPEO PIC  X(0001).
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  EEXPENSO PIC  Z(5).99.
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  CPYFROMO PIC  99B99B99.
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  CPYTHRUO PIC  99B99B99.
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  CDAYSO PIC  Z(4)9-.
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  CPYAMTO PIC  Z(6).99-.
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  CRESVO PIC  Z(5).99.
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL156.cbl
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  ERRMSG0O PIC  X(0072).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  ERRMSG1O PIC  X(0072).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  ERRMSG2O PIC  X(0072).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  ENTERPFO PIC  X(0002).
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  PF6TITO PIC  X(0016).
  3315*    -------------------------------
  3316 01  EL156BI REDEFINES EL156AI.
  3317     05  FILLER            PIC  X(0012).
  3318*    -------------------------------
  3319     05  RUNDTEBL PIC S9(0004) COMP.
  3320     05  RUNDTEBF PIC  X(0001).
  3321     05  FILLER REDEFINES RUNDTEBF.
  3322         10  RUNDTEBA PIC  X(0001).
  3323     05  RUNDTEBI PIC  X(0008).
  3324*    -------------------------------
  3325     05  RUNTIMBL PIC S9(0004) COMP.
  3326     05  RUNTIMBF PIC  X(0001).
  3327     05  FILLER REDEFINES RUNTIMBF.
  3328         10  RUNTIMBA PIC  X(0001).
  3329     05  RUNTIMBI PIC  X(0005).
  3330*    -------------------------------
  3331     05  PAYDTBL PIC S9(0004) COMP.
  3332     05  PAYDTBF PIC  X(0001).
  3333     05  FILLER REDEFINES PAYDTBF.
  3334         10  PAYDTBA PIC  X(0001).
  3335     05  PAYDTBI PIC  X(0008).
  3336*    -------------------------------
  3337     05  PAYTYPBL PIC S9(0004) COMP.
  3338     05  PAYTYPBF PIC  X(0001).
  3339     05  FILLER REDEFINES PAYTYPBF.
  3340         10  PAYTYPBA PIC  X(0001).
  3341     05  PAYTYPBI PIC  X(0015).
  3342*    -------------------------------
  3343     05  PAYAMTBL PIC S9(0004) COMP.
  3344     05  PAYAMTBF PIC  X(0001).
  3345     05  FILLER REDEFINES PAYAMTBF.
  3346         10  PAYAMTBA PIC  X(0001).
  3347     05  PAYAMTBI PIC  X(0011).
  3348*    -------------------------------
  3349     05  LOANHBL PIC S9(0004) COMP.
  3350     05  LOANHBF PIC  X(0001).
  3351     05  FILLER REDEFINES LOANHBF.
  3352         10  LOANHBA PIC  X(0001).
  3353     05  LOANHBI PIC  X(0012).
  3354*    -------------------------------
  3355     05  LOANNBL PIC S9(0004) COMP.
  3356     05  LOANNBF PIC  X(0001).
  3357     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL156.cbl
  3358         10  LOANNBA PIC  X(0001).
  3359     05  LOANNBI PIC  X(0025).
  3360*    -------------------------------
  3361     05  CKNUMHDL PIC S9(0004) COMP.
  3362     05  CKNUMHDF PIC  X(0001).
  3363     05  FILLER REDEFINES CKNUMHDF.
  3364         10  CKNUMHDA PIC  X(0001).
  3365     05  CKNUMHDI PIC  X(0012).
  3366*    -------------------------------
  3367     05  CKNUMBL PIC S9(0004) COMP.
  3368     05  CKNUMBF PIC  X(0001).
  3369     05  FILLER REDEFINES CKNUMBF.
  3370         10  CKNUMBA PIC  X(0001).
  3371     05  CKNUMBI PIC  X(0007).
  3372*    -------------------------------
  3373     05  AGTHDGL PIC S9(0004) COMP.
  3374     05  AGTHDGF PIC  X(0001).
  3375     05  FILLER REDEFINES AGTHDGF.
  3376         10  AGTHDGA PIC  X(0001).
  3377     05  AGTHDGI PIC  X(0016).
  3378*    -------------------------------
  3379     05  NAMEBL PIC S9(0004) COMP.
  3380     05  NAMEBF PIC  X(0001).
  3381     05  FILLER REDEFINES NAMEBF.
  3382         10  NAMEBA PIC  X(0001).
  3383     05  NAMEBI PIC  X(0030).
  3384*    -------------------------------
  3385     05  NAMEB2L PIC S9(0004) COMP.
  3386     05  NAMEB2F PIC  X(0001).
  3387     05  FILLER REDEFINES NAMEB2F.
  3388         10  NAMEB2A PIC  X(0001).
  3389     05  NAMEB2I PIC  X(0030).
  3390*    -------------------------------
  3391     05  ADDR1BL PIC S9(0004) COMP.
  3392     05  ADDR1BF PIC  X(0001).
  3393     05  FILLER REDEFINES ADDR1BF.
  3394         10  ADDR1BA PIC  X(0001).
  3395     05  ADDR1BI PIC  X(0030).
  3396*    -------------------------------
  3397     05  ADDR1B2L PIC S9(0004) COMP.
  3398     05  ADDR1B2F PIC  X(0001).
  3399     05  FILLER REDEFINES ADDR1B2F.
  3400         10  ADDR1B2A PIC  X(0001).
  3401     05  ADDR1B2I PIC  X(0030).
  3402*    -------------------------------
  3403     05  ADDR2BL PIC S9(0004) COMP.
  3404     05  ADDR2BF PIC  X(0001).
  3405     05  FILLER REDEFINES ADDR2BF.
  3406         10  ADDR2BA PIC  X(0001).
  3407     05  ADDR2BI PIC  X(0030).
  3408*    -------------------------------
  3409     05  ADDR2B2L PIC S9(0004) COMP.
  3410     05  ADDR2B2F PIC  X(0001).
  3411     05  FILLER REDEFINES ADDR2B2F.
  3412         10  ADDR2B2A PIC  X(0001).
  3413     05  ADDR2B2I PIC  X(0030).
  3414*    -------------------------------
  3415     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL156.cbl
  3416     05  CITYSTBF PIC  X(0001).
  3417     05  FILLER REDEFINES CITYSTBF.
  3418         10  CITYSTBA PIC  X(0001).
  3419     05  CITYSTBI PIC  X(0030).
  3420*    -------------------------------
  3421     05  CITYST2L PIC S9(0004) COMP.
  3422     05  CITYST2F PIC  X(0001).
  3423     05  FILLER REDEFINES CITYST2F.
  3424         10  CITYST2A PIC  X(0001).
  3425     05  CITYST2I PIC  X(0030).
  3426*    -------------------------------
  3427     05  ZIPBL PIC S9(0004) COMP.
  3428     05  ZIPBF PIC  X(0001).
  3429     05  FILLER REDEFINES ZIPBF.
  3430         10  ZIPBA PIC  X(0001).
  3431     05  ZIPBI PIC  X(0009).
  3432*    -------------------------------
  3433     05  ZIPB2L PIC S9(0004) COMP.
  3434     05  ZIPB2F PIC  X(0001).
  3435     05  FILLER REDEFINES ZIPB2F.
  3436         10  ZIPB2A PIC  X(0001).
  3437     05  ZIPB2I PIC  X(0009).
  3438*    -------------------------------
  3439     05  INTHDBL PIC S9(0004) COMP.
  3440     05  INTHDBF PIC  X(0001).
  3441     05  FILLER REDEFINES INTHDBF.
  3442         10  INTHDBA PIC  X(0001).
  3443     05  INTHDBI PIC  X(0012).
  3444*    -------------------------------
  3445     05  INTAMTBL PIC S9(0004) COMP.
  3446     05  INTAMTBF PIC  X(0001).
  3447     05  FILLER REDEFINES INTAMTBF.
  3448         10  INTAMTBA PIC  X(0001).
  3449     05  INTAMTBI PIC  X(0011).
  3450*    -------------------------------
  3451     05  PMTHDGBL PIC S9(0004) COMP.
  3452     05  PMTHDGBF PIC  X(0001).
  3453     05  FILLER REDEFINES PMTHDGBF.
  3454         10  PMTHDGBA PIC  X(0001).
  3455     05  PMTHDGBI PIC  X(0034).
  3456*    -------------------------------
  3457     05  CLMNOBL PIC S9(0004) COMP.
  3458     05  CLMNOBF PIC  X(0001).
  3459     05  FILLER REDEFINES CLMNOBF.
  3460         10  CLMNOBA PIC  X(0001).
  3461     05  CLMNOBI PIC  X(0007).
  3462*    -------------------------------
  3463     05  CARRBL PIC S9(0004) COMP.
  3464     05  CARRBF PIC  X(0001).
  3465     05  FILLER REDEFINES CARRBF.
  3466         10  CARRBA PIC  X(0001).
  3467     05  CARRBI PIC  X(0001).
  3468*    -------------------------------
  3469     05  CERTNOBL PIC S9(0004) COMP.
  3470     05  CERTNOBF PIC  X(0001).
  3471     05  FILLER REDEFINES CERTNOBF.
  3472         10  CERTNOBA PIC  X(0001).
  3473     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL156.cbl
  3474*    -------------------------------
  3475     05  SUFXBL PIC S9(0004) COMP.
  3476     05  SUFXBF PIC  X(0001).
  3477     05  FILLER REDEFINES SUFXBF.
  3478         10  SUFXBA PIC  X(0001).
  3479     05  SUFXBI PIC  X(0001).
  3480*    -------------------------------
  3481     05  CLMTYPBL PIC S9(0004) COMP.
  3482     05  CLMTYPBF PIC  X(0001).
  3483     05  FILLER REDEFINES CLMTYPBF.
  3484         10  CLMTYPBA PIC  X(0001).
  3485     05  CLMTYPBI PIC  X(0006).
  3486*    -------------------------------
  3487     05  INCURBL PIC S9(0004) COMP.
  3488     05  INCURBF PIC  X(0001).
  3489     05  FILLER REDEFINES INCURBF.
  3490         10  INCURBA PIC  X(0001).
  3491     05  INCURBI PIC  X(0008).
  3492*    -------------------------------
  3493     05  PYFROMBL PIC S9(0004) COMP.
  3494     05  PYFROMBF PIC  X(0001).
  3495     05  FILLER REDEFINES PYFROMBF.
  3496         10  PYFROMBA PIC  X(0001).
  3497     05  PYFROMBI PIC  X(0008).
  3498*    -------------------------------
  3499     05  PYTHRUBL PIC S9(0004) COMP.
  3500     05  PYTHRUBF PIC  X(0001).
  3501     05  FILLER REDEFINES PYTHRUBF.
  3502         10  PYTHRUBA PIC  X(0001).
  3503     05  PYTHRUBI PIC  X(0008).
  3504*    -------------------------------
  3505     05  DAYSBL PIC S9(0004) COMP.
  3506     05  DAYSBF PIC  X(0001).
  3507     05  FILLER REDEFINES DAYSBF.
  3508         10  DAYSBA PIC  X(0001).
  3509     05  DAYSBI PIC  X(0005).
  3510*    -------------------------------
  3511     05  BYBL PIC S9(0004) COMP.
  3512     05  BYBF PIC  X(0001).
  3513     05  FILLER REDEFINES BYBF.
  3514         10  BYBA PIC  X(0001).
  3515     05  BYBI PIC  X(0004).
  3516*    -------------------------------
  3517     05  PROOFDBL PIC S9(0004) COMP.
  3518     05  PROOFDBF PIC  X(0001).
  3519     05  FILLER REDEFINES PROOFDBF.
  3520         10  PROOFDBA PIC  X(0001).
  3521     05  PROOFDBI PIC  X(0008).
  3522*    -------------------------------
  3523     05  ACCTBL PIC S9(0004) COMP.
  3524     05  ACCTBF PIC  X(0001).
  3525     05  FILLER REDEFINES ACCTBF.
  3526         10  ACCTBA PIC  X(0001).
  3527     05  ACCTBI PIC  X(0010).
  3528*    -------------------------------
  3529     05  STATEBL PIC S9(0004) COMP.
  3530     05  STATEBF PIC  X(0001).
  3531     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL156.cbl
  3532         10  STATEBA PIC  X(0001).
  3533     05  STATEBI PIC  X(0002).
  3534*    -------------------------------
  3535     05  GROUPBL PIC S9(0004) COMP.
  3536     05  GROUPBF PIC  X(0001).
  3537     05  FILLER REDEFINES GROUPBF.
  3538         10  GROUPBA PIC  X(0001).
  3539     05  GROUPBI PIC  X(0006).
  3540*    -------------------------------
  3541     05  ACARRBL PIC S9(0004) COMP.
  3542     05  ACARRBF PIC  X(0001).
  3543     05  FILLER REDEFINES ACARRBF.
  3544         10  ACARRBA PIC  X(0001).
  3545     05  ACARRBI PIC  X(0001).
  3546*    -------------------------------
  3547     05  ACCTNMBL PIC S9(0004) COMP.
  3548     05  ACCTNMBF PIC  X(0001).
  3549     05  FILLER REDEFINES ACCTNMBF.
  3550         10  ACCTNMBA PIC  X(0001).
  3551     05  ACCTNMBI PIC  X(0030).
  3552*    -------------------------------
  3553     05  UNDISBL PIC S9(0004) COMP.
  3554     05  UNDISBF PIC  X(0001).
  3555     05  FILLER REDEFINES UNDISBF.
  3556         10  UNDISBA PIC  X(0001).
  3557     05  UNDISBI PIC  X(0010).
  3558*    -------------------------------
  3559     05  RATEBL PIC S9(0004) COMP.
  3560     05  RATEBF PIC  X(0001).
  3561     05  FILLER REDEFINES RATEBF.
  3562         10  RATEBA PIC  X(0001).
  3563     05  RATEBI PIC  X(0006).
  3564*    -------------------------------
  3565     05  ERMSG1BL PIC S9(0004) COMP.
  3566     05  ERMSG1BF PIC  X(0001).
  3567     05  FILLER REDEFINES ERMSG1BF.
  3568         10  ERMSG1BA PIC  X(0001).
  3569     05  ERMSG1BI PIC  X(0072).
  3570*    -------------------------------
  3571     05  ENTPFBL PIC S9(0004) COMP.
  3572     05  ENTPFBF PIC  X(0001).
  3573     05  FILLER REDEFINES ENTPFBF.
  3574         10  ENTPFBA PIC  X(0001).
  3575     05  ENTPFBI PIC  99.
  3576 01  EL156BO REDEFINES EL156AI.
  3577     05  FILLER            PIC  X(0012).
  3578*    -------------------------------
  3579     05  FILLER            PIC  X(0003).
  3580     05  RUNDTEBO PIC  X(0008).
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  RUNTIMBO PIC  99.99.
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  PAYDTBO PIC  99B99B99.
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL156.cbl
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3593*    -------------------------------
  3594     05  FILLER            PIC  X(0003).
  3595     05  LOANHBO PIC  X(0012).
  3596*    -------------------------------
  3597     05  FILLER            PIC  X(0003).
  3598     05  LOANNBO PIC  X(0025).
  3599*    -------------------------------
  3600     05  FILLER            PIC  X(0003).
  3601     05  CKNUMHDO PIC  X(0012).
  3602*    -------------------------------
  3603     05  FILLER            PIC  X(0003).
  3604     05  CKNUMBO PIC  X(0007).
  3605*    -------------------------------
  3606     05  FILLER            PIC  X(0003).
  3607     05  AGTHDGO PIC  X(0016).
  3608*    -------------------------------
  3609     05  FILLER            PIC  X(0003).
  3610     05  NAMEBO PIC  X(0030).
  3611*    -------------------------------
  3612     05  FILLER            PIC  X(0003).
  3613     05  NAMEB2O PIC  X(0030).
  3614*    -------------------------------
  3615     05  FILLER            PIC  X(0003).
  3616     05  ADDR1BO PIC  X(0030).
  3617*    -------------------------------
  3618     05  FILLER            PIC  X(0003).
  3619     05  ADDR1B2O PIC  X(0030).
  3620*    -------------------------------
  3621     05  FILLER            PIC  X(0003).
  3622     05  ADDR2BO PIC  X(0030).
  3623*    -------------------------------
  3624     05  FILLER            PIC  X(0003).
  3625     05  ADDR2B2O PIC  X(0030).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  CITYSTBO PIC  X(0030).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  CITYST2O PIC  X(0030).
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  ZIPBO PIC  ZZZZ99999.
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  ZIPB2O PIC  ZZZZZZZZZ.
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  INTHDBO PIC  X(0012).
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  PMTHDGBO PIC  X(0034).
  3647*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL156.cbl
  3648     05  FILLER            PIC  X(0003).
  3649     05  CLMNOBO PIC  X(0007).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  CARRBO PIC  X(0001).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  CERTNOBO PIC  X(0010).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  SUFXBO PIC  X(0001).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  CLMTYPBO PIC  X(0006).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  INCURBO PIC  X(0008).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  PYFROMBO PIC  99B99B99.
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  PYTHRUBO PIC  99B99B99.
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  DAYSBO PIC  X(0005).
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  BYBO PIC  X(0004).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  PROOFDBO PIC  99B99B99.
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  ACCTBO PIC  X(0010).
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  STATEBO PIC  X(0002).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  GROUPBO PIC  X(0006).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  ACARRBO PIC  X(0001).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  ACCTNMBO PIC  X(0030).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  UNDISBO PIC  ZZZ,Z99.99.
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  RATEBO PIC  ZZZ.99.
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
  3703     05  ERMSG1BO PIC  X(0072).
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL156.cbl
  3706     05  ENTPFBO PIC  X(0002).
  3707*    -------------------------------
  3708****************************************************************
  3709*
  3710* Copyright (c) 2007 by Clerity Solutions, Inc.
  3711* All rights reserved.
  3712*
  3713****************************************************************
  3714 01  DFHEIV.
  3715   02  DFHEIV0               PIC X(35).
  3716   02  DFHEIV1               PIC X(08).
  3717   02  DFHEIV2               PIC X(08).
  3718   02  DFHEIV3               PIC X(08).
  3719   02  DFHEIV4               PIC X(06).
  3720   02  DFHEIV5               PIC X(04).
  3721   02  DFHEIV6               PIC X(04).
  3722   02  DFHEIV7               PIC X(02).
  3723   02  DFHEIV8               PIC X(02).
  3724   02  DFHEIV9               PIC X(01).
  3725   02  DFHEIV10              PIC S9(7) COMP-3.
  3726   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3727   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3728   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3729   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3730   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3731   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3732   02  DFHEIV17              PIC X(04).
  3733   02  DFHEIV18              PIC X(04).
  3734   02  DFHEIV19              PIC X(04).
  3735   02  DFHEIV20              USAGE IS POINTER.
  3736   02  DFHEIV21              USAGE IS POINTER.
  3737   02  DFHEIV22              USAGE IS POINTER.
  3738   02  DFHEIV23              USAGE IS POINTER.
  3739   02  DFHEIV24              USAGE IS POINTER.
  3740   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3741   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3742   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3743   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3744   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3745   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3746   02  FILLER                PIC X(02).
  3747   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3748   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3749   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3750   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3751   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3752 LINKAGE  SECTION.
  3753*****************************************************************
  3754*                                                               *
  3755* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3756* All rights reserved.                                          *
  3757*                                                               *
  3758*****************************************************************
  3759 01  dfheiblk.
  3760     02  eibtime          pic s9(7) comp-3.
  3761     02  eibdate          pic s9(7) comp-3.
  3762     02  eibtrnid         pic x(4).
  3763     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL156.cbl
  3764     02  eibtrmid         pic x(4).
  3765     02  dfheigdi         pic s9(4) comp.
  3766     02  eibcposn         pic s9(4) comp.
  3767     02  eibcalen         pic s9(4) comp.
  3768     02  eibaid           pic x(1).
  3769     02  eibfiller1       pic x(1).
  3770     02  eibfn            pic x(2).
  3771     02  eibfiller2       pic x(2).
  3772     02  eibrcode         pic x(6).
  3773     02  eibfiller3       pic x(2).
  3774     02  eibds            pic x(8).
  3775     02  eibreqid         pic x(8).
  3776     02  eibrsrce         pic x(8).
  3777     02  eibsync          pic x(1).
  3778     02  eibfree          pic x(1).
  3779     02  eibrecv          pic x(1).
  3780     02  eibsend          pic x(1).
  3781     02  eibatt           pic x(1).
  3782     02  eibeoc           pic x(1).
  3783     02  eibfmh           pic x(1).
  3784     02  eibcompl         pic x(1).
  3785     02  eibsig           pic x(1).
  3786     02  eibconf          pic x(1).
  3787     02  eiberr           pic x(1).
  3788     02  eibrldbk         pic x(1).
  3789     02  eiberrcd         pic x(4).
  3790     02  eibsynrb         pic x(1).
  3791     02  eibnodat         pic x(1).
  3792     02  eibfiller5       pic x(2).
  3793     02  eibresp          pic 9(09) comp.
  3794     02  eibresp2         pic 9(09) comp.
  3795     02  dfheigdj         pic s9(4) comp.
  3796     02  dfheigdk         pic s9(4) comp.
  3797 01  DFHCOMMAREA             PIC X(1024).
  3798
  3799*    COPY ELCMSTR.
  3800******************************************************************
  3801*                                                                *
  3802*                            ELCMSTR.                            *
  3803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3804*                            VMOD=2.012                          *
  3805*                                                                *
  3806*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3807*                                                                *
  3808*   FILE TYPE = VSAM,KSDS                                        *
  3809*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3810*                                                                *
  3811*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3812*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3813*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3814*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3815*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3816*                                                 RKP=75,LEN=21  *
  3817*                                                                *
  3818*   **** NOTE ****                                               *
  3819*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3820*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3821*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL156.cbl
  3822*   LOG = YES                                                    *
  3823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3824******************************************************************
  3825*                   C H A N G E   L O G
  3826*
  3827* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3828*-----------------------------------------------------------------
  3829*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3830* EFFECTIVE    NUMBER
  3831*-----------------------------------------------------------------
  3832* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3833* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3834* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3835* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3836* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3837******************************************************************
  3838 01  CLAIM-MASTER.
  3839     12  CL-RECORD-ID                PIC XX.
  3840         88  VALID-CL-ID         VALUE 'CL'.
  3841
  3842     12  CL-CONTROL-PRIMARY.
  3843         16  CL-COMPANY-CD           PIC X.
  3844         16  CL-CARRIER              PIC X.
  3845         16  CL-CLAIM-NO             PIC X(7).
  3846         16  CL-CERT-NO.
  3847             20  CL-CERT-PRIME       PIC X(10).
  3848             20  CL-CERT-SFX         PIC X.
  3849
  3850     12  CL-CONTROL-BY-NAME.
  3851         16  CL-COMPANY-CD-A1        PIC X.
  3852         16  CL-INSURED-LAST-NAME    PIC X(15).
  3853         16  CL-INSURED-NAME.
  3854             20  CL-INSURED-1ST-NAME PIC X(12).
  3855             20  CL-INSURED-MID-INIT PIC X.
  3856
  3857     12  CL-CONTROL-BY-SSN.
  3858         16  CL-COMPANY-CD-A2        PIC X.
  3859         16  CL-SOC-SEC-NO.
  3860             20  CL-SSN-STATE        PIC XX.
  3861             20  CL-SSN-ACCOUNT      PIC X(6).
  3862             20  CL-SSN-LN3          PIC X(3).
  3863
  3864     12  CL-CONTROL-BY-CERT-NO.
  3865         16  CL-COMPANY-CD-A4        PIC X.
  3866         16  CL-CERT-NO-A4.
  3867             20  CL-CERT-A4-PRIME    PIC X(10).
  3868             20  CL-CERT-A4-SFX      PIC X.
  3869
  3870     12  CL-CONTROL-BY-CCN.
  3871         16  CL-COMPANY-CD-A5        PIC X.
  3872         16  CL-CCN-A5.
  3873             20  CL-CCN.
  3874                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3875                 24  CL-CCN-PRIME-A5 PIC X(12).
  3876             20  CL-CCN-FILLER-A5    PIC X(4).
  3877
  3878     12  CL-INSURED-PROFILE-DATA.
  3879         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL156.cbl
  3880         16  CL-INSURED-SEX-CD       PIC X.
  3881             88  INSURED-IS-MALE        VALUE 'M'.
  3882             88  INSURED-IS-FEMALE      VALUE 'F'.
  3883             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3884         16  CL-INSURED-OCC-CD       PIC X(6).
  3885         16  FILLER                  PIC X(5).
  3886
  3887     12  CL-PROCESSING-INFO.
  3888         16  CL-PROCESSOR-ID         PIC X(4).
  3889         16  CL-CLAIM-STATUS         PIC X.
  3890             88  CLAIM-IS-OPEN          VALUE 'O'.
  3891             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3892         16  CL-CLAIM-TYPE           PIC X.
  3893*            88  AH-CLAIM               VALUE 'A'.
  3894*            88  LIFE-CLAIM             VALUE 'L'.
  3895*            88  PROPERTY-CLAIM         VALUE 'P'.
  3896*            88  IUI-CLAIM              VALUE 'I'.
  3897*            88  GAP-CLAIM              VALUE 'G'.
  3898*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3899         16  CL-CLAIM-PREM-TYPE      PIC X.
  3900             88  SINGLE-PREMIUM         VALUE '1'.
  3901             88  O-B-COVERAGE           VALUE '2'.
  3902             88  OPEN-END-COVERAGE      VALUE '3'.
  3903         16  CL-INCURRED-DT          PIC XX.
  3904         16  CL-REPORTED-DT          PIC XX.
  3905         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3906         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3907         16  CL-LAST-PMT-DT          PIC XX.
  3908         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3909         16  CL-PAID-THRU-DT         PIC XX.
  3910         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3911         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3912         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3913         16  CL-PMT-CALC-METHOD      PIC X.
  3914             88  CL-360-DAY-YR          VALUE '1'.
  3915             88  CL-365-DAY-YR          VALUE '2'.
  3916             88  CL-FULL-MONTHS         VALUE '3'.
  3917         16  CL-CAUSE-CD             PIC X(6).
  3918
  3919         16  CL-PRIME-CERT-NO.
  3920             20  CL-PRIME-CERT-PRIME PIC X(10).
  3921             20  CL-PRIME-CERT-SFX   PIC X.
  3922
  3923         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3924             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3925             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3926
  3927         16  CL-MICROFILM-NO         PIC X(10).
  3928         16  FILLER REDEFINES CL-MICROFILM-NO.
  3929             20  CL-BENEFIT-PERIOD   PIC 99.
  3930             20  FILLER              PIC X(8).
  3931         16  CL-PROG-FORM-TYPE       PIC X.
  3932         16  CL-LAST-ADD-ON-DT       PIC XX.
  3933
  3934         16  CL-LAST-REOPEN-DT       PIC XX.
  3935         16  CL-LAST-CLOSE-DT        PIC XX.
  3936         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3937             88  FINAL-PAID             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL156.cbl
  3938             88  CLAIM-DENIED           VALUE '2'.
  3939             88  AUTO-CLOSE             VALUE '3'.
  3940             88  MANUAL-CLOSE           VALUE '4'.
  3941             88  BENEFITS-CHANGED       VALUE 'C'.
  3942             88  SETUP-ERRORS           VALUE 'E'.
  3943         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3944         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3945         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3946             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3947         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3948         16  FILLER                  PIC X.
  3949
  3950     12  CL-CERTIFICATE-DATA.
  3951         16  CL-CERT-ORIGIN          PIC X.
  3952             88  CERT-WAS-ONLINE        VALUE '1'.
  3953             88  CERT-WAS-CREATED       VALUE '2'.
  3954             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3955         16  CL-CERT-KEY-DATA.
  3956             20  CL-CERT-CARRIER     PIC X.
  3957             20  CL-CERT-GROUPING    PIC X(6).
  3958             20  CL-CERT-STATE       PIC XX.
  3959             20  CL-CERT-ACCOUNT.
  3960                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3961                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3962             20  CL-CERT-EFF-DT      PIC XX.
  3963
  3964     12  CL-STATUS-CONTROLS.
  3965         16  CL-PRIORITY-CD          PIC X.
  3966             88  CONFIDENTIAL-DATA      VALUE '8'.
  3967             88  HIGHEST-PRIORITY       VALUE '9'.
  3968         16  CL-SUPV-ATTN-CD         PIC X.
  3969             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3970             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3971         16  CL-PURGED-DT            PIC XX.
  3972         16  CL-RESTORED-DT          PIC XX.
  3973         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3974         16  CL-NEXT-RESEND-DT       PIC XX.
  3975         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3976         16  CL-CRITICAL-PERIOD      PIC 99.
  3977*        16  FILLER                  PIC XX.
  3978         16  CL-LAST-MAINT-DT        PIC XX.
  3979         16  CL-LAST-MAINT-USER      PIC X(4).
  3980         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3981         16  CL-LAST-MAINT-TYPE      PIC X.
  3982             88  CLAIM-SET-UP           VALUE ' '.
  3983             88  PAYMENT-MADE           VALUE '1'.
  3984             88  LETTER-SENT            VALUE '2'.
  3985             88  MASTER-WAS-ALTERED     VALUE '3'.
  3986             88  MASTER-WAS-RESTORED    VALUE '4'.
  3987             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3988             88  FILE-CONVERTED         VALUE '6'.
  3989             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3990             88  ERROR-CORRECTION       VALUE 'E'.
  3991         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3992         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3993         16  CL-BENEFICIARY          PIC X(10).
  3994         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3995         16  CL-DENIAL-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL156.cbl
  3996             88  CL-TYPE-DENIAL          VALUE '1'.
  3997             88  CL-TYPE-RESCISSION      VALUE '2'.
  3998             88  CL-TYPE-REFORMATION     VALUE '3'.
  3999             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4000             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4001         16  filler                  pic x(5).
  4002*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4003*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4004*        16  CL-RTW-DT               PIC XX.
  4005
  4006     12  CL-TRAILER-CONTROLS.
  4007         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4008             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4009             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4010             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4011         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4012         16  FILLER                  PIC XX.
  4013         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4014         16  CL-ADDRESS-TRAILER-CNT.
  4015             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4016                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4017             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4018                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4019             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4020                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4021             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4022                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4023             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4024                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4025             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4026                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4027             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4028                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4029
  4030     12  CL-CV-REFERENCE-NO.
  4031         16  CL-CV-REFNO-PRIME       PIC X(18).
  4032         16  CL-CV-REFNO-SFX         PIC XX.
  4033
  4034     12  CL-FILE-LOCATION            PIC X(4).
  4035
  4036     12  CL-PROCESS-ERRORS.
  4037         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4038             88  NO-FATAL-ERRORS        VALUE ZERO.
  4039         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4040             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4041
  4042     12  CL-PRODUCT-CD               PIC X.
  4043
  4044     12  CL-CURRENT-KEY-DATA.
  4045         16  CL-CURRENT-CARRIER      PIC X.
  4046         16  CL-CURRENT-GROUPING     PIC X(6).
  4047         16  CL-CURRENT-STATE        PIC XX.
  4048         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4049
  4050     12  CL-ASSOCIATES               PIC X.
  4051         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4052         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4053         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL156.cbl
  4054         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4055
  4056     12  CL-ACTIVITY-CODE            PIC 99.
  4057     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4058     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4059
  4060     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4061     12  CL-LAG-REPORT-CODE          PIC 9.
  4062     12  CL-LOAN-TYPE                PIC XX.
  4063     12  CL-LEGAL-STATE              PIC XX.
  4064
  4065     12  CL-YESNOSW                  PIC X.
  4066     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4067         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4068         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4069         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4070     12  cl-insured-type             pic x.
  4071         88  cl-claim-on-primary         value 'P'.
  4072         88  cl-claim-on-co-borrower     value 'C'.
  4073     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL156.cbl
  4075*    COPY ELCCNTL.
  4076******************************************************************
  4077*                                                                *
  4078*                                                                *
  4079*                            ELCCNTL.                            *
  4080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4081*                            VMOD=2.059                          *
  4082*                                                                *
  4083*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4084*                                                                *
  4085*   FILE TYPE = VSAM,KSDS                                        *
  4086*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4087*                                                                *
  4088*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4089*       ALTERNATE INDEX = NONE                                   *
  4090*                                                                *
  4091*   LOG = YES                                                    *
  4092*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4093******************************************************************
  4094*                   C H A N G E   L O G
  4095*
  4096* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4097*-----------------------------------------------------------------
  4098*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4099* EFFECTIVE    NUMBER
  4100*-----------------------------------------------------------------
  4101* 082503                   PEMA  ADD BENEFIT GROUP
  4102* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4103* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4104* 092705    2005050300006  PEMA  ADD SPP LEASES
  4105* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4106* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4107* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4108* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4109* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4110* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4111* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4112* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4113* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4114* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4115******************************************************************
  4116*
  4117 01  CONTROL-FILE.
  4118     12  CF-RECORD-ID                       PIC XX.
  4119         88  VALID-CF-ID                        VALUE 'CF'.
  4120
  4121     12  CF-CONTROL-PRIMARY.
  4122         16  CF-COMPANY-ID                  PIC XXX.
  4123         16  CF-RECORD-TYPE                 PIC X.
  4124             88  CF-COMPANY-MASTER              VALUE '1'.
  4125             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4126             88  CF-STATE-MASTER                VALUE '3'.
  4127             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4128             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4129             88  CF-CARRIER-MASTER              VALUE '6'.
  4130             88  CF-MORTALITY-MASTER            VALUE '7'.
  4131             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4132             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL156.cbl
  4133             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4134             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4135             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4136             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4137             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4138             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4139             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4140             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4141             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4142         16  CF-ACCESS-CD-GENL              PIC X(4).
  4143         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4144             20  CF-PROCESSOR               PIC X(4).
  4145         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4146             20  CF-STATE-CODE              PIC XX.
  4147             20  FILLER                     PIC XX.
  4148         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4149             20  FILLER                     PIC XX.
  4150             20  CF-HI-BEN-IN-REC           PIC XX.
  4151         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4152             20  FILLER                     PIC XXX.
  4153             20  CF-CARRIER-CNTL            PIC X.
  4154         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4155             20  FILLER                     PIC XX.
  4156             20  CF-HI-TYPE-IN-REC          PIC 99.
  4157         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4158             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4159                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4160             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4161             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4162         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4163             20  FILLER                     PIC X.
  4164             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4165         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4166             20  FILLER                     PIC XX.
  4167             20  CF-MORTGAGE-PLAN           PIC XX.
  4168         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4169
  4170     12  CF-LAST-MAINT-DT                   PIC XX.
  4171     12  CF-LAST-MAINT-BY                   PIC X(4).
  4172     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4173
  4174     12  CF-RECORD-BODY                     PIC X(728).
  4175
  4176
  4177****************************************************************
  4178*             COMPANY MASTER RECORD                            *
  4179****************************************************************
  4180
  4181     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4182         16  CF-COMPANY-ADDRESS.
  4183             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4184             20  CF-CL-IN-CARE-OF           PIC X(30).
  4185             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4186             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4187             20  CF-CL-CITY-STATE           PIC X(30).
  4188             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4189             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4190         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL156.cbl
  4191         16  CF-COMPANY-PASSWORD            PIC X(8).
  4192         16  CF-SECURITY-OPTION             PIC X.
  4193             88  ALL-SECURITY                   VALUE '1'.
  4194             88  COMPANY-VERIFY                 VALUE '2'.
  4195             88  PROCESSOR-VERIFY               VALUE '3'.
  4196             88  NO-SECURITY                    VALUE '4'.
  4197             88  ALL-BUT-TERM                   VALUE '5'.
  4198         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4199             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4200         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4201             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4202         16  CF-INFORCE-LOCATION            PIC X.
  4203             88  CERTS-ARE-ONLINE               VALUE '1'.
  4204             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4205             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4206         16  CF-LOWER-CASE-LETTERS          PIC X.
  4207         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4208             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4209             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4210             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4211             88  CF-ACCNT-CNTL                  VALUE '3'.
  4212             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4213
  4214         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4215         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4216
  4217         16  CF-LGX-CREDIT-USER             PIC X.
  4218             88  CO-IS-NOT-USER                 VALUE 'N'.
  4219             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4220
  4221         16 CF-CREDIT-CALC-CODES.
  4222             20  CF-CR-REM-TERM-CALC PIC X.
  4223               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4224               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4225               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4226               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4227               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4228               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4229               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4230             20  CF-CR-R78-METHOD           PIC X.
  4231               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4232               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4233
  4234         16  CF-CLAIM-CONTROL-COUNTS.
  4235             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4236                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4237
  4238             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4239                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4240
  4241             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4242                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4243
  4244             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4245                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4246
  4247         16  CF-CURRENT-MONTH-END           PIC XX.
  4248
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL156.cbl
  4249         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4250             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4251             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4252             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4253             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4254                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4255                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4256             20  CF-CO-PREM-REJECT-SW       PIC X.
  4257                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4258                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4259             20  CF-CO-REF-REJECT-SW        PIC X.
  4260                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4261                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4262
  4263         16  CF-CO-REPORTING-DT             PIC XX.
  4264         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4265         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4266           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4267           88  CF-CO-MONTH-END                  VALUE '1'.
  4268
  4269         16  CF-LGX-CLAIM-USER              PIC X.
  4270             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4271             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4272
  4273         16  CF-CREDIT-EDIT-CONTROLS.
  4274             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4275             20  CF-MIN-AGE                 PIC 99.
  4276             20  CF-DEFAULT-AGE             PIC 99.
  4277             20  CF-MIN-TERM                PIC S999      COMP-3.
  4278             20  CF-MAX-TERM                PIC S999      COMP-3.
  4279             20  CF-DEFAULT-SEX             PIC X.
  4280             20  CF-JOINT-AGE-INPUT         PIC X.
  4281                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4282             20  CF-BIRTH-DATE-INPUT        PIC X.
  4283                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4284             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4285                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4286                 88  CF-ZERO-CARRIER            VALUE '1'.
  4287                 88  CF-ZERO-GROUPING           VALUE '2'.
  4288                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4289             20  CF-EDIT-SW                 PIC X.
  4290                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4291             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4292             20  CF-CR-PR-METHOD            PIC X.
  4293               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4294               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4295             20  FILLER                     PIC X.
  4296
  4297         16  CF-CREDIT-MISC-CONTROLS.
  4298             20  CF-REIN-TABLE-SW           PIC X.
  4299                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4300             20  CF-COMP-TABLE-SW           PIC X.
  4301                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4302             20  CF-EXPERIENCE-RETENTION-AGE
  4303                                            PIC S9        COMP-3.
  4304             20  CF-CONVERSION-DT           PIC XX.
  4305             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4306             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL156.cbl
  4307                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4308                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4309
  4310             20  CF-CR-CHECK-NO-CONTROL.
  4311                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4312                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4313                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4314                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4315                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4316                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4317
  4318                 24  CF-CR-CHECK-COUNT       REDEFINES
  4319                     CF-CR-CHECK-COUNTER      PIC X(4).
  4320
  4321                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4322                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4323
  4324                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4325                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4326                 24  CF-MAIL-PROCESSING       PIC X.
  4327                     88  MAIL-PROCESSING          VALUE 'Y'.
  4328
  4329         16  CF-MISC-SYSTEM-CONTROL.
  4330             20  CF-SYSTEM-C                 PIC X.
  4331                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4332             20  CF-SYSTEM-D                 PIC X.
  4333                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4334             20  CF-SOC-SEC-NO-SW            PIC X.
  4335                 88  SOC-SEC-NO-USED             VALUE '1'.
  4336             20  CF-MEMBER-NO-SW             PIC X.
  4337                 88  MEMBER-NO-USED              VALUE '1'.
  4338             20  CF-TAX-ID-NUMBER            PIC X(11).
  4339             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4340             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4341                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4342                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4343                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4344                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4345             20  CF-SYSTEM-E                 PIC X.
  4346                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4347
  4348         16  CF-LGX-LIFE-USER               PIC X.
  4349             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4350             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4351
  4352         16  CF-CR-MONTH-END-DT             PIC XX.
  4353
  4354         16  CF-FILE-MAINT-DATES.
  4355             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4356                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4357             20  CF-LAST-BATCH       REDEFINES
  4358                 CF-LAST-BATCH-NO               PIC X(4).
  4359             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4360             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4361             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4362             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4363             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4364             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL156.cbl
  4365             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4366             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4367             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4368             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4369
  4370         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4371         16  FILLER                         PIC X.
  4372
  4373         16  CF-ALT-MORT-CODE               PIC X(4).
  4374         16  CF-MEMBER-CAPTION              PIC X(10).
  4375
  4376         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4377             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4378             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4379             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4380             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4381             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4382
  4383         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4384
  4385         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4386         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4387         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4388         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4389
  4390         16  CF-AH-OVERRIDE-L1              PIC X.
  4391         16  CF-AH-OVERRIDE-L2              PIC XX.
  4392         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4393         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4394
  4395         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4396         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4397
  4398         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4399         16  CF-AR-LAST-EL860-DT            PIC XX.
  4400         16  CF-MP-MONTH-END-DT             PIC XX.
  4401
  4402         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4403         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4404             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4405
  4406         16  CF-AR-MONTH-END-DT             PIC XX.
  4407
  4408         16  CF-CRDTCRD-USER                PIC X.
  4409             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4410             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4411
  4412         16  CF-CC-MONTH-END-DT             PIC XX.
  4413
  4414         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4415
  4416         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4417             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4418             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4419             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4420         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4421         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4422         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL156.cbl
  4423         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4424             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4425             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4426         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4427         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4428         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4429             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4430         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4431
  4432         16  CF-CL-ZIP-CODE.
  4433             20  CF-CL-ZIP-PRIME.
  4434                 24  CF-CL-ZIP-1ST          PIC X.
  4435                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4436                 24  FILLER                 PIC X(4).
  4437             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4438         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4439             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4440             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4441             20  FILLER                     PIC XXX.
  4442
  4443         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4444         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4445         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4446         16  CF-CO-OPTION-START-DATE        PIC XX.
  4447         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4448           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4449                                                      '3' '4'.
  4450           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4451           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4452           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4453           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4454           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4455           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4456
  4457         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4458
  4459         16  CF-PAYMENT-APPROVAL-LEVELS.
  4460             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4461             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4462             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4463             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4464             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4465             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4466
  4467         16  CF-END-USER-REPORTING-USER     PIC X.
  4468             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4469             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4470
  4471         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4472             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4473             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4474
  4475         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4476
  4477         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4478         16  FILLER                         PIC X.
  4479
  4480         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL156.cbl
  4481             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4482             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4483             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4484
  4485         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4486
  4487         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4488             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4489             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4490
  4491         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4492             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4493             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4494
  4495         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4496
  4497         16  CF-CO-ACH-ID-CODE              PIC  X.
  4498             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4499             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4500             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4501         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4502         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4503         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4504         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4505         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4506         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4507         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4508         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4509         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4510                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4511         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4512                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4513
  4514         16  CF-CO-OVER-SHORT.
  4515             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4516             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4517
  4518*         16  FILLER                         PIC X(102).
  4519         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4520             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4521             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4522
  4523         16  CF-AH-APPROVAL-DAYS.
  4524             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4525             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4526             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4527             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4528
  4529         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4530
  4531         16  CF-APPROV-LEV-5.
  4532             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4533             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4534             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4535
  4536         16  FILLER                         PIC X(68).
  4537****************************************************************
  4538*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL156.cbl
  4539****************************************************************
  4540
  4541     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4542         16  CF-PROCESSOR-NAME              PIC X(30).
  4543         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4544         16  CF-PROCESSOR-TITLE             PIC X(26).
  4545         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4546                 88  MESSAGE-YES                VALUE 'Y'.
  4547                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4548
  4549*****************************************************
  4550****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4551****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4552****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4553****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4554*****************************************************
  4555
  4556         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4557             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4558             20  CF-APPLICATION-FORCE       PIC X.
  4559             20  CF-INDIVIDUAL-APP.
  4560                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4561                     28  CF-BROWSE-APP      PIC X.
  4562                     28  CF-UPDATE-APP      PIC X.
  4563
  4564         16  CF-CURRENT-TERM-ON             PIC X(4).
  4565         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4566             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4567             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4568             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4569             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4570             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4571             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4572             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4573         16  CF-PROCESSOR-CARRIER           PIC X.
  4574             88  NO-CARRIER-SECURITY            VALUE ' '.
  4575         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4576             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4577         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4578             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4579         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4580             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4581
  4582         16  CF-PROC-SYS-ACCESS-SW.
  4583             20  CF-PROC-CREDIT-CLAIMS-SW.
  4584                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4585                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4586                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4587                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4588             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4589                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4590                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4591             20  CF-PROC-LIFE-GNRLDGR-SW.
  4592                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4593                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4594                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4595                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4596             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL156.cbl
  4597                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4598                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4599         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4600             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4601             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4602         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4603
  4604         16  CF-APPROVAL-LEVEL                  PIC X.
  4605             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4606             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4607             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4608             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4609             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4610
  4611         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4612
  4613         16  CF-LANGUAGE-TYPE                   PIC X.
  4614             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4615             88  CF-LANG-IS-FR                      VALUE 'F'.
  4616
  4617         16  CF-CSR-IND                         PIC X.
  4618         16  FILLER                             PIC X(239).
  4619
  4620****************************************************************
  4621*             PROCESSOR/REMINDERS RECORD                       *
  4622****************************************************************
  4623
  4624     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4625         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4626             20  CF-START-REMIND-DT         PIC XX.
  4627             20  CF-END-REMIND-DT           PIC XX.
  4628             20  CF-REMINDER-TEXT           PIC X(50).
  4629         16  FILLER                         PIC X(296).
  4630
  4631
  4632****************************************************************
  4633*             STATE MASTER RECORD                              *
  4634****************************************************************
  4635
  4636     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4637         16  CF-STATE-ABBREVIATION          PIC XX.
  4638         16  CF-STATE-NAME                  PIC X(25).
  4639         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4640         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4641             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4642             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4643             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4644             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4645                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4646                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4647             20  CF-ST-PREM-REJECT-SW       PIC X.
  4648                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4649                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4650             20  CF-ST-REF-REJECT-SW        PIC X.
  4651                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4652                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4653         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4654         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL156.cbl
  4655         16  CF-ST-REFUND-RULES.
  4656             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4657             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4658             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4659         16  CF-ST-FST-PMT-EXTENSION.
  4660             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4661             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4662                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4663                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4664                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4665                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4666         16  CF-ST-STATE-CALL.
  4667             20  CF-ST-CALL-UNEARNED        PIC X.
  4668             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4669             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4670         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4671             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4672             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4673         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4674         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4675         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4676         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4677         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4678         16  FILLER                         PIC X.
  4679         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4680             20  CF-ST-BENEFIT-CD           PIC XX.
  4681             20  CF-ST-BENEFIT-KIND         PIC X.
  4682                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4683                 88  CF-ST-AH-KIND              VALUE 'A'.
  4684             20  CF-ST-REM-TERM-CALC        PIC X.
  4685                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4686                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4687                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4688                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4689                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4690                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4691                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4692                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4693
  4694             20  CF-ST-REFUND-CALC          PIC X.
  4695                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4696                 88  ST-REFD-BY-R78             VALUE '1'.
  4697                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4698                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4699                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4700                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4701                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4702                 88  ST-REFD-UTAH               VALUE '7'.
  4703                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4704                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4705                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4706
  4707             20  CF-ST-EARNING-CALC         PIC X.
  4708                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4709                 88  ST-EARN-BY-R78             VALUE '1'.
  4710                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4711                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4712                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL156.cbl
  4713                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4714                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4715                 88  ST-EARN-MEAN               VALUE '8'.
  4716                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4717
  4718             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4719                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4720                 88  ST-OVRD-BY-R78             VALUE '1'.
  4721                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4722                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4723                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4724                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4725                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4726                 88  ST-OVRD-MEAN               VALUE '8'.
  4727                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4728             20  FILLER                     PIC X.
  4729
  4730         16  CF-ST-COMMISSION-CAPS.
  4731             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4732             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4733             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4734             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4735         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4736                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4737
  4738         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4739
  4740         16  CF-ST-STATUTORY-INTEREST.
  4741             20  CF-ST-STAT-DATE-FROM       PIC X.
  4742                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4743                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4744             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4745             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4746             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4747             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4748             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4749
  4750         16  CF-ST-OVER-SHORT.
  4751             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4752             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4753
  4754         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4755
  4756         16  CF-ST-RT-CALC                  PIC X.
  4757
  4758         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4759         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4760         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4761         16  CF-ST-RF-LR-CALC               PIC X.
  4762         16  CF-ST-RF-LL-CALC               PIC X.
  4763         16  CF-ST-RF-LN-CALC               PIC X.
  4764         16  CF-ST-RF-AH-CALC               PIC X.
  4765         16  CF-ST-RF-CP-CALC               PIC X.
  4766*        16  FILLER                         PIC X(206).
  4767*CIDMOD         16  FILLER                         PIC X(192).
  4768         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4769             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4770         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL156.cbl
  4771         16  CF-ST-VFY-2ND-BENE             PIC X.
  4772         16  CF-ST-CAUSAL-STATE             PIC X.
  4773         16  FILLER                         PIC X(185).
  4774
  4775****************************************************************
  4776*             BENEFIT MASTER RECORD                            *
  4777****************************************************************
  4778
  4779     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4780         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4781             20  CF-BENEFIT-CODE            PIC XX.
  4782             20  CF-BENEFIT-NUMERIC  REDEFINES
  4783                 CF-BENEFIT-CODE            PIC XX.
  4784             20  CF-BENEFIT-ALPHA           PIC XXX.
  4785             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4786             20  CF-BENEFIT-COMMENT         PIC X(10).
  4787
  4788             20  CF-LF-COVERAGE-TYPE        PIC X.
  4789                 88  CF-REDUCING                VALUE 'R'.
  4790                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4791
  4792             20  CF-SPECIAL-CALC-CD         PIC X.
  4793                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4794                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4795                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4796                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4797                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4798                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4799                 88  CF-FARM-PLAN               VALUE 'F'.
  4800                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4801                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4802                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4803                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4804                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4805                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4806                 88  CF-PRUDENTIAL              VALUE 'P'.
  4807                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4808                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4809                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4810                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4811                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4812                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4813
  4814             20  CF-JOINT-INDICATOR         PIC X.
  4815                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4816
  4817*            20  FILLER                     PIC X(12).
  4818             20  cf-maximum-benefits        pic s999 comp-3.
  4819             20  FILLER                     PIC X(09).
  4820             20  CF-BENEFIT-CATEGORY        PIC X.
  4821             20  CF-LOAN-TYPE               PIC X(8).
  4822
  4823             20  CF-CO-REM-TERM-CALC        PIC X.
  4824                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4825                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4826                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4827                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4828                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL156.cbl
  4829
  4830             20  CF-CO-EARNINGS-CALC        PIC X.
  4831                 88  CO-EARN-BY-R78             VALUE '1'.
  4832                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4833                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4834                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4835                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4836                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4837                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4838                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4839
  4840             20  CF-CO-REFUND-CALC          PIC X.
  4841                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4842                 88  CO-REFD-BY-R78             VALUE '1'.
  4843                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4844                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4845                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4846                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4847                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4848                 88  CO-REFD-MEAN               VALUE '8'.
  4849                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4850                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4851                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4852
  4853             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4854                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4855                 88  CO-OVRD-BY-R78             VALUE '1'.
  4856                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4857                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4858                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4859                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4860                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4861                 88  CO-OVRD-MEAN               VALUE '8'.
  4862                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4863
  4864             20  CF-CO-BEN-I-G-CD           PIC X.
  4865                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4866                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4867                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4868
  4869         16  FILLER                         PIC X(304).
  4870
  4871
  4872****************************************************************
  4873*             CARRIER MASTER RECORD                            *
  4874****************************************************************
  4875
  4876     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4877         16  CF-ADDRESS-DATA.
  4878             20  CF-MAIL-TO-NAME            PIC X(30).
  4879             20  CF-IN-CARE-OF              PIC X(30).
  4880             20  CF-ADDRESS-LINE-1          PIC X(30).
  4881             20  CF-ADDRESS-LINE-2          PIC X(30).
  4882             20  CF-CITY-STATE              PIC X(30).
  4883             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4884             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4885
  4886         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL156.cbl
  4887             20  CF-CLAIM-NO-METHOD         PIC X.
  4888                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4889                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4890                 88  CLAIM-NO-SEQ               VALUE '3'.
  4891                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4892             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4893                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4894                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4895                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4896
  4897         16  CF-CHECK-NO-CONTROL.
  4898             20  CF-CHECK-NO-METHOD         PIC X.
  4899                 88  CHECK-NO-MANUAL            VALUE '1'.
  4900                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4901                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4902                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4903             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4904                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4905
  4906         16  CF-DOMICILE-STATE              PIC XX.
  4907
  4908         16  CF-EXPENSE-CONTROLS.
  4909             20  CF-EXPENSE-METHOD          PIC X.
  4910                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4911                 88  DOLLARS-PER-PMT            VALUE '2'.
  4912                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4913                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4914             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4915             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4916
  4917         16  CF-CORRESPONDENCE-CONTROL.
  4918             20  CF-LETTER-RESEND-OPT       PIC X.
  4919                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4920                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4921             20  FILLER                     PIC X(4).
  4922
  4923         16  CF-RESERVE-CONTROLS.
  4924             20  CF-MANUAL-SW               PIC X.
  4925                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4926             20  CF-FUTURE-SW               PIC X.
  4927                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4928             20  CF-PTC-SW                  PIC X.
  4929                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4930             20  CF-IBNR-SW                 PIC X.
  4931                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4932             20  CF-PTC-LF-SW               PIC X.
  4933                 88  CF-LF-PTC-USED             VALUE '1'.
  4934             20  CF-CDT-ACCESS-METHOD       PIC X.
  4935                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4936                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4937                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4938             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4939
  4940         16  CF-CLAIM-CALC-METHOD           PIC X.
  4941             88  360-PLUS-MONTHS                VALUE '1'.
  4942             88  365-PLUS-MONTHS                VALUE '2'.
  4943             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4944             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL156.cbl
  4945             88  365-DAILY                      VALUE '5'.
  4946
  4947         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4948         16  FILLER                         PIC X(11).
  4949
  4950         16  CF-LIMIT-AMOUNTS.
  4951             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4952             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4953             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4954             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4955             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4956             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4957             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4958             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4959             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4960             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4961
  4962         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4963         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4964         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4965
  4966         16  CF-ZIP-CODE.
  4967             20  CF-ZIP-PRIME.
  4968                 24  CF-ZIP-1ST             PIC X.
  4969                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4970                 24  FILLER                 PIC X(4).
  4971             20  CF-ZIP-PLUS4               PIC X(4).
  4972         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4973             20  CF-CAN-POSTAL-1            PIC XXX.
  4974             20  CF-CAN-POSTAL-2            PIC XXX.
  4975             20  FILLER                     PIC XXX.
  4976
  4977         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4978         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4979         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4980
  4981         16  CF-RATING-SWITCH               PIC X.
  4982             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4983             88  CF-NO-RATING                   VALUE 'N'.
  4984
  4985         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4986
  4987         16  CF-CARRIER-OVER-SHORT.
  4988             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4989             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4990
  4991         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4992         16  CF-SECPAY-SWITCH               PIC X.
  4993             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4994             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4995         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4996         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4997         16  FILLER                         PIC X(444).
  4998*        16  FILLER                         PIC X(452).
  4999
  5000
  5001****************************************************************
  5002*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL156.cbl
  5003****************************************************************
  5004
  5005     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5006         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5007                                INDEXED BY CF-MORT-NDX.
  5008             20  CF-MORT-TABLE              PIC X(5).
  5009             20  CF-MORT-TABLE-TYPE         PIC X.
  5010                 88  CF-MORT-JOINT              VALUE 'J'.
  5011                 88  CF-MORT-SINGLE             VALUE 'S'.
  5012                 88  CF-MORT-COMBINED           VALUE 'C'.
  5013                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5014                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5015             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5016             20  CF-MORT-AGE-METHOD         PIC XX.
  5017                 88  CF-AGE-LAST                VALUE 'AL'.
  5018                 88  CF-AGE-NEAR                VALUE 'AN'.
  5019             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5020             20  CF-MORT-ADJUSTMENT-DIRECTION
  5021                                            PIC X.
  5022                 88  CF-MINUS                   VALUE '-'.
  5023                 88  CF-PLUS                    VALUE '+'.
  5024             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5025             20  CF-MORT-JOINT-CODE         PIC X.
  5026                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5027             20  CF-MORT-PC-Q               PIC X.
  5028                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5029             20  CF-MORT-TABLE-CODE         PIC X(4).
  5030             20  CF-MORT-COMMENTS           PIC X(15).
  5031             20  FILLER                     PIC X(14).
  5032
  5033         16  FILLER                         PIC X(251).
  5034
  5035
  5036****************************************************************
  5037*             BUSSINESS TYPE MASTER RECORD                     *
  5038****************************************************************
  5039
  5040     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5041* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5042* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5043* AND RECORD 05 IS TYPES 81-99
  5044         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5045             20  CF-BUSINESS-TITLE          PIC  X(19).
  5046             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5047                                            PIC S9V9(4) COMP-3.
  5048             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5049             20  FILLER                     PIC  X.
  5050         16  FILLER                         PIC  X(248).
  5051
  5052
  5053****************************************************************
  5054*             TERMINAL MASTER RECORD                           *
  5055****************************************************************
  5056
  5057     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5058
  5059         16  CF-COMPANY-TERMINALS.
  5060             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL156.cbl
  5061                                  PIC X(4).
  5062         16  FILLER               PIC X(248).
  5063
  5064
  5065****************************************************************
  5066*             LIFE EDIT MASTER RECORD                          *
  5067****************************************************************
  5068
  5069     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5070         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5071             20  CF-LIFE-CODE-IN            PIC XX.
  5072             20  CF-LIFE-CODE-OUT           PIC XX.
  5073         16  FILLER                         PIC X(248).
  5074
  5075
  5076****************************************************************
  5077*             AH EDIT MASTER RECORD                            *
  5078****************************************************************
  5079
  5080     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5081         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5082             20  CF-AH-CODE-IN              PIC XXX.
  5083             20  CF-AH-CODE-OUT             PIC XX.
  5084         16  FILLER                         PIC X(248).
  5085
  5086
  5087****************************************************************
  5088*             CREDIBILITY TABLES                               *
  5089****************************************************************
  5090
  5091     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5092         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5093                             INDEXED BY CF-CRDB-NDX.
  5094             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5095             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5096             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5097         16  FILLER                         PIC  X(332).
  5098
  5099
  5100****************************************************************
  5101*             REPORT CUSTOMIZATION RECORD                      *
  5102****************************************************************
  5103
  5104     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5105         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5106             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5107             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5108             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5109**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5110****       A T-TRANSFER.                                   ****
  5111             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5112
  5113         16  FILLER                         PIC XX.
  5114
  5115         16  CF-CARRIER-CNTL-OPT.
  5116             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5117                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5118                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL156.cbl
  5119             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5120                                            PIC X.
  5121         16  CF-GROUP-CNTL-OPT.
  5122             20  CF-GROUP-OPT-SEQ           PIC 9.
  5123                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5124                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5125             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5126                                            PIC X(6).
  5127         16  CF-STATE-CNTL-OPT.
  5128             20  CF-STATE-OPT-SEQ           PIC 9.
  5129                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5130                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5131             20  CF-STATE-SELECT OCCURS 3 TIMES
  5132                                            PIC XX.
  5133         16  CF-ACCOUNT-CNTL-OPT.
  5134             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5135                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5136                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5137             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5138                                            PIC X(10).
  5139         16  CF-BUS-TYP-CNTL-OPT.
  5140             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5141                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5142                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5143             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5144                                            PIC XX.
  5145         16  CF-LF-TYP-CNTL-OPT.
  5146             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5147                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5148                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5149             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5150                                            PIC XX.
  5151         16  CF-AH-TYP-CNTL-OPT.
  5152             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5153                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5154                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5155             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5156                                            PIC XX.
  5157         16  CF-REPTCD1-CNTL-OPT.
  5158             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5159                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5160                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5161             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5162                                            PIC X(10).
  5163         16  CF-REPTCD2-CNTL-OPT.
  5164             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5165                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5166                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5167             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5168                                            PIC X(10).
  5169         16  CF-USER1-CNTL-OPT.
  5170             20  CF-USER1-OPT-SEQ           PIC 9.
  5171                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5172                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5173             20  CF-USER1-SELECT OCCURS 3 TIMES
  5174                                            PIC X(10).
  5175         16  CF-USER2-CNTL-OPT.
  5176             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL156.cbl
  5177                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5178                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5179             20  CF-USER2-SELECT OCCURS 3 TIMES
  5180                                            PIC X(10).
  5181         16  CF-USER3-CNTL-OPT.
  5182             20  CF-USER3-OPT-SEQ           PIC 9.
  5183                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5184                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5185             20  CF-USER3-SELECT OCCURS 3 TIMES
  5186                                            PIC X(10).
  5187         16  CF-USER4-CNTL-OPT.
  5188             20  CF-USER4-OPT-SEQ           PIC 9.
  5189                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5190                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5191             20  CF-USER4-SELECT OCCURS 3 TIMES
  5192                                            PIC X(10).
  5193         16  CF-USER5-CNTL-OPT.
  5194             20  CF-USER5-OPT-SEQ           PIC 9.
  5195                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5196                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5197             20  CF-USER5-SELECT OCCURS 3 TIMES
  5198                                            PIC X(10).
  5199         16  CF-REINS-CNTL-OPT.
  5200             20  CF-REINS-OPT-SEQ           PIC 9.
  5201                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5202                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5203             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5204                 24  CF-REINS-PRIME         PIC XXX.
  5205                 24  CF-REINS-SUB           PIC XXX.
  5206
  5207         16  CF-AGENT-CNTL-OPT.
  5208             20  CF-AGENT-OPT-SEQ           PIC 9.
  5209                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5210                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5211             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5212                                            PIC X(10).
  5213
  5214         16  FILLER                         PIC X(43).
  5215
  5216         16  CF-LOSS-RATIO-SELECT.
  5217             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5218             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5219         16  CF-ENTRY-DATE-SELECT.
  5220             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5221             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5222         16  CF-EFFECTIVE-DATE-SELECT.
  5223             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5224             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5225
  5226         16  CF-EXCEPTION-LIST-IND          PIC X.
  5227             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5228
  5229         16  FILLER                         PIC X(318).
  5230
  5231****************************************************************
  5232*                  EXCEPTION REPORTING RECORD                  *
  5233****************************************************************
  5234
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL156.cbl
  5235     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5236         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5237             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5238
  5239         16  CF-COMBINED-LIFE-AH-OPT.
  5240             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5241             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5242             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5243             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5244
  5245         16  CF-LIFE-OPT.
  5246             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5247             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5248             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5249             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5250             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5251             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5252             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5253             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5254             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5255             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5256
  5257         16  CF-AH-OPT.
  5258             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5259             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5260             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5261             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5262             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5263             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5264             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5265             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5266             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5267             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5268
  5269         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5270             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5271             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5272             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5273
  5274         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5275
  5276         16  FILLER                         PIC X(673).
  5277
  5278
  5279****************************************************************
  5280*             MORTGAGE SYSTEM PLAN RECORD                      *
  5281****************************************************************
  5282
  5283     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5284         16  CF-PLAN-TYPE                   PIC X.
  5285             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5286             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5287             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5288         16  CF-PLAN-ABBREV                 PIC XXX.
  5289         16  CF-PLAN-DESCRIPT               PIC X(10).
  5290         16  CF-PLAN-NOTES                  PIC X(20).
  5291         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5292         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL156.cbl
  5293             20  CF-PLAN-TERM-DATA.
  5294                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5295                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5296             20  CF-PLAN-AGE-DATA.
  5297                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5298                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5299                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5300             20  CF-PLAN-BENEFIT-DATA.
  5301                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5302                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5303                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5304                                            PIC S9(7)V99  COMP-3.
  5305         16  CF-PLAN-POLICY-FORMS.
  5306             20  CF-POLICY-FORM             PIC X(12).
  5307             20  CF-MASTER-APPLICATION      PIC X(12).
  5308             20  CF-MASTER-POLICY           PIC X(12).
  5309         16  CF-PLAN-RATING.
  5310             20  CF-RATE-CODE               PIC X(5).
  5311             20  CF-SEX-RATING              PIC X.
  5312                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5313                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5314             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5315             20  CF-SUB-STD-TYPE            PIC X.
  5316                 88  CF-PCT-OF-PREM            VALUE '1'.
  5317                 88  CF-PCT-OF-BENE            VALUE '2'.
  5318         16  CF-PLAN-PREM-TOLERANCES.
  5319             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5320             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5321         16  CF-PLAN-PYMT-TOLERANCES.
  5322             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5323             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5324         16  CF-PLAN-MISC-DATA.
  5325             20  FILLER                     PIC X.
  5326             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5327             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5328         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5329         16  CF-PLAN-IND-GRP                PIC X.
  5330             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5331                                                     '1'.
  5332             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5333                                                     '2'.
  5334         16  CF-MIB-SEARCH-SW               PIC X.
  5335             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5336             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5337             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5338             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5339         16  CF-ALPHA-SEARCH-SW             PIC X.
  5340             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5341             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5342             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5343             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5344             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5345             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5346             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5347             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5348             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5349             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5350                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL156.cbl
  5351                                                     'X' 'Y' 'Z'.
  5352         16  CF-EFF-DT-RULE-SW              PIC X.
  5353             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5354             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5355             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5356             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5357             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5358         16  FILLER                         PIC X(4).
  5359         16  CF-HEALTH-QUESTIONS            PIC X.
  5360             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5361         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5362         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5363         16  CF-PLAN-SNGL-JNT               PIC X.
  5364             88  CF-COMBINED-PLAN              VALUE 'C'.
  5365             88  CF-JNT-PLAN                   VALUE 'J'.
  5366             88  CF-SNGL-PLAN                  VALUE 'S'.
  5367         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5368         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5369         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5370         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5371         16  CF-RERATE-CNTL                 PIC  X.
  5372             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5373             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5374             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5375             88  CF-AUTO-RECALC                 VALUE '4'.
  5376         16  CF-BENEFIT-TYPE                PIC  X.
  5377             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5378             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5379         16  CF-POLICY-FEE                  PIC S999V99
  5380                                                    COMP-3.
  5381         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5382         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5383         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5384         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5385         16  FILLER                         PIC  X(32).
  5386         16  CF-TERMINATION-FORM            PIC  X(04).
  5387         16  FILLER                         PIC  X(08).
  5388         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5389                                                       COMP-3.
  5390         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5391         16  CF-ISSUE-LETTER                PIC  X(4).
  5392         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5393         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5394             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5395             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5396         16  CF-MP-REFUND-CALC              PIC X.
  5397             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5398             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5399             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5400             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5401             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5402             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5403             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5404             88  CF-MP-REFD-MEAN                VALUE '8'.
  5405         16  CF-ALT-RATE-CODE               PIC  X(5).
  5406
  5407
  5408         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL156.cbl
  5409****************************************************************
  5410*             MORTGAGE COMPANY MASTER RECORD                   *
  5411****************************************************************
  5412
  5413     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5414         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5415         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5416             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5417             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5418             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5419             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5420             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5421
  5422         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5423         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5424         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5425         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5426         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5427
  5428         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5429             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5430         16  CF-MP-RECON-USE-IND            PIC X(1).
  5431             88  CF-MP-USE-RECON             VALUE 'Y'.
  5432         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5433             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5434         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5435             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5436             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5437         16  FILLER                         PIC X(1).
  5438         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5439             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5440         16  CF-MORTG-MIB-VERSION           PIC X.
  5441             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5442             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5443             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5444         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5445             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5446                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5447             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5448                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5449             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5450                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5451             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5452                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5453             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5454                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5455             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5456                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5457         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5458         16  FILLER                         PIC X(7).
  5459         16  CF-MORTG-DESTINATION-SYMBOL.
  5460             20  CF-MORTG-MIB-COMM          PIC X(5).
  5461             20  CF-MORTG-MIB-TERM          PIC X(5).
  5462         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5463             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5464         16  FILLER                         PIC X(03).
  5465         16  CF-MP-CHECK-NO-CONTROL.
  5466             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL156.cbl
  5467                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5468                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5469                                                ' ' LOW-VALUES.
  5470                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5471                                               VALUE '3'.
  5472         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5473         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5474         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5475             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5476                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5477             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5478                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5479             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5480                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5481             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5482                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5483             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5484                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5485             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5486                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5487         16  CF-MORTG-BILLING-AREA.
  5488             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5489                                            PIC X.
  5490         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5491         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5492         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5493         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5494             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5495             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5496         16  FILLER                         PIC X.
  5497         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5498             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5499             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5500         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5501         16  FILLER                         PIC X(8).
  5502         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5503         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5504         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5505         16  CF-ACH-COMPANY-ID.
  5506             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5507                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5508                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5509                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5510             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5511         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5512             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5513         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5514             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5515             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5516         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5517         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5518         16  FILLER                         PIC X(536).
  5519
  5520****************************************************************
  5521*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5522****************************************************************
  5523
  5524     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL156.cbl
  5525         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5526             20  CF-FEMALE-HEIGHT.
  5527                 24  CF-FEMALE-FT           PIC 99.
  5528                 24  CF-FEMALE-IN           PIC 99.
  5529             20  CF-FEMALE-MIN-WT           PIC 999.
  5530             20  CF-FEMALE-MAX-WT           PIC 999.
  5531         16  FILLER                         PIC X(428).
  5532
  5533     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5534         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5535             20  CF-MALE-HEIGHT.
  5536                 24  CF-MALE-FT             PIC 99.
  5537                 24  CF-MALE-IN             PIC 99.
  5538             20  CF-MALE-MIN-WT             PIC 999.
  5539             20  CF-MALE-MAX-WT             PIC 999.
  5540         16  FILLER                         PIC X(428).
  5541******************************************************************
  5542*             AUTOMATIC ACTIVITY RECORD                          *
  5543******************************************************************
  5544     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5545         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5546             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5547             20  CF-SYS-LETTER-ID           PIC X(04).
  5548             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5549             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5550             20  CF-SYS-RESET-SW            PIC X(01).
  5551             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5552             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5553
  5554         16  FILLER                         PIC X(50).
  5555
  5556         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5557             20  CF-USER-ACTIVE-SW          PIC X(01).
  5558             20  CF-USER-LETTER-ID          PIC X(04).
  5559             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5560             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5561             20  CF-USER-RESET-SW           PIC X(01).
  5562             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5563             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5564             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5565
  5566         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL156.cbl
  5568*    COPY ELCCERT.
  5569******************************************************************
  5570*                                                                *
  5571*                            ELCCERT.                            *
  5572*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5573*                            VMOD=2.013                          *
  5574*                                                                *
  5575*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5576*                                                                *
  5577*   FILE TYPE = VSAM,KSDS                                        *
  5578*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5579*                                                                *
  5580*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5581*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5582*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5583*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5584*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5585*                                                                *
  5586*   LOG = YES                                                    *
  5587*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5588******************************************************************
  5589*                   C H A N G E   L O G
  5590*
  5591* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5592*-----------------------------------------------------------------
  5593*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5594* EFFECTIVE    NUMBER
  5595*-----------------------------------------------------------------
  5596* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5597* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5598* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5599* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5600* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5601* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5602* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5603* 032612  CR2011110200001  PEMA  AHL CHANGES
  5604******************************************************************
  5605
  5606 01  CERTIFICATE-MASTER.
  5607     12  CM-RECORD-ID                      PIC XX.
  5608         88  VALID-CM-ID                      VALUE 'CM'.
  5609
  5610     12  CM-CONTROL-PRIMARY.
  5611         16  CM-COMPANY-CD                 PIC X.
  5612         16  CM-CARRIER                    PIC X.
  5613         16  CM-GROUPING.
  5614             20  CM-GROUPING-PREFIX        PIC X(3).
  5615             20  CM-GROUPING-PRIME         PIC X(3).
  5616         16  CM-STATE                      PIC XX.
  5617         16  CM-ACCOUNT.
  5618             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5619             20  CM-ACCOUNT-PRIME          PIC X(6).
  5620         16  CM-CERT-EFF-DT                PIC XX.
  5621         16  CM-CERT-NO.
  5622             20  CM-CERT-PRIME             PIC X(10).
  5623             20  CM-CERT-SFX               PIC X.
  5624
  5625     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL156.cbl
  5626         16  CM-COMPANY-CD-A1              PIC X.
  5627         16  CM-INSURED-LAST-NAME          PIC X(15).
  5628         16  CM-INSURED-INITIALS.
  5629             20  CM-INSURED-INITIAL1       PIC X.
  5630             20  CM-INSURED-INITIAL2       PIC X.
  5631
  5632     12  CM-CONTROL-BY-SSN.
  5633         16  CM-COMPANY-CD-A2              PIC X.
  5634         16  CM-SOC-SEC-NO.
  5635             20  CM-SSN-STATE              PIC XX.
  5636             20  CM-SSN-ACCOUNT            PIC X(6).
  5637             20  CM-SSN-LN3.
  5638                 25  CM-INSURED-INITIALS-A2.
  5639                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5640                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5641                 25 CM-PART-LAST-NAME-A2         PIC X.
  5642
  5643     12  CM-CONTROL-BY-CERT-NO.
  5644         16  CM-COMPANY-CD-A4              PIC X.
  5645         16  CM-CERT-NO-A4                 PIC X(11).
  5646
  5647     12  CM-CONTROL-BY-MEMB.
  5648         16  CM-COMPANY-CD-A5              PIC X.
  5649         16  CM-MEMBER-NO.
  5650             20  CM-MEMB-STATE             PIC XX.
  5651             20  CM-MEMB-ACCOUNT           PIC X(6).
  5652             20  CM-MEMB-LN4.
  5653                 25  CM-INSURED-INITIALS-A5.
  5654                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5655                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5656                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5657
  5658     12  CM-INSURED-PROFILE-DATA.
  5659         16  CM-INSURED-FIRST-NAME.
  5660             20  CM-INSURED-1ST-INIT       PIC X.
  5661             20  FILLER                    PIC X(9).
  5662         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5663         16  CM-INSURED-SEX                PIC X.
  5664             88  CM-SEX-MALE                  VALUE 'M'.
  5665             88  CM-SEX-FEMAL                 VALUE 'F'.
  5666         16  CM-INSURED-JOINT-AGE          PIC 99.
  5667         16  CM-JOINT-INSURED-NAME.
  5668             20  CM-JT-LAST-NAME           PIC X(15).
  5669             20  CM-JT-FIRST-NAME.
  5670                 24  CM-JT-1ST-INIT        PIC X.
  5671                 24  FILLER                PIC X(9).
  5672             20  CM-JT-INITIAL             PIC X.
  5673
  5674     12  CM-LIFE-DATA.
  5675         16  CM-LF-BENEFIT-CD              PIC XX.
  5676         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5677         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5678         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5679         16  CM-LF-DEV-CODE                PIC XXX.
  5680         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5681         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5682         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5683         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL156.cbl
  5684         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5685         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5686         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5687         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5688         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5689         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5690         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5691         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5692         16  cm-temp-epiq                  pic xx.
  5693             88  EPIQ-CLASS                  value 'EQ'.
  5694*        16  FILLER                        PIC XX.
  5695
  5696     12  CM-AH-DATA.
  5697         16  CM-AH-BENEFIT-CD              PIC XX.
  5698         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5699         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5700         16  CM-AH-DEV-CODE                PIC XXX.
  5701         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5702         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5703         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5704         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5705         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5706         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5707         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5708         16  CM-AH-PAID-THRU-DT            PIC XX.
  5709             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5710         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5711         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5712         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5713         16  FILLER                        PIC X.
  5714
  5715     12  CM-LOAN-INFORMATION.
  5716         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5717         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5718                                           PIC S9(5)V99  COMP-3.
  5719         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5720         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5721         16  CM-PAY-FREQUENCY              PIC S99.
  5722         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5723         16  CM-RATE-CLASS                 PIC XX.
  5724         16  CM-BENEFICIARY                PIC X(25).
  5725         16  CM-POLICY-FORM-NO             PIC X(12).
  5726         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5727         16  CM-LAST-ADD-ON-DT             PIC XX.
  5728         16  CM-DEDUCTIBLE-AMOUNTS.
  5729             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5730             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5731         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5732             20  CM-RESIDENT-STATE         PIC XX.
  5733             20  CM-RATE-CODE              PIC X(4).
  5734             20  FILLER                    PIC XX.
  5735         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5736             20  CM-LOAN-OFFICER           PIC X(5).
  5737             20  FILLER                    PIC XXX.
  5738         16  CM-CSR-CODE                   PIC XXX.
  5739         16  CM-UNDERWRITING-CODE          PIC X.
  5740             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5741         16  CM-POST-CARD-IND              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL156.cbl
  5742         16  CM-NH-INTERFACE-SW            PIC X.
  5743         16  CM-PREMIUM-TYPE               PIC X.
  5744             88  CM-SING-PRM                  VALUE '1'.
  5745             88  CM-O-B-COVERAGE              VALUE '2'.
  5746             88  CM-OPEN-END                  VALUE '3'.
  5747         16  CM-IND-GRP-TYPE               PIC X.
  5748             88  CM-INDIVIDUAL                VALUE 'I'.
  5749             88  CM-GROUP                     VALUE 'G'.
  5750         16  CM-SKIP-CODE                  PIC X.
  5751             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5752             88  SKIP-JULY                    VALUE '1'.
  5753             88  SKIP-AUGUST                  VALUE '2'.
  5754             88  SKIP-SEPTEMBER               VALUE '3'.
  5755             88  SKIP-JULY-AUG                VALUE '4'.
  5756             88  SKIP-AUG-SEPT                VALUE '5'.
  5757             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5758             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5759             88  SKIP-JUNE                    VALUE '8'.
  5760             88  SKIP-JUNE-JULY               VALUE '9'.
  5761             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5762             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5763         16  CM-PAYMENT-MODE               PIC X.
  5764             88  PAY-MONTHLY                  VALUE SPACE.
  5765             88  PAY-WEEKLY                   VALUE '1'.
  5766             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5767             88  PAY-BI-WEEKLY                VALUE '3'.
  5768             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5769         16  CM-LOAN-NUMBER                PIC X(8).
  5770         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5771         16  CM-OLD-LOF                    PIC XXX.
  5772*        16  CM-LOAN-OFFICER               PIC XXX.
  5773         16  CM-REIN-TABLE                 PIC XXX.
  5774         16  CM-SPECIAL-REIN-CODE          PIC X.
  5775         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5776         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5777         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5778
  5779     12  CM-STATUS-DATA.
  5780         16  CM-ENTRY-STATUS               PIC X.
  5781         16  CM-ENTRY-DT                   PIC XX.
  5782
  5783         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5784         16  CM-LF-CANCEL-DT               PIC XX.
  5785         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5786
  5787         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5788         16  CM-LF-DEATH-DT                PIC XX.
  5789         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5790
  5791         16  CM-LF-CURRENT-STATUS          PIC X.
  5792             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5793                                                'M' '4' '5' '9'.
  5794             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5795             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5796             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5797             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5798             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5799             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL156.cbl
  5800             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5801             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5802             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5803             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5804             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5805             88  CM-LF-DECLINED               VALUE 'D'.
  5806             88  CM-LF-VOIDED                 VALUE 'V'.
  5807
  5808         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5809         16  CM-AH-CANCEL-DT               PIC XX.
  5810         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5811
  5812         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5813         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5814         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5815
  5816         16  CM-AH-CURRENT-STATUS          PIC X.
  5817             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5818                                                'M' '4' '5' '9'.
  5819             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5820             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5821             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5822             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5823             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5824             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5825             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5826             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5827             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5828             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5829             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5830             88  CM-AH-DECLINED               VALUE 'D'.
  5831             88  CM-AH-VOIDED                 VALUE 'V'.
  5832
  5833         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5834             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5835             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5836             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5837         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5838
  5839         16  CM-ENTRY-BATCH                PIC X(6).
  5840         16  CM-LF-EXIT-BATCH              PIC X(6).
  5841         16  CM-AH-EXIT-BATCH              PIC X(6).
  5842         16  CM-LAST-MONTH-END             PIC XX.
  5843
  5844     12  CM-NOTE-SW                        PIC X.
  5845         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5846         88  CERT-NOTES-PRESENT               VALUE '1'.
  5847         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5848         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5849         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5850         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5851         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5852         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5853     12  CM-COMP-EXCP-SW                   PIC X.
  5854         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5855         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5856     12  CM-INSURED-ADDRESS-SW             PIC X.
  5857         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL156.cbl
  5858         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5859
  5860*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5861     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5862     12  FILLER                            PIC X.
  5863
  5864*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5865     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5866     12  FILLER                            PIC X.
  5867*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5868     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5869
  5870     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5871         88  CERT-ADDED-BATCH                 VALUE ' '.
  5872         88  CERT-ADDED-ONLINE                VALUE '1'.
  5873         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5874         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5875         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5876     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5877         88  CERT-AS-LOADED                   VALUE ' '.
  5878         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5879         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5880         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5881         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5882         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5883         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5884         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5885
  5886     12  CM-ACCOUNT-COMM-PCTS.
  5887         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5888         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5889
  5890     12  CM-USER-FIELD                     PIC X.
  5891     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5892     12  CM-CLP-STATE                      PIC XX.
  5893     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5894     12  CM-USER-RESERVED                  PIC XXX.
  5895     12  FILLER REDEFINES CM-USER-RESERVED.
  5896         16  CM-AH-CLASS-CD                PIC XX.
  5897         16  F                             PIC X.
  5898******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL156.cbl
  5900*    COPY ELCTRLR.
  5901******************************************************************
  5902*                                                                *
  5903*                            ELCTRLR.                            *
  5904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5905*                            VMOD=2.014                          *
  5906*                                                                *
  5907*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5908*                                                                *
  5909*   FILE TYPE = VSAM,KSDS                                        *
  5910*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5911*                                                                *
  5912*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5913*       ALTERNATE INDEX = NONE                                   *
  5914*                                                                *
  5915*   LOG = YES                                                    *
  5916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5917******************************************************************
  5918*                   C H A N G E   L O G
  5919*
  5920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5921*-----------------------------------------------------------------
  5922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5923* EFFECTIVE    NUMBER
  5924*-----------------------------------------------------------------
  5925* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5926* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5927* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5928* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5929* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5930* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5931* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5932* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5933* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5934* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5935* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5936* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5937* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5938* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5939* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5940* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5941* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5942* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5943* 040814    2014030500002  AJRA  ADD ICD CODES
  5944* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5945******************************************************************
  5946 01  ACTIVITY-TRAILERS.
  5947     12  AT-RECORD-ID                    PIC XX.
  5948         88  VALID-AT-ID                       VALUE 'AT'.
  5949
  5950     12  AT-CONTROL-PRIMARY.
  5951         16  AT-COMPANY-CD               PIC X.
  5952         16  AT-CARRIER                  PIC X.
  5953         16  AT-CLAIM-NO                 PIC X(7).
  5954         16  AT-CERT-NO.
  5955             20  AT-CERT-PRIME           PIC X(10).
  5956             20  AT-CERT-SFX             PIC X.
  5957         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL156.cbl
  5958             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5959             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5960             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5961             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5962             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5963             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5964             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5965             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5966             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5967             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5968             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5969             88  AT-BENEFICIARY-TRL           VALUE +91.
  5970             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5971             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5972             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5973             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5974
  5975     12  AT-TRAILER-TYPE                 PIC X.
  5976         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5977         88  PAYMENT-TR                       VALUE '2'.
  5978         88  AUTO-PAY-TR                      VALUE '3'.
  5979         88  CORRESPONDENCE-TR                VALUE '4'.
  5980         88  ADDRESS-TR                       VALUE '5'.
  5981         88  GENERAL-INFO-TR                  VALUE '6'.
  5982         88  AUTO-PROMPT-TR                   VALUE '7'.
  5983         88  DENIAL-TR                        VALUE '8'.
  5984         88  INCURRED-CHG-TR                  VALUE '9'.
  5985         88  FORM-CONTROL-TR                  VALUE 'A'.
  5986
  5987     12  AT-RECORDED-DT                  PIC XX.
  5988     12  AT-RECORDED-BY                  PIC X(4).
  5989     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5990
  5991     12  AT-TRAILER-BODY                 PIC X(165).
  5992
  5993     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5994         16  AT-RESERVE-CONTROLS.
  5995             20  AT-MANUAL-SW            PIC X.
  5996                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5997             20  AT-FUTURE-SW            PIC X.
  5998                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5999             20  AT-PTC-SW               PIC X.
  6000                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6001             20  AT-IBNR-SW              PIC X.
  6002                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6003             20  AT-PTC-LF-SW            PIC X.
  6004                 88  AT-LF-PTC-USED          VALUE '1'.
  6005             20  AT-CDT-ACCESS-METHOD    PIC X.
  6006                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6007                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6008                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6009             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6010         16  AT-LAST-COMPUTED-DT         PIC XX.
  6011         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6012         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6013         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6014         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6015         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL156.cbl
  6016         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6017         16  AT-EXPENSE-CONTROLS.
  6018             20  AT-EXPENSE-METHOD       PIC X.
  6019                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6020                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6021                 88  PERCENT-OF-PMT           VALUE '3'.
  6022                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6023             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6024             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6025         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6026         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6027
  6028         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6029         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6030
  6031*        16  FILLER                      PIC X(53).
  6032         16  FILLER                      PIC X(47).
  6033
  6034         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6035         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6036
  6037         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6038             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6039             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6040*                    C = CLOSED
  6041*                    O = OPEN
  6042             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6043*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6044
  6045     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6046         16  AT-PAYMENT-TYPE             PIC X.
  6047             88  PARTIAL-PAYMENT                VALUE '1'.
  6048             88  FINAL-PAYMENT                  VALUE '2'.
  6049             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6050             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6051             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6052             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6053             88  VOIDED-PAYMENT                 VALUE '9'.
  6054             88  TRANSFER                       VALUE 'T'.
  6055             88  LIFE-INTEREST                  VALUE 'I'.
  6056
  6057         16  AT-CLAIM-TYPE               PIC X.
  6058             88  PAID-FOR-AH                    VALUE 'A'.
  6059             88  PAID-FOR-LIFE                  VALUE 'L'.
  6060             88  PAID-FOR-IUI                   VALUE 'I'.
  6061             88  PAID-FOR-GAP                   VALUE 'G'.
  6062             88  PAID-FOR-FAM                   VALUE 'F'.
  6063         16  AT-CLAIM-PREM-TYPE          PIC X.
  6064             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6065             88  AT-O-B-COVERAGE                VALUE '2'.
  6066             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6067         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6068         16  AT-CHECK-NO                 PIC X(7).
  6069         16  AT-PAID-FROM-DT             PIC XX.
  6070         16  AT-PAID-THRU-DT             PIC XX.
  6071         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6072         16  FILLER                      PIC X.
  6073         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL156.cbl
  6074         16  AT-PAYMENT-ORIGIN           PIC X.
  6075             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6076             88  ONLINE-AUTO-PMT                VALUE '2'.
  6077             88  OFFLINE-PMT                    VALUE '3'.
  6078         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6079         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6080         16  AT-VOID-DATA.
  6081             20  AT-VOID-DT              PIC XX.
  6082*00144       20  AT-VOID-REASON          PIC X(30).
  6083             20  AT-VOID-REASON          PIC X(26).
  6084         16  AT-PMT-APPROVED-BY          PIC X(04).
  6085         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6086         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6087         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6088                                         PIC S99V9(5)  COMP-3.
  6089         16  AT-CREDIT-INTERFACE.
  6090             20  AT-PMT-SELECT-DT        PIC XX.
  6091                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6092             20  AT-PMT-ACCEPT-DT        PIC XX.
  6093                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6094             20  AT-VOID-SELECT-DT       PIC XX.
  6095                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6096             20  AT-VOID-ACCEPT-DT       PIC XX.
  6097                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6098
  6099         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6100                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6101                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6102         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6103
  6104         16  AT-FORCE-CONTROL            PIC X.
  6105             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6106         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6107         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6108         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6109         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6110         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6111         16  AT-BENEFIT-TYPE             PIC X.
  6112
  6113         16  AT-EXPENSE-TYPE             PIC X.
  6114         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6115
  6116         16  AT-PAYEE-TYPE-CD.
  6117             20  AT-PAYEE-TYPE           PIC X.
  6118                 88  INSURED-PAID           VALUE 'I'.
  6119                 88  BENEFICIARY-PAID       VALUE 'B'.
  6120                 88  ACCOUNT-PAID           VALUE 'A'.
  6121                 88  OTHER-1-PAID           VALUE 'O'.
  6122                 88  OTHER-2-PAID           VALUE 'Q'.
  6123                 88  DOCTOR-PAID            VALUE 'P'.
  6124                 88  EMPLOYER-PAID          VALUE 'E'.
  6125             20  AT-PAYEE-SEQ            PIC X.
  6126
  6127         16  AT-CASH-PAYMENT             PIC X.
  6128         16  AT-GROUPED-PAYMENT          PIC X.
  6129         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6130         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6131         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL156.cbl
  6132         16  AT-VOID-TYPE                PIC X.
  6133             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6134             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6135         16  AT-AIG-UNEMP-IND            PIC X.
  6136             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6137         16  AT-ASSOCIATES               PIC X.
  6138             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6139             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6140
  6141         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6142         16  AT-CV-PMT-CODE              PIC X.
  6143             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6144             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6145             88  FULL-ADD-PAYMENT           VALUE '3'.
  6146             88  HALF-ADD-PAYMENT           VALUE '4'.
  6147             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6148             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6149             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6150             88  ADDL-PAYMENT               VALUE '8'.
  6151
  6152         16  AT-EOB-CODE1                PIC XXX.
  6153         16  AT-EOB-CODE2                PIC XXX.
  6154         16  AT-EOB-CODE3                PIC XXX.
  6155         16  FILLER REDEFINES AT-EOB-CODE3.
  6156             20  AT-PRINT-CLM-FORM       PIC X.
  6157             20  AT-PRINT-SURVEY         PIC X.
  6158             20  AT-SPECIAL-RELEASE      PIC X.
  6159         16  AT-EOB-CODE4                PIC XXX.
  6160         16  FILLER REDEFINES AT-EOB-CODE4.
  6161             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6162             20  FILLER                  PIC X.
  6163         16  AT-EOB-CODE5                PIC XXX.
  6164         16  FILLER REDEFINES AT-EOB-CODE5.
  6165             20  AT-PMT-PROOF-DT         PIC XX.
  6166             20  FILLER                  PIC X.
  6167
  6168         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6169             88  AT-PRINT-EOB            VALUE 'Y'.
  6170
  6171         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6172         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6173
  6174     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6175         16  AT-SCHEDULE-START-DT        PIC XX.
  6176         16  AT-SCHEDULE-END-DT          PIC XX.
  6177         16  AT-TERMINATED-DT            PIC XX.
  6178         16  AT-LAST-PMT-TYPE            PIC X.
  6179             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6180             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6181         16  AT-FIRST-PMT-DATA.
  6182             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6183             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6184             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6185         16  AT-REGULAR-PMT-DATA.
  6186             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6187             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6188             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6189         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL156.cbl
  6190             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6191                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6192                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6193                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6194                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6195                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6196             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6197         16  AT-AUTO-PAY-DAY             PIC 99.
  6198         16  AT-AUTO-CASH                PIC X.
  6199             88  AT-CASH                      VALUE 'Y'.
  6200             88  AT-NON-CASH                  VALUE 'N'.
  6201*        16  FILLER                      PIC X(129).
  6202         16  AT-AUTO-END-LETTER          PIC X(4).
  6203         16  FILLER                      PIC X(125).
  6204
  6205         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6206         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6207
  6208     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6209         16  AT-LETTER-SENT-DT           PIC XX.
  6210         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6211         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6212         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6213         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6214         16  AT-LETTER-ORIGIN            PIC X.
  6215             88  ONLINE-CREATION              VALUE '1' '3'.
  6216             88  OFFLINE-CREATION             VALUE '2' '4'.
  6217             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6218             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6219         16  AT-STD-LETTER-FORM          PIC X(4).
  6220         16  AT-REASON-TEXT              PIC X(70).
  6221         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6222         16  AT-ADDRESEE-TYPE            PIC X.
  6223              88  INSURED-ADDRESEE            VALUE 'I'.
  6224              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6225              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6226              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6227              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6228              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6229              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6230         16  AT-ADDRESSEE-NAME           PIC X(30).
  6231         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6232         16  AT-RESEND-PRINT-DATE        PIC XX.
  6233         16  AT-CORR-SOL-UNSOL           PIC X.
  6234         16  AT-LETTER-PURGED-DT         PIC XX.
  6235*
  6236*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6237*
  6238         16  AT-CSO-REDEFINITION.
  6239             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6240             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6241             20  AT-LETTER-TO-BENE       PIC X(1).
  6242             20  AT-STOP-LETTER-DT       PIC X(2).
  6243             20  FILLER                  PIC X(19).
  6244*             20  FILLER                  PIC X(27).
  6245             20  AT-CSO-LETTER-STATUS    PIC X.
  6246                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6247                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL156.cbl
  6248                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6249             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6250             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6251*
  6252*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6253*
  6254*        16  FILLER                      PIC X(26).
  6255*
  6256*        16  AT-DMD-BSR-CODE             PIC X.
  6257*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6258*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6259*
  6260*        16  AT-DMD-LETTER-STATUS        PIC X.
  6261*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6262*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6263*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6264*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6265*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6266
  6267         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6268         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6269
  6270     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6271         16  AT-ADDRESS-TYPE             PIC X.
  6272             88  INSURED-ADDRESS               VALUE 'I'.
  6273             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6274             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6275             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6276             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6277             88  OTHER-ADDRESS-1               VALUE 'O'.
  6278             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6279         16  AT-MAIL-TO-NAME             PIC X(30).
  6280         16  AT-ADDRESS-LINE-1           PIC X(30).
  6281         16  AT-ADDRESS-LINE-2           PIC X(30).
  6282         16  AT-CITY-STATE.
  6283             20  AT-CITY                 PIC X(28).
  6284             20  AT-STATE                PIC XX.
  6285         16  AT-ZIP.
  6286             20  AT-ZIP-CODE.
  6287                 24  AT-ZIP-1ST          PIC X.
  6288                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6289                 24  FILLER              PIC X(4).
  6290             20  AT-ZIP-PLUS4            PIC X(4).
  6291         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6292             20  AT-CAN-POSTAL-1         PIC XXX.
  6293             20  AT-CAN-POSTAL-2         PIC XXX.
  6294             20  FILLER                  PIC XXX.
  6295         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6296*         16  FILLER                      PIC X(23).
  6297         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6298         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6299         16  FILLER                      PIC X(13).
  6300         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6301         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6302
  6303     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6304         16  AT-INFO-LINE-1              PIC X(60).
  6305         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL156.cbl
  6306             20  AT-NOTE-ERROR-NO OCCURS 15
  6307                                         PIC X(4).
  6308         16  AT-INFO-LINE-2              PIC X(60).
  6309         16  FILLER REDEFINES AT-INFO-LINE-2.
  6310             20  AT-ICD-CODE-1           PIC X(8).
  6311             20  AT-ICD-CODE-2           PIC X(8).
  6312             20  FILLER                  PIC X(44).
  6313         16  AT-INFO-TRAILER-TYPE        PIC X.
  6314             88  AT-ERRORS-NOTE          VALUE 'E'.
  6315             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6316             88  AT-CALL-NOTE            VALUE 'C'.
  6317             88  AT-MAINT-NOTE           VALUE 'M'.
  6318             88  AT-CERT-CHANGE          VALUE 'X'.
  6319             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6320             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6321             88  AT-CERT-CANCELLED       VALUE 'T'.
  6322         16  AT-CALL-TYPE                PIC X.
  6323             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6324             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6325         16  AT-NOTE-CONTINUATION        PIC X.
  6326             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6327         16  AT-EOB-CODES-EXIST          PIC X.
  6328             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6329         16  FILLER                      PIC X(35).
  6330         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6331         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6332
  6333     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6334         16  AT-PROMPT-LINE-1            PIC X(60).
  6335         16  AT-PROMPT-LINE-2            PIC X(60).
  6336         16  AT-PROMPT-START-DT          PIC XX.
  6337         16  AT-PROMPT-END-DT            PIC XX.
  6338         16  FILLER                      PIC X(35).
  6339         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6340         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6341
  6342     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6343         16  AT-DENIAL-INFO-1            PIC X(60).
  6344         16  AT-DENIAL-INFO-2            PIC X(60).
  6345         16  AT-DENIAL-DT                PIC XX.
  6346         16  AT-RETRACTION-DT            PIC XX.
  6347         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6348*         16  FILLER                      PIC X(31).
  6349         16  AT-DENIAL-PROOF-DT          PIC XX.
  6350         16  FILLER                      PIC X(29).
  6351         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6352         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6353
  6354     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6355         16  AT-OLD-INCURRED-DT          PIC XX.
  6356         16  AT-OLD-REPORTED-DT          PIC XX.
  6357         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6358         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6359         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6360         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6361         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6362         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6363         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL156.cbl
  6364         16  AT-OLD-DIAG-CODE            PIC X(6).
  6365         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6366         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6367         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6368         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6369         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6370         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6371         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6372         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6373         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6374         16  FILLER                      PIC X(9).
  6375         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6376
  6377     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6378         16  AT-FORM-SEND-ON-DT          PIC XX.
  6379         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6380         16  AT-FORM-RE-SEND-DT          PIC XX.
  6381         16  AT-FORM-ANSWERED-DT         PIC XX.
  6382         16  AT-FORM-PRINTED-DT          PIC XX.
  6383         16  AT-FORM-REPRINT-DT          PIC XX.
  6384         16  AT-FORM-TYPE                PIC X.
  6385             88  INITIAL-FORM                  VALUE '1'.
  6386             88  PROGRESS-FORM                 VALUE '2'.
  6387         16  AT-INSTRUCT-LN-1            PIC X(28).
  6388         16  AT-INSTRUCT-LN-2            PIC X(28).
  6389         16  AT-INSTRUCT-LN-3            PIC X(28).
  6390         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6391         16  AT-FORM-ADDRESS             PIC X.
  6392             88  FORM-TO-INSURED              VALUE 'I'.
  6393             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6394             88  FORM-TO-OTHER-1              VALUE 'O'.
  6395             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6396         16  AT-RELATED-1.
  6397             20 AT-REL-CARR-1            PIC X.
  6398             20 AT-REL-CLAIM-1           PIC X(7).
  6399             20 AT-REL-CERT-1            PIC X(11).
  6400         16  AT-RELATED-2.
  6401             20 AT-REL-CARR-2            PIC X.
  6402             20 AT-REL-CLAIM-2           PIC X(7).
  6403             20 AT-REL-CERT-2            PIC X(11).
  6404         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6405         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6406         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6407         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6408         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6409         16  AT-STOP-FORM-DT             PIC X(2).
  6410
  6411         16  FILLER                      PIC X(09).
  6412         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6413         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6414******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL156.cbl
  6416*    COPY ELCACTQ.
  6417******************************************************************
  6418*                                                                *
  6419*                            ELCACTQ.                            *
  6420*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6421*                            VMOD=2.004                          *
  6422*                                                                *
  6423*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6424*                                                                *
  6425*   FILE TYPE = VSAM,KSDS                                        *
  6426*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6427*                                                                *
  6428*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6429*       ALTERNATE INDEX = NONE                                   *
  6430*                                                                *
  6431*   LOG = YES                                                    *
  6432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6433*                                                                *
  6434*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6435******************************************************************
  6436
  6437 01  ACTIVITY-QUE.
  6438     12  AQ-RECORD-ID                PIC XX.
  6439         88  VALID-AQ-ID                VALUE 'AQ'.
  6440
  6441     12  AQ-CONTROL-PRIMARY.
  6442         16  AQ-COMPANY-CD           PIC X.
  6443         16  AQ-CARRIER              PIC X.
  6444         16  AQ-CLAIM-NO             PIC X(7).
  6445         16  AQ-CERT-NO.
  6446             20  AQ-CERT-PRIME       PIC X(10).
  6447             20  AQ-CERT-SFX         PIC X.
  6448
  6449     12  AQ-PENDING-ACTIVITY-FLAGS.
  6450         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6451         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6452             88  PENDING-PAYMENTS       VALUE '1'.
  6453         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6454             88  PENDING-FULL-PRINT     VALUE '1'.
  6455             88  PENDING-PART-PRINT     VALUE '2'.
  6456         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6457             88  PENDING-LETTERS        VALUE '1'.
  6458         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6459             88  PENDING-RESTORE        VALUE 'C'.
  6460             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6461
  6462     12  FILLER                      PIC X(20).
  6463
  6464     12  AQ-RESEND-DATE              PIC XX.
  6465     12  AQ-FOLLOWUP-DATE            PIC XX.
  6466     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6467     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6468     12  AQ-AUTO-LETTER              PIC X(4).
  6469     12  FILLER                      PIC XX.
  6470     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6471*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL156.cbl
  6473*    COPY ERCACCT.
  6474******************************************************************
  6475*                                                                *
  6476*                                                                *
  6477*                            ERCACCT                             *
  6478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6479*                            VMOD=2.031                          *
  6480*                                                                *
  6481*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6482*                                                                *
  6483*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6484*   VSAM ACCOUNT MASTER FILES.                                   *
  6485*                                                                *
  6486*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6487*                                                                *
  6488*   FILE TYPE = VSAM,KSDS                                        *
  6489*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6490*                                                                *
  6491*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6492*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6493*                                                                *
  6494*   LOG = NO                                                     *
  6495*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6496*                                                                *
  6497*                                                                *
  6498******************************************************************
  6499*                   C H A N G E   L O G
  6500*
  6501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6502*-----------------------------------------------------------------
  6503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6504* EFFECTIVE    NUMBER
  6505*-----------------------------------------------------------------
  6506* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6507* 092705    2005050300006  PEMA  ADD SPP LEASES
  6508* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6509* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6510* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6511* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6512* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6513******************************************************************
  6514
  6515 01  ACCOUNT-MASTER.
  6516     12  AM-RECORD-ID                      PIC XX.
  6517         88  VALID-AM-ID                      VALUE 'AM'.
  6518
  6519     12  AM-CONTROL-PRIMARY.
  6520         16  AM-COMPANY-CD                 PIC X.
  6521         16  AM-MSTR-CNTRL.
  6522             20  AM-CONTROL-A.
  6523                 24  AM-CARRIER            PIC X.
  6524                 24  AM-GROUPING.
  6525                     28 AM-GROUPING-PREFIX PIC XXX.
  6526                     28 AM-GROUPING-PRIME  PIC XXX.
  6527                 24  AM-STATE              PIC XX.
  6528                 24  AM-ACCOUNT.
  6529                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6530                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL156.cbl
  6531             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6532                                           PIC X(19).
  6533             20  AM-CNTRL-B.
  6534                 24  AM-EXPIRATION-DT      PIC XX.
  6535                 24  FILLER                PIC X(4).
  6536             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6537                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6538
  6539     12  AM-CONTROL-BY-VAR-GRP.
  6540         16  AM-COMPANY-CD-A1              PIC X.
  6541         16  AM-VG-CARRIER                 PIC X.
  6542         16  AM-VG-GROUPING                PIC X(6).
  6543         16  AM-VG-STATE                   PIC XX.
  6544         16  AM-VG-ACCOUNT                 PIC X(10).
  6545         16  AM-VG-DATE.
  6546             20  AM-VG-EXPIRATION-DT       PIC XX.
  6547             20  FILLER                    PIC X(4).
  6548         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6549                                           PIC 9(11)      COMP-3.
  6550     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6551         16  FILLER                        PIC X(10).
  6552         16  AM-VG-KEY3.
  6553             20  AM-VG3-ACCOUNT            PIC X(10).
  6554             20  AM-VG3-EXP-DT             PIC XX.
  6555         16  FILLER                        PIC X(4).
  6556     12  AM-MAINT-INFORMATION.
  6557         16  AM-LAST-MAINT-DT              PIC XX.
  6558         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6559         16  AM-LAST-MAINT-USER            PIC X(4).
  6560         16  FILLER                        PIC XX.
  6561
  6562     12  AM-EFFECTIVE-DT                   PIC XX.
  6563     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6564
  6565     12  AM-PREV-DATES  COMP-3.
  6566         16  AM-PREV-EXP-DT                PIC 9(11).
  6567         16  AM-PREV-EFF-DT                PIC 9(11).
  6568
  6569     12  AM-REPORT-CODE-1                  PIC X(10).
  6570     12  AM-REPORT-CODE-2                  PIC X(10).
  6571
  6572     12  AM-CITY-CODE                      PIC X(4).
  6573     12  AM-COUNTY-PARISH                  PIC X(6).
  6574
  6575     12  AM-NAME                           PIC X(30).
  6576     12  AM-PERSON                         PIC X(30).
  6577     12  AM-ADDRS                          PIC X(30).
  6578     12  AM-CITY.
  6579         16  AM-ADDR-CITY                  PIC X(28).
  6580         16  AM-ADDR-STATE                 PIC XX.
  6581     12  AM-ZIP.
  6582         16  AM-ZIP-PRIME.
  6583             20  AM-ZIP-PRI-1ST            PIC X.
  6584                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6585             20  FILLER                    PIC X(4).
  6586         16  AM-ZIP-PLUS4                  PIC X(4).
  6587     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6588         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL156.cbl
  6589         16  AM-CAN-POSTAL-2               PIC XXX.
  6590         16  FILLER                        PIC XXX.
  6591     12  AM-TEL-NO.
  6592         16  AM-AREA-CODE                  PIC 999.
  6593         16  AM-TEL-PRE                    PIC 999.
  6594         16  AM-TEL-NBR                    PIC 9(4).
  6595     12  AM-TEL-LOC                        PIC X.
  6596         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6597         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6598
  6599     12  AM-COMM-STRUCTURE.
  6600         16  AM-DEFN-1.
  6601             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6602                 24  AM-AGT.
  6603                     28  AM-AGT-PREFIX     PIC X(4).
  6604                     28  AM-AGT-PRIME      PIC X(6).
  6605                 24  AM-COM-TYP            PIC X.
  6606                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6607                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6608                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6609                 24  AM-RECALC-LV-INDIC    PIC X.
  6610                 24  AM-RETRO-LV-INDIC     PIC X.
  6611                 24  AM-GL-CODES           PIC X.
  6612                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6613                 24  FILLER                PIC X(01).
  6614         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6615             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6616                 24  FILLER                PIC X(11).
  6617                 24  AM-L-COMA             PIC XXX.
  6618                 24  AM-J-COMA             PIC XXX.
  6619                 24  AM-A-COMA             PIC XXX.
  6620                 24  FILLER                PIC X(6).
  6621
  6622     12  AM-COMM-CHANGE-STATUS             PIC X.
  6623         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6624
  6625     12  AM-CSR-CODE                       PIC X(4).
  6626
  6627     12  AM-BILLING-STATUS                 PIC X.
  6628         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6629         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6630     12  AM-AUTO-REFUND-SW                 PIC X.
  6631         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6632         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6633     12  AM-GPCD                           PIC 99.
  6634     12  AM-IG                             PIC X.
  6635         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6636         88  AM-HAS-GROUP                     VALUE '2'.
  6637     12  AM-STATUS                         PIC X.
  6638         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6639         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6640         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6641         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6642         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6643         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6644     12  AM-REMIT-TO                       PIC 99.
  6645     12  AM-ID-NO                          PIC X(11).
  6646
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL156.cbl
  6647     12  AM-CAL-TABLE                      PIC XX.
  6648     12  AM-LF-DEVIATION                   PIC XXX.
  6649     12  AM-AH-DEVIATION                   PIC XXX.
  6650     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6651     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6652     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6653     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6654     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6655     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6656
  6657     12  AM-USER-FIELDS.
  6658         16  AM-FLD-1                      PIC XX.
  6659         16  AM-FLD-2                      PIC XX.
  6660         16  AM-FLD-3                      PIC XX.
  6661         16  AM-FLD-4                      PIC XX.
  6662         16  AM-FLD-5                      PIC XX.
  6663
  6664     12  AM-1ST-PROD-DATE.
  6665         16  AM-1ST-PROD-YR                PIC XX.
  6666         16  AM-1ST-PROD-MO                PIC XX.
  6667         16  AM-1ST-PROD-DA                PIC XX.
  6668     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6669     12  AM-CERTS-PURGED-DATE.
  6670         16  AM-PUR-YR                     PIC XX.
  6671         16  AM-PUR-MO                     PIC XX.
  6672         16  AM-PUR-DA                     PIC XX.
  6673     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6674     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6675     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6676     12  AM-INACTIVE-DATE.
  6677         16  AM-INA-MO                     PIC 99.
  6678         16  AM-INA-DA                     PIC 99.
  6679         16  AM-INA-YR                     PIC 99.
  6680     12  AM-AR-HI-CERT-DATE                PIC XX.
  6681
  6682     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6683     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6684
  6685     12  AM-OB-PAYMENT-MODE                PIC X.
  6686         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6687         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6688         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6689         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6690
  6691     12  AM-AH-ONLY-INDICATOR              PIC X.
  6692         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6693         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6694
  6695     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6696
  6697     12  AM-OVER-SHORT.
  6698         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6699         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6700
  6701     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6702     12  AM-DCC-CLP-STATE                  PIC XX.
  6703
  6704     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL156.cbl
  6705     12  AM-RECALC-REIN                    PIC X.
  6706
  6707     12  AM-REI-TABLE                      PIC XXX.
  6708     12  AM-REI-ET-LF                      PIC X.
  6709     12  AM-REI-ET-AH                      PIC X.
  6710     12  AM-REI-PE-LF                      PIC X.
  6711     12  AM-REI-PE-AH                      PIC X.
  6712     12  AM-REI-PRT-ST                     PIC X.
  6713     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6714     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6715     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6716     12  AM-REI-GROUP-A                    PIC X(6).
  6717     12  AM-REI-MORT                       PIC X(4).
  6718     12  AM-REI-PRT-OW                     PIC X.
  6719     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6720     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6721     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6722     12  AM-REI-GROUP-B                    PIC X(6).
  6723
  6724     12  AM-TRUST-TYPE                     PIC X(2).
  6725
  6726     12  AM-EMPLOYER-STMT-USED             PIC X.
  6727     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6728
  6729     12  AM-STD-AH-TYPE                    PIC XX.
  6730     12  AM-EARN-METHODS.
  6731         16  AM-EARN-METHOD-R              PIC X.
  6732             88 AM-REF-RL-R78                 VALUE 'R'.
  6733             88 AM-REF-RL-PR                  VALUE 'P'.
  6734             88 AM-REF-RL-MEAN                VALUE 'M'.
  6735             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6736         16  AM-EARN-METHOD-L              PIC X.
  6737             88 AM-REF-LL-R78                 VALUE 'R'.
  6738             88 AM-REF-LL-PR                  VALUE 'P'.
  6739             88 AM-REF-LL-MEAN                VALUE 'M'.
  6740             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6741         16  AM-EARN-METHOD-A              PIC X.
  6742             88 AM-REF-AH-R78                 VALUE 'R'.
  6743             88 AM-REF-AH-PR                  VALUE 'P'.
  6744             88 AM-REF-AH-MEAN                VALUE 'M'.
  6745             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6746             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6747             88 AM-REF-AH-NET                 VALUE 'N'.
  6748
  6749     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6750     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6751     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6752
  6753     12  AM-RET-Y-N                        PIC X.
  6754     12  AM-RET-P-E                        PIC X.
  6755     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6756     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6757     12  AM-RET-GRP                        PIC X(6).
  6758     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6759         16  AM-POOL-PRIME                 PIC XXX.
  6760         16  AM-POOL-SUB                   PIC XXX.
  6761     12  AM-RETRO-EARNINGS.
  6762         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL156.cbl
  6763         16  AM-RET-EARN-L                 PIC X.
  6764         16  AM-RET-EARN-A                 PIC X.
  6765     12  AM-RET-ST-TAX-USE                 PIC X.
  6766         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6767         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6768     12  AM-RETRO-BEG-EARNINGS.
  6769         16  AM-RET-BEG-EARN-R             PIC X.
  6770         16  AM-RET-BEG-EARN-L             PIC X.
  6771         16  AM-RET-BEG-EARN-A             PIC X.
  6772     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6773     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6774
  6775     12  AM-USER-SELECT-OPTIONS.
  6776         16  AM-USER-SELECT-1              PIC X(10).
  6777         16  AM-USER-SELECT-2              PIC X(10).
  6778         16  AM-USER-SELECT-3              PIC X(10).
  6779         16  AM-USER-SELECT-4              PIC X(10).
  6780         16  AM-USER-SELECT-5              PIC X(10).
  6781
  6782     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6783
  6784     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6785
  6786     12  AM-RPT045A-SWITCH                 PIC X.
  6787         88  RPT045A-OFF                   VALUE 'N'.
  6788
  6789     12  AM-INSURANCE-LIMITS.
  6790         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6791         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6792
  6793     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6794         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6795
  6796     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6797         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6798         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6799
  6800     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6801
  6802     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6803     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6804     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6805     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6806     12  AM-DCC-UEF-STATE                  PIC XX.
  6807     12  FILLER                            PIC XXX.
  6808     12  AM-REPORT-CODE-3                  PIC X(10).
  6809*    12  FILLER                            PIC X(22).
  6810
  6811     12  AM-RESERVE-DATE.
  6812         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6813         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6814         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6815
  6816     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6817     12  AM-NOTIFICATION-TYPES.
  6818         16  AM-NOTIF-OF-LETTERS           PIC X.
  6819         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6820         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL156.cbl
  6821         16  AM-NOTIF-OF-STATUS            PIC X.
  6822
  6823     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6824         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6825         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6826         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6827         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6828
  6829     12  AM-BENEFIT-CONTROLS.
  6830         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6831             20  AM-BENEFIT-CODE           PIC XX.
  6832             20  AM-BENEFIT-TYPE           PIC X.
  6833             20  AM-BENEFIT-REVISION       PIC XXX.
  6834             20  AM-BENEFIT-REM-TERM       PIC X.
  6835             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6836             20  FILLER                    PIC XX.
  6837         16  FILLER                        PIC X(80).
  6838
  6839     12  AM-TRANSFER-DATA.
  6840         16  AM-TRANSFERRED-FROM.
  6841             20  AM-TRNFROM-CARRIER        PIC X.
  6842             20  AM-TRNFROM-GROUPING.
  6843                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6844                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6845             20  AM-TRNFROM-STATE          PIC XX.
  6846             20  AM-TRNFROM-ACCOUNT.
  6847                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6848                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6849             20  AM-TRNFROM-DTE            PIC XX.
  6850         16  AM-TRANSFERRED-TO.
  6851             20  AM-TRNTO-CARRIER          PIC X.
  6852             20  AM-TRNTO-GROUPING.
  6853                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6854                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6855             20  AM-TRNTO-STATE            PIC XX.
  6856             20  AM-TRNTO-ACCOUNT.
  6857                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6858                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6859             20  AM-TRNTO-DTE              PIC XX.
  6860         16  FILLER                        PIC X(10).
  6861
  6862     12  AM-SAVED-REMIT-TO                 PIC 99.
  6863
  6864     12  AM-COMM-STRUCTURE-SAVED.
  6865         16  AM-DEFN-1-SAVED.
  6866             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6867                 24  AM-AGT-SV             PIC X(10).
  6868                 24  AM-COM-TYP-SV         PIC X.
  6869                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6870                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6871                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6872                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6873                 24  FILLER                PIC X.
  6874                 24  AM-GL-CODES-SV        PIC X.
  6875                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6876                 24  FILLER                PIC X.
  6877         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6878             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL156.cbl
  6879                 24  FILLER                PIC X(11).
  6880                 24  AM-L-COMA-SV          PIC XXX.
  6881                 24  AM-J-COMA-SV          PIC XXX.
  6882                 24  AM-A-COMA-SV          PIC XXX.
  6883                 24  FILLER                PIC X(6).
  6884
  6885     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6886         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6887            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6888            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6889            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6890
  6891     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6892     12  FILLER                            PIC X(120).
  6893
  6894     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6895         16  AM-CONTROL-NAME               PIC X(30).
  6896         16  AM-EXECUTIVE-ONE.
  6897             20  AM-EXEC1-NAME             PIC X(15).
  6898             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6899                                                          COMP-3.
  6900             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6901                                                          COMP-3.
  6902         16  AM-EXECUTIVE-TWO.
  6903             20  AM-EXEC2-NAME             PIC X(15).
  6904             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6905                                                          COMP-3.
  6906             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6907                                                          COMP-3.
  6908
  6909     12  AM-RETRO-ADDITIONAL-DATA.
  6910         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6911         16  AM-RETRO-PREM-P-E             PIC X.
  6912         16  AM-RETRO-CLMS-P-I             PIC X.
  6913         16  AM-RETRO-RET-BRACKET-LF.
  6914             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6915                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6916                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6917             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6918                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6919                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6920             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6921                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6922                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6923         16  AM-RETRO-RET-BRACKET-AH.
  6924             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6925                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6926                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6927                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6928             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6929                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6930                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6931             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6932                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6933                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6934
  6935     12  AM-COMMENTS.
  6936         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL156.cbl
  6937
  6938     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6939         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6940         16  AM-FLI-BILLING-CODE           PIC X.
  6941         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6942         16  AM-FLI-UNITED-IDENT           PIC X.
  6943         16  AM-FLI-INTEREST-LOST-DATA.
  6944             20  AM-FLI-BANK-NO            PIC X(5).
  6945             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6946             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6947             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6948         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6949             20  AM-FLI-AGT                PIC X(9).
  6950             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6951             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6952         16  FILLER                        PIC X(102).
  6953
  6954     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6955         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6956             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6957             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6958             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6959             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6960             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6961         16  FILLER                          PIC X(10).
  6962******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL156.cbl
  6964*    COPY ELCCHKQ.
  6965******************************************************************
  6966*                                                                *
  6967*                                                                *
  6968*                            ELCCHKQ.                            *
  6969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6970*                            VMOD=2.007                          *
  6971*                                                                *
  6972*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6973*                                                                *
  6974*   FILE TYPE = VSAM,KSDS                                        *
  6975*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6976*                                                                *
  6977*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6978*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6979*                                                                *
  6980*   LOG = YES                                                    *
  6981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6982******************************************************************
  6983 01  CHECK-QUE.
  6984     12  CQ-RECORD-ID                PIC XX.
  6985         88  VALID-CQ-ID         VALUE 'CQ'.
  6986
  6987     12  CQ-CONTROL-PRIMARY.
  6988         16  CQ-COMPANY-CD           PIC X.
  6989         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6990         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6991
  6992     12  CQ-CONTROL-BY-PAYEE.
  6993         16  CQ-CONTROL-BY-NUMBER.
  6994             20  CQ-COMPANY-CD-A1     PIC X.
  6995             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6996         16  CQ-PAYEE-CARRIER        PIC X.
  6997         16  CQ-PAYEE-GROUPING       PIC X(6).
  6998         16  CQ-PAYEE-STATE          PIC XX.
  6999         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7000         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7001
  7002     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7003         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7004         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7005         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7006         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7007         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7008         16  FILLER                  PIC X(3).
  7009
  7010     12  CQ-ENTRY-TYPE               PIC X.
  7011             88  CHECK-ON-QUE           VALUE 'Q'.
  7012             88  ALIGNMENT-CHECK        VALUE 'A'.
  7013             88  SPOILED-CHECK          VALUE 'S'.
  7014             88  PAYMENT-ABORTED        VALUE 'X'.
  7015
  7016     12  CQ-CLAIM-MAST-CNTL.
  7017         16  CQ-CARRIER              PIC X.
  7018         16  CQ-CLAIM-NO             PIC X(7).
  7019         16  CQ-CERT-NO.
  7020             20  CQ-CERT-PRIME       PIC X(10).
  7021             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL156.cbl
  7022         16  CQ-CLAIM-TYPE           PIC X.
  7023             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7024             88  CQ-AH-CLAIM            VALUE 'A'.
  7025         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7026             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7027             88  CQ-O-B-COVERAGE        VALUE '2'.
  7028             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7029
  7030     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7031     12  CQ-CHECK-NUMBER             PIC X(7).
  7032     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7033     12  CQ-PAYMENT-TYPE             PIC X.
  7034             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7035             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7036             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7037             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7038             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7039             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7040             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7041             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7042     12  CQ-VOID-INDICATOR           PIC X.
  7043             88  CHECK-IS-STOPPED          VALUE 'S'.
  7044             88  CHECK-IS-VOID             VALUE 'V'.
  7045     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7046     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7047     12  CQ-CHECK-BY-USER            PIC X(4).
  7048     12  CQ-PRE-NUMBERING-SW         PIC X.
  7049       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7050       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7051
  7052     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7053     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7054     12  CQ-LEDGER-FLAG              PIC X(01).
  7055     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7056     12  CQ-LAST-UPDATED-DT          PIC XX.
  7057     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7058     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7059
  7060     12  FILLER                      PIC X(04).
  7061
  7062******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL156.cbl
  7064*    COPY ELCBENE.
  7065******************************************************************
  7066*                                                                *
  7067*                            ELCBENE.                            *
  7068*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7069*                            VMOD=2.006                          *
  7070*                                                                *
  7071*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7072*                                                                *
  7073*   FILE TYPE = VSAM,KSDS                                        *
  7074*   RECORD SIZE = 500   RECFORM = FIX                            *
  7075*                                                                *
  7076*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7077*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7078*                                                                *
  7079*   LOG = YES                                                    *
  7080*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7081*                                                                *
  7082*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7083******************************************************************
  7084
  7085 01  BENEFICIARY-MASTER.
  7086     12  BE-RECORD-ID                PIC XX.
  7087         88  VALID-BE-ID                VALUE 'BE'.
  7088
  7089     12  BE-CONTROL-PRIMARY.
  7090         16  BE-COMPANY-CD           PIC X.
  7091         16  BE-RECORD-TYPE          PIC X.
  7092             88  BENEFICIARY-RECORD  VALUE 'B'.
  7093             88  ADJUSTOR-RECORD     VALUE 'A'.
  7094         16  BE-BENEFICIARY          PIC X(10).
  7095     12  BE-CONTROL-BY-NAME.
  7096         16  BE-COMPANY-CD-A1        PIC X.
  7097         16  BE-RECORD-TYPE-A1       PIC X.
  7098         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7099         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7100
  7101     12  BE-LAST-MAINT-DT            PIC XX.
  7102     12  BE-LAST-MAINT-BY            PIC X(4).
  7103     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7104
  7105     12  BE-ADDRESS-DATA.
  7106         16  BE-MAIL-TO-NAME         PIC X(30).
  7107         16  BE-ADDRESS-LINE-1       PIC X(30).
  7108         16  BE-ADDRESS-LINE-2       PIC X(30).
  7109         16  BE-ADDRESS-LINE-3       PIC X(30).
  7110         16  BE-CITY-STATE.
  7111             20  BE-CITY             PIC X(28).
  7112             20  BE-STATE            PIC XX.
  7113         16  BE-ZIP-CODE.
  7114             20  BE-ZIP-PRIME.
  7115                 24  BE-ZIP-1ST      PIC X.
  7116                     88  BE-CANADIAN-POST-CODE
  7117                                         VALUE 'A' THRU 'Z'.
  7118                 24  FILLER          PIC X(4).
  7119             20  BE-ZIP-PLUS4        PIC X(4).
  7120         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7121             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL156.cbl
  7122             20  BE-CAN-POSTAL-2     PIC XXX.
  7123             20  FILLER              PIC XXX.
  7124         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7125         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7126
  7127******************************************************************
  7128*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7129*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7130******************************************************************
  7131     12  BE-CARRIER                  PIC X.
  7132
  7133     12  BE-ADDRESS-DATA2.
  7134         16  BE-MAIL-TO-NAME2        PIC X(30).
  7135         16  BE-ADDRESS-LINE-12      PIC X(30).
  7136         16  BE-ADDRESS-LINE-22      PIC X(30).
  7137         16  BE-ADDRESS-LINE-32      PIC X(30).
  7138         16  BE-CITY-STATE2.
  7139             20  BE-CITY2            PIC X(28).
  7140             20  BE-STATE2           PIC XX.
  7141         16  BE-ZIP-CODE2.
  7142             20  BE-ZIP-PRIME2.
  7143                 24  BE-ZIP-1ST2     PIC X.
  7144                     88  BE-CANADIAN-POST-CODE2
  7145                                         VALUE 'A' THRU 'Z'.
  7146                 24  FILLER          PIC X(4).
  7147             20  BE-ZIP-PLUS42       PIC X(4).
  7148         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7149             20  BE-CAN-POSTAL-12    PIC XXX.
  7150             20  BE-CAN-POSTAL-22    PIC XXX.
  7151             20  FILLER              PIC XXX.
  7152         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7153         16  BE-BILLING-STMT-DATA.
  7154             20  BE-BSR              PIC X.
  7155                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7156                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7157             20  BE-BSR-FROM         PIC X(30).
  7158             20  BE-BSR-DEPT         PIC X(30).
  7159             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7160             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7161             20  BE-OUTPUT-TYPE      PIC X.
  7162                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7163                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7164
  7165     12  FILLER                      PIC X(28).
  7166******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL156.cbl
  7168*    COPY ELCARCH.
  7169******************************************************************
  7170*                                                                *
  7171*                            ELCARCH.                            *
  7172*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7173*                            VMOD=2.007                          *
  7174*                                                                *
  7175*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7176*                                                                *
  7177*   FILE TYPE = VSAM,KSDS                                        *
  7178*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7179*                                                                *
  7180*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7181*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7182*                                                                *
  7183*   LOG = NO                                                     *
  7184*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7185*                                                                *
  7186*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7187******************************************************************
  7188 01  LETTER-ARCHIVE.
  7189     12  LA-RECORD-ID                PIC XX.
  7190         88  VALID-LA-ID                VALUE 'LA'.
  7191
  7192     12  LA-CONTROL-PRIMARY.
  7193         16  LA-COMPANY-CD           PIC X.
  7194         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7195         16  LA-RECORD-TYPE          PIC X.
  7196             88  LA-HEADER-DATA         VALUE '1'.
  7197             88  LA-ADDRESS-DATA        VALUE '2'.
  7198             88  LA-TEXT-DATA           VALUE '3'.
  7199             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7200         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7201
  7202     12  LA-CONTROL-BY-TYPE.
  7203         16  LA-COMPANY-CD-A1        PIC X.
  7204         16  LA-RECORD-TYPE-A1       PIC X.
  7205         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7206         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7207
  7208     12  LA-TEXT-RECORD.
  7209         16  LA-SKIP-CONTROL         PIC XX.
  7210             88  NO-LINES-SKIPPED       VALUE SPACES.
  7211             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7212         16  LA-TEXT-LINE            PIC X(70).
  7213
  7214     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7215         16  FILLER                  PIC XX.
  7216         16  LA-ADDRESS-LINE         PIC X(30).
  7217         16  FILLER                  PIC X(40).
  7218
  7219     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7220         16  FILLER                  PIC XX.
  7221         16  LA-CARRIER              PIC X.
  7222         16  LA-CLAIM-NO             PIC X(7).
  7223         16  LA-CERT-NO.
  7224             20  LA-CERT-PRIME       PIC X(10).
  7225             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL156.cbl
  7226         16  LA-NO-OF-COPIES         PIC S9.
  7227         16  LA-RESEND-DATE          PIC XX.
  7228         16  LA-PROCESSOR-CD         PIC X(4).
  7229         16  LA-CREATION-DT          PIC XX.
  7230         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7231         16  LA-RESEND-PRINT-DATE    PIC XX.
  7232         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7233         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7234*
  7235* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7236*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7237*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7238*   I        20  LA-DMD-RES-ST           PIC XX.
  7239*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7240*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7241*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7242*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7243*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7244*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7245*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7246*   I        20  LA-DMD-UND-CODE         PIC XX.
  7247*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7248*   V    16  FILLER                  PIC X(15).
  7249* -----
  7250*
  7251* REINSERTED  CSO  MODS
  7252*
  7253         16  FILLER.
  7254             20  FILLER                  PIC X(29).
  7255             20  LA-CSO-LETTER-STATUS    PIC X.
  7256                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7257                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7258                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7259             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7260             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7261*
  7262
  7263     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7264         16  FILLER                  PIC XX.
  7265         16  LA4-CARRIER             PIC X.
  7266         16  LA4-CLAIM-NO            PIC X(7).
  7267         16  LA4-CERT-NO.
  7268             20  LA4-CERT-PRIME      PIC X(10).
  7269             20  LA4-CERT-SFX        PIC X.
  7270         16  LA4-NO-OF-COPIES        PIC S9.
  7271         16  LA4-RESEND-DATE         PIC XX.
  7272         16  LA4-PROCESSOR-CD        PIC X(4).
  7273         16  LA4-CREATION-DT         PIC XX.
  7274         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7275         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7276         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7277         16  LA4-FORM-TYPE           PIC X.
  7278             88  LA4-INITIAL-FORM    VALUE '1'.
  7279             88  LA4-PROGRESS-FORM   VALUE '2'.
  7280         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7281         16  LA4-STATE               PIC X(02).
  7282         16  FILLER                  PIC X(31).
  7283******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL156.cbl
  7285*    COPY ELCDAR.
  7286******************************************************************
  7287*                                                                *
  7288*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7289*   FILE TYPE = VSAM,KSDS                                        *
  7290*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7291*   BASE CLUSTER = DLYACTV                                       *
  7292*   LOG = YES                                                    *
  7293*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7294*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7295*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7296*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7297*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7298*               BY PROGRAM "LGINFCE".                            *
  7299*                                                                *
  7300******************************************************************
  7301 01  DAILY-ACTIVITY-RECORD.
  7302     05  DA-KEY.
  7303         10  DA-COMP-CD          PIC X.
  7304         10  DA-CARRIER          PIC X.
  7305         10  DA-CLAIM-NO         PIC X(7).
  7306         10  DA-CERT-NO.
  7307             15  DA-CERT-PRIME   PIC X(10).
  7308             15  DA-CERT-SFX     PIC X.
  7309     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7310     05  DA-RECORD-TYPE          PIC X.
  7311     05  FILLER                  PIC X(2).
  7312******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL156.cbl
  7314*    COPY ERCCOMP.
  7315******************************************************************
  7316*                                                                *
  7317*                                                                *
  7318*                            ERCCOMP                             *
  7319*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7320*                            VMOD=2.019                          *
  7321*                                                                *
  7322*   ONLINE CREDIT SYSTEM                                         *
  7323*                                                                *
  7324*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7325*                                                                *
  7326*   FILE TYPE = VSAM,KSDS                                        *
  7327*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7328*                                                                *
  7329*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7330*       ALTERNATE PATH = NONE                                    *
  7331*                                                                *
  7332*   LOG = NO                                                     *
  7333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7334*                                                                *
  7335******************************************************************
  7336*                   C H A N G E   L O G
  7337*
  7338* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7339*-----------------------------------------------------------------
  7340*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7341* EFFECTIVE    NUMBER
  7342*-----------------------------------------------------------------
  7343* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7344* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7345* 092205    2005050300006  PEMA  ADD LEASE FEE
  7346* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7347* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7348* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7349* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7350* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7351* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7352******************************************************************
  7353
  7354 01  COMPENSATION-MASTER.
  7355     12  CO-RECORD-ID                          PIC XX.
  7356         88  VALID-CO-ID                          VALUE 'CO'.
  7357
  7358     12  CO-CONTROL-PRIMARY.
  7359         16  CO-COMPANY-CD                     PIC X.
  7360         16  CO-CONTROL.
  7361             20  CO-CTL-1.
  7362                 24  CO-CARR-GROUP.
  7363                     28  CO-CARRIER            PIC X.
  7364                     28  CO-GROUPING.
  7365                         32  CO-GROUP-PREFIX   PIC XXX.
  7366                         32  CO-GROUP-PRIME    PIC XXX.
  7367                 24  CO-RESP-NO.
  7368                     28  CO-RESP-PREFIX        PIC X(4).
  7369                     28  CO-RESP-PRIME         PIC X(6).
  7370             20  CO-CTL-2.
  7371                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL156.cbl
  7372                     28  CO-ACCT-PREFIX        PIC X(4).
  7373                     28  CO-ACCT-PRIME         PIC X(6).
  7374         16  CO-TYPE                           PIC X.
  7375             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7376             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7377             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7378
  7379     12  CO-MAINT-INFORMATION.
  7380         16  CO-LAST-MAINT-DT                  PIC XX.
  7381         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7382         16  CO-LAST-MAINT-USER                PIC X(4).
  7383     12  FILLER                                PIC XX.
  7384     12  CO-STMT-TYPE                          PIC XXX.
  7385     12  CO-COMP-TYPE                          PIC X.
  7386         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7387     12  CO-STMT-OWNER                         PIC X(4).
  7388     12  CO-BALANCE-CONTROL                    PIC X.
  7389         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7390         88  CO-NO-BALANCE                        VALUE 'N'.
  7391
  7392     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7393         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7394         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7395         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7396
  7397     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7398         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7399         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7400
  7401     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7402     12  CO-GA-DIRECT-DEP                      PIC X.
  7403     12  CO-FUTURE-SPACE                       PIC X.
  7404         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7405
  7406     12  CO-ACCT-NAME                          PIC X(30).
  7407     12  CO-MAIL-NAME                          PIC X(30).
  7408     12  CO-ADDR-1                             PIC X(30).
  7409     12  CO-ADDR-2                             PIC X(30).
  7410     12  CO-ADDR-3.
  7411         16  CO-ADDR-CITY                      PIC X(27).
  7412         16  CO-ADDR-STATE                     PIC XX.
  7413     12  CO-CSO-1099                           PIC X.
  7414     12  CO-ZIP.
  7415         16  CO-ZIP-PRIME.
  7416             20  CO-ZIP-PRI-1ST                PIC X.
  7417                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7418             20  FILLER                        PIC X(4).
  7419         16  CO-ZIP-PLUS4                      PIC X(4).
  7420     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7421         16  CO-CAN-POSTAL-1                   PIC XXX.
  7422         16  CO-CAN-POSTAL-2                   PIC XXX.
  7423         16  FILLER                            PIC XXX.
  7424     12  CO-SOC-SEC                            PIC X(13).
  7425     12  CO-TELEPHONE.
  7426         16  CO-AREA-CODE                      PIC XXX.
  7427         16  CO-PREFIX                         PIC XXX.
  7428         16  CO-PHONE                          PIC X(4).
  7429
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL156.cbl
  7430     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7431
  7432     12  CO-AR-BAL-LEVEL                       PIC X.
  7433         88  CO-AR-REF-LVL                        VALUE '1'.
  7434         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7435         88  CO-AR-BILL-LVL                       VALUE '2'.
  7436         88  CO-AR-AGT-LVL                        VALUE '3'.
  7437         88  CO-AR-FR-LVL                         VALUE '4'.
  7438
  7439     12  CO-AR-NORMAL-PRINT                    PIC X.
  7440         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7441         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7442
  7443     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7444
  7445     12  CO-AR-REPORTING                       PIC X.
  7446         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7447         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7448
  7449     12  CO-AR-PULL-CHECK                      PIC X.
  7450         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7451         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7452
  7453     12  CO-AR-BALANCE-PRINT                   PIC X.
  7454         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7455
  7456     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7457         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7458         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7459         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7460
  7461     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7462
  7463     12  CO-USER-CODE                          PIC X.
  7464     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7465
  7466******************************************************************
  7467*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7468*    THE LAST MONTH END RUN.
  7469******************************************************************
  7470
  7471     12  CO-LAST-ACTIVITY-DATE.
  7472         16  CO-ACT-YEAR                       PIC 99.
  7473         16  CO-ACT-MONTH                      PIC 99.
  7474         16  CO-ACT-DAY                        PIC 99.
  7475
  7476     12  CO-LAST-STMT-DT.
  7477         16  CO-LAST-STMT-YEAR                 PIC 99.
  7478         16  CO-LAST-STMT-MONTH                PIC 99.
  7479         16  CO-LAST-STMT-DAY                  PIC 99.
  7480
  7481     12  CO-MO-END-TOTALS.
  7482         16  CO-MONTHLY-TOTALS.
  7483             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7484             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7485             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7486             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7487             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL156.cbl
  7488
  7489         16  CO-AGING-TOTALS.
  7490             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7491             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7492             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7493             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7494
  7495         16  CO-YTD-TOTALS.
  7496             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7497             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7498
  7499         16  CO-OVER-UNDER-TOTALS.
  7500             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7501             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7502
  7503     12  CO-MISCELLANEOUS-TOTALS.
  7504         16  CO-FICA-TOTALS.
  7505             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7506             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7507
  7508         16  CO-CLAIM-TOTALS.
  7509             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7510             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7511
  7512******************************************************************
  7513*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7514*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7515******************************************************************
  7516
  7517     12  CO-CURRENT-TOTALS.
  7518         16  CO-CURRENT-LAST-STMT-DT.
  7519             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7520             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7521             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7522
  7523         16  CO-CURRENT-MONTHLY-TOTALS.
  7524             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7525             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7526             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7527             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7528             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7529
  7530         16  CO-CURRENT-AGING-TOTALS.
  7531             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7532             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7533             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7534             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7535
  7536         16  CO-CURRENT-YTD-TOTALS.
  7537             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7538             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7539
  7540     12  CO-PAID-COMM-TOTALS.
  7541         16  CO-YTD-PAID-COMMS.
  7542             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7543             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7544
  7545     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL156.cbl
  7546         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7547         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7548
  7549     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7550         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7551         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7552         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7553         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7554         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7555         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7556         88  CO-FINAL-LETTER                  VALUE 'F'.
  7557         88  CO-RECONCILING                   VALUE 'R'.
  7558         88  CO-PHONE-CALL                    VALUE 'P'.
  7559         88  CO-LEGAL                         VALUE 'L'.
  7560         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7561         88  CO-WRITE-OFF                     VALUE 'W'.
  7562         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7563
  7564     12  CO-CSR-CODE                       PIC X(4).
  7565
  7566     12  CO-GA-STATUS-INFO.
  7567         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7568         16  CO-GA-TERMINATION-DT          PIC XX.
  7569         16  CO-GA-STATUS-CODE             PIC X.
  7570             88  CO-GA-ACTIVE                 VALUE 'A'.
  7571             88  CO-GA-INACTIVE               VALUE 'I'.
  7572             88  CO-GA-PENDING                VALUE 'P'.
  7573         16  CO-GA-COMMENTS.
  7574             20  CO-GA-COMMENT-1           PIC X(40).
  7575             20  CO-GA-COMMENT-2           PIC X(40).
  7576             20  CO-GA-COMMENT-3           PIC X(40).
  7577             20  CO-GA-COMMENT-4           PIC X(40).
  7578
  7579     12  CO-RPTCD2                         PIC X(10).
  7580     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7581         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7582         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7583
  7584     12  CO-TYPE-AGENT                     PIC X(01).
  7585         88  CO-CORPORATION                   VALUE 'C'.
  7586         88  CO-PARTNERSHIP                   VALUE 'P'.
  7587         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7588         88  CO-TRUST                         VALUE 'T'.
  7589         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7590
  7591     12  CO-FAXNO.
  7592         16  CO-FAX-AREA-CODE                  PIC XXX.
  7593         16  CO-FAX-PREFIX                     PIC XXX.
  7594         16  CO-FAX-PHONE                      PIC X(4).
  7595
  7596     12  CO-BANK-INFORMATION.
  7597         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7598         16  CO-BANK-TRANSIT-NON REDEFINES
  7599             CO-BANK-TRANSIT-NO                PIC 9(8).
  7600
  7601         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7602     12  CO-MISC-DEDUCT-INFO REDEFINES
  7603                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL156.cbl
  7604         16  CO-MD-GL-ACCT                     PIC X(10).
  7605         16  CO-MD-DIV                         PIC XX.
  7606         16  CO-MD-CENTER                      PIC X(4).
  7607         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7608         16  CO-CREATE-AP-CHECK                PIC X.
  7609         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7610         16  FILLER                            PIC XXX.
  7611     12  CO-ACH-STATUS                         PIC X.
  7612         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7613         88  CO-ACH-PENDING                        VALUE 'P'.
  7614
  7615     12  CO-BILL-SW                            PIC X.
  7616     12  CO-CONTROL-NAME                       PIC X(30).
  7617     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7618     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7619     12  CO-CLP-STATE                          PIC XX.
  7620     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7621     12  CO-SPP-REFUND-EDIT                    PIC X.
  7622
  7623******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL156.cbl
  7625*    COPY ERCDMDNT.
  7626******************************************************************
  7627*                                                                *
  7628*                            ERCDMDNT                            *
  7629*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7630*                            VMOD=2.005                          *
  7631*                                                                *
  7632*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7633*                                                                *
  7634*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7635*                                                                *
  7636*        FILE TYPE= VSAM,KSDS                                    *
  7637*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7638*                                                                *
  7639*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7640*                                                                *
  7641*        LOG = YES                                               *
  7642*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7643*                                                                *
  7644******************************************************************
  7645
  7646 01  CERTIFICATE-NOTE.
  7647     12  CN-RECORD-ID                     PIC  XX.
  7648         88  VALID-CN-ID                      VALUE 'CN'.
  7649
  7650     12  CN-CONTROL-PRIMARY.
  7651         16  CN-COMPANY-CD                PIC X.
  7652         16  CN-CERT-KEY.
  7653             20  CN-CARRIER               PIC X.
  7654             20  CN-GROUPING.
  7655                 24  CN-GROUPING-PREFIX   PIC XXX.
  7656                 24  CN-GROUPING-PRIME    PIC XXX.
  7657             20  CN-STATE                 PIC XX.
  7658             20  CN-ACCOUNT.
  7659                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7660                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7661             20  CN-CERT-EFF-DT           PIC XX.
  7662             20  CN-CERT-NO.
  7663                 24  CN-CERT-PRIME        PIC X(10).
  7664                 24  CN-CERT-SFX          PIC X.
  7665
  7666     12  CN-BILLING-START-LINE-NO         PIC 99.
  7667     12  CN-BILLING-END-LINE-NO           PIC 99.
  7668
  7669     12  CN-LINES.
  7670         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7671
  7672     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7673         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7674         16  CN-CSI-GENERAL-DATA-AREA.
  7675             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7676
  7677         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7678             CN-CSI-GENERAL-DATA-AREA.
  7679             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7680             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7681             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7682             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL156.cbl
  7683             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7684             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7685             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7686             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7687             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7688             20  FILLER                       PIC XX.
  7689             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7690             20  FILLER                       PIC X(38).
  7691
  7692         16  CN-CSI-PRODUCT-DATA-AREA.
  7693             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7694
  7695         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7696             CN-CSI-PRODUCT-DATA-AREA.
  7697             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7698             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7699             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7700             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7701             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7702             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7703             20  FILLER                   PIC XX.
  7704             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7705             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7706             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7707             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7708             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7709             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7710             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7711             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7712             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7713             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7714             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7715             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7716             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7717             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7718             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7719             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7720             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7721             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7722             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7723             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7724             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7725             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7726             20  FILLER                   PIC X(25).
  7727
  7728         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7729             CN-CSI-CREDIT-CARD-DATA.
  7730             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7731             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7732             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7733             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7734             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7735             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7736             20  FILLER                   PIC XX.
  7737             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7738             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7739             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7740             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL156.cbl
  7741             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7742             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7743             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7744             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7745             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7746             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7747             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7748             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7749             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7750             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7751             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7752             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7753             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7754             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7755             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7756             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7757             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7758             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7759             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7760             20  FILLER                   PIC X(17).
  7761
  7762         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7763             CN-CSI-FAMILY-LEAVE-DATA.
  7764             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7765             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7766             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7767             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7768             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7769             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7770             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7771             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7772             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7773             20  CN-CSI-SL-INT-ON-PROCEEDS
  7774                                          PIC S9(5)V99  COMP-3.
  7775             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7776             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7777             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7778             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7779             20  CN-CSI-SL-POLICY-BENEFITS
  7780                                          PIC S9(5)V99  COMP-3.
  7781             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7782             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7783             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7784             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7785             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7786             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7787             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7788             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7789             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7790             20  CN-CSI-SL-STATE-NOT      PIC X.
  7791             20  FILLER                   PIC XX.
  7792
  7793         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7794             CN-CSI-SENIOR-LIFE-DATA.
  7795             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7796             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7797             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7798                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL156.cbl
  7799             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7800             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7801             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7802             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7803             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7804             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7805             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7806             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7807             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7808             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7809             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7810             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7811             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7812             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7813             20  CN-CSI-PP-REPAIR         PIC X.
  7814             20  CN-CSI-PP-REPLACE        PIC X.
  7815             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7816             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7817             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7818             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7819             20  FILLER                   PIC X(5).
  7820
  7821         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7822             CN-CSI-PURCH-PROP-DATA.
  7823             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7824             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7825             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7826             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7827             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7828             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7829             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7830             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7831             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7832             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7833             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7834             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7835             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7836             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7837             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7838             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7839             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7840             20  CN-CSI-EW-REPLACE        PIC X.
  7841             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7842             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7843             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7844             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7845             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7846             20  FILLER                   PIC X(4).
  7847
  7848     12  CN-LAST-MAINT-DT                 PIC XX.
  7849     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7850     12  CN-LAST-MAINT-USER               PIC X(4).
  7851     12  FILLER                           PIC X(6).
  7852
  7853******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL156.cbl
  7855*    COPY ERCCNOT.
  7856******************************************************************
  7857*                                                                *
  7858*                            ERCCNOT                             *
  7859*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7860*                            VMOD=2.003                          *
  7861*                                                                *
  7862*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7863*                                                                *
  7864*        FILE TYPE= VSAM,KSDS                                    *
  7865*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7866*                                                                *
  7867*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7868*                                                                *
  7869*        LOG = YES                                               *
  7870*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7871*                                                                *
  7872******************************************************************
  7873*                   C H A N G E   L O G
  7874*
  7875* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7876*-----------------------------------------------------------------
  7877*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7878* EFFECTIVE    NUMBER
  7879*-----------------------------------------------------------------
  7880* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7881******************************************************************
  7882
  7883 01  CERT-NOTE-FILE.
  7884     12  CZ-RECORD-ID                PIC  XX.
  7885         88  VALID-CZ-ID                  VALUE 'CZ'.
  7886
  7887     12  CZ-CONTROL-PRIMARY.
  7888         16  CZ-COMPANY-CD           PIC X.
  7889         16  CZ-CARRIER              PIC X.
  7890         16  CZ-GROUPING.
  7891             20 CZ-GROUPING-PREFIX   PIC XXX.
  7892             20 CZ-GROUPING-PRIME    PIC XXX.
  7893         16  CZ-STATE                PIC XX.
  7894         16  CZ-ACCOUNT.
  7895             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7896             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7897         16  CZ-CERT-EFF-DT          PIC XX.
  7898         16  CZ-CERT-NO.
  7899             20  CZ-CERT-PRIME       PIC X(10).
  7900             20  CZ-CERT-SFX         PIC X.
  7901         16  CZ-RECORD-TYPE          PIC X.
  7902             88  CERT-NOTE           VALUE '1'.
  7903             88  CLAIM-CERT-NOTE     VALUE '2'.
  7904         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7905
  7906     12  CZ-LAST-MAINT-DT            PIC XX.
  7907     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7908     12  CZ-LAST-MAINT-USER          PIC X(4).
  7909
  7910     12  CZ-NOTE-INFORMATION.
  7911         16  CZ-NOTE                 PIC X(63).
  7912         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL156.cbl
  7913******************************************************************
  7914*                            COPY ERCPDEF.
  7915******************************************************************
  7916*                                                                *
  7917*                                                                *
  7918*                            ERCPDEF.                            *
  7919*                                                                *
  7920*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7921*                                                                *
  7922*    FILE TYPE = VSAM,KSDS                                       *
  7923*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7924*                                                                *
  7925*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7926*                                                                *
  7927*    LOG = YES                                                   *
  7928*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7929******************************************************************
  7930*                   C H A N G E   L O G
  7931*
  7932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7933*-----------------------------------------------------------------
  7934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7935* EFFECTIVE    NUMBER
  7936*-----------------------------------------------------------------
  7937* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7938* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7939******************************************************************
  7940 01  PRODUCT-MASTER.
  7941    12  PD-RECORD-ID                 PIC X(02).
  7942        88  VALID-PD-ID                  VALUE 'PD'.
  7943    12  PD-CONTROL-PRIMARY.
  7944        16  PD-COMPANY-CD            PIC X.
  7945        16  PD-STATE                 PIC XX.
  7946        16  PD-PRODUCT-CD            PIC XXX.
  7947        16  PD-FILLER                PIC X(7).
  7948        16  PD-BEN-TYPE              PIC X.
  7949        16  PD-BEN-CODE              PIC XX.
  7950        16  PD-PROD-EXP-DT           PIC XX.
  7951    12  FILLER                       PIC X(50).
  7952    12  PD-PRODUCT-DATA OCCURS 8.
  7953        16  PD-PROD-CODE             PIC X.
  7954            88  PD-PROD-LIFE           VALUE 'L'.
  7955            88  PD-PROD-PROP           VALUE 'P'.
  7956            88  PD-PROD-AH             VALUE 'A'.
  7957            88  PD-PROD-IU             VALUE 'I'.
  7958            88  PD-PROD-GAP            VALUE 'G'.
  7959            88  PD-PROD-FAML           VALUE 'F'.
  7960        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7961        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7962        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7963        16  PD-MAX-TERM              PIC S999        COMP-3.
  7964        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7965        16  FILLER                   PIC X.
  7966        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7967        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7968        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7969        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7970        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL156.cbl
  7971        16  PD-REC-CRIT-PERIOD       PIC 99.
  7972        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7973            20  PD-RECURRING-YN      PIC X.
  7974            20  FILLER               PIC X.
  7975        16  PD-RTW-MOS               PIC 99.
  7976        16  PD-MAX-EXTENSION         PIC 99.
  7977        16  FILLER                   PIC XX.
  7978    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7979    12  PD-TERM-LIMITS OCCURS 15.
  7980        16  PD-LOW-TERM              PIC S999        COMP-3.
  7981        16  PD-HI-TERM               PIC S999        COMP-3.
  7982*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7983    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7984        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7985        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7986    12  PD-EARN-FACTORS.
  7987        16  FILLER OCCURS 15.
  7988            20  FILLER OCCURS 15.
  7989                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7990    12  PD-PRODUCT-DESC              PIC X(80).
  7991    12  PD-TRUNCATED                 PIC X.
  7992    12  FILLER                       PIC X(59).
  7993    12  PD-MAINT-INFORMATION.
  7994        16  PD-LAST-MAINT-DT         PIC X(02).
  7995        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7996        16  PD-LAST-MAINT-BY         PIC X(04).
  7997*                            COPY ELCCRTT.
  7998******************************************************************
  7999*                                                                *
  8000*                            ELCCRTT.                            *
  8001*                                                                *
  8002*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8003*                                                                *
  8004*   FILE TYPE = VSAM,KSDS                                        *
  8005*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8006*                                                                *
  8007*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8008*                                                                *
  8009*   LOG = YES                                                    *
  8010*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8011******************************************************************
  8012*                   C H A N G E   L O G
  8013*
  8014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8015*-----------------------------------------------------------------
  8016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8017* EFFECTIVE    NUMBER
  8018*-----------------------------------------------------------------
  8019* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8020* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8021* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8022* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8023* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8024* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8025* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8026******************************************************************
  8027
  8028 01  CERTIFICATE-TRAILERS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL156.cbl
  8029     12  CS-RECORD-ID                      PIC XX.
  8030         88  VALID-CS-ID                      VALUE 'CS'.
  8031
  8032     12  CS-CONTROL-PRIMARY.
  8033         16  CS-COMPANY-CD                 PIC X.
  8034         16  CS-CARRIER                    PIC X.
  8035         16  CS-GROUPING                   PIC X(6).
  8036         16  CS-STATE                      PIC XX.
  8037         16  CS-ACCOUNT                    PIC X(10).
  8038         16  CS-CERT-EFF-DT                PIC XX.
  8039         16  CS-CERT-NO.
  8040             20  CS-CERT-PRIME             PIC X(10).
  8041             20  CS-CERT-SFX               PIC X.
  8042         16  CS-TRAILER-TYPE               PIC X.
  8043             88  COMM-TRLR           VALUE 'A'.
  8044             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8045             88  CERT-DATA-TRLR      VALUE 'C'.
  8046
  8047     12  CS-DATA-AREA                      PIC X(516).
  8048
  8049     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8050         16  CS-BANK-COMMISSION-AREA.
  8051             20  CS-BANK-COMMS       OCCURS 10.
  8052                 24  CS-AGT                PIC X(10).
  8053                 24  CS-COM-TYP            PIC X.
  8054                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8055                 24  CS-RECALC-LV-INDIC    PIC X.
  8056                 24  FILLER                PIC X(10).
  8057         16  FILLER                        PIC X(256).
  8058
  8059     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8060****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8061         16  CS-MB-CLAIM-DATA OCCURS 24.
  8062             20  CS-CLAIM-NO               PIC X(7).
  8063             20  CS-CLAIM-TYPE             PIC X.
  8064                 88  CS-AH-CLM               VALUE 'A'.
  8065                 88  CS-IU-CLM               VALUE 'I'.
  8066                 88  CS-GP-CLM               VALUE 'G'.
  8067                 88  CS-LF-CLM               VALUE 'L'.
  8068                 88  CS-PR-CLM               VALUE 'P'.
  8069                 88  CS-FL-CLM               VALUE 'F'.
  8070             20  CS-INSURED-TYPE           PIC X.
  8071                 88  CS-PRIM-INSURED          VALUE 'P'.
  8072                 88  CS-CO-BORROWER           VALUE 'C'.
  8073             20  CS-BENEFIT-PERIOD         PIC 99.
  8074             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8075             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8076             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8077         16  FILLER                        PIC X(12).
  8078     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8079         16  CS-VIN-NUMBER                 PIC X(17).
  8080         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8081         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8082         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8083         16  FILLER                        PIC X(496).
  8084 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8085                          CONTROL-FILE CERTIFICATE-MASTER
  8086                          ACTIVITY-TRAILERS ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL156.cbl
  8087                          ACCOUNT-MASTER CHECK-QUE
  8088                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8089                          DAILY-ACTIVITY-RECORD
  8090                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8091                          CERT-NOTE-FILE PRODUCT-MASTER
  8092                          CERTIFICATE-TRAILERS.
  8093 0000-DFHEXIT SECTION.
  8094     MOVE '9#                    $   ' TO DFHEIV0.
  8095     MOVE 'EL156' TO DFHEIV1.
  8096     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8097
  8098     IF EIBCALEN = 0
  8099         GO TO 8800-UNAUTHORIZED-ACCESS.
  8100
  8101     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8102     MOVE EIBTRMID               TO QID-TERM.
  8103     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8104     MOVE '2'                    TO EMI-SWITCH2.
  8105     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8106     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8107
  8108     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8109     MOVE '5'                    TO DC-OPTION-CODE.
  8110     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8111     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8112                                    SAVE-BIN-DATE.
  8113     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8114     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8115
  8116     IF SAVE-DATE-YY > 70
  8117         MOVE 19                 TO SAVE-DATE-CC
  8118     ELSE
  8119         MOVE 20                 TO SAVE-DATE-CC.
  8120
  8121     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8122         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8123     END-IF.
  8124
  8125     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8126        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8127     ELSE
  8128        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8129     END-IF
  8130
  8131     IF PI-PRINT-CLM-FRM-YN = 'N'
  8132         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8133     ELSE
  8134         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8135     END-IF
  8136
  8137     IF PI-PRINT-SURVEY-YN = 'N'
  8138         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8139     ELSE
  8140         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8141     END-IF
  8142
  8143     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8144         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL156.cbl
  8145     ELSE
  8146         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8147     END-IF
  8148
  8149* EXEC CICS HANDLE CONDITION
  8150*        NOTOPEN   (9990-ABEND)
  8151*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8152*        MAPFAIL   (0400-FIRST-TIME)
  8153*        DUPREC    (6180-DUPREC)
  8154*        ERROR     (9990-ABEND)
  8155*    END-EXEC.
  8156*    MOVE '"$JL?%.               ! " #00008144' TO DFHEIV0
  8157     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8159     MOVE X'2220233030303038313434' TO DFHEIV0(25:11)
  8160     CALL 'kxdfhei1' USING DFHEIV0
  8161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8162
  8163
  8164     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8165         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8166
  8167     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8168         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8169             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8170             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8171             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8172             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8173             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8174             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8175             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8176             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8177             MOVE LOW-VALUES           TO EL156AI
  8178             MOVE 'Y'                  TO FIRST-ENTRY
  8179         ELSE
  8180             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8181             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8182             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8183             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8184             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8185             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8186             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8187             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8188
  8189     IF RETURNED-FROM NOT = SPACES
  8190        IF (RETURNED-FROM = 'EL614')
  8191           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8192           IF WS-SAVED-EOB-CODES NOT = SPACES
  8193              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8194           ELSE
  8195              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8196           END-IF
  8197        END-IF
  8198         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8199            MOVE 'Y'             TO FIRST-ENTRY
  8200            IF RETURNED-FROM = 'EL614'
  8201               AND (PI-PASS-SW NOT = 'C')
  8202               IF WS-SAVED-EOB-CODES NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL156.cbl
  8203                  MOVE WS-SAVED-EOB-CODES
  8204                                 TO PI-PMTNOTE2
  8205                                    WS-PMTNOTE2
  8206                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8207               ELSE
  8208                  MOVE SPACES    TO PI-PMTNOTE2
  8209                                    WS-PMTNOTE2
  8210                                    PI-EOB-CODES-EXIST
  8211               END-IF
  8212            END-IF
  8213            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8214            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8215            IF RETURNED-FROM = 'EL614'
  8216               GO TO 1000-EDIT-DATA
  8217            END-IF
  8218            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8219               (PAYEEI   = LOW-VALUES OR SPACES)
  8220               GO TO 8100-SEND-INITIAL-MAP
  8221            ELSE
  8222               GO TO 1000-EDIT-DATA.
  8223
  8224     IF EIBTRNID NOT = TRANS-ID
  8225         GO TO 0400-FIRST-TIME.
  8226
  8227     IF EIBAID = DFHCLEAR
  8228        IF PI-PASS-SW = 'C'
  8229           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8230           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8231           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8232           MOVE 'Y'            TO RETURNED-FROM-B
  8233           GO TO 1000-EDIT-DATA
  8234        ELSE
  8235           GO TO 9400-CLEAR.
  8236
  8237     IF PI-PASS-SW = 'C'
  8238         MOVE MAP-NAMEB          TO MAP-NAME
  8239         IF EIBAID = DFHPF1 OR DFHPF13
  8240             GO TO 5000-UPDATE
  8241           ELSE
  8242             IF EIBAID NOT = DFHENTER
  8243                 MOVE LOW-VALUES TO EL156BI
  8244                 MOVE MAP-NAMEB  TO MAP-NAME
  8245                 MOVE ER-0029    TO EMI-ERROR
  8246                 MOVE -1         TO  ENTPFBL
  8247                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8248                 GO TO 8200-SEND-DATAONLY.
  8249
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL156.cbl
  8251 0200-RECEIVE.
  8252     MOVE LOW-VALUES             TO EL156AI.
  8253     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8254         MOVE ER-0008            TO EMI-ERROR
  8255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8256         IF PI-PASS-SW = 'C'
  8257             MOVE -1             TO ENTPFBL
  8258             GO TO 8200-SEND-DATAONLY
  8259         ELSE
  8260             MOVE -1             TO PMTTYPEL
  8261             GO TO 8200-SEND-DATAONLY.
  8262
  8263     IF PI-COMPANY-ID = 'DMD'
  8264         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8265
  8266     IF PI-PASS-SW = 'C'
  8267         MOVE MAP-NAMEB          TO MAP-NAME.
  8268
  8269
  8270* EXEC CICS RECEIVE
  8271*        MAP   (MAP-NAME)
  8272*        MAPSET(MAPSET-NAME)
  8273*        ASIS
  8274*        INTO  (EL156AI)
  8275*    END-EXEC.
  8276     MOVE LENGTH OF
  8277      EL156AI
  8278       TO DFHEIV11
  8279*    MOVE '8"TAI  L              ''   #00008257' TO DFHEIV0
  8280     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8281     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8282     MOVE X'2020233030303038323537' TO DFHEIV0(25:11)
  8283     CALL 'kxdfhei1' USING DFHEIV0,
  8284           MAP-NAME,
  8285           EL156AI,
  8286           DFHEIV11,
  8287           MAPSET-NAME,
  8288           DFHEIV99,
  8289           DFHEIV99
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8291
  8292
  8293     IF PI-PASS-SW NOT = 'C'
  8294         GO TO 0250-MAPA.
  8295
  8296     IF ENTPFBL NOT > ZERO
  8297         MOVE MAP-NAMEB          TO MAP-NAME
  8298         MOVE ER-0029            TO EMI-ERROR
  8299         MOVE -1                 TO  ENTPFBL
  8300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8301         GO TO 8200-SEND-DATAONLY.
  8302
  8303     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8304         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8305       ELSE
  8306         MOVE MAP-NAMEB           TO MAP-NAME
  8307         MOVE ER-0029             TO EMI-ERROR
  8308         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL156.cbl
  8309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8310         GO TO 8200-SEND-DATAONLY.
  8311
  8312     IF EIBAID = DFHPF1 OR DFHPF13
  8313         IF MODIFY-CAP
  8314            GO TO 5000-UPDATE
  8315          ELSE
  8316            MOVE 'UPDATE'           TO SM-READ
  8317            PERFORM 9995-SECURITY-VIOLATION
  8318            MOVE MAP-NAMEB          TO MAP-NAME
  8319            MOVE ER-0070            TO EMI-ERROR
  8320            MOVE -1                 TO  ENTPFBL
  8321            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8322            GO TO 8200-SEND-DATAONLY.
  8323
  8324 0250-MAPA.
  8325     IF ENTERPFL = 0
  8326         GO TO 0300-CHECK-PFKEYS.
  8327
  8328     IF EIBAID NOT = DFHENTER
  8329         MOVE ER-0004            TO EMI-ERROR
  8330         GO TO 0320-INPUT-ERROR.
  8331
  8332     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8333         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8334     ELSE
  8335         MOVE ER-0029            TO EMI-ERROR
  8336         GO TO 0320-INPUT-ERROR.
  8337
  8338 0300-CHECK-PFKEYS.
  8339     IF EIBAID = DFHPF7 OR DFHPF8
  8340         GO TO 8820-PF7-8.
  8341
  8342     IF EIBAID = DFHPF23
  8343         GO TO 8810-PF23.
  8344
  8345     IF EIBAID = DFHPF24
  8346         GO TO 9200-RETURN-MAIN-MENU.
  8347
  8348     IF EIBAID = DFHPF12
  8349         GO TO 9500-PF12.
  8350
  8351     IF EIBAID = DFHPF1
  8352        IF PI-PASS-SW = 'A' OR 'B'
  8353          GO TO 0330-BROWSE-FORWARD.
  8354
  8355     IF EIBAID = DFHPF2
  8356        IF PI-PASS-SW = 'A' OR 'B'
  8357          GO TO 0350-BROWSE-BACKWARD.
  8358
  8359     IF EIBAID = DFHPF6
  8360        IF PI-EOB-CODES-EXIST = 'Y'
  8361           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8362        ELSE
  8363           MOVE SPACES              TO WS-PMTNOTE2
  8364        END-IF
  8365         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8366         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL156.cbl
  8367            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8368         END-IF
  8369         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8370         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8371             MOVE 'EL614'        TO PGM-NAME
  8372             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8373             GO TO 9300-XCTL
  8374         ELSE
  8375             MOVE XCTL-157       TO PGM-NAME
  8376             GO TO 9300-XCTL.
  8377
  8378     IF EIBAID = DFHPF9
  8379        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8380        MOVE XCTL-141            TO PGM-NAME
  8381        GO TO 9300-XCTL.
  8382
  8383     IF EIBAID = DFHPF10
  8384        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8385        MOVE XCTL-155            TO PGM-NAME
  8386        GO TO 9300-XCTL.
  8387
  8388     MOVE SPACES                 TO ERRMSG0O
  8389                                    ERRMSG1O
  8390                                    ERRMSG2O.
  8391
  8392     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8393         IF PI-PASS-SW NOT = 'B'
  8394             MOVE ER-0422        TO EMI-ERROR
  8395             GO TO 0320-INPUT-ERROR
  8396           ELSE
  8397             GO TO 0700-TEST-FOR-CHANGES.
  8398
  8399     IF EIBAID = DFHPF11
  8400        IF PI-PASS-SW = 'C'
  8401           MOVE ER-0029          TO EMI-ERROR
  8402           GO TO 0320-INPUT-ERROR.
  8403
  8404     IF EIBAID = DFHENTER OR DFHPF11
  8405        NEXT SENTENCE
  8406     ELSE
  8407        MOVE ER-0029             TO EMI-ERROR
  8408        GO TO 0320-INPUT-ERROR.
  8409
  8410     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8411
  8412     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8413         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8414         GO TO 1000-EDIT-DATA
  8415     ELSE
  8416         IF PI-FATAL-COUNT NOT = 0 OR
  8417            PI-FORCE-COUNT NOT = 0
  8418             GO TO 1000-EDIT-DATA
  8419         ELSE
  8420             GO TO 2000-EDIT-DONE.
  8421
  8422 0320-INPUT-ERROR.
  8423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8424
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL156.cbl
  8425     IF ENTERPFL = 0
  8426         MOVE -1                 TO PMTTYPEL
  8427     ELSE
  8428         MOVE AL-UNBON           TO ENTERPFA
  8429         MOVE -1                 TO ENTERPFL.
  8430
  8431     GO TO 8200-SEND-DATAONLY.
  8432
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL156.cbl
  8434 0330-BROWSE-FORWARD.
  8435
  8436     MOVE CLMNOI            TO PI-CLAIM-NO.
  8437     MOVE CARRI             TO PI-CARRIER.
  8438     MOVE CERTNOI           TO PI-CERT-PRIME.
  8439     MOVE SUFXI             TO PI-CERT-SFX.
  8440
  8441     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8442     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8443     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8444     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8445
  8446     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8447
  8448
  8449* EXEC CICS HANDLE CONDITION
  8450*         NOTFND   (0380-CLAIM-END-FILE)
  8451*         ENDFILE  (0380-CLAIM-END-FILE)
  8452*    END-EXEC.
  8453*    MOVE '"$I''                  ! # #00008419' TO DFHEIV0
  8454     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8456     MOVE X'2320233030303038343139' TO DFHEIV0(25:11)
  8457     CALL 'kxdfhei1' USING DFHEIV0
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8459
  8460
  8461
  8462* EXEC CICS STARTBR
  8463*         DATASET    ('ELMSTR')
  8464*         RIDFLD     (ELMSTR-KEY)
  8465*         GTEQ
  8466*    END-EXEC.
  8467     MOVE 'ELMSTR' TO DFHEIV1
  8468     MOVE 0
  8469       TO DFHEIV11
  8470*    MOVE '&,         G          &   #00008424' TO DFHEIV0
  8471     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8472     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8473     MOVE X'2020233030303038343234' TO DFHEIV0(25:11)
  8474     CALL 'kxdfhei1' USING DFHEIV0,
  8475           DFHEIV1,
  8476           ELMSTR-KEY,
  8477           DFHEIV99,
  8478           DFHEIV11,
  8479           DFHEIV99
  8480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8481
  8482
  8483     MOVE 'Y' TO WS-BROWSE-START-SW.
  8484
  8485 0335-READNEXT.
  8486
  8487
  8488* EXEC CICS READNEXT
  8489*         DATASET    ('ELMSTR')
  8490*         RIDFLD     (ELMSTR-KEY)
  8491*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL156.cbl
  8492*    END-EXEC.
  8493     MOVE 'ELMSTR' TO DFHEIV1
  8494     MOVE 0
  8495       TO DFHEIV11
  8496*    MOVE '&.S                   )   #00008434' TO DFHEIV0
  8497     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8498     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8499     MOVE X'2020233030303038343334' TO DFHEIV0(25:11)
  8500     CALL 'kxdfhei1' USING DFHEIV0,
  8501           DFHEIV1,
  8502           DFHEIV20,
  8503           DFHEIV99,
  8504           ELMSTR-KEY,
  8505           DFHEIV99,
  8506           DFHEIV11,
  8507           DFHEIV99,
  8508           DFHEIV99
  8509     SET ADDRESS OF CLAIM-MASTER TO
  8510         DFHEIV20
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8512
  8513
  8514     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8515        GO TO 0380-CLAIM-END-FILE.
  8516
  8517     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8518        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8519        GO TO 0335-READNEXT.
  8520
  8521     IF PI-COMPANY-ID = 'CRI'
  8522         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8523            GO TO 0380-CLAIM-END-FILE.
  8524
  8525     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8526         GO TO 0335-READNEXT.
  8527
  8528     IF PI-CARRIER-SECURITY > SPACES
  8529         IF CL-CARRIER = PI-CARRIER-SECURITY
  8530             NEXT SENTENCE
  8531         ELSE
  8532             GO TO 0335-READNEXT.
  8533
  8534     IF PI-ACCOUNT-SECURITY > SPACES
  8535         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8536             NEXT SENTENCE
  8537         ELSE
  8538             GO TO 0335-READNEXT.
  8539
  8540     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8541     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8542     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8543
  8544     GO TO 0400-FIRST-TIME.
  8545
  8546 0350-BROWSE-BACKWARD.
  8547
  8548     MOVE CLMNOI            TO PI-CLAIM-NO
  8549                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL156.cbl
  8550     MOVE CARRI             TO PI-CARRIER.
  8551     MOVE CERTNOI           TO PI-CERT-PRIME.
  8552     MOVE SUFXI             TO PI-CERT-SFX.
  8553
  8554     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8555
  8556     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8557     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8558     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8559
  8560
  8561* EXEC CICS HANDLE CONDITION
  8562*         NOTFND   (0380-CLAIM-END-FILE)
  8563*         ENDFILE  (0380-CLAIM-END-FILE)
  8564*    END-EXEC.
  8565*    MOVE '"$I''                  ! $ #00008486' TO DFHEIV0
  8566     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8568     MOVE X'2420233030303038343836' TO DFHEIV0(25:11)
  8569     CALL 'kxdfhei1' USING DFHEIV0
  8570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8571
  8572
  8573
  8574* EXEC CICS STARTBR
  8575*         DATASET    ('ELMSTR')
  8576*         RIDFLD     (ELMSTR-KEY)
  8577*         GTEQ
  8578*    END-EXEC.
  8579     MOVE 'ELMSTR' TO DFHEIV1
  8580     MOVE 0
  8581       TO DFHEIV11
  8582*    MOVE '&,         G          &   #00008491' TO DFHEIV0
  8583     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8584     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8585     MOVE X'2020233030303038343931' TO DFHEIV0(25:11)
  8586     CALL 'kxdfhei1' USING DFHEIV0,
  8587           DFHEIV1,
  8588           ELMSTR-KEY,
  8589           DFHEIV99,
  8590           DFHEIV11,
  8591           DFHEIV99
  8592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8593
  8594
  8595     MOVE 'Y' TO WS-BROWSE-START-SW.
  8596
  8597
  8598* EXEC CICS READNEXT
  8599*         DATASET    ('ELMSTR')
  8600*         RIDFLD     (ELMSTR-KEY)
  8601*         SET        (ADDRESS OF CLAIM-MASTER)
  8602*    END-EXEC.
  8603     MOVE 'ELMSTR' TO DFHEIV1
  8604     MOVE 0
  8605       TO DFHEIV11
  8606*    MOVE '&.S                   )   #00008499' TO DFHEIV0
  8607     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL156.cbl
  8608     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8609     MOVE X'2020233030303038343939' TO DFHEIV0(25:11)
  8610     CALL 'kxdfhei1' USING DFHEIV0,
  8611           DFHEIV1,
  8612           DFHEIV20,
  8613           DFHEIV99,
  8614           ELMSTR-KEY,
  8615           DFHEIV99,
  8616           DFHEIV11,
  8617           DFHEIV99,
  8618           DFHEIV99
  8619     SET ADDRESS OF CLAIM-MASTER TO
  8620         DFHEIV20
  8621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8622
  8623
  8624
  8625* EXEC CICS READPREV
  8626*         DATASET    ('ELMSTR')
  8627*         RIDFLD     (ELMSTR-KEY)
  8628*         SET        (ADDRESS OF CLAIM-MASTER)
  8629*    END-EXEC.
  8630     MOVE 'ELMSTR' TO DFHEIV1
  8631     MOVE 0
  8632       TO DFHEIV11
  8633*    MOVE '&0S                   )   #00008505' TO DFHEIV0
  8634     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8635     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8636     MOVE X'2020233030303038353035' TO DFHEIV0(25:11)
  8637     CALL 'kxdfhei1' USING DFHEIV0,
  8638           DFHEIV1,
  8639           DFHEIV20,
  8640           DFHEIV99,
  8641           ELMSTR-KEY,
  8642           DFHEIV99,
  8643           DFHEIV11,
  8644           DFHEIV99,
  8645           DFHEIV99
  8646     SET ADDRESS OF CLAIM-MASTER TO
  8647         DFHEIV20
  8648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8649
  8650
  8651 0360-BROWSE-BACKWARD.
  8652
  8653
  8654* EXEC CICS READPREV
  8655*         DATASET    ('ELMSTR')
  8656*         RIDFLD     (ELMSTR-KEY)
  8657*         SET        (ADDRESS OF CLAIM-MASTER)
  8658*    END-EXEC.
  8659     MOVE 'ELMSTR' TO DFHEIV1
  8660     MOVE 0
  8661       TO DFHEIV11
  8662*    MOVE '&0S                   )   #00008513' TO DFHEIV0
  8663     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303038353133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL156.cbl
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           DFHEIV1,
  8668           DFHEIV20,
  8669           DFHEIV99,
  8670           ELMSTR-KEY,
  8671           DFHEIV99,
  8672           DFHEIV11,
  8673           DFHEIV99,
  8674           DFHEIV99
  8675     SET ADDRESS OF CLAIM-MASTER TO
  8676         DFHEIV20
  8677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8678
  8679
  8680     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8681        GO TO 0380-CLAIM-END-FILE.
  8682
  8683     IF PI-COMPANY-ID = 'CRI'
  8684         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8685            GO TO 0380-CLAIM-END-FILE.
  8686
  8687     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8688         GO TO 0360-BROWSE-BACKWARD.
  8689
  8690     IF PI-CARRIER-SECURITY > SPACES
  8691         IF CL-CARRIER = PI-CARRIER-SECURITY
  8692             NEXT SENTENCE
  8693         ELSE
  8694             GO TO 0360-BROWSE-BACKWARD.
  8695
  8696     IF PI-ACCOUNT-SECURITY > SPACES
  8697         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8698             NEXT SENTENCE
  8699         ELSE
  8700             GO TO 0360-BROWSE-BACKWARD.
  8701
  8702     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8703     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8704     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8705
  8706     GO TO 0400-FIRST-TIME.
  8707
  8708 0380-CLAIM-END-FILE.
  8709
  8710     MOVE ER-0130     TO EMI-ERROR.
  8711     MOVE -1          TO CLMNOL.
  8712     MOVE AL-UABON    TO CARRA
  8713                         CLMNOA
  8714                         CERTNOA
  8715                         SUFXA.
  8716
  8717     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8718
  8719     GO TO 8200-SEND-DATAONLY.
  8720
  8721 0400-FIRST-TIME.
  8722
  8723     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL156.cbl
  8724        MOVE 'N'         TO WS-BROWSE-START-SW
  8725
  8726* EXEC CICS ENDBR
  8727*            DATASET    ('ELMSTR')
  8728*       END-EXEC.
  8729     MOVE 'ELMSTR' TO DFHEIV1
  8730     MOVE 0
  8731       TO DFHEIV11
  8732*    MOVE '&2                    $   #00008564' TO DFHEIV0
  8733     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8734     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8735     MOVE X'2020233030303038353634' TO DFHEIV0(25:11)
  8736     CALL 'kxdfhei1' USING DFHEIV0,
  8737           DFHEIV1,
  8738           DFHEIV11,
  8739           DFHEIV99
  8740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8741
  8742
  8743     IF PI-PROCESSOR-ID = 'LGXX'
  8744         NEXT SENTENCE
  8745     ELSE
  8746
  8747* EXEC CICS READQ TS
  8748*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8749*            INTO    (SECURITY-CONTROL)
  8750*            LENGTH  (SC-COMM-LENGTH)
  8751*            ITEM    (SC-ITEM)
  8752*        END-EXEC
  8753*    MOVE '*$II   L              ''   #00008571' TO DFHEIV0
  8754     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8756     MOVE X'2020233030303038353731' TO DFHEIV0(25:11)
  8757     CALL 'kxdfhei1' USING DFHEIV0,
  8758           PI-SECURITY-TEMP-STORE-ID,
  8759           SECURITY-CONTROL,
  8760           SC-COMM-LENGTH,
  8761           SC-ITEM,
  8762           DFHEIV99,
  8763           DFHEIV99
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8765         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8766         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8767
  8768     MOVE LOW-VALUES             TO EL156AI.
  8769     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8770     MOVE 'Y'                    TO FIRST-ENTRY.
  8771     GO TO 7000-SHOW-CLAIM.
  8772
  8773 0500-CREATE-TEMP-STORAGE.
  8774     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8775
  8776
  8777* EXEC CICS WRITEQ TS
  8778*        QUEUE (QID)
  8779*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8780*        LENGTH(PI-COMM-LENGTH)
  8781*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL156.cbl
  8782*    MOVE '*"                    ''   #00008588' TO DFHEIV0
  8783     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8784     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8785     MOVE X'2020233030303038353838' TO DFHEIV0(25:11)
  8786     CALL 'kxdfhei1' USING DFHEIV0,
  8787           QID,
  8788           PROGRAM-INTERFACE-BLOCK,
  8789           PI-COMM-LENGTH,
  8790           DFHEIV99,
  8791           DFHEIV99,
  8792           DFHEIV99
  8793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8794
  8795
  8796
  8797* EXEC CICS WRITEQ TS
  8798*        QUEUE (QID)
  8799*        FROM  (EL156AI)
  8800*        LENGTH(MAP-LENGTH)
  8801*    END-EXEC.
  8802*    MOVE '*"                    ''   #00008594' TO DFHEIV0
  8803     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8805     MOVE X'2020233030303038353934' TO DFHEIV0(25:11)
  8806     CALL 'kxdfhei1' USING DFHEIV0,
  8807           QID,
  8808           EL156AI,
  8809           MAP-LENGTH,
  8810           DFHEIV99,
  8811           DFHEIV99,
  8812           DFHEIV99
  8813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8814
  8815
  8816 0599-EXIT.
  8817      EXIT.
  8818
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL156.cbl
  8820 0600-RECOVER-TEMP-STORAGE.
  8821
  8822* EXEC CICS READQ TS
  8823*        QUEUE (QID)
  8824*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8825*        LENGTH(PI-COMM-LENGTH)
  8826*    END-EXEC.
  8827*    MOVE '*$I    L              ''   #00008605' TO DFHEIV0
  8828     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8830     MOVE X'2020233030303038363035' TO DFHEIV0(25:11)
  8831     CALL 'kxdfhei1' USING DFHEIV0,
  8832           QID,
  8833           PROGRAM-INTERFACE-BLOCK,
  8834           PI-COMM-LENGTH,
  8835           DFHEIV99,
  8836           DFHEIV99,
  8837           DFHEIV99
  8838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8839
  8840
  8841
  8842* EXEC CICS READQ TS
  8843*        QUEUE (QID)
  8844*        INTO  (EL156AI)
  8845*        LENGTH(MAP-LENGTH)
  8846*    END-EXEC.
  8847*    MOVE '*$I    L              ''   #00008611' TO DFHEIV0
  8848     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8850     MOVE X'2020233030303038363131' TO DFHEIV0(25:11)
  8851     CALL 'kxdfhei1' USING DFHEIV0,
  8852           QID,
  8853           EL156AI,
  8854           MAP-LENGTH,
  8855           DFHEIV99,
  8856           DFHEIV99,
  8857           DFHEIV99
  8858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8859
  8860
  8861     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8862
  8863     IF PMTTYPEI NOT = LOW-VALUES
  8864         MOVE AL-UANON           TO PMTTYPEA.
  8865
  8866     IF PAYEEI NOT = LOW-VALUES
  8867         MOVE AL-UANON           TO PAYEEA.
  8868
  8869     IF NOTE1I NOT = LOW-VALUES
  8870         MOVE AL-UANON           TO NOTE1A.
  8871
  8872     IF (RETURNED-FROM = 'EL614')
  8873        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8874     END-IF
  8875*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8876*       AND (PI-EOB-CODES-EXIST = 'Y')
  8877*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL156.cbl
  8878*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8879     IF PI-SET-NOTE2-MDT = 'Y'
  8880         MOVE AL-SANON           TO NOTE2A
  8881     END-IF
  8882
  8883     IF OFFLINEI NOT = LOW-VALUES
  8884         MOVE AL-UANON           TO OFFLINEA.
  8885
  8886*    IF GROUPEDI NOT = LOW-VALUES
  8887*        MOVE AL-UANON           TO GROUPEDA.
  8888
  8889*    IF CASHI NOT = LOW-VALUES
  8890*        MOVE AL-UANON           TO CASHA.
  8891
  8892     IF CHECKNOI NOT = LOW-VALUES
  8893         MOVE AL-UANON           TO CHECKNOA.
  8894
  8895     IF HOLDTILI NOT = LOW-VALUES
  8896         MOVE AL-UANON           TO HOLDTILA.
  8897
  8898     IF EPYFROMI NOT = LOW-VALUES
  8899         MOVE AL-UANON           TO EPYFROMA.
  8900
  8901     IF AIGFROMI NOT = LOW-VALUES
  8902         MOVE AL-UANON           TO AIGFROMA.
  8903
  8904     IF EPYTHRUI NOT = LOW-VALUES
  8905         MOVE AL-UANON           TO EPYTHRUA.
  8906
  8907     IF EDAYSI NOT = LOW-VALUES
  8908         MOVE AL-UNNON           TO EDAYSA.
  8909
  8910     IF EPYAMTL NOT = +0
  8911         MOVE AL-UNNON           TO EPYAMTA.
  8912
  8913     IF ERESVL NOT = +0
  8914         MOVE AL-UNNON           TO ERESVA.
  8915
  8916     IF EEXPENSL NOT = +0
  8917         MOVE AL-UNNON           TO EEXPENSA.
  8918
  8919     IF ETYPEI NOT = LOW-VALUES
  8920         MOVE AL-UNNON           TO ETYPEA.
  8921
  8922     IF PROOFDTI NOT = 0
  8923         MOVE AL-UNNON           TO PROOFDTA.
  8924
  8925     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8926        MOVE AL-UANON            TO EOBYNA
  8927     END-IF
  8928     IF CLMFMYNI = 'Y' OR 'N'
  8929        MOVE AL-UANON            TO CLMFMYNA
  8930     END-IF
  8931
  8932     IF SURVYYNI = 'Y' OR 'N'
  8933        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8934           MOVE AL-UANON         TO SURVYYNA
  8935        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL156.cbl
  8936     END-IF
  8937
  8938     IF SPRELYNI = 'Y' OR 'N'
  8939        MOVE AL-UANON            TO SPRELYNA
  8940     END-IF
  8941
  8942     .
  8943 0699-EXIT.
  8944      EXIT.
  8945
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL156.cbl
  8947 0700-TEST-FOR-CHANGES.
  8948     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8949         MOVE ER-0433            TO EMI-ERROR
  8950         GO TO 0750-FUNCTION-ERROR.
  8951
  8952     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8953
  8954     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8955         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8956         MOVE 'A'                TO PI-PASS-SW
  8957         GO TO 1000-EDIT-DATA.
  8958
  8959     IF PI-FATAL-COUNT NOT = 0
  8960         MOVE ER-0499            TO EMI-ERROR
  8961         GO TO 0750-FUNCTION-ERROR.
  8962
  8963     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8964         MOVE ER-0500            TO EMI-ERROR
  8965         GO TO 0750-FUNCTION-ERROR.
  8966
  8967     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8968        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8969           MOVE ER-0542          TO EMI-ERROR
  8970           MOVE -1               TO EPYAMTL
  8971           GO TO 0750-FUNCTION-ERROR.
  8972
  8973     IF PI-OFFLINE = 'Y'  OR
  8974        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8975        MOVE EIBAID              TO PI-PFKEY-USED
  8976        GO TO 5000-UPDATE.
  8977
  8978     GO TO 6000-BUILD-SCREEN-B.
  8979
  8980 0750-FUNCTION-ERROR.
  8981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8982
  8983     IF ENTERPFL > 0
  8984         MOVE -1                 TO ENTERPFL
  8985         MOVE AL-UNBON           TO ENTERPFA
  8986         GO TO 8200-SEND-DATAONLY
  8987     ELSE
  8988         MOVE -1                 TO ENTERPFL
  8989         MOVE AL-UNNOF           TO ENTERPFA
  8990         GO TO 8200-SEND-DATAONLY.
  8991
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL156.cbl
  8993 0800-DELETE-TS.
  8994
  8995* EXEC CICS HANDLE CONDITION
  8996*        QIDERR(0800-EXIT)
  8997*    END-EXEC.
  8998*    MOVE '"$N                   ! % #00008750' TO DFHEIV0
  8999     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9001     MOVE X'2520233030303038373530' TO DFHEIV0(25:11)
  9002     CALL 'kxdfhei1' USING DFHEIV0
  9003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9004
  9005
  9006
  9007* EXEC CICS DELETEQ TS
  9008*        QUEUE(QID)
  9009*    END-EXEC.
  9010*    MOVE '*&                    #   #00008754' TO DFHEIV0
  9011     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9013     MOVE X'2020233030303038373534' TO DFHEIV0(25:11)
  9014     CALL 'kxdfhei1' USING DFHEIV0,
  9015           QID,
  9016           DFHEIV99
  9017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9018
  9019
  9020 0800-EXIT.
  9021      EXIT.
  9022 0900-GET-DDF-LIMITS.
  9023
  9024     if cm-clp-state = zeros or spaces or low-values
  9025        move cm-state            to cm-clp-state
  9026     end-if
  9027     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9028     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9029     MOVE cm-clp-state           TO ERPDEF-STATE
  9030     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9031     evaluate true
  9032        when (cl-claim-type = 'L' or 'P')
  9033           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9034             and 'CU')
  9035           move 'L'              to erpdef-ben-type
  9036           move pi-lf-benefit-cd to erpdef-ben-code
  9037        when (cl-claim-type not = 'L' and 'P')
  9038           and (pi-ah-benefit-cd not = '00' and '  ')
  9039           move 'A'              to erpdef-ben-type
  9040           move pi-ah-benefit-cd to erpdef-ben-code
  9041        when (cl-claim-type not = 'L' and 'P')
  9042           and (pi-ah-benefit-cd = '00' or '  ')
  9043           move 'L'              to erpdef-ben-type
  9044           move pi-lf-benefit-cd to erpdef-ben-code
  9045        when (cl-claim-type = 'L' or 'P')
  9046           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9047           move 'A'              to erpdef-ben-type
  9048           move pi-ah-benefit-cd to erpdef-ben-code
  9049        when other
  9050           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL156.cbl
  9051           move pi-ah-benefit-cd to erpdef-ben-code
  9052     end-evaluate
  9053*    if (cl-claim-type = 'L' or 'P')
  9054*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9055*          and 'CU')
  9056*       move 'L'                 to erpdef-ben-type
  9057*       move pi-lf-benefit-cd    to erpdef-ben-code
  9058*    else
  9059*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9060*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9061*    end-if
  9062     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9063
  9064     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9065
  9066
  9067* EXEC CICS STARTBR
  9068*        DATASET  ('ERPDEF')
  9069*        RIDFLD   (ERPDEF-KEY)
  9070*        GTEQ
  9071*        RESP     (WS-RESPONSE)
  9072*    END-EXEC
  9073     MOVE 'ERPDEF' TO DFHEIV1
  9074     MOVE 0
  9075       TO DFHEIV11
  9076*    MOVE '&,         G          &  N#00008804' TO DFHEIV0
  9077     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9078     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9079     MOVE X'204E233030303038383034' TO DFHEIV0(25:11)
  9080     CALL 'kxdfhei1' USING DFHEIV0,
  9081           DFHEIV1,
  9082           ERPDEF-KEY,
  9083           DFHEIV99,
  9084           DFHEIV11,
  9085           DFHEIV99
  9086     MOVE EIBRESP  TO WS-RESPONSE
  9087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9088
  9089     IF NOT WS-RESP-NORMAL
  9090        GO TO 0900-EXIT
  9091     END-IF
  9092
  9093     .
  9094 0900-READNEXT.
  9095
  9096
  9097* EXEC CICS READNEXT
  9098*       DATASET  ('ERPDEF')
  9099*       SET      (ADDRESS OF PRODUCT-MASTER)
  9100*       RIDFLD   (ERPDEF-KEY)
  9101*       RESP     (WS-RESPONSE)
  9102*    END-EXEC
  9103     MOVE 'ERPDEF' TO DFHEIV1
  9104     MOVE 0
  9105       TO DFHEIV11
  9106*    MOVE '&.S                   )  N#00008818' TO DFHEIV0
  9107     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9108     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL156.cbl
  9109     MOVE X'204E233030303038383138' TO DFHEIV0(25:11)
  9110     CALL 'kxdfhei1' USING DFHEIV0,
  9111           DFHEIV1,
  9112           DFHEIV20,
  9113           DFHEIV99,
  9114           ERPDEF-KEY,
  9115           DFHEIV99,
  9116           DFHEIV11,
  9117           DFHEIV99,
  9118           DFHEIV99
  9119     SET ADDRESS OF PRODUCT-MASTER TO
  9120         DFHEIV20
  9121     MOVE EIBRESP  TO WS-RESPONSE
  9122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9123
  9124     IF NOT WS-RESP-NORMAL
  9125        GO TO 0900-ENDBR
  9126     END-IF
  9127
  9128     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9129        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9130           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9131        ELSE
  9132           GO TO 0900-READNEXT
  9133        END-IF
  9134     ELSE
  9135        GO TO 0900-ENDBR
  9136     END-IF
  9137
  9138     IF CM-LOAN-TERM = ZEROS
  9139        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9140     END-IF
  9141
  9142     .
  9143 0900-ENDBR.
  9144
  9145
  9146* EXEC CICS ENDBR
  9147*       DATASET  ('ERPDEF')
  9148*    END-EXEC
  9149     MOVE 'ERPDEF' TO DFHEIV1
  9150     MOVE 0
  9151       TO DFHEIV11
  9152*    MOVE '&2                    $   #00008846' TO DFHEIV0
  9153     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9154     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9155     MOVE X'2020233030303038383436' TO DFHEIV0(25:11)
  9156     CALL 'kxdfhei1' USING DFHEIV0,
  9157           DFHEIV1,
  9158           DFHEIV11,
  9159           DFHEIV99
  9160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9161
  9162     .
  9163 0900-EXIT.
  9164     EXIT.
  9165 1000-EDIT-DATA.
  9166
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL156.cbl
  9167     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9168         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9169         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9170
  9171     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9172
  9173     IF NOT MODIFY-CAP
  9174         MOVE ER-0070            TO EMI-ERROR
  9175         MOVE -1                 TO PMTTYPEL
  9176         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9177         GO TO 2000-EDIT-DONE.
  9178
  9179     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9180                         '5' AND '6'
  9181         MOVE ER-0420            TO EMI-ERROR
  9182         MOVE -1                 TO PMTTYPEL
  9183         MOVE AL-UABON           TO PMTTYPEA
  9184         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9185     ELSE
  9186         MOVE AL-UANON           TO PMTTYPEA.
  9187
  9188*    IF PI-OFFLINE = 'Y'
  9189*       IF PI-GROUPED = 'Y'
  9190*          MOVE ER-1880         TO EMI-ERROR
  9191*          MOVE -1              TO GROUPEDL
  9192*          MOVE AL-UABON        TO GROUPEDA
  9193*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9194*
  9195*    IF GROUPEDL > +0
  9196*       IF PI-GROUPED = 'Y' OR 'N'
  9197*          MOVE AL-UANON TO GROUPEDA
  9198*       ELSE
  9199*          MOVE ER-3140            TO EMI-ERROR
  9200*          MOVE -1                 TO GROUPEDL
  9201*          MOVE AL-UABON           TO GROUPEDA
  9202*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9203*
  9204*    IF CASHL > +0
  9205*       IF PI-CASH = 'Y' OR 'N'
  9206*          MOVE AL-UANON           TO CASHA
  9207*       ELSE
  9208*          MOVE ER-3141            TO EMI-ERROR
  9209*          MOVE -1                 TO CASHL
  9210*          MOVE AL-UABON           TO CASHA
  9211*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9212
  9213     IF LOANNOL > +0
  9214         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9215
  9216 1000-EDIT-PAYEE.
  9217
  9218     IF PI-PAYEE-SEQ NOT NUMERIC
  9219         MOVE ER-0294            TO  EMI-ERROR
  9220         MOVE -1                 TO  PAYEEL
  9221         MOVE AL-UABON           TO  PAYEEA
  9222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9223         GO TO 1000-CONT-EDIT.
  9224
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL156.cbl
  9225     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9226                         'E' OR 'O' OR 'Q'
  9227         NEXT SENTENCE
  9228     ELSE
  9229         MOVE ER-0294            TO  EMI-ERROR
  9230         MOVE -1                 TO  PAYEEL
  9231         MOVE AL-UABON           TO  PAYEEA
  9232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9233         GO TO 1000-CONT-EDIT.
  9234
  9235     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9236        (PI-PAYEE-SEQ NOT < '1' AND
  9237         PI-PAYEE-SEQ NOT > '9'))
  9238      OR
  9239        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9240         (PI-PAYEE-SEQ NOT > '9'))
  9241         MOVE AL-UANON            TO PAYEEA
  9242     ELSE
  9243         MOVE ER-0294            TO EMI-ERROR
  9244         MOVE -1                 TO PAYEEL
  9245         MOVE AL-UABON           TO PAYEEA
  9246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9247
  9248     IF PI-COMPANY-ID = 'DMD'
  9249         IF PI-PAYEE-TYPE = 'B' AND
  9250            PI-PAYEE-SEQ NOT = '0'
  9251               MOVE ER-7841            TO EMI-ERROR
  9252               MOVE -1                 TO PAYEEL
  9253               MOVE AL-UABON           TO PAYEEA
  9254               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9255
  9256     IF PI-COMPANY-ID = 'JHL'
  9257         IF PI-PAYEE = 'B0'
  9258             NEXT SENTENCE
  9259           ELSE
  9260
  9261* EXEC CICS HANDLE CONDITION
  9262*            ENDFILE(1950-NOT-FOUND)
  9263*            NOTFND (1950-NOT-FOUND)
  9264*        END-EXEC
  9265*    MOVE '"$''I                  ! & #00008948' TO DFHEIV0
  9266     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9268     MOVE X'2620233030303038393438' TO DFHEIV0(25:11)
  9269     CALL 'kxdfhei1' USING DFHEIV0
  9270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9271         MOVE 'N'                    TO FOUND-TOL-SW
  9272         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9273         MOVE '2'                    TO CNTL-REC-TYPE
  9274         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9275         MOVE +0                     TO CNTL-SEQ-NO
  9276         MOVE 'PROC'                 TO FILE-SWITCH
  9277         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9278         IF PI-PAYEE = 'I1' AND
  9279            APPROVAL-LEVEL-2
  9280             NEXT SENTENCE
  9281           ELSE
  9282         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL156.cbl
  9283             MOVE ER-3546        TO EMI-ERROR
  9284             MOVE -1             TO PAYEEL
  9285             MOVE AL-UABON       TO PAYEEA
  9286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9287
  9288     IF PI-PAYEE-TYPE = 'E'
  9289        IF PI-PMTTYPE = '5' OR '6'
  9290            NEXT SENTENCE
  9291        ELSE
  9292            MOVE ER-3539            TO EMI-ERROR
  9293            MOVE -1                 TO PAYEEL
  9294            MOVE AL-UABON           TO PAYEEA
  9295            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9296
  9297 1000-CONT-EDIT.
  9298
  9299     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9300        IF PI-EPYAMT NOT NEGATIVE
  9301            MOVE ER-0421         TO EMI-ERROR
  9302            MOVE -1              TO OFFLINEL
  9303            MOVE AL-UABON        TO OFFLINEA
  9304            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9305        ELSE
  9306            MOVE AL-UANON        TO OFFLINEA.
  9307
  9308     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9309        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9310           CONTINUE
  9311        ELSE
  9312           IF PI-PRINT-EOB-YN = 'S' AND
  9313              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9314                CONTINUE
  9315           ELSE
  9316              MOVE ER-1561       TO EMI-ERROR
  9317              MOVE -1            TO EOBYNL
  9318              MOVE AL-UABON      TO EOBYNA
  9319              PERFORM 9900-ERROR-FORMAT
  9320                                 THRU 9900-EXIT
  9321           END-IF
  9322        END-IF
  9323
  9324        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9325            MOVE ER-1566        TO EMI-ERROR
  9326            MOVE -1             TO CLMFMYNL
  9327            MOVE AL-UABON       TO CLMFMYNA
  9328            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9329        END-IF
  9330
  9331        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9332            MOVE ER-1567        TO EMI-ERROR
  9333            MOVE -1             TO SURVYYNL
  9334            MOVE AL-UABON       TO SURVYYNA
  9335            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9336        END-IF
  9337
  9338        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9339            MOVE ER-1569        TO EMI-ERROR
  9340            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL156.cbl
  9341            MOVE AL-UABON       TO SPRELYNA
  9342            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9343        END-IF
  9344
  9345     END-IF
  9346     IF PI-EPYAMT IS NEGATIVE
  9347         IF PI-OFFLINE NOT = 'Y'
  9348             MOVE ER-0836        TO  EMI-ERROR
  9349             MOVE -1             TO  OFFLINEL
  9350             MOVE AL-UABON       TO  OFFLINEA
  9351             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9352
  9353     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9354        MOVE ER-0872             TO EMI-ERROR
  9355        MOVE -1                  TO PROOFDTL
  9356        MOVE AL-UABON            TO PROOFDTA
  9357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9358     ELSE
  9359        MOVE '4'                TO DC-OPTION-CODE
  9360        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9361        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9362        IF DATE-CONVERSION-ERROR
  9363            MOVE ER-0873        TO EMI-ERROR
  9364            MOVE -1                  TO PROOFDTL
  9365            MOVE AL-UABON            TO PROOFDTA
  9366            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9367        ELSE
  9368            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9369            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9370                MOVE ER-0873    TO EMI-ERROR
  9371                MOVE -1                  TO PROOFDTL
  9372                MOVE AL-UABON            TO PROOFDTA
  9373                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9374            END-IF
  9375        END-IF
  9376     END-IF.
  9377
  9378     IF PI-COMPANY-ID = 'DMD'
  9379        IF NOTE1L NOT = ZEROS
  9380            MOVE ER-7844        TO  EMI-ERROR
  9381            MOVE -1             TO  NOTE1L
  9382            MOVE AL-UABON       TO  NOTE1A
  9383            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9384
  9385     IF PI-COMPANY-ID = 'DMD'
  9386        IF NOTE2L NOT = ZEROS
  9387          GO TO 1004-DMD-EOB-CHECKS.
  9388
  9389     IF NOTE1L NOT > +0
  9390         GO TO 1005-CHECK-ERRORS.
  9391
  9392     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9393         GO TO 1005-CHECK-ERRORS.
  9394
  9395     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9396         GO TO 1003-HAN-PMT-NOTES.
  9397
  9398     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL156.cbl
  9399
  9400     IF WS-PMTOPTION NUMERIC
  9401        IF WS-PMTOPTION > '00' AND < '17'
  9402           NEXT SENTENCE
  9403        ELSE
  9404           MOVE ER-0618          TO EMI-ERROR
  9405           MOVE -1               TO NOTE1L
  9406           MOVE AL-UABON         TO NOTE1A
  9407           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9408     ELSE
  9409        GO TO 1005-CHECK-ERRORS.
  9410
  9411     IF WS-PMTOPTION = '05' AND
  9412        WS-DOCNAME = SPACES
  9413          MOVE ER-0616             TO EMI-ERROR
  9414          MOVE -1                  TO NOTE1L
  9415          MOVE AL-UABON            TO NOTE1A
  9416          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9417
  9418     IF WS-PMTOPTION = '15' OR '16'
  9419
  9420* EXEC CICS BIF DEEDIT
  9421*            FIELD (WS-AMOUNT)
  9422*            LENGTH(08)
  9423*        END-EXEC
  9424     MOVE 08
  9425       TO DFHEIV11
  9426*    MOVE '@"L                   #   #00009100' TO DFHEIV0
  9427     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9428     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9429     MOVE X'2020233030303039313030' TO DFHEIV0(25:11)
  9430     CALL 'kxdfhei1' USING DFHEIV0,
  9431           WS-AMOUNT,
  9432           DFHEIV11
  9433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9434        IF (WS-NUM-AMT = ZEROS) OR
  9435           (WS-AMOUNT NOT NUMERIC)
  9436           MOVE ER-0617          TO EMI-ERROR
  9437           MOVE -1               TO NOTE1L
  9438           MOVE AL-UABON         TO NOTE1A
  9439           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9440
  9441     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9442
  9443     GO TO 1005-CHECK-ERRORS.
  9444
  9445 1003-HAN-PMT-NOTES.
  9446
  9447     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9448
  9449     IF WS-HAN-PMT-CODE = SPACE
  9450         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9451     ELSE
  9452     IF WS-HAN-PMT-CODE = 'A'
  9453         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9454                                 TO WS-HAN-PMT-NOTE
  9455     ELSE
  9456     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL156.cbl
  9457         MOVE ':FINAL PAYMENT / DECEASED'
  9458                                 TO WS-HAN-PMT-NOTE
  9459     ELSE
  9460     IF WS-HAN-PMT-CODE = 'C'
  9461         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9462                                 TO WS-HAN-PMT-NOTE
  9463     ELSE
  9464     IF WS-HAN-PMT-CODE = 'D'
  9465         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9466                                 TO WS-HAN-PMT-NOTE
  9467     ELSE
  9468     IF WS-HAN-PMT-CODE = 'E'
  9469         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9470                                 TO WS-HAN-PMT-NOTE
  9471     ELSE
  9472     IF WS-HAN-PMT-CODE = 'F'
  9473         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9474                                 TO WS-HAN-PMT-NOTE
  9475     ELSE
  9476     IF WS-HAN-PMT-CODE = 'P'
  9477         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9478
  9479     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9480     GO TO 1005-CHECK-ERRORS.
  9481
  9482 1004-DMD-EOB-CHECKS.
  9483
  9484     INITIALIZE PI-AT-EOB-CODES.
  9485
  9486     IF NOTE2I (20:21) > SPACES
  9487         MOVE ER-7845          TO EMI-ERROR
  9488         MOVE -1               TO NOTE2L
  9489         MOVE AL-UABON         TO NOTE2A
  9490         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9491         GO TO 1005-CHECK-ERRORS
  9492      ELSE
  9493         MOVE NOTE2I             TO W-EOB-CODES.
  9494
  9495     MOVE +1                     TO W-EOB-NDX.
  9496
  9497 1004-CHECK-EACH-EOB.
  9498
  9499     IF W-EOB-NDX > +5
  9500             OR
  9501        W-EOB-CODE (W-EOB-NDX) = SPACES
  9502         GO TO 1004-CHECK-DUP-EOB.
  9503
  9504     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9505         MOVE ER-0956            TO EMI-ERROR
  9506         MOVE -1                 TO NOTE2L
  9507         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9508         GO TO 1005-CHECK-ERRORS.
  9509
  9510     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9511     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9512     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9513     MOVE 'DLO023'               TO PGM-NAME.
  9514
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL156.cbl
  9515
  9516* EXEC CICS LINK
  9517*        PROGRAM    (PGM-NAME)
  9518*        COMMAREA   (CD-COMMUNICATION-AREA)
  9519*        LENGTH     (CD-RCRD-LENGTH)
  9520*    END-EXEC.
  9521*    MOVE '."C                   (   #00009185' TO DFHEIV0
  9522     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9524     MOVE X'2020233030303039313835' TO DFHEIV0(25:11)
  9525     CALL 'kxdfhei1' USING DFHEIV0,
  9526           PGM-NAME,
  9527           CD-COMMUNICATION-AREA,
  9528           CD-RCRD-LENGTH,
  9529           DFHEIV99,
  9530           DFHEIV99,
  9531           DFHEIV99,
  9532           DFHEIV99
  9533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9534
  9535
  9536     IF CD-RETURN-CODE = 'OK'
  9537         GO TO 1004-CONT.
  9538
  9539     MOVE -1                     TO NOTE2L.
  9540
  9541     IF CD-RETURN-CODE = '01'
  9542         MOVE ER-8310            TO EMI-ERROR
  9543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9544         GO TO 1005-CHECK-ERRORS.
  9545
  9546     IF CD-RETURN-CODE = '02'
  9547         MOVE ER-8311            TO EMI-ERROR
  9548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9549         GO TO 1005-CHECK-ERRORS.
  9550
  9551     IF CD-RETURN-CODE = '03'
  9552         MOVE ER-8312            TO EMI-ERROR
  9553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9554         GO TO 1005-CHECK-ERRORS.
  9555
  9556     IF CD-RETURN-CODE = '04'
  9557         MOVE ER-8313            TO EMI-ERROR
  9558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9559         GO TO 1005-CHECK-ERRORS.
  9560
  9561     IF CD-RETURN-CODE = '05'
  9562         MOVE ER-8314            TO EMI-ERROR
  9563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9564         GO TO 1005-CHECK-ERRORS.
  9565
  9566     IF CD-RETURN-CODE = '06'
  9567         MOVE ER-8315            TO EMI-ERROR
  9568         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9569         GO TO 1005-CHECK-ERRORS.
  9570
  9571     IF CD-RETURN-CODE = 'E1'
  9572         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL156.cbl
  9573         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9574         GO TO 1005-CHECK-ERRORS.
  9575
  9576     IF CD-RETURN-CODE = 'N1'
  9577         MOVE ER-8317            TO EMI-ERROR
  9578         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9579         GO TO 1005-CHECK-ERRORS.
  9580
  9581 1004-CONT.
  9582     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9583
  9584     ADD +1 TO W-EOB-NDX.
  9585     GO TO 1004-CHECK-EACH-EOB.
  9586
  9587 1004-CHECK-DUP-EOB.
  9588     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9589         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9590                               PI-AT-EOB-CODE (3) OR
  9591                               PI-AT-EOB-CODE (4) OR
  9592                               PI-AT-EOB-CODE (5)))
  9593                  OR
  9594        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9595         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9596                               PI-AT-EOB-CODE (4) OR
  9597                               PI-AT-EOB-CODE (5)))
  9598                  OR
  9599        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9600         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9601                               PI-AT-EOB-CODE (5)))
  9602                  OR
  9603        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9604         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9605            MOVE ER-8000            TO EMI-ERROR
  9606            MOVE AL-UABON           TO NOTE2A
  9607            MOVE -1                 TO NOTE2L
  9608            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9609            GO TO 1005-CHECK-ERRORS.
  9610
  9611 1005-CHECK-ERRORS.
  9612*    IF PI-COMPANY-ID NOT = 'DMD'
  9613        GO TO 1006-CHECK-ERRORS.
  9614
  9615*********  DMD CODE START ******************
  9616*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9617*       GO TO 1006-CHECK-ERRORS.
  9618*
  9619*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9620*
  9621*    COMPUTE W-PAYMENT-TOTAL
  9622*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9623*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9624*               AND
  9625*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9626*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9627*          MOVE ER-0967    TO EMI-ERROR
  9628*          MOVE -1         TO PMTTYPEL
  9629*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9630*
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL156.cbl
  9631*    GO TO 1006-CHECK-ERRORS.
  9632*********  DMD CODE END ******************
  9633
  9634 1006-CHECK-ERRORS.
  9635     IF NOT EMI-NO-ERRORS
  9636        GO TO 2000-EDIT-DONE.
  9637
  9638
  9639* EXEC CICS HANDLE CONDITION
  9640*        NOTFND(1950-NOT-FOUND)
  9641*    END-EXEC.
  9642*    MOVE '"$I                   ! '' #00009293' TO DFHEIV0
  9643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9645     MOVE X'2720233030303039323933' TO DFHEIV0(25:11)
  9646     CALL 'kxdfhei1' USING DFHEIV0
  9647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9648
  9649
  9650     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9651     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9652     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9653     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9654     MOVE 'MSTR'                 TO FILE-SWITCH.
  9655
  9656     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9657
  9658     IF PI-COMPANY-ID = 'DMD'
  9659         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9660
  9661     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9662        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9663           MOVE ER-0873    TO EMI-ERROR
  9664           MOVE -1                  TO PROOFDTL
  9665           MOVE AL-UABON            TO PROOFDTA
  9666           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9667        END-IF
  9668     END-IF
  9669     if cl-benefit-period = zeros
  9670        move er-1667             to emi-error
  9671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9672     end-if
  9673     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9674     MOVE +95                    TO TRLR-SEQ-NO
  9675
  9676* EXEC CICS READ
  9677*       DATASET  ('ELTRLR')
  9678*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9679*       RIDFLD   (ELTRLR-KEY)
  9680*       RESP     (WS-RESPONSE)
  9681*    END-EXEC
  9682     MOVE 'ELTRLR' TO DFHEIV1
  9683*    MOVE '&"S        E          (  N#00009322' TO DFHEIV0
  9684     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9685     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9686     MOVE X'204E233030303039333232' TO DFHEIV0(25:11)
  9687     CALL 'kxdfhei1' USING DFHEIV0,
  9688           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL156.cbl
  9689           DFHEIV20,
  9690           DFHEIV99,
  9691           ELTRLR-KEY,
  9692           DFHEIV99,
  9693           DFHEIV99,
  9694           DFHEIV99
  9695     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9696         DFHEIV20
  9697     MOVE EIBRESP  TO WS-RESPONSE
  9698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9699
  9700     if ws-resp-normal
  9701        perform varying s1 from +1 by +1 until
  9702           at-note-error-no (s1) = spaces
  9703           if at-note-error-no (s1) = '1662'
  9704              continue
  9705           else
  9706              move at-note-error-no (s1)
  9707                                 to emi-error
  9708              if at-note-error-no (s1) = '1653'
  9709                 evaluate true
  9710                    when cl-claim-type = 'L'
  9711                       move '  LF  '
  9712                                 to emi-claim-type
  9713                    when cl-claim-type = 'I'
  9714                       move '  IU  '
  9715                                 to emi-claim-type
  9716                    when cl-claim-type = 'A'
  9717                       move '  AH  '
  9718                                 to emi-claim-type
  9719                    when other
  9720                       move ' FMLA '
  9721                                 to emi-claim-type
  9722                 end-evaluate
  9723              end-if
  9724              PERFORM 9900-ERROR-FORMAT
  9725                                 THRU 9900-EXIT
  9726           end-if
  9727        end-perform
  9728     end-if
  9729     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9730         IF PI-PMTTYPE = '5' OR '6'
  9731             NEXT SENTENCE
  9732         ELSE
  9733             MOVE ER-0555             TO EMI-ERROR
  9734             MOVE -1                  TO PMTTYPEL
  9735             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9736
  9737     IF CL-LAST-CLOSE-REASON = '2'
  9738         IF CL-CLAIM-STATUS = 'C'
  9739             MOVE ER-0760        TO  EMI-ERROR
  9740             MOVE -1             TO  PMTTYPEL
  9741             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9742
  9743     IF PI-ACTIVITY-CODE = 9
  9744         MOVE ER-3538            TO  EMI-ERROR
  9745         MOVE -1                 TO  PMTTYPEL
  9746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL156.cbl
  9747
  9748     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9749         GO TO 1008-READ-CERT.
  9750**********************AIG LOGIC STARTS *********************
  9751     IF CL-CERT-PRIME = 'INCOMPLETE'
  9752         MOVE ER-3540            TO  EMI-ERROR
  9753         MOVE -1                 TO  PMTTYPEL
  9754         MOVE AL-UABON           TO  PMTTYPEA
  9755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9756         GO TO 2000-EDIT-DONE.
  9757
  9758     IF PI-PMTTYPE = '4'
  9759         IF PI-EPYAMT IS NEGATIVE
  9760             IF PI-ECHECKNO-CR = 'CR'
  9761                 NEXT SENTENCE
  9762             ELSE
  9763                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9764
  9765     IF PI-PMTTYPE = '4'
  9766         IF PI-ECHECKNO-CR = 'CR'
  9767             IF PI-EPYAMT IS NEGATIVE
  9768                 NEXT SENTENCE
  9769             ELSE
  9770                 MOVE ER-0834    TO  EMI-ERROR
  9771                 MOVE -1         TO  EPYAMTL
  9772                 MOVE AL-UNBON   TO  EPYAMTA
  9773                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9774
  9775     IF PI-PMTTYPE = '4'
  9776         IF PI-EPYAMT IS NEGATIVE
  9777             IF PI-OFFLINE = 'Y'
  9778                 NEXT SENTENCE
  9779             ELSE
  9780                 MOVE 'Y'        TO  PI-OFFLINE
  9781                                     WS-OFFLINE
  9782                                     OFFLINEO
  9783                 MOVE AL-UANON   TO  OFFLINEA.
  9784
  9785*    IF PI-PMTTYPE = '4'
  9786*        IF PI-EPYAMT IS NEGATIVE
  9787*            IF PI-CASH = 'Y'
  9788*                NEXT SENTENCE
  9789*            ELSE
  9790*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9791*                MOVE AL-UANON   TO  CASHA
  9792*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9793*
  9794*    IF PI-CASH NOT = 'Y' AND 'N'
  9795*         IF PI-OFFLINE = 'Y'  AND
  9796*            PI-ECHECKNO-CR = 'CR'
  9797*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9798*              MOVE AL-UANON     TO  CASHA
  9799*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9800*
  9801*    IF PI-CASH NOT = 'Y' AND 'N'
  9802*        IF PI-PMTTYPE = '5' OR '6'
  9803*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9804*            MOVE AL-UANON       TO  CASHA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL156.cbl
  9805*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9806*
  9807*    IF PI-CASH NOT = 'Y' AND 'N'
  9808*       IF CL-ASSOCIATES = 'N' OR 'A'
  9809*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9810*           MOVE AL-UANON        TO  CASHA
  9811*       ELSE
  9812*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9813*           MOVE AL-UANON        TO  CASHA.
  9814*
  9815*    IF PI-PMTTYPE = '5' OR '6'
  9816*        IF PI-CASH = 'N'
  9817*            MOVE ER-0819        TO  EMI-ERROR
  9818*            MOVE AL-UANON       TO  CASHA
  9819*            MOVE -1             TO  CASHL
  9820*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9821*
  9822*    IF CL-ASSOCIATES = 'N' OR 'A'
  9823*       IF CASHI = 'N'
  9824*        MOVE ER-3537            TO  EMI-ERROR
  9825*        MOVE AL-UANON           TO  CASHA
  9826*        MOVE -1                 TO  CASHL
  9827*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9828
  9829 1007-DEFAULT-AIG-CHECKNO.
  9830
  9831     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9832         MOVE ER-3532            TO  EMI-ERROR
  9833         MOVE -1                 TO  PMTTYPEL
  9834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9835**********************AIG LOGIC ENDS ***********************
  9836
  9837 1008-READ-CERT.
  9838
  9839     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9840     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9841     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9842     MOVE CL-CERT-STATE          TO CERT-STATE.
  9843     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9844     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9845     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9846     MOVE 'CERT'                 TO FILE-SWITCH.
  9847
  9848     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9849
  9850     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9851        MOVE CM-LF-LOAN-EXPIRE-DT
  9852                                 TO WS-EXP-DT PI-EXP-DT
  9853                                    ws-extended-exp-dt
  9854     ELSE
  9855        MOVE CM-AH-LOAN-EXPIRE-DT
  9856                                 TO WS-EXP-DT PI-EXP-DT
  9857                                    ws-extended-exp-dt
  9858     end-if
  9859     if pi-dcc-product-code not = spaces
  9860        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9861        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9862        PERFORM 0900-GET-DDF-limits
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL156.cbl
  9863                                 THRU 0900-EXIT
  9864        IF PDEF-FOUND
  9865           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9866              (P1 > +8)
  9867              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9868           END-PERFORM
  9869           IF P1 < +9
  9870              MOVE '6'           TO DC-OPTION-CODE
  9871              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9872              MOVE PD-MAX-EXTENSION (P1)
  9873                                 TO DC-ELAPSED-MONTHS
  9874              PERFORM 9700-LINK-DATE-CONVERT
  9875                                 THRU 9700-EXIT
  9876              if no-conversion-error
  9877                 move dc-bin-date-2 to ws-extended-exp-dt
  9878              end-if
  9879           end-if
  9880        end-if
  9881     end-if
  9882*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9883*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9884
  9885     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9886         MOVE ER-0458            TO EMI-ERROR
  9887         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9888
  9889     IF (CL-INCURRED-DT > WS-EXP-DT)
  9890        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9891        MOVE ER-1677             TO EMI-ERROR
  9892        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9893     END-IF
  9894     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9895     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9896         MOVE ER-0459            TO EMI-ERROR
  9897         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9898
  9899     IF CL-REPORTED-DT = LOW-VALUES
  9900        MOVE ER-0530             TO EMI-ERROR
  9901        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9902
  9903     IF PI-COMPANY-ID = 'NCL'
  9904        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9905            MOVE ER-0770            TO EMI-ERROR
  9906            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9907
  9908     IF PI-COMPANY-ID = 'NCL'
  9909        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9910            MOVE ER-0737            TO EMI-ERROR
  9911            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9912
  9913     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9914         MOVE ER-0768            TO  EMI-ERROR
  9915         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9916
  9917     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9918         MOVE ER-0769            TO  EMI-ERROR
  9919         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9920
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL156.cbl
  9921     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9922         GO TO 1020-DO-LIFE-EDITS
  9923     ELSE
  9924         GO TO 1030-DO-AH-EDITS.
  9925
  9926 1010-GENERAL-ERROR.
  9927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9928
  9929     IF EMI-MESSAGE-FORMATTED
  9930         MOVE -1                 TO PMTTYPEL.
  9931
  9932 1010-EXIT.
  9933     EXIT.
  9934
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL156.cbl
  9936 1020-DO-LIFE-EDITS.
  9937     IF CM-LF-BENEFIT-CD = '00'
  9938         IF PI-PMTTYPE = '5' OR '6'
  9939             MOVE ER-0658        TO EMI-ERROR
  9940             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9941         ELSE
  9942             MOVE ER-1775        TO EMI-ERROR
  9943             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9944
  9945     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9946     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9947         MOVE ER-0460            TO EMI-ERROR
  9948         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9949
  9950     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9951     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9952     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9953     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9954     MOVE '4'                    TO  CNTL-REC-TYPE.
  9955     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9956     MOVE 'BENE'                 TO  FILE-SWITCH.
  9957     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9958     IF NO-BENEFIT-FOUND
  9959         GO TO 1950-NOT-FOUND.
  9960
  9961     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9962
  9963     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9964         IF PI-PMTTYPE = '4'
  9965             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9966                PI-LF-COVERAGE-TYPE = 'P'
  9967                 NEXT SENTENCE
  9968             ELSE
  9969                 MOVE ER-0461        TO EMI-ERROR
  9970                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9971         ELSE
  9972            NEXT SENTENCE
  9973     ELSE
  9974         IF PI-PMTTYPE = '2'
  9975            IF NOT CM-O-B-COVERAGE
  9976              AND CM-LF-CURRENT-STATUS = '7'
  9977                MOVE ER-0462     TO EMI-ERROR
  9978                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9979
  9980     IF PI-PMTTYPE = '2'
  9981         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9982            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9983             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9984             MOVE ER-0730            TO  EMI-ERROR
  9985             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9986             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9987
  9988     IF PI-PMTTYPE = '2'
  9989         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9990            PI-LF-COVERAGE-TYPE = 'P'
  9991             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9992                 MOVE ER-0462    TO  EMI-ERROR
  9993                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL156.cbl
  9994
  9995     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9996       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9997         MOVE ER-0466            TO EMI-ERROR
  9998         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9999
 10000     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10001         IF PI-PMTTYPE = '3'
 10002             MOVE 0436           TO EMI-ERROR
 10003             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10004             GO TO 1045-EDIT-PAYEE-ADDR
 10005         ELSE
 10006             GO TO 1045-EDIT-PAYEE-ADDR.
 10007
 10008     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10009        PI-LF-COVERAGE-TYPE = 'P'
 10010         IF PI-PMTTYPE = '3'
 10011             MOVE ER-0436          TO  EMI-ERROR
 10012             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10013         ELSE
 10014             NEXT SENTENCE
 10015     ELSE
 10016         IF PI-PMTTYPE = '1' OR '3'
 10017             MOVE ER-0436            TO EMI-ERROR
 10018             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10019*
 10020     IF PI-COMPANY-ID = 'CID' AND
 10021        CL-CERT-STATE = 'SC'  AND
 10022        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10023           MOVE ER-0879    TO  EMI-ERROR
 10024           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10025           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10026     END-IF.
 10027     IF PI-COMPANY-ID = 'AHL'
 10028        evaluate true
 10029           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10030              MOVE ER-0879       TO  EMI-ERROR
 10031              PERFORM 1040-PMTTYPE-ERROR
 10032                                 THRU 1040-EXIT
 10033              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10034           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10035                 '6D' OR '6H' OR '6R'
 10036              MOVE ER-0879       TO  EMI-ERROR
 10037              PERFORM 1040-PMTTYPE-ERROR
 10038                                 THRU 1040-EXIT
 10039              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10040           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10041              MOVE ER-0879       TO  EMI-ERROR
 10042              PERFORM 1040-PMTTYPE-ERROR
 10043                                 THRU 1040-EXIT
 10044              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10045        end-evaluate
 10046     END-IF
 10047     GO TO 1045-EDIT-PAYEE-ADDR.
 10048
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL156.cbl
 10050 1030-DO-AH-EDITS.
 10051     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10052     IF CM-AH-BENEFIT-CD = '00'
 10053         IF PI-PMTTYPE = '5' OR '6'
 10054             MOVE ER-0658        TO EMI-ERROR
 10055             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10056         ELSE
 10057             MOVE ER-1775        TO EMI-ERROR
 10058             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10059
 10060     IF CL-TOTAL-PAID-AMT = ZEROS
 10061         IF PI-PMTTYPE = '4'
 10062             MOVE ER-0438        TO EMI-ERROR
 10063             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10064
 10065     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10066         IF PI-PMTTYPE = '3'
 10067             MOVE ER-0463        TO EMI-ERROR
 10068             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10069         ELSE
 10070             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10071              AND CM-LF-CURRENT-STATUS = '7'
 10072                 MOVE ER-0465    TO EMI-ERROR
 10073                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10074
 10075     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10076         IF PI-PMTTYPE = '3'
 10077             MOVE ER-0464        TO EMI-ERROR
 10078             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10079         ELSE
 10080             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10081                 MOVE ER-0469    TO EMI-ERROR
 10082                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10083
 10084     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10085         IF PI-PMTTYPE = '3'
 10086             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10087                 MOVE ER-0467    TO EMI-ERROR
 10088                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10089             ELSE
 10090                 NEXT SENTENCE
 10091         ELSE
 10092             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10093                 MOVE ER-0468    TO EMI-ERROR
 10094                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10095
 10096     GO TO 1045-EDIT-PAYEE-ADDR.
 10097
 10098 1040-PMTTYPE-ERROR.
 10099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10100
 10101     IF EMI-MESSAGE-FORMATTED
 10102         MOVE -1                 TO PMTTYPEL
 10103         MOVE AL-UABON           TO PMTTYPEA.
 10104
 10105 1040-EXIT.
 10106     EXIT.
 10107
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL156.cbl
 10109 1045-EDIT-PAYEE-ADDR.
 10110
 10111     IF PI-OFFLINE = 'N' AND
 10112        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10113           < PI-PAYEE-SEQ-NUM)
 10114        OR
 10115         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10116         (PI-PAYEE-TYPE = 'B')                 AND
 10117         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10118        OR
 10119         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10120           < PI-PAYEE-SEQ-NUM)
 10121        OR
 10122         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10123           < PI-PAYEE-SEQ-NUM)
 10124        OR
 10125         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10126           < PI-PAYEE-SEQ-NUM)
 10127        OR
 10128         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10129           < PI-PAYEE-SEQ-NUM)
 10130        OR
 10131         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10132           < PI-PAYEE-SEQ-NUM))
 10133             MOVE ER-0437        TO EMI-ERROR
 10134             MOVE -1             TO PAYEEL
 10135             MOVE AL-UABON       TO PAYEEA
 10136             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10137
 10138     IF PI-OFFLINE    = 'N' AND
 10139        PI-PAYEE-TYPE = 'B' AND
 10140        PI-PAYEE-SEQ  = '0'
 10141         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10142         IF BENE-FOUND-SW = 'N'
 10143             MOVE ER-0437        TO EMI-ERROR
 10144             MOVE -1             TO PAYEEL
 10145             MOVE AL-UABON       TO PAYEEA
 10146             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10147
 10148     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10149        IF PI-OFFLINE    = 'N'  AND
 10150           PI-PAYEE-TYPE = 'B'  AND
 10151           PI-PAYEE-SEQ  = '9'
 10152             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10153             IF BENE-FOUND-SW = 'N'
 10154                MOVE ER-0437        TO EMI-ERROR
 10155                MOVE -1             TO PAYEEL
 10156                MOVE AL-UABON       TO PAYEEA
 10157                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10158
 10159*    IF PI-COMPANY-ID = 'CRI'
 10160*        IF CL-CLAIM-TYPE = 'L'
 10161*            MOVE 'N'                TO  WS-GROUPED
 10162*                                        PI-GROUPED
 10163*                                        GROUPEDI
 10164*            MOVE AL-UANON           TO  GROUPEDA
 10165*            GO TO 1050-EDIT-CHECK-NO
 10166*        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL156.cbl
 10167*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10168*            IF WS-GROUP-1 = 'C'
 10169*                NEXT SENTENCE
 10170*            ELSE
 10171*                MOVE 'N'            TO  WS-GROUPED
 10172*                                        PI-GROUPED
 10173*                                        GROUPEDI
 10174*                MOVE AL-UANON       TO  GROUPEDA
 10175*                GO TO 1050-EDIT-CHECK-NO.
 10176
 10177*     IF PI-GROUPED = 'Y'
 10178*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10179*           NEXT SENTENCE
 10180*        ELSE
 10181*           MOVE ER-0437        TO EMI-ERROR
 10182*           MOVE -1             TO PAYEEL
 10183**02180            MOVE AL-UABON       TO PAYEEA
 10184*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10185*
 10186*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10187*        (PI-GROUPED    = ' ')
 10188*        NEXT SENTENCE
 10189*     ELSE
 10190*
 10191     GO TO 1050-EDIT-CHECK-NO.
 10192*     IF PI-COMPANY-ID = 'CRI'
 10193*        MOVE 'N'           TO GROUPEDI
 10194*                              PI-GROUPED
 10195*                              WS-GROUPED
 10196*        MOVE AL-UANON      TO GROUPEDA.
 10197*
 10198*     IF PI-COMPANY-ID = 'CRI'
 10199*        IF PI-PAYEE-TYPE = 'B'
 10200*           IF BENE-FOUND-SW = 'Y'
 10201*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10202*                 MOVE 'Y'           TO GROUPEDI
 10203*                                       PI-GROUPED
 10204*                                       WS-GROUPED
 10205*                 MOVE AL-UANON      TO GROUPEDA
 10206*              ELSE
 10207*                 NEXT SENTENCE
 10208*           ELSE
 10209*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10210*              IF BENE-FOUND-SW = 'Y'
 10211*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10212*                    MOVE 'Y'      TO GROUPEDI
 10213*                                     PI-GROUPED
 10214*                                     WS-GROUPED
 10215*                    MOVE AL-UANON TO GROUPEDA.
 10216*
 10217
 10218     IF PI-COMPANY-ID NOT = 'CRI'
 10219        GO TO 1050-EDIT-CHECK-NO.
 10220
 10221*************** CRI CODE START ******************
 10222     IF PI-PAYEE-TYPE NOT = 'A'
 10223        GO TO 1050-EDIT-CHECK-NO.
 10224
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL156.cbl
 10225     MOVE LOW-VALUES             TO ERACCT-KEY.
 10226     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10227     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10228     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10229     MOVE PI-STATE               TO ACCT-STATE.
 10230     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10231     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10232     MOVE 'ACCT'                 TO FILE-SWITCH.
 10233
 10234     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10235     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10236
 10237
 10238* EXEC CICS HANDLE CONDITION
 10239*         NOTFND   (1950-NOT-FOUND)
 10240*         ENDFILE  (1950-NOT-FOUND)
 10241*    END-EXEC.
 10242*    MOVE '"$I''                  ! ( #00009866' TO DFHEIV0
 10243     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10245     MOVE X'2820233030303039383636' TO DFHEIV0(25:11)
 10246     CALL 'kxdfhei1' USING DFHEIV0
 10247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10248
 10249
 10250
 10251* EXEC CICS STARTBR
 10252*         DATASET   ('ERACCT')
 10253*         RIDFLD    (ERACCT-KEY)
 10254*         GTEQ
 10255*    END-EXEC.
 10256     MOVE 'ERACCT' TO DFHEIV1
 10257     MOVE 0
 10258       TO DFHEIV11
 10259*    MOVE '&,         G          &   #00009871' TO DFHEIV0
 10260     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10261     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10262     MOVE X'2020233030303039383731' TO DFHEIV0(25:11)
 10263     CALL 'kxdfhei1' USING DFHEIV0,
 10264           DFHEIV1,
 10265           ERACCT-KEY,
 10266           DFHEIV99,
 10267           DFHEIV11,
 10268           DFHEIV99
 10269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10270
 10271
 10272 1046-READNEXT-ERACCT.
 10273
 10274
 10275* EXEC CICS READNEXT
 10276*         DATASET   ('ERACCT')
 10277*         RIDFLD    (ERACCT-KEY)
 10278*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10279*    END-EXEC.
 10280     MOVE 'ERACCT' TO DFHEIV1
 10281     MOVE 0
 10282       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL156.cbl
 10283*    MOVE '&.S                   )   #00009879' TO DFHEIV0
 10284     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10285     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10286     MOVE X'2020233030303039383739' TO DFHEIV0(25:11)
 10287     CALL 'kxdfhei1' USING DFHEIV0,
 10288           DFHEIV1,
 10289           DFHEIV20,
 10290           DFHEIV99,
 10291           ERACCT-KEY,
 10292           DFHEIV99,
 10293           DFHEIV11,
 10294           DFHEIV99,
 10295           DFHEIV99
 10296     SET ADDRESS OF ACCOUNT-MASTER TO
 10297         DFHEIV20
 10298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10299
 10300
 10301     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10302        IF WS-ERACCT-HOLD-RECORD = SPACES
 10303           GO TO 1950-NOT-FOUND
 10304        ELSE
 10305           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10306           GO TO 1048-CONTINUE.
 10307
 10308     IF ACCT-EXP-DT = HIGH-VALUES
 10309        NEXT SENTENCE
 10310     ELSE
 10311        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10312        GO TO 1046-READNEXT-ERACCT.
 10313
 10314 1048-CONTINUE.
 10315
 10316*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10317*       MOVE 'Y'                 TO GROUPEDI
 10318*                                   PI-GROUPED
 10319*                                   WS-GROUPED
 10320*       MOVE AL-UANON            TO GROUPEDA.
 10321*************** CRI CODE END ******************
 10322
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL156.cbl
 10324 1050-EDIT-CHECK-NO.
 10325
 10326     IF PI-OFFLINE = 'Y'
 10327         IF PI-ECHECKNO = SPACES
 10328              MOVE ER-0439        TO EMI-ERROR
 10329              GO TO 1090-CHECK-NO-ERROR
 10330           ELSE
 10331*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10332*           IF PI-ECHECKNO-N = 'N' AND
 10333*              PI-CASH       = 'Y'
 10334*                MOVE ER-3535        TO EMI-ERROR
 10335*                GO TO 1090-CHECK-NO-ERROR
 10336*             ELSE
 10337*                MOVE AL-UANON    TO CHECKNOA
 10338*                GO TO 1100-EDIT-HOLDTIL
 10339*         ELSE
 10340            MOVE AL-UANON    TO CHECKNOA
 10341            GO TO 1100-EDIT-HOLDTIL.
 10342
 10343     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10344     MOVE '6'                    TO CNTL-REC-TYPE.
 10345
 10346     IF CONTROL-IS-ACTUAL-CARRIER
 10347         MOVE PI-CARRIER         TO WS-CARR
 10348     ELSE
 10349         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10350
 10351     IF PI-COMPANY-ID = 'FIA'
 10352         MOVE PI-CARRIER         TO WS-CARR.
 10353
 10354     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10355     MOVE 0                      TO CNTL-SEQ-NO.
 10356     MOVE 'CARR'                 TO FILE-SWITCH.
 10357
 10358     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10359
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL156.cbl
 10361     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10362         GO TO 1051-EDIT-CHECKNO-CONT.
 10363
 10364**********************AIG LOGIC STARTS**********************
 10365     IF PI-ECHECKNO = SPACES
 10366         IF CHECK-NO-MANUAL
 10367             MOVE ER-0441        TO EMI-ERROR
 10368             GO TO 1090-CHECK-NO-ERROR
 10369         ELSE
 10370             MOVE AL-UANOF       TO CHECKNOA
 10371             GO TO 1100-EDIT-HOLDTIL.
 10372
 10373     IF PI-ECHECKNO NOT = SPACES
 10374         IF CHECK-NO-MANUAL
 10375             MOVE AL-UANON       TO CHECKNOA
 10376             GO TO 1100-EDIT-HOLDTIL.
 10377
 10378     IF PI-ECHECKNO-CR = 'CR'
 10379        IF PI-OFFLINE = 'Y'
 10380            MOVE AL-UANON       TO CHECKNOA
 10381            GO TO 1100-EDIT-HOLDTIL
 10382        ELSE
 10383            MOVE ER-3534        TO EMI-ERROR
 10384            GO TO 1090-CHECK-NO-ERROR.
 10385
 10386     IF PI-ECHECKNO-N = 'N'
 10387        IF PI-CASH = 'N'
 10388            MOVE AL-UANON       TO CHECKNOA
 10389            GO TO 1100-EDIT-HOLDTIL
 10390        ELSE
 10391            MOVE ER-3535          TO EMI-ERROR
 10392            GO TO 1090-CHECK-NO-ERROR.
 10393
 10394     MOVE ER-0442        TO EMI-ERROR
 10395     GO TO 1090-CHECK-NO-ERROR.
 10396**********************AIG LOGIC ENDS************************
 10397
 10398 1051-EDIT-CHECKNO-CONT.
 10399
 10400     IF PI-COMPANY-ID = 'DMD'
 10401        IF PI-ECHECKNO NOT = SPACES
 10402           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10403              MOVE ER-0442        TO EMI-ERROR
 10404              GO TO 1090-CHECK-NO-ERROR
 10405            ELSE
 10406              GO TO 1100-EDIT-HOLDTIL
 10407          ELSE
 10408           GO TO 1100-EDIT-HOLDTIL.
 10409
 10410     IF PI-ECHECKNO = SPACES
 10411         IF CHECK-NO-MANUAL
 10412             MOVE ER-0441        TO EMI-ERROR
 10413             GO TO 1090-CHECK-NO-ERROR
 10414         ELSE
 10415             MOVE AL-UANOF       TO CHECKNOA
 10416             GO TO 1100-EDIT-HOLDTIL
 10417     ELSE
 10418         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL156.cbl
 10419             MOVE AL-UANON       TO CHECKNOA
 10420             GO TO 1100-EDIT-HOLDTIL
 10421         ELSE
 10422             MOVE ER-0442        TO EMI-ERROR
 10423             GO TO 1090-CHECK-NO-ERROR.
 10424
 10425 1090-CHECK-NO-ERROR.
 10426     MOVE -1                     TO CHECKNOL.
 10427     MOVE AL-UABON               TO CHECKNOA.
 10428     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10429
 10430     GO TO 2000-EDIT-DONE.
 10431
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL156.cbl
 10433 1100-EDIT-HOLDTIL.
 10434     MOVE AL-UANON               TO HOLDTILA.
 10435
 10436     IF PI-HOLDTIL = ZEROS
 10437        IF PI-OFFLINE = 'Y'
 10438           MOVE ER-0572          TO EMI-ERROR
 10439           GO TO 1105-HOLDTIL-ERROR
 10440        ELSE
 10441           GO TO 1110-EDIT-PAID-FROM.
 10442
 10443     MOVE '4'                    TO DC-OPTION-CODE.
 10444     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10445     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10446
 10447     IF DATE-CONVERSION-ERROR
 10448         MOVE ER-0446            TO EMI-ERROR
 10449         GO TO 1105-HOLDTIL-ERROR
 10450     END-IF
 10451     IF PI-OFFLINE = 'Y'
 10452        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10453           MOVE ER-0446            TO EMI-ERROR
 10454           GO TO 1105-HOLDTIL-ERROR
 10455        END-IF
 10456     END-IF
 10457
 10458     IF PI-OFFLINE = 'Y'
 10459        GO TO 1110-EDIT-PAID-FROM.
 10460
 10461     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10462     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10463     MOVE '1'                    TO DC-OPTION-CODE.
 10464     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10465
 10466     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10467         MOVE ER-0447            TO EMI-ERROR
 10468         GO TO 1105-HOLDTIL-ERROR.
 10469
 10470     GO TO 1110-EDIT-PAID-FROM.
 10471
 10472 1105-HOLDTIL-ERROR.
 10473     MOVE -1                     TO HOLDTILL.
 10474     MOVE AL-UNBON               TO HOLDTILA.
 10475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10476
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL156.cbl
 10478 1110-EDIT-PAID-FROM.
 10479     MOVE AL-UANON               TO EPYFROMA.
 10480
 10481     IF PI-EPYFROM = ZEROS
 10482         GO TO 1120-CALCULATE-PAID-FROM.
 10483
 10484     IF PI-PMTTYPE = '5' OR '6'
 10485         MOVE ER-0448            TO EMI-ERROR
 10486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10487         MOVE AL-UNBON           TO EPYFROMA
 10488         MOVE -1                 TO EPYFROML
 10489         GO TO 1150-EDIT-PAID-THRU.
 10490
 10491     MOVE '4'                    TO DC-OPTION-CODE.
 10492     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10493     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10494
 10495     IF DATE-CONVERSION-ERROR
 10496         MOVE ER-0449            TO EMI-ERROR
 10497         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10498         MOVE AL-UNBON           TO EPYFROMA
 10499         MOVE -1                 TO EPYFROML
 10500     ELSE
 10501         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10502
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL156.cbl
 10504 1120-CALCULATE-PAID-FROM.
 10505     IF PI-PMTTYPE = '5' OR '6'
 10506         GO TO 1150-EDIT-PAID-THRU.
 10507
 10508*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10509*       IF PI-PMTTYPE = '4'
 10510*         GO TO 1150-EDIT-PAID-THRU.
 10511
 10512     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10513         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10514         MOVE ' '                TO DC-OPTION-CODE
 10515         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10516         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10517         GO TO 1145-TEST-PAID-FROM.
 10518
 10519     IF PI-PMTTYPE = '4'
 10520        GO TO 1150-EDIT-PAID-THRU.
 10521
 10522     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10523     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10524     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10525     MOVE '5'                    TO CNTL-REC-TYPE.
 10526     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10527     MOVE 'BENE'                 TO FILE-SWITCH.
 10528
 10529     IF WS-BEN-CD = ZEROS
 10530         GO TO 1950-NOT-FOUND.
 10531
 10532     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10533
 10534     IF NO-BENEFIT-FOUND
 10535         GO TO 1950-NOT-FOUND.
 10536
 10537     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10538     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10539
 10540     IF PI-BEN-DAYS NOT NUMERIC
 10541        MOVE ZEROS               TO PI-BEN-DAYS.
 10542
 10543     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10544
 10545     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10546        (CL-TOTAL-PAID-AMT > ZEROS)
 10547         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10548         MOVE '6'                 TO DC-OPTION-CODE
 10549         MOVE +0                  TO DC-ELAPSED-MONTHS
 10550         MOVE +1                  TO DC-ELAPSED-DAYS
 10551         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10552         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10553         GO TO 1145-TEST-PAID-FROM.
 10554
 10555******************************************************************
 10556****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10557****** SPECIAL ENTERED DATE.
 10558******************************************************************
 10559
 10560     IF PI-AIGFROM = ZEROS
 10561         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL156.cbl
 10562
 10563     MOVE AL-UANON TO AIGFROMA.
 10564
 10565     MOVE '4'                    TO DC-OPTION-CODE.
 10566     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10567     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10568
 10569     IF DATE-CONVERSION-ERROR
 10570         MOVE ER-0449            TO EMI-ERROR
 10571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10572         MOVE AL-UNBON           TO AIGFROMA
 10573         MOVE -1                 TO AIGFROML
 10574         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10575     ELSE
 10576         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10577         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10578
 10579     GO TO 1140-CONTINUE-PAID-FROM.
 10580
 10581 1130-CONTINUE-PAID-FROM.
 10582
 10583     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10584        (CL-TOTAL-PAID-AMT = ZEROS)
 10585           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10586
 10587 1140-CONTINUE-PAID-FROM.
 10588
 10589     IF PI-BEN-TYPE = 'R'
 10590         IF PI-BEN-DAYS = ZEROS
 10591             NEXT SENTENCE
 10592         ELSE
 10593         IF PI-COMPANY-ID NOT = 'DMD'
 10594             SUBTRACT 1 FROM PI-BEN-DAYS.
 10595
 10596     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10597
 10598     IF PI-COMPANY-ID = 'DMD'
 10599         MOVE -1                 TO DC-ELAPSED-DAYS
 10600         MOVE +0                 TO DC-ELAPSED-MONTHS
 10601         MOVE '6'                TO DC-OPTION-CODE
 10602         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10603         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10604         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10605                               REMAINDER DC-ELAPSED-DAYS
 10606      ELSE
 10607         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10608         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10609
 10610     MOVE '6'                    TO DC-OPTION-CODE.
 10611     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10612     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10613
 10614     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10615
 10616     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10617         MOVE ER-0541            TO EMI-ERROR
 10618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10619         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL156.cbl
 10620         MOVE AL-UNBON           TO EPYFROMA.
 10621
 10622     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10623        (PI-BENEFIT-SAVE = '60E')
 10624        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10625           (CL-TOTAL-PAID-AMT = ZEROS)
 10626             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10627             MOVE 30                  TO DC-ELAPSED-DAYS
 10628             MOVE +0                  TO DC-ELAPSED-MONTHS
 10629             MOVE '6'                 TO DC-OPTION-CODE
 10630             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10631
 10632     IF PI-BEN-TYPE = 'R'
 10633         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10634     ELSE
 10635         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10636         IF WS-SV-EPYFROM = LOW-VALUES
 10637            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10638
 10639     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10640         IF WS-USE-AIG-PAYFROM   OR
 10641            WS-AIG-RECALC-PAYFROM
 10642              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10643                                      DC-BIN-DATE-1
 10644              MOVE ' '            TO  DC-OPTION-CODE
 10645              MOVE +0             TO  DC-ELAPSED-MONTHS
 10646                                      DC-ELAPSED-DAYS
 10647              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10648              IF NO-CONVERSION-ERROR
 10649                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10650
 10651     IF PI-CPYFROM < CL-INCURRED-DT
 10652        MOVE -1                  TO EPYFROML
 10653        MOVE ER-3542             TO EMI-ERROR
 10654        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10655
 10656     IF CM-ENTRY-DT < CL-INCURRED-DT
 10657        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10658        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10659        MOVE +0                     TO DC-ELAPSED-DAYS
 10660        MOVE +0                     TO DC-ELAPSED-MONTHS
 10661        MOVE '1'                    TO DC-OPTION-CODE
 10662        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10663        ELSE
 10664        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10665
 10666     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10667         NEXT SENTENCE
 10668     ELSE
 10669         IF DC-ELAPSED-MONTHS < 2
 10670             MOVE ER-3255        TO EMI-ERROR
 10671             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10672
 10673 1145-TEST-PAID-FROM.
 10674     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10675         GO TO 1150-EDIT-PAID-THRU.
 10676
 10677     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL156.cbl
 10678         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10679         MOVE ' '                TO DC-OPTION-CODE
 10680         MOVE +0                 TO DC-ELAPSED-MONTHS
 10681                                    DC-ELAPSED-DAYS
 10682         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10683         IF NO-CONVERSION-ERROR
 10684             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10685         ELSE
 10686             MOVE SPACES             TO EMI-DATE-FIELD.
 10687
 10688     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10689         IF CL-TOTAL-PAID-AMT = ZEROS
 10690             MOVE ER-3543            TO EMI-ERROR
 10691             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10692             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10693             IF EMI-MESSAGE-FORMATTED
 10694                MOVE -1             TO EPYFROML
 10695                MOVE AL-UNBON       TO EPYFROMA
 10696             ELSE
 10697                NEXT SENTENCE
 10698         ELSE
 10699             MOVE ER-0452            TO EMI-ERROR
 10700             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10701             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10702             IF EMI-MESSAGE-FORMATTED
 10703                MOVE -1             TO EPYFROML
 10704                MOVE AL-UNBON       TO EPYFROMA.
 10705
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL156.cbl
 10707 1150-EDIT-PAID-THRU.
 10708
 10709     MOVE AL-UANON               TO EPYTHRUA.
 10710
 10711     IF PI-EPYTHRU = ZEROS
 10712         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10713             GO TO 1200-EDIT-FIND-TOLERANCES
 10714         ELSE
 10715            IF (PI-PMTTYPE = '3') OR
 10716               (PI-PMTTYPE = '2' AND
 10717                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10718               GO TO 1152-CHECK-TYPE
 10719            ELSE
 10720               MOVE ER-0473      TO EMI-ERROR
 10721               GO TO 1170-PAID-THRU-FATAL-ERROR
 10722     ELSE
 10723         IF PI-PMTTYPE = '5' OR '6'
 10724             MOVE ER-0474        TO EMI-ERROR
 10725             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10726
 10727     MOVE '4'                    TO DC-OPTION-CODE.
 10728     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10729     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10730
 10731     IF DATE-CONVERSION-ERROR
 10732         MOVE ER-0475            TO EMI-ERROR
 10733         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10734
 10735     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10736
 10737     IF PI-COMPANY-ID = 'DMD'
 10738         IF PI-PMTTYPE NOT = '2'
 10739                 AND
 10740            WS-EXP-DT > WS-SV-EPYTHRU
 10741             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10742             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10743             MOVE '1'              TO DC-OPTION-CODE
 10744             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10745             IF DATE-CONVERSION-ERROR
 10746                 MOVE ER-0944      TO EMI-ERROR
 10747                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10748             ELSE
 10749                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10750                    DC-ELAPSED-DAYS   = 1
 10751                     MOVE ER-0945  TO EMI-ERROR
 10752                     MOVE -1       TO EPYTHRUL
 10753                     MOVE AL-UABON TO EPYTHRUA
 10754                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10755
 10756     IF PI-PMTTYPE = '4'
 10757         NEXT SENTENCE
 10758     ELSE
 10759         IF WS-SV-EPYTHRU = WS-EXP-DT
 10760             IF PI-PMTTYPE NOT = '2' AND '3'
 10761                 MOVE ER-3541    TO EMI-ERROR
 10762                 MOVE -1         TO PMTTYPEL
 10763                 MOVE AL-UABON   TO PMTTYPEA
 10764                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL156.cbl
 10765
 10766     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10767         MOVE ER-0501            TO EMI-ERROR
 10768         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10769
 10770     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10771        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10772*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10773*              MOVE ER-0540         TO EMI-ERROR
 10774*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10775*              MOVE -1              TO EPYTHRUL
 10776*              MOVE AL-UNBON        TO EPYTHRUA
 10777*          ELSE
 10778*          IF PI-COMPANY-ID = 'DMD'
 10779*              MOVE ER-7540         TO EMI-ERROR
 10780*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10781*              MOVE -1              TO EPYTHRUL
 10782*              MOVE AL-UNBON        TO EPYTHRUA
 10783*          ELSE
 10784               IF PI-PMTTYPE NOT = '2' AND '3'
 10785                  IF PI-COMPANY-ID = '???'
 10786                      MOVE ER-7540  TO EMI-ERROR
 10787                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10788                      MOVE -1       TO EPYTHRUL
 10789                      MOVE AL-UNBON TO EPYTHRUA
 10790                  ELSE
 10791                      MOVE ER-0540  TO EMI-ERROR
 10792                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10793                      MOVE -1       TO EPYTHRUL
 10794                      MOVE AL-UNBON TO EPYTHRUA.
 10795
 10796     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10797            OR
 10798        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10799         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10800            OR
 10801        (PI-CPYFROM NOT = LOW-VALUES AND
 10802         PI-CPYFROM < CL-PAID-THRU-DT)
 10803        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10804
 10805 1152-CHECK-TYPE.
 10806     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10807        OR (PI-PMTTYPE = '5' OR '6')
 10808         GO TO 1160-EDIT-PAID-THRU-AH.
 10809
 10810 1155-EDIT-PAID-THRU-LIFE.
 10811     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10812     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10813     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10814     MOVE '4'                    TO CNTL-REC-TYPE.
 10815     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10816     MOVE 'BENE'                 TO FILE-SWITCH.
 10817
 10818     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10819
 10820     IF NO-BENEFIT-FOUND
 10821         GO TO 1950-NOT-FOUND.
 10822
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL156.cbl
 10823     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10824
 10825     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10826
 10827     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10828        PI-LF-COVERAGE-TYPE = 'P'
 10829         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10830         GO TO 1200-EDIT-FIND-TOLERANCES.
 10831
 10832     IF PI-EPYTHRU = ZEROS
 10833        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10834
 10835     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10836         MOVE ER-0476            TO EMI-ERROR
 10837         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10838
 10839     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10840*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10841     move cl-critical-period    to dc-elapsed-months
 10842     MOVE +0                    TO DC-ELAPSED-DAYS.
 10843     MOVE '6'                   TO DC-OPTION-CODE.
 10844     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10845
 10846     IF (NO-CONVERSION-ERROR AND
 10847         WS-SPECIAL-CALC-CD = 'C')
 10848        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10849            MOVE ER-0657 TO EMI-ERROR
 10850            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10851
 10852     IF PI-COMPANY-ID = 'NCL'
 10853         IF WS-SPECIAL-CALC-CD = 'C' AND
 10854            cl-critical-period = zeros
 10855*           CM-LF-CRITICAL-PERIOD = +0
 10856             MOVE ER-0844       TO EMI-ERROR
 10857             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10858
 10859     GO TO 1200-EDIT-FIND-TOLERANCES.
 10860
 10861 1160-EDIT-PAID-THRU-AH.
 10862     IF PI-EPYTHRU = ZEROS
 10863        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10864                                    WS-SV-EPYTHRU
 10865     ELSE
 10866        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10867
 10868     IF WS-SV-EPYTHRU < PI-CPYFROM
 10869         MOVE ER-0508            TO EMI-ERROR
 10870         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10871
 10872     perform 7975-read-acct      thru 7975-exit
 10873     move zeros                  to pi-max-ext
 10874     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10875        PERFORM 0900-GET-DDF-LIMITS
 10876                                 THRU 0900-EXIT
 10877        IF PDEF-FOUND
 10878           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10879              (P1 > +8)
 10880              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL156.cbl
 10881           END-PERFORM
 10882           IF P1 < +9
 10883              MOVE PD-MAX-extension (P1)
 10884                                 TO pi-max-ext
 10885           else
 10886              move er-1674       to emi-error
 10887              PERFORM 9900-ERROR-FORMAT
 10888                                 THRU 9900-EXIT
 10889           END-IF
 10890        else
 10891           move er-1672          to emi-error
 10892           PERFORM 9900-ERROR-FORMAT
 10893                                 THRU 9900-EXIT
 10894        END-IF
 10895     end-if
 10896     move spaces                 to pi-max-ext-used
 10897     IF PI-PMTTYPE = '3'
 10898        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10899        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10900           MOVE ER-0477          TO EMI-ERROR
 10901           PERFORM 1165-PAID-THRU-ERROR
 10902                                 THRU 1165-EXIT
 10903        ELSE
 10904           continue
 10905        end-if
 10906     ELSE
 10907        IF WS-SV-EPYTHRU > WS-EXP-DT
 10908           move ws-exp-dt        to dc-bin-date-1
 10909           move ws-sv-epythru    to dc-bin-date-2
 10910           MOVE '1'              TO DC-OPTION-CODE
 10911           MOVE +0               TO DC-ELAPSED-DAYS
 10912                                    DC-ELAPSED-MONTHS
 10913           PERFORM 9700-LINK-DATE-CONVERT
 10914                                 THRU 9700-EXIT
 10915           if no-conversion-error
 10916              if dc-elapsed-days > zeros
 10917                 add +1 to dc-elapsed-months
 10918              end-if
 10919              if dc-elapsed-months > pi-max-ext
 10920                 MOVE ER-0557    TO EMI-ERROR
 10921                 PERFORM 1165-PAID-THRU-ERROR
 10922                                 THRU 1165-EXIT
 10923              else
 10924                 move 'Y'        to pi-max-ext-used
 10925                 move er-1670    to emi-error
 10926                 perform 9900-error-format
 10927                                 thru 9900-exit
 10928              end-if
 10929           end-if
 10930        end-if
 10931     end-if
 10932
 10933     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10934         PI-PMTTYPE NOT = '3'
 10935         MOVE ER-0541        TO EMI-ERROR
 10936         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10937
 10938     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL156.cbl
 10939        (PI-PMTTYPE NOT = '3')
 10940         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10941             MOVE ER-0478        TO EMI-ERROR
 10942             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10943
 10944     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10945        (PI-PMTTYPE NOT = '4')
 10946         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10947             MOVE ER-0479        TO EMI-ERROR
 10948             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10949
 10950     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10951         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10952             MOVE ER-0545        TO EMI-ERROR
 10953             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10954
 10955     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10956         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10957             MOVE ER-0481        TO EMI-ERROR
 10958             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10959
 10960*    IF PI-COMPANY-ID = 'NCL'
 10961*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10962*           CM-AH-CRITICAL-PERIOD = +0
 10963*            MOVE ER-0844        TO  EMI-ERROR
 10964*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10965
 10966*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10967     if (cl-critical-period = zeros)
 10968        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10969          GO TO 1200-EDIT-FIND-TOLERANCES.
 10970
 10971     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10972     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10973     MOVE '1'        TO DC-OPTION-CODE.
 10974     MOVE +0         TO DC-ELAPSED-DAYS
 10975                        DC-ELAPSED-MONTHS.
 10976     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10977
 10978*    IF NO-CONVERSION-ERROR
 10979*       COMPUTE ws-benefits-paid =
 10980*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10981*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 10982*           MOVE ER-0657 TO EMI-ERROR
 10983*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10984
 10985     GO TO 1200-EDIT-FIND-TOLERANCES.
 10986
 10987 1165-PAID-THRU-ERROR.
 10988     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10989
 10990     IF EMI-MESSAGE-FORMATTED
 10991         MOVE -1                 TO EPYTHRUL
 10992         MOVE AL-UNBON           TO EPYTHRUA.
 10993
 10994 1165-EXIT.
 10995     EXIT.
 10996
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL156.cbl
 10997 1166-CHECK-ALL-TRLRS.
 10998
 10999     IF PI-PMTTYPE = '4'
 11000        GO TO 1166-TRLR-EXIT.
 11001
 11002     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11003
 11004     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11005        WS-SV-EPYFROM = LOW-VALUES
 11006          GO TO 1166-END-CHECK.
 11007
 11008
 11009* EXEC CICS HANDLE CONDITION
 11010*        ENDFILE   (1166-END-CHECK)
 11011*        NOTFND    (1166-END-CHECK)
 11012*    END-EXEC.
 11013*    MOVE '"$''I                  ! ) #00010592' TO DFHEIV0
 11014     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11015     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11016     MOVE X'2920233030303130353932' TO DFHEIV0(25:11)
 11017     CALL 'kxdfhei1' USING DFHEIV0
 11018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11019
 11020
 11021     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11022     MOVE +100                   TO TRLR-SEQ-NO.
 11023
 11024
 11025* EXEC CICS STARTBR
 11026*         DATASET    ('ELTRLR')
 11027*         RIDFLD     (ELTRLR-KEY)
 11028*         GTEQ
 11029*    END-EXEC.
 11030     MOVE 'ELTRLR' TO DFHEIV1
 11031     MOVE 0
 11032       TO DFHEIV11
 11033*    MOVE '&,         G          &   #00010600' TO DFHEIV0
 11034     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11035     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11036     MOVE X'2020233030303130363030' TO DFHEIV0(25:11)
 11037     CALL 'kxdfhei1' USING DFHEIV0,
 11038           DFHEIV1,
 11039           ELTRLR-KEY,
 11040           DFHEIV99,
 11041           DFHEIV11,
 11042           DFHEIV99
 11043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11044
 11045
 11046     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11047
 11048 1166-READ-TRLR-NEXT.
 11049
 11050
 11051* EXEC CICS READNEXT
 11052*         DATASET    ('ELTRLR')
 11053*         RIDFLD     (ELTRLR-KEY)
 11054*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL156.cbl
 11055*    END-EXEC.
 11056     MOVE 'ELTRLR' TO DFHEIV1
 11057     MOVE 0
 11058       TO DFHEIV11
 11059*    MOVE '&.S                   )   #00010610' TO DFHEIV0
 11060     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11061     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11062     MOVE X'2020233030303130363130' TO DFHEIV0(25:11)
 11063     CALL 'kxdfhei1' USING DFHEIV0,
 11064           DFHEIV1,
 11065           DFHEIV20,
 11066           DFHEIV99,
 11067           ELTRLR-KEY,
 11068           DFHEIV99,
 11069           DFHEIV11,
 11070           DFHEIV99,
 11071           DFHEIV99
 11072     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11073         DFHEIV20
 11074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11075
 11076
 11077     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11078        TRLR-CARRIER  = MSTR-CARRIER  AND
 11079        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11080        TRLR-CERT-NO  = MSTR-CERT-NO
 11081          NEXT SENTENCE
 11082      ELSE
 11083          GO TO 1166-END-CHECK.
 11084
 11085* **  BYPASS ALL NON-PAYMENT TRAILERS
 11086
 11087     IF AT-TRAILER-TYPE = '2'
 11088        NEXT SENTENCE
 11089     ELSE
 11090        GO TO 1166-READ-TRLR-NEXT.
 11091
 11092* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11093
 11094     IF AT-PAYMENT-TYPE = '1' OR '2'
 11095        NEXT SENTENCE
 11096     ELSE
 11097        GO TO 1166-READ-TRLR-NEXT.
 11098
 11099* **  BYPASS ALL VOID PAYMENTS
 11100
 11101     IF AT-VOID-DT NOT = LOW-VALUES
 11102        GO TO 1166-READ-TRLR-NEXT.
 11103
 11104     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11105        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11106          GO TO 1166-READ-TRLR-NEXT.
 11107
 11108     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11109         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11110            OR
 11111        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11112         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL156.cbl
 11113        NEXT SENTENCE
 11114     ELSE
 11115         IF CL-TOTAL-PAID-AMT > ZEROS
 11116             MOVE ER-0502            TO EMI-ERROR
 11117             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11118             MOVE -1                 TO EPYTHRUL
 11119             MOVE AL-UNBON           TO EPYTHRUA.
 11120
 11121     GO TO 1166-READ-TRLR-NEXT.
 11122
 11123 1166-END-CHECK.
 11124
 11125     IF WS-BROWSE-TRLR-SW = 'Y'
 11126
 11127* EXEC CICS ENDBR
 11128*            DATASET   ('ELTRLR')
 11129*       END-EXEC.
 11130     MOVE 'ELTRLR' TO DFHEIV1
 11131     MOVE 0
 11132       TO DFHEIV11
 11133*    MOVE '&2                    $   #00010665' TO DFHEIV0
 11134     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11135     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11136     MOVE X'2020233030303130363635' TO DFHEIV0(25:11)
 11137     CALL 'kxdfhei1' USING DFHEIV0,
 11138           DFHEIV1,
 11139           DFHEIV11,
 11140           DFHEIV99
 11141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11142
 11143
 11144     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11145
 11146 1166-TRLR-EXIT.
 11147     EXIT.
 11148
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL156.cbl
 11150 1170-PAID-THRU-FATAL-ERROR.
 11151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11152
 11153     MOVE -1                     TO EPYTHRUL.
 11154     MOVE AL-UNBON               TO EPYTHRUA.
 11155
 11156 1200-EDIT-FIND-TOLERANCES.
 11157
 11158* EXEC CICS HANDLE CONDITION
 11159*        ENDFILE(1950-NOT-FOUND)
 11160*        NOTFND (1950-NOT-FOUND)
 11161*    END-EXEC.
 11162*    MOVE '"$''I                  ! * #00010682' TO DFHEIV0
 11163     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11165     MOVE X'2A20233030303130363832' TO DFHEIV0(25:11)
 11166     CALL 'kxdfhei1' USING DFHEIV0
 11167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11168
 11169
 11170     IF PI-PROCESSOR-ID = 'LGXX'
 11171        GO TO 1240-FIND-ACCT-TOLERANCES.
 11172
 11173     MOVE 'N'                    TO FOUND-TOL-SW.
 11174     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11175     MOVE '2'                    TO CNTL-REC-TYPE.
 11176     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11177     MOVE +0                     TO CNTL-SEQ-NO.
 11178     MOVE 'PROC'                 TO FILE-SWITCH.
 11179
 11180     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11181
 11182     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11183     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11184                                    PI-MAX-PMT-TOL.
 11185     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11186
 11187     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11188         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11189
 11190     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11191     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11192                                    PI-MAX-LF-PMT-TOL.
 11193
 11194     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11195         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11196
 11197     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11198                                    PI-MAX-EXP-PMT.
 11199
 11200 1240-FIND-ACCT-TOLERANCES.
 11201
 11202     IF WS-PMT-TOL NOT = +0
 11203         MOVE 'Y'                TO FOUND-TOL-SW.
 11204
 11205     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11206         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11207         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 212
* EL156.cbl
 11208         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11209         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11210         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11211         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11212     ELSE
 11213         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11214         MOVE PI-CARRIER             TO ACCT-CARRIER
 11215         MOVE PI-GROUPING            TO ACCT-GROUPING
 11216         MOVE PI-STATE               TO ACCT-STATE
 11217         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11218         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11219
 11220     MOVE 'ACCT'                 TO FILE-SWITCH.
 11221
 11222     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11223     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11224
 11225
 11226* EXEC CICS HANDLE CONDITION
 11227*         NOTFND   (1950-NOT-FOUND)
 11228*         ENDFILE  (1950-NOT-FOUND)
 11229*    END-EXEC.
 11230*    MOVE '"$I''                  ! + #00010742' TO DFHEIV0
 11231     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11233     MOVE X'2B20233030303130373432' TO DFHEIV0(25:11)
 11234     CALL 'kxdfhei1' USING DFHEIV0
 11235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11236
 11237
 11238
 11239* EXEC CICS STARTBR
 11240*        DATASET('ERACCT')
 11241*        RIDFLD (ERACCT-KEY)
 11242*        GTEQ
 11243*    END-EXEC.
 11244     MOVE 'ERACCT' TO DFHEIV1
 11245     MOVE 0
 11246       TO DFHEIV11
 11247*    MOVE '&,         G          &   #00010747' TO DFHEIV0
 11248     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11249     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11250     MOVE X'2020233030303130373437' TO DFHEIV0(25:11)
 11251     CALL 'kxdfhei1' USING DFHEIV0,
 11252           DFHEIV1,
 11253           ERACCT-KEY,
 11254           DFHEIV99,
 11255           DFHEIV11,
 11256           DFHEIV99
 11257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11258
 11259
 11260 1245-FIND-ACCT-TOLERANCES-LOOP.
 11261
 11262
 11263* EXEC CICS READNEXT
 11264*        DATASET('ERACCT')
 11265*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 213
* EL156.cbl
 11266*        RIDFLD (ERACCT-KEY)
 11267*    END-EXEC.
 11268     MOVE 'ERACCT' TO DFHEIV1
 11269     MOVE 0
 11270       TO DFHEIV11
 11271*    MOVE '&.S                   )   #00010755' TO DFHEIV0
 11272     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11273     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11274     MOVE X'2020233030303130373535' TO DFHEIV0(25:11)
 11275     CALL 'kxdfhei1' USING DFHEIV0,
 11276           DFHEIV1,
 11277           DFHEIV20,
 11278           DFHEIV99,
 11279           ERACCT-KEY,
 11280           DFHEIV99,
 11281           DFHEIV11,
 11282           DFHEIV99,
 11283           DFHEIV99
 11284     SET ADDRESS OF ACCOUNT-MASTER TO
 11285         DFHEIV20
 11286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11287
 11288
 11289     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11290        IF WS-ERACCT-HOLD-RECORD = SPACES
 11291           GO TO 1950-NOT-FOUND
 11292        ELSE
 11293           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11294           GO TO 1250-CONTINUE.
 11295
 11296     IF ACCT-EXP-DT = HIGH-VALUES
 11297        NEXT SENTENCE
 11298     ELSE
 11299        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11300        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11301
 11302 1250-CONTINUE.
 11303
 11304     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11305
 11306     IF FOUND-TOL-SW = 'N'
 11307         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11308
 11309********* 1260-FIND-STATE-TOLERANCES.
 11310
 11311     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11312     MOVE PI-STATE               TO WS-ST-ACCESS.
 11313     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11314     MOVE '3'                    TO CNTL-REC-TYPE.
 11315     MOVE +0                     TO CNTL-SEQ-NO.
 11316     MOVE 'STAT'                 TO FILE-SWITCH.
 11317
 11318     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11319
 11320     IF WS-PMT-TOL = +0
 11321         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11322
 11323     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 214
* EL156.cbl
 11324     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11325     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11326     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11327     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11328
 11329****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11330****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11331     IF PI-PAYEE-TYPE <> 'B'
 11332           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11333     END-IF.
 11334
 11335     IF PI-PMTTYPE      = '2'  AND
 11336        PI-SPLIT-PMT-SW = 'Y'  AND
 11337        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11338          MOVE ER-3530                TO EMI-ERROR
 11339          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11340
 11341********* 1280-FIND-BENEFIT-TOLERANCES.
 11342
 11343     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11344        OR (PI-PMTTYPE = '5' OR '6')
 11345         GO TO 1300-FIND-CARR-TOLERANCES.
 11346
 11347     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11348     MOVE '4'                    TO CNTL-REC-TYPE.
 11349     MOVE +0                     TO CNTL-SEQ-NO.
 11350     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11351     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11352     MOVE 'BENE'                 TO FILE-SWITCH.
 11353
 11354     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11355
 11356     IF NO-BENEFIT-FOUND
 11357         GO TO 1950-NOT-FOUND.
 11358
 11359     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11360     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11361     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11362
 11363
 11364* EXEC CICS HANDLE CONDITION
 11365*        NOTFND(1950-NOT-FOUND)
 11366*    END-EXEC.
 11367*    MOVE '"$I                   ! , #00010835' TO DFHEIV0
 11368     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11370     MOVE X'2C20233030303130383335' TO DFHEIV0(25:11)
 11371     CALL 'kxdfhei1' USING DFHEIV0
 11372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11373
 11374
 11375 1300-FIND-CARR-TOLERANCES.
 11376     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11377     MOVE '6'                    TO CNTL-REC-TYPE.
 11378
 11379     IF CONTROL-IS-ACTUAL-CARRIER
 11380         MOVE PI-CARRIER               TO WS-CARR
 11381     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 215
* EL156.cbl
 11382         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11383
 11384     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11385     MOVE +0                     TO CNTL-SEQ-NO.
 11386     MOVE 'CARR'                 TO FILE-SWITCH.
 11387
 11388     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11389
 11390     IF WS-DAYS-TOL = +0
 11391         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11392
 11393     IF WS-PMT-TOL = +0
 11394         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11395
 11396     IF WS-MAX-DAYS-TOL = +0
 11397         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11398
 11399     IF WS-MAX-PMT-TOL = +0
 11400         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11401                                    PI-MAX-PMT-TOL.
 11402
 11403     IF WS-MAX-LF-PMT-TOL = +0
 11404        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11405                                    PI-MAX-LF-PMT-TOL.
 11406
 11407     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11408
 11409********* 1320-FIND-COMP-TOLERANCES.
 11410
 11411     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11412     MOVE '1'                    TO CNTL-REC-TYPE.
 11413     MOVE SPACES                 TO CNTL-ACCESS.
 11414     MOVE +0                     TO CNTL-SEQ-NO.
 11415     MOVE 'COMP'                 TO FILE-SWITCH.
 11416
 11417     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11418
 11419     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11420     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11421
 11422     IF WS-PMT-TOL NOT = +0
 11423        IF WS-TOL-SEVERITY NOT = ' '
 11424         GO TO 1360-EDIT-DAYS.
 11425
 11426     IF WS-PMT-TOL = +0
 11427         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11428
 11429     IF WS-TOL-SEVERITY = ' '
 11430         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11431
 11432 1360-EDIT-DAYS.
 11433     IF PI-PMTTYPE NOT = '4'
 11434        IF PI-EDAYS NEGATIVE OR
 11435           PI-EPYAMT NEGATIVE
 11436          MOVE ER-0513             TO EMI-ERROR
 11437          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11438          MOVE -1                  TO PMTTYPEL.
 11439
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 216
* EL156.cbl
 11440     IF PI-PMTTYPE = '5' OR '6'
 11441        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11442
 11443     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11444        IF PI-PMTTYPE = '4'
 11445          MOVE PI-EDAYS          TO PI-CDAYS.
 11446
 11447     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11448         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11449
 11450     IF PI-PMTTYPE = '4'
 11451        MOVE PI-EDAYS            TO PI-CDAYS
 11452        GO TO 1400-EDIT-PAYMENT.
 11453
 11454     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11455        GO TO 1500-EDIT-EXPENSES.
 11456
 11457*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11458*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11459*          CM-AH-BENEFIT-CD = '23'              AND
 11460*          CL-CERT-STATE    = '04'              AND
 11461*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11462*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11463*            GO TO 1362-CHECK-MAX-DAYS.
 11464
 11465     IF PI-EDAYS = ZEROS
 11466*        IF PI-COMPANY-ID = 'DMD'
 11467*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11468*            MOVE -1             TO DC-ELAPSED-DAYS
 11469*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11470*            MOVE '6'            TO DC-OPTION-CODE
 11471*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11472*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11473*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11474*            MOVE '1'            TO DC-OPTION-CODE
 11475*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11476*            IF NO-CONVERSION-ERROR
 11477*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11478*                                 + DC-ODD-DAYS-OVER
 11479*               MOVE 6           TO EDAYSL
 11480*               MOVE AL-UNNON    TO EDAYSA
 11481*            ELSE
 11482*                NEXT SENTENCE
 11483*       ELSE
 11484            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11485            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11486            MOVE '1'             TO DC-OPTION-CODE
 11487            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11488            IF NO-CONVERSION-ERROR
 11489                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11490                ADD 1                 TO PI-EDAYS
 11491                MOVE AL-UNNON         TO EDAYSA.
 11492
 11493*    IF PI-COMPANY-ID = 'DMD'
 11494*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11495*        MOVE -1                 TO DC-ELAPSED-DAYS
 11496*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11497*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 217
* EL156.cbl
 11498*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11499*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11500*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11501*        MOVE '1'                TO DC-OPTION-CODE
 11502*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11503*    ELSE
 11504         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11505         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11506         MOVE '1'                TO DC-OPTION-CODE.
 11507         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11508
 11509     IF NO-CONVERSION-ERROR
 11510        IF PI-COMPANY-ID = 'DMD'
 11511            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11512                             + DC-ODD-DAYS-OVER
 11513        ELSE
 11514            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11515            ADD 1                TO PI-CDAYS.
 11516
 11517     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11518        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11519        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11520
 11521     IF PI-EDAYS NOT NUMERIC
 11522         MOVE ER-0491            TO EMI-ERROR
 11523         GO TO 1370-DAYS-ERROR.
 11524
 11525     IF CL-NO-OF-PMTS-MADE = 0
 11526        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11527        AND CL-CERT-STATE = 'MI'
 11528        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11529            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11530     END-IF.
 11531
 11532 1362-CHECK-MAX-DAYS.
 11533
 11534     IF WS-MAX-DAYS-TOL = +999
 11535         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11536
 11537     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11538         IF PI-EDAYS = ZEROS
 11539             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11540         ELSE
 11541             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11542
 11543     IF WS-MAX-DAYS-TOL NOT = ZERO
 11544        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11545           PI-CDAYS > WS-MAX-DAYS-TOL
 11546             MOVE ER-0492          TO EMI-ERROR
 11547             GO TO 1370-DAYS-ERROR.
 11548
 11549 1365-SKIP-MAX-DAYS-EDIT.
 11550     IF PI-EDAYS = ZEROS
 11551        GO TO 1400-EDIT-PAYMENT.
 11552
 11553     IF WS-DAYS-TOL NOT = ZERO
 11554        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11555           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 218
* EL156.cbl
 11556                MOVE ER-0493     TO EMI-ERROR
 11557                GO TO 1370-DAYS-ERROR.
 11558
 11559     GO TO 1400-EDIT-PAYMENT.
 11560
 11561 1370-DAYS-ERROR.
 11562     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11563
 11564     IF EMI-MESSAGE-FORMATTED
 11565         MOVE -1                 TO EDAYSL
 11566         MOVE AL-UABON           TO EDAYSA.
 11567
 11568     GO TO 1400-EDIT-PAYMENT.
 11569
 11570 1380-EDIT-EXPENSE-PMT-AMT.
 11571     IF PI-PMTTYPE = '5' OR '6'
 11572         NEXT SENTENCE
 11573     ELSE
 11574         GO TO 1400-EDIT-PAYMENT.
 11575
 11576     IF WS-MAX-EXP-PMT NOT = ZEROS
 11577        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11578            MOVE ER-3529            TO EMI-ERROR
 11579            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11580
 11581     GO TO 1500-EDIT-EXPENSES.
 11582
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 219
* EL156.cbl
 11584
 11585 1390-CHECK-PAYMENT-DAYS.
 11586
 11587     IF PI-EDAYS = 0
 11588         MOVE PI-CDAYS TO WS-PD-DAYS
 11589     ELSE
 11590         MOVE PI-EDAYS TO WS-PD-DAYS
 11591     END-IF.
 11592
 11593     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11594         IF WS-PD-DAYS = 14
 11595            GO TO 1390-EXIT
 11596         END-IF
 11597     END-IF.
 11598
 11599     IF PI-COMPANY-ID = 'AHL'  AND
 11600        CM-AH-BENEFIT-CD = '1K'
 11601         IF WS-PD-DAYS = 14
 11602            GO TO 1390-EXIT
 11603         END-IF
 11604     END-IF.
 11605
 11606     IF WS-PD-DAYS < 30
 11607         MOVE ER-3549              TO EMI-ERROR
 11608         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11609     END-IF.
 11610
 11611 1390-EXIT.
 11612      EXIT.
 11613
 11614 1400-EDIT-PAYMENT.
 11615*    IF PI-COMPANY-ID = 'DMD'
 11616*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11617*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11618
 11619     IF PI-COMPANY-ID = 'DCC'
 11620        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11621        MOVE PI-CARRIER          TO ACCT-CARRIER
 11622        MOVE PI-GROUPING         TO ACCT-GROUPING
 11623        MOVE PI-STATE            TO ACCT-STATE
 11624        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11625        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11626        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11627        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11628
 11629
 11630* EXEC CICS READ
 11631*          DATASET ('ERACCT')
 11632*          RIDFLD  (ERACCT-KEY)
 11633*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11634*          GTEQ
 11635*          resp    (WS-RESPONSE)
 11636*       END-EXEC
 11637     MOVE 'ERACCT' TO DFHEIV1
 11638*    MOVE '&"S        G          (  N#00011093' TO DFHEIV0
 11639     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11641     MOVE X'204E233030303131303933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 220
* EL156.cbl
 11642     CALL 'kxdfhei1' USING DFHEIV0,
 11643           DFHEIV1,
 11644           DFHEIV20,
 11645           DFHEIV99,
 11646           ERACCT-KEY,
 11647           DFHEIV99,
 11648           DFHEIV99,
 11649           DFHEIV99
 11650     SET ADDRESS OF ACCOUNT-MASTER TO
 11651         DFHEIV20
 11652     MOVE EIBRESP  TO WS-RESPONSE
 11653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11654        IF WS-RESP-NORMAL
 11655           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11656           and pi-cert-eff-dt < am-expiration-dt
 11657           and pi-cert-eff-dt >= am-effective-dt
 11658           move am-dcc-product-code to pi-dcc-product-code
 11659        else
 11660           move spaces           to pi-dcc-product-code
 11661        end-if
 11662        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11663           PERFORM 0900-GET-DDF-LIMITS
 11664                                 THRU 0900-EXIT
 11665           IF PDEF-FOUND
 11666              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11667                 (P1 > +8)
 11668                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11669              END-PERFORM
 11670              IF P1 < +9
 11671                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11672                    MOVE PD-MAX-AMT (P1)
 11673                                 TO CM-AH-BENEFIT-AMT
 11674                 end-if
 11675              else
 11676                 move er-1674    to emi-error
 11677                 PERFORM 9900-ERROR-FORMAT
 11678                                 THRU 9900-EXIT
 11679              END-IF
 11680           else
 11681              move er-1672       to emi-error
 11682              PERFORM 9900-ERROR-FORMAT
 11683                                 THRU 9900-EXIT
 11684           END-IF
 11685        end-if
 11686     END-IF
 11687     IF PI-PMTTYPE NOT = '4'
 11688        GO TO 1405-CALC-PAYMENT.
 11689
 11690     IF PI-EDAYS NOT NUMERIC
 11691         MOVE PI-EPYAMT           TO PI-CPYAMT
 11692         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11693         GO TO 1430-CHECK-AH-TOLERANCE.
 11694
 11695*    IF PI-COMPANY-ID = 'FIA'
 11696*       IF CERT-ACCOUNT = '0000011043'
 11697*        COMPUTE PI-DAILY-RATE ROUNDED =
 11698*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11699*        COMPUTE PI-CPYAMT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 221
* EL156.cbl
 11700*                          PI-DAILY-RATE * PI-EDAYS
 11701*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11702*        GO TO 1430-CHECK-AH-TOLERANCE.
 11703
 11704     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11705         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11706         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11707         GO TO 1420-CHECK-AIG-BENEFIT.
 11708
 11709     IF WS-CALC-METHOD = '2' OR  '5'
 11710         COMPUTE PI-DAILY-RATE ROUNDED =
 11711                        (CM-AH-BENEFIT-AMT * 12) / 365
 11712         COMPUTE PI-CPYAMT ROUNDED =
 11713                           PI-DAILY-RATE * PI-EDAYS
 11714        GO TO 1420-CHECK-AIG-BENEFIT.
 11715
 11716     IF WS-CALC-METHOD = '3'
 11717         COMPUTE PI-DAILY-RATE =
 11718                         (CM-AH-BENEFIT-AMT * 12) / 365
 11719         COMPUTE PI-CPYAMT ROUNDED =
 11720                           PI-DAILY-RATE * PI-EDAYS
 11721        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 222
* EL156.cbl
 11723*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11724
 11725****************************************************************
 11726****************************************************************
 11727*                  CALCULATED FROM      PAYMENT      PAYMENT
 11728*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11729* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11730*1-01-83  1-15-83    0    15     15        15           15
 11731*1-01-83  1-30-83    0    30     30        30           30
 11732*1-01-83  1-31-83    1     0     31        30           30
 11733*1-01-83  2-01-83    1     1     32        31           31
 11734*1-01-83  2-15-83    1    15     46        45           45
 11735*1-01-83  2-28-83    2     0     59        60           60
 11736*1-01-83  3-01-83    2     1     60        61           61
 11737*1-01-83  3-31-83    3     0     90        90           90
 11738*1-15-83  1-31-83    0    17     17        17           16
 11739*1-15-83  2-01-83    0    18     18        18           17
 11740*1-15-83  2-28-83    1    14     45        44           46
 11741*1-21-83  3-09-83    1    20     48        50           49
 11742*2-05-83  3-06-83    1     2     30        32           32
 11743*2-05-83  3-23-83    1    19     47        49           49
 11744*2-15-83  2-28-83    0    14     14        14           16
 11745*2-15-83  3-01-83    0    15     15        15           17
 11746*2-21-83  3-19-83    0    27     27        27           29
 11747*2-21-83  3-20-83    1     0     28        30           30
 11748*2-21-83  4-10-83    1    18     49        30           50
 11749*2-21-83  5-19-83    2    27     88        87           89
 11750*2-21-83  5-22-83    3     2     91        92           92
 11751*3-21-83  5-19-83    1    30     60        60           59
 11752****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 223
* EL156.cbl
 11754 1405-CALC-PAYMENT.
 11755     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11756     MOVE ' '                    TO DC-OPTION-CODE.
 11757     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11758     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11759     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11760
 11761     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11762     MOVE ' '                    TO DC-OPTION-CODE.
 11763     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11764     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11765     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11766
 11767     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11768     MOVE -1                     TO DC-ELAPSED-DAYS.
 11769     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11770     MOVE '6'                    TO DC-OPTION-CODE.
 11771     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11772     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11773
 11774     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11775     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11776     MOVE '1'                    TO DC-OPTION-CODE.
 11777     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11778
 11779     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11780     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11781     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11782
 11783******************************************************************
 11784*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11785*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11786*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11787******************************************************************
 11788
 11789     IF WS-CALC-METHOD = '1'           AND
 11790        DC-ELAPSED-MONTHS > ZERO AND
 11791        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11792        WDF-DAY > WDT-DAY
 11793          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11794          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11795          MOVE -1                  TO DC-ELAPSED-MONTHS
 11796          MOVE '6'                 TO DC-OPTION-CODE
 11797          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11798          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11799          COMPUTE WS-SAVE-ODD-DAYS =
 11800          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11801          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11802
 11803     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11804     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11805     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11806
 11807     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11808     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11809
 11810*    IF PI-COMPANY-ID = 'FIA'
 11811*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 224
* EL156.cbl
 11812*        COMPUTE PI-DAILY-RATE ROUNDED =
 11813*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11814*        COMPUTE PI-CPYAMT ROUNDED =
 11815*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11816*        GO TO 1420-CHECK-AIG-BENEFIT.
 11817
 11818*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11819*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11820*          CM-AH-BENEFIT-CD = '23'               AND
 11821*          CL-CERT-STATE    = '04'               AND
 11822*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11823*            COMPUTE WS-DAILY-RATE ROUNDED =
 11824*                               CM-AH-BENEFIT-AMT / 30
 11825*            COMPUTE PI-CPYAMT ROUNDED =
 11826*                               (WS-DAILY-RATE * PI-CDAYS)
 11827*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11828*            GO TO 1420-CHECK-AIG-BENEFIT.
 11829
 11830     IF WS-CALC-METHOD = '1'
 11831         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11832         COMPUTE PI-CPYAMT ROUNDED =
 11833             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11834             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11835         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11836         GO TO 1420-CHECK-AIG-BENEFIT.
 11837
 11838     IF WS-CALC-METHOD = '2'
 11839         COMPUTE PI-DAILY-RATE ROUNDED =
 11840                          (CM-AH-BENEFIT-AMT * 12) / 365
 11841         COMPUTE PI-CPYAMT ROUNDED =
 11842             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11843             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11844         GO TO 1420-CHECK-AIG-BENEFIT.
 11845
 11846     IF WS-CALC-METHOD = '4'
 11847         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11848         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11849         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11850         COMPUTE PI-CPYAMT ROUNDED =
 11851                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11852         GO TO 1420-CHECK-AIG-BENEFIT.
 11853
 11854     IF WS-CALC-METHOD = '5'
 11855         COMPUTE PI-DAILY-RATE ROUNDED =
 11856                            (CM-AH-BENEFIT-AMT * 12) / 365
 11857         COMPUTE PI-CPYAMT ROUNDED =
 11858                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11859         GO TO 1420-CHECK-AIG-BENEFIT.
 11860
 11861     IF WS-CALC-METHOD NOT = '3'
 11862        GO TO 1410-CHECK-PAYMENT.
 11863
 11864******   CALCULATION METHOD  3  ROUTINE
 11865     COMPUTE PI-DAILY-RATE =
 11866                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11867
 11868******CHECK TO SEE IF WITHIN SAME MONTH
 11869     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 225
* EL156.cbl
 11870        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11871                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11872         GO TO 1420-CHECK-AIG-BENEFIT.
 11873
 11874******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11875     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11876             SAVE-ODD-DAYS-OVER = ZEROS
 11877      COMPUTE PI-CPYAMT  ROUNDED =
 11878                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11879      GO TO 1420-CHECK-AIG-BENEFIT.
 11880
 11881******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11882******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11883     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11884        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11885        IF WDF-MONTH > 12
 11886           ADD 1                 TO WDF-YEAR
 11887           SUBTRACT 12         FROM WDF-MONTH.
 11888
 11889******CONVERT THE NEW FROM MONTH TO BINARY
 11890     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11891        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11892        MOVE '4'              TO DC-OPTION-CODE
 11893        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11894        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11895
 11896     IF WDF-MONTH = WDT-MONTH AND
 11897        WDF-YEAR  = WDT-YEAR
 11898          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11899                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11900                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11901        ELSE
 11902          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11903          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11904          COMPUTE PI-CPYAMT ROUNDED =
 11905       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11906       +
 11907       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11908       +
 11909       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11910
 11911     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 226
* EL156.cbl
 11913 1410-CHECK-PAYMENT.
 11914******PAYMENT OPTION 6
 11915******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11916     IF SAVE-ELAPSED-MONTHS > ZERO
 11917        IF SAVE-ODD-DAYS-OVER = ZEROS
 11918           GO TO 1412-CHECK-TO-DAY
 11919        ELSE
 11920           IF WDF-DAY > WDT-DAY
 11921              IF WDF-MONTH = 02
 11922                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11923                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11924                  GO TO 1412-CHECK-TO-DAY
 11925              ELSE
 11926                  IF FROM-DAYS-IN-MONTH = 31
 11927                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11928                     GO TO 1412-CHECK-TO-DAY
 11929                  ELSE
 11930                     GO TO 1412-CHECK-TO-DAY
 11931           ELSE
 11932               GO TO 1412-CHECK-TO-DAY.
 11933
 11934     IF WDF-MONTH NOT = WDT-MONTH
 11935        IF WDF-MONTH = 02
 11936           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11937           IF WDF-DAY = 29
 11938              ADD 1              TO SAVE-ODD-DAYS-OVER
 11939           ELSE
 11940              ADD 2              TO SAVE-ODD-DAYS-OVER
 11941        ELSE
 11942           IF FROM-DAYS-IN-MONTH = 31
 11943              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11944
 11945 1412-CHECK-TO-DAY.
 11946        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11947           IF WDT-DAY = 28
 11948              ADD 2              TO SAVE-ODD-DAYS-OVER
 11949           ELSE
 11950              IF WDT-DAY = 29
 11951                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11952              ELSE
 11953                 NEXT SENTENCE
 11954        ELSE
 11955           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11956              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11957
 11958     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11959     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11960     COMPUTE PI-CPYAMT ROUNDED =
 11961         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11962         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11963
 11964     GO TO 1420-CHECK-AIG-BENEFIT.
 11965
 11966 1415-CHECK-LEAP-YEAR.
 11967     IF FROM-DAYS-IN-MONTH = 29
 11968        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11969
 11970 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 227
* EL156.cbl
 11971     EXIT.
 11972
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 228
* EL156.cbl
 11974 1420-CHECK-AIG-BENEFIT.
 11975
 11976     IF WS-SPECIAL-CALC-CD = 'Q'
 11977         GO TO 1425-CHECK-WHOLE-MONTH.
 11978
 11979*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11980*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11981*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11982*       (PI-PMTTYPE = '1' OR '2')
 11983*        NEXT SENTENCE
 11984*    ELSE
 11985         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11986         GO TO 1430-CHECK-AH-TOLERANCE.
 11987
 11988******************AIG LOGIC STARTS**********************
 11989*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11990*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11991*    MOVE ER-3533      TO EMI-ERROR.
 11992*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11993*    GO TO 1430-CHECK-AH-TOLERANCE.
 11994******************AIG LOGIC ENDS************************
 11995
 11996 1425-CHECK-WHOLE-MONTH.
 11997******************************************************************
 11998****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11999****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12000****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12001****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12002****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12003****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12004****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12005****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12006****          PAID * MONTHLY BENEFIT.                         ****
 12007******************************************************************
 12008
 12009     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12010
 12011     IF CL-NO-OF-PMTS-MADE > +0
 12012         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12013
 12014     IF PI-CDAYS < WS-BEN-DAYS
 12015         GO TO 1430-CHECK-AH-TOLERANCE.
 12016
 12017     IF PI-CDAYS = WS-BEN-DAYS
 12018         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12019         GO TO 1430-CHECK-AH-TOLERANCE.
 12020
 12021*    IF PI-COMPANY-ID = 'ACM'
 12022*       NEXT SENTENCE
 12023*    ELSE
 12024        GO TO 1425-NOT-ACM-W15C.
 12025
 12026*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12027*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12028*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12029*    MOVE '6'                    TO  DC-OPTION-CODE.
 12030*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12031*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 229
* EL156.cbl
 12032*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12033*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12034*       MOVE '1'                 TO  DC-OPTION-CODE
 12035*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12036*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12037*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12038*       IF NO-CONVERSION-ERROR
 12039*          IF (DC-ELAPSED-MONTHS > +0) OR
 12040*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12041*             NEXT SENTENCE
 12042*          ELSE
 12043*             MOVE +0            TO  PI-CPYAMT
 12044*             MOVE ER-0846       TO  EMI-ERROR
 12045*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12046*             GO TO 1430-CHECK-AH-TOLERANCE
 12047*       ELSE
 12048*           MOVE ER-0846         TO  EMI-ERROR
 12049*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12050*           GO TO 1430-CHECK-AH-TOLERANCE.
 12051*
 12052*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12053*       ADD +1 TO DC-ELAPSED-MONTHS.
 12054*
 12055*    COMPUTE PI-CPYAMT ROUNDED =
 12056*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12057*
 12058*    GO TO 1430-CHECK-AH-TOLERANCE.
 12059
 12060 1425-NOT-ACM-W15C.
 12061
 12062     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12063     MOVE '6'                        TO  DC-OPTION-CODE.
 12064     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12065     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12066
 12067     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12068     IF NO-CONVERSION-ERROR
 12069         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12070     ELSE
 12071         MOVE ER-0846                TO  EMI-ERROR
 12072         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12073         GO TO 1430-CHECK-AH-TOLERANCE.
 12074
 12075     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12076     MOVE '1'                        TO  DC-OPTION-CODE.
 12077     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12078     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12079     IF NO-CONVERSION-ERROR
 12080         IF DC-ODD-DAYS-OVER = +0
 12081             NEXT SENTENCE
 12082         ELSE
 12083             MOVE ER-0846            TO  EMI-ERROR
 12084             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12085             GO TO 1430-CHECK-AH-TOLERANCE
 12086     ELSE
 12087         MOVE ER-0846                TO  EMI-ERROR
 12088         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12089         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 230
* EL156.cbl
 12090
 12091     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12092         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12093
 12094     GO TO 1430-CHECK-AH-TOLERANCE.
 12095
 12096 1425-CONT-WHOLE-MONTH-PMTS.
 12097******************************************************************
 12098****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12099****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12100****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12101******************************************************************
 12102
 12103     IF PI-COMPANY-ID = 'ACM'
 12104        NEXT SENTENCE
 12105     ELSE
 12106        IF DC-ODD-DAYS-OVER = +0
 12107            NEXT SENTENCE
 12108        ELSE
 12109            MOVE ER-0845            TO  EMI-ERROR
 12110            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12111            GO TO 1430-CHECK-AH-TOLERANCE.
 12112
 12113     COMPUTE PI-CPYAMT ROUNDED =
 12114                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12115
 12116 1430-CHECK-AH-TOLERANCE.
 12117     IF PI-PMT-APPR-SW = 'G'
 12118         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12119
 12120*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12121*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12122*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12123*
 12124*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12125*      IF WDF-MONTH = 02
 12126*        IF SAVE-ELAPSED-MONTHS = 0
 12127*          NEXT SENTENCE
 12128*        ELSE
 12129*          IF SAVE-ODD-DAYS-OVER > 0
 12130*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12131*            COMPUTE WS-PMT-MOS ROUNDED =
 12132*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12133*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12134*                                     WS-PMT-MOS
 12135*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12136*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12137*          ELSE
 12138*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12139*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12140*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12141*                                     WS-PMT-MOS.
 12142
 12143     IF WS-MAX-PMT-TOL NOT = ZERO
 12144        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12145           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12146            MOVE ER-0494         TO  EMI-ERROR
 12147            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 231
* EL156.cbl
 12148            GO TO 1500-EDIT-EXPENSES.
 12149
 12150 1430-CONT-CHECK-AH-TOLERANCE.
 12151
 12152     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12153        GO TO 1500-EDIT-EXPENSES.
 12154
 12155     IF CM-O-B-COVERAGE
 12156        GO TO 1500-EDIT-EXPENSES.
 12157
 12158     IF PI-COMPANY-ID = 'NCL'
 12159       IF FOUND-TOL-SW = 'Y'
 12160         IF WS-PMT-TOL NOT = ZERO
 12161           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12162              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12163                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12164                  IF WS-NCL-PMT-OPTION = SPACES
 12165                      MOVE ER-0699 TO EMI-ERROR
 12166                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12167                  ELSE
 12168                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12169                      NEXT SENTENCE
 12170                  ELSE
 12171                  IF NOT WS-VALID-NCL-OPTION
 12172                      MOVE ER-0699 TO EMI-ERROR
 12173                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12174
 12175     IF WS-PMT-TOL NOT = ZERO
 12176        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12177           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12178           MOVE ER-0495          TO EMI-ERROR
 12179           PERFORM 1490-PAYMENT-ERROR
 12180                                 THRU 1490-EXIT
 12181        end-if
 12182     end-if
 12183
 12184     GO TO 1500-EDIT-EXPENSES.
 12185
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 232
* EL156.cbl
 12187 1440-COMPUTE-LIFE-REMAINING.
 12188
 12189     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12190        IF PI-PMTTYPE = '4'
 12191          MOVE PI-EPYAMT TO PI-CPYAMT
 12192          GO TO 1460-TEST-TYPE.
 12193
 12194     IF WS-LF-COVERAGE-TYPE = 'L'
 12195        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12196                          - CL-TOTAL-PAID-AMT
 12197        GO TO 1450-CHECK-MAX.
 12198
 12199     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12200        PI-LF-COVERAGE-TYPE = 'P'
 12201          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12202                              CM-LF-ITD-DEATH-AMT
 12203          GO TO 1450-CHECK-MAX.
 12204
 12205     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12206     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12207     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12208     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12209     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12210     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12211     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12212     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12213     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12214
 12215     PERFORM 9800-LINK-REM-TERM.
 12216
 12217     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12218     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12219     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12220     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12221     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12222     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12223     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12224     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12225     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12226     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12227     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12228     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12229     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12230     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12231     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12232     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12233     IF PI-COMPANY-ID = 'DCC'
 12234        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12235        MOVE PI-CARRIER          TO ACCT-CARRIER
 12236        MOVE PI-GROUPING         TO ACCT-GROUPING
 12237        MOVE PI-STATE            TO ACCT-STATE
 12238        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12239        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12240        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12241        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12242
 12243
 12244* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 233
* EL156.cbl
 12245*          DATASET ('ERACCT')
 12246*          RIDFLD  (ERACCT-KEY)
 12247*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12248*          GTEQ
 12249*          resp    (WS-RESPONSE)
 12250*       END-EXEC
 12251     MOVE 'ERACCT' TO DFHEIV1
 12252*    MOVE '&"S        G          (  N#00011689' TO DFHEIV0
 12253     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12254     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12255     MOVE X'204E233030303131363839' TO DFHEIV0(25:11)
 12256     CALL 'kxdfhei1' USING DFHEIV0,
 12257           DFHEIV1,
 12258           DFHEIV20,
 12259           DFHEIV99,
 12260           ERACCT-KEY,
 12261           DFHEIV99,
 12262           DFHEIV99,
 12263           DFHEIV99
 12264     SET ADDRESS OF ACCOUNT-MASTER TO
 12265         DFHEIV20
 12266     MOVE EIBRESP  TO WS-RESPONSE
 12267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12268        IF WS-RESP-NORMAL
 12269           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12270           and (pi-cert-eff-dt < am-expiration-dt)
 12271           and (pi-cert-eff-dt >= am-effective-dt)
 12272           move am-dcc-product-code to pi-dcc-product-code
 12273        else
 12274           move spaces           to pi-dcc-product-code
 12275        end-if
 12276        if pi-dcc-product-code not = spaces
 12277           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12278           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12279           PERFORM 0900-GET-DDF-limits
 12280                                 THRU 0900-EXIT
 12281           IF PDEF-FOUND
 12282              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12283                 (P1 > +8)
 12284                 OR (PD-PROD-CODE (P1) = 'L')
 12285              END-PERFORM
 12286              IF P1 < +9
 12287                 MOVE PD-MAX-AMT (P1)
 12288                                 TO CP-R-MAX-TOT-BEN
 12289              else
 12290                 move er-1674    to emi-error
 12291                 PERFORM 9900-ERROR-FORMAT
 12292                                 THRU 9900-EXIT
 12293              END-IF
 12294           else
 12295              move er-1672       to emi-error
 12296              PERFORM 9900-ERROR-FORMAT
 12297                                 THRU 9900-EXIT
 12298           END-IF
 12299        end-if
 12300     END-IF
 12301
 12302* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 234
* EL156.cbl
 12303*       PROGRAM  (LINK-REMAMT)
 12304*       COMMAREA (CALCULATION-PASS-AREA)
 12305*       LENGTH   (CP-COMM-LENGTH)
 12306*    END-EXEC.
 12307*    MOVE '."C                   (   #00011729' TO DFHEIV0
 12308     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12310     MOVE X'2020233030303131373239' TO DFHEIV0(25:11)
 12311     CALL 'kxdfhei1' USING DFHEIV0,
 12312           LINK-REMAMT,
 12313           CALCULATION-PASS-AREA,
 12314           CP-COMM-LENGTH,
 12315           DFHEIV99,
 12316           DFHEIV99,
 12317           DFHEIV99,
 12318           DFHEIV99
 12319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12320
 12321
 12322     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12323
 12324     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12325     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12326
 12327     IF PI-COMPANY-ID = 'BOA' AND
 12328        PI-PMTTYPE    = '2'   AND
 12329        PI-OFFLINE    = 'N'
 12330           GO TO 1441-COMPUTE-BOA-INTEREST.
 12331
 12332     IF PI-COMPANY-ID = 'NCL' AND
 12333        PI-PMTTYPE    = '2'   AND
 12334        PI-OFFLINE    = 'N'
 12335          GO TO 1442-COMPUTE-NCL-INTEREST
 12336       ELSE
 12337          GO TO 1445-CONTINUE.
 12338
 12339 1441-COMPUTE-BOA-INTEREST.
 12340     MOVE +0             TO WS-CALC-INT.
 12341
 12342     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12343     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12344     MOVE +0             TO DC-ELAPSED-MONTHS
 12345                            DC-ELAPSED-DAYS.
 12346     MOVE '1'            TO DC-OPTION-CODE.
 12347     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12348     IF NO-CONVERSION-ERROR
 12349         NEXT SENTENCE
 12350     ELSE
 12351         GO TO 1445-CONTINUE.
 12352
 12353     IF (PI-INT-RATE NOT > ZEROS)  AND
 12354        (DC-ELAPSED-DAYS > +30)
 12355         MOVE ER-3531            TO EMI-ERROR
 12356         MOVE -1                 TO PINTL
 12357         MOVE AL-UNBON           TO PINTA
 12358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12359
 12360     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 235
* EL156.cbl
 12361         GO TO 1445-CONTINUE.
 12362
 12363     IF (PI-INT-RATE NOT > ZEROS)  OR
 12364        (DC-ELAPSED-DAYS NOT > +30)
 12365         MOVE PI-EPYAMT TO PI-CPYAMT
 12366         GO TO 1441-FORMAT-NOTE.
 12367
 12368     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12369                                 *  PI-INT-RATE
 12370                                 *  DC-ELAPSED-DAYS
 12371                                 /  365
 12372                                 /  100.
 12373
 12374     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12375
 12376 1441-FORMAT-NOTE.
 12377
 12378     MOVE SPACES        TO WS-BOANOTE1.
 12379     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12380     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12381     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12382     MOVE AL-UANON      TO NOTE1A.
 12383
 12384     IF WS-CALC-INT > ZEROS
 12385         MOVE SPACES        TO WS-BOANOTE2
 12386         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12387         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12388         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12389         MOVE AL-UANON      TO NOTE2A.
 12390
 12391     GO TO 1445-CONTINUE.
 12392
 12393 1442-COMPUTE-NCL-INTEREST.
 12394     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12395     MOVE PI-STATE               TO WS-ST-ACCESS.
 12396     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12397     MOVE '3'                    TO CNTL-REC-TYPE.
 12398     MOVE +0                     TO CNTL-SEQ-NO.
 12399     MOVE 'STAT'                 TO FILE-SWITCH.
 12400
 12401     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12402
 12403     MOVE +0                 TO WS-CALC-INT.
 12404
 12405     IF ST-STAT-FROM-INCURRED
 12406         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12407       ELSE
 12408     IF ST-STAT-FROM-REPORTED
 12409         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12410       ELSE
 12411         GO TO 1445-CONTINUE.
 12412
 12413     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12414     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12415     MOVE +0                 TO DC-ELAPSED-MONTHS
 12416                                DC-ELAPSED-DAYS.
 12417     MOVE '1'                TO DC-OPTION-CODE.
 12418     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 236
* EL156.cbl
 12419     IF NO-CONVERSION-ERROR
 12420         NEXT SENTENCE
 12421     ELSE
 12422         GO TO 1445-CONTINUE.
 12423
 12424     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12425        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12426         GO TO 1445-CONTINUE.
 12427
 12428     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12429                                 *  CF-ST-STAT-INTEREST.
 12430
 12431     MOVE SPACES              TO WS-NCLNOTE1.
 12432     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12433     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12434     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12435                                 PI-PMTNOTE1
 12436                                 NOTE1I.
 12437     MOVE AL-UANON            TO NOTE1A.
 12438
 12439     IF WS-CALC-INT > ZEROS
 12440         MOVE SPACES          TO WS-NCLNOTE2
 12441         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12442         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12443         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12444                                 PI-PMTNOTE2
 12445                                 NOTE2I
 12446         MOVE AL-UANON        TO NOTE2A.
 12447
 12448     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12449
 12450 1445-CONTINUE.
 12451
 12452     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12453        GO TO 1460-TEST-TYPE.
 12454
 12455     IF CM-O-B-COVERAGE
 12456        GO TO 1460-TEST-TYPE.
 12457
 12458     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12459         GO TO 1450-CHECK-MAX.
 12460
 12461     if (pi-company-id = 'DCC')
 12462        and (pdef-found)
 12463        and (pi-epyamt > pd-max-amt (p1))
 12464        move er-1657             to emi-error
 12465        perform 1490-payment-error
 12466                                 thru 1490-exit
 12467        go to 1460-test-type
 12468     else
 12469        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12470           > PI-EPYAMT)
 12471                         OR
 12472           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12473           < PI-EPYAMT)
 12474           MOVE ER-0594          TO EMI-ERROR
 12475           PERFORM 1490-PAYMENT-ERROR
 12476                                 THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 237
* EL156.cbl
 12477           GO TO 1460-TEST-TYPE
 12478        end-if
 12479     end-if
 12480     .
 12481 1450-CHECK-MAX.
 12482
 12483     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12484        PI-LF-COVERAGE-TYPE = 'P'
 12485         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12486                                   CM-LF-ITD-DEATH-AMT
 12487     ELSE
 12488         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12489                                   CL-TOTAL-PAID-AMT.
 12490
 12491     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12492          MOVE ER-0543           TO EMI-ERROR
 12493          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12494
 12495 1460-TEST-TYPE.
 12496
 12497     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12498        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12499           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12500                                   CM-LF-ALT-BENEFIT-AMT -
 12501                                   CL-TOTAL-PAID-AMT
 12502           IF PI-EPYAMT > WS-LF-BEN-AMT
 12503               MOVE ER-0543      TO EMI-ERROR
 12504               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12505           END-IF
 12506        END-IF
 12507     END-IF
 12508
 12509     IF PI-PMT-APPR-SW = 'G'
 12510       NEXT SENTENCE
 12511     ELSE
 12512       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12513         IF PI-EPYAMT = ZERO
 12514             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12515                 MOVE ER-0494    TO  EMI-ERROR
 12516                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12517                 GO TO 1500-EDIT-EXPENSES
 12518             ELSE
 12519                 NEXT SENTENCE
 12520         ELSE
 12521             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12522                 MOVE ER-0494    TO  EMI-ERROR
 12523                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12524                 GO TO 1500-EDIT-EXPENSES.
 12525
 12526     IF PI-PMTTYPE NOT = '2' OR
 12527        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12528         GO TO 1500-EDIT-EXPENSES.
 12529
 12530     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12531     MOVE ER-0526                TO EMI-ERROR.
 12532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12533
 12534     IF EMI-ERROR-NUMBER (1) = '0526'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 238
* EL156.cbl
 12535        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12536
 12537     IF EMI-ERROR-NUMBER (2) = '0526'
 12538        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12539
 12540     GO TO 1500-EDIT-EXPENSES.
 12541
 12542 1490-PAYMENT-ERROR.
 12543     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12544
 12545     IF EMI-MESSAGE-FORMATTED
 12546         MOVE -1                 TO EPYAMTL
 12547         MOVE AL-UNBON           TO EPYAMTA.
 12548
 12549 1490-EXIT.
 12550      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 239
* EL156.cbl
 12552 1500-EDIT-EXPENSES.
 12553     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12554         GO TO 1500-SKIP-ERROR-0556.
 12555
 12556 1500-CONTINUE-ON.
 12557
 12558     IF CM-O-B-COVERAGE
 12559        MOVE ER-0556             TO EMI-ERROR
 12560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12561
 12562 1500-SKIP-ERROR-0556.
 12563     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12564        IF PI-EEXPENS NOT = ZEROS
 12565           MOVE ER-0524          TO EMI-ERROR
 12566           GO TO 1590-EXPENSE-ERROR
 12567        ELSE
 12568           GO TO 1600-EDIT-RESERVES.
 12569
 12570     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12571     MOVE '6'                    TO CNTL-REC-TYPE.
 12572
 12573     IF CONTROL-IS-ACTUAL-CARRIER
 12574         MOVE PI-CARRIER         TO WS-CARR
 12575     ELSE
 12576         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12577
 12578     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12579     MOVE +0                     TO CNTL-SEQ-NO.
 12580     MOVE 'CARR'                 TO FILE-SWITCH.
 12581
 12582     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12583
 12584     IF EXPENSE-CALC-MANUAL
 12585        GO TO 1600-EDIT-RESERVES.
 12586
 12587     IF DOLLARS-PER-PMT
 12588        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12589        GO TO 1600-EDIT-RESERVES.
 12590
 12591     IF DOLLARS-PER-MONTH AND
 12592        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12593       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12594       GO TO 1600-EDIT-RESERVES.
 12595
 12596     IF PERCENT-OF-PAYMENT
 12597        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12598
 12599     GO TO 1600-EDIT-RESERVES.
 12600
 12601 1590-EXPENSE-ERROR.
 12602     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12603
 12604     IF EMI-MESSAGE-FORMATTED
 12605        MOVE -1                  TO EEXPENSL
 12606        MOVE AL-UNBON            TO EEXPENSA.
 12607
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 240
* EL156.cbl
 12609 1600-EDIT-RESERVES.
 12610     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12611        IF PI-ERESV = ZEROS
 12612           GO TO 1700-EDIT-EXPENSE-TYPE
 12613        ELSE
 12614           MOVE ER-0525          TO EMI-ERROR
 12615           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12616           GO TO 1700-EDIT-EXPENSE-TYPE.
 12617
 12618     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12619     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12620     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12621
 12622     IF NOT AT-MANUAL-RESERVES-USED
 12623        IF PI-ERESV NOT = ZEROS
 12624           MOVE ER-0518          TO EMI-ERROR
 12625           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12626
 12627     IF AT-MANUAL-RESERVES-USED
 12628        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12629        GO TO 1700-EDIT-EXPENSE-TYPE.
 12630
 12631     IF AT-FUTURE-RESERVES-USED
 12632        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12633
 12634     IF AT-FUTURE-RESERVES-USED
 12635        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12636
 12637     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12638        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12639
 12640     IF AT-IBNR-RESERVES-USED
 12641        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12642
 12643     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12644     GO TO 1700-EDIT-EXPENSE-TYPE.
 12645
 12646 1690-RESERVE-ERROR.
 12647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12648
 12649     IF EMI-MESSAGE-FORMATTED
 12650        MOVE AL-UNBON            TO ERESVA
 12651        MOVE -1                  TO ERESVL.
 12652
 12653 1690-EXIT.
 12654      EXIT.
 12655
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 241
* EL156.cbl
 12657 1700-EDIT-EXPENSE-TYPE.
 12658     IF PI-PMTTYPE NOT = '5' AND '6'
 12659        GO TO 2000-EDIT-DONE.
 12660
 12661     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12662                   '6' OR '7' OR '8' OR '9'
 12663        GO TO 2000-EDIT-DONE.
 12664
 12665 1705-EXPENSE-ERROR.
 12666     MOVE ER-0573                TO EMI-ERROR.
 12667     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12668
 12669     IF EMI-MESSAGE-FORMATTED
 12670        MOVE AL-UABON            TO ETYPEA
 12671        MOVE -1                  TO ETYPEL.
 12672
 12673     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 242
* EL156.cbl
 12675 1950-NOT-FOUND.
 12676     IF FILE-SWITCH = 'MSTR'
 12677        MOVE ER-0204             TO EMI-ERROR.
 12678
 12679     IF FILE-SWITCH = 'CARR'
 12680        MOVE ER-0252             TO EMI-ERROR.
 12681
 12682     IF FILE-SWITCH = 'COMP'
 12683        MOVE ER-0254             TO EMI-ERROR.
 12684
 12685     IF FILE-SWITCH = 'STAT'
 12686        MOVE ER-0149             TO EMI-ERROR.
 12687
 12688     IF FILE-SWITCH = 'PROC'
 12689        MOVE ER-0019             TO EMI-ERROR.
 12690
 12691     IF FILE-SWITCH = 'ACCT'
 12692        MOVE ER-0198             TO EMI-ERROR.
 12693
 12694     IF FILE-SWITCH = 'BENE'
 12695        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12696           MOVE ER-0282          TO EMI-ERROR
 12697        ELSE
 12698           MOVE ER-0283          TO EMI-ERROR.
 12699
 12700     MOVE -1                     TO PMTTYPEL.
 12701     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12702
 12703     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12704                                     WS-FORCE-CTR.
 12705
 12706     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12707                                     WS-FATAL-CTR.
 12708
 12709     GO TO 8200-SEND-DATAONLY.
 12710
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 243
* EL156.cbl
 12712 2000-EDIT-DONE.
 12713*********************
 12714     perform 2210-dcc-max-benes thru 2210-exit
 12715     if pi-company-id not = 'DCC'
 12716        IF (WS-SPECIAL-CALC-CD = 'C')
 12717           and (cl-critical-period > 0)
 12718           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12719              IF PI-EPYAMT > ZEROS
 12720                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12721                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12722              ELSE
 12723                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12724                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12725              END-IF
 12726              if ws-benefits-paid > cl-critical-period
 12727                 MOVE ER-0657          TO EMI-ERROR
 12728                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12729              END-IF
 12730           END-IF
 12731        END-IF
 12732     end-if
 12733     IF PI-HOLDTIL NOT = ZEROS
 12734        MOVE PI-HOLDTIL          TO HOLDTILO
 12735        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12736
 12737     IF PI-EPYFROM NOT = ZEROS
 12738        MOVE PI-EPYFROM          TO EPYFROMO
 12739        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12740
 12741     IF PI-EPYTHRU NOT = ZEROS
 12742        MOVE PI-EPYTHRU            TO EPYTHRUO
 12743        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12744        IF PI-USES-PAID-TO
 12745           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12746           MOVE '4'                TO DC-OPTION-CODE
 12747           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12748           IF NO-CONVERSION-ERROR
 12749              MOVE +1              TO DC-ELAPSED-DAYS
 12750              MOVE +0              TO DC-ELAPSED-MONTHS
 12751              MOVE '6'             TO DC-OPTION-CODE
 12752              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12753              IF NO-CONVERSION-ERROR
 12754                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12755
 12756     MOVE PI-EDAYS               TO EDAYSO.
 12757
 12758     IF PI-AIGFROM NOT = ZEROS
 12759        MOVE PI-AIGFROM          TO AIGFROMO
 12760        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12761
 12762     MOVE PI-EPYAMT              TO EPYAMTO.
 12763     MOVE PI-ERESV               TO ERESVO.
 12764     MOVE PI-EEXPENS             TO EEXPENSO.
 12765
 12766     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12767     MOVE SPACES                 TO DC-OPTION-CODE.
 12768     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12769
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 244
* EL156.cbl
 12770     IF DATE-CONVERSION-ERROR
 12771        MOVE SPACES              TO CPYFROMI
 12772     ELSE
 12773        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12774        IF PI-EPYFROM = ZEROS
 12775           MOVE AL-UANON             TO EPYFROMA
 12776           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12777           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12778
 12779     IF PI-USES-PAID-TO
 12780        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12781        MOVE +1                            TO DC-ELAPSED-DAYS
 12782        MOVE +0                            TO DC-ELAPSED-MONTHS
 12783        MOVE '6'                           TO DC-OPTION-CODE
 12784        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12785        IF NO-CONVERSION-ERROR
 12786           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12787           IF PI-EPYTHRU = ZEROS
 12788              MOVE AL-UANON                TO EPYTHRUA
 12789              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12790              MOVE ' '                     TO DC-OPTION-CODE
 12791              MOVE +0                      TO DC-ELAPSED-DAYS
 12792                                              DC-ELAPSED-MONTHS
 12793              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12794              IF NO-CONVERSION-ERROR
 12795                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12796                  GO TO 2001-CONTINUE
 12797              ELSE
 12798                  GO TO 2001-CONTINUE
 12799           ELSE
 12800              GO TO 2001-CONTINUE.
 12801
 12802     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12803     MOVE SPACES                 TO DC-OPTION-CODE.
 12804     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12805
 12806     IF DATE-CONVERSION-ERROR
 12807        MOVE SPACES              TO CPYTHRUI
 12808     ELSE
 12809        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12810        IF PI-EPYTHRU = ZEROS
 12811           MOVE AL-UANON TO EPYTHRUA
 12812           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12813           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12814
 12815 2001-CONTINUE.
 12816
 12817     MOVE PI-CDAYS               TO CDAYSO.
 12818
 12819     IF PI-EDAYS = ZEROS
 12820        MOVE AL-UNNON TO EDAYSA
 12821        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12822
 12823     MOVE PI-CPYAMT              TO CPYAMTO.
 12824
 12825     IF PI-EPYAMT = ZEROS
 12826        MOVE AL-UNNON            TO EPYAMTA
 12827        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 245
* EL156.cbl
 12828
 12829     MOVE PI-CRESV               TO CRESVO.
 12830     MOVE PI-CEXPENS             TO CEXPENSO.
 12831
 12832     IF PI-EEXPENS = ZEROS
 12833        MOVE AL-UNNON TO EEXPENSA
 12834        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12835
 12836     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12837        AND (CL-CLAIM-TYPE = 'L')
 12838        AND (PI-OFFLINE NOT EQUAL 'Y')
 12839        IF PI-PMTTYPE = '2' OR '4'
 12840           PERFORM 2200-CALC-INTEREST
 12841                                 THRU 2200-EXIT
 12842        END-IF
 12843     END-IF
 12844     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12845     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12846     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12847
 12848     IF EMI-FATAL-CTR = ZEROS
 12849        MOVE 'B'                 TO PI-PASS-SW.
 12850
 12851     IF NOT EMI-MESSAGE-FORMATTED
 12852         MOVE -1                 TO EPYFROML
 12853     ELSE
 12854         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12855            EMI-ERROR-NUMBER (2) = SPACES
 12856             MOVE -1             TO EPYFROML.
 12857
 12858     GO TO 8200-SEND-DATAONLY.
 12859
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 246
* EL156.cbl
 12861 2200-CALC-INTEREST.
 12862     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12863        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12864        MOVE '4'                 TO DC-OPTION-CODE
 12865        PERFORM 9700-LINK-DATE-CONVERT
 12866        IF DATE-CONVERSION-ERROR
 12867            MOVE LOW-VALUES      TO CP-PRF-DT
 12868        ELSE
 12869           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12870        END-IF
 12871     END-IF
 12872     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12873        IN CLAIM-INT-PASS-AREA
 12874     MOVE CL-CERT-STATE          TO CP-STATE
 12875        IN CLAIM-INT-PASS-AREA
 12876     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12877     MOVE 'LF'                   TO CP-COVERAGE
 12878     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12879     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12880     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12881     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12882     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12883     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12884
 12885* EXEC CICS LINK
 12886*       PROGRAM   ('ELCLMI')
 12887*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12888*       LENGTH    (CP-CLAIM-LENGTH)
 12889*    END-EXEC
 12890     MOVE 'ELCLMI' TO DFHEIV1
 12891*    MOVE '."C                   (   #00012297' TO DFHEIV0
 12892     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12894     MOVE X'2020233030303132323937' TO DFHEIV0(25:11)
 12895     CALL 'kxdfhei1' USING DFHEIV0,
 12896           DFHEIV1,
 12897           CLAIM-INT-PASS-AREA,
 12898           CP-CLAIM-LENGTH,
 12899           DFHEIV99,
 12900           DFHEIV99,
 12901           DFHEIV99,
 12902           DFHEIV99
 12903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12904     MOVE AL-PANOF               TO PINTHA
 12905                                    PINTA
 12906     IF NO-CI-ERROR
 12907        MOVE CP-CLM-INT-AMT      TO PINTO
 12908                                    PI-INT-AMT
 12909        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12910        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12911        MOVE AL-PANOF            TO PINTHA
 12912                                    PINTA
 12913     ELSE
 12914        IF CI-RETURN-CODE = '8'
 12915           MOVE ER-3818          TO EMI-ERROR
 12916           MOVE -1               TO ZINTL
 12917           PERFORM 9900-ERROR-FORMAT
 12918                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 247
* EL156.cbl
 12919           GO TO 2200-EXIT
 12920        ELSE
 12921           MOVE ZEROS            TO PINTO
 12922                                    PI-INT-AMT
 12923                                    PI-INT-DAYS
 12924                                    PI-INT-RATE-USED
 12925        END-IF
 12926     END-IF
 12927     IF PI-INT-AMT NOT = ZEROS
 12928        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12929           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12930           CONTINUE
 12931        ELSE
 12932           MOVE CL-SOC-SEC-NO (1:3)
 12933                                 TO WS-SSN (1:3)
 12934           MOVE CL-SOC-SEC-NO (5:2)
 12935                                 TO WS-SSN (4:2)
 12936           MOVE CL-SOC-SEC-NO (8:4)
 12937                                 TO WS-SSN (6:4)
 12938           IF (WS-SSN NUMERIC)
 12939              AND (WS-SSN NOT = ZEROS)
 12940              CONTINUE
 12941           ELSE
 12942              MOVE ER-2044       TO EMI-ERROR
 12943              PERFORM 9900-ERROR-FORMAT
 12944                                 THRU 9900-EXIT
 12945           END-IF
 12946        END-IF
 12947        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12948        MOVE +51                 TO TRLR-SEQ-NO
 12949
 12950* EXEC CICS READ
 12951*          DATASET  ('ELTRLR')
 12952*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12953*          RIDFLD   (ELTRLR-KEY)
 12954*          RESP     (WS-RESPONSE)
 12955*       END-EXEC
 12956     MOVE 'ELTRLR' TO DFHEIV1
 12957*    MOVE '&"S        E          (  N#00012347' TO DFHEIV0
 12958     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12960     MOVE X'204E233030303132333437' TO DFHEIV0(25:11)
 12961     CALL 'kxdfhei1' USING DFHEIV0,
 12962           DFHEIV1,
 12963           DFHEIV20,
 12964           DFHEIV99,
 12965           ELTRLR-KEY,
 12966           DFHEIV99,
 12967           DFHEIV99,
 12968           DFHEIV99
 12969     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12970         DFHEIV20
 12971     MOVE EIBRESP  TO WS-RESPONSE
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12973        IF (NOT WS-RESP-NORMAL)
 12974                    OR
 12975           ((WS-RESP-NORMAL)
 12976           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 248
* EL156.cbl
 12977           OR (AT-CITY-STATE = SPACES)))
 12978           MOVE ER-0874          TO EMI-ERROR
 12979           PERFORM 9900-ERROR-FORMAT
 12980                                 THRU 9900-EXIT
 12981        END-IF
 12982     END-IF
 12983     .
 12984 2200-EXIT.
 12985     EXIT.
 12986 2210-dcc-max-benes.
 12987
 12988     move pi-ah-term             to ws-max-bens
 12989     if cl-critical-period not = zeros and spaces
 12990        move cl-critical-period  to ws-max-bens
 12991     end-if
 12992     move cm-ah-benefit-amt      to ws-monthly-benefit
 12993     if pdef-found
 12994        and (pd-max-amt (p1) not = zeros)
 12995        and (pd-max-amt (p1) < ws-monthly-benefit)
 12996        move pd-max-amt (p1)     to ws-monthly-benefit
 12997     end-if
 12998
 12999     move cl-cert-key-data       to elcrtt-key (2:21)
 13000     move cl-company-cd          to ctrlr-comp-cd
 13001     move cl-cert-no             to ctrlr-cert-no
 13002     move 'B'                    to ctrlr-rec-type
 13003
 13004
 13005* EXEC CICS READ
 13006*       DATASET  ('ELCRTT')
 13007*       set      (address of CERTIFICATE-TRAILERS)
 13008*       RIDFLD   (ELCRTT-KEY)
 13009*       RESP     (WS-RESPONSE)
 13010*    END-EXEC
 13011     MOVE 'ELCRTT' TO DFHEIV1
 13012*    MOVE '&"S        E          (  N#00012384' TO DFHEIV0
 13013     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13014     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13015     MOVE X'204E233030303132333834' TO DFHEIV0(25:11)
 13016     CALL 'kxdfhei1' USING DFHEIV0,
 13017           DFHEIV1,
 13018           DFHEIV20,
 13019           DFHEIV99,
 13020           ELCRTT-KEY,
 13021           DFHEIV99,
 13022           DFHEIV99,
 13023           DFHEIV99
 13024     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13025         DFHEIV20
 13026     MOVE EIBRESP  TO WS-RESPONSE
 13027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13028     IF not WS-RESP-NORMAL
 13029        go to 2210-exit
 13030     end-if
 13031
 13032*    if instypei = 'P'
 13033*       move +1 to s1
 13034*    else
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 249
* EL156.cbl
 13035*       MOVE +2 to s1
 13036*    end-if
 13037
 13038*    move +1 to s1
 13039*    evaluate cl-claim-type
 13040*       when 'A'
 13041*          move +1 to s2
 13042*       when 'I'
 13043*          move +2 to s2
 13044*       when 'G'
 13045*          move +3 to s2
 13046*       when 'L'
 13047*          move +4 to s2
 13048*       when 'P'
 13049*          move +5 to s2
 13050*    end-evaluate
 13051
 13052     move zeros                  to ws-prev-days-paid
 13053                                    ws-benefits-paid
 13054                                    ws-prev-amt-paid
 13055     perform varying s1 from +1 by +1 until
 13056        (s1 > +24)
 13057        or (cs-claim-type (s1) = spaces)
 13058        if pi-company-id not = 'DCC'
 13059           if cs-claim-type (s1) = cl-claim-type
 13060              compute ws-prev-days-paid =
 13061                 ws-prev-days-paid + cs-days-paid (s1)
 13062              compute ws-prev-amt-paid =
 13063                 ws-prev-amt-paid + cs-total-paid (s1)
 13064           end-if
 13065        else
 13066           if (cs-claim-type (s1) = cl-claim-type)
 13067              and (cs-benefit-period (s1) = cl-benefit-period)
 13068              and (cs-insured-type (s1) = cl-insured-type)
 13069              compute ws-prev-days-paid =
 13070                 ws-prev-days-paid + cs-days-paid (s1)
 13071              compute ws-prev-amt-paid =
 13072                 ws-prev-amt-paid + cs-total-paid (s1)
 13073           end-if
 13074        end-if
 13075     end-perform
 13076     if pi-epyamt > zeros
 13077        compute ws-benefits-paid =
 13078           (ws-prev-amt-paid + pi-epyamt)
 13079           / ws-monthly-benefit
 13080     else
 13081        compute ws-benefits-paid =
 13082           (ws-prev-amt-paid + pi-cpyamt)
 13083           / ws-monthly-benefit
 13084     end-if
 13085     if pi-company-id = 'DCC'
 13086     if cl-claim-type not = 'L' and 'P'
 13087        if ws-benefits-paid > ws-max-bens
 13088           move er-1658          to emi-error
 13089           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13090        end-if
 13091     end-if
 13092     end-if
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 250
* EL156.cbl
 13093*     if s1 < +25
 13094*        if pi-epyamt > zeros
 13095*           compute ws-benefits-paid =
 13096*              (cs-total-paid (s1) + PI-EPYAMT)
 13097*              / ws-monthly-benefit
 13098*        else
 13099*           compute ws-benefits-paid =
 13100*              (cs-total-paid (s1) + PI-CPYAMT)
 13101*              / ws-monthly-benefit
 13102*        end-if
 13103
 13104*       if ws-benefits-paid > pd-crit-period (p1)
 13105*        if ws-benefits-paid > ws-max-bens
 13106*           move er-1658          to emi-error
 13107*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13108*        end-if
 13109*     end-if
 13110     .
 13111 2210-exit.
 13112     exit.
 13113
 13114 2220-update-elcrtt.
 13115
 13116
 13117* EXEC CICS GETMAIN
 13118*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13119*       LENGTH   (ELCRTT-LENGTH)
 13120*       INITIMG  (GETMAIN-SPACE)
 13121*    END-EXEC
 13122*    MOVE ',"IL                  $   #00012478' TO DFHEIV0
 13123     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13125     MOVE X'2020233030303132343738' TO DFHEIV0(25:11)
 13126     CALL 'kxdfhei1' USING DFHEIV0,
 13127           DFHEIV20,
 13128           ELCRTT-LENGTH,
 13129           GETMAIN-SPACE
 13130     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13131         DFHEIV20
 13132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13133
 13134     move cl-cert-key-data       to elcrtt-key (2:21)
 13135     move cl-company-cd          to ctrlr-comp-cd
 13136     move cl-cert-no             to ctrlr-cert-no
 13137     move 'B'                    to ctrlr-rec-type
 13138
 13139
 13140* EXEC CICS READ
 13141*       UPDATE
 13142*       DATASET  (ELCRTT-DSID)
 13143*       into     (CERTIFICATE-TRAILERS)
 13144*       RIDFLD   (ELCRTT-KEY)
 13145*       RESP     (WS-RESPONSE)
 13146*    END-EXEC
 13147     MOVE LENGTH OF
 13148      CERTIFICATE-TRAILERS
 13149       TO DFHEIV11
 13150*    MOVE '&"IL       EU         (  N#00012489' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 251
* EL156.cbl
 13151     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13152     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13153     MOVE X'204E233030303132343839' TO DFHEIV0(25:11)
 13154     CALL 'kxdfhei1' USING DFHEIV0,
 13155           ELCRTT-DSID,
 13156           CERTIFICATE-TRAILERS,
 13157           DFHEIV11,
 13158           ELCRTT-KEY,
 13159           DFHEIV99,
 13160           DFHEIV99,
 13161           DFHEIV99
 13162     MOVE EIBRESP  TO WS-RESPONSE
 13163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13164
 13165     IF WS-RESP-NORMAL
 13166        perform 2225-upd-crt-trlr thru 2225-exit
 13167
 13168* EXEC CICS REWRITE
 13169*          DATASET  (ELCRTT-DSID)
 13170*          from     (CERTIFICATE-TRAILERS)
 13171*          RESP     (WS-RESPONSE)
 13172*       END-EXEC
 13173     MOVE LENGTH OF
 13174      CERTIFICATE-TRAILERS
 13175       TO DFHEIV11
 13176*    MOVE '&& L                  %  N#00012499' TO DFHEIV0
 13177     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13178     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13179     MOVE X'204E233030303132343939' TO DFHEIV0(25:11)
 13180     CALL 'kxdfhei1' USING DFHEIV0,
 13181           ELCRTT-DSID,
 13182           CERTIFICATE-TRAILERS,
 13183           DFHEIV11,
 13184           DFHEIV99
 13185     MOVE EIBRESP  TO WS-RESPONSE
 13186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13187     else
 13188        if ws-resp-notfnd
 13189           move 'CS'             to certificate-trailers
 13190           move cl-company-cd    to cs-company-cd
 13191           move cl-cert-key-data to cs-control-primary (2:21)
 13192           move cl-cert-no       to cs-cert-no
 13193           move 'B'              to cs-trailer-type
 13194           perform varying s1 from +1 by +1 until s1 > +24
 13195              move zeros         to cs-benefit-period (s1)
 13196                                    cs-days-paid (s1)
 13197                                    cs-total-paid (s1)
 13198                                    cs-remaining-bens (s1)
 13199           end-perform
 13200           perform 2225-upd-crt-trlr
 13201                                 thru 2225-exit
 13202
 13203* EXEC CICS WRITE
 13204*             DATASET  (ELCRTT-DSID)
 13205*             from     (CERTIFICATE-TRAILERS)
 13206*             RIDFLD   (cs-control-primary)
 13207*             RESP     (WS-RESPONSE)
 13208*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 252
* EL156.cbl
 13209     MOVE LENGTH OF
 13210      CERTIFICATE-TRAILERS
 13211       TO DFHEIV11
 13212*    MOVE '&$ L                  ''  N#00012519' TO DFHEIV0
 13213     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13214     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13215     MOVE X'204E233030303132353139' TO DFHEIV0(25:11)
 13216     CALL 'kxdfhei1' USING DFHEIV0,
 13217           ELCRTT-DSID,
 13218           CERTIFICATE-TRAILERS,
 13219           DFHEIV11,
 13220           cs-control-primary,
 13221           DFHEIV99,
 13222           DFHEIV99
 13223     MOVE EIBRESP  TO WS-RESPONSE
 13224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13225        end-if
 13226     END-IF
 13227
 13228     .
 13229 2220-exit.
 13230     exit.
 13231
 13232 2225-upd-crt-trlr.
 13233
 13234*    if instypei = 'P'
 13235*       move +1 to s1
 13236*    else
 13237*       MOVE +2 to s1
 13238*    end-if
 13239
 13240*    move +1 to s1
 13241*    evaluate cl-claim-type
 13242*       when 'A'
 13243*          move +1 to s2
 13244*       when 'I'
 13245*          move +2 to s2
 13246*       when 'G'
 13247*          move +3 to s2
 13248*       when 'L'
 13249*          move +4 to s2
 13250*       when 'P'
 13251*          move +5 to s2
 13252*    end-evaluate
 13253     perform varying s1 from +1 by +1 until
 13254        (s1 > +24)
 13255        or (cl-claim-no = cs-claim-no (s1))
 13256     end-perform
 13257     if s1 < +25
 13258        compute cs-total-paid (s1) =
 13259           cs-total-paid (s1) + at-amount-paid
 13260        compute cs-days-paid (s1) =
 13261           cs-days-paid (s1) +  at-days-in-period
 13262*       compute cs-remaining-bens (s1) =
 13263*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13264        perform 2230-accum-bens-paid thru 2230-exit
 13265     end-if
 13266
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 253
* EL156.cbl
 13267     .
 13268 2225-exit.
 13269     exit.
 13270 2230-accum-bens-paid.
 13271     if cl-claim-type not = 'L' and 'P'
 13272        move pi-ah-term          to ws-max-bens
 13273        if cl-critical-period not = zeros and spaces
 13274           move cl-critical-period
 13275                                 to ws-max-bens
 13276        end-if
 13277     else
 13278        move 01                  to ws-max-bens
 13279     end-if
 13280     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13281     perform varying s2 from +1 by +1 until
 13282        (s2 > +24)
 13283        or (cs-claim-no (s2) = spaces)
 13284        if pi-company-id not = 'DCC'
 13285           if cs-claim-type (s2) = cl-claim-type
 13286              compute ws-tot-days-paid =
 13287                 ws-tot-days-paid + cs-days-paid (s2)
 13288              compute ws-tot-amt-paid =
 13289                 ws-tot-amt-paid + cs-total-paid (s2)
 13290           end-if
 13291        else
 13292           if (cs-benefit-period (s2) = cl-benefit-period)
 13293              and (cs-claim-type (s2) = cl-claim-type)
 13294              and (cs-insured-type (s2) = cl-insured-type)
 13295              compute ws-tot-days-paid =
 13296                 ws-tot-days-paid + cs-days-paid (s2)
 13297              compute ws-tot-amt-paid =
 13298                 ws-tot-amt-paid + cs-total-paid (s2)
 13299           end-if
 13300        end-if
 13301     end-perform
 13302     if cl-claim-type = 'L' and 'P'
 13303        if ws-tot-amt-paid > zeros
 13304           move zeros            to cs-remaining-bens (s1)
 13305        else
 13306           move 01               to cs-remaining-bens (s1)
 13307        end-if
 13308     else
 13309        compute ws-pd-bens rounded =
 13310           ws-tot-amt-paid / pi-ah-benefit-amt
 13311        compute cs-remaining-bens (s1) =
 13312           ws-max-bens - ws-pd-bens
 13313        if cs-remaining-bens (s1) < zeros
 13314           move zeros            to cs-remaining-bens (s1)
 13315        end-if
 13316     end-if
 13317     .
 13318 2230-exit.
 13319     exit.
 13320 3000-MOVE-INPUT-TO-SAVE-AREA.
 13321     IF PMTTYPEL > 0
 13322         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13323
 13324     MOVE SPACES                 TO PI-PROVISIONAL-IND.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 254
* EL156.cbl
 13325
 13326     IF WS-PMTTYPE = '9'
 13327         MOVE 'P'                TO PI-PROVISIONAL-IND
 13328         MOVE '1'                TO WS-PMTTYPE.
 13329
 13330     IF PAYEEL > 0
 13331         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13332         MOVE PAYEEI             TO WS-PAYEE.
 13333
 13334     IF NOTE1L > +0
 13335         MOVE NOTE1I             TO WS-PMTNOTE1
 13336                                    WS-FLI-PMTNOTE
 13337                                    WS-HAN-PMTNOTE.
 13338
 13339     IF NOTE2L > +0
 13340         MOVE NOTE2I             TO WS-PMTNOTE2.
 13341
 13342     IF OFFLINEL > 0
 13343         MOVE OFFLINEI           TO WS-OFFLINE.
 13344
 13345     IF PROOFDTL > 0
 13346         MOVE PROOFDTI            TO DATE-WORK
 13347         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13348         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13349         MOVE '4'                 TO DC-OPTION-CODE
 13350         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13351         IF NO-CONVERSION-ERROR
 13352            MOVE NUM-WORK         TO PROOFDTO
 13353            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13354            MOVE NUM-WORK         TO WS-PROOF-DATE
 13355         ELSE
 13356            MOVE ZEROS            TO WS-PROOF-DATE
 13357         END-IF
 13358     END-IF.
 13359
 13360     IF EOBYNL > +0
 13361         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13362         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13363     END-IF
 13364
 13365     IF CLMFMYNL > +0
 13366         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13367         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13368     END-IF
 13369
 13370     IF SURVYYNL > +0
 13371         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13372         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13373     END-IF
 13374
 13375     IF SPRELYNL > +0
 13376         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13377         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13378     END-IF
 13379*    IF GROUPEDL > +0
 13380*        MOVE GROUPEDI           TO WS-GROUPED.
 13381*
 13382*    IF CASHL > +0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 255
* EL156.cbl
 13383*       MOVE CASHI               TO WS-CASH.
 13384     IF LOANNOL > +0
 13385         MOVE LOANNOI            TO WS-LOAN-NO.
 13386
 13387     IF CHECKNOL > 0
 13388         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13389
 13390     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13391         IF WS-AIG-CREDIT-ENTERED
 13392             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13393             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13394             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13395             MOVE AL-UANON         TO CHECKNOA.
 13396
 13397     IF HOLDTILL > 0
 13398         MOVE HOLDTILI           TO DATE-WORK
 13399         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13400         MOVE NUM-WORK           TO WS-HOLDTIL.
 13401
 13402     IF ZINTL > +0
 13403
 13404* EXEC CICS BIF DEEDIT
 13405*           FIELD   (ZINTI)
 13406*           LENGTH  (07)
 13407*       END-EXEC
 13408     MOVE 07
 13409       TO DFHEIV11
 13410*    MOVE '@"L                   #   #00012703' TO DFHEIV0
 13411     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13412     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13413     MOVE X'2020233030303132373033' TO DFHEIV0(25:11)
 13414     CALL 'kxdfhei1' USING DFHEIV0,
 13415           ZINTI,
 13416           DFHEIV11
 13417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13418        IF ZINTI NOT NUMERIC
 13419           MOVE ER-0419          TO EMI-ERROR
 13420           PERFORM 9900-ERROR-FORMAT
 13421           MOVE AL-UABON         TO ZINTA
 13422           MOVE -1               TO ZINTL
 13423        ELSE
 13424           MOVE ZINTI            TO CP-INT-RATE
 13425                                    WS-INT-RATE
 13426           MOVE CP-INT-RATE      TO ZINTO
 13427           MOVE AL-UNNON         TO ZINTA
 13428        END-IF
 13429     ELSE
 13430        MOVE ZEROS               TO CP-INT-RATE
 13431     END-IF
 13432     IF EPYFROML > 0
 13433         MOVE EPYFROMI           TO DATE-WORK
 13434         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13435         MOVE NUM-WORK           TO WS-EPYFROM.
 13436
 13437     IF AIGFROML > 0
 13438         MOVE AIGFROMI           TO DATE-WORK
 13439         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13440         MOVE NUM-WORK           TO WS-AIGFROM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 256
* EL156.cbl
 13441     ELSE
 13442         IF (AIGFROMI = LOW-VALUES) AND
 13443            (PI-AIGFROM NOT = ZEROS)
 13444              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13445
 13446     IF EPYTHRUL > +0
 13447        MOVE EPYTHRUI           TO DATE-WORK
 13448        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13449        MOVE NUM-WORK           TO WS-EPYTHRU
 13450        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13451        MOVE '4'                TO DC-OPTION-CODE
 13452        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13453        IF NO-CONVERSION-ERROR
 13454           IF PI-USES-PAID-TO
 13455              MOVE '6'                TO DC-OPTION-CODE
 13456              MOVE -1                 TO DC-ELAPSED-DAYS
 13457              MOVE +0                 TO DC-ELAPSED-MONTHS
 13458              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13459              IF NO-CONVERSION-ERROR
 13460                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13461                 MOVE ' '             TO DC-OPTION-CODE
 13462                 MOVE +0              TO DC-ELAPSED-DAYS
 13463                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13464              IF NO-CONVERSION-ERROR
 13465                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13466
 13467*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13468*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13469     IF EDAYSL > 0
 13470
 13471* EXEC CICS BIF DEEDIT
 13472*            FIELD(EDAYSI)
 13473*            LENGTH(6)
 13474*        END-EXEC
 13475     MOVE 6
 13476       TO DFHEIV11
 13477*    MOVE '@"L                   #   #00012759' TO DFHEIV0
 13478     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13479     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13480     MOVE X'2020233030303132373539' TO DFHEIV0(25:11)
 13481     CALL 'kxdfhei1' USING DFHEIV0,
 13482           EDAYSI,
 13483           DFHEIV11
 13484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13485         MOVE EDAYSI             TO WS-DY-WORK
 13486         IF WS-DY-SIGN = SPACES
 13487            MOVE WS-DY-NUM       TO WS-EDAYS
 13488            ADD 0                TO WS-EDAYS
 13489         ELSE
 13490            MOVE EDAYSI          TO WS-EDAYS
 13491            ADD 0                TO WS-EDAYS.
 13492
 13493*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13494*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13495     IF EPYAMTL > 0
 13496
 13497* EXEC CICS BIF DEEDIT
 13498*            FIELD(EPYAMTI)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 257
* EL156.cbl
 13499*            LENGTH(10)
 13500*        END-EXEC
 13501     MOVE 10
 13502       TO DFHEIV11
 13503*    MOVE '@"L                   #   #00012774' TO DFHEIV0
 13504     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13505     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13506     MOVE X'2020233030303132373734' TO DFHEIV0(25:11)
 13507     CALL 'kxdfhei1' USING DFHEIV0,
 13508           EPYAMTI,
 13509           DFHEIV11
 13510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13511         MOVE EPYAMTI            TO WS-PY-WORK
 13512         IF WS-PY-SIGN = SPACES
 13513            MOVE WS-PY-NUM       TO WS-EPYAMT
 13514            ADD 0                TO WS-EPYAMT
 13515         ELSE
 13516            MOVE EPYAMTI         TO WS-EPYAMT
 13517            ADD 0                TO WS-EPYAMT.
 13518
 13519     IF ERESVL > 0
 13520
 13521* EXEC CICS BIF DEEDIT
 13522*            FIELD(ERESVI)
 13523*            LENGTH(9)
 13524*        END-EXEC
 13525     MOVE 9
 13526       TO DFHEIV11
 13527*    MOVE '@"L                   #   #00012787' TO DFHEIV0
 13528     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13529     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13530     MOVE X'2020233030303132373837' TO DFHEIV0(25:11)
 13531     CALL 'kxdfhei1' USING DFHEIV0,
 13532           ERESVI,
 13533           DFHEIV11
 13534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13535         MOVE ERESVI TO WS-ERESV.
 13536
 13537     IF EEXPENSL > 0
 13538
 13539* EXEC CICS BIF DEEDIT
 13540*            FIELD(EEXPENSI)
 13541*            LENGTH(8)
 13542*        END-EXEC
 13543     MOVE 8
 13544       TO DFHEIV11
 13545*    MOVE '@"L                   #   #00012794' TO DFHEIV0
 13546     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13547     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13548     MOVE X'2020233030303132373934' TO DFHEIV0(25:11)
 13549     CALL 'kxdfhei1' USING DFHEIV0,
 13550           EEXPENSI,
 13551           DFHEIV11
 13552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13553         MOVE EEXPENSI           TO WS-EEXPENS.
 13554
 13555     IF ETYPEL > ZEROS
 13556         MOVE ETYPEI             TO WS-ETYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 258
* EL156.cbl
 13557
 13558     IF PI-COMPANY-ID = 'BOA'
 13559        IF PINTL > ZEROS
 13560
 13561* EXEC CICS BIF DEEDIT
 13562*            FIELD (PINTI)
 13563*            LENGTH(05)
 13564*          END-EXEC
 13565     MOVE 05
 13566       TO DFHEIV11
 13567*    MOVE '@"L                   #   #00012805' TO DFHEIV0
 13568     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13569     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13570     MOVE X'2020233030303132383035' TO DFHEIV0(25:11)
 13571     CALL 'kxdfhei1' USING DFHEIV0,
 13572           PINTI,
 13573           DFHEIV11
 13574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13575           IF PINTI NUMERIC
 13576               MOVE AL-UNNON     TO PINTA
 13577               MOVE PINTI        TO WS-INT-RATE
 13578               MOVE WS-INT-RATE  TO PINTO.
 13579
 13580 3000-EXIT.
 13581     EXIT.
 13582
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 259
* EL156.cbl
 13584 3050-REBUILD-ENTERED.
 13585
 13586     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13587
 13588     IF PI-PROV-PMT
 13589         MOVE '9'           TO PMTTYPEO
 13590     ELSE
 13591         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13592
 13593     MOVE PI-PAYEE          TO PAYEEO.
 13594     MOVE PI-PMTNOTE1       TO NOTE1O.
 13595     MOVE PI-PMTNOTE2       TO NOTE2O.
 13596     MOVE PI-OFFLINE        TO OFFLINEO.
 13597     IF PI-PROOF-DATE NOT = ZEROS
 13598         MOVE PI-PROOF-DATE TO PROOFDTO
 13599         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13600     END-IF.
 13601*    MOVE PI-GROUPED        TO GROUPEDO.
 13602
 13603*    MOVE PI-CASH           TO CASHO.
 13604
 13605     IF PI-INT-RATE > ZEROS
 13606         MOVE PI-INT-RATE   TO PINTO.
 13607
 13608     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13609        IF PI-INT-AMT > ZEROS
 13610           MOVE PI-INT-AMT       TO PINTO
 13611           MOVE AL-PANOF         TO PINTA
 13612                                    PINTHA
 13613        END-IF
 13614     END-IF
 13615     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13616     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13617     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13618     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13619     IF PI-HOLDTIL NOT = ZEROS
 13620        MOVE PI-HOLDTIL          TO HOLDTILO
 13621        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13622
 13623     IF PI-EPYFROM NOT = ZEROS
 13624        MOVE PI-EPYFROM          TO EPYFROMO
 13625        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13626
 13627     IF PI-AIGFROM NOT = ZEROS
 13628        MOVE PI-AIGFROM          TO AIGFROMO
 13629        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13630
 13631     IF PI-EPYTHRU NOT = ZEROS
 13632        MOVE PI-EPYTHRU          TO EPYTHRUO
 13633        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13634        IF PI-USES-PAID-TO
 13635           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13636           MOVE '4'                TO DC-OPTION-CODE
 13637           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13638           IF NO-CONVERSION-ERROR
 13639              MOVE +1 TO DC-ELAPSED-DAYS
 13640              MOVE +0 TO DC-ELAPSED-MONTHS
 13641              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 260
* EL156.cbl
 13642              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13643              IF NO-CONVERSION-ERROR
 13644                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13645
 13646     IF PI-EDAYS NOT = ZEROS
 13647        MOVE PI-EDAYS TO EDAYSO.
 13648
 13649     IF PI-EPYAMT NOT = ZEROS
 13650        MOVE PI-EPYAMT TO EPYAMTO.
 13651
 13652     IF PI-ERESV NOT = ZEROS
 13653        MOVE PI-ERESV TO ERESVO.
 13654
 13655     IF PI-EEXPENS NOT = ZEROS
 13656        MOVE PI-EEXPENS TO EEXPENSO.
 13657
 13658     MOVE PI-ETYPE TO ETYPEO.
 13659
 13660     IF PI-ECHECKNO NOT = SPACES
 13661        MOVE PI-ECHECKNO         TO CHECKNOO
 13662     ELSE
 13663        MOVE PI-CCHECKNO         TO CHECKNOO.
 13664
 13665     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13666     MOVE SPACES                 TO DC-OPTION-CODE.
 13667     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13668
 13669     IF DATE-CONVERSION-ERROR
 13670        MOVE SPACES              TO CPYFROMI
 13671     ELSE
 13672        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13673
 13674     IF PI-USES-PAID-TO
 13675        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13676        MOVE +1                  TO DC-ELAPSED-DAYS
 13677        MOVE +0                  TO DC-ELAPSED-MONTHS
 13678        MOVE '6'                 TO DC-OPTION-CODE
 13679        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13680        IF NO-CONVERSION-ERROR
 13681           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13682           GO TO 3051-CONTINUE.
 13683
 13684     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13685     MOVE SPACES                 TO DC-OPTION-CODE.
 13686     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13687
 13688     IF DATE-CONVERSION-ERROR
 13689        MOVE SPACES              TO CPYTHRUI
 13690     ELSE
 13691        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13692
 13693 3051-CONTINUE.
 13694
 13695     IF PI-CDAYS NOT = ZEROS
 13696        MOVE PI-CDAYS TO CDAYSO.
 13697
 13698     IF PI-CPYAMT NOT = ZEROS
 13699        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 261
* EL156.cbl
 13700
 13701     IF PI-CRESV NOT = ZEROS
 13702        MOVE PI-CRESV TO CRESVO.
 13703
 13704     IF PI-CEXPENS NOT = ZEROS
 13705        MOVE PI-CEXPENS TO CEXPENSO.
 13706
 13707 3059-EXIT.
 13708     EXIT.
 13709
 13710 3100-DEEDIT-DATE.
 13711
 13712* EXEC CICS BIF DEEDIT
 13713*        FIELD(DATE-WORK)
 13714*        LENGTH(8)
 13715*    END-EXEC.
 13716     MOVE 8
 13717       TO DFHEIV11
 13718*    MOVE '@"L                   #   #00012945' TO DFHEIV0
 13719     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13720     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13721     MOVE X'2020233030303132393435' TO DFHEIV0(25:11)
 13722     CALL 'kxdfhei1' USING DFHEIV0,
 13723           DATE-WORK,
 13724           DFHEIV11
 13725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13726
 13727
 13728 3100-EXIT.
 13729     EXIT.
 13730
 13731 3200-CALC-AIG-DAYS.
 13732
 13733     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13734
 13735     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13736     MOVE ' '                    TO DC-OPTION-CODE.
 13737     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13738     IF NO-CONVERSION-ERROR
 13739         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13740     ELSE
 13741         GO TO 3290-ERROR.
 13742
 13743     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13744         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13745                                WS-BIN-FROM-DT
 13746     ELSE
 13747         IF CL-TOTAL-PAID-AMT > ZEROS
 13748             IF WS-SV-EPYFROM = LOW-VALUES
 13749                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13750                                        WS-BIN-FROM-DT
 13751             ELSE
 13752                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13753                                        WS-BIN-FROM-DT
 13754         ELSE
 13755             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13756                                        WS-BIN-FROM-DT.
 13757
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 262
* EL156.cbl
 13758 3210-CONTINUE.
 13759
 13760     MOVE ' '                    TO DC-OPTION-CODE.
 13761     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13762     IF DATE-CONVERSION-ERROR
 13763         GO TO 3290-ERROR.
 13764
 13765     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13766
 13767     IF PI-LOAN-DUE-DAY = 31
 13768         MOVE 30              TO WS-PMT-DUE-DA
 13769                                 WS-SAVE-DUE-DA
 13770     ELSE
 13771         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13772                                 WS-SAVE-DUE-DA.
 13773
 13774     IF (PI-LOAN-DUE-DAY > 28) AND
 13775        (WS-PMT-DUE-MO = 2)
 13776         MOVE 'Y'                TO WS-DUE-DAY-SW
 13777         MOVE 28                 TO WS-PMT-DUE-DA.
 13778
 13779     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13780     MOVE '4'                    TO DC-OPTION-CODE.
 13781     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13782     IF NO-CONVERSION-ERROR
 13783         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13784     ELSE
 13785         GO TO 3290-ERROR.
 13786
 13787*--------------------------------------------------------------*
 13788*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13789*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13790*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13791*                                                              *
 13792*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13793*             INCURRED DATE      - 04/15/91                    *
 13794*             PMT DUE DATE       - 04/03/91                    *
 13795*             PMT DUE DATE       - 05/03/91                    *
 13796*--------------------------------------------------------------*
 13797
 13798     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13799        (WS-SV-AIGFROM = LOW-VALUES)
 13800         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13801            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13802             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13803             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13804             IF NO-CONVERSION-ERROR
 13805                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13806                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13807             ELSE
 13808                 GO TO 3290-ERROR.
 13809
 13810     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13811        (WS-SV-AIGFROM = LOW-VALUES)
 13812         GO TO 3205-CONT-CALC-PMT.
 13813
 13814     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13815     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 263
* EL156.cbl
 13816     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13817     IF NO-CONVERSION-ERROR
 13818         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13819     ELSE
 13820         GO TO 3290-ERROR.
 13821
 13822     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13823        (WS-PMT-DUE-DA < WS-FROM-DA)
 13824          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13825          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13826          IF NO-CONVERSION-ERROR
 13827              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13828              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13829          ELSE
 13830              GO TO 3290-ERROR.
 13831
 13832 3205-CONT-CALC-PMT.
 13833
 13834*--------------------------------------------------------------*
 13835*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13836*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13837*--------------------------------------------------------------*
 13838
 13839     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13840        PI-PMTTYPE = '2'
 13841          NEXT SENTENCE
 13842     ELSE
 13843        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13844           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13845             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13846             MOVE ER-3527            TO EMI-ERROR
 13847             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13848             MOVE -1                 TO EPYTHRUL
 13849             MOVE AL-UNBON           TO EPYTHRUA
 13850                                        EPYFROMA
 13851             GO TO 3299-EXIT.
 13852
 13853*--------------------------------------------------------------*
 13854*    CALCULATE RETRO ELIMINATION DATE                          *
 13855*--------------------------------------------------------------*
 13856
 13857     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13858         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13859     ELSE
 13860         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13861
 13862     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13863     MOVE +0             TO DC-ELAPSED-MONTHS.
 13864     MOVE '6'            TO DC-OPTION-CODE.
 13865     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13866     IF NO-CONVERSION-ERROR
 13867         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13868     ELSE
 13869         GO TO 3290-ERROR.
 13870
 13871 3210-CHECK-PMT-DATE.
 13872
 13873*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 264
* EL156.cbl
 13874*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13875*    THE ENTERED PAY FROM DATE                                 *
 13876*--------------------------------------------------------------*
 13877
 13878     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13879         NEXT SENTENCE
 13880     ELSE
 13881         GO TO 3220-COMPUTE-DAYS.
 13882
 13883     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13884     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13885     IF NO-CONVERSION-ERROR
 13886         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13887         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13888         GO TO 3210-CHECK-PMT-DATE
 13889     ELSE
 13890         GO TO 3290-ERROR.
 13891
 13892 3220-COMPUTE-DAYS.
 13893
 13894     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13895     MOVE ZEROS         TO WS-CDAYS.
 13896     MOVE 'N'           TO WS-ELIMINATION-SW.
 13897
 13898*--------------------------------------------------------------*
 13899*    COMPUTE CALIFORNIA DUE DAYS                               *
 13900*--------------------------------------------------------------*
 13901
 13902     IF CL-TOTAL-PAID-AMT > ZEROS
 13903         MOVE 'Y' TO WS-ELIMINATION-SW
 13904         GO TO 3240-FIRST-PMT-DUE
 13905     ELSE
 13906        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13907            NEXT SENTENCE
 13908        ELSE
 13909            GO TO 3240-FIRST-PMT-DUE.
 13910
 13911 3230-NEXT-PMT-DUE.
 13912
 13913     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13914     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13915     IF NO-CONVERSION-ERROR
 13916         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13917         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13918     ELSE
 13919         GO TO 3290-ERROR.
 13920
 13921 3240-FIRST-PMT-DUE.
 13922
 13923     IF CL-TOTAL-PAID-AMT > ZEROS
 13924         NEXT SENTENCE
 13925     ELSE
 13926        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13927            GO TO 3230-NEXT-PMT-DUE.
 13928
 13929     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13930         GO TO 3250-VERIFY-ELIMINATION.
 13931
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 265
* EL156.cbl
 13932     ADD +30 TO WS-CDAYS.
 13933     MOVE 'Y' TO WS-ELIMINATION-SW.
 13934     GO TO 3230-NEXT-PMT-DUE.
 13935
 13936 3250-VERIFY-ELIMINATION.
 13937
 13938     IF ELIM-SATISFIED
 13939         GO TO 3260-END-CALC.
 13940
 13941     IF PI-PMTTYPE = '1'
 13942         MOVE ZEROS TO WS-CDAYS
 13943         GO TO 3260-END-CALC.
 13944
 13945     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13946         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13947     ELSE
 13948         IF CL-TOTAL-PAID-AMT > ZEROS
 13949             IF WS-SV-EPYFROM = LOW-VALUES
 13950                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13951             ELSE
 13952                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13953         ELSE
 13954             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13955
 13956     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13957     MOVE '1'                    TO DC-OPTION-CODE.
 13958     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13959     IF NO-CONVERSION-ERROR
 13960         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13961     ELSE
 13962         GO TO 3290-ERROR.
 13963
 13964     IF CL-TOTAL-PAID-AMT > ZEROS
 13965         MOVE WS-DAYS-OFF TO WS-CDAYS
 13966     ELSE
 13967         IF PI-BEN-DAYS > WS-DAYS-OFF
 13968             MOVE ZEROS TO WS-CDAYS
 13969         ELSE
 13970             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13971
 13972 3260-END-CALC.
 13973
 13974     MOVE WS-CDAYS TO PI-CDAYS.
 13975
 13976     IF PI-EDAYS = ZEROS
 13977         MOVE PI-CDAYS TO PI-EDAYS
 13978         MOVE AL-UNNON TO EDAYSA.
 13979
 13980     GO TO 3299-EXIT.
 13981
 13982 3290-ERROR.
 13983
 13984     MOVE ER-3528            TO EMI-ERROR.
 13985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13986     MOVE -1                 TO CDAYSL.
 13987     MOVE AL-UNBON           TO CDAYSA.
 13988
 13989 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 266
* EL156.cbl
 13990     EXIT.
 13991
 13992 3300-BUMP-DATE.
 13993
 13994     IF WS-RESTORE-DUE-DAY
 13995         MOVE 'N'              TO WS-DUE-DAY-SW
 13996         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13997         ADD 1                 TO WS-PMT-DUE-MO
 13998         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13999         MOVE '4'              TO DC-OPTION-CODE
 14000         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14001         IF NO-CONVERSION-ERROR
 14002             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14003             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14004             GO TO 3399-EXIT
 14005         ELSE
 14006             MOVE '9'          TO DC-ERROR-CODE
 14007             GO TO 3399-EXIT.
 14008
 14009     IF (WS-PMT-DUE-MO = 1) AND
 14010        (WS-SAVE-DUE-DA > 28)
 14011           MOVE 'Y' TO WS-DUE-DAY-SW.
 14012
 14013     MOVE +0                 TO DC-ELAPSED-DAYS.
 14014     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14015     MOVE '6'                TO DC-OPTION-CODE.
 14016     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14017
 14018 3399-EXIT.
 14019     EXIT.
 14020
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 267
* EL156.cbl
 14022 3400-COMPUTE-EXPIRY.
 14023
 14024     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14025     MOVE +0                    TO DC-ELAPSED-DAYS
 14026                                   DC-ODD-DAYS-OVER.
 14027     MOVE '1'                   TO DC-END-OF-MONTH.
 14028     MOVE '6'                   TO DC-OPTION-CODE.
 14029
 14030     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14031         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14032     ELSE
 14033         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14034
 14035     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14036     IF NO-CONVERSION-ERROR
 14037         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14038     ELSE
 14039         GO TO 3390-CONTINUE.
 14040
 14041     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14042         GO TO 3390-CONTINUE.
 14043
 14044     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14045     MOVE '4'                    TO CNTL-REC-TYPE.
 14046     MOVE +0                     TO CNTL-SEQ-NO.
 14047     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14048     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14049     MOVE 'BENE'                 TO FILE-SWITCH.
 14050
 14051     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14052
 14053     IF NO-BENEFIT-FOUND
 14054         GO TO 3390-CONTINUE.
 14055
 14056     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14057        IF (PI-OFFLINE = 'Y') OR
 14058           (PI-PMTTYPE = '7')
 14059           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14060                                     THRU 9870-EXIT
 14061           IF ERROR-ON-OUTPUT
 14062             MOVE -1                 TO ENTERPFL
 14063             MOVE AL-UANON           TO ENTERPFA
 14064             MOVE MAP-NAMEA          TO MAP-NAME
 14065             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14066             GO TO 8200-SEND-DATAONLY.
 14067
 14068     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14069        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14070        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14071          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14072          MOVE +0        TO DC-ELAPSED-DAYS
 14073          MOVE +1        TO DC-ELAPSED-MONTHS
 14074          MOVE 6         TO DC-OPTION-CODE
 14075          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14076          IF NO-CONVERSION-ERROR
 14077              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14078
 14079 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 268
* EL156.cbl
 14080
 14081      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14082         MOVE CM-AH-LOAN-EXPIRE-DT
 14083                                 TO DC-BIN-DATE-1
 14084      ELSE
 14085         MOVE CM-LF-LOAN-EXPIRE-DT
 14086                                 TO DC-BIN-DATE-1
 14087      END-IF
 14088
 14089      MOVE ' '                    TO DC-OPTION-CODE.
 14090      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14091      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14092      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14093
 14094 3499-EXIT.
 14095     EXIT.
 14096
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 269
* EL156.cbl
 14098
 14099 3600-CHECK-VERIFICATION.
 14100
 14101     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14102
 14103     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14104
 14105     IF PI-PAYEE-TYPE = 'I'
 14106        GO TO 3600-READ-TRAILER.
 14107
 14108     IF PI-PAYEE-TYPE = 'B'
 14109        ADD +10                  TO TRLR-SEQ-NO
 14110        GO TO 3600-READ-TRAILER.
 14111
 14112     IF PI-PAYEE-TYPE = 'A'
 14113        ADD +20                  TO TRLR-SEQ-NO
 14114        GO TO 3600-READ-TRAILER.
 14115
 14116     IF PI-PAYEE-TYPE = 'O'
 14117        ADD +50                  TO TRLR-SEQ-NO
 14118        GO TO 3600-READ-TRAILER.
 14119
 14120     IF PI-PAYEE-TYPE = 'Q'
 14121        ADD +60                  TO TRLR-SEQ-NO
 14122        GO TO 3600-READ-TRAILER.
 14123
 14124     IF PI-PAYEE-TYPE = 'P'
 14125        ADD +30                  TO TRLR-SEQ-NO
 14126        GO TO 3600-READ-TRAILER.
 14127
 14128     IF PI-PAYEE-TYPE = 'E'
 14129        ADD +40                  TO TRLR-SEQ-NO.
 14130
 14131 3600-READ-TRAILER.
 14132
 14133
 14134* EXEC CICS HANDLE CONDITION
 14135*         NOTFND(3600-CONTINUE)
 14136*    END-EXEC.
 14137*    MOVE '"$I                   ! - #00013355' TO DFHEIV0
 14138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14140     MOVE X'2D20233030303133333535' TO DFHEIV0(25:11)
 14141     CALL 'kxdfhei1' USING DFHEIV0
 14142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14143
 14144
 14145     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14146
 14147 3600-CONTINUE.
 14148
 14149     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14150         GO TO 3600-AH-VERIFY
 14151     END-IF.
 14152
 14153     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14154       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14155         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 270
* EL156.cbl
 14156           MOVE ER-7576            TO EMI-ERROR
 14157           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14158           MOVE -1                 TO PAYEEL
 14159           MOVE AL-UABON           TO PAYEEA
 14160           GO TO 3600-EXIT
 14161         END-IF
 14162       END-IF
 14163     END-IF.
 14164
 14165     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14166     MOVE 1 TO WS-SUB2
 14167     MOVE SPACES TO WS-PAYEE-NAME
 14168     PERFORM VARYING WS-SUB FROM 1 BY 1
 14169             UNTIL WS-SUB > 30
 14170         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14171            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14172                 WS-PAYEE-NAME-X (WS-SUB2)
 14173            ADD +1 TO WS-SUB2
 14174         END-IF
 14175     END-PERFORM.
 14176
 14177     STRING CL-INSURED-1ST-NAME
 14178            CL-INSURED-MID-INIT
 14179            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14180     MOVE 1 TO WS-SUB2
 14181     MOVE SPACES TO WS-INSURED-NAME
 14182     PERFORM VARYING WS-SUB FROM 1 BY 1
 14183             UNTIL WS-SUB > 30
 14184         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14185            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14186                 WS-INSURED-NAME-X (WS-SUB2)
 14187            ADD +1 TO WS-SUB2
 14188         END-IF
 14189     END-PERFORM.
 14190
 14191     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14192        MOVE ER-7579            TO EMI-ERROR
 14193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14194        MOVE -1                 TO PAYEEL
 14195        MOVE AL-UABON           TO PAYEEA
 14196     END-IF.
 14197
 14198     IF PI-PMTTYPE = '4'  AND
 14199        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14200        PI-PAYEE-TYPE <> 'I'
 14201          MOVE ER-7580          TO EMI-ERROR
 14202          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14203          MOVE -1               TO PAYEEL
 14204          MOVE AL-UABON         TO PAYEEA
 14205     END-IF.
 14206
 14207     GO TO 3600-EXIT.
 14208
 14209 3600-AH-VERIFY.
 14210
 14211     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14212        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14213           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 271
* EL156.cbl
 14214           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14215           MOVE -1                 TO PAYEEL
 14216           MOVE AL-UABON           TO PAYEEA
 14217        END-IF
 14218     END-IF.
 14219
 14220
 14221 3600-EXIT.
 14222     EXIT.
 14223
 14224 5000-UPDATE.
 14225
 14226     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14227
 14228     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14229
 14230     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14231        PI-OFFLINE = 'Y'
 14232        NEXT SENTENCE
 14233     ELSE
 14234        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14235
 14236*    IF PI-COMPANY-ID = 'CRI'
 14237*       IF PI-PMTTYPE = '1' OR  '2'
 14238*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14239*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14240*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14241
 14242*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14243*       IF PI-PMTTYPE = '1'
 14244*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14245*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14246
 14247     IF PI-PMTTYPE      = '2' AND
 14248        PI-SPLIT-PMT-SW = 'Y' AND
 14249        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14250          MOVE ER-3530                TO EMI-ERROR
 14251          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14252
 14253     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14254        AND (CL-CLAIM-TYPE = 'L')
 14255        IF PI-PMTTYPE = '2' OR '4'
 14256           IF PI-INT-AMT NOT = ZEROS
 14257              PERFORM 7110-BUILD-PMT-TRLR
 14258                                 THRU 7130-EXIT
 14259           ELSE
 14260              IF PI-PMTTYPE = '2'
 14261                 PERFORM 7140-BUILD-NOTE-TRLR
 14262                                 THRU 7170-EXIT
 14263              END-IF
 14264           END-IF
 14265        END-IF
 14266     END-IF
 14267*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14268*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14269*            MOVE 'N'                 TO  WS-LETTER-SW.
 14270
 14271*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 272
* EL156.cbl
 14272*        IF CL-NO-OF-PMTS-MADE = +1
 14273*                OR
 14274*           PI-PMTTYPE = '2'
 14275*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14276
 14277     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14278
 14279*    IF PI-COMPANY-ID = 'DMD'
 14280*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14281*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14282
 14283
 14284* EXEC CICS REWRITE
 14285*         DATASET('ELMSTR')
 14286*         FROM(CLAIM-MASTER)
 14287*     END-EXEC.
 14288     MOVE LENGTH OF
 14289      CLAIM-MASTER
 14290       TO DFHEIV11
 14291     MOVE 'ELMSTR' TO DFHEIV1
 14292*    MOVE '&& L                  %   #00013497' TO DFHEIV0
 14293     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14294     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14295     MOVE X'2020233030303133343937' TO DFHEIV0(25:11)
 14296     CALL 'kxdfhei1' USING DFHEIV0,
 14297           DFHEIV1,
 14298           CLAIM-MASTER,
 14299           DFHEIV11,
 14300           DFHEIV99
 14301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14302
 14303
 14304     IF WS-LETTER-SW = 'N'
 14305         GO TO 5000-END-UPDATE.
 14306
 14307 5000-GENERATE-AUTO-LETTER.
 14308
 14309
 14310* EXEC CICS LINK
 14311*        PROGRAM    (LINK-1523)
 14312*        COMMAREA   (W-1523-LINKDATA)
 14313*        LENGTH     (W-1523-COMM-LENGTH)
 14314*    END-EXEC.
 14315*    MOVE '."C                   (   #00013507' TO DFHEIV0
 14316     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14318     MOVE X'2020233030303133353037' TO DFHEIV0(25:11)
 14319     CALL 'kxdfhei1' USING DFHEIV0,
 14320           LINK-1523,
 14321           W-1523-LINKDATA,
 14322           W-1523-COMM-LENGTH,
 14323           DFHEIV99,
 14324           DFHEIV99,
 14325           DFHEIV99,
 14326           DFHEIV99
 14327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14328
 14329
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 273
* EL156.cbl
 14330     IF W-1523-FATAL-ERROR
 14331         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14333         MOVE ER-0802                TO  EMI-ERROR
 14334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14335
 14336     IF W-1523-ERROR-CODE = 0191
 14337         MOVE ER-0803                TO  EMI-ERROR
 14338         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14339
 14340     IF PI-COMPANY-ID      = 'HAN' AND
 14341        PI-PMTTYPE         = '1'   AND
 14342        PI-3RD-PARTY-SW    = 'Y'   AND
 14343        W-1523-FORM-NUMBER = 'EOB1'
 14344           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14345           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14346           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14347           GO TO 5000-GENERATE-AUTO-LETTER.
 14348
 14349 5000-END-UPDATE.
 14350
 14351     MOVE ER-0000                TO EMI-ERROR.
 14352     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14353     GO TO 7000-SHOW-CLAIM.
 14354
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 274
* EL156.cbl
 14356 5000-MOVE-NAME.
 14357     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14358     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14359     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14360
 14361 5000-EXIT.
 14362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 275
* EL156.cbl
 14364 5300-CREATE-DMO.
 14365
 14366     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14367     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14368     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14369
 14370
 14371* EXEC CICS HANDLE CONDITION
 14372*         NOTFND   (5300-NOTE-NOT-FOUND)
 14373*    END-EXEC.
 14374*    MOVE '"$I                   ! . #00013553' TO DFHEIV0
 14375     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14376     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14377     MOVE X'2E20233030303133353533' TO DFHEIV0(25:11)
 14378     CALL 'kxdfhei1' USING DFHEIV0
 14379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14380
 14381
 14382
 14383* EXEC CICS READ
 14384*         DATASET('ERNOTE')
 14385*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14386*         RIDFLD (W-NOTE-KEY)
 14387*    END-EXEC.
 14388     MOVE 'ERNOTE' TO DFHEIV1
 14389*    MOVE '&"S        E          (   #00013557' TO DFHEIV0
 14390     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14391     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14392     MOVE X'2020233030303133353537' TO DFHEIV0(25:11)
 14393     CALL 'kxdfhei1' USING DFHEIV0,
 14394           DFHEIV1,
 14395           DFHEIV20,
 14396           DFHEIV99,
 14397           W-NOTE-KEY,
 14398           DFHEIV99,
 14399           DFHEIV99,
 14400           DFHEIV99
 14401     SET ADDRESS OF CERTIFICATE-NOTE TO
 14402         DFHEIV20
 14403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14404
 14405
 14406     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14407     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14408     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14409
 14410     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14411         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14412     ELSE
 14413         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14414
 14415     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14416     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14417     MOVE 'DLO006'               TO PGM-NAME.
 14418
 14419
 14420* EXEC CICS LINK
 14421*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 276
* EL156.cbl
 14422*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14423*        LENGTH     (DCT-RCRD-LENGTH)
 14424*    END-EXEC.
 14425*    MOVE '."C                   (   #00013576' TO DFHEIV0
 14426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14428     MOVE X'2020233030303133353736' TO DFHEIV0(25:11)
 14429     CALL 'kxdfhei1' USING DFHEIV0,
 14430           PGM-NAME,
 14431           DCT-COMMUNICATION-AREA,
 14432           DCT-RCRD-LENGTH,
 14433           DFHEIV99,
 14434           DFHEIV99,
 14435           DFHEIV99,
 14436           DFHEIV99
 14437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14438
 14439
 14440     IF DCT-RETURN-CODE = 'OK'
 14441         GO TO 5300-CONT.
 14442
 14443     IF DCT-RETURN-CODE = '01' OR '02'
 14444         GO TO 5300-EXIT.
 14445
 14446     IF DCT-RETURN-CODE = '03'
 14447         MOVE ER-0951            TO EMI-ERROR
 14448         GO TO 5300-BAD-EXIT.
 14449
 14450     IF DCT-RETURN-CODE = '04'
 14451         MOVE ER-0946            TO EMI-ERROR
 14452         GO TO 5300-BAD-EXIT.
 14453
 14454     IF DCT-RETURN-CODE = '05'
 14455         MOVE ER-0947            TO EMI-ERROR
 14456         GO TO 5300-BAD-EXIT.
 14457
 14458     IF DCT-RETURN-CODE = '06'
 14459         MOVE ER-0921            TO EMI-ERROR
 14460         GO TO 5300-BAD-EXIT.
 14461
 14462     IF DCT-RETURN-CODE = '07'
 14463         MOVE ER-0849            TO EMI-ERROR
 14464         GO TO 5300-BAD-EXIT.
 14465
 14466     IF DCT-RETURN-CODE = '08'
 14467         MOVE ER-0948            TO EMI-ERROR
 14468         GO TO 5300-BAD-EXIT.
 14469
 14470     IF DCT-RETURN-CODE = 'N1'
 14471         MOVE ER-0950            TO EMI-ERROR
 14472         GO TO 5300-BAD-EXIT.
 14473
 14474     IF DCT-RETURN-CODE = 'E1'
 14475         MOVE ER-0974            TO EMI-ERROR
 14476         GO TO 5300-BAD-EXIT.
 14477
 14478     IF DCT-RETURN-CODE = 'E2'
 14479         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 277
* EL156.cbl
 14480         GO TO 5300-BAD-EXIT.
 14481
 14482     IF DCT-RETURN-CODE NOT = 'OK'
 14483         MOVE ER-0949            TO EMI-ERROR
 14484         GO TO 5300-BAD-EXIT.
 14485
 14486 5300-CONT.
 14487
 14488     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14489     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14490     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14491     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14492     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14493     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14494     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14495     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14496
 14497     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14498     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14499     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14500     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14501     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14502
 14503     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14504
 14505     IF PI-PMTTYPE = '2'
 14506         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14507         MOVE '4'                TO DM-CLAIM-STATUS
 14508     ELSE
 14509         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14510         MOVE '2'                TO DM-CLAIM-STATUS.
 14511
 14512     MOVE 'DLO025'               TO PGM-NAME.
 14513
 14514
 14515* EXEC CICS LINK
 14516*        PROGRAM    (PGM-NAME)
 14517*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14518*        LENGTH     (DM-DMO-LENGTH)
 14519*    END-EXEC.
 14520*    MOVE '."C                   (   #00013656' TO DFHEIV0
 14521     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14523     MOVE X'2020233030303133363536' TO DFHEIV0(25:11)
 14524     CALL 'kxdfhei1' USING DFHEIV0,
 14525           PGM-NAME,
 14526           DMO-COMMUNICATION-AREA,
 14527           DM-DMO-LENGTH,
 14528           DFHEIV99,
 14529           DFHEIV99,
 14530           DFHEIV99,
 14531           DFHEIV99
 14532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14533
 14534
 14535     IF DM-RETURN-CODE = 'OK'
 14536         GO TO 5300-EXIT.
 14537
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 278
* EL156.cbl
 14538     IF DM-RETURN-CODE = '01'
 14539         MOVE ER-8051            TO EMI-ERROR
 14540         GO TO 5300-BAD-EXIT.
 14541
 14542     IF DM-RETURN-CODE = '02'
 14543         MOVE ER-8052            TO EMI-ERROR
 14544         GO TO 5300-BAD-EXIT.
 14545
 14546     IF DM-RETURN-CODE = '03'
 14547         MOVE ER-8053            TO EMI-ERROR
 14548         GO TO 5300-BAD-EXIT.
 14549
 14550     IF DM-RETURN-CODE = '04'
 14551         MOVE ER-8054            TO EMI-ERROR
 14552         GO TO 5300-BAD-EXIT.
 14553
 14554     IF DM-RETURN-CODE = '05'
 14555         MOVE ER-8055            TO EMI-ERROR
 14556         GO TO 5300-BAD-EXIT.
 14557
 14558     IF DM-RETURN-CODE = '06'
 14559         MOVE ER-8056            TO EMI-ERROR
 14560         GO TO 5300-BAD-EXIT.
 14561
 14562     IF DM-RETURN-CODE = '07'
 14563         MOVE ER-8057            TO EMI-ERROR
 14564         GO TO 5300-BAD-EXIT.
 14565
 14566     IF DM-RETURN-CODE = '08'
 14567         MOVE ER-8058            TO EMI-ERROR
 14568         GO TO 5300-BAD-EXIT.
 14569
 14570     IF DM-RETURN-CODE = '09'
 14571         MOVE ER-8059            TO EMI-ERROR
 14572         GO TO 5300-BAD-EXIT.
 14573
 14574     IF DM-RETURN-CODE = '10'
 14575         MOVE ER-8060            TO EMI-ERROR
 14576         GO TO 5300-BAD-EXIT.
 14577
 14578     IF DM-RETURN-CODE = '11'
 14579         MOVE ER-8061            TO EMI-ERROR
 14580         GO TO 5300-BAD-EXIT.
 14581
 14582     IF DM-RETURN-CODE = '12'
 14583         MOVE ER-8062            TO EMI-ERROR
 14584         GO TO 5300-BAD-EXIT.
 14585
 14586     IF DM-RETURN-CODE = '13'
 14587         MOVE ER-8063            TO EMI-ERROR
 14588         GO TO 5300-BAD-EXIT.
 14589
 14590     IF DM-RETURN-CODE = '14'
 14591         MOVE ER-8064            TO EMI-ERROR
 14592         GO TO 5300-BAD-EXIT.
 14593
 14594     IF DM-RETURN-CODE = '15'
 14595         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 279
* EL156.cbl
 14596         GO TO 5300-BAD-EXIT.
 14597
 14598     IF DM-RETURN-CODE = '16'
 14599         MOVE ER-8154            TO EMI-ERROR
 14600         GO TO 5300-BAD-EXIT.
 14601
 14602     IF DM-RETURN-CODE = '17'
 14603         MOVE ER-8155            TO EMI-ERROR
 14604         GO TO 5300-BAD-EXIT.
 14605
 14606     IF DM-RETURN-CODE = 'N1'
 14607         MOVE ER-8152            TO EMI-ERROR
 14608         GO TO 5300-BAD-EXIT.
 14609
 14610     IF DM-RETURN-CODE = 'E1'
 14611         MOVE ER-8153            TO EMI-ERROR
 14612         GO TO 5300-BAD-EXIT.
 14613
 14614     MOVE ER-8066            TO EMI-ERROR.
 14615     GO TO 5300-BAD-EXIT.
 14616
 14617 5300-NOTE-NOT-FOUND.
 14618
 14619     MOVE ER-0954                TO EMI-ERROR.
 14620     GO TO 5300-BAD-EXIT.
 14621
 14622 5300-BAD-EXIT.
 14623
 14624* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14625*    MOVE '6"R                   !   #00013750' TO DFHEIV0
 14626     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14628     MOVE X'2020233030303133373530' TO DFHEIV0(25:11)
 14629     CALL 'kxdfhei1' USING DFHEIV0
 14630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14631
 14632     IF MAP-NAME = 'EL156A'
 14633         MOVE -1             TO ENTERPFL
 14634       ELSE
 14635         MOVE LOW-VALUES     TO EL156BI
 14636         MOVE -1             TO ENTPFBL.
 14637
 14638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14639     GO TO 8200-SEND-DATAONLY.
 14640
 14641 5300-EXIT.
 14642     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 280
* EL156.cbl
 14644 5350-FORMAT-LAST-NAME-1ST.
 14645*****************************************************************
 14646*             M O V E   N A M E   R O U T I N E                 *
 14647*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14648*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14649*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14650*                  FIELD                   VALUE                *
 14651*           W-NAME-LAST    (CL15)      SMITH                    *
 14652*           W-NAME-FIRST   (CL15)      JOHN                     *
 14653*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14654*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14655*     CONTAIN                                                   *
 14656*                SMITH, JOHN ALLEN                              *
 14657*     OR                                                        *
 14658*                SMITH, JOHN A.                                 *
 14659*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14660*     COPYBOOK, ELCNWA.                                         *
 14661*****************************************************************.
 14662
 14663     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14664     MOVE ZERO                   TO  WS-NAME-SW.
 14665     SET NWA-INDEX               TO +1.
 14666
 14667     IF W-NAME-LAST   = SPACES AND
 14668        W-NAME-MIDDLE = SPACES
 14669         MOVE +1                 TO WS-NAME-SW.
 14670
 14671     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14672     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14673
 14674     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14675     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14676
 14677     SET NWA-INDEX UP BY +1.
 14678
 14679     IF W-NAME-MIDDLE NOT = SPACES
 14680         IF W-NAME-MIDDLE-2 = SPACES
 14681             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14682             SET NWA-INDEX UP BY +1
 14683             MOVE '.'            TO WS-NW (NWA-INDEX)
 14684             SET NWA-INDEX UP BY +2
 14685         ELSE
 14686             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14687             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14688
 14689 5350-EXIT.
 14690     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 281
* EL156.cbl
 14692 5360-MOVE-NAME.
 14693
 14694     IF WS-NAME-SW > +1
 14695         GO TO 5360-EXIT.
 14696
 14697     IF WS-NAME-WORK2 = SPACES
 14698         GO TO 5360-EXIT.
 14699
 14700     SET NWA-INDEX2            TO +1.
 14701     SET NWA-INDEX3            TO +2.
 14702
 14703 5360-MOVE-NAME-CYCLE.
 14704
 14705     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14706
 14707     IF NWA-INDEX < +30
 14708         SET NWA-INDEX UP BY +1
 14709     ELSE
 14710         ADD +2                TO  WS-NAME-SW
 14711         GO TO 5360-EXIT.
 14712
 14713     IF NWA-INDEX2 < +20
 14714         SET NWA-INDEX3 UP BY +1
 14715         SET NWA-INDEX2 UP BY +1.
 14716
 14717     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14718        WS-NW2 (NWA-INDEX3) = SPACES
 14719         IF WS-NAME-SW = ZERO
 14720             MOVE ','            TO  WS-NW (NWA-INDEX)
 14721             SET NWA-INDEX UP BY +2
 14722             MOVE +1             TO  WS-NAME-SW
 14723             GO TO 5360-EXIT
 14724         ELSE
 14725             GO TO 5360-EXIT.
 14726
 14727     GO TO 5360-MOVE-NAME-CYCLE.
 14728
 14729 5360-EXIT.
 14730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 282
* EL156.cbl
 14732 6000-BUILD-SCREEN-B.
 14733     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14734     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14735     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14736     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14737
 14738     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14739
 14740 6050-BUILD-SCREEN.
 14741     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14742     MOVE LOW-VALUES             TO EL156BI.
 14743     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14744
 14745     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14746
 14747     IF PI-PAYEE-TYPE = 'I'
 14748        GO TO 6060-READ-TRAILER.
 14749
 14750     IF PI-PAYEE-TYPE = 'B'
 14751        ADD +10                  TO TRLR-SEQ-NO
 14752        GO TO 6060-READ-TRAILER.
 14753
 14754     IF PI-PAYEE-TYPE = 'A'
 14755        ADD +20                  TO TRLR-SEQ-NO
 14756        GO TO 6060-READ-TRAILER.
 14757
 14758     IF PI-PAYEE-TYPE = 'O'
 14759        ADD +50                  TO TRLR-SEQ-NO
 14760        GO TO 6060-READ-TRAILER.
 14761
 14762     IF PI-PAYEE-TYPE = 'Q'
 14763        ADD +60                  TO TRLR-SEQ-NO
 14764        GO TO 6060-READ-TRAILER.
 14765
 14766     IF PI-PAYEE-TYPE = 'P'
 14767        ADD +30                  TO TRLR-SEQ-NO
 14768        GO TO 6060-READ-TRAILER.
 14769
 14770     IF PI-PAYEE-TYPE = 'E'
 14771        ADD +40                  TO TRLR-SEQ-NO.
 14772
 14773 6060-READ-TRAILER.
 14774
 14775     IF PI-PAYEE-TYPE    = 'A' AND
 14776        PI-PAYEE-SEQ-NUM = 0
 14777          GO TO 6061-READ-ACCOUNT.
 14778
 14779     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14780        (PI-PAYEE-TYPE    = 'B')             AND
 14781        (PI-PAYEE-SEQ-NUM = 9)
 14782          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14783          IF BENE-FOUND-SW = 'N'
 14784            GO TO 6065-NOT-FOUND
 14785          ELSE
 14786            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14787            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14788            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14789*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 283
* EL156.cbl
 14790            STRING BE-CITY ' ' BE-STATE
 14791               DELIMITED BY '  ' INTO CITYSTBO
 14792            END-STRING
 14793            MOVE BE-ZIP-CODE       TO ZIPBO
 14794            GO TO 6061-READ-ACCOUNT.
 14795
 14796     IF PI-PAYEE-TYPE    = 'B' AND
 14797        PI-PAYEE-SEQ-NUM = 0
 14798          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14799          IF BENE-FOUND-SW = 'N'
 14800            GO TO 6065-NOT-FOUND
 14801          ELSE
 14802            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14803            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14804            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14805*           MOVE BE-CITY-STATE     TO CITYSTBO
 14806            STRING BE-CITY ' ' BE-STATE
 14807               DELIMITED BY '  ' INTO CITYSTBO
 14808            END-STRING
 14809            MOVE BE-ZIP-CODE       TO ZIPBO
 14810            GO TO 6061-READ-ACCOUNT.
 14811
 14812
 14813* EXEC CICS HANDLE CONDITION
 14814*         NOTFND(6065-NOT-FOUND)
 14815*     END-EXEC.
 14816*    MOVE '"$I                   ! / #00013931' TO DFHEIV0
 14817     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14819     MOVE X'2F20233030303133393331' TO DFHEIV0(25:11)
 14820     CALL 'kxdfhei1' USING DFHEIV0
 14821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14822
 14823
 14824     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14825
 14826     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14827     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14828     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14829     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14830*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14831     STRING AT-CITY ' ' AT-STATE
 14832        DELIMITED BY '  ' INTO CITYSTBO
 14833     END-STRING
 14834     MOVE AT-ZIP-CODE            TO ZIPBO.
 14835
 14836 6061-READ-ACCOUNT.
 14837
 14838* EXEC CICS HANDLE CONDITION
 14839*         NOTFND(6068-ACCT-NOT-FND)
 14840*     END-EXEC.
 14841*    MOVE '"$I                   ! 0 #00013948' TO DFHEIV0
 14842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14844     MOVE X'3020233030303133393438' TO DFHEIV0(25:11)
 14845     CALL 'kxdfhei1' USING DFHEIV0
 14846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14847
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 284
* EL156.cbl
 14848
 14849
 14850* EXEC CICS READ
 14851*         DATASET('ERACCT')
 14852*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14853*         RIDFLD (PI-ACCT-KEY)
 14854*     END-EXEC.
 14855     MOVE 'ERACCT' TO DFHEIV1
 14856*    MOVE '&"S        E          (   #00013952' TO DFHEIV0
 14857     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14858     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14859     MOVE X'2020233030303133393532' TO DFHEIV0(25:11)
 14860     CALL 'kxdfhei1' USING DFHEIV0,
 14861           DFHEIV1,
 14862           DFHEIV20,
 14863           DFHEIV99,
 14864           PI-ACCT-KEY,
 14865           DFHEIV99,
 14866           DFHEIV99,
 14867           DFHEIV99
 14868     SET ADDRESS OF ACCOUNT-MASTER TO
 14869         DFHEIV20
 14870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14871
 14872
 14873     MOVE AM-CARRIER             TO ACARRBO.
 14874     MOVE AM-GROUPING            TO GROUPBO.
 14875     MOVE AM-STATE               TO STATEBO.
 14876     MOVE AM-ACCOUNT             TO ACCTBO.
 14877     MOVE AM-NAME                TO ACCTNMBO.
 14878
 14879     IF PI-PAYEE-TYPE = 'A' AND
 14880        PI-PAYEE-SEQ-NUM = 0
 14881          MOVE AM-NAME             TO NAMEBO
 14882                                      PI-PAYEE-NAME
 14883          MOVE AM-ADDRS            TO ADDR1BO
 14884          MOVE SPACES              TO ADDR2BO
 14885*         MOVE AM-CITY             TO CITYSTBO
 14886          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14887             DELIMITED BY '  ' INTO CITYSTBO
 14888          END-STRING
 14889          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14890          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14891          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14892          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14893
 14894     IF CITYSTBO EQUAL SPACES
 14895         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14896         GO TO 6070-FORMAT-DATA
 14897     END-IF.
 14898
 14899     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14900     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14901     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14902     PERFORM VARYING WS-SUB FROM 30 BY -1
 14903          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14904        IF WS-END-SUB = 0  AND
 14905           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 285
* EL156.cbl
 14906              OR LOW-VALUES  OR '.')
 14907            CONTINUE
 14908        ELSE
 14909            IF WS-END-SUB = 0
 14910                MOVE WS-SUB TO WS-END-SUB
 14911            ELSE
 14912                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14913                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14914                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14915                END-IF
 14916            END-IF
 14917        END-IF
 14918        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14919            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14920            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14921        END-IF
 14922     END-PERFORM.
 14923
 14924     IF WS-BEG-SUB > 0
 14925         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14926         IF WS-STATE-LENGTH = 2
 14927             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14928                  TO PI-CHECK-STATE-FOR-AK
 14929         ELSE
 14930             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14931                'ALASKA'
 14932                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14933             ELSE
 14934                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14935             END-IF
 14936         END-IF
 14937     ELSE
 14938         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14939     END-IF.
 14940
 14941     GO TO 6070-FORMAT-DATA.
 14942
 14943 6065-NOT-FOUND.
 14944     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14945     GO TO 6061-READ-ACCOUNT.
 14946
 14947 6068-ACCT-NOT-FND.
 14948     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14949
 14950 6070-FORMAT-DATA.
 14951     IF PI-HOLDTIL = ZEROS
 14952        MOVE SAVE-DATE           TO PAYDTBI
 14953       ELSE
 14954        MOVE PI-HOLDTIL          TO PAYDTBO
 14955        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14956
 14957     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14958     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14959
 14960     IF EIBAID = DFHPF3 OR DFHPF4
 14961        NEXT SENTENCE
 14962     ELSE
 14963       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 286
* EL156.cbl
 14964
 14965     MOVE PI-EPYFROM          TO PYFROMBO.
 14966     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14967
 14968     IF NOT PI-USES-PAID-TO
 14969        MOVE PI-EPYTHRU          TO PYTHRUBO
 14970        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14971     ELSE
 14972        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14973        MOVE '4'              TO DC-OPTION-CODE
 14974        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14975        IF NO-CONVERSION-ERROR
 14976           MOVE +1            TO DC-ELAPSED-DAYS
 14977           MOVE +0            TO DC-ELAPSED-MONTHS
 14978           MOVE '6'           TO DC-OPTION-CODE
 14979           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14980           IF NO-CONVERSION-ERROR
 14981              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14982
 14983     MOVE PI-EDAYS            TO DAYSBO.
 14984     MOVE PI-EPYAMT           TO PAYAMTBO.
 14985     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14986        IF PI-INT-AMT > ZEROS
 14987           MOVE PI-INT-AMT       TO INTAMTBO
 14988        END-IF
 14989     END-IF
 14990     GO TO 6072-SET-TYPE.
 14991
 14992 6071-CONTINUE.
 14993
 14994     IF PI-CPYFROM NOT = LOW-VALUES
 14995        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14996        MOVE SPACES              TO DC-OPTION-CODE
 14997        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14998        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14999
 15000     IF PI-CPYTHRU NOT = LOW-VALUES
 15001        IF NOT PI-USES-PAID-TO
 15002           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15003           MOVE SPACES             TO DC-OPTION-CODE
 15004           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15005           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15006        ELSE
 15007           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15008           MOVE '6'                TO DC-OPTION-CODE
 15009           MOVE +1                 TO DC-ELAPSED-DAYS
 15010           MOVE +0                 TO DC-ELAPSED-MONTHS
 15011           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15012           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15013
 15014     MOVE PI-CDAYS               TO DAYSBO.
 15015     MOVE PI-CPYAMT              TO PAYAMTBO.
 15016     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15017        IF PI-INT-AMT > ZEROS
 15018           MOVE PI-INT-AMT       TO INTAMTBO
 15019        END-IF
 15020     END-IF
 15021     .
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 287
* EL156.cbl
 15022 6072-SET-TYPE.
 15023     IF PI-PMTTYPE = '1'
 15024        MOVE 'PARTIAL'           TO PAYTYPBO.
 15025
 15026     IF PI-PMTTYPE = '2'
 15027        MOVE 'FINAL'             TO PAYTYPBO.
 15028
 15029     IF PI-PMTTYPE = '3'
 15030        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15031
 15032     IF PI-PMTTYPE = '4'
 15033        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15034
 15035     IF PI-PMTTYPE = '5'
 15036        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15037
 15038     IF PI-PMTTYPE = '6'
 15039        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15040
 15041     IF PI-PROV-PMT
 15042        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15043
 15044     IF PI-ECHECKNO NOT = SPACES
 15045        MOVE PI-ECHECKNO         TO CKNUMBO
 15046     ELSE
 15047        MOVE PI-CCHECKNO         TO CKNUMBO.
 15048
 15049     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 15050        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15051        MOVE +91                 TO  TRLR-SEQ-NO
 15052
 15053* EXEC CICS READ
 15054*           DATASET  ('ELTRLR')
 15055*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15056*           RIDFLD   (ELTRLR-KEY)
 15057*           RESP     (WS-RESPONSE)
 15058*       END-EXEC
 15059     MOVE 'ELTRLR' TO DFHEIV1
 15060*    MOVE '&"S        E          (  N#00014137' TO DFHEIV0
 15061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15063     MOVE X'204E233030303134313337' TO DFHEIV0(25:11)
 15064     CALL 'kxdfhei1' USING DFHEIV0,
 15065           DFHEIV1,
 15066           DFHEIV20,
 15067           DFHEIV99,
 15068           ELTRLR-KEY,
 15069           DFHEIV99,
 15070           DFHEIV99,
 15071           DFHEIV99
 15072     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15073         DFHEIV20
 15074     MOVE EIBRESP  TO WS-RESPONSE
 15075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15076
 15077        IF WS-RESP-NORMAL
 15078           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15079        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 288
* EL156.cbl
 15080           MOVE SPACES           TO  LOANNBO
 15081        END-IF
 15082     END-IF
 15083
 15084*       MOVE PI-LOAN-NO          TO LOANNBO
 15085
 15086     IF CKNUMBO = SPACES
 15087         MOVE SPACES             TO CKNUMHDO.
 15088
 15089     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15090     MOVE CL-CARRIER             TO CARRBO.
 15091     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15092     MOVE CL-CERT-SFX            TO SUFXBO.
 15093
 15094     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15095        EVALUATE CL-CLAIM-TYPE
 15096           WHEN 'I'
 15097              MOVE '  IU  '      TO CLMTYPBO
 15098           WHEN 'G'
 15099              MOVE ' GAP  '      TO CLMTYPBO
 15100           WHEN OTHER
 15101              MOVE PI-AH-OVERRIDE-L6
 15102                                 TO CLMTYPBO
 15103        END-EVALUATE
 15104        MOVE ZEROS               TO UNDISBO
 15105*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15106        IF PI-PMTTYPE = '5' OR '6'
 15107           GO TO 6073-GET-NOTIFY-DATA
 15108        ELSE
 15109           MOVE PI-DAILY-RATE    TO RATEBO
 15110           GO TO 6073-GET-NOTIFY-DATA.
 15111
 15112     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15113
 15114     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15115        MOVE ZEROS               TO UNDISBO
 15116     ELSE
 15117        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15118
 15119 6073-GET-NOTIFY-DATA.
 15120
 15121     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15122
 15123     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15124         MOVE SPACES             TO  NAMEB2O
 15125                                     ADDR1B2O
 15126                                     ADDR2B2O
 15127                                     CITYST2O
 15128                                     AGTHDGO
 15129         MOVE ZEROS              TO  ZIPB2O
 15130         GO TO 6080-SET-INCURRED.
 15131
 15132     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15133     MOVE +29                    TO  TRLR-SEQ-NO.
 15134
 15135
 15136* EXEC CICS HANDLE CONDITION
 15137*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 289
* EL156.cbl
 15138*    END-EXEC.
 15139*    MOVE '"$I                   ! 1 #00014202' TO DFHEIV0
 15140     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15142     MOVE X'3120233030303134323032' TO DFHEIV0(25:11)
 15143     CALL 'kxdfhei1' USING DFHEIV0
 15144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15145
 15146
 15147     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15148
 15149     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15150     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15151     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15152*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15153     STRING AT-CITY ' ' AT-STATE
 15154        DELIMITED BY '  ' INTO CITYST2O
 15155     END-STRING
 15156     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15157     GO TO 6080-SET-INCURRED.
 15158
 15159 6074-GET-COMP-DATA.
 15160
 15161     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15162         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15163
 15164     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15165         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15166                                         ADDR1B2O
 15167                                         ADDR2B2O
 15168                                         CITYST2O
 15169         MOVE ZEROS                  TO  ZIPB2O
 15170         GO TO 6080-SET-INCURRED.
 15171
 15172     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15173     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15174     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15175     MOVE AM-GROUPING            TO  COMP-GROUP.
 15176     MOVE 'A'                    TO  COMP-TYPE.
 15177     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15178                                 TO  COMP-FIN-RESP.
 15179
 15180     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15181         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15182                                       'G' OR 'B' or 'S'
 15183             MOVE 'G'            TO  COMP-TYPE
 15184             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15185         ELSE
 15186             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15187                                 TO  COMP-ACCOUNT
 15188     ELSE
 15189         MOVE 'G'                TO  COMP-TYPE
 15190         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15191
 15192     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15193
 15194     IF COMP-REC-FOUND
 15195         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 290
* EL156.cbl
 15196         MOVE CO-ADDR-1          TO  ADDR1B2O
 15197         MOVE CO-ADDR-2          TO  ADDR2B2O
 15198*        MOVE CO-ADDR-3          TO  CITYST2O
 15199         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15200            DELIMITED BY '  ' INTO CITYST2O
 15201         END-STRING
 15202         MOVE CO-ZIP             TO  ZIPB2O
 15203     ELSE
 15204         MOVE 'NO COMP ADDRESS AVAILABLE'
 15205                                 TO  NAMEB2O
 15206                                     ADDR1B2O
 15207                                     ADDR2B2O
 15208                                     CITYST2O
 15209         MOVE ZEROS               TO ZIPB2O.
 15210
 15211 6080-SET-INCURRED.
 15212     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15213     MOVE SPACES                 TO DC-OPTION-CODE.
 15214     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15215     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15216     MOVE PI-PROCESSOR-ID        TO BYBO.
 15217     MOVE MAP-NAMEB              TO MAP-NAME.
 15218     MOVE 'C'                    TO PI-PASS-SW.
 15219     MOVE EIBAID                 TO PI-PFKEY-USED.
 15220     MOVE -1                     TO ENTPFBL.
 15221     GO TO 8100-SEND-INITIAL-MAP.
 15222
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 291
* EL156.cbl
 15224 6100-BUILD-PAYMENT-TRAILER.
 15225
 15226     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15227       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15228         GO TO 6105-STATE-CHECK-NUMBER
 15229     END-IF.
 15230
 15231     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15232     MOVE '6'                    TO CNTL-REC-TYPE.
 15233
 15234     IF CONTROL-IS-ACTUAL-CARRIER
 15235         MOVE PI-CARRIER         TO WS-CARR
 15236     ELSE
 15237         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15238
 15239     IF PI-COMPANY-ID = 'FIA'
 15240         MOVE PI-CARRIER         TO  WS-CARR.
 15241
 15242     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15243     MOVE 0                      TO CNTL-SEQ-NO.
 15244     MOVE 'CARR'                 TO FILE-SWITCH.
 15245
 15246     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15247
 15248     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15249         IF PI-OFFLINE     = 'Y' AND
 15250            PI-ECHECKNO-CR = 'CR'
 15251              GO TO 6110-READ-CONTROL
 15252         ELSE
 15253            IF PI-CASH = 'N'
 15254                GO TO 6110-READ-CONTROL.
 15255
 15256     IF CHECK-NO-MANUAL    OR
 15257        CHECK-NO-AT-PRINT  OR
 15258        PI-OFFLINE = 'Y'
 15259          GO TO 6130-BUILD-TRAILER.
 15260
 15261     IF PI-COMPANY-ID = 'FIA'
 15262         NEXT SENTENCE
 15263     ELSE
 15264         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15265             GO TO 6110-READ-CONTROL.
 15266
 15267     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15268
 15269     IF CHECK-CNT-RESET-VALUE
 15270        MOVE +1                  TO CF-CHECK-COUNTER
 15271     ELSE
 15272        ADD +1                   TO CF-CHECK-COUNTER.
 15273
 15274     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15275
 15276     IF CHECK-NO-CARR-SEQ
 15277        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15278
 15279     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15280
 15281     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 292
* EL156.cbl
 15282     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15283        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15284         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15285         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15286            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15287         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15288                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15289     END-IF.
 15290
 15291     GO TO 6120-REWRITE.
 15292
 15293 6105-STATE-CHECK-NUMBER.
 15294     IF CHECK-NO-MANUAL    OR
 15295        CHECK-NO-AT-PRINT  OR
 15296        PI-OFFLINE = 'Y'
 15297           GO TO 6130-BUILD-TRAILER
 15298     END-IF.
 15299
 15300     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15301     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15302     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15303     MOVE '3'                TO CNTL-REC-TYPE.
 15304     MOVE +0                 TO CNTL-SEQ-NO.
 15305     MOVE 'STAT'             TO FILE-SWITCH.
 15306     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15307
 15308     IF CF-ST-CHECK-CNT-RESET
 15309         MOVE +1             TO CF-ST-CHECK-COUNTER
 15310     ELSE
 15311         ADD +1              TO CF-ST-CHECK-COUNTER
 15312     END-IF.
 15313
 15314     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15315     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15316     GO TO 6120-REWRITE.
 15317
 15318 6110-READ-CONTROL.
 15319     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15320     MOVE '1'                    TO CNTL-REC-TYPE.
 15321     MOVE SPACES                 TO CNTL-ACCESS.
 15322     MOVE 0                      TO CNTL-SEQ-NO.
 15323
 15324     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15325
 15326     IF CO-CHECK-COUNT-RESET
 15327        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15328     ELSE
 15329        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15330
 15331     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15332
 15333     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15334         IF PI-OFFLINE     = 'Y'  AND
 15335            PI-ECHECKNO-CR = 'CR'
 15336              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15337              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15338              MOVE AL-UANON           TO CHECKNOA
 15339              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 293
* EL156.cbl
 15340         ELSE
 15341         IF PI-CASH = 'N'
 15342             MOVE 'N'                TO PI-ECHECKNO-N
 15343             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15344             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15345             MOVE AL-UANON           TO CHECKNOA
 15346             GO TO 6120-REWRITE.
 15347
 15348     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15349
 15350 6120-REWRITE.
 15351
 15352* EXEC CICS REWRITE
 15353*         DATASET('ELCNTL')
 15354*         FROM(CONTROL-FILE)
 15355*     END-EXEC.
 15356     MOVE LENGTH OF
 15357      CONTROL-FILE
 15358       TO DFHEIV11
 15359     MOVE 'ELCNTL' TO DFHEIV1
 15360*    MOVE '&& L                  %   #00014410' TO DFHEIV0
 15361     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15363     MOVE X'2020233030303134343130' TO DFHEIV0(25:11)
 15364     CALL 'kxdfhei1' USING DFHEIV0,
 15365           DFHEIV1,
 15366           CONTROL-FILE,
 15367           DFHEIV11,
 15368           DFHEIV99
 15369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15370
 15371
 15372     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15373
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 294
* EL156.cbl
 15375 6130-BUILD-TRAILER.
 15376
 15377
 15378* EXEC CICS GETMAIN
 15379*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15380*         LENGTH    (200)
 15381*         INITIMG   (GETMAIN-SPACE)
 15382*     END-EXEC.
 15383     MOVE 200
 15384       TO DFHEIV11
 15385*    MOVE ',"IL                  $   #00014420' TO DFHEIV0
 15386     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15387     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15388     MOVE X'2020233030303134343230' TO DFHEIV0(25:11)
 15389     CALL 'kxdfhei1' USING DFHEIV0,
 15390           DFHEIV20,
 15391           DFHEIV11,
 15392           GETMAIN-SPACE
 15393     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15394         DFHEIV20
 15395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15396
 15397
 15398     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15399                                    AT-PREV-PAID-THRU-DT.
 15400     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15401     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15402     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15403     MOVE 'AT'                   TO AT-RECORD-ID.
 15404     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15405
 15406     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15407        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15408           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15409     ELSE
 15410           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15411           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15412
 15413     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15414         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15415             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15416             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15417           ELSE
 15418             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15419             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15420
 15421     MOVE '2'                    TO AT-TRAILER-TYPE.
 15422     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15423                                    AT-PAYMENT-LAST-MAINT-DT.
 15424     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15425                                    AT-PAYMENT-LAST-UPDATED-BY.
 15426     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15427     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15428     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15429     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15430
 15431     IF PI-PMT-APPROVED
 15432        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 295
* EL156.cbl
 15433           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15434
 15435     IF PI-PFKEY-USED = DFHPF5
 15436        GO TO 6140-PF5-ENTERED.
 15437
 15438     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15439     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15440
 15441     IF PI-AIG-SPECIAL-BENEFIT
 15442         IF WS-1ST-SPECIAL-PMT
 15443             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15444             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15445                                        AT-AMOUNT-PAID
 15446         ELSE
 15447             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15448
 15449     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15450
 15451     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15452     MOVE '4'                    TO DC-OPTION-CODE.
 15453     PERFORM 9700-LINK-DATE-CONVERT.
 15454
 15455     IF DATE-CONVERSION-ERROR
 15456        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15457     ELSE
 15458        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15459
 15460     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15461     MOVE '4'                    TO DC-OPTION-CODE.
 15462     PERFORM 9700-LINK-DATE-CONVERT.
 15463
 15464     IF DATE-CONVERSION-ERROR
 15465        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15466     ELSE
 15467        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15468
 15469     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15470     GO TO 6150-FINISH-MOVE.
 15471
 15472 6140-PF5-ENTERED.
 15473     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15474     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15475
 15476     IF PI-AIG-SPECIAL-BENEFIT
 15477         IF WS-1ST-SPECIAL-PMT
 15478             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15479             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15480                                        AT-AMOUNT-PAID
 15481         ELSE
 15482             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15483
 15484     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15485     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15486     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15487
 15488 6150-FINISH-MOVE.
 15489
 15490     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 296
* EL156.cbl
 15491         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15492     ELSE
 15493         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15494
 15495     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15496     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15497
 15498*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15499*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15500
 15501     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15502         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15503
 15504     IF PI-OFFLINE = 'N'
 15505        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15506        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15507     ELSE
 15508        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15509        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15510
 15511     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15512
 15513     IF WS-2ND-SPECIAL-PMT
 15514         MOVE 'Y'                TO AT-CASH-PAYMENT
 15515         MOVE SPACES             TO AT-CHECK-NO
 15516         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15517         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15518         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15519         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15520
 15521     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15522                                    AT-TO-BE-WRITTEN-DT.
 15523
 15524     IF PI-HOLDTIL NOT = ZEROS
 15525        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15526        MOVE '4'                 TO DC-OPTION-CODE
 15527        PERFORM 9700-LINK-DATE-CONVERT
 15528        IF PI-OFFLINE = 'N'
 15529           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15530        ELSE
 15531           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15532
 15533     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15534     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15535                                    AT-CHECK-QUE-SEQUENCE.
 15536
 15537     IF PI-PFKEY-USED = DFHPF4
 15538        MOVE '1'                 TO AT-FORCE-CONTROL.
 15539
 15540     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15541        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15542        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15543        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15544
 15545     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15546                                    AT-VOID-SELECT-DT
 15547                                    AT-VOID-ACCEPT-DT
 15548                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 297
* EL156.cbl
 15549     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15550        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15551        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15552        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15553        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15554     ELSE
 15555        MOVE ZEROS               TO AT-DAILY-RATE
 15556                                    AT-ELIMINATION-DAYS
 15557        MOVE SPACES              TO AT-BENEFIT-TYPE
 15558     END-IF
 15559     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15560     MOVE '4'                    TO DC-OPTION-CODE.
 15561     PERFORM 9700-LINK-DATE-CONVERT.
 15562     IF DATE-CONVERSION-ERROR
 15563         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15564     ELSE
 15565         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15566     END-IF.
 15567     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15568     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15569     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15570     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15571     IF (PI-REAUDIT-NEEDED = 'Y')
 15572        or (pi-max-ext-used = 'Y')
 15573        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15574         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15575         MOVE 'Y' TO WS-NEED-APPROVAL
 15576         GO TO 6170-WRITE
 15577     END-IF.
 15578*******************************************************
 15579     IF NOT PI-PMT-GRADUATED
 15580         GO TO 6170-WRITE.
 15581
 15582     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15583     MOVE '1'                    TO CNTL-REC-TYPE.
 15584     MOVE SPACES                 TO CNTL-ACCESS.
 15585     MOVE +0                     TO CNTL-SEQ-NO.
 15586     MOVE 'COMP'                 TO FILE-SWITCH.
 15587
 15588     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15589
 15590     IF PAID-FOR-LIFE
 15591         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15592             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15593                                     WS-PMT-APPROVAL-SW
 15594             GO TO 6170-WRITE.
 15595
 15596*05999      IF PAID-FOR-AH
 15597     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15598         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15599             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15600                                     WS-PMT-APPROVAL-SW
 15601             GO TO 6170-WRITE.
 15602
 15603     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15604
 15605******A&H Limits are set as a monthly payment.  Calculate the mont
 15606******equivalent of the amount paid today
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 298
* EL156.cbl
 15607     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15608        PI-SAVE-ODD-DAYS-OVER > 0
 15609           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15610                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15611           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15612                                  WS-CALC-PMT-MONTHS
 15613     ELSE
 15614           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15615     END-IF.
 15616*06007      IF ((PAID-FOR-AH) AND
 15617     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15618*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15619        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15620              OR
 15621        ((PAID-FOR-LIFE) AND
 15622        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15623            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15624       ELSE
 15625*06014      IF ((PAID-FOR-AH)  AND
 15626         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15627*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15628           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15629              OR
 15630        ((PAID-FOR-LIFE) AND
 15631        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15632            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15633         ELSE
 15634*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15635           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15636               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15637              OR
 15638          ((PAID-FOR-LIFE) AND
 15639          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15640            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15641       ELSE
 15642           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15643               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15644              OR
 15645          ((PAID-FOR-LIFE) AND
 15646          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15647            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15648       ELSE
 15649            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15650
 15651     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15652        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15653        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15654            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15655        END-IF
 15656     ELSE
 15657     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15658        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15659        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15660            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15661        END-IF
 15662     ELSE
 15663     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15664        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 299
* EL156.cbl
 15665        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15666            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15667        END-IF
 15668     ELSE
 15669     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15670        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15671        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15672            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15673        END-IF
 15674     ELSE
 15675     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15676            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15677
 15678     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15679
 15680     IF NOT PI-PMT-GRADUATED
 15681         GO TO 6170-WRITE.
 15682
 15683
 15684* EXEC CICS HANDLE CONDITION
 15685*        NOTFND   (6170-WRITE)
 15686*    END-EXEC.
 15687*    MOVE '"$I                   ! 2 #00014711' TO DFHEIV0
 15688     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15690     MOVE X'3220233030303134373131' TO DFHEIV0(25:11)
 15691     CALL 'kxdfhei1' USING DFHEIV0
 15692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15693
 15694
 15695     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15696     MOVE '2'                    TO CNTL-REC-TYPE.
 15697     MOVE +0                     TO CNTL-SEQ-NO.
 15698     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15699
 15700
 15701* EXEC CICS READ
 15702*         DATASET  ('ELCNTL')
 15703*         SET      (ADDRESS OF CONTROL-FILE)
 15704*         RIDFLD   (ELCNTL-KEY)
 15705*    END-EXEC.
 15706     MOVE 'ELCNTL' TO DFHEIV1
 15707*    MOVE '&"S        E          (   #00014720' TO DFHEIV0
 15708     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15709     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15710     MOVE X'2020233030303134373230' TO DFHEIV0(25:11)
 15711     CALL 'kxdfhei1' USING DFHEIV0,
 15712           DFHEIV1,
 15713           DFHEIV20,
 15714           DFHEIV99,
 15715           ELCNTL-KEY,
 15716           DFHEIV99,
 15717           DFHEIV99,
 15718           DFHEIV99
 15719     SET ADDRESS OF CONTROL-FILE TO
 15720         DFHEIV20
 15721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15722
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 300
* EL156.cbl
 15723
 15724     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15725
 15726     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15727                         OR '4' OR '5'
 15728         NEXT SENTENCE
 15729     ELSE
 15730         MOVE 'Y' TO WS-NEED-APPROVAL
 15731         GO TO 6170-WRITE.
 15732
 15733     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15734         MOVE 'Y' TO WS-NEED-APPROVAL
 15735         IF WS-APPROVAL-LEVEL = '1'
 15736             MOVE '2'        TO  AT-APPROVED-LEVEL
 15737                            WS-SAVE-APPROVED-LEVEL
 15738             GO TO 6170-WRITE
 15739         ELSE
 15740             IF WS-APPROVAL-LEVEL = '2'
 15741                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15742                                WS-SAVE-APPROVED-LEVEL
 15743                 GO TO 6170-WRITE
 15744             ELSE IF WS-APPROVAL-LEVEL = '3'
 15745                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15746                                WS-SAVE-APPROVED-LEVEL
 15747                 GO TO 6170-WRITE
 15748             ELSE IF WS-APPROVAL-LEVEL = '4'
 15749                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15750                                WS-SAVE-APPROVED-LEVEL
 15751                 GO TO 6170-WRITE.
 15752
 15753     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15754                             WS-PMT-APPROVAL-SW.
 15755     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15756                             AT-APPROVAL-LEVEL-REQD.
 15757
 15758*******************************************************
 15759
 15760 6170-WRITE.
 15761
 15762     if pi-company-id = 'DCC'
 15763        PERFORM 0900-GET-DDF-limits
 15764                                 THRU 0900-EXIT
 15765     end-if
 15766     perform 2220-update-elcrtt  thru 2220-exit
 15767     IF PI-COMPANY-ID = 'DMD'
 15768        IF PI-AT-EOB-CODES NOT = SPACES
 15769           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15770           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15771           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15772           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15773           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15774
 15775
 15776* EXEC CICS HANDLE CONDITION
 15777*        DUPREC    (6180-DUPREC)
 15778*    END-EXEC.
 15779*    MOVE '"$%                   ! 3 #00014777' TO DFHEIV0
 15780     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 301
* EL156.cbl
 15781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15782     MOVE X'3320233030303134373737' TO DFHEIV0(25:11)
 15783     CALL 'kxdfhei1' USING DFHEIV0
 15784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15785
 15786
 15787
 15788* EXEC CICS WRITE
 15789*         DATASET       ('ELTRLR')
 15790*         FROM          (ACTIVITY-TRAILERS)
 15791*         RIDFLD        (AT-CONTROL-PRIMARY)
 15792*     END-EXEC.
 15793     MOVE LENGTH OF
 15794      ACTIVITY-TRAILERS
 15795       TO DFHEIV11
 15796     MOVE 'ELTRLR' TO DFHEIV1
 15797*    MOVE '&$ L                  ''   #00014781' TO DFHEIV0
 15798     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15800     MOVE X'2020233030303134373831' TO DFHEIV0(25:11)
 15801     CALL 'kxdfhei1' USING DFHEIV0,
 15802           DFHEIV1,
 15803           ACTIVITY-TRAILERS,
 15804           DFHEIV11,
 15805           AT-CONTROL-PRIMARY,
 15806           DFHEIV99,
 15807           DFHEIV99
 15808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15809
 15810
 15811     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15812        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15813*06088           GO TO 6199-EXIT.
 15814           GO TO 6176-APPROVAL-NOTE.
 15815
 15816
 15817* EXEC CICS GETMAIN
 15818*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15819*         LENGTH    (200)
 15820*         INITIMG   (GETMAIN-SPACE)
 15821*     END-EXEC.
 15822     MOVE 200
 15823       TO DFHEIV11
 15824*    MOVE ',"IL                  $   #00014792' TO DFHEIV0
 15825     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15827     MOVE X'2020233030303134373932' TO DFHEIV0(25:11)
 15828     CALL 'kxdfhei1' USING DFHEIV0,
 15829           DFHEIV20,
 15830           DFHEIV11,
 15831           GETMAIN-SPACE
 15832     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15833         DFHEIV20
 15834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15835
 15836
 15837     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15838
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 302
* EL156.cbl
 15839     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15840     MOVE 'AT'                   TO AT-RECORD-ID.
 15841     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15842     MOVE '6'                    TO AT-TRAILER-TYPE.
 15843     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15844                                    AT-GEN-INFO-LAST-MAINT-DT
 15845     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15846                                    AT-GEN-INFO-LAST-UPDATED-BY
 15847     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15848
 15849     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15850     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15851     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15852
 15853     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15854
 15855 6175-WRITE.
 15856
 15857
 15858* EXEC CICS HANDLE CONDITION
 15859*        DUPREC    (6190-DUPREC)
 15860*    END-EXEC.
 15861*    MOVE '"$%                   ! 4 #00014818' TO DFHEIV0
 15862     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15864     MOVE X'3420233030303134383138' TO DFHEIV0(25:11)
 15865     CALL 'kxdfhei1' USING DFHEIV0
 15866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15867
 15868
 15869
 15870* EXEC CICS WRITE
 15871*         DATASET     ('ELTRLR')
 15872*         FROM        (ACTIVITY-TRAILERS)
 15873*         RIDFLD      (AT-CONTROL-PRIMARY)
 15874*     END-EXEC.
 15875     MOVE LENGTH OF
 15876      ACTIVITY-TRAILERS
 15877       TO DFHEIV11
 15878     MOVE 'ELTRLR' TO DFHEIV1
 15879*    MOVE '&$ L                  ''   #00014822' TO DFHEIV0
 15880     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15881     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15882     MOVE X'2020233030303134383232' TO DFHEIV0(25:11)
 15883     CALL 'kxdfhei1' USING DFHEIV0,
 15884           DFHEIV1,
 15885           ACTIVITY-TRAILERS,
 15886           DFHEIV11,
 15887           AT-CONTROL-PRIMARY,
 15888           DFHEIV99,
 15889           DFHEIV99
 15890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15891
 15892
 15893 6176-APPROVAL-NOTE.
 15894
 15895     IF NOT APPROVAL-NEEDED
 15896         GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 303
* EL156.cbl
 15897
 15898
 15899* EXEC CICS GETMAIN
 15900*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15901*        LENGTH    (200)
 15902*        INITIMG   (GETMAIN-SPACE)
 15903*    END-EXEC.
 15904     MOVE 200
 15905       TO DFHEIV11
 15906*    MOVE ',"IL                  $   #00014833' TO DFHEIV0
 15907     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15908     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15909     MOVE X'2020233030303134383333' TO DFHEIV0(25:11)
 15910     CALL 'kxdfhei1' USING DFHEIV0,
 15911           DFHEIV20,
 15912           DFHEIV11,
 15913           GETMAIN-SPACE
 15914     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15915         DFHEIV20
 15916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15917
 15918
 15919     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15920
 15921     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15922     MOVE 'AT'               TO AT-RECORD-ID
 15923     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15924     MOVE '6'                TO AT-TRAILER-TYPE
 15925     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15926                                AT-GEN-INFO-LAST-MAINT-DT
 15927     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15928                                AT-GEN-INFO-LAST-UPDATED-BY
 15929     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15930
 15931     IF PI-REAUDIT-NEEDED = 'Y'
 15932         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15933     ELSE
 15934         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15935     END-IF
 15936     IF PI-APPROVAL-3550-NEEDED = 'Y'
 15937         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 15938     END-IF
 15939     MOVE SPACES             TO AT-INFO-LINE-2
 15940
 15941     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15942 6177-WRITE.
 15943
 15944
 15945* EXEC CICS HANDLE CONDITION
 15946*        DUPREC    (6185-DUPREC)
 15947*    END-EXEC.
 15948*    MOVE '"$%                   ! 5 #00014864' TO DFHEIV0
 15949     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15951     MOVE X'3520233030303134383634' TO DFHEIV0(25:11)
 15952     CALL 'kxdfhei1' USING DFHEIV0
 15953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15954
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 304
* EL156.cbl
 15955
 15956
 15957* EXEC CICS WRITE
 15958*         DATASET     ('ELTRLR')
 15959*         FROM        (ACTIVITY-TRAILERS)
 15960*         RIDFLD      (AT-CONTROL-PRIMARY)
 15961*     END-EXEC.
 15962     MOVE LENGTH OF
 15963      ACTIVITY-TRAILERS
 15964       TO DFHEIV11
 15965     MOVE 'ELTRLR' TO DFHEIV1
 15966*    MOVE '&$ L                  ''   #00014868' TO DFHEIV0
 15967     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15968     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15969     MOVE X'2020233030303134383638' TO DFHEIV0(25:11)
 15970     CALL 'kxdfhei1' USING DFHEIV0,
 15971           DFHEIV1,
 15972           ACTIVITY-TRAILERS,
 15973           DFHEIV11,
 15974           AT-CONTROL-PRIMARY,
 15975           DFHEIV99,
 15976           DFHEIV99
 15977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15978
 15979
 15980
 15981     GO TO 6199-EXIT.
 15982
 15983 6180-DUPREC.
 15984
 15985     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15986     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15987     GO TO 6170-WRITE.
 15988
 15989 6185-DUPREC.
 15990     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15991     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15992     GO TO 6177-WRITE.
 15993
 15994 6190-DUPREC.
 15995     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15996     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15997     GO TO 6175-WRITE.
 15998
 15999 6199-EXIT.
 16000      EXIT.
 16001
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 305
* EL156.cbl
 16003 6200-UPDATE-CLAIM-MSTR.
 16004     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16005     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16006     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16007     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16008
 16009     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16010
 16011     MOVE ZEROS                  TO W-INTEREST.
 16012
 16013     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 16014        IF (PI-OFFLINE = 'Y') OR
 16015           (PI-PMTTYPE = '7')
 16016           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16017                                 THRU 9870-EXIT
 16018        END-IF
 16019     END-IF
 16020     IF NOT ERROR-ON-OUTPUT
 16021        CONTINUE
 16022     ELSE
 16023
 16024* EXEC CICS REWRITE
 16025*          DATASET('ELMSTR')
 16026*          FROM(CLAIM-MASTER)
 16027*       END-EXEC
 16028     MOVE LENGTH OF
 16029      CLAIM-MASTER
 16030       TO DFHEIV11
 16031     MOVE 'ELMSTR' TO DFHEIV1
 16032*    MOVE '&& L                  %   #00014917' TO DFHEIV0
 16033     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16034     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16035     MOVE X'2020233030303134393137' TO DFHEIV0(25:11)
 16036     CALL 'kxdfhei1' USING DFHEIV0,
 16037           DFHEIV1,
 16038           CLAIM-MASTER,
 16039           DFHEIV11,
 16040           DFHEIV99
 16041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16042
 16043        MOVE -1                  TO ENTPFBL
 16044        MOVE AL-UANON            TO ENTPFBA
 16045        MOVE MAP-NAMEB           TO MAP-NAME
 16046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16047        GO TO 8200-SEND-DATAONLY
 16048     END-IF
 16049
 16050     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16051
 16052     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16053
 16054     IF PI-AIG-SPECIAL-BENEFIT
 16055         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16056
 16057     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16058
 16059     IF PI-SPECIAL-BEN-SW = 'Y'
 16060         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 306
* EL156.cbl
 16061         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16062
 16063     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16064         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16065     ELSE
 16066         IF PI-PMTTYPE NOT = '4'
 16067            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16068
 16069     IF PI-PMTTYPE = '5' OR '6'
 16070        GO TO  6250-SET-MAINT.
 16071
 16072     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16073                                         CL-LAG-REPORT-CODE.
 16074
 16075     IF CL-ACTIVITY-CODE = 09
 16076         GO TO 6200-CONT-UPDATE.
 16077
 16078     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16079         IF CL-ACTIVITY-CODE = 11
 16080             GO TO 6200-CONT-UPDATE.
 16081
 16082     IF WS-ACT-REC-FOUND-SW = 'N'
 16083         GO TO 6200-CONT-UPDATE.
 16084
 16085     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16086         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16087         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16088         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16089
 16090     IF WS-UPDATE-SW = 'Y'
 16091         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16092                                         CL-NEXT-FOLLOWUP-DT.
 16093
 16094 6200-CONT-UPDATE.
 16095
 16096     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16097       IF CLAIM-IS-CLOSED
 16098         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16099           IF WS-OPEN-CLOSE-SW = '2'
 16100             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16101                                        CL-LAST-CLOSE-DT.
 16102
 16103     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16104        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16105        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16106
 16107     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16108        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16109        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16110        MOVE 'C'                 TO CL-CLAIM-STATUS
 16111        IF PI-PMTTYPE = '2'
 16112           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16113           CONTINUE
 16114        ELSE
 16115           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16116        END-IF
 16117     ELSE
 16118        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 307
* EL156.cbl
 16119           IF PI-PMTTYPE = '2' AND
 16120              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16121              CONTINUE
 16122           ELSE
 16123              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16124           END-IF
 16125        END-IF
 16126     END-IF
 16127
 16128     IF PI-PMTTYPE = '4'
 16129        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16130
 16131     IF PI-COMPANY-ID = 'CVL'
 16132         IF PI-LOAN-UPDATE-SW = 'Y'
 16133             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16134             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16135             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16136             MOVE CL-CERT-STATE      TO  CERT-STATE
 16137             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16138             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16139             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16140             MOVE 'CERT'             TO  FILE-SWITCH
 16141             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16142             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16143             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16144
 16145     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16146        GO TO 6220-USE-COMPUTED.
 16147
 16148     IF (PI-PMTTYPE = '4')  AND
 16149        (PI-EPYAMT < ZEROS)
 16150          COMPUTE CL-NO-OF-DAYS-PAID =
 16151                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16152          IF CL-NO-OF-DAYS-PAID < +0
 16153              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16154          ELSE
 16155              NEXT SENTENCE
 16156     ELSE
 16157          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16158
 16159     IF PI-PROCESSOR-ID = 'FIX '
 16160        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16161           NEXT SENTENCE
 16162        ELSE
 16163           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16164     ELSE
 16165        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16166
 16167     IF PI-PMTTYPE = '4'
 16168        GO TO 6250-SET-MAINT.
 16169
 16170     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16171
 16172     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16173     MOVE '4'                    TO DC-OPTION-CODE.
 16174     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16175     IF DATE-CONVERSION-ERROR
 16176        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 308
* EL156.cbl
 16177     ELSE
 16178        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16179           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16180           IF PI-AIG-SPECIAL-BENEFIT
 16181               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16182           ELSE
 16183               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16184
 16185     GO TO 6250-SET-MAINT.
 16186
 16187 6220-USE-COMPUTED.
 16188
 16189     IF (PI-PMTTYPE = '4')  AND
 16190        (PI-CPYAMT < ZEROS)
 16191          COMPUTE CL-NO-OF-DAYS-PAID =
 16192                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16193          IF CL-NO-OF-DAYS-PAID < +0
 16194              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16195          ELSE
 16196              NEXT SENTENCE
 16197     ELSE
 16198          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16199
 16200     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16201
 16202     IF PI-PMTTYPE = '4'
 16203        GO TO 6250-SET-MAINT.
 16204
 16205     IF PI-AIG-SPECIAL-BENEFIT
 16206         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16207     ELSE
 16208         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16209
 16210     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16211
 16212     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16213        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16214
 16215 6250-SET-MAINT.
 16216     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16217
 16218     IF PI-PROCESSOR-ID = 'FIX '
 16219        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16220           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16221        ELSE
 16222           NEXT SENTENCE
 16223     ELSE
 16224        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16225
 16226     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16227     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16228     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16229
 16230 6299-EXIT.
 16231      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 309
* EL156.cbl
 16233 6300-UPDATE-CERT.
 16234
 16235*  ADD CERTNOTE FOR SC NP+6
 16236     IF PI-COMPANY-ID = 'CID' AND
 16237       (PI-PMTTYPE = '2' OR '3') AND
 16238        CL-CERT-STATE = 'SC'  AND
 16239        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16240           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16241     END-IF.
 16242
 16243     IF PI-COMPANY-ID = 'AHL' AND
 16244       (PI-PMTTYPE = '2' OR '3') AND
 16245        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16246           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16247           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16248     END-IF.
 16249
 16250     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16251     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16252     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16253     MOVE CL-CERT-STATE    TO CERT-STATE.
 16254     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16255     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16256     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16257     MOVE 'CERT'           TO FILE-SWITCH.
 16258
 16259     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16260
 16261     IF CERT-NOTE-ADDED
 16262        IF CM-NOTE-SW = ' '
 16263           MOVE '4'             TO CM-NOTE-SW
 16264        ELSE
 16265           IF CM-NOTE-SW = '1'
 16266               MOVE '5'           TO CM-NOTE-SW
 16267           ELSE
 16268              IF CM-NOTE-SW = '2'
 16269                 MOVE '6'         TO CM-NOTE-SW
 16270              ELSE
 16271                 IF CM-NOTE-SW = '3'
 16272                    MOVE '7'      TO CM-NOTE-SW
 16273                 END-IF
 16274              END-IF
 16275           END-IF
 16276        END-IF
 16277     END-IF.
 16278
 16279     IF PI-COMPANY-ID = 'CVL'
 16280         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16281         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16282
 16283     IF PI-PMTTYPE NOT = '4'
 16284        GO TO 6340-UPDATE-CERT.
 16285
 16286     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16287        IF PI-PFKEY-USED = DFHPF5
 16288           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16289        ELSE
 16290           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 310
* EL156.cbl
 16291
 16292*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16293*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16294*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16295*               PI-LF-COVERAGE-TYPE = 'P'
 16296*                GO TO 6350-REWRITE-CERT.
 16297
 16298     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16299       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16300          PI-LF-COVERAGE-TYPE = 'P'
 16301           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16302                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16303                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16304                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16305                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16306                GO TO 6350-REWRITE-CERT
 16307            ELSE
 16308                GO TO 6350-REWRITE-CERT.
 16309
 16310     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16311         GO TO 6350-REWRITE-CERT.
 16312
 16313     IF NOT CM-AH-LUMP-SUM-DISAB
 16314        GO TO 6380-UNLOCK-CERT.
 16315
 16316     IF PI-PFKEY-USED = DFHPF5
 16317        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16318                                    CM-AH-ITD-AH-PMT
 16319        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16320        GO TO 6350-REWRITE-CERT
 16321     ELSE
 16322        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16323                                    CM-AH-ITD-AH-PMT
 16324        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16325        GO TO 6350-REWRITE-CERT.
 16326
 16327 6340-UPDATE-CERT.
 16328
 16329     IF CL-CLAIM-TYPE = 'L'
 16330         IF PI-PFKEY-USED = DFHPF5
 16331             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16332         ELSE
 16333             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16334
 16335     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16336         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16337             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16338                PI-LF-COVERAGE-TYPE = 'P'
 16339                 GO TO 6350-REWRITE-CERT.
 16340
 16341     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16342       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16343          PI-LF-COVERAGE-TYPE = 'P'
 16344           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16345                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16346                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16347                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16348                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 311
* EL156.cbl
 16349                GO TO 6350-REWRITE-CERT.
 16350
 16351     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16352         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16353            PI-LF-COVERAGE-TYPE NOT = 'P'
 16354             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16355             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16356             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16357             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16358             GO TO 6350-REWRITE-CERT.
 16359
 16360     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16361         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16362         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16363         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16364         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16365         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16366         IF PI-PFKEY-USED = DFHPF5
 16367             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16368                                        CM-AH-ITD-AH-PMT
 16369             GO TO 6350-REWRITE-CERT
 16370         ELSE
 16371             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16372                                        CM-AH-ITD-AH-PMT
 16373             GO TO 6350-REWRITE-CERT.
 16374
 16375 6350-REWRITE-CERT.
 16376
 16377
 16378* EXEC CICS REWRITE
 16379*         DATASET  ('ELCERT')
 16380*         FROM(CERTIFICATE-MASTER)
 16381*     END-EXEC.
 16382     MOVE LENGTH OF
 16383      CERTIFICATE-MASTER
 16384       TO DFHEIV11
 16385     MOVE 'ELCERT' TO DFHEIV1
 16386*    MOVE '&& L                  %   #00015256' TO DFHEIV0
 16387     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16388     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16389     MOVE X'2020233030303135323536' TO DFHEIV0(25:11)
 16390     CALL 'kxdfhei1' USING DFHEIV0,
 16391           DFHEIV1,
 16392           CERTIFICATE-MASTER,
 16393           DFHEIV11,
 16394           DFHEIV99
 16395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16396
 16397
 16398     GO TO 6399-EXIT.
 16399
 16400 6380-UNLOCK-CERT.
 16401
 16402* EXEC CICS UNLOCK
 16403*         DATASET  ('ELCERT')
 16404*     END-EXEC.
 16405     MOVE 'ELCERT' TO DFHEIV1
 16406*    MOVE '&*                    #   #00015264' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 312
* EL156.cbl
 16407     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16408     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16409     MOVE X'2020233030303135323634' TO DFHEIV0(25:11)
 16410     CALL 'kxdfhei1' USING DFHEIV0,
 16411           DFHEIV1,
 16412           DFHEIV99
 16413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16414
 16415
 16416 6399-EXIT.
 16417      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 313
* EL156.cbl
 16419 6400-UPDATE-ZERO-TRAILER.
 16420     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16421     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16422
 16423     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16424
 16425     IF PI-EPYAMT NOT = ZEROS
 16426         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16427     ELSE
 16428         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16429
 16430     IF PI-ERESV NOT = ZEROS
 16431        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16432
 16433     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16434        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16435
 16436     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16437        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16438     ELSE
 16439        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16440
 16441     IF PI-PMTTYPE = '5'
 16442        IF PI-EPYAMT = ZEROS
 16443           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16444        ELSE
 16445           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16446
 16447     IF PI-PMTTYPE = '6'
 16448        IF PI-EPYAMT = ZEROS
 16449           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16450        ELSE
 16451           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16452
 16453 6420-CHECK-OPEN-CLOSE.
 16454     IF PI-PMTTYPE = '5' OR '6'
 16455        GO TO 6450-REWRITE.
 16456
 16457     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16458         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16459             IF CLAIM-IS-CLOSED
 16460                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16461                 MOVE 1          TO  SUB-1
 16462                 GO TO 6440-AIG-LOOP.
 16463
 16464     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16465        GO TO 6450-REWRITE.
 16466
 16467     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16468        GO TO 6450-REWRITE.
 16469
 16470     MOVE 1                      TO SUB-1.
 16471
 16472 6430-LOOP.
 16473     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16474        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16475        IF PI-PMTTYPE = '1' OR '4'
 16476           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 314
* EL156.cbl
 16477           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16478           GO TO 6450-REWRITE
 16479        ELSE
 16480           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16481           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16482           GO TO 6450-REWRITE.
 16483
 16484     IF SUB-1 = 6
 16485      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16486      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16487      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16488      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16489      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16490      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16491      GO TO 6430-LOOP.
 16492
 16493     ADD 1                       TO SUB-1.
 16494     GO TO 6430-LOOP.
 16495
 16496
 16497 6440-AIG-LOOP.
 16498
 16499     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16500       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16501       IF WS-OPEN-CLOSE-SW = '1'
 16502         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16503         IF PI-PMTTYPE = '2'
 16504           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16505           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16506         ELSE
 16507           IF PI-PMTTYPE = '3'
 16508             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16509             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16510           ELSE
 16511             IF PI-PMTTYPE = '4'
 16512               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16513               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16514             ELSE
 16515               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16516               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16517       ELSE
 16518         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16519         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16520         GO TO 6450-REWRITE.
 16521
 16522     IF SUB-1 = 6
 16523      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16524      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16525      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16526      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16527      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16528      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16529      GO TO 6440-AIG-LOOP.
 16530
 16531     ADD 1                       TO SUB-1.
 16532     GO TO 6440-AIG-LOOP.
 16533
 16534 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 315
* EL156.cbl
 16535     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16536     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16537     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16538
 16539     IF PI-COMPANY-ID = 'DMD'
 16540         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16541         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16542         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16543         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16544         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16545
 16546
 16547* EXEC CICS REWRITE
 16548*         DATASET  ('ELTRLR')
 16549*         FROM     (ACTIVITY-TRAILERS)
 16550*     END-EXEC.
 16551     MOVE LENGTH OF
 16552      ACTIVITY-TRAILERS
 16553       TO DFHEIV11
 16554     MOVE 'ELTRLR' TO DFHEIV1
 16555*    MOVE '&& L                  %   #00015398' TO DFHEIV0
 16556     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16557     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16558     MOVE X'2020233030303135333938' TO DFHEIV0(25:11)
 16559     CALL 'kxdfhei1' USING DFHEIV0,
 16560           DFHEIV1,
 16561           ACTIVITY-TRAILERS,
 16562           DFHEIV11,
 16563           DFHEIV99
 16564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16565
 16566
 16567 6499-EXIT.
 16568      EXIT.
 16569
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 316
* EL156.cbl
 16571 6500-READ-DLO035.
 16572     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16573     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16574     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16575     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16576
 16577
 16578* EXEC CICS LINK
 16579*        PROGRAM    ('DLO035')
 16580*        COMMAREA   (DLO035-KEY)
 16581*        LENGTH     (DL35-LENGTH)
 16582*    END-EXEC.
 16583     MOVE 'DLO035' TO DFHEIV1
 16584*    MOVE '."C                   (   #00015413' TO DFHEIV0
 16585     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16587     MOVE X'2020233030303135343133' TO DFHEIV0(25:11)
 16588     CALL 'kxdfhei1' USING DFHEIV0,
 16589           DFHEIV1,
 16590           DLO035-KEY,
 16591           DL35-LENGTH,
 16592           DFHEIV99,
 16593           DFHEIV99,
 16594           DFHEIV99,
 16595           DFHEIV99
 16596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16597
 16598
 16599     IF DL35-RETURN-CODE = 'OK'
 16600         GO TO 6500-EXIT.
 16601
 16602     IF DL35-RETURN-CODE = '01'
 16603         MOVE ER-7830            TO EMI-ERROR
 16604         GO TO 6500-BAD-EXIT.
 16605
 16606     IF DL35-RETURN-CODE = '02'
 16607         MOVE ER-7831            TO EMI-ERROR
 16608         GO TO 6500-BAD-EXIT.
 16609
 16610     IF DL35-RETURN-CODE = '03'
 16611         MOVE ER-7832            TO EMI-ERROR
 16612         GO TO 6500-BAD-EXIT.
 16613
 16614     IF DL35-RETURN-CODE = '04'
 16615         MOVE ER-7833            TO EMI-ERROR
 16616         GO TO 6500-BAD-EXIT.
 16617
 16618     IF DL35-RETURN-CODE = '05'
 16619         MOVE ER-7834            TO EMI-ERROR
 16620         GO TO 6500-BAD-EXIT.
 16621
 16622     IF DL35-RETURN-CODE = '06'
 16623         MOVE ER-7835            TO EMI-ERROR
 16624         GO TO 6500-BAD-EXIT.
 16625
 16626     IF DL35-RETURN-CODE = '07'
 16627         MOVE ER-7836            TO EMI-ERROR
 16628         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 317
* EL156.cbl
 16629
 16630     IF DL35-RETURN-CODE = 'E1'
 16631         MOVE ER-7837            TO EMI-ERROR
 16632         GO TO 6500-BAD-EXIT.
 16633
 16634     IF DL35-RETURN-CODE NOT = 'OK'
 16635         MOVE ER-7838            TO EMI-ERROR
 16636         GO TO 6500-BAD-EXIT.
 16637
 16638 6500-EXIT.
 16639      EXIT.
 16640
 16641 6500-BAD-EXIT.
 16642
 16643* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16644*    MOVE '6"R                   !   #00015462' TO DFHEIV0
 16645     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16647     MOVE X'2020233030303135343632' TO DFHEIV0(25:11)
 16648     CALL 'kxdfhei1' USING DFHEIV0
 16649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16650
 16651     MOVE -1                 TO PMTTYPEL.
 16652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16653     GO TO 8200-SEND-DATAONLY.
 16654
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 318
* EL156.cbl
 16656 6600-UPDATE-DLO035.
 16657     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16658     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16659     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16660     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16661
 16662
 16663* EXEC CICS LINK
 16664*        PROGRAM    ('DLO035')
 16665*        COMMAREA   (DLO035-KEY)
 16666*        LENGTH     (DL35-LENGTH)
 16667*    END-EXEC.
 16668     MOVE 'DLO035' TO DFHEIV1
 16669*    MOVE '."C                   (   #00015474' TO DFHEIV0
 16670     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16672     MOVE X'2020233030303135343734' TO DFHEIV0(25:11)
 16673     CALL 'kxdfhei1' USING DFHEIV0,
 16674           DFHEIV1,
 16675           DLO035-KEY,
 16676           DL35-LENGTH,
 16677           DFHEIV99,
 16678           DFHEIV99,
 16679           DFHEIV99,
 16680           DFHEIV99
 16681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16682
 16683
 16684     IF DL35-RETURN-CODE = 'OK'
 16685         GO TO 6600-EXIT.
 16686
 16687     IF DL35-RETURN-CODE = '01'
 16688         MOVE ER-7830            TO EMI-ERROR
 16689         GO TO 6500-BAD-EXIT.
 16690
 16691     IF DL35-RETURN-CODE = '02'
 16692         MOVE ER-7831            TO EMI-ERROR
 16693         GO TO 6500-BAD-EXIT.
 16694
 16695     IF DL35-RETURN-CODE = '03'
 16696         MOVE ER-7832            TO EMI-ERROR
 16697         GO TO 6500-BAD-EXIT.
 16698
 16699     IF DL35-RETURN-CODE = '04'
 16700         MOVE ER-7833            TO EMI-ERROR
 16701         GO TO 6500-BAD-EXIT.
 16702
 16703     IF DL35-RETURN-CODE = '05'
 16704         MOVE ER-7834            TO EMI-ERROR
 16705         GO TO 6500-BAD-EXIT.
 16706
 16707     IF DL35-RETURN-CODE = '06'
 16708         MOVE ER-7835            TO EMI-ERROR
 16709         GO TO 6500-BAD-EXIT.
 16710
 16711     IF DL35-RETURN-CODE = '07'
 16712         MOVE ER-7836            TO EMI-ERROR
 16713         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 319
* EL156.cbl
 16714
 16715     IF DL35-RETURN-CODE = 'E1'
 16716         MOVE ER-7837            TO EMI-ERROR
 16717         GO TO 6500-BAD-EXIT.
 16718
 16719     IF DL35-RETURN-CODE NOT = 'OK'
 16720         MOVE ER-7838            TO EMI-ERROR
 16721         GO TO 6500-BAD-EXIT.
 16722
 16723 6600-EXIT.
 16724      EXIT.
 16725
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 320
* EL156.cbl
 16727 6700-UPDATE-ACTQ.
 16728***************************************************************
 16729*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16730*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16731*    ONE ALREADY THERE.                                       *
 16732***************************************************************
 16733
 16734
 16735* EXEC CICS HANDLE CONDITION
 16736*         NOTFND(6720-BUILD-NEW-RECORD)
 16737*     END-EXEC.
 16738*    MOVE '"$I                   ! 6 #00015530' TO DFHEIV0
 16739     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16741     MOVE X'3620233030303135353330' TO DFHEIV0(25:11)
 16742     CALL 'kxdfhei1' USING DFHEIV0
 16743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16744
 16745
 16746
 16747* EXEC CICS READ
 16748*         DATASET('ELACTQ')
 16749*         RIDFLD (ELMSTR-KEY)
 16750*         SET    (ADDRESS OF ACTIVITY-QUE)
 16751*         UPDATE
 16752*     END-EXEC.
 16753     MOVE 'ELACTQ' TO DFHEIV1
 16754*    MOVE '&"S        EU         (   #00015534' TO DFHEIV0
 16755     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16756     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16757     MOVE X'2020233030303135353334' TO DFHEIV0(25:11)
 16758     CALL 'kxdfhei1' USING DFHEIV0,
 16759           DFHEIV1,
 16760           DFHEIV20,
 16761           DFHEIV99,
 16762           ELMSTR-KEY,
 16763           DFHEIV99,
 16764           DFHEIV99,
 16765           DFHEIV99
 16766     SET ADDRESS OF ACTIVITY-QUE TO
 16767         DFHEIV20
 16768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16769
 16770
 16771     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16772
 16773     IF PI-AIG-SPECIAL-BENEFIT AND
 16774        PI-CASH = 'Y'
 16775         ADD 2                   TO AQ-PAYMENT-COUNTER
 16776     ELSE
 16777         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16778
 16779     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16780         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16781
 16782     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16783
 16784     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 321
* EL156.cbl
 16785         IF WS-PMT-APPROVAL-SW = 'A'
 16786             NEXT SENTENCE
 16787         ELSE
 16788            IF PI-AIG-SPECIAL-BENEFIT AND
 16789               PI-CASH = 'Y'
 16790                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16791                                     WS-PMT-UNAPPROVED-CNT
 16792            ELSE
 16793                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16794                                     WS-PMT-UNAPPROVED-CNT
 16795     ELSE
 16796         IF PI-PMT-APPR-SW = 'Y'
 16797            IF PI-AIG-SPECIAL-BENEFIT AND
 16798               PI-CASH = 'Y'
 16799                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16800                                     WS-PMT-UNAPPROVED-CNT
 16801            ELSE
 16802                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16803                                     WS-PMT-UNAPPROVED-CNT.
 16804
 16805     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16806         MOVE ER-3536 TO EMI-ERROR
 16807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16808
 16809     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16810
 16811
 16812* EXEC CICS REWRITE
 16813*         DATASET('ELACTQ')
 16814*         FROM   (ACTIVITY-QUE)
 16815*     END-EXEC.
 16816     MOVE LENGTH OF
 16817      ACTIVITY-QUE
 16818       TO DFHEIV11
 16819     MOVE 'ELACTQ' TO DFHEIV1
 16820*    MOVE '&& L                  %   #00015581' TO DFHEIV0
 16821     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16822     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16823     MOVE X'2020233030303135353831' TO DFHEIV0(25:11)
 16824     CALL 'kxdfhei1' USING DFHEIV0,
 16825           DFHEIV1,
 16826           ACTIVITY-QUE,
 16827           DFHEIV11,
 16828           DFHEIV99
 16829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16830
 16831
 16832     GO TO 6799-EXIT.
 16833
 16834 6720-BUILD-NEW-RECORD.
 16835
 16836* EXEC CICS GETMAIN
 16837*         SET    (ADDRESS OF ACTIVITY-QUE)
 16838*         LENGTH (60)
 16839*         INITIMG(GETMAIN-SPACE)
 16840*     END-EXEC.
 16841     MOVE 60
 16842       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 322
* EL156.cbl
 16843*    MOVE ',"IL                  $   #00015589' TO DFHEIV0
 16844     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16846     MOVE X'2020233030303135353839' TO DFHEIV0(25:11)
 16847     CALL 'kxdfhei1' USING DFHEIV0,
 16848           DFHEIV20,
 16849           DFHEIV11,
 16850           GETMAIN-SPACE
 16851     SET ADDRESS OF ACTIVITY-QUE TO
 16852         DFHEIV20
 16853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16854
 16855
 16856     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16857
 16858     IF PI-AIG-SPECIAL-BENEFIT AND
 16859        PI-CASH = 'Y'
 16860         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16861     ELSE
 16862         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16863
 16864     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16865     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16866     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16867     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16868                                    AQ-FOLLOWUP-DATE.
 16869     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16870     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16871
 16872     IF PI-PMT-GRADUATED
 16873         IF WS-PMT-APPROVAL-SW = 'A'
 16874             NEXT SENTENCE
 16875         ELSE
 16876            IF PI-AIG-SPECIAL-BENEFIT AND
 16877               PI-CASH = 'Y'
 16878                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16879            ELSE
 16880                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16881     ELSE
 16882         IF PI-PMT-APPR-SW = 'Y'
 16883            IF PI-AIG-SPECIAL-BENEFIT AND
 16884               PI-CASH = 'Y'
 16885                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16886            ELSE
 16887                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16888
 16889     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16890         MOVE ER-3536 TO EMI-ERROR
 16891         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16892
 16893
 16894* EXEC CICS WRITE
 16895*         DATASET('ELACTQ')
 16896*         RIDFLD (ELMSTR-KEY)
 16897*         FROM   (ACTIVITY-QUE)
 16898*     END-EXEC.
 16899     MOVE LENGTH OF
 16900      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 323
* EL156.cbl
 16901       TO DFHEIV11
 16902     MOVE 'ELACTQ' TO DFHEIV1
 16903*    MOVE '&$ L                  ''   #00015632' TO DFHEIV0
 16904     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16905     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16906     MOVE X'2020233030303135363332' TO DFHEIV0(25:11)
 16907     CALL 'kxdfhei1' USING DFHEIV0,
 16908           DFHEIV1,
 16909           ACTIVITY-QUE,
 16910           DFHEIV11,
 16911           ELMSTR-KEY,
 16912           DFHEIV99,
 16913           DFHEIV99
 16914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16915
 16916
 16917 6799-EXIT.
 16918      EXIT.
 16919
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 324
* EL156.cbl
 16921 6800-BUILD-FORM-TRAILER.
 16922
 16923
 16924* EXEC CICS GETMAIN
 16925*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16926*         LENGTH   (200)
 16927*         INITIMG  (GETMAIN-SPACE)
 16928*    END-EXEC.
 16929     MOVE 200
 16930       TO DFHEIV11
 16931*    MOVE ',"IL                  $   #00015644' TO DFHEIV0
 16932     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16933     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16934     MOVE X'2020233030303135363434' TO DFHEIV0(25:11)
 16935     CALL 'kxdfhei1' USING DFHEIV0,
 16936           DFHEIV20,
 16937           DFHEIV11,
 16938           GETMAIN-SPACE
 16939     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16940         DFHEIV20
 16941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16942
 16943
 16944     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16945
 16946     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16947     MOVE 'AT'                   TO AT-RECORD-ID.
 16948     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16949
 16950     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16951     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16952                                    AT-FORM-LAST-MAINT-DT
 16953                                    AT-FORM-SEND-ON-DT.
 16954     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16955                                    AT-FORM-LAST-UPDATED-BY.
 16956     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16957     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16958     MOVE '6'                    TO DC-OPTION-CODE.
 16959     MOVE +29                    TO DC-ELAPSED-DAYS.
 16960     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16961     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16962     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16963
 16964     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16965         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16966
 16967     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16968                                    AT-FORM-RE-SEND-DT
 16969                                    AT-EMP-FORM-ANSWERED-DT
 16970                                    AT-PHY-FORM-ANSWERED-DT
 16971                                    AT-EMP-FORM-SEND-ON-DT
 16972                                    AT-PHY-FORM-SEND-ON-DT
 16973                                    AT-FORM-PRINTED-DT
 16974                                    AT-FORM-REPRINT-DT.
 16975     MOVE '2'                    TO AT-FORM-TYPE.
 16976
 16977     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16978     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 325
* EL156.cbl
 16979
 16980     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16981         NEXT SENTENCE
 16982     ELSE
 16983         IF CL-PROG-FORM-TYPE NOT = 'S'
 16984            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16985
 16986
 16987* EXEC CICS WRITE
 16988*         DATASET  ('ELTRLR')
 16989*         FROM     (ACTIVITY-TRAILERS)
 16990*         RIDFLD   (AT-CONTROL-PRIMARY)
 16991*     END-EXEC.
 16992     MOVE LENGTH OF
 16993      ACTIVITY-TRAILERS
 16994       TO DFHEIV11
 16995     MOVE 'ELTRLR' TO DFHEIV1
 16996*    MOVE '&$ L                  ''   #00015692' TO DFHEIV0
 16997     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16998     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16999     MOVE X'2020233030303135363932' TO DFHEIV0(25:11)
 17000     CALL 'kxdfhei1' USING DFHEIV0,
 17001           DFHEIV1,
 17002           ACTIVITY-TRAILERS,
 17003           DFHEIV11,
 17004           AT-CONTROL-PRIMARY,
 17005           DFHEIV99,
 17006           DFHEIV99
 17007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17008
 17009
 17010 6899-EXIT.
 17011      EXIT.
 17012
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 326
* EL156.cbl
 17014 6900-BUILD-ARCHIVE-HEADER.
 17015
 17016     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17017     MOVE '1'                    TO CNTL-REC-TYPE.
 17018     MOVE +0                     TO CNTL-SEQ-NO.
 17019     MOVE SPACES                 TO CNTL-ACCESS.
 17020
 17021
 17022* EXEC CICS READ
 17023*         DATASET  ('ELCNTL')
 17024*         SET      (ADDRESS OF CONTROL-FILE)
 17025*         RIDFLD   (ELCNTL-KEY)
 17026*         UPDATE
 17027*    END-EXEC.
 17028     MOVE 'ELCNTL' TO DFHEIV1
 17029*    MOVE '&"S        EU         (   #00015709' TO DFHEIV0
 17030     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17031     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17032     MOVE X'2020233030303135373039' TO DFHEIV0(25:11)
 17033     CALL 'kxdfhei1' USING DFHEIV0,
 17034           DFHEIV1,
 17035           DFHEIV20,
 17036           DFHEIV99,
 17037           ELCNTL-KEY,
 17038           DFHEIV99,
 17039           DFHEIV99,
 17040           DFHEIV99
 17041     SET ADDRESS OF CONTROL-FILE TO
 17042         DFHEIV20
 17043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17044
 17045
 17046     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17047     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17048
 17049
 17050* EXEC CICS REWRITE
 17051*         FROM     (CONTROL-FILE)
 17052*         DATASET  ('ELCNTL')
 17053*    END-EXEC.
 17054     MOVE LENGTH OF
 17055      CONTROL-FILE
 17056       TO DFHEIV11
 17057     MOVE 'ELCNTL' TO DFHEIV1
 17058*    MOVE '&& L                  %   #00015719' TO DFHEIV0
 17059     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17060     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17061     MOVE X'2020233030303135373139' TO DFHEIV0(25:11)
 17062     CALL 'kxdfhei1' USING DFHEIV0,
 17063           DFHEIV1,
 17064           CONTROL-FILE,
 17065           DFHEIV11,
 17066           DFHEIV99
 17067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17068
 17069
 17070
 17071* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 327
* EL156.cbl
 17072*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17073*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17074*    END-EXEC.
 17075*    MOVE '"$$%                  ! 7 #00015724' TO DFHEIV0
 17076     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17078     MOVE X'3720233030303135373234' TO DFHEIV0(25:11)
 17079     CALL 'kxdfhei1' USING DFHEIV0
 17080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17081
 17082
 17083
 17084* EXEC CICS GETMAIN
 17085*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17086*         LENGTH  (ELARCH-LENGTH)
 17087*         INITIMG (GETMAIN-SPACE)
 17088*    END-EXEC.
 17089*    MOVE ',"IL                  $   #00015729' TO DFHEIV0
 17090     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17091     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17092     MOVE X'2020233030303135373239' TO DFHEIV0(25:11)
 17093     CALL 'kxdfhei1' USING DFHEIV0,
 17094           DFHEIV20,
 17095           ELARCH-LENGTH,
 17096           GETMAIN-SPACE
 17097     SET ADDRESS OF LETTER-ARCHIVE TO
 17098         DFHEIV20
 17099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17100
 17101
 17102     MOVE 'LA'                   TO LA-RECORD-ID.
 17103     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17104                                    LA-ARCHIVE-NO-A1.
 17105     MOVE '4'                    TO LA-RECORD-TYPE
 17106                                    LA-RECORD-TYPE-A1.
 17107     MOVE +0                     TO LA-LINE-SEQ-NO
 17108                                    LA-LINE-SEQ-NO-A1.
 17109     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17110                                    LA-COMPANY-CD-A1.
 17111     MOVE CL-CARRIER             TO LA4-CARRIER.
 17112     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17113     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17114     MOVE CL-CERT-STATE          TO LA4-STATE.
 17115     MOVE +0                     TO LA4-NO-OF-COPIES.
 17116     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17117     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17118     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17119                                    LA4-INITIAL-PRINT-DATE
 17120                                    LA4-RESEND-PRINT-DATE
 17121                                    LA4-FORM-REM-PRINT-DT.
 17122     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17123     MOVE '2'                    TO LA4-FORM-TYPE.
 17124
 17125
 17126* EXEC CICS WRITE
 17127*         DATASET  ('ELARCH')
 17128*         FROM     (LETTER-ARCHIVE)
 17129*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 328
* EL156.cbl
 17130*    END-EXEC.
 17131     MOVE LENGTH OF
 17132      LETTER-ARCHIVE
 17133       TO DFHEIV11
 17134     MOVE 'ELARCH' TO DFHEIV1
 17135*    MOVE '&$ L                  ''   #00015758' TO DFHEIV0
 17136     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17138     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 17139     CALL 'kxdfhei1' USING DFHEIV0,
 17140           DFHEIV1,
 17141           LETTER-ARCHIVE,
 17142           DFHEIV11,
 17143           LA-CONTROL-PRIMARY,
 17144           DFHEIV99,
 17145           DFHEIV99
 17146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17147
 17148
 17149 6999-EXIT.
 17150      EXIT.
 17151
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 329
* EL156.cbl
 17153 7000-SHOW-CLAIM.
 17154     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17155     MOVE 'A'                    TO PI-PASS-SW.
 17156     MOVE LOW-VALUES             TO PI-CPYFROM
 17157                                    PI-MONTH-END-SAVE
 17158                                    PI-CPYTHRU.
 17159
 17160     MOVE ZEROS                  TO PI-FATAL-COUNT
 17161                                    PI-DAILY-RATE
 17162                                    PI-BEN-DAYS
 17163                                    PI-MANUAL-SW
 17164                                    PI-SAVE-CURSOR
 17165                                    PI-FORCE-COUNT
 17166                                    PI-HOLDTIL
 17167                                    PI-EPYFROM
 17168                                    PI-EPYTHRU
 17169                                    PI-EDAYS
 17170                                    PI-EPYAMT
 17171                                    PI-ERESV
 17172                                    PI-EEXPENS
 17173                                    PI-CDAYS
 17174                                    PI-CPYAMT
 17175                                    PI-CRESV
 17176                                    PI-CEXPENS
 17177                                    PI-INT-RATE
 17178                                    PI-AIGFROM.
 17179     MOVE ZEROS                  TO PI-PROOF-DATE.
 17180     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17181                                    PI-REM-BEN-AMT
 17182                                    PI-MO-BEN-AMT
 17183                                    pi-ah-term.
 17184
 17185     MOVE LOW-VALUES             TO EL156AI.
 17186     MOVE MAP-NAMEA              TO MAP-NAME.
 17187
 17188* EXEC CICS HANDLE CONDITION
 17189*        NOTFND   (7010-BUILD-MAP)
 17190*    END-EXEC.
 17191*    MOVE '"$I                   ! 8 #00015802' TO DFHEIV0
 17192     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17194     MOVE X'3820233030303135383032' TO DFHEIV0(25:11)
 17195     CALL 'kxdfhei1' USING DFHEIV0
 17196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17197
 17198
 17199     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17200     MOVE '2'                    TO CNTL-REC-TYPE.
 17201     MOVE +0                     TO CNTL-SEQ-NO.
 17202     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17203
 17204
 17205* EXEC CICS READ
 17206*         DATASET  ('ELCNTL')
 17207*         SET      (ADDRESS OF CONTROL-FILE)
 17208*         RIDFLD   (ELCNTL-KEY)
 17209*    END-EXEC.
 17210     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 330
* EL156.cbl
 17211*    MOVE '&"S        E          (   #00015811' TO DFHEIV0
 17212     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17213     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17214     MOVE X'2020233030303135383131' TO DFHEIV0(25:11)
 17215     CALL 'kxdfhei1' USING DFHEIV0,
 17216           DFHEIV1,
 17217           DFHEIV20,
 17218           DFHEIV99,
 17219           ELCNTL-KEY,
 17220           DFHEIV99,
 17221           DFHEIV99,
 17222           DFHEIV99
 17223     SET ADDRESS OF CONTROL-FILE TO
 17224         DFHEIV20
 17225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17226
 17227
 17228     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17229
 17230     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17231         MOVE AL-UANON      TO SURVYYNA
 17232     END-IF.
 17233
 17234
 17235     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17236     MOVE '1'                    TO CNTL-REC-TYPE.
 17237     MOVE SPACES                 TO CNTL-ACCESS.
 17238     MOVE +0                     TO CNTL-SEQ-NO.
 17239
 17240
 17241* EXEC CICS READ
 17242*         DATASET  ('ELCNTL')
 17243*         SET      (ADDRESS OF CONTROL-FILE)
 17244*         RIDFLD   (ELCNTL-KEY)
 17245*    END-EXEC.
 17246     MOVE 'ELCNTL' TO DFHEIV1
 17247*    MOVE '&"S        E          (   #00015829' TO DFHEIV0
 17248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17250     MOVE X'2020233030303135383239' TO DFHEIV0(25:11)
 17251     CALL 'kxdfhei1' USING DFHEIV0,
 17252           DFHEIV1,
 17253           DFHEIV20,
 17254           DFHEIV99,
 17255           ELCNTL-KEY,
 17256           DFHEIV99,
 17257           DFHEIV99,
 17258           DFHEIV99
 17259     SET ADDRESS OF CONTROL-FILE TO
 17260         DFHEIV20
 17261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17262
 17263
 17264     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17265
 17266 7010-BUILD-MAP.
 17267
 17268
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 331
* EL156.cbl
 17269* EXEC CICS HANDLE CONDITION
 17270*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17271*    END-EXEC.
 17272*    MOVE '"$I                   ! 9 #00015839' TO DFHEIV0
 17273     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17275     MOVE X'3920233030303135383339' TO DFHEIV0(25:11)
 17276     CALL 'kxdfhei1' USING DFHEIV0
 17277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17278
 17279
 17280     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17281     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17282     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17283     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17284     MOVE 'MSTR'                 TO FILE-SWITCH.
 17285
 17286     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17287
 17288     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17289     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17290     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17291     MOVE CL-CCN                 TO PI-SV-CCN.
 17292
 17293     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17294     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17295     MOVE CL-CLAIM-NO            TO CLMNOO.
 17296     MOVE CL-CARRIER             TO CARRO.
 17297     MOVE CL-CERT-PRIME          TO CERTNOO.
 17298     MOVE CL-CERT-SFX            TO SUFXO.
 17299
 17300     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17301        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17302        CONTINUE
 17303     ELSE
 17304        MOVE AL-SADOF            TO ZINTHA
 17305                                    ZINTA
 17306                                    PINTHA
 17307                                    PINTA
 17308     END-IF
 17309     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17310     EVALUATE TRUE
 17311     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17312         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17313     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17314         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17315
 17316     WHEN CL-CLAIM-TYPE = 'I'
 17317         MOVE '  IU  '           TO CLMTYPO
 17318     WHEN CL-CLAIM-TYPE = 'G'
 17319         MOVE ' GAP  '           TO CLMTYPO
 17320     END-EVALUATE.
 17321     IF CLAIM-IS-OPEN
 17322         MOVE ' OPEN'            TO CLMSTATO
 17323     ELSE
 17324         MOVE 'CLOSED'           TO CLMSTATO.
 17325
 17326     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 332
* EL156.cbl
 17327
 17328     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17329         MOVE SPACES             TO  PCERTNOO
 17330                                     PSUFXO
 17331                                     PRIMHDGO
 17332                                     SEQUO
 17333         MOVE AL-SADOF           TO  PCERTNOA
 17334                                     PSUFXA
 17335                                     PRIMHDGA
 17336                                     SEQUA
 17337     ELSE
 17338         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17339         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17340         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17341         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17342         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17343         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17344         MOVE AL-SANON               TO  PCERTNOA
 17345                                         PSUFXA
 17346                                         PRIMHDGA
 17347         MOVE AL-SABON               TO  SEQUA.
 17348
 17349     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17350
 17351     IF CL-NO-OF-PMTS-MADE = 0 AND
 17352        CL-TOTAL-PAID-AMT = 0
 17353         NEXT SENTENCE
 17354     ELSE
 17355         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17356             IF NOT PI-USES-PAID-TO
 17357                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17358                 MOVE ' '                 TO DC-OPTION-CODE
 17359                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17360                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17361             ELSE
 17362                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17363                 MOVE '6'                 TO DC-OPTION-CODE
 17364                 MOVE +1                  TO DC-ELAPSED-DAYS
 17365                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17366                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17367                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17368
 17369     IF MAP-NAME = 'EL156A'
 17370        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17371           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17372             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17373           end-if
 17374        end-if
 17375     end-if
 17376     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17377         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17378         MOVE ' '                TO DC-OPTION-CODE
 17379         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17380         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17381
 17382     IF CL-INCURRED-DT NOT = LOW-VALUES
 17383         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17384         MOVE ' '                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 333
* EL156.cbl
 17385         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17386         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17387
 17388     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17389
 17390     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17391         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17392         MOVE ' '                TO DC-OPTION-CODE
 17393         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17394         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17395
 17396     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17397         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17398         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17399     ELSE
 17400         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17401         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17402
 17403     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17404     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17405     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17406     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17407                                    PI-GROUPING.
 17408     MOVE CL-CERT-STATE          TO CERT-STATE
 17409                                    PI-STATE.
 17410     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17411                                    PI-ACCOUNT.
 17412     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17413     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17414     MOVE 'CERT'                 TO FILE-SWITCH.
 17415
 17416     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17417     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17418        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17419        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17420            MOVE 'N' TO PI-JOINT-INSURED-IND
 17421     ELSE
 17422            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17423     END-IF.
 17424
 17425     perform 7975-read-acct      thru 7975-exit
 17426     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17427     MOVE PI-STATE               TO WS-ST-ACCESS.
 17428     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17429     MOVE '3'                    TO CNTL-REC-TYPE.
 17430     MOVE +0                     TO CNTL-SEQ-NO.
 17431     MOVE 'STAT'                 TO FILE-SWITCH.
 17432
 17433     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17434
 17435     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17436     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17437
 17438     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17439        GO TO 7020-BYPASS-BENEFIT.
 17440
 17441     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17442     MOVE '4'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 334
* EL156.cbl
 17443     MOVE +0                     TO CNTL-SEQ-NO.
 17444     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17445     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17446     MOVE 'BENE'                 TO FILE-SWITCH.
 17447
 17448     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17449
 17450     IF NO-BENEFIT-FOUND
 17451        GO TO 7020-BYPASS-BENEFIT.
 17452
 17453     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17454     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17455     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17456
 17457 7020-BYPASS-BENEFIT.
 17458
 17459*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17460*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17461*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17462
 17463     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17464         GO TO 7021-GO-TO-LIFE.
 17465     move zeros                  to PI-MAX-BENEFIT-AMT
 17466     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17467     move cm-ah-orig-term        to pi-ah-term
 17468     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17469
 17470     IF (PI-COMPANY-ID = 'DCC')
 17471        and (acct-found)
 17472        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17473        PERFORM 0900-GET-DDF-limits
 17474                                 THRU 0900-EXIT
 17475        IF PDEF-FOUND
 17476           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17477              (P1 > +8)
 17478              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17479           END-PERFORM
 17480           IF P1 < +9
 17481              MOVE PD-MAX-AMT (P1)
 17482                                 TO PI-MAX-BENEFIT-AMT
 17483           END-IF
 17484        END-IF
 17485     end-if
 17486     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17487     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17488     if (pi-max-benefit-amt not = zeros)
 17489        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17490        move pi-max-benefit-amt  to beneo
 17491     else
 17492        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17493     end-if
 17494     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17495     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17496                                    CP-ORIGINAL-TERM.
 17497     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17498
 17499*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17500*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 335
* EL156.cbl
 17501*    ELSE
 17502         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17503
 17504     MOVE ' '                    TO DC-OPTION-CODE.
 17505     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17506     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17507
 17508     IF PI-COMPANY-ID = 'DMD'
 17509         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17510         GO TO 7023-BYPASS-REMAINING-TERM.
 17511
 17512     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17513     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17514     GO TO 7022-AROUND-LIFE.
 17515
 17516 7021-GO-TO-LIFE.
 17517
 17518     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17519     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17520     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17521                                    CP-ORIGINAL-TERM.
 17522     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17523     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17524     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17525     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17526
 17527     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17528         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17529     ELSE
 17530         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17531
 17532     MOVE ' '                    TO DC-OPTION-CODE.
 17533     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17534     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17535
 17536 7022-AROUND-LIFE.
 17537
 17538     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17539     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17540     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17541     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17542     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17543     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17544     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17545
 17546     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17547
 17548     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17549        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17550           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17551
 17552     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17553        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17554           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17555
 17556 7023-BYPASS-REMAINING-TERM.
 17557     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17558       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 336
* EL156.cbl
 17559          MOVE ZEROS                  TO BENEO
 17560       ELSE
 17561          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17562          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17563          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17564          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17565          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17566          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17567          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17568          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17569          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17570          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17571          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17572          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17573          IF (PI-COMPANY-ID = 'DCC')
 17574             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17575             PERFORM 0900-GET-DDF-limits
 17576                                 THRU 0900-EXIT
 17577             IF PDEF-FOUND
 17578                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17579                   (P1 > +8)
 17580                   OR (PD-PROD-CODE (P1) = 'L')
 17581                END-PERFORM
 17582                IF P1 < +9
 17583                   MOVE PD-MAX-AMT (P1)
 17584                                 TO CP-R-MAX-TOT-BEN
 17585                END-IF
 17586             END-IF
 17587          END-IF
 17588
 17589* EXEC CICS LINK
 17590*            PROGRAM  (LINK-REMAMT)
 17591*            COMMAREA (CALCULATION-PASS-AREA)
 17592*            LENGTH   (CP-COMM-LENGTH)
 17593*         END-EXEC
 17594*    MOVE '."C                   (   #00016151' TO DFHEIV0
 17595     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17597     MOVE X'2020233030303136313531' TO DFHEIV0(25:11)
 17598     CALL 'kxdfhei1' USING DFHEIV0,
 17599           LINK-REMAMT,
 17600           CALCULATION-PASS-AREA,
 17601           CP-COMM-LENGTH,
 17602           DFHEIV99,
 17603           DFHEIV99,
 17604           DFHEIV99,
 17605           DFHEIV99
 17606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17607          MOVE CP-REMAINING-AMT       TO BENEO
 17608       end-if
 17609     end-if
 17610     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17611     MOVE +95                    TO TRLR-SEQ-NO
 17612
 17613* EXEC CICS READ
 17614*       DATASET  ('ELTRLR')
 17615*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17616*       RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 337
* EL156.cbl
 17617*       RESP     (WS-RESPONSE)
 17618*    END-EXEC
 17619     MOVE 'ELTRLR' TO DFHEIV1
 17620*    MOVE '&"S        E          (  N#00016161' TO DFHEIV0
 17621     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17622     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17623     MOVE X'204E233030303136313631' TO DFHEIV0(25:11)
 17624     CALL 'kxdfhei1' USING DFHEIV0,
 17625           DFHEIV1,
 17626           DFHEIV20,
 17627           DFHEIV99,
 17628           ELTRLR-KEY,
 17629           DFHEIV99,
 17630           DFHEIV99,
 17631           DFHEIV99
 17632     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17633         DFHEIV20
 17634     MOVE EIBRESP  TO WS-RESPONSE
 17635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17636
 17637     if ws-resp-normal
 17638        perform varying s1 from +1 by +1 until
 17639           at-note-error-no (s1) = spaces
 17640           move at-note-error-no (s1)
 17641                                 to emi-error
 17642           if at-note-error-no (s1) = '1653'
 17643              evaluate true
 17644                 when cl-claim-type = 'L'
 17645                    move '  LF  '
 17646                                 to emi-claim-type
 17647                 when cl-claim-type = 'I'
 17648                    move '  IU  '
 17649                                 to emi-claim-type
 17650                 when other
 17651                    move '  AH  '
 17652                                 to emi-claim-type
 17653              end-evaluate
 17654           end-if
 17655           PERFORM 9900-ERROR-FORMAT
 17656                                 THRU 9900-EXIT
 17657        end-perform
 17658     end-if
 17659     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17660         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17661            WS-LF-COVERAGE-TYPE = 'P'
 17662             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17663                                        CM-LF-ITD-DEATH-AMT
 17664             MOVE WS-REMAINING-AMT  TO  BENEO.
 17665
 17666     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17667     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17668     MOVE WS-TERMS               TO TERMSO.
 17669
 17670     IF WS-STATUS = '6' OR '7' OR '8'
 17671         MOVE AL-SABOF           TO CRTSTATA.
 17672
 17673     IF WS-STATUS = '1' OR '4'
 17674        IF CP-REMAINING-TERM-3 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 338
* EL156.cbl
 17675           MOVE 'EXPIRED'        TO CRTSTATO
 17676        ELSE
 17677           MOVE 'ACTIVE  '       TO CRTSTATO.
 17678
 17679     IF WS-STATUS = '2'
 17680         MOVE 'PEND    '         TO CRTSTATO.
 17681
 17682     IF WS-STATUS = '3'
 17683         MOVE 'RESTORE '         TO CRTSTATO.
 17684
 17685     IF WS-STATUS = '5'
 17686         MOVE 'REISSUE '         TO CRTSTATO.
 17687
 17688     IF WS-STATUS = '6'
 17689         MOVE 'LMP DIS'          TO CRTSTATO.
 17690
 17691     IF WS-STATUS = '7'
 17692         MOVE 'DEATH'            TO CRTSTATO.
 17693
 17694     IF WS-STATUS = '8'
 17695         MOVE 'CANCEL'           TO CRTSTATO.
 17696
 17697     IF WS-STATUS = '9'
 17698         MOVE 'RE-ONLY '         TO CRTSTATO.
 17699
 17700     IF WS-STATUS = 'V'
 17701         MOVE 'VOID  '           TO CRTSTATO.
 17702
 17703     IF WS-STATUS = 'D'
 17704         MOVE 'DECLINE '         TO CRTSTATO.
 17705
 17706     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17707         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17708         MOVE '5'                TO CNTL-REC-TYPE
 17709     ELSE
 17710         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17711         MOVE '4'                TO CNTL-REC-TYPE.
 17712
 17713     MOVE '** NONE **'           TO COVERO.
 17714     MOVE AL-SABON               TO COVERA.
 17715
 17716     IF PI-COMPANY-ID = 'CVL'
 17717         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17718             MOVE CM-BENEFICIARY TO LOANNOO
 17719             MOVE AL-UANON       TO LOANNOA.
 17720
 17721     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17722        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17723        MOVE +91                 TO  TRLR-SEQ-NO
 17724
 17725* EXEC CICS READ
 17726*           DATASET  ('ELTRLR')
 17727*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17728*           RIDFLD   (ELTRLR-KEY)
 17729*           RESP     (WS-RESPONSE)
 17730*       END-EXEC
 17731     MOVE 'ELTRLR' TO DFHEIV1
 17732*    MOVE '&"S        E          (  N#00016255' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 339
* EL156.cbl
 17733     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17735     MOVE X'204E233030303136323535' TO DFHEIV0(25:11)
 17736     CALL 'kxdfhei1' USING DFHEIV0,
 17737           DFHEIV1,
 17738           DFHEIV20,
 17739           DFHEIV99,
 17740           ELTRLR-KEY,
 17741           DFHEIV99,
 17742           DFHEIV99,
 17743           DFHEIV99
 17744     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17745         DFHEIV20
 17746     MOVE EIBRESP  TO WS-RESPONSE
 17747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17748
 17749        IF WS-RESP-NORMAL
 17750           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17751        ELSE
 17752           MOVE SPACES           TO  LOANNOO
 17753        END-IF
 17754*052506
 17755*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17756*052506
 17757     END-IF
 17758
 17759     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17760        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17761
 17762     IF WS-BEN-CD = ZEROS
 17763         GO TO 7050-SHOW-CONTINUE.
 17764
 17765     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17766     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17767     MOVE +0                     TO CNTL-SEQ-NO.
 17768     MOVE 'BENE'                 TO FILE-SWITCH.
 17769
 17770     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17771
 17772     IF BENEFIT-FOUND
 17773         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17774         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17775         MOVE AL-SANON                    TO COVERA.
 17776
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 340
* EL156.cbl
 17778 7050-SHOW-CONTINUE.
 17779
 17780     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17781        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17782            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17783     END-IF
 17784
 17785     IF PI-COMPANY-ID = 'DMD'
 17786         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17787
 17788     MOVE -1                     TO PMTTYPEL.
 17789     GO TO 8100-SEND-INITIAL-MAP.
 17790
 17791 7100-SHOW-RECORD-NOT-FOUND.
 17792     IF FILE-SWITCH = 'MSTR'
 17793         MOVE ER-0204            TO EMI-ERROR.
 17794
 17795     IF FILE-SWITCH = 'CERT'
 17796         MOVE ER-0206            TO EMI-ERROR.
 17797
 17798     IF FILE-SWITCH = 'STAT'
 17799         MOVE ER-0149            TO EMI-ERROR.
 17800
 17801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17802
 17803     MOVE -1                     TO PMTTYPEL.
 17804     GO TO 8100-SEND-INITIAL-MAP
 17805
 17806     .
 17807 7110-BUILD-PMT-TRLR.
 17808     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17809     MOVE +51                    TO TRLR-SEQ-NO
 17810
 17811* EXEC CICS READ
 17812*        DATASET  ('ELTRLR')
 17813*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17814*        RIDFLD   (ELTRLR-KEY)
 17815*        RESP     (WS-RESPONSE)
 17816*    END-EXEC
 17817     MOVE 'ELTRLR' TO DFHEIV1
 17818*    MOVE '&"S        E          (  N#00016323' TO DFHEIV0
 17819     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17820     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17821     MOVE X'204E233030303136333233' TO DFHEIV0(25:11)
 17822     CALL 'kxdfhei1' USING DFHEIV0,
 17823           DFHEIV1,
 17824           DFHEIV20,
 17825           DFHEIV99,
 17826           ELTRLR-KEY,
 17827           DFHEIV99,
 17828           DFHEIV99,
 17829           DFHEIV99
 17830     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17831         DFHEIV20
 17832     MOVE EIBRESP  TO WS-RESPONSE
 17833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17834     IF WS-RESP-NORMAL
 17835        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 341
* EL156.cbl
 17836     END-IF
 17837     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17838
 17839* EXEC CICS GETMAIN
 17840*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17841*         LENGTH    (200)
 17842*         INITIMG   (GETMAIN-SPACE)
 17843*     END-EXEC
 17844     MOVE 200
 17845       TO DFHEIV11
 17846*    MOVE ',"IL                  $   #00016333' TO DFHEIV0
 17847     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17848     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17849     MOVE X'2020233030303136333333' TO DFHEIV0(25:11)
 17850     CALL 'kxdfhei1' USING DFHEIV0,
 17851           DFHEIV20,
 17852           DFHEIV11,
 17853           GETMAIN-SPACE
 17854     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17855         DFHEIV20
 17856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17857     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17858                                    AT-PREV-PAID-THRU-DT
 17859     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17860     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17861     MOVE 'AT'                   TO AT-RECORD-ID
 17862     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17863     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17864     MOVE '2'                    TO AT-TRAILER-TYPE
 17865     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17866                                    AT-PAYMENT-LAST-MAINT-DT
 17867     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17868                                    AT-PAYMENT-LAST-UPDATED-BY
 17869     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17870     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17871     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17872     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17873     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17874     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17875     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17876     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17877     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17878     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17879     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17880     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17881     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17882     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17883     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17884     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17885                                    AT-TO-BE-WRITTEN-DT
 17886     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17887                                    AT-CHECK-QUE-SEQUENCE
 17888                                    AT-ADDL-RESERVE
 17889     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17890                                    AT-VOID-SELECT-DT
 17891                                    AT-VOID-ACCEPT-DT
 17892                                    AT-VOID-DT
 17893                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 342
* EL156.cbl
 17894                                    AT-INT-PMT-SELECT-DT
 17895     MOVE ZEROS                  TO AT-DAILY-RATE
 17896                                    AT-ELIMINATION-DAYS
 17897     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17898*    EXEC CICS HANDLE CONDITION
 17899*        DUPREC    (7120-DUPREC)
 17900*    END-EXEC
 17901     .
 17902 7115-WRITE-INT-TRLR.
 17903
 17904* EXEC CICS WRITE
 17905*         DATASET       ('ELTRLR')
 17906*         FROM          (ACTIVITY-TRAILERS)
 17907*         RIDFLD        (AT-CONTROL-PRIMARY)
 17908*         RESP          (WS-RESPONSE)
 17909*     END-EXEC
 17910     MOVE LENGTH OF
 17911      ACTIVITY-TRAILERS
 17912       TO DFHEIV11
 17913     MOVE 'ELTRLR' TO DFHEIV1
 17914*    MOVE '&$ L                  ''  N#00016384' TO DFHEIV0
 17915     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17916     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17917     MOVE X'204E233030303136333834' TO DFHEIV0(25:11)
 17918     CALL 'kxdfhei1' USING DFHEIV0,
 17919           DFHEIV1,
 17920           ACTIVITY-TRAILERS,
 17921           DFHEIV11,
 17922           AT-CONTROL-PRIMARY,
 17923           DFHEIV99,
 17924           DFHEIV99
 17925     MOVE EIBRESP  TO WS-RESPONSE
 17926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17927      IF WS-RESP-DUPREC
 17928         GO TO 7120-DUPREC
 17929      END-IF
 17930     GO TO 7130-EXIT
 17931     .
 17932 7120-DUPREC.
 17933     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17934     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17935     GO TO 7115-WRITE-INT-TRLR
 17936     .
 17937 7130-EXIT.
 17938      EXIT.
 17939 7140-BUILD-NOTE-TRLR.
 17940
 17941
 17942* EXEC CICS GETMAIN
 17943*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17944*         LENGTH    (200)
 17945*         INITIMG   (GETMAIN-SPACE)
 17946*     END-EXEC
 17947     MOVE 200
 17948       TO DFHEIV11
 17949*    MOVE ',"IL                  $   #00016404' TO DFHEIV0
 17950     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17951     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 343
* EL156.cbl
 17952     MOVE X'2020233030303136343034' TO DFHEIV0(25:11)
 17953     CALL 'kxdfhei1' USING DFHEIV0,
 17954           DFHEIV20,
 17955           DFHEIV11,
 17956           GETMAIN-SPACE
 17957     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17958         DFHEIV20
 17959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17960     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17961     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17962     MOVE 'AT'                   TO AT-RECORD-ID
 17963     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17964     MOVE '6'                    TO AT-TRAILER-TYPE
 17965     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17966                                    AT-GEN-INFO-LAST-MAINT-DT
 17967     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17968                                    AT-GEN-INFO-LAST-UPDATED-BY
 17969     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17970     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17971     .
 17972 7150-WRITE.
 17973
 17974* EXEC CICS HANDLE CONDITION
 17975*        DUPREC    (7160-DUPREC)
 17976*    END-EXEC
 17977*    MOVE '"$%                   ! : #00016422' TO DFHEIV0
 17978     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17980     MOVE X'3A20233030303136343232' TO DFHEIV0(25:11)
 17981     CALL 'kxdfhei1' USING DFHEIV0
 17982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17983
 17984* EXEC CICS WRITE
 17985*         DATASET     ('ELTRLR')
 17986*         FROM        (ACTIVITY-TRAILERS)
 17987*         RIDFLD      (AT-CONTROL-PRIMARY)
 17988*         RESP        (WS-RESPONSE)
 17989*     END-EXEC
 17990     MOVE LENGTH OF
 17991      ACTIVITY-TRAILERS
 17992       TO DFHEIV11
 17993     MOVE 'ELTRLR' TO DFHEIV1
 17994*    MOVE '&$ L                  ''  N#00016425' TO DFHEIV0
 17995     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17997     MOVE X'204E233030303136343235' TO DFHEIV0(25:11)
 17998     CALL 'kxdfhei1' USING DFHEIV0,
 17999           DFHEIV1,
 18000           ACTIVITY-TRAILERS,
 18001           DFHEIV11,
 18002           AT-CONTROL-PRIMARY,
 18003           DFHEIV99,
 18004           DFHEIV99
 18005     MOVE EIBRESP  TO WS-RESPONSE
 18006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18007      IF WS-RESP-DUPREC
 18008         GO TO 7160-DUPREC
 18009      END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 344
* EL156.cbl
 18010     GO TO 7170-EXIT
 18011     .
 18012 7160-DUPREC.
 18013     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18014     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18015     GO TO 7150-WRITE
 18016     .
 18017 7170-EXIT.
 18018      EXIT.
 18019
 18020 7180-ADD-CERT-NOTE.
 18021*ADD CERT NOTE FOR SC NP+6
 18022
 18023
 18024* EXEC CICS GETMAIN
 18025*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18026*         LENGTH    (150)
 18027*         INITIMG   (GETMAIN-SPACE)
 18028*     END-EXEC.
 18029     MOVE 150
 18030       TO DFHEIV11
 18031*    MOVE ',"IL                  $   #00016447' TO DFHEIV0
 18032     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18033     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18034     MOVE X'2020233030303136343437' TO DFHEIV0(25:11)
 18035     CALL 'kxdfhei1' USING DFHEIV0,
 18036           DFHEIV20,
 18037           DFHEIV11,
 18038           GETMAIN-SPACE
 18039     SET ADDRESS OF CERT-NOTE-FILE TO
 18040         DFHEIV20
 18041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18042
 18043
 18044     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18045     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18046     MOVE +1                     TO WRK-NOTE-SEQ.
 18047     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18048     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18049     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18050     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18051     MOVE CL-CERT-STATE          TO CZ-STATE.
 18052     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18053     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18054     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18055     MOVE '2'                    TO CZ-RECORD-TYPE.
 18056     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18057     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18058     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18059     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18060     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18061     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18062     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18063     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18064     IF PI-COMPANY-ID = 'AHL'
 18065        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18066           CONTINUE
 18067        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 345
* EL156.cbl
 18068           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18069              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18070           ELSE
 18071              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18072           END-IF
 18073        END-IF
 18074     END-IF
 18075     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18076     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18077
 18078 7181-WRITE.
 18079
 18080
 18081* EXEC CICS WRITE
 18082*         DATASET     ('ERCNOT')
 18083*         FROM        (CERT-NOTE-FILE)
 18084*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18085*         RESP        (WS-RESPONSE)
 18086*    END-EXEC.
 18087     MOVE LENGTH OF
 18088      CERT-NOTE-FILE
 18089       TO DFHEIV11
 18090     MOVE 'ERCNOT' TO DFHEIV1
 18091*    MOVE '&$ L                  ''  N#00016489' TO DFHEIV0
 18092     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18093     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18094     MOVE X'204E233030303136343839' TO DFHEIV0(25:11)
 18095     CALL 'kxdfhei1' USING DFHEIV0,
 18096           DFHEIV1,
 18097           CERT-NOTE-FILE,
 18098           DFHEIV11,
 18099           CZ-CONTROL-PRIMARY,
 18100           DFHEIV99,
 18101           DFHEIV99
 18102     MOVE EIBRESP  TO WS-RESPONSE
 18103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18104
 18105
 18106     IF WS-RESP-DUPREC
 18107         GO TO 7182-DUPREC
 18108     END-IF.
 18109
 18110     SET CERT-NOTE-ADDED TO TRUE.
 18111
 18112     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18113         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18114     END-IF.
 18115
 18116     GO TO 7189-EXIT.
 18117
 18118 7182-DUPREC.
 18119
 18120     ADD +1                      TO  WRK-NOTE-SEQ.
 18121     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18122     GO TO 7181-WRITE.
 18123
 18124 7189-EXIT.
 18125      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 346
* EL156.cbl
 18126
 18127 7190-ADD-ORIG-NOTE.
 18128
 18129
 18130* EXEC CICS GETMAIN
 18131*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18132*         LENGTH    (150)
 18133*         INITIMG   (GETMAIN-SPACE)
 18134*     END-EXEC.
 18135     MOVE 150
 18136       TO DFHEIV11
 18137*    MOVE ',"IL                  $   #00016519' TO DFHEIV0
 18138     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18139     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18140     MOVE X'2020233030303136353139' TO DFHEIV0(25:11)
 18141     CALL 'kxdfhei1' USING DFHEIV0,
 18142           DFHEIV20,
 18143           DFHEIV11,
 18144           GETMAIN-SPACE
 18145     SET ADDRESS OF CERT-NOTE-FILE TO
 18146         DFHEIV20
 18147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18148
 18149
 18150     ADD +1                      TO WRK-NOTE-SEQ.
 18151     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18152     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18153     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18154     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18155     MOVE CL-CERT-STATE          TO CZ-STATE.
 18156     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18157     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18158     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18159     MOVE '2'                    TO CZ-RECORD-TYPE.
 18160     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18161     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18162     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18163     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18164     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18165     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18166
 18167 7191-WRITE.
 18168
 18169
 18170* EXEC CICS WRITE
 18171*         DATASET     ('ERCNOT')
 18172*         FROM        (CERT-NOTE-FILE)
 18173*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18174*         RESP        (WS-RESPONSE)
 18175*    END-EXEC.
 18176     MOVE LENGTH OF
 18177      CERT-NOTE-FILE
 18178       TO DFHEIV11
 18179     MOVE 'ERCNOT' TO DFHEIV1
 18180*    MOVE '&$ L                  ''  N#00016544' TO DFHEIV0
 18181     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18182     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18183     MOVE X'204E233030303136353434' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 347
* EL156.cbl
 18184     CALL 'kxdfhei1' USING DFHEIV0,
 18185           DFHEIV1,
 18186           CERT-NOTE-FILE,
 18187           DFHEIV11,
 18188           CZ-CONTROL-PRIMARY,
 18189           DFHEIV99,
 18190           DFHEIV99
 18191     MOVE EIBRESP  TO WS-RESPONSE
 18192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18193
 18194
 18195     IF WS-RESP-DUPREC
 18196         GO TO 7192-DUPREC
 18197     END-IF.
 18198
 18199     GO TO 7199-EXIT.
 18200
 18201 7192-DUPREC.
 18202
 18203     ADD +1                      TO  WRK-NOTE-SEQ.
 18204     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18205     GO TO 7191-WRITE.
 18206
 18207 7199-EXIT.
 18208      EXIT.
 18209 7200-FIND-BENEFIT.
 18210     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18211
 18212
 18213* EXEC CICS HANDLE CONDITION
 18214*        ENDFILE(7200-EXIT)
 18215*        NOTFND(7200-EXIT)
 18216*    END-EXEC.
 18217*    MOVE '"$''I                  ! ; #00016568' TO DFHEIV0
 18218     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18220     MOVE X'3B20233030303136353638' TO DFHEIV0(25:11)
 18221     CALL 'kxdfhei1' USING DFHEIV0
 18222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18223
 18224
 18225
 18226* EXEC CICS READ
 18227*        DATASET('ELCNTL')
 18228*        SET(ADDRESS OF CONTROL-FILE)
 18229*        RIDFLD(ELCNTL-KEY)
 18230*        GTEQ
 18231*    END-EXEC.
 18232     MOVE 'ELCNTL' TO DFHEIV1
 18233*    MOVE '&"S        G          (   #00016573' TO DFHEIV0
 18234     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18235     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18236     MOVE X'2020233030303136353733' TO DFHEIV0(25:11)
 18237     CALL 'kxdfhei1' USING DFHEIV0,
 18238           DFHEIV1,
 18239           DFHEIV20,
 18240           DFHEIV99,
 18241           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 348
* EL156.cbl
 18242           DFHEIV99,
 18243           DFHEIV99,
 18244           DFHEIV99
 18245     SET ADDRESS OF CONTROL-FILE TO
 18246         DFHEIV20
 18247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18248
 18249
 18250     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18251        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18252           GO TO 7200-EXIT.
 18253
 18254     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18255         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18256            ((SUB-1 > 8) OR
 18257            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18258
 18259     IF SUB-1 NOT = 9
 18260         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18261
 18262     GO TO 7200-EXIT.
 18263
 18264 7200-BENEFIT-DUMMY.
 18265
 18266 7200-DUMMY-EXIT.
 18267     EXIT.
 18268
 18269 7200-EXIT.
 18270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 349
* EL156.cbl
 18272*052506
 18273*052506 7250-FIND-LETTER-TRLR.
 18274*052506     EXEC CICS HANDLE CONDITION
 18275*052506         ENDFILE  (7250-END)
 18276*052506         NOTFND   (7250-END)
 18277*052506     END-EXEC.
 18278*052506
 18279*052506     EXEC CICS STARTBR
 18280*052506         DATASET   ('ELTRLR')
 18281*052506         RIDFLD    (ELTRLR-KEY)
 18282*052506         GTEQ
 18283*052506     END-EXEC.
 18284*052506
 18285*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18286*052506
 18287*052506 7250-FIND-LOOP.
 18288*052506     EXEC CICS READNEXT
 18289*052506         DATASET   ('ELTRLR')
 18290*052506         RIDFLD    (ELTRLR-KEY)
 18291*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18292*052506     END-EXEC.
 18293*052506
 18294*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18295*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18296*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18297*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18298*052506        GO TO 7250-END
 18299*052506     END-IF.
 18300*052506
 18301*052506     IF AT-TRAILER-TYPE NOT = '4'
 18302*052506         GO TO 7250-FIND-LOOP
 18303*052506     END-IF.
 18304*052506
 18305*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18306*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18307*052506     END-IF.
 18308*052506
 18309*052506     GO TO 7250-FIND-LOOP.
 18310*052506
 18311*052506 7250-END.
 18312*052506
 18313*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18314*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18315*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18316*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18317*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18318*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18319*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18320*052506     END-IF.
 18321*052506
 18322*052506     EXEC CICS ENDBR
 18323*052506          DATASET    ('ELTRLR')
 18324*052506     END-EXEC.
 18325*052506
 18326*052506 7250-EXIT.
 18327*052506     EXIT.
 18328*052506     EJECT
 18329*052506
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 350
* EL156.cbl
 18330 7300-CHECK-AUTO-ACTIVITY.
 18331
 18332     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18333         NEXT SENTENCE
 18334     ELSE
 18335         GO TO 7399-EXIT.
 18336
 18337     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18338
 18339     IF WS-ACT-REC-FOUND-SW = 'N'
 18340         GO TO 7399-EXIT.
 18341
 18342     IF PI-ACTIVITY-CODE = 09
 18343         GO TO 7300-CONT-AUTO-ACTIVITY.
 18344
 18345     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18346        (PI-ACTIVITY-CODE = 11)
 18347         GO TO 7300-CONT-AUTO-ACTIVITY.
 18348
 18349     IF PI-PROVISIONAL-IND = 'P'
 18350         IF PI-PMTTYPE = '1'
 18351             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18352                 MOVE 'N'    TO  PI-RESET-SW
 18353                 GO TO 7399-EXIT.
 18354
 18355     IF PI-PMTTYPE = '1'
 18356         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18357             MOVE 'N'        TO  PI-RESET-SW
 18358             GO TO 7399-EXIT.
 18359
 18360     IF PI-PMTTYPE = '2' OR '3'
 18361         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18362             MOVE 'N'        TO  PI-RESET-SW
 18363             GO TO 7399-EXIT.
 18364
 18365     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18366         IF PI-PROVISIONAL-IND = 'P'
 18367             NEXT SENTENCE
 18368         ELSE
 18369             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18370
 18371 7300-CONT-AUTO-ACTIVITY.
 18372
 18373     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18374         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18375         MOVE '4'            TO DC-OPTION-CODE
 18376         MOVE +0             TO DC-ELAPSED-DAYS
 18377                                DC-ELAPSED-MONTHS
 18378         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18379         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18380         IF PI-USES-PAID-TO
 18381             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18382             IF NO-CONVERSION-ERROR
 18383                 MOVE +1     TO DC-ELAPSED-DAYS
 18384                 MOVE +0     TO DC-ELAPSED-MONTHS
 18385                 MOVE '6'    TO DC-OPTION-CODE
 18386                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18387                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 351
* EL156.cbl
 18388                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18389
 18390     IF PI-PFKEY-USED = DFHPF5
 18391         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18392         IF PI-USES-PAID-TO
 18393             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18394             MOVE +1                  TO DC-ELAPSED-DAYS
 18395             MOVE +0                  TO DC-ELAPSED-MONTHS
 18396             MOVE '6'                 TO DC-OPTION-CODE
 18397             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18398             IF NO-CONVERSION-ERROR
 18399                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18400
 18401     IF WS-CHK-THRU-DT < PI-EXP-DT
 18402         NEXT SENTENCE
 18403     ELSE
 18404         MOVE 03                     TO  WS-ACTIVITY-CODE
 18405         GO TO 7390-PROCESS-ACTIVITY.
 18406
 18407     IF PI-PROV-PMT
 18408         MOVE 09                     TO  WS-ACTIVITY-CODE
 18409     ELSE
 18410        IF PI-PMTTYPE = '1'
 18411            MOVE 02                  TO  WS-ACTIVITY-CODE
 18412        ELSE
 18413        IF PI-PMTTYPE = '2' OR '3'
 18414            MOVE 07                  TO  WS-ACTIVITY-CODE
 18415        ELSE
 18416        IF PI-PMTTYPE = '4'
 18417            MOVE 00                  TO  WS-ACTIVITY-CODE
 18418        ELSE
 18419            MOVE 'N'                 TO  PI-RESET-SW
 18420            GO TO 7399-EXIT.
 18421
 18422 7390-PROCESS-ACTIVITY.
 18423
 18424     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18425
 18426 7399-EXIT.
 18427     EXIT.
 18428
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 352
* EL156.cbl
 18430 7400-CHECK-AUTO-ACTIVITY.
 18431
 18432
 18433* EXEC CICS HANDLE CONDITION
 18434*        NOTFND   (7400-NOT-FOUND)
 18435*    END-EXEC.
 18436*    MOVE '"$I                   ! < #00016762' TO DFHEIV0
 18437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18439     MOVE X'3C20233030303136373632' TO DFHEIV0(25:11)
 18440     CALL 'kxdfhei1' USING DFHEIV0
 18441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18442
 18443
 18444     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18445     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18446     MOVE SPACES                 TO  CNTL-ACCESS.
 18447     MOVE +0                     TO  CNTL-SEQ-NO.
 18448
 18449
 18450* EXEC CICS READ
 18451*        DATASET   ('ELCNTL')
 18452*        RIDFLD    (ELCNTL-KEY)
 18453*        SET       (ADDRESS OF CONTROL-FILE)
 18454*    END-EXEC.
 18455     MOVE 'ELCNTL' TO DFHEIV1
 18456*    MOVE '&"S        E          (   #00016771' TO DFHEIV0
 18457     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18459     MOVE X'2020233030303136373731' TO DFHEIV0(25:11)
 18460     CALL 'kxdfhei1' USING DFHEIV0,
 18461           DFHEIV1,
 18462           DFHEIV20,
 18463           DFHEIV99,
 18464           ELCNTL-KEY,
 18465           DFHEIV99,
 18466           DFHEIV99,
 18467           DFHEIV99
 18468     SET ADDRESS OF CONTROL-FILE TO
 18469         DFHEIV20
 18470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18471
 18472
 18473     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18474     GO TO 7400-EXIT.
 18475
 18476 7400-NOT-FOUND.
 18477     MOVE 'N'                        TO  PI-RESET-SW
 18478                                         WS-LETTER-SW
 18479                                         WS-ACT-REC-FOUND-SW.
 18480
 18481     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18482
 18483 7400-EXIT.
 18484     EXIT.
 18485
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 353
* EL156.cbl
 18487 7450-FORMAT-AUTO-LETTER.
 18488
 18489     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18490         MOVE 'Y'                    TO PI-RESET-SW
 18491         GO TO 7450-CONTINUE-PROCESS.
 18492
 18493     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18494
 18495     IF SUB > 9
 18496         SUBTRACT 9 FROM SUB
 18497         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18498     ELSE
 18499         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18500
 18501 7450-CONTINUE-PROCESS.
 18502
 18503     IF WS-ACTIVITY-CODE = ZEROS
 18504         MOVE 'N'                    TO  WS-LETTER-SW
 18505         GO TO 7450-EXIT.
 18506
 18507     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18508
 18509     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18510         MOVE 'N'                    TO  PI-RESET-SW
 18511                                         WS-LETTER-SW
 18512         GO TO 7450-EXIT.
 18513
 18514     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18515         MOVE 'N'                    TO  WS-LETTER-SW
 18516         GO TO 7450-EXIT.
 18517
 18518     MOVE 'Y'                        TO  WS-LETTER-SW.
 18519     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18520     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18521
 18522     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18523
 18524     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18525         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18526         MOVE '6'                    TO  DC-OPTION-CODE
 18527         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18528         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18529         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18530         IF NO-CONVERSION-ERROR
 18531             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18532         ELSE
 18533              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18534
 18535     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18536         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18537         MOVE '6'                    TO  DC-OPTION-CODE
 18538         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18539         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18540         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18541         IF NO-CONVERSION-ERROR
 18542             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18543         ELSE
 18544             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 354
* EL156.cbl
 18545
 18546 7450-EXIT.
 18547     EXIT.
 18548
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 355
* EL156.cbl
 18550 7500-RESET-AUTO-ACTIVITY.
 18551
 18552     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18553     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18554     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18555     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18556     MOVE +100                   TO  TRLR-SEQ-NO.
 18557
 18558 7500-STARTBR-TRLR.
 18559
 18560
 18561* EXEC CICS HANDLE CONDITION
 18562*        ENDFILE  (7590-END)
 18563*        NOTFND   (7590-END)
 18564*    END-EXEC.
 18565*    MOVE '"$''I                  ! = #00016864' TO DFHEIV0
 18566     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18568     MOVE X'3D20233030303136383634' TO DFHEIV0(25:11)
 18569     CALL 'kxdfhei1' USING DFHEIV0
 18570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18571
 18572
 18573
 18574* EXEC CICS STARTBR
 18575*        DATASET   ('ELTRLR')
 18576*        RIDFLD    (ELTRLR-KEY)
 18577*        GTEQ
 18578*    END-EXEC.
 18579     MOVE 'ELTRLR' TO DFHEIV1
 18580     MOVE 0
 18581       TO DFHEIV11
 18582*    MOVE '&,         G          &   #00016869' TO DFHEIV0
 18583     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18584     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18585     MOVE X'2020233030303136383639' TO DFHEIV0(25:11)
 18586     CALL 'kxdfhei1' USING DFHEIV0,
 18587           DFHEIV1,
 18588           ELTRLR-KEY,
 18589           DFHEIV99,
 18590           DFHEIV11,
 18591           DFHEIV99
 18592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18593
 18594
 18595     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18596
 18597 7500-READ-NEXT.
 18598
 18599
 18600* EXEC CICS READNEXT
 18601*        DATASET   ('ELTRLR')
 18602*        RIDFLD    (ELTRLR-KEY)
 18603*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18604*    END-EXEC.
 18605     MOVE 'ELTRLR' TO DFHEIV1
 18606     MOVE 0
 18607       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 356
* EL156.cbl
 18608*    MOVE '&.S                   )   #00016879' TO DFHEIV0
 18609     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18610     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18611     MOVE X'2020233030303136383739' TO DFHEIV0(25:11)
 18612     CALL 'kxdfhei1' USING DFHEIV0,
 18613           DFHEIV1,
 18614           DFHEIV20,
 18615           DFHEIV99,
 18616           ELTRLR-KEY,
 18617           DFHEIV99,
 18618           DFHEIV11,
 18619           DFHEIV99,
 18620           DFHEIV99
 18621     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18622         DFHEIV20
 18623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18624
 18625
 18626     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18627        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18628        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18629        PI-CERT-NO    NOT = TRLR-CERT-NO
 18630         GO TO 7590-END.
 18631
 18632     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18633         GO TO 7500-READ-NEXT.
 18634
 18635     IF AT-TRAILER-TYPE NOT = '4'
 18636         GO TO 7500-READ-NEXT.
 18637
 18638     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18639         GO TO 7500-READ-NEXT.
 18640
 18641     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18642        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18643         GO TO 7500-READ-NEXT.
 18644
 18645     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18646        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18647        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18648         GO TO 7500-READ-NEXT.
 18649
 18650     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18651                         AND
 18652        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18653                         AND
 18654        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18655            GO TO 7500-READ-NEXT.
 18656
 18657     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18658
 18659
 18660* EXEC CICS ENDBR
 18661*        DATASET   ('ELTRLR')
 18662*    END-EXEC.
 18663     MOVE 'ELTRLR' TO DFHEIV1
 18664     MOVE 0
 18665       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 357
* EL156.cbl
 18666*    MOVE '&2                    $   #00016918' TO DFHEIV0
 18667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18669     MOVE X'2020233030303136393138' TO DFHEIV0(25:11)
 18670     CALL 'kxdfhei1' USING DFHEIV0,
 18671           DFHEIV1,
 18672           DFHEIV11,
 18673           DFHEIV99
 18674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18675
 18676
 18677     MOVE 'N'                        TO  WS-BROWSE-SW.
 18678
 18679
 18680* EXEC CICS READ
 18681*        DATASET   ('ELTRLR')
 18682*        RIDFLD    (ELTRLR-KEY)
 18683*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18684*        UPDATE
 18685*    END-EXEC.
 18686     MOVE 'ELTRLR' TO DFHEIV1
 18687*    MOVE '&"S        EU         (   #00016924' TO DFHEIV0
 18688     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18689     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18690     MOVE X'2020233030303136393234' TO DFHEIV0(25:11)
 18691     CALL 'kxdfhei1' USING DFHEIV0,
 18692           DFHEIV1,
 18693           DFHEIV20,
 18694           DFHEIV99,
 18695           ELTRLR-KEY,
 18696           DFHEIV99,
 18697           DFHEIV99,
 18698           DFHEIV99
 18699     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18700         DFHEIV20
 18701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18702
 18703
 18704     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18705
 18706     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18707         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18708     ELSE
 18709         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18710             NEXT SENTENCE
 18711         ELSE
 18712             GO TO 7500-REWRITE-TRLR.
 18713
 18714     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18715
 18716     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18717     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18718     MOVE '1'                        TO  ARCH-REC-TYPE.
 18719     MOVE +0                         TO  ARCH-SEQ.
 18720
 18721     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18722
 18723 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 358
* EL156.cbl
 18724
 18725
 18726* EXEC CICS REWRITE
 18727*        DATASET   ('ELTRLR')
 18728*        FROM      (ACTIVITY-TRAILERS)
 18729*    END-EXEC.
 18730     MOVE LENGTH OF
 18731      ACTIVITY-TRAILERS
 18732       TO DFHEIV11
 18733     MOVE 'ELTRLR' TO DFHEIV1
 18734*    MOVE '&& L                  %   #00016952' TO DFHEIV0
 18735     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18736     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18737     MOVE X'2020233030303136393532' TO DFHEIV0(25:11)
 18738     CALL 'kxdfhei1' USING DFHEIV0,
 18739           DFHEIV1,
 18740           ACTIVITY-TRAILERS,
 18741           DFHEIV11,
 18742           DFHEIV99
 18743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18744
 18745
 18746     GO TO 7500-STARTBR-TRLR.
 18747
 18748 7590-END.
 18749
 18750     IF WS-BROWSE-SW = 'Y'
 18751         MOVE 'N'                    TO  WS-BROWSE-SW
 18752
 18753* EXEC CICS ENDBR
 18754*            DATASET   ('ELTRLR')
 18755*        END-EXEC.
 18756     MOVE 'ELTRLR' TO DFHEIV1
 18757     MOVE 0
 18758       TO DFHEIV11
 18759*    MOVE '&2                    $   #00016963' TO DFHEIV0
 18760     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18761     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18762     MOVE X'2020233030303136393633' TO DFHEIV0(25:11)
 18763     CALL 'kxdfhei1' USING DFHEIV0,
 18764           DFHEIV1,
 18765           DFHEIV11,
 18766           DFHEIV99
 18767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18768
 18769
 18770 7599-EXIT.
 18771     EXIT.
 18772
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 359
* EL156.cbl
 18774 7600-READ-ARCH-UPDATE.
 18775
 18776
 18777* EXEC CICS HANDLE CONDITION
 18778*        NOTFND   (7699-EXIT)
 18779*    END-EXEC.
 18780*    MOVE '"$I                   ! > #00016973' TO DFHEIV0
 18781     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18783     MOVE X'3E20233030303136393733' TO DFHEIV0(25:11)
 18784     CALL 'kxdfhei1' USING DFHEIV0
 18785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18786
 18787
 18788
 18789* EXEC CICS READ
 18790*        DATASET   ('ELARCH')
 18791*        RIDFLD    (ELARCH-KEY)
 18792*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18793*        UPDATE
 18794*    END-EXEC.
 18795     MOVE 'ELARCH' TO DFHEIV1
 18796*    MOVE '&"S        EU         (   #00016977' TO DFHEIV0
 18797     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18798     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18799     MOVE X'2020233030303136393737' TO DFHEIV0(25:11)
 18800     CALL 'kxdfhei1' USING DFHEIV0,
 18801           DFHEIV1,
 18802           DFHEIV20,
 18803           DFHEIV99,
 18804           ELARCH-KEY,
 18805           DFHEIV99,
 18806           DFHEIV99,
 18807           DFHEIV99
 18808     SET ADDRESS OF LETTER-ARCHIVE TO
 18809         DFHEIV20
 18810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18811
 18812
 18813     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18814
 18815
 18816* EXEC CICS REWRITE
 18817*        DATASET   ('ELARCH')
 18818*        FROM      (LETTER-ARCHIVE)
 18819*    END-EXEC.
 18820     MOVE LENGTH OF
 18821      LETTER-ARCHIVE
 18822       TO DFHEIV11
 18823     MOVE 'ELARCH' TO DFHEIV1
 18824*    MOVE '&& L                  %   #00016986' TO DFHEIV0
 18825     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18826     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18827     MOVE X'2020233030303136393836' TO DFHEIV0(25:11)
 18828     CALL 'kxdfhei1' USING DFHEIV0,
 18829           DFHEIV1,
 18830           LETTER-ARCHIVE,
 18831           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 360
* EL156.cbl
 18832           DFHEIV99
 18833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18834
 18835
 18836 7699-EXIT.
 18837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 361
* EL156.cbl
 18839 7700-GET-DCT.
 18840
 18841     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18842     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18843     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18844     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18845                                    PI-MAX-BENEFIT-AMT
 18846                                    PI-MAX-BENEFIT-PYMT
 18847                                    PI-MIN-PAYMENT-AMT
 18848                                    PI-TIME-OF-LOSS-BAL.
 18849
 18850
 18851* EXEC CICS HANDLE CONDITION
 18852*         NOTFND (5300-NOTE-NOT-FOUND)
 18853*     END-EXEC.
 18854*    MOVE '"$I                   ! ? #00017005' TO DFHEIV0
 18855     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18857     MOVE X'3F20233030303137303035' TO DFHEIV0(25:11)
 18858     CALL 'kxdfhei1' USING DFHEIV0
 18859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18860
 18861
 18862
 18863* EXEC CICS READ
 18864*         DATASET('ERNOTE')
 18865*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18866*         RIDFLD (W-NOTE-KEY)
 18867*     END-EXEC.
 18868     MOVE 'ERNOTE' TO DFHEIV1
 18869*    MOVE '&"S        E          (   #00017009' TO DFHEIV0
 18870     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18871     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18872     MOVE X'2020233030303137303039' TO DFHEIV0(25:11)
 18873     CALL 'kxdfhei1' USING DFHEIV0,
 18874           DFHEIV1,
 18875           DFHEIV20,
 18876           DFHEIV99,
 18877           W-NOTE-KEY,
 18878           DFHEIV99,
 18879           DFHEIV99,
 18880           DFHEIV99
 18881     SET ADDRESS OF CERTIFICATE-NOTE TO
 18882         DFHEIV20
 18883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18884
 18885
 18886     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18887     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18888     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18889     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18890     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18891
 18892     IF PI-PAYEE-TYPE NOT = 'B'
 18893         GO TO 7700-EXIT.
 18894
 18895     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18896     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 362
* EL156.cbl
 18897     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18898
 18899     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18900         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18901     ELSE
 18902         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18903
 18904     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18905     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18906     MOVE 'DLO006'               TO PGM-NAME.
 18907
 18908
 18909* EXEC CICS LINK
 18910*        PROGRAM    (PGM-NAME)
 18911*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18912*        LENGTH     (DCT-RCRD-LENGTH)
 18913*    END-EXEC.
 18914*    MOVE '."C                   (   #00017037' TO DFHEIV0
 18915     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18917     MOVE X'2020233030303137303337' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0,
 18919           PGM-NAME,
 18920           DCT-COMMUNICATION-AREA,
 18921           DCT-RCRD-LENGTH,
 18922           DFHEIV99,
 18923           DFHEIV99,
 18924           DFHEIV99,
 18925           DFHEIV99
 18926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18927
 18928
 18929     IF DCT-RETURN-CODE = 'OK'
 18930         GO TO 7700-CONT.
 18931
 18932     IF DCT-RETURN-CODE = '01' OR '02'
 18933         GO TO 7700-SET-TO-YES.
 18934
 18935     IF DCT-RETURN-CODE = '03'
 18936
 18937* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18938*    MOVE '6"R                   !   #00017050' TO DFHEIV0
 18939     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18941     MOVE X'2020233030303137303530' TO DFHEIV0(25:11)
 18942     CALL 'kxdfhei1' USING DFHEIV0
 18943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18944         MOVE ER-0951            TO EMI-ERROR
 18945         MOVE -1                 TO PMTTYPEL
 18946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18947         GO TO 8200-SEND-DATAONLY.
 18948
 18949     IF DCT-RETURN-CODE = '04'
 18950
 18951* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18952*    MOVE '6"R                   !   #00017057' TO DFHEIV0
 18953     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18954     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 363
* EL156.cbl
 18955     MOVE X'2020233030303137303537' TO DFHEIV0(25:11)
 18956     CALL 'kxdfhei1' USING DFHEIV0
 18957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18958         MOVE ER-0946            TO EMI-ERROR
 18959         MOVE -1                 TO PMTTYPEL
 18960         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18961         GO TO 8200-SEND-DATAONLY.
 18962
 18963     IF DCT-RETURN-CODE = '05'
 18964
 18965* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18966*    MOVE '6"R                   !   #00017064' TO DFHEIV0
 18967     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18969     MOVE X'2020233030303137303634' TO DFHEIV0(25:11)
 18970     CALL 'kxdfhei1' USING DFHEIV0
 18971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18972         MOVE ER-0947            TO EMI-ERROR
 18973         MOVE -1                 TO PMTTYPEL
 18974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18975         GO TO 8200-SEND-DATAONLY.
 18976
 18977     IF DCT-RETURN-CODE = '06'
 18978
 18979* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18980*    MOVE '6"R                   !   #00017071' TO DFHEIV0
 18981     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18983     MOVE X'2020233030303137303731' TO DFHEIV0(25:11)
 18984     CALL 'kxdfhei1' USING DFHEIV0
 18985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18986         MOVE ER-0921            TO EMI-ERROR
 18987         MOVE -1                 TO PMTTYPEL
 18988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18989         GO TO 8200-SEND-DATAONLY.
 18990
 18991     IF DCT-RETURN-CODE = '07'
 18992
 18993* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18994*    MOVE '6"R                   !   #00017078' TO DFHEIV0
 18995     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18996     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18997     MOVE X'2020233030303137303738' TO DFHEIV0(25:11)
 18998     CALL 'kxdfhei1' USING DFHEIV0
 18999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19000         MOVE ER-0919            TO EMI-ERROR
 19001         MOVE -1                 TO PMTTYPEL
 19002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19003         GO TO 8200-SEND-DATAONLY.
 19004
 19005     IF DCT-RETURN-CODE = '08'
 19006
 19007* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19008*    MOVE '6"R                   !   #00017085' TO DFHEIV0
 19009     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19011     MOVE X'2020233030303137303835' TO DFHEIV0(25:11)
 19012     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 364
* EL156.cbl
 19013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19014         MOVE ER-0948            TO EMI-ERROR
 19015         MOVE -1                 TO PMTTYPEL
 19016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19017         GO TO 8200-SEND-DATAONLY.
 19018
 19019     IF DCT-RETURN-CODE = 'N1'
 19020
 19021* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19022*    MOVE '6"R                   !   #00017092' TO DFHEIV0
 19023     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19025     MOVE X'2020233030303137303932' TO DFHEIV0(25:11)
 19026     CALL 'kxdfhei1' USING DFHEIV0
 19027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19028         MOVE ER-0950            TO EMI-ERROR
 19029         MOVE -1                 TO PMTTYPEL
 19030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19031         GO TO 8200-SEND-DATAONLY.
 19032
 19033     IF DCT-RETURN-CODE = 'E1'
 19034
 19035* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19036*    MOVE '6"R                   !   #00017099' TO DFHEIV0
 19037     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19039     MOVE X'2020233030303137303939' TO DFHEIV0(25:11)
 19040     CALL 'kxdfhei1' USING DFHEIV0
 19041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19042         MOVE ER-0974            TO EMI-ERROR
 19043         MOVE -1                 TO PMTTYPEL
 19044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19045         GO TO 8200-SEND-DATAONLY.
 19046
 19047     IF DCT-RETURN-CODE = 'E2'
 19048
 19049* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19050*    MOVE '6"R                   !   #00017106' TO DFHEIV0
 19051     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19053     MOVE X'2020233030303137313036' TO DFHEIV0(25:11)
 19054     CALL 'kxdfhei1' USING DFHEIV0
 19055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19056         MOVE ER-0975            TO EMI-ERROR
 19057         MOVE -1                 TO PMTTYPEL
 19058         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19059         GO TO 8200-SEND-DATAONLY.
 19060
 19061     IF DCT-RETURN-CODE NOT = 'OK'
 19062
 19063* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19064*    MOVE '6"R                   !   #00017113' TO DFHEIV0
 19065     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19067     MOVE X'2020233030303137313133' TO DFHEIV0(25:11)
 19068     CALL 'kxdfhei1' USING DFHEIV0
 19069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19070         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 365
* EL156.cbl
 19071         MOVE -1                 TO PMTTYPEL
 19072         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19073         GO TO 8200-SEND-DATAONLY.
 19074
 19075 7700-CONT.
 19076
 19077*    MOVE 'N'                    TO CASHO.
 19078*    MOVE +1                     TO CASHL.
 19079*    MOVE AL-UANON               TO CASHA.
 19080
 19081     IF PI-OFFLINE = 'Y'
 19082         GO TO 7700-EXIT.
 19083
 19084     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19085     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19086     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19087     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19088     MOVE +7                     TO CHECKNOL.
 19089     MOVE AL-UANON               TO CHECKNOA.
 19090     GO TO 7700-EXIT.
 19091
 19092 7700-SET-TO-YES.
 19093
 19094*    MOVE 'Y'                    TO CASHO.
 19095*    MOVE +1                     TO CASHL.
 19096*    MOVE AL-UANON               TO CASHA.
 19097
 19098 7700-EXIT.
 19099     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 366
* EL156.cbl
 19101 7800-READ-COMP-MSTR.
 19102
 19103
 19104* EXEC CICS HANDLE CONDITION
 19105*        NOTFND   (7800-COMP-NOTFND)
 19106*    END-EXEC.
 19107*    MOVE '"$I                   ! @ #00017147' TO DFHEIV0
 19108     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19110     MOVE X'4020233030303137313437' TO DFHEIV0(25:11)
 19111     CALL 'kxdfhei1' USING DFHEIV0
 19112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19113
 19114
 19115
 19116* EXEC CICS READ
 19117*        DATASET   ('ERCOMP')
 19118*        RIDFLD    (ERCOMP-KEY)
 19119*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19120*    END-EXEC.
 19121     MOVE 'ERCOMP' TO DFHEIV1
 19122*    MOVE '&"S        E          (   #00017151' TO DFHEIV0
 19123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303137313531' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0,
 19127           DFHEIV1,
 19128           DFHEIV20,
 19129           DFHEIV99,
 19130           ERCOMP-KEY,
 19131           DFHEIV99,
 19132           DFHEIV99,
 19133           DFHEIV99
 19134     SET ADDRESS OF COMPENSATION-MASTER TO
 19135         DFHEIV20
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19137
 19138
 19139     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19140     GO TO 7800-COMP-EXIT.
 19141
 19142 7800-COMP-NOTFND.
 19143     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19144
 19145 7800-COMP-EXIT.
 19146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 367
* EL156.cbl
 19148 7900-READ-CLAIM.
 19149
 19150* EXEC CICS READ
 19151*        DATASET  ('ELMSTR')
 19152*        SET      (ADDRESS OF CLAIM-MASTER)
 19153*        RIDFLD   (ELMSTR-KEY)
 19154*    END-EXEC.
 19155     MOVE 'ELMSTR' TO DFHEIV1
 19156*    MOVE '&"S        E          (   #00017167' TO DFHEIV0
 19157     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19159     MOVE X'2020233030303137313637' TO DFHEIV0(25:11)
 19160     CALL 'kxdfhei1' USING DFHEIV0,
 19161           DFHEIV1,
 19162           DFHEIV20,
 19163           DFHEIV99,
 19164           ELMSTR-KEY,
 19165           DFHEIV99,
 19166           DFHEIV99,
 19167           DFHEIV99
 19168     SET ADDRESS OF CLAIM-MASTER TO
 19169         DFHEIV20
 19170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19171
 19172
 19173 7900-EXIT.
 19174      EXIT.
 19175
 19176 7910-READ-CLAIM-UPDATE.
 19177
 19178* EXEC CICS READ
 19179*        DATASET  ('ELMSTR')
 19180*        SET      (ADDRESS OF CLAIM-MASTER)
 19181*        RIDFLD   (ELMSTR-KEY)
 19182*        UPDATE
 19183*    END-EXEC.
 19184     MOVE 'ELMSTR' TO DFHEIV1
 19185*    MOVE '&"S        EU         (   #00017177' TO DFHEIV0
 19186     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19187     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19188     MOVE X'2020233030303137313737' TO DFHEIV0(25:11)
 19189     CALL 'kxdfhei1' USING DFHEIV0,
 19190           DFHEIV1,
 19191           DFHEIV20,
 19192           DFHEIV99,
 19193           ELMSTR-KEY,
 19194           DFHEIV99,
 19195           DFHEIV99,
 19196           DFHEIV99
 19197     SET ADDRESS OF CLAIM-MASTER TO
 19198         DFHEIV20
 19199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19200
 19201
 19202 7910-EXIT.
 19203      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 368
* EL156.cbl
 19205 7920-READ-BENE.
 19206     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19207     MOVE 'B'                TO BENE-RECORD-TYPE.
 19208     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19209
 19210     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19211        IF PI-PAYEE-TYPE    = 'B' AND
 19212           PI-PAYEE-SEQ-NUM = 9
 19213             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19214             MOVE WS-A-BENE           TO BENE-NUMBER.
 19215
 19216
 19217* EXEC CICS HANDLE CONDITION
 19218*        NOTFND   (7920-NOT-FOUND)
 19219*    END-EXEC.
 19220*    MOVE '"$I                   ! A #00017198' TO DFHEIV0
 19221     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19223     MOVE X'4120233030303137313938' TO DFHEIV0(25:11)
 19224     CALL 'kxdfhei1' USING DFHEIV0
 19225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19226
 19227
 19228
 19229* EXEC CICS READ
 19230*        DATASET  ('ELBENE')
 19231*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19232*        RIDFLD   (ELBENE-KEY)
 19233*    END-EXEC.
 19234     MOVE 'ELBENE' TO DFHEIV1
 19235*    MOVE '&"S        E          (   #00017202' TO DFHEIV0
 19236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19238     MOVE X'2020233030303137323032' TO DFHEIV0(25:11)
 19239     CALL 'kxdfhei1' USING DFHEIV0,
 19240           DFHEIV1,
 19241           DFHEIV20,
 19242           DFHEIV99,
 19243           ELBENE-KEY,
 19244           DFHEIV99,
 19245           DFHEIV99,
 19246           DFHEIV99
 19247     SET ADDRESS OF BENEFICIARY-MASTER TO
 19248         DFHEIV20
 19249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19250
 19251
 19252     MOVE 'Y' TO BENE-FOUND-SW.
 19253     GO TO 7920-EXIT.
 19254
 19255 7920-NOT-FOUND.
 19256     MOVE 'N'                    TO BENE-FOUND-SW.
 19257
 19258 7920-EXIT.
 19259      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 369
* EL156.cbl
 19261 7930-READ-CONTROL.
 19262
 19263* EXEC CICS READ
 19264*        DATASET  ('ELCNTL')
 19265*        SET      (ADDRESS OF CONTROL-FILE)
 19266*        RIDFLD   (ELCNTL-KEY)
 19267*    END-EXEC.
 19268     MOVE 'ELCNTL' TO DFHEIV1
 19269*    MOVE '&"S        E          (   #00017218' TO DFHEIV0
 19270     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19272     MOVE X'2020233030303137323138' TO DFHEIV0(25:11)
 19273     CALL 'kxdfhei1' USING DFHEIV0,
 19274           DFHEIV1,
 19275           DFHEIV20,
 19276           DFHEIV99,
 19277           ELCNTL-KEY,
 19278           DFHEIV99,
 19279           DFHEIV99,
 19280           DFHEIV99
 19281     SET ADDRESS OF CONTROL-FILE TO
 19282         DFHEIV20
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286 7930-EXIT.
 19287      EXIT.
 19288
 19289 7940-READ-CONTROL-UPDATE.
 19290
 19291* EXEC CICS READ
 19292*        DATASET  ('ELCNTL')
 19293*        SET      (ADDRESS OF CONTROL-FILE)
 19294*        RIDFLD   (ELCNTL-KEY)
 19295*        UPDATE
 19296*    END-EXEC.
 19297     MOVE 'ELCNTL' TO DFHEIV1
 19298*    MOVE '&"S        EU         (   #00017228' TO DFHEIV0
 19299     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19300     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19301     MOVE X'2020233030303137323238' TO DFHEIV0(25:11)
 19302     CALL 'kxdfhei1' USING DFHEIV0,
 19303           DFHEIV1,
 19304           DFHEIV20,
 19305           DFHEIV99,
 19306           ELCNTL-KEY,
 19307           DFHEIV99,
 19308           DFHEIV99,
 19309           DFHEIV99
 19310     SET ADDRESS OF CONTROL-FILE TO
 19311         DFHEIV20
 19312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19313
 19314
 19315 7940-EXIT.
 19316      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 370
* EL156.cbl
 19318 7950-READ-TRAILER.
 19319
 19320* EXEC CICS READ
 19321*        DATASET  ('ELTRLR')
 19322*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19323*        RIDFLD   (ELTRLR-KEY)
 19324*    END-EXEC.
 19325     MOVE 'ELTRLR' TO DFHEIV1
 19326*    MOVE '&"S        E          (   #00017239' TO DFHEIV0
 19327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19329     MOVE X'2020233030303137323339' TO DFHEIV0(25:11)
 19330     CALL 'kxdfhei1' USING DFHEIV0,
 19331           DFHEIV1,
 19332           DFHEIV20,
 19333           DFHEIV99,
 19334           ELTRLR-KEY,
 19335           DFHEIV99,
 19336           DFHEIV99,
 19337           DFHEIV99
 19338     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19339         DFHEIV20
 19340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19341
 19342
 19343 7950-EXIT.
 19344      EXIT.
 19345
 19346 7960-READ-TRAILER-UPDATE.
 19347
 19348* EXEC CICS READ
 19349*        DATASET  ('ELTRLR')
 19350*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19351*        RIDFLD   (ELTRLR-KEY)
 19352*        UPDATE
 19353*    END-EXEC.
 19354     MOVE 'ELTRLR' TO DFHEIV1
 19355*    MOVE '&"S        EU         (   #00017249' TO DFHEIV0
 19356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19357     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19358     MOVE X'2020233030303137323439' TO DFHEIV0(25:11)
 19359     CALL 'kxdfhei1' USING DFHEIV0,
 19360           DFHEIV1,
 19361           DFHEIV20,
 19362           DFHEIV99,
 19363           ELTRLR-KEY,
 19364           DFHEIV99,
 19365           DFHEIV99,
 19366           DFHEIV99
 19367     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19368         DFHEIV20
 19369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19370
 19371
 19372 7960-EXIT.
 19373      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 371
* EL156.cbl
 19375 7970-READ-CERT.
 19376
 19377* EXEC CICS READ
 19378*        DATASET  ('ELCERT')
 19379*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19380*        RIDFLD   (ELCERT-KEY)
 19381*    END-EXEC.
 19382     MOVE 'ELCERT' TO DFHEIV1
 19383*    MOVE '&"S        E          (   #00017260' TO DFHEIV0
 19384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19386     MOVE X'2020233030303137323630' TO DFHEIV0(25:11)
 19387     CALL 'kxdfhei1' USING DFHEIV0,
 19388           DFHEIV1,
 19389           DFHEIV20,
 19390           DFHEIV99,
 19391           ELCERT-KEY,
 19392           DFHEIV99,
 19393           DFHEIV99,
 19394           DFHEIV99
 19395     SET ADDRESS OF CERTIFICATE-MASTER TO
 19396         DFHEIV20
 19397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19398
 19399
 19400 7970-EXIT.
 19401      EXIT.
 19402 7975-read-acct.
 19403
 19404     move spaces              to WS-ACCT-RECORD-SW
 19405                                 pi-dcc-product-code
 19406
 19407     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19408     MOVE PI-CARRIER          TO ACCT-CARRIER
 19409     MOVE PI-GROUPING         TO ACCT-GROUPING
 19410     MOVE PI-STATE            TO ACCT-STATE
 19411     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19412     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19413     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19414     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19415
 19416
 19417* EXEC CICS READ
 19418*       DATASET ('ERACCT')
 19419*       RIDFLD  (ERACCT-KEY)
 19420*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19421*       GTEQ
 19422*       resp    (WS-RESPONSE)
 19423*    END-EXEC
 19424     MOVE 'ERACCT' TO DFHEIV1
 19425*    MOVE '&"S        G          (  N#00017282' TO DFHEIV0
 19426     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19428     MOVE X'204E233030303137323832' TO DFHEIV0(25:11)
 19429     CALL 'kxdfhei1' USING DFHEIV0,
 19430           DFHEIV1,
 19431           DFHEIV20,
 19432           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 372
* EL156.cbl
 19433           ERACCT-KEY,
 19434           DFHEIV99,
 19435           DFHEIV99,
 19436           DFHEIV99
 19437     SET ADDRESS OF ACCOUNT-MASTER TO
 19438         DFHEIV20
 19439     MOVE EIBRESP  TO WS-RESPONSE
 19440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19441     IF WS-RESP-NORMAL
 19442        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19443        and pi-cert-eff-dt < am-expiration-dt
 19444        and pi-cert-eff-dt >= am-effective-dt
 19445        move am-dcc-product-code to pi-dcc-product-code
 19446        set acct-found to true
 19447     end-if
 19448
 19449     .
 19450 7975-exit.
 19451     exit.
 19452 7980-READ-CERT-UPDATE.
 19453
 19454* EXEC CICS READ
 19455*        DATASET  ('ELCERT')
 19456*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19457*        RIDFLD   (ELCERT-KEY)
 19458*        UPDATE
 19459*    END-EXEC.
 19460     MOVE 'ELCERT' TO DFHEIV1
 19461*    MOVE '&"S        EU         (   #00017301' TO DFHEIV0
 19462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19464     MOVE X'2020233030303137333031' TO DFHEIV0(25:11)
 19465     CALL 'kxdfhei1' USING DFHEIV0,
 19466           DFHEIV1,
 19467           DFHEIV20,
 19468           DFHEIV99,
 19469           ELCERT-KEY,
 19470           DFHEIV99,
 19471           DFHEIV99,
 19472           DFHEIV99
 19473     SET ADDRESS OF CERTIFICATE-MASTER TO
 19474         DFHEIV20
 19475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19476
 19477
 19478 7980-EXIT.
 19479      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 373
* EL156.cbl
 19481 8000-LOAD-ERROR-MESSAGES.
 19482     IF PI-PASS-SW = 'C'
 19483        MOVE EMI-LINE1           TO ERMSG1BO
 19484     ELSE
 19485        MOVE EMI-LINE1           TO ERRMSG1O
 19486        MOVE EMI-LINE2           TO ERRMSG2O.
 19487
 19488 8000-EXIT.
 19489     EXIT.
 19490
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 374
* EL156.cbl
 19492
 19493 8010-DMD-ERROR-CHECKS.
 19494     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19495
 19496     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19497         GO TO 8051-ISSUE-ERROR.
 19498
 19499     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19500     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19501     MOVE '3'                    TO DC-OPTION-CODE.
 19502     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19503     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19504         GO TO 8051-ISSUE-ERROR.
 19505
 19506     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19507       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19508                           OR
 19509          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19510           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19511             MOVE ER-0851         TO EMI-ERROR
 19512             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19513       END-IF
 19514       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19515             MOVE ER-8147         TO EMI-ERROR
 19516             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19517
 19518     GO TO 8090-EXIT.
 19519
 19520 8051-ISSUE-ERROR.
 19521     MOVE ER-8146            TO EMI-ERROR.
 19522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19523     GO TO 8090-EXIT.
 19524
 19525 8090-EXIT.
 19526      EXIT.
 19527
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 375
* EL156.cbl
 19529 8100-SEND-INITIAL-MAP.
 19530
 19531     MOVE SAVE-DATE              TO RUNDTEAO.
 19532     MOVE EIBTIME                TO TIME-IN.
 19533     MOVE TIME-OUT               TO RUNTIMAO.
 19534     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19535
 19536     IF MAP-NAME = 'EL156A'
 19537        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19538           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19539        END-IF
 19540     END-IF
 19541*    IF MAP-NAME = 'EL156A'
 19542*       IF PI-COMPANY-ID = 'CRI'
 19543*          NEXT SENTENCE
 19544*       ELSE
 19545*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19546
 19547     IF MAP-NAME = 'EL156A'
 19548        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19549           NEXT SENTENCE
 19550        ELSE
 19551           MOVE AL-SADOF TO  PINTA    PINTHA.
 19552
 19553     IF MAP-NAME = 'EL156A'
 19554        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19555            NEXT SENTENCE
 19556        ELSE
 19557           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19558
 19559*    IF MAP-NAME = 'EL156A'
 19560*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19561*          NEXT SENTENCE
 19562*       ELSE
 19563*          MOVE AL-SADOF TO CASHHA CASHA.
 19564
 19565     IF MAP-NAME = 'EL156A'
 19566        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19567           NEXT SENTENCE
 19568        ELSE
 19569           MOVE AL-SADOF        TO  LOANHA
 19570                                    LOANNOA.
 19571
 19572     IF MAP-NAME = 'EL156A'
 19573        MOVE -1                 TO  ENTERPFL
 19574        IF PI-USES-PAID-TO
 19575           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19576           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19577           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19578        ELSE
 19579           NEXT SENTENCE
 19580     ELSE
 19581        IF MAP-NAME = 'EL156B'
 19582           IF PI-USES-PAID-TO
 19583              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19584              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19585
 19586
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 376
* EL156.cbl
 19587* EXEC CICS SEND
 19588*        MAP   (MAP-NAME)
 19589*        MAPSET(MAPSET-NAME)
 19590*        FROM  (EL156AI)
 19591*        ERASE
 19592*        CURSOR
 19593*    END-EXEC.
 19594     MOVE LENGTH OF
 19595      EL156AI
 19596       TO DFHEIV12
 19597     MOVE -1
 19598       TO DFHEIV11
 19599*    MOVE '8$     CT  E    H L F ,   #00017416' TO DFHEIV0
 19600     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19601     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19602     MOVE X'2020233030303137343136' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0,
 19604           MAP-NAME,
 19605           EL156AI,
 19606           DFHEIV12,
 19607           MAPSET-NAME,
 19608           DFHEIV99,
 19609           DFHEIV99,
 19610           DFHEIV99,
 19611           DFHEIV11,
 19612           DFHEIV99,
 19613           DFHEIV99,
 19614           DFHEIV99
 19615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19616
 19617
 19618     GO TO 9100-RETURN-TRAN.
 19619
 19620 8200-SEND-DATAONLY.
 19621
 19622     IF FIRST-ENTRY = 'Y'
 19623         GO TO 8100-SEND-INITIAL-MAP.
 19624
 19625     IF RETURNED-FROM-B = 'Y'
 19626         GO TO 8100-SEND-INITIAL-MAP.
 19627
 19628     MOVE SAVE-DATE              TO RUNDTEAO.
 19629     MOVE EIBTIME                TO TIME-IN.
 19630     MOVE TIME-OUT               TO RUNTIMAO.
 19631
 19632     IF EIBAID = DFHPF11
 19633        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19635        MOVE 'EL001   '          TO RETURNED-FROM
 19636        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19637        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19638        GO TO 8100-SEND-INITIAL-MAP.
 19639
 19640     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19641
 19642     IF MAP-NAME =  'EL156A'
 19643        MOVE -1                 TO  ENTERPFL
 19644        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 377
* EL156.cbl
 19645           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19646           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19647           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19648        ELSE
 19649           NEXT SENTENCE
 19650     ELSE
 19651        IF MAP-NAME = 'EL156B'
 19652           IF PI-USES-PAID-TO
 19653              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19654              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19655
 19656     IF MAP-NAME =  'EL156A'
 19657        IF PI-COMPANY-ID = 'BOA'
 19658            IF PI-INT-RATE NUMERIC
 19659                MOVE PI-INT-RATE TO PINTO.
 19660     IF MAP-NAME = 'EL156A'
 19661        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19662           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19663*          MOVE 'Y'              TO EOBYNO
 19664        END-IF
 19665     END-IF
 19666
 19667
 19668* EXEC CICS SEND
 19669*        MAP   (MAP-NAME)
 19670*        MAPSET(MAPSET-NAME)
 19671*        FROM  (EL156AI)
 19672*        DATAONLY
 19673*        CURSOR
 19674*    END-EXEC.
 19675     MOVE LENGTH OF
 19676      EL156AI
 19677       TO DFHEIV12
 19678     MOVE -1
 19679       TO DFHEIV11
 19680*    MOVE '8$D    CT       H L F ,   #00017473' TO DFHEIV0
 19681     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19682     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19683     MOVE X'2020233030303137343733' TO DFHEIV0(25:11)
 19684     CALL 'kxdfhei1' USING DFHEIV0,
 19685           MAP-NAME,
 19686           EL156AI,
 19687           DFHEIV12,
 19688           MAPSET-NAME,
 19689           DFHEIV99,
 19690           DFHEIV99,
 19691           DFHEIV99,
 19692           DFHEIV11,
 19693           DFHEIV99,
 19694           DFHEIV99,
 19695           DFHEIV99
 19696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19697
 19698
 19699     GO TO 9100-RETURN-TRAN.
 19700
 19701 8300-SEND-TEXT.
 19702
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 378
* EL156.cbl
 19703* EXEC CICS SEND TEXT
 19704*        FROM(LOGOFF-TEXT)
 19705*        LENGTH(LOGOFF-LENGTH)
 19706*        ERASE
 19707*        FREEKB
 19708*    END-EXEC.
 19709*    MOVE '8&      T  E F  H   F -   #00017484' TO DFHEIV0
 19710     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19711     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19712     MOVE X'2020233030303137343834' TO DFHEIV0(25:11)
 19713     CALL 'kxdfhei1' USING DFHEIV0,
 19714           LOGOFF-TEXT,
 19715           LOGOFF-LENGTH,
 19716           DFHEIV99,
 19717           DFHEIV99,
 19718           DFHEIV99,
 19719           DFHEIV99,
 19720           DFHEIV99,
 19721           DFHEIV99,
 19722           DFHEIV99,
 19723           DFHEIV99,
 19724           DFHEIV99,
 19725           DFHEIV99
 19726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19727
 19728
 19729
 19730* EXEC CICS RETURN
 19731*    END-EXEC.
 19732*    MOVE '.(                    ''   #00017491' TO DFHEIV0
 19733     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19734     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19735     MOVE X'2020233030303137343931' TO DFHEIV0(25:11)
 19736     CALL 'kxdfhei1' USING DFHEIV0,
 19737           DFHEIV99,
 19738           DFHEIV99,
 19739           DFHEIV99,
 19740           DFHEIV99,
 19741           DFHEIV99,
 19742           DFHEIV99
 19743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19744
 19745
 19746 8500-FILE-NOTOPEN.
 19747     IF FILE-SWITCH = 'MSTR'
 19748         MOVE ER-0154            TO EMI-ERROR.
 19749     IF FILE-SWITCH = 'TRLR'
 19750         MOVE ER-0172            TO EMI-ERROR.
 19751     IF FILE-SWITCH = 'CERT'
 19752         MOVE ER-0169            TO EMI-ERROR.
 19753     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19754                      'PROC' OR 'STAT'
 19755         MOVE ER-0042            TO EMI-ERROR.
 19756     IF FILE-SWITCH = 'ACTQ'
 19757         MOVE ER-0338            TO EMI-ERROR.
 19758     IF FILE-SWITCH = 'ACCT'
 19759         MOVE ER-0168            TO EMI-ERROR.
 19760
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 379
* EL156.cbl
 19761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19762     MOVE -1                     TO PMTTYPEL.
 19763
 19764     IF FIRST-ENTRY = 'Y'
 19765         GO TO 8100-SEND-INITIAL-MAP.
 19766
 19767     GO TO 8200-SEND-DATAONLY.
 19768
 19769 8600-PGRM-NOT-FOUND.
 19770
 19771     MOVE ER-0923                TO EMI-ERROR.
 19772     MOVE -1                     TO ENTPFBL.
 19773     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19774
 19775     IF FIRST-ENTRY = 'Y'
 19776         GO TO 8100-SEND-INITIAL-MAP
 19777     ELSE
 19778         GO TO 8200-SEND-DATAONLY.
 19779
 19780 8800-UNAUTHORIZED-ACCESS.
 19781     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19782     GO TO 8300-SEND-TEXT.
 19783
 19784 8810-PF23.
 19785     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19786     MOVE XCTL-005               TO PGM-NAME.
 19787     GO TO 9300-XCTL.
 19788
 19789 8820-PF7-8.
 19790     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19791     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19792                                    PI-SAVED-PROGRAM-2
 19793                                    PI-SAVED-PROGRAM-3
 19794                                    PI-SAVED-PROGRAM-4
 19795                                    PI-SAVED-PROGRAM-5
 19796                                    PI-SAVED-PROGRAM-6
 19797                                    PI-RETURN-TO-PROGRAM.
 19798     IF EIBAID = DFHPF8
 19799        MOVE XCTL-132            TO PGM-NAME
 19800     ELSE
 19801        MOVE XCTL-130            TO PGM-NAME.
 19802
 19803     GO TO 9300-XCTL.
 19804
 19805 9100-RETURN-TRAN.
 19806     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19807     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19808
 19809
 19810* EXEC CICS RETURN
 19811*        TRANSID(TRANS-ID)
 19812*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19813*        LENGTH(PI-COMM-LENGTH)
 19814*    END-EXEC.
 19815*    MOVE '.(CT                  ''   #00017557' TO DFHEIV0
 19816     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19817     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19818     MOVE X'2020233030303137353537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 380
* EL156.cbl
 19819     CALL 'kxdfhei1' USING DFHEIV0,
 19820           TRANS-ID,
 19821           PROGRAM-INTERFACE-BLOCK,
 19822           PI-COMM-LENGTH,
 19823           DFHEIV99,
 19824           DFHEIV99,
 19825           DFHEIV99
 19826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19827
 19828
 19829 9200-RETURN-MAIN-MENU.
 19830     MOVE XCTL-126               TO PGM-NAME.
 19831     GO TO 9300-XCTL.
 19832
 19833 9300-XCTL.
 19834
 19835* EXEC CICS XCTL
 19836*        PROGRAM(PGM-NAME)
 19837*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19838*        LENGTH(PI-COMM-LENGTH)
 19839*    END-EXEC.
 19840*    MOVE '.$C                   %   #00017568' TO DFHEIV0
 19841     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19842     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19843     MOVE X'2020233030303137353638' TO DFHEIV0(25:11)
 19844     CALL 'kxdfhei1' USING DFHEIV0,
 19845           PGM-NAME,
 19846           PROGRAM-INTERFACE-BLOCK,
 19847           PI-COMM-LENGTH,
 19848           DFHEIV99
 19849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19850
 19851
 19852 9400-CLEAR.
 19853     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19854     GO TO 9300-XCTL.
 19855
 19856 9500-PF12.
 19857     MOVE XCTL-010               TO PGM-NAME.
 19858     GO TO 9300-XCTL.
 19859
 19860 9700-LINK-DATE-CONVERT.
 19861     MOVE LINK-ELDATCV           TO PGM-NAME.
 19862
 19863* EXEC CICS LINK
 19864*        PROGRAM   (PGM-NAME)
 19865*        COMMAREA  (DATE-CONVERSION-DATA)
 19866*        LENGTH    (DC-COMM-LENGTH)
 19867*    END-EXEC.
 19868*    MOVE '."C                   (   #00017584' TO DFHEIV0
 19869     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19871     MOVE X'2020233030303137353834' TO DFHEIV0(25:11)
 19872     CALL 'kxdfhei1' USING DFHEIV0,
 19873           PGM-NAME,
 19874           DATE-CONVERSION-DATA,
 19875           DC-COMM-LENGTH,
 19876           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 381
* EL156.cbl
 19877           DFHEIV99,
 19878           DFHEIV99,
 19879           DFHEIV99
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19881
 19882
 19883 9700-EXIT.
 19884     EXIT.
 19885
 19886 9800-LINK-REM-TERM.
 19887     MOVE LINK-REMTERM TO PGM-NAME.
 19888
 19889
 19890* EXEC CICS LINK
 19891*        PROGRAM   (PGM-NAME)
 19892*        COMMAREA  (CALCULATION-PASS-AREA)
 19893*        LENGTH    (CP-COMM-LENGTH)
 19894*    END-EXEC.
 19895*    MOVE '."C                   (   #00017596' TO DFHEIV0
 19896     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19898     MOVE X'2020233030303137353936' TO DFHEIV0(25:11)
 19899     CALL 'kxdfhei1' USING DFHEIV0,
 19900           PGM-NAME,
 19901           CALCULATION-PASS-AREA,
 19902           CP-COMM-LENGTH,
 19903           DFHEIV99,
 19904           DFHEIV99,
 19905           DFHEIV99,
 19906           DFHEIV99
 19907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19908
 19909
 19910 9800-EXIT.
 19911     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 382
* EL156.cbl
 19913 9830-DMD-REMAINING-TERM.
 19914
 19915     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19916         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19917
 19918     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19919                              CM-PMT-EXTENSION-DAYS.
 19920
 19921     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19922                                  CL-NO-OF-DAYS-PAID.
 19923
 19924     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19925         GIVING W-REM REMAINDER W-REM-DAYS.
 19926
 19927     MOVE W-REM                  TO WST-REM.
 19928
 19929     IF W-REM-DAYS > ZEROS
 19930         MOVE '/'                TO WST-SLASH
 19931         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19932     ELSE
 19933         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19934
 19935 9830-EXIT.
 19936     EXIT.
 19937
 19938 9870-OUTPUT-ACTIVITY-RECORD.
 19939
 19940
 19941* EXEC CICS GETMAIN
 19942*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19943*         LENGTH(25)
 19944*         INITIMG(WS-BLANK)
 19945*    END-EXEC.
 19946     MOVE 25
 19947       TO DFHEIV11
 19948*    MOVE ',"IL                  $   #00017632' TO DFHEIV0
 19949     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19950     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19951     MOVE X'2020233030303137363332' TO DFHEIV0(25:11)
 19952     CALL 'kxdfhei1' USING DFHEIV0,
 19953           DFHEIV20,
 19954           DFHEIV11,
 19955           WS-BLANK
 19956     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19957         DFHEIV20
 19958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19959
 19960
 19961     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19962     MOVE ELMSTR-KEY             TO DA-KEY.
 19963     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19964
 19965     IF PI-PMTTYPE EQUAL '7'
 19966         MOVE 'V'                TO DA-RECORD-TYPE
 19967     ELSE
 19968         MOVE 'P'                TO DA-RECORD-TYPE.
 19969
 19970
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 383
* EL156.cbl
 19971* EXEC CICS HANDLE CONDITION
 19972*         NOTOPEN(9870-NOTOPEN)
 19973*         DUPREC(9870-EXIT)
 19974*    END-EXEC.
 19975*    MOVE '"$J%                  ! B #00017647' TO DFHEIV0
 19976     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19978     MOVE X'4220233030303137363437' TO DFHEIV0(25:11)
 19979     CALL 'kxdfhei1' USING DFHEIV0
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19981
 19982
 19983
 19984* EXEC CICS WRITE
 19985*         DATASET('DLYACTV')
 19986*         RIDFLD(DA-KEY)
 19987*         FROM(DAILY-ACTIVITY-RECORD)
 19988*         LENGTH(25)
 19989*    END-EXEC.
 19990     MOVE 'DLYACTV' TO DFHEIV1
 19991     MOVE 25
 19992       TO DFHEIV11
 19993*    MOVE '&$ L                  ''   #00017652' TO DFHEIV0
 19994     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19995     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19996     MOVE X'2020233030303137363532' TO DFHEIV0(25:11)
 19997     CALL 'kxdfhei1' USING DFHEIV0,
 19998           DFHEIV1,
 19999           DAILY-ACTIVITY-RECORD,
 20000           DFHEIV11,
 20001           DA-KEY,
 20002           DFHEIV99,
 20003           DFHEIV99
 20004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20005
 20006     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20007     GO TO 9870-EXIT.
 20008
 20009 9870-NOTOPEN.
 20010
 20011     MOVE '2955'                 TO EMI-ERROR.
 20012     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20013
 20014 9870-EXIT.
 20015     EXIT.
 20016
 20017 9900-ERROR-FORMAT.
 20018
 20019     IF EMI-ERROR = ER-0923
 20020         MOVE PGM-NAME           TO W-CALLED-NAME.
 20021
 20022     MOVE LINK-001      TO PGM-NAME.
 20023     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20024
 20025
 20026* EXEC CICS LINK
 20027*        PROGRAM (PGM-NAME)
 20028*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 384
* EL156.cbl
 20029*        LENGTH  (EMI-COMM-LENGTH)
 20030*    END-EXEC.
 20031*    MOVE '."C                   (   #00017677' TO DFHEIV0
 20032     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20034     MOVE X'2020233030303137363737' TO DFHEIV0(25:11)
 20035     CALL 'kxdfhei1' USING DFHEIV0,
 20036           PGM-NAME,
 20037           ERROR-MESSAGE-INTERFACE-BLOCK,
 20038           EMI-COMM-LENGTH,
 20039           DFHEIV99,
 20040           DFHEIV99,
 20041           DFHEIV99,
 20042           DFHEIV99
 20043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20044
 20045
 20046     IF EMI-ERROR = ER-0923
 20047         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20048
 20049 9900-EXIT.
 20050     EXIT.
 20051
 20052 9990-ABEND.
 20053     MOVE LINK-004               TO PGM-NAME.
 20054     MOVE DFHEIBLK               TO EMI-LINE1.
 20055
 20056* EXEC CICS LINK
 20057*        PROGRAM   (PGM-NAME)
 20058*        COMMAREA  (EMI-LINE1)
 20059*        LENGTH    (64)
 20060*    END-EXEC.
 20061     MOVE 64
 20062       TO DFHEIV11
 20063*    MOVE '."C                   (   #00017692' TO DFHEIV0
 20064     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20065     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20066     MOVE X'2020233030303137363932' TO DFHEIV0(25:11)
 20067     CALL 'kxdfhei1' USING DFHEIV0,
 20068           PGM-NAME,
 20069           EMI-LINE1,
 20070           DFHEIV11,
 20071           DFHEIV99,
 20072           DFHEIV99,
 20073           DFHEIV99,
 20074           DFHEIV99
 20075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20076
 20077
 20078     MOVE 'EL156A'               TO  MAP-NAME.
 20079     MOVE LOW-VALUES             TO  EL156AO.
 20080     GO TO 8100-SEND-INITIAL-MAP.
 20081
 20082 9995-SECURITY-VIOLATION.
 20083*    COPY ELCSCTP.
 20084******************************************************************
 20085*                                                                *
 20086*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 385
* EL156.cbl
 20087*                            VMOD=2.001                          *
 20088*                                                                *
 20089*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20090******************************************************************
 20091
 20092
 20093     MOVE EIBDATE          TO SM-JUL-DATE.
 20094     MOVE EIBTRMID         TO SM-TERMID.
 20095     MOVE THIS-PGM         TO SM-PGM.
 20096     MOVE EIBTIME          TO TIME-IN.
 20097     MOVE TIME-OUT         TO SM-TIME.
 20098     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20099
 20100
 20101* EXEC CICS LINK
 20102*         PROGRAM  ('EL003')
 20103*         COMMAREA (SECURITY-MESSAGE)
 20104*         LENGTH   (80)
 20105*    END-EXEC.
 20106     MOVE 'EL003' TO DFHEIV1
 20107     MOVE 80
 20108       TO DFHEIV11
 20109*    MOVE '."C                   (   #00017720' TO DFHEIV0
 20110     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20112     MOVE X'2020233030303137373230' TO DFHEIV0(25:11)
 20113     CALL 'kxdfhei1' USING DFHEIV0,
 20114           DFHEIV1,
 20115           SECURITY-MESSAGE,
 20116           DFHEIV11,
 20117           DFHEIV99,
 20118           DFHEIV99,
 20119           DFHEIV99,
 20120           DFHEIV99
 20121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20122
 20123
 20124******************************************************************
 20125
 20126
 20127
 20128 9999-DFHBACK SECTION.
 20129     MOVE '9%                    "   ' TO DFHEIV0
 20130     MOVE 'EL156' TO DFHEIV1
 20131     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20132     GOBACK.
 20133 9999-DFHEXIT.
 20134     IF DFHEIGDJ EQUAL 0001
 20135         NEXT SENTENCE
 20136     ELSE IF DFHEIGDJ EQUAL 2
 20137         GO TO 9990-ABEND,
 20138               8600-PGRM-NOT-FOUND,
 20139               0400-FIRST-TIME,
 20140               6180-DUPREC,
 20141               9990-ABEND
 20142         DEPENDING ON DFHEIGDI
 20143     ELSE IF DFHEIGDJ EQUAL 3
 20144         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 386
* EL156.cbl
 20145               0380-CLAIM-END-FILE
 20146         DEPENDING ON DFHEIGDI
 20147     ELSE IF DFHEIGDJ EQUAL 4
 20148         GO TO 0380-CLAIM-END-FILE,
 20149               0380-CLAIM-END-FILE
 20150         DEPENDING ON DFHEIGDI
 20151     ELSE IF DFHEIGDJ EQUAL 5
 20152         GO TO 0800-EXIT
 20153         DEPENDING ON DFHEIGDI
 20154     ELSE IF DFHEIGDJ EQUAL 6
 20155         GO TO 1950-NOT-FOUND,
 20156               1950-NOT-FOUND
 20157         DEPENDING ON DFHEIGDI
 20158     ELSE IF DFHEIGDJ EQUAL 7
 20159         GO TO 1950-NOT-FOUND
 20160         DEPENDING ON DFHEIGDI
 20161     ELSE IF DFHEIGDJ EQUAL 8
 20162         GO TO 1950-NOT-FOUND,
 20163               1950-NOT-FOUND
 20164         DEPENDING ON DFHEIGDI
 20165     ELSE IF DFHEIGDJ EQUAL 9
 20166         GO TO 1166-END-CHECK,
 20167               1166-END-CHECK
 20168         DEPENDING ON DFHEIGDI
 20169     ELSE IF DFHEIGDJ EQUAL 10
 20170         GO TO 1950-NOT-FOUND,
 20171               1950-NOT-FOUND
 20172         DEPENDING ON DFHEIGDI
 20173     ELSE IF DFHEIGDJ EQUAL 11
 20174         GO TO 1950-NOT-FOUND,
 20175               1950-NOT-FOUND
 20176         DEPENDING ON DFHEIGDI
 20177     ELSE IF DFHEIGDJ EQUAL 12
 20178         GO TO 1950-NOT-FOUND
 20179         DEPENDING ON DFHEIGDI
 20180     ELSE IF DFHEIGDJ EQUAL 13
 20181         GO TO 3600-CONTINUE
 20182         DEPENDING ON DFHEIGDI
 20183     ELSE IF DFHEIGDJ EQUAL 14
 20184         GO TO 5300-NOTE-NOT-FOUND
 20185         DEPENDING ON DFHEIGDI
 20186     ELSE IF DFHEIGDJ EQUAL 15
 20187         GO TO 6065-NOT-FOUND
 20188         DEPENDING ON DFHEIGDI
 20189     ELSE IF DFHEIGDJ EQUAL 16
 20190         GO TO 6068-ACCT-NOT-FND
 20191         DEPENDING ON DFHEIGDI
 20192     ELSE IF DFHEIGDJ EQUAL 17
 20193         GO TO 6074-GET-COMP-DATA
 20194         DEPENDING ON DFHEIGDI
 20195     ELSE IF DFHEIGDJ EQUAL 18
 20196         GO TO 6170-WRITE
 20197         DEPENDING ON DFHEIGDI
 20198     ELSE IF DFHEIGDJ EQUAL 19
 20199         GO TO 6180-DUPREC
 20200         DEPENDING ON DFHEIGDI
 20201     ELSE IF DFHEIGDJ EQUAL 20
 20202         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 387
* EL156.cbl
 20203         DEPENDING ON DFHEIGDI
 20204     ELSE IF DFHEIGDJ EQUAL 21
 20205         GO TO 6185-DUPREC
 20206         DEPENDING ON DFHEIGDI
 20207     ELSE IF DFHEIGDJ EQUAL 22
 20208         GO TO 6720-BUILD-NEW-RECORD
 20209         DEPENDING ON DFHEIGDI
 20210     ELSE IF DFHEIGDJ EQUAL 23
 20211         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20212               6900-BUILD-ARCHIVE-HEADER
 20213         DEPENDING ON DFHEIGDI
 20214     ELSE IF DFHEIGDJ EQUAL 24
 20215         GO TO 7010-BUILD-MAP
 20216         DEPENDING ON DFHEIGDI
 20217     ELSE IF DFHEIGDJ EQUAL 25
 20218         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20219         DEPENDING ON DFHEIGDI
 20220     ELSE IF DFHEIGDJ EQUAL 26
 20221         GO TO 7160-DUPREC
 20222         DEPENDING ON DFHEIGDI
 20223     ELSE IF DFHEIGDJ EQUAL 27
 20224         GO TO 7200-EXIT,
 20225               7200-EXIT
 20226         DEPENDING ON DFHEIGDI
 20227     ELSE IF DFHEIGDJ EQUAL 28
 20228         GO TO 7400-NOT-FOUND
 20229         DEPENDING ON DFHEIGDI
 20230     ELSE IF DFHEIGDJ EQUAL 29
 20231         GO TO 7590-END,
 20232               7590-END
 20233         DEPENDING ON DFHEIGDI
 20234     ELSE IF DFHEIGDJ EQUAL 30
 20235         GO TO 7699-EXIT
 20236         DEPENDING ON DFHEIGDI
 20237     ELSE IF DFHEIGDJ EQUAL 31
 20238         GO TO 5300-NOTE-NOT-FOUND
 20239         DEPENDING ON DFHEIGDI
 20240     ELSE IF DFHEIGDJ EQUAL 32
 20241         GO TO 7800-COMP-NOTFND
 20242         DEPENDING ON DFHEIGDI
 20243     ELSE IF DFHEIGDJ EQUAL 33
 20244         GO TO 7920-NOT-FOUND
 20245         DEPENDING ON DFHEIGDI
 20246     ELSE IF DFHEIGDJ EQUAL 34
 20247         GO TO 9870-NOTOPEN,
 20248               9870-EXIT
 20249         DEPENDING ON DFHEIGDI.
 20250     MOVE '9%                    "   ' TO DFHEIV0
 20251     MOVE 'EL156' TO DFHEIV1
 20252     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20253     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12180     Code:       74962
