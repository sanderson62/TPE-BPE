* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   1
* EL162.cbl
* Options: int("EL162.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL162.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL162.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL162.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL162 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/02/95 14:07:28.
     7*                            VMOD=2.015
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX17 - RECORD MAIL RECEIVED
    13*            USED TO REVIEW PENDING MAIL AND TO RECORD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   2
* EL162.cbl
    14*            INCOMING MAIL.
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    24* 121406    2006081100001  PEMA  ADD RECEIVE DATE EDIT
    25* 051107    2006052500001  AJRA  POPULATE UBY WITH USER ID
    26* 100610    2009122800001  AJRA  BYPASS LETTER W/ RESEND PRINTED D
    27* 102610    2009122800001  AJRA    REPLACE VERIFY W/ STOP DATE
    28* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    29* 010416    2015072900002  TANA  ADD PF7 TO CLAIM MEMO SCREEN
    30* 062217    2017050300002  TANA  ADD AUTH RCVD FIELD
    31* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    32******************************************************************
    33
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   3
* EL162.cbl
    35 ENVIRONMENT DIVISION.
    36 DATA DIVISION.
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*    EL162 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.015 *********'.
    42
    43*                            COPY ELCSCTM.
    44******************************************************************
    45*                                                                *
    46*                                                                *
    47*                            ELCSCTM                             *
    48*                            VMOD=2.001                          *
    49*                                                                *
    50*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    51*                                                                *
    52******************************************************************
    53 01  SECURITY-MESSAGE.
    54     12  FILLER                          PIC X(30)
    55            VALUE '** LOGIC SECURITY VIOLATION -'.
    56     12  SM-READ                         PIC X(6).
    57     12  FILLER                          PIC X(5)
    58            VALUE ' PGM='.
    59     12  SM-PGM                          PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' OPR='.
    62     12  SM-PROCESSOR-ID                 PIC X(4).
    63     12  FILLER                          PIC X(6)
    64            VALUE ' TERM='.
    65     12  SM-TERMID                       PIC X(4).
    66     12  FILLER                          PIC XX   VALUE SPACE.
    67     12  SM-JUL-DATE                     PIC 9(5).
    68     12  FILLER                          PIC X    VALUE SPACE.
    69     12  SM-TIME                         PIC 99.99.
    70
    71
    72*                            COPY ELCSCRTY.
    73******************************************************************
    74*                                                                *
    75*                                                                *
    76*                            ELCSCRTY                            *
    77*                            VMOD=2.001                          *
    78*                                                                *
    79*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    80*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    81*        SAVED IN PI-SECURITY-ADDRESS.                           *
    82*                                                                *
    83******************************************************************
    84 01  SECURITY-CONTROL.
    85     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    86     12  FILLER                       PIC XX    VALUE 'SC'.
    87     12  SC-CREDIT-CODES.
    88         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    89             20  SC-CREDIT-DISPLAY    PIC X.
    90             20  SC-CREDIT-UPDATE     PIC X.
    91     12  SC-CLAIMS-CODES.
    92         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   4
* EL162.cbl
    93             20  SC-CLAIMS-DISPLAY    PIC X.
    94             20  SC-CLAIMS-UPDATE     PIC X.
    95
    96 01  WS-DATE-AREA.
    97     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    98     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    99     05  CURRENT-MINUS1-SAVE PIC XX      VALUE SPACES.
   100
   101 01  STANDARD-AREAS.
   102     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   103     12  MAP-NAME.
   104         16  MAP-PRE             PIC XX      VALUE 'EL'.
   105         16  MAP-NUMBER          PIC X(4)    VALUE '162A'.
   106         16  FILLER              PIC XX      VALUE SPACES.
   107     12  MAPSET-NAME             PIC X(8)    VALUE 'EL162S'.
   108     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   109     12  TRANS-ID                PIC X(4)    VALUE 'EX17'.
   110     12  PGM-NAME                PIC X(8).
   111     12  TIME-IN                 PIC S9(7).
   112     12  TIME-OUT-R  REDEFINES TIME-IN.
   113         16  FILLER              PIC X.
   114         16  TIME-OUT            PIC 99V99.
   115         16  FILLER              PIC XX.
   116     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   117     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   118     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   119     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   120     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   121     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   122     12  THIS-PGM                PIC X(8)    VALUE 'EL162'.
   123     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   124     12  PGM-EL132               PIC X(8)    VALUE 'EL132'.
   125     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   126     12  PGM-EL1284              PIC X(8)    VALUE 'EL1284'.
   127     12  ELMSTR-FILE-ID          PIC X(8)    VALUE 'ELMSTR'.
   128     12  ELTRLR-FILE-ID          PIC X(8)    VALUE 'ELTRLR'.
   129     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   130     12  SUB                     PIC S999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   5
* EL162.cbl
   132 01  ERROR-MESSAGES.
   133     12  ER-ZEROS                PIC X(4)    VALUE '0000'.
   134     12  ER-0004                 PIC X(4)    VALUE '0004'.
   135     12  ER-0008                 PIC X(4)    VALUE '0008'.
   136     12  ER-0029                 PIC X(4)    VALUE '0029'.
   137     12  ER-0050                 PIC X(4)    VALUE '0050'.
   138     12  ER-0021                 PIC X(4)    VALUE '0021'.
   139     12  ER-0042                 PIC X(4)    VALUE '0042'.
   140     12  ER-0066                 PIC X(4)    VALUE '0066'.
   141     12  ER-0067                 PIC X(4)    VALUE '0067'.
   142     12  ER-0070                 PIC X(4)    VALUE '0070'.
   143     12  ER-0133                 PIC X(4)    VALUE '0133'.
   144     12  ER-0168                 PIC X(4)    VALUE '0168'.
   145     12  ER-0172                 PIC X(4)    VALUE '0172'.
   146     12  ER-0179                 PIC X(4)    VALUE '0179'.
   147     12  ER-0287                 PIC X(4)    VALUE '0287'.
   148     12  ER-0318                 PIC X(4)    VALUE '0318'.
   149     12  ER-0319                 PIC X(4)    VALUE '0319'.
   150     12  ER-0320                 PIC X(4)    VALUE '0320'.
   151     12  ER-0321                 PIC X(4)    VALUE '0321'.
   152     12  ER-0322                 PIC X(4)    VALUE '0322'.
   153     12  ER-0514                 PIC X(4)    VALUE '0514'.
   154     12  ER-0539                 PIC X(4)    VALUE '0539'.
   155     12  ER-0895                 PIC X(4)    VALUE '0895'.
   156     12  ER-0896                 PIC X(4)    VALUE '0896'.
   157     12  ER-7839                 PIC X(4)    VALUE '7839'.
   158
   159     12  BIN-CURRENT-DATE        PIC XX.
   160     12  INDX-WORK               PIC 9(4).
   161     12  REC-DATA-SW             PIC X       VALUE ' '.
   162         88  REC-DATA                        VALUE '1'.
   163     12  VER-DATA-SW             PIC X       VALUE ' '.
   164         88  VER-DATA                        VALUE '1'.
   165     12  UNSOL-DATA-SW           PIC X       VALUE ' '.
   166         88  UNSOL-DATA                      VALUE '1'.
   167         88  FILE-DATA                       VALUE '2'.
   168     12  ADDR-TYPE               PIC X.
   169     12  ADDR-SEQ                PIC S9(4) COMP.
   170     12  ACTV-LENGTH             PIC S9(4) COMP VALUE +200.
   171     12  USENT-SAVE              PIC XX    VALUE LOW-VALUES.
   172     12  URECDTE-SAVE            PIC XX    VALUE LOW-VALUES.
   173     12  REC-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX     PIC XX.
   174     12  STOP-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX2   PIC XX.
   175     12  DEEDIT-FIELD            PIC X(15).
   176     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   177
   178     12  ACCT-KEY.
   179         16  ACCT-PARTIAL-KEY.
   180             20  ACCT-CO         PIC X.
   181             20  ACCT-CARRIER    PIC X.
   182             20  ACCT-GROUPING   PIC X(6).
   183             20  ACCT-STATE      PIC XX.
   184             20  ACCT-ACCOUNT    PIC X(10).
   185         16  ACCT-EXP-DATE       PIC XX.
   186     12  FILLER                  PIC S9(9)  VALUE +0 COMP.
   187     12  ACCT-SAVE-KEY           PIC X(20).
   188     12  WS-ZIP.
   189         16  WS-ZIP-CODE         PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   6
* EL162.cbl
   190         16  WS-DASH             PIC X     VALUE '-'.
   191         16  WS-ZIP-PLUS4        PIC X(4).
   192     12  WS-CANADIAN-POSTAL-CODES REDEFINES WS-ZIP.
   193         16  WS-CAN-POSTAL-CD-1  PIC X(3).
   194         16  WS-DASH-CAN         PIC X.
   195         16  WS-CAN-POSTAL-CD-2  PIC X(3).
   196         16  WS-CAN-FILLER       PIC X(3).
   197     12  WS-WORK-PHONE           PIC X(10)  VALUE ZEROS.
   198     12  WS-NUMERIC-PHONE REDEFINES WS-WORK-PHONE
   199                                 PIC 9(10).
   200     12  WS-REASON               PIC X(70).
   201
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   7
* EL162.cbl
   203*                            COPY ELCDATE.
   204******************************************************************
   205*                                                                *
   206*                                                                *
   207*                            ELCDATE.                            *
   208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   209*                            VMOD=2.003
   210*                                                                *
   211*                                                                *
   212*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   213*                 LENGTH = 200                                   *
   214******************************************************************
   215
   216 01  DATE-CONVERSION-DATA.
   217     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   218     12  DC-OPTION-CODE                PIC X.
   219         88  BIN-TO-GREG                VALUE ' '.
   220         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   221         88  EDIT-GREG-TO-BIN           VALUE '2'.
   222         88  YMD-GREG-TO-BIN            VALUE '3'.
   223         88  MDY-GREG-TO-BIN            VALUE '4'.
   224         88  JULIAN-TO-BIN              VALUE '5'.
   225         88  BIN-PLUS-ELAPSED           VALUE '6'.
   226         88  FIND-CENTURY               VALUE '7'.
   227         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   228         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   229         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   230         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   231         88  JULIAN-TO-BIN-3            VALUE 'C'.
   232         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   233         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   234         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   235         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   236         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   237         88  CHECK-LEAP-YEAR            VALUE 'H'.
   238         88  BIN-3-TO-GREG              VALUE 'I'.
   239         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   240         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   241         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   242         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   243         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   244         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   245         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   246         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   247         88  THREE-CHARACTER-BIN
   248                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   249         88  GREGORIAN-TO-BIN
   250                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   251         88  BIN-TO-GREGORIAN
   252                  VALUES ' ' '1' 'I' '8' 'G'.
   253         88  JULIAN-TO-BINARY
   254                  VALUES '5' 'C' 'E' 'F'.
   255     12  DC-ERROR-CODE                 PIC X.
   256         88  NO-CONVERSION-ERROR        VALUE ' '.
   257         88  DATE-CONVERSION-ERROR
   258                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   259         88  DATE-IS-ZERO               VALUE '1'.
   260         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   8
* EL162.cbl
   261         88  DATE-IS-INVALID            VALUE '3'.
   262         88  DATE1-GREATER-DATE2        VALUE '4'.
   263         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   264         88  DATE-INVALID-OPTION        VALUE '9'.
   265         88  INVALID-CENTURY            VALUE 'A'.
   266         88  ONLY-CENTURY               VALUE 'B'.
   267         88  ONLY-LEAP-YEAR             VALUE 'C'.
   268         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   269     12  DC-END-OF-MONTH               PIC X.
   270         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   271     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   272         88  USE-NORMAL-PROCESS         VALUE ' '.
   273         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   274         88  ADJUST-UP-100-YRS          VALUE '2'.
   275     12  FILLER                        PIC X.
   276     12  DC-CONVERSION-DATES.
   277         16  DC-BIN-DATE-1             PIC XX.
   278         16  DC-BIN-DATE-2             PIC XX.
   279         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   280         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   281                       DC-GREG-DATE-1-EDIT.
   282             20  DC-EDIT1-MONTH        PIC 99.
   283             20  SLASH1-1              PIC X.
   284             20  DC-EDIT1-DAY          PIC 99.
   285             20  SLASH1-2              PIC X.
   286             20  DC-EDIT1-YEAR         PIC 99.
   287         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   288         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   289                     DC-GREG-DATE-2-EDIT.
   290             20  DC-EDIT2-MONTH        PIC 99.
   291             20  SLASH2-1              PIC X.
   292             20  DC-EDIT2-DAY          PIC 99.
   293             20  SLASH2-2              PIC X.
   294             20  DC-EDIT2-YEAR         PIC 99.
   295         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   296         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   297                     DC-GREG-DATE-1-YMD.
   298             20  DC-YMD-YEAR           PIC 99.
   299             20  DC-YMD-MONTH          PIC 99.
   300             20  DC-YMD-DAY            PIC 99.
   301         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   302         16  DC-GREG-DATE-1-MDY-R REDEFINES
   303                      DC-GREG-DATE-1-MDY.
   304             20  DC-MDY-MONTH          PIC 99.
   305             20  DC-MDY-DAY            PIC 99.
   306             20  DC-MDY-YEAR           PIC 99.
   307         16  DC-GREG-DATE-1-ALPHA.
   308             20  DC-ALPHA-MONTH        PIC X(10).
   309             20  DC-ALPHA-DAY          PIC 99.
   310             20  FILLER                PIC XX.
   311             20  DC-ALPHA-CENTURY.
   312                 24 DC-ALPHA-CEN-N     PIC 99.
   313             20  DC-ALPHA-YEAR         PIC 99.
   314         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   315         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   316         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   317         16  DC-JULIAN-DATE            PIC 9(05).
   318         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page   9
* EL162.cbl
   319                                       PIC 9(05).
   320         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   321             20  DC-JULIAN-YEAR        PIC 99.
   322             20  DC-JULIAN-DAYS        PIC 999.
   323         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   324         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   325         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   326     12  DATE-CONVERSION-VARIBLES.
   327         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   328         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   329             20  FILLER                PIC 9(3).
   330             20  HOLD-CEN-1-CCYY.
   331                 24  HOLD-CEN-1-CC     PIC 99.
   332                 24  HOLD-CEN-1-YY     PIC 99.
   333             20  HOLD-CEN-1-MO         PIC 99.
   334             20  HOLD-CEN-1-DA         PIC 99.
   335         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   336             20  HOLD-CEN-1-R-MO       PIC 99.
   337             20  HOLD-CEN-1-R-DA       PIC 99.
   338             20  HOLD-CEN-1-R-CCYY.
   339                 24  HOLD-CEN-1-R-CC   PIC 99.
   340                 24  HOLD-CEN-1-R-YY   PIC 99.
   341             20  FILLER                PIC 9(3).
   342         16  HOLD-CENTURY-1-X.
   343             20  FILLER                PIC X(3)  VALUE SPACES.
   344             20  HOLD-CEN-1-X-CCYY.
   345                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   346                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   347             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   348             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   349         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   350             20  HOLD-CEN-1-R-X-MO     PIC XX.
   351             20  HOLD-CEN-1-R-X-DA     PIC XX.
   352             20  HOLD-CEN-1-R-X-CCYY.
   353                 24  HOLD-CEN-1-R-X-CC PIC XX.
   354                 24  HOLD-CEN-1-R-X-YY PIC XX.
   355             20  FILLER                PIC XXX.
   356         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   357         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   358         16  DC-JULIAN-DATE-1          PIC 9(07).
   359         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   360             20  DC-JULIAN-1-CCYY.
   361                 24  DC-JULIAN-1-CC    PIC 99.
   362                 24  DC-JULIAN-1-YR    PIC 99.
   363             20  DC-JULIAN-DA-1        PIC 999.
   364         16  DC-JULIAN-DATE-2          PIC 9(07).
   365         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   366             20  DC-JULIAN-2-CCYY.
   367                 24  DC-JULIAN-2-CC    PIC 99.
   368                 24  DC-JULIAN-2-YR    PIC 99.
   369             20  DC-JULIAN-DA-2        PIC 999.
   370         16  DC-GREG-DATE-A-EDIT.
   371             20  DC-EDITA-MONTH        PIC 99.
   372             20  SLASHA-1              PIC X VALUE '/'.
   373             20  DC-EDITA-DAY          PIC 99.
   374             20  SLASHA-2              PIC X VALUE '/'.
   375             20  DC-EDITA-CCYY.
   376                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  10
* EL162.cbl
   377                 24  DC-EDITA-YEAR     PIC 99.
   378         16  DC-GREG-DATE-B-EDIT.
   379             20  DC-EDITB-MONTH        PIC 99.
   380             20  SLASHB-1              PIC X VALUE '/'.
   381             20  DC-EDITB-DAY          PIC 99.
   382             20  SLASHB-2              PIC X VALUE '/'.
   383             20  DC-EDITB-CCYY.
   384                 24  DC-EDITB-CENT     PIC 99.
   385                 24  DC-EDITB-YEAR     PIC 99.
   386         16  DC-GREG-DATE-CYMD         PIC 9(08).
   387         16  DC-GREG-DATE-CYMD-R REDEFINES
   388                              DC-GREG-DATE-CYMD.
   389             20  DC-CYMD-CEN           PIC 99.
   390             20  DC-CYMD-YEAR          PIC 99.
   391             20  DC-CYMD-MONTH         PIC 99.
   392             20  DC-CYMD-DAY           PIC 99.
   393         16  DC-GREG-DATE-MDCY         PIC 9(08).
   394         16  DC-GREG-DATE-MDCY-R REDEFINES
   395                              DC-GREG-DATE-MDCY.
   396             20  DC-MDCY-MONTH         PIC 99.
   397             20  DC-MDCY-DAY           PIC 99.
   398             20  DC-MDCY-CEN           PIC 99.
   399             20  DC-MDCY-YEAR          PIC 99.
   400    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   401        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   402    12  DC-EL310-DATE                  PIC X(21).
   403    12  FILLER                         PIC X(28).
   404
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  11
* EL162.cbl
   406*                            COPY ELCLOGOF.
   407******************************************************************
   408*                                                                *
   409*                                                                *
   410*                            ELCLOGOF.                           *
   411*                            VMOD=2.001                          *
   412*                                                                *
   413*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   414*                                                                *
   415******************************************************************
   416 01  CLASIC-LOGOFF.
   417     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   418     12  LOGOFF-TEXT.
   419         16  FILLER          PIC X(5)    VALUE SPACES.
   420         16  LOGOFF-MSG.
   421             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   422             20  FILLER      PIC X       VALUE SPACES.
   423             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   424         16  FILLER          PIC X(80)
   425           VALUE '* YOU ARE NOW LOGGED OFF'.
   426         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   427         16  FILLER          PIC X       VALUE QUOTE.
   428         16  LOGOFF-SYS-MSG  PIC X(17)
   429           VALUE 'S CLAS-IC SYSTEM '.
   430     12  TEXT-MESSAGES.
   431         16  UNACCESS-MSG    PIC X(29)
   432             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   433         16  PGMIDERR-MSG    PIC X(17)
   434             VALUE 'PROGRAM NOT FOUND'.
   435
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  12
* EL162.cbl
   437*                            COPY ELCATTR.
   438******************************************************************
   439*                                                                *
   440*                            ELCATTR.                            *
   441*                            VMOD=2.001                          *
   442*                                                                *
   443*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   444*                                                                *
   445*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   446*                                                                *
   447*                   POS 1   P=PROTECTED                          *
   448*                           U=UNPROTECTED                        *
   449*                           S=ASKIP                              *
   450*                   POS 2   A=ALPHA/NUMERIC                      *
   451*                           N=NUMERIC                            *
   452*                   POS 3   N=NORMAL                             *
   453*                           B=BRIGHT                             *
   454*                           D=DARK                               *
   455*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   456*                           OF=MODIFIED DATA TAG OFF             *
   457*                                                                *
   458*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   459******************************************************************
   460 01  ATTRIBUTE-LIST.
   461     12  AL-PABOF            PIC X       VALUE 'Y'.
   462     12  AL-PABON            PIC X       VALUE 'Z'.
   463     12  AL-PADOF            PIC X       VALUE '%'.
   464     12  AL-PADON            PIC X       VALUE '_'.
   465     12  AL-PANOF            PIC X       VALUE '-'.
   466     12  AL-PANON            PIC X       VALUE '/'.
   467     12  AL-SABOF            PIC X       VALUE '8'.
   468     12  AL-SABON            PIC X       VALUE '9'.
   469     12  AL-SADOF            PIC X       VALUE '@'.
   470     12  AL-SADON            PIC X       VALUE QUOTE.
   471     12  AL-SANOF            PIC X       VALUE '0'.
   472     12  AL-SANON            PIC X       VALUE '1'.
   473     12  AL-UABOF            PIC X       VALUE 'H'.
   474     12  AL-UABON            PIC X       VALUE 'I'.
   475     12  AL-UADOF            PIC X       VALUE '<'.
   476     12  AL-UADON            PIC X       VALUE '('.
   477     12  AL-UANOF            PIC X       VALUE ' '.
   478     12  AL-UANON            PIC X       VALUE 'A'.
   479     12  AL-UNBOF            PIC X       VALUE 'Q'.
   480     12  AL-UNBON            PIC X       VALUE 'R'.
   481     12  AL-UNDOF            PIC X       VALUE '*'.
   482     12  AL-UNDON            PIC X       VALUE ')'.
   483     12  AL-UNNOF            PIC X       VALUE '&'.
   484     12  AL-UNNON            PIC X       VALUE 'J'.
   485
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  13
* EL162.cbl
   487*                            COPY ELCEMIB.
   488******************************************************************
   489*                                                                *
   490*                                                                *
   491*                            ELCEMIB.                            *
   492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   493*                            VMOD=2.005                          *
   494*                                                                *
   495*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   496*                                                                *
   497******************************************************************
   498 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   499     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   500     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   501     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   502     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   503     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   504     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   505     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   506     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   507     12  EMI-SWITCH1             PIC X        VALUE '1'.
   508         88  EMI-NO-ERRORS                    VALUE '1'.
   509         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   510         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   511     12  EMI-SWITCH2             PIC X        VALUE '1'.
   512         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   513     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   514         88  EMI-AREA1-EMPTY                  VALUE '1'.
   515         88  EMI-AREA1-FULL                   VALUE '2'.
   516     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   517         88  EMI-AREA2-EMPTY                  VALUE '1'.
   518         88  EMI-AREA2-FULL                   VALUE '2'.
   519     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   520         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   521         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   522         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   523         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   524         88  EMI-BYPASS-FATALS                VALUE 'X'.
   525     12  EMI-ERROR-LINES.
   526         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   527         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   528         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   529         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   530             20  EMI-ERR-CODES OCCURS 10 TIMES.
   531                 24  EMI-ERR-NUM         PIC X(4).
   532                 24  EMI-FILLER          PIC X.
   533                 24  EMI-SEV             PIC X.
   534                 24  FILLER              PIC X.
   535             20  FILLER                  PIC X(02).
   536     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   537         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   538             20  EMI-ERROR-NUMBER    PIC X(4).
   539             20  EMI-FILL            PIC X.
   540             20  EMI-SEVERITY        PIC X.
   541             20  FILLER              PIC X.
   542             20  EMI-ERROR-TEXT.
   543                 24  EMI-TEXT-VARIABLE   PIC X(10).
   544                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  14
* EL162.cbl
   545     12  EMI-SEVERITY-SAVE           PIC X.
   546         88  EMI-NOTE                    VALUE 'N'.
   547         88  EMI-WARNING                 VALUE 'W'.
   548         88  EMI-FORCABLE                VALUE 'F'.
   549         88  EMI-FATAL                   VALUE 'X'.
   550     12  EMI-MESSAGE-FLAG            PIC X.
   551         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   552         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   553     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   554     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   555         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   556         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   557         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   558     12  emi-claim-no                pic x(7).
   559     12  emi-claim-type              pic x(6).
   560     12  FILLER                      PIC X(124)  VALUE SPACES.
   561     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   562     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   563     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   564     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  15
* EL162.cbl
   566*                            COPY ELCINTF.
   567******************************************************************
   568*                                                                *
   569*                                                                *
   570*                            ELCINTF.                            *
   571*                            VMOD=2.017                          *
   572*                                                                *
   573*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   574*                                                                *
   575*       LENGTH = 1024                                            *
   576*                                                                *
   577******************************************************************
   578*                   C H A N G E   L O G
   579*
   580* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   581*-----------------------------------------------------------------
   582*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   583* EFFECTIVE    NUMBER
   584*-----------------------------------------------------------------
   585* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   586******************************************************************
   587 01  PROGRAM-INTERFACE-BLOCK.
   588     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   589     12  PI-CALLING-PROGRAM              PIC X(8).
   590     12  PI-SAVED-PROGRAM-1              PIC X(8).
   591     12  PI-SAVED-PROGRAM-2              PIC X(8).
   592     12  PI-SAVED-PROGRAM-3              PIC X(8).
   593     12  PI-SAVED-PROGRAM-4              PIC X(8).
   594     12  PI-SAVED-PROGRAM-5              PIC X(8).
   595     12  PI-SAVED-PROGRAM-6              PIC X(8).
   596     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   597     12  PI-COMPANY-ID                   PIC XXX.
   598     12  PI-COMPANY-CD                   PIC X.
   599
   600     12  PI-COMPANY-PASSWORD             PIC X(8).
   601
   602     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   603
   604     12  PI-CONTROL-IN-PROGRESS.
   605         16  PI-CARRIER                  PIC X.
   606         16  PI-GROUPING                 PIC X(6).
   607         16  PI-STATE                    PIC XX.
   608         16  PI-ACCOUNT                  PIC X(10).
   609         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   610                                         PIC X(10).
   611         16  PI-CLAIM-CERT-GRP.
   612             20  PI-CLAIM-NO             PIC X(7).
   613             20  PI-CERT-NO.
   614                 25  PI-CERT-PRIME       PIC X(10).
   615                 25  PI-CERT-SFX         PIC X.
   616             20  PI-CERT-EFF-DT          PIC XX.
   617         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   618             20  PI-PLAN-CODE            PIC X(2).
   619             20  PI-REVISION-NUMBER      PIC X(3).
   620             20  PI-PLAN-EFF-DT          PIC X(2).
   621             20  PI-PLAN-EXP-DT          PIC X(2).
   622             20  FILLER                  PIC X(11).
   623         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  16
* EL162.cbl
   624             20  PI-OE-REFERENCE-1.
   625                 25  PI-OE-REF-1-PRIME   PIC X(18).
   626                 25  PI-OE-REF-1-SUFF    PIC XX.
   627
   628     12  PI-SESSION-IN-PROGRESS          PIC X.
   629         88  CLAIM-SESSION                   VALUE '1'.
   630         88  CREDIT-SESSION                  VALUE '2'.
   631         88  WARRANTY-SESSION                VALUE '3'.
   632         88  MORTGAGE-SESSION                VALUE '4'.
   633         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   634
   635
   636*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   637
   638     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   639     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   640
   641     12  PI-CREDIT-USER                  PIC X.
   642         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   643         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   644
   645     12  PI-CLAIM-USER                   PIC X.
   646         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   647         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   648
   649     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   650         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   651         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   652         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   653         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   654         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   655
   656     12  PI-PROCESSOR-ID                 PIC X(4).
   657
   658     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   659
   660     12  PI-MEMBER-CAPTION               PIC X(10).
   661
   662     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   663         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   664
   665     12  PI-LIFE-OVERRIDE-L1             PIC X.
   666     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   667     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   668     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   669
   670     12  PI-AH-OVERRIDE-L1               PIC X.
   671     12  PI-AH-OVERRIDE-L2               PIC XX.
   672     12  PI-AH-OVERRIDE-L6               PIC X(6).
   673     12  PI-AH-OVERRIDE-L12              PIC X(12).
   674
   675     12  PI-NEW-SYSTEM                   PIC X(2).
   676
   677     12  PI-PRIMARY-CERT-NO              PIC X(11).
   678     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   679         88  PI-USES-PAID-TO                 VALUE '1'.
   680     12  PI-CRDTCRD-SYSTEM.
   681         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  17
* EL162.cbl
   682             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   683             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   684         16  PI-CC-MONTH-END-DT          PIC XX.
   685     12  PI-PROCESSOR-PRINTER            PIC X(4).
   686
   687     12  PI-OE-REFERENCE-2.
   688         16  PI-OE-REF-2-PRIME           PIC X(10).
   689         16  PI-OE-REF-2-SUFF            PIC X.
   690
   691     12  PI-REM-TRM-CALC-OPTION          PIC X.
   692
   693     12  PI-LANGUAGE-TYPE                PIC X.
   694             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   695             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   696             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   697
   698     12  PI-POLICY-LINKAGE-IND           PIC X.
   699         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   700         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   701                                                   LOW-VALUES.
   702
   703     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   704     12  PI-CLAIM-PW-SESSION             PIC X(1).
   705         88  PI-CLAIM-CREDIT                 VALUE '1'.
   706         88  PI-CLAIM-CONVEN                 VALUE '2'.
   707
   708     12  PI-PROCESSOR-CSR-IND            PIC X.
   709         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   710         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   711
   712     12  FILLER                          PIC X(3).
   713
   714     12  PI-SYSTEM-LEVEL                 PIC X(145).
   715
   716     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   717         PI-SYSTEM-LEVEL.
   718
   719         16  PI-ENTRY-CODES.
   720             20  PI-ENTRY-CD-1           PIC X.
   721             20  PI-ENTRY-CD-2           PIC X.
   722
   723         16  PI-RETURN-CODES.
   724             20  PI-RETURN-CD-1          PIC X.
   725             20  PI-RETURN-CD-2          PIC X.
   726
   727         16  PI-UPDATE-STATUS-SAVE.
   728             20  PI-UPDATE-BY            PIC X(4).
   729             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   730
   731         16  PI-LOWER-CASE-LETTERS       PIC X.
   732             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   733
   734*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   735*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   736*            88  CARRIER-CLM-CNTL            VALUE '2'.
   737
   738         16  PI-CERT-ACCESS-CONTROL      PIC X.
   739             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  18
* EL162.cbl
   740             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   741             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   742             88  ACCNT-CNTL                  VALUE '3'.
   743             88  CARR-ACCNT-CNTL             VALUE '4'.
   744
   745         16  PI-PROCESSOR-CAP-LIST.
   746             20  PI-SYSTEM-CONTROLS.
   747                24 PI-SYSTEM-DISPLAY     PIC X.
   748                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   749                24 PI-SYSTEM-MODIFY      PIC X.
   750                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   751             20  FILLER                  PIC XX.
   752             20  PI-DISPLAY-CAP          PIC X.
   753                 88  DISPLAY-CAP             VALUE 'Y'.
   754             20  PI-MODIFY-CAP           PIC X.
   755                 88  MODIFY-CAP              VALUE 'Y'.
   756             20  PI-MSG-AT-LOGON-CAP     PIC X.
   757                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   758             20  PI-FORCE-CAP            PIC X.
   759                 88  FORCE-CAP               VALUE 'Y'.
   760
   761         16  PI-PROGRAM-CONTROLS.
   762             20  PI-PGM-PRINT-OPT        PIC X.
   763             20  PI-PGM-FORMAT-OPT       PIC X.
   764             20  PI-PGM-PROCESS-OPT      PIC X.
   765             20  PI-PGM-TOTALS-OPT       PIC X.
   766
   767         16  PI-HELP-INTERFACE.
   768             20  PI-LAST-ERROR-NO        PIC X(4).
   769             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   770
   771         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   772             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   773
   774         16  PI-CR-CONTROL-IN-PROGRESS.
   775             20  PI-CR-CARRIER           PIC X.
   776             20  PI-CR-GROUPING          PIC X(6).
   777             20  PI-CR-STATE             PIC XX.
   778             20  PI-CR-ACCOUNT           PIC X(10).
   779             20  PI-CR-FIN-RESP          PIC X(10).
   780             20  PI-CR-TYPE              PIC X.
   781
   782         16  PI-CR-BATCH-NUMBER          PIC X(6).
   783
   784         16  PI-CR-MONTH-END-DT          PIC XX.
   785
   786         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   787             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   788             88  PI-ZERO-CARRIER             VALUE '1'.
   789             88  PI-ZERO-GROUPING            VALUE '2'.
   790             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   791
   792         16  PI-CARRIER-SECURITY         PIC X.
   793             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   794
   795         16  PI-ACCOUNT-SECURITY         PIC X(10).
   796             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   797             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  19
* EL162.cbl
   798
   799         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   800             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   801                                         INDEXED BY PI-ACCESS-NDX
   802                                         PIC X.
   803
   804         16  PI-GA-BILLING-CONTROL       PIC X.
   805             88  PI-GA-BILLING               VALUE '1'.
   806
   807         16  PI-MAIL-PROCESSING          PIC X.
   808             88  PI-MAIL-YES                 VALUE 'Y'.
   809
   810         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   811
   812         16  PI-AR-SYSTEM.
   813             20  PI-AR-PROCESSING-CNTL   PIC X.
   814                 88  PI-AR-PROCESSING        VALUE 'Y'.
   815             20  PI-AR-SUMMARY-CODE      PIC X(6).
   816             20  PI-AR-MONTH-END-DT      PIC XX.
   817
   818         16  PI-MP-SYSTEM.
   819             20  PI-MORTGAGE-USER            PIC X.
   820                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   821                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   822             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   823                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   824                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   825                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   826                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   827                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   828             20  PI-MP-MONTH-END-DT          PIC XX.
   829             20  PI-MP-REFERENCE-NO.
   830                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   831                 24  PI-MP-REFERENCE-SFX     PIC XX.
   832
   833         16  PI-LABEL-CONTROL            PIC X(01).
   834             88  PI-CREATE-LABELS                    VALUE 'Y'.
   835             88  PI-BYPASS-LABELS                    VALUE 'N'.
   836
   837         16  PI-BILL-GROUPING-CODE       PIC X(01).
   838             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   839
   840         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   841             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   842             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   843
   844         16  FILLER                      PIC X(14).
   845
   846     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   847******************************************************************
   848     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   849         16  PI-NEXT-TRLR-SUB    PIC S999  COMP-3.
   850         16  PI-ACTV-SAVE        PIC X(20).
   851         16  PI-ACTV-SAVE-SEQ    PIC S9(04) COMP.
   852         16  PI-ACTV-KEY.
   853           18  PI-ACTV-PARTIAL.
   854             20  PI-ACTV-COMP-CD     PIC X.
   855             20  PI-ACTV-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  20
* EL162.cbl
   856             20  PI-ACTV-CLAIM       PIC X(7).
   857             20  PI-ACTV-CERT-NO.
   858                 22  PI-ACTV-CERT-NO-PRIME PIC X(10).
   859                 22  PI-ACTV-CERT-NO-SUFX  PIC X.
   860           18  PI-ACTV-SEQ           PIC S9(4) COMP.
   861
   862         16  PI-DISPLAYED-TRAILER-CODES.
   863             18  PI-TRLRS OCCURS 50 TIMES    PIC S9(4) COMP.
   864         16  PI-CLAM-KEY.
   865             20  PI-CLAM-COMP-CD     PIC X.
   866             20  PI-CLAM-CARRIER     PIC X.
   867             20  PI-CLAM-CLAIM       PIC X(7).
   868             20  PI-CLAM-CERT-NO.
   869                 24  PI-CLAM-CERT-NO-PRIME  PIC X(10).
   870                 24  PI-CLAM-CERT-NO-SUFX   PIC X.
   871         16  PI-DMD-FORCE-ERROR      PIC X.
   872             88  PI-DMD-FORCED             VALUE 'X'.
   873         16  FILLER                  PIC X(473).
   874
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  21
* EL162.cbl
   876*                            COPY ELCAID.
   877******************************************************************
   878*                                                                *
   879*                            ELCAID.                             *
   880*                            VMOD=2.001                          *
   881*                                                                *
   882*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   883*                                                                *
   884*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   885*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   886******************************************************************
   887
   888 01  DFHAID.
   889   02  DFHNULL   PIC  X  VALUE  ' '.
   890   02  DFHENTER  PIC  X  VALUE  QUOTE.
   891   02  DFHCLEAR  PIC  X  VALUE  '_'.
   892   02  DFHPEN    PIC  X  VALUE  '='.
   893   02  DFHOPID   PIC  X  VALUE  'W'.
   894   02  DFHPA1    PIC  X  VALUE  '%'.
   895   02  DFHPA2    PIC  X  VALUE  '>'.
   896   02  DFHPA3    PIC  X  VALUE  ','.
   897   02  DFHPF1    PIC  X  VALUE  '1'.
   898   02  DFHPF2    PIC  X  VALUE  '2'.
   899   02  DFHPF3    PIC  X  VALUE  '3'.
   900   02  DFHPF4    PIC  X  VALUE  '4'.
   901   02  DFHPF5    PIC  X  VALUE  '5'.
   902   02  DFHPF6    PIC  X  VALUE  '6'.
   903   02  DFHPF7    PIC  X  VALUE  '7'.
   904   02  DFHPF8    PIC  X  VALUE  '8'.
   905   02  DFHPF9    PIC  X  VALUE  '9'.
   906   02  DFHPF10   PIC  X  VALUE  ':'.
   907   02  DFHPF11   PIC  X  VALUE  '#'.
   908   02  DFHPF12   PIC  X  VALUE  '@'.
   909   02  DFHPF13   PIC  X  VALUE  'A'.
   910   02  DFHPF14   PIC  X  VALUE  'B'.
   911   02  DFHPF15   PIC  X  VALUE  'C'.
   912   02  DFHPF16   PIC  X  VALUE  'D'.
   913   02  DFHPF17   PIC  X  VALUE  'E'.
   914   02  DFHPF18   PIC  X  VALUE  'F'.
   915   02  DFHPF19   PIC  X  VALUE  'G'.
   916   02  DFHPF20   PIC  X  VALUE  'H'.
   917   02  DFHPF21   PIC  X  VALUE  'I'.
   918*00039    02  DFHPF22   PIC  X  VALUE  ''.
   919   02  DFHPF22   PIC  X  VALUE  '['.
   920   02  DFHPF23   PIC  X  VALUE  '.'.
   921   02  DFHPF24   PIC  X  VALUE  '<'.
   922   02  DFHMSRE   PIC  X  VALUE  'X'.
   923   02  DFHSTRF   PIC  X  VALUE  'h'.
   924   02  DFHTRIG   PIC  X  VALUE  '"'.
   925 01  FILLER    REDEFINES DFHAID.
   926     12  FILLER              PIC X(8).
   927     12  PF-VALUES           PIC X       OCCURS 2.
   928
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  22
* EL162.cbl
   930*                            COPY EL162S.
   931 01  EL162AI.
   932     05  FILLER            PIC  X(0012).
   933*    -------------------------------
   934     05  RUNDTEL PIC S9(0004) COMP.
   935     05  RUNDTEF PIC  X(0001).
   936     05  FILLER REDEFINES RUNDTEF.
   937         10  RUNDTEA PIC  X(0001).
   938     05  RUNDTEI PIC  X(0008).
   939*    -------------------------------
   940     05  RUNTIMEL PIC S9(0004) COMP.
   941     05  RUNTIMEF PIC  X(0001).
   942     05  FILLER REDEFINES RUNTIMEF.
   943         10  RUNTIMEA PIC  X(0001).
   944     05  RUNTIMEI PIC  X(0005).
   945*    -------------------------------
   946     05  CLAIMNOL PIC S9(0004) COMP.
   947     05  CLAIMNOF PIC  X(0001).
   948     05  FILLER REDEFINES CLAIMNOF.
   949         10  CLAIMNOA PIC  X(0001).
   950     05  CLAIMNOI PIC  X(0007).
   951*    -------------------------------
   952     05  TYPEL PIC S9(0004) COMP.
   953     05  TYPEF PIC  X(0001).
   954     05  FILLER REDEFINES TYPEF.
   955         10  TYPEA PIC  X(0001).
   956     05  TYPEI PIC  X(0006).
   957*    -------------------------------
   958     05  CARRL PIC S9(0004) COMP.
   959     05  CARRF PIC  X(0001).
   960     05  FILLER REDEFINES CARRF.
   961         10  CARRA PIC  X(0001).
   962     05  CARRI PIC  X(0001).
   963*    -------------------------------
   964     05  CERTNOL PIC S9(0004) COMP.
   965     05  CERTNOF PIC  X(0001).
   966     05  FILLER REDEFINES CERTNOF.
   967         10  CERTNOA PIC  X(0001).
   968     05  CERTNOI PIC  X(0011).
   969*    -------------------------------
   970     05  LASTNMEL PIC S9(0004) COMP.
   971     05  LASTNMEF PIC  X(0001).
   972     05  FILLER REDEFINES LASTNMEF.
   973         10  LASTNMEA PIC  X(0001).
   974     05  LASTNMEI PIC  X(0015).
   975*    -------------------------------
   976     05  FILEL PIC S9(0004) COMP.
   977     05  FILEF PIC  X(0001).
   978     05  FILLER REDEFINES FILEF.
   979         10  FILEA PIC  X(0001).
   980     05  FILEI PIC  X(0004).
   981*    -------------------------------
   982     05  RECDTE1L PIC S9(0004) COMP.
   983     05  RECDTE1F PIC  X(0001).
   984     05  FILLER REDEFINES RECDTE1F.
   985         10  RECDTE1A PIC  X(0001).
   986     05  RECDTE1I PIC  X(0008).
   987*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  23
* EL162.cbl
   988     05  STOPDT1L PIC S9(0004) COMP.
   989     05  STOPDT1F PIC  X(0001).
   990     05  FILLER REDEFINES STOPDT1F.
   991         10  STOPDT1A PIC  X(0001).
   992     05  STOPDT1I PIC  X(0008).
   993*    -------------------------------
   994     05  SENT1L PIC S9(0004) COMP.
   995     05  SENT1F PIC  X(0001).
   996     05  FILLER REDEFINES SENT1F.
   997         10  SENT1A PIC  X(0001).
   998     05  SENT1I PIC  X(0008).
   999*    -------------------------------
  1000     05  BY1L PIC S9(0004) COMP.
  1001     05  BY1F PIC  X(0001).
  1002     05  FILLER REDEFINES BY1F.
  1003         10  BY1A PIC  X(0001).
  1004     05  BY1I PIC  X(0004).
  1005*    -------------------------------
  1006     05  RESEND1L PIC S9(0004) COMP.
  1007     05  RESEND1F PIC  X(0001).
  1008     05  FILLER REDEFINES RESEND1F.
  1009         10  RESEND1A PIC  X(0001).
  1010     05  RESEND1I PIC  X(0008).
  1011*    -------------------------------
  1012     05  FOLLOW1L PIC S9(0004) COMP.
  1013     05  FOLLOW1F PIC  X(0001).
  1014     05  FILLER REDEFINES FOLLOW1F.
  1015         10  FOLLOW1A PIC  X(0001).
  1016     05  FOLLOW1I PIC  X(0008).
  1017*    -------------------------------
  1018     05  FORM1L PIC S9(0004) COMP.
  1019     05  FORM1F PIC  X(0001).
  1020     05  FILLER REDEFINES FORM1F.
  1021         10  FORM1A PIC  X(0001).
  1022     05  FORM1I PIC  X(0004).
  1023*    -------------------------------
  1024     05  TO1L PIC S9(0004) COMP.
  1025     05  TO1F PIC  X(0001).
  1026     05  FILLER REDEFINES TO1F.
  1027         10  TO1A PIC  X(0001).
  1028     05  TO1I PIC  X(0008).
  1029*    -------------------------------
  1030     05  ARCH1L PIC S9(0004) COMP.
  1031     05  ARCH1F PIC  X(0001).
  1032     05  FILLER REDEFINES ARCH1F.
  1033         10  ARCH1A PIC  X(0001).
  1034     05  ARCH1I PIC  X(0008).
  1035*    -------------------------------
  1036     05  TRLR1L PIC S9(0004) COMP.
  1037     05  TRLR1F PIC  X(0001).
  1038     05  FILLER REDEFINES TRLR1F.
  1039         10  TRLR1A PIC  X(0001).
  1040     05  TRLR1I PIC  X(0004).
  1041*    -------------------------------
  1042     05  TYPE1L PIC S9(0004) COMP.
  1043     05  TYPE1F PIC  X(0001).
  1044     05  FILLER REDEFINES TYPE1F.
  1045         10  TYPE1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  24
* EL162.cbl
  1046     05  TYPE1I PIC  X(0001).
  1047*    -------------------------------
  1048     05  RE1L PIC S9(0004) COMP.
  1049     05  RE1F PIC  X(0001).
  1050     05  FILLER REDEFINES RE1F.
  1051         10  RE1A PIC  X(0001).
  1052     05  RE1I PIC  X(0070).
  1053*    -------------------------------
  1054     05  RECDTE2L PIC S9(0004) COMP.
  1055     05  RECDTE2F PIC  X(0001).
  1056     05  FILLER REDEFINES RECDTE2F.
  1057         10  RECDTE2A PIC  X(0001).
  1058     05  RECDTE2I PIC  X(0008).
  1059*    -------------------------------
  1060     05  STOPDT2L PIC S9(0004) COMP.
  1061     05  STOPDT2F PIC  X(0001).
  1062     05  FILLER REDEFINES STOPDT2F.
  1063         10  STOPDT2A PIC  X(0001).
  1064     05  STOPDT2I PIC  X(0008).
  1065*    -------------------------------
  1066     05  SENT2L PIC S9(0004) COMP.
  1067     05  SENT2F PIC  X(0001).
  1068     05  FILLER REDEFINES SENT2F.
  1069         10  SENT2A PIC  X(0001).
  1070     05  SENT2I PIC  X(0008).
  1071*    -------------------------------
  1072     05  BY2L PIC S9(0004) COMP.
  1073     05  BY2F PIC  X(0001).
  1074     05  FILLER REDEFINES BY2F.
  1075         10  BY2A PIC  X(0001).
  1076     05  BY2I PIC  X(0004).
  1077*    -------------------------------
  1078     05  RESEND2L PIC S9(0004) COMP.
  1079     05  RESEND2F PIC  X(0001).
  1080     05  FILLER REDEFINES RESEND2F.
  1081         10  RESEND2A PIC  X(0001).
  1082     05  RESEND2I PIC  X(0008).
  1083*    -------------------------------
  1084     05  FOLLOW2L PIC S9(0004) COMP.
  1085     05  FOLLOW2F PIC  X(0001).
  1086     05  FILLER REDEFINES FOLLOW2F.
  1087         10  FOLLOW2A PIC  X(0001).
  1088     05  FOLLOW2I PIC  X(0008).
  1089*    -------------------------------
  1090     05  FORM2L PIC S9(0004) COMP.
  1091     05  FORM2F PIC  X(0001).
  1092     05  FILLER REDEFINES FORM2F.
  1093         10  FORM2A PIC  X(0001).
  1094     05  FORM2I PIC  X(0004).
  1095*    -------------------------------
  1096     05  TO2L PIC S9(0004) COMP.
  1097     05  TO2F PIC  X(0001).
  1098     05  FILLER REDEFINES TO2F.
  1099         10  TO2A PIC  X(0001).
  1100     05  TO2I PIC  X(0008).
  1101*    -------------------------------
  1102     05  ARCH2L PIC S9(0004) COMP.
  1103     05  ARCH2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  25
* EL162.cbl
  1104     05  FILLER REDEFINES ARCH2F.
  1105         10  ARCH2A PIC  X(0001).
  1106     05  ARCH2I PIC  X(0008).
  1107*    -------------------------------
  1108     05  TRLR2L PIC S9(0004) COMP.
  1109     05  TRLR2F PIC  X(0001).
  1110     05  FILLER REDEFINES TRLR2F.
  1111         10  TRLR2A PIC  X(0001).
  1112     05  TRLR2I PIC  X(0004).
  1113*    -------------------------------
  1114     05  TYPE2L PIC S9(0004) COMP.
  1115     05  TYPE2F PIC  X(0001).
  1116     05  FILLER REDEFINES TYPE2F.
  1117         10  TYPE2A PIC  X(0001).
  1118     05  TYPE2I PIC  X(0001).
  1119*    -------------------------------
  1120     05  RE2L PIC S9(0004) COMP.
  1121     05  RE2F PIC  X(0001).
  1122     05  FILLER REDEFINES RE2F.
  1123         10  RE2A PIC  X(0001).
  1124     05  RE2I PIC  X(0070).
  1125*    -------------------------------
  1126     05  RECDTE3L PIC S9(0004) COMP.
  1127     05  RECDTE3F PIC  X(0001).
  1128     05  FILLER REDEFINES RECDTE3F.
  1129         10  RECDTE3A PIC  X(0001).
  1130     05  RECDTE3I PIC  X(0008).
  1131*    -------------------------------
  1132     05  STOPDT3L PIC S9(0004) COMP.
  1133     05  STOPDT3F PIC  X(0001).
  1134     05  FILLER REDEFINES STOPDT3F.
  1135         10  STOPDT3A PIC  X(0001).
  1136     05  STOPDT3I PIC  X(0008).
  1137*    -------------------------------
  1138     05  SENT3L PIC S9(0004) COMP.
  1139     05  SENT3F PIC  X(0001).
  1140     05  FILLER REDEFINES SENT3F.
  1141         10  SENT3A PIC  X(0001).
  1142     05  SENT3I PIC  X(0008).
  1143*    -------------------------------
  1144     05  BY3L PIC S9(0004) COMP.
  1145     05  BY3F PIC  X(0001).
  1146     05  FILLER REDEFINES BY3F.
  1147         10  BY3A PIC  X(0001).
  1148     05  BY3I PIC  X(0004).
  1149*    -------------------------------
  1150     05  RESEND3L PIC S9(0004) COMP.
  1151     05  RESEND3F PIC  X(0001).
  1152     05  FILLER REDEFINES RESEND3F.
  1153         10  RESEND3A PIC  X(0001).
  1154     05  RESEND3I PIC  X(0008).
  1155*    -------------------------------
  1156     05  FOLLOW3L PIC S9(0004) COMP.
  1157     05  FOLLOW3F PIC  X(0001).
  1158     05  FILLER REDEFINES FOLLOW3F.
  1159         10  FOLLOW3A PIC  X(0001).
  1160     05  FOLLOW3I PIC  X(0008).
  1161*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  26
* EL162.cbl
  1162     05  FORM3L PIC S9(0004) COMP.
  1163     05  FORM3F PIC  X(0001).
  1164     05  FILLER REDEFINES FORM3F.
  1165         10  FORM3A PIC  X(0001).
  1166     05  FORM3I PIC  X(0004).
  1167*    -------------------------------
  1168     05  TO3L PIC S9(0004) COMP.
  1169     05  TO3F PIC  X(0001).
  1170     05  FILLER REDEFINES TO3F.
  1171         10  TO3A PIC  X(0001).
  1172     05  TO3I PIC  X(0008).
  1173*    -------------------------------
  1174     05  ARCH3L PIC S9(0004) COMP.
  1175     05  ARCH3F PIC  X(0001).
  1176     05  FILLER REDEFINES ARCH3F.
  1177         10  ARCH3A PIC  X(0001).
  1178     05  ARCH3I PIC  X(0008).
  1179*    -------------------------------
  1180     05  TRLR3L PIC S9(0004) COMP.
  1181     05  TRLR3F PIC  X(0001).
  1182     05  FILLER REDEFINES TRLR3F.
  1183         10  TRLR3A PIC  X(0001).
  1184     05  TRLR3I PIC  X(0004).
  1185*    -------------------------------
  1186     05  TYPE3L PIC S9(0004) COMP.
  1187     05  TYPE3F PIC  X(0001).
  1188     05  FILLER REDEFINES TYPE3F.
  1189         10  TYPE3A PIC  X(0001).
  1190     05  TYPE3I PIC  X(0001).
  1191*    -------------------------------
  1192     05  RE3L PIC S9(0004) COMP.
  1193     05  RE3F PIC  X(0001).
  1194     05  FILLER REDEFINES RE3F.
  1195         10  RE3A PIC  X(0001).
  1196     05  RE3I PIC  X(0070).
  1197*    -------------------------------
  1198     05  RECDTE4L PIC S9(0004) COMP.
  1199     05  RECDTE4F PIC  X(0001).
  1200     05  FILLER REDEFINES RECDTE4F.
  1201         10  RECDTE4A PIC  X(0001).
  1202     05  RECDTE4I PIC  X(0008).
  1203*    -------------------------------
  1204     05  STOPDT4L PIC S9(0004) COMP.
  1205     05  STOPDT4F PIC  X(0001).
  1206     05  FILLER REDEFINES STOPDT4F.
  1207         10  STOPDT4A PIC  X(0001).
  1208     05  STOPDT4I PIC  X(0008).
  1209*    -------------------------------
  1210     05  SENT4L PIC S9(0004) COMP.
  1211     05  SENT4F PIC  X(0001).
  1212     05  FILLER REDEFINES SENT4F.
  1213         10  SENT4A PIC  X(0001).
  1214     05  SENT4I PIC  X(0008).
  1215*    -------------------------------
  1216     05  BY4L PIC S9(0004) COMP.
  1217     05  BY4F PIC  X(0001).
  1218     05  FILLER REDEFINES BY4F.
  1219         10  BY4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  27
* EL162.cbl
  1220     05  BY4I PIC  X(0004).
  1221*    -------------------------------
  1222     05  RESEND4L PIC S9(0004) COMP.
  1223     05  RESEND4F PIC  X(0001).
  1224     05  FILLER REDEFINES RESEND4F.
  1225         10  RESEND4A PIC  X(0001).
  1226     05  RESEND4I PIC  X(0008).
  1227*    -------------------------------
  1228     05  FOLLOW4L PIC S9(0004) COMP.
  1229     05  FOLLOW4F PIC  X(0001).
  1230     05  FILLER REDEFINES FOLLOW4F.
  1231         10  FOLLOW4A PIC  X(0001).
  1232     05  FOLLOW4I PIC  X(0008).
  1233*    -------------------------------
  1234     05  FORM4L PIC S9(0004) COMP.
  1235     05  FORM4F PIC  X(0001).
  1236     05  FILLER REDEFINES FORM4F.
  1237         10  FORM4A PIC  X(0001).
  1238     05  FORM4I PIC  X(0004).
  1239*    -------------------------------
  1240     05  TO4L PIC S9(0004) COMP.
  1241     05  TO4F PIC  X(0001).
  1242     05  FILLER REDEFINES TO4F.
  1243         10  TO4A PIC  X(0001).
  1244     05  TO4I PIC  X(0008).
  1245*    -------------------------------
  1246     05  ARCH4L PIC S9(0004) COMP.
  1247     05  ARCH4F PIC  X(0001).
  1248     05  FILLER REDEFINES ARCH4F.
  1249         10  ARCH4A PIC  X(0001).
  1250     05  ARCH4I PIC  X(0008).
  1251*    -------------------------------
  1252     05  TRLR4L PIC S9(0004) COMP.
  1253     05  TRLR4F PIC  X(0001).
  1254     05  FILLER REDEFINES TRLR4F.
  1255         10  TRLR4A PIC  X(0001).
  1256     05  TRLR4I PIC  X(0004).
  1257*    -------------------------------
  1258     05  TYPE4L PIC S9(0004) COMP.
  1259     05  TYPE4F PIC  X(0001).
  1260     05  FILLER REDEFINES TYPE4F.
  1261         10  TYPE4A PIC  X(0001).
  1262     05  TYPE4I PIC  X(0001).
  1263*    -------------------------------
  1264     05  RE4L PIC S9(0004) COMP.
  1265     05  RE4F PIC  X(0001).
  1266     05  FILLER REDEFINES RE4F.
  1267         10  RE4A PIC  X(0001).
  1268     05  RE4I PIC  X(0070).
  1269*    -------------------------------
  1270     05  URECDTEL PIC S9(0004) COMP.
  1271     05  URECDTEF PIC  X(0001).
  1272     05  FILLER REDEFINES URECDTEF.
  1273         10  URECDTEA PIC  X(0001).
  1274     05  URECDTEI PIC  X(0008).
  1275*    -------------------------------
  1276     05  USENTL PIC S9(0004) COMP.
  1277     05  USENTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  28
* EL162.cbl
  1278     05  FILLER REDEFINES USENTF.
  1279         10  USENTA PIC  X(0001).
  1280     05  USENTI PIC  X(0008).
  1281*    -------------------------------
  1282     05  UBYL PIC S9(0004) COMP.
  1283     05  UBYF PIC  X(0001).
  1284     05  FILLER REDEFINES UBYF.
  1285         10  UBYA PIC  X(0001).
  1286     05  UBYI PIC  X(0004).
  1287*    -------------------------------
  1288     05  UFORML PIC S9(0004) COMP.
  1289     05  UFORMF PIC  X(0001).
  1290     05  FILLER REDEFINES UFORMF.
  1291         10  UFORMA PIC  X(0001).
  1292     05  UFORMI PIC  X(0004).
  1293*    -------------------------------
  1294     05  AUTHRCVL PIC S9(0004) COMP.
  1295     05  AUTHRCVF PIC  X(0001).
  1296     05  FILLER REDEFINES AUTHRCVF.
  1297         10  AUTHRCVA PIC  X(0001).
  1298     05  AUTHRCVI PIC  X(0001).
  1299*    -------------------------------
  1300     05  UREL PIC S9(0004) COMP.
  1301     05  UREF PIC  X(0001).
  1302     05  FILLER REDEFINES UREF.
  1303         10  UREA PIC  X(0001).
  1304     05  UREI PIC  X(0070).
  1305*    -------------------------------
  1306     05  ADDR1L PIC S9(0004) COMP.
  1307     05  ADDR1F PIC  X(0001).
  1308     05  FILLER REDEFINES ADDR1F.
  1309         10  ADDR1A PIC  X(0001).
  1310     05  ADDR1I PIC  X(0030).
  1311*    -------------------------------
  1312     05  ADDR2L PIC S9(0004) COMP.
  1313     05  ADDR2F PIC  X(0001).
  1314     05  FILLER REDEFINES ADDR2F.
  1315         10  ADDR2A PIC  X(0001).
  1316     05  ADDR2I PIC  X(0030).
  1317*    -------------------------------
  1318     05  ADDR3L PIC S9(0004) COMP.
  1319     05  ADDR3F PIC  X(0001).
  1320     05  FILLER REDEFINES ADDR3F.
  1321         10  ADDR3A PIC  X(0001).
  1322     05  ADDR3I PIC  X(0030).
  1323*    -------------------------------
  1324     05  ADDR4L PIC S9(0004) COMP.
  1325     05  ADDR4F PIC  X(0001).
  1326     05  FILLER REDEFINES ADDR4F.
  1327         10  ADDR4A PIC  X(0001).
  1328     05  ADDR4I PIC  X(0030).
  1329*    -------------------------------
  1330     05  ZIPL PIC S9(0004) COMP.
  1331     05  ZIPF PIC  X(0001).
  1332     05  FILLER REDEFINES ZIPF.
  1333         10  ZIPA PIC  X(0001).
  1334     05  ZIPI PIC  X(0010).
  1335*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  29
* EL162.cbl
  1336     05  PHONEL PIC S9(0004) COMP.
  1337     05  PHONEF PIC  X(0001).
  1338     05  FILLER REDEFINES PHONEF.
  1339         10  PHONEA PIC  X(0001).
  1340     05  PHONEI PIC  X(0012).
  1341*    -------------------------------
  1342     05  TRLRL PIC S9(0004) COMP.
  1343     05  TRLRF PIC  X(0001).
  1344     05  FILLER REDEFINES TRLRF.
  1345         10  TRLRA PIC  X(0001).
  1346     05  TRLRI PIC  X(0004).
  1347*    -------------------------------
  1348     05  ERRMSG1L PIC S9(0004) COMP.
  1349     05  ERRMSG1F PIC  X(0001).
  1350     05  FILLER REDEFINES ERRMSG1F.
  1351         10  ERRMSG1A PIC  X(0001).
  1352     05  ERRMSG1I PIC  X(0072).
  1353*    -------------------------------
  1354     05  ENTERPFL PIC S9(0004) COMP.
  1355     05  ENTERPFF PIC  X(0001).
  1356     05  FILLER REDEFINES ENTERPFF.
  1357         10  ENTERPFA PIC  X(0001).
  1358     05  ENTERPFI PIC  99.
  1359*    -------------------------------
  1360     05  PF4KEYL PIC S9(0004) COMP.
  1361     05  PF4KEYF PIC  X(0001).
  1362     05  FILLER REDEFINES PF4KEYF.
  1363         10  PF4KEYA PIC  X(0001).
  1364     05  PF4KEYI PIC  X(0015).
  1365*    -------------------------------
  1366     05  PF5KEYL PIC S9(0004) COMP.
  1367     05  PF5KEYF PIC  X(0001).
  1368     05  FILLER REDEFINES PF5KEYF.
  1369         10  PF5KEYA PIC  X(0001).
  1370     05  PF5KEYI PIC  X(0014).
  1371 01  EL162AO REDEFINES EL162AI.
  1372     05  FILLER            PIC  X(0012).
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(0003).
  1375     05  RUNDTEO PIC  X(0008).
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  RUNTIMEO PIC  99.99.
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  CLAIMNOO PIC  X(0007).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  TYPEO PIC  X(0006).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  CARRO PIC  X(0001).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  CERTNOO PIC  X(0011).
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  LASTNMEO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  30
* EL162.cbl
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  FILEO PIC  X(0004).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  RECDTE1O PIC  X(0008).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  STOPDT1O PIC  X(0008).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  SENT1O PIC  X(0008).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  BY1O PIC  X(0004).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  RESEND1O PIC  X(0008).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  FOLLOW1O PIC  X(0008).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  FORM1O PIC  X(0004).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  TO1O PIC  X(0008).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  ARCH1O PIC  X(0008).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  TRLR1O PIC  9999.
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  TYPE1O PIC  X(0001).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  RE1O PIC  X(0070).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  RECDTE2O PIC  X(0008).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  STOPDT2O PIC  X(0008).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  SENT2O PIC  X(0008).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  BY2O PIC  X(0004).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  RESEND2O PIC  X(0008).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  FOLLOW2O PIC  X(0008).
  1451*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  31
* EL162.cbl
  1452     05  FILLER            PIC  X(0003).
  1453     05  FORM2O PIC  X(0004).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  TO2O PIC  X(0008).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  ARCH2O PIC  X(0008).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  TRLR2O PIC  9999.
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  TYPE2O PIC  X(0001).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  RE2O PIC  X(0070).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  RECDTE3O PIC  X(0008).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  STOPDT3O PIC  X(0008).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  SENT3O PIC  X(0008).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  BY3O PIC  X(0004).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  RESEND3O PIC  X(0008).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  FOLLOW3O PIC  X(0008).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  FORM3O PIC  X(0004).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  TO3O PIC  X(0008).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  ARCH3O PIC  X(0008).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  TRLR3O PIC  9999.
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  TYPE3O PIC  X(0001).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  RE3O PIC  X(0070).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  RECDTE4O PIC  X(0008).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  32
* EL162.cbl
  1510     05  STOPDT4O PIC  X(0008).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  SENT4O PIC  X(0008).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  BY4O PIC  X(0004).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  RESEND4O PIC  X(0008).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  FOLLOW4O PIC  X(0008).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  FORM4O PIC  X(0004).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  TO4O PIC  X(0008).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  ARCH4O PIC  X(0008).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  TRLR4O PIC  9999.
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  TYPE4O PIC  X(0001).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  RE4O PIC  X(0070).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  URECDTEO PIC  99B99B99.
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  USENTO PIC  99B99B99.
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  UBYO PIC  X(0004).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  UFORMO PIC  X(0004).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  AUTHRCVO PIC  X(0001).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  UREO PIC  X(0070).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  ADDR1O PIC  X(0030).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  ADDR2O PIC  X(0030).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  ADDR3O PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  33
* EL162.cbl
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  ADDR4O PIC  X(0030).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  ZIPO PIC  X(0010).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  PHONEO PIC  999B999B9999.
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  TRLRO PIC  9999.
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  ERRMSG1O PIC  X(0072).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  ENTERPFO PIC  X(0002).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  PF4KEYO PIC  X(0015).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  PF5KEYO PIC  X(0014).
  1592*    -------------------------------
  1593
  1594 01  MAP-REDEF REDEFINES EL162AI.
  1595     12  FILLER              PIC X(93).
  1596     12  TRL-LINES.
  1597       14  TRAILER-LINES  OCCURS 4 TIMES INDEXED BY SC-INDX.
  1598         16  SC-RECL         PIC S9(4)  COMP.
  1599         16  SC-RECA         PIC X.
  1600         16  SC-REC          PIC X(8).
  1601         16  SC-REC-O REDEFINES SC-REC PIC 99B99B99.
  1602         16  SC-STOPL        PIC S9(4)  COMP.
  1603         16  SC-STOPA        PIC X.
  1604         16  SC-STOP         PIC X(8).
  1605         16  SC-STOP-O REDEFINES SC-STOP PIC 99B99B99.
  1606         16  FILLER          PIC X(3).
  1607         16  SC-SENT         PIC X(8).
  1608         16  FILLER          PIC X(3).
  1609         16  SC-BY           PIC X(4).
  1610         16  FILLER          PIC X(3).
  1611         16  SC-RESEND       PIC X(8).
  1612         16  FILLER          PIC X(3).
  1613         16  SC-FOLLOWUP     PIC X(8).
  1614         16  FILLER          PIC X(3).
  1615         16  SC-FORM         PIC X(4).
  1616         16  FILLER          PIC X(3).
  1617         16  SC-TO           PIC X(8).
  1618         16  FILLER          PIC X(3).
  1619         16  SC-ARCHIVE      PIC X(8).
  1620         16  FILLER          PIC X(3).
  1621         16  SC-TRLRNO       PIC 9(4).
  1622         16  FILLER          PIC X(3).
  1623         16  SC-TYPE         PIC X.
  1624         16  FILLER          PIC X(3).
  1625         16  SC-REASON       PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  34
* EL162.cbl
  1626
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  35
* EL162.cbl
  1628****************************************************************
  1629*
  1630* Copyright (c) 2007-2013 Dell Inc.
  1631* All rights reserved.
  1632*
  1633****************************************************************
  1634 01  DFHEIV.
  1635   02  DFHEIV0               PIC X(35).
  1636   02  DFHEIV1               PIC X(08).
  1637   02  DFHEIV2               PIC X(08).
  1638   02  DFHEIV3               PIC X(08).
  1639   02  DFHEIV4               PIC X(06).
  1640   02  DFHEIV5               PIC X(04).
  1641   02  DFHEIV6               PIC X(04).
  1642   02  DFHEIV7               PIC X(02).
  1643   02  DFHEIV8               PIC X(02).
  1644   02  DFHEIV9               PIC X(01).
  1645   02  DFHEIV10              PIC S9(7) COMP-3.
  1646   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1648   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1649   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1650   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1651   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1652   02  DFHEIV17              PIC X(04).
  1653   02  DFHEIV18              PIC X(04).
  1654   02  DFHEIV19              PIC X(04).
  1655   02  DFHEIV20              USAGE IS POINTER.
  1656   02  DFHEIV21              USAGE IS POINTER.
  1657   02  DFHEIV22              USAGE IS POINTER.
  1658   02  DFHEIV23              USAGE IS POINTER.
  1659   02  DFHEIV24              USAGE IS POINTER.
  1660   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1661   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1662   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1663   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1664   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1665   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1666   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1667   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1668   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1669   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1670   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1671   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1672   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1673   02  FILLER                PIC X(02).
  1674   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1675   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1676   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1677   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1678   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1679   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1680   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1681 LINKAGE  SECTION.
  1682*****************************************************************
  1683*                                                               *
  1684* Copyright (c) 2007-2013 Dell Inc.                             *
  1685* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  36
* EL162.cbl
  1686*                                                               *
  1687*****************************************************************
  1688 01  dfheiblk.
  1689     02  eibtime          pic s9(7) comp-3.
  1690     02  eibdate          pic s9(7) comp-3.
  1691     02  eibtrnid         pic x(4).
  1692     02  eibtaskn         pic s9(7) comp-3.
  1693     02  eibtrmid         pic x(4).
  1694     02  dfheigdi         pic s9(4) comp.
  1695     02  eibcposn         pic s9(4) comp.
  1696     02  eibcalen         pic s9(4) comp.
  1697     02  eibaid           pic x(1).
  1698     02  eibfiller1       pic x(1).
  1699     02  eibfn            pic x(2).
  1700     02  eibfiller2       pic x(2).
  1701     02  eibrcode         pic x(6).
  1702     02  eibfiller3       pic x(2).
  1703     02  eibds            pic x(8).
  1704     02  eibreqid         pic x(8).
  1705     02  eibrsrce         pic x(8).
  1706     02  eibsync          pic x(1).
  1707     02  eibfree          pic x(1).
  1708     02  eibrecv          pic x(1).
  1709     02  eibsend          pic x(1).
  1710     02  eibatt           pic x(1).
  1711     02  eibeoc           pic x(1).
  1712     02  eibfmh           pic x(1).
  1713     02  eibcompl         pic x(1).
  1714     02  eibsig           pic x(1).
  1715     02  eibconf          pic x(1).
  1716     02  eiberr           pic x(1).
  1717     02  eibrldbk         pic x(1).
  1718     02  eiberrcd         pic x(4).
  1719     02  eibsynrb         pic x(1).
  1720     02  eibnodat         pic x(1).
  1721     02  eibfiller5       pic x(2).
  1722     02  eibresp          pic s9(8) comp.
  1723     02  eibresp2         pic s9(8) comp.
  1724     02  dfheigdj         pic s9(4) comp.
  1725     02  dfheigdk         pic s9(4) comp.
  1726
  1727 01  DFHCOMMAREA             PIC X(1024).
  1728
  1729*01 PARMLIST .
  1730*    02  FILLER              PIC S9(8)   COMP.
  1731*    02  CLAM-POINTER        PIC S9(8)   COMP.
  1732*    02  ACTV-POINTER        PIC S9(8)   COMP.
  1733*    02  ACCT-POINTER        PIC S9(8)   COMP.
  1734
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  37
* EL162.cbl
  1736*                            COPY ELCMSTR.
  1737******************************************************************
  1738*                                                                *
  1739*                            ELCMSTR.                            *
  1740*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1741*                            VMOD=2.012                          *
  1742*                                                                *
  1743*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1744*                                                                *
  1745*   FILE TYPE = VSAM,KSDS                                        *
  1746*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1747*                                                                *
  1748*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1749*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1750*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1751*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1752*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1753*                                                 RKP=75,LEN=21  *
  1754*                                                                *
  1755*   **** NOTE ****                                               *
  1756*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1757*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1758*                                                                *
  1759*   LOG = YES                                                    *
  1760*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1761******************************************************************
  1762*                   C H A N G E   L O G
  1763*
  1764* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1765*-----------------------------------------------------------------
  1766*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1767* EFFECTIVE    NUMBER
  1768*-----------------------------------------------------------------
  1769* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1770* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1771* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1772* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1773* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1774* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  1775* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1776******************************************************************
  1777 01  CLAIM-MASTER.
  1778     12  CL-RECORD-ID                PIC XX.
  1779         88  VALID-CL-ID         VALUE 'CL'.
  1780
  1781     12  CL-CONTROL-PRIMARY.
  1782         16  CL-COMPANY-CD           PIC X.
  1783         16  CL-CARRIER              PIC X.
  1784         16  CL-CLAIM-NO             PIC X(7).
  1785         16  CL-CERT-NO.
  1786             20  CL-CERT-PRIME       PIC X(10).
  1787             20  CL-CERT-SFX         PIC X.
  1788
  1789     12  CL-CONTROL-BY-NAME.
  1790         16  CL-COMPANY-CD-A1        PIC X.
  1791         16  CL-INSURED-LAST-NAME    PIC X(15).
  1792         16  CL-INSURED-NAME.
  1793             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  38
* EL162.cbl
  1794             20  CL-INSURED-MID-INIT PIC X.
  1795
  1796     12  CL-CONTROL-BY-SSN.
  1797         16  CL-COMPANY-CD-A2        PIC X.
  1798         16  CL-SOC-SEC-NO.
  1799             20  CL-SSN-STATE        PIC XX.
  1800             20  CL-SSN-ACCOUNT      PIC X(6).
  1801             20  CL-SSN-LN3          PIC X(3).
  1802
  1803     12  CL-CONTROL-BY-CERT-NO.
  1804         16  CL-COMPANY-CD-A4        PIC X.
  1805         16  CL-CERT-NO-A4.
  1806             20  CL-CERT-A4-PRIME    PIC X(10).
  1807             20  CL-CERT-A4-SFX      PIC X.
  1808
  1809     12  CL-CONTROL-BY-CCN.
  1810         16  CL-COMPANY-CD-A5        PIC X.
  1811         16  CL-CCN-A5.
  1812             20  CL-CCN.
  1813                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1814                 24  CL-CCN-PRIME-A5 PIC X(12).
  1815             20  CL-CCN-FILLER-A5    PIC X(4).
  1816
  1817     12  CL-INSURED-PROFILE-DATA.
  1818         16  CL-INSURED-BIRTH-DT     PIC XX.
  1819         16  CL-INSURED-SEX-CD       PIC X.
  1820             88  INSURED-IS-MALE        VALUE 'M'.
  1821             88  INSURED-IS-FEMALE      VALUE 'F'.
  1822             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1823         16  CL-INSURED-OCC-CD       PIC X(6).
  1824         16  FILLER                  PIC X(5).
  1825
  1826     12  CL-PROCESSING-INFO.
  1827         16  CL-PROCESSOR-ID         PIC X(4).
  1828         16  CL-CLAIM-STATUS         PIC X.
  1829             88  CLAIM-IS-OPEN          VALUE 'O'.
  1830             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1831         16  CL-CLAIM-TYPE           PIC X.
  1832*            88  AH-CLAIM               VALUE 'A'.
  1833*            88  LIFE-CLAIM             VALUE 'L'.
  1834*            88  PROPERTY-CLAIM         VALUE 'P'.
  1835*            88  IUI-CLAIM              VALUE 'I'.
  1836*            88  GAP-CLAIM              VALUE 'G'.
  1837*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1838*            88  OTHER-CLAIM            VALUE 'O'.
  1839         16  CL-CLAIM-PREM-TYPE      PIC X.
  1840             88  SINGLE-PREMIUM         VALUE '1'.
  1841             88  O-B-COVERAGE           VALUE '2'.
  1842             88  OPEN-END-COVERAGE      VALUE '3'.
  1843         16  CL-INCURRED-DT          PIC XX.
  1844         16  CL-REPORTED-DT          PIC XX.
  1845         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1846         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1847         16  CL-LAST-PMT-DT          PIC XX.
  1848         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1849         16  CL-PAID-THRU-DT         PIC XX.
  1850         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1851         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  39
* EL162.cbl
  1852         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1853         16  CL-PMT-CALC-METHOD      PIC X.
  1854             88  CL-360-DAY-YR          VALUE '1'.
  1855             88  CL-365-DAY-YR          VALUE '2'.
  1856             88  CL-FULL-MONTHS         VALUE '3'.
  1857         16  CL-CAUSE-CD             PIC X(6).
  1858
  1859         16  CL-PRIME-CERT-NO.
  1860             20  CL-PRIME-CERT-PRIME PIC X(10).
  1861             20  CL-PRIME-CERT-SFX   PIC X.
  1862
  1863         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1864             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1865             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1866
  1867         16  CL-MICROFILM-NO         PIC X(10).
  1868         16  FILLER REDEFINES CL-MICROFILM-NO.
  1869             20  CL-BENEFIT-PERIOD   PIC 99.
  1870             20  FILLER              PIC X(8).
  1871         16  CL-PROG-FORM-TYPE       PIC X.
  1872         16  CL-LAST-ADD-ON-DT       PIC XX.
  1873
  1874         16  CL-LAST-REOPEN-DT       PIC XX.
  1875         16  CL-LAST-CLOSE-DT        PIC XX.
  1876         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1877             88  FINAL-PAID             VALUE '1'.
  1878             88  CLAIM-DENIED           VALUE '2'.
  1879             88  AUTO-CLOSE             VALUE '3'.
  1880             88  MANUAL-CLOSE           VALUE '4'.
  1881             88  BENEFITS-CHANGED       VALUE 'C'.
  1882             88  SETUP-ERRORS           VALUE 'E'.
  1883         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1884         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1885         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1886             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1887         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1888         16  FILLER                  PIC X.
  1889
  1890     12  CL-CERTIFICATE-DATA.
  1891         16  CL-CERT-ORIGIN          PIC X.
  1892             88  CERT-WAS-ONLINE        VALUE '1'.
  1893             88  CERT-WAS-CREATED       VALUE '2'.
  1894             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1895         16  CL-CERT-KEY-DATA.
  1896             20  CL-CERT-CARRIER     PIC X.
  1897             20  CL-CERT-GROUPING    PIC X(6).
  1898             20  CL-CERT-STATE       PIC XX.
  1899             20  CL-CERT-ACCOUNT.
  1900                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1901                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1902             20  CL-CERT-EFF-DT      PIC XX.
  1903
  1904     12  CL-STATUS-CONTROLS.
  1905         16  CL-PRIORITY-CD          PIC X.
  1906             88  CONFIDENTIAL-DATA      VALUE '8'.
  1907             88  HIGHEST-PRIORITY       VALUE '9'.
  1908         16  CL-SUPV-ATTN-CD         PIC X.
  1909             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  40
* EL162.cbl
  1910             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1911         16  CL-PURGED-DT            PIC XX.
  1912         16  CL-RESTORED-DT          PIC XX.
  1913         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1914         16  CL-NEXT-RESEND-DT       PIC XX.
  1915         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1916         16  CL-CRITICAL-PERIOD      PIC 99.
  1917*        16  FILLER                  PIC XX.
  1918         16  CL-LAST-MAINT-DT        PIC XX.
  1919         16  CL-LAST-MAINT-USER      PIC X(4).
  1920         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1921         16  CL-LAST-MAINT-TYPE      PIC X.
  1922             88  CLAIM-SET-UP           VALUE ' '.
  1923             88  PAYMENT-MADE           VALUE '1'.
  1924             88  LETTER-SENT            VALUE '2'.
  1925             88  MASTER-WAS-ALTERED     VALUE '3'.
  1926             88  MASTER-WAS-RESTORED    VALUE '4'.
  1927             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1928             88  FILE-CONVERTED         VALUE '6'.
  1929             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1930             88  ERROR-CORRECTION       VALUE 'E'.
  1931         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1932         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1933         16  CL-BENEFICIARY          PIC X(10).
  1934         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1935         16  CL-DENIAL-TYPE          PIC X.
  1936             88  CL-TYPE-DENIAL          VALUE '1'.
  1937             88  CL-TYPE-RESCISSION      VALUE '2'.
  1938             88  CL-TYPE-REFORMATION     VALUE '3'.
  1939             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1940             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1941         16  CL-NO-OF-EXTENSIONS     PIC 99.
  1942         16  filler                  pic x(3).
  1943*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1944*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1945*        16  CL-RTW-DT               PIC XX.
  1946
  1947     12  CL-TRAILER-CONTROLS.
  1948         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1949             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1950             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1951             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1952         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1953         16  FILLER                  PIC XX.
  1954         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1955         16  CL-ADDRESS-TRAILER-CNT.
  1956             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1957                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1958             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1959                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1960             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1961                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1962             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1963                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1964             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1965                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1966             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1967                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  41
* EL162.cbl
  1968             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1969                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1970
  1971     12  CL-CV-REFERENCE-NO.
  1972         16  CL-CV-REFNO-PRIME       PIC X(18).
  1973         16  CL-CV-REFNO-SFX         PIC XX.
  1974
  1975     12  CL-FILE-LOCATION            PIC X(4).
  1976
  1977     12  CL-PROCESS-ERRORS.
  1978         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1979             88  NO-FATAL-ERRORS        VALUE ZERO.
  1980         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1981             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1982
  1983     12  CL-PRODUCT-CD               PIC X.
  1984
  1985     12  CL-CURRENT-KEY-DATA.
  1986         16  CL-CURRENT-CARRIER      PIC X.
  1987         16  CL-CURRENT-GROUPING     PIC X(6).
  1988         16  CL-CURRENT-STATE        PIC XX.
  1989         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1990
  1991     12  CL-ASSOCIATES               PIC X.
  1992         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1993         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1994         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1995         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1996
  1997     12  CL-ACTIVITY-CODE            PIC 99.
  1998     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1999     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  2000
  2001     12  CL-LAPSE-REPORT-CODE        PIC 9.
  2002     12  CL-LAG-REPORT-CODE          PIC 9.
  2003     12  CL-LOAN-TYPE                PIC XX.
  2004     12  CL-LEGAL-STATE              PIC XX.
  2005
  2006     12  CL-YESNOSW                  PIC X.
  2007     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  2008         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  2009         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  2010         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  2011     12  cl-insured-type             pic x.
  2012         88  cl-claim-on-primary         value 'P'.
  2013         88  cl-claim-on-co-borrower     value 'C'.
  2014     12  cl-benefit-expiration-dt    PIC XX.
  2015
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  42
* EL162.cbl
  2017*                            COPY ELCTRLR.
  2018******************************************************************
  2019*                                                                *
  2020*                            ELCTRLR.                            *
  2021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2022*                            VMOD=2.014                          *
  2023*                                                                *
  2024*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  2025*                                                                *
  2026*   FILE TYPE = VSAM,KSDS                                        *
  2027*   RECORD SIZE = 200    RECFORM = FIXED                         *
  2028*                                                                *
  2029*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  2030*       ALTERNATE INDEX = NONE                                   *
  2031*                                                                *
  2032*   LOG = YES                                                    *
  2033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2034******************************************************************
  2035*                   C H A N G E   L O G
  2036*
  2037* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2038*-----------------------------------------------------------------
  2039*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2040* EFFECTIVE    NUMBER
  2041*-----------------------------------------------------------------
  2042* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2043* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  2044* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  2045* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  2046* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  2047* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  2048* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  2049* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  2050* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  2051* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  2052* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  2053* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  2054* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  2055* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  2056* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  2057* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2058* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  2059* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  2060* 040814    2014030500002  AJRA  ADD ICD CODES
  2061* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2062* 013017  CR2016053100001  PEMA  ACH PROCESSING
  2063* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  2064* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2065******************************************************************
  2066 01  ACTIVITY-TRAILERS.
  2067     12  AT-RECORD-ID                    PIC XX.
  2068         88  VALID-AT-ID                       VALUE 'AT'.
  2069
  2070     12  AT-CONTROL-PRIMARY.
  2071         16  AT-COMPANY-CD               PIC X.
  2072         16  AT-CARRIER                  PIC X.
  2073         16  AT-CLAIM-NO                 PIC X(7).
  2074         16  AT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  43
* EL162.cbl
  2075             20  AT-CERT-PRIME           PIC X(10).
  2076             20  AT-CERT-SFX             PIC X.
  2077         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  2078             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  2079             88  AT-LAST-TRL-AVAIL            VALUE +100.
  2080             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  2081             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  2082             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  2083             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  2084             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  2085             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  2086             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  2087             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  2088             88  AT-DIAGNOSIS-TRL             VALUE +90.
  2089             88  AT-BENEFICIARY-TRL           VALUE +91.
  2090             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  2091             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  2092             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  2093             88  AT-ERROR-MSGS-TRL            VALUE +95.
  2094
  2095     12  AT-TRAILER-TYPE                 PIC X.
  2096         88  RESERVE-EXPENSE-TR               VALUE '1'.
  2097         88  PAYMENT-TR                       VALUE '2'.
  2098         88  AUTO-PAY-TR                      VALUE '3'.
  2099         88  CORRESPONDENCE-TR                VALUE '4'.
  2100         88  ADDRESS-TR                       VALUE '5'.
  2101         88  GENERAL-INFO-TR                  VALUE '6'.
  2102         88  AUTO-PROMPT-TR                   VALUE '7'.
  2103         88  DENIAL-TR                        VALUE '8'.
  2104         88  INCURRED-CHG-TR                  VALUE '9'.
  2105         88  FORM-CONTROL-TR                  VALUE 'A'.
  2106
  2107     12  AT-RECORDED-DT                  PIC XX.
  2108     12  AT-RECORDED-BY                  PIC X(4).
  2109     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  2110
  2111     12  AT-TRAILER-BODY                 PIC X(165).
  2112
  2113     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  2114         16  AT-RESERVE-CONTROLS.
  2115             20  AT-MANUAL-SW            PIC X.
  2116                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  2117             20  AT-FUTURE-SW            PIC X.
  2118                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  2119             20  AT-PTC-SW               PIC X.
  2120                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  2121             20  AT-IBNR-SW              PIC X.
  2122                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  2123             20  AT-PTC-LF-SW            PIC X.
  2124                 88  AT-LF-PTC-USED          VALUE '1'.
  2125             20  AT-CDT-ACCESS-METHOD    PIC X.
  2126                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  2127                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  2128                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  2129             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  2130         16  AT-LAST-COMPUTED-DT         PIC XX.
  2131         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  2132         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  44
* EL162.cbl
  2133         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  2134         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2135         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2136         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  2137         16  AT-EXPENSE-CONTROLS.
  2138             20  AT-EXPENSE-METHOD       PIC X.
  2139                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  2140                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  2141                 88  PERCENT-OF-PMT           VALUE '3'.
  2142                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  2143             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  2144             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  2145         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  2146         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  2147
  2148         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  2149         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  2150
  2151*        16  FILLER                      PIC X(53).
  2152         16  FILLER                      PIC X(47).
  2153
  2154         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  2155         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  2156
  2157         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  2158             20  AT-OPEN-CLOSE-DATE      PIC XX.
  2159             20  AT-OPEN-CLOSE-TYPE      PIC X.
  2160*                    C = CLOSED
  2161*                    O = OPEN
  2162             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  2163*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  2164
  2165     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  2166         16  AT-PAYMENT-TYPE             PIC X.
  2167             88  PARTIAL-PAYMENT                VALUE '1'.
  2168             88  FINAL-PAYMENT                  VALUE '2'.
  2169             88  LUMP-SUM-PAYMENT               VALUE '3'.
  2170             88  ADDITIONAL-PAYMENT             VALUE '4'.
  2171             88  CHARGEABLE-EXPENSE             VALUE '5'.
  2172             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  2173             88  VOIDED-PAYMENT                 VALUE '9'.
  2174             88  TRANSFER                       VALUE 'T'.
  2175             88  LIFE-INTEREST                  VALUE 'I'.
  2176
  2177         16  AT-CLAIM-TYPE               PIC X.
  2178             88  PAID-FOR-AH                    VALUE 'A'.
  2179             88  PAID-FOR-LIFE                  VALUE 'L'.
  2180             88  PAID-FOR-IUI                   VALUE 'I'.
  2181             88  PAID-FOR-GAP                   VALUE 'G'.
  2182             88  PAID-FOR-FAM                   VALUE 'F'.
  2183             88  PAID-FOR-OTH                   VALUE 'O'.
  2184         16  AT-CLAIM-PREM-TYPE          PIC X.
  2185             88  AT-SINGLE-PREMIUM              VALUE '1'.
  2186             88  AT-O-B-COVERAGE                VALUE '2'.
  2187             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  2188         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  2189         16  AT-CHECK-NO                 PIC X(7).
  2190         16  AT-PAID-FROM-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  45
* EL162.cbl
  2191         16  AT-PAID-THRU-DT             PIC XX.
  2192         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  2193         16  AT-ACH-PAYMENT              PIC X.
  2194*        16  FILLER                      PIC X.
  2195         16  AT-PAYEES-NAME              PIC X(30).
  2196         16  AT-PAYMENT-ORIGIN           PIC X.
  2197             88  ONLINE-MANUAL-PMT              VALUE '1'.
  2198             88  ONLINE-AUTO-PMT                VALUE '2'.
  2199             88  OFFLINE-PMT                    VALUE '3'.
  2200         16  AT-CHECK-WRITTEN-DT         PIC XX.
  2201         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  2202         16  AT-VOID-DATA.
  2203             20  AT-VOID-DT              PIC XX.
  2204*00144       20  AT-VOID-REASON          PIC X(30).
  2205             20  AT-VOID-REASON          PIC X(26).
  2206         16  AT-PMT-APPROVED-BY          PIC X(04).
  2207         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  2208         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  2209         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  2210                                         PIC S99V9(5)  COMP-3.
  2211         16  AT-CREDIT-INTERFACE.
  2212             20  AT-PMT-SELECT-DT        PIC XX.
  2213                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  2214             20  AT-PMT-ACCEPT-DT        PIC XX.
  2215                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  2216             20  AT-VOID-SELECT-DT       PIC XX.
  2217                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  2218             20  AT-VOID-ACCEPT-DT       PIC XX.
  2219                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  2220
  2221         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  2222                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  2223                 88  CONVERSION-PAYMENT           VALUE +99999999.
  2224         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  2225
  2226         16  AT-FORCE-CONTROL            PIC X.
  2227             88  PAYMENT-WAS-FORCED           VALUE '1'.
  2228         16  AT-PREV-LAST-PMT-DT         PIC XX.
  2229         16  AT-PREV-PAID-THRU-DT        PIC XX.
  2230         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2231         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  2232         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  2233         16  AT-BENEFIT-TYPE             PIC X.
  2234
  2235         16  AT-EXPENSE-TYPE             PIC X.
  2236         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  2237
  2238         16  AT-PAYEE-TYPE-CD.
  2239             20  AT-PAYEE-TYPE           PIC X.
  2240                 88  INSURED-PAID           VALUE 'I'.
  2241                 88  BENEFICIARY-PAID       VALUE 'B'.
  2242                 88  ACCOUNT-PAID           VALUE 'A'.
  2243                 88  OTHER-1-PAID           VALUE 'O'.
  2244                 88  OTHER-2-PAID           VALUE 'Q'.
  2245                 88  DOCTOR-PAID            VALUE 'P'.
  2246                 88  EMPLOYER-PAID          VALUE 'E'.
  2247             20  AT-PAYEE-SEQ            PIC X.
  2248
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  46
* EL162.cbl
  2249         16  AT-CASH-PAYMENT             PIC X.
  2250         16  AT-GROUPED-PAYMENT          PIC X.
  2251         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  2252         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  2253         16  AT-APPROVED-LEVEL           PIC X.
  2254         16  AT-VOID-TYPE                PIC X.
  2255             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  2256             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  2257         16  AT-AIG-UNEMP-IND            PIC X.
  2258             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  2259         16  AT-ASSOCIATES               PIC X.
  2260             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  2261             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  2262
  2263         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  2264         16  AT-CV-PMT-CODE              PIC X.
  2265             88  FULL-DEATH-PAYMENT         VALUE '1'.
  2266             88  HALF-DEATH-PAYMENT         VALUE '2'.
  2267             88  FULL-ADD-PAYMENT           VALUE '3'.
  2268             88  HALF-ADD-PAYMENT           VALUE '4'.
  2269             88  FULL-RIDER-PAYMENT         VALUE '5'.
  2270             88  HALF-RIDER-PAYMENT         VALUE '6'.
  2271             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  2272             88  ADDL-PAYMENT               VALUE '8'.
  2273
  2274         16  AT-EOB-CODE1                PIC XXX.
  2275         16  AT-EOB-CODE2                PIC XXX.
  2276         16  AT-EOB-CODE3                PIC XXX.
  2277         16  FILLER REDEFINES AT-EOB-CODE3.
  2278             20  AT-PRINT-CLM-FORM       PIC X.
  2279             20  AT-PRINT-SURVEY         PIC X.
  2280             20  AT-SPECIAL-RELEASE      PIC X.
  2281         16  AT-EOB-CODE4                PIC XXX.
  2282         16  FILLER REDEFINES AT-EOB-CODE4.
  2283             20  AT-INT-PMT-SELECT-DT    PIC XX.
  2284             20  FILLER                  PIC X.
  2285         16  AT-EOB-CODE5                PIC XXX.
  2286         16  FILLER REDEFINES AT-EOB-CODE5.
  2287             20  AT-PMT-PROOF-DT         PIC XX.
  2288             20  FILLER                  PIC X.
  2289
  2290         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  2291             88  AT-PRINT-EOB            VALUE 'Y'.
  2292
  2293         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  2294         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  2295
  2296     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  2297         16  AT-SCHEDULE-START-DT        PIC XX.
  2298         16  AT-SCHEDULE-END-DT          PIC XX.
  2299         16  AT-TERMINATED-DT            PIC XX.
  2300         16  AT-LAST-PMT-TYPE            PIC X.
  2301             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  2302             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  2303         16  AT-FIRST-PMT-DATA.
  2304             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2305             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  2306             20  AT-1ST-PAY-THRU-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  47
* EL162.cbl
  2307         16  AT-REGULAR-PMT-DATA.
  2308             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  2309             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  2310             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  2311         16  AT-AUTO-PAYEE-CD.
  2312             20  AT-AUTO-PAYEE-TYPE      PIC X.
  2313                 88  INSURED-PAID-AUTO      VALUE 'I'.
  2314                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  2315                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  2316                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  2317                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  2318             20  AT-AUTO-PAYEE-SEQ       PIC X.
  2319         16  AT-AUTO-PAY-DAY             PIC 99.
  2320         16  AT-AUTO-CASH                PIC X.
  2321             88  AT-CASH                      VALUE 'Y'.
  2322             88  AT-NON-CASH                  VALUE 'N'.
  2323*        16  FILLER                      PIC X(129).
  2324         16  AT-AUTO-END-LETTER          PIC X(4).
  2325         16  FILLER                      PIC X(125).
  2326
  2327         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  2328         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  2329
  2330     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  2331         16  AT-LETTER-SENT-DT           PIC XX.
  2332         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  2333         16  AT-AUTO-RE-SEND-DT          PIC XX.
  2334         16  AT-LETTER-ANSWERED-DT       PIC XX.
  2335         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  2336         16  AT-LETTER-ORIGIN            PIC X.
  2337             88  ONLINE-CREATION              VALUE '1' '3'.
  2338             88  OFFLINE-CREATION             VALUE '2' '4'.
  2339             88  NAPER-ONLINE-CREATION        VALUE '3'.
  2340             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  2341         16  AT-STD-LETTER-FORM          PIC X(4).
  2342         16  AT-REASON-TEXT              PIC X(70).
  2343         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  2344         16  AT-ADDRESEE-TYPE            PIC X.
  2345              88  INSURED-ADDRESEE            VALUE 'I'.
  2346              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  2347              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  2348              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  2349              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  2350              88  OTHER-ADDRESEE-1            VALUE 'O'.
  2351              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  2352         16  AT-ADDRESSEE-NAME           PIC X(30).
  2353         16  AT-INITIAL-PRINT-DATE       PIC XX.
  2354         16  AT-RESEND-PRINT-DATE        PIC XX.
  2355         16  AT-CORR-SOL-UNSOL           PIC X.
  2356         16  AT-LETTER-PURGED-DT         PIC XX.
  2357*
  2358*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  2359*
  2360         16  AT-CSO-REDEFINITION.
  2361             20  AT-RESEND-LETTER-FORM   PIC X(4).
  2362             20  AT-AUTO-CLOSE-IND       PIC X(1).
  2363             20  AT-LETTER-TO-BENE       PIC X(1).
  2364             20  AT-STOP-LETTER-DT       PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  48
* EL162.cbl
  2365             20  AT-AUTH-RCVD            PIC X(1).
  2366             20  FILLER                  PIC X(18).
  2367*             20  FILLER                  PIC X(27).
  2368             20  AT-CSO-LETTER-STATUS    PIC X.
  2369                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  2370                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  2371                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  2372             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  2373             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  2374*
  2375*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  2376*
  2377*        16  FILLER                      PIC X(26).
  2378*
  2379*        16  AT-DMD-BSR-CODE             PIC X.
  2380*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  2381*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  2382*
  2383*        16  AT-DMD-LETTER-STATUS        PIC X.
  2384*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  2385*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  2386*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  2387*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  2388*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  2389
  2390         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  2391         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  2392
  2393     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  2394         16  AT-ADDRESS-TYPE             PIC X.
  2395             88  INSURED-ADDRESS               VALUE 'I'.
  2396             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  2397             88  ACCOUNT-ADDRESS               VALUE 'A'.
  2398             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  2399             88  EMPLOYER-ADDRESS              VALUE 'E'.
  2400             88  OTHER-ADDRESS-1               VALUE 'O'.
  2401             88  OTHER-ADDRESS-2               VALUE 'Q'.
  2402         16  AT-MAIL-TO-NAME             PIC X(30).
  2403         16  AT-ADDRESS-LINE-1           PIC X(30).
  2404         16  AT-ADDRESS-LINE-2           PIC X(30).
  2405         16  AT-CITY-STATE.
  2406             20  AT-CITY                 PIC X(28).
  2407             20  AT-STATE                PIC XX.
  2408         16  AT-ZIP.
  2409             20  AT-ZIP-CODE.
  2410                 24  AT-ZIP-1ST          PIC X.
  2411                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2412                 24  FILLER              PIC X(4).
  2413             20  AT-ZIP-PLUS4            PIC X(4).
  2414         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2415             20  AT-CAN-POSTAL-1         PIC XXX.
  2416             20  AT-CAN-POSTAL-2         PIC XXX.
  2417             20  FILLER                  PIC XXX.
  2418         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2419*         16  FILLER                      PIC X(23).
  2420         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  2421         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  2422         16  FILLER                      PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  49
* EL162.cbl
  2423         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2424         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  2425
  2426     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2427         16  AT-INFO-LINE-1              PIC X(60).
  2428         16  FILLER REDEFINES AT-INFO-LINE-1.
  2429             20  AT-NOTE-ERROR-NO OCCURS 15
  2430                                         PIC X(4).
  2431         16  AT-INFO-LINE-2              PIC X(60).
  2432         16  FILLER REDEFINES AT-INFO-LINE-2.
  2433             20  AT-ICD-CODE-1           PIC X(8).
  2434             20  AT-ICD-CODE-2           PIC X(8).
  2435             20  FILLER                  PIC X(44).
  2436         16  AT-INFO-TRAILER-TYPE        PIC X.
  2437             88  AT-ERRORS-NOTE          VALUE 'E'.
  2438             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2439             88  AT-CALL-NOTE            VALUE 'C'.
  2440             88  AT-MAINT-NOTE           VALUE 'M'.
  2441             88  AT-CERT-CHANGE          VALUE 'X'.
  2442             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2443             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2444             88  AT-CERT-CANCELLED       VALUE 'T'.
  2445         16  AT-CALL-TYPE                PIC X.
  2446             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2447             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2448         16  AT-NOTE-CONTINUATION        PIC X.
  2449             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2450         16  AT-EOB-CODES-EXIST          PIC X.
  2451             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2452         16  FILLER                      PIC X(35).
  2453         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2454         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2455
  2456     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  2457         16  AT-PROMPT-LINE-1            PIC X(60).
  2458         16  AT-PROMPT-LINE-2            PIC X(60).
  2459         16  AT-PROMPT-START-DT          PIC XX.
  2460         16  AT-PROMPT-END-DT            PIC XX.
  2461         16  FILLER                      PIC X(35).
  2462         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2463         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2464
  2465     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2466         16  AT-DENIAL-INFO-1            PIC X(60).
  2467         16  AT-DENIAL-INFO-2            PIC X(60).
  2468         16  AT-DENIAL-DT                PIC XX.
  2469         16  AT-RETRACTION-DT            PIC XX.
  2470         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2471*         16  FILLER                      PIC X(31).
  2472         16  AT-DENIAL-PROOF-DT          PIC XX.
  2473         16  FILLER                      PIC X(29).
  2474         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2475         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2476
  2477     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2478         16  AT-OLD-INCURRED-DT          PIC XX.
  2479         16  AT-OLD-REPORTED-DT          PIC XX.
  2480         16  AT-OLD-ESTABLISHED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  50
* EL162.cbl
  2481         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2482         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2483         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2484         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2485         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2486         16  FILLER                      PIC X(26).
  2487         16  AT-OLD-DIAG-CODE            PIC X(6).
  2488         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2489         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2490         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2491         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2492         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2493         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2494         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2495         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2496         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2497         16  FILLER                      PIC X(9).
  2498         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2499
  2500     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2501         16  AT-FORM-SEND-ON-DT          PIC XX.
  2502         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2503         16  AT-FORM-RE-SEND-DT          PIC XX.
  2504         16  AT-FORM-ANSWERED-DT         PIC XX.
  2505         16  AT-FORM-PRINTED-DT          PIC XX.
  2506         16  AT-FORM-REPRINT-DT          PIC XX.
  2507         16  AT-FORM-TYPE                PIC X.
  2508             88  INITIAL-FORM                  VALUE '1'.
  2509             88  PROGRESS-FORM                 VALUE '2'.
  2510         16  AT-INSTRUCT-LN-1            PIC X(28).
  2511         16  AT-INSTRUCT-LN-2            PIC X(28).
  2512         16  AT-INSTRUCT-LN-3            PIC X(28).
  2513         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2514         16  AT-FORM-ADDRESS             PIC X.
  2515             88  FORM-TO-INSURED              VALUE 'I'.
  2516             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2517             88  FORM-TO-OTHER-1              VALUE 'O'.
  2518             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2519         16  AT-RELATED-1.
  2520             20 AT-REL-CARR-1            PIC X.
  2521             20 AT-REL-CLAIM-1           PIC X(7).
  2522             20 AT-REL-CERT-1            PIC X(11).
  2523         16  AT-RELATED-2.
  2524             20 AT-REL-CARR-2            PIC X.
  2525             20 AT-REL-CLAIM-2           PIC X(7).
  2526             20 AT-REL-CERT-2            PIC X(11).
  2527         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2528         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2529         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2530         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2531         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2532         16  AT-STOP-FORM-DT             PIC X(2).
  2533
  2534         16  FILLER                      PIC X(09).
  2535         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2536         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2537******************************************************************
  2538
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  51
* EL162.cbl
  2540*                            COPY ERCACCT.
  2541******************************************************************
  2542*                                                                *
  2543*                                                                *
  2544*                            ERCACCT                             *
  2545*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2546*                            VMOD=2.031                          *
  2547*                                                                *
  2548*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2549*                                                                *
  2550*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2551*   VSAM ACCOUNT MASTER FILES.                                   *
  2552*                                                                *
  2553*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2554*                                                                *
  2555*   FILE TYPE = VSAM,KSDS                                        *
  2556*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2557*                                                                *
  2558*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2559*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2560*                                                                *
  2561*   LOG = NO                                                     *
  2562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2563*                                                                *
  2564*                                                                *
  2565******************************************************************
  2566*                   C H A N G E   L O G
  2567*
  2568* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2569*-----------------------------------------------------------------
  2570*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2571* EFFECTIVE    NUMBER
  2572*-----------------------------------------------------------------
  2573* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2574* 092705    2005050300006  PEMA  ADD SPP LEASES
  2575* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2576* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2577* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2578* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2579* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2580* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2581******************************************************************
  2582
  2583 01  ACCOUNT-MASTER.
  2584     12  AM-RECORD-ID                      PIC XX.
  2585         88  VALID-AM-ID                      VALUE 'AM'.
  2586
  2587     12  AM-CONTROL-PRIMARY.
  2588         16  AM-COMPANY-CD                 PIC X.
  2589         16  AM-MSTR-CNTRL.
  2590             20  AM-CONTROL-A.
  2591                 24  AM-CARRIER            PIC X.
  2592                 24  AM-GROUPING.
  2593                     28 AM-GROUPING-PREFIX PIC XXX.
  2594                     28 AM-GROUPING-PRIME  PIC XXX.
  2595                 24  AM-STATE              PIC XX.
  2596                 24  AM-ACCOUNT.
  2597                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  52
* EL162.cbl
  2598                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2599             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2600                                           PIC X(19).
  2601             20  AM-CNTRL-B.
  2602                 24  AM-EXPIRATION-DT      PIC XX.
  2603                 24  FILLER                PIC X(4).
  2604             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2605                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2606
  2607     12  AM-CONTROL-BY-VAR-GRP.
  2608         16  AM-COMPANY-CD-A1              PIC X.
  2609         16  AM-VG-CARRIER                 PIC X.
  2610         16  AM-VG-GROUPING                PIC X(6).
  2611         16  AM-VG-STATE                   PIC XX.
  2612         16  AM-VG-ACCOUNT                 PIC X(10).
  2613         16  AM-VG-DATE.
  2614             20  AM-VG-EXPIRATION-DT       PIC XX.
  2615             20  FILLER                    PIC X(4).
  2616         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2617                                           PIC 9(11)      COMP-3.
  2618     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2619         16  FILLER                        PIC X(10).
  2620         16  AM-VG-KEY3.
  2621             20  AM-VG3-ACCOUNT            PIC X(10).
  2622             20  AM-VG3-EXP-DT             PIC XX.
  2623         16  FILLER                        PIC X(4).
  2624     12  AM-MAINT-INFORMATION.
  2625         16  AM-LAST-MAINT-DT              PIC XX.
  2626         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2627         16  AM-LAST-MAINT-USER            PIC X(4).
  2628         16  FILLER                        PIC XX.
  2629
  2630     12  AM-EFFECTIVE-DT                   PIC XX.
  2631     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2632
  2633     12  AM-PREV-DATES  COMP-3.
  2634         16  AM-PREV-EXP-DT                PIC 9(11).
  2635         16  AM-PREV-EFF-DT                PIC 9(11).
  2636
  2637     12  AM-REPORT-CODE-1                  PIC X(10).
  2638     12  AM-REPORT-CODE-2                  PIC X(10).
  2639
  2640     12  AM-CITY-CODE                      PIC X(4).
  2641     12  AM-COUNTY-PARISH                  PIC X(6).
  2642
  2643     12  AM-NAME                           PIC X(30).
  2644     12  AM-PERSON                         PIC X(30).
  2645     12  AM-ADDRS                          PIC X(30).
  2646     12  AM-CITY.
  2647         16  AM-ADDR-CITY                  PIC X(28).
  2648         16  AM-ADDR-STATE                 PIC XX.
  2649     12  AM-ZIP.
  2650         16  AM-ZIP-PRIME.
  2651             20  AM-ZIP-PRI-1ST            PIC X.
  2652                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2653             20  FILLER                    PIC X(4).
  2654         16  AM-ZIP-PLUS4                  PIC X(4).
  2655     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  53
* EL162.cbl
  2656         16  AM-CAN-POSTAL-1               PIC XXX.
  2657         16  AM-CAN-POSTAL-2               PIC XXX.
  2658         16  FILLER                        PIC XXX.
  2659     12  AM-TEL-NO.
  2660         16  AM-AREA-CODE                  PIC 999.
  2661         16  AM-TEL-PRE                    PIC 999.
  2662         16  AM-TEL-NBR                    PIC 9(4).
  2663     12  AM-TEL-LOC                        PIC X.
  2664         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2665         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2666
  2667     12  AM-COMM-STRUCTURE.
  2668         16  AM-DEFN-1.
  2669             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2670                 24  AM-AGT.
  2671                     28  AM-AGT-PREFIX     PIC X(4).
  2672                     28  AM-AGT-PRIME      PIC X(6).
  2673                 24  AM-COM-TYP            PIC X.
  2674                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2675                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2676                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2677                 24  AM-RECALC-LV-INDIC    PIC X.
  2678                 24  AM-RETRO-LV-INDIC     PIC X.
  2679                 24  AM-GL-CODES           PIC X.
  2680                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2681                 24  FILLER                PIC X(01).
  2682         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2683             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2684                 24  FILLER                PIC X(11).
  2685                 24  AM-L-COMA             PIC XXX.
  2686                 24  AM-J-COMA             PIC XXX.
  2687                 24  AM-A-COMA             PIC XXX.
  2688                 24  FILLER                PIC X(6).
  2689
  2690     12  AM-COMM-CHANGE-STATUS             PIC X.
  2691         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2692
  2693     12  AM-CSR-CODE                       PIC X(4).
  2694
  2695     12  AM-BILLING-STATUS                 PIC X.
  2696         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2697         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2698     12  AM-AUTO-REFUND-SW                 PIC X.
  2699         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2700         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2701     12  AM-GPCD                           PIC 99.
  2702     12  AM-IG                             PIC X.
  2703         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2704         88  AM-HAS-GROUP                     VALUE '2'.
  2705     12  AM-STATUS                         PIC X.
  2706         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2707         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2708         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2709         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2710         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2711         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2712         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2713         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  54
* EL162.cbl
  2714         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2715         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2716     12  AM-REMIT-TO                       PIC 99.
  2717     12  AM-ID-NO                          PIC X(11).
  2718
  2719     12  AM-CAL-TABLE                      PIC XX.
  2720     12  AM-LF-DEVIATION                   PIC XXX.
  2721     12  AM-AH-DEVIATION                   PIC XXX.
  2722     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2723     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2724     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2725     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2726     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2727     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2728
  2729     12  AM-USER-FIELDS.
  2730         16  AM-FLD-1                      PIC XX.
  2731         16  AM-FLD-2                      PIC XX.
  2732         16  AM-FLD-3                      PIC XX.
  2733         16  AM-FLD-4                      PIC XX.
  2734         16  AM-FLD-5                      PIC XX.
  2735
  2736     12  AM-1ST-PROD-DATE.
  2737         16  AM-1ST-PROD-YR                PIC XX.
  2738         16  AM-1ST-PROD-MO                PIC XX.
  2739         16  AM-1ST-PROD-DA                PIC XX.
  2740     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2741     12  AM-CERTS-PURGED-DATE.
  2742         16  AM-PUR-YR                     PIC XX.
  2743         16  AM-PUR-MO                     PIC XX.
  2744         16  AM-PUR-DA                     PIC XX.
  2745     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2746     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2747     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2748     12  AM-INACTIVE-DATE.
  2749         16  AM-INA-MO                     PIC 99.
  2750         16  AM-INA-DA                     PIC 99.
  2751         16  AM-INA-YR                     PIC 99.
  2752     12  AM-AR-HI-CERT-DATE                PIC XX.
  2753
  2754     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2755     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2756
  2757     12  AM-OB-PAYMENT-MODE                PIC X.
  2758         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2759         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2760         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2761         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2762
  2763     12  AM-AH-ONLY-INDICATOR              PIC X.
  2764         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2765         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2766
  2767     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2768
  2769     12  AM-OVER-SHORT.
  2770         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2771         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  55
* EL162.cbl
  2772
  2773     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2774     12  AM-DCC-CLP-STATE                  PIC XX.
  2775
  2776     12  AM-RECALC-COMM                    PIC X.
  2777     12  AM-RECALC-REIN                    PIC X.
  2778
  2779     12  AM-REI-TABLE                      PIC XXX.
  2780     12  AM-REI-ET-LF                      PIC X.
  2781     12  AM-REI-ET-AH                      PIC X.
  2782     12  AM-REI-PE-LF                      PIC X.
  2783     12  AM-REI-PE-AH                      PIC X.
  2784     12  AM-REI-PRT-ST                     PIC X.
  2785     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2786     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2787     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2788     12  AM-REI-GROUP-A                    PIC X(6).
  2789     12  AM-REI-MORT                       PIC X(4).
  2790     12  AM-REI-PRT-OW                     PIC X.
  2791     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2792     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2793     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2794     12  AM-REI-GROUP-B                    PIC X(6).
  2795
  2796     12  AM-TRUST-TYPE                     PIC X(2).
  2797
  2798     12  AM-EMPLOYER-STMT-USED             PIC X.
  2799     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2800
  2801     12  AM-STD-AH-TYPE                    PIC XX.
  2802     12  AM-EARN-METHODS.
  2803         16  AM-EARN-METHOD-R              PIC X.
  2804             88 AM-REF-RL-R78                 VALUE 'R'.
  2805             88 AM-REF-RL-PR                  VALUE 'P'.
  2806             88 AM-REF-RL-MEAN                VALUE 'M'.
  2807             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2808         16  AM-EARN-METHOD-L              PIC X.
  2809             88 AM-REF-LL-R78                 VALUE 'R'.
  2810             88 AM-REF-LL-PR                  VALUE 'P'.
  2811             88 AM-REF-LL-MEAN                VALUE 'M'.
  2812             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2813         16  AM-EARN-METHOD-A              PIC X.
  2814             88 AM-REF-AH-R78                 VALUE 'R'.
  2815             88 AM-REF-AH-PR                  VALUE 'P'.
  2816             88 AM-REF-AH-MEAN                VALUE 'M'.
  2817             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2818             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2819             88 AM-REF-AH-NET                 VALUE 'N'.
  2820
  2821     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2822     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2823     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2824
  2825     12  AM-RET-Y-N                        PIC X.
  2826     12  AM-RET-P-E                        PIC X.
  2827     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2828     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2829     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  56
* EL162.cbl
  2830     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2831         16  AM-POOL-PRIME                 PIC XXX.
  2832         16  AM-POOL-SUB                   PIC XXX.
  2833     12  AM-RETRO-EARNINGS.
  2834         16  AM-RET-EARN-R                 PIC X.
  2835         16  AM-RET-EARN-L                 PIC X.
  2836         16  AM-RET-EARN-A                 PIC X.
  2837     12  AM-RET-ST-TAX-USE                 PIC X.
  2838         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2839         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2840     12  AM-RETRO-BEG-EARNINGS.
  2841         16  AM-RET-BEG-EARN-R             PIC X.
  2842         16  AM-RET-BEG-EARN-L             PIC X.
  2843         16  AM-RET-BEG-EARN-A             PIC X.
  2844     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2845     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2846
  2847     12  AM-USER-SELECT-OPTIONS.
  2848         16  AM-USER-SELECT-1              PIC X(10).
  2849         16  AM-USER-SELECT-2              PIC X(10).
  2850         16  AM-USER-SELECT-3              PIC X(10).
  2851         16  AM-USER-SELECT-4              PIC X(10).
  2852         16  AM-USER-SELECT-5              PIC X(10).
  2853
  2854     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2855
  2856     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2857
  2858     12  AM-RPT045A-SWITCH                 PIC X.
  2859         88  RPT045A-OFF                   VALUE 'N'.
  2860
  2861     12  AM-INSURANCE-LIMITS.
  2862         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2863         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2864
  2865     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2866         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2867
  2868     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2869         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2870         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2871
  2872     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2873
  2874     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2875     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2876     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2877     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2878     12  AM-DCC-UEF-STATE                  PIC XX.
  2879     12  FILLER                            PIC XXX.
  2880     12  AM-REPORT-CODE-3                  PIC X(10).
  2881*    12  FILLER                            PIC X(22).
  2882
  2883     12  AM-RESERVE-DATE.
  2884         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2885         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2886         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2887
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  57
* EL162.cbl
  2888     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2889     12  AM-NOTIFICATION-TYPES.
  2890         16  AM-NOTIF-OF-LETTERS           PIC X.
  2891         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2892         16  AM-NOTIF-OF-REPORTS           PIC X.
  2893         16  AM-NOTIF-OF-STATUS            PIC X.
  2894
  2895     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2896         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2897         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2898         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2899         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2900
  2901     12  AM-BENEFIT-CONTROLS.
  2902         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2903             20  AM-BENEFIT-CODE           PIC XX.
  2904             20  AM-BENEFIT-TYPE           PIC X.
  2905             20  AM-BENEFIT-REVISION       PIC XXX.
  2906             20  AM-BENEFIT-REM-TERM       PIC X.
  2907             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2908             20  FILLER                    PIC XX.
  2909         16  FILLER                        PIC X(80).
  2910
  2911     12  AM-TRANSFER-DATA.
  2912         16  AM-TRANSFERRED-FROM.
  2913             20  AM-TRNFROM-CARRIER        PIC X.
  2914             20  AM-TRNFROM-GROUPING.
  2915                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2916                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2917             20  AM-TRNFROM-STATE          PIC XX.
  2918             20  AM-TRNFROM-ACCOUNT.
  2919                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2920                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2921             20  AM-TRNFROM-DTE            PIC XX.
  2922         16  AM-TRANSFERRED-TO.
  2923             20  AM-TRNTO-CARRIER          PIC X.
  2924             20  AM-TRNTO-GROUPING.
  2925                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2926                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2927             20  AM-TRNTO-STATE            PIC XX.
  2928             20  AM-TRNTO-ACCOUNT.
  2929                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2930                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2931             20  AM-TRNTO-DTE              PIC XX.
  2932         16  FILLER                        PIC X(10).
  2933
  2934     12  AM-SAVED-REMIT-TO                 PIC 99.
  2935
  2936     12  AM-COMM-STRUCTURE-SAVED.
  2937         16  AM-DEFN-1-SAVED.
  2938             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2939                 24  AM-AGT-SV             PIC X(10).
  2940                 24  AM-COM-TYP-SV         PIC X.
  2941                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2942                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2943                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2944                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2945                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  58
* EL162.cbl
  2946                 24  AM-GL-CODES-SV        PIC X.
  2947                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2948                 24  FILLER                PIC X.
  2949         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2950             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2951                 24  FILLER                PIC X(11).
  2952                 24  AM-L-COMA-SV          PIC XXX.
  2953                 24  AM-J-COMA-SV          PIC XXX.
  2954                 24  AM-A-COMA-SV          PIC XXX.
  2955                 24  FILLER                PIC X(6).
  2956
  2957     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2958         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2959            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2960            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2961            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2962
  2963     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2964     12  FILLER                            PIC X(120).
  2965
  2966     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2967         16  AM-CONTROL-NAME               PIC X(30).
  2968         16  AM-EXECUTIVE-ONE.
  2969             20  AM-EXEC1-NAME             PIC X(15).
  2970             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2971                                                          COMP-3.
  2972             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2973                                                          COMP-3.
  2974         16  AM-EXECUTIVE-TWO.
  2975             20  AM-EXEC2-NAME             PIC X(15).
  2976             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2977                                                          COMP-3.
  2978             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2979                                                          COMP-3.
  2980
  2981     12  AM-RETRO-ADDITIONAL-DATA.
  2982         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2983         16  AM-RETRO-PREM-P-E             PIC X.
  2984         16  AM-RETRO-CLMS-P-I             PIC X.
  2985         16  AM-RETRO-RET-BRACKET-LF.
  2986             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2987                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2988                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2989             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2990                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2991                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2992             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2993                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2994                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2995         16  AM-RETRO-RET-BRACKET-AH.
  2996             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2997                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2998                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2999                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3000             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3001                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3002                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3003             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  59
* EL162.cbl
  3004                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3005                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3006
  3007     12  AM-COMMENTS.
  3008         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3009
  3010     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3011         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3012         16  AM-FLI-BILLING-CODE           PIC X.
  3013         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3014         16  AM-FLI-UNITED-IDENT           PIC X.
  3015         16  AM-FLI-INTEREST-LOST-DATA.
  3016             20  AM-FLI-BANK-NO            PIC X(5).
  3017             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3018             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3019             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3020         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3021             20  AM-FLI-AGT                PIC X(9).
  3022             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3023             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3024         16  FILLER                        PIC X(102).
  3025
  3026     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3027         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3028             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3029             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3030             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3031             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3032             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3033         16  FILLER                          PIC X(10).
  3034******************************************************************
  3035
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  60
* EL162.cbl
  3037 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  3038                          ACTIVITY-TRAILERS ACCOUNT-MASTER.
  3039 0000-DFHEXIT SECTION.
  3040     MOVE '9#                    $   ' TO DFHEIV0.
  3041     MOVE 'EL162' TO DFHEIV1.
  3042     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3043
  3044     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3045     MOVE '5'                   TO DC-OPTION-CODE.
  3046     PERFORM 9700-DATE-LINK.
  3047     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3048     MOVE DC-BIN-DATE-1         TO  BIN-CURRENT-DATE.
  3049
  3050     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  3051
  3052     IF PI-COMPANY-ID = 'DMD'
  3053         MOVE -1                TO  DC-ELAPSED-MONTHS
  3054         MOVE +0                TO  DC-ELAPSED-DAYS
  3055         MOVE '6'               TO  DC-OPTION-CODE
  3056         PERFORM 9700-DATE-LINK
  3057         MOVE DC-BIN-DATE-2     TO  CURRENT-MINUS1-SAVE.
  3058
  3059     IF EIBCALEN NOT GREATER THAN ZERO
  3060         GO TO 8800-UNAUTHORIZED-ACCESS.
  3061
  3062     IF PI-CALLING-PROGRAM = PGM-EL150
  3063         MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3064         MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3065         MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3066         MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3067         MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3068         MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3069         MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3070         MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3071         MOVE +1                   TO SUB
  3072         PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3073         MOVE LOW-VALUES           TO EL162AO
  3074                                      PI-DISPLAYED-TRAILER-CODES
  3075         MOVE 1                    TO PI-ACTV-SEQ
  3076                                      PI-NEXT-TRLR-SUB
  3077         GO TO 7000-BUILD-SCREEN.
  3078
  3079     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3080         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3081************ FIRST TIME IN FROM MENU, FORCE THE CLAIM
  3082************ TO BE DESIGNATED THRU EL132.
  3083             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3084             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3085             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3086             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3087             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3088             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3089             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3090             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3091             MOVE PGM-EL132            TO PGM-NAME
  3092             GO TO 9300-XCTL
  3093         ELSE
  3094             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  61
* EL162.cbl
  3095             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3096             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3097             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3098             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3099             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3100             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3101             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  3102             MOVE +1                   TO SUB
  3103             PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3104             MOVE LOW-VALUES           TO EL162AO
  3105                                       PI-DISPLAYED-TRAILER-CODES
  3106             MOVE 1                    TO PI-ACTV-SEQ
  3107                                          PI-NEXT-TRLR-SUB
  3108             GO TO 7000-BUILD-SCREEN.
  3109
  3110     IF EIBAID = DFHCLEAR
  3111         GO TO 9400-CLEAR.
  3112
  3113
  3114* EXEC CICS HANDLE CONDITION
  3115*        PGMIDERR(9600-PGMID-ERROR)
  3116*        ERROR   (9990-ABEND)
  3117*    END-EXEC.
  3118*    MOVE '"$L.                  ! " #00003109' TO DFHEIV0
  3119     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3121     MOVE X'2220233030303033313039' TO DFHEIV0(25:11)
  3122     CALL 'kxdfhei1' USING DFHEIV0
  3123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3124
  3125
  3126     IF PI-PROCESSOR-ID = 'LGXX'
  3127         GO TO 0200-RECEIVE.
  3128
  3129
  3130* EXEC CICS READQ TS
  3131*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3132*        INTO    (SECURITY-CONTROL)
  3133*        LENGTH  (SC-COMM-LENGTH)
  3134*        ITEM    (SC-ITEM)
  3135*    END-EXEC.
  3136*    MOVE '*$II   L              ''   #00003117' TO DFHEIV0
  3137     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3138     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3139     MOVE X'2020233030303033313137' TO DFHEIV0(25:11)
  3140     CALL 'kxdfhei1' USING DFHEIV0,
  3141           PI-SECURITY-TEMP-STORE-ID,
  3142           SECURITY-CONTROL,
  3143           SC-COMM-LENGTH,
  3144           SC-ITEM,
  3145           DFHEIV99,
  3146           DFHEIV99
  3147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3148
  3149
  3150     MOVE SC-CLAIMS-DISPLAY (2)    TO  PI-DISPLAY-CAP.
  3151     MOVE SC-CLAIMS-UPDATE  (2)    TO  PI-MODIFY-CAP.
  3152
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  62
* EL162.cbl
  3153     IF NOT MODIFY-CAP
  3154         MOVE 'UPDATE'             TO  SM-READ
  3155         PERFORM 9995-SECURITY-VIOLATION
  3156         MOVE ER-0070              TO  EMI-ERROR
  3157         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3158         GO TO 8100-SEND-INITIAL-MAP.
  3159
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  63
* EL162.cbl
  3161 0200-RECEIVE.
  3162
  3163     MOVE LOW-VALUES TO EL162AI.
  3164
  3165     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3166         MOVE ER-0008            TO EMI-ERROR
  3167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3168         GO TO 8200-SEND-DATAONLY.
  3169
  3170
  3171* EXEC CICS RECEIVE
  3172*        MAP   (MAP-NAME)
  3173*        MAPSET(MAPSET-NAME)
  3174*        INTO  (EL162AI)
  3175*    END-EXEC.
  3176     MOVE LENGTH OF
  3177      EL162AI
  3178       TO DFHEIV11
  3179*    MOVE '8"T I  L              ''   #00003144' TO DFHEIV0
  3180     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3182     MOVE X'2020233030303033313434' TO DFHEIV0(25:11)
  3183     CALL 'kxdfhei1' USING DFHEIV0,
  3184           MAP-NAME,
  3185           EL162AI,
  3186           DFHEIV11,
  3187           MAPSET-NAME,
  3188           DFHEIV99,
  3189           DFHEIV99
  3190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3191
  3192
  3193     IF ENTERPFL = ZERO
  3194         GO TO 0300-CHECK-PFKEYS.
  3195
  3196     IF EIBAID NOT = DFHENTER
  3197         MOVE ER-0004            TO EMI-ERROR
  3198         GO TO 0320-INPUT-ERROR.
  3199
  3200     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3201         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3202     ELSE
  3203         MOVE ER-0029            TO EMI-ERROR
  3204         GO TO 0320-INPUT-ERROR.
  3205
  3206 0300-CHECK-PFKEYS.
  3207     IF EIBAID = DFHPF23
  3208         GO TO 8810-PF23.
  3209
  3210     IF EIBAID = DFHPF24
  3211         GO TO 9200-RETURN-MAIN-MENU.
  3212
  3213     IF EIBAID = DFHPF12
  3214         GO TO 9500-PF12.
  3215
  3216     IF PI-COMPANY-ID = 'DMD'
  3217         MOVE SPACE              TO PI-DMD-FORCE-ERROR.
  3218
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  64
* EL162.cbl
  3219     IF EIBAID = DFHPF4
  3220         IF PI-COMPANY-ID NOT = 'DMD'
  3221             MOVE ER-0029        TO EMI-ERROR
  3222             GO TO 0320-INPUT-ERROR
  3223         ELSE
  3224             MOVE 'X'            TO PI-DMD-FORCE-ERROR
  3225             MOVE DFHENTER       TO EIBAID
  3226             GO TO 0330-EDIT-DATA.
  3227
  3228     IF EIBAID = DFHPF5
  3229         IF PI-RETURN-TO-PROGRAM = 'EL150'
  3230             MOVE ER-0029        TO EMI-ERROR
  3231             GO TO 0320-INPUT-ERROR
  3232         ELSE
  3233             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  3234             MOVE PGM-EL132      TO PGM-NAME
  3235             GO TO 9300-XCTL.
  3236
  3237     IF PI-CLAIM-NO = SPACES
  3238        MOVE ER-0319             TO EMI-ERROR
  3239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3240        GO TO 8100-SEND-INITIAL-MAP.
  3241
  3242     IF SC-RECL (1) > 0 OR SC-STOPL (1) > 0 OR
  3243        SC-RECL (2) > 0 OR SC-STOPL (2) > 0 OR
  3244        SC-RECL (3) > 0 OR SC-STOPL (3) > 0 OR
  3245        SC-RECL (4) > 0 OR SC-STOPL (4) > 0 OR
  3246        UREL > 0  OR USENTL > 0  OR
  3247*00409         UBYL > 0  OR UFORML > 0  OR URECDTEL > 0
  3248        UFORML > 0  OR URECDTEL > 0
  3249          IF EIBAID NOT = DFHENTER
  3250             MOVE ER-0050            TO EMI-ERROR
  3251             GO TO 0320-INPUT-ERROR.
  3252
  3253     IF EIBAID = DFHPF1
  3254         GO TO 6000-BROWSE-FORWARD.
  3255
  3256     IF EIBAID = DFHPF2
  3257         GO TO 6100-BROWSE-BACKWARD.
  3258
  3259     IF EIBAID = DFHPF6
  3260         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  3261         MOVE PGM-EL141          TO PGM-NAME
  3262         GO TO 9300-XCTL.
  3263
  3264     IF EIBAID = DFHPF7
  3265         MOVE PGM-EL1284          TO PGM-NAME
  3266         GO TO 9300-XCTL.
  3267
  3268     IF EIBAID = DFHENTER
  3269         GO TO 0330-EDIT-DATA.
  3270
  3271     MOVE ER-0029                TO EMI-ERROR.
  3272
  3273 0320-INPUT-ERROR.
  3274     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3275
  3276     MOVE AL-UNBON        TO ENTERPFA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  65
* EL162.cbl
  3277
  3278     IF ENTERPFL = 0
  3279         MOVE -1          TO URECDTEL
  3280     ELSE
  3281         MOVE -1          TO ENTERPFL.
  3282
  3283     GO TO 8200-SEND-DATAONLY.
  3284
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  66
* EL162.cbl
  3286 0330-EDIT-DATA.
  3287     SET SC-INDX  INDX           TO 1.
  3288     SET INDX2                   TO 1.
  3289
  3290 0331-LOOP.
  3291     IF SC-RECL (SC-INDX) > ZERO
  3292        MOVE SC-REC (SC-INDX)    TO DEEDIT-FIELD
  3293        PERFORM 8600-DEEDIT
  3294        MOVE '1'                 TO REC-DATA-SW
  3295        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3296        MOVE '4'                 TO DC-OPTION-CODE
  3297        PERFORM 9700-DATE-LINK
  3298        IF DATE-CONVERSION-ERROR
  3299           MOVE ER-0021          TO EMI-ERROR
  3300           MOVE -1               TO SC-RECL (SC-INDX)
  3301           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3302           PERFORM 9900-ERROR-FORMAT
  3303                                 THRU 9900-EXIT
  3304        ELSE
  3305           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3306              MOVE ER-0539       TO EMI-ERROR
  3307              MOVE -1            TO SC-RECL (SC-INDX)
  3308              MOVE AL-UABON      TO SC-RECA (SC-INDX)
  3309              PERFORM 9900-ERROR-FORMAT
  3310                                 THRU 9900-EXIT
  3311           ELSE
  3312              MOVE DC-BIN-DATE-1 TO REC-DATE-SAVE (INDX)
  3313              MOVE DEEDIT-FIELD-V0
  3314                                 TO SC-REC-O (SC-INDX)
  3315              INSPECT SC-REC (SC-INDX) CONVERTING ' ' TO '/'
  3316           END-IF
  3317        END-IF
  3318     ELSE
  3319        MOVE LOW-VALUES          TO REC-DATE-SAVE (INDX)
  3320     END-IF
  3321     IF PI-COMPANY-ID = 'DMD'
  3322       IF SC-RECL (SC-INDX) > 0
  3323         IF REC-DATE-SAVE (INDX) < CURRENT-MINUS1-SAVE
  3324         IF NOT PI-DMD-FORCED
  3325           MOVE ER-7839        TO EMI-ERROR
  3326           MOVE -1             TO SC-RECL (SC-INDX)
  3327           MOVE AL-UABON       TO SC-RECA (SC-INDX)
  3328           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3329         END-IF
  3330         ELSE
  3331         IF REC-DATE-SAVE (INDX) > BIN-CURRENT-DATE
  3332           MOVE ER-0539          TO EMI-ERROR
  3333           MOVE -1               TO SC-RECL (SC-INDX)
  3334           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3335           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3336
  3337     IF SC-STOPL (SC-INDX) > ZERO
  3338        MOVE SC-STOP (SC-INDX)    TO DEEDIT-FIELD
  3339        PERFORM 8600-DEEDIT
  3340        MOVE '1'                 TO REC-DATA-SW
  3341        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3342        MOVE '4'                 TO DC-OPTION-CODE
  3343        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  67
* EL162.cbl
  3344        IF DATE-CONVERSION-ERROR
  3345           MOVE ER-0021          TO EMI-ERROR
  3346           MOVE -1               TO SC-STOPL (SC-INDX)
  3347           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3348           PERFORM 9900-ERROR-FORMAT
  3349                                 THRU 9900-EXIT
  3350        ELSE
  3351           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3352              MOVE ER-0895       TO EMI-ERROR
  3353              MOVE -1            TO SC-STOPL (SC-INDX)
  3354              MOVE AL-UABON      TO SC-STOPA (SC-INDX)
  3355              PERFORM 9900-ERROR-FORMAT
  3356                                 THRU 9900-EXIT
  3357           ELSE
  3358              MOVE DC-BIN-DATE-1 TO STOP-DATE-SAVE (INDX2)
  3359              MOVE DEEDIT-FIELD-V0 TO SC-STOP-O (SC-INDX)
  3360              INSPECT SC-STOP (SC-INDX) CONVERTING ' ' TO '/'
  3361           END-IF
  3362        END-IF
  3363     ELSE
  3364        MOVE LOW-VALUES          TO STOP-DATE-SAVE (INDX2)
  3365     END-IF.
  3366
  3367     SET SC-INDX
  3368            INDX2
  3369            INDX UP BY 1.
  3370
  3371     IF SC-INDX NOT = 5
  3372        GO TO 0331-LOOP.
  3373
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  68
* EL162.cbl
  3375
  3376     IF URECDTEL > 0
  3377        MOVE URECDTEI            TO DEEDIT-FIELD
  3378        PERFORM 8600-DEEDIT
  3379        MOVE '1'                 TO UNSOL-DATA-SW
  3380        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3381        MOVE '4'                 TO DC-OPTION-CODE
  3382        PERFORM 9700-DATE-LINK
  3383        IF DATE-CONVERSION-ERROR
  3384           MOVE ER-0021          TO EMI-ERROR
  3385           MOVE -1               TO URECDTEL
  3386           MOVE AL-UABON         TO URECDTEA
  3387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3388        ELSE
  3389           MOVE DC-BIN-DATE-1    TO URECDTE-SAVE
  3390           MOVE DEEDIT-FIELD-V0  TO URECDTEO
  3391           INSPECT URECDTEI CONVERTING ' ' TO '/'.
  3392
  3393     IF PI-COMPANY-ID = 'DMD'
  3394       IF URECDTEL > 0
  3395         IF URECDTE-SAVE < CURRENT-MINUS1-SAVE
  3396         IF NOT PI-DMD-FORCED
  3397           MOVE ER-7839        TO EMI-ERROR
  3398           MOVE -1             TO URECDTEL
  3399           MOVE AL-UABON       TO URECDTEA
  3400           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3401         END-IF
  3402         ELSE
  3403         IF URECDTE-SAVE > BIN-CURRENT-DATE
  3404           MOVE ER-0539          TO EMI-ERROR
  3405           MOVE -1               TO URECDTEL
  3406           MOVE AL-UABON         TO URECDTEA
  3407           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3408
  3409     IF USENTL > 0
  3410        MOVE USENTI              TO DEEDIT-FIELD
  3411        PERFORM 8600-DEEDIT
  3412        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3413        MOVE '4'                 TO DC-OPTION-CODE
  3414        PERFORM 9700-DATE-LINK
  3415        IF DATE-CONVERSION-ERROR
  3416           MOVE ER-0021          TO EMI-ERROR
  3417           MOVE -1               TO USENTL
  3418           MOVE AL-UABON         TO USENTA
  3419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3420          ELSE
  3421           MOVE DC-BIN-DATE-1    TO USENT-SAVE
  3422           MOVE DEEDIT-FIELD-V0  TO USENTO
  3423           INSPECT USENTI CONVERTING ' ' TO '/'
  3424        ELSE
  3425           MOVE LOW-VALUES       TO USENT-SAVE.
  3426
  3427     IF USENT-SAVE   NOT = LOW-VALUES AND
  3428        URECDTE-SAVE NOT = LOW-VALUES
  3429          IF USENT-SAVE GREATER THAN URECDTE-SAVE
  3430             MOVE ER-0514        TO EMI-ERROR
  3431             MOVE -1             TO URECDTEL
  3432             MOVE AL-UABON       TO URECDTEA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  69
* EL162.cbl
  3433             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3434
  3435     IF URECDTE-SAVE NOT = LOW-VALUES
  3436          IF URECDTE-SAVE GREATER THAN BIN-CURRENT-DATE
  3437             MOVE ER-0539        TO EMI-ERROR
  3438             MOVE -1             TO URECDTEL
  3439             MOVE AL-UABON       TO URECDTEA
  3440             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3441
  3442     IF URECDTEL = ZEROS
  3443        IF USENTL > ZEROS  OR
  3444*00570            UBYL   > ZEROS  OR
  3445           UFORML > ZEROS  OR
  3446           UREL   > ZEROS
  3447              MOVE ER-0321          TO EMI-ERROR
  3448              MOVE -1               TO URECDTEL
  3449              PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT.
  3450     IF AUTHRCVL > 0
  3451        IF AUTHRCVI = 'N' OR 'Y'
  3452           CONTINUE
  3453        ELSE
  3454           MOVE ER-0287        TO EMI-ERROR
  3455           MOVE -1             TO AUTHRCVL
  3456           MOVE AL-UABON       TO AUTHRCVA
  3457           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3458        END-IF
  3459     END-IF.
  3460
  3461     IF NOT EMI-NO-ERRORS
  3462        GO TO 8200-SEND-DATAONLY.
  3463
  3464     IF NOT MODIFY-CAP
  3465         MOVE ER-0070            TO EMI-ERROR
  3466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3467         MOVE LOW-VALUES TO EL162AO
  3468         GO TO 8100-SEND-INITIAL-MAP.
  3469
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  70
* EL162.cbl
  3471     PERFORM 3000-BUILD-KEYS.
  3472
  3473     IF REC-DATA
  3474        PERFORM 4000-UPDATE-RECEIVE-DATES THRU 4099-EXIT
  3475                VARYING SC-INDX FROM 1 BY 1 UNTIL
  3476                SC-INDX = 5.
  3477
  3478     PERFORM 4100-CREATE-NEW-TRLR THRU 4199-EXIT.
  3479
  3480     MOVE ER-ZEROS               TO EMI-ERROR.
  3481     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  3482                                    ZIPI PHONEI.
  3483
  3484     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3485
  3486     MOVE -1                     TO SC-RECL (1).
  3487     GO TO 8200-SEND-DATAONLY.
  3488
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  71
* EL162.cbl
  3490 2000-ZERO-PI-TRLR-TABLE.
  3491
  3492     MOVE +0                     TO PI-TRLRS (SUB).
  3493     ADD +1 TO SUB.
  3494
  3495     IF SUB > +50
  3496        MOVE +0                  TO SUB
  3497        GO TO 2010-EXIT.
  3498
  3499     GO TO 2000-ZERO-PI-TRLR-TABLE.
  3500
  3501 2010-EXIT.
  3502     EXIT.
  3503
  3504 3000-BUILD-KEYS.
  3505     MOVE PI-CLAIM-NO            TO PI-CLAM-CLAIM
  3506                                    PI-ACTV-CLAIM
  3507                                    CLAIMNOI.
  3508
  3509     MOVE PI-CERT-NO             TO PI-CLAM-CERT-NO
  3510                                    PI-ACTV-CERT-NO
  3511                                    CERTNOI.
  3512
  3513     MOVE PI-COMPANY-CD          TO PI-CLAM-COMP-CD
  3514                                    PI-ACTV-COMP-CD.
  3515
  3516     MOVE PI-CARRIER             TO PI-CLAM-CARRIER
  3517                                    PI-ACTV-CARRIER
  3518                                    CARRI.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  72
* EL162.cbl
  3520 4000-UPDATE-RECEIVE-DATES.
  3521
  3522     IF SC-RECL (SC-INDX) = ZERO AND SC-STOPL (SC-INDX)
  3523        GO TO 4099-EXIT.
  3524
  3525     MOVE SC-TRLRNO (SC-INDX)    TO PI-ACTV-SEQ.
  3526
  3527*00648      IF SC-RECL (SC-INDX) = ZERO
  3528*00649          EXEC CICS READ
  3529*00650               DATASET (ELTRLR-FILE-ID)
  3530*00651               RIDFLD  (PI-ACTV-KEY)
  3531*00652               SET     (ADDRESS OF ACTIVITY-TRAILERS)
  3532*00653          END-EXEC
  3533*00654         ELSE
  3534
  3535* EXEC CICS READ
  3536*             DATASET(ELTRLR-FILE-ID)
  3537*             RIDFLD (PI-ACTV-KEY)
  3538*             SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3539*             UPDATE
  3540*        END-EXEC.
  3541*    MOVE '&"S        EU         (   #00003491' TO DFHEIV0
  3542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3543     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3544     MOVE X'2020233030303033343931' TO DFHEIV0(25:11)
  3545     CALL 'kxdfhei1' USING DFHEIV0,
  3546           ELTRLR-FILE-ID,
  3547           DFHEIV20,
  3548           DFHEIV99,
  3549           PI-ACTV-KEY,
  3550           DFHEIV99,
  3551           DFHEIV99,
  3552           DFHEIV99
  3553     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3554         DFHEIV20
  3555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3556
  3557
  3558     SET INDX2 TO SC-INDX.
  3559
  3560     IF SC-STOPL (SC-INDX) = ZEROS
  3561         GO TO 4000-BYPASS-STOP-DATE
  3562     END-IF.
  3563
  3564     IF (CORRESPONDENCE-TR AND
  3565         STOP-DATE-SAVE (INDX2) LESS THAN AT-LETTER-SENT-DT)
  3566              OR
  3567        (FORM-CONTROL-TR AND
  3568         STOP-DATE-SAVE (INDX2) LESS THAN AT-FORM-SEND-ON-DT)
  3569           MOVE ER-0896          TO EMI-ERROR
  3570           MOVE -1               TO SC-STOPL (SC-INDX)
  3571           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3572           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3573
  3574* EXEC CICS SYNCPOINT
  3575*               ROLLBACK
  3576*          END-EXEC
  3577*    MOVE '6"R                   !   #00003513' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  73
* EL162.cbl
  3578     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3580     MOVE X'2020233030303033353133' TO DFHEIV0(25:11)
  3581     CALL 'kxdfhei1' USING DFHEIV0
  3582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3583           GO TO 8200-SEND-DATAONLY
  3584     END-IF.
  3585
  3586     IF CORRESPONDENCE-TR
  3587        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-LETTER-DT
  3588        MOVE PI-PROCESSOR-ID     TO AT-CORR-LAST-UPDATED-BY
  3589        MOVE BIN-CURRENT-DATE    TO AT-CORR-LAST-MAINT-DT
  3590     END-IF.
  3591
  3592     IF FORM-CONTROL-TR
  3593        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-FORM-DT
  3594        MOVE PI-PROCESSOR-ID     TO AT-FORM-LAST-UPDATED-BY
  3595        MOVE BIN-CURRENT-DATE    TO AT-FORM-LAST-MAINT-DT
  3596     END-IF.
  3597     MOVE AL-UANOF               TO SC-STOPA (SC-INDX).
  3598
  3599 4000-BYPASS-STOP-DATE.
  3600
  3601     IF SC-RECL (SC-INDX) = ZEROS
  3602*00673         GO TO 4099-EXIT.
  3603        GO TO 4090-REWRITE
  3604     END-IF.
  3605
  3606     SET INDX TO SC-INDX.
  3607
  3608     IF (CORRESPONDENCE-TR AND
  3609         REC-DATE-SAVE (INDX)  LESS THAN AT-LETTER-SENT-DT)
  3610              OR
  3611        (FORM-CONTROL-TR AND
  3612         REC-DATE-SAVE (INDX)  LESS THAN AT-FORM-SEND-ON-DT)
  3613           MOVE ER-0514          TO EMI-ERROR
  3614           MOVE -1               TO SC-RECL (SC-INDX)
  3615           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3616           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3617
  3618* EXEC CICS SYNCPOINT
  3619*               ROLLBACK
  3620*          END-EXEC
  3621*    MOVE '6"R                   !   #00003550' TO DFHEIV0
  3622     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3624     MOVE X'2020233030303033353530' TO DFHEIV0(25:11)
  3625     CALL 'kxdfhei1' USING DFHEIV0
  3626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3627           GO TO 8200-SEND-DATAONLY.
  3628
  3629     IF CORRESPONDENCE-TR
  3630        MOVE REC-DATE-SAVE (INDX)   TO AT-LETTER-ANSWERED-DT
  3631        MOVE PI-PROCESSOR-ID        TO AT-CORR-LAST-UPDATED-BY
  3632        MOVE BIN-CURRENT-DATE       TO AT-CORR-LAST-MAINT-DT.
  3633
  3634     IF FORM-CONTROL-TR
  3635        MOVE PI-PROCESSOR-ID        TO AT-FORM-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  74
* EL162.cbl
  3636        MOVE BIN-CURRENT-DATE       TO AT-FORM-LAST-MAINT-DT
  3637        IF SC-TYPE (SC-INDX) = 'C'
  3638           MOVE REC-DATE-SAVE (INDX)   TO AT-FORM-ANSWERED-DT
  3639        ELSE
  3640        IF SC-TYPE (SC-INDX) = 'E'
  3641           MOVE REC-DATE-SAVE (INDX)   TO AT-EMP-FORM-ANSWERED-DT
  3642        ELSE
  3643        IF SC-TYPE (SC-INDX) = 'P'
  3644           MOVE REC-DATE-SAVE (INDX)   TO AT-PHY-FORM-ANSWERED-DT.
  3645
  3646     MOVE AL-UANOF               TO SC-RECA (SC-INDX).
  3647
  3648 4090-REWRITE.
  3649
  3650     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3651
  3652     IF PI-COMPANY-ID = 'DMD'
  3653         MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY.
  3654
  3655
  3656* EXEC CICS REWRITE
  3657*         FROM   (ACTIVITY-TRAILERS)
  3658*         DATASET(ELTRLR-FILE-ID)
  3659*    END-EXEC.
  3660     MOVE LENGTH OF
  3661      ACTIVITY-TRAILERS
  3662       TO DFHEIV11
  3663*    MOVE '&& L                  %   #00003581' TO DFHEIV0
  3664     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3665     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3666     MOVE X'2020233030303033353831' TO DFHEIV0(25:11)
  3667     CALL 'kxdfhei1' USING DFHEIV0,
  3668           ELTRLR-FILE-ID,
  3669           ACTIVITY-TRAILERS,
  3670           DFHEIV11,
  3671           DFHEIV99
  3672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3673
  3674
  3675 4099-EXIT.
  3676      EXIT.
  3677
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  75
* EL162.cbl
  3679 4100-CREATE-NEW-TRLR.
  3680
  3681
  3682* EXEC CICS READ
  3683*         DATASET(ELMSTR-FILE-ID)
  3684*         SET    (ADDRESS OF CLAIM-MASTER)
  3685*         RIDFLD (PI-CLAM-KEY)
  3686*         UPDATE
  3687*    END-EXEC.
  3688*    MOVE '&"S        EU         (   #00003592' TO DFHEIV0
  3689     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3690     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3691     MOVE X'2020233030303033353932' TO DFHEIV0(25:11)
  3692     CALL 'kxdfhei1' USING DFHEIV0,
  3693           ELMSTR-FILE-ID,
  3694           DFHEIV20,
  3695           DFHEIV99,
  3696           PI-CLAM-KEY,
  3697           DFHEIV99,
  3698           DFHEIV99,
  3699           DFHEIV99
  3700     SET ADDRESS OF CLAIM-MASTER TO
  3701         DFHEIV20
  3702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3703
  3704
  3705     IF FILEL > ZEROS
  3706        MOVE FILEI               TO CL-FILE-LOCATION.
  3707
  3708     IF NOT UNSOL-DATA
  3709        GO TO 4150-REWRITE-CLAIM.
  3710
  3711     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  3712
  3713
  3714* EXEC CICS GETMAIN
  3715*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3716*         INITIMG(GETMAIN-SPACE)
  3717*         LENGTH (ACTV-LENGTH)
  3718*    END-EXEC.
  3719*    MOVE ',"IL                  $   #00003607' TO DFHEIV0
  3720     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3722     MOVE X'2020233030303033363037' TO DFHEIV0(25:11)
  3723     CALL 'kxdfhei1' USING DFHEIV0,
  3724           DFHEIV20,
  3725           ACTV-LENGTH,
  3726           GETMAIN-SPACE
  3727     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3728         DFHEIV20
  3729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3730
  3731
  3732     MOVE 'AT'                   TO AT-RECORD-ID.
  3733     MOVE  4                     TO AT-TRAILER-TYPE.
  3734     MOVE BIN-CURRENT-DATE       TO AT-RECORDED-DT
  3735                                    AT-CORR-LAST-MAINT-DT
  3736
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  76
* EL162.cbl
  3737     IF UBYL > +0
  3738        MOVE UBYI                TO AT-RECORDED-BY
  3739                                    AT-CORR-LAST-UPDATED-BY
  3740     ELSE
  3741        MOVE PI-PROCESSOR-ID     TO AT-RECORDED-BY
  3742                                    AT-CORR-LAST-UPDATED-BY.
  3743
  3744     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3745     MOVE PI-ACTV-KEY            TO AT-CONTROL-PRIMARY.
  3746     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  3747     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
  3748     MOVE USENT-SAVE             TO AT-LETTER-SENT-DT.
  3749     MOVE LOW-VALUES             TO AT-RECEIPT-FOLLOW-UP
  3750                                    AT-AUTO-RE-SEND-DT
  3751                                    AT-INITIAL-PRINT-DATE
  3752                                    AT-RESEND-PRINT-DATE.
  3753     MOVE URECDTE-SAVE           TO AT-LETTER-ANSWERED-DT.
  3754     MOVE ZEROS                  TO AT-LETTER-ARCHIVE-NO.
  3755     MOVE '1'                    TO AT-LETTER-ORIGIN.
  3756
  3757     IF UFORML > 0
  3758        MOVE UFORMI              TO AT-STD-LETTER-FORM
  3759       ELSE
  3760        MOVE SPACES              TO AT-STD-LETTER-FORM.
  3761
  3762     IF UREL > 0
  3763        MOVE UREI                TO AT-REASON-TEXT
  3764       ELSE
  3765        MOVE SPACES              TO AT-REASON-TEXT.
  3766     IF AUTHRCVL > 0
  3767        MOVE AUTHRCVI            TO AT-AUTH-RCVD
  3768     ELSE
  3769        MOVE SPACES              TO AT-AUTH-RCVD
  3770     END-IF.
  3771
  3772     MOVE SPACES                 TO AT-ADDRESSEE-NAME
  3773                                    AT-ADDRESEE-TYPE.
  3774     MOVE ZEROS                  TO AT-ADDRESS-REC-SEQ-NO.
  3775     MOVE 'U'                    TO AT-CORR-SOL-UNSOL.
  3776
  3777
  3778* EXEC CICS WRITE
  3779*         DATASET(ELTRLR-FILE-ID)
  3780*         FROM   (ACTIVITY-TRAILERS)
  3781*         RIDFLD (AT-CONTROL-PRIMARY)
  3782*    END-EXEC.
  3783     MOVE LENGTH OF
  3784      ACTIVITY-TRAILERS
  3785       TO DFHEIV11
  3786*    MOVE '&$ L                  ''   #00003658' TO DFHEIV0
  3787     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3788     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3789     MOVE X'2020233030303033363538' TO DFHEIV0(25:11)
  3790     CALL 'kxdfhei1' USING DFHEIV0,
  3791           ELTRLR-FILE-ID,
  3792           ACTIVITY-TRAILERS,
  3793           DFHEIV11,
  3794           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  77
* EL162.cbl
  3795           DFHEIV99,
  3796           DFHEIV99
  3797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3798
  3799
  3800     MOVE SPACES                 TO URECDTEI
  3801                                    USENTI
  3802*00795                                     UBYI
  3803                                    UFORMI
  3804                                    UREI.
  3805
  3806     MOVE AL-UANOF               TO URECDTEA
  3807                                    USENTA
  3808*00801                                     UBYA
  3809                                    UFORMA
  3810                                    UREA.
  3811
  3812     MOVE PI-PROCESSOR-ID        TO UBYI.
  3813
  3814 4150-REWRITE-CLAIM.
  3815
  3816* EXEC CICS HANDLE CONDITION
  3817*        DUPKEY (4199-EXIT)
  3818*    END-EXEC.
  3819*    MOVE '"$$                   ! # #00003679' TO DFHEIV0
  3820     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  3821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3822     MOVE X'2320233030303033363739' TO DFHEIV0(25:11)
  3823     CALL 'kxdfhei1' USING DFHEIV0
  3824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3825
  3826
  3827     MOVE PI-PROCESSOR-ID   TO  CL-LAST-MAINT-USER.
  3828     MOVE EIBTIME           TO  CL-LAST-MAINT-HHMMSS.
  3829     MOVE BIN-CURRENT-DATE  TO  CL-LAST-MAINT-DT.
  3830     MOVE '2'               TO  CL-LAST-MAINT-TYPE.
  3831
  3832     IF PI-COMPANY-ID = 'DMD'
  3833         MOVE 11                 TO CL-ACTIVITY-CODE
  3834         MOVE BIN-CURRENT-DATE   TO CL-ACTIVITY-MAINT-DT
  3835         MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  3836         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
  3837
  3838
  3839* EXEC CICS REWRITE
  3840*         DATASET(ELMSTR-FILE-ID)
  3841*         FROM   (CLAIM-MASTER)
  3842*    END-EXEC.
  3843     MOVE LENGTH OF
  3844      CLAIM-MASTER
  3845       TO DFHEIV11
  3846*    MOVE '&& L                  %   #00003694' TO DFHEIV0
  3847     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3848     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3849     MOVE X'2020233030303033363934' TO DFHEIV0(25:11)
  3850     CALL 'kxdfhei1' USING DFHEIV0,
  3851           ELMSTR-FILE-ID,
  3852           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  78
* EL162.cbl
  3853           DFHEIV11,
  3854           DFHEIV99
  3855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3856
  3857
  3858 4199-EXIT.
  3859      EXIT.
  3860
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  79
* EL162.cbl
  3862 4200-LOCATE-ADDRESS.
  3863     IF ADDR-TYPE = '3' AND ADDR-SEQ = ZEROS
  3864        GO TO 4210-READ-ACCOUNT.
  3865
  3866     IF ADDR-TYPE = SPACES OR ADDR-SEQ = ZEROS
  3867        GO TO 4290-ERROR.
  3868
  3869     MOVE ADDR-SEQ               TO PI-ACTV-SEQ.
  3870
  3871
  3872* EXEC CICS HANDLE CONDITION
  3873*         NOTFND(4290-ERROR)
  3874*    END-EXEC.
  3875*    MOVE '"$I                   ! $ #00003712' TO DFHEIV0
  3876     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3878     MOVE X'2420233030303033373132' TO DFHEIV0(25:11)
  3879     CALL 'kxdfhei1' USING DFHEIV0
  3880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3881
  3882
  3883
  3884* EXEC CICS READ
  3885*         DATASET(ELTRLR-FILE-ID)
  3886*         RIDFLD (PI-ACTV-KEY)
  3887*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3888*    END-EXEC.
  3889*    MOVE '&"S        E          (   #00003716' TO DFHEIV0
  3890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3892     MOVE X'2020233030303033373136' TO DFHEIV0(25:11)
  3893     CALL 'kxdfhei1' USING DFHEIV0,
  3894           ELTRLR-FILE-ID,
  3895           DFHEIV20,
  3896           DFHEIV99,
  3897           PI-ACTV-KEY,
  3898           DFHEIV99,
  3899           DFHEIV99,
  3900           DFHEIV99
  3901     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3902         DFHEIV20
  3903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3904
  3905
  3906     MOVE AT-MAIL-TO-NAME        TO ADDR1O.
  3907     MOVE AT-ADDRESS-LINE-1      TO ADDR2O.
  3908     MOVE AT-ADDRESS-LINE-2      TO ADDR3O.
  3909*    MOVE AT-CITY-STATE          TO ADDR4O.
  3910     STRING AT-CITY ' ' AT-STATE
  3911        DELIMITED BY '  ' INTO ADDR4O
  3912     END-STRING
  3913     MOVE AT-PHONE-NO            TO PHONEO.
  3914     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3915
  3916     IF AT-CANADIAN-POST-CODE
  3917         MOVE AT-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3918         MOVE AT-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3919         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  80
* EL162.cbl
  3920                                    WS-CAN-FILLER
  3921         MOVE WS-CANADIAN-POSTAL-CODES
  3922                                 TO ZIPO
  3923     ELSE
  3924         MOVE AT-ZIP-CODE        TO WS-ZIP-CODE
  3925         IF AT-ZIP-PLUS4 = SPACES OR ZEROS
  3926             MOVE SPACES         TO WS-ZIP-PLUS4
  3927                                    WS-DASH
  3928             MOVE WS-ZIP         TO ZIPO
  3929         ELSE
  3930             MOVE AT-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3931             MOVE '-'            TO WS-DASH
  3932             MOVE WS-ZIP         TO ZIPO.
  3933
  3934     GO TO 4299-EXIT.
  3935
  3936 4210-READ-ACCOUNT.
  3937     MOVE PI-COMPANY-CD          TO ACCT-CO.
  3938     MOVE PI-CARRIER             TO ACCT-CARRIER.
  3939     MOVE PI-GROUPING            TO ACCT-GROUPING.
  3940     MOVE PI-STATE               TO ACCT-STATE.
  3941     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  3942     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DATE.
  3943
  3944
  3945* EXEC CICS HANDLE CONDITION
  3946*         NOTOPEN(8880-ACCT-NOT-OPEN)
  3947*         NOTFND (4250-ACCT-NOT-FOUND)
  3948*    END-EXEC.
  3949*    MOVE '"$JI                  ! % #00003760' TO DFHEIV0
  3950     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3952     MOVE X'2520233030303033373630' TO DFHEIV0(25:11)
  3953     CALL 'kxdfhei1' USING DFHEIV0
  3954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3955
  3956
  3957
  3958* EXEC CICS STARTBR
  3959*         RIDFLD   (ACCT-KEY)
  3960*         DATASET  (ERACCT-FILE-ID)
  3961*         KEYLENGTH(13)
  3962*         GENERIC
  3963*    END-EXEC.
  3964     MOVE 13
  3965       TO DFHEIV11
  3966     MOVE 0
  3967       TO DFHEIV12
  3968*    MOVE '&,   KG    G          &   #00003765' TO DFHEIV0
  3969     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3971     MOVE X'2020233030303033373635' TO DFHEIV0(25:11)
  3972     CALL 'kxdfhei1' USING DFHEIV0,
  3973           ERACCT-FILE-ID,
  3974           ACCT-KEY,
  3975           DFHEIV11,
  3976           DFHEIV12,
  3977           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  81
* EL162.cbl
  3978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3979
  3980
  3981     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  3982
  3983 4230-READNEXT.
  3984
  3985* EXEC CICS READNEXT
  3986*         DATASET(ERACCT-FILE-ID)
  3987*         SET    (ADDRESS OF ACCOUNT-MASTER)
  3988*         RIDFLD (ACCT-KEY)
  3989*    END-EXEC.
  3990     MOVE 0
  3991       TO DFHEIV11
  3992*    MOVE '&.S                   )   #00003775' TO DFHEIV0
  3993     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3994     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3995     MOVE X'2020233030303033373735' TO DFHEIV0(25:11)
  3996     CALL 'kxdfhei1' USING DFHEIV0,
  3997           ERACCT-FILE-ID,
  3998           DFHEIV20,
  3999           DFHEIV99,
  4000           ACCT-KEY,
  4001           DFHEIV99,
  4002           DFHEIV11,
  4003           DFHEIV99,
  4004           DFHEIV99
  4005     SET ADDRESS OF ACCOUNT-MASTER TO
  4006         DFHEIV20
  4007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4008
  4009
  4010     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  4011        GO TO 4250-ACCT-NOT-FOUND.
  4012
  4013     IF PI-CERT-EFF-DT NOT LESS THAN AM-EFFECTIVE-DT AND
  4014        PI-CERT-EFF-DT     LESS THAN AM-EXPIRATION-DT
  4015        NEXT SENTENCE
  4016      ELSE
  4017        GO TO 4230-READNEXT.
  4018
  4019     MOVE AM-NAME                TO ADDR1O.
  4020     MOVE AM-PERSON              TO ADDR2O.
  4021     MOVE AM-ADDRS               TO ADDR3O.
  4022*    MOVE AM-CITY                TO ADDR4O.
  4023     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  4024        DELIMITED BY '  ' INTO ADDR4O
  4025     END-STRING
  4026
  4027     MOVE AM-TEL-NO              TO WS-WORK-PHONE.
  4028     INSPECT WS-WORK-PHONE CONVERTING ' ' TO '0'.
  4029     MOVE WS-NUMERIC-PHONE       TO PHONEO.
  4030     INSPECT PHONEI CONVERTING ' ' TO '-'.
  4031
  4032     IF AM-CANADIAN-POST-CODE
  4033         MOVE AM-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  4034         MOVE AM-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  4035         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  82
* EL162.cbl
  4036                                    WS-CAN-FILLER
  4037         MOVE WS-CANADIAN-POSTAL-CODES
  4038                                 TO ZIPO
  4039     ELSE
  4040         MOVE AM-ZIP-PRIME       TO WS-ZIP-CODE
  4041         IF AM-ZIP-PLUS4 = SPACES OR ZEROS
  4042             MOVE SPACES         TO WS-ZIP-PLUS4
  4043                                    WS-DASH
  4044             MOVE WS-ZIP         TO ZIPO
  4045         ELSE
  4046             MOVE AM-ZIP-PLUS4   TO WS-ZIP-PLUS4
  4047             MOVE '-'            TO WS-DASH
  4048             MOVE WS-ZIP         TO ZIPO.
  4049
  4050     PERFORM 4240-ENDBR.
  4051
  4052     GO TO 4299-EXIT.
  4053
  4054 4240-ENDBR.
  4055
  4056* EXEC CICS ENDBR
  4057*         DATASET(ERACCT-FILE-ID)
  4058*    END-EXEC.
  4059     MOVE 0
  4060       TO DFHEIV11
  4061*    MOVE '&2                    $   #00003826' TO DFHEIV0
  4062     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4063     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4064     MOVE X'2020233030303033383236' TO DFHEIV0(25:11)
  4065     CALL 'kxdfhei1' USING DFHEIV0,
  4066           ERACCT-FILE-ID,
  4067           DFHEIV11,
  4068           DFHEIV99
  4069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4070
  4071
  4072 4250-ACCT-NOT-FOUND.
  4073     PERFORM 4240-ENDBR.
  4074     MOVE ER-0179                TO EMI-ERROR.
  4075     MOVE -1                     TO SC-RECL (1).
  4076     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4077                                    ZIPI PHONEI.
  4078
  4079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4080
  4081 4290-ERROR.
  4082     MOVE ER-0322                TO EMI-ERROR.
  4083     MOVE -1                     TO SC-RECL (1).
  4084     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4085                                    ZIPI PHONEI.
  4086
  4087     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4088
  4089 4299-EXIT.
  4090      EXIT.
  4091
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  83
* EL162.cbl
  4093 6000-BROWSE-FORWARD.
  4094     IF PI-ACTV-SAVE NOT = PI-ACTV-PARTIAL
  4095        MOVE ER-0066             TO EMI-ERROR
  4096        MOVE -1                  TO SC-RECL (1)
  4097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4098        GO TO 8200-SEND-DATAONLY.
  4099
  4100     MOVE LOW-VALUES             TO EL162AI.
  4101     ADD 1 TO PI-ACTV-SEQ.
  4102
  4103     GO TO 7000-BUILD-SCREEN.
  4104
  4105 6100-BROWSE-BACKWARD.
  4106
  4107     IF PI-NEXT-TRLR-SUB > 8
  4108        SUBTRACT 4 FROM PI-NEXT-TRLR-SUB.
  4109
  4110     MOVE PI-NEXT-TRLR-SUB       TO SUB.
  4111
  4112     IF SUB = 1 OR 5
  4113        MOVE ER-0067             TO EMI-ERROR
  4114        MOVE -1                  TO SC-RECL (1)
  4115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4116        MOVE  1                  TO SUB
  4117        MOVE  +1                 TO PI-NEXT-TRLR-SUB
  4118     ELSE
  4119        SUBTRACT 4 FROM SUB
  4120        MOVE SUB                 TO PI-NEXT-TRLR-SUB.
  4121
  4122     MOVE LOW-VALUES             TO EL162AI
  4123                                    TRL-LINES.
  4124     MOVE PI-ACTV-SAVE           TO PI-ACTV-PARTIAL.
  4125
  4126     MOVE PI-TRLRS (SUB)         TO PI-ACTV-SEQ.
  4127
  4128     GO TO 7000-BUILD-SCREEN.
  4129
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  84
* EL162.cbl
  4131 6200-FORMAT-DATA.
  4132
  4133     IF FORM-CONTROL-TR
  4134        GO TO 6250-FORMAT-FORM.
  4135
  4136     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
  4137        MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
  4138        MOVE SPACES                TO DC-OPTION-CODE
  4139        PERFORM 9700-DATE-LINK
  4140        MOVE DC-GREG-DATE-1-EDIT   TO SC-REC (SC-INDX).
  4141
  4142     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  4143        MOVE AT-STOP-LETTER-DT     TO DC-BIN-DATE-1
  4144        MOVE SPACES                TO DC-OPTION-CODE
  4145        PERFORM 9700-DATE-LINK
  4146        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4147     END-IF.
  4148
  4149     IF AT-LETTER-SENT-DT NOT = LOW-VALUES
  4150        MOVE AT-LETTER-SENT-DT   TO DC-BIN-DATE-1
  4151        MOVE SPACES              TO DC-OPTION-CODE
  4152        PERFORM 9700-DATE-LINK
  4153        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4154
  4155     IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
  4156        MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
  4157        MOVE SPACES              TO DC-OPTION-CODE
  4158        PERFORM 9700-DATE-LINK
  4159        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4160
  4161     IF AT-RECEIPT-FOLLOW-UP NOT = LOW-VALUES
  4162        MOVE AT-RECEIPT-FOLLOW-UP TO DC-BIN-DATE-1
  4163        MOVE SPACES               TO DC-OPTION-CODE
  4164        PERFORM 9700-DATE-LINK
  4165        MOVE DC-GREG-DATE-1-EDIT  TO SC-FOLLOWUP (SC-INDX).
  4166
  4167     MOVE AT-STD-LETTER-FORM     TO SC-FORM (SC-INDX).
  4168
  4169     IF INSURED-ADDRESEE
  4170        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4171     ELSE
  4172     IF BENEFICIARY-ADDRESEE
  4173        MOVE 'BENEFI '           TO SC-TO (SC-INDX)
  4174     ELSE
  4175     IF ACCOUNT-ADDRESEE
  4176        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4177     ELSE
  4178     IF PHYSICIAN-ADDRESEE
  4179        MOVE 'DOCTOR'            TO SC-TO (SC-INDX)
  4180     ELSE
  4181     IF EMPLOYER-ADDRESEE
  4182        MOVE 'EMPLOYER'          TO SC-TO (SC-INDX)
  4183     ELSE
  4184     IF OTHER-ADDRESEE-1
  4185        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4186     ELSE
  4187        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4188
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  85
* EL162.cbl
  4189     IF AT-LETTER-ARCHIVE-NO NOT = +0
  4190        MOVE AT-LETTER-ARCHIVE-NO TO SC-ARCHIVE (SC-INDX)
  4191     ELSE
  4192        MOVE SPACES              TO SC-ARCHIVE (SC-INDX).
  4193
  4194     MOVE 'L'                    TO SC-TYPE   (SC-INDX).
  4195
  4196     MOVE AT-REASON-TEXT         TO SC-REASON (SC-INDX).
  4197
  4198*    IF PI-COMPANY-ID = 'DMD'
  4199*       IF AT-DMD-LETTER-PURGED
  4200*          MOVE AT-REASON-TEXT          TO WS-REASON
  4201*          MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
  4202*          MOVE SPACES                  TO DC-OPTION-CODE
  4203*          PERFORM 9700-DATE-LINK
  4204*          MOVE 'PURGED -'              TO WS-REASON (51:9)
  4205*          MOVE DC-GREG-DATE-1-EDIT     TO WS-REASON (60:11)
  4206*          MOVE WS-REASON               TO SC-REASON (SC-INDX).
  4207*
  4208     MOVE AT-RECORDED-BY         TO SC-BY     (SC-INDX).
  4209     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO (SC-INDX).
  4210     MOVE AL-UANOF               TO SC-RECA   (SC-INDX)
  4211                                    SC-STOPA  (SC-INDX).
  4212
  4213     GO TO 6299-EXIT.
  4214
  4215 6250-FORMAT-FORM.
  4216
  4217     IF AT-STOP-FORM-DT NOT = LOW-VALUES AND SPACES
  4218        MOVE AT-STOP-FORM-DT       TO DC-BIN-DATE-1
  4219        MOVE SPACES                TO DC-OPTION-CODE
  4220        PERFORM 9700-DATE-LINK
  4221        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4222     END-IF.
  4223
  4224     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4225        IF (AT-FORM-ANSWERED-DT = LOW-VALUES)
  4226                         OR
  4227           (AT-FORM-ANSWERED-DT NOT = LOW-VALUES  AND
  4228            AT-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4229             NEXT SENTENCE
  4230         ELSE
  4231             GO TO 6260-CHECK-EMPLOYER-FORM
  4232     ELSE
  4233        GO TO 6260-CHECK-EMPLOYER-FORM.
  4234
  4235     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
  4236        MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4237        MOVE SPACES              TO DC-OPTION-CODE
  4238        PERFORM 9700-DATE-LINK
  4239        MOVE DC-GREG-DATE-1-EDIT TO SC-REC (SC-INDX).
  4240
  4241     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4242        MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
  4243        MOVE SPACES              TO DC-OPTION-CODE
  4244        PERFORM 9700-DATE-LINK
  4245        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4246
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  86
* EL162.cbl
  4247     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4248        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4249        MOVE SPACES              TO DC-OPTION-CODE
  4250        PERFORM 9700-DATE-LINK
  4251        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4252
  4253     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4254        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4255        MOVE SPACES                 TO DC-OPTION-CODE
  4256        PERFORM 9700-DATE-LINK
  4257        MOVE DC-GREG-DATE-1-EDIT TO SC-FOLLOWUP (SC-INDX).
  4258
  4259     IF AT-FORM-TYPE = '1'
  4260        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4261     ELSE
  4262        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4263
  4264     IF FORM-TO-INSURED
  4265        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4266     ELSE
  4267     IF FORM-TO-ACCOUNT
  4268        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4269     ELSE
  4270     IF FORM-TO-OTHER-1
  4271        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4272     ELSE
  4273     IF FORM-TO-OTHER-2
  4274        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4275
  4276     MOVE 'CLAIMANT'             TO SC-ARCHIVE (SC-INDX).
  4277     MOVE 'C'                    TO SC-TYPE    (SC-INDX).
  4278     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4279     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4280     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4281     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4282     MOVE AL-UANOF               TO SC-RECA    (SC-INDX).
  4283     MOVE AL-UANOF               TO SC-STOPA   (SC-INDX).
  4284
  4285 6260-CHECK-EMPLOYER-FORM.
  4286
  4287     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4288        IF (AT-EMP-FORM-ANSWERED-DT = LOW-VALUES)
  4289                          OR
  4290           (AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4291            AT-EMP-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4292              NEXT SENTENCE
  4293          ELSE
  4294              GO TO 6280-CHECK-PHYSICIAN-FORM
  4295     ELSE
  4296        GO TO 6280-CHECK-PHYSICIAN-FORM.
  4297
  4298     IF SC-TYPE (SC-INDX) = 'C'
  4299        SET SC-INDX UP BY 1
  4300        ADD +1 TO PI-NEXT-TRLR-SUB.
  4301
  4302     IF AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES
  4303        MOVE AT-EMP-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4304        MOVE SPACES                  TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  87
* EL162.cbl
  4305        PERFORM 9700-DATE-LINK
  4306        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4307
  4308     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4309        MOVE AT-EMP-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4310        MOVE SPACES                 TO DC-OPTION-CODE
  4311        PERFORM 9700-DATE-LINK
  4312        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4313
  4314     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4315        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4316        MOVE SPACES              TO DC-OPTION-CODE
  4317        PERFORM 9700-DATE-LINK
  4318        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4319
  4320     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4321        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4322        MOVE SPACES                 TO DC-OPTION-CODE
  4323        PERFORM 9700-DATE-LINK
  4324        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4325
  4326     IF AT-FORM-TYPE = '1'
  4327        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4328     ELSE
  4329        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4330
  4331     IF FORM-TO-INSURED
  4332        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4333     ELSE
  4334     IF FORM-TO-ACCOUNT
  4335        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4336     ELSE
  4337     IF FORM-TO-OTHER-1
  4338        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4339     ELSE
  4340     IF FORM-TO-OTHER-2
  4341        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4342
  4343     MOVE 'EMPLOYER'             TO SC-ARCHIVE (SC-INDX).
  4344     MOVE 'E'                    TO SC-TYPE    (SC-INDX).
  4345     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4346     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4347     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4348     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4349     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4350                                    SC-STOPA   (SC-INDX).
  4351
  4352 6280-CHECK-PHYSICIAN-FORM.
  4353
  4354     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4355        IF (AT-PHY-FORM-ANSWERED-DT = LOW-VALUES)
  4356                         OR
  4357           (AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4358            AT-PHY-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4359              NEXT SENTENCE
  4360          ELSE
  4361              GO TO 6299-EXIT
  4362     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  88
* EL162.cbl
  4363        GO TO 6299-EXIT.
  4364
  4365     IF SC-TYPE (SC-INDX) = 'C' OR 'E'
  4366        SET SC-INDX UP BY 1
  4367        ADD +1 TO PI-NEXT-TRLR-SUB.
  4368
  4369     IF AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES
  4370        MOVE AT-PHY-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4371        MOVE SPACES                  TO DC-OPTION-CODE
  4372        PERFORM 9700-DATE-LINK
  4373        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4374
  4375     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4376        MOVE AT-PHY-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4377        MOVE SPACES                 TO DC-OPTION-CODE
  4378        PERFORM 9700-DATE-LINK
  4379        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4380
  4381     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4382        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4383        MOVE SPACES              TO DC-OPTION-CODE
  4384        PERFORM 9700-DATE-LINK
  4385        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4386
  4387     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4388        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4389        MOVE SPACES                 TO DC-OPTION-CODE
  4390        PERFORM 9700-DATE-LINK
  4391        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4392
  4393     IF AT-FORM-TYPE = '1'
  4394        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4395     ELSE
  4396        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4397
  4398     IF FORM-TO-INSURED
  4399        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4400     ELSE
  4401     IF FORM-TO-ACCOUNT
  4402        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4403     ELSE
  4404     IF FORM-TO-OTHER-1
  4405        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4406     ELSE
  4407     IF FORM-TO-OTHER-2
  4408        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4409
  4410     MOVE ' DOCTOR '             TO SC-ARCHIVE (SC-INDX).
  4411     MOVE 'P'                    TO SC-TYPE    (SC-INDX).
  4412     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4413     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4414     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4415     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4416     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4417                                    SC-STOPA   (SC-INDX).
  4418
  4419 6299-EXIT.
  4420      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  89
* EL162.cbl
  4421
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  90
* EL162.cbl
  4423 7000-BUILD-SCREEN.
  4424
  4425     IF PI-CLAIM-NO = SPACES
  4426        MOVE ER-0319             TO EMI-ERROR
  4427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4428        GO TO 8100-SEND-INITIAL-MAP.
  4429
  4430     PERFORM 3000-BUILD-KEYS.
  4431
  4432     MOVE PI-PROCESSOR-ID        TO UBYI.
  4433
  4434
  4435* EXEC CICS HANDLE CONDITION
  4436*         NOTOPEN(8870-CLAIM-NOT-OPEN)
  4437*         NOTFND (8860-CLAIM-NOT-FOUND)
  4438*    END-EXEC.
  4439*    MOVE '"$JI                  ! & #00004192' TO DFHEIV0
  4440     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4442     MOVE X'2620233030303034313932' TO DFHEIV0(25:11)
  4443     CALL 'kxdfhei1' USING DFHEIV0
  4444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4445
  4446
  4447
  4448* EXEC CICS READ
  4449*         DATASET(ELMSTR-FILE-ID)
  4450*         RIDFLD (PI-CLAM-KEY)
  4451*         SET    (ADDRESS OF CLAIM-MASTER)
  4452*    END-EXEC.
  4453*    MOVE '&"S        E          (   #00004197' TO DFHEIV0
  4454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4456     MOVE X'2020233030303034313937' TO DFHEIV0(25:11)
  4457     CALL 'kxdfhei1' USING DFHEIV0,
  4458           ELMSTR-FILE-ID,
  4459           DFHEIV20,
  4460           DFHEIV99,
  4461           PI-CLAM-KEY,
  4462           DFHEIV99,
  4463           DFHEIV99,
  4464           DFHEIV99
  4465     SET ADDRESS OF CLAIM-MASTER TO
  4466         DFHEIV20
  4467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4468
  4469
  4470     EVALUATE TRUE
  4471     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  4472        MOVE PI-LIFE-OVERRIDE-L6 TO TYPEI
  4473     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  4474        MOVE PI-AH-OVERRIDE-L6   TO TYPEI
  4475     WHEN CL-CLAIM-TYPE = 'I'
  4476        MOVE ' IU   '            TO TYPEI
  4477     WHEN CL-CLAIM-TYPE = 'G'
  4478        MOVE ' GAP  '            TO TYPEI
  4479
  4480     WHEN CL-CLAIM-TYPE = 'F'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  91
* EL162.cbl
  4481        MOVE ' FAM  '            TO TYPEI
  4482
  4483     WHEN CL-CLAIM-TYPE = 'O'
  4484        MOVE ' OTH  '            TO TYPEI
  4485     END-EVALUATE
  4486
  4487     MOVE CL-INSURED-LAST-NAME   TO LASTNMEI.
  4488     MOVE CL-FILE-LOCATION       TO FILEI.
  4489     MOVE PI-ACTV-PARTIAL        TO PI-ACTV-SAVE.
  4490
  4491     IF CL-1ST-TRL-AVAIL
  4492        GO TO 7100-NOT-FOUND.
  4493
  4494 7010-START-BROWSE.
  4495
  4496
  4497* EXEC CICS HANDLE CONDITION
  4498*         NOTOPEN(8820-ACTV-NOT-OPEN)
  4499*         NOTFND (7100-NOT-FOUND)
  4500*         ENDFILE(7100-NOT-FOUND)
  4501*    END-EXEC.
  4502*    MOVE '"$JI''                 ! '' #00004229' TO DFHEIV0
  4503     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4505     MOVE X'2720233030303034323239' TO DFHEIV0(25:11)
  4506     CALL 'kxdfhei1' USING DFHEIV0
  4507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4508
  4509
  4510
  4511* EXEC CICS STARTBR
  4512*         DATASET(ELTRLR-FILE-ID)
  4513*         RIDFLD (PI-ACTV-KEY)
  4514*         GTEQ
  4515*    END-EXEC.
  4516     MOVE 0
  4517       TO DFHEIV11
  4518*    MOVE '&,         G          &   #00004235' TO DFHEIV0
  4519     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4520     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4521     MOVE X'2020233030303034323335' TO DFHEIV0(25:11)
  4522     CALL 'kxdfhei1' USING DFHEIV0,
  4523           ELTRLR-FILE-ID,
  4524           PI-ACTV-KEY,
  4525           DFHEIV99,
  4526           DFHEIV11,
  4527           DFHEIV99
  4528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4529
  4530
  4531     SET SC-INDX TO 1.
  4532
  4533 7020-READ-NEXT.
  4534
  4535
  4536* EXEC CICS READNEXT
  4537*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  4538*         RIDFLD   (PI-ACTV-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  92
* EL162.cbl
  4539*         DATASET  (ELTRLR-FILE-ID)
  4540*    END-EXEC.
  4541     MOVE 0
  4542       TO DFHEIV11
  4543*    MOVE '&.S                   )   #00004245' TO DFHEIV0
  4544     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4545     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4546     MOVE X'2020233030303034323435' TO DFHEIV0(25:11)
  4547     CALL 'kxdfhei1' USING DFHEIV0,
  4548           ELTRLR-FILE-ID,
  4549           DFHEIV20,
  4550           DFHEIV99,
  4551           PI-ACTV-KEY,
  4552           DFHEIV99,
  4553           DFHEIV11,
  4554           DFHEIV99,
  4555           DFHEIV99
  4556     SET ADDRESS OF ACTIVITY-TRAILERS TO
  4557         DFHEIV20
  4558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4559
  4560
  4561     IF PI-ACTV-PARTIAL NOT = PI-ACTV-SAVE
  4562        GO TO 7100-NOT-FOUND.
  4563
  4564     IF AT-TRAILER-TYPE = '4' OR  'A'
  4565        NEXT SENTENCE
  4566     ELSE
  4567        GO TO 7020-READ-NEXT.
  4568
  4569     IF CORRESPONDENCE-TR
  4570        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND
  4571           AT-LETTER-ANSWERED-DT NOT = BIN-CURRENT-DATE
  4572             GO TO 7020-READ-NEXT.
  4573
  4574     IF CORRESPONDENCE-TR AND
  4575        AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND
  4576        AT-RESEND-LETTER-FORM NOT = LOW-VALUES
  4577             GO TO 7020-READ-NEXT
  4578     END-IF.
  4579
  4580     IF CORRESPONDENCE-TR AND
  4581        AT-STOP-LETTER-DT NOT = LOW-VALUES AND
  4582        AT-STOP-LETTER-DT NOT = SPACES AND
  4583        AT-STOP-LETTER-DT NOT = BIN-CURRENT-DATE
  4584*        AT-STOP-LETTER-DT = AT-LETTER-SENT-DT
  4585             GO TO 7020-READ-NEXT
  4586     END-IF.
  4587
  4588     IF NOT FORM-CONTROL-TR
  4589        GO TO 7030-CONTINUE.
  4590
  4591     IF ((AT-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4592          AT-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4593          AT-FORM-SEND-ON-DT = LOW-VALUES)
  4594       AND
  4595        ((AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4596          AT-EMP-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  93
* EL162.cbl
  4597          AT-EMP-FORM-SEND-ON-DT = LOW-VALUES)
  4598       AND
  4599        ((AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4600          AT-PHY-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4601          AT-PHY-FORM-SEND-ON-DT = LOW-VALUES)
  4602             GO TO 7020-READ-NEXT.
  4603
  4604     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) AND
  4605        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4606        IF SC-INDX > 2
  4607           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4608           GO TO 7040-END-BUILD-SCREEN.
  4609
  4610     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) OR
  4611        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4612        IF SC-INDX > 3
  4613           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4614           GO TO 7040-END-BUILD-SCREEN.
  4615
  4616 7030-CONTINUE.
  4617
  4618     PERFORM 6200-FORMAT-DATA THRU 6299-EXIT.
  4619
  4620     MOVE PI-ACTV-SEQ             TO PI-ACTV-SAVE-SEQ.
  4621
  4622     MOVE AT-SEQUENCE-NO          TO PI-TRLRS (PI-NEXT-TRLR-SUB).
  4623
  4624     ADD 1   TO PI-NEXT-TRLR-SUB.
  4625     SET SC-INDX UP BY 1.
  4626
  4627     IF SC-INDX NOT = 5
  4628        GO TO 7020-READ-NEXT.
  4629
  4630 7040-END-BUILD-SCREEN.
  4631
  4632     IF SC-INDX = +2
  4633        ADD +3 TO PI-NEXT-TRLR-SUB
  4634     ELSE
  4635     IF SC-INDX = +3
  4636        ADD +2 TO PI-NEXT-TRLR-SUB
  4637     ELSE
  4638     IF SC-INDX = +4
  4639        ADD +1 TO PI-NEXT-TRLR-SUB.
  4640
  4641     MOVE -1                     TO SC-RECL (1).
  4642     GO TO 8100-SEND-INITIAL-MAP.
  4643
  4644 7100-NOT-FOUND.
  4645     IF PI-NEXT-TRLR-SUB = 1
  4646        MOVE ER-0320             TO EMI-ERROR
  4647        MOVE -1                  TO URECDTEL
  4648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4649        GO TO 8100-SEND-INITIAL-MAP.
  4650
  4651     MOVE -1                     TO SC-RECL (1).
  4652
  4653*    IF ANY LINES WERE PRINTED THEN
  4654*    SET THE SUB TO ALWAYS BE 1 GREATER THAN A MULTIPLE OF 4.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  94
* EL162.cbl
  4655
  4656     SET INDX-WORK TO SC-INDX.
  4657
  4658     IF SC-INDX NOT = 1
  4659        COMPUTE PI-NEXT-TRLR-SUB = (4 - INDX-WORK) + 1 +
  4660                                    PI-NEXT-TRLR-SUB.
  4661
  4662     IF EIBAID NOT = DFHPF1
  4663        GO TO 8100-SEND-INITIAL-MAP.
  4664
  4665     MOVE ER-0066                TO EMI-ERROR.
  4666     MOVE -1                     TO SC-RECL (1).
  4667
  4668     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4669
  4670     GO TO 8100-SEND-INITIAL-MAP.
  4671
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  95
* EL162.cbl
  4673 8100-SEND-INITIAL-MAP.
  4674     MOVE SAVE-DATE    TO RUNDTEO.
  4675     MOVE EIBTIME      TO TIME-IN.
  4676     MOVE TIME-OUT     TO RUNTIMEO.
  4677
  4678     IF NOT EMI-NO-ERRORS
  4679         SET EMI-INDX TO 1
  4680         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSG1O.
  4681
  4682     IF PI-COMPANY-ID NOT = 'DMD'
  4683         MOVE SPACES             TO PF4KEYO.
  4684
  4685     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4686         MOVE SPACES             TO PF5KEYO.
  4687
  4688
  4689* EXEC CICS SEND
  4690*        MAP   (MAP-NAME)
  4691*        MAPSET(MAPSET-NAME)
  4692*        FROM  (EL162AO)
  4693*        ERASE
  4694*        CURSOR
  4695*    END-EXEC.
  4696     MOVE LENGTH OF
  4697      EL162AO
  4698       TO DFHEIV12
  4699     MOVE -1
  4700       TO DFHEIV11
  4701*    MOVE '8$     CT  E    H L F ,   #00004378' TO DFHEIV0
  4702     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4703     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4704     MOVE X'2020233030303034333738' TO DFHEIV0(25:11)
  4705     CALL 'kxdfhei1' USING DFHEIV0,
  4706           MAP-NAME,
  4707           EL162AO,
  4708           DFHEIV12,
  4709           MAPSET-NAME,
  4710           DFHEIV99,
  4711           DFHEIV99,
  4712           DFHEIV99,
  4713           DFHEIV11,
  4714           DFHEIV99,
  4715           DFHEIV99,
  4716           DFHEIV99
  4717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4718
  4719
  4720     GO TO 9100-RETURN-TRAN.
  4721
  4722 8200-SEND-DATAONLY.
  4723     MOVE SAVE-DATE            TO RUNDTEO.
  4724     MOVE EIBTIME              TO TIME-IN.
  4725     MOVE TIME-OUT             TO RUNTIMEO.
  4726     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4727
  4728     IF PI-COMPANY-ID NOT = 'DMD'
  4729         MOVE SPACES             TO PF4KEYO.
  4730
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  96
* EL162.cbl
  4731     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4732         MOVE SPACES             TO PF5KEYO.
  4733
  4734
  4735* EXEC CICS SEND
  4736*        MAP   (MAP-NAME)
  4737*        MAPSET(MAPSET-NAME)
  4738*        FROM  (EL162AO)
  4739*        DATAONLY
  4740*        CURSOR
  4741*    END-EXEC.
  4742     MOVE LENGTH OF
  4743      EL162AO
  4744       TO DFHEIV12
  4745     MOVE -1
  4746       TO DFHEIV11
  4747*    MOVE '8$D    CT       H L F ,   #00004400' TO DFHEIV0
  4748     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4749     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4750     MOVE X'2020233030303034343030' TO DFHEIV0(25:11)
  4751     CALL 'kxdfhei1' USING DFHEIV0,
  4752           MAP-NAME,
  4753           EL162AO,
  4754           DFHEIV12,
  4755           MAPSET-NAME,
  4756           DFHEIV99,
  4757           DFHEIV99,
  4758           DFHEIV99,
  4759           DFHEIV11,
  4760           DFHEIV99,
  4761           DFHEIV99,
  4762           DFHEIV99
  4763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4764
  4765
  4766     GO TO 9100-RETURN-TRAN.
  4767
  4768 8300-SEND-TEXT.
  4769
  4770* EXEC CICS SEND TEXT
  4771*        FROM  (LOGOFF-TEXT)
  4772*        LENGTH(LOGOFF-LENGTH)
  4773*        ERASE
  4774*        FREEKB
  4775*    END-EXEC.
  4776*    MOVE '8&      T  E F  H   F -   #00004411' TO DFHEIV0
  4777     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4778     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4779     MOVE X'2020233030303034343131' TO DFHEIV0(25:11)
  4780     CALL 'kxdfhei1' USING DFHEIV0,
  4781           LOGOFF-TEXT,
  4782           LOGOFF-LENGTH,
  4783           DFHEIV99,
  4784           DFHEIV99,
  4785           DFHEIV99,
  4786           DFHEIV99,
  4787           DFHEIV99,
  4788           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  97
* EL162.cbl
  4789           DFHEIV99,
  4790           DFHEIV99,
  4791           DFHEIV99,
  4792           DFHEIV99
  4793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4794
  4795
  4796
  4797* EXEC CICS RETURN
  4798*    END-EXEC.
  4799*    MOVE '.(                    ''   #00004418' TO DFHEIV0
  4800     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4801     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4802     MOVE X'2020233030303034343138' TO DFHEIV0(25:11)
  4803     CALL 'kxdfhei1' USING DFHEIV0,
  4804           DFHEIV99,
  4805           DFHEIV99,
  4806           DFHEIV99,
  4807           DFHEIV99,
  4808           DFHEIV99,
  4809           DFHEIV99
  4810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4811
  4812
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  98
* EL162.cbl
  4814 8600-DEEDIT.
  4815
  4816* EXEC CICS BIF DEEDIT
  4817*        FIELD (DEEDIT-FIELD)
  4818*        LENGTH(15)
  4819*    END-EXEC.
  4820     MOVE 15
  4821       TO DFHEIV11
  4822*    MOVE '@"L                   #   #00004423' TO DFHEIV0
  4823     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4824     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4825     MOVE X'2020233030303034343233' TO DFHEIV0(25:11)
  4826     CALL 'kxdfhei1' USING DFHEIV0,
  4827           DEEDIT-FIELD,
  4828           DFHEIV11
  4829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4830
  4831
  4832 8800-UNAUTHORIZED-ACCESS.
  4833     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  4834     GO TO 8300-SEND-TEXT.
  4835
  4836 8810-PF23.
  4837     MOVE EIBAID                   TO PI-ENTRY-CD-1.
  4838     MOVE XCTL-005 TO PGM-NAME.
  4839     GO TO 9300-XCTL.
  4840
  4841 8820-ACTV-NOT-OPEN.
  4842     MOVE ER-0172                TO EMI-ERROR.
  4843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4844     GO TO 8200-SEND-DATAONLY.
  4845
  4846 8860-CLAIM-NOT-FOUND.
  4847     MOVE ER-0319                TO EMI-ERROR.
  4848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4849     GO TO 8100-SEND-INITIAL-MAP.
  4850
  4851 8870-CLAIM-NOT-OPEN.
  4852     MOVE ER-0042                TO EMI-ERROR.
  4853     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4854     GO TO 8200-SEND-DATAONLY.
  4855
  4856 8880-ACCT-NOT-OPEN.
  4857     MOVE ER-0168                TO EMI-ERROR
  4858     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4859     GO TO 8200-SEND-DATAONLY.
  4860
  4861 9100-RETURN-TRAN.
  4862     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4863     MOVE MAP-NUMBER           TO PI-CURRENT-SCREEN-NO.
  4864
  4865* EXEC CICS RETURN
  4866*        TRANSID(TRANS-ID)
  4867*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4868*        LENGTH(PI-COMM-LENGTH)
  4869*    END-EXEC.
  4870*    MOVE '.(CT                  ''   #00004460' TO DFHEIV0
  4871     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page  99
* EL162.cbl
  4872     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4873     MOVE X'2020233030303034343630' TO DFHEIV0(25:11)
  4874     CALL 'kxdfhei1' USING DFHEIV0,
  4875           TRANS-ID,
  4876           PROGRAM-INTERFACE-BLOCK,
  4877           PI-COMM-LENGTH,
  4878           DFHEIV99,
  4879           DFHEIV99,
  4880           DFHEIV99
  4881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4882
  4883
  4884 9200-RETURN-MAIN-MENU.
  4885     MOVE XCTL-126 TO PGM-NAME.
  4886     GO TO 9300-XCTL.
  4887
  4888 9300-XCTL.
  4889
  4890* EXEC CICS XCTL
  4891*        PROGRAM(PGM-NAME)
  4892*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4893*        LENGTH(PI-COMM-LENGTH)
  4894*    END-EXEC.
  4895*    MOVE '.$C                   %   #00004471' TO DFHEIV0
  4896     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4897     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4898     MOVE X'2020233030303034343731' TO DFHEIV0(25:11)
  4899     CALL 'kxdfhei1' USING DFHEIV0,
  4900           PGM-NAME,
  4901           PROGRAM-INTERFACE-BLOCK,
  4902           PI-COMM-LENGTH,
  4903           DFHEIV99
  4904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4905
  4906
  4907 9400-CLEAR.
  4908     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4909     GO TO 9300-XCTL.
  4910
  4911 9500-PF12.
  4912     MOVE XCTL-010 TO PGM-NAME.
  4913     GO TO 9300-XCTL.
  4914
  4915 9600-PGMID-ERROR.
  4916
  4917* EXEC CICS HANDLE CONDITION
  4918*        PGMIDERR(8300-SEND-TEXT)
  4919*    END-EXEC.
  4920*    MOVE '"$L                   ! ( #00004486' TO DFHEIV0
  4921     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4923     MOVE X'2820233030303034343836' TO DFHEIV0(25:11)
  4924     CALL 'kxdfhei1' USING DFHEIV0
  4925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4926
  4927
  4928     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4929     MOVE ' '          TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page 100
* EL162.cbl
  4930     MOVE XCTL-005     TO PGM-NAME.
  4931     MOVE PGM-NAME     TO LOGOFF-PGM.
  4932     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4933     GO TO 9300-XCTL.
  4934
  4935 9700-DATE-LINK.
  4936     MOVE LINK-ELDATCV           TO PGM-NAME.
  4937
  4938
  4939* EXEC CICS LINK
  4940*         PROGRAM (PGM-NAME)
  4941*         COMMAREA(DATE-CONVERSION-DATA)
  4942*         LENGTH  (DC-COMM-LENGTH)
  4943*    END-EXEC.
  4944*    MOVE '."C                   (   #00004500' TO DFHEIV0
  4945     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4947     MOVE X'2020233030303034353030' TO DFHEIV0(25:11)
  4948     CALL 'kxdfhei1' USING DFHEIV0,
  4949           PGM-NAME,
  4950           DATE-CONVERSION-DATA,
  4951           DC-COMM-LENGTH,
  4952           DFHEIV99,
  4953           DFHEIV99,
  4954           DFHEIV99,
  4955           DFHEIV99
  4956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4957
  4958
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page 101
* EL162.cbl
  4960 9900-ERROR-FORMAT.
  4961     IF NOT EMI-ERRORS-COMPLETE
  4962         MOVE LINK-001 TO PGM-NAME
  4963
  4964* EXEC CICS LINK
  4965*            PROGRAM (PGM-NAME)
  4966*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4967*            LENGTH  (EMI-COMM-LENGTH)
  4968*        END-EXEC.
  4969*    MOVE '."C                   (   #00004510' TO DFHEIV0
  4970     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4972     MOVE X'2020233030303034353130' TO DFHEIV0(25:11)
  4973     CALL 'kxdfhei1' USING DFHEIV0,
  4974           PGM-NAME,
  4975           ERROR-MESSAGE-INTERFACE-BLOCK,
  4976           EMI-COMM-LENGTH,
  4977           DFHEIV99,
  4978           DFHEIV99,
  4979           DFHEIV99,
  4980           DFHEIV99
  4981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4982
  4983
  4984 9900-EXIT.
  4985     EXIT.
  4986
  4987 9990-ABEND.
  4988     MOVE LINK-004 TO PGM-NAME.
  4989     MOVE DFHEIBLK TO EMI-LINE1.
  4990
  4991
  4992* EXEC CICS LINK
  4993*        PROGRAM (PGM-NAME)
  4994*        COMMAREA(EMI-LINE1)
  4995*        LENGTH  (72)
  4996*    END-EXEC.
  4997     MOVE 72
  4998       TO DFHEIV11
  4999*    MOVE '."C                   (   #00004523' TO DFHEIV0
  5000     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5002     MOVE X'2020233030303034353233' TO DFHEIV0(25:11)
  5003     CALL 'kxdfhei1' USING DFHEIV0,
  5004           PGM-NAME,
  5005           EMI-LINE1,
  5006           DFHEIV11,
  5007           DFHEIV99,
  5008           DFHEIV99,
  5009           DFHEIV99,
  5010           DFHEIV99
  5011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5012
  5013
  5014     GO TO 8200-SEND-DATAONLY.
  5015
  5016 9995-SECURITY-VIOLATION.
  5017*                            COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page 102
* EL162.cbl
  5018******************************************************************
  5019*                                                                *
  5020*                            ELCSCTP                             *
  5021*                            VMOD=2.001                          *
  5022*                                                                *
  5023*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5024******************************************************************
  5025
  5026
  5027     MOVE EIBDATE          TO SM-JUL-DATE.
  5028     MOVE EIBTRMID         TO SM-TERMID.
  5029     MOVE THIS-PGM         TO SM-PGM.
  5030     MOVE EIBTIME          TO TIME-IN.
  5031     MOVE TIME-OUT         TO SM-TIME.
  5032     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5033
  5034
  5035* EXEC CICS LINK
  5036*         PROGRAM  ('EL003')
  5037*         COMMAREA (SECURITY-MESSAGE)
  5038*         LENGTH   (80)
  5039*    END-EXEC.
  5040     MOVE 'EL003' TO DFHEIV1
  5041     MOVE 80
  5042       TO DFHEIV11
  5043*    MOVE '."C                   (   #00004549' TO DFHEIV0
  5044     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5046     MOVE X'2020233030303034353439' TO DFHEIV0(25:11)
  5047     CALL 'kxdfhei1' USING DFHEIV0,
  5048           DFHEIV1,
  5049           SECURITY-MESSAGE,
  5050           DFHEIV11,
  5051           DFHEIV99,
  5052           DFHEIV99,
  5053           DFHEIV99,
  5054           DFHEIV99
  5055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5056
  5057
  5058******************************************************************
  5059
  5060
  5061
  5062 9999-DFHBACK SECTION.
  5063     MOVE '9%                    "   ' TO DFHEIV0
  5064     MOVE 'EL162' TO DFHEIV1
  5065     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5066     GOBACK.
  5067 9999-DFHEXIT.
  5068     IF DFHEIGDJ EQUAL 0001
  5069         NEXT SENTENCE
  5070     ELSE IF DFHEIGDJ EQUAL 2
  5071         GO TO 9600-PGMID-ERROR,
  5072               9990-ABEND
  5073         DEPENDING ON DFHEIGDI
  5074     ELSE IF DFHEIGDJ EQUAL 3
  5075         GO TO 4199-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 12:55 Page 103
* EL162.cbl
  5076         DEPENDING ON DFHEIGDI
  5077     ELSE IF DFHEIGDJ EQUAL 4
  5078         GO TO 4290-ERROR
  5079         DEPENDING ON DFHEIGDI
  5080     ELSE IF DFHEIGDJ EQUAL 5
  5081         GO TO 8880-ACCT-NOT-OPEN,
  5082               4250-ACCT-NOT-FOUND
  5083         DEPENDING ON DFHEIGDI
  5084     ELSE IF DFHEIGDJ EQUAL 6
  5085         GO TO 8870-CLAIM-NOT-OPEN,
  5086               8860-CLAIM-NOT-FOUND
  5087         DEPENDING ON DFHEIGDI
  5088     ELSE IF DFHEIGDJ EQUAL 7
  5089         GO TO 8820-ACTV-NOT-OPEN,
  5090               7100-NOT-FOUND,
  5091               7100-NOT-FOUND
  5092         DEPENDING ON DFHEIGDI
  5093     ELSE IF DFHEIGDJ EQUAL 8
  5094         GO TO 8300-SEND-TEXT
  5095         DEPENDING ON DFHEIGDI.
  5096     MOVE '9%                    "   ' TO DFHEIV0
  5097     MOVE 'EL162' TO DFHEIV1
  5098     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5099     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5420     Code:       14065
