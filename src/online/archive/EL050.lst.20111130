* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   117* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   118*-----------------------------------------------------------------
   119
   120 01  WORK-AREAS.
   121
   122*****************************************************************
   123*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   124*****************************************************************
   125
   126     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   127     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   128     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   129     12  WS-NAME-EDIT-WORK-AREA.
   130         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   131         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   132             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   133         16  WS-WORK-NAME.
   134             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   135             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   136             20  FILLER           PIC X(10)     VALUE SPACES.
   137         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   138             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   139
   140*****************************************************************
   141*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   142*****************************************************************
   143
   144     12  WS-ERRESC-KEY.
   145         16 WS-ERRESC-SEARCH-KEY.
   146             20  WS-ERRESC-COMPANY-CD PIC  X.
   147             20  WS-ERRESC-CARRIER    PIC  X.
   148             20  WS-ERRESC-GROUP      PIC X(6).
   149             20  WS-ERRESC-STATE      PIC XX.
   150             20  WS-ERRESC-ACCOUNT    PIC X(10).
   151         16 WS-ERRESC-RESIDUAL-KEY.
   152             20  WS-ERRESC-AGENT      PIC X(10).
   153             20  WS-ERRESC-RES-STATE  PIC XX.
   154             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   155*                                          YYYYMMDD
   156     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   157     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   158
   159*RESIDENT STATE TAX MASTER(ERRESS)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   5
* EL050.cbl
   160*
   161     12  WS-ERRESS-KEY.
   162         16  WS-ERRESS-COMPANY-CD      PIC  X.
   163         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   164         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   165         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   166*                                          YYYYMMDD
   167
   168     12  WS-CONTRACT-DATE              PIC 9(8).
   169*                                          YYYYMMDD
   170     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   171     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   172         16 WS-YEAR-YY                 PIC   9999.
   173         16 FILLER                     PIC 9(4).
   174*                                          YYYYMMDD
   175     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   176     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   177     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   178     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   179
   180     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   181         88  DPRB-1ST-TIME                      VALUE ' '.
   182
   183*****************************************************************
   184*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   185*****************************************************************
   186
   187     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   188     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   189     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   190     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   191     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   192     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   193     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   194     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   195     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   196     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   197         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   198         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   199     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   200         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   201         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   202     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   203
   204     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   205     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   206
   207     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   208     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   209     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   212     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   213     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   214     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   6
* EL050.cbl
   218     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   221     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   222     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   243     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   244     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   245     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   246     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   247     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   255     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   256     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   257     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   258     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   259     12  WS-2671-SW               PIC X         VALUE SPACE.
   260     12  WS-2672-SW               PIC X         VALUE SPACE.
   261     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   262         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   263     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   264         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   265     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   266
   267     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   268         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   269         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   270         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   271         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   272
   273     12  WS-CREDIT-EDIT-CONTROLS.
   274         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   275         16  WS-MIN-AGE           PIC 99                VALUE  0.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   7
* EL050.cbl
   276         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   277         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   278         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   279         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   280
   281     12  WS-SAVE-ALLOWABLE-BENEFIT.
   282         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   283         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   284         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   285         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   286         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   287         16  FILLER                      PIC XX.
   288
   289     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   290     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   291     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   292     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   293     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   294     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   295     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   296     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   297     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   298     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   299
   300     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   301     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   302     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   303     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   304     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   305     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   306     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   307     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   308         88  WS-REDUCING              VALUE 'R'.
   309         88  WS-LEVEL                 VALUE 'L' 'P'.
   310     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   311
   312     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   313     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   314     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   315     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   316     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   317     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   318     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   319     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   320
   321     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   322     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   323     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   324     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   325     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   326     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   327     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   328     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   329     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   330     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   331     12  WS-ACCT-SIG-SW.
   332         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   333         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   8
* EL050.cbl
   334     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   335     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   336     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   337     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   338     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   341     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   342     12  WS-INITIALS.
   343         16  WS-INIT-1            PIC X         VALUE SPACES.
   344         16  WS-INIT-2            PIC X         VALUE SPACES.
   345
   346     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   347     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   348     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   349     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   350     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   351*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   352     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   353     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   354     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   357     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   358     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   359     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   360     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   361     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   362     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   363     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   364     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   365     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   366     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   367     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   368     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   369     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   373     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   374******** FLA
   375     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   376     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   377     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   379     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   380********
   381     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   382     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   383     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   384     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   385     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   386     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   387     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   388     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   389     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   390     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   391
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page   9
* EL050.cbl
   392     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   393         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   394                                         '0' THRU '9'.
   395
   396     12  NUMBER-OF-MONTHS.
   397         16  SK-MO OCCURS 12 TIMES PIC X.
   398
   399     12  WS-WORK-DATE.
   400         16  WS-YEAR            PIC 99    VALUE 00.
   401         16  WS-MONTH           PIC 99    VALUE 00.
   402         16  WS-DAY             PIC 99    VALUE 00.
   403
   404     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   405     12  WS-WORK-CRIT-DEV       REDEFINES
   406         WS-WORK-LF-CRIT-PER    PIC X(03).
   407
   408     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   409     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   410
   411     12  WS-WORK-DATE-FROM.
   412         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   413         16  FILLER             PIC X  VALUE SPACE.
   414         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   415         16  FILLER             PIC X         VALUE SPACE.
   416         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   417
   418     12  WS-WORK-DATE-THRU.
   419         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   420         16  FILLER             PIC X         VALUE SPACE.
   421         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   424
   425     12  WS-LF-INPUT-CD.
   426         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   427         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   428
   429     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   430     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   431         16  WS-AH-INPUT-CD-1   PIC X.
   432         16  WS-AH-INPUT-CD-2-3 PIC XX.
   433
   434     12  WS-SWITCHES.
   435         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   436         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   437             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   438         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   439             88  BANK-ACCT-FOUND          VALUE 'Y'.
   440         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   441             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   442         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   443             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   444         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   445             88  COMP-MASTER-FOUND        VALUE 'Y'.
   446         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   447             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   448         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   449             88  PDEF-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  10
* EL050.cbl
   450         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   451             88  STAT-MASTER-FOUND        VALUE 'Y'.
   452         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   453             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   454         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   455             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   456         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   457             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   458         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   459             88  FORM-MASTER-FOUND        VALUE 'Y'.
   460         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   461             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   462         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   463             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   464         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   465             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   466         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   467             88  NO-BENEFIT-FOUND         VALUE 'N'.
   468         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   469             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   470         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   471             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   472         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   473             88  AH-BENEFIT-FOUND         VALUE ' '.
   474             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   475         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   476             88  LF-BENEFIT-FOUND         VALUE ' '.
   477             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   478         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   479             88  NO-STATE-RECORD          VALUE '1'.
   480         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   481             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   482         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   483             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   484         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   485             88  CERT-WAS-FOUND           VALUE ' '.
   486             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   487         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   488             88  BROWSE-STARTED           VALUE 'Y'.
   489         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   490             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   491         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   492             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   493         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   494             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   495         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   496             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   497         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   498             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   499         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   500             88  APP-CERT-USED            VALUE 'Y' 'A'.
   501         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   502             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   503             88  FIRST-TIME-THROUGH       VALUE '1'.
   504             88  CTBL-NOT-FOUND           VALUE '2'.
   505
   506         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   507             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  11
* EL050.cbl
   508
   509         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   510             88  DLO-ERROR-FOUND          VALUE 'Y'.
   511
   512********FLA
   513     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   514     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   515********
   516     12  RC-SW-1                  PIC X           VALUE '0'.
   517     12  RC-SW-2                  PIC X           VALUE '0'.
   518     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   519     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   520     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   521     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   522     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   526     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   527     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   528     12  LIT-SPACES               PIC X           VALUE SPACES.
   529     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   530     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   531     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   532     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   533     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   534     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   535     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   536         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   537         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   538     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   539         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   540
   541 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   542     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   543     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   544 01  WS-CRI-SSN-WORK-AREA.
   545     05  WS-CRI-SOC-SEC-NO.
   546         10  WS-SS-REPT-CD       PIC X(5).
   547         10  WS-SS-LAST-NAME     PIC X(5).
   548         10  WS-SS-INITIAL       PIC X.
   549
   550     05  WS-CRI-REPORT-CODE.
   551         10  FILLER              PIC X(5).
   552         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   553
   554     05  WS-CRI-LAST-NAME.
   555         10  WS-CRI-NAME-MOVE    PIC X(5).
   556         10  FILLER              PIC X(10).
   557
   558 01  WS-NUM-TABLE                PIC X(26)  VALUE
   559     '12345678012345070923456789'.
   560 01  FILLER REDEFINES WS-NUM-TABLE.
   561     05  WS-NUM OCCURS 26        PIC 9.
   562 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   563 01  V1                          PIC S999 COMP-3.
   564 01  V2                          PIC S999 COMP-3.
   565 01  V3                          PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  12
* EL050.cbl
   566 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   567 01  FILLER REDEFINES WS-WORK-VIN.
   568     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   569 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   570 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   571 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   572 01  WS-HEX-WORK.
   573     05  FILLER                  PIC X  VALUE LOW-VALUES.
   574     05  WS-HEX-BYTE             PIC X.
   575 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   576 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   577 01  WS-WORK-HIN-ROW-B.
   578     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   579
   580 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   581 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   582     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   583 01  WS-ROW-D-TABLE.
   584     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   585
   586 01  WS-HIN-TABLE-B.
   587     05  F                       PIC XX VALUE 'A2'.
   588     05  F                       PIC XX VALUE 'B3'.
   589     05  F                       PIC XX VALUE 'C4'.
   590     05  F                       PIC XX VALUE 'D5'.
   591     05  F                       PIC XX VALUE 'E6'.
   592     05  F                       PIC XX VALUE 'F7'.
   593     05  F                       PIC XX VALUE 'G8'.
   594     05  F                       PIC XX VALUE 'H9'.
   595     05  F                       PIC XX VALUE 'I1'.
   596     05  F                       PIC XX VALUE 'J2'.
   597     05  F                       PIC XX VALUE 'K3'.
   598     05  F                       PIC XX VALUE 'L4'.
   599     05  F                       PIC XX VALUE 'M5'.
   600     05  F                       PIC XX VALUE 'N6'.
   601     05  F                       PIC XX VALUE 'O0'.
   602     05  F                       PIC XX VALUE 'P7'.
   603     05  F                       PIC XX VALUE 'Q0'.
   604     05  F                       PIC XX VALUE 'R8'.
   605     05  F                       PIC XX VALUE 'S9'.
   606     05  F                       PIC XX VALUE 'T2'.
   607     05  F                       PIC XX VALUE 'U3'.
   608     05  F                       PIC XX VALUE 'V4'.
   609     05  F                       PIC XX VALUE 'W5'.
   610     05  F                       PIC XX VALUE 'X6'.
   611     05  F                       PIC XX VALUE 'Y7'.
   612     05  F                       PIC XX VALUE 'Z8'.
   613 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   614     05  WS-VAL-IN               PIC X.
   615     05  WS-VAL-OUT              PIC 9.
   616 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   617 01  WS-COMPARE-BINARY-DATES.
   618     05  WS-971231                PIC XX VALUE X'92FF'.
   619     05  WS-931231                PIC XX VALUE X'8CFF'.
   620     05  WS-791231                PIC XX VALUE X'77FF'.
   621     05  WS-771001                PIC XX VALUE X'74A1'.
   622     05  WS-820301                PIC XX VALUE X'7B41'.
   623     05  WS-831031                PIC XX VALUE X'7DBF'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  13
* EL050.cbl
   624     05  WS-831231                PIC XX VALUE X'7DFF'.
   625     05  WS-810831                PIC XX VALUE X'7A7F'.
   626     05  WS-830901                PIC XX VALUE X'7D81'.
   627
   628 01  FILE-ACCESS-IDS.
   629     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   630     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   631     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   632     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   633     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   634     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   635     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   636     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   637     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   638     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   639     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   640     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   641     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   642     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   643     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   644     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   645     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   646 01  DD-IU-SW                    PIC X   VALUE ' '.
   647     88  DD-IU-PRESENT                 VALUE 'Y'.
   648
   649 01  ACCESS-KEYS.
   650     12  ELMSTR-KEY.
   651         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   652         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   653     12  W-CLAIM-KEY.
   654         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   655         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   656
   657     12  ELCNTL-KEY.
   658         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   659         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   660         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   661         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   662
   663     12  ELCERT-KEY.
   664         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   665         16  CERT-CARRIER         PIC X       VALUE SPACE.
   666         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   667         16  CERT-STATE           PIC XX      VALUE SPACES.
   668         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   669         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   670         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   671
   672     12  ELCERT2-KEY.
   673         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   674         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   675
   676     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   677
   678     12  ELCERT-SAVE.
   679         16  FILLER                      PIC XX    VALUE SPACES.
   680
   681         16  WCS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  14
* EL050.cbl
   682             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   683             20  WCS-CARRIER             PIC X     VALUE SPACE.
   684             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   685             20  WCS-STATE               PIC XX    VALUE SPACES.
   686             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   687             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   688             20  WCS-CERT-NO.
   689                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   690                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   691
   692         16  CS-CONTROL-BY-NAME.
   693             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   694             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   695             20  CS-INSURED-INITIALS.
   696                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   697                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   698
   699         16  CS-CONTROL-BY-SSN.
   700             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   701             20  CS-SOC-SEC-NO.
   702                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   703                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   704                 24  CS-SSN-LN3.
   705                     28 CS-INSURED-INITIALS-A2   PIC XX
   706                                     VALUE SPACES.
   707                     28 CS-PART-LAST-NAME-A2     PIC X
   708                                     VALUE SPACE.
   709
   710         16  CS-CONTROL-BY-CERT-NO.
   711             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   712             20  CS-CERT-NO-A4           PIC X(11)
   713                                     VALUE SPACES.
   714
   715         16  CS-CONTROL-BY-MEMB.
   716             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   717             20  CS-MEMBER-NO.
   718                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   719                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   720                 24  CS-MEMB-LN4.
   721                     28 CS-INSURED-INITIALS-A5   PIC XX
   722                                      VALUE SPACES.
   723                     28 CS-PART-LAST-NAME-A5     PIC XX
   724                                      VALUE SPACES.
   725
   726         16  FILLER              PIC X(360) VALUE SPACES.
   727
   728     12  ERACCT-KEY.
   729         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   730         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   731         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   732         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   733         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   734         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   735
   736     12  ERCOMP-KEY.
   737         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   738         16  COMP-CARRIER         PIC X     VALUE SPACES.
   739         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  15
* EL050.cbl
   740         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   741         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   742         16  COMP-TYPE            PIC X     VALUE SPACES.
   743
   744     12  ERLOFC-KEY.
   745         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   746         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   747         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   748         16  LOFC-STATE           PIC XX    VALUE SPACES.
   749         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   750         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   751
   752     12  WS-ELCRTT-KEY.
   753         16  WS-ELCRTT-PRIMARY       PIC X(33).
   754         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   755
   756     12  ERBXRF-KEY.
   757         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   758         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   759         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   760         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   761
   762     12  ERAGTC-KEY.
   763         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   764         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   765         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   766         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   767         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   768         16  AGTC-TYPE            PIC X     VALUE SPACES.
   769
   770     12  ERPLAN-KEY.
   771         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   772         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   773         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   774         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   775         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   776         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   777         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   778         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   779
   780     12  ERFORM-KEY.
   781         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   782         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   783         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   784         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   785
   786     12  ERREIN-KEY.
   787         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   788         16  REIN-TYPE            PIC X     VALUE SPACES.
   789         16  REIN-TABLE-CO.
   790             20  REIN-CODE-1      PIC X     VALUE SPACE.
   791             20  REIN-CODE-2      PIC X     VALUE SPACE.
   792             20  REIN-CODE-3      PIC X     VALUE SPACE.
   793         16  FILLER               PIC X(3)  VALUE SPACES.
   794
   795     12  ERCTBL-KEY.
   796         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   797         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  16
* EL050.cbl
   798         16  CTBL-CNTRL-2.
   799             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   800             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   801
   802     12  WS-ACCESS.
   803         16  FILLER               PIC XX    VALUE SPACES.
   804         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   805
   806     12  WS-CARR-ACCESS.
   807         16  FILLER               PIC X(3)  VALUE SPACES.
   808         16  WS-CARR              PIC X     VALUE SPACE.
   809*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   810*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   811     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   812         88  WS-DMD-LF-RATING   VALUE 'Y'.
   813         88  WS-DMD-AH-RATING   VALUE 'Y'.
   814         88  WS-DMD-NO-RATING   VALUE 'N'.
   815
   816     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   817         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   818                                         'NJ' 'NL'
   819                                         'PJ' 'PL'
   820                                         'SJ' 'SL'.
   821     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   822         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   823                                         'NI' 'NJ' 'NL' 'NU'
   824                                         'PJ' 'PL' 'PI' 'PU'
   825                                         'SI' 'SJ' 'SL' 'SU'
   826                                         'MX' 'MY' 'MZ'.
   827 01  ERPDEF-KEY-SAVE             PIC X(18).
   828 01  ERPDEF-KEY.
   829     12  ERPDEF-COMPANY-CD       PIC X.
   830     12  ERPDEF-STATE            PIC XX.
   831     12  ERPDEF-PROD-CD          PIC XXX.
   832     12  F                       PIC X(7).
   833     12  ERPDEF-BEN-TYPE         PIC X.
   834     12  ERPDEF-BEN-CODE         PIC XX.
   835     12  ERPDEF-EXP-DT           PIC XX.
   836
   837 01  ELSTAT-KEY-SAVE             PIC X(20).
   838 01  ELSTAT-KEY.
   839     12  ELSTAT-COMPANY-ID       PIC XXX.
   840     12  ELSTAT-CARRIER          PIC X.
   841     12  ELSTAT-GROUP            PIC X(6).
   842     12  ELSTAT-STATE            PIC XX.
   843     12  ELSTAT-EXP-DT           PIC 9(8).
   844 01  WS-ERROR-VALUES.
   845     12  ER-1570                     PIC S9(4)   VALUE +1570.
   846     12  ER-1571                     PIC S9(4)   VALUE +1571.
   847     12  ER-1575                     PIC S9(4)   VALUE +1575.
   848     12  ER-1891                     PIC S9(4)   VALUE +1891.
   849     12  ER-1892                     PIC S9(4)   VALUE +1892.
   850     12  ER-1893                     PIC S9(4)   VALUE +1893.
   851     12  ER-1894                     PIC S9(4)   VALUE +1894.
   852     12  ER-1895                     PIC S9(4)   VALUE +1895.
   853     12  ER-1896                     PIC S9(4)   VALUE +1896.
   854     12  ER-1897                     PIC S9(4)   VALUE +1897.
   855     12  ER-1898                     PIC S9(4)   VALUE +1898.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  17
* EL050.cbl
   856     12  ER-1899                     PIC S9(4)   VALUE +1899.
   857     12  ER-1900                     PIC S9(4)   VALUE +1900.
   858     12  ER-1901                     PIC S9(4)   VALUE +1901.
   859     12  ER-1902                     PIC S9(4)   VALUE +1902.
   860     12  ER-1903                     PIC S9(4)   VALUE +1903.
   861     12  ER-1904                     PIC S9(4)   VALUE +1904.
   862     12  ER-1905                     PIC S9(4)   VALUE +1905.
   863     12  ER-1906                     PIC S9(4)   VALUE +1906.
   864     12  ER-1907                     PIC S9(4)   VALUE +1907.
   865     12  ER-1909                     PIC S9(4)   VALUE +1909.
   866     12  ER-1910                     PIC S9(4)   VALUE +1910.
   867     12  ER-1911                     PIC S9(4)   VALUE +1911.
   868     12  ER-1912                     PIC S9(4)   VALUE +1912.
   869     12  ER-1913                     PIC S9(4)   VALUE +1913.
   870     12  ER-1914                     PIC S9(4)   VALUE +1914.
   871     12  ER-1915                     PIC S9(4)   VALUE +1915.
   872     12  ER-1916                     PIC S9(4)   VALUE +1916.
   873     12  ER-1917                     PIC S9(4)   VALUE +1917.
   874     12  ER-1918                     PIC S9(4)   VALUE +1918.
   875     12  ER-1919                     PIC S9(4)   VALUE +1919.
   876     12  ER-1920                     PIC S9(4)   VALUE +1920.
   877     12  ER-1921                     PIC S9(4)   VALUE +1921.
   878     12  ER-1922                     PIC S9(4)   VALUE +1922.
   879     12  ER-1923                     PIC S9(4)   VALUE +1923.
   880     12  ER-1924                     PIC S9(4)   VALUE +1924.
   881     12  ER-1925                     PIC S9(4)   VALUE +1925.
   882     12  ER-1926                     PIC S9(4)   VALUE +1926.
   883     12  ER-1927                     PIC S9(4)   VALUE +1927.
   884     12  ER-2393                     PIC S9(4)   VALUE +2393.
   885     12  ER-2600                     PIC S9(4)   VALUE +2600.
   886     12  ER-2601                     PIC S9(4)   VALUE +2601.
   887     12  ER-2602                     PIC S9(4)   VALUE +2602.
   888     12  ER-2603                     PIC S9(4)   VALUE +2603.
   889     12  ER-2604                     PIC S9(4)   VALUE +2604.
   890     12  ER-2605                     PIC S9(4)   VALUE +2605.
   891     12  ER-2606                     PIC S9(4)   VALUE +2606.
   892     12  ER-2607                     PIC S9(4)   VALUE +2607.
   893     12  ER-2608                     PIC S9(4)   VALUE +2608.
   894     12  ER-2609                     PIC S9(4)   VALUE +2609.
   895     12  ER-2610                     PIC S9(4)   VALUE +2610.
   896     12  ER-2611                     PIC S9(4)   VALUE +2611.
   897     12  ER-2612                     PIC S9(4)   VALUE +2612.
   898     12  ER-2613                     PIC S9(4)   VALUE +2613.
   899     12  ER-2614                     PIC S9(4)   VALUE +2614.
   900     12  ER-2615                     PIC S9(4)   VALUE +2615.
   901     12  ER-2616                     PIC S9(4)   VALUE +2616.
   902     12  ER-2617                     PIC S9(4)   VALUE +2617.
   903     12  ER-2618                     PIC S9(4)   VALUE +2618.
   904     12  ER-2619                     PIC S9(4)   VALUE +2619.
   905     12  ER-2620                     PIC S9(4)   VALUE +2620.
   906     12  ER-2621                     PIC S9(4)   VALUE +2621.
   907     12  ER-2622                     PIC S9(4)   VALUE +2622.
   908     12  ER-2623                     PIC S9(4)   VALUE +2623.
   909     12  ER-2624                     PIC S9(4)   VALUE +2624.
   910     12  ER-2625                     PIC S9(4)   VALUE +2625.
   911     12  ER-2626                     PIC S9(4)   VALUE +2626.
   912     12  ER-2627                     PIC S9(4)   VALUE +2627.
   913     12  ER-2628                     PIC S9(4)   VALUE +2628.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  18
* EL050.cbl
   914     12  ER-2629                     PIC S9(4)   VALUE +2629.
   915     12  ER-2630                     PIC S9(4)   VALUE +2630.
   916     12  ER-2631                     PIC S9(4)   VALUE +2631.
   917     12  ER-2632                     PIC S9(4)   VALUE +2632.
   918     12  ER-2633                     PIC S9(4)   VALUE +2633.
   919     12  ER-2634                     PIC S9(4)   VALUE +2634.
   920     12  ER-2635                     PIC S9(4)   VALUE +2635.
   921     12  ER-2636                     PIC S9(4)   VALUE +2636.
   922     12  ER-2637                     PIC S9(4)   VALUE +2637.
   923     12  ER-2638                     PIC S9(4)   VALUE +2638.
   924     12  ER-2639                     PIC S9(4)   VALUE +2639.
   925     12  ER-2640                     PIC S9(4)   VALUE +2640.
   926     12  ER-2641                     PIC S9(4)   VALUE +2641.
   927     12  ER-2642                     PIC S9(4)   VALUE +2642.
   928     12  ER-2643                     PIC S9(4)   VALUE +2643.
   929     12  ER-2644                     PIC S9(4)   VALUE +2644.
   930     12  ER-2645                     PIC S9(4)   VALUE +2645.
   931     12  ER-2646                     PIC S9(4)   VALUE +2646.
   932     12  ER-2647                     PIC S9(4)   VALUE +2647.
   933     12  ER-2648                     PIC S9(4)   VALUE +2648.
   934     12  ER-2649                     PIC S9(4)   VALUE +2649.
   935     12  ER-2650                     PIC S9(4)   VALUE +2650.
   936     12  ER-2651                     PIC S9(4)   VALUE +2651.
   937     12  ER-2652                     PIC S9(4)   VALUE +2652.
   938     12  ER-2653                     PIC S9(4)   VALUE +2653.
   939     12  ER-2654                     PIC S9(4)   VALUE +2654.
   940     12  ER-2655                     PIC S9(4)   VALUE +2655.
   941     12  ER-2656                     PIC S9(4)   VALUE +2656.
   942     12  ER-2657                     PIC S9(4)   VALUE +2657.
   943     12  ER-2658                     PIC S9(4)   VALUE +2658.
   944     12  ER-2659                     PIC S9(4)   VALUE +2659.
   945     12  ER-2660                     PIC S9(4)   VALUE +2660.
   946     12  ER-2661                     PIC S9(4)   VALUE +2661.
   947     12  ER-2662                     PIC S9(4)   VALUE +2662.
   948     12  ER-2663                     PIC S9(4)   VALUE +2663.
   949     12  ER-2664                     PIC S9(4)   VALUE +2664.
   950     12  ER-2665                     PIC S9(4)   VALUE +2665.
   951     12  ER-2666                     PIC S9(4)   VALUE +2666.
   952     12  ER-2667                     PIC S9(4)   VALUE +2667.
   953     12  ER-2668                     PIC S9(4)   VALUE +2668.
   954     12  ER-2669                     PIC S9(4)   VALUE +2669.
   955     12  ER-2670                     PIC S9(4)   VALUE +2670.
   956     12  ER-2671                     PIC S9(4)   VALUE +2671.
   957     12  ER-2672                     PIC S9(4)   VALUE +2672.
   958     12  ER-2673                     PIC S9(4)   VALUE +2673.
   959     12  ER-2674                     PIC S9(4)   VALUE +2674.
   960     12  ER-2675                     PIC S9(4)   VALUE +2675.
   961     12  ER-2676                     PIC S9(4)   VALUE +2676.
   962     12  ER-2677                     PIC S9(4)   VALUE +2677.
   963     12  ER-2678                     PIC S9(4)   VALUE +2678.
   964     12  ER-2679                     PIC S9(4)   VALUE +2679.
   965     12  ER-2680                     PIC S9(4)   VALUE +2680.
   966     12  ER-2681                     PIC S9(4)   VALUE +2681.
   967     12  ER-2682                     PIC S9(4)   VALUE +2682.
   968     12  ER-2683                     PIC S9(4)   VALUE +2683.
   969     12  ER-2684                     PIC S9(4)   VALUE +2684.
   970     12  ER-2685                     PIC S9(4)   VALUE +2685.
   971     12  ER-2686                     PIC S9(4)   VALUE +2686.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  19
* EL050.cbl
   972     12  ER-2687                     PIC S9(4)   VALUE +2687.
   973     12  ER-2688                     PIC S9(4)   VALUE +2688.
   974     12  ER-2689                     PIC S9(4)   VALUE +2689.
   975     12  ER-2690                     PIC S9(4)   VALUE +2690.
   976     12  ER-2691                     PIC S9(4)   VALUE +2691.
   977     12  ER-2692                     PIC S9(4)   VALUE +2692.
   978     12  ER-2693                     PIC S9(4)   VALUE +2693.
   979     12  ER-2694                     PIC S9(4)   VALUE +2694.
   980     12  ER-2695                     PIC S9(4)   VALUE +2695.
   981     12  ER-2696                     PIC S9(4)   VALUE +2696.
   982     12  ER-2697                     PIC S9(4)   VALUE +2697.
   983     12  ER-2698                     PIC S9(4)   VALUE +2698.
   984     12  ER-2699                     PIC S9(4)   VALUE +2699.
   985     12  ER-2700                     PIC S9(4)   VALUE +2700.
   986     12  ER-2701                     PIC S9(4)   VALUE +2701.
   987     12  ER-2702                     PIC S9(4)   VALUE +2702.
   988     12  ER-2703                     PIC S9(4)   VALUE +2703.
   989     12  ER-2704                     PIC S9(4)   VALUE +2704.
   990     12  ER-2707                     PIC S9(4)   VALUE +2707.
   991     12  ER-2720                     PIC S9(4)   VALUE +2720.
   992     12  ER-2709                     PIC S9(4)   VALUE +2709.
   993     12  ER-2717                     PIC S9(4)   VALUE +2717.
   994     12  ER-2718                     PIC S9(4)   VALUE +2718.
   995     12  ER-2719                     PIC S9(4)   VALUE +2719.
   996     12  ER-2721                     PIC S9(4)   VALUE +2721.
   997     12  ER-2722                     PIC S9(4)   VALUE +2722.
   998     12  ER-2723                     PIC S9(4)   VALUE +2723.
   999     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1000     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1001     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1002     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1003     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1004     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1005     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1006     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1007     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1008     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1009     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1010     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1011     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1012     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1013     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1014     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1015     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1016     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1017     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1018     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1019     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1020     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1021     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1022     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1023     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1024     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1025     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1026     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1027     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1028     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1029     12  ER-2754                     PIC S9(4)   VALUE +2754.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  20
* EL050.cbl
  1030     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1031     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1032     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1033     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1034     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1035     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1036     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1037     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1038     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1039     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1040     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1041     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1042     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1043     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1044     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1045     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1046     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1047     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1048     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1049     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1050     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1051     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1052     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1053     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1054     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1055     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1056     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1057     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1058     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1059     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1060     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1061     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1062     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1063     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1064     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1065     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1066     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1067     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1068     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1069     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1070     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1071     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1072     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1073     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1074     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1075     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1076     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1077     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1078     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1079     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1080     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1081     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1082     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1083     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1084     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1085     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1086     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1087     12  ER-2969                     PIC S9(4)   VALUE +2969.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  21
* EL050.cbl
  1088     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1089     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1090     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1091     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1092     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1093     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1094     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1095     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1096     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1097     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1098     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1099     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1100     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1101     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1102     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1103     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1104     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1105     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1106     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1107     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1108     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1109     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1110     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1111     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1112     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1113     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1114     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1115     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1116     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1117     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1118     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1119     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1120     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1121     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1122     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1123     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1124     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1125     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1126     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1127     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1128     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1129     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1130     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1131     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1132     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1133     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1134     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1135     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1136     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1137     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1138     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1139     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1140     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1141     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1142     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1143     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1144     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1145     12  ER-8087                     PIC S9(4)   VALUE +8087.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  22
* EL050.cbl
  1146     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1147     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1148     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1149     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1150     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1151     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1152     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1153     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1154     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1155     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1156     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1157     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1158     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1159     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1160     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1161     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1162     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1163     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1164     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1165     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1166     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1167     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1168     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1169     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1170     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1171     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1172     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1173     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1174     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1175     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1176     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1177     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1178     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1179     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1180     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1181     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1182     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1183     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1184     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1185******************************************************************
  1186***************   END OF ELC50WS     ****************************
  1187******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  23
* EL050.cbl
  1190 01  WORKING-STORAGE-WORK-AREAS.
  1191     12  WS-RESPONSE             PIC S9(8)  COMP.
  1192         88  WS-RESP-NORMAL           VALUE +00.
  1193         88  WS-RESP-ERROR            VALUE +01.
  1194         88  WS-RESP-NOTFND           VALUE +13.
  1195         88  WS-RESP-DUPREC           VALUE +14.
  1196         88  WS-RESP-ENDFILE          VALUE +20.
  1197     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1198     12  WORK-AREAS.
  1199         16  WK-CONV-GREG.
  1200             24  WCG-CENT             PIC XX.
  1201             24  WCG-REST             PIC X(4).
  1202         16  WORK-GREGORIAN-DATE.
  1203             24  WK-GREG-CENT         PIC XX.
  1204             24  WK-GREG-DATE-YYMMDD.
  1205                 28  WK-GREG-YYMM     PIC X(4).
  1206                 28  WK-GREG-DD       PIC XX.
  1207
  1208         16  WORK-SELECT-DATE.
  1209             24  WK-SELECT-CENT            PIC XX.
  1210             24  WK-SELECT-DATE-YYMMDD.
  1211                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1212                 28  FILLER                PIC XX.
  1213
  1214         16  WK-FORM-NO.
  1215             24  WK-FORM-BANK-ID       PIC X(5).
  1216             24  WK-FORM-UNDRWRTR      PIC X(1).
  1217             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1218
  1219         16  WK-MEMBER-NO.
  1220             24  WK-MEMBER-1-6        PIC X(6).
  1221             24  WK-MEMBER-7-12       PIC X(6).
  1222
  1223         16  WK-FULL-CERT-NO.
  1224             24  WK-CERT-POS-1-2      PIC X(2).
  1225             24  WK-CERT-POS-3        PIC X(1).
  1226             24  WK-CERT-POS-4        PIC X(1).
  1227             24  WK-CERT-POS-5-6      PIC X(2).
  1228             24  WK-CERT-POS-7        PIC X(1).
  1229             24  WK-CERT-POS-8-11     PIC X(4).
  1230
  1231         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1232             88  VALID-RATE-CODE        VALUE 'Y'.
  1233             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1234
  1235         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1236         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1237         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1238         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1239         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1240         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1241         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1242         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1243         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1244         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1245
  1246* DLO001
  1247 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  24
* EL050.cbl
  1248     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1249     12  DMPF-RETURN-CODE          PIC XX.
  1250         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1251         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1252         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1253         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1254         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1255         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1256
  1257* DLO002
  1258 01  WS-DLO-INTERNAL-POLICY-FORM.
  1259     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1260     12  DIPF-RETURN-CODE          PIC XX.
  1261         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1262         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1263         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1264         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1265         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1266         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1267
  1268* DLO003
  1269 01  WS-DLO-VALID-BANK-ID.
  1270     12  DVBI-BANK-ID              PIC X(5).
  1271     12  DVBI-BANK-ID-TYPE         PIC X.
  1272         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1273         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1274         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1275         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1276         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1277     12  DVBI-RETURN-CODE          PIC XX.
  1278         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1279         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1280         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1281         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1282         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1283         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1284         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1285         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1286         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1287
  1288* DLO007
  1289 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1290     12  DCUA-RES-STATE            PIC XX.
  1291     12  DCUA-BEN-TYPE             PIC XX.
  1292     12  DCUA-SYS-IDENT            PIC X.
  1293         88  DCUA-CLAIM                        VALUE 'C'.
  1294         88  DCUA-PREMIUM                      VALUE 'P'.
  1295     12  DCUA-COVERAGE-RULE        PIC X.
  1296     12  DCUA-CLIENT-ID            PIC X(10).
  1297     12  DCUA-EFF-DATE             PIC X(8).
  1298     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1299     12  DCUA-RETURN-CODE          PIC XX.
  1300         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1301     12  DCUA-CERT-NUMBER          PIC X(11).
  1302     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1303     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1304
  1305* DLO011
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  25
* EL050.cbl
  1306 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1307     12  DPRB-RATE-CODE            PIC X(4).
  1308     12  DPRB-COVERAGE-CATEG       PIC X.
  1309     12  DPRB-RETURN-CODE          PIC XX.
  1310         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1311         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1312         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1313         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1314         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1315         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1316         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1317         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1318         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1319     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1320     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1321     12  DPRB-BEN-TYPE             PIC XX.
  1322
  1323* DLO017
  1324 01  WS-DLO-VALID-RATE-CODE.
  1325     12  DVRC-RATE-CODE            PIC X(4).
  1326     12  DVRC-RETURN-CODE          PIC XX.
  1327         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1328         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1329         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1330         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1331         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1332         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1333
  1334* DLO019
  1335 01  WS-DLO-ORIG-COV-CAT.
  1336     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1337     12  DOCC-RETURN-CODE          PIC XX.
  1338     12  DOCC-ORIG-COV-CAT         PIC X.
  1339     12  DOCC-UNDERWITER           PIC XX.
  1340     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1341     12  DOCC-FILLER               PIC X(6).
  1342
  1343* DLO021
  1344 01  WS-DLO-VALID-LOAN-OFFICER.
  1345     12  DVLO-LOAN-OFFICER.
  1346         16  DVLO-BILL-TYPE        PIC X.
  1347         16  DVLO-BILL-SOURCE      PIC X.
  1348         16  DVLO-BATCH-TYPE       PIC X.
  1349     12  DVLO-RETURN-CODE          PIC XX.
  1350         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1351         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1352         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1353         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1354         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1355         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1356
  1357* DLO022
  1358 01  WS-DLO-VALID-STATE-CODE.
  1359     12  DVSC-STATE-CODE           PIC XX.
  1360     12  DVSC-RETURN-CODE          PIC XX.
  1361         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1362
  1363* DLO023
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  26
* EL050.cbl
  1364 01  WS-DLO-VALID-CODE-VALUES.
  1365     12  DVCV-SYSTEM-ID            PIC XX.
  1366         88  DVCV-CLAIMS                       VALUE 'CL'.
  1367         88  DVCV-CREDIT                       VALUE 'CR'.
  1368     12  DVCV-RECORD-TYPE          PIC XX.
  1369         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1370         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1371         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1372         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1373         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1374         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1375         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1376         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1377     12  DVCV-RECORD-KEY           PIC X(6).
  1378     12  DVCV-RETURN-CODE          PIC XX.
  1379         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1380         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1381         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1382         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1383         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1384         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1385         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1386     12  DVCV-CODE-DESC            PIC X(60).
  1387     12  DVCV-GEN-DESC-1           PIC X(20).
  1388     12  DVCV-GEN-DESC-2           PIC X(20).
  1389     12  DVCV-GEN-DESC-3           PIC X(20).
  1390
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  27
* EL050.cbl
  1392*    COPY ERCBXRF.
  1393******************************************************************
  1394*                                                                *
  1395*                                                                *
  1396*                            ERCBXRF                             *
  1397*                                                                *
  1398*   ONLINE CREDIT SYSTEM                                         *
  1399*                                                                *
  1400*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1401*                                                                *
  1402*   FILE TYPE = VSAM,KSDS                                        *
  1403*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1404*                                                                *
  1405*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1406*       ALTERNATE PATH = NONE                                    *
  1407*                                                                *
  1408*   LOG = NO                                                     *
  1409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1410*                                                                *
  1411******************************************************************
  1412
  1413 01  BANK-CROSS-REFERENCE.
  1414     12  BK-RECORD-ID                PIC XX.
  1415         88  VALID-BK-ID             VALUE 'BK'.
  1416
  1417     12  BK-CONTROL-PRIMARY.
  1418         16  BK-COMPANY-CD           PIC X.
  1419         16  BK-CARRIER              PIC X.
  1420         16  BK-GROUPING             PIC X(6).
  1421         16  BK-BANK-NO              PIC X(10).
  1422
  1423     12  BK-MAINT-INFORMATION.
  1424         16  BK-LAST-MAINT-DT        PIC XX.
  1425         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1426         16  BK-LAST-MAINT-USER      PIC X(4).
  1427         16  FILLER                  PIC X(9).
  1428
  1429     12  FILLER                      PIC X(37).
  1430
  1431     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1432
  1433     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1434                            DEPENDING ON BK-BANK-POINTER-CNT.
  1435         16  BK-AM-ACCOUNT           PIC X(10).
  1436         16  BK-AM-EXP-DT            PIC XX.
  1437         16  BK-AM-EFF-DT            PIC XX.
  1438         16  BK-AM-STATE             PIC XX.
  1439         16  FILLER                  PIC X(20).
  1440
  1441******************************************************************
  1442
  1443*    COPY ERCCOMP.
  1444******************************************************************
  1445*                                                                *
  1446*                                                                *
  1447*                            ERCCOMP                             *
  1448*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1449*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  28
* EL050.cbl
  1450*                                                                *
  1451*   ONLINE CREDIT SYSTEM                                         *
  1452*                                                                *
  1453*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1454*                                                                *
  1455*   FILE TYPE = VSAM,KSDS                                        *
  1456*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1457*                                                                *
  1458*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1459*       ALTERNATE PATH = NONE                                    *
  1460*                                                                *
  1461*   LOG = NO                                                     *
  1462*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1463*                                                                *
  1464******************************************************************
  1465*                   C H A N G E   L O G
  1466*
  1467* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1468*-----------------------------------------------------------------
  1469*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1470* EFFECTIVE    NUMBER
  1471*-----------------------------------------------------------------
  1472* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1473* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1474* 092205    2005050300006  PEMA  ADD LEASE FEE
  1475* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1476* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1477* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1478* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1479* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1480******************************************************************
  1481
  1482 01  COMPENSATION-MASTER.
  1483     12  CO-RECORD-ID                          PIC XX.
  1484         88  VALID-CO-ID                          VALUE 'CO'.
  1485
  1486     12  CO-CONTROL-PRIMARY.
  1487         16  CO-COMPANY-CD                     PIC X.
  1488         16  CO-CONTROL.
  1489             20  CO-CTL-1.
  1490                 24  CO-CARR-GROUP.
  1491                     28  CO-CARRIER            PIC X.
  1492                     28  CO-GROUPING.
  1493                         32  CO-GROUP-PREFIX   PIC XXX.
  1494                         32  CO-GROUP-PRIME    PIC XXX.
  1495                 24  CO-RESP-NO.
  1496                     28  CO-RESP-PREFIX        PIC X(4).
  1497                     28  CO-RESP-PRIME         PIC X(6).
  1498             20  CO-CTL-2.
  1499                 24  CO-ACCOUNT.
  1500                     28  CO-ACCT-PREFIX        PIC X(4).
  1501                     28  CO-ACCT-PRIME         PIC X(6).
  1502         16  CO-TYPE                           PIC X.
  1503             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1504             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1505             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1506
  1507     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  29
* EL050.cbl
  1508         16  CO-LAST-MAINT-DT                  PIC XX.
  1509         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1510         16  CO-LAST-MAINT-USER                PIC X(4).
  1511     12  FILLER                                PIC XX.
  1512     12  CO-STMT-TYPE                          PIC XXX.
  1513     12  CO-COMP-TYPE                          PIC X.
  1514         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1515     12  CO-STMT-OWNER                         PIC X(4).
  1516     12  CO-BALANCE-CONTROL                    PIC X.
  1517         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1518         88  CO-NO-BALANCE                        VALUE 'N'.
  1519
  1520     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1521         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1522         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1523         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1524
  1525     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1526         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1527         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1528
  1529     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1530     12  CO-GA-DIRECT-DEP                      PIC X.
  1531     12  CO-FUTURE-SPACE                       PIC X.
  1532         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1533
  1534     12  CO-ACCT-NAME                          PIC X(30).
  1535     12  CO-MAIL-NAME                          PIC X(30).
  1536     12  CO-ADDR-1                             PIC X(30).
  1537     12  CO-ADDR-2                             PIC X(30).
  1538     12  CO-ADDR-3.
  1539         16  CO-ADDR-CITY                      PIC X(27).
  1540         16  CO-ADDR-STATE                     PIC XX.
  1541     12  CO-CSO-1099                           PIC X.
  1542     12  CO-ZIP.
  1543         16  CO-ZIP-PRIME.
  1544             20  CO-ZIP-PRI-1ST                PIC X.
  1545                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1546             20  FILLER                        PIC X(4).
  1547         16  CO-ZIP-PLUS4                      PIC X(4).
  1548     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1549         16  CO-CAN-POSTAL-1                   PIC XXX.
  1550         16  CO-CAN-POSTAL-2                   PIC XXX.
  1551         16  FILLER                            PIC XXX.
  1552     12  CO-SOC-SEC                            PIC X(13).
  1553     12  CO-TELEPHONE.
  1554         16  CO-AREA-CODE                      PIC XXX.
  1555         16  CO-PREFIX                         PIC XXX.
  1556         16  CO-PHONE                          PIC X(4).
  1557
  1558     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1559
  1560     12  CO-AR-BAL-LEVEL                       PIC X.
  1561         88  CO-AR-REF-LVL                        VALUE '1'.
  1562         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1563         88  CO-AR-BILL-LVL                       VALUE '2'.
  1564         88  CO-AR-AGT-LVL                        VALUE '3'.
  1565         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  30
* EL050.cbl
  1566
  1567     12  CO-AR-NORMAL-PRINT                    PIC X.
  1568         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1569         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1570
  1571     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1572
  1573     12  CO-AR-REPORTING                       PIC X.
  1574         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1575         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1576
  1577     12  CO-AR-PULL-CHECK                      PIC X.
  1578         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1579         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1580
  1581     12  CO-AR-BALANCE-PRINT                   PIC X.
  1582         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1583
  1584     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1585         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1586         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1587         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1588
  1589     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1590
  1591     12  CO-USER-CODE                          PIC X.
  1592     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1593
  1594******************************************************************
  1595*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1596*    THE LAST MONTH END RUN.
  1597******************************************************************
  1598
  1599     12  CO-LAST-ACTIVITY-DATE.
  1600         16  CO-ACT-YEAR                       PIC 99.
  1601         16  CO-ACT-MONTH                      PIC 99.
  1602         16  CO-ACT-DAY                        PIC 99.
  1603
  1604     12  CO-LAST-STMT-DT.
  1605         16  CO-LAST-STMT-YEAR                 PIC 99.
  1606         16  CO-LAST-STMT-MONTH                PIC 99.
  1607         16  CO-LAST-STMT-DAY                  PIC 99.
  1608
  1609     12  CO-MO-END-TOTALS.
  1610         16  CO-MONTHLY-TOTALS.
  1611             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1612             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1613             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1614             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1615             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1616
  1617         16  CO-AGING-TOTALS.
  1618             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1619             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1620             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1621             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1622
  1623         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  31
* EL050.cbl
  1624             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1625             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1626
  1627         16  CO-OVER-UNDER-TOTALS.
  1628             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1629             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1630
  1631     12  CO-MISCELLANEOUS-TOTALS.
  1632         16  CO-FICA-TOTALS.
  1633             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1634             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1635
  1636         16  CO-CLAIM-TOTALS.
  1637             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1638             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1639
  1640******************************************************************
  1641*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1642*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1643******************************************************************
  1644
  1645     12  CO-CURRENT-TOTALS.
  1646         16  CO-CURRENT-LAST-STMT-DT.
  1647             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1648             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1649             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1650
  1651         16  CO-CURRENT-MONTHLY-TOTALS.
  1652             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1653             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1654             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-CURRENT-AGING-TOTALS.
  1659             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1660             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1661             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1662             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1663
  1664         16  CO-CURRENT-YTD-TOTALS.
  1665             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1666             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1667
  1668     12  CO-PAID-COMM-TOTALS.
  1669         16  CO-YTD-PAID-COMMS.
  1670             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1671             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1672
  1673     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1674         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1675         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1676
  1677     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1678         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1679         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1680         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1681         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  32
* EL050.cbl
  1682         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1683         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1684         88  CO-FINAL-LETTER                  VALUE 'F'.
  1685         88  CO-RECONCILING                   VALUE 'R'.
  1686         88  CO-PHONE-CALL                    VALUE 'P'.
  1687         88  CO-LEGAL                         VALUE 'L'.
  1688         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1689         88  CO-WRITE-OFF                     VALUE 'W'.
  1690         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1691
  1692     12  CO-CSR-CODE                       PIC X(4).
  1693
  1694     12  CO-GA-STATUS-INFO.
  1695         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1696         16  CO-GA-TERMINATION-DT          PIC XX.
  1697         16  CO-GA-STATUS-CODE             PIC X.
  1698             88  CO-GA-ACTIVE                 VALUE 'A'.
  1699             88  CO-GA-INACTIVE               VALUE 'I'.
  1700             88  CO-GA-PENDING                VALUE 'P'.
  1701         16  CO-GA-COMMENTS.
  1702             20  CO-GA-COMMENT-1           PIC X(40).
  1703             20  CO-GA-COMMENT-2           PIC X(40).
  1704             20  CO-GA-COMMENT-3           PIC X(40).
  1705             20  CO-GA-COMMENT-4           PIC X(40).
  1706
  1707     12  CO-RPTCD2                         PIC X(10).
  1708
  1709     12  CO-TYPE-AGENT                     PIC X(01).
  1710         88  CO-CORPORATION                   VALUE 'C'.
  1711         88  CO-PARTNERSHIP                   VALUE 'P'.
  1712         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1713         88  CO-TRUST                         VALUE 'T'.
  1714         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1715
  1716     12  CO-FAXNO.
  1717         16  CO-FAX-AREA-CODE                  PIC XXX.
  1718         16  CO-FAX-PREFIX                     PIC XXX.
  1719         16  CO-FAX-PHONE                      PIC X(4).
  1720
  1721     12  CO-BANK-INFORMATION.
  1722         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1723         16  CO-BANK-TRANSIT-NON REDEFINES
  1724             CO-BANK-TRANSIT-NO                PIC 9(8).
  1725
  1726         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1727     12  CO-MISC-DEDUCT-INFO REDEFINES
  1728                  CO-BANK-INFORMATION.
  1729         16  CO-MD-GL-ACCT                     PIC X(10).
  1730         16  CO-MD-DIV                         PIC XX.
  1731         16  CO-MD-CENTER                      PIC X(4).
  1732         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1733         16  CO-CREATE-AP-CHECK                PIC X.
  1734         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1735         16  FILLER                            PIC XXX.
  1736     12  CO-ACH-STATUS                         PIC X.
  1737         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1738         88  CO-ACH-PENDING                        VALUE 'P'.
  1739
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  33
* EL050.cbl
  1740     12  CO-BILL-SW                            PIC X.
  1741     12  CO-CONTROL-NAME                       PIC X(30).
  1742     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1743     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1744     12  CO-CLP-STATE                          PIC XX.
  1745     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1746     12  CO-SPP-REFUND-EDIT                    PIC X.
  1747
  1748******************************************************************
  1749
  1750*    COPY ERCAGTC.
  1751******************************************************************
  1752*                                                                *
  1753*                                                                *
  1754*                            ERCAGTC                             *
  1755*                            VMOD=2.001                          *
  1756*                                                                *
  1757*   ONLINE CREDIT SYSTEM                                         *
  1758*                                                                *
  1759*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1760*                                                                *
  1761*   FILE TYPE = VSAM,KSDS                                        *
  1762*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1763*                                                                *
  1764*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1765*       ALTERNATE PATH = NONE                                    *
  1766*                                                                *
  1767*   LOG = NO                                                     *
  1768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1769*                                                                *
  1770******************************************************************
  1771*                   C H A N G E   L O G
  1772*
  1773* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1774*-----------------------------------------------------------------
  1775*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1776* EFFECTIVE    NUMBER
  1777*-----------------------------------------------------------------
  1778* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1779* 111004                         NEW FILE AND COPYBOOK
  1780* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1781******************************************************************
  1782 01  AGENT-COMMISSIONS.
  1783     12  AG-RECORD-ID                          PIC XX.
  1784         88  VALID-CO-ID                          VALUE 'AG'.
  1785     12  AG-CONTROL-PRIMARY.
  1786         16  AG-COMPANY-CD                     PIC X.
  1787         16  AG-CONTROL.
  1788             20  AG-CTL-1.
  1789                 24  AG-CARR-GROUP.
  1790                     28  AG-CARRIER            PIC X.
  1791                     28  AG-GROUPING           PIC X(6).
  1792                 24  AG-BANK                   PIC X(10).
  1793             20  AG-CTL-2.
  1794                 24  AG-EXP-DT                 PIC XX.
  1795         16  AG-TYPE                           PIC X.
  1796             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1797             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  34
* EL050.cbl
  1798     12  AG-MAINT-INFORMATION.
  1799         16  AG-LAST-MAINT-DT                  PIC XX.
  1800         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1801         16  AG-LAST-MAINT-USER                PIC X(4).
  1802         16  FILLER                            PIC X(10).
  1803     12  AG-EFF-DT                             PIC XX.
  1804     12  AG-COMM-STRUCTURE.
  1805         16  AG-AGT-COMMS OCCURS 10.
  1806             20  AG-AGT                PIC X(10).
  1807             20  AG-COM-TYP            PIC X.
  1808             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1809             20  AG-RECALC-LV-INDIC    PIC X.
  1810             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1811             20  AG-LRCALC-LV-INDIC    PIC X.
  1812             20  FILLER                PIC X(05).
  1813     12  FILLER                  PIC X(145).
  1814******************************************************************
  1815*    COPY ERCRESS.
  1816******************************************************************
  1817*                                                                *
  1818*                            ERCRESS                             *
  1819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1820*                            VMOD=2.002                          *
  1821*                                                                *
  1822*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1823*                                                                *
  1824*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1825*   VSAM RESIDENT STATE TAX MASTER                              *
  1826*                                                                *
  1827*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1828*                                                                *
  1829*   FILE TYPE = VSAM,KSDS                                        *
  1830*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1831*                                                                *
  1832*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1833*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1834*                                                                *
  1835*   LOG = NO                                                     *
  1836*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1837*                                                                *
  1838*                                                                *
  1839******************************************************************
  1840
  1841 01  RESIDENT-STATE-TAX-MASTER.
  1842
  1843     10  ERRESS-PRIMARY-KEY.
  1844         15  RES-COMPANY-CD        PIC X.
  1845         15  RES-RESIDENT-STATE    PIC XX.
  1846         15  RES-COVERAGE-CATEGORY PIC X.
  1847         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1848*                                      YYYYMMDD
  1849*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1850
  1851     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1852
  1853         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1854         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1855         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  35
* EL050.cbl
  1856         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1857
  1858     10 RES-RECALC-SW              PIC   X.
  1859         88 RECALC                VALUE 'Y'.
  1860         88 NO-RECALC             VALUE 'N'.
  1861     10  RES-MAINT-BY              PIC X(4).
  1862     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1863     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1864*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  36
* EL050.cbl
  1866*    COPY ERCRESC.
  1867******************************************************************
  1868*                                                                *
  1869*                            ERCRESC                             *
  1870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1871*                            VMOD=2.003                          *
  1872*                                                                *
  1873*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1874*                                                                *
  1875*   FILE TYPE = VSAM,KSDS                                        *
  1876*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1877*                                                                *
  1878*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1879*       ALTERNATE PATH1 = NONE                                   *
  1880*                                                                *
  1881*   LOG = NO                                                     *
  1882*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1883*                                                                *
  1884******************************************************************
  1885
  1886 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1887
  1888     10  ERRESC-RECORD-KEY.
  1889         15  RESC-COMPANY-CD           PIC   X.
  1890         15  RESC-CARRIER              PIC   X.
  1891         15  RESC-GROUP                PIC   X(6).
  1892         15  RESC-STATE                PIC   XX.
  1893         15  RESC-ACCOUNT              PIC   X(10).
  1894         15  RESC-AGENT                PIC   X(10).
  1895         15  RESC-RESIDENT-STATE       PIC   XX.
  1896         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1897*                                           YYYYMMDD
  1898     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1899
  1900     10  RESC-COMM-RECORD-DATA.
  1901         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1902             20 RESC-COVERAGE-CAT      PIC    X.
  1903             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1904             20 RESC-COMMISSION-TAB REDEFINES
  1905                RESC-COMMISSION-PER    PIC  XXX.
  1906
  1907     10  RESC-MAINT-BY                 PIC X(4).
  1908     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1909     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1910*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  37
* EL050.cbl
  1912*    COPY ERCPLAN.
  1913******************************************************************
  1914*                                                                *
  1915*                                                                *
  1916*                            ERCPLAN                             *
  1917*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1918*                            VMOD=2.003                          *
  1919*                                                                *
  1920*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1921*                                                                *
  1922*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1923*   PLAN MASTER                                                  *
  1924*                                                                *
  1925*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1926*                                                                *
  1927*   FILE TYPE = VSAM,KSDS                                        *
  1928*   RECORD SIZE = 420   RECFORM = FIX                            *
  1929*                                                                *
  1930*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1931*       ALTERNATE PATH1 = N/A                                    *
  1932*                                                                *
  1933*   LOG = NO                                                     *
  1934*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1935*                                                                *
  1936*                                                                *
  1937******************************************************************
  1938
  1939 01  PLAN-MASTER.
  1940     12  PL-RECORD-ID                      PIC XX.
  1941         88  VALID-PL-ID                      VALUE 'PL'.
  1942
  1943     12  PL-CONTROL-PRIMARY.
  1944         16  PL-COMPANY-CD                 PIC X.
  1945         16  PL-MSTR-CNTRL.
  1946             20  PL-CONTROL-A.
  1947                 24  PL-CARRIER            PIC X.
  1948                 24  PL-GROUPING           PIC X(6).
  1949                 24  PL-STATE              PIC XX.
  1950                 24  PL-ACCOUNT            PIC X(10).
  1951             20  PL-BENEFIT-TYPE           PIC X.
  1952             20  PL-BENEFIT-CODE           PIC XX.
  1953             20  PL-REVISION-NO            PIC X(3).
  1954
  1955     12  PL-CONTROL-BY-VAR-GRP.
  1956         16  PL-COMPANY-CD-A1              PIC X.
  1957         16  PL-VG-CARRIER                 PIC X.
  1958         16  PL-VG-GROUPING                PIC X(6).
  1959         16  PL-VG-STATE                   PIC XX.
  1960         16  PL-VG-ACCOUNT                 PIC X(10).
  1961         16  PL-BENEFIT-TYPE-A1            PIC X.
  1962         16  PL-BENEFIT-CODE-A1            PIC XX.
  1963         16  PL-REVISION-NO-A1             PIC 999.
  1964
  1965     12  PL-MAINT-INFORMATION.
  1966         16  PL-LAST-MAINT-DT              PIC XX.
  1967         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1968         16  PL-LAST-MAINT-USER            PIC X(4).
  1969         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  38
* EL050.cbl
  1970
  1971     12  PL-LIABILITY-LIMITS.
  1972         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1973         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1974             20  PL-LM-AGE                 PIC S99        COMP-3.
  1975             20  PL-LM-DUR                 PIC S999       COMP-3.
  1976             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1977             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1978
  1979     12  FILLER                            PIC X(30).
  1980
  1981     12  PL-GL-ACCOUNT-NOS.
  1982         16  PL-PREMIUM-GL                 PIC X(8).
  1983         16  PL-COMM-GL                    PIC X(8).
  1984         16  PL-CLAIM-GL                   PIC X(8).
  1985     12  FILLER                            PIC X(24).
  1986     12  PL-TOLERANCES.
  1987         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1988         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1989         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1990         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1991         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1992         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1993     12  PL-OVER-SHORT.
  1994         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1995         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1996     12  FILLER                            PIC X(24).
  1997     12  PLAN-MISC.
  1998         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  1999         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2000         16  PL-IG                         PIC X.
  2001         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2002         16  PL-POLICY-FORM                PIC X(12).
  2003         16  PL-EDIT-FOR-FORM              PIC X(01).
  2004         16  PL-DEV-CODE                   PIC XXX.
  2005         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2006         16  PL-CALC-METHOD                PIC X.
  2007         16  PL-BENEFIT-GROUP              PIC X(05).
  2008         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2009
  2010         16  FILLER                        PIC X(99).
  2011******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  39
* EL050.cbl
  2013*    COPY ELCCERT.
  2014******************************************************************
  2015*                                                                *
  2016*                            ELCCERT.                            *
  2017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2018*                            VMOD=2.013                          *
  2019*                                                                *
  2020*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2021*                                                                *
  2022*   FILE TYPE = VSAM,KSDS                                        *
  2023*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2024*                                                                *
  2025*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2026*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2027*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2028*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2029*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2030*                                                                *
  2031*   LOG = YES                                                    *
  2032*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2033******************************************************************
  2034*                   C H A N G E   L O G
  2035*
  2036* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2037*-----------------------------------------------------------------
  2038*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2039* EFFECTIVE    NUMBER
  2040*-----------------------------------------------------------------
  2041* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2042* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2043* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2044* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2045* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2046* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2047* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2048******************************************************************
  2049
  2050 01  CERTIFICATE-MASTER.
  2051     12  CM-RECORD-ID                      PIC XX.
  2052         88  VALID-CM-ID                      VALUE 'CM'.
  2053
  2054     12  CM-CONTROL-PRIMARY.
  2055         16  CM-COMPANY-CD                 PIC X.
  2056         16  CM-CARRIER                    PIC X.
  2057         16  CM-GROUPING.
  2058             20  CM-GROUPING-PREFIX        PIC X(3).
  2059             20  CM-GROUPING-PRIME         PIC X(3).
  2060         16  CM-STATE                      PIC XX.
  2061         16  CM-ACCOUNT.
  2062             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2063             20  CM-ACCOUNT-PRIME          PIC X(6).
  2064         16  CM-CERT-EFF-DT                PIC XX.
  2065         16  CM-CERT-NO.
  2066             20  CM-CERT-PRIME             PIC X(10).
  2067             20  CM-CERT-SFX               PIC X.
  2068
  2069     12  CM-CONTROL-BY-NAME.
  2070         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  40
* EL050.cbl
  2071         16  CM-INSURED-LAST-NAME          PIC X(15).
  2072         16  CM-INSURED-INITIALS.
  2073             20  CM-INSURED-INITIAL1       PIC X.
  2074             20  CM-INSURED-INITIAL2       PIC X.
  2075
  2076     12  CM-CONTROL-BY-SSN.
  2077         16  CM-COMPANY-CD-A2              PIC X.
  2078         16  CM-SOC-SEC-NO.
  2079             20  CM-SSN-STATE              PIC XX.
  2080             20  CM-SSN-ACCOUNT            PIC X(6).
  2081             20  CM-SSN-LN3.
  2082                 25  CM-INSURED-INITIALS-A2.
  2083                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2084                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2085                 25 CM-PART-LAST-NAME-A2         PIC X.
  2086
  2087     12  CM-CONTROL-BY-CERT-NO.
  2088         16  CM-COMPANY-CD-A4              PIC X.
  2089         16  CM-CERT-NO-A4                 PIC X(11).
  2090
  2091     12  CM-CONTROL-BY-MEMB.
  2092         16  CM-COMPANY-CD-A5              PIC X.
  2093         16  CM-MEMBER-NO.
  2094             20  CM-MEMB-STATE             PIC XX.
  2095             20  CM-MEMB-ACCOUNT           PIC X(6).
  2096             20  CM-MEMB-LN4.
  2097                 25  CM-INSURED-INITIALS-A5.
  2098                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2099                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2100                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2101
  2102     12  CM-INSURED-PROFILE-DATA.
  2103         16  CM-INSURED-FIRST-NAME.
  2104             20  CM-INSURED-1ST-INIT       PIC X.
  2105             20  FILLER                    PIC X(9).
  2106         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2107         16  CM-INSURED-SEX                PIC X.
  2108             88  CM-SEX-MALE                  VALUE 'M'.
  2109             88  CM-SEX-FEMAL                 VALUE 'F'.
  2110         16  CM-INSURED-JOINT-AGE          PIC 99.
  2111         16  CM-JOINT-INSURED-NAME.
  2112             20  CM-JT-LAST-NAME           PIC X(15).
  2113             20  CM-JT-FIRST-NAME.
  2114                 24  CM-JT-1ST-INIT        PIC X.
  2115                 24  FILLER                PIC X(9).
  2116             20  CM-JT-INITIAL             PIC X.
  2117
  2118     12  CM-LIFE-DATA.
  2119         16  CM-LF-BENEFIT-CD              PIC XX.
  2120         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2121         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2122         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2123         16  CM-LF-DEV-CODE                PIC XXX.
  2124         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2125         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2126         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2127         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2128         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  41
* EL050.cbl
  2129         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2130         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2131         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2132         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2133         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2134         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2135         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2136         16  FILLER                        PIC XX.
  2137
  2138     12  CM-AH-DATA.
  2139         16  CM-AH-BENEFIT-CD              PIC XX.
  2140         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2141         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2142         16  CM-AH-DEV-CODE                PIC XXX.
  2143         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2144         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2145         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2146         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2147         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2148         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2149         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2150         16  CM-AH-PAID-THRU-DT            PIC XX.
  2151             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2152         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2153         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2154         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2155         16  FILLER                        PIC X.
  2156
  2157     12  CM-LOAN-INFORMATION.
  2158         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2159         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2160                                           PIC S9(5)V99  COMP-3.
  2161         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2162         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2163         16  CM-PAY-FREQUENCY              PIC S99.
  2164         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2165         16  CM-RATE-CLASS                 PIC XX.
  2166         16  CM-BENEFICIARY                PIC X(25).
  2167         16  CM-POLICY-FORM-NO             PIC X(12).
  2168         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2169         16  CM-LAST-ADD-ON-DT             PIC XX.
  2170         16  CM-DEDUCTIBLE-AMOUNTS.
  2171             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2172             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2173         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2174             20  CM-RESIDENT-STATE         PIC XX.
  2175             20  CM-RATE-CODE              PIC X(4).
  2176             20  FILLER                    PIC XX.
  2177         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2178             20  CM-LOAN-OFFICER           PIC X(5).
  2179             20  FILLER                    PIC XXX.
  2180         16  CM-CSR-CODE                   PIC XXX.
  2181         16  CM-UNDERWRITING-CODE          PIC X.
  2182             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2183         16  CM-POST-CARD-IND              PIC X.
  2184         16  CM-NH-INTERFACE-SW            PIC X.
  2185         16  CM-PREMIUM-TYPE               PIC X.
  2186             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  42
* EL050.cbl
  2187             88  CM-O-B-COVERAGE              VALUE '2'.
  2188             88  CM-OPEN-END                  VALUE '3'.
  2189         16  CM-IND-GRP-TYPE               PIC X.
  2190             88  CM-INDIVIDUAL                VALUE 'I'.
  2191             88  CM-GROUP                     VALUE 'G'.
  2192         16  CM-SKIP-CODE                  PIC X.
  2193             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2194             88  SKIP-JULY                    VALUE '1'.
  2195             88  SKIP-AUGUST                  VALUE '2'.
  2196             88  SKIP-SEPTEMBER               VALUE '3'.
  2197             88  SKIP-JULY-AUG                VALUE '4'.
  2198             88  SKIP-AUG-SEPT                VALUE '5'.
  2199             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2200             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2201             88  SKIP-JUNE                    VALUE '8'.
  2202             88  SKIP-JUNE-JULY               VALUE '9'.
  2203             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2204             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2205         16  CM-PAYMENT-MODE               PIC X.
  2206             88  PAY-MONTHLY                  VALUE SPACE.
  2207             88  PAY-WEEKLY                   VALUE '1'.
  2208             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2209             88  PAY-BI-WEEKLY                VALUE '3'.
  2210             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2211         16  CM-LOAN-NUMBER                PIC X(8).
  2212         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2213         16  CM-OLD-LOF                    PIC XXX.
  2214*        16  CM-LOAN-OFFICER               PIC XXX.
  2215         16  CM-REIN-TABLE                 PIC XXX.
  2216         16  CM-SPECIAL-REIN-CODE          PIC X.
  2217         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2218         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2219         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2220
  2221     12  CM-STATUS-DATA.
  2222         16  CM-ENTRY-STATUS               PIC X.
  2223         16  CM-ENTRY-DT                   PIC XX.
  2224
  2225         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2226         16  CM-LF-CANCEL-DT               PIC XX.
  2227         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2228
  2229         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2230         16  CM-LF-DEATH-DT                PIC XX.
  2231         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2232
  2233         16  CM-LF-CURRENT-STATUS          PIC X.
  2234             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2235                                                'M' '4' '5' '9'.
  2236             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2237             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2238             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2239             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2240             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2241             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2242             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2243             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2244             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  43
* EL050.cbl
  2245             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2246             88  CM-LF-DECLINED               VALUE 'D'.
  2247             88  CM-LF-VOIDED                 VALUE 'V'.
  2248
  2249         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2250         16  CM-AH-CANCEL-DT               PIC XX.
  2251         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2252
  2253         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2254         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2255         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2256
  2257         16  CM-AH-CURRENT-STATUS          PIC X.
  2258             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2259                                                'M' '4' '5' '9'.
  2260             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2261             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2262             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2263             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2264             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2265             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2266             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2267             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2268             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2269             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2270             88  CM-AH-DECLINED               VALUE 'D'.
  2271             88  CM-AH-VOIDED                 VALUE 'V'.
  2272
  2273         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2274             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2275             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2276             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2277         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2278
  2279         16  CM-ENTRY-BATCH                PIC X(6).
  2280         16  CM-LF-EXIT-BATCH              PIC X(6).
  2281         16  CM-AH-EXIT-BATCH              PIC X(6).
  2282         16  CM-LAST-MONTH-END             PIC XX.
  2283
  2284     12  CM-NOTE-SW                        PIC X.
  2285         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2286         88  CERT-NOTES-PRESENT               VALUE '1'.
  2287         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2288         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2289         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2290         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2291         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2292         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2293     12  CM-COMP-EXCP-SW                   PIC X.
  2294         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2295         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2296     12  CM-INSURED-ADDRESS-SW             PIC X.
  2297         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2298         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2299
  2300*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2301     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2302     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  44
* EL050.cbl
  2303
  2304*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2305     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2306     12  FILLER                            PIC X.
  2307*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2308     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2309
  2310     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2311         88  CERT-ADDED-BATCH                 VALUE ' '.
  2312         88  CERT-ADDED-ONLINE                VALUE '1'.
  2313         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2314         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2315         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2316     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2317         88  CERT-AS-LOADED                   VALUE ' '.
  2318         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2319         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2320         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2321         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2322         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2323         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2324         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2325
  2326     12  CM-ACCOUNT-COMM-PCTS.
  2327         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2328         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2329
  2330     12  CM-USER-FIELD                     PIC X.
  2331     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2332     12  CM-CLP-STATE                      PIC XX.
  2333     12  CM-USER-RESERVED                  PIC XXX.
  2334******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  45
* EL050.cbl
  2336*    COPY ERCMAIL.
  2337******************************************************************
  2338*                                                                *
  2339*                                                                *
  2340*                            ERCMAIL                             *
  2341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2342*                            VMOD=2.003                          *
  2343*                                                                *
  2344*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2345*                                                                *
  2346*   FILE TYPE = VSAM,KSDS                                        *
  2347*   RECORD SIZE = 374   RECFORM = FIX                            *
  2348*                                                                *
  2349*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2350*   ALTERNATE PATH    = NOT USED                                 *
  2351*                                                                *
  2352*   LOG = YES                                                    *
  2353*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2354******************************************************************
  2355*                   C H A N G E   L O G
  2356*
  2357* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2358*-----------------------------------------------------------------
  2359*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2360* EFFECTIVE    NUMBER
  2361*-----------------------------------------------------------------
  2362* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2363* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2364* 111108                   PEMA  ADD CRED BENE ADDR2
  2365******************************************************************
  2366
  2367 01  MAILING-DATA.
  2368     12  MA-RECORD-ID                      PIC XX.
  2369         88  VALID-MA-ID                       VALUE 'MA'.
  2370
  2371     12  MA-CONTROL-PRIMARY.
  2372         16  MA-COMPANY-CD                 PIC X.
  2373         16  MA-CARRIER                    PIC X.
  2374         16  MA-GROUPING.
  2375             20  MA-GROUPING-PREFIX        PIC XXX.
  2376             20  MA-GROUPING-PRIME         PIC XXX.
  2377         16  MA-STATE                      PIC XX.
  2378         16  MA-ACCOUNT.
  2379             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2380             20  MA-ACCOUNT-PRIME          PIC X(6).
  2381         16  MA-CERT-EFF-DT                PIC XX.
  2382         16  MA-CERT-NO.
  2383             20  MA-CERT-PRIME             PIC X(10).
  2384             20  MA-CERT-SFX               PIC X.
  2385
  2386     12  FILLER                            PIC XX.
  2387
  2388     12  MA-ACCESS-CONTROL.
  2389         16  MA-SOURCE-SYSTEM              PIC XX.
  2390             88  MA-FROM-CREDIT                VALUE 'CR'.
  2391             88  MA-FROM-VSI                   VALUE 'VS'.
  2392             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2393             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  46
* EL050.cbl
  2394         16  MA-RECORD-ADD-DT              PIC XX.
  2395         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2396         16  MA-LAST-MAINT-DT              PIC XX.
  2397         16  MA-LAST-MAINT-BY              PIC XXXX.
  2398         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2399
  2400     12  MA-PROFILE-INFO.
  2401         16  MA-QUALIFY-CODE-1             PIC XX.
  2402         16  MA-QUALIFY-CODE-2             PIC XX.
  2403         16  MA-QUALIFY-CODE-3             PIC XX.
  2404         16  MA-QUALIFY-CODE-4             PIC XX.
  2405         16  MA-QUALIFY-CODE-5             PIC XX.
  2406
  2407         16  MA-INSURED-LAST-NAME          PIC X(15).
  2408         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2409         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2410         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2411         16  MA-INSURED-BIRTH-DT           PIC XX.
  2412         16  MA-INSURED-SEX                PIC X.
  2413             88  MA-SEX-MALE                   VALUE 'M'.
  2414             88  MA-SEX-FEMALE                 VALUE 'F'.
  2415         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2416
  2417         16  MA-ADDRESS-CORRECTED          PIC X.
  2418         16  MA-JOINT-BIRTH-DT             PIC XX.
  2419*        16  FILLER                        PIC X(12).
  2420
  2421         16  MA-ADDRESS-LINE-1             PIC X(30).
  2422         16  MA-ADDRESS-LINE-2             PIC X(30).
  2423         16  MA-CITY-STATE.
  2424             20  MA-CITY                   PIC X(28).
  2425             20  MA-ADDR-STATE             PIC XX.
  2426         16  MA-ZIP.
  2427             20  MA-ZIP-CODE.
  2428                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2429                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2430                 24  FILLER                PIC X(4).
  2431             20  MA-ZIP-PLUS4              PIC X(4).
  2432         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2433             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2434             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2435             20  FILLER                    PIC X(3).
  2436
  2437         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2438
  2439         16  FILLER                        PIC XXX.
  2440*        16  FILLER                        PIC X(10).
  2441
  2442     12  MA-CRED-BENE-INFO.
  2443         16  MA-CRED-BENE-NAME                 PIC X(25).
  2444         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2445         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2446         16  MA-CRED-BENE-CTYST.
  2447             20  MA-CRED-BENE-CITY             PIC X(28).
  2448             20  MA-CRED-BENE-STATE            PIC XX.
  2449         16  MA-CRED-BENE-ZIP.
  2450             20  MA-CB-ZIP-CODE.
  2451                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  47
* EL050.cbl
  2452                     88  MA-CB-CANADIAN-POST-CODE
  2453                                           VALUE 'A' THRU 'Z'.
  2454                 24  FILLER                    PIC X(4).
  2455             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2456         16  MA-CB-CANADIAN-POSTAL-CODE
  2457                            REDEFINES MA-CRED-BENE-ZIP.
  2458             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2459             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2460             20  FILLER                        PIC X(3).
  2461     12  MA-POST-CARD-MAIL-DATA.
  2462         16  MA-MAIL-DATA OCCURS 7.
  2463             20  MA-MAIL-TYPE              PIC X.
  2464                 88  MA-12MO-MAILING           VALUE '1'.
  2465                 88  MA-EXP-MAILING            VALUE '2'.
  2466             20  MA-MAIL-STATUS            PIC X.
  2467                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2468                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2469                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2470             20  MA-MAIL-DATE              PIC XX.
  2471     12  FILLER                            PIC XX.
  2472     12  FILLER                            PIC XX.
  2473*    12  FILLER                            PIC X(30).
  2474******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  48
* EL050.cbl
  2476*    COPY ERCPNDM.
  2477******************************************************************
  2478*                                                                *
  2479*                                                                *
  2480*                            ERCPNDM                             *
  2481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2482*                            VMOD=2.003                          *
  2483*                                                                *
  2484*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2485*                                                                *
  2486*   FILE TYPE = VSAM,KSDS                                        *
  2487*   RECORD SIZE = 374   RECFORM = FIX                            *
  2488*                                                                *
  2489*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2490*   ALTERNATE PATH    = NOT USED                                 *
  2491*                                                                *
  2492*   LOG = YES                                                    *
  2493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2494******************************************************************
  2495*                   C H A N G E   L O G
  2496*
  2497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2498*-----------------------------------------------------------------
  2499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2500* EFFECTIVE    NUMBER
  2501*-----------------------------------------------------------------
  2502* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2503* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2504* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2505******************************************************************
  2506
  2507 01  PENDING-MAILING-DATA.
  2508     12  PM-RECORD-ID                      PIC XX.
  2509         88  VALID-MA-ID                       VALUE 'PM'.
  2510
  2511     12  PM-CONTROL-PRIMARY.
  2512         16  PM-COMPANY-CD                 PIC X.
  2513         16  PM-ENTRY-BATCH                PIC X(6).
  2514         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2515         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2516
  2517     12  FILLER                            PIC X(14).
  2518
  2519     12  PM-ACCESS-CONTROL.
  2520         16  PM-SOURCE-SYSTEM              PIC XX.
  2521             88  PM-FROM-CREDIT                VALUE 'CR'.
  2522             88  PM-FROM-VSI                   VALUE 'VS'.
  2523             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2524             88  PM-FROM-OTHER                 VALUE 'OT'.
  2525         16  PM-RECORD-ADD-DT              PIC XX.
  2526         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2527         16  PM-LAST-MAINT-DT              PIC XX.
  2528         16  PM-LAST-MAINT-BY              PIC XXXX.
  2529         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2530
  2531     12  PM-PROFILE-INFO.
  2532         16  PM-QUALIFY-CODE-1             PIC XX.
  2533         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  49
* EL050.cbl
  2534         16  PM-QUALIFY-CODE-3             PIC XX.
  2535         16  PM-QUALIFY-CODE-4             PIC XX.
  2536         16  PM-QUALIFY-CODE-5             PIC XX.
  2537
  2538         16  PM-INSURED-LAST-NAME          PIC X(15).
  2539         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2540         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2541         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2542         16  PM-INSURED-BIRTH-DT           PIC XX.
  2543         16  PM-INSURED-SEX                PIC X.
  2544             88  PM-SEX-MALE                   VALUE 'M'.
  2545             88  PM-SEX-FEMALE                 VALUE 'F'.
  2546         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2547
  2548         16  PM-ADDRESS-CORRECTED          PIC X.
  2549         16  PM-JOINT-BIRTH-DT             PIC XX.
  2550*        16  FILLER                        PIC X(12).
  2551
  2552         16  PM-ADDRESS-LINE-1             PIC X(30).
  2553         16  PM-ADDRESS-LINE-2             PIC X(30).
  2554         16  PM-CITY-STATE.
  2555             20  PM-CITY                   PIC X(28).
  2556             20  PM-STATE                  PIC XX.
  2557         16  PM-ZIP.
  2558             20  PM-ZIP-CODE.
  2559                 24  PM-ZIP-1              PIC X.
  2560                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2561                 24  FILLER                PIC X(4).
  2562             20  PM-ZIP-PLUS4              PIC X(4).
  2563         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2564             20  PM-CAN-POST1              PIC XXX.
  2565             20  PM-CAN-POST2              PIC XXX.
  2566             20  FILLER                    PIC XXX.
  2567
  2568         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2569
  2570         16  FILLER                        PIC X(03).
  2571
  2572     12  PM-CRED-BENE-INFO.
  2573         16  PM-CRED-BENE-NAME             PIC X(25).
  2574         16  PM-CRED-BENE-ADDR             PIC X(30).
  2575         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2576         16  PM-CRED-BENE-CTYST.
  2577             20  PM-CRED-BENE-CITY         PIC X(28).
  2578             20  PM-CRED-BENE-STATE        PIC XX.
  2579         16  PM-CRED-BENE-ZIP.
  2580             20  PM-CB-ZIP-CODE.
  2581                 24  PM-CB-ZIP-1           PIC X.
  2582                     88  PM-CB-CANADIAN-POST-CODE
  2583                                  VALUE 'A' THRU 'Z'.
  2584                 24  FILLER                PIC X(4).
  2585             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2586         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2587             20  PM-CB-CAN-POST1           PIC XXX.
  2588             20  PM-CB-CAN-POST2           PIC XXX.
  2589             20  FILLER                    PIC XXX.
  2590     12  PM-POST-CARD-MAIL-DATA.
  2591         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  50
* EL050.cbl
  2592             20  PM-MAIL-TYPE              PIC X.
  2593                 88  PM-12MO-MAILING           VALUE '1'.
  2594                 88  PM-EXP-MAILING            VALUE '2'.
  2595             20  PM-MAIL-STATUS            PIC X.
  2596                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2597                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2598                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2599             20  PM-MAIL-DATE              PIC XX.
  2600     12  FILLER                            PIC XX.
  2601     12  FILLER                            PIC X(12).
  2602*    12  FILLER                            PIC X(30).
  2603
  2604******************************************************************
  2605*                                COPY ERCLOFC.
  2606******************************************************************
  2607*                                                                *
  2608*                                                                *
  2609*                            ERCLOFC                             *
  2610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2611*                            VMOD=2.003                          *
  2612*                                                                *
  2613*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2614*                                                                *
  2615*   FILE TYPE = VSAM,KSDS                                        *
  2616*   RECORD SIZE = 670   RECFORM = FIX                            *
  2617*                                                                *
  2618*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2619*                                                                *
  2620*   LOG = YES                                                    *
  2621*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2622*                                                                *
  2623******************************************************************
  2624
  2625 01  LOAN-OFFICER-MASTER.
  2626     12  LO-RECORD-ID                PIC XX.
  2627         88  VALID-LO-ID                VALUE 'LO'.
  2628
  2629     12  LO-CONTROL-PRIMARY.
  2630         16  LO-COMPANY-CD           PIC X.
  2631         16  LO-CARRIER              PIC X.
  2632         16  LO-GROUPING.
  2633             20  LO-GROUPING-PREFIX  PIC XXX.
  2634             20  LO-GROUPING-PRIME   PIC XXX.
  2635         16  LO-STATE                PIC XX.
  2636         16  LO-ACCOUNT.
  2637             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2638             20  LO-ACCOUNT-PRIME    PIC X(6).
  2639         16  LO-OFFICER-CODE         PIC X(5).
  2640
  2641     12  LO-OFFICER-NAME             PIC X(30).
  2642
  2643     12  LO-LAST-MAINT-DT            PIC XX.
  2644     12  LO-LAST-USER                PIC X(4).
  2645     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2646
  2647     12  LO-COMP-CONTROL             PIC X.
  2648             88  LO-SHOW-COMP           VALUE 'Y'.
  2649             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  51
* EL050.cbl
  2650     12  LO-DETAIL-CONTROL           PIC X.
  2651             88  LO-PRINT-DETAIL        VALUE 'D'.
  2652             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2653
  2654     12  LO-SV-CARRIER               PIC X.
  2655     12  LO-SV-GROUPING              PIC X(6).
  2656     12  LO-SV-STATE                 PIC XX.
  2657
  2658     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2659     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2660
  2661     12  LO-OFFICER-INFO.
  2662         16  FILLER OCCURS 12 TIMES.
  2663             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2664             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2665             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2666             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2667             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2668             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2669             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2670             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2671     12  FILLER                      PIC X(198).
  2672******************************************************************
  2673*                                COPY ERCPDEF.
  2674******************************************************************
  2675*                                                                *
  2676*                                                                *
  2677*                            ERCPDEF.                            *
  2678*                                                                *
  2679*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2680*                                                                *
  2681*    FILE TYPE = VSAM,KSDS                                       *
  2682*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2683*                                                                *
  2684*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2685*                                                                *
  2686*    LOG = YES                                                   *
  2687*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2688******************************************************************
  2689 01  PRODUCT-MASTER.
  2690    12  PD-RECORD-ID                 PIC X(02).
  2691        88  VALID-PD-ID                  VALUE 'PD'.
  2692    12  PD-CONTROL-PRIMARY.
  2693        16  PD-COMPANY-CD            PIC X.
  2694        16  PD-STATE                 PIC XX.
  2695        16  PD-PRODUCT-CD            PIC XXX.
  2696        16  PD-FILLER                PIC X(7).
  2697        16  PD-BEN-TYPE              PIC X.
  2698        16  PD-BEN-CODE              PIC XX.
  2699        16  PD-PROD-EXP-DT           PIC XX.
  2700    12  FILLER                       PIC X(50).
  2701    12  PD-PRODUCT-DATA OCCURS 8.
  2702        16  PD-PROD-CODE             PIC X.
  2703            88  PD-PROD-LIFE           VALUE 'L'.
  2704            88  PD-PROD-PROP           VALUE 'P'.
  2705            88  PD-PROD-AH             VALUE 'A'.
  2706            88  PD-PROD-IU             VALUE 'I'.
  2707            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  52
* EL050.cbl
  2708        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2709        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2710        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2711        16  PD-MAX-TERM              PIC S999        COMP-3.
  2712        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2713        16  FILLER                   PIC X.
  2714        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2715        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2716        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2717        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2718        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2719        16  PD-REC-CRIT-PERIOD       PIC X.
  2720        16  PD-RTW-MOS               PIC 99.
  2721        16  FILLER                   PIC X(5).
  2722    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2723    12  PD-TERM-LIMITS OCCURS 15.
  2724        16  PD-LOW-TERM              PIC S999        COMP-3.
  2725        16  PD-HI-TERM               PIC S999        COMP-3.
  2726*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2727    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2728        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2729        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2730    12  PD-EARN-FACTORS.
  2731        16  FILLER OCCURS 15.
  2732            20  FILLER OCCURS 15.
  2733                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2734    12  PD-PRODUCT-DESC              PIC X(80).
  2735    12  FILLER                       PIC X(60).
  2736    12  PD-MAINT-INFORMATION.
  2737        16  PD-LAST-MAINT-DT         PIC X(02).
  2738        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2739        16  PD-LAST-MAINT-BY         PIC X(04).
  2740*                                COPY ELCSTATE.
  2741******************************************************************
  2742*                                                                *
  2743*                                                                *
  2744*                            ELCSTATE.                           *
  2745*                                                                *
  2746*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2747*                                                                *
  2748*   FILE TYPE = VSAM,KSDS                                        *
  2749*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2750*                                                                *
  2751*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2752*       ALTERNATE INDEX = NONE                                   *
  2753*                                                                *
  2754*   LOG = YES                                                    *
  2755*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2756******************************************************************
  2757*                   C H A N G E   L O G
  2758*
  2759* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2760*-----------------------------------------------------------------
  2761*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2762* EFFECTIVE    NUMBER
  2763*-----------------------------------------------------------------
  2764* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2765******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  53
* EL050.cbl
  2766*
  2767 01  STATE-FILE.
  2768     12  SF-RECORD-ID                       PIC XX.
  2769         88  VALID-CF-ID                        VALUE 'SF'.
  2770     12  SF-CONTROL-PRIMARY.
  2771         16  SF-COMPANY-ID                  PIC XXX.
  2772         16  SF-CARRIER-CODE                PIC X.
  2773         16  SF-GROUPING                    PIC X(6).
  2774         16  SF-STATE-CODE                  PIC XX.
  2775         16  SF-EXPIRE-DATE                 PIC 9(8).
  2776****************************************************************
  2777*             STATE CONTROLS
  2778****************************************************************
  2779     12  SF-LAST-MAINT-DT                   PIC XX.
  2780     12  SF-LAST-MAINT-BY                   PIC X(4).
  2781     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2782     12  SF-STATE-RT-CONTROLS.
  2783         16  SF-ST-RT-CALC                  PIC X.
  2784     12  SF-ST-TAX-CONTROLS.
  2785         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2786         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2787         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2788     12  SF-ST-REFUND-OPTIONS.
  2789         16  SF-ST-RF-LR-CALC               PIC X.
  2790         16  SF-ST-RF-LL-CALC               PIC X.
  2791         16  SF-ST-RF-LN-CALC               PIC X.
  2792         16  SF-ST-RF-AH-CALC               PIC X.
  2793         16  SF-ST-RF-CP-CALC               PIC X.
  2794     12  SF-ST-UNEARN-PREM-OPTIONS.
  2795         16  SF-ST-LUEP-R78                 PIC X.
  2796         16  SF-ST-LUEP-PRO                 PIC X.
  2797         16  SF-ST-LUEP-ST                  PIC X.
  2798         16  SF-ST-LUEP-DOM                 PIC X.
  2799         16  SF-ST-AUEP-R78                 PIC X.
  2800         16  SF-ST-AUEP-PRO                 PIC X.
  2801         16  SF-ST-AUEP-ST                  PIC X.
  2802         16  SF-ST-AUEP-DOM                 PIC X.
  2803         16  SF-ST-CUEP-R78                 PIC X.
  2804         16  SF-ST-CUEP-PRO                 PIC X.
  2805         16  SF-ST-CUEP-ST                  PIC X.
  2806         16  SF-ST-CUEP-DOM                 PIC X.
  2807     12  SF-ST-EARN-PREM-OPTIONS.
  2808         16  SF-ST-LEP-R78                  PIC X.
  2809         16  SF-ST-LEP-PRO                  PIC X.
  2810         16  SF-ST-LEP-ST                   PIC X.
  2811         16  SF-ST-LEP-DOM                  PIC X.
  2812         16  SF-ST-AEP-R78                  PIC X.
  2813         16  SF-ST-AEP-PRO                  PIC X.
  2814         16  SF-ST-AEP-ST                   PIC X.
  2815         16  SF-ST-AEP-DOM                  PIC X.
  2816         16  SF-ST-CEP-R78                  PIC X.
  2817         16  SF-ST-CEP-PRO                  PIC X.
  2818         16  SF-ST-CEP-ST                   PIC X.
  2819         16  SF-ST-CEP-DOM                  PIC X.
  2820     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  54
* EL050.cbl
  2822*    COPY ELCCRTT.
  2823******************************************************************
  2824*                                                                *
  2825*                            ELCCRTT.                            *
  2826*                                                                *
  2827*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2828*                                                                *
  2829*   FILE TYPE = VSAM,KSDS                                        *
  2830*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2831*                                                                *
  2832*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2833*                                                                *
  2834*   LOG = YES                                                    *
  2835*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2836******************************************************************
  2837*                   C H A N G E   L O G
  2838*
  2839* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2840*-----------------------------------------------------------------
  2841*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2842* EFFECTIVE    NUMBER
  2843*-----------------------------------------------------------------
  2844* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2845* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2846* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2847******************************************************************
  2848
  2849 01  CERTIFICATE-TRAILERS.
  2850     12  CS-RECORD-ID                      PIC XX.
  2851         88  VALID-CS-ID                      VALUE 'CS'.
  2852
  2853     12  CS-CONTROL-PRIMARY.
  2854         16  CS-COMPANY-CD                 PIC X.
  2855         16  CS-CARRIER                    PIC X.
  2856         16  CS-GROUPING                   PIC X(6).
  2857         16  CS-STATE                      PIC XX.
  2858         16  CS-ACCOUNT                    PIC X(10).
  2859         16  CS-CERT-EFF-DT                PIC XX.
  2860         16  CS-CERT-NO.
  2861             20  CS-CERT-PRIME             PIC X(10).
  2862             20  CS-CERT-SFX               PIC X.
  2863         16  CS-TRAILER-TYPE               PIC X.
  2864             88  COMM-TRLR           VALUE 'A'.
  2865             88  FUTURE-TRLR         VALUE 'B'.
  2866             88  CERT-DATA-TRLR      VALUE 'C'.
  2867
  2868     12  CS-DATA-AREA                      PIC X(516).
  2869
  2870     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2871         16  CS-BANK-COMMISSION-AREA.
  2872             20  CS-BANK-COMMS       OCCURS 10.
  2873                 24  CS-AGT                PIC X(10).
  2874                 24  CS-COM-TYP            PIC X.
  2875                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2876                 24  CS-RECALC-LV-INDIC    PIC X.
  2877                 24  FILLER                PIC X(10).
  2878         16  FILLER                        PIC X(256).
  2879
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  55
* EL050.cbl
  2880     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2881         16  CS-VIN-NUMBER                 PIC X(17).
  2882         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2883         16  FILLER                        PIC X(498).
  2884******************************************************************
  2885
  2886*    COPY ELCDATE.
  2887******************************************************************
  2888*                                                                *
  2889*                                                                *
  2890*                            ELCDATE.                            *
  2891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2892*                            VMOD=2.003
  2893*                                                                *
  2894*                                                                *
  2895*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2896*                 LENGTH = 200                                   *
  2897******************************************************************
  2898
  2899 01  DATE-CONVERSION-DATA.
  2900     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2901     12  DC-OPTION-CODE                PIC X.
  2902         88  BIN-TO-GREG                VALUE ' '.
  2903         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2904         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2905         88  YMD-GREG-TO-BIN            VALUE '3'.
  2906         88  MDY-GREG-TO-BIN            VALUE '4'.
  2907         88  JULIAN-TO-BIN              VALUE '5'.
  2908         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2909         88  FIND-CENTURY               VALUE '7'.
  2910         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2911         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2912         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2913         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2914         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2915         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2916         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2917         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2918         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2919         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2920         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2921         88  BIN-3-TO-GREG              VALUE 'I'.
  2922         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2923         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2924         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2925         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2926         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2927         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2928         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2929         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2930         88  THREE-CHARACTER-BIN
  2931                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2932         88  GREGORIAN-TO-BIN
  2933                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2934         88  BIN-TO-GREGORIAN
  2935                  VALUES ' ' '1' 'I' '8' 'G'.
  2936         88  JULIAN-TO-BINARY
  2937                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  56
* EL050.cbl
  2938     12  DC-ERROR-CODE                 PIC X.
  2939         88  NO-CONVERSION-ERROR        VALUE ' '.
  2940         88  DATE-CONVERSION-ERROR
  2941                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2942         88  DATE-IS-ZERO               VALUE '1'.
  2943         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2944         88  DATE-IS-INVALID            VALUE '3'.
  2945         88  DATE1-GREATER-DATE2        VALUE '4'.
  2946         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2947         88  DATE-INVALID-OPTION        VALUE '9'.
  2948         88  INVALID-CENTURY            VALUE 'A'.
  2949         88  ONLY-CENTURY               VALUE 'B'.
  2950         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2951         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2952     12  DC-END-OF-MONTH               PIC X.
  2953         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2954     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2955         88  USE-NORMAL-PROCESS         VALUE ' '.
  2956         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2957         88  ADJUST-UP-100-YRS          VALUE '2'.
  2958     12  FILLER                        PIC X.
  2959     12  DC-CONVERSION-DATES.
  2960         16  DC-BIN-DATE-1             PIC XX.
  2961         16  DC-BIN-DATE-2             PIC XX.
  2962         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2963         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2964                       DC-GREG-DATE-1-EDIT.
  2965             20  DC-EDIT1-MONTH        PIC 99.
  2966             20  SLASH1-1              PIC X.
  2967             20  DC-EDIT1-DAY          PIC 99.
  2968             20  SLASH1-2              PIC X.
  2969             20  DC-EDIT1-YEAR         PIC 99.
  2970         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2971         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2972                     DC-GREG-DATE-2-EDIT.
  2973             20  DC-EDIT2-MONTH        PIC 99.
  2974             20  SLASH2-1              PIC X.
  2975             20  DC-EDIT2-DAY          PIC 99.
  2976             20  SLASH2-2              PIC X.
  2977             20  DC-EDIT2-YEAR         PIC 99.
  2978         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2979         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2980                     DC-GREG-DATE-1-YMD.
  2981             20  DC-YMD-YEAR           PIC 99.
  2982             20  DC-YMD-MONTH          PIC 99.
  2983             20  DC-YMD-DAY            PIC 99.
  2984         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2985         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2986                      DC-GREG-DATE-1-MDY.
  2987             20  DC-MDY-MONTH          PIC 99.
  2988             20  DC-MDY-DAY            PIC 99.
  2989             20  DC-MDY-YEAR           PIC 99.
  2990         16  DC-GREG-DATE-1-ALPHA.
  2991             20  DC-ALPHA-MONTH        PIC X(10).
  2992             20  DC-ALPHA-DAY          PIC 99.
  2993             20  FILLER                PIC XX.
  2994             20  DC-ALPHA-CENTURY.
  2995                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  57
* EL050.cbl
  2996             20  DC-ALPHA-YEAR         PIC 99.
  2997         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2998         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2999         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3000         16  DC-JULIAN-DATE            PIC 9(05).
  3001         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3002                                       PIC 9(05).
  3003         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3004             20  DC-JULIAN-YEAR        PIC 99.
  3005             20  DC-JULIAN-DAYS        PIC 999.
  3006         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3007         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3008         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3009     12  DATE-CONVERSION-VARIBLES.
  3010         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3011         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3012             20  FILLER                PIC 9(3).
  3013             20  HOLD-CEN-1-CCYY.
  3014                 24  HOLD-CEN-1-CC     PIC 99.
  3015                 24  HOLD-CEN-1-YY     PIC 99.
  3016             20  HOLD-CEN-1-MO         PIC 99.
  3017             20  HOLD-CEN-1-DA         PIC 99.
  3018         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3019             20  HOLD-CEN-1-R-MO       PIC 99.
  3020             20  HOLD-CEN-1-R-DA       PIC 99.
  3021             20  HOLD-CEN-1-R-CCYY.
  3022                 24  HOLD-CEN-1-R-CC   PIC 99.
  3023                 24  HOLD-CEN-1-R-YY   PIC 99.
  3024             20  FILLER                PIC 9(3).
  3025         16  HOLD-CENTURY-1-X.
  3026             20  FILLER                PIC X(3)  VALUE SPACES.
  3027             20  HOLD-CEN-1-X-CCYY.
  3028                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3029                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3030             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3031             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3032         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3033             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3034             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3035             20  HOLD-CEN-1-R-X-CCYY.
  3036                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3037                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3038             20  FILLER                PIC XXX.
  3039         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3040         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3041         16  DC-JULIAN-DATE-1          PIC 9(07).
  3042         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3043             20  DC-JULIAN-1-CCYY.
  3044                 24  DC-JULIAN-1-CC    PIC 99.
  3045                 24  DC-JULIAN-1-YR    PIC 99.
  3046             20  DC-JULIAN-DA-1        PIC 999.
  3047         16  DC-JULIAN-DATE-2          PIC 9(07).
  3048         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3049             20  DC-JULIAN-2-CCYY.
  3050                 24  DC-JULIAN-2-CC    PIC 99.
  3051                 24  DC-JULIAN-2-YR    PIC 99.
  3052             20  DC-JULIAN-DA-2        PIC 999.
  3053         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  58
* EL050.cbl
  3054             20  DC-EDITA-MONTH        PIC 99.
  3055             20  SLASHA-1              PIC X VALUE '/'.
  3056             20  DC-EDITA-DAY          PIC 99.
  3057             20  SLASHA-2              PIC X VALUE '/'.
  3058             20  DC-EDITA-CCYY.
  3059                 24  DC-EDITA-CENT     PIC 99.
  3060                 24  DC-EDITA-YEAR     PIC 99.
  3061         16  DC-GREG-DATE-B-EDIT.
  3062             20  DC-EDITB-MONTH        PIC 99.
  3063             20  SLASHB-1              PIC X VALUE '/'.
  3064             20  DC-EDITB-DAY          PIC 99.
  3065             20  SLASHB-2              PIC X VALUE '/'.
  3066             20  DC-EDITB-CCYY.
  3067                 24  DC-EDITB-CENT     PIC 99.
  3068                 24  DC-EDITB-YEAR     PIC 99.
  3069         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3070         16  DC-GREG-DATE-CYMD-R REDEFINES
  3071                              DC-GREG-DATE-CYMD.
  3072             20  DC-CYMD-CEN           PIC 99.
  3073             20  DC-CYMD-YEAR          PIC 99.
  3074             20  DC-CYMD-MONTH         PIC 99.
  3075             20  DC-CYMD-DAY           PIC 99.
  3076         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3077         16  DC-GREG-DATE-MDCY-R REDEFINES
  3078                              DC-GREG-DATE-MDCY.
  3079             20  DC-MDCY-MONTH         PIC 99.
  3080             20  DC-MDCY-DAY           PIC 99.
  3081             20  DC-MDCY-CEN           PIC 99.
  3082             20  DC-MDCY-YEAR          PIC 99.
  3083    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3084        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3085    12  DC-EL310-DATE                  PIC X(21).
  3086    12  FILLER                         PIC X(28).
  3087
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  59
* EL050.cbl
  3089*    COPY ELCCALC.
  3090******************************************************************
  3091*                                                                *
  3092*                           ELCCALC.                            *
  3093*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3094*                            VMOD=2.025                          *
  3095*                                                                *
  3096*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3097*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3098*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3099*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3100*                                                                *
  3101*  PASSED TO ELRTRM                                              *
  3102*  -----------------                                             *
  3103*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3104*  ORIGINAL TERM                                                 *
  3105*  BEGINNING DATE                                                *
  3106*  ENDING DATE                                                   *
  3107*  COMPANY I.D.                                                  *
  3108*  ACCOUNT MASTER USER FIELD                                     *
  3109*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3110*  FREE LOOK DAYS                                                *
  3111*                                                                *
  3112*  RETURNED FROM ELRTRM                                          *
  3113*  ---------------------                                         *
  3114*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3115*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3116*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3117*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3118*----------------------------------------------------------------*
  3119*  PASSED TO ELRAMT                                              *
  3120*  ----------------                                              *
  3121*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3122*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3123*  ORIGINAL AMOUNT                                               *
  3124*  ALTERNATE BENEFIT (BALLON)                                    *
  3125*  A.P.R. - NET PAY ONLY                                         *
  3126*  METHOD
  3127*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3128*  COMPANY I.D.                                                  *
  3129*  BENEFIT TYPE                                                  *
  3130*                                                                *
  3131*  RETURNED FROM ELRAMT                                          *
  3132*  --------------------                                          *
  3133*  REMAINING AMOUNT 1 - CURRENT                                  *
  3134*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3135*  REMAINING AMOUNT FACTOR
  3136*----------------------------------------------------------------*
  3137*  PASSED TO ELRESV                                              *
  3138*  -----------------                                             *
  3139*  CERTIFICATE EFFECTIVE DATE                                    *
  3140*  VALUATION DATE                                                *
  3141*  PAID THRU DATE                                                *
  3142*  BENEFIT                                                       *
  3143*  INCURRED DATE                                                 *
  3144*  REPORTED DATE                                                 *
  3145*  ISSUE AGE                                                     *
  3146*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  60
* EL050.cbl
  3147*  CDT PERCENT                                                   *
  3148*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3149* *CLAIM TYPE (LIFE, A/H)                                        *
  3150* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3151* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3152*                                                                *
  3153*  RETURNED FROM ELRESV                                          *
  3154*  --------------------                                          *
  3155*  CDT TABLE USED                                                *
  3156*  CDT FACTOR USED                                               *
  3157*  PAY TO CURRENT RESERVE                                        *
  3158*  I.B.N.R. - A/H ONLY                                           *
  3159*  FUTURE (ACCRUED) AH ONLY                                      *
  3160*----------------------------------------------------------------*
  3161*  PASSED TO ELRATE                                              *
  3162*  ----------------                                              *
  3163*  CERT ISSUE DATE                                               *
  3164*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3165*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3166*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3167*  STATE CODE (CLIENT DEFINED)                                   *
  3168*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3169*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3170*  DEVIATION CODE                                                *
  3171*  ISSUE AGE                                                     *
  3172*  ORIGINAL BENEFIT AMOUNT                                       *
  3173*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3174*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3175*  BENEFIT KIND (LIFE OR A/H)                                    *
  3176*  A.P.R.                                                        *
  3177*  METHOD
  3178*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3179*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3180*  COMPANY I.D. (3 CHARACTER)                                    *
  3181*  BENEFIT CODE                                                  *
  3182*  BENEFIT OVERRIDE CODE                                         *
  3183*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3184*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3185*  JOINT INDICATOR (CSL ONLY)                                    *
  3186*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3187*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3188*                                                                *
  3189*  RETURNED FROM ELRATE                                          *
  3190*  --------------------                                          *
  3191*  CALCULATED PREMIUM                                            *
  3192*  PREMIUM RATE                                                  *
  3193*  MORTALITY CODE                                                *
  3194*  MAX ATTAINED AGE                                              *
  3195*  MAX AGE                                                       *
  3196*  MAX TERM                                                      *
  3197*  MAX MONTHLY BENEFIT                                           *
  3198*  MAX TOTAL BENIFIT                                             *
  3199*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3200*----------------------------------------------------------------*
  3201*  PASSED TO ELRFND                                              *
  3202*  ----------------                                              *
  3203*  CERT ISSUE DATE                                               *
  3204*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  61
* EL050.cbl
  3205*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3206*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3207*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3208*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3209*  STATE CODE (CLIENT DEFINED)                                   *
  3210*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3211*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3212*  DEVIATION CODE                                                *
  3213*  ISSUE AGE                                                     *
  3214*  ORIGINAL BENEFIT AMOUNT                                       *
  3215*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3216*  PROCESS TYPE (CANCEL)                                         *
  3217*  BENEFIT KIND (LIFE OR A/H)                                    *
  3218*  A.P.R.                                                        *
  3219*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3220*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3221*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3222*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3223*  COMPANY I.D. (3 CHARACTER)                                    *
  3224*  BENEFIT CODE                                                  *
  3225*  BENEFIT OVERRIDE CODE                                         *
  3226*                                                                *
  3227*  RETURNED FROM ELRFND                                          *
  3228*  --------------------                                          *
  3229*  CALCULATED REFUND                                             *
  3230*----------------------------------------------------------------*
  3231*  PASSED TO ELEARN                                              *
  3232*  ----------------                                              *
  3233*  CERT ISSUE DATE                                               *
  3234*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3235*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3236*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3237*  STATE CODE (CLIENT DEFINED)                                   *
  3238*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3239*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3240*  DEVIATION CODE                                                *
  3241*  ISSUE AGE                                                     *
  3242*  ORIGINAL BENEFIT AMOUNT                                       *
  3243*  BENEFIT KIND (LIFE OR A/H)                                    *
  3244*  A.P.R.                                                        *
  3245*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3246*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3247*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3248*  COMPANY I.D. (3 CHARACTER)                                    *
  3249*  BENEFIT CODE                                                  *
  3250*  BENEFIT OVERRIDE CODE                                         *
  3251*                                                                *
  3252*  RETURNED FROM ELEARN                                          *
  3253*  --------------------                                          *
  3254*  INDICATED  EARNINGS                                           *
  3255*----------------------------------------------------------------*
  3256*                 LENGTH = 450                                   *
  3257*                                                                *
  3258******************************************************************
  3259******************************************************************
  3260*                   C H A N G E   L O G
  3261*
  3262* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  62
* EL050.cbl
  3263*-----------------------------------------------------------------
  3264*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3265* EFFECTIVE    NUMBER
  3266*-----------------------------------------------------------------
  3267* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3268* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3269* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3270* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3271* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3272* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3273* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3274* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3275* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3276******************************************************************
  3277
  3278 01  CALCULATION-PASS-AREA.
  3279     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3280                                     COMP.
  3281
  3282     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3283       88  NO-CP-ERROR                             VALUE ZERO.
  3284       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3285                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3286       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3287       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3288       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3289       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3290       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3291       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3292       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3293       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3294       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3295       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3296       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3297       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3298       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3299       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3300       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3301       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3302       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3303
  3304     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3305       88  NO-CP-ERROR-2                           VALUE ZERO.
  3306***********************  INPUT AREAS ****************************
  3307
  3308     12  CP-CALCULATION-AREA.
  3309         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3310         16  CP-CERT-EFF-DT        PIC XX.
  3311         16  CP-VALUATION-DT       PIC XX.
  3312         16  CP-PAID-THRU-DT       PIC XX.
  3313         16  CP-BENEFIT-TYPE       PIC X.
  3314           88  CP-AH                               VALUE 'A' 'D'
  3315                                                   'I' 'U'.
  3316           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3317           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3318         16  CP-INCURRED-DT        PIC XX.
  3319         16  CP-REPORTED-DT        PIC XX.
  3320         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  63
* EL050.cbl
  3321         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3322         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3323                                     COMP-3.
  3324         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3325                                     COMP-3.
  3326         16  CP-CDT-METHOD         PIC X.
  3327           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3328           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3329           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3330         16  CP-CLAIM-TYPE         PIC X.
  3331           88  CP-AH-CLAIM                         VALUE 'A'.
  3332           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3333         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3334                                     COMP-3.
  3335         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3336                                     COMP-3.
  3337         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3338                                     COMP-3.
  3339         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3340                                     COMP-3.
  3341         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3342                                     COMP-3.
  3343         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3344                                     COMP-3.
  3345         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3346                                     COMP-3.
  3347         16  CP-REM-TERM-METHOD    PIC X.
  3348           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3349           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3350           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3351           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3352           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3353           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3354           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3355         16  CP-EARNING-METHOD     PIC X.
  3356           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3357           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3358           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3359           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3360           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3361           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3362           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3363           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3364           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3365           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3366           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3367           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3368           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3369           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3370         16  CP-PROCESS-TYPE       PIC X.
  3371           88  CP-CLAIM                            VALUE '1'.
  3372           88  CP-CANCEL                           VALUE '2'.
  3373           88  CP-ISSUE                            VALUE '3'.
  3374         16  CP-SPECIAL-CALC-CD    PIC X.
  3375           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3376           88  CP-1-MTH-INTEREST               VALUE ' '.
  3377           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3378           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  64
* EL050.cbl
  3379           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3380           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3381           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3382           88  CP-FARM-PLAN                    VALUE 'F'.
  3383           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3384           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3385           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3386           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3387           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3388           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3389           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3390           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3391           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3392           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3393                                                     'W' 'X'.
  3394           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3395           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3396           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3397           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3398           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3399           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3400           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3401           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3402           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3403           88  CP-CSL-METH-1                   VALUE '5'.
  3404           88  CP-CSL-METH-2                   VALUE '6'.
  3405           88  CP-CSL-METH-3                   VALUE '7'.
  3406           88  CP-CSL-METH-4                   VALUE '8'.
  3407
  3408         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3409                                     COMP-3.
  3410         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3411         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3412         16  CP-STATE              PIC XX          VALUE SPACE.
  3413         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3414         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3415           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3416               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3417         16  CP-R78-OPTION         PIC X.
  3418           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3419           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3420
  3421         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3422         16  CP-IBNR-RESERVE-SW    PIC X.
  3423         16  CP-CLAIM-STATUS       PIC X.
  3424         16  CP-RATE-FILE          PIC X.
  3425         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3426                                     COMP-3.
  3427
  3428         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3429         16  CP-AH-OVERRIDE-CODE   PIC X.
  3430
  3431         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3432                                     COMP-3.
  3433         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3434                                   PIC S9(5)V99 COMP-3.
  3435         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3436                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  65
* EL050.cbl
  3437         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3438                                     COMP-3.
  3439         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3440                                     COMP-3.
  3441         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3442                                  PIC S9(7)V99 COMP-3.
  3443
  3444         16  CP-PAID-FROM-DATE     PIC X(02).
  3445         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3446         16  CP-EXT-DAYS-CALC      PIC X.
  3447           88  CP-EXT-NO-CHG                   VALUE ' '.
  3448           88  CP-EXT-CHG-LF                   VALUE '1'.
  3449           88  CP-EXT-CHG-AH                   VALUE '2'.
  3450           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3451         16  CP-DOMICILE-STATE     PIC XX.
  3452         16  CP-CARRIER            PIC X.
  3453         16  CP-REIN-FLAG          PIC X.
  3454         16  CP-REM-TRM-CALC-OPTION PIC X.
  3455           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3456                      '2' '3' '4' '5'.
  3457           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3458           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3459           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3460           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3461           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3462           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3463           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3464           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3465         16  CP-SIG-SWITCH         PIC X.
  3466         16  CP-RATING-METHOD      PIC X.
  3467           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3468           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3469           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3470           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3471           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3472           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3473           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3474           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3475           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3476         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3477                                     COMP-3.
  3478         16  CP-BEN-CATEGORY       PIC X.
  3479         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3480         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3481                                   PIC S99V9(5) COMP-3.
  3482         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3483         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3484                                   PIC S99V9(5) COMP-3.
  3485         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3486         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3487         16  CP-EXPIRE-DT          PIC XX.
  3488         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3489         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3490         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3491         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3492         16  CP-DDF-SPEC-CALC      PIC X.
  3493             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3494             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  66
* EL050.cbl
  3495         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3496         16  CP-CANCEL-REASON      PIC X.
  3497         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3498         16  CP-PMT-MODE           PIC X.
  3499         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3500         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3501         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3502         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3503         16  FILLER                PIC X.
  3504
  3505***************    OUTPUT FROM ELRESV   ************************
  3506
  3507         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3508
  3509         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3510                                     COMP-3.
  3511         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3512                                     COMP-3.
  3513         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3514                                     COMP-3.
  3515         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3516                                     COMP-3.
  3517         16  FILLER                PIC X(09).
  3518***************    OUTPUT FROM ELRTRM   *************************
  3519
  3520         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3521                                     COMP-3.
  3522         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3523                                     COMP-3.
  3524         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3525                                     COMP-3.
  3526         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3527                                     COMP-3.
  3528         16  FILLER                PIC X(12).
  3529
  3530***************    OUTPUT FROM ELRAMT   *************************
  3531
  3532         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3533                                     COMP-3.
  3534         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3535                                     COMP-3.
  3536         16  FILLER                PIC X(12).
  3537
  3538***************    OUTPUT FROM ELRATE   *************************
  3539
  3540         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3543                                     COMP-3.
  3544         16  CP-MORTALITY-CODE     PIC X(4).
  3545         16  CP-RATE-EDIT-FLAG     PIC X.
  3546             88  CP-RATES-NEED-APR                  VALUE '1'.
  3547         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3548                                     COMP-3.
  3549         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3550         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3551         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3552                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  67
* EL050.cbl
  3553         16  FILLER                PIC X(07).
  3554
  3555***************    OUTPUT FROM ELRFND   *************************
  3556
  3557         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3558                                     COMP-3.
  3559         16  CP-REFUND-TYPE-USED   PIC X.
  3560           88  CP-R-AS-R78                         VALUE '1'.
  3561           88  CP-R-AS-PRORATA                     VALUE '2'.
  3562           88  CP-R-AS-CALIF                       VALUE '3'.
  3563           88  CP-R-AS-TEXAS                       VALUE '4'.
  3564           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3565           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3566           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3567           88  CP-R-AS-MEAN                        VALUE '8'.
  3568           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3569           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3570           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3571           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3572           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3573           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3574         16  FILLER                PIC X(12).
  3575
  3576***************    OUTPUT FROM ELEARN   *************************
  3577
  3578         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3583                                     COMP-3.
  3584         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3585                                     COMP-3.
  3586         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3587                                     COMP-3.
  3588         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3589                                     COMP-3.
  3590         16  CP-EARNING-TYPE-USED  PIC X.
  3591           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3592           88  CP-E-AS-R78                         VALUE '1'.
  3593           88  CP-E-AS-PRORATA                     VALUE '2'.
  3594           88  CP-E-AS-TEXAS                       VALUE '4'.
  3595           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3596           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3597           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3598           88  CP-E-AS-MEAN                        VALUE '8'.
  3599           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3600         16  FILLER                PIC X(12).
  3601
  3602***************    OUTPUT FROM ELPMNT   *************************
  3603
  3604         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3605                                     COMP-3.
  3606         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3607                                     COMP-3.
  3608         16  FILLER                PIC X(12).
  3609
  3610***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  68
* EL050.cbl
  3611         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3612                                     COMP-3.
  3613         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3614                                     COMP-3.
  3615         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3616                                     COMP-3.
  3617         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3618                                     COMP-3.
  3619         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3620                                     COMP-3.
  3621         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3624             88  OPEN-RATE-FILE                   VALUE 'O'.
  3625             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3626             88  IO-ERROR                         VALUE 'E'.
  3627
  3628         16  CP-FIRST-PAY-DATE     PIC XX.
  3629
  3630         16  CP-JOINT-INDICATOR    PIC X.
  3631
  3632         16  CP-RESERVE-REMAINING-TERM
  3633                                   PIC S9(4)V9    VALUE ZERO
  3634                                     COMP-3.
  3635
  3636         16  CP-INSURED-BIRTH-DT   PIC XX.
  3637
  3638         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3639                                     COMP-3.
  3640
  3641         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3642                                     COMP-3.
  3643
  3644         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3645                                     COMP-3.
  3646
  3647         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3648                                     COMP-3.
  3649
  3650         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3651                                     COMP-3.
  3652
  3653         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3654                                     COMP-3.
  3655
  3656         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3657                                     COMP-3.
  3658
  3659         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3660             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3661
  3662         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3667         16  FILLER                PIC X(15).
  3668******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  69
* EL050.cbl
  3670******************************************************************
  3671*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3672*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3673*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3674*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3675*** MODIFICATION.                                              ***
  3676*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3677*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3678******************************************************************
  3679*    COPY ERCPNDB.
  3680******************************************************************
  3681*                                                                *
  3682*                                                                *
  3683*                            ERCPNDB.                            *
  3684*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3685*                            VMOD=2.025                          *
  3686*                                                                *
  3687*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3688*                                                                *
  3689******************************************************************
  3690*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3691*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3692******************************************************************
  3693*                                                                *
  3694*                                                                *
  3695*   FILE TYPE = VSAM,KSDS                                        *
  3696*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3697*                                                                *
  3698*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3699*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3700*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3701*                                                 RKP=13,LEN=36  *
  3702*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3703*                                      AND CHG-SEQ.)             *
  3704*                                                RKP=49,LEN=11   *
  3705*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3706*                                      AND CHG-SEQ.)             *
  3707*                                                RKP=60,LEN=15   *
  3708*                                                                *
  3709*   LOG = NO                                                     *
  3710*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3711******************************************************************
  3712******************************************************************
  3713*                   C H A N G E   L O G
  3714*
  3715* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3716*-----------------------------------------------------------------
  3717*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3718* EFFECTIVE    NUMBER
  3719*-----------------------------------------------------------------
  3720* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3721* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3722* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3723* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3724* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3725* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3726* 032306                   PEMA  ADD BOW LOAN NUMBER
  3727* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  70
* EL050.cbl
  3728* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3729* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3730* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3731* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3732* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3733* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3734* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3735******************************************************************
  3736
  3737 01  PENDING-BUSINESS.
  3738     12  PB-RECORD-ID                     PIC XX.
  3739         88  VALID-PB-ID                        VALUE 'PB'.
  3740
  3741     12  PB-CONTROL-PRIMARY.
  3742         16  PB-COMPANY-CD                PIC X.
  3743         16  PB-ENTRY-BATCH               PIC X(6).
  3744         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3745         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3746
  3747     12  PB-CONTROL-BY-ACCOUNT.
  3748         16  PB-COMPANY-CD-A1             PIC X.
  3749         16  PB-CARRIER                   PIC X.
  3750         16  PB-GROUPING.
  3751             20  PB-GROUPING-PREFIX       PIC XXX.
  3752             20  PB-GROUPING-PRIME        PIC XXX.
  3753         16  PB-STATE                     PIC XX.
  3754         16  PB-ACCOUNT.
  3755             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3756             20  PB-ACCOUNT-PRIME         PIC X(6).
  3757         16  PB-CERT-EFF-DT               PIC XX.
  3758         16  PB-CERT-NO.
  3759             20  PB-CERT-PRIME            PIC X(10).
  3760             20  PB-CERT-SFX              PIC X.
  3761         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3762
  3763         16  PB-RECORD-TYPE               PIC X.
  3764             88  PB-MAILING-DATA                VALUE '0'.
  3765             88  PB-ISSUE                       VALUE '1'.
  3766             88  PB-CANCELLATION                VALUE '2'.
  3767             88  PB-BATCH-TRAILER               VALUE '9'.
  3768
  3769     12  PB-CONTROL-BY-ORIG-BATCH.
  3770         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3771         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3772         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3773         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3774
  3775     12  PB-CONTROL-BY-CSR.
  3776         16  PB-CSR-COMPANY-CD            PIC X.
  3777         16  PB-CSR-ID                    PIC X(4).
  3778         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3779         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3780         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3781******************************************************************
  3782*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3783******************************************************************
  3784
  3785     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  71
* EL050.cbl
  3786     12  PB-LAST-MAINT-BY                 PIC X(4).
  3787     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3788
  3789     12  PB-RECORD-BODY                   PIC X(375).
  3790
  3791     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3792         16  PB-CERT-ORIGIN               PIC X.
  3793             88  CLASIC-CREATED-CERT         VALUE '1'.
  3794         16  PB-I-NAME.
  3795             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3796             20  PB-I-INSURED-FIRST-NAME.
  3797                 24  PB-I-INSURED-1ST-INIT PIC X.
  3798                 24  FILLER                PIC X(9).
  3799             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3800         16  PB-I-AGE                     PIC S99   COMP-3.
  3801         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3802         16  PB-I-BIRTHDAY                PIC XX.
  3803         16  PB-I-INSURED-SEX             PIC X.
  3804             88  PB-SEX-MALE     VALUE 'M'.
  3805             88  PB-SEX-FEMALE   VALUE 'F'.
  3806
  3807         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3808         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3809         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3810         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3811         16  PB-I-SKIP-CODE               PIC X.
  3812             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3813             88  PB-SKIP-JULY              VALUE '1'.
  3814             88  PB-SKIP-AUGUST            VALUE '2'.
  3815             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3816             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3817             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3818             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3819             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3820             88  PB-SKIP-JUNE              VALUE '8'.
  3821             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3822             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3823             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3824         16  PB-I-TERM-TYPE               PIC X.
  3825             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3826             88  PB-PAID-WEEKLY            VALUE 'W'.
  3827             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3828             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3829             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3830         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3831         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3832         16  PB-I-DATA-ENTRY-SW           PIC X.
  3833             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3834             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3835             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3836             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3837         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3838         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3839*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3840         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3841         16  FILLER                       PIC X.
  3842
  3843         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  72
* EL050.cbl
  3844             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3845             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3846                                                   '90' THRU '99'.
  3847         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3848                                          PIC XX.
  3849         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3850         16  PB-I-AMOUNT-FINANCED REDEFINES
  3851                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3852         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3853         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3854                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3855         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3856         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3857         16  PB-I-CLP-AMOUNT REDEFINES
  3858                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3859         16  PB-I-LF-CALC-FLAG            PIC X.
  3860             88 PB-COMP-LF-PREM               VALUE '?'.
  3861         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3862         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3863         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3864         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3865         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3866         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3867         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3868         16  PB-I-LF-ABBR                 PIC XXX.
  3869         16  PB-I-LF-INPUT-CD             PIC XX.
  3870
  3871         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3872             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3873             88  PB-INVALID-AH               VALUE '  ' '00'
  3874                                                   '90' THRU '99'.
  3875         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3876         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3877         16  PB-I-AH-CALC-FLAG            PIC X.
  3878             88 PB-COMP-AH-PREM                  VALUE '?'.
  3879         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3880         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3881         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3882         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3883         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3884         16  PB-I-AH-ABBR                 PIC XXX.
  3885         16  PB-I-AH-INPUT-CD             PIC XXX.
  3886
  3887         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3888         16  PB-I-REIN-TABLE              PIC XXX.
  3889         16  PB-I-BUSINESS-TYPE           PIC 99.
  3890         16  PB-I-INDV-GRP-CD             PIC X.
  3891         16  PB-I-MORT-CODE.
  3892             20  PB-I-TABLE               PIC X.
  3893             20  PB-I-INTEREST            PIC XX.
  3894             20  PB-I-MORT-TYP            PIC X.
  3895         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3896         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3897         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3898         16  PB-I-INDV-GRP-OVRD           PIC X.
  3899         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3900         16  PB-I-SIG-SW                  PIC X.
  3901             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  73
* EL050.cbl
  3902         16  PB-I-RATE-CLASS              PIC XX.
  3903         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3904         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3905         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3906         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3907         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3908         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3909         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3910         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3911         16  PB-I-OB-FLAG                 PIC X.
  3912             88  PB-I-OB                      VALUE 'B'.
  3913             88  PB-I-SUMMARY                 VALUE 'Z'.
  3914         16  PB-I-ENTRY-STATUS            PIC X.
  3915             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3916                                              'M' '5' '9' '2'.
  3917             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3918             88  PB-I-POLICY-PENDING          VALUE '2'.
  3919             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3920             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3921             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3922             88  PB-I-REIN-ONLY               VALUE '9'.
  3923             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3924             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3925             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3926             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3927         16  PB-I-INT-CODE                PIC X.
  3928             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3929             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3930         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3931         16  PB-I-SOC-SEC-NO              PIC X(11).
  3932         16  PB-I-MEMBER-NO               PIC X(12).
  3933         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3934*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3935         16  PB-I-OLD-LOF                 PIC XXX.
  3936         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3937         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3938         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3939         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3940         16  PB-I-LIFE-INDICATOR          PIC X.
  3941             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3942         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3943         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3944                                          PIC S9(5)V99    COMP-3.
  3945         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3946             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3947             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3948         16  PB-I-1ST-PMT-DT              PIC XX.
  3949         16  PB-I-JOINT-INSURED.
  3950             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3951             20 PB-I-JOINT-FIRST-NAME.
  3952                24  PB-I-JOINT-FIRST-INIT PIC X.
  3953                24  FILLER                PIC X(9).
  3954             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3955*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3956         16  PB-I-BENEFICIARY-NAME.
  3957             20  PB-I-BANK-NUMBER         PIC X(10).
  3958             20  FILLER                   PIC X(15).
  3959         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  74
* EL050.cbl
  3960         16  PB-I-REFERENCE               PIC X(12).
  3961         16  FILLER REDEFINES PB-I-REFERENCE.
  3962             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3963             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3964             20  PB-I-CLP-STATE           PIC XX.
  3965         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3966             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3967             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3968             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3969         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3970         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3971         16  PB-I-RESIDENT-STATE          PIC XX.
  3972         16  PB-I-RATE-CODE               PIC X(4).
  3973         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3974         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3975         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3976         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3977         16  PB-I-BANK-NOCHRGB            PIC 99.
  3978         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3979         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3980
  3981     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3982         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3983             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3984         16  PB-C-CANCEL-ORIGIN           PIC X.
  3985             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3986         16  PB-C-LF-CANCEL-DT            PIC XX.
  3987         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3988         16  PB-C-LF-CALC-REQ             PIC X.
  3989             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3990         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3991         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3992         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3993             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3994         16  PB-C-AH-CANCEL-DT            PIC XX.
  3995         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3996         16  PB-C-AH-CALC-REQ             PIC X.
  3997             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3998         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3999         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4000         16  PB-C-LAST-NAME               PIC X(15).
  4001         16  PB-C-REFUND-SW               PIC X.
  4002             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4003             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4004         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4005         16  PB-C-PAYEE-CODE              PIC X(6).
  4006         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4007         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4008         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4009         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4010         16  PB-C-REFERENCE               PIC X(12).
  4011         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4012         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4013         16  PB-C-POST-CARD-IND           PIC X.
  4014         16  PB-C-CANCEL-REASON           PIC X.
  4015         16  PB-C-REF-INTERFACE-SW        PIC X.
  4016         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4017         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  75
* EL050.cbl
  4018         16  FILLER                       PIC X(01).
  4019*        16  FILLER                       PIC X(18).
  4020         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4021*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4022         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4023         16  PB-CANCELED-CERT-DATA.
  4024             20  PB-CI-INSURED-NAME.
  4025                 24  PB-CI-LAST-NAME      PIC X(15).
  4026                 24  PB-CI-INITIALS       PIC XX.
  4027             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4028             20  PB-CI-INSURED-SEX        PIC X.
  4029             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4030             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4031             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4032             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4033             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4034             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4035             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4036             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4037             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4038             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4039             20  PB-CI-RATE-CLASS         PIC XX.
  4040             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4041             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4042             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4043             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4044             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4045             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4046             20  PB-CI-LF-ABBR            PIC X(3).
  4047             20  PB-CI-AH-ABBR            PIC X(3).
  4048             20  PB-CI-OB-FLAG            PIC X.
  4049                 88  PB-CI-OB                VALUE 'B'.
  4050             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4051                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4052                                           'M' '4' '5' '9' '2'.
  4053                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4054                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4055                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4056                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4057                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4058                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4059                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4060                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4061                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4062                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4063                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4064                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4065             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4066                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4067                                           'M' '4' '5' '9' '2'.
  4068                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4069                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4070                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4071                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4072                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4073                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4074                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4075                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  76
* EL050.cbl
  4076                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4077                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4078                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4079                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4080             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4081             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4082             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4083             20  PB-CI-MEMBER-NO          PIC X(12).
  4084             20  PB-CI-INT-CODE           PIC X.
  4085                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4086                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4087             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4088             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4089             20  PB-CI-COMP-EXCP-SW       PIC X.
  4090                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4091                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4092             20  PB-CI-ENTRY-STATUS       PIC X.
  4093             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4094             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4095             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4096             20  PB-CI-DEATH-DT           PIC XX.
  4097             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4098             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4099             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4100             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4101             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4102             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4103             20  PB-CI-ENTRY-DT              PIC XX.
  4104             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4105             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4106             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4107             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4108             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4109             20  PB-CI-OLD-LOF               PIC XXX.
  4110*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4111             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4112             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4113             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4114             20  PB-CI-INDV-GRP-CD           PIC X.
  4115             20  PB-CI-BENEFICIARY-NAME.
  4116                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4117                 24  FILLER                  PIC X(15).
  4118             20  PB-CI-NOTE-SW               PIC X.
  4119             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4120             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4121             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4122             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4123             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4124             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4125             20  PB-CI-FIRST-NAME            PIC X(10).
  4126             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4127
  4128         16  FILLER                       PIC X(13).
  4129*032306  16  FILLER                       PIC X(27).
  4130*        16  FILLER                       PIC X(46).
  4131
  4132     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4133         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  77
* EL050.cbl
  4134         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4135         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4136         16  PB-M-INSURED-MID-INIT        PIC X.
  4137         16  PB-M-INSURED-AGE             PIC 99.
  4138         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4139         16  PB-M-INSURED-SEX             PIC X.
  4140         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4141         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4142         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4143         16  PB-M-INSURED-CITY-STATE.
  4144             20  PB-M-INSURED-CITY        PIC X(28).
  4145             20  PB-M-INSURED-STATE       PIC XX.
  4146         16  PB-M-INSURED-ZIP-CODE.
  4147             20  PB-M-INSURED-ZIP-PRIME.
  4148                 24  PB-M-INSURED-ZIP-1   PIC X.
  4149                     88  PB-M-CANADIAN-POST-CODE
  4150                                             VALUE 'A' THRU 'Z'.
  4151                 24  FILLER               PIC X(4).
  4152             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4153         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4154                                        PB-M-INSURED-ZIP-CODE.
  4155             20  PM-M-INS-CAN-POST1       PIC XXX.
  4156             20  PM-M-INS-CAN-POST2       PIC XXX.
  4157             20  FILLER                   PIC XXX.
  4158         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4159         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4160         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4161         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4162         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4163         16  PB-M-CRED-BENE-CITYST.
  4164             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4165             20  PB-M-CRED-BENE-STATE     PIC XX.
  4166         16  FILLER                       PIC X(92).
  4167
  4168     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4169         16  FILLER                       PIC X(10).
  4170         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4171         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4172         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4173         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4174         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4175         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4176         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4177         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4178         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4179         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4180         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4181         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4182         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4183         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4184         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4185         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4186         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4187         16  PB-ACCOUNT-NAME              PIC X(30).
  4188         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4189         16  PB-REFERENCE                 PIC X(12).
  4190         16  PB-B-RECEIVED-DT             PIC XX.
  4191         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  78
* EL050.cbl
  4192
  4193     12  PB-RECORD-STATUS.
  4194         16  PB-CREDIT-SELECT-DT          PIC XX.
  4195         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4196         16  PB-BILLED-DT                 PIC XX.
  4197         16  PB-BILLING-STATUS            PIC X.
  4198             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4199             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4200             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4201         16  PB-RECORD-BILL               PIC X.
  4202             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4203             88  PB-RECORD-RETURNED           VALUE 'R'.
  4204             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4205             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4206             88  PB-OVERRIDE-AH               VALUE 'A'.
  4207             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4208         16  PB-BATCH-ENTRY               PIC X.
  4209             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4210             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4211             88  PB-REISSUED-CERT             VALUE 'E'.
  4212             88  PB-MONTHLY-CERT              VALUE 'M'.
  4213             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4214             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4215             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4216         16  PB-FORCE-CODE                PIC X.
  4217             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4218             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4219             88  PB-CANCEL-FORCE              VALUE '8'.
  4220             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4221             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4222             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4223             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4224             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4225             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4226             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4227         16  PB-FATAL-FLAG                PIC X.
  4228             88  PB-FATAL-ERRORS              VALUE 'X'.
  4229         16  PB-FORCE-ER-CD               PIC X.
  4230             88  PB-FORCE-ERRORS              VALUE 'F'.
  4231             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4232         16  PB-WARN-ER-CD                PIC X.
  4233             88  PB-WARNING-ERRORS            VALUE 'W'.
  4234         16  FILLER                       PIC X.
  4235         16  PB-OUT-BAL-CD                PIC X.
  4236             88  PB-OUT-OF-BAL                VALUE 'O'.
  4237         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4238         16  PB-AH-OVERRIDE-L1            PIC X.
  4239         16  PB-INPUT-DT                  PIC XX.
  4240         16  PB-INPUT-BY                  PIC X(4).
  4241         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4242         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4243         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4244         16  PB-LF-EARNING-METHOD         PIC X.
  4245         16  PB-AH-EARNING-METHOD         PIC X.
  4246         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4247         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4248         16  PB-REIN-CD                   PIC XXX.
  4249         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  79
* EL050.cbl
  4250         16  PB-AH-REFUND-TYPE            PIC X.
  4251         16  PB-ACCT-EFF-DT               PIC XX.
  4252         16  PB-ACCT-EXP-DT               PIC XX.
  4253         16  PB-COMPANY-ID                PIC X(3).
  4254         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4255         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4256         16  PB-SV-CARRIER                PIC X.
  4257         16  PB-SV-GROUPING               PIC X(6).
  4258         16  PB-SV-STATE                  PIC XX.
  4259         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4260         16  PB-GA-BILLING-INFO.
  4261             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4262                                          PIC XX.
  4263         16  PB-SV-REMIT-TO  REDEFINES
  4264             PB-GA-BILLING-INFO           PIC X(10).
  4265         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4266         16  PB-I-LOAN-OFFICER            PIC X(5).
  4267         16  PB-I-VIN                     PIC X(17).
  4268
  4269         16  FILLER                       PIC X(04).
  4270         16  IMNET-BYPASS-SW              PIC X.
  4271
  4272******************************************************************
  4273*                COMMON EDIT ERRORS                              *
  4274******************************************************************
  4275
  4276     12  PB-COMMON-ERRORS.
  4277         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4278                                           PIC S9(4)     COMP.
  4279
  4280******************************************************************
  4281
  4282* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4283*    COPY ELC50W1.
  4284******************************************************************
  4285*                                                                *
  4286*                                                                *
  4287*                             ELC50W1                            *
  4288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4289*                            VMOD=2.004                          *
  4290*                                                                *
  4291*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4292*                                                                *
  4293*                                                                *
  4294******************************************************************
  4295
  4296     12  WK-WORK-AREA.
  4297         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4298         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4299         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4300         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4301         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4302         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4303         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4304         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4305         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4306         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4307         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  80
* EL050.cbl
  4308         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4309         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4310         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4311         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4312         16  WK-CREDIT-EDIT-CONTROLS.
  4313             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4314             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4315             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4316             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4317             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4318             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4319         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4320         16  WK-SAVE-REIN-DATA.
  4321             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4322             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4323             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4324         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4325             88  ENTRY-FROM-EL6311       VALUE '6'.
  4326         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4327         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4328     12  WK-RECORD-ADDRESSES.
  4329         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4330         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4331         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4332         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4333         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4334         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4335         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4336         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4337     12  WK-OVER-SHORT-AREA.
  4338         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4339         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4340         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4341             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4342         16  FILLER                   PIC X(5) VALUE SPACES.
  4343
  4344*    COPY ELCEDITC.
  4345******************************************************************
  4346*                                                                *
  4347*                                                                *
  4348*                            ELCEDITC                            *
  4349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4350*                            VMOD=2.012                          *
  4351*                                                                *
  4352*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4353*                     EL6313, EL050 AND EL517.                   *
  4354*                                                                *
  4355******************************************************************
  4356******************************************************************
  4357*                   C H A N G E   L O G
  4358*
  4359* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4360*-----------------------------------------------------------------
  4361*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4362* EFFECTIVE    NUMBER
  4363*-----------------------------------------------------------------
  4364* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4365******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  81
* EL050.cbl
  4366
  4367     12  EDIT-CRITERIA-DATA.
  4368         16  EC-CO-MONTH-END-DT       PIC XX.
  4369         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4370         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4371         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4372         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4373         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4374         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4375         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4376         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4377         16  EC-CO-REM-TERM-CALC      PIC X.
  4378               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4379               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4380               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4381               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4382
  4383         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4384               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4385               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4386               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4387               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4388               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4389               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4390               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4391               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4392               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4393               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4394
  4395         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4396               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4397               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4398               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4399               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4400               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4401               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4402               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4403               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4404
  4405         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4406                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4407                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4408
  4409         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4410                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4411                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4412                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4413                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4414                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4415                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4416                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4417                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4418
  4419         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4420               88  EC-BR-REDUCING                   VALUE 'R'.
  4421               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4422
  4423         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  82
* EL050.cbl
  4424         16  EC-BR-LF-DESC             PIC X(10).
  4425         16  EC-BR-AH-DESC             PIC X(10).
  4426         16  EC-BR-LF-COMMENT          PIC X(10).
  4427         16  EC-BR-AH-COMMENT          PIC X(10).
  4428
  4429         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4430               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4431               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4432               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4433               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4434
  4435         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4436               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4437               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4438               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4439               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4440
  4441         16  EC-BR-LF-REFUND-CALC      PIC X.
  4442                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4443                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4444                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4445                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4446                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4447                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4448                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4449
  4450         16  EC-BR-AH-REFUND-CALC      PIC X.
  4451                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4452                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4453                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4454                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4455                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4456                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4457                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4458                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4459
  4460         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4461                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4462                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4463                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4464
  4465         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4466                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4467                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4468                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4469
  4470         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4471         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4472         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4473         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4474
  4475         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4476         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4477                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4478                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4479                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4480                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4481
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  83
* EL050.cbl
  4482         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4483               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4484               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4485               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4486               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4487               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4488
  4489         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4490               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4491               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4492               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4493               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4494               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4495
  4496         16  EC-ST-LF-REFUND-CALC      PIC X.
  4497                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4498                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4499                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4500                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4501                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4502                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4503                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4504                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4505
  4506         16  EC-ST-AH-REFUND-CALC      PIC X.
  4507                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4508                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4509                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4510                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4511                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4512                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4513                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4514                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4515
  4516         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4517         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4518         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4519         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4520         16  EC-AM-EXPIRATION-DT       PIC XX.
  4521         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4522         16  EC-AM-CLASS-CD            PIC XX.
  4523         16  EC-AM-LF-DEVIATION        PIC XXX.
  4524         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4525         16  EC-AM-AH-DEVIATION        PIC XXX.
  4526         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4527         16  EC-AM-PHONE-NO            PIC X(10).
  4528
  4529         16  EC-AM-LF-REFUND-CALC      PIC X.
  4530                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4531                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4532                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4533                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4534                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4535                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4536                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4537
  4538         16  EC-AM-AH-REFUND-CALC      PIC X.
  4539                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  84
* EL050.cbl
  4540                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4541                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4542                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4543                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4544                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4545                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4546
  4547         16  EC-AM-BEN-I-G-CD          PIC X.
  4548                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4549                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4550                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4551
  4552         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4553         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4554         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4555         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4556         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4557         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4558         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4559         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4560         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4561
  4562         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4563         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4564         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4565         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4566         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4567         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4568         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4569         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4570         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4571         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4572         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4573         16  EC-RT-LF-NSP-ST           PIC XX.
  4574         16  EC-RT-AH-NSP-ST           PIC XX.
  4575         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4576         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4577
  4578         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4579             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4580                                             'M' '5' '9' '2'.
  4581             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4582             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4583             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4584             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4585             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4586             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4587             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4588             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4589             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4590             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4591
  4592         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4593             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4594                                             'M' '5' '9' '2'.
  4595             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4596             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4597             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  85
* EL050.cbl
  4598             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4599             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4600             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4601             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4602             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4603             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4604             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4605
  4606         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4607         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4608         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4609         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4610         16  EC-CM-DEATH-DT            PIC XX.
  4611
  4612*DMD CUSTOM CODING FIELDS BELOW
  4613*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4614         16  EC-BR-DMD-RATING-SW       PIC X.
  4615                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4616                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4617                 88  NO-DMD-RATING               VALUE 'N'.
  4618
  4619         16  EC-NEW-CERT               PIC X(11).
  4620         16  EC-NEW-STATE              PIC XX.
  4621         16  FILLER                    PIC X.
  4622*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4623         16  OVER-SHORT-EDIT-FIELDS.
  4624             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4625             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4626             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4627             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4628             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4629             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4630             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4631             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4632             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4633         16  FILLER                    PIC X(71).
  4634******************************************************************
  4635
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  86
* EL050.cbl
  4637*    COPY ELCDIFRD.
  4638******************************************************************
  4639*                                                                *
  4640*                                                                *
  4641*                            ELCDIFRD.                           *
  4642*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4643*                            VMOD=2.004                          *
  4644*                                                                *
  4645*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4646*                                                                *
  4647******************************************************************
  4648*
  4649  01  WS-DIFFERENCE-CALCULATION.
  4650        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4651        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4652        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4653        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4654        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4655        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4656        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4657        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4658        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4659        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4660        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4661
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  87
* EL050.cbl
  4663****************************************************************
  4664*
  4665* Copyright (c) 2007 by Clerity Solutions, Inc.
  4666* All rights reserved.
  4667*
  4668****************************************************************
  4669 01  DFHEIV.
  4670   02  DFHEIV0               PIC X(35).
  4671   02  DFHEIV1               PIC X(08).
  4672   02  DFHEIV2               PIC X(08).
  4673   02  DFHEIV3               PIC X(08).
  4674   02  DFHEIV4               PIC X(06).
  4675   02  DFHEIV5               PIC X(04).
  4676   02  DFHEIV6               PIC X(04).
  4677   02  DFHEIV7               PIC X(02).
  4678   02  DFHEIV8               PIC X(02).
  4679   02  DFHEIV9               PIC X(01).
  4680   02  DFHEIV10              PIC S9(7) COMP-3.
  4681   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4682   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4683   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4684   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4685   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4686   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4687   02  DFHEIV17              PIC X(04).
  4688   02  DFHEIV18              PIC X(04).
  4689   02  DFHEIV19              PIC X(04).
  4690   02  DFHEIV20              USAGE IS POINTER.
  4691   02  DFHEIV21              USAGE IS POINTER.
  4692   02  DFHEIV22              USAGE IS POINTER.
  4693   02  DFHEIV23              USAGE IS POINTER.
  4694   02  DFHEIV24              USAGE IS POINTER.
  4695   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4696   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4697   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4698   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4699   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4700   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4701   02  FILLER                PIC X(02).
  4702   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4703   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4704   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4705   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4706   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4707 LINKAGE  SECTION.
  4708*****************************************************************
  4709*                                                               *
  4710* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4711* All rights reserved.                                          *
  4712*                                                               *
  4713*****************************************************************
  4714 01  dfheiblk.
  4715     02  eibtime          pic s9(7) comp-3.
  4716     02  eibdate          pic s9(7) comp-3.
  4717     02  eibtrnid         pic x(4).
  4718     02  eibtaskn         pic s9(7) comp-3.
  4719     02  eibtrmid         pic x(4).
  4720     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  88
* EL050.cbl
  4721     02  eibcposn         pic s9(4) comp.
  4722     02  eibcalen         pic s9(4) comp.
  4723     02  eibaid           pic x(1).
  4724     02  eibfiller1       pic x(1).
  4725     02  eibfn            pic x(2).
  4726     02  eibfiller2       pic x(2).
  4727     02  eibrcode         pic x(6).
  4728     02  eibfiller3       pic x(2).
  4729     02  eibds            pic x(8).
  4730     02  eibreqid         pic x(8).
  4731     02  eibrsrce         pic x(8).
  4732     02  eibsync          pic x(1).
  4733     02  eibfree          pic x(1).
  4734     02  eibrecv          pic x(1).
  4735     02  eibsend          pic x(1).
  4736     02  eibatt           pic x(1).
  4737     02  eibeoc           pic x(1).
  4738     02  eibfmh           pic x(1).
  4739     02  eibcompl         pic x(1).
  4740     02  eibsig           pic x(1).
  4741     02  eibconf          pic x(1).
  4742     02  eiberr           pic x(1).
  4743     02  eibrldbk         pic x(1).
  4744     02  eiberrcd         pic x(4).
  4745     02  eibsynrb         pic x(1).
  4746     02  eibnodat         pic x(1).
  4747     02  eibfiller5       pic x(2).
  4748     02  eibresp          pic 9(09) comp.
  4749     02  eibresp2         pic 9(09) comp.
  4750     02  dfheigdj         pic s9(4) comp.
  4751     02  dfheigdk         pic s9(4) comp.
  4752
  4753 01  DFHCOMMAREA                   PIC X(1036).
  4754
  4755*01 PARMLIST .
  4756*    02  FILLER                    PIC S9(8)   COMP.
  4757*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4758*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4759*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4760*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4761*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4762*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4763*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4764
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  89
* EL050.cbl
  4766*    COPY ELCCNTL.
  4767******************************************************************
  4768*                                                                *
  4769*                                                                *
  4770*                            ELCCNTL.                            *
  4771*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4772*                            VMOD=2.059                          *
  4773*                                                                *
  4774*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4775*                                                                *
  4776*   FILE TYPE = VSAM,KSDS                                        *
  4777*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4778*                                                                *
  4779*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4780*       ALTERNATE INDEX = NONE                                   *
  4781*                                                                *
  4782*   LOG = YES                                                    *
  4783*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4784******************************************************************
  4785*                   C H A N G E   L O G
  4786*
  4787* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4788*-----------------------------------------------------------------
  4789*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4790* EFFECTIVE    NUMBER
  4791*-----------------------------------------------------------------
  4792* 082503                   PEMA  ADD BENEFIT GROUP
  4793* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4794* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4795* 092705    2005050300006  PEMA  ADD SPP LEASES
  4796* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4797* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4798* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4799* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4800* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4801******************************************************************
  4802*
  4803 01  CONTROL-FILE.
  4804     12  CF-RECORD-ID                       PIC XX.
  4805         88  VALID-CF-ID                        VALUE 'CF'.
  4806
  4807     12  CF-CONTROL-PRIMARY.
  4808         16  CF-COMPANY-ID                  PIC XXX.
  4809         16  CF-RECORD-TYPE                 PIC X.
  4810             88  CF-COMPANY-MASTER              VALUE '1'.
  4811             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4812             88  CF-STATE-MASTER                VALUE '3'.
  4813             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4814             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4815             88  CF-CARRIER-MASTER              VALUE '6'.
  4816             88  CF-MORTALITY-MASTER            VALUE '7'.
  4817             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4818             88  CF-TERMINAL-MASTER             VALUE '9'.
  4819             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4820             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4821             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4822             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4823             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  90
* EL050.cbl
  4824             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4825             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4826             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4827             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4828         16  CF-ACCESS-CD-GENL              PIC X(4).
  4829         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4830             20  CF-PROCESSOR               PIC X(4).
  4831         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4832             20  CF-STATE-CODE              PIC XX.
  4833             20  FILLER                     PIC XX.
  4834         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4835             20  FILLER                     PIC XX.
  4836             20  CF-HI-BEN-IN-REC           PIC XX.
  4837         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4838             20  FILLER                     PIC XXX.
  4839             20  CF-CARRIER-CNTL            PIC X.
  4840         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4841             20  FILLER                     PIC XX.
  4842             20  CF-HI-TYPE-IN-REC          PIC 99.
  4843         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4844             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4845                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4846             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4847             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4848         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4849             20  FILLER                     PIC X.
  4850             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4851         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  FILLER                     PIC XX.
  4853             20  CF-MORTGAGE-PLAN           PIC XX.
  4854         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4855
  4856     12  CF-LAST-MAINT-DT                   PIC XX.
  4857     12  CF-LAST-MAINT-BY                   PIC X(4).
  4858     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4859
  4860     12  CF-RECORD-BODY                     PIC X(728).
  4861
  4862
  4863****************************************************************
  4864*             COMPANY MASTER RECORD                            *
  4865****************************************************************
  4866
  4867     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4868         16  CF-COMPANY-ADDRESS.
  4869             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4870             20  CF-CL-IN-CARE-OF           PIC X(30).
  4871             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4872             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4873             20  CF-CL-CITY-STATE           PIC X(30).
  4874             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4875             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4876         16  CF-COMPANY-CD                  PIC X.
  4877         16  CF-COMPANY-PASSWORD            PIC X(8).
  4878         16  CF-SECURITY-OPTION             PIC X.
  4879             88  ALL-SECURITY                   VALUE '1'.
  4880             88  COMPANY-VERIFY                 VALUE '2'.
  4881             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  91
* EL050.cbl
  4882             88  NO-SECURITY                    VALUE '4'.
  4883             88  ALL-BUT-TERM                   VALUE '5'.
  4884         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4885             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4886         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4887             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4888         16  CF-INFORCE-LOCATION            PIC X.
  4889             88  CERTS-ARE-ONLINE               VALUE '1'.
  4890             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4891             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4892         16  CF-LOWER-CASE-LETTERS          PIC X.
  4893         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4894             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4895             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4896             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4897             88  CF-ACCNT-CNTL                  VALUE '3'.
  4898             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4899
  4900         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4901         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4902
  4903         16  CF-LGX-CREDIT-USER             PIC X.
  4904             88  CO-IS-NOT-USER                 VALUE 'N'.
  4905             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4906
  4907         16 CF-CREDIT-CALC-CODES.
  4908             20  CF-CR-REM-TERM-CALC PIC X.
  4909               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4910               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4911               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4912               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4913               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4914               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4915               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4916             20  CF-CR-R78-METHOD           PIC X.
  4917               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4918               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4919
  4920         16  CF-CLAIM-CONTROL-COUNTS.
  4921             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4922                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4923
  4924             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4925                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4926
  4927             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4928                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4929
  4930             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4931                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4932
  4933         16  CF-CURRENT-MONTH-END           PIC XX.
  4934
  4935         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4936             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4937             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4938             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4939             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  92
* EL050.cbl
  4940                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4941                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4942             20  CF-CO-PREM-REJECT-SW       PIC X.
  4943                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4944                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4945             20  CF-CO-REF-REJECT-SW        PIC X.
  4946                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4947                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4948
  4949         16  CF-CO-REPORTING-DT             PIC XX.
  4950         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4951         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4952           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4953           88  CF-CO-MONTH-END                  VALUE '1'.
  4954
  4955         16  CF-LGX-CLAIM-USER              PIC X.
  4956             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4957             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4958
  4959         16  CF-CREDIT-EDIT-CONTROLS.
  4960             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4961             20  CF-MIN-AGE                 PIC 99.
  4962             20  CF-DEFAULT-AGE             PIC 99.
  4963             20  CF-MIN-TERM                PIC S999      COMP-3.
  4964             20  CF-MAX-TERM                PIC S999      COMP-3.
  4965             20  CF-DEFAULT-SEX             PIC X.
  4966             20  CF-JOINT-AGE-INPUT         PIC X.
  4967                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4968             20  CF-BIRTH-DATE-INPUT        PIC X.
  4969                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4970             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4971                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4972                 88  CF-ZERO-CARRIER            VALUE '1'.
  4973                 88  CF-ZERO-GROUPING           VALUE '2'.
  4974                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4975             20  CF-EDIT-SW                 PIC X.
  4976                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4977             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4978             20  CF-CR-PR-METHOD            PIC X.
  4979               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4980               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4981             20  FILLER                     PIC X.
  4982
  4983         16  CF-CREDIT-MISC-CONTROLS.
  4984             20  CF-REIN-TABLE-SW           PIC X.
  4985                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4986             20  CF-COMP-TABLE-SW           PIC X.
  4987                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4988             20  CF-EXPERIENCE-RETENTION-AGE
  4989                                            PIC S9        COMP-3.
  4990             20  CF-CONVERSION-DT           PIC XX.
  4991             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4992             20  CF-RUN-FREQUENCY-SW        PIC X.
  4993                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4994                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4995
  4996             20  CF-CR-CHECK-NO-CONTROL.
  4997                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  93
* EL050.cbl
  4998                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4999                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5000                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5001                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5002                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5003
  5004                 24  CF-CR-CHECK-COUNT       REDEFINES
  5005                     CF-CR-CHECK-COUNTER      PIC X(4).
  5006
  5007                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5008                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5009
  5010                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5011                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5012                 24  CF-MAIL-PROCESSING       PIC X.
  5013                     88  MAIL-PROCESSING          VALUE 'Y'.
  5014
  5015         16  CF-MISC-SYSTEM-CONTROL.
  5016             20  CF-SYSTEM-C                 PIC X.
  5017                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5018             20  CF-SYSTEM-D                 PIC X.
  5019                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5020             20  CF-SOC-SEC-NO-SW            PIC X.
  5021                 88  SOC-SEC-NO-USED             VALUE '1'.
  5022             20  CF-MEMBER-NO-SW             PIC X.
  5023                 88  MEMBER-NO-USED              VALUE '1'.
  5024             20  CF-TAX-ID-NUMBER            PIC X(11).
  5025             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5026             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5027                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5028                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5029                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5030                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5031             20  CF-SYSTEM-E                 PIC X.
  5032                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5033
  5034         16  CF-LGX-LIFE-USER               PIC X.
  5035             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5036             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5037
  5038         16  CF-CR-MONTH-END-DT             PIC XX.
  5039
  5040         16  CF-FILE-MAINT-DATES.
  5041             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5042                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5043             20  CF-LAST-BATCH       REDEFINES
  5044                 CF-LAST-BATCH-NO               PIC X(4).
  5045             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5046             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5047             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5048             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5049             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5050             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5051             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5052             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5053             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5054             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5055
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  94
* EL050.cbl
  5056         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5057         16  FILLER                         PIC X.
  5058
  5059         16  CF-ALT-MORT-CODE               PIC X(4).
  5060         16  CF-MEMBER-CAPTION              PIC X(10).
  5061
  5062         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5063             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5064             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5065             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5066             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5067             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5068
  5069         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5070
  5071         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5072         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5073         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5074         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5075
  5076         16  CF-AH-OVERRIDE-L1              PIC X.
  5077         16  CF-AH-OVERRIDE-L2              PIC XX.
  5078         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5079         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5080
  5081         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5082         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5083
  5084         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5085         16  CF-AR-LAST-EL860-DT            PIC XX.
  5086         16  CF-MP-MONTH-END-DT             PIC XX.
  5087
  5088         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5089         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5090             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5091
  5092         16  CF-AR-MONTH-END-DT             PIC XX.
  5093
  5094         16  CF-CRDTCRD-USER                PIC X.
  5095             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5096             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5097
  5098         16  CF-CC-MONTH-END-DT             PIC XX.
  5099
  5100         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5101
  5102         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5103             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5104             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5105             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5106         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5107         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5108         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5109         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5110             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5111             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5112         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5113         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  95
* EL050.cbl
  5114         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5115             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5116         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5117
  5118         16  CF-CL-ZIP-CODE.
  5119             20  CF-CL-ZIP-PRIME.
  5120                 24  CF-CL-ZIP-1ST          PIC X.
  5121                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5122                 24  FILLER                 PIC X(4).
  5123             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5124         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5125             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5126             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5127             20  FILLER                     PIC XXX.
  5128
  5129         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5130         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5131         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5132         16  CF-CO-OPTION-START-DATE        PIC XX.
  5133         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5134           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5135                                                      '3' '4'.
  5136           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5137           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5138           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5139           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5140           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5141           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5142
  5143         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5144
  5145         16  CF-PAYMENT-APPROVAL-LEVELS.
  5146             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5147             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5148             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5149             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5150             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5151             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5152
  5153         16  CF-END-USER-REPORTING-USER     PIC X.
  5154             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5155             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5156
  5157         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5158             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5159             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5160
  5161         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5162
  5163         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5164         16  FILLER                         PIC X.
  5165
  5166         16  CF-CREDIT-ARCHIVE-CNTL.
  5167             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5168             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5169             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5170
  5171         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  96
* EL050.cbl
  5172
  5173         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5174             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5175             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5176
  5177         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5178             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5179             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5180
  5181         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5182
  5183         16  CF-CO-ACH-ID-CODE              PIC  X.
  5184             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5185             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5186             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5187         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5188         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5189         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5190         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5191         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5192         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5193         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5194         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5195         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5196                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5197         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5198                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5199
  5200         16  CF-CO-OVER-SHORT.
  5201             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5202             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5203
  5204*         16  FILLER                         PIC X(102).
  5205         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5206             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5207             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5208
  5209         16  CF-AH-APPROVAL-DAYS.
  5210             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5211             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5212             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5213             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5214
  5215         16  FILLER                         PIC X(82).
  5216****************************************************************
  5217*             PROCESSOR/USER RECORD                            *
  5218****************************************************************
  5219
  5220     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5221         16  CF-PROCESSOR-NAME              PIC X(30).
  5222         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5223         16  CF-PROCESSOR-TITLE             PIC X(26).
  5224         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5225                 88  MESSAGE-YES                VALUE 'Y'.
  5226                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5227
  5228*****************************************************
  5229****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  97
* EL050.cbl
  5230****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5231****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5232****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5233*****************************************************
  5234
  5235         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5236             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5237             20  CF-APPLICATION-FORCE       PIC X.
  5238             20  CF-INDIVIDUAL-APP.
  5239                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5240                     28  CF-BROWSE-APP      PIC X.
  5241                     28  CF-UPDATE-APP      PIC X.
  5242
  5243         16  CF-CURRENT-TERM-ON             PIC X(4).
  5244         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5245             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5246             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5247             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5248             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5249             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5250             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5251             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5252         16  CF-PROCESSOR-CARRIER           PIC X.
  5253             88  NO-CARRIER-SECURITY            VALUE ' '.
  5254         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5255             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5256         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5257             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5258         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5259             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5260
  5261         16  CF-PROC-SYS-ACCESS-SW.
  5262             20  CF-PROC-CREDIT-CLAIMS-SW.
  5263                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5264                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5265                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5266                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5267             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5268                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5269                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5270             20  CF-PROC-LIFE-GNRLDGR-SW.
  5271                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5272                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5273                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5274                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5275             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5276                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5277                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5278         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5279             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5280             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5281         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5282
  5283         16  CF-APPROVAL-LEVEL                  PIC X.
  5284             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5285             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5286             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5287             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  98
* EL050.cbl
  5288
  5289         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5290
  5291         16  CF-LANGUAGE-TYPE                   PIC X.
  5292             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5293             88  CF-LANG-IS-FR                      VALUE 'F'.
  5294         16  FILLER                             PIC  X(240).
  5295
  5296****************************************************************
  5297*             PROCESSOR/REMINDERS RECORD                       *
  5298****************************************************************
  5299
  5300     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5301         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5302             20  CF-START-REMIND-DT         PIC XX.
  5303             20  CF-END-REMIND-DT           PIC XX.
  5304             20  CF-REMINDER-TEXT           PIC X(50).
  5305         16  FILLER                         PIC X(296).
  5306
  5307
  5308****************************************************************
  5309*             STATE MASTER RECORD                              *
  5310****************************************************************
  5311
  5312     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5313         16  CF-STATE-ABBREVIATION          PIC XX.
  5314         16  CF-STATE-NAME                  PIC X(25).
  5315         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5316         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5317             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5318             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5319             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5320             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5321                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5322                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5323             20  CF-ST-PREM-REJECT-SW       PIC X.
  5324                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5325                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5326             20  CF-ST-REF-REJECT-SW        PIC X.
  5327                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5328                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5329         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5330         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5331         16  CF-ST-REFUND-RULES.
  5332             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5333             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5334             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5335         16  CF-ST-FST-PMT-EXTENSION.
  5336             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5337             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5338                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5339                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5340                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5341                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5342         16  CF-ST-STATE-CALL.
  5343             20  CF-ST-CALL-UNEARNED        PIC X.
  5344             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5345             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page  99
* EL050.cbl
  5346         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5347             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5348             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5349         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5350         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5351         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5352         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5353         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5354         16  FILLER                         PIC X.
  5355         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5356             20  CF-ST-BENEFIT-CD           PIC XX.
  5357             20  CF-ST-BENEFIT-KIND         PIC X.
  5358                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5359                 88  CF-ST-AH-KIND              VALUE 'A'.
  5360             20  CF-ST-REM-TERM-CALC        PIC X.
  5361                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5362                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5363                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5364                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5365                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5366                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5367                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5368                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5369
  5370             20  CF-ST-REFUND-CALC          PIC X.
  5371                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5372                 88  ST-REFD-BY-R78             VALUE '1'.
  5373                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5374                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5375                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5376                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5377                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5378                 88  ST-REFD-UTAH               VALUE '7'.
  5379                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5380                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5381                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5382
  5383             20  CF-ST-EARNING-CALC         PIC X.
  5384                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5385                 88  ST-EARN-BY-R78             VALUE '1'.
  5386                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5387                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5388                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5389                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5390                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5391                 88  ST-EARN-MEAN               VALUE '8'.
  5392                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5393
  5394             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5395                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5396                 88  ST-OVRD-BY-R78             VALUE '1'.
  5397                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5398                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5399                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5400                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5401                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5402                 88  ST-OVRD-MEAN               VALUE '8'.
  5403                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 100
* EL050.cbl
  5404             20  FILLER                     PIC X.
  5405
  5406         16  CF-ST-COMMISSION-CAPS.
  5407             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5408             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5409             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5410             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5411         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5412                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5413
  5414         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5415
  5416         16  CF-ST-STATUTORY-INTEREST.
  5417             20  CF-ST-STAT-DATE-FROM       PIC X.
  5418                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5419                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5420             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5421             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5422             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5423             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5424             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5425
  5426         16  CF-ST-OVER-SHORT.
  5427             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5428             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5429
  5430         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5431
  5432         16  CF-ST-RT-CALC                  PIC X.
  5433
  5434         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5435         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5436         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5437         16  CF-ST-RF-LR-CALC               PIC X.
  5438         16  CF-ST-RF-LL-CALC               PIC X.
  5439         16  CF-ST-RF-LN-CALC               PIC X.
  5440         16  CF-ST-RF-AH-CALC               PIC X.
  5441         16  CF-ST-RF-CP-CALC               PIC X.
  5442*        16  FILLER                         PIC X(206).
  5443*CIDMOD         16  FILLER                         PIC X(192).
  5444         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5445             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5446         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5447         16  CF-ST-VFY-2ND-BENE             PIC X.
  5448         16  FILLER                         PIC X(186).
  5449
  5450****************************************************************
  5451*             BENEFIT MASTER RECORD                            *
  5452****************************************************************
  5453
  5454     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5455         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5456             20  CF-BENEFIT-CODE            PIC XX.
  5457             20  CF-BENEFIT-NUMERIC  REDEFINES
  5458                 CF-BENEFIT-CODE            PIC XX.
  5459             20  CF-BENEFIT-ALPHA           PIC XXX.
  5460             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5461             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 101
* EL050.cbl
  5462
  5463             20  CF-LF-COVERAGE-TYPE        PIC X.
  5464                 88  CF-REDUCING                VALUE 'R'.
  5465                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5466
  5467             20  CF-SPECIAL-CALC-CD         PIC X.
  5468                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5469                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5470                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5471                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5472                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5473                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5474                 88  CF-FARM-PLAN               VALUE 'F'.
  5475                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5476                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5477                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5478                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5479                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5480                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5481                 88  CF-PRUDENTIAL              VALUE 'P'.
  5482                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5483                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5484                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5485                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5486                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5487                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5488
  5489             20  CF-JOINT-INDICATOR         PIC X.
  5490                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5491
  5492*            20  FILLER                     PIC X(12).
  5493             20  FILLER                     PIC X(11).
  5494             20  CF-BENEFIT-CATEGORY        PIC X.
  5495             20  CF-LOAN-TYPE               PIC X(8).
  5496
  5497             20  CF-CO-REM-TERM-CALC        PIC X.
  5498                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5499                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5500                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5501                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5502                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5503
  5504             20  CF-CO-EARNINGS-CALC        PIC X.
  5505                 88  CO-EARN-BY-R78             VALUE '1'.
  5506                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5507                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5508                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5509                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5510                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5511                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5512                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5513
  5514             20  CF-CO-REFUND-CALC          PIC X.
  5515                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5516                 88  CO-REFD-BY-R78             VALUE '1'.
  5517                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5518                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5519                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 102
* EL050.cbl
  5520                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5521                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5522                 88  CO-REFD-MEAN               VALUE '8'.
  5523                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5524                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5525                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5526
  5527             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5528                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5529                 88  CO-OVRD-BY-R78             VALUE '1'.
  5530                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5531                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5532                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5533                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5534                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5535                 88  CO-OVRD-MEAN               VALUE '8'.
  5536                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5537
  5538             20  CF-CO-BEN-I-G-CD           PIC X.
  5539                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5540                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5541                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5542
  5543         16  FILLER                         PIC X(304).
  5544
  5545
  5546****************************************************************
  5547*             CARRIER MASTER RECORD                            *
  5548****************************************************************
  5549
  5550     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5551         16  CF-ADDRESS-DATA.
  5552             20  CF-MAIL-TO-NAME            PIC X(30).
  5553             20  CF-IN-CARE-OF              PIC X(30).
  5554             20  CF-ADDRESS-LINE-1          PIC X(30).
  5555             20  CF-ADDRESS-LINE-2          PIC X(30).
  5556             20  CF-CITY-STATE              PIC X(30).
  5557             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5558             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5559
  5560         16  CF-CLAIM-NO-CONTROL.
  5561             20  CF-CLAIM-NO-METHOD         PIC X.
  5562                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5563                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5564                 88  CLAIM-NO-SEQ               VALUE '3'.
  5565                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5566             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5567                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5568                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5569                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5570
  5571         16  CF-CHECK-NO-CONTROL.
  5572             20  CF-CHECK-NO-METHOD         PIC X.
  5573                 88  CHECK-NO-MANUAL            VALUE '1'.
  5574                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5575                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5576                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5577             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 103
* EL050.cbl
  5578                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5579
  5580         16  CF-DOMICILE-STATE              PIC XX.
  5581
  5582         16  CF-EXPENSE-CONTROLS.
  5583             20  CF-EXPENSE-METHOD          PIC X.
  5584                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5585                 88  DOLLARS-PER-PMT            VALUE '2'.
  5586                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5587                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5588             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5589             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5590
  5591         16  CF-CORRESPONDENCE-CONTROL.
  5592             20  CF-LETTER-RESEND-OPT       PIC X.
  5593                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5594                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5595             20  FILLER                     PIC X(4).
  5596
  5597         16  CF-RESERVE-CONTROLS.
  5598             20  CF-MANUAL-SW               PIC X.
  5599                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5600             20  CF-FUTURE-SW               PIC X.
  5601                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5602             20  CF-PTC-SW                  PIC X.
  5603                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5604             20  CF-IBNR-SW                 PIC X.
  5605                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5606             20  CF-PTC-LF-SW               PIC X.
  5607                 88  CF-LF-PTC-USED             VALUE '1'.
  5608             20  CF-CDT-ACCESS-METHOD       PIC X.
  5609                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5610                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5611                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5612             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5613
  5614         16  CF-CLAIM-CALC-METHOD           PIC X.
  5615             88  360-PLUS-MONTHS                VALUE '1'.
  5616             88  365-PLUS-MONTHS                VALUE '2'.
  5617             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5618             88  360-DAILY                      VALUE '4'.
  5619             88  365-DAILY                      VALUE '5'.
  5620
  5621         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5622         16  FILLER                         PIC X(11).
  5623
  5624         16  CF-LIMIT-AMOUNTS.
  5625             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5626             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5627             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5628             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5629             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5630             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5631             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5632             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5633             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5634             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5635
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 104
* EL050.cbl
  5636         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5637         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5638         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5639
  5640         16  CF-ZIP-CODE.
  5641             20  CF-ZIP-PRIME.
  5642                 24  CF-ZIP-1ST             PIC X.
  5643                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5644                 24  FILLER                 PIC X(4).
  5645             20  CF-ZIP-PLUS4               PIC X(4).
  5646         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5647             20  CF-CAN-POSTAL-1            PIC XXX.
  5648             20  CF-CAN-POSTAL-2            PIC XXX.
  5649             20  FILLER                     PIC XXX.
  5650
  5651         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5652         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5653         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5654
  5655         16  CF-RATING-SWITCH               PIC X.
  5656             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5657             88  CF-NO-RATING                   VALUE 'N'.
  5658
  5659         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5660
  5661         16  CF-CARRIER-OVER-SHORT.
  5662             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5663             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5664
  5665         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5666         16  CF-SECPAY-SWITCH               PIC X.
  5667             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5668             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5669         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5670         16  FILLER                         PIC X(448).
  5671*        16  FILLER                         PIC X(452).
  5672
  5673
  5674****************************************************************
  5675*             MORTALITY MASTER RECORD                          *
  5676****************************************************************
  5677
  5678     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5679         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5680                                INDEXED BY CF-MORT-NDX.
  5681             20  CF-MORT-TABLE              PIC X(5).
  5682             20  CF-MORT-TABLE-TYPE         PIC X.
  5683                 88  CF-MORT-JOINT              VALUE 'J'.
  5684                 88  CF-MORT-SINGLE             VALUE 'S'.
  5685                 88  CF-MORT-COMBINED           VALUE 'C'.
  5686                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5687                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5688             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5689             20  CF-MORT-AGE-METHOD         PIC XX.
  5690                 88  CF-AGE-LAST                VALUE 'AL'.
  5691                 88  CF-AGE-NEAR                VALUE 'AN'.
  5692             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5693             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 105
* EL050.cbl
  5694                                            PIC X.
  5695                 88  CF-MINUS                   VALUE '-'.
  5696                 88  CF-PLUS                    VALUE '+'.
  5697             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5698             20  CF-MORT-JOINT-CODE         PIC X.
  5699                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5700             20  CF-MORT-PC-Q               PIC X.
  5701                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5702             20  CF-MORT-TABLE-CODE         PIC X(4).
  5703             20  CF-MORT-COMMENTS           PIC X(15).
  5704             20  FILLER                     PIC X(14).
  5705
  5706         16  FILLER                         PIC X(251).
  5707
  5708
  5709****************************************************************
  5710*             BUSSINESS TYPE MASTER RECORD                     *
  5711****************************************************************
  5712
  5713     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5714* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5715* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5716* AND RECORD 05 IS TYPES 81-99
  5717         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5718             20  CF-BUSINESS-TITLE          PIC  X(19).
  5719             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5720                                            PIC S9V9(4) COMP-3.
  5721             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5722             20  FILLER                     PIC  X.
  5723         16  FILLER                         PIC  X(248).
  5724
  5725
  5726****************************************************************
  5727*             TERMINAL MASTER RECORD                           *
  5728****************************************************************
  5729
  5730     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5731
  5732         16  CF-COMPANY-TERMINALS.
  5733             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5734                                  PIC X(4).
  5735         16  FILLER               PIC X(248).
  5736
  5737
  5738****************************************************************
  5739*             LIFE EDIT MASTER RECORD                          *
  5740****************************************************************
  5741
  5742     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5743         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5744             20  CF-LIFE-CODE-IN            PIC XX.
  5745             20  CF-LIFE-CODE-OUT           PIC XX.
  5746         16  FILLER                         PIC X(248).
  5747
  5748
  5749****************************************************************
  5750*             AH EDIT MASTER RECORD                            *
  5751****************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 106
* EL050.cbl
  5752
  5753     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5754         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5755             20  CF-AH-CODE-IN              PIC XXX.
  5756             20  CF-AH-CODE-OUT             PIC XX.
  5757         16  FILLER                         PIC X(248).
  5758
  5759
  5760****************************************************************
  5761*             CREDIBILITY TABLES                               *
  5762****************************************************************
  5763
  5764     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5765         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5766                             INDEXED BY CF-CRDB-NDX.
  5767             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5768             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5769             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5770         16  FILLER                         PIC  X(332).
  5771
  5772
  5773****************************************************************
  5774*             REPORT CUSTOMIZATION RECORD                      *
  5775****************************************************************
  5776
  5777     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5778         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5779             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5780             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5781             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5782**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5783****       A T-TRANSFER.                                   ****
  5784             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5785
  5786         16  FILLER                         PIC XX.
  5787
  5788         16  CF-CARRIER-CNTL-OPT.
  5789             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5790                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5791                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5792             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5793                                            PIC X.
  5794         16  CF-GROUP-CNTL-OPT.
  5795             20  CF-GROUP-OPT-SEQ           PIC 9.
  5796                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5797                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5798             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5799                                            PIC X(6).
  5800         16  CF-STATE-CNTL-OPT.
  5801             20  CF-STATE-OPT-SEQ           PIC 9.
  5802                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5803                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5804             20  CF-STATE-SELECT OCCURS 3 TIMES
  5805                                            PIC XX.
  5806         16  CF-ACCOUNT-CNTL-OPT.
  5807             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5808                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5809                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 107
* EL050.cbl
  5810             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5811                                            PIC X(10).
  5812         16  CF-BUS-TYP-CNTL-OPT.
  5813             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5814                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5815                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5816             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5817                                            PIC XX.
  5818         16  CF-LF-TYP-CNTL-OPT.
  5819             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5820                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5821                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5822             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5823                                            PIC XX.
  5824         16  CF-AH-TYP-CNTL-OPT.
  5825             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5826                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5827                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5828             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5829                                            PIC XX.
  5830         16  CF-REPTCD1-CNTL-OPT.
  5831             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5832                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5833                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5834             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5835                                            PIC X(10).
  5836         16  CF-REPTCD2-CNTL-OPT.
  5837             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5838                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5839                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5840             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5841                                            PIC X(10).
  5842         16  CF-USER1-CNTL-OPT.
  5843             20  CF-USER1-OPT-SEQ           PIC 9.
  5844                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5845                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5846             20  CF-USER1-SELECT OCCURS 3 TIMES
  5847                                            PIC X(10).
  5848         16  CF-USER2-CNTL-OPT.
  5849             20  CF-USER2-OPT-SEQ           PIC 9.
  5850                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5851                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5852             20  CF-USER2-SELECT OCCURS 3 TIMES
  5853                                            PIC X(10).
  5854         16  CF-USER3-CNTL-OPT.
  5855             20  CF-USER3-OPT-SEQ           PIC 9.
  5856                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5857                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5858             20  CF-USER3-SELECT OCCURS 3 TIMES
  5859                                            PIC X(10).
  5860         16  CF-USER4-CNTL-OPT.
  5861             20  CF-USER4-OPT-SEQ           PIC 9.
  5862                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5863                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5864             20  CF-USER4-SELECT OCCURS 3 TIMES
  5865                                            PIC X(10).
  5866         16  CF-USER5-CNTL-OPT.
  5867             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 108
* EL050.cbl
  5868                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5869                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5870             20  CF-USER5-SELECT OCCURS 3 TIMES
  5871                                            PIC X(10).
  5872         16  CF-REINS-CNTL-OPT.
  5873             20  CF-REINS-OPT-SEQ           PIC 9.
  5874                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5875                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5876             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5877                 24  CF-REINS-PRIME         PIC XXX.
  5878                 24  CF-REINS-SUB           PIC XXX.
  5879
  5880         16  CF-AGENT-CNTL-OPT.
  5881             20  CF-AGENT-OPT-SEQ           PIC 9.
  5882                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5883                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5884             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5885                                            PIC X(10).
  5886
  5887         16  FILLER                         PIC X(43).
  5888
  5889         16  CF-LOSS-RATIO-SELECT.
  5890             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5891             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5892         16  CF-ENTRY-DATE-SELECT.
  5893             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5894             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5895         16  CF-EFFECTIVE-DATE-SELECT.
  5896             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5897             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5898
  5899         16  CF-EXCEPTION-LIST-IND          PIC X.
  5900             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5901
  5902         16  FILLER                         PIC X(318).
  5903
  5904****************************************************************
  5905*                  EXCEPTION REPORTING RECORD                  *
  5906****************************************************************
  5907
  5908     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5909         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5910             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5911
  5912         16  CF-COMBINED-LIFE-AH-OPT.
  5913             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5914             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5915             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5916             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5917
  5918         16  CF-LIFE-OPT.
  5919             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5920             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5921             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5922             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5923             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5924             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5925             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 109
* EL050.cbl
  5926             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5927             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5928             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5929
  5930         16  CF-AH-OPT.
  5931             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5932             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5933             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5934             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5935             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5936             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5937             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5938             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5939             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5940             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5941
  5942         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5943             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5944             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5945             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5946
  5947         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5948
  5949         16  FILLER                         PIC X(673).
  5950
  5951
  5952****************************************************************
  5953*             MORTGAGE SYSTEM PLAN RECORD                      *
  5954****************************************************************
  5955
  5956     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5957         16  CF-PLAN-TYPE                   PIC X.
  5958             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5959             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5960             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5961         16  CF-PLAN-ABBREV                 PIC XXX.
  5962         16  CF-PLAN-DESCRIPT               PIC X(10).
  5963         16  CF-PLAN-NOTES                  PIC X(20).
  5964         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5965         16  CF-PLAN-UNDERWRITING.
  5966             20  CF-PLAN-TERM-DATA.
  5967                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5968                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5969             20  CF-PLAN-AGE-DATA.
  5970                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5971                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5972                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5973             20  CF-PLAN-BENEFIT-DATA.
  5974                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5975                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5976                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5977                                            PIC S9(7)V99  COMP-3.
  5978         16  CF-PLAN-POLICY-FORMS.
  5979             20  CF-POLICY-FORM             PIC X(12).
  5980             20  CF-MASTER-APPLICATION      PIC X(12).
  5981             20  CF-MASTER-POLICY           PIC X(12).
  5982         16  CF-PLAN-RATING.
  5983             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 110
* EL050.cbl
  5984             20  CF-SEX-RATING              PIC X.
  5985                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5986                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5987             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5988             20  CF-SUB-STD-TYPE            PIC X.
  5989                 88  CF-PCT-OF-PREM            VALUE '1'.
  5990                 88  CF-PCT-OF-BENE            VALUE '2'.
  5991         16  CF-PLAN-PREM-TOLERANCES.
  5992             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5993             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5994         16  CF-PLAN-PYMT-TOLERANCES.
  5995             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5996             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5997         16  CF-PLAN-MISC-DATA.
  5998             20  FILLER                     PIC X.
  5999             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6000             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6001         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6002         16  CF-PLAN-IND-GRP                PIC X.
  6003             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6004                                                     '1'.
  6005             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6006                                                     '2'.
  6007         16  CF-MIB-SEARCH-SW               PIC X.
  6008             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6009             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6010             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6011             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6012         16  CF-ALPHA-SEARCH-SW             PIC X.
  6013             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6014             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6015             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6016             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6017             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6018             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6019             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6020             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6021             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6022             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6023                                                     'A' 'B' 'C'
  6024                                                     'X' 'Y' 'Z'.
  6025         16  CF-EFF-DT-RULE-SW              PIC X.
  6026             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6027             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6028             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6029             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6030             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6031         16  FILLER                         PIC X(4).
  6032         16  CF-HEALTH-QUESTIONS            PIC X.
  6033             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6034         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6035         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6036         16  CF-PLAN-SNGL-JNT               PIC X.
  6037             88  CF-COMBINED-PLAN              VALUE 'C'.
  6038             88  CF-JNT-PLAN                   VALUE 'J'.
  6039             88  CF-SNGL-PLAN                  VALUE 'S'.
  6040         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6041         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 111
* EL050.cbl
  6042         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6043         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6044         16  CF-RERATE-CNTL                 PIC  X.
  6045             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6046             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6047             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6048             88  CF-AUTO-RECALC                 VALUE '4'.
  6049         16  CF-BENEFIT-TYPE                PIC  X.
  6050             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6051             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6052         16  CF-POLICY-FEE                  PIC S999V99
  6053                                                    COMP-3.
  6054         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6055         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6056         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6057         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6058         16  FILLER                         PIC  X(32).
  6059         16  CF-TERMINATION-FORM            PIC  X(04).
  6060         16  FILLER                         PIC  X(08).
  6061         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6062                                                       COMP-3.
  6063         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6064         16  CF-ISSUE-LETTER                PIC  X(4).
  6065         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6066         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6067             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6068             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6069         16  CF-MP-REFUND-CALC              PIC X.
  6070             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6071             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6072             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6073             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6074             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6075             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6076             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6077             88  CF-MP-REFD-MEAN                VALUE '8'.
  6078         16  CF-ALT-RATE-CODE               PIC  X(5).
  6079
  6080
  6081         16  FILLER                         PIC X(498).
  6082****************************************************************
  6083*             MORTGAGE COMPANY MASTER RECORD                   *
  6084****************************************************************
  6085
  6086     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6087         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6088         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6089             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6090             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6091             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6092             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6093             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6094
  6095         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6096         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6097         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6098         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6099         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 112
* EL050.cbl
  6100
  6101         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6102             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6103         16  CF-MP-RECON-USE-IND            PIC X(1).
  6104             88  CF-MP-USE-RECON             VALUE 'Y'.
  6105         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6106             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6107         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6108             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6109             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6110         16  FILLER                         PIC X(1).
  6111         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6112             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6113         16  CF-MORTG-MIB-VERSION           PIC X.
  6114             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6115             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6116             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6117         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6118             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6119                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6120             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6121                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6122             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6123                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6124             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6125                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6126             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6127                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6128             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6129                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6130         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6131         16  FILLER                         PIC X(7).
  6132         16  CF-MORTG-DESTINATION-SYMBOL.
  6133             20  CF-MORTG-MIB-COMM          PIC X(5).
  6134             20  CF-MORTG-MIB-TERM          PIC X(5).
  6135         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6136             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6137         16  FILLER                         PIC X(03).
  6138         16  CF-MP-CHECK-NO-CONTROL.
  6139             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6140                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6141                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6142                                                ' ' LOW-VALUES.
  6143                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6144                                               VALUE '3'.
  6145         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6146         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6147         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6148             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6149                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6150             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6151                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6152             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6153                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6154             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6155                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6156             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6157                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 113
* EL050.cbl
  6158             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6159                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6160         16  CF-MORTG-BILLING-AREA.
  6161             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6162                                            PIC X.
  6163         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6164         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6165         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6166         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6167             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6168             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6169         16  FILLER                         PIC X.
  6170         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6171             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6172             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6173         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6174         16  FILLER                         PIC X(8).
  6175         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6176         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6177         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6178         16  CF-ACH-COMPANY-ID.
  6179             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6180                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6181                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6182                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6183             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6184         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6185             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6186         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6187             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6188             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6189         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6190         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6191         16  FILLER                         PIC X(536).
  6192
  6193****************************************************************
  6194*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6195****************************************************************
  6196
  6197     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6198         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6199             20  CF-FEMALE-HEIGHT.
  6200                 24  CF-FEMALE-FT           PIC 99.
  6201                 24  CF-FEMALE-IN           PIC 99.
  6202             20  CF-FEMALE-MIN-WT           PIC 999.
  6203             20  CF-FEMALE-MAX-WT           PIC 999.
  6204         16  FILLER                         PIC X(428).
  6205
  6206     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6207         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6208             20  CF-MALE-HEIGHT.
  6209                 24  CF-MALE-FT             PIC 99.
  6210                 24  CF-MALE-IN             PIC 99.
  6211             20  CF-MALE-MIN-WT             PIC 999.
  6212             20  CF-MALE-MAX-WT             PIC 999.
  6213         16  FILLER                         PIC X(428).
  6214******************************************************************
  6215*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 114
* EL050.cbl
  6216******************************************************************
  6217     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6218         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6219             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6220             20  CF-SYS-LETTER-ID           PIC X(04).
  6221             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6222             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6223             20  CF-SYS-RESET-SW            PIC X(01).
  6224             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6225             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6226
  6227         16  FILLER                         PIC X(50).
  6228
  6229         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6230             20  CF-USER-ACTIVE-SW          PIC X(01).
  6231             20  CF-USER-LETTER-ID          PIC X(04).
  6232             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6233             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6234             20  CF-USER-RESET-SW           PIC X(01).
  6235             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6236             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6237             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6238
  6239         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 115
* EL050.cbl
  6241*    COPY ERCACCT.
  6242******************************************************************
  6243*                                                                *
  6244*                                                                *
  6245*                            ERCACCT                             *
  6246*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6247*                            VMOD=2.031                          *
  6248*                                                                *
  6249*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6250*                                                                *
  6251*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6252*   VSAM ACCOUNT MASTER FILES.                                   *
  6253*                                                                *
  6254*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6255*                                                                *
  6256*   FILE TYPE = VSAM,KSDS                                        *
  6257*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6258*                                                                *
  6259*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6260*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6261*                                                                *
  6262*   LOG = NO                                                     *
  6263*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6264*                                                                *
  6265*                                                                *
  6266******************************************************************
  6267*                   C H A N G E   L O G
  6268*
  6269* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6270*-----------------------------------------------------------------
  6271*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6272* EFFECTIVE    NUMBER
  6273*-----------------------------------------------------------------
  6274* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6275* 092705    2005050300006  PEMA  ADD SPP LEASES
  6276* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6277* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6278* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6279* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6280* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6281******************************************************************
  6282
  6283 01  ACCOUNT-MASTER.
  6284     12  AM-RECORD-ID                      PIC XX.
  6285         88  VALID-AM-ID                      VALUE 'AM'.
  6286
  6287     12  AM-CONTROL-PRIMARY.
  6288         16  AM-COMPANY-CD                 PIC X.
  6289         16  AM-MSTR-CNTRL.
  6290             20  AM-CONTROL-A.
  6291                 24  AM-CARRIER            PIC X.
  6292                 24  AM-GROUPING.
  6293                     28 AM-GROUPING-PREFIX PIC XXX.
  6294                     28 AM-GROUPING-PRIME  PIC XXX.
  6295                 24  AM-STATE              PIC XX.
  6296                 24  AM-ACCOUNT.
  6297                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6298                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 116
* EL050.cbl
  6299             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6300                                           PIC X(19).
  6301             20  AM-CNTRL-B.
  6302                 24  AM-EXPIRATION-DT      PIC XX.
  6303                 24  FILLER                PIC X(4).
  6304             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6305                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6306
  6307     12  AM-CONTROL-BY-VAR-GRP.
  6308         16  AM-COMPANY-CD-A1              PIC X.
  6309         16  AM-VG-CARRIER                 PIC X.
  6310         16  AM-VG-GROUPING                PIC X(6).
  6311         16  AM-VG-STATE                   PIC XX.
  6312         16  AM-VG-ACCOUNT                 PIC X(10).
  6313         16  AM-VG-DATE.
  6314             20  AM-VG-EXPIRATION-DT       PIC XX.
  6315             20  FILLER                    PIC X(4).
  6316         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6317                                           PIC 9(11)      COMP-3.
  6318     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6319         16  FILLER                        PIC X(10).
  6320         16  AM-VG-KEY3.
  6321             20  AM-VG3-ACCOUNT            PIC X(10).
  6322             20  AM-VG3-EXP-DT             PIC XX.
  6323         16  FILLER                        PIC X(4).
  6324     12  AM-MAINT-INFORMATION.
  6325         16  AM-LAST-MAINT-DT              PIC XX.
  6326         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6327         16  AM-LAST-MAINT-USER            PIC X(4).
  6328         16  FILLER                        PIC XX.
  6329
  6330     12  AM-EFFECTIVE-DT                   PIC XX.
  6331     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6332
  6333     12  AM-PREV-DATES  COMP-3.
  6334         16  AM-PREV-EXP-DT                PIC 9(11).
  6335         16  AM-PREV-EFF-DT                PIC 9(11).
  6336
  6337     12  AM-REPORT-CODE-1                  PIC X(10).
  6338     12  AM-REPORT-CODE-2                  PIC X(10).
  6339
  6340     12  AM-CITY-CODE                      PIC X(4).
  6341     12  AM-COUNTY-PARISH                  PIC X(6).
  6342
  6343     12  AM-NAME                           PIC X(30).
  6344     12  AM-PERSON                         PIC X(30).
  6345     12  AM-ADDRS                          PIC X(30).
  6346     12  AM-CITY.
  6347         16  AM-ADDR-CITY                  PIC X(28).
  6348         16  AM-ADDR-STATE                 PIC XX.
  6349     12  AM-ZIP.
  6350         16  AM-ZIP-PRIME.
  6351             20  AM-ZIP-PRI-1ST            PIC X.
  6352                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6353             20  FILLER                    PIC X(4).
  6354         16  AM-ZIP-PLUS4                  PIC X(4).
  6355     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6356         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 117
* EL050.cbl
  6357         16  AM-CAN-POSTAL-2               PIC XXX.
  6358         16  FILLER                        PIC XXX.
  6359     12  AM-TEL-NO.
  6360         16  AM-AREA-CODE                  PIC 999.
  6361         16  AM-TEL-PRE                    PIC 999.
  6362         16  AM-TEL-NBR                    PIC 9(4).
  6363     12  AM-TEL-LOC                        PIC X.
  6364         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6365         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6366
  6367     12  AM-COMM-STRUCTURE.
  6368         16  AM-DEFN-1.
  6369             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6370                 24  AM-AGT.
  6371                     28  AM-AGT-PREFIX     PIC X(4).
  6372                     28  AM-AGT-PRIME      PIC X(6).
  6373                 24  AM-COM-TYP            PIC X.
  6374                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6375                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6376                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6377                 24  AM-RECALC-LV-INDIC    PIC X.
  6378                 24  AM-RETRO-LV-INDIC     PIC X.
  6379                 24  AM-GL-CODES           PIC X.
  6380                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6381                 24  FILLER                PIC X(01).
  6382         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6383             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6384                 24  FILLER                PIC X(11).
  6385                 24  AM-L-COMA             PIC XXX.
  6386                 24  AM-J-COMA             PIC XXX.
  6387                 24  AM-A-COMA             PIC XXX.
  6388                 24  FILLER                PIC X(6).
  6389
  6390     12  AM-COMM-CHANGE-STATUS             PIC X.
  6391         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6392
  6393     12  AM-CSR-CODE                       PIC X(4).
  6394
  6395     12  AM-BILLING-STATUS                 PIC X.
  6396         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6397         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6398     12  AM-AUTO-REFUND-SW                 PIC X.
  6399         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6400         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6401     12  AM-GPCD                           PIC 99.
  6402     12  AM-IG                             PIC X.
  6403         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6404         88  AM-HAS-GROUP                     VALUE '2'.
  6405     12  AM-STATUS                         PIC X.
  6406         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6407         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6408         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6409         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6410         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6411         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6412     12  AM-REMIT-TO                       PIC 99.
  6413     12  AM-ID-NO                          PIC X(11).
  6414
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 118
* EL050.cbl
  6415     12  AM-CAL-TABLE                      PIC XX.
  6416     12  AM-LF-DEVIATION                   PIC XXX.
  6417     12  AM-AH-DEVIATION                   PIC XXX.
  6418     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6419     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6420     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6421     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6422     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6423     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6424
  6425     12  AM-USER-FIELDS.
  6426         16  AM-FLD-1                      PIC XX.
  6427         16  AM-FLD-2                      PIC XX.
  6428         16  AM-FLD-3                      PIC XX.
  6429         16  AM-FLD-4                      PIC XX.
  6430         16  AM-FLD-5                      PIC XX.
  6431
  6432     12  AM-1ST-PROD-DATE.
  6433         16  AM-1ST-PROD-YR                PIC XX.
  6434         16  AM-1ST-PROD-MO                PIC XX.
  6435         16  AM-1ST-PROD-DA                PIC XX.
  6436     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6437     12  AM-CERTS-PURGED-DATE.
  6438         16  AM-PUR-YR                     PIC XX.
  6439         16  AM-PUR-MO                     PIC XX.
  6440         16  AM-PUR-DA                     PIC XX.
  6441     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6442     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6443     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6444     12  AM-INACTIVE-DATE.
  6445         16  AM-INA-MO                     PIC 99.
  6446         16  AM-INA-DA                     PIC 99.
  6447         16  AM-INA-YR                     PIC 99.
  6448     12  AM-AR-HI-CERT-DATE                PIC XX.
  6449
  6450     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6451     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6452
  6453     12  AM-OB-PAYMENT-MODE                PIC X.
  6454         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6455         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6456         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6457         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6458
  6459     12  AM-AH-ONLY-INDICATOR              PIC X.
  6460         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6461         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6462
  6463     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6464
  6465     12  AM-OVER-SHORT.
  6466         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6467         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6468
  6469     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6470     12  AM-DCC-CLP-STATE                  PIC XX.
  6471
  6472     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 119
* EL050.cbl
  6473     12  AM-RECALC-REIN                    PIC X.
  6474
  6475     12  AM-REI-TABLE                      PIC XXX.
  6476     12  AM-REI-ET-LF                      PIC X.
  6477     12  AM-REI-ET-AH                      PIC X.
  6478     12  AM-REI-PE-LF                      PIC X.
  6479     12  AM-REI-PE-AH                      PIC X.
  6480     12  AM-REI-PRT-ST                     PIC X.
  6481     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6482     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6483     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6484     12  AM-REI-GROUP-A                    PIC X(6).
  6485     12  AM-REI-MORT                       PIC X(4).
  6486     12  AM-REI-PRT-OW                     PIC X.
  6487     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6488     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6489     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6490     12  AM-REI-GROUP-B                    PIC X(6).
  6491
  6492     12  AM-TRUST-TYPE                     PIC X(2).
  6493
  6494     12  AM-EMPLOYER-STMT-USED             PIC X.
  6495     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6496
  6497     12  AM-STD-AH-TYPE                    PIC XX.
  6498     12  AM-EARN-METHODS.
  6499         16  AM-EARN-METHOD-R              PIC X.
  6500             88 AM-REF-RL-R78                 VALUE 'R'.
  6501             88 AM-REF-RL-PR                  VALUE 'P'.
  6502             88 AM-REF-RL-MEAN                VALUE 'M'.
  6503             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6504         16  AM-EARN-METHOD-L              PIC X.
  6505             88 AM-REF-LL-R78                 VALUE 'R'.
  6506             88 AM-REF-LL-PR                  VALUE 'P'.
  6507             88 AM-REF-LL-MEAN                VALUE 'M'.
  6508             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6509         16  AM-EARN-METHOD-A              PIC X.
  6510             88 AM-REF-AH-R78                 VALUE 'R'.
  6511             88 AM-REF-AH-PR                  VALUE 'P'.
  6512             88 AM-REF-AH-MEAN                VALUE 'M'.
  6513             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6514             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6515             88 AM-REF-AH-NET                 VALUE 'N'.
  6516
  6517     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6518     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6519     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6520
  6521     12  AM-RET-Y-N                        PIC X.
  6522     12  AM-RET-P-E                        PIC X.
  6523     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6524     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6525     12  AM-RET-GRP                        PIC X(6).
  6526     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6527         16  AM-POOL-PRIME                 PIC XXX.
  6528         16  AM-POOL-SUB                   PIC XXX.
  6529     12  AM-RETRO-EARNINGS.
  6530         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 120
* EL050.cbl
  6531         16  AM-RET-EARN-L                 PIC X.
  6532         16  AM-RET-EARN-A                 PIC X.
  6533     12  AM-RET-ST-TAX-USE                 PIC X.
  6534         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6535         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6536     12  AM-RETRO-BEG-EARNINGS.
  6537         16  AM-RET-BEG-EARN-R             PIC X.
  6538         16  AM-RET-BEG-EARN-L             PIC X.
  6539         16  AM-RET-BEG-EARN-A             PIC X.
  6540     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6541     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6542
  6543     12  AM-USER-SELECT-OPTIONS.
  6544         16  AM-USER-SELECT-1              PIC X(10).
  6545         16  AM-USER-SELECT-2              PIC X(10).
  6546         16  AM-USER-SELECT-3              PIC X(10).
  6547         16  AM-USER-SELECT-4              PIC X(10).
  6548         16  AM-USER-SELECT-5              PIC X(10).
  6549
  6550     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6551
  6552     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6553
  6554     12  AM-RPT045A-SWITCH                 PIC X.
  6555         88  RPT045A-OFF                   VALUE 'N'.
  6556
  6557     12  AM-INSURANCE-LIMITS.
  6558         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6559         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6560
  6561     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6562         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6563
  6564     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6565         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6566         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6567
  6568     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6569
  6570     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6571     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6572     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6573     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6574     12  AM-DCC-UEF-STATE                  PIC XX.
  6575     12  FILLER                            PIC XXX.
  6576     12  AM-REPORT-CODE-3                  PIC X(10).
  6577*    12  FILLER                            PIC X(22).
  6578
  6579     12  AM-RESERVE-DATE.
  6580         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6581         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6582         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6583
  6584     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6585     12  AM-NOTIFICATION-TYPES.
  6586         16  AM-NOTIF-OF-LETTERS           PIC X.
  6587         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6588         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 121
* EL050.cbl
  6589         16  AM-NOTIF-OF-STATUS            PIC X.
  6590
  6591     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6592         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6593         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6594         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6595         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6596
  6597     12  AM-BENEFIT-CONTROLS.
  6598         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6599             20  AM-BENEFIT-CODE           PIC XX.
  6600             20  AM-BENEFIT-TYPE           PIC X.
  6601             20  AM-BENEFIT-REVISION       PIC XXX.
  6602             20  AM-BENEFIT-REM-TERM       PIC X.
  6603             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6604             20  FILLER                    PIC XX.
  6605         16  FILLER                        PIC X(80).
  6606
  6607     12  AM-TRANSFER-DATA.
  6608         16  AM-TRANSFERRED-FROM.
  6609             20  AM-TRNFROM-CARRIER        PIC X.
  6610             20  AM-TRNFROM-GROUPING.
  6611                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6612                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6613             20  AM-TRNFROM-STATE          PIC XX.
  6614             20  AM-TRNFROM-ACCOUNT.
  6615                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6616                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6617             20  AM-TRNFROM-DTE            PIC XX.
  6618         16  AM-TRANSFERRED-TO.
  6619             20  AM-TRNTO-CARRIER          PIC X.
  6620             20  AM-TRNTO-GROUPING.
  6621                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6622                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6623             20  AM-TRNTO-STATE            PIC XX.
  6624             20  AM-TRNTO-ACCOUNT.
  6625                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6626                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6627             20  AM-TRNTO-DTE              PIC XX.
  6628         16  FILLER                        PIC X(10).
  6629
  6630     12  AM-SAVED-REMIT-TO                 PIC 99.
  6631
  6632     12  AM-COMM-STRUCTURE-SAVED.
  6633         16  AM-DEFN-1-SAVED.
  6634             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6635                 24  AM-AGT-SV             PIC X(10).
  6636                 24  AM-COM-TYP-SV         PIC X.
  6637                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6638                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6639                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6640                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6641                 24  FILLER                PIC X.
  6642                 24  AM-GL-CODES-SV        PIC X.
  6643                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6644                 24  FILLER                PIC X.
  6645         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6646             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 122
* EL050.cbl
  6647                 24  FILLER                PIC X(11).
  6648                 24  AM-L-COMA-SV          PIC XXX.
  6649                 24  AM-J-COMA-SV          PIC XXX.
  6650                 24  AM-A-COMA-SV          PIC XXX.
  6651                 24  FILLER                PIC X(6).
  6652
  6653     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6654         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6655            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6656            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6657            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6658
  6659     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6660     12  FILLER                            PIC X(120).
  6661
  6662     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6663         16  AM-CONTROL-NAME               PIC X(30).
  6664         16  AM-EXECUTIVE-ONE.
  6665             20  AM-EXEC1-NAME             PIC X(15).
  6666             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6667                                                          COMP-3.
  6668             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6669                                                          COMP-3.
  6670         16  AM-EXECUTIVE-TWO.
  6671             20  AM-EXEC2-NAME             PIC X(15).
  6672             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6673                                                          COMP-3.
  6674             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6675                                                          COMP-3.
  6676
  6677     12  AM-RETRO-ADDITIONAL-DATA.
  6678         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6679         16  AM-RETRO-PREM-P-E             PIC X.
  6680         16  AM-RETRO-CLMS-P-I             PIC X.
  6681         16  AM-RETRO-RET-BRACKET-LF.
  6682             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6683                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6684                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6685             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6686                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6687                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6688             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6689                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6690                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6691         16  AM-RETRO-RET-BRACKET-AH.
  6692             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6693                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6694                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6695                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6696             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6697                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6698                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6699             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6700                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6701                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6702
  6703     12  AM-COMMENTS.
  6704         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 123
* EL050.cbl
  6705
  6706     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6707         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6708         16  AM-FLI-BILLING-CODE           PIC X.
  6709         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6710         16  AM-FLI-UNITED-IDENT           PIC X.
  6711         16  AM-FLI-INTEREST-LOST-DATA.
  6712             20  AM-FLI-BANK-NO            PIC X(5).
  6713             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6714             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6715             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6716         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6717             20  AM-FLI-AGT                PIC X(9).
  6718             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6719             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6720         16  FILLER                        PIC X(102).
  6721
  6722     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6723         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6724             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6725             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6726             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6727             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6728             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6729         16  FILLER                          PIC X(10).
  6730******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 124
* EL050.cbl
  6732*    COPY ERCREIN.
  6733******************************************************************
  6734*                                                                *
  6735*                            ERCREIN                             *
  6736*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6737*                            VMOD=2.010                          *
  6738*                                                                *
  6739*   ONLINE CREDIT SYSTEM                                         *
  6740*                                                                *
  6741*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6742*                                                                *
  6743*   FILE TYPE = VSAM,KSDS                                        *
  6744*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6745*                                                                *
  6746*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6747*       ALTERNATE PATH = NONE                                    *
  6748*                                                                *
  6749*   LOG = NO                                                     *
  6750*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6751*                                                                *
  6752******************************************************************
  6753*                   C H A N G E   L O G
  6754*
  6755* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6756*-----------------------------------------------------------------
  6757*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6758* EFFECTIVE    NUMBER
  6759*-----------------------------------------------------------------
  6760* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6761* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6762******************************************************************
  6763 01  REINSURANCE-RECORD.
  6764     12  RE-RECORD-ID                      PIC XX.
  6765         88  VALID-RE-ID                      VALUE 'RE'.
  6766
  6767     12  RE-CONTROL-PRIMARY.
  6768         16  RE-COMPANY-CD                 PIC X.
  6769         16  RE-KEY.
  6770             20  RE-CODE                   PIC X.
  6771                 88  RE-TABLE-RECORD          VALUE 'A'.
  6772                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6773             20  RE-TABLE                  PIC XXX.
  6774             20  FILLER                    PIC XXX.
  6775         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6776             20  FILLER                    PIC X.
  6777             20  RE-COMPANY.
  6778                 24  RE-COMP-PRIME         PIC XXX.
  6779                 24  RE-COMP-SUB           PIC XXX.
  6780
  6781     12  RE-MAINT-INFORMATION.
  6782         16  RE-LAST-MAINT-DT              PIC XX.
  6783         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6784         16  RE-LAST-MAINT-USER            PIC X(4).
  6785         16  FILLER                        PIC X(10).
  6786
  6787     12  RE-TABLE-DATA.
  6788         16  RE-100-COMP                   PIC 99.
  6789
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 125
* EL050.cbl
  6790         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6791             20  RE-REI-COMP-NO.
  6792                 24  RE-REI-COMP           PIC XXX.
  6793                 24  RE-REI-COMP-SUB       PIC XXX.
  6794             20  RE-LF-QC                  PIC X.
  6795             20  RE-AH-QC                  PIC X.
  6796             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6797             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6798             20  RE-LFAGE-LO               PIC 99.
  6799             20  RE-LFAGE-HI               PIC 99.
  6800             20  RE-AHAGE-LO               PIC 99.
  6801             20  RE-AHAGE-HI               PIC 99.
  6802             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6803             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6804             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6805             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6806             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6807             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6808             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6809             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6810             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6811             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6812             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6813             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6814             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6815             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6816             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6817             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6818             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6819             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6820             20  RE-LF-BEN-CODE            PIC X.
  6821             20  RE-AH-BEN-CODE            PIC X.
  6822             20  RE-INTERACTIVE            PIC X.
  6823             20  RE-REMAINING              PIC X.
  6824             20  RE-LF-RUNOFF-SW           PIC X.
  6825             20  RE-AH-RUNOFF-SW           PIC X.
  6826             20  FILLER                    PIC X(19).
  6827
  6828         16  RE-COMP-INFO-END              PIC X(6).
  6829         16  RE-NSP-ST-CD-LF               PIC XX.
  6830         16  RE-NSP-ST-CD-AH               PIC XX.
  6831         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6832             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6833
  6834         16  FILLER                        PIC X(27).
  6835
  6836     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6837         16  RE-NAME                       PIC X(30).
  6838         16  RE-LF-PE                      PIC X.
  6839         16  RE-AH-PE                      PIC X.
  6840         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6841         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6842         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6843         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6844         16  RE-PRT-ST                     PIC X.
  6845         16  RE-PRT-OW                     PIC X.
  6846         16  RE-MORT-CODE                  PIC X(4).
  6847         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 126
* EL050.cbl
  6848         16  RE-ZERO-LF-FEE                PIC X.
  6849         16  RE-ZERO-AH-FEE                PIC X.
  6850         16  RE-CEDE-NAME                  PIC X(30).
  6851         16  RE-LF-COMM                    PIC X.
  6852         16  RE-AH-COMM                    PIC X.
  6853         16  RE-LF-TAX                     PIC X.
  6854         16  RE-AH-TAX                     PIC X.
  6855         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6856         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6857         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6858
  6859         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6860             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6861
  6862         16  RE-LF-CEDING-FEE-BRACKETS.
  6863             20  RE-LF-FEE-METHOD          PIC X.
  6864                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6865                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6866                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6867                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6868             20  RE-LF-FEE-BASIS           PIC X.
  6869                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6870                 88  RE-LF-NET-CEDED               VALUE '2'.
  6871                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6872                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6873                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6874                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6875                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6876                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6877             20  FILLER                    PIC XXX.
  6878             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6879                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6880                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6881
  6882         16  RE-AH-CEDING-FEE-BRACKETS.
  6883             20  RE-AH-FEE-METHOD          PIC X.
  6884                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6885                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6886                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6887                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6888             20  RE-AH-FEE-BASIS           PIC X.
  6889                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6890                 88  RE-AH-NET-CEDED               VALUE '2'.
  6891                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6892                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6893                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6894                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6895                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6896                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6897             20  FILLER                    PIC XXX.
  6898             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6899                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6900                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6901
  6902         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6903
  6904         16  RE-OLD-CEDING-STMT            PIC X.
  6905
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 127
* EL050.cbl
  6906         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6907         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6908         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6909         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6910         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6911         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6912         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6913         16  RE-MORT-SW                    PIC X.
  6914         16  RE-CEDING-TYPE-FLAG           PIC X.
  6915             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6916             88  RE-CEDED                          VALUE 'C'.
  6917             88  RE-ASSUMED                        VALUE 'A'.
  6918             88  RE-PHANTOM                        VALUE 'P'.
  6919
  6920         16  RE-CEDING-STMT-OPT-A          PIC X.
  6921             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6922         16  RE-CEDING-STMT-OPT-B          PIC X.
  6923             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6924         16  RE-CEDING-STMT-OPT-C          PIC X.
  6925             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6926         16  RE-CEDING-STMT-OPT-D          PIC X.
  6927             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6928         16  RE-CEDING-STMT-OPT-E          PIC X.
  6929             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6930
  6931         16  RE-PRT-CRSV                   PIC X.
  6932
  6933         16  RE-GL-CENTER                  PIC X(4).
  6934
  6935         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6936
  6937         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6938
  6939         16  RE-EARN-STOP-CODE             PIC X.
  6940             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6941             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6942
  6943         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6944             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6945
  6946         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6947         16  FILLER                        PIC X(2281).
  6948
  6949         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6950
  6951******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 128
* EL050.cbl
  6953*    COPY ERCCTBL.
  6954******************************************************************
  6955*                                                                *
  6956*                                                                *
  6957*                            ERCCTBL                             *
  6958*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6959*                            VMOD=2.003
  6960*                                                                *
  6961*   ONLINE CREDIT SYSTEM                                         *
  6962*                                                                *
  6963*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6964*                                                                *
  6965*   FILE TYPE = VSAM,KSDS                                        *
  6966*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6967*                                                                *
  6968*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6969*       ALTERNATE PATH = NONE                                    *
  6970*                                                                *
  6971*   LOG = NO                                                     *
  6972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6973*                                                                *
  6974*                                                                *
  6975******************************************************************
  6976
  6977 01  COMM-TABLE-RECORD.
  6978     12  CT-RECORD-ID                      PIC XX.
  6979         88  VALID-CT-ID                      VALUE 'CT'.
  6980
  6981     12  CT-CONTROL-PRIMARY.
  6982         16  CT-COMPANY-CD                 PIC X.
  6983         16  CT-TABLE                      PIC XXX.
  6984         16  CT-CNTRL-2.
  6985             20  CT-BEN-TYPE               PIC X.
  6986             20  CT-BEN-CODE               PIC XX.
  6987
  6988     12  CT-MAINT-INFORMATION.
  6989         16  CT-LAST-MAINT-DT              PIC XX.
  6990         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6991         16  CT-LAST-MAINT-USER            PIC X(4).
  6992         16  FILLER                        PIC X(31).
  6993
  6994     12  CT-LIMITS.
  6995         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  6996
  6997         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  6998
  6999         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7000
  7001     12  CT-RATES.
  7002         16  CT-RTX          OCCURS 27 TIMES.
  7003             20  CT-RT                     PIC SV9(5)     COMP-3.
  7004             20  CT-RT-R   REDEFINES
  7005                 CT-RT                     PIC XXX.
  7006
  7007     12  FILLER                            PIC  X(42).
  7008
  7009******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 129
* EL050.cbl
  7011*    COPY ERCFORM.
  7012******************************************************************
  7013*                                                                *
  7014*                                                                *
  7015*                            ERCFORM.                            *
  7016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7017*                            VMOD=2.003                          *
  7018*                                                                *
  7019*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7020*                                                                *
  7021*    FILE TYPE = VSAM,KSDS                                       *
  7022*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7023*                                                                *
  7024*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7025*                                                                *
  7026*    LOG = YES                                                   *
  7027*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7028******************************************************************
  7029 01  FORM-MASTER.
  7030    12  FO-RECORD-ID                 PIC X(02).
  7031        88  VALID-FO-ID                  VALUE 'FO'.
  7032
  7033    12  FO-CONTROL-PRIMARY.
  7034        16  FO-COMPANY-CD            PIC X(01).
  7035        16  FO-STATE                 PIC X(02).
  7036        16  FO-FORM-ID               PIC X(12).
  7037        16  FO-FORM-EXP-DT           PIC X(02).
  7038
  7039    12  FO-POLICY-FORM-DATA.
  7040        16  FO-IND-GRP-CD            PIC X(01).
  7041        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7042        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7043        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7044        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7045        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7046        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7047        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7048        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7049        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7050        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7051        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7052        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7053        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7054        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7055        16  FO-APP-CERT-USE-CD       PIC X(01).
  7056
  7057    12  FILLER                       PIC X(29).
  7058
  7059    12  FO-FORM-PLAN-TABLE.
  7060        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7061            20  FO-PLAN-TYPE         PIC X(01).
  7062            20  FO-PLAN-ID           PIC X(02).
  7063            20  FO-PLAN-TERM         PIC 9(03).
  7064            20  FO-PLAN-REFUND-METHOD
  7065                                     PIC X.
  7066
  7067    12  FILLER                       PIC X(30).
  7068
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 130
* EL050.cbl
  7069    12  FO-COMMENTS-AREA.
  7070        16  FO-COMMENT-LINE-1        PIC X(78).
  7071
  7072    12  FILLER                       PIC X(20).
  7073
  7074    12  FO-MAINT-INFORMATION.
  7075        16  FO-LAST-MAINT-DT         PIC X(02).
  7076        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7077        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 131
* EL050.cbl
  7079*    COPY ELCMSTR.
  7080******************************************************************
  7081*                                                                *
  7082*                            ELCMSTR.                            *
  7083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7084*                            VMOD=2.012                          *
  7085*                                                                *
  7086*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7087*                                                                *
  7088*   FILE TYPE = VSAM,KSDS                                        *
  7089*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7090*                                                                *
  7091*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7092*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7093*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7094*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7095*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7096*                                                 RKP=75,LEN=21  *
  7097*                                                                *
  7098*   **** NOTE ****                                               *
  7099*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7100*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7101*                                                                *
  7102*   LOG = YES                                                    *
  7103*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7104******************************************************************
  7105*                   C H A N G E   L O G
  7106*
  7107* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7108*-----------------------------------------------------------------
  7109*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7110* EFFECTIVE    NUMBER
  7111*-----------------------------------------------------------------
  7112* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7113* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7114******************************************************************
  7115 01  CLAIM-MASTER.
  7116     12  CL-RECORD-ID                PIC XX.
  7117         88  VALID-CL-ID         VALUE 'CL'.
  7118
  7119     12  CL-CONTROL-PRIMARY.
  7120         16  CL-COMPANY-CD           PIC X.
  7121         16  CL-CARRIER              PIC X.
  7122         16  CL-CLAIM-NO             PIC X(7).
  7123         16  CL-CERT-NO.
  7124             20  CL-CERT-PRIME       PIC X(10).
  7125             20  CL-CERT-SFX         PIC X.
  7126
  7127     12  CL-CONTROL-BY-NAME.
  7128         16  CL-COMPANY-CD-A1        PIC X.
  7129         16  CL-INSURED-LAST-NAME    PIC X(15).
  7130         16  CL-INSURED-NAME.
  7131             20  CL-INSURED-1ST-NAME PIC X(12).
  7132             20  CL-INSURED-MID-INIT PIC X.
  7133
  7134     12  CL-CONTROL-BY-SSN.
  7135         16  CL-COMPANY-CD-A2        PIC X.
  7136         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 132
* EL050.cbl
  7137             20  CL-SSN-STATE        PIC XX.
  7138             20  CL-SSN-ACCOUNT      PIC X(6).
  7139             20  CL-SSN-LN3          PIC X(3).
  7140
  7141     12  CL-CONTROL-BY-CERT-NO.
  7142         16  CL-COMPANY-CD-A4        PIC X.
  7143         16  CL-CERT-NO-A4.
  7144             20  CL-CERT-A4-PRIME    PIC X(10).
  7145             20  CL-CERT-A4-SFX      PIC X.
  7146
  7147     12  CL-CONTROL-BY-CCN.
  7148         16  CL-COMPANY-CD-A5        PIC X.
  7149         16  CL-CCN-A5.
  7150             20  CL-CCN.
  7151                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7152                 24  CL-CCN-PRIME-A5 PIC X(12).
  7153             20  CL-CCN-FILLER-A5    PIC X(4).
  7154
  7155     12  CL-INSURED-PROFILE-DATA.
  7156         16  CL-INSURED-BIRTH-DT     PIC XX.
  7157         16  CL-INSURED-SEX-CD       PIC X.
  7158             88  INSURED-IS-MALE        VALUE 'M'.
  7159             88  INSURED-IS-FEMALE      VALUE 'F'.
  7160             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7161         16  CL-INSURED-OCC-CD       PIC X(6).
  7162         16  FILLER                  PIC X(5).
  7163
  7164     12  CL-PROCESSING-INFO.
  7165         16  CL-PROCESSOR-ID         PIC X(4).
  7166         16  CL-CLAIM-STATUS         PIC X.
  7167             88  CLAIM-IS-OPEN          VALUE 'O'.
  7168             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7169         16  CL-CLAIM-TYPE           PIC X.
  7170*            88  AH-CLAIM               VALUE 'A'.
  7171*            88  LIFE-CLAIM             VALUE 'L'.
  7172*            88  PROPERTY-CLAIM         VALUE 'P'.
  7173*            88  IUI-CLAIM              VALUE 'I'.
  7174*            88  GAP-CLAIM              VALUE 'G'.
  7175         16  CL-CLAIM-PREM-TYPE      PIC X.
  7176             88  SINGLE-PREMIUM         VALUE '1'.
  7177             88  O-B-COVERAGE           VALUE '2'.
  7178             88  OPEN-END-COVERAGE      VALUE '3'.
  7179         16  CL-INCURRED-DT          PIC XX.
  7180         16  CL-REPORTED-DT          PIC XX.
  7181         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7182         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7183         16  CL-LAST-PMT-DT          PIC XX.
  7184         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7185         16  CL-PAID-THRU-DT         PIC XX.
  7186         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7187         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7188         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7189         16  CL-PMT-CALC-METHOD      PIC X.
  7190             88  CL-360-DAY-YR          VALUE '1'.
  7191             88  CL-365-DAY-YR          VALUE '2'.
  7192             88  CL-FULL-MONTHS         VALUE '3'.
  7193         16  CL-CAUSE-CD             PIC X(6).
  7194
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 133
* EL050.cbl
  7195         16  CL-PRIME-CERT-NO.
  7196             20  CL-PRIME-CERT-PRIME PIC X(10).
  7197             20  CL-PRIME-CERT-SFX   PIC X.
  7198
  7199         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7200             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7201             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7202
  7203         16  CL-MICROFILM-NO         PIC X(10).
  7204         16  CL-PROG-FORM-TYPE       PIC X.
  7205         16  CL-LAST-ADD-ON-DT       PIC XX.
  7206
  7207         16  CL-LAST-REOPEN-DT       PIC XX.
  7208         16  CL-LAST-CLOSE-DT        PIC XX.
  7209         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7210             88  FINAL-PAID             VALUE '1'.
  7211             88  CLAIM-DENIED           VALUE '2'.
  7212             88  AUTO-CLOSE             VALUE '3'.
  7213             88  MANUAL-CLOSE           VALUE '4'.
  7214             88  BENEFITS-CHANGED       VALUE 'C'.
  7215             88  SETUP-ERRORS           VALUE 'E'.
  7216         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7217         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7218         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7219             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7220         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7221         16  FILLER                  PIC X.
  7222
  7223     12  CL-CERTIFICATE-DATA.
  7224         16  CL-CERT-ORIGIN          PIC X.
  7225             88  CERT-WAS-ONLINE        VALUE '1'.
  7226             88  CERT-WAS-CREATED       VALUE '2'.
  7227             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7228         16  CL-CERT-KEY-DATA.
  7229             20  CL-CERT-CARRIER     PIC X.
  7230             20  CL-CERT-GROUPING    PIC X(6).
  7231             20  CL-CERT-STATE       PIC XX.
  7232             20  CL-CERT-ACCOUNT.
  7233                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7234                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7235             20  CL-CERT-EFF-DT      PIC XX.
  7236
  7237     12  CL-STATUS-CONTROLS.
  7238         16  CL-PRIORITY-CD          PIC X.
  7239             88  CONFIDENTIAL-DATA      VALUE '8'.
  7240             88  HIGHEST-PRIORITY       VALUE '9'.
  7241         16  CL-SUPV-ATTN-CD         PIC X.
  7242             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7243             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7244         16  CL-PURGED-DT            PIC XX.
  7245         16  CL-RESTORED-DT          PIC XX.
  7246         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7247         16  CL-NEXT-RESEND-DT       PIC XX.
  7248         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7249         16  FILLER                  PIC XX.
  7250         16  CL-LAST-MAINT-DT        PIC XX.
  7251         16  CL-LAST-MAINT-USER      PIC X(4).
  7252         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 134
* EL050.cbl
  7253         16  CL-LAST-MAINT-TYPE      PIC X.
  7254             88  CLAIM-SET-UP           VALUE ' '.
  7255             88  PAYMENT-MADE           VALUE '1'.
  7256             88  LETTER-SENT            VALUE '2'.
  7257             88  MASTER-WAS-ALTERED     VALUE '3'.
  7258             88  MASTER-WAS-RESTORED    VALUE '4'.
  7259             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7260             88  FILE-CONVERTED         VALUE '6'.
  7261             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7262             88  ERROR-CORRECTION       VALUE 'E'.
  7263         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7264         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7265         16  CL-BENEFICIARY          PIC X(10).
  7266         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7267         16  CL-DENIAL-TYPE          PIC X.
  7268             88  CL-TYPE-DENIAL          VALUE '1'.
  7269             88  CL-TYPE-RESCISSION      VALUE '2'.
  7270             88  CL-TYPE-REFORMATION     VALUE '3'.
  7271             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7272             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7273         16  FILLER                  PIC X(5).
  7274
  7275     12  CL-TRAILER-CONTROLS.
  7276         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7277             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7278             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7279             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7280         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7281         16  FILLER                  PIC XX.
  7282         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7283         16  CL-ADDRESS-TRAILER-CNT.
  7284             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7285                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7286             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7287                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7288             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7289                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7290             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7291                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7292             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7293                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7294             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7295                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7296             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7297                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7298
  7299     12  CL-CV-REFERENCE-NO.
  7300         16  CL-CV-REFNO-PRIME       PIC X(18).
  7301         16  CL-CV-REFNO-SFX         PIC XX.
  7302
  7303     12  CL-FILE-LOCATION            PIC X(4).
  7304
  7305     12  CL-PROCESS-ERRORS.
  7306         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7307             88  NO-FATAL-ERRORS        VALUE ZERO.
  7308         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7309             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7310
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 135
* EL050.cbl
  7311     12  CL-PRODUCT-CD               PIC X.
  7312
  7313     12  CL-CURRENT-KEY-DATA.
  7314         16  CL-CURRENT-CARRIER      PIC X.
  7315         16  CL-CURRENT-GROUPING     PIC X(6).
  7316         16  CL-CURRENT-STATE        PIC XX.
  7317         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7318
  7319     12  CL-ASSOCIATES               PIC X.
  7320         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7321         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7322         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7323         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7324
  7325     12  CL-ACTIVITY-CODE            PIC 99.
  7326     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7327     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7328
  7329     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7330     12  CL-LAG-REPORT-CODE          PIC 9.
  7331     12  CL-LOAN-TYPE                PIC XX.
  7332     12  CL-LEGAL-STATE              PIC XX.
  7333
  7334*    12  FILLER                      PIC X(5).
  7335     12  CL-YESNOSW                  PIC X.
  7336     12  FILLER                      PIC X(4).
  7337
  7338 01  PLAN-RECORDS.
  7339     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7340     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7341
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 136
* EL050.cbl
  7343 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7344                          ACCOUNT-MASTER REINSURANCE-RECORD
  7345                          COMM-TABLE-RECORD FORM-MASTER
  7346                          CLAIM-MASTER PLAN-RECORDS.
  7347 0000-DFHEXIT SECTION.
  7348     MOVE '9#                    $   ' TO DFHEIV0.
  7349     MOVE 'EL050' TO DFHEIV1.
  7350     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7351
  7352     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7353
  7354
  7355* EXEC CICS  HANDLE CONDITION
  7356*           ERROR    (9300-ABEND)
  7357*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7358*    END-EXEC.
  7359*    MOVE '"$.J                  ! " #00007350' TO DFHEIV0
  7360     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7362     MOVE X'2220233030303037333530' TO DFHEIV0(25:11)
  7363     CALL 'kxdfhei1' USING DFHEIV0
  7364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7365
  7366
  7367 0000-COPY-PROCEDURE-DIV.
  7368*                          COPY ELC50PD.
  7369******************************************************************
  7370*                                                                *
  7371*                            ELC50PD                             *
  7372*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7373*                            VMOD=2.188                          *
  7374*                                                                *
  7375******************************************************************
  7376*                   C H A N G E   L O G
  7377*
  7378* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7379*-----------------------------------------------------------------
  7380*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7381* EFFECTIVE    NUMBER
  7382*-----------------------------------------------------------------
  7383* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7384* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7385* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7386*                             2709 AND 2718
  7387* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7388* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7389* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7390* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7391* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7392*                                IS OPEN OR CNC DT < PD THRU
  7393* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7394* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7395* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7396* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7397* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7398* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7399* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7400* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 137
* EL050.cbl
  7401* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7402* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7403* 020906                   PEMA  EXPAND LOAN OFFICER
  7404* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7405* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7406* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7407* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7408* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7409* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7410* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7411* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7412* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7413* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7414* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7415* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7416* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7417* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7418* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7419* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7420* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7421* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7422* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7423* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7424* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7425* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7426* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7427* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7428* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7429*                                UPDATE VIN ON CERT TRAILER
  7430* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7431* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7432* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7433* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7434* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7435* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7436* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7437* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7438* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7439* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7440* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7441* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7442* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7443* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7444* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7445* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7446* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7447* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7448* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7449* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7450* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7451* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7452* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7453* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7454* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7455* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7456* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7457* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7458* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 138
* EL050.cbl
  7459******************************************************************
  7460************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7461******************************************************************
  7462
  7463     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7464
  7465     MOVE SPACES                 TO PB-FATAL-FLAG
  7466                                    PB-FORCE-ER-CD
  7467                                    PB-WARN-ER-CD
  7468                                    PB-OUT-BAL-CD.
  7469
  7470     MOVE SPACE                  TO WS-IG-OVRD-AH
  7471                                    WS-IG-OVRD-LF
  7472                                    WS-IG-OVRD-AM
  7473                                    WS-IG-OVRD
  7474                                    WS-IG-OVRD-AH-PL
  7475                                    WS-IG-OVRD-LF-PL
  7476                                    WS-IG-OVRD-AH-BEN
  7477                                    WS-IG-OVRD-LF-BEN.
  7478
  7479******************************************************************
  7480*************       INITIALIZE COMMON ERRORS       ***************
  7481******************************************************************
  7482
  7483     MOVE +0                     TO PB-NO-OF-ERRORS.
  7484     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7485
  7486******************************************************************
  7487
  7488     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7489     SET JULIAN-TO-BIN           TO TRUE.
  7490*    MOVE 5                      TO DC-OPTION-CODE.
  7491     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7492     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7493
  7494     MOVE ZERO                   TO  SUB4.
  7495
  7496 0040-INITIALIZE-GA-BILL-DT.
  7497
  7498     ADD +1                      TO  SUB4.
  7499
  7500     IF  SUB4 GREATER THAN +5
  7501         GO TO 0050-CHECK-CNTL-FOUND.
  7502
  7503     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7504         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7505
  7506     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7507
  7508 0050-CHECK-CNTL-FOUND.
  7509
  7510     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7511        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7512                                         WS-AH-REM-TERM-CALC
  7513                                         EC-CO-REM-TERM-CALC
  7514        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7515        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7516        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 139
* EL050.cbl
  7517                                         WS-TOL-AH-CLAIM
  7518        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7519                                         WS-TOL-AH-PREM
  7520                                         EC-CO-TOL-PREM
  7521        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7522                                         WS-TOL-AH-REFUND
  7523                                         EC-CO-TOL-REFUND
  7524        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7525                                         WS-AH-REFUND-OVS-AMT
  7526                                         EC-CO-OVR-SHT-AMT
  7527        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7528                                         WS-TOL-AH-PREM-PCT
  7529                                         EC-CO-TOL-PREM-PCT
  7530        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7531                                         WS-TOL-AH-REFUND-PCT
  7532                                         EC-CO-TOL-REFUND-PCT
  7533        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7534                                         WS-AH-REFUND-OVS-PCT
  7535                                         EC-CO-OVR-SHT-PCT
  7536        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7537        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7538        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7539        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7540        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7541        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7542        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7543        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7544        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7545        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7546        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7547        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7548                                         EC-CO-MONTH-END-DT
  7549        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7550          GO TO 0100-READ-ACCT.
  7551
  7552     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7553     MOVE SPACES                 TO CNTL-ACCESS.
  7554     MOVE '1'                    TO CNTL-REC-TYPE.
  7555     MOVE +0                     TO CNTL-SEQ-NO.
  7556
  7557     MOVE '1' TO RC-SW-1.
  7558     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7559     IF NOT CF-COMPANY-MASTER
  7560         MOVE ZEROS             TO WK-CO-TOL-PREM
  7561                                   WK-CO-TOL-CLAIM
  7562                                   WK-CO-TOL-REFUND
  7563                                   WK-REFUND-OVS-AMT
  7564                                   WK-REFUND-OVS-PCT
  7565                                   WK-CO-TOL-PREM-PCT
  7566                                   WK-CO-TOL-REFUND-PCT
  7567                                   WK-DEFAULT-APR
  7568                                   WK-CO-MAX-CAP
  7569        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7570                                   WK-CR-R78-METHOD
  7571                                   WK-CO-REF-REJECT-SW
  7572                                   WK-CO-PREM-REJECT-SW
  7573                                   WK-REM-TRM-CALC-OPTION
  7574                                   WK-BIRTH-DATE-INPUT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 140
* EL050.cbl
  7575                                   WK-JOINT-AGE-INPUT
  7576        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7577        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7578        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7579        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7580          GO TO 0099-COMPANY-NOT-FOUND.
  7581
  7582     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7583        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7584     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7585        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7586     IF CF-CO-TOL-CAP NOT NUMERIC
  7587        MOVE +0                    TO CF-CO-TOL-CAP.
  7588     IF CF-DEFAULT-APR NOT NUMERIC
  7589        MOVE +0                    TO CF-DEFAULT-APR.
  7590
  7591     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7592     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7593     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7594     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7595     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7596     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7597     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7598     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7599     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7600     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7601     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7602     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7603
  7604     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7605          CF-CO-OVR-SHT-AMT > +0
  7606        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7607
  7608     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7609          CF-CO-OVR-SHT-PCT > +0
  7610        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7611
  7612     IF CF-VALID-REM-TRM-OPTION
  7613         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7614     ELSE
  7615         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7616
  7617     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7618     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7619     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7620     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7621
  7622     GO TO 0050-CHECK-CNTL-FOUND.
  7623
  7624 0099-COMPANY-NOT-FOUND.
  7625
  7626     MOVE ER-2616                TO WS-ERROR.
  7627     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7628
  7629 0100-READ-ACCT.
  7630
  7631     MOVE SPACES                 TO DATE-RANGE-SW.
  7632
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 141
* EL050.cbl
  7633     IF WK-ACCT-ADDR = ZEROS
  7634        GO TO 0102-ACCT-GETMAIN.
  7635
  7636     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7637     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7638     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7639
  7640     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7641        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7642        GO TO 0105-READ-ACCT
  7643     END-IF
  7644
  7645     IF PB-CARRIER NOT = SPACES
  7646        IF PB-CARRIER NOT = AM-VG-CARRIER
  7647           GO TO 0105-READ-ACCT.
  7648
  7649     IF PB-STATE NOT = SPACES
  7650        IF PB-STATE NOT = AM-VG-STATE
  7651           GO TO 0105-READ-ACCT.
  7652
  7653     IF PB-GROUPING NOT = SPACES
  7654        IF PB-GROUPING NOT = AM-VG-GROUPING
  7655           GO TO 0105-READ-ACCT.
  7656
  7657     MOVE 'X'                 TO DATE-RANGE-SW.
  7658
  7659     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7660        MOVE 'X'                 TO DATE-RANGE-SW
  7661        GO TO 0105-READ-ACCT.
  7662
  7663     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7664        GO TO 0105-READ-ACCT.
  7665
  7666     GO TO 0180-ACCOUNT-FOUND.
  7667
  7668 0102-ACCT-GETMAIN.
  7669     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7670     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7671
  7672 0105-READ-ACCT.
  7673     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7674     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7675     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7676     MOVE PB-STATE               TO ACCT-STATE.
  7677     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7678     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7679
  7680     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7681
  7682     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7683
  7684 0110-FIND-ACCT-TOLERANCES-LOOP.
  7685     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7686
  7687     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7688        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7689        GO TO 0199-ACCT-NOT-FOUND
  7690     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 142
* EL050.cbl
  7691     IF PB-CARRIER NOT = SPACES
  7692        IF PB-CARRIER NOT = AM-VG-CARRIER
  7693           GO TO 0199-ACCT-NOT-FOUND.
  7694
  7695     IF PB-STATE NOT = SPACES
  7696        IF PB-STATE NOT = AM-VG-STATE
  7697           GO TO 0199-ACCT-NOT-FOUND.
  7698
  7699     IF PB-GROUPING NOT = SPACES
  7700        IF PB-GROUPING NOT = AM-VG-GROUPING
  7701           GO TO 0199-ACCT-NOT-FOUND.
  7702
  7703     MOVE 'X'                    TO DATE-RANGE-SW.
  7704
  7705     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7706        MOVE 'X'                 TO DATE-RANGE-SW
  7707        GO TO 0199-ACCT-NOT-FOUND.
  7708
  7709     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7710        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7711
  7712 0180-ACCOUNT-FOUND.
  7713     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7714     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7715     MOVE AM-STATE               TO PB-SV-STATE.
  7716     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7717
  7718     IF AM-CANCEL-FEE  NOT NUMERIC
  7719        MOVE ZEROS TO AM-CANCEL-FEE.
  7720
  7721     IF AM-MAX-MON-BEN NOT NUMERIC
  7722        MOVE ZEROS TO AM-MAX-MON-BEN.
  7723
  7724     IF AM-MAX-TOT-BEN NOT NUMERIC
  7725        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7726
  7727     IF AM-CLP-TOL-PCT NOT NUMERIC
  7728        MOVE +0                  TO AM-CLP-TOL-PCT
  7729     END-IF
  7730     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7731        MOVE +0                  TO AM-SPP-LEASE-COMM
  7732     END-IF
  7733     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7734        MOVE ER-2611             TO   WS-ERROR
  7735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7736
  7737     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7738        MOVE ER-2621             TO   WS-ERROR
  7739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7740
  7741     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7742        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7743        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7744        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7745         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7746
  7747     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7748     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 143
* EL050.cbl
  7749     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7750     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7751     IF AM-CLP-TOL-PCT NOT = ZEROS
  7752        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7753     END-IF
  7754     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7755        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7756     END-IF
  7757*    IF PB-COMPANY-ID = 'DCC'
  7758*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7759*                                   WS-ADMIN-FEES
  7760*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7761*          (SUB5 > +10)
  7762*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7763*             AND (AM-A-COM (SUB5) NUMERIC)
  7764*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7765*                + (AM-A-COM (SUB5) * 1000)
  7766*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7767*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7768*                + (AM-A-COM (SUB5) * 1000)
  7769*             END-IF
  7770*             IF AM-COM-TYP (SUB5) = 'N'
  7771*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7772*                + (AM-A-COM (SUB5) * 1000)
  7773*             END-IF
  7774*          END-IF
  7775*       END-PERFORM
  7776*    END-IF
  7777     IF (PB-COMPANY-ID = 'DCC')
  7778        AND (PB-ISSUE)
  7779        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7780        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7781           (SUB5 > +10)
  7782           MOVE +0 TO WS-WK-RATE
  7783           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7784              IF (AM-A-COM (SUB5) NUMERIC)
  7785                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7786                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7787              ELSE
  7788                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7789                 IF PB-ISSUE
  7790                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7791                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7792                 ELSE
  7793                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7794                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7795                 END-IF
  7796                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7797                 MOVE ZEROS             TO WS-SUB1
  7798                                           WS-COMMISSION
  7799                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7800                 MOVE '0530'               TO CTBL-SW
  7801                 MOVE ' '                  TO WS-CTBL-READ-SW
  7802                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7803                 IF FIRST-TIME-THROUGH
  7804                    MOVE 'AA'              TO CTBL-BEN-CODE
  7805                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7806                 END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 144
* EL050.cbl
  7807                 IF CTBL-TABLE-FOUND
  7808                    IF PB-ISSUE
  7809                       COMPUTE WS-COMM-CK-AMT =
  7810                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7811                    ELSE
  7812                       COMPUTE WS-COMM-CK-AMT =
  7813                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7814                    END-IF
  7815                    PERFORM 8800-GET-COMP-RATE
  7816                              THRU 8800-EXIT
  7817                 END-IF
  7818              END-IF
  7819              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7820                + (WS-WK-RATE * 1000)
  7821           END-IF
  7822        END-PERFORM
  7823     END-IF
  7824     IF PB-COMPANY-ID EQUAL 'CRI'
  7825         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7826
  7827     IF PB-COMPANY-ID EQUAL 'NCL'
  7828         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7829     END-IF
  7830
  7831     GO TO 0200-READ-CERT.
  7832
  7833 0199-ACCT-NOT-FOUND.
  7834
  7835     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7836
  7837     IF DATE-RANGE-SW NOT = SPACES
  7838        MOVE ER-2601             TO WS-ERROR
  7839        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7840     ELSE
  7841        MOVE ER-2619             TO WS-ERROR
  7842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7843
  7844     GO TO 9990-RETURN.
  7845
  7846 0200-READ-CERT.
  7847
  7848     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7849     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7850     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7851     MOVE PB-SV-STATE            TO CERT-STATE.
  7852     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7853     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7854     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7855
  7856     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7857
  7858     IF CERT-WAS-NOT-FOUND
  7859        GO TO 0299-CERT-NOT-FOUND.
  7860
  7861     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7862        MOVE ER-2759             TO WS-ERROR
  7863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7864        GO TO 0298-UNLOCK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 145
* EL050.cbl
  7865
  7866     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7867         MOVE ER-2758            TO WS-ERROR
  7868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7869         GO TO 0298-UNLOCK-RETURN.
  7870
  7871     IF PB-ISSUE
  7872        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7873           IF CERT-WAS-CREATED-FOR-CLAIM
  7874              NEXT SENTENCE
  7875            ELSE
  7876              MOVE ER-2626       TO WS-ERROR
  7877              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7878              GO TO 0298-UNLOCK-RETURN.
  7879
  7880     IF NOT PB-CANCELLATION
  7881        GO TO 0300-CONTINUE-EDIT.
  7882
  7883     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7884     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7885     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7886     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7887     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7888     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7889
  7890     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7891     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7892     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7893     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7894     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7895     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7896     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7897     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7898     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7899
  7900     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7901     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7902     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7903     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7904     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7905     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7906     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7907
  7908     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7909     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7910
  7911     MOVE CM-CREDIT-INTERFACE-SW-1
  7912                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7913     MOVE CM-CREDIT-INTERFACE-SW-2
  7914                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7915
  7916     IF CM-O-B-COVERAGE
  7917         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7918
  7919     IF CM-LIVES NOT NUMERIC
  7920         MOVE ZERO                TO CM-LIVES.
  7921
  7922     IF CM-BILLED NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 146
* EL050.cbl
  7923         MOVE ZERO                TO CM-BILLED.
  7924
  7925     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7926         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7927         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7928         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7929         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7930         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7931         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7932         MOVE CM-LIVES             TO PB-CI-LIVES
  7933*The next line causes a problem with my change  I dont think it is
  7934*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7935
  7936     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7937     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7938     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7939     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7940     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7941     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7942
  7943     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7944     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7945     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7946     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7947
  7948     IF CM-LIFE-COMM-PCT NUMERIC
  7949         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7950     ELSE
  7951         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7952
  7953     IF CM-AH-COMM-PCT NUMERIC
  7954         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7955     ELSE
  7956         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7957
  7958     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7959
  7960     IF CM-LOAN-APR       NOT NUMERIC
  7961           MOVE ZERO               TO CM-LOAN-APR.
  7962
  7963     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7964           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7965
  7966     IF CM-LOAN-TERM      NOT NUMERIC
  7967           MOVE ZERO               TO CM-LOAN-TERM.
  7968
  7969     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7970           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7971
  7972     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7973           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7974
  7975     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7976     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7977     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7978     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7979     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7980     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 147
* EL050.cbl
  7981     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7982     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  7983     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7984     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7985     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7986     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  7987
  7988     IF CM-STATE = CM-SSN-STATE
  7989         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  7990
  7991     IF CM-STATE NOT = CM-MEMB-STATE
  7992         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  7993
  7994     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  7995
  7996     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  7997        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  7998        IF CM-ADDL-CLP NOT NUMERIC
  7999           MOVE +0               TO CM-ADDL-CLP
  8000        END-IF
  8001        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8002        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8003           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8004        END-IF
  8005     END-IF
  8006     IF PB-COMPANY-ID = 'DCC'
  8007        MOVE +0                  TO WS-ADMIN-FEES
  8008                                    WS-CSO-ADMIN-FEE
  8009                                    WS-COMM-AND-MFEE
  8010                                    WS-1ST-YR-ALLOW
  8011        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8012           (SUB5 > +10)
  8013           MOVE +0 TO WS-WK-RATE
  8014           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8015              IF (AM-A-COM (SUB5) NUMERIC)
  8016                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8017                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8018              ELSE
  8019                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8020                 IF PB-ISSUE
  8021                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8022                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8023                 ELSE
  8024                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8025                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8026                 END-IF
  8027                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8028                 MOVE ZEROS             TO WS-SUB1
  8029                                           WS-COMMISSION
  8030                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8031                 MOVE '0530'               TO CTBL-SW
  8032                 MOVE ' '                  TO WS-CTBL-READ-SW
  8033                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8034                 IF FIRST-TIME-THROUGH
  8035                    MOVE 'AA'              TO CTBL-BEN-CODE
  8036                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8037                 END-IF
  8038                 IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 148
* EL050.cbl
  8039                    IF PB-ISSUE
  8040                       COMPUTE WS-COMM-CK-AMT =
  8041                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8042                    ELSE
  8043                       COMPUTE WS-COMM-CK-AMT =
  8044                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8045                    END-IF
  8046                    PERFORM 8800-GET-COMP-RATE
  8047                              THRU 8800-EXIT
  8048                 END-IF
  8049              END-IF
  8050              IF AM-COM-TYP (SUB5) = 'I'
  8051                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8052                   + (WS-WK-RATE * 1000)
  8053              END-IF
  8054              IF AM-COM-TYP (SUB5) = 'N'
  8055                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8056                   + (WS-WK-RATE * 1000)
  8057              END-IF
  8058              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8059                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8060                   + (WS-WK-RATE * 1000)
  8061              END-IF
  8062              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8063                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8064                   + (WS-WK-RATE * 1000)
  8065              END-IF
  8066           END-IF
  8067        END-PERFORM
  8068     END-IF
  8069     GO TO 0300-CONTINUE-EDIT.
  8070
  8071 0298-UNLOCK-RETURN.
  8072      PERFORM 9250-UNLOCK-RETURN
  8073      GO TO 9990-RETURN.
  8074
  8075 0299-CERT-NOT-FOUND.
  8076
  8077     MOVE '1'                     TO CERT-STATUS-SW.
  8078
  8079     IF PB-COMPANY-ID = 'UCL'
  8080         IF WS-ERROR = ER-2799
  8081             GO TO 3000-CONTINUE-EDIT.
  8082
  8083     IF NOT PB-CANCELLATION
  8084         GO TO 0300-CONTINUE-EDIT.
  8085
  8086     MOVE ER-2726                  TO  WS-ERROR.
  8087     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8088     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8089     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8090                                    PB-CI-LF-TERM
  8091                                    PB-C-LF-REM-TERM
  8092                                    PB-CI-AH-TERM
  8093                                    PB-C-AH-REM-TERM
  8094                                    PB-CI-LF-BENEFIT-CD
  8095                                    PB-CI-LF-BENEFIT-AMT
  8096                                    PB-CI-LF-ALT-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 149
* EL050.cbl
  8097                                    PB-CI-LF-PREMIUM-AMT
  8098                                    PB-CI-LF-ALT-PREMIUM-AMT
  8099                                    PB-CI-AH-BENEFIT-CD
  8100                                    PB-CI-AH-BENEFIT-AMT
  8101                                    PB-CI-AH-PREMIUM-AMT
  8102                                    PB-CI-PAY-FREQUENCY
  8103                                    PB-CI-LOAN-APR
  8104                                    PB-CI-LOAN-TERM
  8105                                    PB-CI-LIFE-COMMISSION
  8106                                    PB-CI-AH-COMMISSION
  8107                                    PB-CI-CURR-SEQ
  8108                                    PB-CI-AH-CANCEL-AMT
  8109                                    PB-CI-LF-CANCEL-AMT
  8110                                    PB-CI-RATE-DEV-PCT-LF
  8111                                    PB-CI-RATE-DEV-PCT-AH
  8112                                    PB-CI-EXTENTION-DAYS
  8113                                    PB-CI-TERM-IN-DAYS
  8114                                    PB-CI-LIVES
  8115                                    PB-CI-LF-CRIT-PER
  8116                                    PB-CI-AH-CRIT-PER
  8117                                    PB-CI-ADDL-CLP
  8118                                    PB-CI-DDF-IU-RATE-UP.
  8119
  8120     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8121                                    PB-CI-AH-SETTLEMENT-DT
  8122                                    PB-CI-DEATH-DT
  8123                                    PB-CI-LF-PRIOR-CANCEL-DT
  8124                                    PB-CI-AH-PRIOR-CANCEL-DT
  8125                                    PB-CI-ENTRY-DT
  8126                                    PB-CI-LF-EXPIRE-DT
  8127                                    PB-CI-AH-EXPIRE-DT
  8128                                    PB-CI-LOAN-1ST-PMT-DT.
  8129
  8130     IF ACCOUNT-MAST-FOUND
  8131        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8132        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8133
  8134     GO TO 3000-CONTINUE-EDIT.
  8135
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 150
* EL050.cbl
  8137
  8138 0300-CONTINUE-EDIT.
  8139
  8140     IF PB-ISSUE
  8141        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8142            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8143
  8144     IF PB-ISSUE
  8145        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8146            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8147
  8148     IF PB-ISSUE
  8149       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8150          (AM-NO-AH-ONLY)
  8151           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8152               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8153                   MOVE ER-2679 TO WS-ERROR
  8154                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8155
  8156     IF PB-ISSUE
  8157        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8158        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8159        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8160     ELSE
  8161        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8162        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8163        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8164
  8165     MOVE 'N'                    TO PLAN-MASTER-SW
  8166                                    PLAN-MASTER-LIFE-SW
  8167                                    FORM-MASTER-SW
  8168                                    WS-APP-CERT-SW.
  8169
  8170     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8171                                    WS-PL-TOL-LF-REFUND
  8172                                    WS-PL-REF-OVS-AMT
  8173                                    WS-PL-TOL-LF-PREM-PCT
  8174                                    WS-PL-TOL-LF-REFUND-PCT
  8175                                    WS-PL-REF-OVS-PCT
  8176                                    WS-PL-TOL-LF-CLAIM.
  8177
  8178     IF PB-COMPANY-ID = 'NCL'
  8179       IF PB-ISSUE
  8180         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8181             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8182             IF FORM-MASTER-FOUND
  8183                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8184
  8185     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8186        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8187
  8188********************** MON CODE **********************
  8189     IF PB-COMPANY-ID = 'MON'
  8190     IF PB-ISSUE
  8191     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8192        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8193             PB-I-LOAN-APR = ZERO)
  8194               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 151
* EL050.cbl
  8195******************************************************
  8196
  8197     IF PB-COMPANY-ID = 'NCL'
  8198       IF PB-ISSUE
  8199           IF FORM-MASTER-FOUND
  8200             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8201                AM-DISMBR-COVERAGE
  8202                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8203                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8204                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8205                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8206                                           PB-I-LIFE-BENEFIT-CD.
  8207
  8208     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8209
  8210     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8211         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8212         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8213         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8214         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8215         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8216           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8217             GO TO 0301-LIFE-BENEFIT-SEARCH
  8218         ELSE
  8219             NEXT SENTENCE
  8220     ELSE
  8221         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8222
  8223     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8224     MOVE '4'                    TO CNTL-REC-TYPE.
  8225     MOVE +0                     TO CNTL-SEQ-NO.
  8226     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8227
  8228     MOVE '1' TO RC-SW-2.
  8229     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8230
  8231     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8232        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8233         GO TO 0305-BENEFIT-NOT-FOUND.
  8234
  8235     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8236
  8237 0301-LIFE-BENEFIT-SEARCH.
  8238
  8239     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8240
  8241     IF NO-BENEFIT-FOUND
  8242        GO TO 0305-BENEFIT-NOT-FOUND.
  8243
  8244     IF WS-BEN-CD = '99'
  8245        GO TO 0305-BENEFIT-NOT-FOUND.
  8246
  8247     IF PB-COMPANY-ID = 'NCL'
  8248         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8249             GO TO 0304-LIFE-BENEFIT-FOUND.
  8250
  8251     MOVE +1                     TO SUB5.
  8252     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 152
* EL050.cbl
  8253
  8254* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8255* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8256     IF PB-COMPANY-ID = 'DMD'
  8257         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8258
  8259 0302-EDIT-ACCT-LF-BENEFITS.
  8260
  8261     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8262        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8263           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8264                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8265           GO TO 03XX-GET-LIFE-ERPLAN.
  8266
  8267     IF SUB5 LESS THAN +20
  8268        ADD +1                   TO SUB5
  8269        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8270
  8271     MOVE +1                     TO SUB5.
  8272
  8273     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8274        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8275
  8276 0303-EDIT-DMD-EXTRA-BENEFITS.
  8277
  8278     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8279        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8280           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8281                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8282           GO TO 03XX-GET-LIFE-ERPLAN.
  8283
  8284     IF SUB5 LESS THAN +30
  8285        ADD +1                   TO SUB5
  8286        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8287
  8288     MOVE +1                     TO SUB5.
  8289
  8290 03XX-EDIT-FOR-NINETY-LF.
  8291
  8292***************************************************************
  8293*                                                             *
  8294*    NINETY BENEFIT PLAN TYPES:                               *
  8295*                                                             *
  8296*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8297*      92 = ALL GROUP REDUCING BENEFITS                       *
  8298*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8299*      94 = ALL GROUP LEVEL BENEFITS                          *
  8300*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8301*           BENEFIT CONTROLS.                                 *
  8302*      99 = ALL BENEFITS                                      *
  8303*                                                             *
  8304***************************************************************
  8305
  8306     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8307                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8308
  8309     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8310       AND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 153
* EL050.cbl
  8311        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8312        GO TO 03XX-GET-LIFE-ERPLAN.
  8313
  8314     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8315       AND
  8316        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8317        IF CF-REDUCING (SUB3)
  8318           IF (PB-I-INDV-GRP-OVRD = 'I')
  8319              OR
  8320           ((AM-IG = '1') AND
  8321           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8322              OR
  8323           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8324           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8325           (AM-IG NOT = '2'))
  8326              GO TO 03XX-GET-LIFE-ERPLAN.
  8327
  8328     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8329       AND
  8330        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8331        IF CF-REDUCING (SUB3)
  8332           IF (PB-I-INDV-GRP-OVRD = 'G')
  8333              OR
  8334           ((AM-IG = '2') AND
  8335           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8336              OR
  8337           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8338           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8339           (AM-IG NOT = '1'))
  8340              GO TO 03XX-GET-LIFE-ERPLAN.
  8341
  8342     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8343       AND
  8344        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8345        IF CF-LEVEL    (SUB3)
  8346           IF (PB-I-INDV-GRP-OVRD = 'I')
  8347              OR
  8348           ((AM-IG = '1') AND
  8349           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8350              OR
  8351           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8352           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8353            (AM-IG NOT = '2'))
  8354              GO TO 03XX-GET-LIFE-ERPLAN.
  8355
  8356     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8357       AND
  8358        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8359        IF CF-LEVEL    (SUB3)
  8360           IF (PB-I-INDV-GRP-OVRD = 'G')
  8361              OR
  8362           ((AM-IG = '2') AND
  8363           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8364              OR
  8365           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8366           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8367           (AM-IG NOT = '1'))
  8368              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 154
* EL050.cbl
  8369
  8370     IF SUB5 LESS THAN +20
  8371        ADD +1                   TO SUB5
  8372        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8373
  8374     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8375
  8376     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8377        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8378
  8379     MOVE +1                     TO SUB5.
  8380
  8381 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8382
  8383     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8384                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8385
  8386     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8387       AND
  8388        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8389        GO TO 03XX-GET-LIFE-ERPLAN.
  8390
  8391     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8392       AND
  8393        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8394        IF CF-REDUCING (SUB3)
  8395           IF (PB-I-INDV-GRP-OVRD = 'I')
  8396              OR
  8397           ((AM-IG = '1') AND
  8398           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8399              OR
  8400           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8401           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8402           (AM-IG NOT = '2'))
  8403              GO TO 03XX-GET-LIFE-ERPLAN.
  8404
  8405     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8406       AND
  8407        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8408        IF CF-REDUCING (SUB3)
  8409           IF (PB-I-INDV-GRP-OVRD = 'G')
  8410              OR
  8411           ((AM-IG = '2') AND
  8412           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8413              OR
  8414           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8415           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8416           (AM-IG NOT = '1'))
  8417              GO TO 03XX-GET-LIFE-ERPLAN.
  8418
  8419     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8420       AND
  8421        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8422        IF CF-LEVEL    (SUB3)
  8423           IF (PB-I-INDV-GRP-OVRD = 'I')
  8424              OR
  8425           ((AM-IG = '1') AND
  8426           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 155
* EL050.cbl
  8427              OR
  8428           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8429           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8430            (AM-IG NOT = '2'))
  8431              GO TO 03XX-GET-LIFE-ERPLAN.
  8432
  8433     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8434       AND
  8435        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8436        IF CF-LEVEL    (SUB3)
  8437           IF (PB-I-INDV-GRP-OVRD = 'G')
  8438              OR
  8439           ((AM-IG = '2') AND
  8440           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8441              OR
  8442           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8443           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8444           (AM-IG NOT = '1'))
  8445              GO TO 03XX-GET-LIFE-ERPLAN.
  8446
  8447     IF SUB5 LESS THAN +30
  8448        ADD +1                   TO SUB5
  8449        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8450
  8451     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8452
  8453 03XX-EDIT-FOR-NINETY-LF-CONT.
  8454
  8455     MOVE +99                    TO SUB5.
  8456
  8457     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8458        IF PB-ISSUE
  8459           MOVE ER-1924          TO  WS-ERROR
  8460           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8461
  8462     GO TO 0304-LIFE-BENEFIT-FOUND.
  8463
  8464 03XX-GET-LIFE-ERPLAN.
  8465
  8466     IF WK-PLAN-ADDR EQUAL +0
  8467        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8468
  8469     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8470     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8471     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8472     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8473     MOVE 'Y'                    TO PLAN-MASTER-SW
  8474                                    PLAN-MASTER-LIFE-SW.
  8475     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8476
  8477 03XX-ERPLAN-LIFE-GETMAIN.
  8478
  8479     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8480     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8481
  8482 03XX-ERPLAN-LIFE-READ.
  8483
  8484     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 156
* EL050.cbl
  8485     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8486     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8487     MOVE PB-SV-STATE            TO PLAN-STATE.
  8488     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8489     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8490     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8491     MOVE WS-SAVE-BENEFIT-REVISION
  8492                                 TO PLAN-REVISION-NO.
  8493
  8494     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8495     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8496
  8497     IF PB-COMPANY-ID = 'NCL'
  8498       IF NOT LF-PLAN-MASTER-FOUND
  8499         IF NOT PB-POLICY-IS-DECLINED  AND
  8500            NOT PB-POLICY-IS-VOIDED
  8501             MOVE  ER-1921         TO  WS-ERROR
  8502             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8503             GO TO 0304-LIFE-BENEFIT-FOUND.
  8504
  8505     IF NOT LF-PLAN-MASTER-FOUND
  8506        GO TO 0304-LIFE-BENEFIT-FOUND.
  8507
  8508 XXXX-CHECK-LF-PLAN-KEY.
  8509
  8510     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8511        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8512        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8513        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8514        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8515        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8516        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8517        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8518        MOVE 'N'                 TO PLAN-MASTER-SW
  8519          GO TO 03XX-ERPLAN-LIFE-READ.
  8520
  8521     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8522
  8523     IF  PB-CANCELLATION
  8524         GO TO  0303-LF-ACCT-BEN-FOUND.
  8525
  8526     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8527        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8528           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8529           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8530              MOVE ER-2644             TO WS-ERROR
  8531              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8532           ELSE
  8533              NEXT SENTENCE
  8534        ELSE
  8535           IF PB-COMPANY-ID NOT = 'NCL'
  8536              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8537                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8538
  8539 0303-LF-ACCT-BEN-FOUND.
  8540
  8541     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8542
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 157
* EL050.cbl
  8543     IF PL-DEV-CODE NOT = SPACES
  8544        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8545
  8546     IF PL-DEV-PCT NUMERIC AND
  8547        PL-DEV-PCT NOT = ZEROS
  8548        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8549
  8550     IF PL-TOL-PREM-AMT GREATER THAN +0
  8551        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8552
  8553     IF PL-TOL-REF-AMT GREATER THAN +0
  8554        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8555
  8556     IF PL-TOL-PREM-PCT GREATER THAN +0
  8557        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8558
  8559     IF PL-TOL-REF-PCT GREATER THAN +0
  8560        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8561
  8562     IF PL-TOL-CLM-AMT GREATER THAN +0
  8563        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8564
  8565     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8566                          PL-OVER-SHORT-AMT > +0
  8567        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8568
  8569     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8570                          PL-OVER-SHORT-PCT > +0
  8571        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8572
  8573     IF PL-SALES-TAX NUMERIC AND
  8574                          PL-SALES-TAX > +0
  8575         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8576
  8577     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8578        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8579                                    WS-IG-OVRD-AM.
  8580
  8581 0304-LIFE-BENEFIT-FOUND.
  8582
  8583     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8584
  8585     IF PB-ISSUE
  8586        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8587     ELSE
  8588        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8589
  8590     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8591     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8592     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8593     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8594     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8595                                         WS-LF-REFUND-CALC.
  8596
  8597     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8598        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8599
  8600     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 158
* EL050.cbl
  8601        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8602     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8603
  8604     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8605     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8606     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8607     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8608     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8609     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8610
  8611     IF PB-COMPANY-ID = 'NCL'  AND
  8612        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8613         NEXT SENTENCE
  8614     ELSE
  8615         IF SUB5 NOT GREATER THAN +20
  8616            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8617               MOVE WS-SAVE-BENEFIT-REM-TERM
  8618                                      TO WS-AM-LF-BENE-REM-TERM
  8619                                         EC-BR-LF-REM-TERM-CALC.
  8620
  8621     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8622     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8623
  8624     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8625
  8626 0305-BENEFIT-NOT-FOUND.
  8627
  8628     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8629     MOVE ER-2604                TO WS-ERROR.
  8630     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8631
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 159
* EL050.cbl
  8633
  8634 0310-FIND-AH-BENEFIT-RECORD.
  8635
  8636     MOVE 'N'                    TO PLAN-MASTER-SW
  8637                                    PLAN-MASTER-AH-SW.
  8638
  8639     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8640                                    WS-PL-TOL-AH-REFUND
  8641                                    WS-AH-PL-REF-OVS-AMT
  8642                                    WS-PL-TOL-AH-PREM-PCT
  8643                                    WS-PL-TOL-AH-REFUND-PCT
  8644                                    WS-AH-PL-REF-OVS-PCT
  8645                                    WS-PL-TOL-AH-CLAIM.
  8646
  8647
  8648     IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8649        MOVE SPACES              TO PB-I-AH-INPUT-CD.
  8650
  8651     IF PB-I-AH-INPUT-CD NOT EQUAL SPACES AND
  8652       (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8653          GO TO 0399-BENEFIT-NOT-FOUND.
  8654
  8655     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8656        GO TO 0400-FIND-CARRIER.
  8657
  8658     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8659
  8660     IF WK-AH-BEN-ADDR NOT = ZEROS
  8661         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8662         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8663         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8664         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8665           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8666             GO TO 0311-AH-BENEFIT-SEARCH
  8667         ELSE
  8668             NEXT SENTENCE
  8669     ELSE
  8670         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8671
  8672     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8673     MOVE '5'                    TO CNTL-REC-TYPE.
  8674     MOVE +0                     TO CNTL-SEQ-NO.
  8675     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8676
  8677     MOVE '2' TO RC-SW-2.
  8678     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8679
  8680     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8681        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8682          GO TO 0399-BENEFIT-NOT-FOUND.
  8683
  8684     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8685
  8686 0311-AH-BENEFIT-SEARCH.
  8687
  8688     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8689
  8690     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 160
* EL050.cbl
  8691         GO TO 0399-BENEFIT-NOT-FOUND.
  8692
  8693     IF WS-BEN-CD = '99'
  8694        GO TO 0399-BENEFIT-NOT-FOUND.
  8695
  8696     IF PB-COMPANY-ID  =  'NCL'
  8697         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8698             GO TO 0314-A-H-BENEFIT-FOUND.
  8699
  8700     MOVE +1                     TO SUB5.
  8701     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8702
  8703* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8704* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8705     IF PB-COMPANY-ID = 'DMD'
  8706         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8707
  8708 0312-EDIT-ACCT-AH-BENEFITS.
  8709
  8710     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8711        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8712           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8713                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8714           GO TO 03XX-GET-AH-ERPLAN.
  8715
  8716     IF SUB5 LESS THAN +20
  8717        ADD +1                   TO SUB5
  8718        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8719
  8720     MOVE +1                     TO SUB5.
  8721
  8722     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8723        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8724
  8725 0313-EDIT-DMD-EXTRA-BENEFITS.
  8726
  8727     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8728        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8729           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8730                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8731           GO TO 03XX-GET-AH-ERPLAN.
  8732
  8733     IF SUB5 LESS THAN +30
  8734        ADD +1                   TO SUB5
  8735        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8736
  8737     MOVE +1                     TO SUB5.
  8738
  8739 03XX-EDIT-FOR-NINETY-AH.
  8740
  8741***************************************************************
  8742*                                                             *
  8743*    NINETY BENEFIT PLAN TYPES:                               *
  8744*                                                             *
  8745*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8746*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8747*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8748*           BENEFIT CONTROLS.                                 *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 161
* EL050.cbl
  8749*      99 = ALL BENEFITS.                                     *
  8750*                                                             *
  8751***************************************************************
  8752
  8753     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8754                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8755
  8756     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8757       AND
  8758        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8759        GO TO 03XX-GET-AH-ERPLAN.
  8760
  8761     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8762       AND
  8763        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8764           IF (PB-I-INDV-GRP-OVRD = 'I')
  8765              OR
  8766           ((AM-IG = '1') AND
  8767           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8768              OR
  8769           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8770           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8771           (AM-IG NOT = '2'))
  8772              GO TO 03XX-GET-AH-ERPLAN.
  8773
  8774     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8775       AND
  8776        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8777           IF (PB-I-INDV-GRP-OVRD = 'G')
  8778              OR
  8779           ((AM-IG = '2') AND
  8780           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8781              OR
  8782           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8783           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8784           (AM-IG NOT = '1'))
  8785              GO TO 03XX-GET-AH-ERPLAN.
  8786
  8787     IF SUB5 LESS THAN +20
  8788        ADD +1                   TO SUB5
  8789        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8790
  8791     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8792        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8793
  8794     MOVE +1                    TO SUB5.
  8795
  8796 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8797
  8798     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8799                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8800
  8801     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8802       AND
  8803        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8804        GO TO 03XX-GET-AH-ERPLAN.
  8805
  8806     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 162
* EL050.cbl
  8807       AND
  8808        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8809           IF (PB-I-INDV-GRP-OVRD = 'I')
  8810              OR
  8811           ((AM-IG = '1') AND
  8812           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8813              OR
  8814           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8815           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8816           (AM-IG NOT = '2'))
  8817              GO TO 03XX-GET-AH-ERPLAN.
  8818
  8819     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8820       AND
  8821        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8822           IF (PB-I-INDV-GRP-OVRD = 'G')
  8823              OR
  8824           ((AM-IG = '2') AND
  8825           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8826              OR
  8827           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8828           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8829           (AM-IG NOT = '1'))
  8830              GO TO 03XX-GET-AH-ERPLAN.
  8831
  8832     IF SUB5 LESS THAN +30
  8833        ADD +1                   TO SUB5
  8834        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8835
  8836 03XX-EDIT-FOR-NINETY-AH-CONT.
  8837
  8838     MOVE +99                    TO SUB5.
  8839
  8840     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8841
  8842     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8843        IF PB-ISSUE
  8844           MOVE ER-1925          TO  WS-ERROR
  8845           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8846
  8847     GO TO 0314-A-H-BENEFIT-FOUND.
  8848
  8849 03XX-GET-AH-ERPLAN.
  8850
  8851     IF WK-PLAN-ADDR EQUAL +0
  8852         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8853
  8854     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8855     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8856     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8857     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8858     MOVE 'Y'                    TO PLAN-MASTER-SW
  8859                                    PLAN-MASTER-AH-SW.
  8860*****GO TO XXXX-CHECK-AH-PLAN-KEY.
  8861     GO TO 03XX-ERPLAN-AH-READ.
  8862
  8863 03XX-ERPLAN-AH-GETMAIN.
  8864
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 163
* EL050.cbl
  8865     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8866     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8867
  8868 03XX-ERPLAN-AH-READ.
  8869
  8870     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8871     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8872     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8873     MOVE PB-SV-STATE            TO PLAN-STATE.
  8874     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8875     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8876     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8877     MOVE WS-SAVE-BENEFIT-REVISION
  8878                                 TO PLAN-REVISION-NO.
  8879
  8880     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8881     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8882
  8883     IF PB-COMPANY-ID = 'NCL'
  8884       IF NOT AH-PLAN-MASTER-FOUND
  8885         IF NOT PB-POLICY-IS-DECLINED  AND
  8886            NOT PB-POLICY-IS-VOIDED
  8887             MOVE  ER-1922         TO  WS-ERROR
  8888             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8889             GO TO 0314-A-H-BENEFIT-FOUND.
  8890
  8891     IF NOT AH-PLAN-MASTER-FOUND
  8892        GO TO 0314-A-H-BENEFIT-FOUND.
  8893
  8894 XXXX-CHECK-AH-PLAN-KEY.
  8895
  8896     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8897        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8898        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8899        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8900        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8901        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8902        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8903        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8904        MOVE 'N'                 TO PLAN-MASTER-SW
  8905          GO TO 03XX-ERPLAN-AH-READ.
  8906
  8907     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8908
  8909     IF  PB-CANCELLATION
  8910         GO TO  0313-AH-ACCT-BEN-FOUND.
  8911
  8912     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8913       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8914          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8915          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8916             MOVE ER-2644             TO WS-ERROR
  8917             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8918          ELSE
  8919             NEXT SENTENCE
  8920       ELSE
  8921          IF PB-COMPANY-ID NOT = 'NCL'
  8922             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 164
* EL050.cbl
  8923                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8924
  8925 0313-AH-ACCT-BEN-FOUND.
  8926
  8927     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8928
  8929     IF PL-DEV-CODE NOT = SPACES
  8930        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8931
  8932     IF PL-DEV-PCT NUMERIC AND
  8933        PL-DEV-PCT NOT = ZEROS
  8934        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8935
  8936     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8937        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8938
  8939     IF PL-TOL-REF-AMT NOT EQUAL +0
  8940        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8941
  8942     IF PL-TOL-PREM-PCT GREATER THAN +0
  8943        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8944
  8945     IF PL-TOL-REF-PCT GREATER THAN +0
  8946        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8947
  8948     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8949        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8950
  8951     IF PL-OVER-SHORT-AMT NUMERIC AND
  8952                          PL-OVER-SHORT-AMT > +0
  8953        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8954
  8955     IF PL-OVER-SHORT-PCT NUMERIC AND
  8956                          PL-OVER-SHORT-PCT > +0
  8957        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8958
  8959     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8960        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8961        IF WS-IG-OVRD-AM EQUAL SPACES
  8962            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8963
  8964 0314-A-H-BENEFIT-FOUND.
  8965
  8966     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8967
  8968     IF PB-ISSUE
  8969        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8970       ELSE
  8971        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8972
  8973     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8974     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8975     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8976     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  8977                                         WS-AH-REFUND-CALC.
  8978
  8979     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8980        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 165
* EL050.cbl
  8981
  8982     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8983        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  8984     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  8985
  8986     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  8987     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  8988     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  8989     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  8990     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  8991     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  8992
  8993     IF PB-COMPANY-ID = 'NCL'  AND
  8994        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8995         NEXT SENTENCE
  8996     ELSE
  8997         IF SUB5 NOT GREATER THAN +20
  8998            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  8999                MOVE WS-SAVE-BENEFIT-REM-TERM
  9000                                      TO WS-AM-AH-BENE-REM-TERM
  9001                                         EC-BR-AH-REM-TERM-CALC.
  9002
  9003     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9004     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9005
  9006     GO TO 0400-FIND-CARRIER.
  9007
  9008 0399-BENEFIT-NOT-FOUND.
  9009
  9010     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9011     MOVE ER-2605                TO WS-ERROR.
  9012     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9013
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 166
* EL050.cbl
  9015
  9016 0400-FIND-CARRIER.
  9017
  9018     MOVE PB-SV-CARRIER          TO WS-CARR.
  9019
  9020     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9021     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9022     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9023     MOVE '6'                    TO CNTL-REC-TYPE.
  9024
  9025*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9026     MOVE SPACE                  TO WS-DMD-RATING-SW
  9027                                    EC-BR-DMD-RATING-SW.
  9028
  9029     MOVE '2'                    TO RC-SW-1.
  9030     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9031
  9032     IF NOT CF-CARRIER-MASTER
  9033        GO TO 0400-CARRIER-NOT-FOUND.
  9034
  9035 0400-BUILD-CARR-TOL.
  9036
  9037     IF CF-CR-TOL-PREM NUMERIC AND
  9038        CF-CR-TOL-PREM GREATER THAN +0
  9039        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9040                                    WS-TOL-AH-PREM.
  9041
  9042     IF CF-CR-TOL-REFUND NUMERIC AND
  9043        CF-CR-TOL-REFUND GREATER THAN +0
  9044        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9045                                    WS-TOL-AH-REFUND.
  9046
  9047     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9048        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9049        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9050                                    WS-AH-REFUND-OVS-AMT.
  9051
  9052     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9053        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9054        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9055                                    WS-AH-REFUND-OVS-PCT.
  9056
  9057     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9058        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9059        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9060                                    WS-TOL-AH-PREM-PCT.
  9061
  9062     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9063        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9064        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9065                                     WS-TOL-AH-REFUND-PCT.
  9066
  9067     IF CF-COMPANY-ID EQUAL 'DMD'
  9068         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9069                                    EC-BR-DMD-RATING-SW.
  9070
  9071     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9072     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 167
* EL050.cbl
  9073        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9074     END-IF
  9075     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9076        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9077     END-IF
  9078     IF WS-TOL-CLP-PCT = ZEROS
  9079        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9080     END-IF
  9081
  9082     IF WS-SPP-LEASE-COMM = ZEROS
  9083        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9084     END-IF
  9085     GO TO 0400-FIND-ERCOMP.
  9086
  9087 0400-CARRIER-NOT-FOUND.
  9088
  9089     MOVE ER-2602                TO WS-ERROR.
  9090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9091
  9092 0400-FIND-ERCOMP.
  9093     IF PB-COMPANY-ID = 'DCC'
  9094        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9095           (WS-SUB1 > +10)
  9096           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9097                 OR 'A' OR 'N'
  9098              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9099              MOVE PB-CARRIER    TO COMP-CARRIER
  9100              MOVE PB-GROUPING   TO COMP-GROUPING
  9101              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9102              MOVE AM-AGT (WS-SUB1)
  9103                                 TO COMP-FIN-RESP
  9104              MOVE 'G'           TO COMP-TYPE
  9105              PERFORM 8582-READ-COMPENSATION-MASTER
  9106                                 THRU 8582-EXIT
  9107              IF COMP-MASTER-FOUND
  9108                 IF CO-GA-INACTIVE
  9109                    MOVE ER-2763 TO WS-ERROR
  9110                    PERFORM 9900-ERROR-FORMAT
  9111                                 THRU 9900-EXIT
  9112                    MOVE +11     TO WS-SUB1
  9113                 END-IF
  9114                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9115                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9116                    MOVE ER-2788 TO WS-ERROR
  9117                    PERFORM 9900-ERROR-FORMAT
  9118                                 THRU 9900-EXIT
  9119                    MOVE +11     TO WS-SUB1
  9120                 END-IF
  9121              END-IF
  9122           END-IF
  9123        END-PERFORM
  9124     END-IF
  9125     IF (PB-COMPANY-ID = 'DCC')
  9126               AND
  9127        ((WS-LF-BEN-CATEGORY = 'D')
  9128        OR (WS-AH-BEN-CATEGORY = 'D')
  9129        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9130        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 168
* EL050.cbl
  9131           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9132                                    WS-CLP-STATE
  9133        ELSE
  9134           MOVE SPACES           TO PB-I-CLP-STATE
  9135                                    WS-CLP-STATE
  9136        END-IF
  9137     END-IF
  9138
  9139     IF (PB-COMPANY-ID = 'DCC')
  9140        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9141        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9142        CONTINUE
  9143     ELSE
  9144        GO TO 0400-FIND-STATE-RECORD
  9145     END-IF
  9146     MOVE SPACES                 TO WS-CLP-STATE
  9147     MOVE +0                     TO WS-BANK-FEE
  9148                                    WS-BANK-LFEE
  9149                                    WS-BANK-NOCHRGB
  9150
  9151     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9152     IF (PB-ISSUE)
  9153        AND (PB-I-BANK-NUMBER NOT =
  9154            SPACES AND ZEROS AND LOW-VALUES)
  9155        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9156     ELSE
  9157        IF (PB-CANCELLATION)
  9158           AND (PB-CI-BANK-NUMBER NOT =
  9159                SPACES AND ZEROS AND LOW-VALUES)
  9160           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9161        END-IF
  9162     END-IF
  9163     IF COMP-FIN-RESP NOT = LOW-VALUES
  9164        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9165        MOVE PB-CARRIER          TO COMP-CARRIER
  9166        MOVE PB-GROUPING         TO COMP-GROUPING
  9167        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9168        MOVE 'B'                 TO COMP-TYPE
  9169        PERFORM 8582-READ-COMPENSATION-MASTER
  9170                                 THRU 8582-EXIT
  9171        IF COMP-MASTER-FOUND
  9172           IF CO-MAX-BANK-FEE NOT NUMERIC
  9173              MOVE +0            TO CO-MAX-BANK-FEE
  9174           END-IF
  9175           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9176              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9177           END-IF
  9178           IF CO-GA-INACTIVE
  9179              MOVE ER-2763       TO WS-ERROR
  9180              PERFORM 9900-ERROR-FORMAT
  9181                                 THRU 9900-EXIT
  9182           END-IF
  9183           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9184              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9185              MOVE ER-2788 TO WS-ERROR
  9186              PERFORM 9900-ERROR-FORMAT
  9187                                 THRU 9900-EXIT
  9188              MOVE +11     TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 169
* EL050.cbl
  9189           END-IF
  9190           IF WS-AH-BEN-CATEGORY = 'G'
  9191              MOVE CO-MAX-BANK-FEE
  9192                                 TO WS-BANK-FEE
  9193                                    PB-I-BANK-FEE
  9194           ELSE
  9195              MOVE CO-MAX-BANK-FEE-LEASE
  9196                                 TO WS-BANK-LFEE
  9197                                    PB-I-BANK-FEE
  9198           END-IF
  9199           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9200              AND (WS-AH-REFUND-CALC = 'G'))
  9201                        OR
  9202              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9203              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9204              CONTINUE
  9205           ELSE
  9206              MOVE ER-2789 TO WS-ERROR
  9207              PERFORM 9900-ERROR-FORMAT
  9208                                 THRU 9900-EXIT
  9209           END-IF
  9210           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9211                                    PB-I-CLP-STATE
  9212           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9213           MOVE CO-CARRIER       TO BXRF-CARRIER
  9214           MOVE CO-GROUPING      TO BXRF-GROUPING
  9215           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9216           MOVE BXRF-MAX-REC-LENGTH
  9217                                 TO BXRF-REC-LENGTH
  9218           PERFORM 8584-READ-BANK-CROSS-REF
  9219                                 THRU 8584-EXIT
  9220           IF BXRF-MASTER-FOUND
  9221              MOVE ' '           TO BANK-ACCT-SW
  9222              MOVE BK-BANK-POINTER-CNT
  9223                                 TO BK-BANK-POINTER-CNT
  9224              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9225                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9226                 OR (BANK-ACCT-FOUND)
  9227                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9228                    AND (BK-AM-EXP-DT (WS-SUB1)
  9229                                 > PB-CERT-EFF-DT)
  9230                    AND (BK-AM-EFF-DT (WS-SUB1)
  9231                                 NOT > PB-CERT-EFF-DT)
  9232                    SET BANK-ACCT-FOUND TO TRUE
  9233                 END-IF
  9234              END-PERFORM
  9235              IF NOT BANK-ACCT-FOUND
  9236                 MOVE ZEROS      TO WS-BANK-FEE
  9237                                    WS-BANK-LFEE
  9238                 MOVE ER-2869    TO WS-ERROR
  9239                 PERFORM 9900-ERROR-FORMAT
  9240                                 THRU 9900-EXIT
  9241              ELSE
  9242                 PERFORM 5000-PROCESS-REPS
  9243                                 THRU 5000-EXIT
  9244                 IF AGENT-MASTER-FOUND
  9245                    MOVE +0      TO WS-BANK-FEE
  9246                                    WS-BANK-LFEE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 170
* EL050.cbl
  9247*                   MOVE AG-SPP-FEES (1)
  9248*                                TO PB-I-BANK-FEE
  9249*                                   WS-BANK-FEE
  9250                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9251                       (WS-SUB1 > +10)
  9252                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9253                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9254                       END-IF
  9255                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9256                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9257                       END-IF
  9258                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9259                          AG-SPP-FEES (WS-SUB1)
  9260                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9261                          AG-SPP-LFEES (WS-SUB1)
  9262                    END-PERFORM
  9263                    IF WS-AH-BEN-CATEGORY = 'G'
  9264                       MOVE WS-BANK-FEE
  9265                                 TO PB-I-BANK-FEE
  9266                    ELSE
  9267                       MOVE WS-BANK-LFEE
  9268                                 TO PB-I-BANK-FEE
  9269                    END-IF
  9270                 END-IF
  9271              END-IF
  9272           END-IF
  9273        ELSE
  9274           MOVE ER-2879          TO WS-ERROR
  9275           PERFORM 9900-ERROR-FORMAT
  9276                                 THRU 9900-EXIT
  9277        END-IF
  9278     ELSE
  9279        MOVE ER-2879             TO WS-ERROR
  9280        PERFORM 9900-ERROR-FORMAT
  9281                                 THRU 9900-EXIT
  9282     END-IF
  9283     IF WS-AH-BEN-CATEGORY = 'G'
  9284        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9285        + WS-BANK-FEE
  9286     ELSE
  9287        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9288        + WS-BANK-LFEE
  9289     END-IF
  9290     .
  9291 0400-FIND-STATE-RECORD.
  9292
  9293     IF WK-STATE-ADDR NOT = ZEROS
  9294         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9295         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9296         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9297         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9298         IF PB-SV-STATE = CF-STATE-CODE
  9299             GO TO 0405-CONTINUE-EDIT
  9300         ELSE
  9301             NEXT SENTENCE
  9302     ELSE
  9303         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9304
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 171
* EL050.cbl
  9305     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9306     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9307     MOVE '3'                    TO CNTL-REC-TYPE.
  9308     MOVE +0                     TO CNTL-SEQ-NO.
  9309
  9310     MOVE '3'                    TO RC-SW-2.
  9311     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9312
  9313     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9314        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9315        PB-SV-STATE   NOT = CF-STATE-CODE)
  9316        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9317                                    WS-TOL-AH-CLAIM
  9318                                    WS-MINIMUM-REFUND
  9319                                    WS-TOL-LF-PREM
  9320                                    WS-TOL-AH-PREM
  9321                                    WS-TOL-LF-REFUND
  9322                                    WS-TOL-AH-REFUND
  9323                                    EC-ST-TOL-PREM-PCT
  9324                                    WS-TOL-LF-PREM-PCT
  9325                                    WS-TOL-AH-PREM-PCT
  9326                                    EC-ST-TOL-REFUND-PCT
  9327                                    WS-TOL-LF-REFUND-PCT
  9328                                    WS-TOL-AH-REFUND-PCT
  9329                                    EC-ST-TOL-PREM
  9330                                    EC-ST-TOL-REFUND
  9331                                    EC-ST-FST-PMT-DAYS-MAX
  9332                                    WS-FREE-LOOK-PERIOD
  9333                                    WS-ST-LF-PREM-TAX
  9334                                    WS-ST-AH-PREM-TAX-I
  9335                                    WS-ST-AH-PREM-TAX-G
  9336                                    WS-BANK-FEE
  9337                                    WS-BANK-LFEE
  9338                                    WS-TOL-CLP-PCT
  9339                                    WS-SPP-LEASE-COMM
  9340        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9341                                    EC-ST-FST-PMT-DAYS-CHG
  9342                                    WS-LF-REM-TERM-CALC
  9343                                    WS-LF-REFUND-CALC
  9344                                    EC-ST-LF-REM-TERM-CALC
  9345                                    EC-ST-LF-REFUND-CALC
  9346                                    WS-AH-REM-TERM-CALC
  9347                                    WS-AH-REFUND-CALC
  9348                                    WS-LF-BEN-CATEGORY
  9349                                    WS-AH-BEN-CATEGORY
  9350                                    WS-CLP-STATE
  9351                                    WS-ST-REFUND-CLAIM-FLAG
  9352                                    EC-ST-AH-REM-TERM-CALC
  9353                                    EC-ST-AH-REFUND-CALC
  9354          GO TO 0499-STATE-NOT-FOUND.
  9355
  9356     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9357
  9358 0405-CONTINUE-EDIT.
  9359
  9360     IF PB-CERT-PRIME NOT NUMERIC
  9361        MOVE ER-2722             TO WS-ERROR
  9362        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 172
* EL050.cbl
  9363                                 THRU 9900-EXIT
  9364     END-IF
  9365*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9366*       MOVE +0                  TO SUB3
  9367*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9368*       IF SUB3 > +0
  9369*          MOVE ER-2722          TO WS-ERROR
  9370*          PERFORM 9900-ERROR-FORMAT
  9371*                                THRU 9900-EXIT
  9372*       END-IF
  9373*    END-IF
  9374*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9375*       IF PB-CERT-PRIME NOT NUMERIC
  9376*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9377*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9378*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9379*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9380*
  9381*          MOVE ER-2722          TO WS-ERROR
  9382*          PERFORM 9900-ERROR-FORMAT
  9383*                                THRU 9900-EXIT
  9384*       END-IF
  9385*    END-IF
  9386
  9387     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9388
  9389     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9390        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9391                                    WS-TOL-AH-CLAIM.
  9392
  9393     IF CF-ST-REFUND-MIN NOT NUMERIC
  9394        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9395
  9396     IF CF-ST-REFUND-MIN NOT = ZEROS
  9397        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9398
  9399     IF CF-ST-TOL-PREM  NOT = ZEROS
  9400        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9401                                    WS-TOL-AH-PREM
  9402        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9403
  9404     IF CF-ST-TOL-REFUND NOT = ZEROS
  9405        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9406                                    WS-TOL-AH-REFUND
  9407        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9408
  9409     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9410        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9411        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9412                                    WS-AH-REFUND-OVS-AMT
  9413                                    EC-ST-OVR-SHT-AMT.
  9414
  9415     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9416        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9417        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9418                                    WS-TOL-LF-PREM-PCT
  9419                                    WS-TOL-AH-PREM-PCT.
  9420
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 173
* EL050.cbl
  9421     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9422        CF-ST-TOL-REF-PCT GREATER THAN +0
  9423        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9424                                    WS-TOL-LF-REFUND-PCT
  9425                                    WS-TOL-AH-REFUND-PCT.
  9426
  9427     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9428        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9429        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9430                                    WS-AH-REFUND-OVS-PCT
  9431                                    EC-ST-OVR-SHT-PCT.
  9432
  9433     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9434     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9435
  9436     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9437          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9438
  9439     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9440     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9441     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9442
  9443     IF CF-ST-LF-PREM-TAX NUMERIC
  9444        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9445     END-IF
  9446     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9447        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9448     END-IF
  9449     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9450        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9451     END-IF
  9452
  9453     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9454         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9455     END-IF.
  9456
  9457     IF WS-LF-BENEFIT-CD = ZEROS
  9458        GO TO 0410-CHECK-AH.
  9459
  9460     IF CF-ST-RT-CALC NOT = SPACES
  9461        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9462                                    EC-ST-LF-REM-TERM-CALC
  9463     END-IF
  9464
  9465     IF WS-LF-COVERAGE-TYPE = 'R'
  9466        IF WS-LF-EARNINGS-CALC = '5'
  9467           IF CF-ST-RF-LN-CALC > '0'
  9468              MOVE CF-ST-RF-LN-CALC
  9469                                 TO WS-LF-REFUND-CALC
  9470                                    EC-ST-LF-REFUND-CALC
  9471           END-IF
  9472        ELSE
  9473           IF CF-ST-RF-LR-CALC > '0'
  9474              MOVE CF-ST-RF-LR-CALC
  9475                                 TO WS-LF-REFUND-CALC
  9476                                    EC-ST-LF-REFUND-CALC
  9477           END-IF
  9478        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 174
* EL050.cbl
  9479     ELSE
  9480        IF CF-ST-RF-LL-CALC > '0'
  9481           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9482                                    EC-ST-LF-REFUND-CALC
  9483        END-IF
  9484     END-IF
  9485
  9486     IF CF-ST-RT-CALC NOT = SPACES
  9487        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9488                                    EC-ST-LF-REM-TERM-CALC
  9489     END-IF
  9490
  9491     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9492     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9493
  9494     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9495
  9496     IF NO-BENEFIT-FOUND
  9497        GO TO 0410-CHECK-AH.
  9498
  9499     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9500        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9501                                 TO EC-ST-LF-REM-TERM-CALC
  9502                                    WS-LF-REM-TERM-CALC
  9503     END-IF
  9504
  9505     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9506        MOVE CF-ST-REFUND-CALC (SUB3)
  9507                                 TO WS-LF-REFUND-CALC
  9508                                    EC-ST-LF-REFUND-CALC
  9509     END-IF
  9510*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9511
  9512     .
  9513 0410-CHECK-AH.
  9514
  9515     IF WS-AH-BENEFIT-CD = ZEROS
  9516        GO TO 0500-SET-ACCOUNT.
  9517
  9518     IF CF-ST-RT-CALC NOT = SPACES
  9519        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9520                                    EC-ST-AH-REM-TERM-CALC
  9521     END-IF
  9522
  9523     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9524        IF CF-ST-RF-CP-CALC > '0'
  9525           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9526                                    EC-ST-AH-REFUND-CALC
  9527        END-IF
  9528     ELSE
  9529        IF CF-ST-RF-AH-CALC > '0'
  9530           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9531                                    EC-ST-AH-REFUND-CALC
  9532        END-IF
  9533     END-IF
  9534     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9535     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9536
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 175
* EL050.cbl
  9537     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9538
  9539     IF NO-BENEFIT-FOUND
  9540        GO TO 0500-SET-ACCOUNT.
  9541
  9542     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9543        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9544                                 TO WS-AH-REM-TERM-CALC
  9545                                    EC-ST-AH-REM-TERM-CALC
  9546     END-IF
  9547
  9548     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9549        MOVE CF-ST-REFUND-CALC (SUB3)
  9550                                 TO WS-AH-REFUND-CALC
  9551                                    EC-ST-AH-REFUND-CALC
  9552     END-IF
  9553
  9554*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9555
  9556     GO TO 0500-SET-ACCOUNT.
  9557
  9558 0499-STATE-NOT-FOUND.
  9559
  9560     MOVE ER-2603                TO WS-ERROR.
  9561     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9562
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 176
* EL050.cbl
  9564
  9565 0500-SET-ACCOUNT.
  9566*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9567     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9568        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9569        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9570        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9571        MOVE '3'                 TO CNTL-REC-TYPE
  9572        MOVE +0                  TO CNTL-SEQ-NO
  9573
  9574        MOVE '3'                 TO RC-SW-2
  9575        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9576
  9577        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9578           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9579           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9580           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9581                                    WS-ST-AH-PREM-TAX-I
  9582                                    WS-ST-AH-PREM-TAX-G
  9583        ELSE
  9584           IF CF-ST-LF-PREM-TAX NUMERIC
  9585              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9586           END-IF
  9587           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9588              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9589           END-IF
  9590           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9591              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9592           END-IF
  9593        END-IF
  9594        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9595     END-IF
  9596*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9597*  FOR DCC ONLY
  9598     IF PB-COMPANY-ID = 'DCC'
  9599
  9600     MOVE ' '                    TO STAT-MASTER-SW
  9601     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9602     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9603     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9604     MOVE PB-STATE               TO ELSTAT-STATE
  9605     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9606        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9607     END-IF
  9608
  9609     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9610     SET BIN-TO-GREG             TO TRUE
  9611     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9612     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9613     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9614
  9615     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9616     IF STAT-MASTER-FOUND
  9617        MOVE 'N'                 TO STAT-MASTER-SW
  9618        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9619        IF STAT-MASTER-FOUND
  9620           IF (ELSTAT-KEY-SAVE (1:12) =
  9621                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 177
* EL050.cbl
  9622              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9623                 MOVE 'F'        TO STAT-MASTER-SW
  9624              ELSE
  9625                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9626                 IF (STAT-MASTER-FOUND)
  9627                    AND (ELSTAT-KEY-SAVE (1:12) =
  9628                        SF-CONTROL-PRIMARY (1:12))
  9629                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9630                    MOVE 'F'     TO STAT-MASTER-SW
  9631                 END-IF
  9632              END-IF
  9633           END-IF
  9634        END-IF
  9635     END-IF
  9636
  9637     IF STAT-MASTER-SW = 'F'
  9638        IF SF-ST-LF-PREM-TAX NUMERIC
  9639           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9640        END-IF
  9641        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9642           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9643        END-IF
  9644        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9645           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9646        END-IF
  9647     END-IF
  9648
  9649     END-IF
  9650     IF (PB-COMPANY-ID = 'DCC')
  9651        AND (PB-ISSUE)
  9652        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9653        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9654        AND (AM-GPCD = 06)
  9655        MOVE 'Y'                 TO WS-GOOD-HIN
  9656        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9657           MOVE PB-I-VIN         TO WS-WORK-VIN
  9658           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9659              (V1 > 16)
  9660              IF WS-WORK-VIN (V1:1) NUMERIC
  9661                 MOVE WS-WORK-VIN-N (V1)
  9662                                 TO WS-ROW-B-VAL (V1)
  9663              ELSE
  9664                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9665                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9666                    OR (V2 > 26)
  9667                 END-PERFORM
  9668                 IF V2 < 27
  9669                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9670                 ELSE
  9671                    MOVE 'N'     TO WS-GOOD-HIN
  9672                 END-IF
  9673              END-IF
  9674              COMPUTE WS-ROW-D-VAL (V1) =
  9675                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9676              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9677                 WS-ROW-D-VAL (V1)
  9678           END-PERFORM
  9679           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 178
* EL050.cbl
  9680           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9681             REMAINDER WS-VIN-REMAINDER
  9682           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9683              CONTINUE
  9684           ELSE
  9685              MOVE 'N'           TO WS-GOOD-HIN
  9686           END-IF
  9687        ELSE
  9688           MOVE 'N'              TO WS-GOOD-HIN
  9689        END-IF
  9690        IF WS-GOOD-HIN NOT = 'Y'
  9691           MOVE ER-3826           TO WS-ERROR
  9692           PERFORM 9900-ERROR-FORMAT
  9693                                 THRU 9900-EXIT
  9694        END-IF
  9695     END-IF
  9696     IF (PB-COMPANY-ID = 'DCC')
  9697        AND (PB-ISSUE)
  9698        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9699        AND (AM-GPCD NOT = 06)
  9700        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9701          MOVE PB-I-VIN          TO WS-WORK-VIN
  9702          MOVE +8                TO V2
  9703          MOVE ZEROS             TO WS-VIN-TOTAL
  9704          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9705           (V1 > 17)
  9706             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9707                MOVE ER-3825     TO WS-ERROR
  9708                PERFORM 9900-ERROR-FORMAT
  9709                                 THRU 9900-EXIT
  9710             ELSE
  9711                IF V1 = 8
  9712                   MOVE 10       TO V2
  9713                END-IF
  9714                IF V1 = 9
  9715                   MOVE 0        TO V2
  9716                END-IF
  9717                IF V1 = 10
  9718                   MOVE 9        TO V2
  9719                END-IF
  9720                IF WS-WORK-VIN (V1:1) NUMERIC
  9721                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9722                    + (WS-WORK-VIN-N (V1) * V2)
  9723                ELSE
  9724                   MOVE WS-WORK-VIN (V1:1)
  9725                                 TO WS-HEX-BYTE
  9726                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9727                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9728                    + (WS-NUM (V3) * V2)
  9729                END-IF
  9730                COMPUTE V2 = V2 - 1
  9731             END-IF
  9732          END-PERFORM
  9733          MOVE ZEROS TO WS-VIN-REMAINDER
  9734          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9735             REMAINDER WS-VIN-REMAINDER
  9736          IF ((WS-WORK-VIN (9:1) = 'X')
  9737             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 179
* EL050.cbl
  9738                     OR
  9739             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9740             CONTINUE
  9741          ELSE
  9742             MOVE ER-3826        TO WS-ERROR
  9743             PERFORM 9900-ERROR-FORMAT
  9744                                 THRU 9900-EXIT
  9745          END-IF
  9746        ELSE
  9747          MOVE ER-3826           TO WS-ERROR
  9748          PERFORM 9900-ERROR-FORMAT
  9749                                 THRU 9900-EXIT
  9750        END-IF
  9751     END-IF
  9752******************************************************************
  9753******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9754******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9755******* METHODS.
  9756******************************************************************
  9757     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9758        IF PB-CANCELLATION
  9759           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9760              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9761                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9762                IF FORM-MASTER-FOUND
  9763                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9764******************************************************************
  9765
  9766     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9767     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9768
  9769     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9770     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9771     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9772     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9773
  9774
  9775     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9776     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9777     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9778
  9779     IF AM-LF-OB-RATE NOT NUMERIC
  9780         MOVE ZERO               TO AM-LF-OB-RATE.
  9781
  9782     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9783         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9784
  9785     IF AM-AH-OB-RATE NOT NUMERIC
  9786         MOVE ZERO               TO AM-AH-OB-RATE.
  9787
  9788     IF WS-LF-JOINT-INDICATOR = 'J'
  9789         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9790     ELSE
  9791         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9792
  9793     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9794
  9795     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 180
* EL050.cbl
  9796         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9797
  9798     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9799         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9800                                       WS-IG-OVRD
  9801     ELSE
  9802         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9803             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9804                                       WS-IG-OVRD
  9805         ELSE
  9806             MOVE AM-IG             TO WS-IG-OVRD-AH
  9807                                       WS-IG-OVRD.
  9808
  9809     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9810         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9811                                       WS-IG-OVRD
  9812     ELSE
  9813         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9814             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9815                                       WS-IG-OVRD
  9816         ELSE
  9817             MOVE AM-IG             TO WS-IG-OVRD-LF
  9818                                       WS-IG-OVRD.
  9819
  9820     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9821     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9822     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9823     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9824     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9825
  9826     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9827     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9828     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9829     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9830
  9831     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9832     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9833     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9834     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9835     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9836     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9837     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9838
  9839     IF WS-ACCT-AH-DEV-PCT > +0
  9840        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9841     ELSE
  9842        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9843
  9844     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9845        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9846     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9847        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9848
  9849        IF AM-EARN-METHOD-L = 'S'
  9850            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9851                                        WS-LF-REFUND-CALC.
  9852
  9853        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 181
* EL050.cbl
  9854            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9855                                        WS-LF-REFUND-CALC.
  9856
  9857     IF WS-LF-COVERAGE-TYPE = 'R'
  9858         IF AM-EARN-METHOD-R = 'R'
  9859            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9860                                    WS-LF-REFUND-CALC.
  9861     IF WS-LF-COVERAGE-TYPE = 'R'
  9862         IF AM-EARN-METHOD-R = 'P'
  9863            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9864                                    WS-LF-REFUND-CALC.
  9865     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9866         IF AM-EARN-METHOD-L = 'R'
  9867            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9868                                    WS-LF-REFUND-CALC.
  9869     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9870         IF AM-EARN-METHOD-L = 'P'
  9871            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9872                                    WS-LF-REFUND-CALC.
  9873     IF WS-LF-COVERAGE-TYPE = 'R'
  9874         IF AM-EARN-METHOD-R = 'A'
  9875            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9876                                    WS-LF-REFUND-CALC.
  9877     IF WS-LF-COVERAGE-TYPE = 'R'
  9878         IF AM-EARN-METHOD-R = 'M'
  9879            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9880                                    WS-LF-REFUND-CALC.
  9881     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9882         IF AM-EARN-METHOD-L = 'A'
  9883            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9884                                    WS-LF-REFUND-CALC.
  9885     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9886         IF AM-EARN-METHOD-L = 'M'
  9887            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9888                                    WS-LF-REFUND-CALC.
  9889
  9890     IF AM-EARN-METHOD-A = 'R'
  9891        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9892                                    WS-AH-REFUND-CALC.
  9893     IF AM-EARN-METHOD-A = 'P'
  9894        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9895                                    WS-AH-REFUND-CALC.
  9896     IF AM-EARN-METHOD-A = 'C'
  9897        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9898                                    WS-AH-REFUND-CALC.
  9899     IF AM-EARN-METHOD-A = 'A'
  9900        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9901                                    WS-AH-REFUND-CALC.
  9902     IF AM-EARN-METHOD-A = 'M'
  9903        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9904                                    WS-AH-REFUND-CALC.
  9905     IF AM-EARN-METHOD-A = 'N'
  9906        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9907                                    WS-AH-REFUND-CALC.
  9908     IF AM-EARN-METHOD-A = 'S'
  9909        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9910                                    WS-AH-REFUND-CALC.
  9911
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 182
* EL050.cbl
  9912     IF AM-TOL-PREM NOT = ZEROS
  9913        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9914                                    WS-TOL-AH-PREM.
  9915
  9916     IF AM-OVR-SHT-AMT NUMERIC AND
  9917                  AM-OVR-SHT-AMT > 0
  9918        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9919                                    EC-AM-LF-OVR-SHT-AMT
  9920                                    WS-AH-REFUND-OVS-AMT
  9921                                    EC-AM-AH-OVR-SHT-AMT.
  9922
  9923     IF AM-OVR-SHT-PCT NUMERIC AND
  9924                    AM-OVR-SHT-PCT > 0
  9925        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9926                                    EC-AM-LF-OVR-SHT-PCT
  9927                                    WS-AH-REFUND-OVS-PCT
  9928                                    EC-AM-AH-OVR-SHT-PCT.
  9929
  9930     IF AM-TOL-REF-PCT NUMERIC AND
  9931                  AM-TOL-REF-PCT > 0
  9932        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
  9933                                    WS-TOL-AH-REFUND-PCT.
  9934
  9935     IF AM-TOL-REF  NOT = ZEROS  AND
  9936                  AM-TOL-REF NUMERIC
  9937        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
  9938                                    EC-AM-LF-TOL-REFUND
  9939                                    WS-TOL-AH-REFUND
  9940                                    EC-AM-AH-TOL-REFUND.
  9941
  9942     IF AM-TOL-CLM  NOT = ZEROS
  9943        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
  9944                                    WS-TOL-AH-CLAIM.
  9945
  9946     IF AM-CLP-TOL-PCT NOT NUMERIC
  9947        MOVE +0                  TO AM-CLP-TOL-PCT
  9948     END-IF
  9949
  9950     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9951        MOVE +0                  TO AM-SPP-LEASE-COMM
  9952     END-IF
  9953     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
  9954        MOVE WS-PL-TOL-LF-PREM-PCT
  9955                                 TO WS-TOL-LF-PREM-PCT.
  9956
  9957     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
  9958        MOVE WS-PL-TOL-AH-PREM-PCT
  9959                                 TO WS-TOL-AH-PREM-PCT.
  9960
  9961     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
  9962        MOVE WS-PL-TOL-LF-REFUND-PCT
  9963                                 TO WS-TOL-LF-REFUND-PCT.
  9964
  9965     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
  9966        MOVE WS-PL-TOL-AH-REFUND-PCT
  9967                                 TO WS-TOL-AH-REFUND-PCT.
  9968
  9969     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 183
* EL050.cbl
  9970        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
  9971
  9972     IF WS-PL-REF-OVS-PCT > +0
  9973        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
  9974
  9975     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
  9976        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
  9977     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
  9978        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
  9979     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
  9980        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
  9981     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
  9982        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
  9983     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
  9984        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
  9985     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
  9986        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
  9987
  9988     IF WS-AH-PL-REF-OVS-AMT > +0
  9989        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
  9990
  9991     IF WS-AH-PL-REF-OVS-PCT > +0
  9992        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
  9993
  9994     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
  9995     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
  9996
  9997     IF PB-CANCELLATION
  9998        GO TO 3000-CONTINUE-EDIT.
  9999
 10000     MOVE +1 TO SUB1.
 10001     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10002     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10003
 10004     IF CF-COMPANY-ID = 'DMD'
 10005       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10006         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10007        ELSE
 10008         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10009
 10010  0525-FIND-ACCT-COMM.
 10011     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10012        NEXT SENTENCE
 10013      ELSE
 10014         ADD +1 TO SUB1
 10015         IF SUB1 LESS +11
 10016            GO TO 0525-FIND-ACCT-COMM
 10017          ELSE
 10018             GO TO 0560-EDIT-CONTINUE.
 10019
 10020     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10021     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10022                                    PB-I-LIFE-COMMISSION.
 10023***  IF PB-COMPANY-ID = 'CRI'
 10024     IF PB-PREM-ACCTNG-ONLY
 10025         GO TO 0560-EDIT-CONTINUE.
 10026
 10027     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 184
* EL050.cbl
 10028     MOVE ' '    TO WS-CTBL-READ-SW.
 10029
 10030
 10031 0530-GET-AH-COMP.
 10032     IF NO-AH-COVERAGE  OR
 10033        NO-AH-BENEFIT-MATCH
 10034           GO TO 0540-NEXT-READ-STEP.
 10035
 10036     IF AM-A-COM (SUB1) NUMERIC
 10037        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10038         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10039         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10040         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10041         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10042     ELSE
 10043          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10044          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10045          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10046          MOVE ZEROS             TO WS-SUB1
 10047                                    WS-COMMISSION
 10048          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10049          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10050          IF WS-COMMISSION > ZEROS
 10051             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10052             GO TO 0540-NEXT-READ-STEP
 10053          END-IF
 10054          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10055          IF CTBL-TABLE-FOUND
 10056             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10057                                        PB-I-AH-TERM
 10058             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10059             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10060             GO TO 0540-NEXT-READ-STEP
 10061          ELSE
 10062             IF FIRST-TIME-THROUGH
 10063                 GO TO 0530-GET-AH-COMP
 10064             ELSE
 10065                 MOVE ER-2609                TO WS-ERROR
 10066                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10067
 10068 0540-NEXT-READ-STEP.
 10069     MOVE '0540' TO CTBL-SW.
 10070     MOVE ' '    TO WS-CTBL-READ-SW.
 10071
 10072 0540-GET-LF-COMP.
 10073     IF NO-LIFE-COVERAGE  OR
 10074        NO-LF-BENEFIT-MATCH
 10075           GO TO 0560-EDIT-CONTINUE.
 10076
 10077     IF WS-LF-JOINT-INDICATOR = 'J'
 10078        IF AM-J-COM (SUB1) NUMERIC
 10079           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10080           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10081           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10082           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10083           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10084        ELSE
 10085           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 185
* EL050.cbl
 10086           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10087           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10088           MOVE ZEROS                TO WS-SUB1
 10089                                        WS-COMMISSION
 10090           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10091           IF WS-COMMISSION > ZEROS
 10092              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10093              GO TO 0560-EDIT-CONTINUE
 10094           END-IF
 10095           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10096           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10097           IF CTBL-TABLE-FOUND
 10098              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10099              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10100              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10101              GO TO 0560-EDIT-CONTINUE
 10102           ELSE
 10103              IF FIRST-TIME-THROUGH
 10104                  GO TO 0540-GET-LF-COMP
 10105              ELSE
 10106                  MOVE ER-2609                TO WS-ERROR
 10107                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10108                  GO TO 0560-EDIT-CONTINUE.
 10109
 10110     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10111        IF AM-L-COM (SUB1) NUMERIC
 10112           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10113           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10114           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10115           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10116           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10117        ELSE
 10118           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10119           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10120           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10121           MOVE ZEROS                TO WS-SUB1
 10122                                        WS-COMMISSION
 10123           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10124           IF WS-COMMISSION IS GREATER THAN ZEROS
 10125              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10126              GO TO 0560-EDIT-CONTINUE
 10127           END-IF
 10128           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10129           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10130           IF CTBL-TABLE-FOUND
 10131              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10132              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10133              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10134              GO TO 0560-EDIT-CONTINUE
 10135           ELSE
 10136              IF FIRST-TIME-THROUGH
 10137                  GO TO 0540-GET-LF-COMP
 10138              ELSE
 10139                  MOVE ER-2609                TO WS-ERROR
 10140                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10141
 10142*    GO TO 0560-EDIT-CONTINUE.
 10143
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 186
* EL050.cbl
 10144 0560-EDIT-CONTINUE.
 10145     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10146                                    WS-AH-PMF-COMM
 10147*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10148*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10149     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10150        (SUB1 > +10)
 10151        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10152           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10153           MOVE '0530'           TO CTBL-SW
 10154           MOVE ' '              TO WS-CTBL-READ-SW
 10155           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10156           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10157           MOVE '0540'           TO CTBL-SW
 10158           MOVE ' '              TO WS-CTBL-READ-SW
 10159           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10160        END-IF
 10161     END-PERFORM
 10162     GO TO 0564-EDIT-CONTINUE
 10163     .
 10164 0561-CHECK-AH.
 10165     IF (NO-AH-COVERAGE)
 10166        OR (NO-AH-BENEFIT-MATCH)
 10167        CONTINUE
 10168     ELSE
 10169        IF (AM-A-COM (SUB1) NUMERIC)
 10170           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10171           IF (AM-COM-TYP (SUB1) = 'A')
 10172              AND (WS-AH-PMF-COMM = ZEROS)
 10173              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10174           END-IF
 10175           CONTINUE
 10176        ELSE
 10177           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10178           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10179           MOVE PB-AH-OVERRIDE-L1
 10180                                 TO CTBL-BEN-TYPE
 10181           MOVE ZEROS            TO WS-SUB1
 10182                                    WS-COMMISSION
 10183           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10184           PERFORM 8300-READ-CTBL-TABLE
 10185                                 THRU 8300-EXIT
 10186           IF CTBL-TABLE-FOUND
 10187              IF (AM-COM-TYP (SUB1) = 'A')
 10188                 AND (WS-AH-PMF-COMM = ZEROS)
 10189                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10190                                        PB-I-AH-TERM
 10191                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10192                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10193              END-IF
 10194              CONTINUE
 10195           ELSE
 10196              IF FIRST-TIME-THROUGH
 10197                 GO TO 0561-CHECK-AH
 10198              ELSE
 10199                 MOVE ER-2609    TO WS-ERROR
 10200                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10201              END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 187
* EL050.cbl
 10202           END-IF
 10203        END-IF
 10204     END-IF
 10205     .
 10206 0561-EXIT.
 10207     EXIT.
 10208 0563-CHECK-LF.
 10209     IF (NO-LIFE-COVERAGE)
 10210        OR (NO-LF-BENEFIT-MATCH)
 10211        CONTINUE
 10212     ELSE
 10213        IF WS-LF-JOINT-INDICATOR = 'J'
 10214           IF AM-J-COM (SUB1) NUMERIC
 10215              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10216              IF (AM-COM-TYP (SUB1) = 'A')
 10217                 AND (WS-LF-PMF-COMM = ZEROS)
 10218                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10219              END-IF
 10220              CONTINUE
 10221           ELSE
 10222              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10223              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10224              MOVE PB-LIFE-OVERRIDE-L1
 10225                                 TO CTBL-BEN-TYPE
 10226              MOVE ZEROS         TO WS-SUB1
 10227                                    WS-COMMISSION
 10228              MOVE AM-J-COMA (SUB1)
 10229                                 TO CTBL-TABLE
 10230              PERFORM 8300-READ-CTBL-TABLE
 10231                                 THRU 8300-EXIT
 10232              IF CTBL-TABLE-FOUND
 10233                 IF (AM-COM-TYP (SUB1) = 'A')
 10234                    AND (WS-LF-PMF-COMM = ZEROS)
 10235                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10236                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10237                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10238                 END-IF
 10239                 CONTINUE
 10240              ELSE
 10241                 IF FIRST-TIME-THROUGH
 10242                    GO TO 0563-CHECK-LF
 10243                 ELSE
 10244                    MOVE ER-2609 TO WS-ERROR
 10245                    PERFORM 9900-ERROR-FORMAT
 10246                                 THRU 9900-EXIT
 10247*                   GO TO 0560-EDIT-CONTINUE
 10248                 END-IF
 10249              END-IF
 10250           END-IF
 10251        ELSE
 10252           IF AM-L-COM (SUB1) NUMERIC
 10253              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10254              IF (AM-COM-TYP (SUB1) = 'A')
 10255                 AND (WS-LF-PMF-COMM = ZEROS)
 10256                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10257              END-IF
 10258              CONTINUE
 10259           ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 188
* EL050.cbl
 10260              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10261              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10262              MOVE PB-LIFE-OVERRIDE-L1
 10263                                 TO CTBL-BEN-TYPE
 10264              MOVE ZEROS         TO WS-SUB1
 10265                                    WS-COMMISSION
 10266              MOVE AM-L-COMA (SUB1)
 10267                                 TO CTBL-TABLE
 10268              PERFORM 8300-READ-CTBL-TABLE
 10269                                 THRU 8300-EXIT
 10270              IF CTBL-TABLE-FOUND
 10271                 CONTINUE
 10272              ELSE
 10273                 IF FIRST-TIME-THROUGH
 10274                    GO TO 0563-CHECK-LF
 10275                 ELSE
 10276                    MOVE ER-2609 TO WS-ERROR
 10277                    PERFORM 9900-ERROR-FORMAT
 10278                                 THRU 9900-EXIT
 10279                 END-IF
 10280              END-IF
 10281           END-IF
 10282        END-IF
 10283     END-IF
 10284     .
 10285 0563-EXIT.
 10286     EXIT.
 10287 0564-EDIT-CONTINUE.
 10288
 10289     IF  PB-COMPANY-ID EQUAL 'DMD'
 10290         IF PB-I-NUM-BILLED EQUAL ZEROS
 10291            MOVE ER-8148       TO WS-ERROR
 10292            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10293
 10294*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10295*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10296*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10297*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10298*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10299*         IF NO-CONVERSION-ERROR
 10300*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10301*         ELSE
 10302*             IF PB-COMPANY-ID EQUAL 'HAN'
 10303*                 MOVE ZEROS     TO PB-I-AGE.
 10304     IF PB-I-BIRTHDAY > LOW-VALUES
 10305        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10306        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10307        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10308        PERFORM 8500-DATE-CONVERT
 10309                                 THRU 8500-EXIT
 10310        IF NO-CONVERSION-ERROR
 10311           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10312           IF PB-I-AGE > ZEROS
 10313              IF WS-WORK-AGE NOT = PB-I-AGE
 10314                 MOVE ER-9501    TO WS-ERROR
 10315                 PERFORM 9900-ERROR-FORMAT
 10316                                 THRU 9900-EXIT
 10317              END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 189
* EL050.cbl
 10318           ELSE
 10319              MOVE WS-WORK-AGE   TO PB-I-AGE
 10320           END-IF
 10321        END-IF
 10322     END-IF
 10323     IF PB-I-AGE = ZEROS
 10324        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10325           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10326
 10327     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10328                                   WS-AH-EDIT-AGE.
 10329
 10330     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10331        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10332        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10333        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10334        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10335        IF NO-CONVERSION-ERROR
 10336           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10337           IF PB-I-JOINT-AGE > 0
 10338              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10339                 MOVE ER-9503    TO WS-ERROR
 10340                 PERFORM 9900-ERROR-FORMAT
 10341                                 THRU 9900-EXIT
 10342              END-IF
 10343           ELSE
 10344              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10345           END-IF
 10346        ELSE
 10347           MOVE ZEROS            TO PB-I-JOINT-AGE
 10348        END-IF
 10349     END-IF
 10350     IF PB-I-JOINT-AGE NOT NUMERIC
 10351        MOVE ZERO               TO PB-I-JOINT-AGE.
 10352
 10353     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC'
 10354        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10355           (WS-AH-JOINT-INDICATOR = 'J')
 10356           IF PB-I-JOINT-AGE = ZEROS
 10357               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10358           END-IF
 10359        END-IF
 10360     END-IF
 10361
 10362     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10363     IF WS-LF-JOINT-INDICATOR = 'J'
 10364        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10365        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10366            IF  PB-I-JOINT-AGE = ZERO
 10367                MOVE ER-2686       TO WS-ERROR
 10368                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10369            ELSE
 10370                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10371                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10372                    IF PB-COMPANY-ID NOT = 'LBL'
 10373                        MOVE ER-2685    TO WS-ERROR
 10374                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10375
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 190
* EL050.cbl
 10376     IF WS-AH-JOINT-INDICATOR = 'J'
 10377        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10378            IF  PB-I-JOINT-AGE = ZERO
 10379                MOVE ER-2686       TO WS-ERROR
 10380                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10381            ELSE
 10382                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10383                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10384                                           WS-EDIT-AGE
 10385                    IF PB-COMPANY-ID NOT = 'LBL'
 10386                        MOVE ER-2685    TO WS-ERROR
 10387                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10388
 10389******************************************************************
 10390*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10391******************************************************************
 10392
 10393     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10394        (WS-AH-SPECIAL-CALC-CD = 'O')
 10395        NEXT SENTENCE
 10396     ELSE
 10397        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10398          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10399           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10400            WS-AH-JOINT-INDICATOR = 'J')  AND
 10401           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10402            MOVE ER-2627             TO WS-ERROR
 10403            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10404
 10405     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10406        (WS-AH-SPECIAL-CALC-CD = 'O')
 10407         NEXT SENTENCE
 10408     ELSE
 10409         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10410            WS-AH-JOINT-INDICATOR = 'J'
 10411             IF PB-I-JOINT-INSURED = SPACES
 10412                 IF PB-COMPANY-ID NOT = 'JAL'
 10413                     MOVE ER-2696    TO WS-ERROR
 10414                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10415
 10416     IF PB-COMPANY-ID NOT = 'BOA'
 10417        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10418           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10419           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10420               PB-I-JOINT-INSURED NOT = SPACES)
 10421                MOVE ER-2691         TO WS-ERROR
 10422                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10423
 10424     IF PB-COMPANY-ID = 'BOA'
 10425        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10426           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10427            IF PB-I-JOINT-AGE NOT = ZEROS
 10428                MOVE ER-2691         TO WS-ERROR
 10429                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10430
 10431     IF PB-COMPANY-ID = 'CRI'
 10432        IF PB-I-SIG-SW = 'J'
 10433           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 191
* EL050.cbl
 10434              WS-AH-JOINT-INDICATOR NOT = 'J'
 10435              MOVE ER-2675       TO WS-ERROR
 10436              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10437
 10438     IF PB-COMPANY-ID = 'CRI'
 10439        IF PB-I-SIG-SW = 'S'
 10440           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10441              WS-AH-JOINT-INDICATOR = 'J'
 10442              MOVE ER-2676       TO WS-ERROR
 10443              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10444
 10445     IF PB-COMPANY-ID = 'CVL'
 10446         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10447            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10448              MOVE ER-2783           TO WS-ERROR
 10449              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10450     IF (WS-LF-JOINT-INDICATOR = 'J')
 10451        AND (WS-AH-JOINT-INDICATOR = 'J')
 10452        AND (PB-I-LF-TERM > 120)
 10453        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10454        MOVE ER-2783             TO WS-ERROR
 10455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10456     END-IF
 10457     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10458
 10459     IF PB-I-INDV-GRP-OVRD = 'I'
 10460        MOVE ER-2666             TO WS-ERROR
 10461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10462        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10463
 10464     IF PB-I-INDV-GRP-OVRD = 'G'
 10465        MOVE ER-2666             TO WS-ERROR
 10466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10467        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10468
 10469     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10470        NEXT SENTENCE
 10471     ELSE
 10472        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10473
 10474     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10475        IF WS-ERROR = ER-2666
 10476           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10477           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10478
 10479     IF PB-COMPANY-ID = 'CID'
 10480        IF PB-STATE = 'UT' OR 'MO'
 10481           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10482                 OR '76' OR '77')
 10483                      OR
 10484               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10485                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10486                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10487                   OR '2K' OR '2L'))
 10488              AND PB-I-INDV-GRP-CD = 'I'
 10489              MOVE ER-2721             TO WS-ERROR
 10490              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10491           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 192
* EL050.cbl
 10492        END-IF
 10493     END-IF
 10494
 10495     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10496     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10497        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10498     ELSE
 10499        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10500     END-IF
 10501
 10502*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10503*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10504     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10505                                    ACCOUNT-AH-CK-SW.
 10506
 10507     IF PB-REISSUED-CERT       OR
 10508        PB-REIN-ONLY-CERT      OR
 10509        PB-POLICY-IS-DECLINED  OR
 10510        PB-POLICY-IS-VOIDED
 10511*       OR PB-MONTHLY-CERT
 10512         GO TO 3000-CONTINUE-EDIT.
 10513
 10514     IF PB-COMPANY-ID = 'CID'
 10515        IF WS-EDIT-AGE           > +65
 10516           MOVE ER-2709          TO WS-ERROR
 10517           PERFORM 9900-ERROR-FORMAT
 10518                                 THRU 9900-EXIT
 10519        ELSE
 10520           IF WS-EDIT-AGE        > +55
 10521              MOVE ER-2718       TO WS-ERROR
 10522              PERFORM 9900-ERROR-FORMAT
 10523                                 THRU 9900-EXIT
 10524           END-IF
 10525        END-IF
 10526     IF PB-COMPANY-ID = 'DCC'
 10527        IF WS-EDIT-AGE           > +65
 10528           MOVE ER-2709          TO WS-ERROR
 10529           PERFORM 9900-ERROR-FORMAT
 10530                                 THRU 9900-EXIT
 10531        END-IF
 10532     END-IF
 10533     .
 10534
 10535 0565-LIFE-PLAN-LIMIT-EDITS.
 10536
 10537     IF NOT LF-PLAN-MASTER-FOUND
 10538        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10539                                    EC-AM-LF-MAX-TOT-BEN
 10540        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10541
 10542     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10543
 10544     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10545         IF PL-LM-AGE (1) = ZEROS
 10546             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10547
 10548     IF NO-LF-BENEFIT-MATCH          OR
 10549        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 193
* EL050.cbl
 10550        WS-LF-SPECIAL-CALC-CD = 'M'
 10551        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10552
 10553     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10554     MOVE +1                     TO SUB2.
 10555
 10556     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10557        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10558           MOVE +5   TO SUB2
 10559           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10560              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10561              (PL-LM-AGE (SUB2) EQUAL +0)
 10562              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10563              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10564
 10565     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10566
 10567     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10568                               + PB-I-LF-ALT-BENEFIT-AMT.
 10569
 10570 0568-CHECK-LIFE-ATT-AGE.
 10571
 10572     IF PL-ATT-AGE NUMERIC AND
 10573        PL-ATT-AGE > +0
 10574        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10575     END-IF
 10576*    IF PL-ATT-AGE NUMERIC AND
 10577*       PL-ATT-AGE > +0
 10578*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10579*       IF PB-I-BIRTHDAY > LOW-VALUES
 10580*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10581*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10582*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10583*          SET BIN-PLUS-ELAPSED  TO TRUE
 10584*          PERFORM 8500-DATE-CONVERT
 10585*                                THRU 8500-EXIT
 10586*          IF NO-CONVERSION-ERROR
 10587*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10588*             MOVE ER-2669       TO WS-ERROR
 10589*             PERFORM 9900-ERROR-FORMAT
 10590*                                THRU 9900-EXIT
 10591*          END-IF
 10592*       ELSE
 10593*          IF WS-ATT-AGE >= PL-ATT-AGE
 10594*             MOVE ER-2669       TO WS-ERROR
 10595*             PERFORM 9900-ERROR-FORMAT
 10596*                                THRU 9900-EXIT
 10597*          END-IF
 10598*       END-IF
 10599*    END-IF
 10600     .
 10601 0570-CHECK-LIFE-LIMITS.
 10602
 10603     IF PB-COMPANY-ID EQUAL 'CRI'
 10604        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10605           IF SUB2 GREATER THAN +4
 10606              MOVE ER-2637 TO WS-ERROR
 10607              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 194
* EL050.cbl
 10608              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10609
 10610     IF PB-COMPANY-ID  =  'NCL'
 10611        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10612            SUB2 GREATER THAN +8
 10613             MOVE 'U'         TO PB-BATCH-ENTRY
 10614             MOVE ER-2637     TO WS-ERROR
 10615             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10616             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10617
 10618     IF SUB2 > +8
 10619        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10620           AND (PB-I-SIG-SW = 'Y')
 10621           CONTINUE
 10622        ELSE
 10623           MOVE ER-2637          TO WS-ERROR
 10624           PERFORM 9900-ERROR-FORMAT
 10625                                 THRU 9900-EXIT
 10626        END-IF
 10627        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10628     END-IF
 10629     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10630     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10631     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10632
 10633     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10634        ADD +1  TO SUB2
 10635        GO TO 0570-CHECK-LIFE-LIMITS.
 10636
 10637     IF PB-COMPANY-ID = 'NCL'
 10638         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10639
 10640     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10641        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10642        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10643           AND (PB-I-SIG-SW = 'Y')
 10644           CONTINUE
 10645        ELSE
 10646           MOVE ER-2637          TO WS-ERROR
 10647           PERFORM 9900-ERROR-FORMAT
 10648                                 THRU 9900-EXIT
 10649        END-IF
 10650     END-IF
 10651     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10652
 10653
 10654 0570-CHECK-NCL-LIFE-LIMITS.
 10655
 10656     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10657        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10658         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10659
 10660     IF APP-CERT-USED
 10661         IF SUB2  LESS THAN  +5
 10662             MOVE +5          TO SUB2
 10663             GO TO 0570-CHECK-LIFE-LIMITS.
 10664
 10665     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 195
* EL050.cbl
 10666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10667
 10668     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10669
 10670 0575-CHECK-NCL-SIG-SWITCH.
 10671
 10672     IF NOT APP-CERT-USED
 10673         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10674
 10675     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10676        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10677        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10678        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10679         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10680
 10681     IF SUB2 GREATER THAN +4
 10682         IF PL-LM-AGE (5) = ZEROS  AND
 10683            PL-LM-AGE (6) = ZEROS  AND
 10684            PL-LM-AGE (7) = ZEROS  AND
 10685            PL-LM-AGE (8) = ZEROS
 10686             MOVE  ER-1927        TO WS-ERROR
 10687             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10688             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10689         ELSE
 10690             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10691                 MOVE  ER-1920    TO WS-ERROR
 10692                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10693
 10694     IF PB-I-SIG-SW  = 'Y'
 10695       IF NOT PB-I-POLICY-ACCEPTED  AND
 10696          NOT PB-I-POLICY-DECLINED
 10697           MOVE 'U'               TO PB-BATCH-ENTRY
 10698           MOVE  ER-1926          TO WS-ERROR
 10699           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10700
 10701
 10702 0580-AH-PLAN-LIMIT-EDITS.
 10703
 10704     IF PB-COMPANY-ID = 'CID'
 10705        IF PB-I-AH-BENEFIT-AMT > +1250
 10706           MOVE ER-2702          TO WS-ERROR
 10707           PERFORM 9900-ERROR-FORMAT
 10708                                 THRU 9900-EXIT
 10709        END-IF
 10710     END-IF
 10711
 10712     IF (PB-COMPANY-ID = 'DCC')
 10713        AND (PB-MONTHLY-CERT)
 10714        IF PB-I-AH-BENEFIT-AMT > +1000
 10715           MOVE ER-2881          TO WS-ERROR
 10716           PERFORM 9900-ERROR-FORMAT
 10717                                 THRU 9900-EXIT
 10718        END-IF
 10719     END-IF
 10720     IF NOT AH-PLAN-MASTER-FOUND
 10721        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10722        GO TO 3000-CONTINUE-EDIT.
 10723
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 196
* EL050.cbl
 10724     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10725
 10726     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10727         IF PL-LM-AGE (1) = ZEROS
 10728             GO TO 3000-CONTINUE-EDIT.
 10729
 10730     IF NO-AH-BENEFIT-MATCH          OR
 10731        WS-AH-BENEFIT-CD = ZEROS     OR
 10732        WS-AH-SPECIAL-CALC-CD = 'M'
 10733        GO TO 3000-CONTINUE-EDIT.
 10734
 10735     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10736     MOVE +1                     TO SUB2.
 10737
 10738     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10739        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10740           MOVE +5 TO SUB2
 10741           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10742              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10743              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10744              (PL-LM-AGE (SUB2) EQUAL +0)
 10745              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10746              GO TO 3000-CONTINUE-EDIT.
 10747
 10748     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10749
 10750 0590-CHECK-AH-ATT-AGE.
 10751
 10752     IF PL-ATT-AGE NUMERIC AND
 10753        PL-ATT-AGE GREATER THAN +0
 10754        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10755     END-IF
 10756*       IF WS-ATT-AGE >= PL-ATT-AGE
 10757*          MOVE ER-3054          TO WS-ERROR
 10758*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10759     .
 10760 0597-CHECK-AH-LIMITS.
 10761
 10762     IF PB-COMPANY-ID EQUAL 'CRI'
 10763        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10764           IF SUB2 GREATER THAN +4
 10765              MOVE ER-2638       TO WS-ERROR
 10766              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10767              GO TO 3000-CONTINUE-EDIT.
 10768
 10769     IF PB-COMPANY-ID  =  'NCL'
 10770        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10771            SUB2 GREATER THAN +8
 10772             MOVE 'U'            TO PB-BATCH-ENTRY
 10773             MOVE ER-2638        TO WS-ERROR
 10774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10775             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10776
 10777     IF SUB2 > +8
 10778        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10779           AND (PB-I-SIG-SW = 'Y')
 10780           CONTINUE
 10781        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 197
* EL050.cbl
 10782           MOVE ER-2638          TO WS-ERROR
 10783           PERFORM 9900-ERROR-FORMAT
 10784                                 THRU 9900-EXIT
 10785        END-IF
 10786        GO TO 3000-CONTINUE-EDIT
 10787     END-IF
 10788
 10789     IF PB-COMPANY-ID = 'CRI'
 10790        IF WS-ERROR = ER-2638
 10791           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10792
 10793     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10794     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10795     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10796     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10797
 10798     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10799        ADD +1                   TO SUB2
 10800        GO TO 0597-CHECK-AH-LIMITS.
 10801
 10802     IF PB-COMPANY-ID = 'NCL'
 10803         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10804
 10805     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10806        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10807        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10808                                 > PL-LM-AMT (SUB2))
 10809        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10810           AND (PB-I-SIG-SW = 'Y')
 10811           CONTINUE
 10812        ELSE
 10813           MOVE ER-2638          TO WS-ERROR
 10814           PERFORM 9900-ERROR-FORMAT
 10815                                 THRU 9900-EXIT
 10816        END-IF
 10817     END-IF
 10818
 10819     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10820         IF  WS-ERROR    EQUAL    ER-2638
 10821             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10822                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10823                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10824                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10825                MOVE  ER-1910    TO  WS-ERROR
 10826                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10827
 10828     IF PB-COMPANY-ID = 'CRI'
 10829        IF WS-ERROR = ER-2638
 10830            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10831            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10832            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10833
 10834     GO TO 3000-CONTINUE-EDIT.
 10835
 10836 0597-CHECK-NCL-AH-LIMITS.
 10837
 10838     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10839        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 198
* EL050.cbl
 10840        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10841                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10842         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10843
 10844     IF APP-CERT-USED
 10845         IF SUB2  LESS THAN  +5
 10846             MOVE +5             TO SUB2
 10847             GO TO 0597-CHECK-AH-LIMITS.
 10848
 10849     MOVE ER-2638                TO WS-ERROR.
 10850     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10851
 10852     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10853
 10854 0599-CHECK-NCL-SIG-SWITCH.
 10855
 10856     IF NOT APP-CERT-USED
 10857         GO TO 3000-CONTINUE-EDIT.
 10858
 10859     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10860        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10861        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10862        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10863         GO TO 3000-CONTINUE-EDIT.
 10864
 10865     IF SUB2 GREATER THAN +4
 10866         IF PL-LM-AGE (5) = ZEROS  AND
 10867            PL-LM-AGE (6) = ZEROS  AND
 10868            PL-LM-AGE (7) = ZEROS  AND
 10869            PL-LM-AGE (8) = ZEROS
 10870             MOVE  ER-1927        TO WS-ERROR
 10871             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10872             GO TO 3000-CONTINUE-EDIT
 10873         ELSE
 10874             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10875                 MOVE  ER-1920    TO WS-ERROR
 10876                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10877
 10878     IF PB-I-SIG-SW  = 'Y'
 10879       IF NOT PB-I-POLICY-ACCEPTED  AND
 10880          NOT PB-I-POLICY-DECLINED
 10881           MOVE 'U'               TO PB-BATCH-ENTRY
 10882           MOVE  ER-1926          TO WS-ERROR
 10883           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10884
 10885******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 199
* EL050.cbl
 10887
 10888 3000-CONTINUE-EDIT.
 10889
 10890     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10891     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10892     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10893     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10894     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10895
 10896     IF BROWSE-STARTED
 10897        PERFORM 9990-RETURN THRU 9990-EXIT
 10898        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10899
 10900     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10901        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10902        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10903        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10904*       MOVE 1                   TO DC-OPTION-CODE
 10905        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10906        IF DATE-CONVERSION-ERROR
 10907           MOVE ER-2622          TO WS-ERROR
 10908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10909        ELSE
 10910           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10911              MOVE ER-2623       TO WS-ERROR
 10912              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10913           ELSE
 10914              MOVE ER-2622       TO WS-ERROR
 10915              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10916
 10917     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10918     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10919     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10920*    MOVE 1                      TO DC-OPTION-CODE.
 10921     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10922     IF DATE-CONVERSION-ERROR
 10923        GO TO 3005-EDIT-CONTINUE
 10924     ELSE
 10925        IF DC-ELAPSED-DAYS GREATER +180
 10926           MOVE ER-2613          TO WS-ERROR
 10927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10928        ELSE
 10929           IF DC-ELAPSED-DAYS GREATER +90
 10930              MOVE ER-2612       TO WS-ERROR
 10931              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10932           ELSE
 10933             IF DC-ELAPSED-DAYS GREATER +60
 10934                MOVE ER-2614     TO WS-ERROR
 10935                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10936
 10937 3005-EDIT-CONTINUE.
 10938
 10939     IF PB-CANCELLATION
 10940         GO TO 3700-EDIT-CANCEL.
 10941
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 200
* EL050.cbl
 10943******************************************************************
 10944*                  E D I T   I S S U E                           *
 10945******************************************************************
 10946
 10947 3020-EDIT-ISSUE.
 10948
 10949      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 10950      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 10951      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 10952      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 10953      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 10954
 10955     IF PB-ISSUE-FORCE
 10956        OR PB-ISSUE-DATE-FORCED
 10957        OR PB-FORCE-OFF
 10958        OR PB-OVERCHARGE-FORCE
 10959        CONTINUE
 10960     ELSE
 10961        MOVE ER-2670             TO WS-ERROR
 10962        PERFORM 9900-ERROR-FORMAT
 10963                                 THRU 9900-EXIT
 10964     END-IF
 10965     .
 10966 3022-SET-POLICY-STATUS.
 10967
 10968     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 10969
 10970     IF (PB-REISSUED-CERT)
 10971             OR
 10972        ((PB-COMPANY-ID NOT = 'DCC')
 10973         AND (PB-MONTHLY-CERT))
 10974         MOVE '5'                TO PB-I-ENTRY-STATUS
 10975         MOVE 'E'                TO PB-BATCH-ENTRY
 10976     END-IF
 10977
 10978     IF PB-COMPANY-ID = 'DCC'
 10979        IF PB-MONTHLY-CERT
 10980           MOVE 'M'              TO PB-I-ENTRY-STATUS
 10981        END-IF
 10982     END-IF
 10983     IF PB-POLICY-IS-DECLINED
 10984         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 10985     IF PB-POLICY-IS-VOIDED
 10986         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 10987     IF PB-NEEDS-UNDERWRITING
 10988         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 10989     IF PB-REIN-ONLY-CERT
 10990         MOVE '9'                TO PB-I-ENTRY-STATUS.
 10991     IF PB-PREM-ACCTNG-ONLY
 10992         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 10993
 10994     MOVE SPACE                  TO PB-I-OB-FLAG.
 10995
 10996     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 10997         MOVE ER-2665            TO WS-ERROR
 10998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10999         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11000
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 201
* EL050.cbl
 11001     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11002        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11003           MOVE 'Z'             TO PB-I-OB-FLAG.
 11004
 11005     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11006        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11007           MOVE 'Z'             TO PB-I-OB-FLAG.
 11008
 11009     IF ACCOUNT-MAST-FOUND
 11010         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11011         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11012         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11013         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11014         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11015         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11016         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11017     END-IF
 11018
 11019     IF ACCOUNT-MAST-FOUND
 11020        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11021         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11022
 11023     IF (ACCOUNT-MAST-FOUND)
 11024        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11025        IF PB-REISSUED-CERT
 11026           CONTINUE
 11027        ELSE
 11028           MOVE ER-2608          TO WS-ERROR
 11029           PERFORM 9900-ERROR-FORMAT
 11030                                 THRU 9900-EXIT
 11031         END-IF
 11032     END-IF
 11033
 11034     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11035        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11036        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11037
 11038**********   DMD CUSTOM CODE FOLLOWS  **********
 11039 3024-EDIT-DMD-FIELDS.
 11040     IF PB-COMPANY-ID NOT = 'DMD'
 11041        GO TO 3025-EDIT-REINSURANCE.
 11042
 11043*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11044*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11045*** ERROR IF THEY ARE NOT EQUAL.
 11046
 11047     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11048     SET BIN-TO-GREG               TO TRUE.
 11049     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11050     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11051**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11052
 11053     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11054     SET BIN-TO-GREG               TO TRUE.
 11055     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11056     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11057**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11058
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 202
* EL050.cbl
 11059     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11060        MOVE ER-8116               TO WS-ERROR
 11061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11062
 11063     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11064
 11065     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11066                                      WK-FULL-CERT-NO.
 11067     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11068
 11069     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11070
 11071     IF PB-VALID-LIFE
 11072        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11073     ELSE
 11074        IF PB-VALID-AH
 11075          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11076
 11077
 11078     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11079     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11080     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11081                                      DCUA-UNDRWRTR-CODE
 11082                                      DCUA-UNDRWRTR-GROUP-CODE
 11083                                      DCUA-RETURN-CODE.
 11084
 11085****************************************************************
 11086*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11087***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11088***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11089***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11090***   TO THIS RECORD.                                        ***
 11091****************************************************************
 11092     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11093     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11094     IF DCUA-SUCCESSFUL-PROCESS
 11095        GO TO 3024-EDIT-DL7-CONT.
 11096
 11097     IF DCUA-RETURN-CODE EQUAL '01'
 11098        MOVE ER-8110               TO WS-ERROR
 11099        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11101        GO TO 3024-EDIT-DL7-CONT.
 11102
 11103     IF DCUA-RETURN-CODE EQUAL '02'
 11104        MOVE ER-8111               TO WS-ERROR
 11105        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11106        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11107        GO TO 3024-EDIT-DL7-CONT.
 11108
 11109     IF DCUA-RETURN-CODE EQUAL '03'
 11110        MOVE ER-8074               TO WS-ERROR
 11111        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11113        GO TO 3024-EDIT-DL7-CONT.
 11114
 11115     IF DCUA-RETURN-CODE EQUAL '04'
 11116        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 203
* EL050.cbl
 11117        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11119        GO TO 3024-EDIT-DL7-CONT.
 11120
 11121     IF DCUA-RETURN-CODE EQUAL '05'
 11122        MOVE ER-8076               TO WS-ERROR
 11123        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11125        GO TO 3024-EDIT-DL7-CONT.
 11126
 11127     IF DCUA-RETURN-CODE EQUAL '06'
 11128        MOVE ER-8077               TO WS-ERROR
 11129        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11130        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11131        GO TO 3024-EDIT-DL7-CONT.
 11132
 11133     IF DCUA-RETURN-CODE EQUAL '07'
 11134        MOVE ER-8078               TO WS-ERROR
 11135        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11137        GO TO 3024-EDIT-DL7-CONT.
 11138
 11139     IF DCUA-RETURN-CODE EQUAL 'E1'
 11140        MOVE ER-8079               TO WS-ERROR
 11141        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11143        GO TO 3024-EDIT-DL7-CONT.
 11144
 11145     IF DCUA-RETURN-CODE EQUAL 'E2'
 11146        MOVE ER-8080               TO WS-ERROR
 11147        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11148        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11149        GO TO 3024-EDIT-DL7-CONT.
 11150
 11151     IF DCUA-RETURN-CODE EQUAL 'E3'
 11152        MOVE ER-8098               TO WS-ERROR
 11153        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11155        GO TO 3024-EDIT-DL7-CONT.
 11156
 11157     IF DCUA-RETURN-CODE EQUAL 'C1'
 11158        MOVE ER-8099               TO WS-ERROR
 11159        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11160        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11161        GO TO 3024-EDIT-DL7-CONT.
 11162
 11163     IF DCUA-RETURN-CODE EQUAL 'U1'
 11164        MOVE ER-8109               TO WS-ERROR
 11165        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11167        GO TO 3024-EDIT-DL7-CONT.
 11168
 11169     IF DCUA-RETURN-CODE EQUAL 'N1'
 11170        MOVE ER-8112               TO WS-ERROR
 11171        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11173        GO TO 3024-EDIT-DL7-CONT.
 11174
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 204
* EL050.cbl
 11175     IF DCUA-RETURN-CODE EQUAL 'N2'
 11176        MOVE ER-8113               TO WS-ERROR
 11177        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11179        GO TO 3024-EDIT-DL7-CONT.
 11180
 11181     IF DCUA-RETURN-CODE EQUAL 'N3'
 11182        MOVE ER-8114               TO WS-ERROR
 11183        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11184        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11185        GO TO 3024-EDIT-DL7-CONT.
 11186
 11187     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11188     MOVE ER-8097                  TO WS-ERROR.
 11189     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11190     GO TO 3024-EDIT-DL7-CONT.
 11191
 11192 3024-EDIT-DL7-CONT.
 11193
 11194     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11195     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11196     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11197        NEXT SENTENCE
 11198     ELSE
 11199        MOVE ER-9263               TO WS-ERROR
 11200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11201
 11202******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11203******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11204     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11205        NEXT SENTENCE
 11206     ELSE
 11207        MOVE ER-8039               TO WS-ERROR
 11208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11209
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 205
* EL050.cbl
 11211****************************************************************
 11212*** VALIDATE STATE  : DLO022                                 ***
 11213****************************************************************
 11214     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11215     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11216
 11217     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11218     IF DVSC-SUCCESSFUL-EDIT
 11219        GO TO 3024-EDIT-DL22-CONT.
 11220
 11221     IF DVSC-RETURN-CODE EQUAL '01'
 11222        MOVE ER-8300               TO WS-ERROR
 11223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11224        GO TO 3024-EDIT-DL22-CONT.
 11225
 11226     IF DVSC-RETURN-CODE EQUAL '02'
 11227        MOVE ER-8301               TO WS-ERROR
 11228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11229        GO TO 3024-EDIT-DL22-CONT.
 11230
 11231     IF DVSC-RETURN-CODE EQUAL '03'
 11232        MOVE ER-8302               TO WS-ERROR
 11233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11234        GO TO 3024-EDIT-DL22-CONT.
 11235
 11236     IF DVSC-RETURN-CODE EQUAL 'N1'
 11237        MOVE ER-8304               TO WS-ERROR
 11238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11239        GO TO 3024-EDIT-DL22-CONT.
 11240
 11241     MOVE ER-8303                  TO WS-ERROR
 11242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11243
 11244 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 206
* EL050.cbl
 11246****************************************************************
 11247*** VALIDATE LOAN OFFICER : DLO021                           ***
 11248****************************************************************
 11249
 11250     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11251     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11252     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11253     IF DVLO-SUCCESSFUL-EDIT
 11254        GO TO 3024-EDIT-DL21-CONT.
 11255
 11256     IF DVLO-RETURN-CODE EQUAL '01'
 11257        MOVE ER-8081               TO WS-ERROR
 11258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11259        GO TO 3024-EDIT-DL21-CONT.
 11260
 11261     IF DVLO-RETURN-CODE EQUAL '02'
 11262        MOVE ER-8082               TO WS-ERROR
 11263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11264        GO TO 3024-EDIT-DL21-CONT.
 11265
 11266     IF DVLO-RETURN-CODE EQUAL '03'
 11267        MOVE ER-8083               TO WS-ERROR
 11268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11269        GO TO 3024-EDIT-DL21-CONT.
 11270
 11271     IF DVLO-RETURN-CODE EQUAL '04'
 11272        MOVE ER-8084               TO WS-ERROR
 11273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11274        GO TO 3024-EDIT-DL21-CONT.
 11275
 11276     IF DVLO-RETURN-CODE EQUAL '05'
 11277        MOVE ER-8085               TO WS-ERROR
 11278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11279        GO TO 3024-EDIT-DL21-CONT.
 11280
 11281     MOVE ER-7825                  TO WS-ERROR
 11282     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11283     GO TO 3024-EDIT-DL21-CONT.
 11284
 11285 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 207
* EL050.cbl
 11287
 11288****************************************************************
 11289*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11290****************************************************************
 11291
 11292     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11293     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11294     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11295     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11296     IF DIPF-SUCCESSFUL-EDIT
 11297        GO TO 3024-EDIT-DL02-CONT.
 11298
 11299     IF DIPF-RETURN-CODE EQUAL '01'
 11300        MOVE ER-8086               TO WS-ERROR
 11301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11302        GO TO 3024-EDIT-DL02-CONT.
 11303
 11304     IF DIPF-RETURN-CODE EQUAL '02'
 11305        MOVE ER-8087               TO WS-ERROR
 11306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11307        GO TO 3024-EDIT-DL02-CONT.
 11308
 11309     IF DIPF-RETURN-CODE EQUAL '03'
 11310        MOVE ER-8088               TO WS-ERROR
 11311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11312        GO TO 3024-EDIT-DL02-CONT.
 11313
 11314     MOVE ER-8095                  TO WS-ERROR
 11315     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11316     GO TO 3024-EDIT-DL02-CONT.
 11317
 11318 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 208
* EL050.cbl
 11320
 11321****************************************************************
 11322*** VALIDATE BANK ID : DLO003                                ***
 11323****************************************************************
 11324
 11325     MOVE WK-GREG-CENT           TO WCG-CENT.
 11326     MOVE WK-GREG-YYMM           TO WCG-REST.
 11327     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11328        MOVE ER-8040               TO WS-ERROR
 11329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11330
 11331     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11332     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11333     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11334     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11335     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11336     IF DVBI-SUCCESSFUL-EDIT
 11337        GO TO 3024-EDIT-DL03-CONT.
 11338
 11339     IF DVBI-RETURN-CODE EQUAL '01'
 11340        MOVE ER-8089               TO WS-ERROR
 11341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11342        GO TO 3024-EDIT-DL03-CONT.
 11343
 11344     IF DVBI-RETURN-CODE EQUAL '02'
 11345        MOVE ER-8090               TO WS-ERROR
 11346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11347        GO TO 3024-EDIT-DL03-CONT.
 11348
 11349     IF DVBI-RETURN-CODE EQUAL '03'
 11350        MOVE ER-8091               TO WS-ERROR
 11351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11352        GO TO 3024-EDIT-DL03-CONT.
 11353
 11354     IF DVBI-RETURN-CODE EQUAL '04'
 11355        MOVE ER-8092               TO WS-ERROR
 11356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357        GO TO 3024-EDIT-DL03-CONT.
 11358
 11359     IF DVBI-RETURN-CODE EQUAL '05'
 11360        MOVE ER-8093               TO WS-ERROR
 11361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11362        GO TO 3024-EDIT-DL03-CONT.
 11363
 11364     IF DVBI-RETURN-CODE EQUAL '06'
 11365        MOVE ER-8094               TO WS-ERROR
 11366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11367        GO TO 3024-EDIT-DL03-CONT.
 11368
 11369     MOVE ER-8096                  TO WS-ERROR
 11370     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11371     GO TO 3024-EDIT-DL03-CONT.
 11372
 11373 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 209
* EL050.cbl
 11375
 11376     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11377        NEXT SENTENCE
 11378     ELSE
 11379        MOVE ER-8042               TO WS-ERROR
 11380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11381
 11382     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11383     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11384     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11385
 11386     IF DMPF-RETURN-CODE = '01'
 11387        MOVE ER-8067               TO WS-ERROR
 11388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11389        GO TO 3024-EDIT-DL01-CONT.
 11390
 11391     IF DMPF-RETURN-CODE = '02'
 11392        MOVE ER-8068               TO WS-ERROR
 11393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11394        GO TO 3024-EDIT-DL01-CONT.
 11395
 11396     IF DMPF-RETURN-CODE = '03'
 11397        MOVE ER-8069               TO WS-ERROR
 11398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11399        GO TO 3024-EDIT-DL01-CONT.
 11400
 11401     IF DMPF-RETURN-CODE = 'E1'
 11402        MOVE ER-8070               TO WS-ERROR
 11403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11404        GO TO 3024-EDIT-DL01-CONT.
 11405
 11406     IF DMPF-RETURN-CODE = 'N1'
 11407        MOVE ER-8071               TO WS-ERROR
 11408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11409        GO TO 3024-EDIT-DL01-CONT.
 11410
 11411     IF DMPF-RETURN-CODE NOT = 'OK'
 11412        MOVE ER-8072               TO WS-ERROR
 11413        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11414
 11415 3024-EDIT-DL01-CONT.
 11416******************************************************************
 11417***  VALIDATES RATE CODES : DLO017                             ***
 11418******************************************************************
 11419
 11420      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11421      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11422      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11423      IF DVRC-SUCCESSFUL-EDIT
 11424        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11425        GO TO 3024-CHECK-VALID-RATE.
 11426
 11427      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11428
 11429      IF DVRC-RETURN-CODE EQUAL '01'
 11430         MOVE ER-7817                   TO WS-ERROR
 11431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11432         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 210
* EL050.cbl
 11433
 11434      IF DVRC-RETURN-CODE EQUAL '02'
 11435         MOVE ER-7818                   TO WS-ERROR
 11436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11437         GO TO 3025-EDIT-REINSURANCE.
 11438
 11439      IF DVRC-RETURN-CODE EQUAL '03'
 11440         MOVE ER-7819                   TO WS-ERROR
 11441         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11442         GO TO 3025-EDIT-REINSURANCE.
 11443
 11444       MOVE ER-7820                     TO WS-ERROR.
 11445       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11446       GO TO 3025-EDIT-REINSURANCE.
 11447
 11448******************************************************************
 11449***  GET PREMIUM RATES : DLO011                                ***
 11450******************************************************************
 11451
 11452 3024-CHECK-VALID-RATE.
 11453
 11454     IF VALID-RATE-CODE
 11455        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11456        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11457        MOVE SPACES                TO DPRB-RETURN-CODE
 11458        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11459     ELSE
 11460         GO TO 3025-EDIT-REINSURANCE.
 11461
 11462      IF DPRB-SUCCESSFUL-PROCESS
 11463         IF PB-VALID-LIFE
 11464             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11465             GO TO 3025-EDIT-REINSURANCE
 11466         ELSE
 11467             IF PB-VALID-AH
 11468                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11469                 GO TO 3025-EDIT-REINSURANCE.
 11470
 11471      IF DPRB-RETURN-CODE EQUAL '01'
 11472         MOVE ER-7812                   TO WS-ERROR
 11473         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11474         GO TO 3025-EDIT-REINSURANCE.
 11475
 11476      IF DPRB-RETURN-CODE EQUAL '02'
 11477         MOVE ER-7813                   TO WS-ERROR
 11478         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479         GO TO 3025-EDIT-REINSURANCE.
 11480
 11481      IF DPRB-RETURN-CODE EQUAL '03'
 11482         MOVE ER-7814                   TO WS-ERROR
 11483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11484         GO TO 3025-EDIT-REINSURANCE.
 11485
 11486      IF DPRB-RETURN-CODE EQUAL '04'
 11487         IF NOT DPRB-1ST-TIME
 11488            MOVE ER-7815                   TO WS-ERROR
 11489            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11490            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 211
* EL050.cbl
 11491          ELSE
 11492         IF PB-VALID-LIFE
 11493            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11494          ELSE
 11495            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11496         END-IF
 11497         MOVE SPACES                TO DOCC-RETURN-CODE
 11498         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11499         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11500         IF DOCC-RETURN-CODE = 'OK'
 11501             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11502             GO TO 3024-CHECK-VALID-RATE
 11503           ELSE
 11504             MOVE ER-7823               TO WS-ERROR
 11505             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11506             GO TO 3025-EDIT-REINSURANCE.
 11507
 11508       MOVE ER-7816                     TO WS-ERROR.
 11509       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11510       GO TO 3025-EDIT-REINSURANCE.
 11511
 11512**********   DMD CUSTOM CODE ABOVE    **********
 11513
 11514 3025-EDIT-REINSURANCE.
 11515     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11516         GO TO 3027-EDIT-CONTINUE.
 11517
 11518     MOVE LOW-VALUES               TO ERREIN-KEY.
 11519     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11520     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11521                                      REIN-CODE-2
 11522                                      REIN-CODE-3.
 11523     MOVE 'A'                      TO REIN-TYPE.
 11524
 11525     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11526
 11527     MOVE '3026' TO REIN-SW.
 11528     MOVE ' '                   TO WS-REIN-READ-SW.
 11529
 11530     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11531     IF REIN-TABLE-NOT-FOUND
 11532         GO TO 3026-NO-SPEC-TABLE.
 11533
 11534     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11535     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11536                                   WS-NSP-ST-CD-LF.
 11537     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11538                                   WS-NSP-ST-CD-AH.
 11539
 11540     GO TO 3040-EDIT-CONTINUE.
 11541
 11542 3026-NO-SPEC-TABLE.
 11543
 11544     MOVE ER-2664                TO WS-ERROR.
 11545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11546     GO TO 3040-EDIT-CONTINUE.
 11547
 11548 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 212
* EL050.cbl
 11549
 11550     IF PB-I-REIN-TABLE = SPACES
 11551       GO TO 3040-EDIT-CONTINUE.
 11552
 11553     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11554          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11555          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11556           GO TO 3040-EDIT-CONTINUE.
 11557
 11558     MOVE LOW-VALUES            TO ERREIN-KEY.
 11559     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11560     MOVE 'A'                   TO REIN-TYPE.
 11561     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11562
 11563     MOVE '3028'                TO REIN-SW.
 11564     MOVE ' '                   TO WS-REIN-READ-SW.
 11565
 11566     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11567     IF REIN-TABLE-NOT-FOUND
 11568         GO TO 3028-NO-REIN-TABLE.
 11569
 11570     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11571     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11572                                   WS-NSP-ST-CD-LF.
 11573     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11574                                   WS-NSP-ST-CD-AH.
 11575
 11576     GO TO 3040-EDIT-CONTINUE.
 11577
 11578 3028-NO-REIN-TABLE.
 11579
 11580     MOVE ER-2615                TO WS-ERROR.
 11581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11582     GO TO 3040-EDIT-CONTINUE.
 11583
 11584 3040-EDIT-CONTINUE.
 11585
 11586     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11587         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11588
 11589     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11590         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11591
 11592     IF (NOT PB-REISSUED-CERT)
 11593        AND (NOT PB-MONTHLY-CERT)
 11594        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11595            MOVE '001'           TO PB-I-LF-TERM
 11596            MOVE 'M'             TO PB-I-INSURED-SEX.
 11597
 11598     IF (NOT PB-REISSUED-CERT)
 11599        AND (NOT PB-MONTHLY-CERT)
 11600        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11601            MOVE '001'           TO PB-I-AH-TERM
 11602            MOVE 'M'             TO PB-I-INSURED-SEX.
 11603
 11604 3040-EDIT-1ST-PMT-DT.
 11605     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11606     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 213
* EL050.cbl
 11607         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11608
 11609******************************************************************
 11610*                                                                *
 11611*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11612*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11613*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11614*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11615*                                                                *
 11616******************************************************************
 11617
 11618     IF PB-EFF-DT-PROCESSING
 11619        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11620                                    PB-I-LF-EXPIRE-DT
 11621                                    PB-I-AH-EXPIRE-DT
 11622        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11623        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11624        MOVE ZERO                TO DC-ELAPSED-DAYS
 11625        MOVE +1                  TO DC-ELAPSED-MONTHS
 11626        SET BIN-PLUS-ELAPSED     TO TRUE
 11627*       MOVE 6                   TO DC-OPTION-CODE
 11628        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11629        IF NO-CONVERSION-ERROR
 11630           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11631
 11632******************************************************************
 11633*                                                                *
 11634*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11635*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11636*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11637*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11638*                                                                *
 11639******************************************************************
 11640
 11641     IF PB-EXT-DAYS-PROCESSING
 11642          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11643                                         PB-I-LF-EXPIRE-DT
 11644                                         PB-I-AH-EXPIRE-DT
 11645          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11646          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11647          MOVE +1                     TO DC-ELAPSED-MONTHS
 11648          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11649          SET BIN-PLUS-ELAPSED        TO TRUE
 11650*         MOVE 6                      TO DC-OPTION-CODE
 11651          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11652          IF NO-CONVERSION-ERROR
 11653             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11654
 11655******************************************************************
 11656*                                                                *
 11657*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11658*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11659*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11660*        (EXPIRE DATE - (TERM -1))  *  -1.
 11661*                                                                *
 11662******************************************************************
 11663
 11664     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 214
* EL050.cbl
 11665        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11666           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11667              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11668              MOVE PB-I-AH-TERM      TO WS-TERM
 11669           ELSE
 11670              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11671              MOVE PB-I-LF-TERM      TO WS-TERM
 11672        ELSE
 11673           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11674              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11675              MOVE PB-I-LF-TERM      TO WS-TERM
 11676           ELSE
 11677              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11678              MOVE PB-I-AH-TERM      TO WS-TERM.
 11679
 11680     IF PB-EXPIRE-DT-PROCESSING
 11681        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11682        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11683        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11684        MOVE ZERO                TO DC-ELAPSED-DAYS
 11685                                    DC-ODD-DAYS-OVER
 11686          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11687          SET BIN-PLUS-ELAPSED    TO TRUE
 11688*         MOVE 6                  TO DC-OPTION-CODE
 11689          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11690          IF NO-CONVERSION-ERROR
 11691             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11692
 11693******************************************************************
 11694*                                                                *
 11695*            1ST PAYMENT DATE PROCESSING                         *
 11696*                                                                *
 11697******************************************************************
 11698
 11699     IF PB-1ST-PMT-DT-PROCESSING
 11700        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11701                                    PB-I-AH-EXPIRE-DT
 11702        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11703
 11704     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11705         NEXT SENTENCE
 11706     ELSE
 11707         MOVE ER-2680                 TO WS-ERROR
 11708         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11709         GO TO 3060-ORIG-TERM-CHECK.
 11710
 11711     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11712     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11713     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11714*    MOVE 1                      TO DC-OPTION-CODE.
 11715     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11716                                    DC-ELAPSED-DAYS
 11717                                    DC-ODD-DAYS-OVER.
 11718
 11719     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11720
 11721     IF DATE-CONVERSION-ERROR
 11722        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 215
* EL050.cbl
 11723
 11724     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11725     IF (PB-COMPANY-ID = 'CID')
 11726        AND (WS-LF-COVERAGE-TYPE = 'L')
 11727        IF (DC-ELAPSED-MONTHS > 1)
 11728                      OR
 11729           ((DC-ELAPSED-MONTHS = 1)
 11730           AND (DC-ODD-DAYS-OVER > 0))
 11731           MOVE ER-2882          TO WS-ERROR
 11732           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11733        END-IF
 11734     END-IF
 11735     IF PB-EXT-DAYS-PROCESSING
 11736        CONTINUE
 11737     ELSE
 11738        IF DC-ELAPSED-MONTHS = +0
 11739           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11740        ELSE
 11741           IF (WS-LF-EARNINGS-CALC = '4')
 11742              AND (DC-ELAPSED-MONTHS > ZERO)
 11743              AND (DC-ELAPSED-DAYS > ZERO)
 11744              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11745           ELSE
 11746              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11747                                 THRU 6499-EXIT
 11748              MOVE WS-ODD-DAYS-OVER
 11749                                 TO PB-I-EXTENTION-DAYS
 11750           END-IF
 11751        END-IF
 11752     END-IF
 11753******************************************************************
 11754*                                                                *
 11755*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11756*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11757*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11758*            AND ANY ODD DAYS.                                   *
 11759*                                                                *
 11760******************************************************************
 11761
 11762     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11763                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11764     IF WS-LF-EARNINGS-CALC NOT = '4'
 11765        IF DC-ELAPSED-DAYS > ZEROS
 11766           MOVE ER-2681          TO WS-ERROR
 11767           PERFORM 9900-ERROR-FORMAT
 11768                                 THRU 9900-EXIT
 11769        END-IF
 11770     END-IF
 11771
 11772     IF WS-LF-EARNINGS-CALC NOT = '4'
 11773        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11774           MOVE ER-2681          TO WS-ERROR
 11775           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11776
 11777     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11778        (PB-I-LF-TERM NOT = ZERO) AND
 11779         NOT NO-LIFE-COVERAGE
 11780          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 216
* EL050.cbl
 11781          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11782          IF WS-LF-EARNINGS-CALC = '4'
 11783             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11784             PB-I-PAY-FREQUENCY
 11785          END-IF
 11786          MOVE ZERO              TO DC-ELAPSED-DAYS
 11787                                    DC-ODD-DAYS-OVER
 11788          MOVE 1                 TO DC-END-OF-MONTH
 11789          SET BIN-PLUS-ELAPSED        TO TRUE
 11790*         MOVE 6                 TO DC-OPTION-CODE
 11791          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11792          IF NO-CONVERSION-ERROR
 11793             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11794             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11795                (WS-LF-SPECIAL-CALC-CD = 'L')
 11796                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11797                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11798                  MOVE +1             TO DC-ELAPSED-MONTHS
 11799                  SET BIN-PLUS-ELAPSED  TO TRUE
 11800*                 MOVE 6              TO DC-OPTION-CODE
 11801                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11802                  IF NO-CONVERSION-ERROR
 11803                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11804
 11805* okay, i had to move the new att age edit down here because the
 11806* expiration date could get recalculated and i need the exp date
 11807     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11808        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11809        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11810        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11811           AND ZEROS
 11812           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11813           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11814           SET ELAPSED-BETWEEN-BIN TO TRUE
 11815           PERFORM 8500-DATE-CONVERT
 11816                                 THRU 8500-EXIT
 11817           IF NO-CONVERSION-ERROR
 11818              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11819                 MOVE ER-2669       TO WS-ERROR
 11820*                PERFORM 9900-ERROR-FORMAT
 11821*                                THRU 9900-EXIT
 11822              END-IF
 11823           END-IF
 11824        ELSE
 11825           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11826           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11827              MOVE ER-2669       TO WS-ERROR
 11828*             PERFORM 9900-ERROR-FORMAT
 11829*                                THRU 9900-EXIT
 11830           ELSE
 11831              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11832                 MOVE ER-1570    TO WS-ERROR
 11833                 PERFORM 9900-ERROR-FORMAT
 11834                                 THRU 9900-EXIT
 11835              END-IF
 11836           END-IF
 11837        END-IF
 11838        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 217
* EL050.cbl
 11839           AND ZEROS
 11840           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11841           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11842           SET ELAPSED-BETWEEN-BIN TO TRUE
 11843           PERFORM 8500-DATE-CONVERT
 11844                                 THRU 8500-EXIT
 11845           IF NO-CONVERSION-ERROR
 11846              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11847                 MOVE ER-2669       TO WS-ERROR
 11848*                PERFORM 9900-ERROR-FORMAT
 11849*                                THRU 9900-EXIT
 11850              END-IF
 11851           END-IF
 11852        ELSE
 11853           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11854             (PB-I-LF-TERM / 12)
 11855           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11856              MOVE ER-2669       TO WS-ERROR
 11857*             PERFORM 9900-ERROR-FORMAT
 11858*                                THRU 9900-EXIT
 11859           ELSE
 11860              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11861                 MOVE ER-1571    TO WS-ERROR
 11862                 PERFORM 9900-ERROR-FORMAT
 11863                                 THRU 9900-EXIT
 11864              END-IF
 11865           END-IF
 11866        END-IF
 11867        IF WS-ERROR = ER-2669
 11868           PERFORM 9900-ERROR-FORMAT
 11869                                 THRU 9900-EXIT
 11870        END-IF
 11871     END-IF
 11872     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11873        (PB-I-AH-TERM NOT = ZERO) AND
 11874         NOT NO-AH-COVERAGE
 11875          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11876             AND (PB-COMPANY-ID = 'DCC')
 11877             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11878             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11879          ELSE
 11880             IF WS-LF-EARNINGS-CALC = '4'
 11881                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11882                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11883                PB-I-PAY-FREQUENCY
 11884             ELSE
 11885                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11886                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11887             END-IF
 11888          END-IF
 11889          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11890                                         DC-ODD-DAYS-OVER
 11891          MOVE 1                      TO DC-END-OF-MONTH
 11892          SET BIN-PLUS-ELAPSED        TO TRUE
 11893*         MOVE 6                      TO DC-OPTION-CODE
 11894          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11895          IF NO-CONVERSION-ERROR
 11896             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 218
* EL050.cbl
 11897     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11898        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11899        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11900        IF PB-I-BIRTHDAY > LOW-VALUES
 11901           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11902           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11903           SET ELAPSED-BETWEEN-BIN TO TRUE
 11904           PERFORM 8500-DATE-CONVERT
 11905                                 THRU 8500-EXIT
 11906           IF NO-CONVERSION-ERROR
 11907              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11908                 MOVE ER-3054       TO WS-ERROR
 11909*                PERFORM 9900-ERROR-FORMAT
 11910*                                THRU 9900-EXIT
 11911              END-IF
 11912           END-IF
 11913        ELSE
 11914           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11915           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11916              MOVE ER-3054       TO WS-ERROR
 11917*             PERFORM 9900-ERROR-FORMAT
 11918*                                THRU 9900-EXIT
 11919           END-IF
 11920        END-IF
 11921        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11922           AND ZEROS
 11923           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11924           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11925           SET ELAPSED-BETWEEN-BIN TO TRUE
 11926           PERFORM 8500-DATE-CONVERT
 11927                                 THRU 8500-EXIT
 11928           IF NO-CONVERSION-ERROR
 11929              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11930                 MOVE ER-3054       TO WS-ERROR
 11931*                PERFORM 9900-ERROR-FORMAT
 11932*                                THRU 9900-EXIT
 11933              END-IF
 11934           END-IF
 11935        ELSE
 11936           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11937             (PB-I-AH-TERM / 12)
 11938           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11939              MOVE ER-3054       TO WS-ERROR
 11940*             PERFORM 9900-ERROR-FORMAT
 11941*                                THRU 9900-EXIT
 11942           END-IF
 11943        END-IF
 11944        IF WS-ERROR = ER-3054
 11945           PERFORM 9900-ERROR-FORMAT
 11946                                 THRU 9900-EXIT
 11947        END-IF
 11948     END-IF
 11949     MOVE SPACE                       TO DC-END-OF-MONTH.
 11950
 11951     IF PB-COMPANY-ID = 'NCB'
 11952        GO TO 3040-EDIT-EXTENSION-DAYS.
 11953
 11954     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 219
* EL050.cbl
 11955       AND
 11956        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 11957        NEXT SENTENCE
 11958     ELSE
 11959        GO TO 3040-EDIT-EXTENSION-DAYS.
 11960
 11961     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 11962        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 11963        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 11964     ELSE
 11965        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 11966        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 11967
 11968     SET ELAPSED-BETWEEN-BIN TO TRUE.
 11969*    MOVE '1'      TO DC-OPTION-CODE
 11970     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11971     IF (NO-CONVERSION-ERROR)
 11972        AND (DC-ELAPSED-MONTHS > +1)
 11973        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 11974        MOVE ER-2668   TO WS-ERROR
 11975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11976
 11977 3040-EDIT-EXTENSION-DAYS.
 11978
 11979     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 11980        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 11981         GO TO 3050-EDIT-TERM-IN-DAYS
 11982     ELSE
 11983         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 11984
 11985     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 11986         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 11987     ELSE
 11988        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 11989           AND (WS-LF-EARNINGS-CALC NOT = '4')
 11990           MOVE ER-2681         TO WS-ERROR
 11991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11992
 11993     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 11994        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 11995        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 11996         GO TO 3060-ORIG-TERM-CHECK.
 11997
 11998     GO TO 3060-ORIG-TERM-CHECK.
 11999
 12000 3050-EDIT-TERM-IN-DAYS.
 12001
 12002     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12003
 12004     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12005         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12006     ELSE
 12007         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12008            MOVE ER-2682         TO WS-ERROR
 12009            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12010
 12011     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12012                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 220
* EL050.cbl
 12013     IF WS-WORK-TERM GREATER THAN ZERO
 12014         ADD +1 TO PB-I-LF-TERM.
 12015
 12016     IF NOT NO-AH-COVERAGE
 12017         MOVE ER-2684            TO WS-ERROR
 12018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12019
 12020
 12021 3060-ORIG-TERM-CHECK.
 12022
 12023******************************************************************
 12024*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12025******************************************************************
 12026
 12027     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12028        NEXT SENTENCE
 12029     ELSE
 12030        IF NOT NO-LIFE-COVERAGE
 12031           IF PB-I-LF-TERM NUMERIC
 12032              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12033              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12034              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12035                  NEXT SENTENCE
 12036           ELSE
 12037              MOVE ER-2647       TO WS-ERROR
 12038              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12039
 12040     IF NOT NO-AH-COVERAGE
 12041         IF PB-I-AH-TERM NUMERIC
 12042            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12043            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12044            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12045             NEXT SENTENCE
 12046          ELSE
 12047              MOVE ER-2658       TO WS-ERROR
 12048              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12049
 12050     IF PB-COMPANY-ID = 'NCB'
 12051        GO TO 3070-LOAN-TERM-CHECK.
 12052
 12053     IF POLICY-HAS-AH
 12054       AND
 12055        POLICY-HAS-LIFE
 12056       AND
 12057        PB-I-LF-TERM NUMERIC
 12058       AND
 12059        PB-I-AH-TERM NUMERIC
 12060        NEXT SENTENCE
 12061     ELSE
 12062        GO TO 3070-LOAN-TERM-CHECK.
 12063
 12064     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12065     IF WS-TEX-FACT-2 LESS THAN +0
 12066        MULTIPLY +1 BY WS-TEX-FACT-2.
 12067
 12068     IF WS-TEX-FACT-2 GREATER THAN +1
 12069        MOVE ER-2668             TO WS-ERROR
 12070        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 221
* EL050.cbl
 12071
 12072 3070-LOAN-TERM-CHECK.
 12073
 12074     IF (WS-LF-BENEFIT-CD = ZERO)
 12075         OR (NO-LF-BENEFIT-MATCH)
 12076            GO TO 3125-EDIT-PMT-FREQ.
 12077
 12078     IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U' AND 'V' AND
 12079                                     'W' AND 'X'
 12080         GO TO 3125-EDIT-PMT-FREQ.
 12081
 12082     IF PB-I-LOAN-TERM NOT NUMERIC
 12083         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12084
 12085     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12086        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12087        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12088        PB-I-LOAN-TERM NOT GREATER THAN +360
 12089         NEXT SENTENCE
 12090     ELSE
 12091         MOVE ER-2648            TO WS-ERROR
 12092         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12093
 12094     IF WS-STATE-ABBREVIATION = 'NC'
 12095        IF PB-I-LOAN-TERM > +59
 12096           CONTINUE
 12097        ELSE
 12098           MOVE ER-2792          TO WS-ERROR
 12099           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12100        END-IF
 12101     END-IF
 12102
 12103     .
 12104 3125-EDIT-PMT-FREQ.
 12105     IF (WS-LF-BENEFIT-CD = ZERO)
 12106         OR (NO-LF-BENEFIT-MATCH)
 12107            GO TO 3127-EDIT-LOAN-OFFICER.
 12108     IF WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 12109        CONTINUE
 12110     ELSE
 12111        IF (PB-I-LOAN-TERM > ZEROS)
 12112           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12113           MOVE ER-1575          TO WS-ERROR
 12114           PERFORM 9900-ERROR-FORMAT
 12115                                 THRU 9900-EXIT
 12116        END-IF
 12117     END-IF
 12118     IF WS-LF-EARNINGS-CALC NOT = '4'
 12119         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12120            MOVE ER-2653         TO WS-ERROR
 12121            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12122            GO TO 3127-EDIT-LOAN-OFFICER
 12123         ELSE
 12124            GO TO 3127-EDIT-LOAN-OFFICER.
 12125
 12126     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12127         MOVE ER-2655            TO WS-ERROR
 12128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 222
* EL050.cbl
 12129         GO TO 3127-EDIT-LOAN-OFFICER.
 12130
 12131     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12132         MOVE ER-2654            TO WS-ERROR
 12133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12134         GO TO 3127-EDIT-LOAN-OFFICER.
 12135
 12136     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12137         GIVING WS-TEX-FACT-2
 12138             REMAINDER WS-TEX-FACT-3.
 12139
 12140*    IF WS-TEX-FACT-3 NOT = ZERO
 12141*       MOVE ER-2654             TO WS-ERROR
 12142*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12143
 12144
 12145 3127-EDIT-LOAN-OFFICER.
 12146
 12147     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12148        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12149           MOVE ER-2690          TO WS-ERROR
 12150           PERFORM 9900-ERROR-FORMAT
 12151                                 THRU 9900-EXIT
 12152        ELSE
 12153           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12154           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12155           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12156           MOVE PB-SV-STATE      TO LOFC-STATE
 12157           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12158           MOVE PB-I-LOAN-OFFICER
 12159                                 TO LOFC-CODE
 12160           PERFORM 8586-READ-LOAN-OFFICER
 12161                                 THRU 8586-EXIT
 12162           IF (NOT LOFC-MASTER-FOUND)
 12163              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12164              MOVE ER-3006       TO WS-ERROR
 12165              PERFORM 9900-ERROR-FORMAT
 12166                                 THRU 9900-EXIT
 12167           END-IF
 12168        END-IF
 12169     END-IF
 12170     .
 12171 3129-EDIT-APR.
 12172
 12173     IF (WS-LF-BENEFIT-CD = ZERO)
 12174        OR (NO-LF-BENEFIT-MATCH)
 12175        IF PB-COMPANY-ID NOT = 'DCC'
 12176           GO TO 3130-EDIT-AGE
 12177*       ELSE
 12178*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12179*             GO TO 3130-EDIT-AGE
 12180*          END-IF
 12181        END-IF
 12182     END-IF
 12183
 12184     IF (WS-STATE-ABBREVIATION = 'OH')
 12185         AND (PB-I-RATE-CLASS NOT = 'L ')
 12186         AND (PB-I-LF-TERM GREATER THAN 60)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 223
* EL050.cbl
 12187         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12188         GO TO 3129-APR-CONT.
 12189
 12190     IF (WS-STATE-ABBREVIATION = 'RI')
 12191         AND (PB-I-LF-TERM GREATER THAN 60)
 12192         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12193         GO TO 3129-APR-CONT.
 12194
 12195     IF (WS-STATE-ABBREVIATION = 'UT')
 12196         AND (PB-I-LF-TERM GREATER THAN 62)
 12197         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12198         AND (PB-CERT-EFF-DT LESS WS-830901)
 12199         GO TO 3129-APR-CONT.
 12200
 12201     IF PB-COMPANY-ID = 'LAP'
 12202        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12203           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12204              MOVE ER-2656         TO WS-ERROR
 12205              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12206              GO TO 3130-EDIT-AGE.
 12207
 12208     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12209        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12210        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12211        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12212         GO TO 3130-EDIT-AGE.
 12213
 12214 3129-APR-CONT.
 12215     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12216         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12217         GO TO 3130-EDIT-AGE.
 12218
 12219     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12220        AND (PB-COMPANY-ID = 'DCC')
 12221        AND (PB-I-LOAN-APR = ZERO)
 12222        MOVE ER-2657             TO WS-ERROR
 12223        PERFORM 9900-ERROR-FORMAT
 12224                                 THRU 9900-EXIT
 12225        GO TO 3130-EDIT-AGE
 12226     END-IF
 12227     IF PB-I-LOAN-APR = ZERO
 12228        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12229     END-IF
 12230
 12231     IF PB-I-LOAN-APR = ZERO
 12232        MOVE ER-2656             TO WS-ERROR
 12233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12234        GO TO 3130-EDIT-AGE.
 12235
 12236*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12237     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12238        MOVE ER-2657             TO WS-ERROR
 12239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12240
 12241 3130-EDIT-AGE.
 12242
 12243******************************************************************
 12244*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 224
* EL050.cbl
 12245******************************************************************
 12246
 12247     IF NOT NO-LIFE-COVERAGE
 12248        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12249           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12250               MOVE ER-2628             TO WS-ERROR
 12251               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12252
 12253     IF NOT NO-AH-COVERAGE
 12254        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12255           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12256               MOVE ER-2628         TO WS-ERROR
 12257               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12258
 12259 3133-SEX-CODE.
 12260     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12261         IF WS-DEFAULT-SEX = 'M'
 12262             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12263          ELSE
 12264             IF WS-DEFAULT-SEX = 'F'
 12265             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12266
 12267     IF PB-I-INSURED-SEX = '1'
 12268         MOVE 'M' TO PB-I-INSURED-SEX.
 12269
 12270     IF PB-I-INSURED-SEX = '2'
 12271         MOVE 'F' TO PB-I-INSURED-SEX.
 12272
 12273 3134-SIG-SW-EDIT.
 12274     IF PB-I-SIG-SW = SPACE
 12275         MOVE 'N'                TO  PB-I-SIG-SW.
 12276
 12277     IF PB-COMPANY-ID = 'NCL'
 12278         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12279             NEXT SENTENCE
 12280         ELSE
 12281             MOVE ER-1923        TO  WS-ERROR
 12282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12283     ELSE
 12284     IF PB-COMPANY-ID = 'CRI'
 12285         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12286             NEXT SENTENCE
 12287         ELSE
 12288             MOVE ER-2606        TO  WS-ERROR
 12289             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12290     ELSE
 12291     IF PB-COMPANY-ID = 'TMS'
 12292         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12293             NEXT SENTENCE
 12294         ELSE
 12295             MOVE ER-2689        TO  WS-ERROR
 12296             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12297     ELSE
 12298         IF PB-I-SIG-SW = 'Y' OR 'N'
 12299             NEXT SENTENCE
 12300         ELSE
 12301             MOVE ER-2651        TO  WS-ERROR
 12302             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 225
* EL050.cbl
 12303
 12304     IF PB-COMPANY-ID = 'FLA'
 12305         IF (WS-EDIT-AGE GREATER 54  OR
 12306             WS-AH-EDIT-AGE GREATER 54)  AND
 12307            PB-I-SIG-SW = 'N'
 12308            MOVE ER-2651         TO  WS-ERROR
 12309            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12310
 12311 3135-NAME-EDIT.
 12312
 12313     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12314        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12315        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12316           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12317                                 TO PB-I-JOINT-FIRST-NAME
 12318        END-PERFORM
 12319     END-IF
 12320     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12321        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12322        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12323           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12324                                 TO PB-I-JOINT-LAST-NAME
 12325        END-PERFORM
 12326     END-IF
 12327     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12328        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12329        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12330           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12331                                 TO PB-I-INSURED-FIRST-NAME
 12332        END-PERFORM
 12333     END-IF
 12334     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12335        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12336        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12337           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12338                                 TO PB-I-INSURED-LAST-NAME
 12339        END-PERFORM
 12340     END-IF
 12341     IF PB-I-INSURED-LAST-NAME = SPACES
 12342       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12343       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12344           MOVE ER-2660    TO WS-ERROR
 12345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12346
 12347 3136-EDIT-SEX.
 12348
 12349******************************************************************
 12350*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12351******************************************************************
 12352
 12353     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12354        (WS-AH-SPECIAL-CALC-CD = 'O')
 12355        NEXT SENTENCE
 12356     ELSE
 12357        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12358           NEXT SENTENCE
 12359        ELSE
 12360           MOVE ER-2629            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 226
* EL050.cbl
 12361           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12362
 12363 3137-EDIT-EFF-DATE.
 12364
 12365     IF PB-REISSUED-CERT       OR
 12366        PB-POLICY-IS-DECLINED  OR
 12367        PB-POLICY-IS-VOIDED
 12368         GO TO 3139-EDIT-COVERAGE-CODES.
 12369
 12370     MOVE SPACE                  TO WS-2671-SW
 12371                                    WS-2672-SW.
 12372
 12373     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12374         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12375             MOVE ER-2703        TO WS-ERROR
 12376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12377             GO TO 3139-EDIT-COVERAGE-CODES.
 12378
 12379     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12380         GO TO 3139-EDIT-COVERAGE-CODES.
 12381
 12382     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12383     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12384*    MOVE '1'                    TO DC-OPTION-CODE.
 12385     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12386     MOVE +0                     TO DC-ELAPSED-MONTHS
 12387                                    DC-ELAPSED-DAYS.
 12388     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12389
 12390     IF DATE-CONVERSION-ERROR
 12391         GO TO 3139-EDIT-COVERAGE-CODES.
 12392
 12393     IF DC-ELAPSED-DAYS GREATER +180
 12394         MOVE ER-2672            TO WS-ERROR
 12395         MOVE 'Y'                TO WS-2672-SW
 12396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12397     END-IF
 12398
 12399     IF WS-ERROR = ER-2671  AND
 12400        PB-COMPANY-ID  = 'LBL'
 12401        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12402        MOVE SPACE               TO WS-2671-SW
 12403        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12404
 12405     IF PB-ISSUE-DATE-FORCED  AND
 12406      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12407         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12408         MOVE ER-2673            TO WS-ERROR
 12409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12410         MOVE SPACE              TO WS-2671-SW
 12411                                    WS-2672-SW.
 12412
 12413     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12414         IF PB-ISSUE-DATE-FORCED
 12415             MOVE ER-2600          TO  WS-ERROR
 12416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12417         ELSE
 12418             MOVE ER-2692          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 227
* EL050.cbl
 12419             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12420
 12421
 12422 3139-EDIT-COVERAGE-CODES.
 12423
 12424     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12425        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12426        MOVE ER-2787             TO WS-ERROR
 12427        PERFORM 9900-ERROR-FORMAT
 12428                                 THRU 9900-EXIT
 12429     END-IF
 12430     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12431        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12432                                 > 250000.00
 12433           MOVE ER-2719          TO WS-ERROR
 12434           PERFORM 9900-ERROR-FORMAT
 12435                                 THRU 9900-EXIT
 12436        END-IF
 12437     END-IF
 12438
 12439     IF PB-POLICY-IS-DECLINED  OR
 12440        PB-POLICY-IS-VOIDED
 12441         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12442
 12443     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12444        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12445         MOVE ER-2630                TO WS-ERROR
 12446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12447
 12448     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12449        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12450        PB-I-LF-PREMIUM-AMT = ZERO
 12451         GO TO 3140-CHECK-AH-FOR-ZERO.
 12452
 12453     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12454        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12455        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12456         GO TO 3140-CHECK-AH-FOR-ZERO.
 12457
 12458     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12459        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12460        MOVE ER-2631             TO WS-ERROR
 12461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12462     END-IF
 12463
 12464
 12465******************************************************************
 12466*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12467******************************************************************
 12468
 12469     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12470        NEXT SENTENCE
 12471     ELSE
 12472        IF PB-I-LF-BENEFIT-AMT = ZERO
 12473           MOVE ER-2632             TO WS-ERROR
 12474           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12475
 12476
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 228
* EL050.cbl
 12477******************************************************************
 12478*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12479******************************************************************
 12480
 12481     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12482        CONTINUE
 12483     ELSE
 12484        IF PB-I-LF-PREMIUM-AMT = ZERO
 12485           IF (NOT PB-COMP-LF-PREM)
 12486              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12487              MOVE ER-2633       TO WS-ERROR
 12488              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12489           END-IF
 12490        END-IF
 12491     END-IF
 12492     .
 12493 3140-CHECK-AH-FOR-ZERO.
 12494
 12495     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12496        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12497        PB-I-AH-PREMIUM-AMT = ZERO
 12498         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12499
 12500     IF PB-COMPANY-ID = 'CSL'  AND
 12501        PB-I-AH-BENEFIT-CD = ZERO  AND
 12502        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12503        PB-I-AH-PREMIUM-AMT = ZERO
 12504         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12505
 12506     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12507        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12508        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12509         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12510
 12511     IF PB-I-AH-BENEFIT-CD = ZERO
 12512         MOVE ER-2634            TO WS-ERROR
 12513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12514
 12515******************************************************************
 12516*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12517******************************************************************
 12518
 12519     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12520        NEXT SENTENCE
 12521     ELSE
 12522        IF PB-I-AH-BENEFIT-AMT = ZERO
 12523           MOVE ER-2635             TO WS-ERROR
 12524           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12525
 12526******************************************************************
 12527*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12528******************************************************************
 12529
 12530     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12531        NEXT SENTENCE
 12532     ELSE
 12533        IF PB-I-AH-PREMIUM-AMT = ZERO
 12534            IF NOT PB-COMP-AH-PREM
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 229
* EL050.cbl
 12535                MOVE ER-2636    TO WS-ERROR
 12536                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12537
 12538
 12539 3140-EDIT-MAX-AMT-SIZES.
 12540* CUSTOM CODE FOR CLIENT    'DMD'
 12541     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12542                                     WS-RES-MUNI-TAX
 12543                                     PB-I-STATE-TAX
 12544                                     PB-I-MUNI-TAX.
 12545
 12546     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12547
 12548     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12549        GO TO 3150-RATE-OUTSTAND-BAL.
 12550
 12551     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12552        GO TO 3150-RATE-OUTSTAND-BAL.
 12553
 12554     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12555        GO TO 3150-RATE-OUTSTAND-BAL.
 12556
 12557     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12558                             OR 'RIC')
 12559        GO TO 3150-RATE-OUTSTAND-BAL.
 12560
 12561     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12562        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12563            GO TO 3150-RATE-OUTSTAND-BAL
 12564        ELSE
 12565           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12566               GO TO 3150-RATE-OUTSTAND-BAL.
 12567
 12568     IF NOT PB-NO-MONTHS-SKIPPED
 12569        GO TO 3150-RATE-OUTSTAND-BAL.
 12570
 12571     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12572        GO TO 3150-RATE-OUTSTAND-BAL.
 12573
 12574     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12575        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12576           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12577             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12578           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12579           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12580              MOVE ER-2693     TO WS-ERROR
 12581              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12582              GO TO 3150-RATE-OUTSTAND-BAL
 12583           ELSE
 12584              GO TO 3150-RATE-OUTSTAND-BAL.
 12585
 12586 3150-RATE-OUTSTAND-BAL.
 12587
 12588* DMD RATING TEST
 12589     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12590         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12591         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12592         MOVE ER-2687                 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 230
* EL050.cbl
 12593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12594         MOVE 'B'                     TO PB-I-OB-FLAG
 12595         GO TO 3260-EDIT-CONTINUE.
 12596
 12597     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12598         IF  WS-ERROR    EQUAL    ER-2693
 12599             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12600                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12601                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12602                 MOVE  +0            TO  WS-ERROR.
 12603
 12604     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12605         IF  WS-ERROR    EQUAL    ER-2693
 12606             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12607                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12608                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12609                 MOVE  +0            TO  WS-ERROR.
 12610
 12611     IF PLAN-MASTER-AH-SW = 'Y'
 12612        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12613            IF  WS-ERROR    EQUAL    ER-2693
 12614              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12615                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12616                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12617                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12618                 MOVE  ER-1910           TO  WS-ERROR
 12619                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12620
 12621     IF PLAN-MASTER-AH-SW = 'Y'
 12622        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12623            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12624               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12625               MOVE  ER-1910           TO  WS-ERROR
 12626               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12627
 12628     IF PLAN-MASTER-AH-SW = 'Y'
 12629        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12630            IF  WS-ERROR    EQUAL    ER-2693
 12631                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12632                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12633                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12634                 MOVE  +0       TO  WS-ERROR.
 12635
 12636     IF WS-ERROR = ER-2693
 12637        IF PB-COMPANY-ID = 'JAL' AND
 12638           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12639           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12640           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12641
 12642     IF WS-ERROR = ER-2693
 12643        IF PB-COMPANY-ID = 'NCL'  AND
 12644           PB-I-AH-BENEFIT-CD = 'OA'
 12645           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12646           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12647
 12648     IF WS-ERROR = ER-2693
 12649        IF PB-COMPANY-ID = 'CNL' AND
 12650           PB-I-LF-BENEFIT-CD = '71' OR '72'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 231
* EL050.cbl
 12651           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12652           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12653
 12654     IF WS-ERROR = ER-2693
 12655        IF PB-COMPANY-ID = 'HER'
 12656           IF WS-LEVEL
 12657              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12658              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12659
 12660     IF ((LF-BENEFIT-FOUND) AND
 12661         (NOT NO-LIFE-COVERAGE)  AND
 12662         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12663       OR   ((AH-BENEFIT-FOUND) AND
 12664             (NOT NO-AH-COVERAGE)    AND
 12665             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12666         NEXT SENTENCE
 12667     ELSE
 12668         GO TO 3215-EDIT-RATES.
 12669
 12670     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12671        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12672           MOVE ER-2674          TO WS-ERROR
 12673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12674           GO TO 3215-EDIT-RATES.
 12675
 12676     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12677        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12678           MOVE ER-2674          TO WS-ERROR
 12679           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12680           GO TO 3215-EDIT-RATES.
 12681
 12682     MOVE 'B'                    TO PB-I-OB-FLAG.
 12683
 12684     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12685         NEXT SENTENCE
 12686     ELSE
 12687         IF NOT NO-LIFE-COVERAGE
 12688             IF WS-ACCT-LF-OB-RT = ZERO
 12689                MOVE ER-2641    TO WS-ERROR
 12690                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12691
 12692     IF PB-COMPANY-ID = 'CRI'
 12693       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12694         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12695         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12696         IF WS-ERROR = ER-2675
 12697            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12698            MOVE ER-2687              TO WS-ERROR
 12699            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12700         ELSE
 12701            MOVE ER-2687              TO WS-ERROR
 12702            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12703
 12704
 12705     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12706         NEXT SENTENCE
 12707     ELSE
 12708         IF NOT NO-AH-COVERAGE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 232
* EL050.cbl
 12709             IF WS-ACCT-AH-OB-RT = ZERO
 12710                MOVE ER-2642    TO WS-ERROR
 12711                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12712
 12713     IF PB-COMPANY-ID = 'CRI'
 12714       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12715         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12716         IF WS-ERROR = ER-2676
 12717            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12718            MOVE ER-2687              TO WS-ERROR
 12719            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12720         ELSE
 12721            MOVE ER-2687              TO WS-ERROR
 12722            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12723
 12724     IF PB-COMPANY-ID NOT = 'GIC'
 12725         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12726            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12727     ELSE
 12728         IF PB-I-LF-PREM-CALC = ZEROS
 12729             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12730                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12731
 12732     IF PB-COMPANY-ID NOT = 'GIC'
 12733         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12734            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12735     ELSE
 12736         IF PB-I-AH-PREM-CALC = ZEROS
 12737             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12738                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12739
 12740     MOVE ZEROS TO PB-I-MORT-CODE.
 12741
 12742     GO TO 3260-EDIT-CONTINUE.
 12743
 12744
 12745 3215-EDIT-RATES.
 12746     IF ACCOUNT-MAST-FOUND
 12747         NEXT SENTENCE
 12748     ELSE
 12749         GO TO 3999-END-EDIT.
 12750
 12751 3220-CHECK-LF-RATES.
 12752
 12753     IF PB-COMPANY-ID = 'DCC'
 12754        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12755        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12756        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12757           AND (NOT WS-LF-CASH))
 12758                           OR
 12759           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12760           AND (NOT WS-AH-CASH)))
 12761                       AND
 12762           (PB-I-ENTRY-STATUS NOT = '5')
 12763           MOVE 'M'              TO PB-BATCH-ENTRY
 12764                                    PB-I-ENTRY-STATUS
 12765        END-IF
 12766     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 233
* EL050.cbl
 12767     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12768                                    PB-I-AH-PREM-CALC
 12769                                    PB-I-LF-ALT-PREM-CALC
 12770                                    PB-I-LF-ALT-RATE
 12771                                    PB-I-LF-REI-RATE
 12772                                    PB-I-LF-ALT-REI-RATE
 12773                                    PB-I-AH-REI-RATE
 12774                                    PB-I-TOT-FEES-CALC.
 12775
 12776     IF PB-COMPANY-ID EQUAL 'DMD'
 12777        NEXT SENTENCE
 12778     ELSE
 12779        MOVE ZEROS               TO PB-I-LF-RATE
 12780                                    PB-I-AH-RATE.
 12781
 12782     IF PB-I-TOT-FEES NOT NUMERIC
 12783        MOVE ZEROS               TO PB-I-TOT-FEES
 12784     END-IF
 12785     IF PB-I-LIVES NOT NUMERIC
 12786         MOVE ZERO               TO PB-I-LIVES.
 12787
 12788     IF PB-I-NUM-BILLED NOT NUMERIC
 12789         MOVE ZERO               TO PB-I-NUM-BILLED.
 12790
 12791     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12792        MOVE +0                  TO PB-I-LF-PREM-TAX
 12793     END-IF
 12794
 12795     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12796        MOVE +0                  TO PB-I-AH-PREM-TAX
 12797     END-IF
 12798
 12799     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12800        PB-I-PAY-FREQUENCY = ZEROS
 12801            MOVE 12 TO CP-PAY-FREQUENCY
 12802     ELSE
 12803            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12804
 12805     IF PB-I-STATE-TAX NOT NUMERIC
 12806         MOVE ZEROS               TO PB-I-STATE-TAX.
 12807
 12808     IF PB-I-MUNI-TAX NOT NUMERIC
 12809         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12810
 12811     MOVE SPACES                 TO CP-BEN-CATEGORY
 12812     IF PB-COMPANY-ID  = 'CSL'  AND
 12813        PB-I-LF-TERM NOT = ZERO
 12814        COMPUTE WS-PAYMENT-AMT =
 12815             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12816        COMPUTE WS-CSL-AMT1 =
 12817             PB-I-LF-TERM * AM-MAX-MON-BEN
 12818        COMPUTE WS-CSL-AMT2 =
 12819             WS-PAYMENT-AMT * PB-I-LF-TERM
 12820        IF CP-PAY-FREQUENCY NOT = 12
 12821           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12822           MOVE '8' TO WS-CSL-CALC-CD
 12823        ELSE
 12824           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 234
* EL050.cbl
 12825              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12826               AM-MAX-TOT-BEN
 12827               MOVE '6' TO WS-CSL-CALC-CD
 12828           ELSE
 12829              IF (WS-CSL-AMT1  GREATER THAN
 12830                 AM-MAX-TOT-BEN) AND
 12831                 (WS-CSL-AMT2  GREATER THAN
 12832                 AM-MAX-TOT-BEN)
 12833                 MOVE '7' TO WS-CSL-CALC-CD
 12834              ELSE
 12835                 MOVE '5' TO WS-CSL-CALC-CD.
 12836
 12837     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12838         NEXT SENTENCE
 12839     ELSE
 12840         GO TO 3300-CHECK-AH-RATES.
 12841
 12842*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12843
 12844     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12845        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12846              OR
 12847           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12848           MOVE ER-2618          TO WS-ERROR
 12849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12850           GO TO 3300-CHECK-AH-RATES.
 12851
 12852     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12853           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12854                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12855
 12856     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12857         MOVE ER-2687             TO WS-ERROR
 12858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12859         MOVE 'Z000'              TO PB-I-MORT-CODE
 12860         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12861         GO TO 3300-CHECK-AH-RATES.
 12862
 12863     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12864        IF PB-I-LIVES = ZERO
 12865           MOVE ER-2688          TO WS-ERROR
 12866           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12867
 12868     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12869
 12870     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12871     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12872     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12873     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12874     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12875     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12876     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12877     MOVE '3'                    TO CP-PROCESS-TYPE.
 12878     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12879     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12880
 12881******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12882     IF PB-COMPANY-ID EQUAL 'CDL'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 235
* EL050.cbl
 12883         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12884            CP-EARN-AS-NET-PAY)
 12885             IF PB-CERT-EFF-DT GREATER  WS-931231
 12886                 MOVE '1'        TO CP-EARNING-METHOD.
 12887*******
 12888
 12889     MOVE PB-SV-STATE            TO CP-STATE.
 12890     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12891     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12892     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12893     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12894     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12895                                    CP-RATING-BENEFIT-AMT.
 12896     IF CP-STATE-STD-ABBRV = 'OR'
 12897         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12898                                         PB-I-LF-ALT-BENEFIT-AMT.
 12899     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12900     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12901     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12902     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12903     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12904     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12905     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12906     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12907     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12908                                    CP-REMAINING-TERM
 12909                                    CP-LOAN-TERM.
 12910
 12911     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 12912         NEXT SENTENCE
 12913     ELSE
 12914         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 12915             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12916                                           PB-I-LF-PREMIUM-AMT.
 12917
 12918     IF PB-COMPANY-ID EQUAL 'CSL'
 12919        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 12920           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12921                                         PB-I-LF-PREMIUM-AMT.
 12922
 12923     IF PB-COMPANY-ID EQUAL 'NCB'
 12924         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12925            CP-EARN-AS-NET-PAY
 12926             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12927                 PB-I-LF-PREMIUM-AMT.
 12928
 12929     IF CP-TRUNCATED-LIFE
 12930        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 12931
 12932     IF PB-COMPANY-ID EQUAL 'CRI'
 12933        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 12934
 12935     IF CP-TERM-IS-DAYS
 12936         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 12937     ELSE
 12938         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12939     IF PB-COMPANY-ID = 'DCC'
 12940        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 236
* EL050.cbl
 12941        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 12942        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 12943        IF WS-LF-BEN-CATEGORY = 'D'
 12944           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 12945           MOVE PB-I-LIFE-COMMISSION
 12946                                 TO CP-DCC-ACT-COMM
 12947           MOVE WS-LF-BEN-CATEGORY
 12948                                 TO CP-BEN-CATEGORY
 12949        END-IF
 12950        IF (CP-BENEFIT-CD (1:1) = 'P')
 12951           AND (PB-I-LOAN-TERM NOT = ZEROS)
 12952           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 12953        END-IF
 12954     END-IF
 12955     IF PB-COMPANY-ID = 'CSL'
 12956         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 12957         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 12958         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 12959
 12960     IF PB-COMPANY-ID = 'CSL'
 12961        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 12962
 12963     IF (CP-SPECIAL-CALC-CD = 'H')
 12964        OR (PB-COMPANY-ID = 'DCC')
 12965         MOVE PB-I-LF-ALT-BENEFIT-AMT
 12966                                    TO CP-ALTERNATE-BENEFIT
 12967         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 12968
 12969     IF (PB-COMPANY-ID = 'CID')
 12970        AND (WS-LF-EARNINGS-CALC = 'B')
 12971        AND (CP-STATE-STD-ABBRV = 'MN')
 12972        MOVE PB-I-LF-ALT-BENEFIT-AMT
 12973                                 TO CP-ALTERNATE-BENEFIT
 12974        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 12975     END-IF
 12976     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 12977     MOVE 'R'                   TO CP-RATE-FILE.
 12978     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 12979
 12980     IF CP-ERROR-RATE-NOT-FOUND
 12981        MOVE ER-2641            TO WS-ERROR
 12982        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12983        GO TO 3300-CHECK-AH-RATES.
 12984
 12985     IF PB-COMPANY-ID EQUAL 'CRI'
 12986        IF CP-ERROR-NO-LIMITS-CRI
 12987           IF NOT ACCOUNT-LIFE-CHECKED
 12988              MOVE ER-2607      TO WS-ERROR
 12989              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12990
 12991******************************************************************
 12992*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 12993*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 12994******************************************************************
 12995
 12996* CALC LIFE AGE AT EXPIRATION.
 12997
 12998     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 237
* EL050.cbl
 12999          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13000
 13001*    IF PB-STATE = 'CO' OR 'UT'
 13002*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13003*        MOVE 'F'            TO PB-FATAL-FLAG
 13004*        MOVE ER-2709        TO WS-ERROR
 13005*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13006*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13007
 13008*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13009*        MOVE 'X'            TO PB-FATAL-FLAG
 13010*        MOVE ER-2718        TO WS-ERROR
 13011*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13012*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13013
 13014* CALC A & H AGE AT EXPIRATION.
 13015
 13016     COMPUTE WS-AGE-AT-EXPIRE =
 13017          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13018
 13019*    IF PB-STATE = 'CO' OR 'UT'
 13020*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13021*        MOVE 'F'            TO PB-FATAL-FLAG
 13022*        MOVE ER-2709        TO WS-ERROR
 13023*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13024*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13025
 13026*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13027*        MOVE 'X'            TO PB-FATAL-FLAG
 13028*        MOVE ER-2718        TO WS-ERROR
 13029*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13030*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13031
 13032     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13033        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13034
 13035     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13036        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13037
 13038     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13039        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13040
 13041     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13042         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13043         MOVE ER-2639        TO WS-ERROR
 13044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13045
 13046
 13047******************************************************************
 13048*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13049******************************************************************
 13050
 13051 PREMIUM-EDITING-IS-BYPASSED.
 13052     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13053        AND (CP-R-MAX-ATT-AGE > +0)
 13054        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13055        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13056           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 238
* EL050.cbl
 13057           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13058           MOVE '1'              TO DC-OPTION-CODE
 13059           PERFORM 8500-DATE-CONVERT
 13060                                 THRU 8500-EXIT
 13061           IF NO-CONVERSION-ERROR
 13062              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13063                 MOVE ER-2661       TO WS-ERROR
 13064*                PERFORM 9900-ERROR-FORMAT
 13065*                                THRU 9900-EXIT
 13066              END-IF
 13067           END-IF
 13068        ELSE
 13069           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13070           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13071              MOVE ER-2661       TO WS-ERROR
 13072*             PERFORM 9900-ERROR-FORMAT
 13073*                                THRU 9900-EXIT
 13074           ELSE
 13075              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13076                 MOVE ER-1570    TO WS-ERROR
 13077                 PERFORM 9900-ERROR-FORMAT
 13078                                 THRU 9900-EXIT
 13079              END-IF
 13080           END-IF
 13081        END-IF
 13082        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13083           MOVE PB-I-JOINT-BIRTHDAY
 13084                                 TO DC-BIN-DATE-1
 13085           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13086           MOVE '1'              TO DC-OPTION-CODE
 13087           PERFORM 8500-DATE-CONVERT
 13088                                 THRU 8500-EXIT
 13089           IF NO-CONVERSION-ERROR
 13090              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13091                 MOVE ER-2661       TO WS-ERROR
 13092*                PERFORM 9900-ERROR-FORMAT
 13093*                                THRU 9900-EXIT
 13094              END-IF
 13095           ELSE
 13096              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13097           END-IF
 13098        ELSE
 13099           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13100             (PB-I-LF-TERM / 12)
 13101           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13102              MOVE ER-2661       TO WS-ERROR
 13103*             PERFORM 9900-ERROR-FORMAT
 13104*                                THRU 9900-EXIT
 13105           ELSE
 13106              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13107                 MOVE ER-1571    TO WS-ERROR
 13108                 PERFORM 9900-ERROR-FORMAT
 13109                                 THRU 9900-EXIT
 13110              END-IF
 13111           END-IF
 13112        END-IF
 13113        IF WS-ERROR = ER-2661
 13114           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 239
* EL050.cbl
 13115                                 THRU 9900-EXIT
 13116        END-IF
 13117     END-IF
 13118*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13119*       MOVE ER-2661             TO WS-ERROR
 13120*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13121
 13122     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13123        MOVE ER-2662             TO WS-ERROR
 13124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13125
 13126     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13127        MOVE ER-2677             TO WS-ERROR
 13128        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13129
 13130     IF CP-ERROR-LOAN-TERM
 13131        MOVE ER-2648             TO WS-ERROR
 13132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13133
 13134 3221-CHECK-ERROR-RATE-OPEN.
 13135
 13136     IF CP-ERROR-RATE-FILE-NOTOPEN
 13137         GO TO 3990-FILES-NOT-OPEN.
 13138
 13139     IF PB-COMPANY-ID NOT = 'DMD'
 13140        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13141     END-IF
 13142     .
 13143 3221-CONTINUE.
 13144     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13145                                    WS-DCC-AH-RATE
 13146     IF PB-COMPANY-ID = 'DCC'
 13147        IF WS-LF-BEN-CATEGORY = 'D'
 13148           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13149              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13150        END-IF
 13151     END-IF
 13152     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13153*   X'A4FF' = 12/31/2009
 13154     IF (PB-COMPANY-ID = 'CID')
 13155        AND (WS-LF-EARNINGS-CALC = 'B')
 13156        AND (CP-STATE-STD-ABBRV = 'MN')
 13157        AND (PB-CERT-EFF-DT > X'A4FF')
 13158        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13159     END-IF
 13160     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13161
 13162     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13163     IF (PB-COMPANY-ID = 'DCC')
 13164        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13165        AND (PB-I-POLICY-IS-MONTHLY)
 13166        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13167        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13168     END-IF
 13169     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13170     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13171     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13172     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 240
* EL050.cbl
 13173     IF (PB-COMPANY-ID = 'DCC')
 13174        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13175        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13176        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13177        MOVE ER-2786             TO WS-ERROR
 13178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13179     END-IF
 13180
 13181     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13182
 13183******************************************************************
 13184*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13185******************************************************************
 13186     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13187        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13188
 13189     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13190        GO TO 3225-CHECK-ALT-LIFE-RATE
 13191     ELSE
 13192       IF PB-I-LF-RATE = ZERO
 13193          MOVE ER-2641          TO WS-ERROR
 13194          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13195
 13196 3225-CHECK-ALT-LIFE-RATE.
 13197
 13198     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13199        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13200        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13201         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13202
 13203     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13204         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13205             AND PB-COMPANY-ID NOT = 'DCC')
 13206                   OR
 13207              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13208              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13209              AND PB-COMPANY-ID NOT = 'DCC')
 13210             MOVE ER-2720        TO  WS-ERROR
 13211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13212             GO TO 3225-RATING-CONT
 13213         ELSE
 13214             GO TO 3225-RATING-CONT.
 13215     IF (PB-COMPANY-ID = 'CID')
 13216        AND (AM-GPCD = 01 OR 06 OR 15)
 13217        MOVE ER-2798             TO WS-ERROR
 13218        PERFORM 9900-ERROR-FORMAT
 13219                                 THRU 9900-EXIT
 13220*       GO TO 3225-RATING-CONT
 13221     END-IF
 13222     IF (PB-COMPANY-ID = 'CID')
 13223        AND (WS-LF-EARNINGS-CALC = 'B')
 13224        AND (CP-STATE-STD-ABBRV = 'MN')
 13225        AND (PB-CERT-EFF-DT > X'A4FF')
 13226        GO TO 3225-RATING-CONT
 13227     END-IF
 13228     IF PB-COMPANY-ID = 'DCC'
 13229        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13230           AND (PB-I-POLICY-IS-MONTHLY)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 241
* EL050.cbl
 13231           GO TO 3225-RATING-CONT
 13232        END-IF
 13233     END-IF
 13234
 13235     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13236        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13237        CP-EARN-AS-REG-BALLOON
 13238        NEXT SENTENCE
 13239     ELSE
 13240        MOVE '2'                 TO CP-EARNING-METHOD.
 13241
 13242 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13243
 13244     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13245
 13246     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13247        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13248        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13249         NEXT SENTENCE
 13250     ELSE
 13251         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13252
 13253     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13254     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13255     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13256                                     CP-RATING-BENEFIT-AMT.
 13257     IF CP-STATE-STD-ABBRV = 'OR'
 13258         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13259                                         PB-I-LF-ALT-BENEFIT-AMT.
 13260     IF PB-COMPANY-ID = 'DCC'
 13261        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13262     END-IF
 13263     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13264     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13265     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13266                                    CP-REMAINING-TERM
 13267                                    CP-LOAN-TERM.
 13268     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13269        ADD +1                   TO CP-ORIGINAL-TERM
 13270                                    CP-REMAINING-TERM
 13271                                    CP-LOAN-TERM.
 13272
 13273     MOVE 'R'                   TO CP-RATE-FILE.
 13274     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13275
 13276     IF CP-ERROR-RATE-NOT-FOUND
 13277         MOVE ER-2641            TO WS-ERROR
 13278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13279         GO TO 3300-CHECK-AH-RATES.
 13280
 13281     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13282     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13283
 13284     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13285         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13286
 13287     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13288                               + PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 242
* EL050.cbl
 13289
 13290     IF ACCOUNT-LIFE-CHECKED  OR
 13291        PB-POLICY-IS-VOIDED   OR
 13292        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13293        GO TO 3225-CONTINUE.
 13294
 13295     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13296        GO TO 3225-CONTINUE.
 13297
 13298     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13299                             EC-RT-LF-MAX-TOT-BEN
 13300        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13301        MOVE ER-2639       TO WS-ERROR
 13302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13303
 13304 3225-CONTINUE.
 13305     IF PB-I-LF-ALT-RATE = ZERO
 13306         MOVE ER-2659            TO WS-ERROR
 13307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13308
 13309     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13310        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13311        MOVE ER-2698             TO WS-ERROR
 13312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13313
 13314 3225-RATING-CONT.
 13315
 13316     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13317         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13318         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13319         MOVE ER-2687             TO WS-ERROR
 13320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13321         GO TO 3290-EDIT-LF-REIN-RATE.
 13322
 13323* DMD RATING TEST
 13324     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13325         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13326         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13327         MOVE ER-2687                 TO WS-ERROR
 13328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13329         GO TO 3290-EDIT-LF-REIN-RATE.
 13330
 13331 3230-CLIENT-MORT-CD-SPECIALS.
 13332
 13333     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13334     SET BIN-TO-GREG          TO TRUE.
 13335*    MOVE ' '                 TO DC-OPTION-CODE.
 13336     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13337     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13338
 13339 C-POS-3230-MORT-CD.
 13340     IF PB-COMPANY-ID = 'POS' AND
 13341        PB-SV-CARRIER = '2'
 13342         NEXT SENTENCE
 13343     ELSE
 13344         GO TO C-POS-3240-MORT-CD.
 13345
 13346     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 243
* EL050.cbl
 13347        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13348         MOVE '2350' TO PB-I-MORT-CODE
 13349      ELSE
 13350         MOVE '3300' TO PB-I-MORT-CODE.
 13351
 13352
 13353 C-POS-3240-MORT-CD.
 13354     IF PB-COMPANY-ID = 'POS' AND
 13355        PB-SV-CARRIER = '1'
 13356         NEXT SENTENCE
 13357     ELSE
 13358         GO TO 3230-CONTINUE.
 13359
 13360     IF PB-SV-STATE = '45' OR '47'
 13361        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13362         MOVE '5200' TO PB-I-MORT-CODE
 13363     ELSE
 13364         MOVE '8300' TO PB-I-MORT-CODE.
 13365
 13366 3230-CONTINUE.
 13367
 13368     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13369        GO TO 3240-CONTINUE
 13370     END-IF
 13371
 13372     IF PB-CERT-EFF-DT > WS-971231
 13373        GO TO 3240-CONTINUE
 13374     END-IF
 13375
 13376     IF LF-BENEFIT-FOUND AND
 13377        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13378         MOVE 'F250'       TO PB-I-MORT-CODE
 13379     ELSE
 13380         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13381             MOVE '7250'   TO PB-I-MORT-CODE
 13382         ELSE
 13383             MOVE '4251'   TO PB-I-MORT-CODE
 13384         END-IF
 13385     END-IF
 13386
 13387     .
 13388 3240-CONTINUE.
 13389
 13390     IF PB-COMPANY-ID NOT = 'GNL'
 13391         GO TO 3256-CONTINUE.
 13392
 13393     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13394         MOVE 'A300' TO PB-I-MORT-CODE
 13395     ELSE
 13396         MOVE '8350' TO PB-I-MORT-CODE.
 13397
 13398 3256-CONTINUE.
 13399     IF PB-COMPANY-ID NOT = 'ABL'
 13400         GO TO 3260-EDIT-CONTINUE.
 13401
 13402     IF PB-I-LF-TERM GREATER THAN 59
 13403         MOVE 'F550' TO PB-I-MORT-CODE
 13404     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 244
* EL050.cbl
 13405         MOVE 'E550' TO PB-I-MORT-CODE.
 13406
 13407 3260-EDIT-CONTINUE.
 13408     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13409
 13410 3290-EDIT-LF-REIN-RATE.
 13411     IF LF-REIN-NSP-NOT-USED
 13412         GO TO 3290-RATING-CONT.
 13413
 13414     IF PB-COMPANY-ID = 'DCC'
 13415        GO TO 3290-RATING-CONT.
 13416     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13417     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13418     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13419     MOVE '3'                   TO CP-PROCESS-TYPE.
 13420     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13421
 13422******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13423     IF PB-COMPANY-ID EQUAL 'CDL'
 13424         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13425            CP-EARN-AS-NET-PAY)
 13426             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13427*            MOVE SPACE          TO DC-OPTION-CODE
 13428             SET BIN-TO-GREG     TO TRUE
 13429             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13430***  Y2K PROJ 7744
 13431             IF DC-GREG-DATE-CYMD GREATER 19931231
 13432                 MOVE '1'        TO CP-EARNING-METHOD.
 13433***  Y2K PROJ 7744
 13434*******
 13435
 13436     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13437     MOVE PB-SV-STATE           TO CP-STATE.
 13438     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13439     MOVE ZERO                  TO CP-DEVIATION-CODE
 13440                                   CP-RATE-DEV-PCT.
 13441     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13442     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13443                                   CP-RATING-BENEFIT-AMT.
 13444
 13445************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13446     IF PB-COMPANY-ID EQUAL 'NCB'
 13447         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13448            CP-EARN-AS-NET-PAY
 13449             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13450                 PB-I-LF-PREMIUM-AMT.
 13451************
 13452
 13453     IF CP-STATE-STD-ABBRV = 'OR'
 13454         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13455                                         PB-I-LF-ALT-BENEFIT-AMT.
 13456     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13457     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13458     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13459     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13460     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13461     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13462     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 245
* EL050.cbl
 13463     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13464                                   CP-REMAINING-TERM
 13465                                   CP-LOAN-TERM.
 13466     IF CP-TRUNCATED-LIFE
 13467        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13468
 13469     IF CP-TERM-IS-DAYS
 13470         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13471     ELSE
 13472         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13473
 13474     IF PB-COMPANY-ID = 'DCC'
 13475        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13476     END-IF
 13477     IF PB-COMPANY-ID NOT = 'TIC'
 13478          MOVE ZERO          TO CP-CLASS-CODE.
 13479
 13480     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13481
 13482     MOVE 'R'                   TO CP-RATE-FILE.
 13483     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13484
 13485     IF CP-ERROR-RATE-NOT-FOUND
 13486        IF PB-I-OB
 13487           MOVE ER-2625      TO WS-ERROR
 13488           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13489           GO TO 3299-EDIT-CONTINUE
 13490        ELSE
 13491           MOVE ER-2643      TO WS-ERROR
 13492           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13493           GO TO 3299-EDIT-CONTINUE.
 13494
 13495     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13496
 13497     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13498     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13499
 13500     IF PB-I-LF-REI-RATE = ZERO
 13501         MOVE ER-2643        TO WS-ERROR
 13502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13503
 13504 3290-CHECK-ALT-REIN-RATE.
 13505
 13506     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13507        GO TO 3290-RATING-CONT.
 13508
 13509     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13510     MOVE '2'                    TO CP-EARNING-METHOD.
 13511     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13512     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13513     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13514     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13515                                     CP-RATING-BENEFIT-AMT.
 13516     IF CP-STATE-STD-ABBRV = 'OR'
 13517         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13518                                         PB-I-LF-ALT-BENEFIT-AMT.
 13519     IF PB-COMPANY-ID = 'DCC'
 13520        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 246
* EL050.cbl
 13521     END-IF
 13522     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13523     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13524     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13525                                    CP-REMAINING-TERM
 13526                                    CP-LOAN-TERM.
 13527     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13528        ADD +1                   TO CP-ORIGINAL-TERM
 13529                                    CP-REMAINING-TERM
 13530                                    CP-LOAN-TERM.
 13531
 13532     MOVE 'R'                   TO CP-RATE-FILE.
 13533     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13534
 13535     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13536
 13537     IF PB-I-LF-ALT-REI-RATE = ZERO
 13538         MOVE ER-2643            TO WS-ERROR
 13539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13540
 13541 3290-RATING-CONT.
 13542
 13543     IF PB-I-OB
 13544*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13545        GO TO 3300-CHECK-AH-RATES.
 13546
 13547 3299-EDIT-CONTINUE.
 13548
 13549     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13550         NEXT SENTENCE
 13551     ELSE
 13552         MOVE ER-2620           TO WS-ERROR
 13553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13554
 13555 3300-CHECK-AH-RATES.
 13556     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13557         NEXT SENTENCE
 13558     ELSE
 13559         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13560
 13561     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13562        ((CF-COMPANY-ID = 'DMD') AND
 13563                (NO-DMD-RATING))
 13564         MOVE ER-2687             TO WS-ERROR
 13565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13566         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13567         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13568
 13569     IF PB-I-OB
 13570        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13571
 13572     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13573         MOVE ER-2687             TO WS-ERROR
 13574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13575         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13576         GO TO 3999-END-EDIT.
 13577
 13578*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 247
* EL050.cbl
 13579
 13580     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13581        IF PB-I-AH-CRIT-PER = ZERO
 13582           IF PB-COMPANY-ID = 'DCC'
 13583              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13584              CONTINUE
 13585           ELSE
 13586              MOVE ER-2618       TO WS-ERROR
 13587              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13588              GO TO 3999-END-EDIT
 13589           END-IF
 13590        END-IF
 13591     END-IF
 13592     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13593     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13594     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13595     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13596     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13597     MOVE PB-SV-STATE            TO CP-STATE.
 13598     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13599     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13600     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13601*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13602     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13603     MOVE '3'                    TO CP-PROCESS-TYPE.
 13604     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13605     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13606                                    CP-RATING-BENEFIT-AMT.
 13607     IF PB-COMPANY-ID = 'CID'
 13608               OR
 13609        CP-STATE-STD-ABBRV = 'OR'
 13610         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13611                                         PB-I-AH-TERM.
 13612     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13613        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13614           AND (PB-I-POLICY-IS-MONTHLY)
 13615           MOVE PB-I-LF-BENEFIT-AMT
 13616                                 TO CP-NET-BENEFIT-AMT
 13617           move pb-i-ah-premium-amt to cp-original-premium
 13618        END-IF
 13619     END-IF
 13620     MOVE SPACES                 TO CP-BEN-CATEGORY
 13621     IF PB-COMPANY-ID = 'DCC'
 13622        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13623        EVALUATE TRUE
 13624           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13625              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13626              MOVE PB-I-LF-BENEFIT-AMT
 13627                                 TO CP-RATING-BENEFIT-AMT
 13628           WHEN WS-AH-BEN-CATEGORY = 'G'
 13629              MOVE PB-I-UNPAID-CASH-PRICE
 13630                                 TO CP-RATING-BENEFIT-AMT
 13631           WHEN WS-AH-BEN-CATEGORY = 'D'
 13632              MOVE WS-AH-PMF-COMM
 13633                                 TO CP-DCC-PMF-COMM
 13634              MOVE PB-I-AH-COMMISSION
 13635                                 TO CP-DCC-ACT-COMM
 13636        END-EVALUATE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 248
* EL050.cbl
 13637     END-IF
 13638     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13639     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13640     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13641     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13642     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13643     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13644     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13645                                    CP-REMAINING-TERM
 13646                                    WS-WORK-TERM.
 13647     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13648
 13649     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13650     SET BIN-TO-GREG             TO TRUE.
 13651*    MOVE ' '                    TO DC-OPTION-CODE.
 13652     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13653     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13654
 13655     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13656     IF NOT VALID-SKIP-CODE
 13657         MOVE ER-2683            TO WS-ERROR
 13658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13659         GO TO 3320-RATE-CONTINUE.
 13660
 13661     IF PB-NO-MONTHS-SKIPPED
 13662         GO TO 3320-RATE-CONTINUE.
 13663
 13664     MOVE SPACE TO NUMBER-OF-MONTHS.
 13665
 13666     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13667         MOVE 'S'                TO SK-MO (6).
 13668     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13669         MOVE 'S'                TO SK-MO (7).
 13670     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13671         MOVE 'S'                TO SK-MO (8).
 13672     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13673         MOVE 'S'                TO SK-MO (9).
 13674     IF PB-I-SKIP-CODE = 'A'
 13675         MOVE 'S'                TO SK-MO (10).
 13676
 13677     MOVE 1                      TO SUB2.
 13678     MOVE PB-I-AH-TERM           TO SUB3.
 13679     MOVE WS-MONTH               TO SUB1.
 13680     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13681     GO TO 3320-RATE-CONTINUE.
 13682
 13683 3310-GET-SKIP-MO.
 13684     IF SUB1 = 13
 13685         MOVE 1                  TO SUB1.
 13686
 13687     IF SK-MO (SUB1) = 'S'
 13688         SUBTRACT 1 FROM WS-WORK-TERM.
 13689
 13690     ADD 1 TO SUB2
 13691              SUB1.
 13692
 13693 3320-RATE-CONTINUE.
 13694
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 249
* EL050.cbl
 13695     IF WS-WORK-TERM = ZERO
 13696         MOVE 1                  TO WS-WORK-TERM.
 13697
 13698     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13699                                    CP-LOAN-TERM.
 13700
 13701     IF PB-COMPANY-ID EQUAL 'DMD'
 13702         NEXT SENTENCE
 13703     ELSE
 13704         MOVE ZERO               TO PB-I-AH-RATE
 13705                                    PB-I-AH-REI-RATE.
 13706
 13707
 13708     IF PB-COMPANY-ID EQUAL 'CRI'
 13709        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13710
 13711     IF PB-COMPANY-ID = 'CSL'
 13712         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13713         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13714         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13715         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13716
 13717     IF PB-COMPANY-ID = 'DCC'
 13718        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13719           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13720              PB-I-RATE-DEV-PCT-LF
 13721        END-IF
 13722        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13723                                 TO CP-ALTERNATE-BENEFIT
 13724        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13725        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13726        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13727     END-IF
 13728     IF (PB-COMPANY-ID = 'CID')
 13729        AND (WS-LF-EARNINGS-CALC = 'B')
 13730        AND (CP-STATE-STD-ABBRV = 'MN')
 13731        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13732     ELSE
 13733        MOVE ' '                 TO CP-AH-BALLOON-SW
 13734     END-IF
 13735     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13736     MOVE 'R'                   TO CP-RATE-FILE.
 13737     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13738
 13739     IF CP-ERROR-RATE-NOT-FOUND
 13740        IF PB-I-OB
 13741           MOVE ER-2624          TO WS-ERROR
 13742           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13743           GO TO 3340-CALCULATE-PREMIUM-AMT
 13744        ELSE
 13745           MOVE ER-2642          TO WS-ERROR
 13746           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13747           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13748
 13749     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13750        CP-ERROR-DIV-BY-ZERO
 13751           MOVE ER-3782          TO WS-ERROR
 13752           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 250
* EL050.cbl
 13753
 13754     IF PB-COMPANY-ID EQUAL 'CRI'
 13755        IF CP-ERROR-NO-LIMITS-CRI
 13756           IF NOT ACCOUNT-AH-CHECKED
 13757              MOVE ER-2607          TO WS-ERROR
 13758              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13759
 13760     IF ACCOUNT-AH-CHECKED
 13761        NEXT SENTENCE
 13762     ELSE
 13763       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13764          MOVE ER-2640           TO WS-ERROR
 13765          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13766
 13767     IF PB-COMPANY-ID = 'CRI'
 13768         IF WS-ERROR = ER-2640
 13769             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13770     IF ACCOUNT-AH-CHECKED
 13771        CONTINUE
 13772     ELSE
 13773        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13774           AND (CP-R-MAX-ATT-AGE > +0)
 13775           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13776           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13777              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13778              MOVE PB-I-AH-EXPIRE-DT
 13779                                 TO DC-BIN-DATE-2
 13780              MOVE '1'           TO DC-OPTION-CODE
 13781              PERFORM 8500-DATE-CONVERT
 13782                                 THRU 8500-EXIT
 13783              IF NO-CONVERSION-ERROR
 13784                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13785                    MOVE ER-2661       TO WS-ERROR
 13786*                   PERFORM 9900-ERROR-FORMAT
 13787*                                THRU 9900-EXIT
 13788                 END-IF
 13789              END-IF
 13790           ELSE
 13791              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13792              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13793                 MOVE ER-2661    TO WS-ERROR
 13794*                PERFORM 9900-ERROR-FORMAT
 13795*                                THRU 9900-EXIT
 13796              ELSE
 13797                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13798                    MOVE ER-1570 TO WS-ERROR
 13799                    PERFORM 9900-ERROR-FORMAT
 13800                                 THRU 9900-EXIT
 13801                 END-IF
 13802              END-IF
 13803           END-IF
 13804           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13805              MOVE PB-I-JOINT-BIRTHDAY
 13806                                    TO DC-BIN-DATE-1
 13807              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13808              MOVE '1'              TO DC-OPTION-CODE
 13809              PERFORM 8500-DATE-CONVERT
 13810                                    THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 251
* EL050.cbl
 13811              IF NO-CONVERSION-ERROR
 13812                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13813                    MOVE ER-2661       TO WS-ERROR
 13814*                   PERFORM 9900-ERROR-FORMAT
 13815*                                   THRU 9900-EXIT
 13816                 END-IF
 13817              END-IF
 13818           ELSE
 13819              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13820                (PB-I-AH-TERM / 12)
 13821              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13822                 MOVE ER-2661       TO WS-ERROR
 13823*                PERFORM 9900-ERROR-FORMAT
 13824*                                   THRU 9900-EXIT
 13825              ELSE
 13826                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13827                    MOVE ER-1571 TO WS-ERROR
 13828                    PERFORM 9900-ERROR-FORMAT
 13829                                 THRU 9900-EXIT
 13830                 END-IF
 13831              END-IF
 13832           END-IF
 13833           IF WS-ERROR = ER-2661
 13834              PERFORM 9900-ERROR-FORMAT
 13835                                    THRU 9900-EXIT
 13836           END-IF
 13837        END-IF
 13838     END-IF
 13839*    IF ACCOUNT-AH-CHECKED
 13840*       NEXT SENTENCE
 13841*    ELSE
 13842*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13843*          MOVE ER-2661          TO WS-ERROR
 13844*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13845
 13846     IF ACCOUNT-AH-CHECKED
 13847        NEXT SENTENCE
 13848     ELSE
 13849        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13850           MOVE ER-2663          TO WS-ERROR
 13851           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13852
 13853     IF ACCOUNT-AH-CHECKED OR
 13854        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13855         PB-POLICY-IS-VOIDED
 13856        NEXT SENTENCE
 13857     ELSE
 13858        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13859           MOVE ER-2667            TO WS-ERROR
 13860           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13861
 13862     IF PB-COMPANY-ID = 'CRI'
 13863         IF WS-ERROR = ER-2667
 13864             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13865
 13866     IF ACCOUNT-AH-CHECKED
 13867        NEXT SENTENCE
 13868     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 252
* EL050.cbl
 13869        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13870           MOVE ER-2678            TO WS-ERROR
 13871           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13872
 13873     IF CP-ERROR-RATE-FILE-NOTOPEN
 13874         GO TO 3990-FILES-NOT-OPEN.
 13875
 13876 3321-CONTINUE.
 13877     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13878     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13879     IF (PB-COMPANY-ID = 'DCC')
 13880        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13881        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13882                                    PB-I-LF-ALT-PREM-CALC
 13883        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13884        IF WS-AH-BEN-CATEGORY = 'G'
 13885           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13886           + PB-I-ADDL-CLP)
 13887           * (1 + WS-TOL-CLP-PCT)
 13888*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13889        ELSE
 13890           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13891           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13892*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13893        END-IF
 13894        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13895                                 TO PB-I-AH-PREM-CALC
 13896        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13897           MOVE ER-8152          TO WS-ERROR
 13898           PERFORM 9900-ERROR-FORMAT
 13899                                 THRU 9900-EXIT
 13900        ELSE
 13901           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 13902                 PB-I-ADDL-CLP)
 13903              MOVE ER-8148       TO WS-ERROR
 13904              PERFORM 9900-ERROR-FORMAT
 13905                                 THRU 9900-EXIT
 13906           END-IF
 13907        END-IF
 13908     END-IF
 13909     IF (PB-COMPANY-ID = 'DCC')
 13910        AND (PB-I-POLICY-IS-MONTHLY)
 13911        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13912        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 13913        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 13914           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 13915        END-IF
 13916     END-IF
 13917     IF (PB-COMPANY-ID = 'DCC')
 13918        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 13919        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13920        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 13921        MOVE ER-2786             TO WS-ERROR
 13922        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13923     END-IF
 13924     MOVE +0                     TO PB-I-AH-CLP
 13925     IF PB-COMPANY-ID = 'DCC'
 13926        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 253
* EL050.cbl
 13927           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 13928              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13929        ELSE
 13930           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13931              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 13932           END-IF
 13933        END-IF
 13934     END-IF
 13935     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 13936
 13937     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 13938         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 13939
 13940     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 13941         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 13942
 13943     IF PB-COMPANY-ID = 'CRI'
 13944         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 13945            PB-I-PAYMENT-AMOUNT = ZERO
 13946             NEXT SENTENCE
 13947         ELSE
 13948             COMPUTE PB-I-AH-PREM-CALC =
 13949                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 13950                 (CP-PREMIUM-RATE / 100)
 13951             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 13952                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 13953                                             PB-I-RATE-DEV-PCT-AH.
 13954
 13955     IF PB-I-AH-RATE  = ZERO
 13956         MOVE ER-2642            TO WS-ERROR
 13957         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13958
 13959     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 13960     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 13961     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 13962     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 13963     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 13964     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 13965
 13966     IF (PB-COMPANY-ID = 'DCC')
 13967        AND (WS-AH-BEN-CATEGORY = 'G')
 13968        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13969        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 13970        IF CP-DEVIATION-CODE NOT = '000'
 13971           MOVE '000'            TO CP-DEVIATION-CODE
 13972           PERFORM 7000-GET-RATE THRU 7000-EXIT
 13973           IF NO-CP-ERROR
 13974              COMPUTE PB-I-DDF-IU-RATE-UP =
 13975              PB-I-AH-CLP - CP-CALC-PREMIUM
 13976           ELSE
 13977              MOVE ER-3057        TO WS-ERROR
 13978              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13979           END-IF
 13980        END-IF
 13981     END-IF
 13982     .
 13983 3335-EDIT-AH-REIN-NSP-RATE.
 13984     IF AH-REIN-NSP-NOT-USED
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 254
* EL050.cbl
 13985         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13986
 13987     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 13988     IF PB-COMPANY-ID = 'DCC'
 13989         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13990     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13991     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13992     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13993     MOVE PB-SV-STATE            TO CP-STATE.
 13994     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13995     MOVE ZERO                   TO CP-DEVIATION-CODE
 13996                                    CP-RATE-DEV-PCT.
 13997*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13998     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13999     MOVE '3'                    TO CP-PROCESS-TYPE.
 14000     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14001     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14002                                    CP-RATING-BENEFIT-AMT.
 14003     IF CP-STATE-STD-ABBRV = 'OR'
 14004         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14005                                         PB-I-AH-TERM.
 14006     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14007     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14008     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14009     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14010     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14011     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14012                                    CP-REMAINING-TERM
 14013                                    WS-WORK-TERM.
 14014     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14015     IF PB-COMPANY-ID = 'DCC'
 14016        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14017     END-IF
 14018     IF  PB-COMPANY-ID = 'TIC'
 14019         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14020            MOVE ZERO TO CP-CLASS-CODE.
 14021
 14022     IF PB-COMPANY-ID NOT = 'TIC'
 14023          MOVE ZERO          TO CP-CLASS-CODE.
 14024
 14025     MOVE ZERO               TO CP-DEVIATION-CODE.
 14026
 14027     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14028
 14029     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14030
 14031     MOVE 'R'                   TO CP-RATE-FILE.
 14032     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14033
 14034     IF CP-ERROR-RATE-NOT-FOUND
 14035         MOVE ER-2645        TO WS-ERROR
 14036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14037         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14038
 14039     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14040
 14041     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14042     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 255
* EL050.cbl
 14043
 14044     IF PB-I-AH-REI-RATE = ZERO
 14045         MOVE ER-2645        TO WS-ERROR
 14046         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14047
 14048
 14049 3340-CALCULATE-PREMIUM-AMT.
 14050
 14051     IF PB-COMPANY-ID = 'NCL'
 14052         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14053             WS-AH-SPECIAL-CALC-CD = 'O')
 14054             GO TO 3999-END-EDIT.
 14055
 14056     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14057                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14058                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14059         NEXT SENTENCE
 14060     ELSE
 14061         IF WS-STATE-ABBREVIATION = 'CT'
 14062             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14063                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14064                 COMPUTE PB-I-LF-PREM-CALC =
 14065                                     PB-I-LF-PREM-CALC * .90
 14066                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14067                                     PB-I-LF-ALT-PREM-CALC * .90
 14068                 COMPUTE PB-I-AH-PREM-CALC =
 14069                                     PB-I-AH-PREM-CALC * .90.
 14070
 14071     IF PB-COMP-LF-PREM
 14072        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14073        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14074
 14075     IF PB-COMP-AH-PREM
 14076        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14077
 14078 3340-CHECK-DCC-TOT-FEES.
 14079     IF (PB-COMPANY-ID = 'DCC')
 14080        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14081        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14082        AND (PB-I-POLICY-IS-MONTHLY)
 14083        CONTINUE
 14084     ELSE
 14085        GO TO 3340-EDIT-LF-AH-TOL
 14086     END-IF
 14087     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14088     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14089     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14090        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14091           PB-I-RATE-DEV-PCT-LF
 14092     END-IF
 14093     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14094        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14095           PB-I-RATE-DEV-PCT-AH
 14096     END-IF
 14097     MOVE 'N'                    TO CP-BEN-CATEGORY
 14098     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14099
 14100     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 256
* EL050.cbl
 14101     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14102     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14103     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14104     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14105     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14106     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14107     MOVE '3'                    TO CP-PROCESS-TYPE.
 14108     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14109     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14110
 14111     MOVE PB-SV-STATE            TO CP-STATE.
 14112     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14113     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14114     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14115     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14116     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14117                                    CP-RATING-BENEFIT-AMT.
 14118     IF CP-STATE-STD-ABBRV = 'OR'
 14119         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14120                                         PB-I-LF-ALT-BENEFIT-AMT.
 14121     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14122     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14123     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14124     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14125     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14126     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14127     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14128     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14129     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14130                                    CP-REMAINING-TERM
 14131                                    CP-LOAN-TERM.
 14132
 14133     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14134         NEXT SENTENCE
 14135     ELSE
 14136         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14137             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14138                                           PB-I-LF-PREMIUM-AMT.
 14139
 14140     IF CP-TRUNCATED-LIFE
 14141        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14142
 14143     IF CP-TERM-IS-DAYS
 14144         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14145     ELSE
 14146         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14147
 14148     IF PB-COMPANY-ID = 'DCC'
 14149        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14150     END-IF
 14151     IF CP-SPECIAL-CALC-CD = 'H'
 14152         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14153                                    TO CP-ALTERNATE-BENEFIT
 14154         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14155     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14156     MOVE 'R'                    TO CP-RATE-FILE
 14157     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14158     IF NOT CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 257
* EL050.cbl
 14159        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14160        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14161           AND (CP-BENEFIT-CD (1:1) = 'S')
 14162           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14163                                    PB-I-LF-PREMIUM-AMT
 14164        END-IF
 14165     ELSE
 14166        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14167     END-IF
 14168     .
 14169 3340-EDIT-LF-AH-TOL.
 14170
 14171***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14172***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14173***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14174***
 14175     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14176         PB-I-AH-PREMIUM-AMT
 14177          GIVING WS-CALC-WORK.
 14178
 14179     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14180        AND WS-CALC-WORK NOT = ZERO
 14181         MOVE ER-2649            TO WS-ERROR
 14182         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14183
 14184     SUBTRACT PB-I-LF-PREM-CALC
 14185             FROM PB-I-LF-PREMIUM-AMT
 14186                 GIVING WS-UNSIGN-WRK1.
 14187
 14188     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14189             FROM PB-I-LF-ALT-PREMIUM-AMT
 14190                 GIVING WS-UNSIGN-WRK4.
 14191
 14192     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14193                                + WS-UNSIGN-WRK4.
 14194
 14195     SUBTRACT PB-I-AH-PREM-CALC
 14196             FROM PB-I-AH-PREMIUM-AMT
 14197                 GIVING WS-UNSIGN-WRK2.
 14198
 14199******************************************************************
 14200*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14201******************************************************************
 14202
 14203     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14204         MOVE ZERO TO WS-UNSIGN-WRK1.
 14205
 14206     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14207         MOVE ZERO TO WS-UNSIGN-WRK2.
 14208
 14209     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14210             GIVING WS-UNSIGN-WRK3.
 14211
 14212 3342-CONTINUE.
 14213
 14214     IF (PB-I-LF-RATE = ZERO  AND
 14215         PB-I-AH-RATE = ZERO)
 14216         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 258
* EL050.cbl
 14217            WS-AH-SPECIAL-CALC-CD = 'O'
 14218              NEXT SENTENCE
 14219         ELSE
 14220             GO TO 3345-EDIT-CONTINUE.
 14221
 14222     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14223         NEXT SENTENCE
 14224     ELSE
 14225     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14226        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14227           IF (PB-REISSUED-CERT         OR
 14228               PB-POLICY-IS-DECLINED    OR
 14229               PB-POLICY-IS-VOIDED)
 14230              NEXT SENTENCE
 14231           ELSE
 14232              IF WS-PREM-REJECT-SW = SPACE
 14233                 MOVE ER-2652    TO WS-ERROR
 14234                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14235                 GO TO 3344-CHECK-AH
 14236              ELSE
 14237                 MOVE ER-2650    TO WS-ERROR
 14238                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14239                 GO TO 3344-CHECK-AH.
 14240
 14241***
 14242***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14243***
 14244
 14245     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14246         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14247            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14248             (1 + WS-TOL-LF-PREM-PCT)
 14249         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14250            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14251             (1 - WS-TOL-LF-PREM-PCT)
 14252     ELSE
 14253         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14254         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14255
 14256***
 14257***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14258***
 14259
 14260     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14261         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14262          WS-TOL-LF-PREM.
 14263
 14264     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14265         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14266          WS-TOL-LF-PREM.
 14267
 14268     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14269        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14270
 14271     IF (PB-REISSUED-CERT        OR
 14272         PB-POLICY-IS-DECLINED   OR
 14273         PB-POLICY-IS-VOIDED)
 14274        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 259
* EL050.cbl
 14275     ELSE
 14276     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14277           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14278       OR
 14279        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14280           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14281       AND
 14282        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14283           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14284         OR
 14285          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14286           LESS WS-TOL-LF-LOW-PREM-PCT))
 14287              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14288                  MOVE ER-2652   TO  WS-ERROR
 14289                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14290              ELSE
 14291                  MOVE ER-2650   TO  WS-ERROR
 14292                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14293
 14294*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14295*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14296*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14297*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14298
 14299     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14300        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14301                      OR
 14302           ((PB-COMPANY-ID = 'DCC')
 14303           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14304           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14305           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14306        END-IF
 14307     END-IF
 14308
 14309     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14310        IF WS-COMP-MAX-CAP GREATER THAN +0
 14311           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14312              IF (PB-REISSUED-CERT         OR
 14313                  PB-POLICY-IS-DECLINED    OR
 14314                  PB-POLICY-IS-VOIDED)
 14315                 NEXT SENTENCE
 14316              ELSE
 14317                  MOVE ER-2646   TO  WS-ERROR
 14318                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14319
 14320 3344-CVL-TOLERANCE-CHECK.
 14321
 14322      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14323          GO TO 3344-CHECK-AH.
 14324
 14325      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14326          GO TO 3344-CHECK-AH.
 14327
 14328      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14329                                     WS-UNSIGN-WRK6.
 14330
 14331      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14332          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 260
* EL050.cbl
 14333                                 + PB-I-LF-PREMIUM-AMT
 14334                                 - PB-I-LF-PREM-CALC.
 14335
 14336      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14337          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14338                                 + PB-I-LF-ALT-PREMIUM-AMT
 14339                                 - PB-I-LF-ALT-PREM-CALC.
 14340
 14341      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14342          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14343              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14344                 MOVE ER-2652    TO  WS-ERROR
 14345                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14346              ELSE
 14347                 MOVE ER-2650    TO  WS-ERROR
 14348                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14349
 14350      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14351          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14352              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14353                 MOVE ER-2652    TO  WS-ERROR
 14354                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14355              ELSE
 14356                 MOVE ER-2650    TO  WS-ERROR
 14357                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14358
 14359 3344-CHECK-AH.
 14360
 14361****************************************************************
 14362***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14363***
 14364
 14365     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14366         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14367             (1 + WS-TOL-AH-PREM-PCT)
 14368         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14369             (1 - WS-TOL-AH-PREM-PCT)
 14370     ELSE
 14371         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14372         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14373
 14374***
 14375***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14376***
 14377
 14378     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14379         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14380
 14381     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14382         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14383
 14384     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14385        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14386
 14387     IF (PB-REISSUED-CERT)
 14388        OR (PB-POLICY-IS-DECLINED)
 14389        OR (PB-POLICY-IS-VOIDED)
 14390        OR (AM-DCC-PRODUCT-CODE = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 261
* EL050.cbl
 14391        CONTINUE
 14392     ELSE
 14393        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14394            OR
 14395           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14396           AND
 14397           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14398           OR
 14399           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14400           IF WS-PREM-REJECT-SW = SPACE
 14401              MOVE ER-3052       TO WS-ERROR
 14402              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14403           ELSE
 14404              MOVE ER-3050       TO WS-ERROR
 14405              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14406           END-IF
 14407        END-IF
 14408     END-IF
 14409
 14410     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14411         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14412             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14413             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14414
 14415     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14416        IF WS-COMP-MAX-CAP GREATER THAN +0
 14417           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14418              IF (PB-REISSUED-CERT         OR
 14419                  PB-POLICY-IS-DECLINED    OR
 14420                  PB-POLICY-IS-VOIDED)
 14421                 NEXT SENTENCE
 14422              ELSE
 14423                  MOVE ER-2646   TO  WS-ERROR
 14424                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14425
 14426     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14427        (WS-COMP-MAX-CAP EQUAL +0)
 14428           GO TO 3345-EDIT-CONTINUE.
 14429
 14430     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14431        GREATER THAN WS-COMP-MAX-CAP
 14432           MOVE ER-2646          TO  WS-ERROR
 14433           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14434
 14435 3345-EDIT-CONTINUE.
 14436
 14437*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14438*       IF PB-ENTRY-BATCH   NUMERIC
 14439*          IF PB-ISSUE
 14440*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14441*          ELSE
 14442*              IF PB-CANCELLATION
 14443*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14444
 14445*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14446*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14447*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14448*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 262
* EL050.cbl
 14449*        ELSE
 14450*            MOVE  ER-1909            TO  WS-ERROR
 14451*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14452
 14453     IF PB-I-POLICY-ACCEPTED
 14454        IF PB-POLICY-IS-DECLINED  OR
 14455           PB-REISSUED-CERT  OR
 14456           PB-REIN-ONLY-CERT  OR
 14457           PB-POLICY-IS-VOIDED
 14458            MOVE  ER-1891         TO  WS-ERROR
 14459            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14460        ELSE
 14461            MOVE SPACE            TO  PB-BATCH-ENTRY
 14462            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14463
 14464     IF PB-I-POLICY-DECLINED
 14465        IF PB-REISSUED-CERT  OR
 14466           PB-REIN-ONLY-CERT  OR
 14467           PB-POLICY-IS-VOIDED
 14468            MOVE  ER-1906         TO  WS-ERROR
 14469            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14470        ELSE
 14471            MOVE  'D'             TO  PB-BATCH-ENTRY
 14472                                      PB-I-ENTRY-STATUS.
 14473
 14474     IF PB-I-NEEDS-UNDERWRITING
 14475        IF PB-POLICY-IS-DECLINED OR
 14476           PB-REISSUED-CERT  OR
 14477           PB-REIN-ONLY-CERT  OR
 14478           PB-POLICY-IS-VOIDED
 14479            MOVE  ER-1907         TO  WS-ERROR
 14480            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14481        ELSE
 14482            MOVE 'U'              TO  PB-BATCH-ENTRY
 14483                                      PB-I-ENTRY-STATUS.
 14484
 14485     IF PB-NEEDS-UNDERWRITING
 14486        MOVE  ER-1901             TO  WS-ERROR
 14487        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14488     IF PB-COMPANY-ID = 'DCC'
 14489        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14490        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14491        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14492           AND (NOT WS-LF-CASH))
 14493                           OR
 14494           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14495           AND (NOT WS-AH-CASH)))
 14496                       AND
 14497           (PB-I-ENTRY-STATUS NOT = '5')
 14498           MOVE 'M'              TO PB-BATCH-ENTRY
 14499                                    PB-I-ENTRY-STATUS
 14500        END-IF
 14501     END-IF
 14502     IF  PB-COMPANY-ID NOT = 'NCL'
 14503         GO TO 3999-END-EDIT.
 14504
 14505     IF PB-REISSUED-CERT  OR
 14506        PB-POLICY-IS-DECLINED  OR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 263
* EL050.cbl
 14507        PB-POLICY-IS-VOIDED  OR
 14508        PB-I-OB
 14509         GO TO 3999-END-EDIT.
 14510
 14511     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14512         MOVE  ER-2644            TO  WS-ERROR
 14513         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14514         GO TO 3999-END-EDIT.
 14515
 14516     MOVE 'N'                     TO  FORM-MASTER-SW.
 14517     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14518
 14519     IF NOT FORM-MASTER-FOUND
 14520         GO TO 3999-END-EDIT.
 14521
 14522     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14523                                      FORM-MASTER-AH-SW.
 14524
 14525     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14526         MOVE  +1                 TO SUB6
 14527         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14528
 14529     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14530         MOVE  +1                 TO SUB6
 14531         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14532
 14533     IF LF-FORM-MASTER-FOUND  OR
 14534        AH-FORM-MASTER-FOUND
 14535         GO TO 3360-CHECK-FORM-LIMITS
 14536     ELSE
 14537         GO TO 3999-END-EDIT.
 14538
 14539******************************************************************
 14540*                  3350-GET-ERFORM                               *
 14541*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14542*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14543******************************************************************
 14544
 14545 3350-GET-ERFORM.
 14546
 14547     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14548         GO TO  3350-ERFORM-GETMAIN.
 14549
 14550     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14551     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14552     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14553     MOVE 'Y'                     TO FORM-MASTER-SW.
 14554
 14555     IF PB-CANCELLATION
 14556         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14557            PB-SV-STATE          EQUAL   FO-STATE       AND
 14558            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14559              GO TO 3350-EXIT
 14560         ELSE
 14561             NEXT SENTENCE
 14562     ELSE
 14563         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14564            PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 264
* EL050.cbl
 14565            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14566              GO TO 3350-EXIT.
 14567
 14568 3350-ERFORM-GETMAIN.
 14569
 14570     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14571     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14572
 14573 3350-ERFORM-READ.
 14574
 14575     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14576     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14577     IF PB-CANCELLATION
 14578         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14579     ELSE
 14580         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14581     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14582
 14583     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14584
 14585     IF FORM-MASTER-FOUND
 14586       IF PB-CANCELLATION
 14587          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14588             PB-SV-STATE          EQUAL   FO-STATE       AND
 14589             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14590              GO  TO 3350-EXIT
 14591          ELSE
 14592              NEXT SENTENCE
 14593       ELSE
 14594          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14595             PB-SV-STATE          EQUAL   FO-STATE       AND
 14596             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14597              GO  TO 3350-EXIT.
 14598
 14599     MOVE  'N'                    TO  FORM-MASTER-SW.
 14600     MOVE  ER-1895                TO  WS-ERROR.
 14601     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14602
 14603 3350-EXIT.
 14604      EXIT.
 14605
 14606******************************************************************
 14607*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14608*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14609*   VALID FOR THE POLICY FORM USED.                              *
 14610******************************************************************
 14611
 14612 3355-EDIT-FORM-LF-BENEFITS.
 14613
 14614     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14615        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14616         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14617         GO TO   3355-EXIT.
 14618
 14619     IF  SUB6    LESS THAN   +40
 14620         ADD  +1      TO  SUB6
 14621         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14622
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 265
* EL050.cbl
 14623     MOVE  ER-1896         TO  WS-ERROR.
 14624     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14625
 14626 3355-EXIT.
 14627      EXIT.
 14628
 14629******************************************************************
 14630*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14631*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14632*   VALID FOR THE POLICY FORM USED.                              *
 14633******************************************************************
 14634
 14635 3356-EDIT-FORM-AH-BENEFITS.
 14636
 14637     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14638        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14639         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14640         GO TO  3356-EXIT.
 14641
 14642      IF  SUB6    LESS THAN     +40
 14643          ADD  +1      TO  SUB6
 14644          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14645
 14646     MOVE  ER-1897         TO  WS-ERROR.
 14647     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14648
 14649 3356-EXIT.
 14650      EXIT.
 14651
 14652******************************************************************
 14653*                  3357-BENEFIT-SEARCH                           *
 14654*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14655*   CANCELLATIONS ONLY.                                          *
 14656******************************************************************
 14657 3357-BENEFIT-SEARCH.
 14658     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14659         MOVE +1                          TO SUB6
 14660         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14661
 14662     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14663         MOVE +1                          TO SUB6
 14664         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14665
 14666 3357-EXIT.
 14667     EXIT.
 14668
 14669******************************************************************
 14670*                  3358-BENEFIT-LIFE-SEARCH                      *
 14671*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14672*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14673*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14674******************************************************************
 14675 3358-BENEFIT-LIFE-SEARCH.
 14676     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14677       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14678         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14679           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14680              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 266
* EL050.cbl
 14681                     IS GREATER THAN SPACES
 14682                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14683                                          WS-LF-REFUND-CALC
 14684                 GO TO 3358-EXIT.
 14685
 14686     IF SUB6 LESS THAN +40
 14687         ADD +1                 TO SUB6
 14688         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14689
 14690 3358-EXIT.
 14691     EXIT.
 14692******************************************************************
 14693*                  3359-BENEFIT-AH-SEARCH                        *
 14694*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14695*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14696*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14697******************************************************************
 14698 3359-BENEFIT-AH-SEARCH.
 14699     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14700       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14701         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14702           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14703              IF FO-PLAN-REFUND-METHOD (SUB6)
 14704                      IS GREATER THAN SPACES
 14705                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14706                                          WS-AH-REFUND-CALC
 14707                 GO TO 3359-EXIT.
 14708
 14709     IF SUB6 LESS THAN +40
 14710         ADD +1                 TO SUB6
 14711         GO TO 3359-BENEFIT-AH-SEARCH.
 14712
 14713 3359-EXIT.
 14714     EXIT.
 14715
 14716******************************************************************
 14717*                  3360-CHECK-FORM-LIMITS                        *
 14718*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14719*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14720******************************************************************
 14721
 14722 3360-CHECK-FORM-LIMITS.
 14723
 14724     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14725         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14726
 14727     IF NOT LF-FORM-MASTER-FOUND
 14728         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14729
 14730 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14731
 14732     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14733       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14734        WS-LF-JOINT-INDICATOR = 'J'  AND
 14735        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14736         IF PB-COMPANY-ID = 'NCL'
 14737            MOVE  ER-1911          TO  WS-ERROR
 14738            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 267
* EL050.cbl
 14739         ELSE
 14740            MOVE  ER-1892          TO  WS-ERROR
 14741            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14742
 14743 3360-CHECK-FORM-LF-ATT-AGE.
 14744
 14745     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14746
 14747     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14748         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14749         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14750            IF PB-COMPANY-ID = 'NCL'
 14751                MOVE  ER-1913      TO  WS-ERROR
 14752                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14753            ELSE
 14754                MOVE  ER-1894      TO  WS-ERROR
 14755                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14756
 14757 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14758
 14759     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14760         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14761         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14762            IF PB-COMPANY-ID = 'NCL'
 14763                MOVE  ER-1914      TO  WS-ERROR
 14764                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14765            ELSE
 14766                MOVE  ER-1899      TO  WS-ERROR
 14767                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14768
 14769 3360-CHECK-FORM-LF-TERM-BAMT.
 14770
 14771     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14772         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14773         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14774           IF  PB-COMPANY-ID = 'NCL'
 14775               MOVE  ER-1916       TO  WS-ERROR
 14776               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14777           ELSE
 14778               MOVE  ER-1902       TO  WS-ERROR
 14779               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14780
 14781     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14782                                    PB-I-LF-ALT-BENEFIT-AMT.
 14783
 14784     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14785         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14786         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14787             IF  PB-COMPANY-ID = 'NCL'
 14788                 MOVE  ER-1918     TO  WS-ERROR
 14789                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14790             ELSE
 14791                 MOVE  ER-1904     TO  WS-ERROR
 14792                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14793
 14794******************************************************************
 14795*                  3360-CHECK-FORM-AH-LIMITS                     *
 14796*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 268
* EL050.cbl
 14797*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14798******************************************************************
 14799
 14800 3360-CHECK-FORM-AH-LIMITS.
 14801
 14802     IF NOT AH-FORM-MASTER-FOUND
 14803         GO TO 3999-END-EDIT.
 14804
 14805 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14806
 14807     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14808       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14809        WS-AH-JOINT-INDICATOR = 'J'  AND
 14810        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14811         IF PB-COMPANY-ID = 'NCL'
 14812            MOVE  ER-1912          TO  WS-ERROR
 14813            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14814         ELSE
 14815            MOVE  ER-1893          TO  WS-ERROR
 14816            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14817
 14818 3360-CHECK-FORM-AH-ATT-AGE.
 14819
 14820     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14821
 14822     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14823         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14824         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14825            IF PB-COMPANY-ID = 'NCL'
 14826                MOVE  ER-1913      TO  WS-ERROR
 14827                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14828            ELSE
 14829                MOVE  ER-1894      TO  WS-ERROR
 14830                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14831
 14832 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14833
 14834     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14835         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14836         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14837            IF PB-COMPANY-ID = 'NCL'
 14838                MOVE  ER-1915      TO  WS-ERROR
 14839                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14840            ELSE
 14841                MOVE  ER-1900      TO  WS-ERROR
 14842                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14843
 14844 3360-CHECK-FORM-AH-TERM-BAMT.
 14845
 14846     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14847         FO-AH-MAX-TERM    GREATER THAN  +0
 14848         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14849             IF  PB-COMPANY-ID = 'NCL'
 14850                 MOVE  ER-1917     TO  WS-ERROR
 14851                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14852             ELSE
 14853                  MOVE  ER-1903    TO  WS-ERROR
 14854                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 269
* EL050.cbl
 14855
 14856     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14857         FO-MAX-AH-AMT    GREATER THAN  +0
 14858         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14859             IF  PB-COMPANY-ID = 'NCL'
 14860                 MOVE  ER-1919     TO  WS-ERROR
 14861                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14862             ELSE
 14863                 MOVE  ER-1905     TO  WS-ERROR
 14864                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14865
 14866     GO TO 3999-END-EDIT.
 14867
 14868******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 270
* EL050.cbl
 14870******************************************************************
 14871*                  E D I T   C A N C E L                         *
 14872******************************************************************
 14873
 14874 3700-EDIT-CANCEL.
 14875     IF PB-COMPANY-ID = 'DMD'
 14876         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14877                                         WS-RES-MUNI-TAX
 14878                                         PB-CI-STATE-TAX
 14879                                         PB-CI-MUNI-TAX
 14880         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14881
 14882*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14883*       IF PB-ENTRY-BATCH  NUMERIC
 14884*          IF PB-CANCELLATION
 14885*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14886*          ELSE
 14887*             IF PB-ISSUE
 14888*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14889
 14890     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14891        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14892     END-IF
 14893*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14894*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14895
 14896     IF CM-ENTRY-STATUS = 'V'
 14897        MOVE ER-2780             TO WS-ERROR
 14898        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14899        GO TO 3999-END-EDIT.
 14900
 14901     IF CM-ENTRY-STATUS = 'D'
 14902        MOVE ER-2781             TO WS-ERROR
 14903        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14904        GO TO 3999-END-EDIT.
 14905
 14906     IF CM-ENTRY-STATUS = 'U'
 14907        MOVE ER-2782             TO WS-ERROR
 14908        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14909
 14910***************************************************************
 14911*                                                             *
 14912*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 14913*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 14914*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 14915*   OF ANOTHER COVERAGE.                                      *
 14916*                                                             *
 14917***************************************************************
 14918
 14919     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 14920                                    PB-C-AH-CANCEL-VOID-SW.
 14921
 14922     IF PB-C-LF-CANCEL-AMT = ZERO
 14923        NEXT SENTENCE
 14924     ELSE
 14925        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 14926           AND
 14927           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 271
* EL050.cbl
 14928               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 14929               MOVE ER-2745           TO WS-ERROR
 14930               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14931
 14932     IF PB-C-AH-CANCEL-AMT = ZERO
 14933        NEXT SENTENCE
 14934     ELSE
 14935        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 14936           AND
 14937           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 14938               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 14939               MOVE ER-2745           TO WS-ERROR
 14940               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14941
 14942     IF WS-LF-EARNINGS-CALC = '4'
 14943        MOVE '4'                   TO WS-LF-REFUND-CALC.
 14944
 14945     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 14946     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 14947     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 14948     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 14949     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 14950     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 14951
 14952     MOVE ZERO                     TO PB-C-LF-REF-CALC
 14953                                      PB-C-AH-REF-CALC.
 14954     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 14955
 14956******************************************************************
 14957*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 14958*             TO VALIDATE COVERAGE.                              *
 14959******************************************************************
 14960
 14961     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 14962        PB-C-LF-CANCEL-AMT = ZEROS
 14963          MOVE 'N'                 TO WS-LF-CANCEL-SW
 14964      ELSE
 14965          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 14966
 14967     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 14968        PB-C-AH-CANCEL-AMT = ZEROS
 14969          MOVE 'N'                 TO WS-AH-CANCEL-SW
 14970      ELSE
 14971          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 14972
 14973     EVALUATE TRUE
 14974         WHEN PB-CANCEL-FORCE             OR
 14975              PB-CANCEL-DATE-FORCED       OR
 14976              PB-FORCE-OFF
 14977                  IF PB-COMPANY-ID = 'ACE'
 14978                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 14979                  END-IF
 14980         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 14981               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 14982              (PB-COMPANY-ID = 'ACE' )
 14983                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 14984         WHEN OTHER
 14985              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 272
* EL050.cbl
 14986                 MOVE ER-2794              TO WS-ERROR
 14987              ELSE
 14988                 MOVE ER-2749              TO WS-ERROR
 14989              END-IF
 14990              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14991     END-EVALUATE.
 14992
 14993
 14994*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14995*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 14996*            MOVE  ER-1909            TO  WS-ERROR
 14997*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14998*        ELSE
 14999*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15000
 15001     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15002     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15003        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15004     ELSE
 15005        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15006     END-IF
 15007     .
 15008 3705-EDIT-CANCEL-DT.
 15009
 15010     IF LF-COVERAGE-CANCELLED
 15011        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15012         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15013         MOVE WS-CURRENT-MONTH-END
 15014                                 TO DC-BIN-DATE-2
 15015         SET ELAPSED-BETWEEN-BIN TO TRUE
 15016*        MOVE 1                  TO DC-OPTION-CODE
 15017         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15018         IF DATE-CONVERSION-ERROR
 15019            NEXT SENTENCE
 15020          ELSE
 15021             IF DC-ELAPSED-DAYS GREATER +180
 15022                IF PB-CANCEL-DATE-FORCED  OR
 15023                   PB-CANCEL-DATE-FORCED-NO-FEE
 15024                      MOVE ER-2751  TO WS-ERROR
 15025                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15026                 ELSE
 15027                   MOVE ER-2752  TO WS-ERROR
 15028                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15029
 15030     IF AH-COVERAGE-CANCELLED
 15031        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15032         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15033         MOVE WS-CURRENT-MONTH-END
 15034                                 TO DC-BIN-DATE-2
 15035         SET ELAPSED-BETWEEN-BIN TO TRUE
 15036*        MOVE 1                  TO DC-OPTION-CODE
 15037         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15038         IF DATE-CONVERSION-ERROR
 15039            NEXT SENTENCE
 15040          ELSE
 15041             IF DC-ELAPSED-DAYS GREATER +180
 15042                IF PB-CANCEL-DATE-FORCED OR
 15043                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 273
* EL050.cbl
 15044                      MOVE ER-2751  TO WS-ERROR
 15045                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15046                 ELSE
 15047                   MOVE ER-2752  TO WS-ERROR
 15048                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15049
 15050     IF WS-ERROR = ER-2752
 15051        AND (PB-COMPANY-ID = 'ABL'
 15052         OR  PB-COMPANY-ID = 'FGL'
 15053         OR  PB-COMPANY-ID = 'IST'
 15054         OR  PB-COMPANY-ID = 'JHL'
 15055         OR  PB-COMPANY-ID = 'LAP'
 15056         OR  PB-COMPANY-ID = 'LBL'
 15057         OR  PB-COMPANY-ID = 'NCB'
 15058         OR  PB-COMPANY-ID = 'NLI'
 15059         OR  PB-COMPANY-ID = 'OFI'
 15060         OR  PB-COMPANY-ID = 'PLI'
 15061         OR  PB-COMPANY-ID = 'TAO'
 15062         OR  PB-COMPANY-ID = 'TIC'
 15063         OR  PB-COMPANY-ID = 'HER'
 15064         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15065         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15066            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15067            MOVE ER-2762     TO WS-ERROR
 15068            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15069
 15070     IF LF-COVERAGE-CANCELLED
 15071        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15072        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15073             MOVE ER-2733         TO WS-ERROR
 15074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15075
 15076     IF AH-COVERAGE-CANCELLED
 15077        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15078        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15079              MOVE ER-2733        TO WS-ERROR
 15080              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15081
 15082     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15083        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15084        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15085           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15086            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15087              IF PB-COMPANY-ID NOT = 'LAP'
 15088               MOVE ER-2704            TO WS-ERROR
 15089               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15090
 15091     IF CERT-WAS-NOT-FOUND
 15092         GO TO 3999-END-EDIT.
 15093
 15094     IF PB-COMPANY-ID EQUAL 'CDC'
 15095        IF LF-COVERAGE-CANCELLED
 15096           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15097            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15098            MOVE PB-C-LF-CANCEL-DT
 15099                                 TO DC-BIN-DATE-2
 15100            SET ELAPSED-BETWEEN-BIN TO TRUE
 15101*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 274
* EL050.cbl
 15102            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15103            IF DATE-CONVERSION-ERROR
 15104               NEXT SENTENCE
 15105             ELSE
 15106                IF DC-ELAPSED-DAYS GREATER +60
 15107                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15108
 15109     IF PB-COMPANY-ID EQUAL 'CDC'
 15110        IF AH-COVERAGE-CANCELLED
 15111           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15112            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15113            MOVE PB-C-AH-CANCEL-DT
 15114                                 TO DC-BIN-DATE-2
 15115            MOVE +0              TO DC-ELAPSED-DAYS
 15116                                    DC-ELAPSED-MONTHS
 15117            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15118*           MOVE 1               TO DC-OPTION-CODE
 15119            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15120            IF DATE-CONVERSION-ERROR
 15121               NEXT SENTENCE
 15122             ELSE
 15123                IF DC-ELAPSED-DAYS GREATER +60
 15124                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15125
 15126     MOVE +0                     TO DC-ELAPSED-DAYS
 15127                                    DC-ELAPSED-MONTHS.
 15128
 15129     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15130        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15131          MOVE 'Z'                TO PB-CI-OB-FLAG
 15132          MOVE ER-2767            TO WS-ERROR
 15133          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15134          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15135          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15136          GO TO 3775-OVER-REF-CHK
 15137        ELSE
 15138          MOVE ZEROS              TO PB-CI-LIVES
 15139                                     PB-C-LIVES
 15140          IF PB-CI-OB-FLAG NOT = 'B'
 15141             MOVE SPACE           TO PB-CI-OB-FLAG.
 15142
 15143     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15144         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15145     ELSE
 15146         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15147
 15148     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15149        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15150            MOVE ER-2760         TO WS-ERROR
 15151            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15152
 15153     IF LF-COVERAGE-CANCELLED
 15154        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15155         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15156            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15157               MOVE ER-2774       TO WS-ERROR
 15158               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15159
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 275
* EL050.cbl
 15160     IF AH-COVERAGE-CANCELLED
 15161        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15162         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15163            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15164               MOVE ER-2775       TO WS-ERROR
 15165               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15166
 15167     IF LF-COVERAGE-CANCELLED
 15168        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15169         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15170            MOVE ER-2776         TO WS-ERROR
 15171            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15172
 15173     IF AH-COVERAGE-CANCELLED
 15174        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15175         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15176            MOVE ER-2777         TO WS-ERROR
 15177            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15178
 15179     IF LF-COVERAGE-CANCELLED
 15180        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15181         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15182         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15183         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15184*        MOVE 6                    TO DC-OPTION-CODE
 15185         SET BIN-PLUS-ELAPSED      TO TRUE
 15186         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15187         IF DATE-CONVERSION-ERROR
 15188            NEXT SENTENCE
 15189          ELSE
 15190            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15191              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15192                             OR  'FIA'
 15193                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15194               ELSE
 15195                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15196                MOVE ER-2731       TO WS-ERROR
 15197                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15198
 15199 3705-EDIT-AH-CANCEL-DT.
 15200
 15201     IF AH-COVERAGE-CANCELLED
 15202        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15203         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15204         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15205         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15206*        MOVE 6                    TO DC-OPTION-CODE
 15207         SET BIN-PLUS-ELAPSED      TO TRUE
 15208         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15209         IF DATE-CONVERSION-ERROR
 15210            NEXT SENTENCE
 15211          ELSE
 15212            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15213              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15214                              OR 'FIA'
 15215                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15216              ELSE
 15217               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 276
* EL050.cbl
 15218               MOVE ER-2771       TO WS-ERROR
 15219               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15220
 15221 3705-EDIT-CONTINUED.
 15222
 15223*    IF LF-COVERAGE-CANCELLED
 15224*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15225*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15226*            MOVE ER-2727         TO WS-ERROR
 15227*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15228*
 15229*    IF AH-COVERAGE-CANCELLED
 15230*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15231*        IF PB-COMPANY-ID = 'ACE'
 15232*           MOVE ER-2727        TO WS-ERROR
 15233*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15234*        ELSE
 15235*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15236*              MOVE ER-2727     TO WS-ERROR
 15237*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15238
 15239     IF PB-COMPANY-ID = 'ACE'
 15240       IF AH-COVERAGE-CANCELLED
 15241         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15242           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15243              MOVE ER-2732      TO WS-ERROR
 15244              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15245
 15246     IF PB-COMPANY-ID      EQUAL   'HER'
 15247        IF WS-ERROR        EQUAL   ER-2727
 15248            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15249            MOVE  ER-2725          TO  WS-ERROR
 15250            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15251
 15252     IF PB-C-CLAIM-CREATED-CANCEL
 15253            MOVE ER-2748         TO WS-ERROR
 15254            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15255
 15256     IF PB-C-LAST-NAME NOT = SPACES
 15257         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15258            MOVE ER-2747         TO WS-ERROR
 15259            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15260
 15261 3710-EDIT-LUMP-SUM-PRIOR.
 15262
 15263     IF AH-COVERAGE-CANCELLED
 15264         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15265             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15266                MOVE ER-2735    TO WS-ERROR
 15267                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15268
 15269     IF LF-COVERAGE-CANCELLED
 15270         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15271             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15272                MOVE ER-2735    TO WS-ERROR
 15273                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15274
 15275 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 277
* EL050.cbl
 15276
 15277*    IF LF-COVERAGE-CANCELLED
 15278*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15279*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15280*           (NOT PB-CI-OB)
 15281*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15282*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15283*                   MOVE ER-2732  TO WS-ERROR
 15284*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15285*
 15286*    IF AH-COVERAGE-CANCELLED
 15287*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15288*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15289*           (NOT PB-CI-OB)
 15290*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15291*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15292*                   MOVE ER-2732  TO WS-ERROR
 15293*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15294
 15295     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15296         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15297            (NOT PB-COMP-LF-CANCEL)
 15298             NEXT SENTENCE
 15299         ELSE
 15300           IF PB-C-LF-CANCEL-VOIDED
 15301              NEXT SENTENCE
 15302           ELSE
 15303              MOVE ER-2753      TO WS-ERROR
 15304              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15305
 15306     IF CANCEL-FUTURE-DT
 15307         GO TO 3999-END-EDIT.
 15308
 15309 3715-GET-REMAIN-TERM-LF.
 15310
 15311     IF NO-LF-BENEFIT-MATCH  OR
 15312        WS-LF-BENEFIT-CD = ZEROS
 15313        GO TO 3730-GET-AH-REMAIN-TERM.
 15314
 15315     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15316     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15317     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15318     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15319     MOVE PB-SV-STATE            TO CP-STATE.
 15320     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15321     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15322     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15323     MOVE '2'                    TO CP-PROCESS-TYPE.
 15324     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15325     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15326     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15327     IF (PB-COMPANY-ID = 'CID')
 15328        AND (CP-STATE-STD-ABBRV = 'WI')
 15329        MOVE '7'                 TO CP-REM-TERM-METHOD
 15330        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15331     ELSE
 15332        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15333        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 278
* EL050.cbl
 15334                                 TO CP-REM-TRM-CALC-OPTION
 15335     END-IF
 15336**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15337     IF (PB-COMPANY-ID = 'CID')
 15338        AND (CP-STATE-STD-ABBRV = 'MO')
 15339        AND (PB-CERT-EFF-DT >= X'9B41')
 15340        AND (PB-CERT-EFF-DT <= X'A2FB')
 15341        MOVE '7'                 TO CP-REM-TERM-METHOD
 15342        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15343     END-IF
 15344     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15345                                    CP-LOAN-TERM.
 15346     IF CP-TRUNCATED-LIFE
 15347        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15348
 15349     IF CP-TERM-IS-DAYS
 15350         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15351     ELSE
 15352         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15353
 15354     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15355
 15356     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15357
 15358     IF LF-COVERAGE-CANCELLED
 15359        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15360        NEXT SENTENCE
 15361      ELSE
 15362          GO TO 3730-GET-AH-REMAIN-TERM.
 15363
 15364 3720-GET-LF-REFUND.
 15365
 15366     IF PB-C-LF-CANCEL-VOIDED OR
 15367        PB-C-AH-CANCEL-VOIDED
 15368        GO TO 3780-UPDATE-CANCEL-CERT.
 15369
 15370     IF PB-COMPANY-ID EQUAL 'BOA'
 15371         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15372         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15373         GO TO 3730-GET-AH-REMAIN-TERM.
 15374
 15375     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15376        (WS-AH-SPECIAL-CALC-CD = 'M')
 15377         MOVE ER-2767            TO WS-ERROR
 15378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15379         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15380         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15381         GO TO 3780-UPDATE-CANCEL-CERT.
 15382
 15383     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15384
 15385     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15386     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15387     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15388     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15389     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15390     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15391     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 279
* EL050.cbl
 15392        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15393        MOVE ' '                 TO PDEF-MASTER-SW
 15394        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15395        MOVE PB-STATE            TO ERPDEF-STATE
 15396        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15397        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15398        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15399        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15400        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15401        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15402        IF PDEF-MASTER-FOUND
 15403           MOVE 'N'              TO PDEF-MASTER-SW
 15404           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15405           IF PDEF-MASTER-FOUND
 15406              IF (ERPDEF-KEY-SAVE (1:16) =
 15407                           PD-CONTROL-PRIMARY (1:16))
 15408                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15409                 CONTINUE
 15410              ELSE
 15411                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15412                 IF (ERPDEF-KEY-SAVE (1:16) =
 15413                           PD-CONTROL-PRIMARY (1:16))
 15414                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15415                    CONTINUE
 15416                 ELSE
 15417                    MOVE 'N'     TO PDEF-MASTER-SW
 15418                 END-IF
 15419              END-IF
 15420              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15421
 15422              IF PDEF-MASTER-FOUND
 15423                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15424                    (V1 > +8)
 15425                    OR (PD-PROD-CODE (V1) = 'L')
 15426                 END-PERFORM
 15427                 IF V1 < +9
 15428                    MOVE PD-MAX-AMT (V1)
 15429                                 TO CP-R-MAX-TOT-BEN
 15430                                    EC-AM-LF-MAX-TOT-BEN
 15431                 END-IF
 15432              END-IF
 15433           END-IF
 15434           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15435        END-IF
 15436     END-IF
 15437     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15438
 15439     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15440
 15441     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15442                                    PB-C-LF-REM-TERM.
 15443
 15444     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15445     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15446
 15447     IF PB-COMPANY-ID EQUAL 'FLC'
 15448        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15449           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 280
* EL050.cbl
 15450           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15451                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15452                    - CM-LF-ITD-DEATH-AMT
 15453           IF PB-C-LF-REF-CALC LESS THAN +0
 15454              MOVE +0            TO PB-C-LF-REF-CALC
 15455              GO TO 3730-GET-AH-REMAIN-TERM
 15456           ELSE
 15457              GO TO 3730-GET-AH-REMAIN-TERM.
 15458
 15459     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15460                            OR '4' OR '5' OR '6' OR '8'
 15461                            OR '9' OR 'G'
 15462        MOVE PB-C-LF-REFUND-OVERRIDE
 15463                                 TO CP-EARNING-METHOD.
 15464
 15465     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15466     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15467     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15468                                    CP-RATING-BENEFIT-AMT.
 15469     IF CP-STATE-STD-ABBRV = 'OR'
 15470         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15471                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15472     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15473     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15474     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15475     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15476     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15477     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15478     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15479     IF WS-DEFAULT-APR NOT NUMERIC
 15480         MOVE ZEROS TO WS-DEFAULT-APR.
 15481****   N O T E   ****
 15482*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15483*      THE OH HARD CODING IN ELCRFNDP
 15484
 15485     IF PB-COMPANY-ID = 'CID'
 15486        IF CP-STATE-STD-ABBRV = 'OH'
 15487           MOVE WS-LF-EARNINGS-CALC
 15488                                 TO CP-EARNING-METHOD
 15489        END-IF
 15490     END-IF
 15491
 15492****   N O T E   ****
 15493
 15494     IF CP-EARN-AS-NET-PAY
 15495         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15496            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15497                MOVE WS-DEFAULT-APR
 15498                                 TO  CP-LOAN-APR
 15499                MOVE ER-3780     TO  WS-ERROR
 15500                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15501            ELSE
 15502                MOVE ER-3781     TO  WS-ERROR
 15503                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15504     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15505     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15506
 15507     IF CP-REFUND-TYPE-USED NOT = SPACE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 281
* EL050.cbl
 15508         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15509
 15510     IF CP-ERROR-RATE-IS-ZERO OR
 15511        CP-ERROR-RATE-NOT-FOUND
 15512        MOVE ER-2740             TO WS-ERROR
 15513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15514
 15515     IF CP-ERROR-RATE-FILE-NOTOPEN
 15516        MOVE ER-2617             TO WS-ERROR
 15517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15518
 15519     IF PB-COMPANY-ID = 'DCC'
 15520        AND PB-CI-ENTRY-STATUS = 'M'
 15521        MOVE +0                  TO PB-C-LF-REF-CALC
 15522     ELSE
 15523        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15524     END-IF
 15525
 15526     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15527         GO TO 3730-GET-AH-REMAIN-TERM.
 15528
 15529*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15530*       ADD +1                   TO PB-C-LF-REM-TERM
 15531*                                   CP-REMAINING-TERM
 15532*                                   CP-ORIGINAL-TERM.
 15533
 15534     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15535     MOVE '2'                    TO CP-EARNING-METHOD
 15536                                    CP-RATING-METHOD.
 15537     IF PB-COMPANY-ID = 'CID'
 15538        IF (CP-STATE-STD-ABBRV = 'MN')
 15539           AND (PB-CERT-EFF-DT > X'A4FF')
 15540           AND (WS-LF-EARNINGS-CALC = 'B')
 15541           MOVE '5'              TO CP-EARNING-METHOD
 15542           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15543        END-IF
 15544     END-IF
 15545     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15546                                        CP-REMAINING-BENEFIT
 15547                                        CP-RATING-BENEFIT-AMT.
 15548     IF CP-STATE-STD-ABBRV = 'OR'
 15549         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15550                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15551     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15552     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15553
 15554     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15555
 15556     IF CP-ERROR-RATE-IS-ZERO OR
 15557        CP-ERROR-RATE-NOT-FOUND
 15558        MOVE ER-2740             TO WS-ERROR
 15559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15560
 15561     IF CP-ERROR-RATE-FILE-NOTOPEN
 15562        MOVE ER-2617             TO WS-ERROR
 15563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15564
 15565     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 282
* EL050.cbl
 15566
 15567******************************************************************
 15568
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 283
* EL050.cbl
 15570 3730-GET-AH-REMAIN-TERM.
 15571     IF NO-AH-BENEFIT-MATCH  OR
 15572        WS-AH-BENEFIT-CD = ZEROS
 15573         GO TO 3770-CHECK-REFUNDS.
 15574
 15575     IF PB-CI-AH-LUMP-SUM-DISAB
 15576         IF  PB-C-AH-CANCEL-AMT = ZERO
 15577            IF NOT PB-COMP-AH-CANCEL
 15578             GO TO 3770-CHECK-REFUNDS.
 15579
 15580     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15581     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15582     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15583     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15584     MOVE PB-SV-STATE            TO CP-STATE.
 15585     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15586     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15587     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15588     MOVE '2'                    TO CP-PROCESS-TYPE.
 15589     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15590     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15591     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15592     IF (PB-COMPANY-ID = 'CID')
 15593        AND (CP-STATE-STD-ABBRV = 'WI')
 15594        MOVE '7'                 TO CP-REM-TERM-METHOD
 15595        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15596     ELSE
 15597        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15598        MOVE WS-REM-TRM-CALC-OPTION
 15599                                 TO CP-REM-TRM-CALC-OPTION
 15600     END-IF
 15601     IF (PB-COMPANY-ID = 'CID')
 15602        AND (CP-STATE-STD-ABBRV = 'MO')
 15603        AND (PB-CERT-EFF-DT >= X'9B41')
 15604        AND (PB-CERT-EFF-DT <= X'A2FB')
 15605        MOVE '7'                 TO CP-REM-TERM-METHOD
 15606        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15607     END-IF
 15608     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15609                                    CP-LOAN-TERM.
 15610     IF NOT CP-TERM-IS-DAYS
 15611         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15612
 15613     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15614
 15615     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15616
 15617     IF AH-COVERAGE-CANCELLED
 15618        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15619        NEXT SENTENCE
 15620      ELSE
 15621         GO TO 3770-CHECK-REFUNDS.
 15622
 15623 3740-GET-AH-REFUND.
 15624
 15625     IF PB-C-LF-CANCEL-VOIDED OR
 15626        PB-C-AH-CANCEL-VOIDED
 15627        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 284
* EL050.cbl
 15628
 15629     IF PB-COMPANY-ID = 'BOA'
 15630         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15631         GO TO 3770-CHECK-REFUNDS.
 15632
 15633     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15634*    MOVE ' '                    TO DC-OPTION-CODE
 15635     SET BIN-TO-GREG             TO TRUE
 15636     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15637     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15638                                    PB-C-AH-REM-TERM.
 15639     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15640     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15641
 15642     IF PB-COMPANY-ID EQUAL 'FLC'
 15643        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15644           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15645           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15646                    - CM-AH-ITD-AH-PMT)
 15647           IF PB-C-AH-REF-CALC LESS THAN +0
 15648              MOVE +0            TO PB-C-AH-REF-CALC
 15649              GO TO 3770-CHECK-REFUNDS
 15650           ELSE
 15651              GO TO 3770-CHECK-REFUNDS.
 15652
 15653     IF PB-COMPANY-ID = 'DCC'
 15654        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15655            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15656           MOVE 'S'              TO CP-EARNING-METHOD
 15657        END-IF
 15658     END-IF
 15659     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15660                            OR '4' OR '5' OR '6' OR '8'
 15661                            OR '9' OR 'G' OR 'S'
 15662        MOVE PB-C-AH-REFUND-OVERRIDE
 15663                                 TO CP-EARNING-METHOD.
 15664
 15665     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15666     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15667     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15668                                    CP-RATING-BENEFIT-AMT.
 15669     IF CP-STATE-STD-ABBRV = 'OR'
 15670         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15671                                         PB-CI-AH-TERM.
 15672     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15673     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15674     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15675     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15676     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15677     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15678
 15679     IF CP-STATE-STD-ABBRV = 'OH'
 15680        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15681                                AND 'CID' AND 'DCC')
 15682           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15683              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15684              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15685              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 285
* EL050.cbl
 15686           END-IF
 15687        END-IF
 15688        IF PB-COMPANY-ID = 'CID'
 15689           IF NO-LIFE-COVERAGE
 15690              IF CP-CRITICAL-PERIOD
 15691                 MOVE '2'       TO CP-EARNING-METHOD
 15692              ELSE
 15693                 MOVE '6'       TO CP-EARNING-METHOD
 15694              END-IF
 15695           ELSE
 15696              IF WS-LF-COVERAGE-TYPE = 'L'
 15697                 MOVE '2'       TO CP-EARNING-METHOD
 15698              ELSE
 15699                 IF (PB-CI-LF-TERM > +60) OR
 15700                    (WS-LF-EARNINGS-CALC = '5')
 15701                    IF CP-CRITICAL-PERIOD
 15702                       MOVE '2'  TO CP-EARNING-METHOD
 15703                    ELSE
 15704                       MOVE '6'  TO CP-EARNING-METHOD
 15705                    END-IF
 15706                 ELSE
 15707                    MOVE '1'     TO CP-EARNING-METHOD
 15708                 END-IF
 15709              END-IF
 15710           END-IF
 15711        END-IF
 15712     END-IF
 15713
 15714*    IF CP-STATE-STD-ABBRV = 'VA'
 15715*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15716*          IF CP-ORIGINAL-TERM GREATER 61
 15717*             MOVE '6' TO CP-EARNING-METHOD
 15718*          ELSE
 15719*             MOVE '1' TO CP-EARNING-METHOD.
 15720
 15721     IF WS-DEFAULT-APR NOT NUMERIC
 15722         MOVE ZEROS TO WS-DEFAULT-APR.
 15723     IF CP-EARN-AS-NET-PAY
 15724         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15725            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15726                MOVE WS-DEFAULT-APR
 15727                                 TO  CP-LOAN-APR
 15728                MOVE ER-3780     TO  WS-ERROR
 15729                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15730            ELSE
 15731                MOVE ER-3781     TO  WS-ERROR
 15732                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15733     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15734     IF PB-COMPANY-ID = 'DCC'
 15735        AND CP-CANCEL-REASON = 'R'
 15736        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15737        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15738     END-IF
 15739     IF PB-COMPANY-ID = 'DCC'
 15740        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15741        AND (CP-EARNING-METHOD = 'D')
 15742        AND (CP-CANCEL-REASON NOT = 'R')
 15743        MOVE ' '                 TO DD-IU-SW
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 286
* EL050.cbl
 15744        MOVE ' '                 TO PDEF-MASTER-SW
 15745        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15746        MOVE PB-STATE            TO ERPDEF-STATE
 15747        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15748        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15749        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15750        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15751        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15752        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15753        IF PDEF-MASTER-FOUND
 15754           MOVE 'N'              TO PDEF-MASTER-SW
 15755           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15756           IF PDEF-MASTER-FOUND
 15757              IF (ERPDEF-KEY-SAVE (1:16) =
 15758                           PD-CONTROL-PRIMARY (1:16))
 15759                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15760                 CONTINUE
 15761              ELSE
 15762                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15763                 IF (ERPDEF-KEY-SAVE (1:16) =
 15764                           PD-CONTROL-PRIMARY (1:16))
 15765                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15766                    CONTINUE
 15767                 ELSE
 15768                    MOVE ER-2740 TO WS-ERROR
 15769                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15770                    GO TO 3770-CHECK-REFUNDS
 15771                 END-IF
 15772              END-IF
 15773
 15774              PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15775                 (V1 > +8)
 15776                 OR (PD-PROD-CODE (V1) = 'I')
 15777              END-PERFORM
 15778              IF V1 < +9
 15779                 SET DD-IU-PRESENT        TO TRUE
 15780              END-IF
 15781
 15782              EVALUATE TRUE
 15783                 WHEN CP-ORIGINAL-TERM > +168
 15784                    MOVE 15               TO V1
 15785                 WHEN CP-ORIGINAL-TERM > +156
 15786                    MOVE 14               TO V1
 15787                 WHEN CP-ORIGINAL-TERM > +144
 15788                    MOVE 13               TO V1
 15789                 WHEN CP-ORIGINAL-TERM > +132
 15790                    MOVE 12               TO V1
 15791                 WHEN CP-ORIGINAL-TERM > +120
 15792                    MOVE 11               TO V1
 15793                 WHEN CP-ORIGINAL-TERM > +108
 15794                    MOVE 10               TO V1
 15795                 WHEN CP-ORIGINAL-TERM > +96
 15796                    MOVE 9                TO V1
 15797                 WHEN CP-ORIGINAL-TERM > +84
 15798                    MOVE 8                TO V1
 15799                 WHEN CP-ORIGINAL-TERM > +72
 15800                    MOVE 7                TO V1
 15801                 WHEN CP-ORIGINAL-TERM > +60
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 287
* EL050.cbl
 15802                    MOVE 6                TO V1
 15803                 WHEN CP-ORIGINAL-TERM > +48
 15804                    MOVE 5                TO V1
 15805                 WHEN CP-ORIGINAL-TERM > +36
 15806                    MOVE 4                TO V1
 15807                 WHEN CP-ORIGINAL-TERM > +24
 15808                    MOVE 3                TO V1
 15809                 WHEN CP-ORIGINAL-TERM > +12
 15810                    MOVE 2                TO V1
 15811                 WHEN OTHER
 15812                    MOVE 1                TO V1
 15813              END-EVALUATE
 15814
 15815              EVALUATE TRUE
 15816*                WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15817*                   < +13)
 15818*                   AND (DD-IU-PRESENT)
 15819*                   MOVE 2                TO V2
 15820*                WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15821*                   MOVE 1                TO V2
 15822                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15823                    MOVE 2                TO V2
 15824                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15825                    MOVE 3                TO V2
 15826                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15827                    MOVE 4                TO V2
 15828                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15829                    MOVE 5                TO V2
 15830                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15831                    MOVE 6                TO V2
 15832                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15833                    MOVE 7                TO V2
 15834                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15835                    MOVE 8                TO V2
 15836                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +10
 15837                    MOVE 9                TO V2
 15838                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +12
 15839                    MOVE 10               TO V2
 15840                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15841                    MOVE 11               TO V2
 15842                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +14
 15843                    MOVE 12               TO V2
 15844                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +15
 15845                    MOVE 13               TO V2
 15846                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +16
 15847                    MOVE 14               TO V2
 15848                 WHEN OTHER
 15849                    MOVE 15               TO V2
 15850              END-EVALUATE
 15851
 15852              MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15853                                       TO CP-DDF-LO-FACT
 15854              MOVE PD-UEP-FACTOR (V1 V2)
 15855                                       TO CP-DDF-HI-FACT
 15856
 15857              MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15858              MOVE CM-AH-CLP     TO CP-DDF-CLP
 15859              COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 288
* EL050.cbl
 15860                 (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15861              MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15862              MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15863              COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15864                 + PD-1ST-YR-ADMIN-ALLOW
 15865
 15866              MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15867*             IF PI-CLP-YN = 'Y'
 15868*                MOVE 'C'              TO CP-DDF-SPEC-CALC
 15869*                MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 15870*                MOVE ZEROS            TO CP-DDF-ADDL-CLP
 15871*             END-IF
 15872
 15873              IF DD-IU-PRESENT
 15874                 MOVE 'I'              TO CP-EARNING-METHOD
 15875              END-IF
 15876              MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15877                                           CP-CLP-RATE-UP
 15878              IF CP-IU-RATE-UP NOT = ZEROS
 15879                 COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 15880                    + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 15881                 COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 15882                    / (1 - WS-WORK-FACT)
 15883              END-IF
 15884           END-IF
 15885           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15886        END-IF
 15887     END-IF
 15888     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15889
 15890     IF CP-REFUND-TYPE-USED NOT = SPACE
 15891         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 15892
 15893     IF CP-ERROR-RATE-IS-ZERO OR
 15894        CP-ERROR-RATE-NOT-FOUND
 15895        MOVE ER-2740             TO WS-ERROR
 15896        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15897
 15898     IF CP-ERROR-RATE-FILE-NOTOPEN
 15899        MOVE ER-2617             TO WS-ERROR
 15900        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15901     IF PB-COMPANY-ID = 'DCC'
 15902        AND PB-CI-ENTRY-STATUS = 'M'
 15903        MOVE +0                  TO PB-C-AH-REF-CALC
 15904     ELSE
 15905        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 15906     END-IF
 15907     IF PB-COMPANY-ID = 'DCC'
 15908        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15909        AND (CP-EARNING-METHOD = 'D' OR 'I')
 15910        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15911        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 15912        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 15913        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 15914        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 15915        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 15916        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 15917     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 289
* EL050.cbl
 15918     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 290
* EL050.cbl
 15920
 15921 3770-CHECK-REFUNDS.
 15922
 15923     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 15924        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 15925           MOVE ER-2766          TO WS-ERROR
 15926           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15927           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 15928           IF PB-C-LF-REF-CALC LESS THAN ZERO
 15929              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 15930
 15931     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 15932        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 15933           MOVE ER-2766          TO WS-ERROR
 15934           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15935           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 15936           IF PB-C-AH-REF-CALC LESS THAN ZERO
 15937              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 15938
 15939     IF PB-COMP-LF-CANCEL
 15940        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 15941        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15942           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 15943              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 15944
 15945     IF PB-COMP-AH-CANCEL
 15946        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 15947        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15948           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 15949              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 15950
 15951     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 15952             GIVING WS-UNSIGN-WRK1
 15953     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 15954             GIVING WS-UNSIGN-WRK2.
 15955
 15956     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15957         MOVE ZERO TO WS-UNSIGN-WRK1.
 15958
 15959     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15960         MOVE ZERO TO WS-UNSIGN-WRK2.
 15961
 15962     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 15963
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 291
* EL050.cbl
 15965
 15966 3772-CONTINUE.
 15967
 15968**********************************
 15969*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 15970*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 15971*** DOUBLES THE TOLERANCE AMOUNT.
 15972***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 15973**********************************
 15974     IF PB-COMPANY-ID = 'MON'
 15975     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 15976         IF WS-REF-REJECT-SW = SPACE
 15977             MOVE ER-2754        TO WS-ERROR
 15978             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15979           ELSE
 15980             MOVE ER-2736        TO WS-ERROR
 15981             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15982**********************************
 15983
 15984 3773-CONTINUE.
 15985
 15986     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 15987        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15988           MOVE ER-2723          TO WS-ERROR
 15989           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15990
 15991     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 15992        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15993           MOVE ER-2724          TO WS-ERROR
 15994           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15995
 15996     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 15997         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 15998             (1 + WS-LF-REFUND-OVS-PCT)
 15999     ELSE
 16000         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16001
 16002     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16003         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16004             (1 - WS-TOL-LF-REFUND-PCT)
 16005     ELSE
 16006         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16007
 16008     IF (PB-COMPANY-ID = 'DCC')
 16009        AND (PB-CI-ENTRY-STATUS = 'M')
 16010        AND (PB-C-LF-CANCEL-AMT > +0)
 16011        MOVE ER-3843             TO WS-ERROR
 16012        PERFORM 9900-ERROR-FORMAT
 16013                                 THRU 9900-EXIT
 16014     END-IF
 16015     EVALUATE TRUE
 16016        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16017           CONTINUE
 16018        WHEN PB-C-LF-CANCEL-AMT = +0
 16019                 AND PB-C-LF-REF-CALC > +0
 16020           CONTINUE
 16021        WHEN WS-LF-REFUND-OVS-AMT = 0
 16022                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 292
* EL050.cbl
 16023           CONTINUE
 16024        WHEN OTHER
 16025           IF WS-TOL-LF-REFUND  = +0
 16026              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16027           END-IF
 16028           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16029                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16030                          (PB-C-LF-CANCEL-AMT))
 16031              CONTINUE
 16032           ELSE
 16033              IF WS-LF-REFUND-OVS-AMT = +0
 16034                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16035              END-IF
 16036              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16037                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16038                                       PB-C-LF-CANCEL-AMT)
 16039                 CONTINUE
 16040              ELSE
 16041                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16042                   MOVE ER-2754   TO  WS-ERROR
 16043                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16044                 ELSE
 16045                    MOVE ER-2736   TO  WS-ERROR
 16046                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16047                 END-IF
 16048              END-IF
 16049           END-IF
 16050     END-EVALUATE.
 16051
 16052     EVALUATE TRUE
 16053        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16054           CONTINUE
 16055        WHEN PB-C-LF-CANCEL-AMT = +0
 16056                 AND PB-C-LF-REF-CALC > +0
 16057           CONTINUE
 16058        WHEN OTHER
 16059           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16060               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16061              CONTINUE
 16062           ELSE
 16063              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16064               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16065                CONTINUE
 16066              ELSE
 16067                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16068                     MOVE ER-2754   TO  WS-ERROR
 16069                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16070                 ELSE
 16071                     MOVE ER-2736   TO  WS-ERROR
 16072                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16073                 END-IF
 16074              END-IF
 16075           END-IF
 16076     END-EVALUATE.
 16077
 16078     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16079         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16080             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 293
* EL050.cbl
 16081     ELSE
 16082         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16083
 16084     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16085         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16086             (1 - WS-TOL-AH-REFUND-PCT)
 16087     ELSE
 16088         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16089
 16090     IF (PB-COMPANY-ID = 'DCC')
 16091        AND (PB-CI-ENTRY-STATUS = 'M')
 16092        AND (PB-C-AH-CANCEL-AMT > +0)
 16093        MOVE ER-3843             TO WS-ERROR
 16094        PERFORM 9900-ERROR-FORMAT
 16095                                 THRU 9900-EXIT
 16096     END-IF
 16097     EVALUATE TRUE
 16098        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16099           CONTINUE
 16100*       WHEN PB-C-AH-REF-CALC = +0 AND
 16101*                  PB-C-AH-CANCEL-AMT > +0
 16102        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16103                   PB-C-AH-REF-CALC > +0
 16104           CONTINUE
 16105        WHEN WS-AH-REFUND-OVS-AMT = +0
 16106                AND WS-TOL-AH-REFUND = +0
 16107           CONTINUE
 16108        WHEN OTHER
 16109           IF WS-TOL-AH-REFUND = +0
 16110              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16111           END-IF
 16112           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16113               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16114                                         PB-C-AH-CANCEL-AMT)
 16115              CONTINUE
 16116           ELSE
 16117              IF WS-AH-REFUND-OVS-AMT = +0
 16118                 MOVE +9999999.99 TO
 16119                         WS-AH-REFUND-OVS-AMT
 16120              END-IF
 16121              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16122                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16123                                         PB-C-AH-CANCEL-AMT)
 16124                 CONTINUE
 16125              ELSE
 16126                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16127                    MOVE ER-2754   TO  WS-ERROR
 16128                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16129                 ELSE
 16130                    MOVE ER-2736   TO  WS-ERROR
 16131                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16132                 END-IF
 16133              END-IF
 16134           END-IF
 16135     END-EVALUATE.
 16136
 16137     EVALUATE TRUE
 16138        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 294
* EL050.cbl
 16139           CONTINUE
 16140*       WHEN PB-C-AH-REF-CALC > +0 AND
 16141*                  PB-C-AH-CANCEL-AMT = +0
 16142        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16143                   PB-C-AH-REF-CALC = +0
 16144           CONTINUE
 16145        WHEN OTHER
 16146           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16147               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16148              CONTINUE
 16149           ELSE
 16150              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16151                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16152                 CONTINUE
 16153              ELSE
 16154                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16155                     MOVE ER-2754   TO  WS-ERROR
 16156                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16157                 ELSE
 16158                     MOVE ER-2736   TO  WS-ERROR
 16159                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16160                 END-IF
 16161              END-IF
 16162           END-IF
 16163     END-EVALUATE.
 16164
 16165     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16166        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16167        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16168           AND  PB-C-LF-REF-CALC < +1.00
 16169           AND  PB-C-AH-REF-CALC < +1.00
 16170           CONTINUE
 16171        ELSE
 16172           IF (PB-COMPANY-ID = 'DCC')
 16173              AND (PB-CI-ENTRY-STATUS = 'M')
 16174              CONTINUE
 16175           ELSE
 16176              MOVE ER-2741       TO WS-ERROR
 16177              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16178           END-IF
 16179        END-IF
 16180     END-IF
 16181
 16182     IF (PB-C-LF-CANCEL-AMT = ZERO
 16183        AND WS-LF-BENEFIT-CD NOT = ZERO
 16184        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16185        AND PB-C-LF-REF-CALC NOT = ZERO)
 16186        OR
 16187        (PB-C-LF-CANCEL-AMT = ZERO
 16188        AND WS-LF-BENEFIT-CD NOT = ZERO
 16189        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16190             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16191                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16192                NEXT SENTENCE
 16193             ELSE
 16194                MOVE ER-2739        TO WS-ERROR
 16195                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16196
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 295
* EL050.cbl
 16197     IF (PB-C-AH-CANCEL-AMT = ZERO
 16198        AND WS-AH-BENEFIT-CD NOT = ZERO
 16199        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16200        AND PB-C-AH-REF-CALC NOT = ZERO)
 16201        OR
 16202        (PB-C-AH-CANCEL-AMT = ZERO
 16203        AND WS-AH-BENEFIT-CD NOT = ZERO
 16204        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16205             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16206                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16207                NEXT SENTENCE
 16208             ELSE
 16209                MOVE ER-2738        TO WS-ERROR
 16210                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16211
 16212 3775-OVER-REF-CHK.
 16213
 16214     IF PB-CI-ENTRY-STATUS = '5'
 16215        GO TO 3780-UPDATE-CANCEL-CERT.
 16216
 16217     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16218                              PB-CI-LF-ALT-PREMIUM-AMT.
 16219
 16220     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16221        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16222                                 PB-C-LF-REF-CALC
 16223      ELSE
 16224        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16225                                 PB-C-LF-CANCEL-AMT.
 16226
 16227     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16228        MOVE ER-2755             TO WS-ERROR
 16229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16230
 16231     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16232
 16233     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16234        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16235                                 PB-C-AH-REF-CALC
 16236      ELSE
 16237        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16238                                 PB-C-AH-CANCEL-AMT.
 16239
 16240     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16241        MOVE ER-2778             TO WS-ERROR
 16242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16243
 16244     IF PB-CI-OB-FLAG NOT = 'Z'
 16245        NEXT SENTENCE
 16246       ELSE
 16247         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16248            MOVE ER-2757           TO WS-ERROR
 16249            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16250
 16251 3780-UPDATE-CANCEL-CERT.
 16252
 16253     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16254        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 296
* EL050.cbl
 16255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16256
 16257     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16258         MOVE ER-2729              TO WS-ERROR
 16259         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16260
 16261     IF PB-CI-LF-BENEFIT-CD = ZERO
 16262         GO TO 3780-UPDATE-CONT-1.
 16263
 16264     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16265         GO TO 3780-UPDATE-CONT-1.
 16266
 16267     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16268       AND
 16269        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16270       AND
 16271        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16272       AND
 16273        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16274            NEXT SENTENCE
 16275       ELSE
 16276        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16277          AND
 16278***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16279***       AND
 16280           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16281            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16282               MOVE ER-2730      TO WS-ERROR
 16283               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16284               GO TO 3999-END-EDIT
 16285            ELSE
 16286               GO TO 3999-END-EDIT
 16287        ELSE
 16288            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16289               MOVE ER-2765           TO WS-ERROR
 16290               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16291               GO TO 3785-CHECK-NH.
 16292*              GO TO 3999-END-EDIT.
 16293
 16294 3780-UPDATE-CONT-1.
 16295     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16296
 16297     IF PB-CI-AH-BENEFIT-CD = ZERO
 16298         GO TO 3780-UPDATE-CONT-2.
 16299
 16300     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16301         GO TO 3780-UPDATE-CONT-2.
 16302
 16303     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16304
 16305     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16306       AND
 16307        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16308       AND
 16309        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16310       AND
 16311        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16312            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 297
* EL050.cbl
 16313       ELSE
 16314        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16315          AND
 16316***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16317***       AND
 16318           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16319           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16320            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16321               MOVE ER-2773      TO WS-ERROR
 16322               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16323               GO TO 3999-END-EDIT
 16324            ELSE
 16325               GO TO 3999-END-EDIT
 16326            END-IF
 16327           ELSE
 16328             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16329                MOVE ER-2890 TO WS-ERROR
 16330                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16331                GO TO 3999-END-EDIT
 16332             ELSE
 16333                GO TO 3785-CHECK-NH
 16334             END-IF
 16335           END-IF
 16336          ELSE
 16337            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16338              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16339                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16340                   MOVE ER-2890 TO WS-ERROR
 16341                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16342                   GO TO 3999-END-EDIT
 16343                ELSE
 16344                   MOVE ER-2765 TO WS-ERROR
 16345                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16346                   GO TO 3785-CHECK-NH
 16347                END-IF
 16348              ELSE
 16349               MOVE ER-2765      TO WS-ERROR
 16350               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16351               GO TO 3785-CHECK-NH.
 16352*              GO TO 3999-END-EDIT.
 16353
 16354 3780-UPDATE-CONT-2.
 16355
 16356     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16357        AND WS-LF-BENEFIT-CD = ZERO
 16358           MOVE ER-2743           TO WS-ERROR
 16359           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16360
 16361     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16362        AND WS-AH-BENEFIT-CD = ZERO
 16363           MOVE ER-2744           TO WS-ERROR
 16364           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16365
 16366     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16367        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16368        AND
 16369        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16370         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 298
* EL050.cbl
 16371           MOVE ER-2746           TO WS-ERROR
 16372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16373
 16374     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16375       AND
 16376        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16377             MOVE ER-2737        TO WS-ERROR
 16378             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16379
 16380     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16381       AND
 16382        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16383             MOVE ER-2737        TO WS-ERROR
 16384             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16385
 16386     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16387         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16388             OR 'CID' OR 'DCC'
 16389             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16390         ELSE
 16391             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16392                 MOVE ER-2768    TO WS-ERROR
 16393                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16394             ELSE
 16395                 MOVE ER-2756    TO WS-ERROR
 16396                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16397
 16398     IF CERT-PEND-ISSUE-RETURNED
 16399        MOVE ER-2772             TO WS-ERROR
 16400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16401 3785-CHECK-NH.
 16402     IF PB-STATE NOT = 'NH'
 16403        GO TO 3999-END-EDIT
 16404     END-IF
 16405
 16406     MOVE ER-2796                TO WS-ERROR
 16407     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16408     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16409        OR (CM-NH-INTERFACE-SW = 'Y')
 16410        MOVE ER-2793             TO WS-ERROR
 16411        PERFORM 9900-ERROR-FORMAT
 16412                                 THRU 9900-EXIT
 16413     END-IF
 16414     MOVE +0                     TO WS-PAYMENT-AMT
 16415     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16416        GO TO 3999-END-EDIT
 16417     END-IF
 16418     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16419        GO TO 3999-END-EDIT
 16420     END-IF
 16421     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16422     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16423     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16424        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16425     END-IF
 16426     MOVE '1'                    TO DC-OPTION-CODE
 16427     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16428     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 299
* EL050.cbl
 16429        IF DC-ELAPSED-DAYS < +16
 16430           GO TO 3999-END-EDIT
 16431        END-IF
 16432     END-IF
 16433     MOVE +0                     TO DC-ELAPSED-DAYS
 16434     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16435     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16436     MOVE '1'                    TO DC-OPTION-CODE
 16437     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16438     IF NO-CONVERSION-ERROR
 16439        IF DC-ELAPSED-DAYS > +30
 16440           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16441        ELSE
 16442           GO TO 3999-END-EDIT
 16443        END-IF
 16444     ELSE
 16445        GO TO 3999-END-EDIT
 16446     END-IF
 16447     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16448        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16449           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16450     IF WS-PAYMENT-AMT < 600.00
 16451        GO TO 3999-END-EDIT
 16452     END-IF
 16453     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16454
 16455     IF (ERMAIL-FOUND = ' ')
 16456         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16457         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16458        GO TO 3999-END-EDIT
 16459     END-IF
 16460     MOVE ER-2795                TO WS-ERROR
 16461     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16462
 16463     GO TO 3999-END-EDIT.
 16464******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 300
* EL050.cbl
 16466 3990-FILES-NOT-OPEN.
 16467
 16468     MOVE ER-2617                TO WS-ERROR.
 16469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16470     GO TO 9990-RETURN.
 16471
 16472 3999-END-EDIT.
 16473
 16474     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16475
 16476     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16477         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16478         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16479             PERFORM 9250-UNLOCK-RETURN
 16480             GO TO 9990-RETURN
 16481          ELSE
 16482             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16483             GO TO 9990-RETURN.
 16484
 16485     IF PB-CANCELLATION
 16486          GO TO 9990-RETURN.
 16487
 16488     IF CERT-WAS-NOT-FOUND
 16489        MOVE SPACES              TO CERTIFICATE-MASTER.
 16490
 16491     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16492
 16493     IF CERT-WAS-FOUND
 16494         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16495             PERFORM 9250-UNLOCK-RETURN
 16496          ELSE
 16497            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16498      ELSE
 16499         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16500
 16501     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16502        IF PB-COMPANY-ID = 'DCC' AND
 16503           (PB-CARRIER = '2' OR '4' OR '6')
 16504              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16505        END-IF
 16506     END-IF.
 16507
 16508     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16509     IF ((PB-COMPANY-ID = 'DCC')
 16510        AND (WS-NO-SECURE-PAY))
 16511                  OR
 16512        (WS-LF-SPECIAL-CALC-CD = 'O'
 16513        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16514        SET SKIP-ADDR-EDIT       TO TRUE
 16515     END-IF
 16516     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16517        AND (NOT SKIP-ADDR-EDIT)
 16518        MOVE ER-2963             TO WS-ERROR
 16519        PERFORM 9900-ERROR-FORMAT
 16520                                 THRU 9900-EXIT
 16521        GO TO 9990-RETURN
 16522     END-IF
 16523     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 301
* EL050.cbl
 16524     IF ERPNDM-FOUND NOT = 'X'
 16525        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16526           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16527           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16528           AND (NOT SKIP-ADDR-EDIT)
 16529           MOVE ER-2694          TO WS-ERROR
 16530           PERFORM 9900-ERROR-FORMAT
 16531                                 THRU 9900-EXIT
 16532        END-IF
 16533        MOVE ' '                 TO STATE-RECORD-ERROR
 16534        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16535        MOVE PM-STATE            TO CNTL-ACCESS
 16536        MOVE '3'                 TO CNTL-REC-TYPE
 16537        MOVE +0                  TO CNTL-SEQ-NO
 16538        MOVE '0'                 TO RC-SW-2
 16539        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16540        IF (NO-STATE-RECORD)
 16541           OR (CF-RECORD-TYPE NOT = '3')
 16542           OR (PM-STATE NOT = CF-STATE-CODE)
 16543           IF (PM-STATE = SPACES)
 16544              AND (SKIP-ADDR-EDIT)
 16545              CONTINUE
 16546           ELSE
 16547              MOVE ER-2963       TO WS-ERROR
 16548              PERFORM 9900-ERROR-FORMAT
 16549                                 THRU 9900-EXIT
 16550           END-IF
 16551        END-IF
 16552        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16553           MOVE ER-2883          TO WS-ERROR
 16554           PERFORM 9900-ERROR-FORMAT
 16555                                 THRU 9900-EXIT
 16556        END-IF
 16557        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16558           MOVE ' '                 TO STATE-RECORD-ERROR
 16559           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16560           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16561           MOVE '3'                 TO CNTL-REC-TYPE
 16562           MOVE +0                  TO CNTL-SEQ-NO
 16563           MOVE '0'                 TO RC-SW-2
 16564           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16565           IF NO-STATE-RECORD
 16566              OR (CF-RECORD-TYPE NOT = '3')
 16567              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16568              MOVE ER-2964          TO WS-ERROR
 16569              PERFORM 9900-ERROR-FORMAT
 16570                                    THRU 9900-EXIT
 16571           END-IF
 16572        END-IF
 16573     ELSE
 16574        IF NOT SKIP-ADDR-EDIT
 16575           MOVE ER-2393          TO WS-ERROR
 16576           PERFORM 9900-ERROR-FORMAT
 16577                                 THRU 9900-EXIT
 16578        END-IF
 16579     END-IF
 16580
 16581     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 302
* EL050.cbl
 16582
 16583     IF (ERMAIL-FOUND = ' ' AND
 16584        ERPNDM-FOUND = ' ')
 16585        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16586           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16587           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16588          OR
 16589           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16590          OR
 16591           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16592           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16593           GO TO 3999-UNLOCK-ERMAIL.
 16594
 16595     IF ERPNDM-FOUND = 'X'
 16596        GO TO 3999-UNLOCK-ERMAIL.
 16597
 16598     IF PM-INSURED-LAST-NAME      = SPACES
 16599        AND PM-INSURED-FIRST-NAME = SPACES
 16600        AND PM-ADDRESS-LINE-1     = SPACES
 16601        AND PM-ADDRESS-LINE-2     = SPACES
 16602        AND PM-CITY-STATE         = SPACES
 16603        AND PM-CRED-BENE-NAME     = SPACES
 16604        AND PM-CRED-BENE-ADDR     = SPACES
 16605        AND PM-CRED-BENE-CTYST    = SPACES
 16606        GO TO 3999-UNLOCK-ERMAIL
 16607     END-IF
 16608
 16609     MOVE SPACES                 TO MAILING-DATA.
 16610
 16611     MOVE 'MA'                   TO MA-RECORD-ID.
 16612     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16613     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16614     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16615     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16616     MOVE PB-SV-STATE            TO MA-STATE.
 16617     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16618     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16619
 16620     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16621     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16622
 16623     IF ERMAIL-FOUND = ' '
 16624        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16625     ELSE
 16626        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16627        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16628        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16629
 16630     GO TO 9990-RETURN.
 16631
 16632 3999-UNLOCK-ERMAIL.
 16633     IF ERMAIL-FOUND = ' '
 16634        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16635
 16636     GO TO 9990-RETURN.
 16637******************************************************************
 16638
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 303
* EL050.cbl
 16640 4000-UPDATE-CANCELLED-CERT.
 16641     IF CERT-WAS-NOT-FOUND
 16642        GO TO 4299-EXIT.
 16643
 16644*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16645     IF PB-C-NH-INT-ON-REFS > ZEROS
 16646        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16647     END-IF
 16648     IF PB-C-REF-INTERFACE-SW = 'Y'
 16649        MOVE PB-C-REF-INTERFACE-SW
 16650                                 TO CM-NH-INTERFACE-SW
 16651     END-IF
 16652     IF PB-C-POST-CARD-IND = 'Y'
 16653        MOVE +8                  TO SUB
 16654        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16655        IF ERMAIL-FOUND = ' '
 16656           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16657              (SUB > +7)
 16658              OR (MA-MAIL-STATUS (SUB) = '1')
 16659           END-PERFORM
 16660        END-IF
 16661        IF (SUB > +7)
 16662           OR (ERMAIL-FOUND = 'X')
 16663           MOVE ER-3789          TO WS-ERROR
 16664           PERFORM 9900-ERROR-FORMAT
 16665                                 THRU 9900-EXIT
 16666        END-IF
 16667     ELSE
 16668        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16669     END-IF
 16670     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16671
 16672     IF PB-CI-OB-FLAG = 'Z'
 16673        GO TO 4150-SUMMARY-CERT-CANCEL.
 16674
 16675     IF PB-C-LF-CANCEL-VOIDED
 16676         PERFORM 4200-REVERSE-LF-CANCEL.
 16677     IF PB-C-AH-CANCEL-VOIDED
 16678         PERFORM 4200-REVERSE-AH-CANCEL.
 16679
 16680 4100-APPLY-LF-CANCEL.
 16681
 16682     MOVE +0                     TO WS-SUB.
 16683
 16684 4100-CHECK-LF-ERRORS.
 16685
 16686     ADD +1                       TO WS-SUB.
 16687
 16688     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16689        IF LF-COVERAGE-CANCELLED
 16690           GO TO 4100-LF-CANCEL-CONT
 16691        ELSE
 16692           GO TO 4100-UPDATE-LF-COVERAGE.
 16693
 16694     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16695                                   ER-2729 OR
 16696                                   ER-2730 OR
 16697                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 304
* EL050.cbl
 16698                                   ER-2732 OR
 16699                                   ER-2737 OR
 16700                                   ER-2740 OR
 16701                                   ER-2743 OR
 16702                                   ER-2749 OR
 16703                                   ER-2750 OR
 16704                                   ER-2755 OR
 16705                                   ER-2757 OR
 16706                                   ER-2760 OR
 16707                                   ER-2772 OR
 16708                                   ER-2774 OR
 16709                                   ER-2776 OR
 16710                                   ER-2794
 16711        GO TO 4100-UPDATE-LF-COVERAGE.
 16712
 16713     GO TO 4100-CHECK-LF-ERRORS.
 16714
 16715 4100-UPDATE-LF-COVERAGE.
 16716
 16717     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16718     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16719     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16720        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16721     END-IF
 16722     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16723                                      TO CM-CREDIT-INTERFACE-SW-2.
 16724     IF CM-LF-CANCEL-DT = LOW-VALUE
 16725         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16726
 16727     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16728         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16729                                         CM-LF-STATUS-AT-CANCEL.
 16730
 16731     GO TO 4100-APPLY-AH-CANCEL.
 16732
 16733 4100-LF-CANCEL-CONT.
 16734     IF PB-C-LF-CANCEL-VOIDED
 16735         GO TO 4100-APPLY-AH-CANCEL.
 16736
 16737     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16738         GO TO 4100-APPLY-AH-CANCEL.
 16739
 16740     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16741        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16742           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16743        ELSE
 16744           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16745
 16746     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16747     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16748
 16749     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16750         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16751
 16752     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16753        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16754         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16755         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 305
* EL050.cbl
 16756
 16757     IF PB-RECORD-RETURNED
 16758        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16759      ELSE
 16760        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16761
 16762 4100-APPLY-AH-CANCEL.
 16763
 16764     MOVE +0                      TO WS-SUB.
 16765
 16766 4100-CHECK-AH-ERRORS.
 16767
 16768     ADD +1                       TO WS-SUB.
 16769
 16770     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16771        IF AH-COVERAGE-CANCELLED
 16772           GO TO 4100-AH-CANCEL-CONT
 16773        ELSE
 16774           GO TO 4100-UPDATE-AH-COVERAGE.
 16775
 16776     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16777                                   ER-2729 OR
 16778                                   ER-2732 OR
 16779                                   ER-2737 OR
 16780                                   ER-2740 OR
 16781                                   ER-2744 OR
 16782                                   ER-2749 OR
 16783                                   ER-2750 OR
 16784                                   ER-2755 OR
 16785                                   ER-2757 OR
 16786                                   ER-2760 OR
 16787                                   ER-2771 OR
 16788                                   ER-2772 OR
 16789                                   ER-2773 OR
 16790                                   ER-2775 OR
 16791                                   ER-2777 OR
 16792                                   ER-2794
 16793        GO TO 4100-UPDATE-AH-COVERAGE.
 16794
 16795     GO TO 4100-CHECK-AH-ERRORS.
 16796
 16797 4100-UPDATE-AH-COVERAGE.
 16798
 16799     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16800     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16801     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16802     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16803                                      TO CM-CREDIT-INTERFACE-SW-2.
 16804     IF CM-AH-CANCEL-DT = LOW-VALUE
 16805         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16806
 16807     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16808         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16809                                         CM-AH-STATUS-AT-CANCEL.
 16810
 16811     IF LF-COVERAGE-CANCELLED
 16812         IF PB-RECORD-RETURNED
 16813              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 306
* EL050.cbl
 16814          ELSE
 16815              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16816
 16817     GO TO 4299-EXIT.
 16818
 16819 4100-AH-CANCEL-CONT.
 16820     IF PB-C-AH-CANCEL-VOIDED
 16821         GO TO 4299-EXIT.
 16822
 16823     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16824         GO TO 4299-EXIT.
 16825
 16826     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16827        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16828           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16829        ELSE
 16830           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16831
 16832     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16833     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16834
 16835     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16836         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16837
 16838     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16839         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16840         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16841
 16842     IF PB-RECORD-RETURNED
 16843        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16844      ELSE
 16845        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16846
 16847     GO TO 4299-EXIT.
 16848
 16849 4150-SUMMARY-CERT-CANCEL.
 16850     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16851
 16852     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16853        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16854                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16855     ELSE
 16856        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16857                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16858
 16859     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16860        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16861                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16862     ELSE
 16863        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16864                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16865
 16866     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16867        NEXT SENTENCE
 16868     ELSE
 16869        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16870
 16871     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 307
* EL050.cbl
 16872
 16873 4200-REVERSE-LF-CANCEL.
 16874     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 16875
 16876     IF CM-LF-CANCEL-APPLIED
 16877        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16878        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16879        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16880
 16881     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16882
 16883     IF PB-RECORD-RETURNED
 16884        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16885       ELSE
 16886        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16887
 16888 4200-REVERSE-LF-EXIT.
 16889       EXIT.
 16890
 16891 4200-REVERSE-AH-CANCEL.
 16892     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 16893
 16894     IF CM-AH-CANCEL-APPLIED
 16895        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 16896        MOVE SPACES                TO CM-AH-EXIT-BATCH
 16897        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 16898
 16899     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 16900
 16901     IF PB-RECORD-RETURNED
 16902        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16903       ELSE
 16904        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16905
 16906 4200-REVERSE-AH-EXIT.
 16907       EXIT.
 16908
 16909 4299-EXIT.
 16910       EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 308
* EL050.cbl
 16912
 16913 4500-UPDATE-NEW-CERT.
 16914     IF CERT-WAS-FOUND
 16915         NEXT SENTENCE
 16916       ELSE
 16917         GO TO 4520-BUILD-NEW-KEY.
 16918
 16919     IF  CLASIC-CREATED-CERT
 16920         GO TO 4999-EXIT.
 16921
 16922     IF  CERT-WAS-CREATED-FOR-CLAIM
 16923         GO TO 4520-BUILD-NEW-KEY.
 16924
 16925     IF CERT-ADDED-BATCH
 16926        IF CM-RECORD-ID = 'CM'
 16927            GO TO 4999-EXIT.
 16928
 16929 4520-BUILD-NEW-KEY.
 16930* BUILD CONTROL PRIMARY
 16931
 16932     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 16933                                       CM-COMPANY-CD-A1
 16934                                       CM-COMPANY-CD-A2
 16935                                       CM-COMPANY-CD-A4
 16936                                       CM-COMPANY-CD-A5.
 16937
 16938     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 16939     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 16940     MOVE PB-SV-STATE               TO CM-STATE.
 16941     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 16942     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 16943     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 16944     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 16945
 16946     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 16947
 16948     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 16949     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 16950     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 16951     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 16952
 16953     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 16954        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 16955
 16956     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 16957         MOVE PB-SV-STATE            TO CM-SSN-STATE
 16958         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 16959         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 16960         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 16961     ELSE
 16962         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 16963
 16964     IF PB-COMPANY-ID   EQUAL  'CRI'
 16965         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 16966         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 16967         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 16968         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 16969         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 309
* EL050.cbl
 16970
 16971     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 16972        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 16973         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 16974
 16975     IF PB-COMPANY-ID  = 'LBL'
 16976        IF PB-I-JOINT-COVERAGE
 16977            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 16978                                           PB-I-MEMBER-NO
 16979            GO TO 4550-CONT-CERT-PROCESS.
 16980
 16981     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 16982        NEXT SENTENCE
 16983     ELSE
 16984        GO TO 4540-BUILD-MEMBER-NO.
 16985
 16986******************************************************************
 16987*                                                                *
 16988*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 16989*    FOR 'MON'.                                                  *
 16990*                                                                *
 16991******************************************************************
 16992
 16993     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 16994     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 16995     MOVE +1                     TO WS-SUB1
 16996                                    WS-SUB2.
 16997
 16998 4530-EDIT-MEMB-NAME.
 16999
 17000     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17001        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17002        ADD +1                       TO WS-SUB2.
 17003
 17004     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17005        ADD +1                       TO WS-SUB1
 17006        GO TO 4530-EDIT-MEMB-NAME.
 17007
 17008     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17009     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17010     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17011*    MOVE SPACE                      TO DC-OPTION-CODE.
 17012     SET  BIN-TO-GREG                TO TRUE.
 17013     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17014     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17015
 17016     GO TO 4550-CONT-CERT-PROCESS.
 17017
 17018******************************************************************
 17019*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17020******************************************************************
 17021
 17022 4540-BUILD-MEMBER-NO.
 17023
 17024     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17025         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17026         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17027         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 310
* EL050.cbl
 17028         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17029     ELSE
 17030         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17031
 17032     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17033        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17034         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17035
 17036 4550-CONT-CERT-PROCESS.
 17037
 17038*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17039*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17040*    ELSE
 17041*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17042
 17043     IF CERT-WAS-CREATED-FOR-CLAIM
 17044        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17045        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17046
 17047     IF CERT-AND-CLAIM-ONLINE
 17048        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17049        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17050
 17051     MOVE 'CM'                     TO CM-RECORD-ID.
 17052     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17053
 17054     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17055        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17056        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17057     ELSE
 17058        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17059        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17060
 17061     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17062     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17063     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17064     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17065     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17066     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17067     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17068                                      CM-LF-ITD-CANCEL-AMT
 17069                                      CM-LF-ITD-DEATH-AMT
 17070                                      CM-AH-ITD-AH-PMT
 17071                                      CM-AH-ITD-LUMP-PMT
 17072                                      CM-AH-ITD-CANCEL-AMT
 17073                                      CM-LF-NSP-PREMIUM-AMT
 17074                                      CM-AH-NSP-PREMIUM-AMT.
 17075*                                     CM-CLAIM-DEDUCT-WITHHELD
 17076*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17077     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17078     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17079     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17080     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17081     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17082     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17083     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17084     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17085     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 311
* EL050.cbl
 17086     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17087     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17088     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17089
 17090     IF PB-I-LIVES NOT NUMERIC
 17091         MOVE ZERO                 TO PB-I-LIVES.
 17092
 17093     IF PB-I-NUM-BILLED NOT NUMERIC
 17094         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17095
 17096     MOVE PB-I-LIVES               TO CM-LIVES.
 17097     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17098
 17099     IF PB-COMPANY-ID EQUAL  'DMD'
 17100         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17101         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17102
 17103     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17104     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17105     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17106     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17107     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17108     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17109
 17110     IF PB-I-LF-POLICY-FEE NUMERIC
 17111        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17112     ELSE
 17113        MOVE +0                    TO CM-LF-POLICY-FEE.
 17114
 17115     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17116        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17117        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17118     ELSE
 17119        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17120
 17121     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17122     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17123     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17124     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17125     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17126     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17127     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17128     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17129     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17130
 17131     IF PB-I-AH-POLICY-FEE NUMERIC
 17132        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17133     ELSE
 17134        MOVE +0                    TO CM-AH-POLICY-FEE.
 17135
 17136     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17137        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17138     ELSE
 17139        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17140
 17141     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17142     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17143
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 312
* EL050.cbl
 17144     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17145                                      CM-LF-DEATH-EXIT-DT
 17146                                      CM-AH-SETTLEMENT-EXIT-DT.
 17147
 17148*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17149*                       'TIH' OR 'OFL' OR 'FLA' OR
 17150*                       'TII' OR 'TMS' OR 'CRI' OR
 17151*                       'NCL'
 17152     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17153
 17154     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17155         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17156            MOVE '2'                TO CM-PREMIUM-TYPE.
 17157
 17158     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17159         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17160            MOVE '2'                TO CM-PREMIUM-TYPE.
 17161
 17162     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17163         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17164     ELSE
 17165         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17166         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17167
 17168     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17169     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17170     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17171     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17172     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17173     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17174     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17175     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17176
 17177     IF PB-NO-MONTHS-SKIPPED
 17178         MOVE SPACE                 TO CM-SKIP-CODE
 17179     ELSE
 17180         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17181
 17182     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17183     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17184                                       CM-LF-STATUS-AT-CANCEL.
 17185
 17186     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17187     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17188                                       CM-AH-STATUS-AT-CANCEL.
 17189
 17190     MOVE '1'                       TO CM-ENTRY-STATUS.
 17191
 17192     IF PB-REISSUED-CERT
 17193        MOVE '5'                    TO CM-ENTRY-STATUS.
 17194
 17195     IF PB-MONTHLY-CERT
 17196        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17197
 17198     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17199     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17200     IF PB-POLICY-IS-DECLINED
 17201        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 313
* EL050.cbl
 17202
 17203     IF PB-POLICY-IS-VOIDED
 17204        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17205
 17206     IF PB-NEEDS-UNDERWRITING
 17207        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17208
 17209     IF PB-REIN-ONLY-CERT
 17210        MOVE '9'                    TO CM-ENTRY-STATUS.
 17211
 17212     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17213         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17214     ELSE
 17215         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17216
 17217     IF PB-RECORD-RETURNED
 17218        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17219      ELSE
 17220        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17221
 17222     IF PB-I-MAIL-ADDRS-PRESENT
 17223        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17224
 17225     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17226                                       CM-ENTRY-DT.
 17227
 17228 4999-EXIT.
 17229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 314
* EL050.cbl
 17231
 17232 5000-PROCESS-REPS.
 17233     MOVE ' '                    TO AGTC-MASTER-SW
 17234     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17235     MOVE CO-TYPE                TO AGTC-TYPE
 17236     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17237     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17238     IF (AGTC-MASTER-SW NOT = 'N')
 17239        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17240        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17241        PERFORM 8583-READ-ERAGTC-NEXT
 17242                                 THRU 8583-EXIT
 17243     END-IF
 17244     IF AGTC-MASTER-SW = 'N'
 17245        CONTINUE
 17246     ELSE
 17247        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17248           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17249              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17250              MOVE 'Y'           TO AGTC-MASTER-SW
 17251           END-IF
 17252        END-IF
 17253     END-IF
 17254     .
 17255 5000-EXIT.
 17256     EXIT.
 17257 6370-EDIT-INPUT-LF-CODE.
 17258     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17259        MOVE +1                  TO SUB
 17260        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17261        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17262        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17263        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17264        GO TO 6370-SEARCH-LOOP.
 17265
 17266     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17267
 17268     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17269     MOVE SPACES                 TO CNTL-ACCESS.
 17270*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17271     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17272     MOVE +0                     TO CNTL-SEQ-NO.
 17273     MOVE '4' TO RC-SW-2.
 17274     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17275
 17276     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17277        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17278        GO TO 6370-NO-LF-FOUND.
 17279
 17280     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17281     MOVE +1                     TO SUB.
 17282
 17283 6370-SEARCH-LOOP.
 17284     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17285         GO TO 6370-NO-LF-FOUND.
 17286
 17287     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17288         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 315
* EL050.cbl
 17289         GO TO 6370-HER-NET-PAY-CHECK.
 17290
 17291     ADD 1   TO SUB.
 17292*    IF SUB GREATER 120
 17293     IF SUB GREATER 200
 17294         GO TO 6370-NO-LF-FOUND.
 17295
 17296     GO TO 6370-SEARCH-LOOP.
 17297
 17298 6370-NO-LF-FOUND.
 17299
 17300     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17301
 17302 6370-HER-NET-PAY-CHECK.
 17303
 17304     IF PB-COMPANY-ID = 'CID'
 17305        IF PB-SV-STATE = 'CA' OR 'MN'
 17306           IF PB-I-LF-BENEFIT-CD = '02'
 17307              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17308           ELSE
 17309              IF PB-I-LF-BENEFIT-CD = '04'
 17310                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17311              END-IF
 17312           END-IF
 17313        END-IF
 17314     END-IF
 17315
 17316     IF PB-COMPANY-ID NOT = 'HER'
 17317         GO TO 6370-EXIT.
 17318
 17319     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17320         GO TO 6370-EXIT.
 17321
 17322     IF PB-I-LF-TERM NOT NUMERIC
 17323         MOVE ZEROS              TO PB-I-LF-TERM.
 17324
 17325     IF PB-I-LOAN-TERM NOT NUMERIC
 17326         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17327
 17328     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17329         GO TO 6370-EXIT.
 17330
 17331     IF PB-I-LF-BENEFIT-CD = '33'
 17332         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17333
 17334     IF PB-I-LF-BENEFIT-CD = '34'
 17335         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17336
 17337 6370-EXIT.
 17338     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 316
* EL050.cbl
 17340
 17341 6380-EDIT-INPUT-AH-CODE.
 17342     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17343        MOVE +1                  TO SUB
 17344        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17345        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17346        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17347        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17348        GO TO 6380-SEARCH-LOOP.
 17349
 17350     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17351
 17352     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17353     MOVE SPACES                 TO CNTL-ACCESS.
 17354     MOVE 'A'                    TO CNTL-REC-TYPE.
 17355*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17356     MOVE +0                     TO CNTL-SEQ-NO.
 17357     MOVE '5' TO RC-SW-2.
 17358     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17359
 17360     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17361        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17362        GO TO 6380-NO-AH-FOUND.
 17363
 17364     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17365     MOVE +1 TO SUB.
 17366
 17367 6380-SEARCH-LOOP.
 17368     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17369         GO TO 6380-NO-AH-FOUND.
 17370
 17371     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17372         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17373         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17374
 17375     ADD 1   TO SUB.
 17376     IF SUB GREATER THAN 96
 17377*    IF SUB GREATER THAN 300
 17378         GO TO 6380-NO-AH-FOUND.
 17379
 17380     GO TO 6380-SEARCH-LOOP.
 17381
 17382 6380-NO-AH-FOUND.
 17383
 17384     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17385
 17386     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17387         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17388     ELSE
 17389         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17390
 17391 6380-CSO-AH-ONLY-CHECKS.
 17392
 17393     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17394        NEXT SENTENCE
 17395      ELSE
 17396        GO TO 6380-EXIT.
 17397
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 317
* EL050.cbl
 17398     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17399         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17400
 17401
 17402     GO TO 6380-EXIT
 17403     .
 17404 6380-CSO-LIFE-WITH-AH-CHECKS.
 17405
 17406
 17407     .
 17408 6380-EXIT.
 17409     EXIT.
 17410
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 318
* EL050.cbl
 17412
 17413 6400-COMPUTE-EXTENSION-DAYS.
 17414
 17415******************************************************************
 17416*                                                                *
 17417*                   COMPUTE EXTENSION DAYS                       *
 17418*                                                                *
 17419*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17420*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17421*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17422*    THE EXTENSION DAYS.                                         *
 17423*                                                                *
 17424******************************************************************
 17425
 17426     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17427     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17428
 17429******************************************************************
 17430*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17431*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17432******************************************************************
 17433
 17434     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17435        COMPUTE WS-ODD-DAYS-OVER =
 17436               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17437     ELSE
 17438        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17439
 17440     IF WS-ODD-DAYS-OVER = ZEROS
 17441           GO TO 6499-EXIT
 17442     ELSE
 17443        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17444           IF WS-WDF-MONTH = 02
 17445              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17446              ADD 2       TO  WS-ODD-DAYS-OVER
 17447              GO TO 6499-EXIT
 17448           ELSE
 17449              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17450                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17451                 GO TO 6499-EXIT
 17452               ELSE
 17453                 GO TO 6499-EXIT
 17454        ELSE
 17455           GO TO 6499-EXIT.
 17456
 17457 6412-CHECK-TO-DAY.
 17458
 17459        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17460           IF WS-WDT-DAY = 28
 17461              ADD 2              TO WS-ODD-DAYS-OVER
 17462           ELSE
 17463              IF WS-WDT-DAY = 29
 17464                 ADD 1           TO WS-ODD-DAYS-OVER
 17465              ELSE
 17466                 NEXT SENTENCE
 17467        ELSE
 17468           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17469              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 319
* EL050.cbl
 17470
 17471     GO TO 6499-EXIT.
 17472
 17473
 17474 6415-CHECK-LEAP-YEAR.
 17475
 17476     IF DC-DAYS-IN-MONTH = 29
 17477        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17478
 17479 6415-EXIT.
 17480     EXIT.
 17481
 17482 6499-EXIT.
 17483      EXIT.
 17484
 17485 6500-END.
 17486     EXIT.
 17487
 17488
 17489******************************************************************
 17490************* PROCEDURE DIVISION FOR EL050 ***********************
 17491********************** ELC50PD END *******************************
 17492
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 320
* EL050.cbl
 17494
 17495**START***********************************************************
 17496*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17497*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17498******************************************************************
 17499*
 17500 6600-GET-STATE-MUNICIPAL-TAX.
 17501
 17502     IF PB-COMPANY-ID NOT = 'DMD'
 17503         GO TO 6640-EXIT.
 17504
 17505     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17506     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17507     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17508*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17509*
 17510***  Y2K PROJ 7744
 17511     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17512     SET BIN-TO-GREG          TO TRUE.
 17513     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17514
 17515     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17516
 17517     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17518     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17519
 17520
 17521* EXEC CICS HANDLE CONDITION
 17522*        INVREQ    (6610-START-BROWSE)
 17523*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17524*        NOTFND    (6630-END-OF-FILE)
 17525*    END-EXEC.
 17526*    MOVE '"$8JI                 ! # #00017508' TO DFHEIV0
 17527     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17529     MOVE X'2320233030303137353038' TO DFHEIV0(25:11)
 17530     CALL 'kxdfhei1' USING DFHEIV0
 17531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17532
 17533
 17534 6610-START-BROWSE.
 17535
 17536
 17537* EXEC CICS HANDLE CONDITION
 17538*        NOTFND    (6630-END-OF-FILE)
 17539*        DISABLED  (6630-ERRESS-PROBLEM)
 17540*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17541*        ENDFILE   (6630-END-OF-FILE)
 17542*    END-EXEC.
 17543*    MOVE '"$IcJ''                ! $ #00017516' TO DFHEIV0
 17544     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17546     MOVE X'2420233030303137353136' TO DFHEIV0(25:11)
 17547     CALL 'kxdfhei1' USING DFHEIV0
 17548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17549
 17550
 17551
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 321
* EL050.cbl
 17552* EXEC CICS STARTBR
 17553*        DATASET (FILE-ID-ERRESS)
 17554*        RIDFLD  (WS-ERRESS-KEY)
 17555*        GTEQ
 17556*    END-EXEC.
 17557     MOVE 0
 17558       TO DFHEIV11
 17559*    MOVE '&,         G          &   #00017523' TO DFHEIV0
 17560     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17561     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17562     MOVE X'2020233030303137353233' TO DFHEIV0(25:11)
 17563     CALL 'kxdfhei1' USING DFHEIV0,
 17564           FILE-ID-ERRESS,
 17565           WS-ERRESS-KEY,
 17566           DFHEIV99,
 17567           DFHEIV11,
 17568           DFHEIV99
 17569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17570
 17571
 17572 6620-READ-NEXT-ERRESS-MASTER.
 17573
 17574
 17575* EXEC CICS HANDLE CONDITION
 17576*        NOTFND    (6630-END-OF-FILE)
 17577*        ENDFILE   (6630-END-OF-FILE)
 17578*        DISABLED  (6630-ERRESS-PROBLEM)
 17579*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17580*    END-EXEC.
 17581*    MOVE '"$I''cJ                ! % #00017531' TO DFHEIV0
 17582     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17583     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17584     MOVE X'2520233030303137353331' TO DFHEIV0(25:11)
 17585     CALL 'kxdfhei1' USING DFHEIV0
 17586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17587
 17588
 17589
 17590* EXEC CICS READNEXT
 17591*        DATASET (FILE-ID-ERRESS)
 17592*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17593*        RIDFLD  (WS-ERRESS-KEY)
 17594*    END-EXEC.
 17595     MOVE LENGTH OF
 17596      RESIDENT-STATE-TAX-MASTER
 17597       TO DFHEIV12
 17598     MOVE 0
 17599       TO DFHEIV11
 17600*    MOVE '&.IL                  )   #00017538' TO DFHEIV0
 17601     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17602     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17603     MOVE X'2020233030303137353338' TO DFHEIV0(25:11)
 17604     CALL 'kxdfhei1' USING DFHEIV0,
 17605           FILE-ID-ERRESS,
 17606           RESIDENT-STATE-TAX-MASTER,
 17607           DFHEIV12,
 17608           WS-ERRESS-KEY,
 17609           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 322
* EL050.cbl
 17610           DFHEIV11,
 17611           DFHEIV99,
 17612           DFHEIV99
 17613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17614
 17615
 17616     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17617
 17618* EXEC CICS ENDBR
 17619*            DATASET (FILE-ID-ERRESS)
 17620*       END-EXEC
 17621     MOVE 0
 17622       TO DFHEIV11
 17623*    MOVE '&2                    $   #00017545' TO DFHEIV0
 17624     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17626     MOVE X'2020233030303137353435' TO DFHEIV0(25:11)
 17627     CALL 'kxdfhei1' USING DFHEIV0,
 17628           FILE-ID-ERRESS,
 17629           DFHEIV11,
 17630           DFHEIV99
 17631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17632        GO TO 6630-END-OF-FILE.
 17633
 17634     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17635        NEXT SENTENCE
 17636      ELSE
 17637        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17638
 17639*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17640*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17641*
 17642     MOVE +2                     TO WS-SUB1.
 17643
 17644     IF PB-ISSUE
 17645     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17646        MOVE +1                  TO WS-SUB1.
 17647
 17648     IF PB-CANCELLATION
 17649     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17650        MOVE +1                  TO WS-SUB1.
 17651*
 17652*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17653*
 17654***  Y2K PROJ 7744
 17655     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17656***  Y2K PROJ 7744
 17657
 17658*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17659* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17660* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17661
 17662     ADD 1                    TO WS-YEAR-YY.
 17663
 17664     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17665         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17666                              TO WS-RES-STATE-TAX
 17667         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 323
* EL050.cbl
 17668                              TO WS-RES-MUNI-TAX
 17669     ELSE
 17670         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17671                              TO WS-RES-STATE-TAX
 17672         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17673                              TO WS-RES-MUNI-TAX.
 17674
 17675*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17676
 17677     IF PB-CANCELLATION
 17678         GO TO 6640-CANCEL-TAX.
 17679
 17680     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17681         COMPUTE PB-I-STATE-TAX ROUNDED =
 17682                                   PB-I-LF-PREMIUM-AMT
 17683                                 * WS-RES-STATE-TAX
 17684         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17685                                   PB-I-LF-PREMIUM-AMT
 17686                                 * WS-RES-MUNI-TAX
 17687     ELSE
 17688     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17689         COMPUTE PB-I-STATE-TAX ROUNDED =
 17690                                   PB-I-AH-PREMIUM-AMT
 17691                                 * WS-RES-STATE-TAX
 17692         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17693                                   PB-I-AH-PREMIUM-AMT
 17694                                 * WS-RES-MUNI-TAX.
 17695
 17696
 17697* EXEC CICS ENDBR
 17698*         DATASET (FILE-ID-ERRESS)
 17699*    END-EXEC.
 17700     MOVE 0
 17701       TO DFHEIV11
 17702*    MOVE '&2                    $   #00017612' TO DFHEIV0
 17703     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17704     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17705     MOVE X'2020233030303137363132' TO DFHEIV0(25:11)
 17706     CALL 'kxdfhei1' USING DFHEIV0,
 17707           FILE-ID-ERRESS,
 17708           DFHEIV11,
 17709           DFHEIV99
 17710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17711
 17712
 17713     GO TO 6640-EXIT.
 17714
 17715 6640-CANCEL-TAX.
 17716     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17717
 17718     IF PB-C-LF-CANCEL-AMT > ZEROS
 17719         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17720                                   PB-C-LF-CANCEL-AMT
 17721                                 * WS-RES-STATE-TAX
 17722         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17723                                   PB-C-LF-CANCEL-AMT
 17724                                *  WS-RES-MUNI-TAX
 17725     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 324
* EL050.cbl
 17726     IF PB-C-AH-CANCEL-AMT > ZEROS
 17727         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17728                                   PB-C-AH-CANCEL-AMT
 17729                                 * WS-RES-STATE-TAX
 17730         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17731                                   PB-C-AH-CANCEL-AMT
 17732                                *  WS-RES-MUNI-TAX.
 17733
 17734
 17735* EXEC CICS ENDBR
 17736*         DATASET (FILE-ID-ERRESS)
 17737*    END-EXEC.
 17738     MOVE 0
 17739       TO DFHEIV11
 17740*    MOVE '&2                    $   #00017637' TO DFHEIV0
 17741     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17742     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17743     MOVE X'2020233030303137363337' TO DFHEIV0(25:11)
 17744     CALL 'kxdfhei1' USING DFHEIV0,
 17745           FILE-ID-ERRESS,
 17746           DFHEIV11,
 17747           DFHEIV99
 17748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17749
 17750
 17751     GO TO 6640-EXIT.
 17752
 17753 6630-END-OF-FILE.
 17754     MOVE ER-8002              TO WS-ERROR.
 17755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17756
 17757     GO TO 6640-EXIT.
 17758
 17759 6630-ERRESS-PROBLEM.
 17760     MOVE ER-8044              TO WS-ERROR.
 17761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17762
 17763 6640-EXIT.
 17764     EXIT.
 17765
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 325
* EL050.cbl
 17767 6650-GET-RES-STATE-COMM.
 17768
 17769     IF PB-COMPANY-ID NOT = 'DMD'
 17770         GO TO 6700-COMM-EXIT.
 17771
 17772     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17773     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17774     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17775     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17776     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17777     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17778     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17779
 17780*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17781*
 17782***  Y2K PROJ 7744
 17783     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17784     SET BIN-TO-GREG          TO TRUE.
 17785     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17786
 17787     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17788***  Y2K PROJ 7744
 17789
 17790     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17791
 17792
 17793* EXEC CICS HANDLE CONDITION
 17794*        INVREQ    (6660-START-BROWSE)
 17795*        DISABLED  (6690-ERRESC-PROBLEM)
 17796*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17797*        NOTFND    (6690-END-OF-FILE)
 17798*    END-EXEC.
 17799*    MOVE '"$8cJI                ! & #00017682' TO DFHEIV0
 17800     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17802     MOVE X'2620233030303137363832' TO DFHEIV0(25:11)
 17803     CALL 'kxdfhei1' USING DFHEIV0
 17804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17805
 17806
 17807
 17808* EXEC CICS RESETBR
 17809*        DATASET (FILE-ID-ERRESC)
 17810*        RIDFLD  (WS-ERRESC-KEY)
 17811*    END-EXEC.
 17812     MOVE 0
 17813       TO DFHEIV11
 17814*    MOVE '&4         G          &   #00017689' TO DFHEIV0
 17815     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17816     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17817     MOVE X'2020233030303137363839' TO DFHEIV0(25:11)
 17818     CALL 'kxdfhei1' USING DFHEIV0,
 17819           FILE-ID-ERRESC,
 17820           WS-ERRESC-KEY,
 17821           DFHEIV99,
 17822           DFHEIV11,
 17823           DFHEIV99
 17824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 326
* EL050.cbl
 17825
 17826
 17827 6660-START-BROWSE.
 17828
 17829
 17830* EXEC CICS HANDLE CONDITION
 17831*        NOTFND    (6690-END-OF-FILE)
 17832*        DISABLED  (6690-ERRESC-PROBLEM)
 17833*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17834*        ENDFILE   (6690-END-OF-FILE)
 17835*    END-EXEC.
 17836*    MOVE '"$IcJ''                ! '' #00017696' TO DFHEIV0
 17837     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17839     MOVE X'2720233030303137363936' TO DFHEIV0(25:11)
 17840     CALL 'kxdfhei1' USING DFHEIV0
 17841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17842
 17843
 17844
 17845* EXEC CICS STARTBR
 17846*        DATASET (FILE-ID-ERRESC)
 17847*        RIDFLD  (WS-ERRESC-KEY)
 17848*        GTEQ
 17849*    END-EXEC.
 17850     MOVE 0
 17851       TO DFHEIV11
 17852*    MOVE '&,         G          &   #00017703' TO DFHEIV0
 17853     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17854     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17855     MOVE X'2020233030303137373033' TO DFHEIV0(25:11)
 17856     CALL 'kxdfhei1' USING DFHEIV0,
 17857           FILE-ID-ERRESC,
 17858           WS-ERRESC-KEY,
 17859           DFHEIV99,
 17860           DFHEIV11,
 17861           DFHEIV99
 17862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17863
 17864
 17865     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17866
 17867 6670-READ-NEXT-ERRESC-MASTER.
 17868
 17869
 17870* EXEC CICS HANDLE CONDITION
 17871*        NOTFND    (6690-END-OF-FILE)
 17872*        DISABLED  (6690-ERRESC-PROBLEM)
 17873*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17874*        ENDFILE   (6690-END-OF-FILE)
 17875*    END-EXEC.
 17876*    MOVE '"$IcJ''                ! ( #00017713' TO DFHEIV0
 17877     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17879     MOVE X'2820233030303137373133' TO DFHEIV0(25:11)
 17880     CALL 'kxdfhei1' USING DFHEIV0
 17881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17882
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 327
* EL050.cbl
 17883
 17884
 17885* EXEC CICS READNEXT
 17886*        DATASET (FILE-ID-ERRESC)
 17887*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 17888*        RIDFLD  (ERRESC-RECORD-KEY)
 17889*    END-EXEC.
 17890     MOVE LENGTH OF
 17891      ACCOUNT-RESIDENT-ST-COMMISSION
 17892       TO DFHEIV12
 17893     MOVE 0
 17894       TO DFHEIV11
 17895*    MOVE '&.IL                  )   #00017720' TO DFHEIV0
 17896     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17897     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17898     MOVE X'2020233030303137373230' TO DFHEIV0(25:11)
 17899     CALL 'kxdfhei1' USING DFHEIV0,
 17900           FILE-ID-ERRESC,
 17901           ACCOUNT-RESIDENT-ST-COMMISSION,
 17902           DFHEIV12,
 17903           ERRESC-RECORD-KEY,
 17904           DFHEIV99,
 17905           DFHEIV11,
 17906           DFHEIV99,
 17907           DFHEIV99
 17908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17909
 17910
 17911     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 17912        NEXT SENTENCE
 17913     ELSE
 17914
 17915* EXEC CICS ENDBR
 17916*            DATASET (FILE-ID-ERRESC)
 17917*       END-EXEC
 17918     MOVE 0
 17919       TO DFHEIV11
 17920*    MOVE '&2                    $   #00017729' TO DFHEIV0
 17921     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17922     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17923     MOVE X'2020233030303137373239' TO DFHEIV0(25:11)
 17924     CALL 'kxdfhei1' USING DFHEIV0,
 17925           FILE-ID-ERRESC,
 17926           DFHEIV11,
 17927           DFHEIV99
 17928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17929        GO TO 6690-END-OF-FILE.
 17930
 17931     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 17932
 17933* EXEC CICS ENDBR
 17934*            DATASET (FILE-ID-ERRESC)
 17935*       END-EXEC
 17936     MOVE 0
 17937       TO DFHEIV11
 17938*    MOVE '&2                    $   #00017735' TO DFHEIV0
 17939     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17940     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 328
* EL050.cbl
 17941     MOVE X'2020233030303137373335' TO DFHEIV0(25:11)
 17942     CALL 'kxdfhei1' USING DFHEIV0,
 17943           FILE-ID-ERRESC,
 17944           DFHEIV11,
 17945           DFHEIV99
 17946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17947        GO TO 6690-END-OF-FILE.
 17948
 17949     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 17950        NEXT SENTENCE
 17951      ELSE
 17952        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 17953
 17954* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 17955*
 17956     MOVE ZEROS               TO WS-SUB WS-SUB1.
 17957
 17958     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 17959
 17960     IF WS-SUB1 > ZERO
 17961         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 17962             PERFORM 6680-SET-COMMISSION
 17963         ELSE
 17964             PERFORM 6680-SET-TABLE-CODE.
 17965
 17966
 17967* EXEC CICS ENDBR
 17968*         DATASET (FILE-ID-ERRESC)
 17969*    END-EXEC.
 17970     MOVE 0
 17971       TO DFHEIV11
 17972*    MOVE '&2                    $   #00017757' TO DFHEIV0
 17973     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17974     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17975     MOVE X'2020233030303137373537' TO DFHEIV0(25:11)
 17976     CALL 'kxdfhei1' USING DFHEIV0,
 17977           FILE-ID-ERRESC,
 17978           DFHEIV11,
 17979           DFHEIV99
 17980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17981
 17982
 17983     GO TO 6700-COMM-EXIT.
 17984
 17985 6680-SET-TABLE-CODE.
 17986     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 17987        MOVE ZEROS             TO WS-SUB1
 17988     ELSE
 17989* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 17990* TO COMPUTE AH COMMISSION.
 17991        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 17992        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 17993        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 17994        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 17995        PERFORM 6680-READ-CTBL-TABLE
 17996        IF WS-CTBL-READ-SW NOT = 'Y'
 17997           MOVE ZEROS          TO WS-SUB1.
 17998
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 329
* EL050.cbl
 17999 6680-READ-CTBL-TABLE.
 18000*
 18001* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18002* TO COMPUTE LIFE COMMISSION
 18003
 18004     IF CTBL-SW = '0540'
 18005        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18006        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18007        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18008
 18009     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18010
 18011     IF CTBL-TABLE-FOUND
 18012        IF CTBL-SW = '0530'
 18013             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18014                                    * PB-I-AH-TERM
 18015             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18016             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18017        ELSE
 18018             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18019             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18020             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18021     ELSE
 18022        IF FIRST-TIME-THROUGH
 18023            GO TO 6680-READ-CTBL-TABLE
 18024        ELSE
 18025            MOVE ZEROS         TO WS-SUB1.
 18026
 18027 6680-SET-COMMISSION.
 18028     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18029           MOVE ZEROS          TO WS-SUB1
 18030       ELSE
 18031           MOVE RESC-COMMISSION-PER (WS-SUB)
 18032                               TO WS-COMMISSION
 18033           IF CTBL-SW = '0530'
 18034               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18035           ELSE
 18036               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18037
 18038 6680-SEARCH-CATEGORY.
 18039     ADD +1                   TO WS-SUB.
 18040     IF WS-SUB > +12
 18041         GO TO 6680-EXIT.
 18042
 18043     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18044          MOVE WS-SUB         TO WS-SUB1
 18045          GO TO 6680-EXIT.
 18046
 18047     GO TO 6680-SEARCH-CATEGORY.
 18048
 18049 6680-EXIT.
 18050     EXIT.
 18051
 18052 6690-END-OF-FILE.
 18053     GO TO 6700-COMM-EXIT.
 18054
 18055 6690-ERRESC-PROBLEM.
 18056      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 330
* EL050.cbl
 18057      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18058
 18059      GO TO 6700-COMM-EXIT.
 18060
 18061 6700-COMM-EXIT.
 18062     EXIT.
 18063
 18064 7000-GET-RATE.
 18065
 18066* EXEC CICS LINK
 18067*        PROGRAM    ('ELRATE')
 18068*        COMMAREA   (CALCULATION-PASS-AREA)
 18069*        LENGTH     (CP-COMM-LENGTH)
 18070*    END-EXEC.
 18071     MOVE 'ELRATE' TO DFHEIV1
 18072*    MOVE '."C                   ''   #00017843' TO DFHEIV0
 18073     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18074     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18075     MOVE X'2020233030303137383433' TO DFHEIV0(25:11)
 18076     CALL 'kxdfhei1' USING DFHEIV0,
 18077           DFHEIV1,
 18078           CALCULATION-PASS-AREA,
 18079           CP-COMM-LENGTH,
 18080           DFHEIV99,
 18081           DFHEIV99,
 18082           DFHEIV99
 18083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18084
 18085
 18086 7000-EXIT.
 18087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 331
* EL050.cbl
 18089 7100-FIND-BENEFIT-IN-STATE.
 18090     MOVE 'N'                    TO BEN-SEARCH-SW.
 18091
 18092     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18093         VARYING SUB3 FROM 1 BY 1 UNTIL
 18094            ((SUB3 GREATER 50) OR
 18095              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18096               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18097
 18098     IF SUB3 NOT = 51
 18099         MOVE 'Y'                TO BEN-SEARCH-SW.
 18100
 18101     GO TO 7199-EXIT.
 18102
 18103 7100-BENEFIT-DUMMY.
 18104
 18105 7100-DUMMY-EXIT.
 18106     EXIT.
 18107
 18108 7199-EXIT.
 18109     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 332
* EL050.cbl
 18111 7200-FIND-BENEFIT.
 18112     MOVE 'N'                    TO BEN-SEARCH-SW.
 18113
 18114     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18115         VARYING SUB3 FROM 1 BY 1 UNTIL
 18116            ((SUB3 GREATER 8) OR
 18117            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18118
 18119     IF SUB3 NOT = 9
 18120         MOVE 'Y'                TO BEN-SEARCH-SW.
 18121
 18122     GO TO 7200-EXIT.
 18123
 18124 7200-BENEFIT-DUMMY.
 18125
 18126 7200-DUMMY-EXIT.
 18127     EXIT.
 18128
 18129 7200-EXIT.
 18130     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 333
* EL050.cbl
 18132 7250-LOOK-FOR-RESCINDED-CLAIM.
 18133     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18134                                    W-CL-COMP-CD.
 18135     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18136                                    W-CL-CERT-NO.
 18137
 18138
 18139* EXEC CICS HANDLE CONDITION
 18140*        NOTFND  (7250-CONTINUE)
 18141*        ENDFILE (7250-CONTINUE)
 18142*    END-EXEC.
 18143*    MOVE '"$I''                  ! ) #00017901' TO DFHEIV0
 18144     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18146     MOVE X'2920233030303137393031' TO DFHEIV0(25:11)
 18147     CALL 'kxdfhei1' USING DFHEIV0
 18148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18149
 18150
 18151
 18152* EXEC CICS IGNORE CONDITION
 18153*        DUPKEY
 18154*    END-EXEC.
 18155*    MOVE '"*$                   !   #00017906' TO DFHEIV0
 18156     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18158     MOVE X'2020233030303137393036' TO DFHEIV0(25:11)
 18159     CALL 'kxdfhei1' USING DFHEIV0
 18160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18161
 18162
 18163
 18164* EXEC CICS STARTBR
 18165*        DATASET   (CLMS-ID)
 18166*        RIDFLD    (ELMSTR-KEY)
 18167*        GENERIC   EQUAL
 18168*        KEYLENGTH (ELMSTR-LENGTH)
 18169*    END-EXEC.
 18170     MOVE 0
 18171       TO DFHEIV11
 18172*    MOVE '&,   KG    E          &   #00017910' TO DFHEIV0
 18173     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18174     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18175     MOVE X'2020233030303137393130' TO DFHEIV0(25:11)
 18176     CALL 'kxdfhei1' USING DFHEIV0,
 18177           CLMS-ID,
 18178           ELMSTR-KEY,
 18179           ELMSTR-LENGTH,
 18180           DFHEIV11,
 18181           DFHEIV99
 18182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18183
 18184
 18185     MOVE 'Y'                    TO W-BROWSE-SW.
 18186
 18187 7250-NEXT-CLAIM.
 18188
 18189
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 334
* EL050.cbl
 18190* EXEC CICS READNEXT
 18191*        DATASET   (CLMS-ID)
 18192*        RIDFLD    (ELMSTR-KEY)
 18193*        SET       (ADDRESS OF CLAIM-MASTER)
 18194*    END-EXEC.
 18195     MOVE 0
 18196       TO DFHEIV11
 18197*    MOVE '&.S                   )   #00017921' TO DFHEIV0
 18198     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18199     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18200     MOVE X'2020233030303137393231' TO DFHEIV0(25:11)
 18201     CALL 'kxdfhei1' USING DFHEIV0,
 18202           CLMS-ID,
 18203           DFHEIV20,
 18204           DFHEIV99,
 18205           ELMSTR-KEY,
 18206           DFHEIV99,
 18207           DFHEIV11,
 18208           DFHEIV99,
 18209           DFHEIV99
 18210     SET ADDRESS OF CLAIM-MASTER TO
 18211         DFHEIV20
 18212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18213
 18214
 18215     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18216        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18217         GO TO 7250-CONTINUE
 18218     END-IF.
 18219
 18220     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18221        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18222        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18223        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18224        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18225         GO TO 7250-NEXT-CLAIM
 18226     END-IF.
 18227
 18228     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18229        OR (CL-CLAIM-TYPE = 'I')
 18230        OR (CL-CLAIM-TYPE = 'G')
 18231          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18232              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18233              GO TO 7250-CONTINUE
 18234          END-IF
 18235     END-IF.
 18236
 18237     GO TO 7250-NEXT-CLAIM.
 18238
 18239 7250-CONTINUE.
 18240
 18241     IF W-BROWSE-SW = 'Y'
 18242
 18243* EXEC CICS ENDBR
 18244*            DATASET   (CLMS-ID)
 18245*        END-EXEC
 18246     MOVE 0
 18247       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 335
* EL050.cbl
 18248*    MOVE '&2                    $   #00017954' TO DFHEIV0
 18249     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18250     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18251     MOVE X'2020233030303137393534' TO DFHEIV0(25:11)
 18252     CALL 'kxdfhei1' USING DFHEIV0,
 18253           CLMS-ID,
 18254           DFHEIV11,
 18255           DFHEIV99
 18256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18257         MOVE 'N' TO W-BROWSE-SW
 18258     END-IF.
 18259
 18260 7250-EXIT.
 18261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 336
* EL050.cbl
 18263 7300-CHECK-FOR-OPEN-CLMS.
 18264
 18265*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18266*    MOVE SPACES                 TO CNTL-ACCESS.
 18267*    MOVE '1'                    TO CNTL-REC-TYPE.
 18268*    MOVE +0                     TO CNTL-SEQ-NO.
 18269
 18270*    MOVE '3'                    TO RC-SW-1.
 18271*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18272
 18273*    IF NOT CF-COMPANY-MASTER
 18274*         PERFORM 0099-COMPANY-NOT-FOUND
 18275*         GO TO 7300-EXIT.
 18276
 18277     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18278                                    W-CL-COMP-CD.
 18279     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18280                                    W-CL-CERT-NO.
 18281
 18282
 18283* EXEC CICS HANDLE CONDITION
 18284*        NOTFND  (7300-CONTINUE)
 18285*        ENDFILE (7300-CONTINUE)
 18286*    END-EXEC.
 18287*    MOVE '"$I''                  ! * #00017982' TO DFHEIV0
 18288     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18290     MOVE X'2A20233030303137393832' TO DFHEIV0(25:11)
 18291     CALL 'kxdfhei1' USING DFHEIV0
 18292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18293
 18294
 18295
 18296* EXEC CICS IGNORE CONDITION
 18297*        DUPKEY
 18298*    END-EXEC.
 18299*    MOVE '"*$                   !   #00017987' TO DFHEIV0
 18300     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18302     MOVE X'2020233030303137393837' TO DFHEIV0(25:11)
 18303     CALL 'kxdfhei1' USING DFHEIV0
 18304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18305
 18306
 18307
 18308* EXEC CICS STARTBR
 18309*        DATASET   (CLMS-ID)
 18310*        RIDFLD    (ELMSTR-KEY)
 18311*        GENERIC   EQUAL
 18312*        KEYLENGTH (ELMSTR-LENGTH)
 18313*    END-EXEC.
 18314     MOVE 0
 18315       TO DFHEIV11
 18316*    MOVE '&,   KG    E          &   #00017991' TO DFHEIV0
 18317     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18318     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18319     MOVE X'2020233030303137393931' TO DFHEIV0(25:11)
 18320     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 337
* EL050.cbl
 18321           CLMS-ID,
 18322           ELMSTR-KEY,
 18323           ELMSTR-LENGTH,
 18324           DFHEIV11,
 18325           DFHEIV99
 18326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18327
 18328
 18329     MOVE 'Y'                    TO W-BROWSE-SW.
 18330
 18331 7300-NEXT-CLAIM.
 18332
 18333
 18334* EXEC CICS READNEXT
 18335*        DATASET   (CLMS-ID)
 18336*        RIDFLD    (ELMSTR-KEY)
 18337*        SET       (ADDRESS OF CLAIM-MASTER)
 18338*    END-EXEC.
 18339     MOVE 0
 18340       TO DFHEIV11
 18341*    MOVE '&.S                   )   #00018002' TO DFHEIV0
 18342     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18344     MOVE X'2020233030303138303032' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0,
 18346           CLMS-ID,
 18347           DFHEIV20,
 18348           DFHEIV99,
 18349           ELMSTR-KEY,
 18350           DFHEIV99,
 18351           DFHEIV11,
 18352           DFHEIV99,
 18353           DFHEIV99
 18354     SET ADDRESS OF CLAIM-MASTER TO
 18355         DFHEIV20
 18356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18357
 18358
 18359     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18360        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18361         GO TO 7300-CONTINUE.
 18362
 18363     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18364        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18365        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18366        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18367        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18368         GO TO 7300-NEXT-CLAIM.
 18369
 18370*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18371     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18372        OR (CL-CLAIM-TYPE = 'I')
 18373        OR (CL-CLAIM-TYPE = 'G')
 18374        IF CLAIM-IS-OPEN
 18375           EVALUATE TRUE
 18376             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18377                 MOVE ER-2884      TO WS-ERROR
 18378             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 338
* EL050.cbl
 18379                 MOVE ER-2887      TO WS-ERROR
 18380             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18381                 MOVE ER-2886      TO WS-ERROR
 18382             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18383                 MOVE ER-2888      TO WS-ERROR
 18384             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18385                 MOVE ER-2885      TO WS-ERROR
 18386             WHEN OTHER
 18387                 MOVE ER-2768      TO WS-ERROR
 18388           END-EVALUATE
 18389           IF PB-C-AH-CANCEL-VOIDED OR
 18390              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18391                NOT AH-COVERAGE-CANCELLED)
 18392               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18393               MOVE ER-2768      TO WS-ERROR
 18394           END-IF
 18395           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18396           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18397              PB-FORCE-CODE NOT EQUAL '8'
 18398               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18399           END-IF
 18400           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18401           GO TO 7300-CONTINUE
 18402        ELSE
 18403           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18404*****THIS IS A RESCISSION OR REFORMATION
 18405              IF (AH-COVERAGE-CANCELLED AND
 18406                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18407                    MOVE ER-2890 TO WS-ERROR
 18408                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18409                    GO TO 7300-CONTINUE
 18410              END-IF
 18411           ELSE
 18412              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18413                 MOVE ER-2756        TO WS-ERROR
 18414                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18415                 GO TO 7300-CONTINUE
 18416              END-IF
 18417           END-IF
 18418        END-IF
 18419     ELSE
 18420*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18421        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18422           IF CLAIM-IS-OPEN
 18423              MOVE ER-2889      TO WS-ERROR
 18424              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18425              GO TO 7300-CONTINUE
 18426           ELSE
 18427              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18428*****THIS IS A RESCISSION OR REFORMATION
 18429                 IF (LF-COVERAGE-CANCELLED AND
 18430                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18431                       MOVE ER-2890 TO WS-ERROR
 18432                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18433                       GO TO 7300-CONTINUE
 18434                 END-IF
 18435              ELSE
 18436                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 339
* EL050.cbl
 18437                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18438                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18439                    (LF-COVERAGE-CANCELLED AND
 18440                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18441                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18442                       MOVE ER-2965 TO WS-ERROR
 18443                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18444                       GO TO 7300-CONTINUE
 18445                 END-IF
 18446                 IF LF-COVERAGE-CANCELLED
 18447                  IF CL-TOTAL-PAID-AMT > 0
 18448                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18449                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18450                        MOVE ER-2891 TO WS-ERROR
 18451                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18452                        GO TO 7300-CONTINUE
 18453                      END-IF
 18454                    ELSE
 18455                      MOVE ER-2892 TO WS-ERROR
 18456                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18457                      GO TO 7300-CONTINUE
 18458                    END-IF
 18459                  END-IF
 18460                 END-IF
 18461              END-IF
 18462           END-IF
 18463        END-IF
 18464     END-IF
 18465
 18466     GO TO 7300-NEXT-CLAIM.
 18467
 18468 7300-CONTINUE.
 18469
 18470     IF W-BROWSE-SW = 'Y'
 18471
 18472* EXEC CICS ENDBR
 18473*            DATASET   (CLMS-ID)
 18474*        END-EXEC.
 18475     MOVE 0
 18476       TO DFHEIV11
 18477*    MOVE '&2                    $   #00018120' TO DFHEIV0
 18478     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18479     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18480     MOVE X'2020233030303138313230' TO DFHEIV0(25:11)
 18481     CALL 'kxdfhei1' USING DFHEIV0,
 18482           CLMS-ID,
 18483           DFHEIV11,
 18484           DFHEIV99
 18485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18486
 18487
 18488 7300-EXIT.
 18489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 340
* EL050.cbl
 18491
 18492 7400-GET-REMAIN-TERM.
 18493
 18494* EXEC CICS LINK
 18495*        PROGRAM    ('ELRTRM')
 18496*        COMMAREA   (CALCULATION-PASS-AREA)
 18497*        LENGTH     (CP-COMM-LENGTH)
 18498*    END-EXEC.
 18499     MOVE 'ELRTRM' TO DFHEIV1
 18500*    MOVE '."C                   ''   #00018129' TO DFHEIV0
 18501     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18502     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18503     MOVE X'2020233030303138313239' TO DFHEIV0(25:11)
 18504     CALL 'kxdfhei1' USING DFHEIV0,
 18505           DFHEIV1,
 18506           CALCULATION-PASS-AREA,
 18507           CP-COMM-LENGTH,
 18508           DFHEIV99,
 18509           DFHEIV99,
 18510           DFHEIV99
 18511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18512
 18513
 18514 7400-EXIT.
 18515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 341
* EL050.cbl
 18517
 18518 7500-GET-REMAIN-AMOUNT.
 18519
 18520* EXEC CICS LINK
 18521*        PROGRAM    ('ELRAMT')
 18522*        COMMAREA   (CALCULATION-PASS-AREA)
 18523*        LENGTH     (CP-COMM-LENGTH)
 18524*    END-EXEC.
 18525     MOVE 'ELRAMT' TO DFHEIV1
 18526*    MOVE '."C                   ''   #00018140' TO DFHEIV0
 18527     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18528     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18529     MOVE X'2020233030303138313430' TO DFHEIV0(25:11)
 18530     CALL 'kxdfhei1' USING DFHEIV0,
 18531           DFHEIV1,
 18532           CALCULATION-PASS-AREA,
 18533           CP-COMM-LENGTH,
 18534           DFHEIV99,
 18535           DFHEIV99,
 18536           DFHEIV99
 18537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18538
 18539
 18540 7500-EXIT.
 18541     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 342
* EL050.cbl
 18543
 18544 7600-GET-REFUND.
 18545
 18546* EXEC CICS LINK
 18547*        PROGRAM    ('ELRFND')
 18548*        COMMAREA   (CALCULATION-PASS-AREA)
 18549*        LENGTH     (CP-COMM-LENGTH)
 18550*    END-EXEC.
 18551     MOVE 'ELRFND' TO DFHEIV1
 18552*    MOVE '."C                   ''   #00018151' TO DFHEIV0
 18553     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18554     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18555     MOVE X'2020233030303138313531' TO DFHEIV0(25:11)
 18556     CALL 'kxdfhei1' USING DFHEIV0,
 18557           DFHEIV1,
 18558           CALCULATION-PASS-AREA,
 18559           CP-COMM-LENGTH,
 18560           DFHEIV99,
 18561           DFHEIV99,
 18562           DFHEIV99
 18563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18564
 18565
 18566 7600-EXIT.
 18567     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 343
* EL050.cbl
 18569 7700-CALL-DL1.
 18570
 18571* EXEC CICS LINK
 18572*        PROGRAM    ('DLO001')
 18573*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18574*        LENGTH     (DLO001-COMM-LENGTH)
 18575*    END-EXEC.
 18576     MOVE 'DLO001' TO DFHEIV1
 18577*    MOVE '."C                   ''   #00018161' TO DFHEIV0
 18578     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18579     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18580     MOVE X'2020233030303138313631' TO DFHEIV0(25:11)
 18581     CALL 'kxdfhei1' USING DFHEIV0,
 18582           DFHEIV1,
 18583           WS-DLO-MASTER-POLICY-FORM,
 18584           DLO001-COMM-LENGTH,
 18585           DFHEIV99,
 18586           DFHEIV99,
 18587           DFHEIV99
 18588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18589
 18590
 18591 7700-EXIT.
 18592     EXIT.
 18593
 18594 7710-CALL-DL2.
 18595
 18596* EXEC CICS LINK
 18597*        PROGRAM    ('DLO002')
 18598*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18599*        LENGTH     (DLO002-COMM-LENGTH)
 18600*    END-EXEC.
 18601     MOVE 'DLO002' TO DFHEIV1
 18602*    MOVE '."C                   ''   #00018171' TO DFHEIV0
 18603     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18605     MOVE X'2020233030303138313731' TO DFHEIV0(25:11)
 18606     CALL 'kxdfhei1' USING DFHEIV0,
 18607           DFHEIV1,
 18608           WS-DLO-INTERNAL-POLICY-FORM,
 18609           DLO002-COMM-LENGTH,
 18610           DFHEIV99,
 18611           DFHEIV99,
 18612           DFHEIV99
 18613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18614
 18615
 18616 7710-EXIT.
 18617     EXIT.
 18618
 18619 7720-CALL-DL3.
 18620
 18621* EXEC CICS LINK
 18622*        PROGRAM    ('DLO003')
 18623*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18624*        LENGTH     (DLO003-COMM-LENGTH)
 18625*    END-EXEC.
 18626     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 344
* EL050.cbl
 18627*    MOVE '."C                   ''   #00018181' TO DFHEIV0
 18628     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18630     MOVE X'2020233030303138313831' TO DFHEIV0(25:11)
 18631     CALL 'kxdfhei1' USING DFHEIV0,
 18632           DFHEIV1,
 18633           WS-DLO-VALID-BANK-ID,
 18634           DLO003-COMM-LENGTH,
 18635           DFHEIV99,
 18636           DFHEIV99,
 18637           DFHEIV99
 18638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18639
 18640
 18641 7720-EXIT.
 18642     EXIT.
 18643
 18644 7730-CALL-DL7.
 18645
 18646* EXEC CICS LINK
 18647*        PROGRAM    ('DLO007')
 18648*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18649*        LENGTH     (DLO007-COMM-LENGTH)
 18650*    END-EXEC.
 18651     MOVE 'DLO007' TO DFHEIV1
 18652*    MOVE '."C                   ''   #00018191' TO DFHEIV0
 18653     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18655     MOVE X'2020233030303138313931' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0,
 18657           DFHEIV1,
 18658           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18659           DLO007-COMM-LENGTH,
 18660           DFHEIV99,
 18661           DFHEIV99,
 18662           DFHEIV99
 18663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18664
 18665
 18666 7730-EXIT.
 18667     EXIT.
 18668
 18669 7740-CALL-DL11.
 18670
 18671* EXEC CICS LINK
 18672*        PROGRAM    ('DLO011')
 18673*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18674*        LENGTH     (DLO011-COMM-LENGTH)
 18675*    END-EXEC.
 18676     MOVE 'DLO011' TO DFHEIV1
 18677*    MOVE '."C                   ''   #00018201' TO DFHEIV0
 18678     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18680     MOVE X'2020233030303138323031' TO DFHEIV0(25:11)
 18681     CALL 'kxdfhei1' USING DFHEIV0,
 18682           DFHEIV1,
 18683           WS-DLO-PREM-RATES-BEN-TYPE,
 18684           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 345
* EL050.cbl
 18685           DFHEIV99,
 18686           DFHEIV99,
 18687           DFHEIV99
 18688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18689
 18690
 18691 7740-EXIT.
 18692     EXIT.
 18693
 18694 7750-CALL-DL17.
 18695
 18696* EXEC CICS LINK
 18697*        PROGRAM    ('DLO017')
 18698*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18699*        LENGTH     (DLO017-COMM-LENGTH)
 18700*    END-EXEC.
 18701     MOVE 'DLO017' TO DFHEIV1
 18702*    MOVE '."C                   ''   #00018211' TO DFHEIV0
 18703     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18705     MOVE X'2020233030303138323131' TO DFHEIV0(25:11)
 18706     CALL 'kxdfhei1' USING DFHEIV0,
 18707           DFHEIV1,
 18708           WS-DLO-VALID-RATE-CODE,
 18709           DLO017-COMM-LENGTH,
 18710           DFHEIV99,
 18711           DFHEIV99,
 18712           DFHEIV99
 18713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18714
 18715
 18716 7750-EXIT.
 18717     EXIT.
 18718
 18719 7755-CALL-DL19.
 18720
 18721* EXEC CICS LINK
 18722*        PROGRAM    ('DLO019')
 18723*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18724*        LENGTH     (DLO019-COMM-LENGTH)
 18725*    END-EXEC.
 18726     MOVE 'DLO019' TO DFHEIV1
 18727*    MOVE '."C                   ''   #00018221' TO DFHEIV0
 18728     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18730     MOVE X'2020233030303138323231' TO DFHEIV0(25:11)
 18731     CALL 'kxdfhei1' USING DFHEIV0,
 18732           DFHEIV1,
 18733           WS-DLO-ORIG-COV-CAT,
 18734           DLO019-COMM-LENGTH,
 18735           DFHEIV99,
 18736           DFHEIV99,
 18737           DFHEIV99
 18738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18739
 18740
 18741 7755-EXIT.
 18742     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 346
* EL050.cbl
 18743
 18744 7760-CALL-DL21.
 18745
 18746* EXEC CICS LINK
 18747*        PROGRAM    ('DLO021')
 18748*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18749*        LENGTH     (DLO021-COMM-LENGTH)
 18750*    END-EXEC.
 18751     MOVE 'DLO021' TO DFHEIV1
 18752*    MOVE '."C                   ''   #00018231' TO DFHEIV0
 18753     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18754     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18755     MOVE X'2020233030303138323331' TO DFHEIV0(25:11)
 18756     CALL 'kxdfhei1' USING DFHEIV0,
 18757           DFHEIV1,
 18758           WS-DLO-VALID-LOAN-OFFICER,
 18759           DLO021-COMM-LENGTH,
 18760           DFHEIV99,
 18761           DFHEIV99,
 18762           DFHEIV99
 18763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18764
 18765
 18766 7760-EXIT.
 18767     EXIT.
 18768
 18769 7770-CALL-DL22.
 18770
 18771* EXEC CICS LINK
 18772*        PROGRAM    ('DLO022')
 18773*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18774*        LENGTH     (DLO022-COMM-LENGTH)
 18775*    END-EXEC.
 18776     MOVE 'DLO022' TO DFHEIV1
 18777*    MOVE '."C                   ''   #00018241' TO DFHEIV0
 18778     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18780     MOVE X'2020233030303138323431' TO DFHEIV0(25:11)
 18781     CALL 'kxdfhei1' USING DFHEIV0,
 18782           DFHEIV1,
 18783           WS-DLO-VALID-STATE-CODE,
 18784           DLO022-COMM-LENGTH,
 18785           DFHEIV99,
 18786           DFHEIV99,
 18787           DFHEIV99
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
 18791 7770-EXIT.
 18792     EXIT.
 18793
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 347
* EL050.cbl
 18795
 18796 7800-REWRITE-CERT.
 18797******************************************************************
 18798*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18799*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18800******************************************************************
 18801
 18802     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18803        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18804        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18805        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18806
 18807* EXEC CICS REWRITE
 18808*                  DATASET (CERT-ID)
 18809*                  FROM    (CERTIFICATE-MASTER)
 18810*              END-EXEC
 18811     MOVE LENGTH OF
 18812      CERTIFICATE-MASTER
 18813       TO DFHEIV11
 18814*    MOVE '&& L                  %   #00018262' TO DFHEIV0
 18815     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18817     MOVE X'2020233030303138323632' TO DFHEIV0(25:11)
 18818     CALL 'kxdfhei1' USING DFHEIV0,
 18819           CERT-ID,
 18820           CERTIFICATE-MASTER,
 18821           DFHEIV11,
 18822           DFHEIV99
 18823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18824        GO TO 7800-EXIT.
 18825
 18826       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18827       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18828
 18829 7800-EXIT.
 18830      EXIT.
 18831
 18832 7900-DELETE-CERT.
 18833
 18834* EXEC CICS DELETE
 18835*        DATASET (CERT-ID)
 18836*    END-EXEC.
 18837*    MOVE '&(                    &   #00018275' TO DFHEIV0
 18838     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18839     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18840     MOVE X'2020233030303138323735' TO DFHEIV0(25:11)
 18841     CALL 'kxdfhei1' USING DFHEIV0,
 18842           CERT-ID,
 18843           DFHEIV99,
 18844           DFHEIV99,
 18845           DFHEIV99,
 18846           DFHEIV99
 18847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18848
 18849
 18850 7900-EXIT.
 18851     EXIT.
 18852
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 348
* EL050.cbl
 18853 8000-WRITE-CERT.
 18854
 18855* EXEC CICS HANDLE CONDITION
 18856*        DUPKEY    (8000-FREE-MAIN)
 18857*    END-EXEC.
 18858*    MOVE '"$$                   ! + #00018283' TO DFHEIV0
 18859     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18861     MOVE X'2B20233030303138323833' TO DFHEIV0(25:11)
 18862     CALL 'kxdfhei1' USING DFHEIV0
 18863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18864
 18865
 18866
 18867* EXEC CICS WRITE
 18868*        DATASET     (CERT-ID)
 18869*        FROM        (CERTIFICATE-MASTER)
 18870*        RIDFLD      (ELCERT-KEY)
 18871*    END-EXEC.
 18872     MOVE LENGTH OF
 18873      CERTIFICATE-MASTER
 18874       TO DFHEIV11
 18875*    MOVE '&$ L                  ''   #00018287' TO DFHEIV0
 18876     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18877     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18878     MOVE X'2020233030303138323837' TO DFHEIV0(25:11)
 18879     CALL 'kxdfhei1' USING DFHEIV0,
 18880           CERT-ID,
 18881           CERTIFICATE-MASTER,
 18882           DFHEIV11,
 18883           ELCERT-KEY,
 18884           DFHEIV99,
 18885           DFHEIV99
 18886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18887
 18888
 18889 8000-FREE-MAIN.
 18890
 18891 8000-EXIT.
 18892      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 349
* EL050.cbl
 18894
 18895 8100-READ-ERPNDM.
 18896
 18897* EXEC CICS HANDLE CONDITION
 18898*         NOTFND     (8100-NOTFND)
 18899*         ENDFILE    (8100-NOTFND)
 18900*    END-EXEC.
 18901*    MOVE '"$I''                  ! , #00018300' TO DFHEIV0
 18902     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18904     MOVE X'2C20233030303138333030' TO DFHEIV0(25:11)
 18905     CALL 'kxdfhei1' USING DFHEIV0
 18906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18907
 18908
 18909     MOVE SPACES                 TO ERPNDM-FOUND.
 18910     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 18911
 18912
 18913* EXEC CICS READ
 18914*         DATASET   (FILE-ERPNDM)
 18915*         RIDFLD    (PM-CONTROL-PRIMARY)
 18916*         INTO      (PENDING-MAILING-DATA)
 18917*    END-EXEC.
 18918     MOVE LENGTH OF
 18919      PENDING-MAILING-DATA
 18920       TO DFHEIV11
 18921*    MOVE '&"IL       E          (   #00018308' TO DFHEIV0
 18922     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18924     MOVE X'2020233030303138333038' TO DFHEIV0(25:11)
 18925     CALL 'kxdfhei1' USING DFHEIV0,
 18926           FILE-ERPNDM,
 18927           PENDING-MAILING-DATA,
 18928           DFHEIV11,
 18929           PM-CONTROL-PRIMARY,
 18930           DFHEIV99,
 18931           DFHEIV99,
 18932           DFHEIV99
 18933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18934
 18935
 18936     GO TO 8100-EXIT.
 18937
 18938 8100-NOTFND.
 18939
 18940     MOVE 'X'                    TO ERPNDM-FOUND.
 18941     MOVE ER-2694                TO WS-ERROR.
 18942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18943     MOVE ER-2883                TO WS-ERROR
 18944     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18945     .
 18946 8100-EXIT.
 18947     EXIT.
 18948
 18949 8110-READ-ERMAIL.
 18950
 18951* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 350
* EL050.cbl
 18952*         NOTFND     (8110-NOTFND)
 18953*         ENDFILE    (8110-NOTFND)
 18954*    END-EXEC.
 18955*    MOVE '"$I''                  ! - #00018328' TO DFHEIV0
 18956     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18958     MOVE X'2D20233030303138333238' TO DFHEIV0(25:11)
 18959     CALL 'kxdfhei1' USING DFHEIV0
 18960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18961
 18962
 18963     MOVE SPACES                 TO ERMAIL-FOUND.
 18964     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18965     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18966     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18967     MOVE PB-SV-STATE            TO MA-STATE.
 18968
 18969
 18970* EXEC CICS READ
 18971*         UPDATE
 18972*         DATASET   (FILE-ERMAIL)
 18973*         RIDFLD    (MA-CONTROL-PRIMARY)
 18974*         INTO      (MAILING-DATA)
 18975*    END-EXEC.
 18976     MOVE LENGTH OF
 18977      MAILING-DATA
 18978       TO DFHEIV11
 18979*    MOVE '&"IL       EU         (   #00018339' TO DFHEIV0
 18980     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18981     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18982     MOVE X'2020233030303138333339' TO DFHEIV0(25:11)
 18983     CALL 'kxdfhei1' USING DFHEIV0,
 18984           FILE-ERMAIL,
 18985           MAILING-DATA,
 18986           DFHEIV11,
 18987           MA-CONTROL-PRIMARY,
 18988           DFHEIV99,
 18989           DFHEIV99,
 18990           DFHEIV99
 18991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18992
 18993
 18994     GO TO 8110-EXIT.
 18995
 18996 8110-NOTFND.
 18997     MOVE 'X'                    TO ERMAIL-FOUND.
 18998
 18999 8110-EXIT.
 19000     EXIT.
 19001
 19002 8120-REWRITE-ERMAIL.
 19003
 19004* EXEC CICS REWRITE
 19005*         DATASET    (FILE-ERMAIL)
 19006*         FROM       (MAILING-DATA)
 19007*    END-EXEC.
 19008     MOVE LENGTH OF
 19009      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 351
* EL050.cbl
 19010       TO DFHEIV11
 19011*    MOVE '&& L                  %   #00018355' TO DFHEIV0
 19012     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19013     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19014     MOVE X'2020233030303138333535' TO DFHEIV0(25:11)
 19015     CALL 'kxdfhei1' USING DFHEIV0,
 19016           FILE-ERMAIL,
 19017           MAILING-DATA,
 19018           DFHEIV11,
 19019           DFHEIV99
 19020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19021
 19022
 19023 8120-EXIT.
 19024     EXIT.
 19025
 19026 8130-WRITE-ERMAIL.
 19027
 19028* EXEC CICS HANDLE CONDITION
 19029*         DUPKEY   (8130-EXIT)
 19030*    END-EXEC.
 19031*    MOVE '"$$                   ! . #00018364' TO DFHEIV0
 19032     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19034     MOVE X'2E20233030303138333634' TO DFHEIV0(25:11)
 19035     CALL 'kxdfhei1' USING DFHEIV0
 19036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19037
 19038
 19039
 19040* EXEC CICS WRITE
 19041*         DATASET     (FILE-ERMAIL)
 19042*         RIDFLD      (MA-CONTROL-PRIMARY)
 19043*         FROM        (MAILING-DATA)
 19044*    END-EXEC.
 19045     MOVE LENGTH OF
 19046      MAILING-DATA
 19047       TO DFHEIV11
 19048*    MOVE '&$ L                  ''   #00018368' TO DFHEIV0
 19049     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19050     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19051     MOVE X'2020233030303138333638' TO DFHEIV0(25:11)
 19052     CALL 'kxdfhei1' USING DFHEIV0,
 19053           FILE-ERMAIL,
 19054           MAILING-DATA,
 19055           DFHEIV11,
 19056           MA-CONTROL-PRIMARY,
 19057           DFHEIV99,
 19058           DFHEIV99
 19059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19060
 19061
 19062 8130-EXIT.
 19063     EXIT.
 19064
 19065 8140-UNLOCK-ERMAIL.
 19066
 19067* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 352
* EL050.cbl
 19068*         DATASET   (FILE-ERMAIL)
 19069*    END-EXEC.
 19070*    MOVE '&*                    #   #00018378' TO DFHEIV0
 19071     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19072     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19073     MOVE X'2020233030303138333738' TO DFHEIV0(25:11)
 19074     CALL 'kxdfhei1' USING DFHEIV0,
 19075           FILE-ERMAIL,
 19076           DFHEIV99
 19077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19078
 19079
 19080 8140-EXIT.
 19081     EXIT.
 19082
 19083 8180-UPDATE-VIN-NUMBER.
 19084
 19085* EXEC CICS HANDLE CONDITION
 19086*        NOTFND   (8180-NOTFND)
 19087*    END-EXEC.
 19088*    MOVE '"$I                   ! / #00018386' TO DFHEIV0
 19089     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19090     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19091     MOVE X'2F20233030303138333836' TO DFHEIV0(25:11)
 19092     CALL 'kxdfhei1' USING DFHEIV0
 19093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19094
 19095
 19096     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19097     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19098
 19099
 19100* EXEC CICS READ
 19101*        UPDATE
 19102*        DATASET  (CRTT-ID)
 19103*        RIDFLD   (WS-ELCRTT-KEY)
 19104*        INTO     (CERTIFICATE-TRAILERS)
 19105*    END-EXEC.
 19106     MOVE LENGTH OF
 19107      CERTIFICATE-TRAILERS
 19108       TO DFHEIV11
 19109*    MOVE '&"IL       EU         (   #00018393' TO DFHEIV0
 19110     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19111     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19112     MOVE X'2020233030303138333933' TO DFHEIV0(25:11)
 19113     CALL 'kxdfhei1' USING DFHEIV0,
 19114           CRTT-ID,
 19115           CERTIFICATE-TRAILERS,
 19116           DFHEIV11,
 19117           WS-ELCRTT-KEY,
 19118           DFHEIV99,
 19119           DFHEIV99,
 19120           DFHEIV99
 19121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19122
 19123
 19124     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19125         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 353
* EL050.cbl
 19126
 19127* EXEC CICS REWRITE
 19128*           DATASET  (CRTT-ID)
 19129*           FROM     (CERTIFICATE-TRAILERS)
 19130*        END-EXEC
 19131     MOVE LENGTH OF
 19132      CERTIFICATE-TRAILERS
 19133       TO DFHEIV11
 19134*    MOVE '&& L                  %   #00018402' TO DFHEIV0
 19135     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19136     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19137     MOVE X'2020233030303138343032' TO DFHEIV0(25:11)
 19138     CALL 'kxdfhei1' USING DFHEIV0,
 19139           CRTT-ID,
 19140           CERTIFICATE-TRAILERS,
 19141           DFHEIV11,
 19142           DFHEIV99
 19143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19144     ELSE
 19145
 19146* EXEC CICS UNLOCK
 19147*          DATASET  (CRTT-ID)
 19148*       END-EXEC
 19149*    MOVE '&*                    #   #00018407' TO DFHEIV0
 19150     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19151     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19152     MOVE X'2020233030303138343037' TO DFHEIV0(25:11)
 19153     CALL 'kxdfhei1' USING DFHEIV0,
 19154           CRTT-ID,
 19155           DFHEIV99
 19156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19157     END-IF.
 19158
 19159     GO TO 8180-EXIT.
 19160
 19161 8180-NOTFND.
 19162
 19163     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19164     MOVE 'CS'         TO CS-RECORD-ID.
 19165     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19166     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19167     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19168     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19169
 19170* EXEC CICS WRITE
 19171*       DATASET  (CRTT-ID)
 19172*       RIDFLD   (WS-ELCRTT-KEY)
 19173*       FROM     (CERTIFICATE-TRAILERS)
 19174*    END-EXEC.
 19175     MOVE LENGTH OF
 19176      CERTIFICATE-TRAILERS
 19177       TO DFHEIV11
 19178*    MOVE '&$ L                  ''   #00018422' TO DFHEIV0
 19179     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19180     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19181     MOVE X'2020233030303138343232' TO DFHEIV0(25:11)
 19182     CALL 'kxdfhei1' USING DFHEIV0,
 19183           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 354
* EL050.cbl
 19184           CERTIFICATE-TRAILERS,
 19185           DFHEIV11,
 19186           WS-ELCRTT-KEY,
 19187           DFHEIV99,
 19188           DFHEIV99
 19189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19190
 19191
 19192 8180-EXIT.
 19193     EXIT.
 19194
 19195 8190-UPDATE-REFUND-CLAIM-FLAG.
 19196
 19197* EXEC CICS HANDLE CONDITION
 19198*        NOTFND   (8190-NOTFND)
 19199*    END-EXEC.
 19200*    MOVE '"$I                   ! 0 #00018432' TO DFHEIV0
 19201     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19203     MOVE X'3020233030303138343332' TO DFHEIV0(25:11)
 19204     CALL 'kxdfhei1' USING DFHEIV0
 19205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19206
 19207
 19208     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19209     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19210
 19211
 19212* EXEC CICS READ
 19213*        UPDATE
 19214*        DATASET  (CRTT-ID)
 19215*        RIDFLD   (WS-ELCRTT-KEY)
 19216*        INTO     (CERTIFICATE-TRAILERS)
 19217*    END-EXEC.
 19218     MOVE LENGTH OF
 19219      CERTIFICATE-TRAILERS
 19220       TO DFHEIV11
 19221*    MOVE '&"IL       EU         (   #00018439' TO DFHEIV0
 19222     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19223     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19224     MOVE X'2020233030303138343339' TO DFHEIV0(25:11)
 19225     CALL 'kxdfhei1' USING DFHEIV0,
 19226           CRTT-ID,
 19227           CERTIFICATE-TRAILERS,
 19228           DFHEIV11,
 19229           WS-ELCRTT-KEY,
 19230           DFHEIV99,
 19231           DFHEIV99,
 19232           DFHEIV99
 19233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19234
 19235
 19236     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19237
 19238* EXEC CICS REWRITE
 19239*       DATASET  (CRTT-ID)
 19240*       FROM     (CERTIFICATE-TRAILERS)
 19241*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 355
* EL050.cbl
 19242     MOVE LENGTH OF
 19243      CERTIFICATE-TRAILERS
 19244       TO DFHEIV11
 19245*    MOVE '&& L                  %   #00018447' TO DFHEIV0
 19246     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19247     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19248     MOVE X'2020233030303138343437' TO DFHEIV0(25:11)
 19249     CALL 'kxdfhei1' USING DFHEIV0,
 19250           CRTT-ID,
 19251           CERTIFICATE-TRAILERS,
 19252           DFHEIV11,
 19253           DFHEIV99
 19254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19255
 19256
 19257     GO TO 8190-EXIT.
 19258
 19259 8190-NOTFND.
 19260
 19261     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19262     MOVE 'CS'         TO CS-RECORD-ID.
 19263     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19264     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19265     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19266     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19267
 19268* EXEC CICS WRITE
 19269*       DATASET  (CRTT-ID)
 19270*       RIDFLD   (WS-ELCRTT-KEY)
 19271*       FROM     (CERTIFICATE-TRAILERS)
 19272*    END-EXEC.
 19273     MOVE LENGTH OF
 19274      CERTIFICATE-TRAILERS
 19275       TO DFHEIV11
 19276*    MOVE '&$ L                  ''   #00018462' TO DFHEIV0
 19277     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19278     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19279     MOVE X'2020233030303138343632' TO DFHEIV0(25:11)
 19280     CALL 'kxdfhei1' USING DFHEIV0,
 19281           CRTT-ID,
 19282           CERTIFICATE-TRAILERS,
 19283           DFHEIV11,
 19284           WS-ELCRTT-KEY,
 19285           DFHEIV99,
 19286           DFHEIV99
 19287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19288
 19289
 19290 8190-EXIT.
 19291     EXIT.
 19292
 19293 8200-READ-REIN-TABLE.
 19294
 19295* EXEC CICS HANDLE CONDITION
 19296*         NOTFND   (8200-NOTFND)
 19297*    END-EXEC.
 19298*    MOVE '"$I                   ! 1 #00018472' TO DFHEIV0
 19299     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 356
* EL050.cbl
 19300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19301     MOVE X'3120233030303138343732' TO DFHEIV0(25:11)
 19302     CALL 'kxdfhei1' USING DFHEIV0
 19303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19304
 19305
 19306
 19307* EXEC CICS READ
 19308*        DATASET     (REIN-ID)
 19309*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19310*        RIDFLD      (ERREIN-KEY)
 19311*    END-EXEC.
 19312*    MOVE '&"S        E          (   #00018476' TO DFHEIV0
 19313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19315     MOVE X'2020233030303138343736' TO DFHEIV0(25:11)
 19316     CALL 'kxdfhei1' USING DFHEIV0,
 19317           REIN-ID,
 19318           DFHEIV20,
 19319           DFHEIV99,
 19320           ERREIN-KEY,
 19321           DFHEIV99,
 19322           DFHEIV99,
 19323           DFHEIV99
 19324     SET ADDRESS OF REINSURANCE-RECORD TO
 19325         DFHEIV20
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329     GO TO 8200-EXIT.
 19330
 19331 8200-NOTFND.
 19332     MOVE 'N'             TO WS-REIN-READ-SW.
 19333
 19334 8200-EXIT.
 19335      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 357
* EL050.cbl
 19337
 19338 8300-READ-CTBL-TABLE.
 19339
 19340* EXEC CICS HANDLE CONDITION
 19341*        NOTFND    (8300-NOTFND)
 19342*        DISABLED  (8300-ERRESS-PROBLEM)
 19343*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19344*        ENDFILE   (8300-NOTFND)
 19345*    END-EXEC.
 19346*    MOVE '"$IcJ''                ! 2 #00018492' TO DFHEIV0
 19347     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19349     MOVE X'3220233030303138343932' TO DFHEIV0(25:11)
 19350     CALL 'kxdfhei1' USING DFHEIV0
 19351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19352
 19353
 19354
 19355* EXEC CICS READ
 19356*        DATASET     (CTBL-ID)
 19357*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19358*        RIDFLD      (ERCTBL-KEY)
 19359*    END-EXEC.
 19360*    MOVE '&"S        E          (   #00018499' TO DFHEIV0
 19361     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19362     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19363     MOVE X'2020233030303138343939' TO DFHEIV0(25:11)
 19364     CALL 'kxdfhei1' USING DFHEIV0,
 19365           CTBL-ID,
 19366           DFHEIV20,
 19367           DFHEIV99,
 19368           ERCTBL-KEY,
 19369           DFHEIV99,
 19370           DFHEIV99,
 19371           DFHEIV99
 19372     SET ADDRESS OF COMM-TABLE-RECORD TO
 19373         DFHEIV20
 19374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19375
 19376
 19377     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19378
 19379     GO TO 8300-EXIT.
 19380
 19381 8300-NOTFND.
 19382
 19383     IF CTBL-SW = '0530'
 19384         MOVE 'AA'                     TO WS-AH-COMP-CD
 19385         MOVE '0550'                   TO CTBL-SW
 19386         MOVE '1'                      TO WS-CTBL-READ-SW
 19387         GO TO 8300-EXIT.
 19388
 19389     IF CTBL-SW = '0540'
 19390         MOVE 'AA'                     TO WS-LF-COMP-CD
 19391         MOVE '0550'                   TO CTBL-SW
 19392         MOVE '1'                      TO WS-CTBL-READ-SW
 19393         GO TO 8300-EXIT.
 19394
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 358
* EL050.cbl
 19395     IF CTBL-SW = '0550'
 19396         MOVE '2'                      TO WS-CTBL-READ-SW
 19397         GO TO 8300-EXIT.
 19398
 19399     GO TO 8300-EXIT.
 19400
 19401 8300-ERRESS-PROBLEM.
 19402
 19403      MOVE ER-8050              TO WS-ERROR.
 19404      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19405
 19406     GO TO 8300-EXIT.
 19407
 19408 8300-EXIT.
 19409      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 359
* EL050.cbl
 19411
 19412
 19413 8400-GETMAIN-ERFORM.
 19414
 19415
 19416* EXEC CICS   GETMAIN
 19417*        LENGTH  (500)
 19418*        SET     (ADDRESS OF FORM-MASTER)
 19419*    END-EXEC.
 19420     MOVE 500
 19421       TO DFHEIV11
 19422*    MOVE '," L                  $   #00018543' TO DFHEIV0
 19423     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19425     MOVE X'2020233030303138353433' TO DFHEIV0(25:11)
 19426     CALL 'kxdfhei1' USING DFHEIV0,
 19427           DFHEIV20,
 19428           DFHEIV11,
 19429           DFHEIV99
 19430     SET ADDRESS OF FORM-MASTER TO
 19431         DFHEIV20
 19432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19433
 19434
 19435     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19436
 19437 8400-EXIT.
 19438      EXIT.
 19439
 19440 8450-READ-FORM-MASTER.
 19441
 19442
 19443* EXEC CICS  HANDLE CONDITION
 19444*        NOTFND   (8450-FORM-NOT-FOUND)
 19445*        ENDFILE  (8450-FORM-NOT-FOUND)
 19446*    END-EXEC.
 19447*    MOVE '"$I''                  ! 3 #00018555' TO DFHEIV0
 19448     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19450     MOVE X'3320233030303138353535' TO DFHEIV0(25:11)
 19451     CALL 'kxdfhei1' USING DFHEIV0
 19452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19453
 19454
 19455
 19456* EXEC CICS   READ
 19457*        DATASET   (FORM-ID)
 19458*        RIDFLD    (ERFORM-KEY)
 19459*        INTO      (FORM-MASTER)
 19460*        GTEQ
 19461*    END-EXEC.
 19462     MOVE LENGTH OF
 19463      FORM-MASTER
 19464       TO DFHEIV11
 19465*    MOVE '&"IL       G          (   #00018560' TO DFHEIV0
 19466     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19468     MOVE X'2020233030303138353630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 360
* EL050.cbl
 19469     CALL 'kxdfhei1' USING DFHEIV0,
 19470           FORM-ID,
 19471           FORM-MASTER,
 19472           DFHEIV11,
 19473           ERFORM-KEY,
 19474           DFHEIV99,
 19475           DFHEIV99,
 19476           DFHEIV99
 19477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19478
 19479
 19480     MOVE  'Y'           TO  FORM-MASTER-SW.
 19481
 19482     GO TO  8450-EXIT.
 19483
 19484 8450-FORM-NOT-FOUND.
 19485
 19486     MOVE  'N'           TO  FORM-MASTER-SW.
 19487
 19488 8450-EXIT.
 19489      EXIT.
 19490
 19491 8500-DATE-CONVERT.
 19492
 19493* EXEC CICS LINK
 19494*        PROGRAM    ('ELDATCV')
 19495*        COMMAREA   (DATE-CONVERSION-DATA)
 19496*        LENGTH     (DC-COMM-LENGTH)
 19497*    END-EXEC.
 19498     MOVE 'ELDATCV' TO DFHEIV1
 19499*    MOVE '."C                   ''   #00018579' TO DFHEIV0
 19500     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19501     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19502     MOVE X'2020233030303138353739' TO DFHEIV0(25:11)
 19503     CALL 'kxdfhei1' USING DFHEIV0,
 19504           DFHEIV1,
 19505           DATE-CONVERSION-DATA,
 19506           DC-COMM-LENGTH,
 19507           DFHEIV99,
 19508           DFHEIV99,
 19509           DFHEIV99
 19510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19511
 19512
 19513 8500-EXIT.
 19514     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 361
* EL050.cbl
 19516
 19517 8555-RELOAD-CONTROL-FILE.
 19518     CONTINUE.
 19519
 19520 8555-EXIT.
 19521     EXIT.
 19522
 19523 8557-GETMAIN-ERPLAN.
 19524
 19525
 19526* EXEC CICS GETMAIN
 19527*        LENGTH    (840)
 19528*        SET       (ADDRESS OF PLAN-RECORDS)
 19529*    END-EXEC.
 19530     MOVE 840
 19531       TO DFHEIV11
 19532*    MOVE '," L                  $   #00018597' TO DFHEIV0
 19533     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19534     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19535     MOVE X'2020233030303138353937' TO DFHEIV0(25:11)
 19536     CALL 'kxdfhei1' USING DFHEIV0,
 19537           DFHEIV20,
 19538           DFHEIV11,
 19539           DFHEIV99
 19540     SET ADDRESS OF PLAN-RECORDS TO
 19541         DFHEIV20
 19542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19543
 19544
 19545     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19546
 19547 8557-EXIT.
 19548     EXIT.
 19549
 19550 8560-GETMAIN.
 19551
 19552* EXEC CICS GETMAIN
 19553*        LENGTH    (2000)
 19554*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19555*    END-EXEC.
 19556     MOVE 2000
 19557       TO DFHEIV11
 19558*    MOVE '," L                  $   #00018608' TO DFHEIV0
 19559     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19560     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19561     MOVE X'2020233030303138363038' TO DFHEIV0(25:11)
 19562     CALL 'kxdfhei1' USING DFHEIV0,
 19563           DFHEIV20,
 19564           DFHEIV11,
 19565           DFHEIV99
 19566     SET ADDRESS OF ACCOUNT-MASTER TO
 19567         DFHEIV20
 19568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19569
 19570
 19571     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19572
 19573 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 362
* EL050.cbl
 19574     EXIT.
 19575
 19576 8570-START-ACCOUNT-MASTER.
 19577
 19578* EXEC CICS HANDLE CONDITION
 19579*        NOTFND    (0199-ACCT-NOT-FOUND)
 19580*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19581*    END-EXEC.
 19582*    MOVE '"$I''                  ! 4 #00018619' TO DFHEIV0
 19583     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19585     MOVE X'3420233030303138363139' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0
 19587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19588
 19589
 19590
 19591* EXEC CICS STARTBR
 19592*        DATASET    (ACCT-ID)
 19593*        RIDFLD     (ERACCT-KEY)
 19594*        GTEQ
 19595*    END-EXEC.
 19596     MOVE 0
 19597       TO DFHEIV11
 19598*    MOVE '&,         G          &   #00018624' TO DFHEIV0
 19599     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19600     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19601     MOVE X'2020233030303138363234' TO DFHEIV0(25:11)
 19602     CALL 'kxdfhei1' USING DFHEIV0,
 19603           ACCT-ID,
 19604           ERACCT-KEY,
 19605           DFHEIV99,
 19606           DFHEIV11,
 19607           DFHEIV99
 19608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19609
 19610
 19611 8570-EXIT.
 19612     EXIT.
 19613
 19614 8580-READ-ACCOUNT-MASTER.
 19615
 19616* EXEC CICS HANDLE CONDITION
 19617*        NOTFND    (0199-ACCT-NOT-FOUND)
 19618*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19619*    END-EXEC.
 19620*    MOVE '"$I''                  ! 5 #00018634' TO DFHEIV0
 19621     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19623     MOVE X'3520233030303138363334' TO DFHEIV0(25:11)
 19624     CALL 'kxdfhei1' USING DFHEIV0
 19625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19626
 19627
 19628
 19629* EXEC CICS READNEXT
 19630*        DATASET     (ACCT-ID)
 19631*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 363
* EL050.cbl
 19632*        RIDFLD      (ERACCT-KEY)
 19633*    END-EXEC.
 19634     MOVE LENGTH OF
 19635      ACCOUNT-MASTER
 19636       TO DFHEIV12
 19637     MOVE 0
 19638       TO DFHEIV11
 19639*    MOVE '&.IL                  )   #00018639' TO DFHEIV0
 19640     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19641     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19642     MOVE X'2020233030303138363339' TO DFHEIV0(25:11)
 19643     CALL 'kxdfhei1' USING DFHEIV0,
 19644           ACCT-ID,
 19645           ACCOUNT-MASTER,
 19646           DFHEIV12,
 19647           ERACCT-KEY,
 19648           DFHEIV99,
 19649           DFHEIV11,
 19650           DFHEIV99,
 19651           DFHEIV99
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655 8580-EXIT.
 19656     EXIT.
 19657
 19658 8582-READ-COMPENSATION-MASTER.
 19659
 19660* EXEC CICS HANDLE CONDITION
 19661*        NOTFND    (8582-COMP-NOT-FOUND)
 19662*        ENDFILE   (8582-COMP-NOT-FOUND)
 19663*    END-EXEC.
 19664*    MOVE '"$I''                  ! 6 #00018649' TO DFHEIV0
 19665     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19667     MOVE X'3620233030303138363439' TO DFHEIV0(25:11)
 19668     CALL 'kxdfhei1' USING DFHEIV0
 19669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19670
 19671
 19672
 19673* EXEC CICS READ
 19674*        DATASET     (COMP-ID)
 19675*        INTO        (COMPENSATION-MASTER)
 19676*        RIDFLD      (ERCOMP-KEY)
 19677*    END-EXEC.
 19678     MOVE LENGTH OF
 19679      COMPENSATION-MASTER
 19680       TO DFHEIV11
 19681*    MOVE '&"IL       E          (   #00018654' TO DFHEIV0
 19682     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19683     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19684     MOVE X'2020233030303138363534' TO DFHEIV0(25:11)
 19685     CALL 'kxdfhei1' USING DFHEIV0,
 19686           COMP-ID,
 19687           COMPENSATION-MASTER,
 19688           DFHEIV11,
 19689           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 364
* EL050.cbl
 19690           DFHEIV99,
 19691           DFHEIV99,
 19692           DFHEIV99
 19693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19694
 19695
 19696     MOVE 'Y'                    TO COMP-MASTER-SW
 19697
 19698     GO TO 8582-EXIT
 19699     .
 19700 8582-COMP-NOT-FOUND.
 19701
 19702     MOVE 'N'                    TO COMP-MASTER-SW.
 19703
 19704 8582-EXIT.
 19705     EXIT.
 19706
 19707 8583-READ-ERAGTC.
 19708
 19709* EXEC CICS HANDLE CONDITION
 19710*        NOTFND    (8583-AGTC-NOT-FOUND)
 19711*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19712*    END-EXEC.
 19713*    MOVE '"$I''                  ! 7 #00018672' TO DFHEIV0
 19714     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19716     MOVE X'3720233030303138363732' TO DFHEIV0(25:11)
 19717     CALL 'kxdfhei1' USING DFHEIV0
 19718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19719
 19720
 19721
 19722* EXEC CICS STARTBR
 19723*        DATASET    (AGTC-ID)
 19724*        RIDFLD     (ERAGTC-KEY)
 19725*        GTEQ
 19726*    END-EXEC.
 19727     MOVE 0
 19728       TO DFHEIV11
 19729*    MOVE '&,         G          &   #00018677' TO DFHEIV0
 19730     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19731     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19732     MOVE X'2020233030303138363737' TO DFHEIV0(25:11)
 19733     CALL 'kxdfhei1' USING DFHEIV0,
 19734           AGTC-ID,
 19735           ERAGTC-KEY,
 19736           DFHEIV99,
 19737           DFHEIV11,
 19738           DFHEIV99
 19739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19740
 19741
 19742 8583-READ-ERAGTC-NEXT.
 19743
 19744* EXEC CICS READNEXT
 19745*        DATASET     (AGTC-ID)
 19746*        INTO        (AGENT-COMMISSIONS)
 19747*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 365
* EL050.cbl
 19748*    END-EXEC.
 19749     MOVE LENGTH OF
 19750      AGENT-COMMISSIONS
 19751       TO DFHEIV12
 19752     MOVE 0
 19753       TO DFHEIV11
 19754*    MOVE '&.IL                  )   #00018684' TO DFHEIV0
 19755     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19756     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19757     MOVE X'2020233030303138363834' TO DFHEIV0(25:11)
 19758     CALL 'kxdfhei1' USING DFHEIV0,
 19759           AGTC-ID,
 19760           AGENT-COMMISSIONS,
 19761           DFHEIV12,
 19762           ERAGTC-KEY,
 19763           DFHEIV99,
 19764           DFHEIV11,
 19765           DFHEIV99,
 19766           DFHEIV99
 19767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19768
 19769
 19770*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19771
 19772     GO TO 8583-EXIT
 19773     .
 19774 8583-AGTC-NOT-FOUND.
 19775
 19776     MOVE 'N'                    TO AGTC-MASTER-SW.
 19777
 19778 8583-EXIT.
 19779     EXIT.
 19780
 19781 8584-READ-BANK-CROSS-REF.
 19782
 19783* EXEC CICS HANDLE CONDITION
 19784*        NOTFND    (8584-BXRF-NOT-FOUND)
 19785*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19786*    END-EXEC.
 19787*    MOVE '"$I''                  ! 8 #00018702' TO DFHEIV0
 19788     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19790     MOVE X'3820233030303138373032' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0
 19792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19793
 19794
 19795
 19796* EXEC CICS READ
 19797*        DATASET     (BXRF-ID)
 19798*        INTO        (BANK-CROSS-REFERENCE)
 19799*        RIDFLD      (ERBXRF-KEY)
 19800*        LENGTH      (BXRF-REC-LENGTH)
 19801*    END-EXEC.
 19802*    MOVE '&"IL       E          (   #00018707' TO DFHEIV0
 19803     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19805     MOVE X'2020233030303138373037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 366
* EL050.cbl
 19806     CALL 'kxdfhei1' USING DFHEIV0,
 19807           BXRF-ID,
 19808           BANK-CROSS-REFERENCE,
 19809           BXRF-REC-LENGTH,
 19810           ERBXRF-KEY,
 19811           DFHEIV99,
 19812           DFHEIV99,
 19813           DFHEIV99
 19814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19815
 19816
 19817     MOVE 'Y'                    TO BXRF-MASTER-SW
 19818
 19819     GO TO 8584-EXIT
 19820     .
 19821 8584-BXRF-NOT-FOUND.
 19822
 19823     MOVE 'N'                    TO BXRF-MASTER-SW.
 19824
 19825 8584-EXIT.
 19826     EXIT.
 19827
 19828 8585-READ-PLAN-MASTER.
 19829
 19830
 19831* EXEC CICS HANDLE CONDITION
 19832*        NOTFND    (8585-PLAN-NOT-FOUND)
 19833*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19834*    END-EXEC.
 19835*    MOVE '"$I''                  ! 9 #00018727' TO DFHEIV0
 19836     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19838     MOVE X'3920233030303138373237' TO DFHEIV0(25:11)
 19839     CALL 'kxdfhei1' USING DFHEIV0
 19840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19841
 19842
 19843
 19844* EXEC CICS READ
 19845*        DATASET     (PLAN-ID)
 19846*        INTO        (PLAN-MASTER)
 19847*        RIDFLD      (ERPLAN-KEY)
 19848*    END-EXEC.
 19849     MOVE LENGTH OF
 19850      PLAN-MASTER
 19851       TO DFHEIV11
 19852*    MOVE '&"IL       E          (   #00018732' TO DFHEIV0
 19853     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19854     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19855     MOVE X'2020233030303138373332' TO DFHEIV0(25:11)
 19856     CALL 'kxdfhei1' USING DFHEIV0,
 19857           PLAN-ID,
 19858           PLAN-MASTER,
 19859           DFHEIV11,
 19860           ERPLAN-KEY,
 19861           DFHEIV99,
 19862           DFHEIV99,
 19863           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 367
* EL050.cbl
 19864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19865
 19866
 19867     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19868
 19869     GO TO 8585-EXIT.
 19870
 19871 8585-PLAN-NOT-FOUND.
 19872
 19873     MOVE 'N'                    TO PLAN-MASTER-SW.
 19874
 19875 8585-EXIT.
 19876     EXIT.
 19877
 19878 8586-READ-LOAN-OFFICER.
 19879
 19880* EXEC CICS READ
 19881*        DATASET     (LOFC-ID)
 19882*        INTO        (LOAN-OFFICER-MASTER)
 19883*        RIDFLD      (ERLOFC-KEY)
 19884*        RESP        (WS-RESPONSE)
 19885*    END-EXEC
 19886     MOVE LENGTH OF
 19887      LOAN-OFFICER-MASTER
 19888       TO DFHEIV11
 19889*    MOVE '&"IL       E          (  N#00018750' TO DFHEIV0
 19890     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19892     MOVE X'204E233030303138373530' TO DFHEIV0(25:11)
 19893     CALL 'kxdfhei1' USING DFHEIV0,
 19894           LOFC-ID,
 19895           LOAN-OFFICER-MASTER,
 19896           DFHEIV11,
 19897           ERLOFC-KEY,
 19898           DFHEIV99,
 19899           DFHEIV99,
 19900           DFHEIV99
 19901     MOVE EIBRESP  TO WS-RESPONSE
 19902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19903
 19904     IF WS-RESP-NORMAL
 19905        MOVE 'Y'                 TO LOFC-MASTER-SW
 19906     ELSE
 19907        MOVE 'N'                 TO LOFC-MASTER-SW
 19908     END-IF
 19909     .
 19910 8586-EXIT.
 19911     EXIT.
 19912 8587-START-ERPDEF.
 19913
 19914* EXEC CICS STARTBR
 19915*       DATASET   (PDEF-ID)
 19916*       RIDFLD    (ERPDEF-KEY)
 19917*       GTEQ
 19918*       RESP      (WS-RESPONSE)
 19919*    END-EXEC
 19920     MOVE 0
 19921       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 368
* EL050.cbl
 19922*    MOVE '&,         G          &  N#00018766' TO DFHEIV0
 19923     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19924     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19925     MOVE X'204E233030303138373636' TO DFHEIV0(25:11)
 19926     CALL 'kxdfhei1' USING DFHEIV0,
 19927           PDEF-ID,
 19928           ERPDEF-KEY,
 19929           DFHEIV99,
 19930           DFHEIV11,
 19931           DFHEIV99
 19932     MOVE EIBRESP  TO WS-RESPONSE
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19934     IF WS-RESP-NORMAL
 19935        MOVE 'Y'                 TO PDEF-MASTER-SW
 19936     ELSE
 19937        MOVE 'N'                 TO PDEF-MASTER-SW
 19938     END-IF
 19939     .
 19940 8587-EXIT.
 19941     EXIT.
 19942 8588-READ-ERPDEF.
 19943
 19944* EXEC CICS READNEXT
 19945*       DATASET   (PDEF-ID)
 19946*       RIDFLD    (ERPDEF-KEY)
 19947*       INTO      (PRODUCT-MASTER)
 19948*       RESP      (WS-RESPONSE)
 19949*    END-EXEC
 19950     MOVE LENGTH OF
 19951      PRODUCT-MASTER
 19952       TO DFHEIV12
 19953     MOVE 0
 19954       TO DFHEIV11
 19955*    MOVE '&.IL                  )  N#00018781' TO DFHEIV0
 19956     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19957     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19958     MOVE X'204E233030303138373831' TO DFHEIV0(25:11)
 19959     CALL 'kxdfhei1' USING DFHEIV0,
 19960           PDEF-ID,
 19961           PRODUCT-MASTER,
 19962           DFHEIV12,
 19963           ERPDEF-KEY,
 19964           DFHEIV99,
 19965           DFHEIV11,
 19966           DFHEIV99,
 19967           DFHEIV99
 19968     MOVE EIBRESP  TO WS-RESPONSE
 19969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19970     IF WS-RESP-NORMAL
 19971        MOVE 'Y'                 TO PDEF-MASTER-SW
 19972     ELSE
 19973        MOVE 'N'                 TO PDEF-MASTER-SW
 19974     END-IF
 19975     .
 19976 8588-EXIT.
 19977     EXIT.
 19978 8589-ENDBR-ERPDEF.
 19979
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 369
* EL050.cbl
 19980* EXEC CICS ENDBR
 19981*       DATASET   (PDEF-ID)
 19982*    END-EXEC
 19983     MOVE 0
 19984       TO DFHEIV11
 19985*    MOVE '&2                    $   #00018796' TO DFHEIV0
 19986     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19987     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19988     MOVE X'2020233030303138373936' TO DFHEIV0(25:11)
 19989     CALL 'kxdfhei1' USING DFHEIV0,
 19990           PDEF-ID,
 19991           DFHEIV11,
 19992           DFHEIV99
 19993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19994     .
 19995 8589-EXIT.
 19996     EXIT.
 19997 8590-READ-CERT-MASTER.
 19998     IF PB-COMPANY-ID = 'UCL'
 19999         GO TO 8690-READ-CERT-MASTER-UCL.
 20000
 20001
 20002* EXEC CICS HANDLE CONDITION
 20003*         NOTFND    (0299-CERT-NOT-FOUND)
 20004*    END-EXEC.
 20005*    MOVE '"$I                   ! : #00018806' TO DFHEIV0
 20006     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20008     MOVE X'3A20233030303138383036' TO DFHEIV0(25:11)
 20009     CALL 'kxdfhei1' USING DFHEIV0
 20010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20011
 20012
 20013
 20014* EXEC CICS READ
 20015*        DATASET     (CERT-ID)
 20016*        INTO        (CERTIFICATE-MASTER)
 20017*        RIDFLD      (ELCERT-KEY)
 20018*        UPDATE
 20019*    END-EXEC.
 20020     MOVE LENGTH OF
 20021      CERTIFICATE-MASTER
 20022       TO DFHEIV11
 20023*    MOVE '&"IL       EU         (   #00018810' TO DFHEIV0
 20024     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20025     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20026     MOVE X'2020233030303138383130' TO DFHEIV0(25:11)
 20027     CALL 'kxdfhei1' USING DFHEIV0,
 20028           CERT-ID,
 20029           CERTIFICATE-MASTER,
 20030           DFHEIV11,
 20031           ELCERT-KEY,
 20032           DFHEIV99,
 20033           DFHEIV99,
 20034           DFHEIV99
 20035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20036
 20037
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 370
* EL050.cbl
 20038 8590-EXIT.
 20039     EXIT.
 20040
 20041 8690-READ-CERT-MASTER-UCL.
 20042
 20043* EXEC CICS HANDLE CONDITION
 20044*         NOTFND    (8700-READ-CERT-MASTER)
 20045*    END-EXEC.
 20046*    MOVE '"$I                   ! ; #00018821' TO DFHEIV0
 20047     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20049     MOVE X'3B20233030303138383231' TO DFHEIV0(25:11)
 20050     CALL 'kxdfhei1' USING DFHEIV0
 20051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20052
 20053
 20054 8690-READ-CERT-CONT.
 20055
 20056* EXEC CICS READ
 20057*        DATASET     (CERT-ID)
 20058*        INTO        (CERTIFICATE-MASTER)
 20059*        RIDFLD      (ELCERT-KEY)
 20060*        UPDATE
 20061*    END-EXEC.
 20062     MOVE LENGTH OF
 20063      CERTIFICATE-MASTER
 20064       TO DFHEIV11
 20065*    MOVE '&"IL       EU         (   #00018826' TO DFHEIV0
 20066     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20067     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20068     MOVE X'2020233030303138383236' TO DFHEIV0(25:11)
 20069     CALL 'kxdfhei1' USING DFHEIV0,
 20070           CERT-ID,
 20071           CERTIFICATE-MASTER,
 20072           DFHEIV11,
 20073           ELCERT-KEY,
 20074           DFHEIV99,
 20075           DFHEIV99,
 20076           DFHEIV99
 20077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20078
 20079
 20080     GO TO 8590-EXIT.
 20081
 20082 8700-READ-CERT-MASTER.
 20083     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20084     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20085
 20086* EXEC CICS HANDLE CONDITION
 20087*         DUPKEY    (8720-COMP-ACCOUNTS)
 20088*         ENDFILE   (8730-END-BROWSE)
 20089*         NOTFND    (8740-NOT-FOUND)
 20090*    END-EXEC.
 20091*    MOVE '"$$''I                 ! < #00018838' TO DFHEIV0
 20092     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20094     MOVE X'3C20233030303138383338' TO DFHEIV0(25:11)
 20095     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 371
* EL050.cbl
 20096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20097
 20098
 20099
 20100* EXEC CICS STARTBR
 20101*        DATASET     ('ELCERT5')
 20102*        RIDFLD      (ELCERT2-KEY)
 20103*        EQUAL
 20104*    END-EXEC.
 20105     MOVE 'ELCERT5' TO DFHEIV1
 20106     MOVE 0
 20107       TO DFHEIV11
 20108*    MOVE '&,         E          &   #00018844' TO DFHEIV0
 20109     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20110     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20111     MOVE X'2020233030303138383434' TO DFHEIV0(25:11)
 20112     CALL 'kxdfhei1' USING DFHEIV0,
 20113           DFHEIV1,
 20114           ELCERT2-KEY,
 20115           DFHEIV99,
 20116           DFHEIV11,
 20117           DFHEIV99
 20118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20119
 20120
 20121 8710-READ-NEXT.
 20122
 20123* EXEC CICS READNEXT
 20124*        DATASET     ('ELCERT5')
 20125*        INTO        (CERTIFICATE-MASTER)
 20126*        RIDFLD      (ELCERT2-KEY)
 20127*    END-EXEC.
 20128     MOVE LENGTH OF
 20129      CERTIFICATE-MASTER
 20130       TO DFHEIV12
 20131     MOVE 'ELCERT5' TO DFHEIV1
 20132     MOVE 0
 20133       TO DFHEIV11
 20134*    MOVE '&.IL                  )   #00018851' TO DFHEIV0
 20135     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20136     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20137     MOVE X'2020233030303138383531' TO DFHEIV0(25:11)
 20138     CALL 'kxdfhei1' USING DFHEIV0,
 20139           DFHEIV1,
 20140           CERTIFICATE-MASTER,
 20141           DFHEIV12,
 20142           ELCERT2-KEY,
 20143           DFHEIV99,
 20144           DFHEIV11,
 20145           DFHEIV99,
 20146           DFHEIV99
 20147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20148
 20149
 20150 8720-COMP-ACCOUNTS.
 20151
 20152* EXEC CICS ENTER
 20153*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 372
* EL050.cbl
 20154*         FROM (PB-C-LAST-NAME)
 20155*    END-EXEC.
 20156     MOVE 001
 20157       TO DFHEIV11
 20158*    MOVE ':$F                   %   #00018858' TO DFHEIV0
 20159     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20160     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20161     MOVE X'2020233030303138383538' TO DFHEIV0(25:11)
 20162     CALL 'kxdfhei1' USING DFHEIV0,
 20163           DFHEIV11,
 20164           PB-C-LAST-NAME,
 20165           DFHEIV99,
 20166           DFHEIV99
 20167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20168
 20169
 20170
 20171* EXEC CICS ENTER
 20172*         TRACEID (002)
 20173*         FROM (CM-INSURED-LAST-NAME)
 20174*    END-EXEC.
 20175     MOVE 002
 20176       TO DFHEIV11
 20177*    MOVE ':$F                   %   #00018863' TO DFHEIV0
 20178     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20179     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20180     MOVE X'2020233030303138383633' TO DFHEIV0(25:11)
 20181     CALL 'kxdfhei1' USING DFHEIV0,
 20182           DFHEIV11,
 20183           CM-INSURED-LAST-NAME,
 20184           DFHEIV99,
 20185           DFHEIV99
 20186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20187
 20188
 20189     IF PB-CERT-NO NOT = CM-CERT-NO
 20190         GO TO 8730-END-BROWSE.
 20191
 20192     IF PB-ACCOUNT = CM-ACCOUNT
 20193         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20194             MOVE ER-2799        TO WS-ERROR
 20195             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20196             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20197             GO TO 8730-END-BROWSE.
 20198
 20199     GO TO 8710-READ-NEXT.
 20200
 20201 8730-END-BROWSE.
 20202
 20203* EXEC CICS ENDBR
 20204*         DATASET    ('ELCERT5')
 20205*    END-EXEC.
 20206     MOVE 'ELCERT5' TO DFHEIV1
 20207     MOVE 0
 20208       TO DFHEIV11
 20209*    MOVE '&2                    $   #00018881' TO DFHEIV0
 20210     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20211     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 373
* EL050.cbl
 20212     MOVE X'2020233030303138383831' TO DFHEIV0(25:11)
 20213     CALL 'kxdfhei1' USING DFHEIV0,
 20214           DFHEIV1,
 20215           DFHEIV11,
 20216           DFHEIV99
 20217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20218
 20219
 20220 8740-NOT-FOUND.
 20221     GO TO 0299-CERT-NOT-FOUND.
 20222
 20223 8750-START-ELSTAT.
 20224
 20225* EXEC CICS STARTBR
 20226*       DATASET   (STAT-ID)
 20227*       RIDFLD    (ELSTAT-KEY)
 20228*       GTEQ
 20229*       RESP      (WS-RESPONSE)
 20230*    END-EXEC
 20231     MOVE 0
 20232       TO DFHEIV11
 20233*    MOVE '&,         G          &  N#00018889' TO DFHEIV0
 20234     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20235     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20236     MOVE X'204E233030303138383839' TO DFHEIV0(25:11)
 20237     CALL 'kxdfhei1' USING DFHEIV0,
 20238           STAT-ID,
 20239           ELSTAT-KEY,
 20240           DFHEIV99,
 20241           DFHEIV11,
 20242           DFHEIV99
 20243     MOVE EIBRESP  TO WS-RESPONSE
 20244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20245     IF WS-RESP-NORMAL
 20246        MOVE 'Y'                 TO STAT-MASTER-SW
 20247     ELSE
 20248        MOVE 'N'                 TO STAT-MASTER-SW
 20249     END-IF
 20250     .
 20251 8750-EXIT.
 20252     EXIT.
 20253 8752-READ-ELSTAT.
 20254
 20255* EXEC CICS READNEXT
 20256*       DATASET   (STAT-ID)
 20257*       RIDFLD    (ELSTAT-KEY)
 20258*       INTO      (STATE-FILE)
 20259*       RESP      (WS-RESPONSE)
 20260*    END-EXEC
 20261     MOVE LENGTH OF
 20262      STATE-FILE
 20263       TO DFHEIV12
 20264     MOVE 0
 20265       TO DFHEIV11
 20266*    MOVE '&.IL                  )  N#00018904' TO DFHEIV0
 20267     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20269     MOVE X'204E233030303138393034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 374
* EL050.cbl
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           STAT-ID,
 20272           STATE-FILE,
 20273           DFHEIV12,
 20274           ELSTAT-KEY,
 20275           DFHEIV99,
 20276           DFHEIV11,
 20277           DFHEIV99,
 20278           DFHEIV99
 20279     MOVE EIBRESP  TO WS-RESPONSE
 20280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20281     IF WS-RESP-NORMAL
 20282        MOVE 'Y'                 TO STAT-MASTER-SW
 20283     ELSE
 20284        MOVE 'N'                 TO STAT-MASTER-SW
 20285     END-IF
 20286     .
 20287 8752-EXIT.
 20288     EXIT.
 20289 8800-GET-COMP-RATE.
 20290     MOVE +1 TO IB.
 20291     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20292         ADD +9 TO IB
 20293         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20294             ADD +9 TO IB
 20295             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20296                MOVE ZEROS       TO WS-WK-RATE
 20297                GO TO 8800-EXIT.
 20298
 20299     IF PB-I-AGE GREATER CT-AGE (1)
 20300         ADD +3 TO IB
 20301         IF PB-I-AGE GREATER CT-AGE (2)
 20302             ADD +3 TO IB
 20303             IF PB-I-AGE GREATER CT-AGE (3)
 20304                MOVE ZEROS       TO WS-WK-RATE
 20305                GO TO 8800-EXIT.
 20306
 20307     IF WS-WORK-TERM GREATER CT-TRM (1)
 20308         ADD +1 TO IB
 20309         IF WS-WORK-TERM GREATER CT-TRM (2)
 20310             ADD +1 TO IB
 20311             IF WS-WORK-TERM GREATER CT-TRM (3)
 20312                MOVE ZEROS       TO WS-WK-RATE
 20313                GO TO 8800-EXIT.
 20314
 20315     IF CT-RT (IB) NOT NUMERIC
 20316         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20317         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20318         GO TO 8800-GET-COMP-RATE.
 20319
 20320     MOVE CT-RT (IB) TO WS-WK-RATE.
 20321
 20322 8800-EXIT.
 20323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 375
* EL050.cbl
 20325 8900-ADDRESS-FILE.
 20326     IF ERACCT-FILE-ADDRESSED
 20327         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20328         GO TO 8900-ADDRESS-EXIT.
 20329
 20330     IF ELCNTL-FILE-ADDRESSED
 20331         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20332         GO TO 8900-ADDRESS-EXIT.
 20333
 20334     IF ERPLAN-FILE-ADDRESSED
 20335         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20336         GO TO 8900-ADDRESS-EXIT.
 20337
 20338     IF ERFORM-FILE-ADDRESSED
 20339         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20340         GO TO 8900-ADDRESS-EXIT.
 20341
 20342 8900-ADDRESS-EXIT.
 20343     EXIT.
 20344
 20345 9000-READ-CONTROL.
 20346
 20347* EXEC CICS HANDLE CONDITION
 20348*        NOTFND    (9000-NOTFND)
 20349*    END-EXEC.
 20350*    MOVE '"$I                   ! = #00018975' TO DFHEIV0
 20351     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20353     MOVE X'3D20233030303138393735' TO DFHEIV0(25:11)
 20354     CALL 'kxdfhei1' USING DFHEIV0
 20355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20356
 20357
 20358
 20359* EXEC CICS READ
 20360*        DATASET     (CNTL-ID)
 20361*        SET         (ADDRESS OF CONTROL-FILE)
 20362*        RIDFLD      (ELCNTL-KEY)
 20363*        GTEQ
 20364*    END-EXEC.
 20365*    MOVE '&"S        G          (   #00018979' TO DFHEIV0
 20366     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20367     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20368     MOVE X'2020233030303138393739' TO DFHEIV0(25:11)
 20369     CALL 'kxdfhei1' USING DFHEIV0,
 20370           CNTL-ID,
 20371           DFHEIV20,
 20372           DFHEIV99,
 20373           ELCNTL-KEY,
 20374           DFHEIV99,
 20375           DFHEIV99,
 20376           DFHEIV99
 20377     SET ADDRESS OF CONTROL-FILE TO
 20378         DFHEIV20
 20379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20380
 20381
 20382     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 376
* EL050.cbl
 20383
 20384 9000-NOTFND.
 20385     IF RC-SW-1 = '1'
 20386        MOVE ER-2616              TO WS-ERROR
 20387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20388        GO TO 9000-EXIT.
 20389
 20390     IF RC-SW-1 = '2'
 20391        MOVE ER-2602              TO WS-ERROR
 20392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20393
 20394 9000-EXIT.
 20395      EXIT.
 20396
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 377
* EL050.cbl
 20398 9100-READ-CONTROL.
 20399
 20400* EXEC CICS HANDLE CONDITION
 20401*        NOTFND  (9100-NOTFND)
 20402*        ENDFILE (9100-NOTFND)
 20403*    END-EXEC.
 20404*    MOVE '"$I''                  ! > #00019003' TO DFHEIV0
 20405     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20407     MOVE X'3E20233030303139303033' TO DFHEIV0(25:11)
 20408     CALL 'kxdfhei1' USING DFHEIV0
 20409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20410
 20411
 20412
 20413* EXEC CICS READ
 20414*        DATASET     (CNTL-ID)
 20415*        INTO        (CONTROL-FILE)
 20416*        RIDFLD      (ELCNTL-KEY)
 20417*        GTEQ
 20418*    END-EXEC.
 20419     MOVE LENGTH OF
 20420      CONTROL-FILE
 20421       TO DFHEIV11
 20422*    MOVE '&"IL       G          (   #00019008' TO DFHEIV0
 20423     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20425     MOVE X'2020233030303139303038' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0,
 20427           CNTL-ID,
 20428           CONTROL-FILE,
 20429           DFHEIV11,
 20430           ELCNTL-KEY,
 20431           DFHEIV99,
 20432           DFHEIV99,
 20433           DFHEIV99
 20434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20435
 20436
 20437     GO TO 9100-EXIT.
 20438
 20439 9100-NOTFND.
 20440     IF RC-SW-2 = '0'
 20441        MOVE '1'                  TO STATE-RECORD-ERROR
 20442        GO TO 9100-EXIT
 20443     END-IF
 20444     IF RC-SW-2 = '1'
 20445        MOVE '1'                  TO LF-BENEFIT-ERROR
 20446        MOVE ER-2604              TO WS-ERROR
 20447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20448        GO TO 9100-EXIT.
 20449
 20450     IF RC-SW-2 = '2'
 20451        MOVE '1'                  TO AH-BENEFIT-ERROR
 20452        MOVE ER-2605              TO WS-ERROR
 20453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20454        GO TO 9100-EXIT.
 20455
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 378
* EL050.cbl
 20456     IF RC-SW-2 = '3'
 20457         MOVE ER-2603           TO WS-ERROR
 20458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20459         GO TO 9100-EXIT.
 20460
 20461     IF RC-SW-2 = '4'
 20462         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20463         GO TO 9100-EXIT.
 20464
 20465     IF RC-SW-2 = '5'
 20466         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20467         IF WS-AH-INPUT-CD-1 = SPACE
 20468             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20469         ELSE
 20470             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20471
 20472 9100-EXIT.
 20473      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 379
* EL050.cbl
 20475 9200-CONTROL-GETMAIN.
 20476
 20477* EXEC CICS GETMAIN
 20478*         LENGTH   (750)
 20479*         SET      (ADDRESS OF CONTROL-FILE)
 20480*    END-EXEC.
 20481     MOVE 750
 20482       TO DFHEIV11
 20483*    MOVE '," L                  $   #00019054' TO DFHEIV0
 20484     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20485     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20486     MOVE X'2020233030303139303534' TO DFHEIV0(25:11)
 20487     CALL 'kxdfhei1' USING DFHEIV0,
 20488           DFHEIV20,
 20489           DFHEIV11,
 20490           DFHEIV99
 20491     SET ADDRESS OF CONTROL-FILE TO
 20492         DFHEIV20
 20493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20494
 20495
 20496     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20497
 20498 9200-EXIT.
 20499     EXIT.
 20500
 20501 9250-UNLOCK-RETURN.
 20502
 20503* EXEC CICS UNLOCK
 20504*        DATASET   (CERT-ID)
 20505*    END-EXEC.
 20506*    MOVE '&*                    #   #00019065' TO DFHEIV0
 20507     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20508     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20509     MOVE X'2020233030303139303635' TO DFHEIV0(25:11)
 20510     CALL 'kxdfhei1' USING DFHEIV0,
 20511           CERT-ID,
 20512           DFHEIV99
 20513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20514
 20515
 20516 9300-ABEND.
 20517     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20518
 20519
 20520* EXEC CICS LINK
 20521*        PROGRAM   ('EL004')
 20522*        COMMAREA  (WS-ERROR-LINE)
 20523*        LENGTH    (72)
 20524*    END-EXEC.
 20525     MOVE 'EL004' TO DFHEIV1
 20526     MOVE 72
 20527       TO DFHEIV11
 20528*    MOVE '."C                   ''   #00019072' TO DFHEIV0
 20529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20530     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20531     MOVE X'2020233030303139303732' TO DFHEIV0(25:11)
 20532     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 380
* EL050.cbl
 20533           DFHEIV1,
 20534           WS-ERROR-LINE,
 20535           DFHEIV11,
 20536           DFHEIV99,
 20537           DFHEIV99,
 20538           DFHEIV99
 20539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20540
 20541
 20542     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20543
 20544
 20545* EXEC CICS ABEND
 20546*        ABCODE ('EL50')
 20547*    END-EXEC.
 20548     MOVE 'EL50' TO DFHEIV5
 20549*    MOVE '.,A                   "   #00019080' TO DFHEIV0
 20550     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20551     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20552     MOVE X'2020233030303139303830' TO DFHEIV0(25:11)
 20553     CALL 'kxdfhei1' USING DFHEIV0,
 20554           DFHEIV5
 20555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20556
 20557
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 381
* EL050.cbl
 20559
 20560******************************************************************
 20561*                                                                *
 20562*            E R R O R   F O R M A T   R O U T I N E             *
 20563*                                                                *
 20564******************************************************************
 20565
 20566 9900-ERROR-FORMAT.
 20567
 20568     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20569                    PB-COMMON-ERROR (2) OR
 20570                    PB-COMMON-ERROR (3) OR
 20571                    PB-COMMON-ERROR (4) OR
 20572                    PB-COMMON-ERROR (5) OR
 20573                    PB-COMMON-ERROR (6) OR
 20574                    PB-COMMON-ERROR (7) OR
 20575                    PB-COMMON-ERROR (8) OR
 20576                    PB-COMMON-ERROR (9) OR
 20577                    PB-COMMON-ERROR (10)
 20578        GO TO 9900-EXIT.
 20579
 20580     IF PB-NO-OF-ERRORS = +10
 20581        GO TO 9900-EXIT.
 20582
 20583     ADD +1  TO PB-NO-OF-ERRORS.
 20584     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20585                                       (PB-NO-OF-ERRORS).
 20586 9900-EXIT.
 20587     EXIT.
 20588
 20589 9990-RETURN.
 20590     IF BROWSE-STARTED
 20591
 20592* EXEC CICS ENDBR
 20593*            DATASET  (ACCT-ID)
 20594*       END-EXEC.
 20595     MOVE 0
 20596       TO DFHEIV11
 20597*    MOVE '&2                    $   #00019117' TO DFHEIV0
 20598     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20599     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20600     MOVE X'2020233030303139313137' TO DFHEIV0(25:11)
 20601     CALL 'kxdfhei1' USING DFHEIV0,
 20602           ACCT-ID,
 20603           DFHEIV11,
 20604           DFHEIV99
 20605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20606
 20607
 20608 9990-EXIT.
 20609     EXIT.
 20610
 20611 9999-RETURN.
 20612     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20613
 20614
 20615* EXEC CICS RETURN
 20616*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 382
* EL050.cbl
 20617*    MOVE '.(                    &   #00019127' TO DFHEIV0
 20618     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20619     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20620     MOVE X'2020233030303139313237' TO DFHEIV0(25:11)
 20621     CALL 'kxdfhei1' USING DFHEIV0,
 20622           DFHEIV99,
 20623           DFHEIV99,
 20624           DFHEIV99,
 20625           DFHEIV99,
 20626           DFHEIV99
 20627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20628
 20629
 20630
 20631* GOBACK.
 20632     MOVE '9%                    "   ' TO DFHEIV0
 20633     MOVE 'EL050' TO DFHEIV1
 20634     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20635     GOBACK.
 20636
 20637 9999-DFHBACK SECTION.
 20638     MOVE '9%                    "   ' TO DFHEIV0
 20639     MOVE 'EL050' TO DFHEIV1
 20640     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20641     GOBACK.
 20642 9999-DFHEXIT.
 20643     IF DFHEIGDJ EQUAL 0001
 20644         NEXT SENTENCE
 20645     ELSE IF DFHEIGDJ EQUAL 2
 20646         GO TO 9300-ABEND,
 20647               3990-FILES-NOT-OPEN
 20648         DEPENDING ON DFHEIGDI
 20649     ELSE IF DFHEIGDJ EQUAL 3
 20650         GO TO 6610-START-BROWSE,
 20651               6630-ERRESS-PROBLEM,
 20652               6630-END-OF-FILE
 20653         DEPENDING ON DFHEIGDI
 20654     ELSE IF DFHEIGDJ EQUAL 4
 20655         GO TO 6630-END-OF-FILE,
 20656               6630-ERRESS-PROBLEM,
 20657               6630-ERRESS-PROBLEM,
 20658               6630-END-OF-FILE
 20659         DEPENDING ON DFHEIGDI
 20660     ELSE IF DFHEIGDJ EQUAL 5
 20661         GO TO 6630-END-OF-FILE,
 20662               6630-END-OF-FILE,
 20663               6630-ERRESS-PROBLEM,
 20664               6630-ERRESS-PROBLEM
 20665         DEPENDING ON DFHEIGDI
 20666     ELSE IF DFHEIGDJ EQUAL 6
 20667         GO TO 6660-START-BROWSE,
 20668               6690-ERRESC-PROBLEM,
 20669               6690-ERRESC-PROBLEM,
 20670               6690-END-OF-FILE
 20671         DEPENDING ON DFHEIGDI
 20672     ELSE IF DFHEIGDJ EQUAL 7
 20673         GO TO 6690-END-OF-FILE,
 20674               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 383
* EL050.cbl
 20675               6690-ERRESC-PROBLEM,
 20676               6690-END-OF-FILE
 20677         DEPENDING ON DFHEIGDI
 20678     ELSE IF DFHEIGDJ EQUAL 8
 20679         GO TO 6690-END-OF-FILE,
 20680               6690-ERRESC-PROBLEM,
 20681               6690-ERRESC-PROBLEM,
 20682               6690-END-OF-FILE
 20683         DEPENDING ON DFHEIGDI
 20684     ELSE IF DFHEIGDJ EQUAL 9
 20685         GO TO 7250-CONTINUE,
 20686               7250-CONTINUE
 20687         DEPENDING ON DFHEIGDI
 20688     ELSE IF DFHEIGDJ EQUAL 10
 20689         GO TO 7300-CONTINUE,
 20690               7300-CONTINUE
 20691         DEPENDING ON DFHEIGDI
 20692     ELSE IF DFHEIGDJ EQUAL 11
 20693         GO TO 8000-FREE-MAIN
 20694         DEPENDING ON DFHEIGDI
 20695     ELSE IF DFHEIGDJ EQUAL 12
 20696         GO TO 8100-NOTFND,
 20697               8100-NOTFND
 20698         DEPENDING ON DFHEIGDI
 20699     ELSE IF DFHEIGDJ EQUAL 13
 20700         GO TO 8110-NOTFND,
 20701               8110-NOTFND
 20702         DEPENDING ON DFHEIGDI
 20703     ELSE IF DFHEIGDJ EQUAL 14
 20704         GO TO 8130-EXIT
 20705         DEPENDING ON DFHEIGDI
 20706     ELSE IF DFHEIGDJ EQUAL 15
 20707         GO TO 8180-NOTFND
 20708         DEPENDING ON DFHEIGDI
 20709     ELSE IF DFHEIGDJ EQUAL 16
 20710         GO TO 8190-NOTFND
 20711         DEPENDING ON DFHEIGDI
 20712     ELSE IF DFHEIGDJ EQUAL 17
 20713         GO TO 8200-NOTFND
 20714         DEPENDING ON DFHEIGDI
 20715     ELSE IF DFHEIGDJ EQUAL 18
 20716         GO TO 8300-NOTFND,
 20717               8300-ERRESS-PROBLEM,
 20718               8300-ERRESS-PROBLEM,
 20719               8300-NOTFND
 20720         DEPENDING ON DFHEIGDI
 20721     ELSE IF DFHEIGDJ EQUAL 19
 20722         GO TO 8450-FORM-NOT-FOUND,
 20723               8450-FORM-NOT-FOUND
 20724         DEPENDING ON DFHEIGDI
 20725     ELSE IF DFHEIGDJ EQUAL 20
 20726         GO TO 0199-ACCT-NOT-FOUND,
 20727               0199-ACCT-NOT-FOUND
 20728         DEPENDING ON DFHEIGDI
 20729     ELSE IF DFHEIGDJ EQUAL 21
 20730         GO TO 0199-ACCT-NOT-FOUND,
 20731               0199-ACCT-NOT-FOUND
 20732         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 08-Nov-11 11:55 Page 384
* EL050.cbl
 20733     ELSE IF DFHEIGDJ EQUAL 22
 20734         GO TO 8582-COMP-NOT-FOUND,
 20735               8582-COMP-NOT-FOUND
 20736         DEPENDING ON DFHEIGDI
 20737     ELSE IF DFHEIGDJ EQUAL 23
 20738         GO TO 8583-AGTC-NOT-FOUND,
 20739               8583-AGTC-NOT-FOUND
 20740         DEPENDING ON DFHEIGDI
 20741     ELSE IF DFHEIGDJ EQUAL 24
 20742         GO TO 8584-BXRF-NOT-FOUND,
 20743               8584-BXRF-NOT-FOUND
 20744         DEPENDING ON DFHEIGDI
 20745     ELSE IF DFHEIGDJ EQUAL 25
 20746         GO TO 8585-PLAN-NOT-FOUND,
 20747               8585-PLAN-NOT-FOUND
 20748         DEPENDING ON DFHEIGDI
 20749     ELSE IF DFHEIGDJ EQUAL 26
 20750         GO TO 0299-CERT-NOT-FOUND
 20751         DEPENDING ON DFHEIGDI
 20752     ELSE IF DFHEIGDJ EQUAL 27
 20753         GO TO 8700-READ-CERT-MASTER
 20754         DEPENDING ON DFHEIGDI
 20755     ELSE IF DFHEIGDJ EQUAL 28
 20756         GO TO 8720-COMP-ACCOUNTS,
 20757               8730-END-BROWSE,
 20758               8740-NOT-FOUND
 20759         DEPENDING ON DFHEIGDI
 20760     ELSE IF DFHEIGDJ EQUAL 29
 20761         GO TO 9000-NOTFND
 20762         DEPENDING ON DFHEIGDI
 20763     ELSE IF DFHEIGDJ EQUAL 30
 20764         GO TO 9100-NOTFND,
 20765               9100-NOTFND
 20766         DEPENDING ON DFHEIGDI.
 20767     MOVE '9%                    "   ' TO DFHEIV0
 20768     MOVE 'EL050' TO DFHEIV1
 20769     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20770     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39412     Code:       83851
