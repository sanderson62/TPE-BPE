* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   3
* EL050.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER   PIC X(32) VALUE '********************************'.
    54 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    55 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    56
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    63                                   USAGE IS POINTER.
    64 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    69                                   USAGE IS POINTER.
    70
    71 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75*    COPY ELC50WS.
    76*****************************************************************
    77*                                                               *
    78*                            ELC50WS.                           *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.061.                        *
    81*                                                               *
    82*   THIS IS THE WORKING STORAGE FOR EL050                       *
    83*                                   EL517                       *
    84*****************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 123102                   PEMA  ADD DCC PROCESSING
    94* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    95* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    96* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    97* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    98* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    99* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   100* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   101* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   102* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   103* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   104* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   105* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   107* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   4
* EL050.cbl
   108* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   109* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   110* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   111* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   112* 030309  CR2009021700001  PEMA  ADD ER-2883
   113* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   114* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   115* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   116* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   117* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   118* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   119* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   120* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   121* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   122* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   123* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   124* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   125* 061412  CR2011022800001  AJRA  NAPERSOFT
   126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   127* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   128* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   129*-----------------------------------------------------------------
   130
   131 01  WORK-AREAS.
   132
   133*****************************************************************
   134*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   135*****************************************************************
   136
   137     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   138     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   139     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   140     12  WS-NAME-EDIT-WORK-AREA.
   141         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   142         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   143             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   144         16  WS-WORK-NAME.
   145             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   146             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   147             20  FILLER           PIC X(10)     VALUE SPACES.
   148         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   149             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   150
   151*****************************************************************
   152*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   153*****************************************************************
   154
   155     12  WS-ERRESC-KEY.
   156         16 WS-ERRESC-SEARCH-KEY.
   157             20  WS-ERRESC-COMPANY-CD PIC  X.
   158             20  WS-ERRESC-CARRIER    PIC  X.
   159             20  WS-ERRESC-GROUP      PIC X(6).
   160             20  WS-ERRESC-STATE      PIC XX.
   161             20  WS-ERRESC-ACCOUNT    PIC X(10).
   162         16 WS-ERRESC-RESIDUAL-KEY.
   163             20  WS-ERRESC-AGENT      PIC X(10).
   164             20  WS-ERRESC-RES-STATE  PIC XX.
   165             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   5
* EL050.cbl
   166*                                          YYYYMMDD
   167     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   168     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   169
   170*RESIDENT STATE TAX MASTER(ERRESS)
   171*
   172     12  WS-ERRESS-KEY.
   173         16  WS-ERRESS-COMPANY-CD      PIC  X.
   174         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   175         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   176         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   177*                                          YYYYMMDD
   178
   179     12  WS-CONTRACT-DATE              PIC 9(8).
   180*                                          YYYYMMDD
   181     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   182     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   183         16 WS-YEAR-YY                 PIC   9999.
   184         16 FILLER                     PIC 9(4).
   185*                                          YYYYMMDD
   186     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   187     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   188     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   190
   191     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   192         88  DPRB-1ST-TIME                      VALUE ' '.
   193
   194*****************************************************************
   195*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   196*****************************************************************
   197
   198     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   199     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   200     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   203     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   204     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   205     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   206     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   207     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   208         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   209         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   210     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   211         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   212         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   213     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   214
   215     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   216     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   217
   218     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   219     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   6
* EL050.cbl
   224     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   231     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   232     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   233     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   254     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   255     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   256     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   257     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   266     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   267     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   268     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   269     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   270     12  WS-2671-SW               PIC X         VALUE SPACE.
   271     12  WS-2672-SW               PIC X         VALUE SPACE.
   272     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   273         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   274     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   275         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   276     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   277
   278     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   279         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   280         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   281         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   7
* EL050.cbl
   282         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   283
   284     12  WS-CREDIT-EDIT-CONTROLS.
   285         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   286         16  WS-MIN-AGE           PIC 99                VALUE  0.
   287         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   288         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   289         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   290         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   291
   292     12  WS-AGE-FIELDS.
   293         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   294         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   295         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   296         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   297
   298     12  WS-SAVE-ALLOWABLE-BENEFIT.
   299         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   300         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   301         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   302         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   303         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   304         16  FILLER                      PIC XX.
   305
   306     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   307     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   308     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   309     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   310     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   311     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   312     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   313     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   314     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   315     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   316
   317     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   318     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   319     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   320     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   321     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   322     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   323     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   324     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   325         88  WS-REDUCING              VALUE 'R'.
   326         88  WS-LEVEL                 VALUE 'L' 'P'.
   327     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   328
   329     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   330     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   331     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   332     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   333     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   334     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   335     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   336     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   337     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   338
   339     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   8
* EL050.cbl
   340     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   341     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   342     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   343     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   344     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   345     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   346     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   347     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   348     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   349     12  WS-ACCT-SIG-SW.
   350         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   351         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   352     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   353     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   354     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-INITIALS.
   361         16  WS-INIT-1            PIC X         VALUE SPACES.
   362         16  WS-INIT-2            PIC X         VALUE SPACES.
   363
   364     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   365     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   366     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   367     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   368     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   369*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   370     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   377     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   378     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   380     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   383     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392******** FLA
   393     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   397     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page   9
* EL050.cbl
   398********
   399     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   402     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   403     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   404     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   405     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   406     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   407     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   408     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   409
   410     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   411         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   412                                         '0' THRU '9'.
   413
   414     12  NUMBER-OF-MONTHS.
   415         16  SK-MO OCCURS 12 TIMES PIC X.
   416
   417     12  WS-WORK-DATE.
   418         16  WS-YEAR            PIC 99    VALUE 00.
   419         16  WS-MONTH           PIC 99    VALUE 00.
   420         16  WS-DAY             PIC 99    VALUE 00.
   421
   422     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   423     12  WS-WORK-CRIT-DEV       REDEFINES
   424         WS-WORK-LF-CRIT-PER    PIC X(03).
   425
   426     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   427     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   428
   429     12  WS-WORK-DATE-FROM.
   430         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   431         16  FILLER             PIC X  VALUE SPACE.
   432         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   433         16  FILLER             PIC X         VALUE SPACE.
   434         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   435
   436     12  WS-WORK-DATE-THRU.
   437         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   440         16  FILLER             PIC X         VALUE SPACE.
   441         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   442
   443     12  WS-LF-INPUT-CD.
   444         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   445         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   446
   447     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   448     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   449         16  WS-AH-INPUT-CD-1   PIC X.
   450         16  WS-AH-INPUT-CD-2-3 PIC XX.
   451
   452     12  WS-SWITCHES.
   453         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   454         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   455             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  10
* EL050.cbl
   456         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   457             88  BANK-ACCT-FOUND          VALUE 'Y'.
   458         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   459             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   460         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   461             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   462         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   463             88  COMP-MASTER-FOUND        VALUE 'Y'.
   464         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   465             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   466         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   467             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   468         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   469             88  STAT-MASTER-FOUND        VALUE 'Y'.
   470         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   471             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   472         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   473             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   474         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   475             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   476         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   477             88  FORM-MASTER-FOUND        VALUE 'Y'.
   478         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   479             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   480         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   481             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   482         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   483             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   484         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   485             88  NO-BENEFIT-FOUND         VALUE 'N'.
   486         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   487             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   488         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   489             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   490         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   491             88  AH-BENEFIT-FOUND         VALUE ' '.
   492             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   493         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   494             88  LF-BENEFIT-FOUND         VALUE ' '.
   495             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   496         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   497             88  NO-STATE-RECORD          VALUE '1'.
   498         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   499             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   500         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   501             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   502         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   503             88  CERT-WAS-FOUND           VALUE ' '.
   504             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   505         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   506             88  BROWSE-STARTED           VALUE 'Y'.
   507         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   508             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   509         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   510             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   511         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   512             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   513         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  11
* EL050.cbl
   514             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   515         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   516             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   517         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   518             88  APP-CERT-USED            VALUE 'Y' 'A'.
   519         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   520             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   521             88  FIRST-TIME-THROUGH       VALUE '1'.
   522             88  CTBL-NOT-FOUND           VALUE '2'.
   523
   524         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   525             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   526
   527         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   528             88  DLO-ERROR-FOUND          VALUE 'Y'.
   529
   530********FLA
   531     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   532     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   533********
   534     12  RC-SW-1                  PIC X           VALUE '0'.
   535     12  RC-SW-2                  PIC X           VALUE '0'.
   536     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   537     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   538     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   546     12  LIT-SPACES               PIC X           VALUE SPACES.
   547     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   548     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   549     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   550     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   551     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   552     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   553     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   554         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   555         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   556     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   557         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   558
   559 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   560     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   561     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   562 01  WS-CRI-SSN-WORK-AREA.
   563     05  WS-CRI-SOC-SEC-NO.
   564         10  WS-SS-REPT-CD       PIC X(5).
   565         10  WS-SS-LAST-NAME     PIC X(5).
   566         10  WS-SS-INITIAL       PIC X.
   567
   568     05  WS-CRI-REPORT-CODE.
   569         10  FILLER              PIC X(5).
   570         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   571
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  12
* EL050.cbl
   572     05  WS-CRI-LAST-NAME.
   573         10  WS-CRI-NAME-MOVE    PIC X(5).
   574         10  FILLER              PIC X(10).
   575
   576 01  WS-NUM-TABLE                PIC X(26)  VALUE
   577     '12345678012345070923456789'.
   578 01  FILLER REDEFINES WS-NUM-TABLE.
   579     05  WS-NUM OCCURS 26        PIC 9.
   580 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   581 01  V1                          PIC S999 COMP-3.
   582 01  V2                          PIC S999 COMP-3.
   583 01  V3                          PIC S999 COMP-3.
   584 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   585 01  FILLER REDEFINES WS-WORK-VIN.
   586     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   587 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   588 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   589 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   590 01  WS-HEX-WORK.
   591     05  FILLER                  PIC X  VALUE LOW-VALUES.
   592     05  WS-HEX-BYTE             PIC X.
   593 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   594 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   595 01  WS-WORK-HIN-ROW-B.
   596     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   597
   598 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   599 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   600     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   601 01  WS-ROW-D-TABLE.
   602     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   603
   604 01  WS-HIN-TABLE-B.
   605     05  F                       PIC XX VALUE 'A2'.
   606     05  F                       PIC XX VALUE 'B3'.
   607     05  F                       PIC XX VALUE 'C4'.
   608     05  F                       PIC XX VALUE 'D5'.
   609     05  F                       PIC XX VALUE 'E6'.
   610     05  F                       PIC XX VALUE 'F7'.
   611     05  F                       PIC XX VALUE 'G8'.
   612     05  F                       PIC XX VALUE 'H9'.
   613     05  F                       PIC XX VALUE 'I1'.
   614     05  F                       PIC XX VALUE 'J2'.
   615     05  F                       PIC XX VALUE 'K3'.
   616     05  F                       PIC XX VALUE 'L4'.
   617     05  F                       PIC XX VALUE 'M5'.
   618     05  F                       PIC XX VALUE 'N6'.
   619     05  F                       PIC XX VALUE 'O0'.
   620     05  F                       PIC XX VALUE 'P7'.
   621     05  F                       PIC XX VALUE 'Q0'.
   622     05  F                       PIC XX VALUE 'R8'.
   623     05  F                       PIC XX VALUE 'S9'.
   624     05  F                       PIC XX VALUE 'T2'.
   625     05  F                       PIC XX VALUE 'U3'.
   626     05  F                       PIC XX VALUE 'V4'.
   627     05  F                       PIC XX VALUE 'W5'.
   628     05  F                       PIC XX VALUE 'X6'.
   629     05  F                       PIC XX VALUE 'Y7'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  13
* EL050.cbl
   630     05  F                       PIC XX VALUE 'Z8'.
   631 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   632     05  WS-VAL-IN               PIC X.
   633     05  WS-VAL-OUT              PIC 9.
   634 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   635 01  WS-COMPARE-BINARY-DATES.
   636     05  WS-971231                PIC XX VALUE X'92FF'.
   637     05  WS-931231                PIC XX VALUE X'8CFF'.
   638     05  WS-791231                PIC XX VALUE X'77FF'.
   639     05  WS-771001                PIC XX VALUE X'74A1'.
   640     05  WS-820301                PIC XX VALUE X'7B41'.
   641     05  WS-831031                PIC XX VALUE X'7DBF'.
   642     05  WS-831231                PIC XX VALUE X'7DFF'.
   643     05  WS-810831                PIC XX VALUE X'7A7F'.
   644     05  WS-830901                PIC XX VALUE X'7D81'.
   645
   646 01  FILE-ACCESS-IDS.
   647     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   648     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   649     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   650     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   651     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   652     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   653     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   654     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   655     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   656     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   657     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   658     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   659     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   660     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   661     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   662     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   663     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   664 01  DD-IU-SW                    PIC X   VALUE ' '.
   665     88  DD-IU-PRESENT                 VALUE 'Y'.
   666
   667 01  ACCESS-KEYS.
   668     12  ELMSTR-KEY.
   669         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   670         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   671     12  W-CLAIM-KEY.
   672         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   673         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   674
   675     12  ELCNTL-KEY.
   676         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   677         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   678         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   679         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   680
   681     12  ELCERT-KEY.
   682         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  CERT-CARRIER         PIC X       VALUE SPACE.
   684         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   685         16  CERT-STATE           PIC XX      VALUE SPACES.
   686         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   687         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  14
* EL050.cbl
   688         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   689
   690     12  ELCERT2-KEY.
   691         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   692         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   693
   694     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   695
   696     12  ELCERT-SAVE.
   697         16  FILLER                      PIC XX    VALUE SPACES.
   698
   699         16  WCS-CONTROL-PRIMARY.
   700             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   701             20  WCS-CARRIER             PIC X     VALUE SPACE.
   702             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   703             20  WCS-STATE               PIC XX    VALUE SPACES.
   704             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   705             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   706             20  WCS-CERT-NO.
   707                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   708                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   709
   710         16  CS-CONTROL-BY-NAME.
   711             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   712             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   713             20  CS-INSURED-INITIALS.
   714                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   715                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-SSN.
   718             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   719             20  CS-SOC-SEC-NO.
   720                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   721                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   722                 24  CS-SSN-LN3.
   723                     28 CS-INSURED-INITIALS-A2   PIC XX
   724                                     VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A2     PIC X
   726                                     VALUE SPACE.
   727
   728         16  CS-CONTROL-BY-CERT-NO.
   729             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   730             20  CS-CERT-NO-A4           PIC X(11)
   731                                     VALUE SPACES.
   732
   733         16  CS-CONTROL-BY-MEMB.
   734             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   735             20  CS-MEMBER-NO.
   736                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   737                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   738                 24  CS-MEMB-LN4.
   739                     28 CS-INSURED-INITIALS-A5   PIC XX
   740                                      VALUE SPACES.
   741                     28 CS-PART-LAST-NAME-A5     PIC XX
   742                                      VALUE SPACES.
   743
   744         16  FILLER              PIC X(360) VALUE SPACES.
   745
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  15
* EL050.cbl
   746     12  ERACCT-KEY.
   747         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   749         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   750         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   751         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   753
   754     12  ERCOMP-KEY.
   755         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   756         16  COMP-CARRIER         PIC X     VALUE SPACES.
   757         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   758         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   759         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   760         16  COMP-TYPE            PIC X     VALUE SPACES.
   761
   762     12  ERLOFC-KEY.
   763         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   764         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   765         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   766         16  LOFC-STATE           PIC XX    VALUE SPACES.
   767         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   768         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   769
   770     12  WS-ELCRTT-KEY.
   771         16  WS-ELCRTT-PRIMARY       PIC X(33).
   772         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   773
   774     12  ERBXRF-KEY.
   775         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   777         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   778         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   779
   780     12  ERAGTC-KEY.
   781         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   782         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   783         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   784         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   785         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   786         16  AGTC-TYPE            PIC X     VALUE SPACES.
   787
   788     12  ERPLAN-KEY.
   789         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   790         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   791         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   792         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   793         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   794         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   795         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   796         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   797
   798     12  ERFORM-KEY.
   799         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   800         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   801         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   802         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   803
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  16
* EL050.cbl
   804     12  ERREIN-KEY.
   805         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  REIN-TYPE            PIC X     VALUE SPACES.
   807         16  REIN-TABLE-CO.
   808             20  REIN-CODE-1      PIC X     VALUE SPACE.
   809             20  REIN-CODE-2      PIC X     VALUE SPACE.
   810             20  REIN-CODE-3      PIC X     VALUE SPACE.
   811         16  FILLER               PIC X(3)  VALUE SPACES.
   812
   813     12  ERCTBL-KEY.
   814         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   815         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   816         16  CTBL-CNTRL-2.
   817             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   818             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   819
   820     12  ELCRTO-KEY.
   821         16  ELCRTO-COMPANY-CD       PIC X.
   822         16  ELCRTO-CARRIER          PIC X.
   823         16  ELCRTO-GROUPING         PIC X(6).
   824         16  ELCRTO-STATE            PIC XX.
   825         16  ELCRTO-ACCOUNT          PIC X(10).
   826         16  ELCRTO-CERT-EFF-DT      PIC XX.
   827         16  ELCRTO-CERT-NO.
   828             20  ELCRTO-CERT-PRIME   PIC X(10).
   829             20  ELCRTO-CERT-SFX     PIC X.
   830         16  ELCRTO-RECORD-TYPE      PIC X.
   831         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   832
   833
   834     12  WS-ACCESS.
   835         16  FILLER               PIC XX    VALUE SPACES.
   836         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   837
   838     12  WS-CARR-ACCESS.
   839         16  FILLER               PIC X(3)  VALUE SPACES.
   840         16  WS-CARR              PIC X     VALUE SPACE.
   841*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   842*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   843     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   844         88  WS-DMD-LF-RATING   VALUE 'Y'.
   845         88  WS-DMD-AH-RATING   VALUE 'Y'.
   846         88  WS-DMD-NO-RATING   VALUE 'N'.
   847
   848     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   849         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   850                                         'NJ' 'NL'
   851                                         'PJ' 'PL'
   852                                         'SJ' 'SL'.
   853     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   854         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   855                                         'NI' 'NJ' 'NL' 'NU'
   856                                         'PJ' 'PL' 'PI' 'PU'
   857                                         'SI' 'SJ' 'SL' 'SU'
   858                                         'MX' 'MY' 'MZ'.
   859 01  ERPDEF-KEY-SAVE             PIC X(18).
   860 01  ERPDEF-KEY.
   861     12  ERPDEF-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  17
* EL050.cbl
   862     12  ERPDEF-STATE            PIC XX.
   863     12  ERPDEF-PROD-CD          PIC XXX.
   864     12  F                       PIC X(7).
   865     12  ERPDEF-BEN-TYPE         PIC X.
   866     12  ERPDEF-BEN-CODE         PIC XX.
   867     12  ERPDEF-EXP-DT           PIC XX.
   868
   869 01  ELSTAT-KEY-SAVE             PIC X(20).
   870 01  ELSTAT-KEY.
   871     12  ELSTAT-COMPANY-ID       PIC XXX.
   872     12  ELSTAT-CARRIER          PIC X.
   873     12  ELSTAT-GROUP            PIC X(6).
   874     12  ELSTAT-STATE            PIC XX.
   875     12  ELSTAT-EXP-DT           PIC 9(8).
   876 01  WS-ERROR-VALUES.
   877     12  ER-1570                     PIC S9(4)   VALUE +1570.
   878     12  ER-1571                     PIC S9(4)   VALUE +1571.
   879     12  ER-1575                     PIC S9(4)   VALUE +1575.
   880     12  ER-1891                     PIC S9(4)   VALUE +1891.
   881     12  ER-1892                     PIC S9(4)   VALUE +1892.
   882     12  ER-1893                     PIC S9(4)   VALUE +1893.
   883     12  ER-1894                     PIC S9(4)   VALUE +1894.
   884     12  ER-1895                     PIC S9(4)   VALUE +1895.
   885     12  ER-1896                     PIC S9(4)   VALUE +1896.
   886     12  ER-1897                     PIC S9(4)   VALUE +1897.
   887     12  ER-1898                     PIC S9(4)   VALUE +1898.
   888     12  ER-1899                     PIC S9(4)   VALUE +1899.
   889     12  ER-1900                     PIC S9(4)   VALUE +1900.
   890     12  ER-1901                     PIC S9(4)   VALUE +1901.
   891     12  ER-1902                     PIC S9(4)   VALUE +1902.
   892     12  ER-1903                     PIC S9(4)   VALUE +1903.
   893     12  ER-1904                     PIC S9(4)   VALUE +1904.
   894     12  ER-1905                     PIC S9(4)   VALUE +1905.
   895     12  ER-1906                     PIC S9(4)   VALUE +1906.
   896     12  ER-1907                     PIC S9(4)   VALUE +1907.
   897     12  ER-1909                     PIC S9(4)   VALUE +1909.
   898     12  ER-1910                     PIC S9(4)   VALUE +1910.
   899     12  ER-1911                     PIC S9(4)   VALUE +1911.
   900     12  ER-1912                     PIC S9(4)   VALUE +1912.
   901     12  ER-1913                     PIC S9(4)   VALUE +1913.
   902     12  ER-1914                     PIC S9(4)   VALUE +1914.
   903     12  ER-1915                     PIC S9(4)   VALUE +1915.
   904     12  ER-1916                     PIC S9(4)   VALUE +1916.
   905     12  ER-1917                     PIC S9(4)   VALUE +1917.
   906     12  ER-1918                     PIC S9(4)   VALUE +1918.
   907     12  ER-1919                     PIC S9(4)   VALUE +1919.
   908     12  ER-1920                     PIC S9(4)   VALUE +1920.
   909     12  ER-1921                     PIC S9(4)   VALUE +1921.
   910     12  ER-1922                     PIC S9(4)   VALUE +1922.
   911     12  ER-1923                     PIC S9(4)   VALUE +1923.
   912     12  ER-1924                     PIC S9(4)   VALUE +1924.
   913     12  ER-1925                     PIC S9(4)   VALUE +1925.
   914     12  ER-1926                     PIC S9(4)   VALUE +1926.
   915     12  ER-1927                     PIC S9(4)   VALUE +1927.
   916     12  ER-2393                     PIC S9(4)   VALUE +2393.
   917     12  ER-2600                     PIC S9(4)   VALUE +2600.
   918     12  ER-2601                     PIC S9(4)   VALUE +2601.
   919     12  ER-2602                     PIC S9(4)   VALUE +2602.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  18
* EL050.cbl
   920     12  ER-2603                     PIC S9(4)   VALUE +2603.
   921     12  ER-2604                     PIC S9(4)   VALUE +2604.
   922     12  ER-2605                     PIC S9(4)   VALUE +2605.
   923     12  ER-2606                     PIC S9(4)   VALUE +2606.
   924     12  ER-2607                     PIC S9(4)   VALUE +2607.
   925     12  ER-2608                     PIC S9(4)   VALUE +2608.
   926     12  ER-2609                     PIC S9(4)   VALUE +2609.
   927     12  ER-2610                     PIC S9(4)   VALUE +2610.
   928     12  ER-2611                     PIC S9(4)   VALUE +2611.
   929     12  ER-2612                     PIC S9(4)   VALUE +2612.
   930     12  ER-2613                     PIC S9(4)   VALUE +2613.
   931     12  ER-2614                     PIC S9(4)   VALUE +2614.
   932     12  ER-2615                     PIC S9(4)   VALUE +2615.
   933     12  ER-2616                     PIC S9(4)   VALUE +2616.
   934     12  ER-2617                     PIC S9(4)   VALUE +2617.
   935     12  ER-2618                     PIC S9(4)   VALUE +2618.
   936     12  ER-2619                     PIC S9(4)   VALUE +2619.
   937     12  ER-2620                     PIC S9(4)   VALUE +2620.
   938     12  ER-2621                     PIC S9(4)   VALUE +2621.
   939     12  ER-2622                     PIC S9(4)   VALUE +2622.
   940     12  ER-2623                     PIC S9(4)   VALUE +2623.
   941     12  ER-2624                     PIC S9(4)   VALUE +2624.
   942     12  ER-2625                     PIC S9(4)   VALUE +2625.
   943     12  ER-2626                     PIC S9(4)   VALUE +2626.
   944     12  ER-2627                     PIC S9(4)   VALUE +2627.
   945     12  ER-2628                     PIC S9(4)   VALUE +2628.
   946     12  ER-2629                     PIC S9(4)   VALUE +2629.
   947     12  ER-2630                     PIC S9(4)   VALUE +2630.
   948     12  ER-2631                     PIC S9(4)   VALUE +2631.
   949     12  ER-2632                     PIC S9(4)   VALUE +2632.
   950     12  ER-2633                     PIC S9(4)   VALUE +2633.
   951     12  ER-2634                     PIC S9(4)   VALUE +2634.
   952     12  ER-2635                     PIC S9(4)   VALUE +2635.
   953     12  ER-2636                     PIC S9(4)   VALUE +2636.
   954     12  ER-2637                     PIC S9(4)   VALUE +2637.
   955     12  ER-2638                     PIC S9(4)   VALUE +2638.
   956     12  ER-2639                     PIC S9(4)   VALUE +2639.
   957     12  ER-2640                     PIC S9(4)   VALUE +2640.
   958     12  ER-2641                     PIC S9(4)   VALUE +2641.
   959     12  ER-2642                     PIC S9(4)   VALUE +2642.
   960     12  ER-2643                     PIC S9(4)   VALUE +2643.
   961     12  ER-2644                     PIC S9(4)   VALUE +2644.
   962     12  ER-2645                     PIC S9(4)   VALUE +2645.
   963     12  ER-2646                     PIC S9(4)   VALUE +2646.
   964     12  ER-2647                     PIC S9(4)   VALUE +2647.
   965     12  ER-2648                     PIC S9(4)   VALUE +2648.
   966     12  ER-2649                     PIC S9(4)   VALUE +2649.
   967     12  ER-2650                     PIC S9(4)   VALUE +2650.
   968     12  ER-2651                     PIC S9(4)   VALUE +2651.
   969     12  ER-2652                     PIC S9(4)   VALUE +2652.
   970     12  ER-2653                     PIC S9(4)   VALUE +2653.
   971     12  ER-2654                     PIC S9(4)   VALUE +2654.
   972     12  ER-2655                     PIC S9(4)   VALUE +2655.
   973     12  ER-2656                     PIC S9(4)   VALUE +2656.
   974     12  ER-2657                     PIC S9(4)   VALUE +2657.
   975     12  ER-2658                     PIC S9(4)   VALUE +2658.
   976     12  ER-2659                     PIC S9(4)   VALUE +2659.
   977     12  ER-2660                     PIC S9(4)   VALUE +2660.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  19
* EL050.cbl
   978     12  ER-2661                     PIC S9(4)   VALUE +2661.
   979     12  ER-2662                     PIC S9(4)   VALUE +2662.
   980     12  ER-2663                     PIC S9(4)   VALUE +2663.
   981     12  ER-2664                     PIC S9(4)   VALUE +2664.
   982     12  ER-2665                     PIC S9(4)   VALUE +2665.
   983     12  ER-2666                     PIC S9(4)   VALUE +2666.
   984     12  ER-2667                     PIC S9(4)   VALUE +2667.
   985     12  ER-2668                     PIC S9(4)   VALUE +2668.
   986     12  ER-2669                     PIC S9(4)   VALUE +2669.
   987     12  ER-2670                     PIC S9(4)   VALUE +2670.
   988     12  ER-2671                     PIC S9(4)   VALUE +2671.
   989     12  ER-2672                     PIC S9(4)   VALUE +2672.
   990     12  ER-2673                     PIC S9(4)   VALUE +2673.
   991     12  ER-2674                     PIC S9(4)   VALUE +2674.
   992     12  ER-2675                     PIC S9(4)   VALUE +2675.
   993     12  ER-2676                     PIC S9(4)   VALUE +2676.
   994     12  ER-2677                     PIC S9(4)   VALUE +2677.
   995     12  ER-2678                     PIC S9(4)   VALUE +2678.
   996     12  ER-2679                     PIC S9(4)   VALUE +2679.
   997     12  ER-2680                     PIC S9(4)   VALUE +2680.
   998     12  ER-2681                     PIC S9(4)   VALUE +2681.
   999     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1000     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1001     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1002     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1003     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1004     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1005     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1006     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1007     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1008     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1009     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1010     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1011     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1012     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1013     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1014     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1015     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1016     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1017     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1018     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1019     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1020     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1021     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1022     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1023     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1024     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1025     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1026     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1027     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1028     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1029     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1030     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1031     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1032     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1033     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1034     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1035     12  ER-2728                     PIC S9(4)   VALUE +2728.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  20
* EL050.cbl
  1036     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1037     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1038     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1039     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1040     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1041     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1042     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1043     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1044     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1045     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1046     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1047     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1048     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1049     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1050     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1051     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1052     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1053     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1054     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1055     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1056     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1057     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1058     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1059     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1060     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1061     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1062     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1063     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1064     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1065     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1066     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1067     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1068     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1069     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1070     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1071     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1072     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1073     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1074     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1075     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1076     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1077     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1078     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1079     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1080     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1081     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1082     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1083     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1084     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1085     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1086     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1087     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1088     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1089     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1090     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1091     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1092     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1093     12  ER-2788                     PIC S9(4)   VALUE +2788.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  21
* EL050.cbl
  1094     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1095     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1096     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1097     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1098     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1099     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1100     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1101     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1102     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1103     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1104     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1105     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1106     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1107     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1108     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1109     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1110     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1111     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1112     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1113     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1114     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1115     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1116     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1117     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1118     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1119     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1120     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1121     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1122     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1123     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1124     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1125     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1126     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1127     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1128     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1129     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1130     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1131     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1132     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1133     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1134     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1135     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1136     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1137     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1138     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1139     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1140     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1141     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1142     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1143     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1144     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1145     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1146     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1147     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1148     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1149     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1150     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1151     12  ER-8039                     PIC S9(4)   VALUE +8039.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  22
* EL050.cbl
  1152     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1153     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1154     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1155     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1156     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1157     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1158     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1159     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1160     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1161     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1162     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1163     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1164     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1165     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1166     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1167     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1168     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1169     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1170     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1171     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1172     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1173     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1174     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1175     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1176     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1177     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1178     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1179     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1180     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1181     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1182     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1183     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1184     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1185     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1186     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1187     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1188     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1189     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1190     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1191     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1192     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1193     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1194     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1195     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1196     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1197     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1198     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1199     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1200     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1201     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1202     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1203     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1204     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1205     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1206     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1207     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1208     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1209     12  ER-8313                     PIC S9(4)   VALUE +8313.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  23
* EL050.cbl
  1210     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1211     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1212     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1213     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1214     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1215     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1216     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1217     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1218     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1219******************************************************************
  1220***************   END OF ELC50WS     ****************************
  1221******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  24
* EL050.cbl
  1224 01  WORKING-STORAGE-WORK-AREAS.
  1225     12  WS-RESPONSE             PIC S9(8)  COMP.
  1226         88  WS-RESP-NORMAL           VALUE +00.
  1227         88  WS-RESP-ERROR            VALUE +01.
  1228         88  WS-RESP-NOTFND           VALUE +13.
  1229         88  WS-RESP-DUPREC           VALUE +14.
  1230         88  WS-RESP-ENDFILE          VALUE +20.
  1231     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1232     12  WORK-AREAS.
  1233         16  WK-CONV-GREG.
  1234             24  WCG-CENT             PIC XX.
  1235             24  WCG-REST             PIC X(4).
  1236         16  WORK-GREGORIAN-DATE.
  1237             24  WK-GREG-CENT         PIC XX.
  1238             24  WK-GREG-DATE-YYMMDD.
  1239                 28  WK-GREG-YYMM     PIC X(4).
  1240                 28  WK-GREG-DD       PIC XX.
  1241
  1242         16  WORK-SELECT-DATE.
  1243             24  WK-SELECT-CENT            PIC XX.
  1244             24  WK-SELECT-DATE-YYMMDD.
  1245                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1246                 28  FILLER                PIC XX.
  1247
  1248         16  WK-FORM-NO.
  1249             24  WK-FORM-BANK-ID       PIC X(5).
  1250             24  WK-FORM-UNDRWRTR      PIC X(1).
  1251             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1252
  1253         16  WK-MEMBER-NO.
  1254             24  WK-MEMBER-1-6        PIC X(6).
  1255             24  WK-MEMBER-7-12       PIC X(6).
  1256
  1257         16  WK-FULL-CERT-NO.
  1258             24  WK-CERT-POS-1-2      PIC X(2).
  1259             24  WK-CERT-POS-3        PIC X(1).
  1260             24  WK-CERT-POS-4        PIC X(1).
  1261             24  WK-CERT-POS-5-6      PIC X(2).
  1262             24  WK-CERT-POS-7        PIC X(1).
  1263             24  WK-CERT-POS-8-11     PIC X(4).
  1264
  1265         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1266             88  VALID-RATE-CODE        VALUE 'Y'.
  1267             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1268
  1269         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1270         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1271         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1272         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1273         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1274         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1275         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1276         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1277         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1278         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1279
  1280* DLO001
  1281 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  25
* EL050.cbl
  1282     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1283     12  DMPF-RETURN-CODE          PIC XX.
  1284         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1285         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1286         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1287         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1288         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1289         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1290
  1291* DLO002
  1292 01  WS-DLO-INTERNAL-POLICY-FORM.
  1293     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1294     12  DIPF-RETURN-CODE          PIC XX.
  1295         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1296         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1297         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1298         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1299         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1300         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1301
  1302* DLO003
  1303 01  WS-DLO-VALID-BANK-ID.
  1304     12  DVBI-BANK-ID              PIC X(5).
  1305     12  DVBI-BANK-ID-TYPE         PIC X.
  1306         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1307         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1308         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1309         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1310         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1311     12  DVBI-RETURN-CODE          PIC XX.
  1312         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1313         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1314         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1315         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1316         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1317         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1318         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1319         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1320         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1321
  1322* DLO007
  1323 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1324     12  DCUA-RES-STATE            PIC XX.
  1325     12  DCUA-BEN-TYPE             PIC XX.
  1326     12  DCUA-SYS-IDENT            PIC X.
  1327         88  DCUA-CLAIM                        VALUE 'C'.
  1328         88  DCUA-PREMIUM                      VALUE 'P'.
  1329     12  DCUA-COVERAGE-RULE        PIC X.
  1330     12  DCUA-CLIENT-ID            PIC X(10).
  1331     12  DCUA-EFF-DATE             PIC X(8).
  1332     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1333     12  DCUA-RETURN-CODE          PIC XX.
  1334         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1335     12  DCUA-CERT-NUMBER          PIC X(11).
  1336     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1337     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1338
  1339* DLO011
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  26
* EL050.cbl
  1340 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1341     12  DPRB-RATE-CODE            PIC X(4).
  1342     12  DPRB-COVERAGE-CATEG       PIC X.
  1343     12  DPRB-RETURN-CODE          PIC XX.
  1344         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1345         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1346         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1347         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1348         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1349         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1350         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1351         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1352         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1353     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1354     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1355     12  DPRB-BEN-TYPE             PIC XX.
  1356
  1357* DLO017
  1358 01  WS-DLO-VALID-RATE-CODE.
  1359     12  DVRC-RATE-CODE            PIC X(4).
  1360     12  DVRC-RETURN-CODE          PIC XX.
  1361         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1362         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1363         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1364         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1365         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1366         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO019
  1369 01  WS-DLO-ORIG-COV-CAT.
  1370     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1371     12  DOCC-RETURN-CODE          PIC XX.
  1372     12  DOCC-ORIG-COV-CAT         PIC X.
  1373     12  DOCC-UNDERWITER           PIC XX.
  1374     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1375     12  DOCC-FILLER               PIC X(6).
  1376
  1377* DLO021
  1378 01  WS-DLO-VALID-LOAN-OFFICER.
  1379     12  DVLO-LOAN-OFFICER.
  1380         16  DVLO-BILL-TYPE        PIC X.
  1381         16  DVLO-BILL-SOURCE      PIC X.
  1382         16  DVLO-BATCH-TYPE       PIC X.
  1383     12  DVLO-RETURN-CODE          PIC XX.
  1384         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1385         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1386         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1387         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1388         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1389         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1390
  1391* DLO022
  1392 01  WS-DLO-VALID-STATE-CODE.
  1393     12  DVSC-STATE-CODE           PIC XX.
  1394     12  DVSC-RETURN-CODE          PIC XX.
  1395         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1396
  1397* DLO023
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  27
* EL050.cbl
  1398 01  WS-DLO-VALID-CODE-VALUES.
  1399     12  DVCV-SYSTEM-ID            PIC XX.
  1400         88  DVCV-CLAIMS                       VALUE 'CL'.
  1401         88  DVCV-CREDIT                       VALUE 'CR'.
  1402     12  DVCV-RECORD-TYPE          PIC XX.
  1403         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1404         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1405         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1406         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1407         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1408         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1409         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1410         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1411     12  DVCV-RECORD-KEY           PIC X(6).
  1412     12  DVCV-RETURN-CODE          PIC XX.
  1413         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1415         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1416         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1417         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1418         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1419         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1420     12  DVCV-CODE-DESC            PIC X(60).
  1421     12  DVCV-GEN-DESC-1           PIC X(20).
  1422     12  DVCV-GEN-DESC-2           PIC X(20).
  1423     12  DVCV-GEN-DESC-3           PIC X(20).
  1424
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  28
* EL050.cbl
  1426*    COPY ERCBXRF.
  1427******************************************************************
  1428*                                                                *
  1429*                                                                *
  1430*                            ERCBXRF                             *
  1431*                                                                *
  1432*   ONLINE CREDIT SYSTEM                                         *
  1433*                                                                *
  1434*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1435*                                                                *
  1436*   FILE TYPE = VSAM,KSDS                                        *
  1437*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1438*                                                                *
  1439*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1440*       ALTERNATE PATH = NONE                                    *
  1441*                                                                *
  1442*   LOG = NO                                                     *
  1443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1444*                                                                *
  1445******************************************************************
  1446
  1447 01  BANK-CROSS-REFERENCE.
  1448     12  BK-RECORD-ID                PIC XX.
  1449         88  VALID-BK-ID             VALUE 'BK'.
  1450
  1451     12  BK-CONTROL-PRIMARY.
  1452         16  BK-COMPANY-CD           PIC X.
  1453         16  BK-CARRIER              PIC X.
  1454         16  BK-GROUPING             PIC X(6).
  1455         16  BK-BANK-NO              PIC X(10).
  1456
  1457     12  BK-MAINT-INFORMATION.
  1458         16  BK-LAST-MAINT-DT        PIC XX.
  1459         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1460         16  BK-LAST-MAINT-USER      PIC X(4).
  1461         16  FILLER                  PIC X(9).
  1462
  1463     12  FILLER                      PIC X(37).
  1464
  1465     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1466
  1467     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1468                            DEPENDING ON BK-BANK-POINTER-CNT.
  1469         16  BK-AM-ACCOUNT           PIC X(10).
  1470         16  BK-AM-EXP-DT            PIC XX.
  1471         16  BK-AM-EFF-DT            PIC XX.
  1472         16  BK-AM-STATE             PIC XX.
  1473         16  FILLER                  PIC X(20).
  1474
  1475******************************************************************
  1476
  1477*    COPY ERCCOMP.
  1478******************************************************************
  1479*                                                                *
  1480*                                                                *
  1481*                            ERCCOMP                             *
  1482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1483*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  29
* EL050.cbl
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499*                   C H A N G E   L O G
  1500*
  1501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1502*-----------------------------------------------------------------
  1503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1504* EFFECTIVE    NUMBER
  1505*-----------------------------------------------------------------
  1506* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1507* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1508* 092205    2005050300006  PEMA  ADD LEASE FEE
  1509* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1510* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1511* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1512* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1513* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1514* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1515******************************************************************
  1516
  1517 01  COMPENSATION-MASTER.
  1518     12  CO-RECORD-ID                          PIC XX.
  1519         88  VALID-CO-ID                          VALUE 'CO'.
  1520
  1521     12  CO-CONTROL-PRIMARY.
  1522         16  CO-COMPANY-CD                     PIC X.
  1523         16  CO-CONTROL.
  1524             20  CO-CTL-1.
  1525                 24  CO-CARR-GROUP.
  1526                     28  CO-CARRIER            PIC X.
  1527                     28  CO-GROUPING.
  1528                         32  CO-GROUP-PREFIX   PIC XXX.
  1529                         32  CO-GROUP-PRIME    PIC XXX.
  1530                 24  CO-RESP-NO.
  1531                     28  CO-RESP-PREFIX        PIC X(4).
  1532                     28  CO-RESP-PRIME         PIC X(6).
  1533             20  CO-CTL-2.
  1534                 24  CO-ACCOUNT.
  1535                     28  CO-ACCT-PREFIX        PIC X(4).
  1536                     28  CO-ACCT-PRIME         PIC X(6).
  1537         16  CO-TYPE                           PIC X.
  1538             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1539             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1540             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1541
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  30
* EL050.cbl
  1542     12  CO-MAINT-INFORMATION.
  1543         16  CO-LAST-MAINT-DT                  PIC XX.
  1544         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1545         16  CO-LAST-MAINT-USER                PIC X(4).
  1546     12  FILLER                                PIC XX.
  1547     12  CO-STMT-TYPE                          PIC XXX.
  1548     12  CO-COMP-TYPE                          PIC X.
  1549         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1550     12  CO-STMT-OWNER                         PIC X(4).
  1551     12  CO-BALANCE-CONTROL                    PIC X.
  1552         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1553         88  CO-NO-BALANCE                        VALUE 'N'.
  1554
  1555     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1556         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1557         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1558         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1559
  1560     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1561         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1562         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1563
  1564     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1565     12  CO-GA-DIRECT-DEP                      PIC X.
  1566     12  CO-FUTURE-SPACE                       PIC X.
  1567         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1568
  1569     12  CO-ACCT-NAME                          PIC X(30).
  1570     12  CO-MAIL-NAME                          PIC X(30).
  1571     12  CO-ADDR-1                             PIC X(30).
  1572     12  CO-ADDR-2                             PIC X(30).
  1573     12  CO-ADDR-3.
  1574         16  CO-ADDR-CITY                      PIC X(27).
  1575         16  CO-ADDR-STATE                     PIC XX.
  1576     12  CO-CSO-1099                           PIC X.
  1577     12  CO-ZIP.
  1578         16  CO-ZIP-PRIME.
  1579             20  CO-ZIP-PRI-1ST                PIC X.
  1580                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1581             20  FILLER                        PIC X(4).
  1582         16  CO-ZIP-PLUS4                      PIC X(4).
  1583     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1584         16  CO-CAN-POSTAL-1                   PIC XXX.
  1585         16  CO-CAN-POSTAL-2                   PIC XXX.
  1586         16  FILLER                            PIC XXX.
  1587     12  CO-SOC-SEC                            PIC X(13).
  1588     12  CO-TELEPHONE.
  1589         16  CO-AREA-CODE                      PIC XXX.
  1590         16  CO-PREFIX                         PIC XXX.
  1591         16  CO-PHONE                          PIC X(4).
  1592
  1593     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1594
  1595     12  CO-AR-BAL-LEVEL                       PIC X.
  1596         88  CO-AR-REF-LVL                        VALUE '1'.
  1597         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1598         88  CO-AR-BILL-LVL                       VALUE '2'.
  1599         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  31
* EL050.cbl
  1600         88  CO-AR-FR-LVL                         VALUE '4'.
  1601
  1602     12  CO-AR-NORMAL-PRINT                    PIC X.
  1603         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1604         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1605
  1606     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1607
  1608     12  CO-AR-REPORTING                       PIC X.
  1609         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1610         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1611
  1612     12  CO-AR-PULL-CHECK                      PIC X.
  1613         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1614         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1615
  1616     12  CO-AR-BALANCE-PRINT                   PIC X.
  1617         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1618
  1619     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1620         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1621         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1622         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1623
  1624     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1625
  1626     12  CO-USER-CODE                          PIC X.
  1627     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1628
  1629******************************************************************
  1630*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1631*    THE LAST MONTH END RUN.
  1632******************************************************************
  1633
  1634     12  CO-LAST-ACTIVITY-DATE.
  1635         16  CO-ACT-YEAR                       PIC 99.
  1636         16  CO-ACT-MONTH                      PIC 99.
  1637         16  CO-ACT-DAY                        PIC 99.
  1638
  1639     12  CO-LAST-STMT-DT.
  1640         16  CO-LAST-STMT-YEAR                 PIC 99.
  1641         16  CO-LAST-STMT-MONTH                PIC 99.
  1642         16  CO-LAST-STMT-DAY                  PIC 99.
  1643
  1644     12  CO-MO-END-TOTALS.
  1645         16  CO-MONTHLY-TOTALS.
  1646             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1647             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1648             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1649             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1650             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1651
  1652         16  CO-AGING-TOTALS.
  1653             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1654             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1655             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1656             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1657
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  32
* EL050.cbl
  1658         16  CO-YTD-TOTALS.
  1659             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1660             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-OVER-UNDER-TOTALS.
  1663             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1664             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1665
  1666     12  CO-MISCELLANEOUS-TOTALS.
  1667         16  CO-FICA-TOTALS.
  1668             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1669             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1670
  1671         16  CO-CLAIM-TOTALS.
  1672             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1673             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1674
  1675******************************************************************
  1676*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1677*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1678******************************************************************
  1679
  1680     12  CO-CURRENT-TOTALS.
  1681         16  CO-CURRENT-LAST-STMT-DT.
  1682             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1683             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1684             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1685
  1686         16  CO-CURRENT-MONTHLY-TOTALS.
  1687             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1690             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1691             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1692
  1693         16  CO-CURRENT-AGING-TOTALS.
  1694             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-CURRENT-YTD-TOTALS.
  1700             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1702
  1703     12  CO-PAID-COMM-TOTALS.
  1704         16  CO-YTD-PAID-COMMS.
  1705             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1706             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1707
  1708     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1709         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1710         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1711
  1712     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1713         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1714         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1715         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  33
* EL050.cbl
  1716         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1717         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1718         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1719         88  CO-FINAL-LETTER                  VALUE 'F'.
  1720         88  CO-RECONCILING                   VALUE 'R'.
  1721         88  CO-PHONE-CALL                    VALUE 'P'.
  1722         88  CO-LEGAL                         VALUE 'L'.
  1723         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1724         88  CO-WRITE-OFF                     VALUE 'W'.
  1725         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1726
  1727     12  CO-CSR-CODE                       PIC X(4).
  1728
  1729     12  CO-GA-STATUS-INFO.
  1730         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1731         16  CO-GA-TERMINATION-DT          PIC XX.
  1732         16  CO-GA-STATUS-CODE             PIC X.
  1733             88  CO-GA-ACTIVE                 VALUE 'A'.
  1734             88  CO-GA-INACTIVE               VALUE 'I'.
  1735             88  CO-GA-PENDING                VALUE 'P'.
  1736         16  CO-GA-COMMENTS.
  1737             20  CO-GA-COMMENT-1           PIC X(40).
  1738             20  CO-GA-COMMENT-2           PIC X(40).
  1739             20  CO-GA-COMMENT-3           PIC X(40).
  1740             20  CO-GA-COMMENT-4           PIC X(40).
  1741
  1742     12  CO-RPTCD2                         PIC X(10).
  1743     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1744         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1745         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1746
  1747     12  CO-TYPE-AGENT                     PIC X(01).
  1748         88  CO-CORPORATION                   VALUE 'C'.
  1749         88  CO-PARTNERSHIP                   VALUE 'P'.
  1750         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1751         88  CO-TRUST                         VALUE 'T'.
  1752         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1753
  1754     12  CO-FAXNO.
  1755         16  CO-FAX-AREA-CODE                  PIC XXX.
  1756         16  CO-FAX-PREFIX                     PIC XXX.
  1757         16  CO-FAX-PHONE                      PIC X(4).
  1758
  1759     12  CO-BANK-INFORMATION.
  1760         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1761         16  CO-BANK-TRANSIT-NON REDEFINES
  1762             CO-BANK-TRANSIT-NO                PIC 9(8).
  1763
  1764         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1765     12  CO-MISC-DEDUCT-INFO REDEFINES
  1766                  CO-BANK-INFORMATION.
  1767         16  CO-MD-GL-ACCT                     PIC X(10).
  1768         16  CO-MD-DIV                         PIC XX.
  1769         16  CO-MD-CENTER                      PIC X(4).
  1770         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1771         16  CO-CREATE-AP-CHECK                PIC X.
  1772         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1773         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  34
* EL050.cbl
  1774     12  CO-ACH-STATUS                         PIC X.
  1775         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1776         88  CO-ACH-PENDING                        VALUE 'P'.
  1777
  1778     12  CO-BILL-SW                            PIC X.
  1779     12  CO-CONTROL-NAME                       PIC X(30).
  1780     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1781     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1782     12  CO-CLP-STATE                          PIC XX.
  1783     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1784     12  CO-SPP-REFUND-EDIT                    PIC X.
  1785
  1786******************************************************************
  1787
  1788*    COPY ERCAGTC.
  1789******************************************************************
  1790*                                                                *
  1791*                                                                *
  1792*                            ERCAGTC                             *
  1793*                            VMOD=2.001                          *
  1794*                                                                *
  1795*   ONLINE CREDIT SYSTEM                                         *
  1796*                                                                *
  1797*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1798*                                                                *
  1799*   FILE TYPE = VSAM,KSDS                                        *
  1800*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1801*                                                                *
  1802*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1803*       ALTERNATE PATH = NONE                                    *
  1804*                                                                *
  1805*   LOG = NO                                                     *
  1806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1807*                                                                *
  1808******************************************************************
  1809*                   C H A N G E   L O G
  1810*
  1811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1812*-----------------------------------------------------------------
  1813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1814* EFFECTIVE    NUMBER
  1815*-----------------------------------------------------------------
  1816* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1817* 111004                         NEW FILE AND COPYBOOK
  1818* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1819******************************************************************
  1820 01  AGENT-COMMISSIONS.
  1821     12  AG-RECORD-ID                          PIC XX.
  1822         88  VALID-CO-ID                          VALUE 'AG'.
  1823     12  AG-CONTROL-PRIMARY.
  1824         16  AG-COMPANY-CD                     PIC X.
  1825         16  AG-CONTROL.
  1826             20  AG-CTL-1.
  1827                 24  AG-CARR-GROUP.
  1828                     28  AG-CARRIER            PIC X.
  1829                     28  AG-GROUPING           PIC X(6).
  1830                 24  AG-BANK                   PIC X(10).
  1831             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  35
* EL050.cbl
  1832                 24  AG-EXP-DT                 PIC XX.
  1833         16  AG-TYPE                           PIC X.
  1834             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1835             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1836     12  AG-MAINT-INFORMATION.
  1837         16  AG-LAST-MAINT-DT                  PIC XX.
  1838         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1839         16  AG-LAST-MAINT-USER                PIC X(4).
  1840         16  FILLER                            PIC X(10).
  1841     12  AG-EFF-DT                             PIC XX.
  1842     12  AG-COMM-STRUCTURE.
  1843         16  AG-AGT-COMMS OCCURS 10.
  1844             20  AG-AGT                PIC X(10).
  1845             20  AG-COM-TYP            PIC X.
  1846             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1847             20  AG-RECALC-LV-INDIC    PIC X.
  1848             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1849             20  AG-LRCALC-LV-INDIC    PIC X.
  1850             20  FILLER                PIC X(05).
  1851     12  FILLER                  PIC X(145).
  1852******************************************************************
  1853*    COPY ERCRESS.
  1854******************************************************************
  1855*                                                                *
  1856*                            ERCRESS                             *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.002                          *
  1859*                                                                *
  1860*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1861*                                                                *
  1862*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1863*   VSAM RESIDENT STATE TAX MASTER                              *
  1864*                                                                *
  1865*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1866*                                                                *
  1867*   FILE TYPE = VSAM,KSDS                                        *
  1868*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1869*                                                                *
  1870*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1871*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1872*                                                                *
  1873*   LOG = NO                                                     *
  1874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1875*                                                                *
  1876*                                                                *
  1877******************************************************************
  1878
  1879 01  RESIDENT-STATE-TAX-MASTER.
  1880
  1881     10  ERRESS-PRIMARY-KEY.
  1882         15  RES-COMPANY-CD        PIC X.
  1883         15  RES-RESIDENT-STATE    PIC XX.
  1884         15  RES-COVERAGE-CATEGORY PIC X.
  1885         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1886*                                      YYYYMMDD
  1887*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1888
  1889     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  36
* EL050.cbl
  1890
  1891         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1892         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1893         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1894         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1895
  1896     10 RES-RECALC-SW              PIC   X.
  1897         88 RECALC                VALUE 'Y'.
  1898         88 NO-RECALC             VALUE 'N'.
  1899     10  RES-MAINT-BY              PIC X(4).
  1900     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1901     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1902*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  37
* EL050.cbl
  1904*    COPY ERCRESC.
  1905******************************************************************
  1906*                                                                *
  1907*                            ERCRESC                             *
  1908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1909*                            VMOD=2.003                          *
  1910*                                                                *
  1911*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1912*                                                                *
  1913*   FILE TYPE = VSAM,KSDS                                        *
  1914*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1915*                                                                *
  1916*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1917*       ALTERNATE PATH1 = NONE                                   *
  1918*                                                                *
  1919*   LOG = NO                                                     *
  1920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1921*                                                                *
  1922******************************************************************
  1923
  1924 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1925
  1926     10  ERRESC-RECORD-KEY.
  1927         15  RESC-COMPANY-CD           PIC   X.
  1928         15  RESC-CARRIER              PIC   X.
  1929         15  RESC-GROUP                PIC   X(6).
  1930         15  RESC-STATE                PIC   XX.
  1931         15  RESC-ACCOUNT              PIC   X(10).
  1932         15  RESC-AGENT                PIC   X(10).
  1933         15  RESC-RESIDENT-STATE       PIC   XX.
  1934         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1935*                                           YYYYMMDD
  1936     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1937
  1938     10  RESC-COMM-RECORD-DATA.
  1939         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1940             20 RESC-COVERAGE-CAT      PIC    X.
  1941             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1942             20 RESC-COMMISSION-TAB REDEFINES
  1943                RESC-COMMISSION-PER    PIC  XXX.
  1944
  1945     10  RESC-MAINT-BY                 PIC X(4).
  1946     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1947     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1948*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  38
* EL050.cbl
  1950*    COPY ERCPLAN.
  1951******************************************************************
  1952*                                                                *
  1953*                                                                *
  1954*                            ERCPLAN                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1959*                                                                *
  1960*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1961*   PLAN MASTER                                                  *
  1962*                                                                *
  1963*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 420   RECFORM = FIX                            *
  1967*                                                                *
  1968*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1969*       ALTERNATE PATH1 = N/A                                    *
  1970*                                                                *
  1971*   LOG = NO                                                     *
  1972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1973*                                                                *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  PLAN-MASTER.
  1978     12  PL-RECORD-ID                      PIC XX.
  1979         88  VALID-PL-ID                      VALUE 'PL'.
  1980
  1981     12  PL-CONTROL-PRIMARY.
  1982         16  PL-COMPANY-CD                 PIC X.
  1983         16  PL-MSTR-CNTRL.
  1984             20  PL-CONTROL-A.
  1985                 24  PL-CARRIER            PIC X.
  1986                 24  PL-GROUPING           PIC X(6).
  1987                 24  PL-STATE              PIC XX.
  1988                 24  PL-ACCOUNT            PIC X(10).
  1989             20  PL-BENEFIT-TYPE           PIC X.
  1990             20  PL-BENEFIT-CODE           PIC XX.
  1991             20  PL-REVISION-NO            PIC X(3).
  1992
  1993     12  PL-CONTROL-BY-VAR-GRP.
  1994         16  PL-COMPANY-CD-A1              PIC X.
  1995         16  PL-VG-CARRIER                 PIC X.
  1996         16  PL-VG-GROUPING                PIC X(6).
  1997         16  PL-VG-STATE                   PIC XX.
  1998         16  PL-VG-ACCOUNT                 PIC X(10).
  1999         16  PL-BENEFIT-TYPE-A1            PIC X.
  2000         16  PL-BENEFIT-CODE-A1            PIC XX.
  2001         16  PL-REVISION-NO-A1             PIC 999.
  2002
  2003     12  PL-MAINT-INFORMATION.
  2004         16  PL-LAST-MAINT-DT              PIC XX.
  2005         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2006         16  PL-LAST-MAINT-USER            PIC X(4).
  2007         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  39
* EL050.cbl
  2008
  2009     12  PL-LIABILITY-LIMITS.
  2010         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2011         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2012             20  PL-LM-AGE                 PIC S99        COMP-3.
  2013             20  PL-LM-DUR                 PIC S999       COMP-3.
  2014             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2015             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2016
  2017     12  FILLER                            PIC X(30).
  2018
  2019     12  PL-GL-ACCOUNT-NOS.
  2020         16  PL-PREMIUM-GL                 PIC X(8).
  2021         16  PL-COMM-GL                    PIC X(8).
  2022         16  PL-CLAIM-GL                   PIC X(8).
  2023     12  FILLER                            PIC X(24).
  2024     12  PL-TOLERANCES.
  2025         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2026         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2027         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2028         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2029         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2030         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2031     12  PL-OVER-SHORT.
  2032         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2033         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2034     12  FILLER                            PIC X(24).
  2035     12  PLAN-MISC.
  2036         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2037         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2038         16  PL-IG                         PIC X.
  2039         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2040         16  PL-POLICY-FORM                PIC X(12).
  2041         16  PL-EDIT-FOR-FORM              PIC X(01).
  2042         16  PL-DEV-CODE                   PIC XXX.
  2043         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2044         16  PL-CALC-METHOD                PIC X.
  2045         16  PL-BENEFIT-GROUP              PIC X(05).
  2046         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2047
  2048         16  FILLER                        PIC X(99).
  2049******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  40
* EL050.cbl
  2051*    COPY ELCCERT.
  2052******************************************************************
  2053*                                                                *
  2054*                            ELCCERT.                            *
  2055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2056*                            VMOD=2.013                          *
  2057*                                                                *
  2058*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2059*                                                                *
  2060*   FILE TYPE = VSAM,KSDS                                        *
  2061*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2062*                                                                *
  2063*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2064*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2065*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2066*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2067*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2068*                                                                *
  2069*   LOG = YES                                                    *
  2070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2071******************************************************************
  2072*                   C H A N G E   L O G
  2073*
  2074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2075*-----------------------------------------------------------------
  2076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2077* EFFECTIVE    NUMBER
  2078*-----------------------------------------------------------------
  2079* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2080* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2081* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2082* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2083* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2084* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2085* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2086* 032612  CR2011110200001  PEMA  AHL CHANGES
  2087******************************************************************
  2088
  2089 01  CERTIFICATE-MASTER.
  2090     12  CM-RECORD-ID                      PIC XX.
  2091         88  VALID-CM-ID                      VALUE 'CM'.
  2092
  2093     12  CM-CONTROL-PRIMARY.
  2094         16  CM-COMPANY-CD                 PIC X.
  2095         16  CM-CARRIER                    PIC X.
  2096         16  CM-GROUPING.
  2097             20  CM-GROUPING-PREFIX        PIC X(3).
  2098             20  CM-GROUPING-PRIME         PIC X(3).
  2099         16  CM-STATE                      PIC XX.
  2100         16  CM-ACCOUNT.
  2101             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2102             20  CM-ACCOUNT-PRIME          PIC X(6).
  2103         16  CM-CERT-EFF-DT                PIC XX.
  2104         16  CM-CERT-NO.
  2105             20  CM-CERT-PRIME             PIC X(10).
  2106             20  CM-CERT-SFX               PIC X.
  2107
  2108     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  41
* EL050.cbl
  2109         16  CM-COMPANY-CD-A1              PIC X.
  2110         16  CM-INSURED-LAST-NAME          PIC X(15).
  2111         16  CM-INSURED-INITIALS.
  2112             20  CM-INSURED-INITIAL1       PIC X.
  2113             20  CM-INSURED-INITIAL2       PIC X.
  2114
  2115     12  CM-CONTROL-BY-SSN.
  2116         16  CM-COMPANY-CD-A2              PIC X.
  2117         16  CM-SOC-SEC-NO.
  2118             20  CM-SSN-STATE              PIC XX.
  2119             20  CM-SSN-ACCOUNT            PIC X(6).
  2120             20  CM-SSN-LN3.
  2121                 25  CM-INSURED-INITIALS-A2.
  2122                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2123                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2124                 25 CM-PART-LAST-NAME-A2         PIC X.
  2125
  2126     12  CM-CONTROL-BY-CERT-NO.
  2127         16  CM-COMPANY-CD-A4              PIC X.
  2128         16  CM-CERT-NO-A4                 PIC X(11).
  2129
  2130     12  CM-CONTROL-BY-MEMB.
  2131         16  CM-COMPANY-CD-A5              PIC X.
  2132         16  CM-MEMBER-NO.
  2133             20  CM-MEMB-STATE             PIC XX.
  2134             20  CM-MEMB-ACCOUNT           PIC X(6).
  2135             20  CM-MEMB-LN4.
  2136                 25  CM-INSURED-INITIALS-A5.
  2137                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2138                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2139                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2140
  2141     12  CM-INSURED-PROFILE-DATA.
  2142         16  CM-INSURED-FIRST-NAME.
  2143             20  CM-INSURED-1ST-INIT       PIC X.
  2144             20  FILLER                    PIC X(9).
  2145         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2146         16  CM-INSURED-SEX                PIC X.
  2147             88  CM-SEX-MALE                  VALUE 'M'.
  2148             88  CM-SEX-FEMAL                 VALUE 'F'.
  2149         16  CM-INSURED-JOINT-AGE          PIC 99.
  2150         16  CM-JOINT-INSURED-NAME.
  2151             20  CM-JT-LAST-NAME           PIC X(15).
  2152             20  CM-JT-FIRST-NAME.
  2153                 24  CM-JT-1ST-INIT        PIC X.
  2154                 24  FILLER                PIC X(9).
  2155             20  CM-JT-INITIAL             PIC X.
  2156
  2157     12  CM-LIFE-DATA.
  2158         16  CM-LF-BENEFIT-CD              PIC XX.
  2159         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2160         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2161         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2162         16  CM-LF-DEV-CODE                PIC XXX.
  2163         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2164         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2165         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  42
* EL050.cbl
  2167         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2168         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2170         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2171         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2172         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2173         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2174         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2175         16  FILLER                        PIC XX.
  2176
  2177     12  CM-AH-DATA.
  2178         16  CM-AH-BENEFIT-CD              PIC XX.
  2179         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2180         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2181         16  CM-AH-DEV-CODE                PIC XXX.
  2182         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2183         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2187         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2188         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2189         16  CM-AH-PAID-THRU-DT            PIC XX.
  2190             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2191         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2192         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2193         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2194         16  FILLER                        PIC X.
  2195
  2196     12  CM-LOAN-INFORMATION.
  2197         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2198         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2199                                           PIC S9(5)V99  COMP-3.
  2200         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2201         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2202         16  CM-PAY-FREQUENCY              PIC S99.
  2203         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2204         16  CM-RATE-CLASS                 PIC XX.
  2205         16  CM-BENEFICIARY                PIC X(25).
  2206         16  CM-POLICY-FORM-NO             PIC X(12).
  2207         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2208         16  CM-LAST-ADD-ON-DT             PIC XX.
  2209         16  CM-DEDUCTIBLE-AMOUNTS.
  2210             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2211             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2212         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2213             20  CM-RESIDENT-STATE         PIC XX.
  2214             20  CM-RATE-CODE              PIC X(4).
  2215             20  FILLER                    PIC XX.
  2216         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2217             20  CM-LOAN-OFFICER           PIC X(5).
  2218             20  FILLER                    PIC XXX.
  2219         16  CM-CSR-CODE                   PIC XXX.
  2220         16  CM-UNDERWRITING-CODE          PIC X.
  2221             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2222         16  CM-POST-CARD-IND              PIC X.
  2223         16  CM-NH-INTERFACE-SW            PIC X.
  2224         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  43
* EL050.cbl
  2225             88  CM-SING-PRM                  VALUE '1'.
  2226             88  CM-O-B-COVERAGE              VALUE '2'.
  2227             88  CM-OPEN-END                  VALUE '3'.
  2228         16  CM-IND-GRP-TYPE               PIC X.
  2229             88  CM-INDIVIDUAL                VALUE 'I'.
  2230             88  CM-GROUP                     VALUE 'G'.
  2231         16  CM-SKIP-CODE                  PIC X.
  2232             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2233             88  SKIP-JULY                    VALUE '1'.
  2234             88  SKIP-AUGUST                  VALUE '2'.
  2235             88  SKIP-SEPTEMBER               VALUE '3'.
  2236             88  SKIP-JULY-AUG                VALUE '4'.
  2237             88  SKIP-AUG-SEPT                VALUE '5'.
  2238             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2239             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2240             88  SKIP-JUNE                    VALUE '8'.
  2241             88  SKIP-JUNE-JULY               VALUE '9'.
  2242             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2243             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2244         16  CM-PAYMENT-MODE               PIC X.
  2245             88  PAY-MONTHLY                  VALUE SPACE.
  2246             88  PAY-WEEKLY                   VALUE '1'.
  2247             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2248             88  PAY-BI-WEEKLY                VALUE '3'.
  2249             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2250         16  CM-LOAN-NUMBER                PIC X(8).
  2251         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2252         16  CM-OLD-LOF                    PIC XXX.
  2253*        16  CM-LOAN-OFFICER               PIC XXX.
  2254         16  CM-REIN-TABLE                 PIC XXX.
  2255         16  CM-SPECIAL-REIN-CODE          PIC X.
  2256         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2257         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2258         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2259
  2260     12  CM-STATUS-DATA.
  2261         16  CM-ENTRY-STATUS               PIC X.
  2262         16  CM-ENTRY-DT                   PIC XX.
  2263
  2264         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2265         16  CM-LF-CANCEL-DT               PIC XX.
  2266         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2267
  2268         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2269         16  CM-LF-DEATH-DT                PIC XX.
  2270         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2271
  2272         16  CM-LF-CURRENT-STATUS          PIC X.
  2273             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2274                                                'M' '4' '5' '9'.
  2275             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2276             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2277             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2278             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2279             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2280             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2281             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2282             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  44
* EL050.cbl
  2283             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2284             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2285             88  CM-LF-DECLINED               VALUE 'D'.
  2286             88  CM-LF-VOIDED                 VALUE 'V'.
  2287
  2288         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2289         16  CM-AH-CANCEL-DT               PIC XX.
  2290         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2291
  2292         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2293         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2294         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2295
  2296         16  CM-AH-CURRENT-STATUS          PIC X.
  2297             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2298                                                'M' '4' '5' '9'.
  2299             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2300             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2301             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2302             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2303             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2304             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2305             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2306             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2307             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2308             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2309             88  CM-AH-DECLINED               VALUE 'D'.
  2310             88  CM-AH-VOIDED                 VALUE 'V'.
  2311
  2312         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2313             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2314             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2315             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2316         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2317
  2318         16  CM-ENTRY-BATCH                PIC X(6).
  2319         16  CM-LF-EXIT-BATCH              PIC X(6).
  2320         16  CM-AH-EXIT-BATCH              PIC X(6).
  2321         16  CM-LAST-MONTH-END             PIC XX.
  2322
  2323     12  CM-NOTE-SW                        PIC X.
  2324         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2325         88  CERT-NOTES-PRESENT               VALUE '1'.
  2326         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2327         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2328         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2329         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2330         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2331         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2332     12  CM-COMP-EXCP-SW                   PIC X.
  2333         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2334         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2335     12  CM-INSURED-ADDRESS-SW             PIC X.
  2336         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2337         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2338
  2339*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2340     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  45
* EL050.cbl
  2341     12  FILLER                            PIC X.
  2342
  2343*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2344     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2345     12  FILLER                            PIC X.
  2346*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2347     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2348
  2349     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2350         88  CERT-ADDED-BATCH                 VALUE ' '.
  2351         88  CERT-ADDED-ONLINE                VALUE '1'.
  2352         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2353         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2354         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2355     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2356         88  CERT-AS-LOADED                   VALUE ' '.
  2357         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2358         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2359         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2360         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2361         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2362         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2363         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2364
  2365     12  CM-ACCOUNT-COMM-PCTS.
  2366         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2367         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2368
  2369     12  CM-USER-FIELD                     PIC X.
  2370     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2371     12  CM-CLP-STATE                      PIC XX.
  2372     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2373     12  CM-USER-RESERVED                  PIC XXX.
  2374     12  FILLER REDEFINES CM-USER-RESERVED.
  2375         16  CM-AH-CLASS-CD                PIC XX.
  2376         16  F                             PIC X.
  2377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  46
* EL050.cbl
  2379*    COPY ERCMAIL.
  2380******************************************************************
  2381*                                                                *
  2382*                                                                *
  2383*                            ERCMAIL                             *
  2384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2385*                            VMOD=2.003                          *
  2386*                                                                *
  2387*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2388*                                                                *
  2389*   FILE TYPE = VSAM,KSDS                                        *
  2390*   RECORD SIZE = 374   RECFORM = FIX                            *
  2391*                                                                *
  2392*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2393*   ALTERNATE PATH    = NOT USED                                 *
  2394*                                                                *
  2395*   LOG = YES                                                    *
  2396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2397******************************************************************
  2398*                   C H A N G E   L O G
  2399*
  2400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2401*-----------------------------------------------------------------
  2402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2403* EFFECTIVE    NUMBER
  2404*-----------------------------------------------------------------
  2405* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2406* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2407* 111108                   PEMA  ADD CRED BENE ADDR2
  2408******************************************************************
  2409
  2410 01  MAILING-DATA.
  2411     12  MA-RECORD-ID                      PIC XX.
  2412         88  VALID-MA-ID                       VALUE 'MA'.
  2413
  2414     12  MA-CONTROL-PRIMARY.
  2415         16  MA-COMPANY-CD                 PIC X.
  2416         16  MA-CARRIER                    PIC X.
  2417         16  MA-GROUPING.
  2418             20  MA-GROUPING-PREFIX        PIC XXX.
  2419             20  MA-GROUPING-PRIME         PIC XXX.
  2420         16  MA-STATE                      PIC XX.
  2421         16  MA-ACCOUNT.
  2422             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2423             20  MA-ACCOUNT-PRIME          PIC X(6).
  2424         16  MA-CERT-EFF-DT                PIC XX.
  2425         16  MA-CERT-NO.
  2426             20  MA-CERT-PRIME             PIC X(10).
  2427             20  MA-CERT-SFX               PIC X.
  2428
  2429     12  FILLER                            PIC XX.
  2430
  2431     12  MA-ACCESS-CONTROL.
  2432         16  MA-SOURCE-SYSTEM              PIC XX.
  2433             88  MA-FROM-CREDIT                VALUE 'CR'.
  2434             88  MA-FROM-VSI                   VALUE 'VS'.
  2435             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2436             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  47
* EL050.cbl
  2437         16  MA-RECORD-ADD-DT              PIC XX.
  2438         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2439         16  MA-LAST-MAINT-DT              PIC XX.
  2440         16  MA-LAST-MAINT-BY              PIC XXXX.
  2441         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2442
  2443     12  MA-PROFILE-INFO.
  2444         16  MA-QUALIFY-CODE-1             PIC XX.
  2445         16  MA-QUALIFY-CODE-2             PIC XX.
  2446         16  MA-QUALIFY-CODE-3             PIC XX.
  2447         16  MA-QUALIFY-CODE-4             PIC XX.
  2448         16  MA-QUALIFY-CODE-5             PIC XX.
  2449
  2450         16  MA-INSURED-LAST-NAME          PIC X(15).
  2451         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2452         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2453         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2454         16  MA-INSURED-BIRTH-DT           PIC XX.
  2455         16  MA-INSURED-SEX                PIC X.
  2456             88  MA-SEX-MALE                   VALUE 'M'.
  2457             88  MA-SEX-FEMALE                 VALUE 'F'.
  2458         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2459
  2460         16  MA-ADDRESS-CORRECTED          PIC X.
  2461         16  MA-JOINT-BIRTH-DT             PIC XX.
  2462*        16  FILLER                        PIC X(12).
  2463
  2464         16  MA-ADDRESS-LINE-1             PIC X(30).
  2465         16  MA-ADDRESS-LINE-2             PIC X(30).
  2466         16  MA-CITY-STATE.
  2467             20  MA-CITY                   PIC X(28).
  2468             20  MA-ADDR-STATE             PIC XX.
  2469         16  MA-ZIP.
  2470             20  MA-ZIP-CODE.
  2471                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2472                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2473                 24  FILLER                PIC X(4).
  2474             20  MA-ZIP-PLUS4              PIC X(4).
  2475         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2476             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2477             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2478             20  FILLER                    PIC X(3).
  2479
  2480         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2481
  2482         16  FILLER                        PIC XXX.
  2483*        16  FILLER                        PIC X(10).
  2484
  2485     12  MA-CRED-BENE-INFO.
  2486         16  MA-CRED-BENE-NAME                 PIC X(25).
  2487         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2488         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2489         16  MA-CRED-BENE-CTYST.
  2490             20  MA-CRED-BENE-CITY             PIC X(28).
  2491             20  MA-CRED-BENE-STATE            PIC XX.
  2492         16  MA-CRED-BENE-ZIP.
  2493             20  MA-CB-ZIP-CODE.
  2494                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  48
* EL050.cbl
  2495                     88  MA-CB-CANADIAN-POST-CODE
  2496                                           VALUE 'A' THRU 'Z'.
  2497                 24  FILLER                    PIC X(4).
  2498             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2499         16  MA-CB-CANADIAN-POSTAL-CODE
  2500                            REDEFINES MA-CRED-BENE-ZIP.
  2501             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2502             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2503             20  FILLER                        PIC X(3).
  2504     12  MA-POST-CARD-MAIL-DATA.
  2505         16  MA-MAIL-DATA OCCURS 7.
  2506             20  MA-MAIL-TYPE              PIC X.
  2507                 88  MA-12MO-MAILING           VALUE '1'.
  2508                 88  MA-EXP-MAILING            VALUE '2'.
  2509             20  MA-MAIL-STATUS            PIC X.
  2510                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2511                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2512                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2513             20  MA-MAIL-DATE              PIC XX.
  2514     12  FILLER                            PIC XX.
  2515     12  FILLER                            PIC XX.
  2516*    12  FILLER                            PIC X(30).
  2517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  49
* EL050.cbl
  2519*    COPY ERCPNDM.
  2520******************************************************************
  2521*                                                                *
  2522*                                                                *
  2523*                            ERCPNDM                             *
  2524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2525*                            VMOD=2.003                          *
  2526*                                                                *
  2527*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2528*                                                                *
  2529*   FILE TYPE = VSAM,KSDS                                        *
  2530*   RECORD SIZE = 374   RECFORM = FIX                            *
  2531*                                                                *
  2532*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2533*   ALTERNATE PATH    = NOT USED                                 *
  2534*                                                                *
  2535*   LOG = YES                                                    *
  2536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2537******************************************************************
  2538*                   C H A N G E   L O G
  2539*
  2540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2541*-----------------------------------------------------------------
  2542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2543* EFFECTIVE    NUMBER
  2544*-----------------------------------------------------------------
  2545* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2546* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2547* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2548******************************************************************
  2549
  2550 01  PENDING-MAILING-DATA.
  2551     12  PM-RECORD-ID                      PIC XX.
  2552         88  VALID-MA-ID                       VALUE 'PM'.
  2553
  2554     12  PM-CONTROL-PRIMARY.
  2555         16  PM-COMPANY-CD                 PIC X.
  2556         16  PM-ENTRY-BATCH                PIC X(6).
  2557         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2558         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2559
  2560     12  FILLER                            PIC X(14).
  2561
  2562     12  PM-ACCESS-CONTROL.
  2563         16  PM-SOURCE-SYSTEM              PIC XX.
  2564             88  PM-FROM-CREDIT                VALUE 'CR'.
  2565             88  PM-FROM-VSI                   VALUE 'VS'.
  2566             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2567             88  PM-FROM-OTHER                 VALUE 'OT'.
  2568         16  PM-RECORD-ADD-DT              PIC XX.
  2569         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2570         16  PM-LAST-MAINT-DT              PIC XX.
  2571         16  PM-LAST-MAINT-BY              PIC XXXX.
  2572         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2573
  2574     12  PM-PROFILE-INFO.
  2575         16  PM-QUALIFY-CODE-1             PIC XX.
  2576         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  50
* EL050.cbl
  2577         16  PM-QUALIFY-CODE-3             PIC XX.
  2578         16  PM-QUALIFY-CODE-4             PIC XX.
  2579         16  PM-QUALIFY-CODE-5             PIC XX.
  2580
  2581         16  PM-INSURED-LAST-NAME          PIC X(15).
  2582         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2583         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2584         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2585         16  PM-INSURED-BIRTH-DT           PIC XX.
  2586         16  PM-INSURED-SEX                PIC X.
  2587             88  PM-SEX-MALE                   VALUE 'M'.
  2588             88  PM-SEX-FEMALE                 VALUE 'F'.
  2589         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2590
  2591         16  PM-ADDRESS-CORRECTED          PIC X.
  2592         16  PM-JOINT-BIRTH-DT             PIC XX.
  2593*        16  FILLER                        PIC X(12).
  2594
  2595         16  PM-ADDRESS-LINE-1             PIC X(30).
  2596         16  PM-ADDRESS-LINE-2             PIC X(30).
  2597         16  PM-CITY-STATE.
  2598             20  PM-CITY                   PIC X(28).
  2599             20  PM-STATE                  PIC XX.
  2600         16  PM-ZIP.
  2601             20  PM-ZIP-CODE.
  2602                 24  PM-ZIP-1              PIC X.
  2603                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2604                 24  FILLER                PIC X(4).
  2605             20  PM-ZIP-PLUS4              PIC X(4).
  2606         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2607             20  PM-CAN-POST1              PIC XXX.
  2608             20  PM-CAN-POST2              PIC XXX.
  2609             20  FILLER                    PIC XXX.
  2610
  2611         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2612
  2613         16  FILLER                        PIC X(03).
  2614
  2615     12  PM-CRED-BENE-INFO.
  2616         16  PM-CRED-BENE-NAME             PIC X(25).
  2617         16  PM-CRED-BENE-ADDR             PIC X(30).
  2618         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2619         16  PM-CRED-BENE-CTYST.
  2620             20  PM-CRED-BENE-CITY         PIC X(28).
  2621             20  PM-CRED-BENE-STATE        PIC XX.
  2622         16  PM-CRED-BENE-ZIP.
  2623             20  PM-CB-ZIP-CODE.
  2624                 24  PM-CB-ZIP-1           PIC X.
  2625                     88  PM-CB-CANADIAN-POST-CODE
  2626                                  VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                PIC X(4).
  2628             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2629         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2630             20  PM-CB-CAN-POST1           PIC XXX.
  2631             20  PM-CB-CAN-POST2           PIC XXX.
  2632             20  FILLER                    PIC XXX.
  2633     12  PM-POST-CARD-MAIL-DATA.
  2634         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  51
* EL050.cbl
  2635             20  PM-MAIL-TYPE              PIC X.
  2636                 88  PM-12MO-MAILING           VALUE '1'.
  2637                 88  PM-EXP-MAILING            VALUE '2'.
  2638             20  PM-MAIL-STATUS            PIC X.
  2639                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2640                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2641                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2642             20  PM-MAIL-DATE              PIC XX.
  2643     12  FILLER                            PIC XX.
  2644     12  FILLER                            PIC X(12).
  2645*    12  FILLER                            PIC X(30).
  2646
  2647******************************************************************
  2648*                                COPY ERCLOFC.
  2649******************************************************************
  2650*                                                                *
  2651*                                                                *
  2652*                            ERCLOFC                             *
  2653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2654*                            VMOD=2.003                          *
  2655*                                                                *
  2656*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2657*                                                                *
  2658*   FILE TYPE = VSAM,KSDS                                        *
  2659*   RECORD SIZE = 670   RECFORM = FIX                            *
  2660*                                                                *
  2661*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2662*                                                                *
  2663*   LOG = YES                                                    *
  2664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2665*                                                                *
  2666******************************************************************
  2667
  2668 01  LOAN-OFFICER-MASTER.
  2669     12  LO-RECORD-ID                PIC XX.
  2670         88  VALID-LO-ID                VALUE 'LO'.
  2671
  2672     12  LO-CONTROL-PRIMARY.
  2673         16  LO-COMPANY-CD           PIC X.
  2674         16  LO-CARRIER              PIC X.
  2675         16  LO-GROUPING.
  2676             20  LO-GROUPING-PREFIX  PIC XXX.
  2677             20  LO-GROUPING-PRIME   PIC XXX.
  2678         16  LO-STATE                PIC XX.
  2679         16  LO-ACCOUNT.
  2680             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2681             20  LO-ACCOUNT-PRIME    PIC X(6).
  2682         16  LO-OFFICER-CODE         PIC X(5).
  2683
  2684     12  LO-OFFICER-NAME             PIC X(30).
  2685
  2686     12  LO-LAST-MAINT-DT            PIC XX.
  2687     12  LO-LAST-USER                PIC X(4).
  2688     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2689
  2690     12  LO-COMP-CONTROL             PIC X.
  2691             88  LO-SHOW-COMP           VALUE 'Y'.
  2692             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  52
* EL050.cbl
  2693     12  LO-DETAIL-CONTROL           PIC X.
  2694             88  LO-PRINT-DETAIL        VALUE 'D'.
  2695             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2696
  2697     12  LO-SV-CARRIER               PIC X.
  2698     12  LO-SV-GROUPING              PIC X(6).
  2699     12  LO-SV-STATE                 PIC XX.
  2700
  2701     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2702     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2703
  2704     12  LO-OFFICER-INFO.
  2705         16  FILLER OCCURS 12 TIMES.
  2706             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2707             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2708             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2709             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2710             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2711             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2712             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2713             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2714     12  FILLER                      PIC X(198).
  2715******************************************************************
  2716*                                COPY ERCPDEF.
  2717******************************************************************
  2718*                                                                *
  2719*                                                                *
  2720*                            ERCPDEF.                            *
  2721*                                                                *
  2722*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2723*                                                                *
  2724*    FILE TYPE = VSAM,KSDS                                       *
  2725*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2726*                                                                *
  2727*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2728*                                                                *
  2729*    LOG = YES                                                   *
  2730*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2731******************************************************************
  2732 01  PRODUCT-MASTER.
  2733    12  PD-RECORD-ID                 PIC X(02).
  2734        88  VALID-PD-ID                  VALUE 'PD'.
  2735    12  PD-CONTROL-PRIMARY.
  2736        16  PD-COMPANY-CD            PIC X.
  2737        16  PD-STATE                 PIC XX.
  2738        16  PD-PRODUCT-CD            PIC XXX.
  2739        16  PD-FILLER                PIC X(7).
  2740        16  PD-BEN-TYPE              PIC X.
  2741        16  PD-BEN-CODE              PIC XX.
  2742        16  PD-PROD-EXP-DT           PIC XX.
  2743    12  FILLER                       PIC X(50).
  2744    12  PD-PRODUCT-DATA OCCURS 8.
  2745        16  PD-PROD-CODE             PIC X.
  2746            88  PD-PROD-LIFE           VALUE 'L'.
  2747            88  PD-PROD-PROP           VALUE 'P'.
  2748            88  PD-PROD-AH             VALUE 'A'.
  2749            88  PD-PROD-IU             VALUE 'I'.
  2750            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  53
* EL050.cbl
  2751        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2752        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2753        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2754        16  PD-MAX-TERM              PIC S999        COMP-3.
  2755        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2756        16  FILLER                   PIC X.
  2757        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2758        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2759        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2760        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2761        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2762        16  PD-REC-CRIT-PERIOD       PIC X.
  2763        16  PD-RTW-MOS               PIC 99.
  2764        16  FILLER                   PIC X(5).
  2765    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2766    12  PD-TERM-LIMITS OCCURS 15.
  2767        16  PD-LOW-TERM              PIC S999        COMP-3.
  2768        16  PD-HI-TERM               PIC S999        COMP-3.
  2769*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2770    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2771        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2772        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2773    12  PD-EARN-FACTORS.
  2774        16  FILLER OCCURS 15.
  2775            20  FILLER OCCURS 15.
  2776                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2777    12  PD-PRODUCT-DESC              PIC X(80).
  2778    12  PD-TRUNCATED                 PIC X.
  2779    12  FILLER                       PIC X(59).
  2780    12  PD-MAINT-INFORMATION.
  2781        16  PD-LAST-MAINT-DT         PIC X(02).
  2782        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2783        16  PD-LAST-MAINT-BY         PIC X(04).
  2784*                                COPY ELCSTATE.
  2785******************************************************************
  2786*                                                                *
  2787*                                                                *
  2788*                            ELCSTATE.                           *
  2789*                                                                *
  2790*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2791*                                                                *
  2792*   FILE TYPE = VSAM,KSDS                                        *
  2793*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2794*                                                                *
  2795*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2796*       ALTERNATE INDEX = NONE                                   *
  2797*                                                                *
  2798*   LOG = YES                                                    *
  2799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2800******************************************************************
  2801*                   C H A N G E   L O G
  2802*
  2803* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2804*-----------------------------------------------------------------
  2805*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2806* EFFECTIVE    NUMBER
  2807*-----------------------------------------------------------------
  2808* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  54
* EL050.cbl
  2809******************************************************************
  2810*
  2811 01  STATE-FILE.
  2812     12  SF-RECORD-ID                       PIC XX.
  2813         88  VALID-CF-ID                        VALUE 'SF'.
  2814     12  SF-CONTROL-PRIMARY.
  2815         16  SF-COMPANY-ID                  PIC XXX.
  2816         16  SF-CARRIER-CODE                PIC X.
  2817         16  SF-GROUPING                    PIC X(6).
  2818         16  SF-STATE-CODE                  PIC XX.
  2819         16  SF-EXPIRE-DATE                 PIC 9(8).
  2820****************************************************************
  2821*             STATE CONTROLS
  2822****************************************************************
  2823     12  SF-LAST-MAINT-DT                   PIC XX.
  2824     12  SF-LAST-MAINT-BY                   PIC X(4).
  2825     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2826     12  SF-STATE-RT-CONTROLS.
  2827         16  SF-ST-RT-CALC                  PIC X.
  2828     12  SF-ST-TAX-CONTROLS.
  2829         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2830         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2831         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2832     12  SF-ST-REFUND-OPTIONS.
  2833         16  SF-ST-RF-LR-CALC               PIC X.
  2834         16  SF-ST-RF-LL-CALC               PIC X.
  2835         16  SF-ST-RF-LN-CALC               PIC X.
  2836         16  SF-ST-RF-AH-CALC               PIC X.
  2837         16  SF-ST-RF-CP-CALC               PIC X.
  2838     12  SF-ST-UNEARN-PREM-OPTIONS.
  2839         16  SF-ST-LUEP-R78                 PIC X.
  2840         16  SF-ST-LUEP-PRO                 PIC X.
  2841         16  SF-ST-LUEP-ST                  PIC X.
  2842         16  SF-ST-LUEP-DOM                 PIC X.
  2843         16  SF-ST-AUEP-R78                 PIC X.
  2844         16  SF-ST-AUEP-PRO                 PIC X.
  2845         16  SF-ST-AUEP-ST                  PIC X.
  2846         16  SF-ST-AUEP-DOM                 PIC X.
  2847         16  SF-ST-CUEP-R78                 PIC X.
  2848         16  SF-ST-CUEP-PRO                 PIC X.
  2849         16  SF-ST-CUEP-ST                  PIC X.
  2850         16  SF-ST-CUEP-DOM                 PIC X.
  2851     12  SF-ST-EARN-PREM-OPTIONS.
  2852         16  SF-ST-LEP-R78                  PIC X.
  2853         16  SF-ST-LEP-PRO                  PIC X.
  2854         16  SF-ST-LEP-ST                   PIC X.
  2855         16  SF-ST-LEP-DOM                  PIC X.
  2856         16  SF-ST-AEP-R78                  PIC X.
  2857         16  SF-ST-AEP-PRO                  PIC X.
  2858         16  SF-ST-AEP-ST                   PIC X.
  2859         16  SF-ST-AEP-DOM                  PIC X.
  2860         16  SF-ST-CEP-R78                  PIC X.
  2861         16  SF-ST-CEP-PRO                  PIC X.
  2862         16  SF-ST-CEP-ST                   PIC X.
  2863         16  SF-ST-CEP-DOM                  PIC X.
  2864     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  55
* EL050.cbl
  2866*    COPY ELCCRTT.
  2867******************************************************************
  2868*                                                                *
  2869*                            ELCCRTT.                            *
  2870*                                                                *
  2871*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2872*                                                                *
  2873*   FILE TYPE = VSAM,KSDS                                        *
  2874*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2875*                                                                *
  2876*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2877*                                                                *
  2878*   LOG = YES                                                    *
  2879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2880******************************************************************
  2881*                   C H A N G E   L O G
  2882*
  2883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2884*-----------------------------------------------------------------
  2885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2886* EFFECTIVE    NUMBER
  2887*-----------------------------------------------------------------
  2888* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2889* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2890* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2891* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2892******************************************************************
  2893
  2894 01  CERTIFICATE-TRAILERS.
  2895     12  CS-RECORD-ID                      PIC XX.
  2896         88  VALID-CS-ID                      VALUE 'CS'.
  2897
  2898     12  CS-CONTROL-PRIMARY.
  2899         16  CS-COMPANY-CD                 PIC X.
  2900         16  CS-CARRIER                    PIC X.
  2901         16  CS-GROUPING                   PIC X(6).
  2902         16  CS-STATE                      PIC XX.
  2903         16  CS-ACCOUNT                    PIC X(10).
  2904         16  CS-CERT-EFF-DT                PIC XX.
  2905         16  CS-CERT-NO.
  2906             20  CS-CERT-PRIME             PIC X(10).
  2907             20  CS-CERT-SFX               PIC X.
  2908         16  CS-TRAILER-TYPE               PIC X.
  2909             88  COMM-TRLR           VALUE 'A'.
  2910             88  FUTURE-TRLR         VALUE 'B'.
  2911             88  CERT-DATA-TRLR      VALUE 'C'.
  2912
  2913     12  CS-DATA-AREA                      PIC X(516).
  2914
  2915     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2916         16  CS-BANK-COMMISSION-AREA.
  2917             20  CS-BANK-COMMS       OCCURS 10.
  2918                 24  CS-AGT                PIC X(10).
  2919                 24  CS-COM-TYP            PIC X.
  2920                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2921                 24  CS-RECALC-LV-INDIC    PIC X.
  2922                 24  FILLER                PIC X(10).
  2923         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  56
* EL050.cbl
  2924
  2925     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2926         16  CS-VIN-NUMBER                 PIC X(17).
  2927         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2928         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2929         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2930         16  FILLER                        PIC X(496).
  2931******************************************************************
  2932*    COPY ELCCRTO.
  2933******************************************************************
  2934*                                                                *
  2935*                            ELCCRTO.                            *
  2936*                                                                *
  2937*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2938*                                                                *
  2939*   FILE TYPE = VSAM,KSDS                                        *
  2940*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2941*                                                                *
  2942*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2943*                                                                *
  2944*   LOG = YES                                                    *
  2945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2946******************************************************************
  2947*                   C H A N G E   L O G
  2948*
  2949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2950*-----------------------------------------------------------------
  2951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2952* EFFECTIVE    NUMBER
  2953*-----------------------------------------------------------------
  2954* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2955* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2956* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2957* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2958* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2959******************************************************************
  2960 01  ORIGINAL-CERTIFICATE.
  2961     12  OC-RECORD-ID                      PIC XX.
  2962         88  VALID-OC-ID                      VALUE 'OC'.
  2963     12  OC-CONTROL-PRIMARY.
  2964         16  OC-COMPANY-CD                 PIC X.
  2965         16  OC-CARRIER                    PIC X.
  2966         16  OC-GROUPING                   PIC X(6).
  2967         16  OC-STATE                      PIC XX.
  2968         16  OC-ACCOUNT                    PIC X(10).
  2969         16  OC-CERT-EFF-DT                PIC XX.
  2970         16  OC-CERT-NO.
  2971             20  OC-CERT-PRIME             PIC X(10).
  2972             20  OC-CERT-SFX               PIC X.
  2973         16  OC-RECORD-TYPE                PIC X.
  2974         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2975     12  OC-LAST-MAINT-DT                  PIC XX.
  2976     12  OC-LAST-MAINT-BY                  PIC X(4).
  2977     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2978     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2979     12  FILLER                            PIC X(49).
  2980     12  OC-ORIG-REC.
  2981         16  OC-INS-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  57
* EL050.cbl
  2982         16  OC-INS-FIRST-NAME             PIC X(10).
  2983         16  OC-INS-MIDDLE-INIT            PIC X.
  2984         16  OC-INS-AGE                    PIC S999     COMP-3.
  2985         16  OC-JNT-LAST-NAME              PIC X(15).
  2986         16  OC-JNT-FIRST-NAME             PIC X(10).
  2987         16  OC-JNT-MIDDLE-INIT            PIC X.
  2988         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2989         16  OC-LF-BENCD                   PIC XX.
  2990         16  OC-LF-TERM                    PIC S999      COMP-3.
  2991         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2992         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2993         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2994         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2995         16  OC-LF-EXP-DT                  PIC XX.
  2996         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2997         16  OC-LF-CANCEL-DT               PIC XX.
  2998         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2999         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3000         16  OC-AH-BENCD                   PIC XX.
  3001         16  OC-AH-TERM                    PIC S999      COMP-3.
  3002         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3003         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3004         16  OC-AH-EXP-DT                  PIC XX.
  3005         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3006         16  OC-AH-CP                      PIC 99.
  3007         16  OC-AH-CANCEL-DT               PIC XX.
  3008         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3009         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3010         16  OC-CRED-BENE-NAME             PIC X(25).
  3011         16  OC-1ST-PMT-DT                 PIC XX.
  3012         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3013         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3014         16  OC-ISSUE-TRAN-IND             PIC X.
  3015         16  OC-CANCEL-TRAN-IND            PIC X.
  3016         16  FILLER                        PIC X(211).
  3017
  3018     12  FILLER                            PIC X(50).
  3019******************************************************************
  3020
  3021*    COPY ELCDATE.
  3022******************************************************************
  3023*                                                                *
  3024*                                                                *
  3025*                            ELCDATE.                            *
  3026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3027*                            VMOD=2.003
  3028*                                                                *
  3029*                                                                *
  3030*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3031*                 LENGTH = 200                                   *
  3032******************************************************************
  3033
  3034 01  DATE-CONVERSION-DATA.
  3035     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3036     12  DC-OPTION-CODE                PIC X.
  3037         88  BIN-TO-GREG                VALUE ' '.
  3038         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3039         88  EDIT-GREG-TO-BIN           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  58
* EL050.cbl
  3040         88  YMD-GREG-TO-BIN            VALUE '3'.
  3041         88  MDY-GREG-TO-BIN            VALUE '4'.
  3042         88  JULIAN-TO-BIN              VALUE '5'.
  3043         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3044         88  FIND-CENTURY               VALUE '7'.
  3045         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3046         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3047         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3048         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3049         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3050         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3051         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3052         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3053         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3054         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3055         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3056         88  BIN-3-TO-GREG              VALUE 'I'.
  3057         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3058         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3059         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3060         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3061         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3062         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3063         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3064         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3065         88  THREE-CHARACTER-BIN
  3066                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3067         88  GREGORIAN-TO-BIN
  3068                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3069         88  BIN-TO-GREGORIAN
  3070                  VALUES ' ' '1' 'I' '8' 'G'.
  3071         88  JULIAN-TO-BINARY
  3072                  VALUES '5' 'C' 'E' 'F'.
  3073     12  DC-ERROR-CODE                 PIC X.
  3074         88  NO-CONVERSION-ERROR        VALUE ' '.
  3075         88  DATE-CONVERSION-ERROR
  3076                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3077         88  DATE-IS-ZERO               VALUE '1'.
  3078         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3079         88  DATE-IS-INVALID            VALUE '3'.
  3080         88  DATE1-GREATER-DATE2        VALUE '4'.
  3081         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3082         88  DATE-INVALID-OPTION        VALUE '9'.
  3083         88  INVALID-CENTURY            VALUE 'A'.
  3084         88  ONLY-CENTURY               VALUE 'B'.
  3085         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3086         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3087     12  DC-END-OF-MONTH               PIC X.
  3088         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3089     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3090         88  USE-NORMAL-PROCESS         VALUE ' '.
  3091         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3092         88  ADJUST-UP-100-YRS          VALUE '2'.
  3093     12  FILLER                        PIC X.
  3094     12  DC-CONVERSION-DATES.
  3095         16  DC-BIN-DATE-1             PIC XX.
  3096         16  DC-BIN-DATE-2             PIC XX.
  3097         16  DC-GREG-DATE-1-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  59
* EL050.cbl
  3098         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3099                       DC-GREG-DATE-1-EDIT.
  3100             20  DC-EDIT1-MONTH        PIC 99.
  3101             20  SLASH1-1              PIC X.
  3102             20  DC-EDIT1-DAY          PIC 99.
  3103             20  SLASH1-2              PIC X.
  3104             20  DC-EDIT1-YEAR         PIC 99.
  3105         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3106         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3107                     DC-GREG-DATE-2-EDIT.
  3108             20  DC-EDIT2-MONTH        PIC 99.
  3109             20  SLASH2-1              PIC X.
  3110             20  DC-EDIT2-DAY          PIC 99.
  3111             20  SLASH2-2              PIC X.
  3112             20  DC-EDIT2-YEAR         PIC 99.
  3113         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3114         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3115                     DC-GREG-DATE-1-YMD.
  3116             20  DC-YMD-YEAR           PIC 99.
  3117             20  DC-YMD-MONTH          PIC 99.
  3118             20  DC-YMD-DAY            PIC 99.
  3119         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3120         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3121                      DC-GREG-DATE-1-MDY.
  3122             20  DC-MDY-MONTH          PIC 99.
  3123             20  DC-MDY-DAY            PIC 99.
  3124             20  DC-MDY-YEAR           PIC 99.
  3125         16  DC-GREG-DATE-1-ALPHA.
  3126             20  DC-ALPHA-MONTH        PIC X(10).
  3127             20  DC-ALPHA-DAY          PIC 99.
  3128             20  FILLER                PIC XX.
  3129             20  DC-ALPHA-CENTURY.
  3130                 24 DC-ALPHA-CEN-N     PIC 99.
  3131             20  DC-ALPHA-YEAR         PIC 99.
  3132         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3133         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3134         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3135         16  DC-JULIAN-DATE            PIC 9(05).
  3136         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3137                                       PIC 9(05).
  3138         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3139             20  DC-JULIAN-YEAR        PIC 99.
  3140             20  DC-JULIAN-DAYS        PIC 999.
  3141         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3142         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3143         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3144     12  DATE-CONVERSION-VARIBLES.
  3145         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3146         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3147             20  FILLER                PIC 9(3).
  3148             20  HOLD-CEN-1-CCYY.
  3149                 24  HOLD-CEN-1-CC     PIC 99.
  3150                 24  HOLD-CEN-1-YY     PIC 99.
  3151             20  HOLD-CEN-1-MO         PIC 99.
  3152             20  HOLD-CEN-1-DA         PIC 99.
  3153         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3154             20  HOLD-CEN-1-R-MO       PIC 99.
  3155             20  HOLD-CEN-1-R-DA       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  60
* EL050.cbl
  3156             20  HOLD-CEN-1-R-CCYY.
  3157                 24  HOLD-CEN-1-R-CC   PIC 99.
  3158                 24  HOLD-CEN-1-R-YY   PIC 99.
  3159             20  FILLER                PIC 9(3).
  3160         16  HOLD-CENTURY-1-X.
  3161             20  FILLER                PIC X(3)  VALUE SPACES.
  3162             20  HOLD-CEN-1-X-CCYY.
  3163                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3164                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3165             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3166             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3167         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3168             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3169             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3170             20  HOLD-CEN-1-R-X-CCYY.
  3171                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3172                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3173             20  FILLER                PIC XXX.
  3174         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3175         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3176         16  DC-JULIAN-DATE-1          PIC 9(07).
  3177         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3178             20  DC-JULIAN-1-CCYY.
  3179                 24  DC-JULIAN-1-CC    PIC 99.
  3180                 24  DC-JULIAN-1-YR    PIC 99.
  3181             20  DC-JULIAN-DA-1        PIC 999.
  3182         16  DC-JULIAN-DATE-2          PIC 9(07).
  3183         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3184             20  DC-JULIAN-2-CCYY.
  3185                 24  DC-JULIAN-2-CC    PIC 99.
  3186                 24  DC-JULIAN-2-YR    PIC 99.
  3187             20  DC-JULIAN-DA-2        PIC 999.
  3188         16  DC-GREG-DATE-A-EDIT.
  3189             20  DC-EDITA-MONTH        PIC 99.
  3190             20  SLASHA-1              PIC X VALUE '/'.
  3191             20  DC-EDITA-DAY          PIC 99.
  3192             20  SLASHA-2              PIC X VALUE '/'.
  3193             20  DC-EDITA-CCYY.
  3194                 24  DC-EDITA-CENT     PIC 99.
  3195                 24  DC-EDITA-YEAR     PIC 99.
  3196         16  DC-GREG-DATE-B-EDIT.
  3197             20  DC-EDITB-MONTH        PIC 99.
  3198             20  SLASHB-1              PIC X VALUE '/'.
  3199             20  DC-EDITB-DAY          PIC 99.
  3200             20  SLASHB-2              PIC X VALUE '/'.
  3201             20  DC-EDITB-CCYY.
  3202                 24  DC-EDITB-CENT     PIC 99.
  3203                 24  DC-EDITB-YEAR     PIC 99.
  3204         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3205         16  DC-GREG-DATE-CYMD-R REDEFINES
  3206                              DC-GREG-DATE-CYMD.
  3207             20  DC-CYMD-CEN           PIC 99.
  3208             20  DC-CYMD-YEAR          PIC 99.
  3209             20  DC-CYMD-MONTH         PIC 99.
  3210             20  DC-CYMD-DAY           PIC 99.
  3211         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3212         16  DC-GREG-DATE-MDCY-R REDEFINES
  3213                              DC-GREG-DATE-MDCY.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  61
* EL050.cbl
  3214             20  DC-MDCY-MONTH         PIC 99.
  3215             20  DC-MDCY-DAY           PIC 99.
  3216             20  DC-MDCY-CEN           PIC 99.
  3217             20  DC-MDCY-YEAR          PIC 99.
  3218    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3219        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3220    12  DC-EL310-DATE                  PIC X(21).
  3221    12  FILLER                         PIC X(28).
  3222
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  62
* EL050.cbl
  3224*    COPY ELCCALC.
  3225******************************************************************
  3226*                                                                *
  3227*                           ELCCALC.                            *
  3228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3229*                            VMOD=2.025                          *
  3230*                                                                *
  3231*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3232*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3233*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3234*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3235*                                                                *
  3236*  PASSED TO ELRTRM                                              *
  3237*  -----------------                                             *
  3238*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3239*  ORIGINAL TERM                                                 *
  3240*  BEGINNING DATE                                                *
  3241*  ENDING DATE                                                   *
  3242*  COMPANY I.D.                                                  *
  3243*  ACCOUNT MASTER USER FIELD                                     *
  3244*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3245*  FREE LOOK DAYS                                                *
  3246*                                                                *
  3247*  RETURNED FROM ELRTRM                                          *
  3248*  ---------------------                                         *
  3249*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3250*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3251*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3252*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3253*----------------------------------------------------------------*
  3254*  PASSED TO ELRAMT                                              *
  3255*  ----------------                                              *
  3256*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3257*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3258*  ORIGINAL AMOUNT                                               *
  3259*  ALTERNATE BENEFIT (BALLON)                                    *
  3260*  A.P.R. - NET PAY ONLY                                         *
  3261*  METHOD
  3262*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3263*  COMPANY I.D.                                                  *
  3264*  BENEFIT TYPE                                                  *
  3265*                                                                *
  3266*  RETURNED FROM ELRAMT                                          *
  3267*  --------------------                                          *
  3268*  REMAINING AMOUNT 1 - CURRENT                                  *
  3269*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3270*  REMAINING AMOUNT FACTOR
  3271*----------------------------------------------------------------*
  3272*  PASSED TO ELRESV                                              *
  3273*  -----------------                                             *
  3274*  CERTIFICATE EFFECTIVE DATE                                    *
  3275*  VALUATION DATE                                                *
  3276*  PAID THRU DATE                                                *
  3277*  BENEFIT                                                       *
  3278*  INCURRED DATE                                                 *
  3279*  REPORTED DATE                                                 *
  3280*  ISSUE AGE                                                     *
  3281*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  63
* EL050.cbl
  3282*  CDT PERCENT                                                   *
  3283*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3284* *CLAIM TYPE (LIFE, A/H)                                        *
  3285* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3286* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3287*                                                                *
  3288*  RETURNED FROM ELRESV                                          *
  3289*  --------------------                                          *
  3290*  CDT TABLE USED                                                *
  3291*  CDT FACTOR USED                                               *
  3292*  PAY TO CURRENT RESERVE                                        *
  3293*  I.B.N.R. - A/H ONLY                                           *
  3294*  FUTURE (ACCRUED) AH ONLY                                      *
  3295*----------------------------------------------------------------*
  3296*  PASSED TO ELRATE                                              *
  3297*  ----------------                                              *
  3298*  CERT ISSUE DATE                                               *
  3299*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3300*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3301*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3302*  STATE CODE (CLIENT DEFINED)                                   *
  3303*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3304*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3305*  DEVIATION CODE                                                *
  3306*  ISSUE AGE                                                     *
  3307*  ORIGINAL BENEFIT AMOUNT                                       *
  3308*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3309*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3310*  BENEFIT KIND (LIFE OR A/H)                                    *
  3311*  A.P.R.                                                        *
  3312*  METHOD
  3313*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3314*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3315*  COMPANY I.D. (3 CHARACTER)                                    *
  3316*  BENEFIT CODE                                                  *
  3317*  BENEFIT OVERRIDE CODE                                         *
  3318*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3319*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3320*  JOINT INDICATOR (CSL ONLY)                                    *
  3321*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3322*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3323*                                                                *
  3324*  RETURNED FROM ELRATE                                          *
  3325*  --------------------                                          *
  3326*  CALCULATED PREMIUM                                            *
  3327*  PREMIUM RATE                                                  *
  3328*  MORTALITY CODE                                                *
  3329*  MAX ATTAINED AGE                                              *
  3330*  MAX AGE                                                       *
  3331*  MAX TERM                                                      *
  3332*  MAX MONTHLY BENEFIT                                           *
  3333*  MAX TOTAL BENIFIT                                             *
  3334*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3335*----------------------------------------------------------------*
  3336*  PASSED TO ELRFND                                              *
  3337*  ----------------                                              *
  3338*  CERT ISSUE DATE                                               *
  3339*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  64
* EL050.cbl
  3340*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3341*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3342*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3343*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3344*  STATE CODE (CLIENT DEFINED)                                   *
  3345*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3346*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3347*  DEVIATION CODE                                                *
  3348*  ISSUE AGE                                                     *
  3349*  ORIGINAL BENEFIT AMOUNT                                       *
  3350*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3351*  PROCESS TYPE (CANCEL)                                         *
  3352*  BENEFIT KIND (LIFE OR A/H)                                    *
  3353*  A.P.R.                                                        *
  3354*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3355*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3356*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3357*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3358*  COMPANY I.D. (3 CHARACTER)                                    *
  3359*  BENEFIT CODE                                                  *
  3360*  BENEFIT OVERRIDE CODE                                         *
  3361*                                                                *
  3362*  RETURNED FROM ELRFND                                          *
  3363*  --------------------                                          *
  3364*  CALCULATED REFUND                                             *
  3365*----------------------------------------------------------------*
  3366*  PASSED TO ELEARN                                              *
  3367*  ----------------                                              *
  3368*  CERT ISSUE DATE                                               *
  3369*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3370*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3371*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3372*  STATE CODE (CLIENT DEFINED)                                   *
  3373*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3374*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3375*  DEVIATION CODE                                                *
  3376*  ISSUE AGE                                                     *
  3377*  ORIGINAL BENEFIT AMOUNT                                       *
  3378*  BENEFIT KIND (LIFE OR A/H)                                    *
  3379*  A.P.R.                                                        *
  3380*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3381*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3382*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3383*  COMPANY I.D. (3 CHARACTER)                                    *
  3384*  BENEFIT CODE                                                  *
  3385*  BENEFIT OVERRIDE CODE                                         *
  3386*                                                                *
  3387*  RETURNED FROM ELEARN                                          *
  3388*  --------------------                                          *
  3389*  INDICATED  EARNINGS                                           *
  3390*----------------------------------------------------------------*
  3391*                 LENGTH = 450                                   *
  3392*                                                                *
  3393******************************************************************
  3394******************************************************************
  3395*                   C H A N G E   L O G
  3396*
  3397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  65
* EL050.cbl
  3398*-----------------------------------------------------------------
  3399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3400* EFFECTIVE    NUMBER
  3401*-----------------------------------------------------------------
  3402* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3403* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3404* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3405* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3406* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3407* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3408* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3409* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3410* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3411******************************************************************
  3412
  3413 01  CALCULATION-PASS-AREA.
  3414     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3415                                     COMP.
  3416
  3417     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3418       88  NO-CP-ERROR                             VALUE ZERO.
  3419       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3420                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3421       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3422       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3423       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3424       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3425       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3426       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3427       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3428       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3429       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3430       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3431       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3432       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3433       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3434       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3435       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3436       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3437       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3438
  3439     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3440       88  NO-CP-ERROR-2                           VALUE ZERO.
  3441***********************  INPUT AREAS ****************************
  3442
  3443     12  CP-CALCULATION-AREA.
  3444         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3445         16  CP-CERT-EFF-DT        PIC XX.
  3446         16  CP-VALUATION-DT       PIC XX.
  3447         16  CP-PAID-THRU-DT       PIC XX.
  3448         16  CP-BENEFIT-TYPE       PIC X.
  3449           88  CP-AH                               VALUE 'A' 'D'
  3450                                                   'I' 'U'.
  3451           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3452           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3453         16  CP-INCURRED-DT        PIC XX.
  3454         16  CP-REPORTED-DT        PIC XX.
  3455         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  66
* EL050.cbl
  3456         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3457         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3458                                     COMP-3.
  3459         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3460                                     COMP-3.
  3461         16  CP-CDT-METHOD         PIC X.
  3462           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3463           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3464           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3465         16  CP-CLAIM-TYPE         PIC X.
  3466           88  CP-AH-CLAIM                         VALUE 'A'.
  3467           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3468         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3473                                     COMP-3.
  3474         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3479                                     COMP-3.
  3480         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3481                                     COMP-3.
  3482         16  CP-REM-TERM-METHOD    PIC X.
  3483           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3484           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3485           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3486           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3487           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3488           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3489           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3490         16  CP-EARNING-METHOD     PIC X.
  3491           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3492           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3493           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3494           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3495           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3496           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3497           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3498           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3499           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3500           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3501           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3502           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3503           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3504           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3505         16  CP-PROCESS-TYPE       PIC X.
  3506           88  CP-CLAIM                            VALUE '1'.
  3507           88  CP-CANCEL                           VALUE '2'.
  3508           88  CP-ISSUE                            VALUE '3'.
  3509         16  CP-SPECIAL-CALC-CD    PIC X.
  3510           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3511           88  CP-1-MTH-INTEREST               VALUE ' '.
  3512           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3513           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  67
* EL050.cbl
  3514           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3515           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3516           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3517           88  CP-FARM-PLAN                    VALUE 'F'.
  3518           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3519           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3520           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3521           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3522           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3523           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3524           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3525           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3526           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3527           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3528                                                     'W' 'X'.
  3529           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3530           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3531           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3532           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3533           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3534           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3535           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3536           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3537           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3538           88  CP-CSL-METH-1                   VALUE '5'.
  3539           88  CP-CSL-METH-2                   VALUE '6'.
  3540           88  CP-CSL-METH-3                   VALUE '7'.
  3541           88  CP-CSL-METH-4                   VALUE '8'.
  3542
  3543         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3544                                     COMP-3.
  3545         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3546         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3547         16  CP-STATE              PIC XX          VALUE SPACE.
  3548         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3549         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3550           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3551               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3552         16  CP-R78-OPTION         PIC X.
  3553           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3554           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3555
  3556         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3557         16  CP-IBNR-RESERVE-SW    PIC X.
  3558         16  CP-CLAIM-STATUS       PIC X.
  3559         16  CP-RATE-FILE          PIC X.
  3560         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3561                                     COMP-3.
  3562
  3563         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3564         16  CP-AH-OVERRIDE-CODE   PIC X.
  3565
  3566         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3569                                   PIC S9(5)V99 COMP-3.
  3570         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3571                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  68
* EL050.cbl
  3572         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3573                                     COMP-3.
  3574         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3575                                     COMP-3.
  3576         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3577                                  PIC S9(7)V99 COMP-3.
  3578
  3579         16  CP-PAID-FROM-DATE     PIC X(02).
  3580         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3581         16  CP-EXT-DAYS-CALC      PIC X.
  3582           88  CP-EXT-NO-CHG                   VALUE ' '.
  3583           88  CP-EXT-CHG-LF                   VALUE '1'.
  3584           88  CP-EXT-CHG-AH                   VALUE '2'.
  3585           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3586         16  CP-DOMICILE-STATE     PIC XX.
  3587         16  CP-CARRIER            PIC X.
  3588         16  CP-REIN-FLAG          PIC X.
  3589         16  CP-REM-TRM-CALC-OPTION PIC X.
  3590           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3591                      '2' '3' '4' '5'.
  3592           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3593           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3594           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3595           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3596           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3597           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3598           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3599           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3600         16  CP-SIG-SWITCH         PIC X.
  3601         16  CP-RATING-METHOD      PIC X.
  3602           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3603           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3604           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3605           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3606           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3607           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3608           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3609           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3610           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3611         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3612                                     COMP-3.
  3613         16  CP-BEN-CATEGORY       PIC X.
  3614         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3615         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3616                                   PIC S99V9(5) COMP-3.
  3617         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3618         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3619                                   PIC S99V9(5) COMP-3.
  3620         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3621         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3622         16  CP-EXPIRE-DT          PIC XX.
  3623         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3624         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3625         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3626         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3627         16  CP-DDF-SPEC-CALC      PIC X.
  3628             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3629             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  69
* EL050.cbl
  3630         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3631         16  CP-CANCEL-REASON      PIC X.
  3632         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3633         16  CP-PMT-MODE           PIC X.
  3634         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3635         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3636         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3637         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3638         16  FILLER                PIC X.
  3639
  3640***************    OUTPUT FROM ELRESV   ************************
  3641
  3642         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3643
  3644         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3645                                     COMP-3.
  3646         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3647                                     COMP-3.
  3648         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3649                                     COMP-3.
  3650         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3651                                     COMP-3.
  3652         16  FILLER                PIC X(09).
  3653***************    OUTPUT FROM ELRTRM   *************************
  3654
  3655         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3658                                     COMP-3.
  3659         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3660                                     COMP-3.
  3661         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3662                                     COMP-3.
  3663         16  FILLER                PIC X(12).
  3664
  3665***************    OUTPUT FROM ELRAMT   *************************
  3666
  3667         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3670                                     COMP-3.
  3671         16  FILLER                PIC X(12).
  3672
  3673***************    OUTPUT FROM ELRATE   *************************
  3674
  3675         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-MORTALITY-CODE     PIC X(4).
  3680         16  CP-RATE-EDIT-FLAG     PIC X.
  3681             88  CP-RATES-NEED-APR                  VALUE '1'.
  3682         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3683                                     COMP-3.
  3684         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3685         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3686         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3687                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  70
* EL050.cbl
  3688         16  FILLER                PIC X(07).
  3689
  3690***************    OUTPUT FROM ELRFND   *************************
  3691
  3692         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  CP-REFUND-TYPE-USED   PIC X.
  3695           88  CP-R-AS-R78                         VALUE '1'.
  3696           88  CP-R-AS-PRORATA                     VALUE '2'.
  3697           88  CP-R-AS-CALIF                       VALUE '3'.
  3698           88  CP-R-AS-TEXAS                       VALUE '4'.
  3699           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3700           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3701           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3702           88  CP-R-AS-MEAN                        VALUE '8'.
  3703           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3704           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3705           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3706           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3707           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3708           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3709         16  FILLER                PIC X(12).
  3710
  3711***************    OUTPUT FROM ELEARN   *************************
  3712
  3713         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-EARNING-TYPE-USED  PIC X.
  3726           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3727           88  CP-E-AS-R78                         VALUE '1'.
  3728           88  CP-E-AS-PRORATA                     VALUE '2'.
  3729           88  CP-E-AS-TEXAS                       VALUE '4'.
  3730           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3731           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3732           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3733           88  CP-E-AS-MEAN                        VALUE '8'.
  3734           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3735         16  FILLER                PIC X(12).
  3736
  3737***************    OUTPUT FROM ELPMNT   *************************
  3738
  3739         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3742                                     COMP-3.
  3743         16  FILLER                PIC X(12).
  3744
  3745***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  71
* EL050.cbl
  3746         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3759             88  OPEN-RATE-FILE                   VALUE 'O'.
  3760             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3761             88  IO-ERROR                         VALUE 'E'.
  3762
  3763         16  CP-FIRST-PAY-DATE     PIC XX.
  3764
  3765         16  CP-JOINT-INDICATOR    PIC X.
  3766
  3767         16  CP-RESERVE-REMAINING-TERM
  3768                                   PIC S9(4)V9    VALUE ZERO
  3769                                     COMP-3.
  3770
  3771         16  CP-INSURED-BIRTH-DT   PIC XX.
  3772
  3773         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3774                                     COMP-3.
  3775
  3776         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3777                                     COMP-3.
  3778
  3779         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3780                                     COMP-3.
  3781
  3782         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3783                                     COMP-3.
  3784
  3785         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3786                                     COMP-3.
  3787
  3788         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3789                                     COMP-3.
  3790
  3791         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3792                                     COMP-3.
  3793
  3794         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3795             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3796
  3797         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3802         16  FILLER                PIC X(15).
  3803******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  72
* EL050.cbl
  3805******************************************************************
  3806*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3807*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3808*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3809*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3810*** MODIFICATION.                                              ***
  3811*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3812*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3813******************************************************************
  3814*    COPY ERCPNDB.
  3815******************************************************************
  3816*                                                                *
  3817*                                                                *
  3818*                            ERCPNDB.                            *
  3819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3820*                            VMOD=2.025                          *
  3821*                                                                *
  3822*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3823*                                                                *
  3824******************************************************************
  3825*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3826*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3827******************************************************************
  3828*                                                                *
  3829*                                                                *
  3830*   FILE TYPE = VSAM,KSDS                                        *
  3831*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3832*                                                                *
  3833*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3834*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3835*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3836*                                                 RKP=13,LEN=36  *
  3837*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3838*                                      AND CHG-SEQ.)             *
  3839*                                                RKP=49,LEN=11   *
  3840*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3841*                                      AND CHG-SEQ.)             *
  3842*                                                RKP=60,LEN=15   *
  3843*                                                                *
  3844*   LOG = NO                                                     *
  3845*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3846******************************************************************
  3847******************************************************************
  3848*                   C H A N G E   L O G
  3849*
  3850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3851*-----------------------------------------------------------------
  3852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3853* EFFECTIVE    NUMBER
  3854*-----------------------------------------------------------------
  3855* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3856* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3857* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3858* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3859* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3860* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3861* 032306                   PEMA  ADD BOW LOAN NUMBER
  3862* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  73
* EL050.cbl
  3863* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3864* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3865* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3866* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3867* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3868* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3869* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3870******************************************************************
  3871
  3872 01  PENDING-BUSINESS.
  3873     12  PB-RECORD-ID                     PIC XX.
  3874         88  VALID-PB-ID                        VALUE 'PB'.
  3875
  3876     12  PB-CONTROL-PRIMARY.
  3877         16  PB-COMPANY-CD                PIC X.
  3878         16  PB-ENTRY-BATCH               PIC X(6).
  3879         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3880         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3881
  3882     12  PB-CONTROL-BY-ACCOUNT.
  3883         16  PB-COMPANY-CD-A1             PIC X.
  3884         16  PB-CARRIER                   PIC X.
  3885         16  PB-GROUPING.
  3886             20  PB-GROUPING-PREFIX       PIC XXX.
  3887             20  PB-GROUPING-PRIME        PIC XXX.
  3888         16  PB-STATE                     PIC XX.
  3889         16  PB-ACCOUNT.
  3890             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3891             20  PB-ACCOUNT-PRIME         PIC X(6).
  3892         16  PB-CERT-EFF-DT               PIC XX.
  3893         16  PB-CERT-NO.
  3894             20  PB-CERT-PRIME            PIC X(10).
  3895             20  PB-CERT-SFX              PIC X.
  3896         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3897
  3898         16  PB-RECORD-TYPE               PIC X.
  3899             88  PB-MAILING-DATA                VALUE '0'.
  3900             88  PB-ISSUE                       VALUE '1'.
  3901             88  PB-CANCELLATION                VALUE '2'.
  3902             88  PB-BATCH-TRAILER               VALUE '9'.
  3903
  3904     12  PB-CONTROL-BY-ORIG-BATCH.
  3905         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3906         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3907         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3908         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3909
  3910     12  PB-CONTROL-BY-CSR.
  3911         16  PB-CSR-COMPANY-CD            PIC X.
  3912         16  PB-CSR-ID                    PIC X(4).
  3913         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3914         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3915         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3916******************************************************************
  3917*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3918******************************************************************
  3919
  3920     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  74
* EL050.cbl
  3921     12  PB-LAST-MAINT-BY                 PIC X(4).
  3922     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3923
  3924     12  PB-RECORD-BODY                   PIC X(375).
  3925
  3926     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3927         16  PB-CERT-ORIGIN               PIC X.
  3928             88  CLASIC-CREATED-CERT         VALUE '1'.
  3929         16  PB-I-NAME.
  3930             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3931             20  PB-I-INSURED-FIRST-NAME.
  3932                 24  PB-I-INSURED-1ST-INIT PIC X.
  3933                 24  FILLER                PIC X(9).
  3934             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3935         16  PB-I-AGE                     PIC S99   COMP-3.
  3936         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3937         16  PB-I-BIRTHDAY                PIC XX.
  3938         16  PB-I-INSURED-SEX             PIC X.
  3939             88  PB-SEX-MALE     VALUE 'M'.
  3940             88  PB-SEX-FEMALE   VALUE 'F'.
  3941
  3942         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3943         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3944         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3945         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3946         16  PB-I-SKIP-CODE               PIC X.
  3947             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3948             88  PB-SKIP-JULY              VALUE '1'.
  3949             88  PB-SKIP-AUGUST            VALUE '2'.
  3950             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3951             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3952             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3953             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3954             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3955             88  PB-SKIP-JUNE              VALUE '8'.
  3956             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3957             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3958             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3959         16  PB-I-TERM-TYPE               PIC X.
  3960             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3961             88  PB-PAID-WEEKLY            VALUE 'W'.
  3962             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3963             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3964             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3965         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3966         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3967         16  PB-I-DATA-ENTRY-SW           PIC X.
  3968             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3969             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3970             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3971             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3972         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3973         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3974*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3975         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3976         16  FILLER                       PIC X.
  3977
  3978         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  75
* EL050.cbl
  3979             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3980             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3981                                                   '90' THRU '99'.
  3982         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3983                                          PIC XX.
  3984         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3985         16  PB-I-AMOUNT-FINANCED REDEFINES
  3986                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3987         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3988         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3989                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3990         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3991         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3992         16  PB-I-CLP-AMOUNT REDEFINES
  3993                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3994         16  PB-I-LF-CALC-FLAG            PIC X.
  3995             88 PB-COMP-LF-PREM               VALUE '?'.
  3996         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3997         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3998         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3999         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4000         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4001         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4002         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4003         16  PB-I-LF-ABBR                 PIC XXX.
  4004         16  PB-I-LF-INPUT-CD             PIC XX.
  4005
  4006         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4007             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4008             88  PB-INVALID-AH               VALUE '  ' '00'
  4009                                                   '90' THRU '99'.
  4010         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4011         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4012         16  PB-I-AH-CALC-FLAG            PIC X.
  4013             88 PB-COMP-AH-PREM                  VALUE '?'.
  4014         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4015         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4016         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4017         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4018         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4019         16  PB-I-AH-ABBR                 PIC XXX.
  4020         16  PB-I-AH-INPUT-CD             PIC XXX.
  4021
  4022         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4023         16  PB-I-REIN-TABLE              PIC XXX.
  4024         16  PB-I-BUSINESS-TYPE           PIC 99.
  4025         16  PB-I-INDV-GRP-CD             PIC X.
  4026         16  PB-I-MORT-CODE.
  4027             20  PB-I-TABLE               PIC X.
  4028             20  PB-I-INTEREST            PIC XX.
  4029             20  PB-I-MORT-TYP            PIC X.
  4030         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4031         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4032         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4033         16  PB-I-INDV-GRP-OVRD           PIC X.
  4034         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4035         16  PB-I-SIG-SW                  PIC X.
  4036             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  76
* EL050.cbl
  4037         16  PB-I-RATE-CLASS              PIC XX.
  4038         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4039         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4040         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4041         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4042         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4043         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4044         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4045         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4046         16  PB-I-OB-FLAG                 PIC X.
  4047             88  PB-I-OB                      VALUE 'B'.
  4048             88  PB-I-SUMMARY                 VALUE 'Z'.
  4049         16  PB-I-ENTRY-STATUS            PIC X.
  4050             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4051                                              'M' '5' '9' '2'.
  4052             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4053             88  PB-I-POLICY-PENDING          VALUE '2'.
  4054             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4055             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4056             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4057             88  PB-I-REIN-ONLY               VALUE '9'.
  4058             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4059             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4060             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4061             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4062         16  PB-I-INT-CODE                PIC X.
  4063             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4064             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4065         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4066         16  PB-I-SOC-SEC-NO              PIC X(11).
  4067         16  PB-I-MEMBER-NO               PIC X(12).
  4068         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4069*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4070         16  PB-I-OLD-LOF                 PIC XXX.
  4071         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4072         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4073         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4074         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4075         16  PB-I-LIFE-INDICATOR          PIC X.
  4076             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4077         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4078         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4079                                          PIC S9(5)V99    COMP-3.
  4080         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4081             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4082             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4083         16  PB-I-1ST-PMT-DT              PIC XX.
  4084         16  PB-I-JOINT-INSURED.
  4085             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4086             20 PB-I-JOINT-FIRST-NAME.
  4087                24  PB-I-JOINT-FIRST-INIT PIC X.
  4088                24  FILLER                PIC X(9).
  4089             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4090*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4091         16  PB-I-BENEFICIARY-NAME.
  4092             20  PB-I-BANK-NUMBER         PIC X(10).
  4093             20  FILLER                   PIC X(15).
  4094         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  77
* EL050.cbl
  4095         16  PB-I-REFERENCE               PIC X(12).
  4096         16  FILLER REDEFINES PB-I-REFERENCE.
  4097             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4098             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4099             20  PB-I-CLP-STATE           PIC XX.
  4100         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4101             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4102             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4103             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4104         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4105         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4106         16  PB-I-RESIDENT-STATE          PIC XX.
  4107         16  PB-I-RATE-CODE               PIC X(4).
  4108         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4109         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4110         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4111         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4112         16  PB-I-BANK-NOCHRGB            PIC 99.
  4113         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4114         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4115
  4116     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4117         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4118             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4119         16  PB-C-CANCEL-ORIGIN           PIC X.
  4120             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4121         16  PB-C-LF-CANCEL-DT            PIC XX.
  4122         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4123         16  PB-C-LF-CALC-REQ             PIC X.
  4124             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4125         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4126         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4127         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4128             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4129         16  PB-C-AH-CANCEL-DT            PIC XX.
  4130         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4131         16  PB-C-AH-CALC-REQ             PIC X.
  4132             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4133         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4134         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4135         16  PB-C-LAST-NAME               PIC X(15).
  4136         16  PB-C-REFUND-SW               PIC X.
  4137             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4138             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4139         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4140         16  PB-C-PAYEE-CODE              PIC X(6).
  4141         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4142         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4143         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4144         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4145         16  PB-C-REFERENCE               PIC X(12).
  4146         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4147         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4148         16  PB-C-POST-CARD-IND           PIC X.
  4149         16  PB-C-CANCEL-REASON           PIC X.
  4150         16  PB-C-REF-INTERFACE-SW        PIC X.
  4151         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4152         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  78
* EL050.cbl
  4153         16  FILLER                       PIC X(01).
  4154*        16  FILLER                       PIC X(18).
  4155         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4156*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4157         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4158         16  PB-CANCELED-CERT-DATA.
  4159             20  PB-CI-INSURED-NAME.
  4160                 24  PB-CI-LAST-NAME      PIC X(15).
  4161                 24  PB-CI-INITIALS       PIC XX.
  4162             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4163             20  PB-CI-INSURED-SEX        PIC X.
  4164             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4165             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4166             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4167             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4168             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4169             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4170             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4171             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4172             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4173             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4174             20  PB-CI-RATE-CLASS         PIC XX.
  4175             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4176             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4177             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4178             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4179             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4180             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4181             20  PB-CI-LF-ABBR            PIC X(3).
  4182             20  PB-CI-AH-ABBR            PIC X(3).
  4183             20  PB-CI-OB-FLAG            PIC X.
  4184                 88  PB-CI-OB                VALUE 'B'.
  4185             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4186                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4187                                           'M' '4' '5' '9' '2'.
  4188                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4189                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4190                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4191                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4192                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4193                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4194                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4195                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4196                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4197                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4198                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4199                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4200             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4201                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4202                                           'M' '4' '5' '9' '2'.
  4203                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4204                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4205                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4206                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4207                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4208                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4209                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4210                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  79
* EL050.cbl
  4211                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4212                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4213                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4214                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4215             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4216             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4217             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4218             20  PB-CI-MEMBER-NO          PIC X(12).
  4219             20  PB-CI-INT-CODE           PIC X.
  4220                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4221                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4222             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4223             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4224             20  PB-CI-COMP-EXCP-SW       PIC X.
  4225                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4226                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4227             20  PB-CI-ENTRY-STATUS       PIC X.
  4228             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4229             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4230             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4231             20  PB-CI-DEATH-DT           PIC XX.
  4232             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4233             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4234             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4235             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4236             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4237             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4238             20  PB-CI-ENTRY-DT              PIC XX.
  4239             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4240             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4241             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4242             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4243             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4244             20  PB-CI-OLD-LOF               PIC XXX.
  4245*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4246             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4247             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4248             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4249             20  PB-CI-INDV-GRP-CD           PIC X.
  4250             20  PB-CI-BENEFICIARY-NAME.
  4251                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4252                 24  FILLER                  PIC X(15).
  4253             20  PB-CI-NOTE-SW               PIC X.
  4254             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4255             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4256             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4257             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4258             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4259             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4260             20  PB-CI-FIRST-NAME            PIC X(10).
  4261             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4262
  4263         16  FILLER                       PIC X(13).
  4264*032306  16  FILLER                       PIC X(27).
  4265*        16  FILLER                       PIC X(46).
  4266
  4267     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4268         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  80
* EL050.cbl
  4269         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4270         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4271         16  PB-M-INSURED-MID-INIT        PIC X.
  4272         16  PB-M-INSURED-AGE             PIC 99.
  4273         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4274         16  PB-M-INSURED-SEX             PIC X.
  4275         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4276         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4277         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4278         16  PB-M-INSURED-CITY-STATE.
  4279             20  PB-M-INSURED-CITY        PIC X(28).
  4280             20  PB-M-INSURED-STATE       PIC XX.
  4281         16  PB-M-INSURED-ZIP-CODE.
  4282             20  PB-M-INSURED-ZIP-PRIME.
  4283                 24  PB-M-INSURED-ZIP-1   PIC X.
  4284                     88  PB-M-CANADIAN-POST-CODE
  4285                                             VALUE 'A' THRU 'Z'.
  4286                 24  FILLER               PIC X(4).
  4287             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4288         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4289                                        PB-M-INSURED-ZIP-CODE.
  4290             20  PM-M-INS-CAN-POST1       PIC XXX.
  4291             20  PM-M-INS-CAN-POST2       PIC XXX.
  4292             20  FILLER                   PIC XXX.
  4293         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4294         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4295         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4296         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4297         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4298         16  PB-M-CRED-BENE-CITYST.
  4299             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4300             20  PB-M-CRED-BENE-STATE     PIC XX.
  4301         16  FILLER                       PIC X(92).
  4302
  4303     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4304         16  FILLER                       PIC X(10).
  4305         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4306         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4307         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4308         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4309         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4310         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4311         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4312         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4313         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4314         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4315         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4316         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4317         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4318         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4319         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4320         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4321         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4322         16  PB-ACCOUNT-NAME              PIC X(30).
  4323         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4324         16  PB-REFERENCE                 PIC X(12).
  4325         16  PB-B-RECEIVED-DT             PIC XX.
  4326         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  81
* EL050.cbl
  4327
  4328     12  PB-RECORD-STATUS.
  4329         16  PB-CREDIT-SELECT-DT          PIC XX.
  4330         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4331         16  PB-BILLED-DT                 PIC XX.
  4332         16  PB-BILLING-STATUS            PIC X.
  4333             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4334             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4335             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4336         16  PB-RECORD-BILL               PIC X.
  4337             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4338             88  PB-RECORD-RETURNED           VALUE 'R'.
  4339             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4340             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4341             88  PB-OVERRIDE-AH               VALUE 'A'.
  4342             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4343         16  PB-BATCH-ENTRY               PIC X.
  4344             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4345             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4346             88  PB-REISSUED-CERT             VALUE 'E'.
  4347             88  PB-MONTHLY-CERT              VALUE 'M'.
  4348             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4349             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4350             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4351         16  PB-FORCE-CODE                PIC X.
  4352             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4353             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4354             88  PB-CANCEL-FORCE              VALUE '8'.
  4355             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4356             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4357             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4358             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4359             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4360             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4361             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4362         16  PB-FATAL-FLAG                PIC X.
  4363             88  PB-FATAL-ERRORS              VALUE 'X'.
  4364         16  PB-FORCE-ER-CD               PIC X.
  4365             88  PB-FORCE-ERRORS              VALUE 'F'.
  4366             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4367         16  PB-WARN-ER-CD                PIC X.
  4368             88  PB-WARNING-ERRORS            VALUE 'W'.
  4369         16  FILLER                       PIC X.
  4370         16  PB-OUT-BAL-CD                PIC X.
  4371             88  PB-OUT-OF-BAL                VALUE 'O'.
  4372         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4373         16  PB-AH-OVERRIDE-L1            PIC X.
  4374         16  PB-INPUT-DT                  PIC XX.
  4375         16  PB-INPUT-BY                  PIC X(4).
  4376         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4377         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4378         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4379         16  PB-LF-EARNING-METHOD         PIC X.
  4380         16  PB-AH-EARNING-METHOD         PIC X.
  4381         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4382         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4383         16  PB-REIN-CD                   PIC XXX.
  4384         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  82
* EL050.cbl
  4385         16  PB-AH-REFUND-TYPE            PIC X.
  4386         16  PB-ACCT-EFF-DT               PIC XX.
  4387         16  PB-ACCT-EXP-DT               PIC XX.
  4388         16  PB-COMPANY-ID                PIC X(3).
  4389         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4390         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4391         16  PB-SV-CARRIER                PIC X.
  4392         16  PB-SV-GROUPING               PIC X(6).
  4393         16  PB-SV-STATE                  PIC XX.
  4394         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4395         16  PB-GA-BILLING-INFO.
  4396             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4397                                          PIC XX.
  4398         16  PB-SV-REMIT-TO  REDEFINES
  4399             PB-GA-BILLING-INFO           PIC X(10).
  4400         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4401         16  PB-I-LOAN-OFFICER            PIC X(5).
  4402         16  PB-I-VIN                     PIC X(17).
  4403
  4404         16  FILLER                       PIC X(04).
  4405         16  IMNET-BYPASS-SW              PIC X.
  4406
  4407******************************************************************
  4408*                COMMON EDIT ERRORS                              *
  4409******************************************************************
  4410
  4411     12  PB-COMMON-ERRORS.
  4412         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4413                                           PIC S9(4)     COMP.
  4414
  4415******************************************************************
  4416
  4417* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4418*    COPY ELC50W1.
  4419******************************************************************
  4420*                                                                *
  4421*                                                                *
  4422*                             ELC50W1                            *
  4423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4424*                            VMOD=2.004                          *
  4425*                                                                *
  4426*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4427*                                                                *
  4428*                                                                *
  4429******************************************************************
  4430
  4431     12  WK-WORK-AREA.
  4432         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4433         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4434         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4435         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4436         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4437         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4438         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4439         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4440         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4441         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4442         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  83
* EL050.cbl
  4443         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4444         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4445         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4446         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4447         16  WK-CREDIT-EDIT-CONTROLS.
  4448             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4449             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4450             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4451             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4452             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4453             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4454         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4455         16  WK-SAVE-REIN-DATA.
  4456             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4457             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4458             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4459         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4460             88  ENTRY-FROM-EL6311       VALUE '6'.
  4461         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4462         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4463     12  WK-RECORD-ADDRESSES.
  4464         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4465         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4466         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4467         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4468         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4469         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4470         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4471         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4472     12  WK-OVER-SHORT-AREA.
  4473         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4474         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4475         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4476             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4477         16  FILLER                   PIC X(5) VALUE SPACES.
  4478
  4479*    COPY ELCEDITC.
  4480******************************************************************
  4481*                                                                *
  4482*                                                                *
  4483*                            ELCEDITC                            *
  4484*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4485*                            VMOD=2.012                          *
  4486*                                                                *
  4487*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4488*                     EL6313, EL050 AND EL517.                   *
  4489*                                                                *
  4490******************************************************************
  4491******************************************************************
  4492*                   C H A N G E   L O G
  4493*
  4494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4495*-----------------------------------------------------------------
  4496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4497* EFFECTIVE    NUMBER
  4498*-----------------------------------------------------------------
  4499* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4500******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  84
* EL050.cbl
  4501
  4502     12  EDIT-CRITERIA-DATA.
  4503         16  EC-CO-MONTH-END-DT       PIC XX.
  4504         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4505         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4506         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4507         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4508         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4509         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4510         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4511         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4512         16  EC-CO-REM-TERM-CALC      PIC X.
  4513               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4514               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4515               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4516               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4517
  4518         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4519               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4520               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4521               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4522               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4523               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4524               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4525               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4526               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4527               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4528               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4529
  4530         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4531               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4532               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4533               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4534               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4535               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4536               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4537               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4538               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4539
  4540         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4541                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4542                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4543
  4544         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4545                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4546                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4547                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4548                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4549                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4550                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4551                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4552                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4553
  4554         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4555               88  EC-BR-REDUCING                   VALUE 'R'.
  4556               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4557
  4558         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  85
* EL050.cbl
  4559         16  EC-BR-LF-DESC             PIC X(10).
  4560         16  EC-BR-AH-DESC             PIC X(10).
  4561         16  EC-BR-LF-COMMENT          PIC X(10).
  4562         16  EC-BR-AH-COMMENT          PIC X(10).
  4563
  4564         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4565               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4566               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4567               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4568               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4569
  4570         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4571               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4572               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4573               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4574               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4575
  4576         16  EC-BR-LF-REFUND-CALC      PIC X.
  4577                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4578                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4579                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4580                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4581                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4582                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4583                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4584
  4585         16  EC-BR-AH-REFUND-CALC      PIC X.
  4586                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4587                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4588                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4589                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4590                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4591                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4592                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4593                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4594
  4595         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4596                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4597                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4598                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4599
  4600         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4601                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4602                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4603                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4604
  4605         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4606         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4607         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4608         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4609
  4610         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4611         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4612                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4613                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4614                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4615                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4616
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  86
* EL050.cbl
  4617         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4618               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4619               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4620               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4621               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4622               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4623
  4624         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4625               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4626               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4627               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4628               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4629               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4630
  4631         16  EC-ST-LF-REFUND-CALC      PIC X.
  4632                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4633                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4634                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4635                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4636                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4637                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4638                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4639                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4640
  4641         16  EC-ST-AH-REFUND-CALC      PIC X.
  4642                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4643                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4644                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4645                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4646                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4647                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4648                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4649                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4650
  4651         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4652         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4653         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4654         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4655         16  EC-AM-EXPIRATION-DT       PIC XX.
  4656         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4657         16  EC-AM-CLASS-CD            PIC XX.
  4658         16  EC-AM-LF-DEVIATION        PIC XXX.
  4659         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4660         16  EC-AM-AH-DEVIATION        PIC XXX.
  4661         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4662         16  EC-AM-PHONE-NO            PIC X(10).
  4663
  4664         16  EC-AM-LF-REFUND-CALC      PIC X.
  4665                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4666                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4667                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4668                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4669                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4670                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4671                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4672
  4673         16  EC-AM-AH-REFUND-CALC      PIC X.
  4674                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  87
* EL050.cbl
  4675                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4676                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4677                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4678                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4679                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4680                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4681
  4682         16  EC-AM-BEN-I-G-CD          PIC X.
  4683                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4684                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4685                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4686
  4687         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4688         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4689         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4690         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4691         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4692         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4693         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4694         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4695         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4696
  4697         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4698         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4699         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4700         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4701         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4702         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4703         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4704         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4705         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4706         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4707         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4708         16  EC-RT-LF-NSP-ST           PIC XX.
  4709         16  EC-RT-AH-NSP-ST           PIC XX.
  4710         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4711         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4712
  4713         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4714             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4715                                             'M' '5' '9' '2'.
  4716             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4717             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4718             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4719             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4720             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4721             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4722             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4723             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4724             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4725             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4726
  4727         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4728             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4729                                             'M' '5' '9' '2'.
  4730             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4731             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4732             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  88
* EL050.cbl
  4733             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4734             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4735             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4736             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4737             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4738             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4739             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4740
  4741         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4742         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4743         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4744         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4745         16  EC-CM-DEATH-DT            PIC XX.
  4746
  4747*DMD CUSTOM CODING FIELDS BELOW
  4748*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4749         16  EC-BR-DMD-RATING-SW       PIC X.
  4750                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4751                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4752                 88  NO-DMD-RATING               VALUE 'N'.
  4753
  4754         16  EC-NEW-CERT               PIC X(11).
  4755         16  EC-NEW-STATE              PIC XX.
  4756         16  FILLER                    PIC X.
  4757*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4758         16  OVER-SHORT-EDIT-FIELDS.
  4759             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4760             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4761             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4762             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4763             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4764             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4765             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4766             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4767             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4768         16  FILLER                    PIC X(71).
  4769******************************************************************
  4770
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  89
* EL050.cbl
  4772*    COPY ELCDIFRD.
  4773******************************************************************
  4774*                                                                *
  4775*                                                                *
  4776*                            ELCDIFRD.                           *
  4777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4778*                            VMOD=2.004                          *
  4779*                                                                *
  4780*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4781*                                                                *
  4782******************************************************************
  4783*
  4784  01  WS-DIFFERENCE-CALCULATION.
  4785        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4786        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4787        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4788        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4789        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4790        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4791        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4792        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4793        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4794        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4795        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4796
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  90
* EL050.cbl
  4798****************************************************************
  4799*
  4800* Copyright (c) 2007 by Clerity Solutions, Inc.
  4801* All rights reserved.
  4802*
  4803****************************************************************
  4804 01  DFHEIV.
  4805   02  DFHEIV0               PIC X(35).
  4806   02  DFHEIV1               PIC X(08).
  4807   02  DFHEIV2               PIC X(08).
  4808   02  DFHEIV3               PIC X(08).
  4809   02  DFHEIV4               PIC X(06).
  4810   02  DFHEIV5               PIC X(04).
  4811   02  DFHEIV6               PIC X(04).
  4812   02  DFHEIV7               PIC X(02).
  4813   02  DFHEIV8               PIC X(02).
  4814   02  DFHEIV9               PIC X(01).
  4815   02  DFHEIV10              PIC S9(7) COMP-3.
  4816   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4817   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4818   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4819   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4820   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4821   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4822   02  DFHEIV17              PIC X(04).
  4823   02  DFHEIV18              PIC X(04).
  4824   02  DFHEIV19              PIC X(04).
  4825   02  DFHEIV20              USAGE IS POINTER.
  4826   02  DFHEIV21              USAGE IS POINTER.
  4827   02  DFHEIV22              USAGE IS POINTER.
  4828   02  DFHEIV23              USAGE IS POINTER.
  4829   02  DFHEIV24              USAGE IS POINTER.
  4830   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4831   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4832   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4833   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4834   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4835   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4836   02  FILLER                PIC X(02).
  4837   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4838   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4839   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4840   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4841   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4842 LINKAGE  SECTION.
  4843*****************************************************************
  4844*                                                               *
  4845* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4846* All rights reserved.                                          *
  4847*                                                               *
  4848*****************************************************************
  4849 01  dfheiblk.
  4850     02  eibtime          pic s9(7) comp-3.
  4851     02  eibdate          pic s9(7) comp-3.
  4852     02  eibtrnid         pic x(4).
  4853     02  eibtaskn         pic s9(7) comp-3.
  4854     02  eibtrmid         pic x(4).
  4855     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  91
* EL050.cbl
  4856     02  eibcposn         pic s9(4) comp.
  4857     02  eibcalen         pic s9(4) comp.
  4858     02  eibaid           pic x(1).
  4859     02  eibfiller1       pic x(1).
  4860     02  eibfn            pic x(2).
  4861     02  eibfiller2       pic x(2).
  4862     02  eibrcode         pic x(6).
  4863     02  eibfiller3       pic x(2).
  4864     02  eibds            pic x(8).
  4865     02  eibreqid         pic x(8).
  4866     02  eibrsrce         pic x(8).
  4867     02  eibsync          pic x(1).
  4868     02  eibfree          pic x(1).
  4869     02  eibrecv          pic x(1).
  4870     02  eibsend          pic x(1).
  4871     02  eibatt           pic x(1).
  4872     02  eibeoc           pic x(1).
  4873     02  eibfmh           pic x(1).
  4874     02  eibcompl         pic x(1).
  4875     02  eibsig           pic x(1).
  4876     02  eibconf          pic x(1).
  4877     02  eiberr           pic x(1).
  4878     02  eibrldbk         pic x(1).
  4879     02  eiberrcd         pic x(4).
  4880     02  eibsynrb         pic x(1).
  4881     02  eibnodat         pic x(1).
  4882     02  eibfiller5       pic x(2).
  4883     02  eibresp          pic 9(09) comp.
  4884     02  eibresp2         pic 9(09) comp.
  4885     02  dfheigdj         pic s9(4) comp.
  4886     02  dfheigdk         pic s9(4) comp.
  4887
  4888 01  DFHCOMMAREA                   PIC X(1036).
  4889
  4890*01 PARMLIST .
  4891*    02  FILLER                    PIC S9(8)   COMP.
  4892*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4893*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4894*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4895*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4896*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4897*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4898*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4899
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  92
* EL050.cbl
  4901*    COPY ELCCNTL.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ELCCNTL.                            *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.059                          *
  4908*                                                                *
  4909*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4910*                                                                *
  4911*   FILE TYPE = VSAM,KSDS                                        *
  4912*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4913*                                                                *
  4914*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4915*       ALTERNATE INDEX = NONE                                   *
  4916*                                                                *
  4917*   LOG = YES                                                    *
  4918*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4919******************************************************************
  4920*                   C H A N G E   L O G
  4921*
  4922* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4923*-----------------------------------------------------------------
  4924*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4925* EFFECTIVE    NUMBER
  4926*-----------------------------------------------------------------
  4927* 082503                   PEMA  ADD BENEFIT GROUP
  4928* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4929* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4930* 092705    2005050300006  PEMA  ADD SPP LEASES
  4931* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4932* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4933* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4934* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4935* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4936* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4937* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4938******************************************************************
  4939*
  4940 01  CONTROL-FILE.
  4941     12  CF-RECORD-ID                       PIC XX.
  4942         88  VALID-CF-ID                        VALUE 'CF'.
  4943
  4944     12  CF-CONTROL-PRIMARY.
  4945         16  CF-COMPANY-ID                  PIC XXX.
  4946         16  CF-RECORD-TYPE                 PIC X.
  4947             88  CF-COMPANY-MASTER              VALUE '1'.
  4948             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4949             88  CF-STATE-MASTER                VALUE '3'.
  4950             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4951             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4952             88  CF-CARRIER-MASTER              VALUE '6'.
  4953             88  CF-MORTALITY-MASTER            VALUE '7'.
  4954             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4955             88  CF-TERMINAL-MASTER             VALUE '9'.
  4956             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4957             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4958             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  93
* EL050.cbl
  4959             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4960             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4961             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4962             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4963             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4964             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4965         16  CF-ACCESS-CD-GENL              PIC X(4).
  4966         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4967             20  CF-PROCESSOR               PIC X(4).
  4968         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4969             20  CF-STATE-CODE              PIC XX.
  4970             20  FILLER                     PIC XX.
  4971         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4972             20  FILLER                     PIC XX.
  4973             20  CF-HI-BEN-IN-REC           PIC XX.
  4974         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4975             20  FILLER                     PIC XXX.
  4976             20  CF-CARRIER-CNTL            PIC X.
  4977         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4978             20  FILLER                     PIC XX.
  4979             20  CF-HI-TYPE-IN-REC          PIC 99.
  4980         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4981             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4982                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4983             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4984             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4985         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4986             20  FILLER                     PIC X.
  4987             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4988         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4989             20  FILLER                     PIC XX.
  4990             20  CF-MORTGAGE-PLAN           PIC XX.
  4991         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4992
  4993     12  CF-LAST-MAINT-DT                   PIC XX.
  4994     12  CF-LAST-MAINT-BY                   PIC X(4).
  4995     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4996
  4997     12  CF-RECORD-BODY                     PIC X(728).
  4998
  4999
  5000****************************************************************
  5001*             COMPANY MASTER RECORD                            *
  5002****************************************************************
  5003
  5004     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5005         16  CF-COMPANY-ADDRESS.
  5006             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5007             20  CF-CL-IN-CARE-OF           PIC X(30).
  5008             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5009             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5010             20  CF-CL-CITY-STATE           PIC X(30).
  5011             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5012             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5013         16  CF-COMPANY-CD                  PIC X.
  5014         16  CF-COMPANY-PASSWORD            PIC X(8).
  5015         16  CF-SECURITY-OPTION             PIC X.
  5016             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  94
* EL050.cbl
  5017             88  COMPANY-VERIFY                 VALUE '2'.
  5018             88  PROCESSOR-VERIFY               VALUE '3'.
  5019             88  NO-SECURITY                    VALUE '4'.
  5020             88  ALL-BUT-TERM                   VALUE '5'.
  5021         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5022             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5023         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5024             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5025         16  CF-INFORCE-LOCATION            PIC X.
  5026             88  CERTS-ARE-ONLINE               VALUE '1'.
  5027             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5028             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5029         16  CF-LOWER-CASE-LETTERS          PIC X.
  5030         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5031             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5032             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5033             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5034             88  CF-ACCNT-CNTL                  VALUE '3'.
  5035             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5036
  5037         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5038         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5039
  5040         16  CF-LGX-CREDIT-USER             PIC X.
  5041             88  CO-IS-NOT-USER                 VALUE 'N'.
  5042             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5043
  5044         16 CF-CREDIT-CALC-CODES.
  5045             20  CF-CR-REM-TERM-CALC PIC X.
  5046               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5047               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5048               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5049               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5050               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5051               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5052               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5053             20  CF-CR-R78-METHOD           PIC X.
  5054               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5055               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5056
  5057         16  CF-CLAIM-CONTROL-COUNTS.
  5058             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5059                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5060
  5061             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5062                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5063
  5064             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5065                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5066
  5067             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5068                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5069
  5070         16  CF-CURRENT-MONTH-END           PIC XX.
  5071
  5072         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5073             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5074             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  95
* EL050.cbl
  5075             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5076             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5077                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5078                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5079             20  CF-CO-PREM-REJECT-SW       PIC X.
  5080                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5081                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5082             20  CF-CO-REF-REJECT-SW        PIC X.
  5083                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5084                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5085
  5086         16  CF-CO-REPORTING-DT             PIC XX.
  5087         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5088         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5089           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5090           88  CF-CO-MONTH-END                  VALUE '1'.
  5091
  5092         16  CF-LGX-CLAIM-USER              PIC X.
  5093             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5094             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5095
  5096         16  CF-CREDIT-EDIT-CONTROLS.
  5097             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5098             20  CF-MIN-AGE                 PIC 99.
  5099             20  CF-DEFAULT-AGE             PIC 99.
  5100             20  CF-MIN-TERM                PIC S999      COMP-3.
  5101             20  CF-MAX-TERM                PIC S999      COMP-3.
  5102             20  CF-DEFAULT-SEX             PIC X.
  5103             20  CF-JOINT-AGE-INPUT         PIC X.
  5104                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5105             20  CF-BIRTH-DATE-INPUT        PIC X.
  5106                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5107             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5108                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5109                 88  CF-ZERO-CARRIER            VALUE '1'.
  5110                 88  CF-ZERO-GROUPING           VALUE '2'.
  5111                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5112             20  CF-EDIT-SW                 PIC X.
  5113                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5114             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5115             20  CF-CR-PR-METHOD            PIC X.
  5116               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5117               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5118             20  FILLER                     PIC X.
  5119
  5120         16  CF-CREDIT-MISC-CONTROLS.
  5121             20  CF-REIN-TABLE-SW           PIC X.
  5122                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5123             20  CF-COMP-TABLE-SW           PIC X.
  5124                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5125             20  CF-EXPERIENCE-RETENTION-AGE
  5126                                            PIC S9        COMP-3.
  5127             20  CF-CONVERSION-DT           PIC XX.
  5128             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5129             20  CF-RUN-FREQUENCY-SW        PIC X.
  5130                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5131                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5132
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  96
* EL050.cbl
  5133             20  CF-CR-CHECK-NO-CONTROL.
  5134                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5135                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5136                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5137                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5138                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5139                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5140
  5141                 24  CF-CR-CHECK-COUNT       REDEFINES
  5142                     CF-CR-CHECK-COUNTER      PIC X(4).
  5143
  5144                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5145                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5146
  5147                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5148                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5149                 24  CF-MAIL-PROCESSING       PIC X.
  5150                     88  MAIL-PROCESSING          VALUE 'Y'.
  5151
  5152         16  CF-MISC-SYSTEM-CONTROL.
  5153             20  CF-SYSTEM-C                 PIC X.
  5154                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5155             20  CF-SYSTEM-D                 PIC X.
  5156                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5157             20  CF-SOC-SEC-NO-SW            PIC X.
  5158                 88  SOC-SEC-NO-USED             VALUE '1'.
  5159             20  CF-MEMBER-NO-SW             PIC X.
  5160                 88  MEMBER-NO-USED              VALUE '1'.
  5161             20  CF-TAX-ID-NUMBER            PIC X(11).
  5162             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5163             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5164                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5165                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5166                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5167                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5168             20  CF-SYSTEM-E                 PIC X.
  5169                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5170
  5171         16  CF-LGX-LIFE-USER               PIC X.
  5172             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5173             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5174
  5175         16  CF-CR-MONTH-END-DT             PIC XX.
  5176
  5177         16  CF-FILE-MAINT-DATES.
  5178             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5179                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5180             20  CF-LAST-BATCH       REDEFINES
  5181                 CF-LAST-BATCH-NO               PIC X(4).
  5182             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5183             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5184             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5185             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5186             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5187             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5188             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5189             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5190             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  97
* EL050.cbl
  5191             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5192
  5193         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5194         16  FILLER                         PIC X.
  5195
  5196         16  CF-ALT-MORT-CODE               PIC X(4).
  5197         16  CF-MEMBER-CAPTION              PIC X(10).
  5198
  5199         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5200             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5201             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5202             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5203             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5204             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5205
  5206         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5207
  5208         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5209         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5210         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5211         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5212
  5213         16  CF-AH-OVERRIDE-L1              PIC X.
  5214         16  CF-AH-OVERRIDE-L2              PIC XX.
  5215         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5216         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5217
  5218         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5219         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5220
  5221         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5222         16  CF-AR-LAST-EL860-DT            PIC XX.
  5223         16  CF-MP-MONTH-END-DT             PIC XX.
  5224
  5225         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5226         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5227             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5228
  5229         16  CF-AR-MONTH-END-DT             PIC XX.
  5230
  5231         16  CF-CRDTCRD-USER                PIC X.
  5232             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5233             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5234
  5235         16  CF-CC-MONTH-END-DT             PIC XX.
  5236
  5237         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5238
  5239         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5240             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5241             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5242             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5243         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5244         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5245         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5246         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5247             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5248             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  98
* EL050.cbl
  5249         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5250         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5251         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5252             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5253         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5254
  5255         16  CF-CL-ZIP-CODE.
  5256             20  CF-CL-ZIP-PRIME.
  5257                 24  CF-CL-ZIP-1ST          PIC X.
  5258                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5259                 24  FILLER                 PIC X(4).
  5260             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5261         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5262             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5263             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5264             20  FILLER                     PIC XXX.
  5265
  5266         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5267         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5268         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5269         16  CF-CO-OPTION-START-DATE        PIC XX.
  5270         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5271           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5272                                                      '3' '4'.
  5273           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5274           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5275           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5276           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5277           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5278           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5279
  5280         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5281
  5282         16  CF-PAYMENT-APPROVAL-LEVELS.
  5283             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5284             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5285             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5286             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5287             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5288             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5289
  5290         16  CF-END-USER-REPORTING-USER     PIC X.
  5291             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5292             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5293
  5294         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5295             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5296             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5297
  5298         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5299
  5300         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5301         16  FILLER                         PIC X.
  5302
  5303         16  CF-CREDIT-ARCHIVE-CNTL.
  5304             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5305             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5306             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page  99
* EL050.cbl
  5307
  5308         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5309
  5310         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5311             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5312             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5313
  5314         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5315             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5316             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5317
  5318         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5319
  5320         16  CF-CO-ACH-ID-CODE              PIC  X.
  5321             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5322             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5323             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5324         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5325         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5326         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5327         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5328         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5329         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5330         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5331         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5332         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5333                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5334         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5335                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5336
  5337         16  CF-CO-OVER-SHORT.
  5338             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5339             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5340
  5341*         16  FILLER                         PIC X(102).
  5342         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5343             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5344             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5345
  5346         16  CF-AH-APPROVAL-DAYS.
  5347             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5348             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5349             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5350             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5351
  5352         16  FILLER                         PIC X(82).
  5353****************************************************************
  5354*             PROCESSOR/USER RECORD                            *
  5355****************************************************************
  5356
  5357     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5358         16  CF-PROCESSOR-NAME              PIC X(30).
  5359         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5360         16  CF-PROCESSOR-TITLE             PIC X(26).
  5361         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5362                 88  MESSAGE-YES                VALUE 'Y'.
  5363                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5364
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 100
* EL050.cbl
  5365*****************************************************
  5366****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5367****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5368****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5369****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5370*****************************************************
  5371
  5372         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5373             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5374             20  CF-APPLICATION-FORCE       PIC X.
  5375             20  CF-INDIVIDUAL-APP.
  5376                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5377                     28  CF-BROWSE-APP      PIC X.
  5378                     28  CF-UPDATE-APP      PIC X.
  5379
  5380         16  CF-CURRENT-TERM-ON             PIC X(4).
  5381         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5382             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5383             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5384             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5385             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5386             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5387             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5388             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5389         16  CF-PROCESSOR-CARRIER           PIC X.
  5390             88  NO-CARRIER-SECURITY            VALUE ' '.
  5391         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5392             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5393         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5394             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5395         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5396             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5397
  5398         16  CF-PROC-SYS-ACCESS-SW.
  5399             20  CF-PROC-CREDIT-CLAIMS-SW.
  5400                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5401                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5402                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5403                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5404             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5405                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5406                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5407             20  CF-PROC-LIFE-GNRLDGR-SW.
  5408                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5409                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5410                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5411                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5412             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5413                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5414                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5415         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5416             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5417             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5418         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5419
  5420         16  CF-APPROVAL-LEVEL                  PIC X.
  5421             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5422             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 101
* EL050.cbl
  5423             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5424             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5425
  5426         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5427
  5428         16  CF-LANGUAGE-TYPE                   PIC X.
  5429             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5430             88  CF-LANG-IS-FR                      VALUE 'F'.
  5431
  5432         16  CF-CSR-IND                         PIC X.
  5433         16  FILLER                             PIC X(239).
  5434
  5435****************************************************************
  5436*             PROCESSOR/REMINDERS RECORD                       *
  5437****************************************************************
  5438
  5439     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5440         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5441             20  CF-START-REMIND-DT         PIC XX.
  5442             20  CF-END-REMIND-DT           PIC XX.
  5443             20  CF-REMINDER-TEXT           PIC X(50).
  5444         16  FILLER                         PIC X(296).
  5445
  5446
  5447****************************************************************
  5448*             STATE MASTER RECORD                              *
  5449****************************************************************
  5450
  5451     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5452         16  CF-STATE-ABBREVIATION          PIC XX.
  5453         16  CF-STATE-NAME                  PIC X(25).
  5454         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5455         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5456             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5457             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5458             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5459             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5460                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5461                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5462             20  CF-ST-PREM-REJECT-SW       PIC X.
  5463                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5464                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5465             20  CF-ST-REF-REJECT-SW        PIC X.
  5466                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5467                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5468         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5469         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5470         16  CF-ST-REFUND-RULES.
  5471             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5472             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5473             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5474         16  CF-ST-FST-PMT-EXTENSION.
  5475             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5476             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5477                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5478                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5479                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5480                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 102
* EL050.cbl
  5481         16  CF-ST-STATE-CALL.
  5482             20  CF-ST-CALL-UNEARNED        PIC X.
  5483             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5484             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5485         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5486             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5487             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5488         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5489         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5490         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5491         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5492         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5493         16  FILLER                         PIC X.
  5494         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5495             20  CF-ST-BENEFIT-CD           PIC XX.
  5496             20  CF-ST-BENEFIT-KIND         PIC X.
  5497                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5498                 88  CF-ST-AH-KIND              VALUE 'A'.
  5499             20  CF-ST-REM-TERM-CALC        PIC X.
  5500                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5501                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5502                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5503                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5504                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5505                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5506                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5507                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5508
  5509             20  CF-ST-REFUND-CALC          PIC X.
  5510                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5511                 88  ST-REFD-BY-R78             VALUE '1'.
  5512                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5513                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5514                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5515                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5516                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5517                 88  ST-REFD-UTAH               VALUE '7'.
  5518                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5519                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5520                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5521
  5522             20  CF-ST-EARNING-CALC         PIC X.
  5523                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5524                 88  ST-EARN-BY-R78             VALUE '1'.
  5525                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5526                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5527                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5528                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5529                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5530                 88  ST-EARN-MEAN               VALUE '8'.
  5531                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5532
  5533             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5534                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5535                 88  ST-OVRD-BY-R78             VALUE '1'.
  5536                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5537                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5538                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 103
* EL050.cbl
  5539                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5540                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5541                 88  ST-OVRD-MEAN               VALUE '8'.
  5542                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5543             20  FILLER                     PIC X.
  5544
  5545         16  CF-ST-COMMISSION-CAPS.
  5546             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5547             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5548             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5549             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5550         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5551                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5552
  5553         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5554
  5555         16  CF-ST-STATUTORY-INTEREST.
  5556             20  CF-ST-STAT-DATE-FROM       PIC X.
  5557                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5558                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5559             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5560             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5561             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5562             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5563             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5564
  5565         16  CF-ST-OVER-SHORT.
  5566             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5567             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5568
  5569         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5570
  5571         16  CF-ST-RT-CALC                  PIC X.
  5572
  5573         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5574         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5575         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5576         16  CF-ST-RF-LR-CALC               PIC X.
  5577         16  CF-ST-RF-LL-CALC               PIC X.
  5578         16  CF-ST-RF-LN-CALC               PIC X.
  5579         16  CF-ST-RF-AH-CALC               PIC X.
  5580         16  CF-ST-RF-CP-CALC               PIC X.
  5581*        16  FILLER                         PIC X(206).
  5582*CIDMOD         16  FILLER                         PIC X(192).
  5583         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5584             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5585         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5586         16  CF-ST-VFY-2ND-BENE             PIC X.
  5587         16  CF-ST-CAUSAL-STATE             PIC X.
  5588         16  FILLER                         PIC X(185).
  5589
  5590****************************************************************
  5591*             BENEFIT MASTER RECORD                            *
  5592****************************************************************
  5593
  5594     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5595         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5596             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 104
* EL050.cbl
  5597             20  CF-BENEFIT-NUMERIC  REDEFINES
  5598                 CF-BENEFIT-CODE            PIC XX.
  5599             20  CF-BENEFIT-ALPHA           PIC XXX.
  5600             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5601             20  CF-BENEFIT-COMMENT         PIC X(10).
  5602
  5603             20  CF-LF-COVERAGE-TYPE        PIC X.
  5604                 88  CF-REDUCING                VALUE 'R'.
  5605                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5606
  5607             20  CF-SPECIAL-CALC-CD         PIC X.
  5608                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5609                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5610                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5611                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5612                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5613                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5614                 88  CF-FARM-PLAN               VALUE 'F'.
  5615                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5616                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5617                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5618                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5619                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5620                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5621                 88  CF-PRUDENTIAL              VALUE 'P'.
  5622                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5623                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5624                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5625                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5626                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5627                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5628
  5629             20  CF-JOINT-INDICATOR         PIC X.
  5630                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5631
  5632*            20  FILLER                     PIC X(12).
  5633             20  FILLER                     PIC X(11).
  5634             20  CF-BENEFIT-CATEGORY        PIC X.
  5635             20  CF-LOAN-TYPE               PIC X(8).
  5636
  5637             20  CF-CO-REM-TERM-CALC        PIC X.
  5638                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5639                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5640                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5641                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5642                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5643
  5644             20  CF-CO-EARNINGS-CALC        PIC X.
  5645                 88  CO-EARN-BY-R78             VALUE '1'.
  5646                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5647                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5648                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5649                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5650                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5651                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5652                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5653
  5654             20  CF-CO-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 105
* EL050.cbl
  5655                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5656                 88  CO-REFD-BY-R78             VALUE '1'.
  5657                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5658                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5659                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5660                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5661                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5662                 88  CO-REFD-MEAN               VALUE '8'.
  5663                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5664                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5665                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5666
  5667             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5668                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5669                 88  CO-OVRD-BY-R78             VALUE '1'.
  5670                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5671                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5672                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5673                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5674                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5675                 88  CO-OVRD-MEAN               VALUE '8'.
  5676                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5677
  5678             20  CF-CO-BEN-I-G-CD           PIC X.
  5679                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5680                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5681                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5682
  5683         16  FILLER                         PIC X(304).
  5684
  5685
  5686****************************************************************
  5687*             CARRIER MASTER RECORD                            *
  5688****************************************************************
  5689
  5690     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5691         16  CF-ADDRESS-DATA.
  5692             20  CF-MAIL-TO-NAME            PIC X(30).
  5693             20  CF-IN-CARE-OF              PIC X(30).
  5694             20  CF-ADDRESS-LINE-1          PIC X(30).
  5695             20  CF-ADDRESS-LINE-2          PIC X(30).
  5696             20  CF-CITY-STATE              PIC X(30).
  5697             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5698             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5699
  5700         16  CF-CLAIM-NO-CONTROL.
  5701             20  CF-CLAIM-NO-METHOD         PIC X.
  5702                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5703                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5704                 88  CLAIM-NO-SEQ               VALUE '3'.
  5705                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5706             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5707                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5708                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5709                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5710
  5711         16  CF-CHECK-NO-CONTROL.
  5712             20  CF-CHECK-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 106
* EL050.cbl
  5713                 88  CHECK-NO-MANUAL            VALUE '1'.
  5714                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5715                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5716                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5717             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5718                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5719
  5720         16  CF-DOMICILE-STATE              PIC XX.
  5721
  5722         16  CF-EXPENSE-CONTROLS.
  5723             20  CF-EXPENSE-METHOD          PIC X.
  5724                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5725                 88  DOLLARS-PER-PMT            VALUE '2'.
  5726                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5727                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5728             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5729             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5730
  5731         16  CF-CORRESPONDENCE-CONTROL.
  5732             20  CF-LETTER-RESEND-OPT       PIC X.
  5733                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5734                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5735             20  FILLER                     PIC X(4).
  5736
  5737         16  CF-RESERVE-CONTROLS.
  5738             20  CF-MANUAL-SW               PIC X.
  5739                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5740             20  CF-FUTURE-SW               PIC X.
  5741                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5742             20  CF-PTC-SW                  PIC X.
  5743                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5744             20  CF-IBNR-SW                 PIC X.
  5745                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5746             20  CF-PTC-LF-SW               PIC X.
  5747                 88  CF-LF-PTC-USED             VALUE '1'.
  5748             20  CF-CDT-ACCESS-METHOD       PIC X.
  5749                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5750                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5751                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5752             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5753
  5754         16  CF-CLAIM-CALC-METHOD           PIC X.
  5755             88  360-PLUS-MONTHS                VALUE '1'.
  5756             88  365-PLUS-MONTHS                VALUE '2'.
  5757             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5758             88  360-DAILY                      VALUE '4'.
  5759             88  365-DAILY                      VALUE '5'.
  5760
  5761         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5762         16  FILLER                         PIC X(11).
  5763
  5764         16  CF-LIMIT-AMOUNTS.
  5765             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5766             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5767             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5768             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5769             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5770             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 107
* EL050.cbl
  5771             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5772             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5773             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5774             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5775
  5776         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5777         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5778         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5779
  5780         16  CF-ZIP-CODE.
  5781             20  CF-ZIP-PRIME.
  5782                 24  CF-ZIP-1ST             PIC X.
  5783                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5784                 24  FILLER                 PIC X(4).
  5785             20  CF-ZIP-PLUS4               PIC X(4).
  5786         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5787             20  CF-CAN-POSTAL-1            PIC XXX.
  5788             20  CF-CAN-POSTAL-2            PIC XXX.
  5789             20  FILLER                     PIC XXX.
  5790
  5791         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5792         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5793         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5794
  5795         16  CF-RATING-SWITCH               PIC X.
  5796             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5797             88  CF-NO-RATING                   VALUE 'N'.
  5798
  5799         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5800
  5801         16  CF-CARRIER-OVER-SHORT.
  5802             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5803             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5804
  5805         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5806         16  CF-SECPAY-SWITCH               PIC X.
  5807             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5808             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5809         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5810         16  FILLER                         PIC X(448).
  5811*        16  FILLER                         PIC X(452).
  5812
  5813
  5814****************************************************************
  5815*             MORTALITY MASTER RECORD                          *
  5816****************************************************************
  5817
  5818     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5819         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5820                                INDEXED BY CF-MORT-NDX.
  5821             20  CF-MORT-TABLE              PIC X(5).
  5822             20  CF-MORT-TABLE-TYPE         PIC X.
  5823                 88  CF-MORT-JOINT              VALUE 'J'.
  5824                 88  CF-MORT-SINGLE             VALUE 'S'.
  5825                 88  CF-MORT-COMBINED           VALUE 'C'.
  5826                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5827                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5828             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 108
* EL050.cbl
  5829             20  CF-MORT-AGE-METHOD         PIC XX.
  5830                 88  CF-AGE-LAST                VALUE 'AL'.
  5831                 88  CF-AGE-NEAR                VALUE 'AN'.
  5832             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5833             20  CF-MORT-ADJUSTMENT-DIRECTION
  5834                                            PIC X.
  5835                 88  CF-MINUS                   VALUE '-'.
  5836                 88  CF-PLUS                    VALUE '+'.
  5837             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5838             20  CF-MORT-JOINT-CODE         PIC X.
  5839                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5840             20  CF-MORT-PC-Q               PIC X.
  5841                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5842             20  CF-MORT-TABLE-CODE         PIC X(4).
  5843             20  CF-MORT-COMMENTS           PIC X(15).
  5844             20  FILLER                     PIC X(14).
  5845
  5846         16  FILLER                         PIC X(251).
  5847
  5848
  5849****************************************************************
  5850*             BUSSINESS TYPE MASTER RECORD                     *
  5851****************************************************************
  5852
  5853     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5854* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5855* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5856* AND RECORD 05 IS TYPES 81-99
  5857         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5858             20  CF-BUSINESS-TITLE          PIC  X(19).
  5859             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5860                                            PIC S9V9(4) COMP-3.
  5861             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5862             20  FILLER                     PIC  X.
  5863         16  FILLER                         PIC  X(248).
  5864
  5865
  5866****************************************************************
  5867*             TERMINAL MASTER RECORD                           *
  5868****************************************************************
  5869
  5870     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5871
  5872         16  CF-COMPANY-TERMINALS.
  5873             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5874                                  PIC X(4).
  5875         16  FILLER               PIC X(248).
  5876
  5877
  5878****************************************************************
  5879*             LIFE EDIT MASTER RECORD                          *
  5880****************************************************************
  5881
  5882     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5883         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5884             20  CF-LIFE-CODE-IN            PIC XX.
  5885             20  CF-LIFE-CODE-OUT           PIC XX.
  5886         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 109
* EL050.cbl
  5887
  5888
  5889****************************************************************
  5890*             AH EDIT MASTER RECORD                            *
  5891****************************************************************
  5892
  5893     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5894         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5895             20  CF-AH-CODE-IN              PIC XXX.
  5896             20  CF-AH-CODE-OUT             PIC XX.
  5897         16  FILLER                         PIC X(248).
  5898
  5899
  5900****************************************************************
  5901*             CREDIBILITY TABLES                               *
  5902****************************************************************
  5903
  5904     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5905         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5906                             INDEXED BY CF-CRDB-NDX.
  5907             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5908             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5909             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5910         16  FILLER                         PIC  X(332).
  5911
  5912
  5913****************************************************************
  5914*             REPORT CUSTOMIZATION RECORD                      *
  5915****************************************************************
  5916
  5917     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5918         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5919             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5920             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5921             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5922**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5923****       A T-TRANSFER.                                   ****
  5924             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5925
  5926         16  FILLER                         PIC XX.
  5927
  5928         16  CF-CARRIER-CNTL-OPT.
  5929             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5930                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5931                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5932             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5933                                            PIC X.
  5934         16  CF-GROUP-CNTL-OPT.
  5935             20  CF-GROUP-OPT-SEQ           PIC 9.
  5936                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5937                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5938             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5939                                            PIC X(6).
  5940         16  CF-STATE-CNTL-OPT.
  5941             20  CF-STATE-OPT-SEQ           PIC 9.
  5942                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5943                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5944             20  CF-STATE-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 110
* EL050.cbl
  5945                                            PIC XX.
  5946         16  CF-ACCOUNT-CNTL-OPT.
  5947             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5948                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5949                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5950             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5951                                            PIC X(10).
  5952         16  CF-BUS-TYP-CNTL-OPT.
  5953             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5954                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5955                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5956             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5957                                            PIC XX.
  5958         16  CF-LF-TYP-CNTL-OPT.
  5959             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5960                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5961                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5962             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5963                                            PIC XX.
  5964         16  CF-AH-TYP-CNTL-OPT.
  5965             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5966                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5967                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5968             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5969                                            PIC XX.
  5970         16  CF-REPTCD1-CNTL-OPT.
  5971             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5972                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5973                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5974             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5975                                            PIC X(10).
  5976         16  CF-REPTCD2-CNTL-OPT.
  5977             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5978                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5979                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5980             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5981                                            PIC X(10).
  5982         16  CF-USER1-CNTL-OPT.
  5983             20  CF-USER1-OPT-SEQ           PIC 9.
  5984                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5985                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5986             20  CF-USER1-SELECT OCCURS 3 TIMES
  5987                                            PIC X(10).
  5988         16  CF-USER2-CNTL-OPT.
  5989             20  CF-USER2-OPT-SEQ           PIC 9.
  5990                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5991                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5992             20  CF-USER2-SELECT OCCURS 3 TIMES
  5993                                            PIC X(10).
  5994         16  CF-USER3-CNTL-OPT.
  5995             20  CF-USER3-OPT-SEQ           PIC 9.
  5996                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5997                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5998             20  CF-USER3-SELECT OCCURS 3 TIMES
  5999                                            PIC X(10).
  6000         16  CF-USER4-CNTL-OPT.
  6001             20  CF-USER4-OPT-SEQ           PIC 9.
  6002                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 111
* EL050.cbl
  6003                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6004             20  CF-USER4-SELECT OCCURS 3 TIMES
  6005                                            PIC X(10).
  6006         16  CF-USER5-CNTL-OPT.
  6007             20  CF-USER5-OPT-SEQ           PIC 9.
  6008                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6009                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6010             20  CF-USER5-SELECT OCCURS 3 TIMES
  6011                                            PIC X(10).
  6012         16  CF-REINS-CNTL-OPT.
  6013             20  CF-REINS-OPT-SEQ           PIC 9.
  6014                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6015                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6016             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6017                 24  CF-REINS-PRIME         PIC XXX.
  6018                 24  CF-REINS-SUB           PIC XXX.
  6019
  6020         16  CF-AGENT-CNTL-OPT.
  6021             20  CF-AGENT-OPT-SEQ           PIC 9.
  6022                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6023                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6024             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6025                                            PIC X(10).
  6026
  6027         16  FILLER                         PIC X(43).
  6028
  6029         16  CF-LOSS-RATIO-SELECT.
  6030             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6031             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6032         16  CF-ENTRY-DATE-SELECT.
  6033             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6034             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6035         16  CF-EFFECTIVE-DATE-SELECT.
  6036             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6037             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6038
  6039         16  CF-EXCEPTION-LIST-IND          PIC X.
  6040             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6041
  6042         16  FILLER                         PIC X(318).
  6043
  6044****************************************************************
  6045*                  EXCEPTION REPORTING RECORD                  *
  6046****************************************************************
  6047
  6048     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6049         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6050             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6051
  6052         16  CF-COMBINED-LIFE-AH-OPT.
  6053             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6054             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6055             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6056             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6057
  6058         16  CF-LIFE-OPT.
  6059             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6060             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 112
* EL050.cbl
  6061             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6062             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6063             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6064             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6065             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6066             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6067             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6068             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6069
  6070         16  CF-AH-OPT.
  6071             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6072             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6073             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6074             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6075             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6076             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6077             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6078             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6079             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6080             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6081
  6082         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6083             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6084             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6085             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6086
  6087         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6088
  6089         16  FILLER                         PIC X(673).
  6090
  6091
  6092****************************************************************
  6093*             MORTGAGE SYSTEM PLAN RECORD                      *
  6094****************************************************************
  6095
  6096     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6097         16  CF-PLAN-TYPE                   PIC X.
  6098             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6099             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6100             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6101         16  CF-PLAN-ABBREV                 PIC XXX.
  6102         16  CF-PLAN-DESCRIPT               PIC X(10).
  6103         16  CF-PLAN-NOTES                  PIC X(20).
  6104         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6105         16  CF-PLAN-UNDERWRITING.
  6106             20  CF-PLAN-TERM-DATA.
  6107                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6108                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6109             20  CF-PLAN-AGE-DATA.
  6110                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6111                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6112                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6113             20  CF-PLAN-BENEFIT-DATA.
  6114                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6115                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6116                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6117                                            PIC S9(7)V99  COMP-3.
  6118         16  CF-PLAN-POLICY-FORMS.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 113
* EL050.cbl
  6119             20  CF-POLICY-FORM             PIC X(12).
  6120             20  CF-MASTER-APPLICATION      PIC X(12).
  6121             20  CF-MASTER-POLICY           PIC X(12).
  6122         16  CF-PLAN-RATING.
  6123             20  CF-RATE-CODE               PIC X(5).
  6124             20  CF-SEX-RATING              PIC X.
  6125                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6126                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6127             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6128             20  CF-SUB-STD-TYPE            PIC X.
  6129                 88  CF-PCT-OF-PREM            VALUE '1'.
  6130                 88  CF-PCT-OF-BENE            VALUE '2'.
  6131         16  CF-PLAN-PREM-TOLERANCES.
  6132             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6133             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6134         16  CF-PLAN-PYMT-TOLERANCES.
  6135             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6136             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6137         16  CF-PLAN-MISC-DATA.
  6138             20  FILLER                     PIC X.
  6139             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6140             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6141         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6142         16  CF-PLAN-IND-GRP                PIC X.
  6143             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6144                                                     '1'.
  6145             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6146                                                     '2'.
  6147         16  CF-MIB-SEARCH-SW               PIC X.
  6148             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6149             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6150             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6151             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6152         16  CF-ALPHA-SEARCH-SW             PIC X.
  6153             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6154             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6155             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6156             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6157             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6158             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6159             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6160             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6161             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6162             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6163                                                     'A' 'B' 'C'
  6164                                                     'X' 'Y' 'Z'.
  6165         16  CF-EFF-DT-RULE-SW              PIC X.
  6166             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6167             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6168             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6169             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6170             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6171         16  FILLER                         PIC X(4).
  6172         16  CF-HEALTH-QUESTIONS            PIC X.
  6173             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6174         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6175         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6176         16  CF-PLAN-SNGL-JNT               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 114
* EL050.cbl
  6177             88  CF-COMBINED-PLAN              VALUE 'C'.
  6178             88  CF-JNT-PLAN                   VALUE 'J'.
  6179             88  CF-SNGL-PLAN                  VALUE 'S'.
  6180         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6181         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6182         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6183         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6184         16  CF-RERATE-CNTL                 PIC  X.
  6185             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6186             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6187             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6188             88  CF-AUTO-RECALC                 VALUE '4'.
  6189         16  CF-BENEFIT-TYPE                PIC  X.
  6190             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6191             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6192         16  CF-POLICY-FEE                  PIC S999V99
  6193                                                    COMP-3.
  6194         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6195         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6196         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6197         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6198         16  FILLER                         PIC  X(32).
  6199         16  CF-TERMINATION-FORM            PIC  X(04).
  6200         16  FILLER                         PIC  X(08).
  6201         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6202                                                       COMP-3.
  6203         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6204         16  CF-ISSUE-LETTER                PIC  X(4).
  6205         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6206         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6207             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6208             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6209         16  CF-MP-REFUND-CALC              PIC X.
  6210             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6211             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6212             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6213             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6214             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6215             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6216             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6217             88  CF-MP-REFD-MEAN                VALUE '8'.
  6218         16  CF-ALT-RATE-CODE               PIC  X(5).
  6219
  6220
  6221         16  FILLER                         PIC X(498).
  6222****************************************************************
  6223*             MORTGAGE COMPANY MASTER RECORD                   *
  6224****************************************************************
  6225
  6226     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6227         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6228         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6229             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6230             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6231             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6232             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6233             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6234
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 115
* EL050.cbl
  6235         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6236         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6237         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6238         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6239         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6240
  6241         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6242             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6243         16  CF-MP-RECON-USE-IND            PIC X(1).
  6244             88  CF-MP-USE-RECON             VALUE 'Y'.
  6245         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6246             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6247         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6248             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6249             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6250         16  FILLER                         PIC X(1).
  6251         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6252             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6253         16  CF-MORTG-MIB-VERSION           PIC X.
  6254             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6255             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6256             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6257         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6258             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6259                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6260             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6261                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6262             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6263                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6264             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6265                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6266             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6267                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6268             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6269                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6270         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6271         16  FILLER                         PIC X(7).
  6272         16  CF-MORTG-DESTINATION-SYMBOL.
  6273             20  CF-MORTG-MIB-COMM          PIC X(5).
  6274             20  CF-MORTG-MIB-TERM          PIC X(5).
  6275         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6276             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6277         16  FILLER                         PIC X(03).
  6278         16  CF-MP-CHECK-NO-CONTROL.
  6279             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6280                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6281                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6282                                                ' ' LOW-VALUES.
  6283                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6284                                               VALUE '3'.
  6285         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6286         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6287         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6288             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6289                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6290             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6291                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6292             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 116
* EL050.cbl
  6293                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6294             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6295                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6296             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6297                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6298             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6299                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6300         16  CF-MORTG-BILLING-AREA.
  6301             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6302                                            PIC X.
  6303         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6304         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6305         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6306         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6307             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6308             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6309         16  FILLER                         PIC X.
  6310         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6311             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6312             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6313         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6314         16  FILLER                         PIC X(8).
  6315         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6316         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6317         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6318         16  CF-ACH-COMPANY-ID.
  6319             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6320                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6321                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6322                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6323             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6324         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6325             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6326         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6327             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6328             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6329         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6330         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6331         16  FILLER                         PIC X(536).
  6332
  6333****************************************************************
  6334*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6335****************************************************************
  6336
  6337     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6338         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6339             20  CF-FEMALE-HEIGHT.
  6340                 24  CF-FEMALE-FT           PIC 99.
  6341                 24  CF-FEMALE-IN           PIC 99.
  6342             20  CF-FEMALE-MIN-WT           PIC 999.
  6343             20  CF-FEMALE-MAX-WT           PIC 999.
  6344         16  FILLER                         PIC X(428).
  6345
  6346     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6347         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6348             20  CF-MALE-HEIGHT.
  6349                 24  CF-MALE-FT             PIC 99.
  6350                 24  CF-MALE-IN             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 117
* EL050.cbl
  6351             20  CF-MALE-MIN-WT             PIC 999.
  6352             20  CF-MALE-MAX-WT             PIC 999.
  6353         16  FILLER                         PIC X(428).
  6354******************************************************************
  6355*             AUTOMATIC ACTIVITY RECORD                          *
  6356******************************************************************
  6357     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6358         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6359             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6360             20  CF-SYS-LETTER-ID           PIC X(04).
  6361             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6362             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6363             20  CF-SYS-RESET-SW            PIC X(01).
  6364             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6365             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6366
  6367         16  FILLER                         PIC X(50).
  6368
  6369         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6370             20  CF-USER-ACTIVE-SW          PIC X(01).
  6371             20  CF-USER-LETTER-ID          PIC X(04).
  6372             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6373             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6374             20  CF-USER-RESET-SW           PIC X(01).
  6375             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6376             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6377             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6378
  6379         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 118
* EL050.cbl
  6381*    COPY ERCACCT.
  6382******************************************************************
  6383*                                                                *
  6384*                                                                *
  6385*                            ERCACCT                             *
  6386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6387*                            VMOD=2.031                          *
  6388*                                                                *
  6389*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6390*                                                                *
  6391*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6392*   VSAM ACCOUNT MASTER FILES.                                   *
  6393*                                                                *
  6394*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6395*                                                                *
  6396*   FILE TYPE = VSAM,KSDS                                        *
  6397*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6398*                                                                *
  6399*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6400*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6401*                                                                *
  6402*   LOG = NO                                                     *
  6403*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6404*                                                                *
  6405*                                                                *
  6406******************************************************************
  6407*                   C H A N G E   L O G
  6408*
  6409* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6410*-----------------------------------------------------------------
  6411*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6412* EFFECTIVE    NUMBER
  6413*-----------------------------------------------------------------
  6414* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6415* 092705    2005050300006  PEMA  ADD SPP LEASES
  6416* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6417* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6418* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6419* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6420* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6421******************************************************************
  6422
  6423 01  ACCOUNT-MASTER.
  6424     12  AM-RECORD-ID                      PIC XX.
  6425         88  VALID-AM-ID                      VALUE 'AM'.
  6426
  6427     12  AM-CONTROL-PRIMARY.
  6428         16  AM-COMPANY-CD                 PIC X.
  6429         16  AM-MSTR-CNTRL.
  6430             20  AM-CONTROL-A.
  6431                 24  AM-CARRIER            PIC X.
  6432                 24  AM-GROUPING.
  6433                     28 AM-GROUPING-PREFIX PIC XXX.
  6434                     28 AM-GROUPING-PRIME  PIC XXX.
  6435                 24  AM-STATE              PIC XX.
  6436                 24  AM-ACCOUNT.
  6437                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6438                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 119
* EL050.cbl
  6439             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6440                                           PIC X(19).
  6441             20  AM-CNTRL-B.
  6442                 24  AM-EXPIRATION-DT      PIC XX.
  6443                 24  FILLER                PIC X(4).
  6444             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6445                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6446
  6447     12  AM-CONTROL-BY-VAR-GRP.
  6448         16  AM-COMPANY-CD-A1              PIC X.
  6449         16  AM-VG-CARRIER                 PIC X.
  6450         16  AM-VG-GROUPING                PIC X(6).
  6451         16  AM-VG-STATE                   PIC XX.
  6452         16  AM-VG-ACCOUNT                 PIC X(10).
  6453         16  AM-VG-DATE.
  6454             20  AM-VG-EXPIRATION-DT       PIC XX.
  6455             20  FILLER                    PIC X(4).
  6456         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6457                                           PIC 9(11)      COMP-3.
  6458     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6459         16  FILLER                        PIC X(10).
  6460         16  AM-VG-KEY3.
  6461             20  AM-VG3-ACCOUNT            PIC X(10).
  6462             20  AM-VG3-EXP-DT             PIC XX.
  6463         16  FILLER                        PIC X(4).
  6464     12  AM-MAINT-INFORMATION.
  6465         16  AM-LAST-MAINT-DT              PIC XX.
  6466         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6467         16  AM-LAST-MAINT-USER            PIC X(4).
  6468         16  FILLER                        PIC XX.
  6469
  6470     12  AM-EFFECTIVE-DT                   PIC XX.
  6471     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6472
  6473     12  AM-PREV-DATES  COMP-3.
  6474         16  AM-PREV-EXP-DT                PIC 9(11).
  6475         16  AM-PREV-EFF-DT                PIC 9(11).
  6476
  6477     12  AM-REPORT-CODE-1                  PIC X(10).
  6478     12  AM-REPORT-CODE-2                  PIC X(10).
  6479
  6480     12  AM-CITY-CODE                      PIC X(4).
  6481     12  AM-COUNTY-PARISH                  PIC X(6).
  6482
  6483     12  AM-NAME                           PIC X(30).
  6484     12  AM-PERSON                         PIC X(30).
  6485     12  AM-ADDRS                          PIC X(30).
  6486     12  AM-CITY.
  6487         16  AM-ADDR-CITY                  PIC X(28).
  6488         16  AM-ADDR-STATE                 PIC XX.
  6489     12  AM-ZIP.
  6490         16  AM-ZIP-PRIME.
  6491             20  AM-ZIP-PRI-1ST            PIC X.
  6492                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6493             20  FILLER                    PIC X(4).
  6494         16  AM-ZIP-PLUS4                  PIC X(4).
  6495     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6496         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 120
* EL050.cbl
  6497         16  AM-CAN-POSTAL-2               PIC XXX.
  6498         16  FILLER                        PIC XXX.
  6499     12  AM-TEL-NO.
  6500         16  AM-AREA-CODE                  PIC 999.
  6501         16  AM-TEL-PRE                    PIC 999.
  6502         16  AM-TEL-NBR                    PIC 9(4).
  6503     12  AM-TEL-LOC                        PIC X.
  6504         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6505         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6506
  6507     12  AM-COMM-STRUCTURE.
  6508         16  AM-DEFN-1.
  6509             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6510                 24  AM-AGT.
  6511                     28  AM-AGT-PREFIX     PIC X(4).
  6512                     28  AM-AGT-PRIME      PIC X(6).
  6513                 24  AM-COM-TYP            PIC X.
  6514                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6515                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6516                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6517                 24  AM-RECALC-LV-INDIC    PIC X.
  6518                 24  AM-RETRO-LV-INDIC     PIC X.
  6519                 24  AM-GL-CODES           PIC X.
  6520                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6521                 24  FILLER                PIC X(01).
  6522         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6523             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6524                 24  FILLER                PIC X(11).
  6525                 24  AM-L-COMA             PIC XXX.
  6526                 24  AM-J-COMA             PIC XXX.
  6527                 24  AM-A-COMA             PIC XXX.
  6528                 24  FILLER                PIC X(6).
  6529
  6530     12  AM-COMM-CHANGE-STATUS             PIC X.
  6531         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6532
  6533     12  AM-CSR-CODE                       PIC X(4).
  6534
  6535     12  AM-BILLING-STATUS                 PIC X.
  6536         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6537         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6538     12  AM-AUTO-REFUND-SW                 PIC X.
  6539         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6540         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6541     12  AM-GPCD                           PIC 99.
  6542     12  AM-IG                             PIC X.
  6543         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6544         88  AM-HAS-GROUP                     VALUE '2'.
  6545     12  AM-STATUS                         PIC X.
  6546         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6547         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6548         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6549         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6550         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6551         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6552     12  AM-REMIT-TO                       PIC 99.
  6553     12  AM-ID-NO                          PIC X(11).
  6554
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 121
* EL050.cbl
  6555     12  AM-CAL-TABLE                      PIC XX.
  6556     12  AM-LF-DEVIATION                   PIC XXX.
  6557     12  AM-AH-DEVIATION                   PIC XXX.
  6558     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6559     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6560     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6561     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6562     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6563     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6564
  6565     12  AM-USER-FIELDS.
  6566         16  AM-FLD-1                      PIC XX.
  6567         16  AM-FLD-2                      PIC XX.
  6568         16  AM-FLD-3                      PIC XX.
  6569         16  AM-FLD-4                      PIC XX.
  6570         16  AM-FLD-5                      PIC XX.
  6571
  6572     12  AM-1ST-PROD-DATE.
  6573         16  AM-1ST-PROD-YR                PIC XX.
  6574         16  AM-1ST-PROD-MO                PIC XX.
  6575         16  AM-1ST-PROD-DA                PIC XX.
  6576     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6577     12  AM-CERTS-PURGED-DATE.
  6578         16  AM-PUR-YR                     PIC XX.
  6579         16  AM-PUR-MO                     PIC XX.
  6580         16  AM-PUR-DA                     PIC XX.
  6581     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6582     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6583     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6584     12  AM-INACTIVE-DATE.
  6585         16  AM-INA-MO                     PIC 99.
  6586         16  AM-INA-DA                     PIC 99.
  6587         16  AM-INA-YR                     PIC 99.
  6588     12  AM-AR-HI-CERT-DATE                PIC XX.
  6589
  6590     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6591     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6592
  6593     12  AM-OB-PAYMENT-MODE                PIC X.
  6594         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6595         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6596         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6597         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6598
  6599     12  AM-AH-ONLY-INDICATOR              PIC X.
  6600         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6601         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6602
  6603     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6604
  6605     12  AM-OVER-SHORT.
  6606         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6607         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6608
  6609     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6610     12  AM-DCC-CLP-STATE                  PIC XX.
  6611
  6612     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 122
* EL050.cbl
  6613     12  AM-RECALC-REIN                    PIC X.
  6614
  6615     12  AM-REI-TABLE                      PIC XXX.
  6616     12  AM-REI-ET-LF                      PIC X.
  6617     12  AM-REI-ET-AH                      PIC X.
  6618     12  AM-REI-PE-LF                      PIC X.
  6619     12  AM-REI-PE-AH                      PIC X.
  6620     12  AM-REI-PRT-ST                     PIC X.
  6621     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6622     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6623     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6624     12  AM-REI-GROUP-A                    PIC X(6).
  6625     12  AM-REI-MORT                       PIC X(4).
  6626     12  AM-REI-PRT-OW                     PIC X.
  6627     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6628     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6629     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6630     12  AM-REI-GROUP-B                    PIC X(6).
  6631
  6632     12  AM-TRUST-TYPE                     PIC X(2).
  6633
  6634     12  AM-EMPLOYER-STMT-USED             PIC X.
  6635     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6636
  6637     12  AM-STD-AH-TYPE                    PIC XX.
  6638     12  AM-EARN-METHODS.
  6639         16  AM-EARN-METHOD-R              PIC X.
  6640             88 AM-REF-RL-R78                 VALUE 'R'.
  6641             88 AM-REF-RL-PR                  VALUE 'P'.
  6642             88 AM-REF-RL-MEAN                VALUE 'M'.
  6643             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6644         16  AM-EARN-METHOD-L              PIC X.
  6645             88 AM-REF-LL-R78                 VALUE 'R'.
  6646             88 AM-REF-LL-PR                  VALUE 'P'.
  6647             88 AM-REF-LL-MEAN                VALUE 'M'.
  6648             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6649         16  AM-EARN-METHOD-A              PIC X.
  6650             88 AM-REF-AH-R78                 VALUE 'R'.
  6651             88 AM-REF-AH-PR                  VALUE 'P'.
  6652             88 AM-REF-AH-MEAN                VALUE 'M'.
  6653             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6654             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6655             88 AM-REF-AH-NET                 VALUE 'N'.
  6656
  6657     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6658     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6659     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6660
  6661     12  AM-RET-Y-N                        PIC X.
  6662     12  AM-RET-P-E                        PIC X.
  6663     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6664     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6665     12  AM-RET-GRP                        PIC X(6).
  6666     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6667         16  AM-POOL-PRIME                 PIC XXX.
  6668         16  AM-POOL-SUB                   PIC XXX.
  6669     12  AM-RETRO-EARNINGS.
  6670         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 123
* EL050.cbl
  6671         16  AM-RET-EARN-L                 PIC X.
  6672         16  AM-RET-EARN-A                 PIC X.
  6673     12  AM-RET-ST-TAX-USE                 PIC X.
  6674         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6675         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6676     12  AM-RETRO-BEG-EARNINGS.
  6677         16  AM-RET-BEG-EARN-R             PIC X.
  6678         16  AM-RET-BEG-EARN-L             PIC X.
  6679         16  AM-RET-BEG-EARN-A             PIC X.
  6680     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6681     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6682
  6683     12  AM-USER-SELECT-OPTIONS.
  6684         16  AM-USER-SELECT-1              PIC X(10).
  6685         16  AM-USER-SELECT-2              PIC X(10).
  6686         16  AM-USER-SELECT-3              PIC X(10).
  6687         16  AM-USER-SELECT-4              PIC X(10).
  6688         16  AM-USER-SELECT-5              PIC X(10).
  6689
  6690     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6691
  6692     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6693
  6694     12  AM-RPT045A-SWITCH                 PIC X.
  6695         88  RPT045A-OFF                   VALUE 'N'.
  6696
  6697     12  AM-INSURANCE-LIMITS.
  6698         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6699         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6700
  6701     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6702         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6703
  6704     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6705         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6706         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6707
  6708     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6709
  6710     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6711     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6712     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6713     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6714     12  AM-DCC-UEF-STATE                  PIC XX.
  6715     12  FILLER                            PIC XXX.
  6716     12  AM-REPORT-CODE-3                  PIC X(10).
  6717*    12  FILLER                            PIC X(22).
  6718
  6719     12  AM-RESERVE-DATE.
  6720         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6721         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6722         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6723
  6724     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6725     12  AM-NOTIFICATION-TYPES.
  6726         16  AM-NOTIF-OF-LETTERS           PIC X.
  6727         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6728         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 124
* EL050.cbl
  6729         16  AM-NOTIF-OF-STATUS            PIC X.
  6730
  6731     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6732         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6733         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6734         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6735         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6736
  6737     12  AM-BENEFIT-CONTROLS.
  6738         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6739             20  AM-BENEFIT-CODE           PIC XX.
  6740             20  AM-BENEFIT-TYPE           PIC X.
  6741             20  AM-BENEFIT-REVISION       PIC XXX.
  6742             20  AM-BENEFIT-REM-TERM       PIC X.
  6743             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6744             20  FILLER                    PIC XX.
  6745         16  FILLER                        PIC X(80).
  6746
  6747     12  AM-TRANSFER-DATA.
  6748         16  AM-TRANSFERRED-FROM.
  6749             20  AM-TRNFROM-CARRIER        PIC X.
  6750             20  AM-TRNFROM-GROUPING.
  6751                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6752                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6753             20  AM-TRNFROM-STATE          PIC XX.
  6754             20  AM-TRNFROM-ACCOUNT.
  6755                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6756                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6757             20  AM-TRNFROM-DTE            PIC XX.
  6758         16  AM-TRANSFERRED-TO.
  6759             20  AM-TRNTO-CARRIER          PIC X.
  6760             20  AM-TRNTO-GROUPING.
  6761                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6762                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6763             20  AM-TRNTO-STATE            PIC XX.
  6764             20  AM-TRNTO-ACCOUNT.
  6765                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6766                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6767             20  AM-TRNTO-DTE              PIC XX.
  6768         16  FILLER                        PIC X(10).
  6769
  6770     12  AM-SAVED-REMIT-TO                 PIC 99.
  6771
  6772     12  AM-COMM-STRUCTURE-SAVED.
  6773         16  AM-DEFN-1-SAVED.
  6774             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6775                 24  AM-AGT-SV             PIC X(10).
  6776                 24  AM-COM-TYP-SV         PIC X.
  6777                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6778                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6779                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6780                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6781                 24  FILLER                PIC X.
  6782                 24  AM-GL-CODES-SV        PIC X.
  6783                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6784                 24  FILLER                PIC X.
  6785         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6786             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 125
* EL050.cbl
  6787                 24  FILLER                PIC X(11).
  6788                 24  AM-L-COMA-SV          PIC XXX.
  6789                 24  AM-J-COMA-SV          PIC XXX.
  6790                 24  AM-A-COMA-SV          PIC XXX.
  6791                 24  FILLER                PIC X(6).
  6792
  6793     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6794         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6795            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6796            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6797            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6798
  6799     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6800     12  FILLER                            PIC X(120).
  6801
  6802     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6803         16  AM-CONTROL-NAME               PIC X(30).
  6804         16  AM-EXECUTIVE-ONE.
  6805             20  AM-EXEC1-NAME             PIC X(15).
  6806             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6807                                                          COMP-3.
  6808             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6809                                                          COMP-3.
  6810         16  AM-EXECUTIVE-TWO.
  6811             20  AM-EXEC2-NAME             PIC X(15).
  6812             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6813                                                          COMP-3.
  6814             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6815                                                          COMP-3.
  6816
  6817     12  AM-RETRO-ADDITIONAL-DATA.
  6818         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6819         16  AM-RETRO-PREM-P-E             PIC X.
  6820         16  AM-RETRO-CLMS-P-I             PIC X.
  6821         16  AM-RETRO-RET-BRACKET-LF.
  6822             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6823                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6824                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6825             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6826                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6827                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6828             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6829                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6830                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6831         16  AM-RETRO-RET-BRACKET-AH.
  6832             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6833                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6834                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6835                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6836             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6837                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6838                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6839             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6840                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6841                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6842
  6843     12  AM-COMMENTS.
  6844         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 126
* EL050.cbl
  6845
  6846     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6847         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6848         16  AM-FLI-BILLING-CODE           PIC X.
  6849         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6850         16  AM-FLI-UNITED-IDENT           PIC X.
  6851         16  AM-FLI-INTEREST-LOST-DATA.
  6852             20  AM-FLI-BANK-NO            PIC X(5).
  6853             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6854             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6855             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6856         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6857             20  AM-FLI-AGT                PIC X(9).
  6858             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6859             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6860         16  FILLER                        PIC X(102).
  6861
  6862     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6863         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6864             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6865             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6866             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6867             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6868             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6869         16  FILLER                          PIC X(10).
  6870******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 127
* EL050.cbl
  6872*    COPY ERCREIN.
  6873******************************************************************
  6874*                                                                *
  6875*                            ERCREIN                             *
  6876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6877*                            VMOD=2.010                          *
  6878*                                                                *
  6879*   ONLINE CREDIT SYSTEM                                         *
  6880*                                                                *
  6881*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6882*                                                                *
  6883*   FILE TYPE = VSAM,KSDS                                        *
  6884*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6885*                                                                *
  6886*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6887*       ALTERNATE PATH = NONE                                    *
  6888*                                                                *
  6889*   LOG = NO                                                     *
  6890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6891*                                                                *
  6892******************************************************************
  6893*                   C H A N G E   L O G
  6894*
  6895* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6896*-----------------------------------------------------------------
  6897*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6898* EFFECTIVE    NUMBER
  6899*-----------------------------------------------------------------
  6900* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6901* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6902******************************************************************
  6903 01  REINSURANCE-RECORD.
  6904     12  RE-RECORD-ID                      PIC XX.
  6905         88  VALID-RE-ID                      VALUE 'RE'.
  6906
  6907     12  RE-CONTROL-PRIMARY.
  6908         16  RE-COMPANY-CD                 PIC X.
  6909         16  RE-KEY.
  6910             20  RE-CODE                   PIC X.
  6911                 88  RE-TABLE-RECORD          VALUE 'A'.
  6912                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6913             20  RE-TABLE                  PIC XXX.
  6914             20  FILLER                    PIC XXX.
  6915         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6916             20  FILLER                    PIC X.
  6917             20  RE-COMPANY.
  6918                 24  RE-COMP-PRIME         PIC XXX.
  6919                 24  RE-COMP-SUB           PIC XXX.
  6920
  6921     12  RE-MAINT-INFORMATION.
  6922         16  RE-LAST-MAINT-DT              PIC XX.
  6923         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6924         16  RE-LAST-MAINT-USER            PIC X(4).
  6925         16  FILLER                        PIC X(10).
  6926
  6927     12  RE-TABLE-DATA.
  6928         16  RE-100-COMP                   PIC 99.
  6929
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 128
* EL050.cbl
  6930         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6931             20  RE-REI-COMP-NO.
  6932                 24  RE-REI-COMP           PIC XXX.
  6933                 24  RE-REI-COMP-SUB       PIC XXX.
  6934             20  RE-LF-QC                  PIC X.
  6935             20  RE-AH-QC                  PIC X.
  6936             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6937             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6938             20  RE-LFAGE-LO               PIC 99.
  6939             20  RE-LFAGE-HI               PIC 99.
  6940             20  RE-AHAGE-LO               PIC 99.
  6941             20  RE-AHAGE-HI               PIC 99.
  6942             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6943             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6944             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6945             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6946             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6947             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6948             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6949             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6950             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6951             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6952             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6953             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6954             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6955             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6956             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6957             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6958             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6959             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6960             20  RE-LF-BEN-CODE            PIC X.
  6961             20  RE-AH-BEN-CODE            PIC X.
  6962             20  RE-INTERACTIVE            PIC X.
  6963             20  RE-REMAINING              PIC X.
  6964             20  RE-LF-RUNOFF-SW           PIC X.
  6965             20  RE-AH-RUNOFF-SW           PIC X.
  6966             20  FILLER                    PIC X(19).
  6967
  6968         16  RE-COMP-INFO-END              PIC X(6).
  6969         16  RE-NSP-ST-CD-LF               PIC XX.
  6970         16  RE-NSP-ST-CD-AH               PIC XX.
  6971         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6972             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6973
  6974         16  FILLER                        PIC X(27).
  6975
  6976     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6977         16  RE-NAME                       PIC X(30).
  6978         16  RE-LF-PE                      PIC X.
  6979         16  RE-AH-PE                      PIC X.
  6980         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6981         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6982         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6983         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6984         16  RE-PRT-ST                     PIC X.
  6985         16  RE-PRT-OW                     PIC X.
  6986         16  RE-MORT-CODE                  PIC X(4).
  6987         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 129
* EL050.cbl
  6988         16  RE-ZERO-LF-FEE                PIC X.
  6989         16  RE-ZERO-AH-FEE                PIC X.
  6990         16  RE-CEDE-NAME                  PIC X(30).
  6991         16  RE-LF-COMM                    PIC X.
  6992         16  RE-AH-COMM                    PIC X.
  6993         16  RE-LF-TAX                     PIC X.
  6994         16  RE-AH-TAX                     PIC X.
  6995         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6996         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6997         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6998
  6999         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7000             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7001
  7002         16  RE-LF-CEDING-FEE-BRACKETS.
  7003             20  RE-LF-FEE-METHOD          PIC X.
  7004                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7005                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7006                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7007                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7008             20  RE-LF-FEE-BASIS           PIC X.
  7009                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7010                 88  RE-LF-NET-CEDED               VALUE '2'.
  7011                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7012                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7013                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7014                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7015                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7016                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7017             20  FILLER                    PIC XXX.
  7018             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7019                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7020                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7021
  7022         16  RE-AH-CEDING-FEE-BRACKETS.
  7023             20  RE-AH-FEE-METHOD          PIC X.
  7024                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7025                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7026                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7027                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7028             20  RE-AH-FEE-BASIS           PIC X.
  7029                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7030                 88  RE-AH-NET-CEDED               VALUE '2'.
  7031                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7032                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7033                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7034                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7035                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7036                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7037             20  FILLER                    PIC XXX.
  7038             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7039                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7040                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7041
  7042         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7043
  7044         16  RE-OLD-CEDING-STMT            PIC X.
  7045
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 130
* EL050.cbl
  7046         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7047         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7048         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7049         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7050         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7051         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7052         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7053         16  RE-MORT-SW                    PIC X.
  7054         16  RE-CEDING-TYPE-FLAG           PIC X.
  7055             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7056             88  RE-CEDED                          VALUE 'C'.
  7057             88  RE-ASSUMED                        VALUE 'A'.
  7058             88  RE-PHANTOM                        VALUE 'P'.
  7059
  7060         16  RE-CEDING-STMT-OPT-A          PIC X.
  7061             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7062         16  RE-CEDING-STMT-OPT-B          PIC X.
  7063             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7064         16  RE-CEDING-STMT-OPT-C          PIC X.
  7065             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7066         16  RE-CEDING-STMT-OPT-D          PIC X.
  7067             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7068         16  RE-CEDING-STMT-OPT-E          PIC X.
  7069             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7070
  7071         16  RE-PRT-CRSV                   PIC X.
  7072
  7073         16  RE-GL-CENTER                  PIC X(4).
  7074
  7075         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7076
  7077         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7078
  7079         16  RE-EARN-STOP-CODE             PIC X.
  7080             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7081             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7082
  7083         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7084             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7085
  7086         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7087         16  FILLER                        PIC X(2281).
  7088
  7089         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7090
  7091******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 131
* EL050.cbl
  7093*    COPY ERCCTBL.
  7094******************************************************************
  7095*                                                                *
  7096*                                                                *
  7097*                            ERCCTBL                             *
  7098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7099*                            VMOD=2.003
  7100*                                                                *
  7101*   ONLINE CREDIT SYSTEM                                         *
  7102*                                                                *
  7103*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7104*                                                                *
  7105*   FILE TYPE = VSAM,KSDS                                        *
  7106*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7107*                                                                *
  7108*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7109*       ALTERNATE PATH = NONE                                    *
  7110*                                                                *
  7111*   LOG = NO                                                     *
  7112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7113*                                                                *
  7114*                                                                *
  7115******************************************************************
  7116
  7117 01  COMM-TABLE-RECORD.
  7118     12  CT-RECORD-ID                      PIC XX.
  7119         88  VALID-CT-ID                      VALUE 'CT'.
  7120
  7121     12  CT-CONTROL-PRIMARY.
  7122         16  CT-COMPANY-CD                 PIC X.
  7123         16  CT-TABLE                      PIC XXX.
  7124         16  CT-CNTRL-2.
  7125             20  CT-BEN-TYPE               PIC X.
  7126             20  CT-BEN-CODE               PIC XX.
  7127
  7128     12  CT-MAINT-INFORMATION.
  7129         16  CT-LAST-MAINT-DT              PIC XX.
  7130         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7131         16  CT-LAST-MAINT-USER            PIC X(4).
  7132         16  FILLER                        PIC X(31).
  7133
  7134     12  CT-LIMITS.
  7135         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7136
  7137         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7138
  7139         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7140
  7141     12  CT-RATES.
  7142         16  CT-RTX          OCCURS 27 TIMES.
  7143             20  CT-RT                     PIC SV9(5)     COMP-3.
  7144             20  CT-RT-R   REDEFINES
  7145                 CT-RT                     PIC XXX.
  7146
  7147     12  FILLER                            PIC  X(42).
  7148
  7149******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 132
* EL050.cbl
  7151*    COPY ERCFORM.
  7152******************************************************************
  7153*                                                                *
  7154*                                                                *
  7155*                            ERCFORM.                            *
  7156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7157*                            VMOD=2.003                          *
  7158*                                                                *
  7159*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7160*                                                                *
  7161*    FILE TYPE = VSAM,KSDS                                       *
  7162*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7163*                                                                *
  7164*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7165*                                                                *
  7166*    LOG = YES                                                   *
  7167*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7168******************************************************************
  7169 01  FORM-MASTER.
  7170    12  FO-RECORD-ID                 PIC X(02).
  7171        88  VALID-FO-ID                  VALUE 'FO'.
  7172
  7173    12  FO-CONTROL-PRIMARY.
  7174        16  FO-COMPANY-CD            PIC X(01).
  7175        16  FO-STATE                 PIC X(02).
  7176        16  FO-FORM-ID               PIC X(12).
  7177        16  FO-FORM-EXP-DT           PIC X(02).
  7178
  7179    12  FO-POLICY-FORM-DATA.
  7180        16  FO-IND-GRP-CD            PIC X(01).
  7181        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7182        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7183        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7184        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7185        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7186        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7187        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7188        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7189        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7190        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7191        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7192        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7193        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7194        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7195        16  FO-APP-CERT-USE-CD       PIC X(01).
  7196
  7197    12  FILLER                       PIC X(29).
  7198
  7199    12  FO-FORM-PLAN-TABLE.
  7200        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7201            20  FO-PLAN-TYPE         PIC X(01).
  7202            20  FO-PLAN-ID           PIC X(02).
  7203            20  FO-PLAN-TERM         PIC 9(03).
  7204            20  FO-PLAN-REFUND-METHOD
  7205                                     PIC X.
  7206
  7207    12  FILLER                       PIC X(30).
  7208
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 133
* EL050.cbl
  7209    12  FO-COMMENTS-AREA.
  7210        16  FO-COMMENT-LINE-1        PIC X(78).
  7211
  7212    12  FILLER                       PIC X(20).
  7213
  7214    12  FO-MAINT-INFORMATION.
  7215        16  FO-LAST-MAINT-DT         PIC X(02).
  7216        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7217        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 134
* EL050.cbl
  7219*    COPY ELCMSTR.
  7220******************************************************************
  7221*                                                                *
  7222*                            ELCMSTR.                            *
  7223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7224*                            VMOD=2.012                          *
  7225*                                                                *
  7226*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7227*                                                                *
  7228*   FILE TYPE = VSAM,KSDS                                        *
  7229*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7230*                                                                *
  7231*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7232*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7233*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7234*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7235*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7236*                                                 RKP=75,LEN=21  *
  7237*                                                                *
  7238*   **** NOTE ****                                               *
  7239*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7240*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7241*                                                                *
  7242*   LOG = YES                                                    *
  7243*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7244******************************************************************
  7245*                   C H A N G E   L O G
  7246*
  7247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7248*-----------------------------------------------------------------
  7249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7250* EFFECTIVE    NUMBER
  7251*-----------------------------------------------------------------
  7252* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7253* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7254******************************************************************
  7255 01  CLAIM-MASTER.
  7256     12  CL-RECORD-ID                PIC XX.
  7257         88  VALID-CL-ID         VALUE 'CL'.
  7258
  7259     12  CL-CONTROL-PRIMARY.
  7260         16  CL-COMPANY-CD           PIC X.
  7261         16  CL-CARRIER              PIC X.
  7262         16  CL-CLAIM-NO             PIC X(7).
  7263         16  CL-CERT-NO.
  7264             20  CL-CERT-PRIME       PIC X(10).
  7265             20  CL-CERT-SFX         PIC X.
  7266
  7267     12  CL-CONTROL-BY-NAME.
  7268         16  CL-COMPANY-CD-A1        PIC X.
  7269         16  CL-INSURED-LAST-NAME    PIC X(15).
  7270         16  CL-INSURED-NAME.
  7271             20  CL-INSURED-1ST-NAME PIC X(12).
  7272             20  CL-INSURED-MID-INIT PIC X.
  7273
  7274     12  CL-CONTROL-BY-SSN.
  7275         16  CL-COMPANY-CD-A2        PIC X.
  7276         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 135
* EL050.cbl
  7277             20  CL-SSN-STATE        PIC XX.
  7278             20  CL-SSN-ACCOUNT      PIC X(6).
  7279             20  CL-SSN-LN3          PIC X(3).
  7280
  7281     12  CL-CONTROL-BY-CERT-NO.
  7282         16  CL-COMPANY-CD-A4        PIC X.
  7283         16  CL-CERT-NO-A4.
  7284             20  CL-CERT-A4-PRIME    PIC X(10).
  7285             20  CL-CERT-A4-SFX      PIC X.
  7286
  7287     12  CL-CONTROL-BY-CCN.
  7288         16  CL-COMPANY-CD-A5        PIC X.
  7289         16  CL-CCN-A5.
  7290             20  CL-CCN.
  7291                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7292                 24  CL-CCN-PRIME-A5 PIC X(12).
  7293             20  CL-CCN-FILLER-A5    PIC X(4).
  7294
  7295     12  CL-INSURED-PROFILE-DATA.
  7296         16  CL-INSURED-BIRTH-DT     PIC XX.
  7297         16  CL-INSURED-SEX-CD       PIC X.
  7298             88  INSURED-IS-MALE        VALUE 'M'.
  7299             88  INSURED-IS-FEMALE      VALUE 'F'.
  7300             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7301         16  CL-INSURED-OCC-CD       PIC X(6).
  7302         16  FILLER                  PIC X(5).
  7303
  7304     12  CL-PROCESSING-INFO.
  7305         16  CL-PROCESSOR-ID         PIC X(4).
  7306         16  CL-CLAIM-STATUS         PIC X.
  7307             88  CLAIM-IS-OPEN          VALUE 'O'.
  7308             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7309         16  CL-CLAIM-TYPE           PIC X.
  7310*            88  AH-CLAIM               VALUE 'A'.
  7311*            88  LIFE-CLAIM             VALUE 'L'.
  7312*            88  PROPERTY-CLAIM         VALUE 'P'.
  7313*            88  IUI-CLAIM              VALUE 'I'.
  7314*            88  GAP-CLAIM              VALUE 'G'.
  7315         16  CL-CLAIM-PREM-TYPE      PIC X.
  7316             88  SINGLE-PREMIUM         VALUE '1'.
  7317             88  O-B-COVERAGE           VALUE '2'.
  7318             88  OPEN-END-COVERAGE      VALUE '3'.
  7319         16  CL-INCURRED-DT          PIC XX.
  7320         16  CL-REPORTED-DT          PIC XX.
  7321         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7322         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7323         16  CL-LAST-PMT-DT          PIC XX.
  7324         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7325         16  CL-PAID-THRU-DT         PIC XX.
  7326         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7327         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7328         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7329         16  CL-PMT-CALC-METHOD      PIC X.
  7330             88  CL-360-DAY-YR          VALUE '1'.
  7331             88  CL-365-DAY-YR          VALUE '2'.
  7332             88  CL-FULL-MONTHS         VALUE '3'.
  7333         16  CL-CAUSE-CD             PIC X(6).
  7334
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 136
* EL050.cbl
  7335         16  CL-PRIME-CERT-NO.
  7336             20  CL-PRIME-CERT-PRIME PIC X(10).
  7337             20  CL-PRIME-CERT-SFX   PIC X.
  7338
  7339         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7340             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7341             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7342
  7343         16  CL-MICROFILM-NO         PIC X(10).
  7344         16  CL-PROG-FORM-TYPE       PIC X.
  7345         16  CL-LAST-ADD-ON-DT       PIC XX.
  7346
  7347         16  CL-LAST-REOPEN-DT       PIC XX.
  7348         16  CL-LAST-CLOSE-DT        PIC XX.
  7349         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7350             88  FINAL-PAID             VALUE '1'.
  7351             88  CLAIM-DENIED           VALUE '2'.
  7352             88  AUTO-CLOSE             VALUE '3'.
  7353             88  MANUAL-CLOSE           VALUE '4'.
  7354             88  BENEFITS-CHANGED       VALUE 'C'.
  7355             88  SETUP-ERRORS           VALUE 'E'.
  7356         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7357         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7358         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7359             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7360         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7361         16  FILLER                  PIC X.
  7362
  7363     12  CL-CERTIFICATE-DATA.
  7364         16  CL-CERT-ORIGIN          PIC X.
  7365             88  CERT-WAS-ONLINE        VALUE '1'.
  7366             88  CERT-WAS-CREATED       VALUE '2'.
  7367             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7368         16  CL-CERT-KEY-DATA.
  7369             20  CL-CERT-CARRIER     PIC X.
  7370             20  CL-CERT-GROUPING    PIC X(6).
  7371             20  CL-CERT-STATE       PIC XX.
  7372             20  CL-CERT-ACCOUNT.
  7373                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7374                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7375             20  CL-CERT-EFF-DT      PIC XX.
  7376
  7377     12  CL-STATUS-CONTROLS.
  7378         16  CL-PRIORITY-CD          PIC X.
  7379             88  CONFIDENTIAL-DATA      VALUE '8'.
  7380             88  HIGHEST-PRIORITY       VALUE '9'.
  7381         16  CL-SUPV-ATTN-CD         PIC X.
  7382             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7383             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7384         16  CL-PURGED-DT            PIC XX.
  7385         16  CL-RESTORED-DT          PIC XX.
  7386         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7387         16  CL-NEXT-RESEND-DT       PIC XX.
  7388         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7389         16  FILLER                  PIC XX.
  7390         16  CL-LAST-MAINT-DT        PIC XX.
  7391         16  CL-LAST-MAINT-USER      PIC X(4).
  7392         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 137
* EL050.cbl
  7393         16  CL-LAST-MAINT-TYPE      PIC X.
  7394             88  CLAIM-SET-UP           VALUE ' '.
  7395             88  PAYMENT-MADE           VALUE '1'.
  7396             88  LETTER-SENT            VALUE '2'.
  7397             88  MASTER-WAS-ALTERED     VALUE '3'.
  7398             88  MASTER-WAS-RESTORED    VALUE '4'.
  7399             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7400             88  FILE-CONVERTED         VALUE '6'.
  7401             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7402             88  ERROR-CORRECTION       VALUE 'E'.
  7403         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7404         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7405         16  CL-BENEFICIARY          PIC X(10).
  7406         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7407         16  CL-DENIAL-TYPE          PIC X.
  7408             88  CL-TYPE-DENIAL          VALUE '1'.
  7409             88  CL-TYPE-RESCISSION      VALUE '2'.
  7410             88  CL-TYPE-REFORMATION     VALUE '3'.
  7411             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7412             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7413         16  FILLER                  PIC X(5).
  7414
  7415     12  CL-TRAILER-CONTROLS.
  7416         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7417             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7418             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7419             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7420         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7421         16  FILLER                  PIC XX.
  7422         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7423         16  CL-ADDRESS-TRAILER-CNT.
  7424             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7425                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7426             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7427                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7428             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7429                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7430             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7431                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7432             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7433                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7434             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7435                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7436             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7437                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7438
  7439     12  CL-CV-REFERENCE-NO.
  7440         16  CL-CV-REFNO-PRIME       PIC X(18).
  7441         16  CL-CV-REFNO-SFX         PIC XX.
  7442
  7443     12  CL-FILE-LOCATION            PIC X(4).
  7444
  7445     12  CL-PROCESS-ERRORS.
  7446         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7447             88  NO-FATAL-ERRORS        VALUE ZERO.
  7448         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7449             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7450
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 138
* EL050.cbl
  7451     12  CL-PRODUCT-CD               PIC X.
  7452
  7453     12  CL-CURRENT-KEY-DATA.
  7454         16  CL-CURRENT-CARRIER      PIC X.
  7455         16  CL-CURRENT-GROUPING     PIC X(6).
  7456         16  CL-CURRENT-STATE        PIC XX.
  7457         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7458
  7459     12  CL-ASSOCIATES               PIC X.
  7460         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7461         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7462         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7463         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7464
  7465     12  CL-ACTIVITY-CODE            PIC 99.
  7466     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7467     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7468
  7469     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7470     12  CL-LAG-REPORT-CODE          PIC 9.
  7471     12  CL-LOAN-TYPE                PIC XX.
  7472     12  CL-LEGAL-STATE              PIC XX.
  7473
  7474*    12  FILLER                      PIC X(5).
  7475     12  CL-YESNOSW                  PIC X.
  7476     12  FILLER                      PIC X(4).
  7477
  7478 01  PLAN-RECORDS.
  7479     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7480     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7481
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 139
* EL050.cbl
  7483 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7484                          ACCOUNT-MASTER REINSURANCE-RECORD
  7485                          COMM-TABLE-RECORD FORM-MASTER
  7486                          CLAIM-MASTER PLAN-RECORDS.
  7487 0000-DFHEXIT SECTION.
  7488     MOVE '9#                    $   ' TO DFHEIV0.
  7489     MOVE 'EL050' TO DFHEIV1.
  7490     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7491
  7492     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7493
  7494
  7495* EXEC CICS  HANDLE CONDITION
  7496*           ERROR    (9300-ABEND)
  7497*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7498*    END-EXEC.
  7499*    MOVE '"$.J                  ! " #00007490' TO DFHEIV0
  7500     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7502     MOVE X'2220233030303037343930' TO DFHEIV0(25:11)
  7503     CALL 'kxdfhei1' USING DFHEIV0
  7504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7505
  7506
  7507 0000-COPY-PROCEDURE-DIV.
  7508*                          COPY ELC50PD.
  7509******************************************************************
  7510*                                                                *
  7511*                            ELC50PD                             *
  7512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7513*                            VMOD=2.188                          *
  7514*                                                                *
  7515******************************************************************
  7516*                   C H A N G E   L O G
  7517*
  7518* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7519*-----------------------------------------------------------------
  7520*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7521* EFFECTIVE    NUMBER
  7522*-----------------------------------------------------------------
  7523* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7524* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7525* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7526*                             2709 AND 2718
  7527* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7528* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7529* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7530* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7531* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7532*                                IS OPEN OR CNC DT < PD THRU
  7533* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7534* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7535* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7536* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7537* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7538* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7539* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7540* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 140
* EL050.cbl
  7541* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7542* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7543* 020906                   PEMA  EXPAND LOAN OFFICER
  7544* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7545* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7546* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7547* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7548* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7549* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7550* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7551* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7552* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7553* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7554* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7555* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7556* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7557* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7558* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7559* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7560* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7561* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7562* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7563* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7564* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7565* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7566* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7567* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7568* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7569*                                UPDATE VIN ON CERT TRAILER
  7570* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7571* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7572* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7573* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7574* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7575* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7576* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7577* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7578* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7579* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7580* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7581* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7582* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7583* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7584* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7585* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7586* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7587* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7588* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7589* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7590* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7591* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7592* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7593* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7594* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7595* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7596* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7597* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7598* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 141
* EL050.cbl
  7599* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7600* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7601* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7602* 032912  CR2011110200001  PEMA  AHL CHANGES
  7603* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7604* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7605* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7606* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7607* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7608* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7609* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7610* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7611* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7612* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7613* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7614* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7615******************************************************************
  7616************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7617******************************************************************
  7618
  7619     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7620
  7621     MOVE SPACES                 TO PB-FATAL-FLAG
  7622                                    PB-FORCE-ER-CD
  7623                                    PB-WARN-ER-CD
  7624                                    PB-OUT-BAL-CD.
  7625
  7626     MOVE SPACE                  TO WS-IG-OVRD-AH
  7627                                    WS-IG-OVRD-LF
  7628                                    WS-IG-OVRD-AM
  7629                                    WS-IG-OVRD
  7630                                    WS-IG-OVRD-AH-PL
  7631                                    WS-IG-OVRD-LF-PL
  7632                                    WS-IG-OVRD-AH-BEN
  7633                                    WS-IG-OVRD-LF-BEN.
  7634
  7635******************************************************************
  7636*************       INITIALIZE COMMON ERRORS       ***************
  7637******************************************************************
  7638
  7639     MOVE +0                     TO PB-NO-OF-ERRORS.
  7640     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7641
  7642******************************************************************
  7643
  7644     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7645     SET JULIAN-TO-BIN           TO TRUE.
  7646*    MOVE 5                      TO DC-OPTION-CODE.
  7647     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7648     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7649
  7650     MOVE ZERO                   TO  SUB4.
  7651
  7652 0040-INITIALIZE-GA-BILL-DT.
  7653
  7654     ADD +1                      TO  SUB4.
  7655
  7656     IF  SUB4 GREATER THAN +5
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 142
* EL050.cbl
  7657         GO TO 0050-CHECK-CNTL-FOUND.
  7658
  7659     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7660         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7661
  7662     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7663
  7664 0050-CHECK-CNTL-FOUND.
  7665
  7666     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7667        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7668                                         WS-AH-REM-TERM-CALC
  7669                                         EC-CO-REM-TERM-CALC
  7670        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7671        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7672        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7673                                         WS-TOL-AH-CLAIM
  7674        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7675                                         WS-TOL-AH-PREM
  7676                                         EC-CO-TOL-PREM
  7677        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7678                                         WS-TOL-AH-REFUND
  7679                                         EC-CO-TOL-REFUND
  7680        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7681                                         WS-AH-REFUND-OVS-AMT
  7682                                         EC-CO-OVR-SHT-AMT
  7683        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7684                                         WS-TOL-AH-PREM-PCT
  7685                                         EC-CO-TOL-PREM-PCT
  7686        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7687                                         WS-TOL-AH-REFUND-PCT
  7688                                         EC-CO-TOL-REFUND-PCT
  7689        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7690                                         WS-AH-REFUND-OVS-PCT
  7691                                         EC-CO-OVR-SHT-PCT
  7692        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7693        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7694        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7695        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7696        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7697        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7698        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7699        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7700        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7701        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7702        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7703        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7704                                         EC-CO-MONTH-END-DT
  7705        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7706          GO TO 0100-READ-ACCT.
  7707
  7708     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7709     MOVE SPACES                 TO CNTL-ACCESS.
  7710     MOVE '1'                    TO CNTL-REC-TYPE.
  7711     MOVE +0                     TO CNTL-SEQ-NO.
  7712
  7713     MOVE '1' TO RC-SW-1.
  7714     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 143
* EL050.cbl
  7715     IF NOT CF-COMPANY-MASTER
  7716         MOVE ZEROS             TO WK-CO-TOL-PREM
  7717                                   WK-CO-TOL-CLAIM
  7718                                   WK-CO-TOL-REFUND
  7719                                   WK-REFUND-OVS-AMT
  7720                                   WK-REFUND-OVS-PCT
  7721                                   WK-CO-TOL-PREM-PCT
  7722                                   WK-CO-TOL-REFUND-PCT
  7723                                   WK-DEFAULT-APR
  7724                                   WK-CO-MAX-CAP
  7725        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7726                                   WK-CR-R78-METHOD
  7727                                   WK-CO-REF-REJECT-SW
  7728                                   WK-CO-PREM-REJECT-SW
  7729                                   WK-REM-TRM-CALC-OPTION
  7730                                   WK-BIRTH-DATE-INPUT
  7731                                   WK-JOINT-AGE-INPUT
  7732        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7733        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7734        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7735        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7736          GO TO 0099-COMPANY-NOT-FOUND.
  7737
  7738     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7739        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7740     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7741        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7742     IF CF-CO-TOL-CAP NOT NUMERIC
  7743        MOVE +0                    TO CF-CO-TOL-CAP.
  7744     IF CF-DEFAULT-APR NOT NUMERIC
  7745        MOVE +0                    TO CF-DEFAULT-APR.
  7746
  7747     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7748     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7749     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7750     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7751     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7752     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7753     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7754     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7755     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7756     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7757     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7758     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7759
  7760     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7761          CF-CO-OVR-SHT-AMT > +0
  7762        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7763
  7764     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7765          CF-CO-OVR-SHT-PCT > +0
  7766        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7767
  7768     IF CF-VALID-REM-TRM-OPTION
  7769         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7770     ELSE
  7771         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7772
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 144
* EL050.cbl
  7773     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7774     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7775     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7776     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7777
  7778     GO TO 0050-CHECK-CNTL-FOUND.
  7779
  7780 0099-COMPANY-NOT-FOUND.
  7781
  7782     MOVE ER-2616                TO WS-ERROR.
  7783     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7784
  7785 0100-READ-ACCT.
  7786
  7787     MOVE SPACES                 TO DATE-RANGE-SW.
  7788
  7789     IF WK-ACCT-ADDR = ZEROS
  7790        GO TO 0102-ACCT-GETMAIN.
  7791
  7792     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7793     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7794     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7795
  7796     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7797        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7798        GO TO 0105-READ-ACCT
  7799     END-IF
  7800
  7801     IF PB-CARRIER NOT = SPACES
  7802        IF PB-CARRIER NOT = AM-VG-CARRIER
  7803           GO TO 0105-READ-ACCT.
  7804
  7805     IF PB-STATE NOT = SPACES
  7806        IF PB-STATE NOT = AM-VG-STATE
  7807           GO TO 0105-READ-ACCT.
  7808
  7809     IF PB-GROUPING NOT = SPACES
  7810        IF PB-GROUPING NOT = AM-VG-GROUPING
  7811           GO TO 0105-READ-ACCT.
  7812
  7813     MOVE 'X'                 TO DATE-RANGE-SW.
  7814
  7815     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7816        MOVE 'X'                 TO DATE-RANGE-SW
  7817        GO TO 0105-READ-ACCT.
  7818
  7819     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7820        GO TO 0105-READ-ACCT.
  7821
  7822     GO TO 0180-ACCOUNT-FOUND.
  7823
  7824 0102-ACCT-GETMAIN.
  7825     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7826     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7827
  7828 0105-READ-ACCT.
  7829     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7830     MOVE PB-CARRIER             TO ACCT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 145
* EL050.cbl
  7831     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7832     MOVE PB-STATE               TO ACCT-STATE.
  7833     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7834     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7835
  7836     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7837
  7838     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7839
  7840 0110-FIND-ACCT-TOLERANCES-LOOP.
  7841     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7842
  7843     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7844        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7845        GO TO 0199-ACCT-NOT-FOUND
  7846     END-IF
  7847     IF PB-CARRIER NOT = SPACES
  7848        IF PB-CARRIER NOT = AM-VG-CARRIER
  7849           GO TO 0199-ACCT-NOT-FOUND.
  7850
  7851     IF PB-STATE NOT = SPACES
  7852        IF PB-STATE NOT = AM-VG-STATE
  7853           GO TO 0199-ACCT-NOT-FOUND.
  7854
  7855     IF PB-GROUPING NOT = SPACES
  7856        IF PB-GROUPING NOT = AM-VG-GROUPING
  7857           GO TO 0199-ACCT-NOT-FOUND.
  7858
  7859     MOVE 'X'                    TO DATE-RANGE-SW.
  7860
  7861     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7862        MOVE 'X'                 TO DATE-RANGE-SW
  7863        GO TO 0199-ACCT-NOT-FOUND.
  7864
  7865     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7866        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7867
  7868 0180-ACCOUNT-FOUND.
  7869     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7870     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7871     MOVE AM-STATE               TO PB-SV-STATE.
  7872     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7873
  7874     IF AM-CANCEL-FEE  NOT NUMERIC
  7875        MOVE ZEROS TO AM-CANCEL-FEE.
  7876
  7877     IF AM-MAX-MON-BEN NOT NUMERIC
  7878        MOVE ZEROS TO AM-MAX-MON-BEN.
  7879
  7880     IF AM-MAX-TOT-BEN NOT NUMERIC
  7881        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7882
  7883     IF AM-CLP-TOL-PCT NOT NUMERIC
  7884        MOVE +0                  TO AM-CLP-TOL-PCT
  7885     END-IF
  7886     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7887        MOVE +0                  TO AM-SPP-LEASE-COMM
  7888     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 146
* EL050.cbl
  7889     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7890        MOVE ER-2611             TO   WS-ERROR
  7891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7892
  7893     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7894        MOVE ER-2621             TO   WS-ERROR
  7895        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7896
  7897     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7898        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7899        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7900        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7901         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7902
  7903     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7904     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7905     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7906     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7907     IF AM-CLP-TOL-PCT NOT = ZEROS
  7908        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7909     END-IF
  7910     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7911        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7912     END-IF
  7913*    IF PB-COMPANY-ID = 'DCC'
  7914*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7915*                                   WS-ADMIN-FEES
  7916*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7917*          (SUB5 > +10)
  7918*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7919*             AND (AM-A-COM (SUB5) NUMERIC)
  7920*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7921*                + (AM-A-COM (SUB5) * 1000)
  7922*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7923*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7924*                + (AM-A-COM (SUB5) * 1000)
  7925*             END-IF
  7926*             IF AM-COM-TYP (SUB5) = 'N'
  7927*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7928*                + (AM-A-COM (SUB5) * 1000)
  7929*             END-IF
  7930*          END-IF
  7931*       END-PERFORM
  7932*    END-IF
  7933     IF (PB-COMPANY-ID = 'DCC')
  7934        AND (PB-ISSUE)
  7935        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7936        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7937           (SUB5 > +10)
  7938           MOVE +0 TO WS-WK-RATE
  7939           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7940              IF (AM-A-COM (SUB5) NUMERIC)
  7941                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7942                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7943              ELSE
  7944                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7945                 IF PB-ISSUE
  7946                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 147
* EL050.cbl
  7947                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7948                 ELSE
  7949                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7950                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7951                 END-IF
  7952                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7953                 MOVE ZEROS             TO WS-SUB1
  7954                                           WS-COMMISSION
  7955                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7956                 MOVE '0530'               TO CTBL-SW
  7957                 MOVE ' '                  TO WS-CTBL-READ-SW
  7958                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7959                 IF FIRST-TIME-THROUGH
  7960                    MOVE 'AA'              TO CTBL-BEN-CODE
  7961                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7962                 END-IF
  7963                 IF CTBL-TABLE-FOUND
  7964                    IF PB-ISSUE
  7965                       COMPUTE WS-COMM-CK-AMT =
  7966                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7967                    ELSE
  7968                       COMPUTE WS-COMM-CK-AMT =
  7969                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7970                    END-IF
  7971                    PERFORM 8800-GET-COMP-RATE
  7972                              THRU 8800-EXIT
  7973                 END-IF
  7974              END-IF
  7975              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7976                + (WS-WK-RATE * 1000)
  7977           END-IF
  7978        END-PERFORM
  7979     END-IF
  7980     IF PB-COMPANY-ID EQUAL 'CRI'
  7981         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7982
  7983     IF PB-COMPANY-ID EQUAL 'NCL'
  7984         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7985     END-IF
  7986
  7987     GO TO 0200-READ-CERT.
  7988
  7989 0199-ACCT-NOT-FOUND.
  7990
  7991     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7992
  7993     IF DATE-RANGE-SW NOT = SPACES
  7994        MOVE ER-2601             TO WS-ERROR
  7995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7996     ELSE
  7997        MOVE ER-2619             TO WS-ERROR
  7998        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7999
  8000     GO TO 9990-RETURN.
  8001
  8002 0200-READ-CERT.
  8003
  8004     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 148
* EL050.cbl
  8005     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8006     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8007     MOVE PB-SV-STATE            TO CERT-STATE.
  8008     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8009     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8010     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8011
  8012     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8013
  8014     IF CERT-WAS-NOT-FOUND
  8015        GO TO 0299-CERT-NOT-FOUND.
  8016
  8017     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8018        MOVE ER-2759             TO WS-ERROR
  8019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8020        GO TO 0298-UNLOCK-RETURN.
  8021
  8022     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8023         MOVE ER-2758            TO WS-ERROR
  8024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8025         GO TO 0298-UNLOCK-RETURN.
  8026
  8027     IF PB-ISSUE
  8028        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8029           IF CERT-WAS-CREATED-FOR-CLAIM
  8030              NEXT SENTENCE
  8031            ELSE
  8032              MOVE ER-2626       TO WS-ERROR
  8033              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8034              GO TO 0298-UNLOCK-RETURN.
  8035
  8036     IF NOT PB-CANCELLATION
  8037        GO TO 0300-CONTINUE-EDIT.
  8038
  8039     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8040     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8041     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8042     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8043     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8044     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8045
  8046     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8047     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8048     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8049     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8050     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8051     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8052     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8053     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8054     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8055
  8056     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8057     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8058     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8059     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8060     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8061     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8062     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 149
* EL050.cbl
  8063
  8064     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8065     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8066
  8067     MOVE CM-CREDIT-INTERFACE-SW-1
  8068                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8069     MOVE CM-CREDIT-INTERFACE-SW-2
  8070                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8071
  8072     IF CM-O-B-COVERAGE
  8073         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8074
  8075     IF CM-LIVES NOT NUMERIC
  8076         MOVE ZERO                TO CM-LIVES.
  8077
  8078     IF CM-BILLED NOT NUMERIC
  8079         MOVE ZERO                TO CM-BILLED.
  8080
  8081     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8082         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8083         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8084         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8085         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8086         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8087         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8088         MOVE CM-LIVES             TO PB-CI-LIVES
  8089*The next line causes a problem with my change  I dont think it is
  8090*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8091
  8092     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8093     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8094     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8095     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8096     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8097     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8098
  8099     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8100     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8101     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8102     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8103
  8104     IF CM-LIFE-COMM-PCT NUMERIC
  8105         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8106     ELSE
  8107         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8108
  8109     IF CM-AH-COMM-PCT NUMERIC
  8110         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8111     ELSE
  8112         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8113
  8114     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8115
  8116     IF CM-LOAN-APR       NOT NUMERIC
  8117           MOVE ZERO               TO CM-LOAN-APR.
  8118
  8119     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8120           MOVE ZERO               TO CM-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 150
* EL050.cbl
  8121
  8122     IF CM-LOAN-TERM      NOT NUMERIC
  8123           MOVE ZERO               TO CM-LOAN-TERM.
  8124
  8125     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8126           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8127
  8128     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8129           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8130
  8131     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8132     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8133     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8134     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8135     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8136     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8137     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8138     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8139     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8140     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8141     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8142     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8143
  8144     IF CM-STATE = CM-SSN-STATE
  8145         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8146
  8147     IF CM-STATE NOT = CM-MEMB-STATE
  8148         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8149
  8150     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8151
  8152     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8153        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8154        IF CM-ADDL-CLP NOT NUMERIC
  8155           MOVE +0               TO CM-ADDL-CLP
  8156        END-IF
  8157        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8158        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8159           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8160        END-IF
  8161     END-IF
  8162     IF PB-COMPANY-ID = 'DCC'
  8163        MOVE +0                  TO WS-ADMIN-FEES
  8164                                    WS-CSO-ADMIN-FEE
  8165                                    WS-COMM-AND-MFEE
  8166                                    WS-1ST-YR-ALLOW
  8167        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8168           (SUB5 > +10)
  8169           MOVE +0 TO WS-WK-RATE
  8170           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8171              IF (AM-A-COM (SUB5) NUMERIC)
  8172                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8173                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8174              ELSE
  8175                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8176                 IF PB-ISSUE
  8177                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8178                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 151
* EL050.cbl
  8179                 ELSE
  8180                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8181                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8182                 END-IF
  8183                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8184                 MOVE ZEROS             TO WS-SUB1
  8185                                           WS-COMMISSION
  8186                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8187                 MOVE '0530'               TO CTBL-SW
  8188                 MOVE ' '                  TO WS-CTBL-READ-SW
  8189                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8190                 IF FIRST-TIME-THROUGH
  8191                    MOVE 'AA'              TO CTBL-BEN-CODE
  8192                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8193                 END-IF
  8194                 IF CTBL-TABLE-FOUND
  8195                    IF PB-ISSUE
  8196                       COMPUTE WS-COMM-CK-AMT =
  8197                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8198                    ELSE
  8199                       COMPUTE WS-COMM-CK-AMT =
  8200                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8201                    END-IF
  8202                    PERFORM 8800-GET-COMP-RATE
  8203                              THRU 8800-EXIT
  8204                 END-IF
  8205              END-IF
  8206              IF AM-COM-TYP (SUB5) = 'I'
  8207                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8208                   + (WS-WK-RATE * 1000)
  8209              END-IF
  8210              IF AM-COM-TYP (SUB5) = 'N'
  8211                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8212                   + (WS-WK-RATE * 1000)
  8213              END-IF
  8214              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8215                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8216                   + (WS-WK-RATE * 1000)
  8217              END-IF
  8218              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8219                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8220                   + (WS-WK-RATE * 1000)
  8221              END-IF
  8222           END-IF
  8223        END-PERFORM
  8224     END-IF
  8225     GO TO 0300-CONTINUE-EDIT.
  8226
  8227 0298-UNLOCK-RETURN.
  8228      PERFORM 9250-UNLOCK-RETURN
  8229      GO TO 9990-RETURN.
  8230
  8231 0299-CERT-NOT-FOUND.
  8232
  8233     MOVE '1'                     TO CERT-STATUS-SW.
  8234
  8235     IF PB-COMPANY-ID = 'UCL'
  8236         IF WS-ERROR = ER-2799
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 152
* EL050.cbl
  8237             GO TO 3000-CONTINUE-EDIT.
  8238
  8239     IF NOT PB-CANCELLATION
  8240         GO TO 0300-CONTINUE-EDIT.
  8241
  8242     MOVE ER-2726                  TO  WS-ERROR.
  8243     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8244     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8245     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8246                                    PB-CI-LF-TERM
  8247                                    PB-C-LF-REM-TERM
  8248                                    PB-CI-AH-TERM
  8249                                    PB-C-AH-REM-TERM
  8250                                    PB-CI-LF-BENEFIT-CD
  8251                                    PB-CI-LF-BENEFIT-AMT
  8252                                    PB-CI-LF-ALT-BENEFIT-AMT
  8253                                    PB-CI-LF-PREMIUM-AMT
  8254                                    PB-CI-LF-ALT-PREMIUM-AMT
  8255                                    PB-CI-AH-BENEFIT-CD
  8256                                    PB-CI-AH-BENEFIT-AMT
  8257                                    PB-CI-AH-PREMIUM-AMT
  8258                                    PB-CI-PAY-FREQUENCY
  8259                                    PB-CI-LOAN-APR
  8260                                    PB-CI-LOAN-TERM
  8261                                    PB-CI-LIFE-COMMISSION
  8262                                    PB-CI-AH-COMMISSION
  8263                                    PB-CI-CURR-SEQ
  8264                                    PB-CI-AH-CANCEL-AMT
  8265                                    PB-CI-LF-CANCEL-AMT
  8266                                    PB-CI-RATE-DEV-PCT-LF
  8267                                    PB-CI-RATE-DEV-PCT-AH
  8268                                    PB-CI-EXTENTION-DAYS
  8269                                    PB-CI-TERM-IN-DAYS
  8270                                    PB-CI-LIVES
  8271                                    PB-CI-LF-CRIT-PER
  8272                                    PB-CI-AH-CRIT-PER
  8273                                    PB-CI-ADDL-CLP
  8274                                    PB-CI-DDF-IU-RATE-UP.
  8275
  8276     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8277                                    PB-CI-AH-SETTLEMENT-DT
  8278                                    PB-CI-DEATH-DT
  8279                                    PB-CI-LF-PRIOR-CANCEL-DT
  8280                                    PB-CI-AH-PRIOR-CANCEL-DT
  8281                                    PB-CI-ENTRY-DT
  8282                                    PB-CI-LF-EXPIRE-DT
  8283                                    PB-CI-AH-EXPIRE-DT
  8284                                    PB-CI-LOAN-1ST-PMT-DT.
  8285
  8286     IF ACCOUNT-MAST-FOUND
  8287        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8288        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8289
  8290     GO TO 3000-CONTINUE-EDIT.
  8291
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 153
* EL050.cbl
  8293
  8294 0300-CONTINUE-EDIT.
  8295
  8296     IF PB-ISSUE
  8297        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8298            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8299
  8300     IF PB-ISSUE
  8301        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8302            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8303
  8304     IF PB-ISSUE
  8305       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8306          (AM-NO-AH-ONLY)
  8307           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8308               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8309                   MOVE ER-2679 TO WS-ERROR
  8310                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8311
  8312     IF PB-ISSUE
  8313        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8314        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8315        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8316     ELSE
  8317        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8318        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8319        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8320
  8321     MOVE 'N'                    TO PLAN-MASTER-SW
  8322                                    PLAN-MASTER-LIFE-SW
  8323                                    FORM-MASTER-SW
  8324                                    WS-APP-CERT-SW.
  8325
  8326     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8327                                    WS-PL-TOL-LF-REFUND
  8328                                    WS-PL-REF-OVS-AMT
  8329                                    WS-PL-TOL-LF-PREM-PCT
  8330                                    WS-PL-TOL-LF-REFUND-PCT
  8331                                    WS-PL-REF-OVS-PCT
  8332                                    WS-PL-TOL-LF-CLAIM.
  8333
  8334     IF PB-COMPANY-ID = 'NCL'
  8335       IF PB-ISSUE
  8336         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8337             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8338             IF FORM-MASTER-FOUND
  8339                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8340
  8341     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8342        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8343
  8344********************** MON CODE **********************
  8345     IF PB-COMPANY-ID = 'MON'
  8346     IF PB-ISSUE
  8347     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8348        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8349             PB-I-LOAN-APR = ZERO)
  8350               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 154
* EL050.cbl
  8351******************************************************
  8352
  8353     IF PB-COMPANY-ID = 'NCL'
  8354       IF PB-ISSUE
  8355           IF FORM-MASTER-FOUND
  8356             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8357                AM-DISMBR-COVERAGE
  8358                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8359                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8360                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8361                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8362                                           PB-I-LIFE-BENEFIT-CD.
  8363
  8364     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8365
  8366     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8367         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8368         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8369         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8370         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8371         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8372           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8373             GO TO 0301-LIFE-BENEFIT-SEARCH
  8374         ELSE
  8375             NEXT SENTENCE
  8376     ELSE
  8377         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8378
  8379     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8380     MOVE '4'                    TO CNTL-REC-TYPE.
  8381     MOVE +0                     TO CNTL-SEQ-NO.
  8382     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8383
  8384     MOVE '1' TO RC-SW-2.
  8385     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8386
  8387     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8388        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8389         GO TO 0305-BENEFIT-NOT-FOUND.
  8390
  8391     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8392
  8393 0301-LIFE-BENEFIT-SEARCH.
  8394
  8395     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8396
  8397     IF NO-BENEFIT-FOUND
  8398        GO TO 0305-BENEFIT-NOT-FOUND.
  8399
  8400     IF WS-BEN-CD = '99'
  8401        GO TO 0305-BENEFIT-NOT-FOUND.
  8402
  8403     IF PB-COMPANY-ID = 'NCL'
  8404         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8405             GO TO 0304-LIFE-BENEFIT-FOUND.
  8406
  8407     MOVE +1                     TO SUB5.
  8408     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 155
* EL050.cbl
  8409
  8410* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8411* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8412     IF PB-COMPANY-ID = 'DMD'
  8413         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8414
  8415 0302-EDIT-ACCT-LF-BENEFITS.
  8416
  8417     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8418        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8419           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8420                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8421           GO TO 03XX-GET-LIFE-ERPLAN.
  8422
  8423     IF SUB5 LESS THAN +20
  8424        ADD +1                   TO SUB5
  8425        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8426
  8427     MOVE +1                     TO SUB5.
  8428
  8429     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8430        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8431
  8432 0303-EDIT-DMD-EXTRA-BENEFITS.
  8433
  8434     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8435        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8436           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8437                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8438           GO TO 03XX-GET-LIFE-ERPLAN.
  8439
  8440     IF SUB5 LESS THAN +30
  8441        ADD +1                   TO SUB5
  8442        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8443
  8444     MOVE +1                     TO SUB5.
  8445
  8446 03XX-EDIT-FOR-NINETY-LF.
  8447
  8448***************************************************************
  8449*                                                             *
  8450*    NINETY BENEFIT PLAN TYPES:                               *
  8451*                                                             *
  8452*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8453*      92 = ALL GROUP REDUCING BENEFITS                       *
  8454*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8455*      94 = ALL GROUP LEVEL BENEFITS                          *
  8456*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8457*           BENEFIT CONTROLS.                                 *
  8458*      99 = ALL BENEFITS                                      *
  8459*                                                             *
  8460***************************************************************
  8461
  8462     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8463                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8464
  8465     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8466       AND
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 156
* EL050.cbl
  8467        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8468        GO TO 03XX-GET-LIFE-ERPLAN.
  8469
  8470     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8471       AND
  8472        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8473        IF CF-REDUCING (SUB3)
  8474           IF (PB-I-INDV-GRP-OVRD = 'I')
  8475              OR
  8476           ((AM-IG = '1') AND
  8477           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8478              OR
  8479           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8480           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8481           (AM-IG NOT = '2'))
  8482              GO TO 03XX-GET-LIFE-ERPLAN.
  8483
  8484     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8485       AND
  8486        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8487        IF CF-REDUCING (SUB3)
  8488           IF (PB-I-INDV-GRP-OVRD = 'G')
  8489              OR
  8490           ((AM-IG = '2') AND
  8491           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8492              OR
  8493           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8494           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8495           (AM-IG NOT = '1'))
  8496              GO TO 03XX-GET-LIFE-ERPLAN.
  8497
  8498     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8499       AND
  8500        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8501        IF CF-LEVEL    (SUB3)
  8502           IF (PB-I-INDV-GRP-OVRD = 'I')
  8503              OR
  8504           ((AM-IG = '1') AND
  8505           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8506              OR
  8507           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8508           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8509            (AM-IG NOT = '2'))
  8510              GO TO 03XX-GET-LIFE-ERPLAN.
  8511
  8512     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8513       AND
  8514        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8515        IF CF-LEVEL    (SUB3)
  8516           IF (PB-I-INDV-GRP-OVRD = 'G')
  8517              OR
  8518           ((AM-IG = '2') AND
  8519           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8520              OR
  8521           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8522           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8523           (AM-IG NOT = '1'))
  8524              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 157
* EL050.cbl
  8525
  8526     IF SUB5 LESS THAN +20
  8527        ADD +1                   TO SUB5
  8528        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8529
  8530     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8531
  8532     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8533        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8534
  8535     MOVE +1                     TO SUB5.
  8536
  8537 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8538
  8539     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8540                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8541
  8542     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8543       AND
  8544        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8545        GO TO 03XX-GET-LIFE-ERPLAN.
  8546
  8547     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8548       AND
  8549        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8550        IF CF-REDUCING (SUB3)
  8551           IF (PB-I-INDV-GRP-OVRD = 'I')
  8552              OR
  8553           ((AM-IG = '1') AND
  8554           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8555              OR
  8556           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8557           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8558           (AM-IG NOT = '2'))
  8559              GO TO 03XX-GET-LIFE-ERPLAN.
  8560
  8561     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8562       AND
  8563        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8564        IF CF-REDUCING (SUB3)
  8565           IF (PB-I-INDV-GRP-OVRD = 'G')
  8566              OR
  8567           ((AM-IG = '2') AND
  8568           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8569              OR
  8570           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8571           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8572           (AM-IG NOT = '1'))
  8573              GO TO 03XX-GET-LIFE-ERPLAN.
  8574
  8575     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8576       AND
  8577        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8578        IF CF-LEVEL    (SUB3)
  8579           IF (PB-I-INDV-GRP-OVRD = 'I')
  8580              OR
  8581           ((AM-IG = '1') AND
  8582           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 158
* EL050.cbl
  8583              OR
  8584           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8585           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8586            (AM-IG NOT = '2'))
  8587              GO TO 03XX-GET-LIFE-ERPLAN.
  8588
  8589     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8590       AND
  8591        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8592        IF CF-LEVEL    (SUB3)
  8593           IF (PB-I-INDV-GRP-OVRD = 'G')
  8594              OR
  8595           ((AM-IG = '2') AND
  8596           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8597              OR
  8598           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8599           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8600           (AM-IG NOT = '1'))
  8601              GO TO 03XX-GET-LIFE-ERPLAN.
  8602
  8603     IF SUB5 LESS THAN +30
  8604        ADD +1                   TO SUB5
  8605        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8606
  8607     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8608
  8609 03XX-EDIT-FOR-NINETY-LF-CONT.
  8610
  8611     MOVE +99                    TO SUB5.
  8612
  8613     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8614        IF PB-ISSUE
  8615           MOVE ER-1924          TO  WS-ERROR
  8616           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8617
  8618     GO TO 0304-LIFE-BENEFIT-FOUND.
  8619
  8620 03XX-GET-LIFE-ERPLAN.
  8621
  8622     IF WK-PLAN-ADDR EQUAL +0
  8623        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8624
  8625     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8626     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8627     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8628     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8629     MOVE 'Y'                    TO PLAN-MASTER-SW
  8630                                    PLAN-MASTER-LIFE-SW.
  8631     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8632
  8633 03XX-ERPLAN-LIFE-GETMAIN.
  8634
  8635     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8636     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8637
  8638 03XX-ERPLAN-LIFE-READ.
  8639
  8640     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 159
* EL050.cbl
  8641     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8642     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8643     MOVE PB-SV-STATE            TO PLAN-STATE.
  8644     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8645     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8646     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8647     MOVE WS-SAVE-BENEFIT-REVISION
  8648                                 TO PLAN-REVISION-NO.
  8649
  8650     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8651     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8652
  8653     IF PB-COMPANY-ID = 'NCL'
  8654       IF NOT LF-PLAN-MASTER-FOUND
  8655         IF NOT PB-POLICY-IS-DECLINED  AND
  8656            NOT PB-POLICY-IS-VOIDED
  8657             MOVE  ER-1921         TO  WS-ERROR
  8658             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8659             GO TO 0304-LIFE-BENEFIT-FOUND.
  8660
  8661     IF NOT LF-PLAN-MASTER-FOUND
  8662        GO TO 0304-LIFE-BENEFIT-FOUND.
  8663
  8664 XXXX-CHECK-LF-PLAN-KEY.
  8665
  8666     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8667        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8668        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8669        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8670        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8671        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8672        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8673        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8674        MOVE 'N'                 TO PLAN-MASTER-SW
  8675          GO TO 03XX-ERPLAN-LIFE-READ.
  8676
  8677     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8678
  8679     IF  PB-CANCELLATION
  8680         GO TO  0303-LF-ACCT-BEN-FOUND.
  8681
  8682     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8683        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8684           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8685           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8686              MOVE ER-2644             TO WS-ERROR
  8687              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8688           ELSE
  8689              NEXT SENTENCE
  8690        ELSE
  8691           IF PB-COMPANY-ID NOT = 'NCL'
  8692              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8693                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8694
  8695 0303-LF-ACCT-BEN-FOUND.
  8696
  8697     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8698
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 160
* EL050.cbl
  8699     IF PL-DEV-CODE NOT = SPACES
  8700        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8701
  8702     IF PL-DEV-PCT NUMERIC AND
  8703        PL-DEV-PCT NOT = ZEROS
  8704        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8705
  8706     IF PL-TOL-PREM-AMT GREATER THAN +0
  8707        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8708
  8709     IF PL-TOL-REF-AMT GREATER THAN +0
  8710        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8711
  8712     IF PL-TOL-PREM-PCT GREATER THAN +0
  8713        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8714
  8715     IF PL-TOL-REF-PCT GREATER THAN +0
  8716        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8717
  8718     IF PL-TOL-CLM-AMT GREATER THAN +0
  8719        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8720
  8721     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8722                          PL-OVER-SHORT-AMT > +0
  8723        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8724
  8725     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8726                          PL-OVER-SHORT-PCT > +0
  8727        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8728
  8729     IF PL-SALES-TAX NUMERIC AND
  8730                          PL-SALES-TAX > +0
  8731         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8732
  8733     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8734        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8735                                    WS-IG-OVRD-AM.
  8736
  8737 0304-LIFE-BENEFIT-FOUND.
  8738
  8739     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8740
  8741     IF PB-ISSUE
  8742        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8743     ELSE
  8744        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8745
  8746     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8747     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8748     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8749     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8750     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8751                                         WS-LF-REFUND-CALC.
  8752
  8753     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8754        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8755
  8756     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 161
* EL050.cbl
  8757        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8758     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8759
  8760     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8761     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8762     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8763     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8764     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8765     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8766
  8767     IF PB-COMPANY-ID = 'NCL'  AND
  8768        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8769         NEXT SENTENCE
  8770     ELSE
  8771         IF SUB5 NOT GREATER THAN +20
  8772            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8773               MOVE WS-SAVE-BENEFIT-REM-TERM
  8774                                      TO WS-AM-LF-BENE-REM-TERM
  8775                                         EC-BR-LF-REM-TERM-CALC.
  8776
  8777     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8778     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8779
  8780     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8781
  8782 0305-BENEFIT-NOT-FOUND.
  8783
  8784     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8785     MOVE ER-2604                TO WS-ERROR.
  8786     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8787
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 162
* EL050.cbl
  8789
  8790 0310-FIND-AH-BENEFIT-RECORD.
  8791
  8792     MOVE 'N'                    TO PLAN-MASTER-SW
  8793                                    PLAN-MASTER-AH-SW.
  8794
  8795     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8796                                    WS-PL-TOL-AH-REFUND
  8797                                    WS-AH-PL-REF-OVS-AMT
  8798                                    WS-PL-TOL-AH-PREM-PCT
  8799                                    WS-PL-TOL-AH-REFUND-PCT
  8800                                    WS-AH-PL-REF-OVS-PCT
  8801                                    WS-PL-TOL-AH-CLAIM.
  8802     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8803
  8804
  8805     if pb-issue
  8806        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8807           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8808        end-if
  8809        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8810           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8811           GO TO 0399-BENEFIT-NOT-FOUND
  8812        end-if
  8813     end-if
  8814
  8815     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8816        GO TO 0400-FIND-CARRIER.
  8817
  8818     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8819
  8820     IF WK-AH-BEN-ADDR NOT = ZEROS
  8821         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8822         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8823         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8824         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8825           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8826             GO TO 0311-AH-BENEFIT-SEARCH
  8827         ELSE
  8828             NEXT SENTENCE
  8829     ELSE
  8830         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8831
  8832     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8833     MOVE '5'                    TO CNTL-REC-TYPE.
  8834     MOVE +0                     TO CNTL-SEQ-NO.
  8835     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8836
  8837     MOVE '2' TO RC-SW-2.
  8838     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8839
  8840     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8841        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8842          GO TO 0399-BENEFIT-NOT-FOUND.
  8843
  8844     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8845
  8846 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 163
* EL050.cbl
  8847
  8848     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8849
  8850     IF NO-BENEFIT-FOUND
  8851         GO TO 0399-BENEFIT-NOT-FOUND.
  8852
  8853     IF WS-BEN-CD = '99'
  8854        GO TO 0399-BENEFIT-NOT-FOUND.
  8855
  8856     IF PB-COMPANY-ID  =  'NCL'
  8857         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8858             GO TO 0314-A-H-BENEFIT-FOUND.
  8859
  8860     MOVE +1                     TO SUB5.
  8861     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8862
  8863* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8864* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8865     IF PB-COMPANY-ID = 'DMD'
  8866         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8867
  8868 0312-EDIT-ACCT-AH-BENEFITS.
  8869
  8870     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8871        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8872           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8873                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8874           GO TO 03XX-GET-AH-ERPLAN.
  8875
  8876     IF SUB5 LESS THAN +20
  8877        ADD +1                   TO SUB5
  8878        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8879
  8880     MOVE +1                     TO SUB5.
  8881
  8882     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8883        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8884
  8885 0313-EDIT-DMD-EXTRA-BENEFITS.
  8886
  8887     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8888        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8889           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8890                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8891           GO TO 03XX-GET-AH-ERPLAN.
  8892
  8893     IF SUB5 LESS THAN +30
  8894        ADD +1                   TO SUB5
  8895        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8896
  8897     MOVE +1                     TO SUB5.
  8898
  8899 03XX-EDIT-FOR-NINETY-AH.
  8900
  8901***************************************************************
  8902*                                                             *
  8903*    NINETY BENEFIT PLAN TYPES:                               *
  8904*                                                             *
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 164
* EL050.cbl
  8905*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8906*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8907*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8908*           BENEFIT CONTROLS.                                 *
  8909*      99 = ALL BENEFITS.                                     *
  8910*                                                             *
  8911***************************************************************
  8912
  8913     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8914                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8915
  8916     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8917       AND
  8918        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8919        GO TO 03XX-GET-AH-ERPLAN.
  8920
  8921     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8922       AND
  8923        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8924           IF (PB-I-INDV-GRP-OVRD = 'I')
  8925              OR
  8926           ((AM-IG = '1') AND
  8927           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8928              OR
  8929           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8930           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8931           (AM-IG NOT = '2'))
  8932              GO TO 03XX-GET-AH-ERPLAN.
  8933
  8934     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8935       AND
  8936        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8937           IF (PB-I-INDV-GRP-OVRD = 'G')
  8938              OR
  8939           ((AM-IG = '2') AND
  8940           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8941              OR
  8942           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8943           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8944           (AM-IG NOT = '1'))
  8945              GO TO 03XX-GET-AH-ERPLAN.
  8946
  8947     IF SUB5 LESS THAN +20
  8948        ADD +1                   TO SUB5
  8949        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8950
  8951     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8952        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8953
  8954     MOVE +1                    TO SUB5.
  8955
  8956 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8957
  8958     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8959                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8960
  8961     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8962       AND
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 165
* EL050.cbl
  8963        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8964        GO TO 03XX-GET-AH-ERPLAN.
  8965
  8966     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8967       AND
  8968        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8969           IF (PB-I-INDV-GRP-OVRD = 'I')
  8970              OR
  8971           ((AM-IG = '1') AND
  8972           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8973              OR
  8974           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8975           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8976           (AM-IG NOT = '2'))
  8977              GO TO 03XX-GET-AH-ERPLAN.
  8978
  8979     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8980       AND
  8981        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8982           IF (PB-I-INDV-GRP-OVRD = 'G')
  8983              OR
  8984           ((AM-IG = '2') AND
  8985           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8986              OR
  8987           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8988           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8989           (AM-IG NOT = '1'))
  8990              GO TO 03XX-GET-AH-ERPLAN.
  8991
  8992     IF SUB5 LESS THAN +30
  8993        ADD +1                   TO SUB5
  8994        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8995
  8996 03XX-EDIT-FOR-NINETY-AH-CONT.
  8997
  8998     MOVE +99                    TO SUB5.
  8999
  9000     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9001
  9002     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9003        IF PB-ISSUE
  9004           MOVE ER-1925          TO  WS-ERROR
  9005           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9006
  9007     GO TO 0314-A-H-BENEFIT-FOUND.
  9008
  9009 03XX-GET-AH-ERPLAN.
  9010
  9011     IF WK-PLAN-ADDR EQUAL +0
  9012         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9013
  9014     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9015     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9016     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9017     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9018     MOVE 'Y'                    TO PLAN-MASTER-SW
  9019                                    PLAN-MASTER-AH-SW.
  9020*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 166
* EL050.cbl
  9021     GO TO 03XX-ERPLAN-AH-READ.
  9022
  9023 03XX-ERPLAN-AH-GETMAIN.
  9024
  9025     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9026     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9027
  9028 03XX-ERPLAN-AH-READ.
  9029
  9030     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9031     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9032     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9033     MOVE PB-SV-STATE            TO PLAN-STATE.
  9034     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9035     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9036     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9037     MOVE WS-SAVE-BENEFIT-REVISION
  9038                                 TO PLAN-REVISION-NO.
  9039
  9040     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9041     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9042
  9043     IF PB-COMPANY-ID = 'NCL'
  9044       IF NOT AH-PLAN-MASTER-FOUND
  9045         IF NOT PB-POLICY-IS-DECLINED  AND
  9046            NOT PB-POLICY-IS-VOIDED
  9047             MOVE  ER-1922         TO  WS-ERROR
  9048             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9049             GO TO 0314-A-H-BENEFIT-FOUND.
  9050
  9051     IF NOT AH-PLAN-MASTER-FOUND
  9052        GO TO 0314-A-H-BENEFIT-FOUND.
  9053
  9054 XXXX-CHECK-AH-PLAN-KEY.
  9055
  9056     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9057        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9058        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9059        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9060        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9061        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9062        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9063        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9064        MOVE 'N'                 TO PLAN-MASTER-SW
  9065          GO TO 03XX-ERPLAN-AH-READ.
  9066
  9067     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9068
  9069     IF  PB-CANCELLATION
  9070         GO TO  0313-AH-ACCT-BEN-FOUND.
  9071
  9072     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9073       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9074          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9075          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9076             MOVE ER-2644             TO WS-ERROR
  9077             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9078          ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 167
* EL050.cbl
  9079             NEXT SENTENCE
  9080       ELSE
  9081          IF PB-COMPANY-ID NOT = 'NCL'
  9082             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9083                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9084
  9085 0313-AH-ACCT-BEN-FOUND.
  9086
  9087     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9088
  9089     IF PL-DEV-CODE NOT = SPACES
  9090        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9091
  9092     IF PL-DEV-PCT NUMERIC AND
  9093        PL-DEV-PCT NOT = ZEROS
  9094        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9095
  9096     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9097        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9098
  9099     IF PL-TOL-REF-AMT NOT EQUAL +0
  9100        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9101
  9102     IF PL-TOL-PREM-PCT GREATER THAN +0
  9103        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9104
  9105     IF PL-TOL-REF-PCT GREATER THAN +0
  9106        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9107
  9108     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9109        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9110
  9111     IF PL-OVER-SHORT-AMT NUMERIC AND
  9112                          PL-OVER-SHORT-AMT > +0
  9113        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9114
  9115     IF PL-OVER-SHORT-PCT NUMERIC AND
  9116                          PL-OVER-SHORT-PCT > +0
  9117        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9118
  9119     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9120        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9121        IF WS-IG-OVRD-AM EQUAL SPACES
  9122            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9123
  9124 0314-A-H-BENEFIT-FOUND.
  9125
  9126     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9127
  9128     IF PB-ISSUE
  9129        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9130       ELSE
  9131        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9132
  9133     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9134     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9135     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9136     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 168
* EL050.cbl
  9137                                         WS-AH-REFUND-CALC.
  9138
  9139     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9140        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9141
  9142     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9143        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9144     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9145
  9146     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9147     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9148     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9149     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9150     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9151     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9152
  9153     IF PB-COMPANY-ID = 'NCL'  AND
  9154        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9155         NEXT SENTENCE
  9156     ELSE
  9157         IF SUB5 NOT GREATER THAN +20
  9158            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9159                MOVE WS-SAVE-BENEFIT-REM-TERM
  9160                                      TO WS-AM-AH-BENE-REM-TERM
  9161                                         EC-BR-AH-REM-TERM-CALC.
  9162
  9163     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9164     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9165
  9166     GO TO 0400-FIND-CARRIER.
  9167
  9168 0399-BENEFIT-NOT-FOUND.
  9169
  9170     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9171     MOVE ER-2605                TO WS-ERROR.
  9172     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9173
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 169
* EL050.cbl
  9175
  9176 0400-FIND-CARRIER.
  9177
  9178     MOVE PB-SV-CARRIER          TO WS-CARR.
  9179
  9180     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9181     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9182     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9183     MOVE '6'                    TO CNTL-REC-TYPE.
  9184
  9185*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9186     MOVE SPACE                  TO WS-DMD-RATING-SW
  9187                                    EC-BR-DMD-RATING-SW.
  9188
  9189     MOVE '2'                    TO RC-SW-1.
  9190     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9191
  9192     IF NOT CF-CARRIER-MASTER
  9193        GO TO 0400-CARRIER-NOT-FOUND.
  9194
  9195 0400-BUILD-CARR-TOL.
  9196
  9197     IF CF-CR-TOL-PREM NUMERIC AND
  9198        CF-CR-TOL-PREM GREATER THAN +0
  9199        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9200                                    WS-TOL-AH-PREM.
  9201
  9202     IF CF-CR-TOL-REFUND NUMERIC AND
  9203        CF-CR-TOL-REFUND GREATER THAN +0
  9204        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9205                                    WS-TOL-AH-REFUND.
  9206
  9207     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9208        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9209        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9210                                    WS-AH-REFUND-OVS-AMT.
  9211
  9212     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9213        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9214        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9215                                    WS-AH-REFUND-OVS-PCT.
  9216
  9217     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9218        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9219        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9220                                    WS-TOL-AH-PREM-PCT.
  9221
  9222     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9223        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9224        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9225                                     WS-TOL-AH-REFUND-PCT.
  9226
  9227     IF CF-COMPANY-ID EQUAL 'DMD'
  9228         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9229                                    EC-BR-DMD-RATING-SW.
  9230
  9231     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9232     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 170
* EL050.cbl
  9233        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9234     END-IF
  9235     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9236        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9237     END-IF
  9238     IF WS-TOL-CLP-PCT = ZEROS
  9239        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9240     END-IF
  9241
  9242     IF WS-SPP-LEASE-COMM = ZEROS
  9243        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9244     END-IF
  9245     GO TO 0400-FIND-ERPDEF.
  9246
  9247 0400-CARRIER-NOT-FOUND.
  9248
  9249     MOVE ER-2602                TO WS-ERROR.
  9250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9251
  9252 0400-FIND-ERPDEF.
  9253     IF PB-COMPANY-ID = 'DCC'
  9254        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9255        CONTINUE
  9256     ELSE
  9257        GO TO 0400-FIND-ERCOMP
  9258     END-IF
  9259     MOVE ' '                    TO PDEF-MASTER-SW
  9260     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9261     MOVE PB-STATE               TO ERPDEF-STATE
  9262     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9263     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9264     IF PB-ISSUE
  9265        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9266     ELSE
  9267        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9268     END-IF
  9269     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9270     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9271     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9272     IF PDEF-MASTER-FOUND
  9273        MOVE 'N'                 TO PDEF-MASTER-SW
  9274        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9275        IF PDEF-MASTER-FOUND
  9276           IF (ERPDEF-KEY-SAVE (1:16) =
  9277                        PD-CONTROL-PRIMARY (1:16))
  9278              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9279              CONTINUE
  9280           ELSE
  9281              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9282              IF (ERPDEF-KEY-SAVE (1:16) =
  9283                        PD-CONTROL-PRIMARY (1:16))
  9284                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9285                 CONTINUE
  9286              ELSE
  9287                 MOVE 'N'        TO PDEF-MASTER-SW
  9288              END-IF
  9289           END-IF
  9290        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 171
* EL050.cbl
  9291        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9292     END-IF
  9293     IF PDEF-MASTER-FOUND
  9294        IF PD-TRUNCATED = 'Y'
  9295           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9296        END-IF
  9297     END-IF
  9298     .
  9299 0400-FIND-ERCOMP.
  9300     IF PB-COMPANY-ID = 'DCC'
  9301        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9302           (WS-SUB1 > +10)
  9303           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9304                 OR 'A' OR 'N'
  9305              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9306              MOVE PB-CARRIER    TO COMP-CARRIER
  9307              MOVE PB-GROUPING   TO COMP-GROUPING
  9308              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9309              MOVE AM-AGT (WS-SUB1)
  9310                                 TO COMP-FIN-RESP
  9311              MOVE 'G'           TO COMP-TYPE
  9312              PERFORM 8582-READ-COMPENSATION-MASTER
  9313                                 THRU 8582-EXIT
  9314              IF COMP-MASTER-FOUND
  9315                 IF CO-GA-INACTIVE
  9316                    MOVE ER-2763 TO WS-ERROR
  9317                    PERFORM 9900-ERROR-FORMAT
  9318                                 THRU 9900-EXIT
  9319                    MOVE +11     TO WS-SUB1
  9320                 END-IF
  9321                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9322                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9323                    MOVE ER-2788 TO WS-ERROR
  9324                    PERFORM 9900-ERROR-FORMAT
  9325                                 THRU 9900-EXIT
  9326                    MOVE +11     TO WS-SUB1
  9327                 END-IF
  9328              END-IF
  9329           END-IF
  9330        END-PERFORM
  9331     END-IF
  9332     IF PB-COMPANY-ID = 'DCC'
  9333        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9334           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9335                                    WS-CLP-STATE
  9336        ELSE
  9337           MOVE SPACES           TO PB-I-CLP-STATE
  9338                                    WS-CLP-STATE
  9339        END-IF
  9340     END-IF
  9341
  9342     IF (PB-COMPANY-ID = 'DCC')
  9343        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9344        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9345        CONTINUE
  9346     ELSE
  9347        GO TO 0400-FIND-STATE-RECORD
  9348     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 172
* EL050.cbl
  9349     MOVE SPACES                 TO WS-CLP-STATE
  9350     MOVE +0                     TO WS-BANK-FEE
  9351                                    WS-BANK-LFEE
  9352                                    WS-BANK-NOCHRGB
  9353
  9354     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9355     IF (PB-ISSUE)
  9356        AND (PB-I-BANK-NUMBER NOT =
  9357            SPACES AND ZEROS AND LOW-VALUES)
  9358        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9359     ELSE
  9360        IF (PB-CANCELLATION)
  9361           AND (PB-CI-BANK-NUMBER NOT =
  9362                SPACES AND ZEROS AND LOW-VALUES)
  9363           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9364        END-IF
  9365     END-IF
  9366     IF COMP-FIN-RESP NOT = LOW-VALUES
  9367        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9368        MOVE PB-CARRIER          TO COMP-CARRIER
  9369        MOVE PB-GROUPING         TO COMP-GROUPING
  9370        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9371        MOVE 'B'                 TO COMP-TYPE
  9372        PERFORM 8582-READ-COMPENSATION-MASTER
  9373                                 THRU 8582-EXIT
  9374        IF COMP-MASTER-FOUND
  9375           IF CO-MAX-BANK-FEE NOT NUMERIC
  9376              MOVE +0            TO CO-MAX-BANK-FEE
  9377           END-IF
  9378           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9379              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9380           END-IF
  9381           IF CO-GA-INACTIVE
  9382              MOVE ER-2763       TO WS-ERROR
  9383              PERFORM 9900-ERROR-FORMAT
  9384                                 THRU 9900-EXIT
  9385           END-IF
  9386           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9387              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9388              MOVE ER-2788 TO WS-ERROR
  9389              PERFORM 9900-ERROR-FORMAT
  9390                                 THRU 9900-EXIT
  9391              MOVE +11     TO WS-SUB1
  9392           END-IF
  9393           IF WS-AH-BEN-CATEGORY = 'G'
  9394              MOVE CO-MAX-BANK-FEE
  9395                                 TO WS-BANK-FEE
  9396                                    PB-I-BANK-FEE
  9397           ELSE
  9398              MOVE CO-MAX-BANK-FEE-LEASE
  9399                                 TO WS-BANK-LFEE
  9400                                    PB-I-BANK-FEE
  9401           END-IF
  9402           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9403              AND (WS-AH-REFUND-CALC = 'G'))
  9404                        OR
  9405              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9406              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 173
* EL050.cbl
  9407              CONTINUE
  9408           ELSE
  9409              MOVE ER-2789 TO WS-ERROR
  9410              PERFORM 9900-ERROR-FORMAT
  9411                                 THRU 9900-EXIT
  9412           END-IF
  9413           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9414                                    PB-I-CLP-STATE
  9415           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9416           MOVE CO-CARRIER       TO BXRF-CARRIER
  9417           MOVE CO-GROUPING      TO BXRF-GROUPING
  9418           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9419           MOVE BXRF-MAX-REC-LENGTH
  9420                                 TO BXRF-REC-LENGTH
  9421           PERFORM 8584-READ-BANK-CROSS-REF
  9422                                 THRU 8584-EXIT
  9423           IF BXRF-MASTER-FOUND
  9424              MOVE ' '           TO BANK-ACCT-SW
  9425              MOVE BK-BANK-POINTER-CNT
  9426                                 TO BK-BANK-POINTER-CNT
  9427              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9428                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9429                 OR (BANK-ACCT-FOUND)
  9430                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9431                    AND (BK-AM-EXP-DT (WS-SUB1)
  9432                                 > PB-CERT-EFF-DT)
  9433                    AND (BK-AM-EFF-DT (WS-SUB1)
  9434                                 NOT > PB-CERT-EFF-DT)
  9435                    SET BANK-ACCT-FOUND TO TRUE
  9436                 END-IF
  9437              END-PERFORM
  9438              IF NOT BANK-ACCT-FOUND
  9439                 MOVE ZEROS      TO WS-BANK-FEE
  9440                                    WS-BANK-LFEE
  9441                 MOVE ER-2869    TO WS-ERROR
  9442                 PERFORM 9900-ERROR-FORMAT
  9443                                 THRU 9900-EXIT
  9444              ELSE
  9445                 PERFORM 5000-PROCESS-REPS
  9446                                 THRU 5000-EXIT
  9447                 IF AGENT-MASTER-FOUND
  9448                    MOVE +0      TO WS-BANK-FEE
  9449                                    WS-BANK-LFEE
  9450*                   MOVE AG-SPP-FEES (1)
  9451*                                TO PB-I-BANK-FEE
  9452*                                   WS-BANK-FEE
  9453                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9454                       (WS-SUB1 > +10)
  9455                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9456                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9457                       END-IF
  9458                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9459                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9460                       END-IF
  9461                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9462                          AG-SPP-FEES (WS-SUB1)
  9463                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9464                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 174
* EL050.cbl
  9465                    END-PERFORM
  9466                    IF WS-AH-BEN-CATEGORY = 'G'
  9467                       MOVE WS-BANK-FEE
  9468                                 TO PB-I-BANK-FEE
  9469                    ELSE
  9470                       MOVE WS-BANK-LFEE
  9471                                 TO PB-I-BANK-FEE
  9472                    END-IF
  9473                 END-IF
  9474              END-IF
  9475           END-IF
  9476        ELSE
  9477           MOVE ER-2879          TO WS-ERROR
  9478           PERFORM 9900-ERROR-FORMAT
  9479                                 THRU 9900-EXIT
  9480        END-IF
  9481     ELSE
  9482        MOVE ER-2879             TO WS-ERROR
  9483        PERFORM 9900-ERROR-FORMAT
  9484                                 THRU 9900-EXIT
  9485     END-IF
  9486     IF WS-AH-BEN-CATEGORY = 'G'
  9487        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9488        + WS-BANK-FEE
  9489     ELSE
  9490        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9491        + WS-BANK-LFEE
  9492     END-IF
  9493     .
  9494 0400-FIND-STATE-RECORD.
  9495
  9496     IF WK-STATE-ADDR NOT = ZEROS
  9497         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9498         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9499         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9500         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9501         IF PB-SV-STATE = CF-STATE-CODE
  9502             GO TO 0405-CONTINUE-EDIT
  9503         ELSE
  9504             NEXT SENTENCE
  9505     ELSE
  9506         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9507
  9508     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9509     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9510     MOVE '3'                    TO CNTL-REC-TYPE.
  9511     MOVE +0                     TO CNTL-SEQ-NO.
  9512
  9513     MOVE '3'                    TO RC-SW-2.
  9514     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9515
  9516     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9517        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9518        PB-SV-STATE   NOT = CF-STATE-CODE)
  9519        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9520                                    WS-TOL-AH-CLAIM
  9521                                    WS-MINIMUM-REFUND
  9522                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 175
* EL050.cbl
  9523                                    WS-TOL-AH-PREM
  9524                                    WS-TOL-LF-REFUND
  9525                                    WS-TOL-AH-REFUND
  9526                                    EC-ST-TOL-PREM-PCT
  9527                                    WS-TOL-LF-PREM-PCT
  9528                                    WS-TOL-AH-PREM-PCT
  9529                                    EC-ST-TOL-REFUND-PCT
  9530                                    WS-TOL-LF-REFUND-PCT
  9531                                    WS-TOL-AH-REFUND-PCT
  9532                                    EC-ST-TOL-PREM
  9533                                    EC-ST-TOL-REFUND
  9534                                    EC-ST-FST-PMT-DAYS-MAX
  9535                                    WS-FREE-LOOK-PERIOD
  9536                                    WS-ST-LF-PREM-TAX
  9537                                    WS-ST-AH-PREM-TAX-I
  9538                                    WS-ST-AH-PREM-TAX-G
  9539                                    WS-BANK-FEE
  9540                                    WS-BANK-LFEE
  9541                                    WS-TOL-CLP-PCT
  9542                                    WS-SPP-LEASE-COMM
  9543        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9544                                    EC-ST-FST-PMT-DAYS-CHG
  9545                                    WS-LF-REM-TERM-CALC
  9546                                    WS-LF-REFUND-CALC
  9547                                    EC-ST-LF-REM-TERM-CALC
  9548                                    EC-ST-LF-REFUND-CALC
  9549                                    WS-AH-REM-TERM-CALC
  9550                                    WS-AH-REFUND-CALC
  9551                                    WS-LF-BEN-CATEGORY
  9552                                    WS-AH-BEN-CATEGORY
  9553                                    WS-CLP-STATE
  9554                                    WS-ST-REFUND-CLAIM-FLAG
  9555                                    EC-ST-AH-REM-TERM-CALC
  9556                                    EC-ST-AH-REFUND-CALC
  9557          GO TO 0499-STATE-NOT-FOUND.
  9558
  9559     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9560
  9561 0405-CONTINUE-EDIT.
  9562
  9563     if pb-company-id = 'AHL'
  9564        continue
  9565     else
  9566        IF PB-CERT-PRIME NOT NUMERIC
  9567           MOVE ER-2722          TO WS-ERROR
  9568           PERFORM 9900-ERROR-FORMAT
  9569                                 THRU 9900-EXIT
  9570        end-if
  9571     END-IF
  9572*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9573*       MOVE +0                  TO SUB3
  9574*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9575*       IF SUB3 > +0
  9576*          MOVE ER-2722          TO WS-ERROR
  9577*          PERFORM 9900-ERROR-FORMAT
  9578*                                THRU 9900-EXIT
  9579*       END-IF
  9580*    END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 176
* EL050.cbl
  9581*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9582*       IF PB-CERT-PRIME NOT NUMERIC
  9583*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9584*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9585*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9586*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9587*
  9588*          MOVE ER-2722          TO WS-ERROR
  9589*          PERFORM 9900-ERROR-FORMAT
  9590*                                THRU 9900-EXIT
  9591*       END-IF
  9592*    END-IF
  9593
  9594     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9595
  9596     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9597        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9598                                    WS-TOL-AH-CLAIM.
  9599
  9600     IF CF-ST-REFUND-MIN NOT NUMERIC
  9601        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9602
  9603     IF CF-ST-REFUND-MIN NOT = ZEROS
  9604        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9605
  9606     IF CF-ST-TOL-PREM  NOT = ZEROS
  9607        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9608                                    WS-TOL-AH-PREM
  9609        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9610
  9611     IF CF-ST-TOL-REFUND NOT = ZEROS
  9612        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9613                                    WS-TOL-AH-REFUND
  9614        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9615
  9616     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9617        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9618        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9619                                    WS-AH-REFUND-OVS-AMT
  9620                                    EC-ST-OVR-SHT-AMT.
  9621
  9622     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9623        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9624        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9625                                    WS-TOL-LF-PREM-PCT
  9626                                    WS-TOL-AH-PREM-PCT.
  9627
  9628     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9629        CF-ST-TOL-REF-PCT GREATER THAN +0
  9630        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9631                                    WS-TOL-LF-REFUND-PCT
  9632                                    WS-TOL-AH-REFUND-PCT.
  9633
  9634     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9635        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9636        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9637                                    WS-AH-REFUND-OVS-PCT
  9638                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 177
* EL050.cbl
  9639
  9640     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9641     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9642
  9643     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9644          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9645
  9646     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9647     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9648     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9649
  9650     IF CF-ST-LF-PREM-TAX NUMERIC
  9651        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9652     END-IF
  9653     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9654        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9655     END-IF
  9656     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9657        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9658     END-IF
  9659
  9660     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9661         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9662     END-IF.
  9663
  9664     IF WS-LF-BENEFIT-CD = ZEROS
  9665        GO TO 0410-CHECK-AH.
  9666
  9667     IF CF-ST-RT-CALC NOT = SPACES
  9668        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9669                                    EC-ST-LF-REM-TERM-CALC
  9670     END-IF
  9671
  9672     IF WS-LF-COVERAGE-TYPE = 'R'
  9673        IF WS-LF-EARNINGS-CALC = '5'
  9674           IF CF-ST-RF-LN-CALC > '0'
  9675              MOVE CF-ST-RF-LN-CALC
  9676                                 TO WS-LF-REFUND-CALC
  9677                                    EC-ST-LF-REFUND-CALC
  9678           END-IF
  9679        ELSE
  9680           IF CF-ST-RF-LR-CALC > '0'
  9681              MOVE CF-ST-RF-LR-CALC
  9682                                 TO WS-LF-REFUND-CALC
  9683                                    EC-ST-LF-REFUND-CALC
  9684           END-IF
  9685        END-IF
  9686     ELSE
  9687        IF CF-ST-RF-LL-CALC > '0'
  9688           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9689                                    EC-ST-LF-REFUND-CALC
  9690        END-IF
  9691     END-IF
  9692
  9693     IF CF-ST-RT-CALC NOT = SPACES
  9694        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9695                                    EC-ST-LF-REM-TERM-CALC
  9696     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 178
* EL050.cbl
  9697
  9698     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9699     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9700
  9701     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9702
  9703     IF NO-BENEFIT-FOUND
  9704        GO TO 0410-CHECK-AH.
  9705
  9706     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9707        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9708                                 TO EC-ST-LF-REM-TERM-CALC
  9709                                    WS-LF-REM-TERM-CALC
  9710     END-IF
  9711
  9712     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9713        MOVE CF-ST-REFUND-CALC (SUB3)
  9714                                 TO WS-LF-REFUND-CALC
  9715                                    EC-ST-LF-REFUND-CALC
  9716     END-IF
  9717*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9718
  9719     .
  9720 0410-CHECK-AH.
  9721
  9722     IF WS-AH-BENEFIT-CD = ZEROS
  9723        GO TO 0500-SET-ACCOUNT.
  9724
  9725     IF CF-ST-RT-CALC NOT = SPACES
  9726        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9727                                    EC-ST-AH-REM-TERM-CALC
  9728     END-IF
  9729
  9730     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9731        IF CF-ST-RF-CP-CALC > '0'
  9732           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9733                                    EC-ST-AH-REFUND-CALC
  9734        END-IF
  9735     ELSE
  9736        IF CF-ST-RF-AH-CALC > '0'
  9737           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9738                                    EC-ST-AH-REFUND-CALC
  9739        END-IF
  9740     END-IF
  9741     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9742     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9743
  9744     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9745
  9746     IF NO-BENEFIT-FOUND
  9747        GO TO 0500-SET-ACCOUNT.
  9748
  9749     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9750        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9751                                 TO WS-AH-REM-TERM-CALC
  9752                                    EC-ST-AH-REM-TERM-CALC
  9753     END-IF
  9754
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 179
* EL050.cbl
  9755     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9756        MOVE CF-ST-REFUND-CALC (SUB3)
  9757                                 TO WS-AH-REFUND-CALC
  9758                                    EC-ST-AH-REFUND-CALC
  9759     END-IF
  9760
  9761*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9762
  9763     GO TO 0500-SET-ACCOUNT.
  9764
  9765 0499-STATE-NOT-FOUND.
  9766
  9767     MOVE ER-2603                TO WS-ERROR.
  9768     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9769
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 180
* EL050.cbl
  9771
  9772 0500-SET-ACCOUNT.
  9773*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9774     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9775        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9776        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9777        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9778        MOVE '3'                 TO CNTL-REC-TYPE
  9779        MOVE +0                  TO CNTL-SEQ-NO
  9780
  9781        MOVE '3'                 TO RC-SW-2
  9782        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9783
  9784        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9785           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9786           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9787           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9788                                    WS-ST-AH-PREM-TAX-I
  9789                                    WS-ST-AH-PREM-TAX-G
  9790        ELSE
  9791           IF CF-ST-LF-PREM-TAX NUMERIC
  9792              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9793           END-IF
  9794           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9795              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9796           END-IF
  9797           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9798              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9799           END-IF
  9800        END-IF
  9801        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9802     END-IF
  9803*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9804*  FOR DCC ONLY
  9805     IF PB-COMPANY-ID = 'DCC'
  9806
  9807     MOVE ' '                    TO STAT-MASTER-SW
  9808     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9809     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9810     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9811     MOVE PB-STATE               TO ELSTAT-STATE
  9812     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9813        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9814     END-IF
  9815
  9816     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9817     SET BIN-TO-GREG             TO TRUE
  9818     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9819     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9820     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9821
  9822     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9823     IF STAT-MASTER-FOUND
  9824        MOVE 'N'                 TO STAT-MASTER-SW
  9825        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9826        IF STAT-MASTER-FOUND
  9827           IF (ELSTAT-KEY-SAVE (1:12) =
  9828                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 181
* EL050.cbl
  9829              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9830                 MOVE 'F'        TO STAT-MASTER-SW
  9831              ELSE
  9832                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9833                 IF (STAT-MASTER-FOUND)
  9834                    AND (ELSTAT-KEY-SAVE (1:12) =
  9835                        SF-CONTROL-PRIMARY (1:12))
  9836                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9837                    MOVE 'F'     TO STAT-MASTER-SW
  9838                 END-IF
  9839              END-IF
  9840           END-IF
  9841        END-IF
  9842     END-IF
  9843
  9844     IF STAT-MASTER-SW = 'F'
  9845        IF SF-ST-LF-PREM-TAX NUMERIC
  9846           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9847        END-IF
  9848        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9849           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9850        END-IF
  9851        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9852           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9853        END-IF
  9854     END-IF
  9855
  9856     END-IF
  9857     IF (PB-COMPANY-ID = 'DCC')
  9858        AND (PB-ISSUE)
  9859        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9860        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9861        AND (AM-GPCD = 06)
  9862        MOVE 'Y'                 TO WS-GOOD-HIN
  9863        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9864           MOVE PB-I-VIN         TO WS-WORK-VIN
  9865           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9866              (V1 > 16)
  9867              IF WS-WORK-VIN (V1:1) NUMERIC
  9868                 MOVE WS-WORK-VIN-N (V1)
  9869                                 TO WS-ROW-B-VAL (V1)
  9870              ELSE
  9871                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9872                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9873                    OR (V2 > 26)
  9874                 END-PERFORM
  9875                 IF V2 < 27
  9876                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9877                 ELSE
  9878                    MOVE 'N'     TO WS-GOOD-HIN
  9879                 END-IF
  9880              END-IF
  9881              COMPUTE WS-ROW-D-VAL (V1) =
  9882                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9883              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9884                 WS-ROW-D-VAL (V1)
  9885           END-PERFORM
  9886           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 182
* EL050.cbl
  9887           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9888             REMAINDER WS-VIN-REMAINDER
  9889           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9890              CONTINUE
  9891           ELSE
  9892              MOVE 'N'           TO WS-GOOD-HIN
  9893           END-IF
  9894        ELSE
  9895           MOVE 'N'              TO WS-GOOD-HIN
  9896        END-IF
  9897        IF WS-GOOD-HIN NOT = 'Y'
  9898           MOVE ER-3826           TO WS-ERROR
  9899           PERFORM 9900-ERROR-FORMAT
  9900                                 THRU 9900-EXIT
  9901        END-IF
  9902     END-IF
  9903     IF (PB-COMPANY-ID = 'DCC')
  9904        AND (PB-ISSUE)
  9905        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9906        AND (AM-GPCD NOT = 06)
  9907        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9908          MOVE PB-I-VIN          TO WS-WORK-VIN
  9909          MOVE +8                TO V2
  9910          MOVE ZEROS             TO WS-VIN-TOTAL
  9911          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9912           (V1 > 17)
  9913             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9914                MOVE ER-3825     TO WS-ERROR
  9915                PERFORM 9900-ERROR-FORMAT
  9916                                 THRU 9900-EXIT
  9917             ELSE
  9918                IF V1 = 8
  9919                   MOVE 10       TO V2
  9920                END-IF
  9921                IF V1 = 9
  9922                   MOVE 0        TO V2
  9923                END-IF
  9924                IF V1 = 10
  9925                   MOVE 9        TO V2
  9926                END-IF
  9927                IF WS-WORK-VIN (V1:1) NUMERIC
  9928                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9929                    + (WS-WORK-VIN-N (V1) * V2)
  9930                ELSE
  9931                   MOVE WS-WORK-VIN (V1:1)
  9932                                 TO WS-HEX-BYTE
  9933                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9934                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9935                    + (WS-NUM (V3) * V2)
  9936                END-IF
  9937                COMPUTE V2 = V2 - 1
  9938             END-IF
  9939          END-PERFORM
  9940          MOVE ZEROS TO WS-VIN-REMAINDER
  9941          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9942             REMAINDER WS-VIN-REMAINDER
  9943          IF ((WS-WORK-VIN (9:1) = 'X')
  9944             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 183
* EL050.cbl
  9945                     OR
  9946             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9947             CONTINUE
  9948          ELSE
  9949             MOVE ER-3826        TO WS-ERROR
  9950             PERFORM 9900-ERROR-FORMAT
  9951                                 THRU 9900-EXIT
  9952          END-IF
  9953        ELSE
  9954          MOVE ER-3826           TO WS-ERROR
  9955          PERFORM 9900-ERROR-FORMAT
  9956                                 THRU 9900-EXIT
  9957        END-IF
  9958     END-IF
  9959******************************************************************
  9960******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9961******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9962******* METHODS.
  9963******************************************************************
  9964     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9965        IF PB-CANCELLATION
  9966           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9967              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9968                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9969                IF FORM-MASTER-FOUND
  9970                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9971******************************************************************
  9972
  9973     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9974     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9975
  9976     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9977     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9978     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9979     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9980
  9981
  9982     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9983     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9984     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9985
  9986     IF AM-LF-OB-RATE NOT NUMERIC
  9987         MOVE ZERO               TO AM-LF-OB-RATE.
  9988
  9989     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9990         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9991
  9992     IF AM-AH-OB-RATE NOT NUMERIC
  9993         MOVE ZERO               TO AM-AH-OB-RATE.
  9994
  9995     IF WS-LF-JOINT-INDICATOR = 'J'
  9996         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9997     ELSE
  9998         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9999
 10000     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10001
 10002     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 184
* EL050.cbl
 10003         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10004
 10005     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10006         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10007                                       WS-IG-OVRD
 10008     ELSE
 10009         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10010             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10011                                       WS-IG-OVRD
 10012         ELSE
 10013             MOVE AM-IG             TO WS-IG-OVRD-AH
 10014                                       WS-IG-OVRD.
 10015
 10016     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10017         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10018                                       WS-IG-OVRD
 10019     ELSE
 10020         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10021             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10022                                       WS-IG-OVRD
 10023         ELSE
 10024             MOVE AM-IG             TO WS-IG-OVRD-LF
 10025                                       WS-IG-OVRD.
 10026
 10027     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10028     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10029     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10030     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10031     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10032
 10033     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10034     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10035     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10036     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10037
 10038     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10039     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10040     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10041     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10042     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10043     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10044     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10045
 10046     IF WS-ACCT-AH-DEV-PCT > +0
 10047        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10048     ELSE
 10049        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10050
 10051     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10052        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10053     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10054        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10055
 10056        IF AM-EARN-METHOD-L = 'S'
 10057            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10058                                        WS-LF-REFUND-CALC.
 10059
 10060        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 185
* EL050.cbl
 10061            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10062                                        WS-LF-REFUND-CALC.
 10063
 10064     IF WS-LF-COVERAGE-TYPE = 'R'
 10065         IF AM-EARN-METHOD-R = 'R'
 10066            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10067                                    WS-LF-REFUND-CALC.
 10068     IF WS-LF-COVERAGE-TYPE = 'R'
 10069         IF AM-EARN-METHOD-R = 'P'
 10070            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10071                                    WS-LF-REFUND-CALC.
 10072     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10073         IF AM-EARN-METHOD-L = 'R'
 10074            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10075                                    WS-LF-REFUND-CALC.
 10076     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10077         IF AM-EARN-METHOD-L = 'P'
 10078            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10079                                    WS-LF-REFUND-CALC.
 10080     IF WS-LF-COVERAGE-TYPE = 'R'
 10081         IF AM-EARN-METHOD-R = 'A'
 10082            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10083                                    WS-LF-REFUND-CALC.
 10084     IF WS-LF-COVERAGE-TYPE = 'R'
 10085         IF AM-EARN-METHOD-R = 'M'
 10086            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10087                                    WS-LF-REFUND-CALC.
 10088     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10089         IF AM-EARN-METHOD-L = 'A'
 10090            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10091                                    WS-LF-REFUND-CALC.
 10092     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10093         IF AM-EARN-METHOD-L = 'M'
 10094            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10095                                    WS-LF-REFUND-CALC.
 10096
 10097     IF AM-EARN-METHOD-A = 'R'
 10098        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10099                                    WS-AH-REFUND-CALC.
 10100     IF AM-EARN-METHOD-A = 'P'
 10101        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10102                                    WS-AH-REFUND-CALC.
 10103     IF AM-EARN-METHOD-A = 'C'
 10104        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10105                                    WS-AH-REFUND-CALC.
 10106     IF AM-EARN-METHOD-A = 'A'
 10107        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10108                                    WS-AH-REFUND-CALC.
 10109     IF AM-EARN-METHOD-A = 'M'
 10110        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10111                                    WS-AH-REFUND-CALC.
 10112     IF AM-EARN-METHOD-A = 'N'
 10113        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10114                                    WS-AH-REFUND-CALC.
 10115     IF AM-EARN-METHOD-A = 'S'
 10116        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10117                                    WS-AH-REFUND-CALC.
 10118
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 186
* EL050.cbl
 10119     IF AM-TOL-PREM NOT = ZEROS
 10120        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10121                                    WS-TOL-AH-PREM.
 10122
 10123     IF AM-OVR-SHT-AMT NUMERIC AND
 10124                  AM-OVR-SHT-AMT > 0
 10125        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10126                                    EC-AM-LF-OVR-SHT-AMT
 10127                                    WS-AH-REFUND-OVS-AMT
 10128                                    EC-AM-AH-OVR-SHT-AMT.
 10129
 10130     IF AM-OVR-SHT-PCT NUMERIC AND
 10131                    AM-OVR-SHT-PCT > 0
 10132        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10133                                    EC-AM-LF-OVR-SHT-PCT
 10134                                    WS-AH-REFUND-OVS-PCT
 10135                                    EC-AM-AH-OVR-SHT-PCT.
 10136
 10137     IF AM-TOL-REF-PCT NUMERIC AND
 10138                  AM-TOL-REF-PCT > 0
 10139        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10140                                    WS-TOL-AH-REFUND-PCT.
 10141
 10142     IF AM-TOL-REF  NOT = ZEROS  AND
 10143                  AM-TOL-REF NUMERIC
 10144        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10145                                    EC-AM-LF-TOL-REFUND
 10146                                    WS-TOL-AH-REFUND
 10147                                    EC-AM-AH-TOL-REFUND.
 10148
 10149     IF AM-TOL-CLM  NOT = ZEROS
 10150        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10151                                    WS-TOL-AH-CLAIM.
 10152
 10153     IF AM-CLP-TOL-PCT NOT NUMERIC
 10154        MOVE +0                  TO AM-CLP-TOL-PCT
 10155     END-IF
 10156
 10157     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10158        MOVE +0                  TO AM-SPP-LEASE-COMM
 10159     END-IF
 10160     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10161        MOVE WS-PL-TOL-LF-PREM-PCT
 10162                                 TO WS-TOL-LF-PREM-PCT.
 10163
 10164     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10165        MOVE WS-PL-TOL-AH-PREM-PCT
 10166                                 TO WS-TOL-AH-PREM-PCT.
 10167
 10168     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10169        MOVE WS-PL-TOL-LF-REFUND-PCT
 10170                                 TO WS-TOL-LF-REFUND-PCT.
 10171
 10172     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10173        MOVE WS-PL-TOL-AH-REFUND-PCT
 10174                                 TO WS-TOL-AH-REFUND-PCT.
 10175
 10176     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 187
* EL050.cbl
 10177        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10178
 10179     IF WS-PL-REF-OVS-PCT > +0
 10180        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10181
 10182     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10183        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10184     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10185        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10186     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10187        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10188     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10189        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10190     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10191        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10192     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10193        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10194
 10195     IF WS-AH-PL-REF-OVS-AMT > +0
 10196        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10197
 10198     IF WS-AH-PL-REF-OVS-PCT > +0
 10199        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10200
 10201     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10202     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10203
 10204     IF PB-CANCELLATION
 10205        GO TO 3000-CONTINUE-EDIT.
 10206
 10207     MOVE +1 TO SUB1.
 10208     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10209     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10210
 10211     IF CF-COMPANY-ID = 'DMD'
 10212       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10213         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10214        ELSE
 10215         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10216
 10217  0525-FIND-ACCT-COMM.
 10218     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10219        NEXT SENTENCE
 10220      ELSE
 10221         ADD +1 TO SUB1
 10222         IF SUB1 LESS +11
 10223            GO TO 0525-FIND-ACCT-COMM
 10224          ELSE
 10225             GO TO 0560-EDIT-CONTINUE.
 10226
 10227     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10228     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10229                                    PB-I-LIFE-COMMISSION.
 10230***  IF PB-COMPANY-ID = 'CRI'
 10231     IF PB-PREM-ACCTNG-ONLY
 10232         GO TO 0560-EDIT-CONTINUE.
 10233
 10234     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 188
* EL050.cbl
 10235     MOVE ' '    TO WS-CTBL-READ-SW.
 10236
 10237
 10238 0530-GET-AH-COMP.
 10239     IF NO-AH-COVERAGE  OR
 10240        NO-AH-BENEFIT-MATCH
 10241           GO TO 0540-NEXT-READ-STEP.
 10242
 10243     IF AM-A-COM (SUB1) NUMERIC
 10244        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10245         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10246         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10247         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10248         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10249     ELSE
 10250          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10251          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10252          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10253          MOVE ZEROS             TO WS-SUB1
 10254                                    WS-COMMISSION
 10255          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10256          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10257          IF WS-COMMISSION > ZEROS
 10258             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10259             GO TO 0540-NEXT-READ-STEP
 10260          END-IF
 10261          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10262          IF CTBL-TABLE-FOUND
 10263             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10264                                        PB-I-AH-TERM
 10265             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10266             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10267             GO TO 0540-NEXT-READ-STEP
 10268          ELSE
 10269             IF FIRST-TIME-THROUGH
 10270                 GO TO 0530-GET-AH-COMP
 10271             ELSE
 10272                 MOVE ER-2609                TO WS-ERROR
 10273                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10274
 10275 0540-NEXT-READ-STEP.
 10276     MOVE '0540' TO CTBL-SW.
 10277     MOVE ' '    TO WS-CTBL-READ-SW.
 10278
 10279 0540-GET-LF-COMP.
 10280     IF NO-LIFE-COVERAGE  OR
 10281        NO-LF-BENEFIT-MATCH
 10282           GO TO 0560-EDIT-CONTINUE.
 10283
 10284     IF WS-LF-JOINT-INDICATOR = 'J'
 10285        IF AM-J-COM (SUB1) NUMERIC
 10286           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10287           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10288           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10289           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10290           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10291        ELSE
 10292           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 189
* EL050.cbl
 10293           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10294           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10295           MOVE ZEROS                TO WS-SUB1
 10296                                        WS-COMMISSION
 10297           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10298           IF WS-COMMISSION > ZEROS
 10299              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10300              GO TO 0560-EDIT-CONTINUE
 10301           END-IF
 10302           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10303           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10304           IF CTBL-TABLE-FOUND
 10305              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10306              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10307              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10308              GO TO 0560-EDIT-CONTINUE
 10309           ELSE
 10310              IF FIRST-TIME-THROUGH
 10311                  GO TO 0540-GET-LF-COMP
 10312              ELSE
 10313                  MOVE ER-2609                TO WS-ERROR
 10314                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10315                  GO TO 0560-EDIT-CONTINUE.
 10316
 10317     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10318        IF AM-L-COM (SUB1) NUMERIC
 10319           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10320           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10321           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10322           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10323           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10324        ELSE
 10325           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10326           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10327           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10328           MOVE ZEROS                TO WS-SUB1
 10329                                        WS-COMMISSION
 10330           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10331           IF WS-COMMISSION IS GREATER THAN ZEROS
 10332              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10333              GO TO 0560-EDIT-CONTINUE
 10334           END-IF
 10335           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10336           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10337           IF CTBL-TABLE-FOUND
 10338              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10339              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10340              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10341              GO TO 0560-EDIT-CONTINUE
 10342           ELSE
 10343              IF FIRST-TIME-THROUGH
 10344                  GO TO 0540-GET-LF-COMP
 10345              ELSE
 10346                  MOVE ER-2609                TO WS-ERROR
 10347                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10348
 10349*    GO TO 0560-EDIT-CONTINUE.
 10350
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 190
* EL050.cbl
 10351 0560-EDIT-CONTINUE.
 10352     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10353                                    WS-AH-PMF-COMM
 10354*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10355*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10356     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10357        (SUB1 > +10)
 10358        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10359           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10360           MOVE '0530'           TO CTBL-SW
 10361           MOVE ' '              TO WS-CTBL-READ-SW
 10362           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10363           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10364           MOVE '0540'           TO CTBL-SW
 10365           MOVE ' '              TO WS-CTBL-READ-SW
 10366           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10367        END-IF
 10368     END-PERFORM
 10369     GO TO 0564-EDIT-CONTINUE
 10370     .
 10371 0561-CHECK-AH.
 10372     IF (NO-AH-COVERAGE)
 10373        OR (NO-AH-BENEFIT-MATCH)
 10374        CONTINUE
 10375     ELSE
 10376        IF (AM-A-COM (SUB1) NUMERIC)
 10377           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10378           IF (AM-COM-TYP (SUB1) = 'A')
 10379              AND (WS-AH-PMF-COMM = ZEROS)
 10380              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10381           END-IF
 10382           CONTINUE
 10383        ELSE
 10384           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10385           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10386           MOVE PB-AH-OVERRIDE-L1
 10387                                 TO CTBL-BEN-TYPE
 10388           MOVE ZEROS            TO WS-SUB1
 10389                                    WS-COMMISSION
 10390           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10391           PERFORM 8300-READ-CTBL-TABLE
 10392                                 THRU 8300-EXIT
 10393           IF CTBL-TABLE-FOUND
 10394              IF (AM-COM-TYP (SUB1) = 'A')
 10395                 AND (WS-AH-PMF-COMM = ZEROS)
 10396                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10397                                        PB-I-AH-TERM
 10398                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10399                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10400              END-IF
 10401              CONTINUE
 10402           ELSE
 10403              IF FIRST-TIME-THROUGH
 10404                 GO TO 0561-CHECK-AH
 10405              ELSE
 10406                 MOVE ER-2609    TO WS-ERROR
 10407                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10408              END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 191
* EL050.cbl
 10409           END-IF
 10410        END-IF
 10411     END-IF
 10412     .
 10413 0561-EXIT.
 10414     EXIT.
 10415 0563-CHECK-LF.
 10416     IF (NO-LIFE-COVERAGE)
 10417        OR (NO-LF-BENEFIT-MATCH)
 10418        CONTINUE
 10419     ELSE
 10420        IF WS-LF-JOINT-INDICATOR = 'J'
 10421           IF AM-J-COM (SUB1) NUMERIC
 10422              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10423              IF (AM-COM-TYP (SUB1) = 'A')
 10424                 AND (WS-LF-PMF-COMM = ZEROS)
 10425                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10426              END-IF
 10427              CONTINUE
 10428           ELSE
 10429              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10430              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10431              MOVE PB-LIFE-OVERRIDE-L1
 10432                                 TO CTBL-BEN-TYPE
 10433              MOVE ZEROS         TO WS-SUB1
 10434                                    WS-COMMISSION
 10435              MOVE AM-J-COMA (SUB1)
 10436                                 TO CTBL-TABLE
 10437              PERFORM 8300-READ-CTBL-TABLE
 10438                                 THRU 8300-EXIT
 10439              IF CTBL-TABLE-FOUND
 10440                 IF (AM-COM-TYP (SUB1) = 'A')
 10441                    AND (WS-LF-PMF-COMM = ZEROS)
 10442                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10443                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10444                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10445                 END-IF
 10446                 CONTINUE
 10447              ELSE
 10448                 IF FIRST-TIME-THROUGH
 10449                    GO TO 0563-CHECK-LF
 10450                 ELSE
 10451                    MOVE ER-2609 TO WS-ERROR
 10452                    PERFORM 9900-ERROR-FORMAT
 10453                                 THRU 9900-EXIT
 10454*                   GO TO 0560-EDIT-CONTINUE
 10455                 END-IF
 10456              END-IF
 10457           END-IF
 10458        ELSE
 10459           IF AM-L-COM (SUB1) NUMERIC
 10460              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10461              IF (AM-COM-TYP (SUB1) = 'A')
 10462                 AND (WS-LF-PMF-COMM = ZEROS)
 10463                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10464              END-IF
 10465              CONTINUE
 10466           ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 192
* EL050.cbl
 10467              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10468              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10469              MOVE PB-LIFE-OVERRIDE-L1
 10470                                 TO CTBL-BEN-TYPE
 10471              MOVE ZEROS         TO WS-SUB1
 10472                                    WS-COMMISSION
 10473              MOVE AM-L-COMA (SUB1)
 10474                                 TO CTBL-TABLE
 10475              PERFORM 8300-READ-CTBL-TABLE
 10476                                 THRU 8300-EXIT
 10477              IF CTBL-TABLE-FOUND
 10478                 CONTINUE
 10479              ELSE
 10480                 IF FIRST-TIME-THROUGH
 10481                    GO TO 0563-CHECK-LF
 10482                 ELSE
 10483                    MOVE ER-2609 TO WS-ERROR
 10484                    PERFORM 9900-ERROR-FORMAT
 10485                                 THRU 9900-EXIT
 10486                 END-IF
 10487              END-IF
 10488           END-IF
 10489        END-IF
 10490     END-IF
 10491     .
 10492 0563-EXIT.
 10493     EXIT.
 10494 0564-EDIT-CONTINUE.
 10495
 10496     IF  PB-COMPANY-ID EQUAL 'DMD'
 10497         IF PB-I-NUM-BILLED EQUAL ZEROS
 10498            MOVE ER-8148       TO WS-ERROR
 10499            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10500
 10501*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10502*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10503*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10504*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10505*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10506*         IF NO-CONVERSION-ERROR
 10507*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10508*         ELSE
 10509*             IF PB-COMPANY-ID EQUAL 'HAN'
 10510*                 MOVE ZEROS     TO PB-I-AGE.
 10511     IF PB-I-BIRTHDAY > LOW-VALUES
 10512        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10513        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10514        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10515        PERFORM 8500-DATE-CONVERT
 10516                                 THRU 8500-EXIT
 10517        IF NO-CONVERSION-ERROR
 10518           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10519           IF PB-I-AGE > ZEROS
 10520              IF WS-WORK-AGE NOT = PB-I-AGE
 10521                 MOVE ER-9501    TO WS-ERROR
 10522                 PERFORM 9900-ERROR-FORMAT
 10523                                 THRU 9900-EXIT
 10524              END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 193
* EL050.cbl
 10525           ELSE
 10526              MOVE WS-WORK-AGE   TO PB-I-AGE
 10527           END-IF
 10528        END-IF
 10529     END-IF
 10530     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10531                                   WS-INS-AGE-SET
 10532     IF PB-I-AGE = ZEROS
 10533        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10534           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10535                                   WS-INS-AGE-SET
 10536           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10537
 10538     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10539                                   WS-AH-EDIT-AGE.
 10540
 10541     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10542        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10543        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10544        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10545        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10546        IF NO-CONVERSION-ERROR
 10547           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10548           IF PB-I-JOINT-AGE > 0
 10549              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10550                 MOVE ER-9503    TO WS-ERROR
 10551                 PERFORM 9900-ERROR-FORMAT
 10552                                 THRU 9900-EXIT
 10553              END-IF
 10554           ELSE
 10555              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10556           END-IF
 10557        ELSE
 10558           MOVE ZEROS            TO PB-I-JOINT-AGE
 10559        END-IF
 10560     END-IF
 10561     IF PB-I-JOINT-AGE NOT NUMERIC
 10562        MOVE ZERO               TO PB-I-JOINT-AGE.
 10563
 10564     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10565                                   WS-JNT-AGE-SET
 10566     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10567        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10568           (WS-AH-JOINT-INDICATOR = 'J')
 10569           IF PB-I-JOINT-AGE = ZEROS
 10570               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10571                                          WS-JNT-AGE-SET
 10572               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10573           END-IF
 10574        END-IF
 10575     END-IF
 10576
 10577     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10578     IF WS-LF-JOINT-INDICATOR = 'J'
 10579        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10580        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10581            IF  PB-I-JOINT-AGE = ZERO
 10582                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 194
* EL050.cbl
 10583                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10584            ELSE
 10585                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10586                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10587                    IF PB-COMPANY-ID NOT = 'LBL'
 10588                        MOVE ER-2685    TO WS-ERROR
 10589                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10590
 10591     IF WS-AH-JOINT-INDICATOR = 'J'
 10592        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10593            IF  PB-I-JOINT-AGE = ZERO
 10594                MOVE ER-2686       TO WS-ERROR
 10595                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10596            ELSE
 10597                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10598                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10599                                           WS-EDIT-AGE
 10600                    IF PB-COMPANY-ID NOT = 'LBL'
 10601                        MOVE ER-2685    TO WS-ERROR
 10602                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10603
 10604******************************************************************
 10605*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10606******************************************************************
 10607
 10608     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10609        (WS-AH-SPECIAL-CALC-CD = 'O')
 10610        NEXT SENTENCE
 10611     ELSE
 10612        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10613          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10614           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10615            WS-AH-JOINT-INDICATOR = 'J')  AND
 10616           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10617            MOVE ER-2627             TO WS-ERROR
 10618            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10619
 10620     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10621        (WS-AH-SPECIAL-CALC-CD = 'O')
 10622         NEXT SENTENCE
 10623     ELSE
 10624         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10625            WS-AH-JOINT-INDICATOR = 'J'
 10626             IF PB-I-JOINT-INSURED = SPACES
 10627                 IF PB-COMPANY-ID NOT = 'JAL'
 10628                     MOVE ER-2696    TO WS-ERROR
 10629                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10630
 10631     IF PB-COMPANY-ID NOT = 'BOA'
 10632        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10633           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10634           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10635               PB-I-JOINT-INSURED NOT = SPACES)
 10636                MOVE ER-2691         TO WS-ERROR
 10637                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10638
 10639     IF PB-COMPANY-ID = 'BOA'
 10640        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 195
* EL050.cbl
 10641           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10642            IF PB-I-JOINT-AGE NOT = ZEROS
 10643                MOVE ER-2691         TO WS-ERROR
 10644                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10645
 10646     IF PB-COMPANY-ID = 'CRI'
 10647        IF PB-I-SIG-SW = 'J'
 10648           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10649              WS-AH-JOINT-INDICATOR NOT = 'J'
 10650              MOVE ER-2675       TO WS-ERROR
 10651              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10652
 10653     IF PB-COMPANY-ID = 'CRI'
 10654        IF PB-I-SIG-SW = 'S'
 10655           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10656              WS-AH-JOINT-INDICATOR = 'J'
 10657              MOVE ER-2676       TO WS-ERROR
 10658              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10659
 10660     IF PB-COMPANY-ID = 'CVL'
 10661         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10662            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10663              MOVE ER-2783           TO WS-ERROR
 10664              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10665     IF (WS-LF-JOINT-INDICATOR = 'J')
 10666        AND (WS-AH-JOINT-INDICATOR = 'J')
 10667        AND (PB-I-LF-TERM > 120)
 10668        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10669        MOVE ER-2783             TO WS-ERROR
 10670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10671     END-IF
 10672     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10673
 10674     IF PB-I-INDV-GRP-OVRD = 'I'
 10675        MOVE ER-2666             TO WS-ERROR
 10676        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10677        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10678
 10679     IF PB-I-INDV-GRP-OVRD = 'G'
 10680        MOVE ER-2666             TO WS-ERROR
 10681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10682        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10683
 10684     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10685        NEXT SENTENCE
 10686     ELSE
 10687        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10688
 10689     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10690        IF WS-ERROR = ER-2666
 10691           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10692           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10693
 10694     IF PB-COMPANY-ID = 'CID'
 10695        IF PB-STATE = 'UT' OR 'MO'
 10696           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10697                 OR '76' OR '77')
 10698                      OR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 196
* EL050.cbl
 10699               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10700                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10701                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10702                   OR '2K' OR '2L'))
 10703              AND PB-I-INDV-GRP-CD = 'I'
 10704              MOVE ER-2721             TO WS-ERROR
 10705              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10706           END-IF
 10707        END-IF
 10708     END-IF
 10709
 10710     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10711     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10712        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10713     ELSE
 10714        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10715     END-IF
 10716
 10717*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10718*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10719     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10720                                    ACCOUNT-AH-CK-SW.
 10721
 10722     IF PB-REISSUED-CERT       OR
 10723        PB-REIN-ONLY-CERT      OR
 10724        PB-POLICY-IS-DECLINED  OR
 10725        PB-POLICY-IS-VOIDED
 10726*       OR PB-MONTHLY-CERT
 10727         GO TO 3000-CONTINUE-EDIT.
 10728
 10729     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10730        IF WS-EDIT-AGE           > +65
 10731           MOVE ER-2709          TO WS-ERROR
 10732           PERFORM 9900-ERROR-FORMAT
 10733                                 THRU 9900-EXIT
 10734        ELSE
 10735           IF WS-EDIT-AGE        > +55
 10736              MOVE ER-2718       TO WS-ERROR
 10737              PERFORM 9900-ERROR-FORMAT
 10738                                 THRU 9900-EXIT
 10739           END-IF
 10740        END-IF
 10741     IF PB-COMPANY-ID = 'DCC'
 10742        IF WS-EDIT-AGE           > +65
 10743           MOVE ER-2709          TO WS-ERROR
 10744           PERFORM 9900-ERROR-FORMAT
 10745                                 THRU 9900-EXIT
 10746        END-IF
 10747     END-IF
 10748     .
 10749
 10750 0565-LIFE-PLAN-LIMIT-EDITS.
 10751
 10752     IF NOT LF-PLAN-MASTER-FOUND
 10753        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10754                                    EC-AM-LF-MAX-TOT-BEN
 10755        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10756
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 197
* EL050.cbl
 10757     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10758
 10759     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10760         IF PL-LM-AGE (1) = ZEROS
 10761             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10762
 10763     IF NO-LF-BENEFIT-MATCH          OR
 10764        WS-LF-BENEFIT-CD = ZEROS     OR
 10765        WS-LF-SPECIAL-CALC-CD = 'M'
 10766        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10767
 10768     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10769     MOVE +1                     TO SUB2.
 10770
 10771     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10772        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10773           MOVE +5   TO SUB2
 10774           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10775              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10776              (PL-LM-AGE (SUB2) EQUAL +0)
 10777              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10778              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10779
 10780     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10781
 10782     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10783                               + PB-I-LF-ALT-BENEFIT-AMT.
 10784
 10785 0568-CHECK-LIFE-ATT-AGE.
 10786
 10787     IF PL-ATT-AGE NUMERIC AND
 10788        PL-ATT-AGE > +0
 10789        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10790     END-IF
 10791*    IF PL-ATT-AGE NUMERIC AND
 10792*       PL-ATT-AGE > +0
 10793*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10794*       IF PB-I-BIRTHDAY > LOW-VALUES
 10795*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10796*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10797*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10798*          SET BIN-PLUS-ELAPSED  TO TRUE
 10799*          PERFORM 8500-DATE-CONVERT
 10800*                                THRU 8500-EXIT
 10801*          IF NO-CONVERSION-ERROR
 10802*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10803*             MOVE ER-2669       TO WS-ERROR
 10804*             PERFORM 9900-ERROR-FORMAT
 10805*                                THRU 9900-EXIT
 10806*          END-IF
 10807*       ELSE
 10808*          IF WS-ATT-AGE >= PL-ATT-AGE
 10809*             MOVE ER-2669       TO WS-ERROR
 10810*             PERFORM 9900-ERROR-FORMAT
 10811*                                THRU 9900-EXIT
 10812*          END-IF
 10813*       END-IF
 10814*    END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 198
* EL050.cbl
 10815     .
 10816 0570-CHECK-LIFE-LIMITS.
 10817
 10818     IF PB-COMPANY-ID EQUAL 'CRI'
 10819        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10820           IF SUB2 GREATER THAN +4
 10821              MOVE ER-2637 TO WS-ERROR
 10822              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10823              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10824
 10825     IF PB-COMPANY-ID  =  'NCL'
 10826        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10827            SUB2 GREATER THAN +8
 10828             MOVE 'U'         TO PB-BATCH-ENTRY
 10829             MOVE ER-2637     TO WS-ERROR
 10830             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10831             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10832
 10833     IF SUB2 > +8
 10834        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10835           AND (PB-I-SIG-SW = 'Y')
 10836           CONTINUE
 10837        ELSE
 10838           MOVE ER-2637          TO WS-ERROR
 10839           PERFORM 9900-ERROR-FORMAT
 10840                                 THRU 9900-EXIT
 10841        END-IF
 10842        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10843     END-IF
 10844     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10845     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10846     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10847
 10848     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10849        ADD +1  TO SUB2
 10850        GO TO 0570-CHECK-LIFE-LIMITS.
 10851
 10852     IF PB-COMPANY-ID = 'NCL'
 10853         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10854
 10855     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10856        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10857        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10858           AND (PB-I-SIG-SW = 'Y')
 10859           CONTINUE
 10860        ELSE
 10861           MOVE ER-2637          TO WS-ERROR
 10862           PERFORM 9900-ERROR-FORMAT
 10863                                 THRU 9900-EXIT
 10864        END-IF
 10865     END-IF
 10866     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10867
 10868
 10869 0570-CHECK-NCL-LIFE-LIMITS.
 10870
 10871     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10872        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 199
* EL050.cbl
 10873         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10874
 10875     IF APP-CERT-USED
 10876         IF SUB2  LESS THAN  +5
 10877             MOVE +5          TO SUB2
 10878             GO TO 0570-CHECK-LIFE-LIMITS.
 10879
 10880     MOVE ER-2637             TO WS-ERROR.
 10881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10882
 10883     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10884
 10885 0575-CHECK-NCL-SIG-SWITCH.
 10886
 10887     IF NOT APP-CERT-USED
 10888         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10889
 10890     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10891        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10892        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10893        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10894         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10895
 10896     IF SUB2 GREATER THAN +4
 10897         IF PL-LM-AGE (5) = ZEROS  AND
 10898            PL-LM-AGE (6) = ZEROS  AND
 10899            PL-LM-AGE (7) = ZEROS  AND
 10900            PL-LM-AGE (8) = ZEROS
 10901             MOVE  ER-1927        TO WS-ERROR
 10902             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10903             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10904         ELSE
 10905             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10906                 MOVE  ER-1920    TO WS-ERROR
 10907                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10908
 10909     IF PB-I-SIG-SW  = 'Y'
 10910       IF NOT PB-I-POLICY-ACCEPTED  AND
 10911          NOT PB-I-POLICY-DECLINED
 10912           MOVE 'U'               TO PB-BATCH-ENTRY
 10913           MOVE  ER-1926          TO WS-ERROR
 10914           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10915
 10916
 10917 0580-AH-PLAN-LIMIT-EDITS.
 10918
 10919     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10920        IF PB-I-AH-BENEFIT-AMT > +1250
 10921           MOVE ER-2702          TO WS-ERROR
 10922           PERFORM 9900-ERROR-FORMAT
 10923                                 THRU 9900-EXIT
 10924        END-IF
 10925     END-IF
 10926
 10927     IF (PB-COMPANY-ID = 'DCC')
 10928        AND (PB-MONTHLY-CERT)
 10929        IF PB-I-AH-BENEFIT-AMT > +3000
 10930           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 200
* EL050.cbl
 10931           PERFORM 9900-ERROR-FORMAT
 10932                                 THRU 9900-EXIT
 10933        END-IF
 10934     END-IF
 10935     IF NOT AH-PLAN-MASTER-FOUND
 10936        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10937        GO TO 3000-CONTINUE-EDIT.
 10938
 10939     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10940
 10941     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10942         IF PL-LM-AGE (1) = ZEROS
 10943             GO TO 3000-CONTINUE-EDIT.
 10944
 10945     IF NO-AH-BENEFIT-MATCH          OR
 10946        WS-AH-BENEFIT-CD = ZEROS     OR
 10947        WS-AH-SPECIAL-CALC-CD = 'M'
 10948        GO TO 3000-CONTINUE-EDIT.
 10949
 10950     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10951     MOVE +1                     TO SUB2.
 10952
 10953     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10954        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10955           MOVE +5 TO SUB2
 10956           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10957              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10958              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10959              (PL-LM-AGE (SUB2) EQUAL +0)
 10960              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10961              GO TO 3000-CONTINUE-EDIT.
 10962
 10963     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10964
 10965 0590-CHECK-AH-ATT-AGE.
 10966
 10967     IF PL-ATT-AGE NUMERIC AND
 10968        PL-ATT-AGE GREATER THAN +0
 10969        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10970     END-IF
 10971*       IF WS-ATT-AGE >= PL-ATT-AGE
 10972*          MOVE ER-3054          TO WS-ERROR
 10973*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10974     .
 10975 0597-CHECK-AH-LIMITS.
 10976
 10977     IF PB-COMPANY-ID EQUAL 'CRI'
 10978        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10979           IF SUB2 GREATER THAN +4
 10980              MOVE ER-2638       TO WS-ERROR
 10981              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10982              GO TO 3000-CONTINUE-EDIT.
 10983
 10984     IF PB-COMPANY-ID  =  'NCL'
 10985        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10986            SUB2 GREATER THAN +8
 10987             MOVE 'U'            TO PB-BATCH-ENTRY
 10988             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 201
* EL050.cbl
 10989             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10990             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10991
 10992     IF SUB2 > +8
 10993        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10994           AND (PB-I-SIG-SW = 'Y')
 10995           CONTINUE
 10996        ELSE
 10997           MOVE ER-2638          TO WS-ERROR
 10998           PERFORM 9900-ERROR-FORMAT
 10999                                 THRU 9900-EXIT
 11000        END-IF
 11001        GO TO 3000-CONTINUE-EDIT
 11002     END-IF
 11003
 11004     IF PB-COMPANY-ID = 'CRI'
 11005        IF WS-ERROR = ER-2638
 11006           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11007
 11008     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11009     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11010     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11011     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11012
 11013     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11014        ADD +1                   TO SUB2
 11015        GO TO 0597-CHECK-AH-LIMITS.
 11016
 11017     IF PB-COMPANY-ID = 'NCL'
 11018         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11019
 11020     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11021        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11022        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11023                                 > PL-LM-AMT (SUB2))
 11024        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11025           AND (PB-I-SIG-SW = 'Y')
 11026           CONTINUE
 11027        ELSE
 11028           MOVE ER-2638          TO WS-ERROR
 11029           PERFORM 9900-ERROR-FORMAT
 11030                                 THRU 9900-EXIT
 11031        END-IF
 11032     END-IF
 11033
 11034     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11035         IF  WS-ERROR    EQUAL    ER-2638
 11036             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11037                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11038                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11039                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11040                MOVE  ER-1910    TO  WS-ERROR
 11041                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11042
 11043     IF PB-COMPANY-ID = 'CRI'
 11044        IF WS-ERROR = ER-2638
 11045            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11046            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 202
* EL050.cbl
 11047            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11048
 11049     GO TO 3000-CONTINUE-EDIT.
 11050
 11051 0597-CHECK-NCL-AH-LIMITS.
 11052
 11053     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11054        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11055        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11056                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11057         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11058
 11059     IF APP-CERT-USED
 11060         IF SUB2  LESS THAN  +5
 11061             MOVE +5             TO SUB2
 11062             GO TO 0597-CHECK-AH-LIMITS.
 11063
 11064     MOVE ER-2638                TO WS-ERROR.
 11065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11066
 11067     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11068
 11069 0599-CHECK-NCL-SIG-SWITCH.
 11070
 11071     IF NOT APP-CERT-USED
 11072         GO TO 3000-CONTINUE-EDIT.
 11073
 11074     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11075        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11076        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11077        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11078         GO TO 3000-CONTINUE-EDIT.
 11079
 11080     IF SUB2 GREATER THAN +4
 11081         IF PL-LM-AGE (5) = ZEROS  AND
 11082            PL-LM-AGE (6) = ZEROS  AND
 11083            PL-LM-AGE (7) = ZEROS  AND
 11084            PL-LM-AGE (8) = ZEROS
 11085             MOVE  ER-1927        TO WS-ERROR
 11086             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11087             GO TO 3000-CONTINUE-EDIT
 11088         ELSE
 11089             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11090                 MOVE  ER-1920    TO WS-ERROR
 11091                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11092
 11093     IF PB-I-SIG-SW  = 'Y'
 11094       IF NOT PB-I-POLICY-ACCEPTED  AND
 11095          NOT PB-I-POLICY-DECLINED
 11096           MOVE 'U'               TO PB-BATCH-ENTRY
 11097           MOVE  ER-1926          TO WS-ERROR
 11098           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11099
 11100******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 203
* EL050.cbl
 11102
 11103 3000-CONTINUE-EDIT.
 11104
 11105     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11106     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11107     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11108     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11109     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11110
 11111     IF BROWSE-STARTED
 11112        PERFORM 9990-RETURN THRU 9990-EXIT
 11113        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11114
 11115     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11116        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11117        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11118        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11119*       MOVE 1                   TO DC-OPTION-CODE
 11120        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11121        IF DATE-CONVERSION-ERROR
 11122           MOVE ER-2622          TO WS-ERROR
 11123           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11124        ELSE
 11125           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11126              MOVE ER-2623       TO WS-ERROR
 11127              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11128           ELSE
 11129              MOVE ER-2622       TO WS-ERROR
 11130              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11131
 11132     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11133     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11134     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11135*    MOVE 1                      TO DC-OPTION-CODE.
 11136     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11137     IF DATE-CONVERSION-ERROR
 11138        GO TO 3005-EDIT-CONTINUE
 11139     ELSE
 11140        IF DC-ELAPSED-DAYS GREATER +180
 11141           MOVE ER-2613          TO WS-ERROR
 11142           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11143        ELSE
 11144           IF DC-ELAPSED-DAYS GREATER +90
 11145              MOVE ER-2612       TO WS-ERROR
 11146              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11147           ELSE
 11148             IF DC-ELAPSED-DAYS GREATER +60
 11149                MOVE ER-2614     TO WS-ERROR
 11150                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11151
 11152 3005-EDIT-CONTINUE.
 11153
 11154     IF PB-CANCELLATION
 11155         GO TO 3700-EDIT-CANCEL.
 11156
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 204
* EL050.cbl
 11158******************************************************************
 11159*                  E D I T   I S S U E                           *
 11160******************************************************************
 11161
 11162 3020-EDIT-ISSUE.
 11163
 11164      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11165      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11166      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11167      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11168      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11169
 11170     IF PB-ISSUE-FORCE
 11171        OR PB-ISSUE-DATE-FORCED
 11172        OR PB-FORCE-OFF
 11173        OR PB-OVERCHARGE-FORCE
 11174        CONTINUE
 11175     ELSE
 11176        MOVE ER-2670             TO WS-ERROR
 11177        PERFORM 9900-ERROR-FORMAT
 11178                                 THRU 9900-EXIT
 11179     END-IF
 11180     .
 11181 3022-SET-POLICY-STATUS.
 11182
 11183     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11184
 11185     IF (PB-REISSUED-CERT)
 11186             OR
 11187        ((PB-COMPANY-ID NOT = 'DCC')
 11188         AND (PB-MONTHLY-CERT))
 11189         MOVE '5'                TO PB-I-ENTRY-STATUS
 11190         MOVE 'E'                TO PB-BATCH-ENTRY
 11191     END-IF
 11192
 11193     IF PB-COMPANY-ID = 'DCC'
 11194        IF PB-MONTHLY-CERT
 11195           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11196        END-IF
 11197     END-IF
 11198     IF PB-POLICY-IS-DECLINED
 11199         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11200     IF PB-POLICY-IS-VOIDED
 11201         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11202     IF PB-NEEDS-UNDERWRITING
 11203         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11204     IF PB-REIN-ONLY-CERT
 11205         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11206     IF PB-PREM-ACCTNG-ONLY
 11207         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11208
 11209     MOVE SPACE                  TO PB-I-OB-FLAG.
 11210
 11211     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11212         MOVE ER-2665            TO WS-ERROR
 11213         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11214         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11215
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 205
* EL050.cbl
 11216     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11217        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11218           MOVE 'Z'             TO PB-I-OB-FLAG.
 11219
 11220     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11221        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11222           MOVE 'Z'             TO PB-I-OB-FLAG.
 11223
 11224     IF ACCOUNT-MAST-FOUND
 11225         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11226         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11227         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11228         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11229         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11230         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11231         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11232     END-IF
 11233
 11234     IF ACCOUNT-MAST-FOUND
 11235        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11236         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11237
 11238     IF (ACCOUNT-MAST-FOUND)
 11239        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11240        IF PB-REISSUED-CERT
 11241           CONTINUE
 11242        ELSE
 11243           MOVE ER-2608          TO WS-ERROR
 11244           PERFORM 9900-ERROR-FORMAT
 11245                                 THRU 9900-EXIT
 11246         END-IF
 11247     END-IF
 11248
 11249     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11250        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11251        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11252
 11253**********   DMD CUSTOM CODE FOLLOWS  **********
 11254 3024-EDIT-DMD-FIELDS.
 11255     IF PB-COMPANY-ID NOT = 'DMD'
 11256        GO TO 3025-EDIT-REINSURANCE.
 11257
 11258*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11259*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11260*** ERROR IF THEY ARE NOT EQUAL.
 11261
 11262     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11263     SET BIN-TO-GREG               TO TRUE.
 11264     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11265     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11266**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11267
 11268     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11269     SET BIN-TO-GREG               TO TRUE.
 11270     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11271     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11272**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11273
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 206
* EL050.cbl
 11274     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11275        MOVE ER-8116               TO WS-ERROR
 11276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11277
 11278     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11279
 11280     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11281                                      WK-FULL-CERT-NO.
 11282     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11283
 11284     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11285
 11286     IF PB-VALID-LIFE
 11287        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11288     ELSE
 11289        IF PB-VALID-AH
 11290          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11291
 11292
 11293     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11294     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11295     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11296                                      DCUA-UNDRWRTR-CODE
 11297                                      DCUA-UNDRWRTR-GROUP-CODE
 11298                                      DCUA-RETURN-CODE.
 11299
 11300****************************************************************
 11301*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11302***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11303***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11304***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11305***   TO THIS RECORD.                                        ***
 11306****************************************************************
 11307     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11308     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11309     IF DCUA-SUCCESSFUL-PROCESS
 11310        GO TO 3024-EDIT-DL7-CONT.
 11311
 11312     IF DCUA-RETURN-CODE EQUAL '01'
 11313        MOVE ER-8110               TO WS-ERROR
 11314        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11316        GO TO 3024-EDIT-DL7-CONT.
 11317
 11318     IF DCUA-RETURN-CODE EQUAL '02'
 11319        MOVE ER-8111               TO WS-ERROR
 11320        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11322        GO TO 3024-EDIT-DL7-CONT.
 11323
 11324     IF DCUA-RETURN-CODE EQUAL '03'
 11325        MOVE ER-8074               TO WS-ERROR
 11326        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11328        GO TO 3024-EDIT-DL7-CONT.
 11329
 11330     IF DCUA-RETURN-CODE EQUAL '04'
 11331        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 207
* EL050.cbl
 11332        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334        GO TO 3024-EDIT-DL7-CONT.
 11335
 11336     IF DCUA-RETURN-CODE EQUAL '05'
 11337        MOVE ER-8076               TO WS-ERROR
 11338        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11340        GO TO 3024-EDIT-DL7-CONT.
 11341
 11342     IF DCUA-RETURN-CODE EQUAL '06'
 11343        MOVE ER-8077               TO WS-ERROR
 11344        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11346        GO TO 3024-EDIT-DL7-CONT.
 11347
 11348     IF DCUA-RETURN-CODE EQUAL '07'
 11349        MOVE ER-8078               TO WS-ERROR
 11350        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11352        GO TO 3024-EDIT-DL7-CONT.
 11353
 11354     IF DCUA-RETURN-CODE EQUAL 'E1'
 11355        MOVE ER-8079               TO WS-ERROR
 11356        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        GO TO 3024-EDIT-DL7-CONT.
 11359
 11360     IF DCUA-RETURN-CODE EQUAL 'E2'
 11361        MOVE ER-8080               TO WS-ERROR
 11362        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11364        GO TO 3024-EDIT-DL7-CONT.
 11365
 11366     IF DCUA-RETURN-CODE EQUAL 'E3'
 11367        MOVE ER-8098               TO WS-ERROR
 11368        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11370        GO TO 3024-EDIT-DL7-CONT.
 11371
 11372     IF DCUA-RETURN-CODE EQUAL 'C1'
 11373        MOVE ER-8099               TO WS-ERROR
 11374        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11376        GO TO 3024-EDIT-DL7-CONT.
 11377
 11378     IF DCUA-RETURN-CODE EQUAL 'U1'
 11379        MOVE ER-8109               TO WS-ERROR
 11380        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11382        GO TO 3024-EDIT-DL7-CONT.
 11383
 11384     IF DCUA-RETURN-CODE EQUAL 'N1'
 11385        MOVE ER-8112               TO WS-ERROR
 11386        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11388        GO TO 3024-EDIT-DL7-CONT.
 11389
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 208
* EL050.cbl
 11390     IF DCUA-RETURN-CODE EQUAL 'N2'
 11391        MOVE ER-8113               TO WS-ERROR
 11392        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11394        GO TO 3024-EDIT-DL7-CONT.
 11395
 11396     IF DCUA-RETURN-CODE EQUAL 'N3'
 11397        MOVE ER-8114               TO WS-ERROR
 11398        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11400        GO TO 3024-EDIT-DL7-CONT.
 11401
 11402     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11403     MOVE ER-8097                  TO WS-ERROR.
 11404     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11405     GO TO 3024-EDIT-DL7-CONT.
 11406
 11407 3024-EDIT-DL7-CONT.
 11408
 11409     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11410     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11411     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11412        NEXT SENTENCE
 11413     ELSE
 11414        MOVE ER-9263               TO WS-ERROR
 11415        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11416
 11417******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11418******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11419     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11420        NEXT SENTENCE
 11421     ELSE
 11422        MOVE ER-8039               TO WS-ERROR
 11423        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11424
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 209
* EL050.cbl
 11426****************************************************************
 11427*** VALIDATE STATE  : DLO022                                 ***
 11428****************************************************************
 11429     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11430     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11431
 11432     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11433     IF DVSC-SUCCESSFUL-EDIT
 11434        GO TO 3024-EDIT-DL22-CONT.
 11435
 11436     IF DVSC-RETURN-CODE EQUAL '01'
 11437        MOVE ER-8300               TO WS-ERROR
 11438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11439        GO TO 3024-EDIT-DL22-CONT.
 11440
 11441     IF DVSC-RETURN-CODE EQUAL '02'
 11442        MOVE ER-8301               TO WS-ERROR
 11443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11444        GO TO 3024-EDIT-DL22-CONT.
 11445
 11446     IF DVSC-RETURN-CODE EQUAL '03'
 11447        MOVE ER-8302               TO WS-ERROR
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11449        GO TO 3024-EDIT-DL22-CONT.
 11450
 11451     IF DVSC-RETURN-CODE EQUAL 'N1'
 11452        MOVE ER-8304               TO WS-ERROR
 11453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11454        GO TO 3024-EDIT-DL22-CONT.
 11455
 11456     MOVE ER-8303                  TO WS-ERROR
 11457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11458
 11459 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 210
* EL050.cbl
 11461****************************************************************
 11462*** VALIDATE LOAN OFFICER : DLO021                           ***
 11463****************************************************************
 11464
 11465     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11466     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11467     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11468     IF DVLO-SUCCESSFUL-EDIT
 11469        GO TO 3024-EDIT-DL21-CONT.
 11470
 11471     IF DVLO-RETURN-CODE EQUAL '01'
 11472        MOVE ER-8081               TO WS-ERROR
 11473        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11474        GO TO 3024-EDIT-DL21-CONT.
 11475
 11476     IF DVLO-RETURN-CODE EQUAL '02'
 11477        MOVE ER-8082               TO WS-ERROR
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479        GO TO 3024-EDIT-DL21-CONT.
 11480
 11481     IF DVLO-RETURN-CODE EQUAL '03'
 11482        MOVE ER-8083               TO WS-ERROR
 11483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11484        GO TO 3024-EDIT-DL21-CONT.
 11485
 11486     IF DVLO-RETURN-CODE EQUAL '04'
 11487        MOVE ER-8084               TO WS-ERROR
 11488        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11489        GO TO 3024-EDIT-DL21-CONT.
 11490
 11491     IF DVLO-RETURN-CODE EQUAL '05'
 11492        MOVE ER-8085               TO WS-ERROR
 11493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11494        GO TO 3024-EDIT-DL21-CONT.
 11495
 11496     MOVE ER-7825                  TO WS-ERROR
 11497     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11498     GO TO 3024-EDIT-DL21-CONT.
 11499
 11500 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 211
* EL050.cbl
 11502
 11503****************************************************************
 11504*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11505****************************************************************
 11506
 11507     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11508     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11509     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11510     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11511     IF DIPF-SUCCESSFUL-EDIT
 11512        GO TO 3024-EDIT-DL02-CONT.
 11513
 11514     IF DIPF-RETURN-CODE EQUAL '01'
 11515        MOVE ER-8086               TO WS-ERROR
 11516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517        GO TO 3024-EDIT-DL02-CONT.
 11518
 11519     IF DIPF-RETURN-CODE EQUAL '02'
 11520        MOVE ER-8087               TO WS-ERROR
 11521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11522        GO TO 3024-EDIT-DL02-CONT.
 11523
 11524     IF DIPF-RETURN-CODE EQUAL '03'
 11525        MOVE ER-8088               TO WS-ERROR
 11526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11527        GO TO 3024-EDIT-DL02-CONT.
 11528
 11529     MOVE ER-8095                  TO WS-ERROR
 11530     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11531     GO TO 3024-EDIT-DL02-CONT.
 11532
 11533 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 212
* EL050.cbl
 11535
 11536****************************************************************
 11537*** VALIDATE BANK ID : DLO003                                ***
 11538****************************************************************
 11539
 11540     MOVE WK-GREG-CENT           TO WCG-CENT.
 11541     MOVE WK-GREG-YYMM           TO WCG-REST.
 11542     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11543        MOVE ER-8040               TO WS-ERROR
 11544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11545
 11546     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11547     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11548     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11549     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11550     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11551     IF DVBI-SUCCESSFUL-EDIT
 11552        GO TO 3024-EDIT-DL03-CONT.
 11553
 11554     IF DVBI-RETURN-CODE EQUAL '01'
 11555        MOVE ER-8089               TO WS-ERROR
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11557        GO TO 3024-EDIT-DL03-CONT.
 11558
 11559     IF DVBI-RETURN-CODE EQUAL '02'
 11560        MOVE ER-8090               TO WS-ERROR
 11561        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11562        GO TO 3024-EDIT-DL03-CONT.
 11563
 11564     IF DVBI-RETURN-CODE EQUAL '03'
 11565        MOVE ER-8091               TO WS-ERROR
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567        GO TO 3024-EDIT-DL03-CONT.
 11568
 11569     IF DVBI-RETURN-CODE EQUAL '04'
 11570        MOVE ER-8092               TO WS-ERROR
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL03-CONT.
 11573
 11574     IF DVBI-RETURN-CODE EQUAL '05'
 11575        MOVE ER-8093               TO WS-ERROR
 11576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11577        GO TO 3024-EDIT-DL03-CONT.
 11578
 11579     IF DVBI-RETURN-CODE EQUAL '06'
 11580        MOVE ER-8094               TO WS-ERROR
 11581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        GO TO 3024-EDIT-DL03-CONT.
 11583
 11584     MOVE ER-8096                  TO WS-ERROR
 11585     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11586     GO TO 3024-EDIT-DL03-CONT.
 11587
 11588 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 213
* EL050.cbl
 11590
 11591     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11592        NEXT SENTENCE
 11593     ELSE
 11594        MOVE ER-8042               TO WS-ERROR
 11595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11596
 11597     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11598     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11599     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11600
 11601     IF DMPF-RETURN-CODE = '01'
 11602        MOVE ER-8067               TO WS-ERROR
 11603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11604        GO TO 3024-EDIT-DL01-CONT.
 11605
 11606     IF DMPF-RETURN-CODE = '02'
 11607        MOVE ER-8068               TO WS-ERROR
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 3024-EDIT-DL01-CONT.
 11610
 11611     IF DMPF-RETURN-CODE = '03'
 11612        MOVE ER-8069               TO WS-ERROR
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL01-CONT.
 11615
 11616     IF DMPF-RETURN-CODE = 'E1'
 11617        MOVE ER-8070               TO WS-ERROR
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619        GO TO 3024-EDIT-DL01-CONT.
 11620
 11621     IF DMPF-RETURN-CODE = 'N1'
 11622        MOVE ER-8071               TO WS-ERROR
 11623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11624        GO TO 3024-EDIT-DL01-CONT.
 11625
 11626     IF DMPF-RETURN-CODE NOT = 'OK'
 11627        MOVE ER-8072               TO WS-ERROR
 11628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11629
 11630 3024-EDIT-DL01-CONT.
 11631******************************************************************
 11632***  VALIDATES RATE CODES : DLO017                             ***
 11633******************************************************************
 11634
 11635      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11636      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11637      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11638      IF DVRC-SUCCESSFUL-EDIT
 11639        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11640        GO TO 3024-CHECK-VALID-RATE.
 11641
 11642      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11643
 11644      IF DVRC-RETURN-CODE EQUAL '01'
 11645         MOVE ER-7817                   TO WS-ERROR
 11646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11647         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 214
* EL050.cbl
 11648
 11649      IF DVRC-RETURN-CODE EQUAL '02'
 11650         MOVE ER-7818                   TO WS-ERROR
 11651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11652         GO TO 3025-EDIT-REINSURANCE.
 11653
 11654      IF DVRC-RETURN-CODE EQUAL '03'
 11655         MOVE ER-7819                   TO WS-ERROR
 11656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11657         GO TO 3025-EDIT-REINSURANCE.
 11658
 11659       MOVE ER-7820                     TO WS-ERROR.
 11660       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11661       GO TO 3025-EDIT-REINSURANCE.
 11662
 11663******************************************************************
 11664***  GET PREMIUM RATES : DLO011                                ***
 11665******************************************************************
 11666
 11667 3024-CHECK-VALID-RATE.
 11668
 11669     IF VALID-RATE-CODE
 11670        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11671        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11672        MOVE SPACES                TO DPRB-RETURN-CODE
 11673        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11674     ELSE
 11675         GO TO 3025-EDIT-REINSURANCE.
 11676
 11677      IF DPRB-SUCCESSFUL-PROCESS
 11678         IF PB-VALID-LIFE
 11679             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11680             GO TO 3025-EDIT-REINSURANCE
 11681         ELSE
 11682             IF PB-VALID-AH
 11683                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11684                 GO TO 3025-EDIT-REINSURANCE.
 11685
 11686      IF DPRB-RETURN-CODE EQUAL '01'
 11687         MOVE ER-7812                   TO WS-ERROR
 11688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689         GO TO 3025-EDIT-REINSURANCE.
 11690
 11691      IF DPRB-RETURN-CODE EQUAL '02'
 11692         MOVE ER-7813                   TO WS-ERROR
 11693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11694         GO TO 3025-EDIT-REINSURANCE.
 11695
 11696      IF DPRB-RETURN-CODE EQUAL '03'
 11697         MOVE ER-7814                   TO WS-ERROR
 11698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699         GO TO 3025-EDIT-REINSURANCE.
 11700
 11701      IF DPRB-RETURN-CODE EQUAL '04'
 11702         IF NOT DPRB-1ST-TIME
 11703            MOVE ER-7815                   TO WS-ERROR
 11704            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11705            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 215
* EL050.cbl
 11706          ELSE
 11707         IF PB-VALID-LIFE
 11708            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11709          ELSE
 11710            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11711         END-IF
 11712         MOVE SPACES                TO DOCC-RETURN-CODE
 11713         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11714         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11715         IF DOCC-RETURN-CODE = 'OK'
 11716             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11717             GO TO 3024-CHECK-VALID-RATE
 11718           ELSE
 11719             MOVE ER-7823               TO WS-ERROR
 11720             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11721             GO TO 3025-EDIT-REINSURANCE.
 11722
 11723       MOVE ER-7816                     TO WS-ERROR.
 11724       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11725       GO TO 3025-EDIT-REINSURANCE.
 11726
 11727**********   DMD CUSTOM CODE ABOVE    **********
 11728
 11729 3025-EDIT-REINSURANCE.
 11730     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11731         GO TO 3027-EDIT-CONTINUE.
 11732
 11733     MOVE LOW-VALUES               TO ERREIN-KEY.
 11734     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11735     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11736                                      REIN-CODE-2
 11737                                      REIN-CODE-3.
 11738     MOVE 'A'                      TO REIN-TYPE.
 11739
 11740     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11741
 11742     MOVE '3026' TO REIN-SW.
 11743     MOVE ' '                   TO WS-REIN-READ-SW.
 11744
 11745     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11746     IF REIN-TABLE-NOT-FOUND
 11747         GO TO 3026-NO-SPEC-TABLE.
 11748
 11749     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11750     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11751                                   WS-NSP-ST-CD-LF.
 11752     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11753                                   WS-NSP-ST-CD-AH.
 11754
 11755     GO TO 3040-EDIT-CONTINUE.
 11756
 11757 3026-NO-SPEC-TABLE.
 11758
 11759     MOVE ER-2664                TO WS-ERROR.
 11760     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11761     GO TO 3040-EDIT-CONTINUE.
 11762
 11763 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 216
* EL050.cbl
 11764
 11765     IF PB-I-REIN-TABLE = SPACES
 11766       GO TO 3040-EDIT-CONTINUE.
 11767
 11768     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11769          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11770          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11771           GO TO 3040-EDIT-CONTINUE.
 11772
 11773     MOVE LOW-VALUES            TO ERREIN-KEY.
 11774     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11775     MOVE 'A'                   TO REIN-TYPE.
 11776     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11777
 11778     MOVE '3028'                TO REIN-SW.
 11779     MOVE ' '                   TO WS-REIN-READ-SW.
 11780
 11781     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11782     IF REIN-TABLE-NOT-FOUND
 11783         GO TO 3028-NO-REIN-TABLE.
 11784
 11785     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11786     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11787                                   WS-NSP-ST-CD-LF.
 11788     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11789                                   WS-NSP-ST-CD-AH.
 11790
 11791     GO TO 3040-EDIT-CONTINUE.
 11792
 11793 3028-NO-REIN-TABLE.
 11794
 11795     MOVE ER-2615                TO WS-ERROR.
 11796     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11797     GO TO 3040-EDIT-CONTINUE.
 11798
 11799 3040-EDIT-CONTINUE.
 11800
 11801     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11802         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11803
 11804     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11805         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11806
 11807     IF (NOT PB-REISSUED-CERT)
 11808        AND (NOT PB-MONTHLY-CERT)
 11809        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11810            MOVE '001'           TO PB-I-LF-TERM
 11811            MOVE 'M'             TO PB-I-INSURED-SEX.
 11812
 11813     IF (NOT PB-REISSUED-CERT)
 11814        AND (NOT PB-MONTHLY-CERT)
 11815        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11816            MOVE '001'           TO PB-I-AH-TERM
 11817            MOVE 'M'             TO PB-I-INSURED-SEX.
 11818
 11819 3040-EDIT-1ST-PMT-DT.
 11820     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11821     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 217
* EL050.cbl
 11822         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11823
 11824******************************************************************
 11825*                                                                *
 11826*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11827*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11828*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11829*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11830*                                                                *
 11831******************************************************************
 11832
 11833     IF PB-EFF-DT-PROCESSING
 11834        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11835                                    PB-I-LF-EXPIRE-DT
 11836                                    PB-I-AH-EXPIRE-DT
 11837        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11838        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11839        MOVE ZERO                TO DC-ELAPSED-DAYS
 11840        MOVE +1                  TO DC-ELAPSED-MONTHS
 11841        SET BIN-PLUS-ELAPSED     TO TRUE
 11842*       MOVE 6                   TO DC-OPTION-CODE
 11843        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11844        IF NO-CONVERSION-ERROR
 11845           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11846
 11847******************************************************************
 11848*                                                                *
 11849*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11850*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11851*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11852*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11853*                                                                *
 11854******************************************************************
 11855
 11856     IF PB-EXT-DAYS-PROCESSING
 11857          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11858                                         PB-I-LF-EXPIRE-DT
 11859                                         PB-I-AH-EXPIRE-DT
 11860          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11861          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11862          MOVE +1                     TO DC-ELAPSED-MONTHS
 11863          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11864          SET BIN-PLUS-ELAPSED        TO TRUE
 11865*         MOVE 6                      TO DC-OPTION-CODE
 11866          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11867          IF NO-CONVERSION-ERROR
 11868             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11869
 11870******************************************************************
 11871*                                                                *
 11872*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11873*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11874*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11875*        (EXPIRE DATE - (TERM -1))  *  -1.
 11876*                                                                *
 11877******************************************************************
 11878
 11879     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 218
* EL050.cbl
 11880        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11881           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11882              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11883              MOVE PB-I-AH-TERM      TO WS-TERM
 11884           ELSE
 11885              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11886              MOVE PB-I-LF-TERM      TO WS-TERM
 11887        ELSE
 11888           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11889              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11890              MOVE PB-I-LF-TERM      TO WS-TERM
 11891           ELSE
 11892              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11893              MOVE PB-I-AH-TERM      TO WS-TERM.
 11894
 11895     IF PB-EXPIRE-DT-PROCESSING
 11896        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11897        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11898        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11899        MOVE ZERO                TO DC-ELAPSED-DAYS
 11900                                    DC-ODD-DAYS-OVER
 11901          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11902          SET BIN-PLUS-ELAPSED    TO TRUE
 11903*         MOVE 6                  TO DC-OPTION-CODE
 11904          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11905          IF NO-CONVERSION-ERROR
 11906             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11907
 11908******************************************************************
 11909*                                                                *
 11910*            1ST PAYMENT DATE PROCESSING                         *
 11911*                                                                *
 11912******************************************************************
 11913
 11914     IF PB-1ST-PMT-DT-PROCESSING
 11915        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11916                                    PB-I-AH-EXPIRE-DT
 11917        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11918
 11919     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11920         NEXT SENTENCE
 11921     ELSE
 11922         MOVE ER-2680                 TO WS-ERROR
 11923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11924         GO TO 3060-ORIG-TERM-CHECK.
 11925
 11926     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11927     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11928     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11929*    MOVE 1                      TO DC-OPTION-CODE.
 11930     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11931                                    DC-ELAPSED-DAYS
 11932                                    DC-ODD-DAYS-OVER.
 11933
 11934     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11935
 11936     IF DATE-CONVERSION-ERROR
 11937        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 219
* EL050.cbl
 11938
 11939     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11940     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11941        AND (WS-LF-COVERAGE-TYPE = 'L')
 11942        IF (DC-ELAPSED-MONTHS > 1)
 11943                      OR
 11944           ((DC-ELAPSED-MONTHS = 1)
 11945           AND (DC-ODD-DAYS-OVER > 0))
 11946           MOVE ER-2882          TO WS-ERROR
 11947           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11948        END-IF
 11949     END-IF
 11950     if dc-elapsed-months > 0
 11951        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 11952        + dc-odd-days-over
 11953     end-if
 11954     IF PB-EXT-DAYS-PROCESSING
 11955        CONTINUE
 11956     ELSE
 11957        IF DC-ELAPSED-MONTHS = +0
 11958           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11959        ELSE
 11960           IF (WS-LF-EARNINGS-CALC = '4')
 11961              AND (DC-ELAPSED-MONTHS > ZERO)
 11962              AND (DC-ELAPSED-DAYS > ZERO)
 11963              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11964           ELSE
 11965              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11966                                 THRU 6499-EXIT
 11967              MOVE WS-ODD-DAYS-OVER
 11968                                 TO PB-I-EXTENTION-DAYS
 11969           END-IF
 11970        END-IF
 11971     END-IF
 11972******************************************************************
 11973*                                                                *
 11974*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11975*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11976*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11977*            AND ANY ODD DAYS.                                   *
 11978*                                                                *
 11979******************************************************************
 11980
 11981     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11982                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11983     IF WS-LF-EARNINGS-CALC NOT = '4'
 11984        IF DC-ELAPSED-DAYS > ZEROS
 11985           MOVE ER-2681          TO WS-ERROR
 11986           PERFORM 9900-ERROR-FORMAT
 11987                                 THRU 9900-EXIT
 11988        END-IF
 11989     END-IF
 11990
 11991     IF WS-LF-EARNINGS-CALC NOT = '4'
 11992        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11993           MOVE ER-2681          TO WS-ERROR
 11994           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11995
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 220
* EL050.cbl
 11996     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11997        (PB-I-LF-TERM NOT = ZERO) AND
 11998         NOT NO-LIFE-COVERAGE
 11999          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12000          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12001          IF WS-LF-EARNINGS-CALC = '4'
 12002             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12003             PB-I-PAY-FREQUENCY
 12004          END-IF
 12005          MOVE ZERO              TO DC-ELAPSED-DAYS
 12006                                    DC-ODD-DAYS-OVER
 12007          MOVE 1                 TO DC-END-OF-MONTH
 12008          SET BIN-PLUS-ELAPSED        TO TRUE
 12009*         MOVE 6                 TO DC-OPTION-CODE
 12010          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12011          IF NO-CONVERSION-ERROR
 12012             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12013             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12014                (WS-LF-SPECIAL-CALC-CD = 'L')
 12015                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12016                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12017                  MOVE +1             TO DC-ELAPSED-MONTHS
 12018                  SET BIN-PLUS-ELAPSED  TO TRUE
 12019*                 MOVE 6              TO DC-OPTION-CODE
 12020                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12021                  IF NO-CONVERSION-ERROR
 12022                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12023
 12024* okay, i had to move the new att age edit down here because the
 12025* expiration date could get recalculated and i need the exp date
 12026     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12027        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12028        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12029        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12030           AND ZEROS
 12031           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12032           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12033           SET ELAPSED-BETWEEN-BIN TO TRUE
 12034           PERFORM 8500-DATE-CONVERT
 12035                                 THRU 8500-EXIT
 12036           IF NO-CONVERSION-ERROR
 12037              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12038                 MOVE ER-2669       TO WS-ERROR
 12039*                PERFORM 9900-ERROR-FORMAT
 12040*                                THRU 9900-EXIT
 12041              END-IF
 12042           END-IF
 12043        ELSE
 12044           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12045           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12046              MOVE ER-2669       TO WS-ERROR
 12047*             PERFORM 9900-ERROR-FORMAT
 12048*                                THRU 9900-EXIT
 12049           ELSE
 12050              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12051                 MOVE ER-1570    TO WS-ERROR
 12052                 PERFORM 9900-ERROR-FORMAT
 12053                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 221
* EL050.cbl
 12054              END-IF
 12055           END-IF
 12056        END-IF
 12057        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12058           AND ZEROS
 12059           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12060           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12061           SET ELAPSED-BETWEEN-BIN TO TRUE
 12062           PERFORM 8500-DATE-CONVERT
 12063                                 THRU 8500-EXIT
 12064           IF NO-CONVERSION-ERROR
 12065              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12066                 MOVE ER-2669       TO WS-ERROR
 12067*                PERFORM 9900-ERROR-FORMAT
 12068*                                THRU 9900-EXIT
 12069              END-IF
 12070           END-IF
 12071        ELSE
 12072           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12073             (PB-I-LF-TERM / 12)
 12074           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12075              MOVE ER-2669       TO WS-ERROR
 12076*             PERFORM 9900-ERROR-FORMAT
 12077*                                THRU 9900-EXIT
 12078           ELSE
 12079              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12080                 MOVE ER-1571    TO WS-ERROR
 12081                 PERFORM 9900-ERROR-FORMAT
 12082                                 THRU 9900-EXIT
 12083              END-IF
 12084           END-IF
 12085        END-IF
 12086        IF WS-ERROR = ER-2669
 12087           PERFORM 9900-ERROR-FORMAT
 12088                                 THRU 9900-EXIT
 12089        END-IF
 12090     END-IF
 12091     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12092        (PB-I-AH-TERM NOT = ZERO) AND
 12093         NOT NO-AH-COVERAGE
 12094          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12095             AND (PB-COMPANY-ID = 'DCC')
 12096             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12097             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12098          ELSE
 12099             IF WS-LF-EARNINGS-CALC = '4'
 12100                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12101                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12102                PB-I-PAY-FREQUENCY
 12103             ELSE
 12104                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12105                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12106             END-IF
 12107          END-IF
 12108          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12109                                         DC-ODD-DAYS-OVER
 12110          MOVE 1                      TO DC-END-OF-MONTH
 12111          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 222
* EL050.cbl
 12112*         MOVE 6                      TO DC-OPTION-CODE
 12113          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12114          IF NO-CONVERSION-ERROR
 12115             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12116     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12117        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12118        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12119        IF PB-I-BIRTHDAY > LOW-VALUES
 12120           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12121           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12122           SET ELAPSED-BETWEEN-BIN TO TRUE
 12123           PERFORM 8500-DATE-CONVERT
 12124                                 THRU 8500-EXIT
 12125           IF NO-CONVERSION-ERROR
 12126              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12127                 MOVE ER-3054       TO WS-ERROR
 12128*                PERFORM 9900-ERROR-FORMAT
 12129*                                THRU 9900-EXIT
 12130              END-IF
 12131           END-IF
 12132        ELSE
 12133           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12134           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12135              MOVE ER-3054       TO WS-ERROR
 12136*             PERFORM 9900-ERROR-FORMAT
 12137*                                THRU 9900-EXIT
 12138           END-IF
 12139        END-IF
 12140        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12141           AND ZEROS
 12142           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12143           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12144           SET ELAPSED-BETWEEN-BIN TO TRUE
 12145           PERFORM 8500-DATE-CONVERT
 12146                                 THRU 8500-EXIT
 12147           IF NO-CONVERSION-ERROR
 12148              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12149                 MOVE ER-3054       TO WS-ERROR
 12150*                PERFORM 9900-ERROR-FORMAT
 12151*                                THRU 9900-EXIT
 12152              END-IF
 12153           END-IF
 12154        ELSE
 12155           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12156             (PB-I-AH-TERM / 12)
 12157           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12158              MOVE ER-3054       TO WS-ERROR
 12159*             PERFORM 9900-ERROR-FORMAT
 12160*                                THRU 9900-EXIT
 12161           END-IF
 12162        END-IF
 12163        IF WS-ERROR = ER-3054
 12164           PERFORM 9900-ERROR-FORMAT
 12165                                 THRU 9900-EXIT
 12166        END-IF
 12167     END-IF
 12168     MOVE SPACE                       TO DC-END-OF-MONTH.
 12169
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 223
* EL050.cbl
 12170     IF PB-COMPANY-ID = 'NCB'
 12171        GO TO 3040-EDIT-EXTENSION-DAYS.
 12172
 12173     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12174       AND
 12175        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12176        NEXT SENTENCE
 12177     ELSE
 12178        GO TO 3040-EDIT-EXTENSION-DAYS.
 12179
 12180     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12181        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12182        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12183     ELSE
 12184        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12185        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12186
 12187     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12188*    MOVE '1'      TO DC-OPTION-CODE
 12189     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12190     IF (NO-CONVERSION-ERROR)
 12191        AND (DC-ELAPSED-MONTHS > +1)
 12192        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12193        MOVE ER-2668   TO WS-ERROR
 12194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12195
 12196 3040-EDIT-EXTENSION-DAYS.
 12197
 12198     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12199        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12200         GO TO 3050-EDIT-TERM-IN-DAYS
 12201     ELSE
 12202         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12203
 12204     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12205         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12206     ELSE
 12207        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12208           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12209           MOVE ER-2681         TO WS-ERROR
 12210           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12211
 12212     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12213        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12214        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12215         GO TO 3060-ORIG-TERM-CHECK.
 12216
 12217     GO TO 3060-ORIG-TERM-CHECK.
 12218
 12219 3050-EDIT-TERM-IN-DAYS.
 12220
 12221     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12222
 12223     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12224         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12225     ELSE
 12226         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12227            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 224
* EL050.cbl
 12228            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12229
 12230     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12231                                       REMAINDER WS-WORK-TERM.
 12232     IF WS-WORK-TERM GREATER THAN ZERO
 12233         ADD +1 TO PB-I-LF-TERM.
 12234
 12235     IF NOT NO-AH-COVERAGE
 12236         MOVE ER-2684            TO WS-ERROR
 12237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12238
 12239
 12240 3060-ORIG-TERM-CHECK.
 12241
 12242******************************************************************
 12243*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12244******************************************************************
 12245
 12246     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12247        NEXT SENTENCE
 12248     ELSE
 12249        IF NOT NO-LIFE-COVERAGE
 12250           IF PB-I-LF-TERM NUMERIC
 12251              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12252              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12253              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12254                  NEXT SENTENCE
 12255           ELSE
 12256              MOVE ER-2647       TO WS-ERROR
 12257              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12258
 12259     IF NOT NO-AH-COVERAGE
 12260         IF PB-I-AH-TERM NUMERIC
 12261            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12262            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12263            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12264             NEXT SENTENCE
 12265          ELSE
 12266              MOVE ER-2658       TO WS-ERROR
 12267              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12268
 12269     IF PB-COMPANY-ID = 'NCB'
 12270        GO TO 3070-LOAN-TERM-CHECK.
 12271
 12272     IF POLICY-HAS-AH
 12273       AND
 12274        POLICY-HAS-LIFE
 12275       AND
 12276        PB-I-LF-TERM NUMERIC
 12277       AND
 12278        PB-I-AH-TERM NUMERIC
 12279        NEXT SENTENCE
 12280     ELSE
 12281        GO TO 3070-LOAN-TERM-CHECK.
 12282
 12283     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12284     IF WS-TEX-FACT-2 LESS THAN +0
 12285        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 225
* EL050.cbl
 12286
 12287     IF WS-TEX-FACT-2 GREATER THAN +1
 12288        MOVE ER-2668             TO WS-ERROR
 12289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12290
 12291 3070-LOAN-TERM-CHECK.
 12292
 12293     IF (WS-LF-BENEFIT-CD = ZERO)
 12294         OR (NO-LF-BENEFIT-MATCH)
 12295            GO TO 3125-EDIT-PMT-FREQ.
 12296*    IF PB-COMPANY-ID NOT = 'DCC'
 12297*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12298*          AND 'V' AND 'W' AND 'X'
 12299*          GO TO 3125-EDIT-PMT-FREQ
 12300*       END-IF
 12301*    ELSE
 12302*       IF WS-AH-DCC-TRUNC = 'T'
 12303*          CONTINUE
 12304*       ELSE
 12305*          GO TO 3125-EDIT-PMT-FREQ
 12306*       END-IF
 12307*    END-IF
 12308     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12309                    OR
 12310        ((PB-COMPANY-ID = 'DCC')
 12311        AND (WS-AH-DCC-TRUNC = 'T'))
 12312        CONTINUE
 12313     ELSE
 12314        GO TO 3125-EDIT-PMT-FREQ
 12315     END-IF
 12316     IF PB-I-LOAN-TERM NOT NUMERIC
 12317         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12318
 12319     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12320        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12321*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12322        PB-I-LOAN-TERM NOT GREATER THAN +360
 12323         NEXT SENTENCE
 12324     ELSE
 12325         MOVE ER-2648            TO WS-ERROR
 12326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12327
 12328     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12329        MOVE ER-3058             TO WS-ERROR
 12330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12331     end-if
 12332
 12333     IF WS-STATE-ABBREVIATION = 'NC'
 12334        IF PB-I-LOAN-TERM > +59
 12335           CONTINUE
 12336        ELSE
 12337           MOVE ER-2792          TO WS-ERROR
 12338           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12339        END-IF
 12340     END-IF
 12341
 12342     .
 12343 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 226
* EL050.cbl
 12344     IF (WS-LF-BENEFIT-CD = ZERO)
 12345         OR (NO-LF-BENEFIT-MATCH)
 12346            GO TO 3127-EDIT-LOAN-OFFICER.
 12347     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12348                    OR
 12349        ((PB-COMPANY-ID = 'DCC')
 12350        AND (WS-AH-DCC-TRUNC = 'T'))
 12351                    OR
 12352         (PB-COMPANY-ID = 'AHL')
 12353        CONTINUE
 12354     ELSE
 12355        IF (PB-I-LOAN-TERM > ZEROS)
 12356           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12357           MOVE ER-1575          TO WS-ERROR
 12358           PERFORM 9900-ERROR-FORMAT
 12359                                 THRU 9900-EXIT
 12360        END-IF
 12361     END-IF
 12362     IF WS-LF-EARNINGS-CALC NOT = '4'
 12363         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12364            MOVE ER-2653         TO WS-ERROR
 12365            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12366            GO TO 3127-EDIT-LOAN-OFFICER
 12367         ELSE
 12368            GO TO 3127-EDIT-LOAN-OFFICER.
 12369
 12370     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12371         MOVE ER-2655            TO WS-ERROR
 12372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12373         GO TO 3127-EDIT-LOAN-OFFICER.
 12374
 12375     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12376         MOVE ER-2654            TO WS-ERROR
 12377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12378         GO TO 3127-EDIT-LOAN-OFFICER.
 12379
 12380     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12381         GIVING WS-TEX-FACT-2
 12382             REMAINDER WS-TEX-FACT-3.
 12383
 12384*    IF WS-TEX-FACT-3 NOT = ZERO
 12385*       MOVE ER-2654             TO WS-ERROR
 12386*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12387
 12388
 12389 3127-EDIT-LOAN-OFFICER.
 12390
 12391     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12392        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12393           MOVE ER-2690          TO WS-ERROR
 12394           PERFORM 9900-ERROR-FORMAT
 12395                                 THRU 9900-EXIT
 12396        ELSE
 12397           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12398           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12399           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12400           MOVE PB-SV-STATE      TO LOFC-STATE
 12401           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 227
* EL050.cbl
 12402           MOVE PB-I-LOAN-OFFICER
 12403                                 TO LOFC-CODE
 12404           PERFORM 8586-READ-LOAN-OFFICER
 12405                                 THRU 8586-EXIT
 12406           IF (NOT LOFC-MASTER-FOUND)
 12407              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12408              MOVE ER-3006       TO WS-ERROR
 12409              PERFORM 9900-ERROR-FORMAT
 12410                                 THRU 9900-EXIT
 12411           END-IF
 12412        END-IF
 12413     END-IF
 12414     .
 12415 3129-EDIT-APR.
 12416
 12417     IF (WS-LF-BENEFIT-CD = ZERO)
 12418        OR (NO-LF-BENEFIT-MATCH)
 12419        IF PB-COMPANY-ID NOT = 'DCC'
 12420           GO TO 3130-EDIT-AGE
 12421*       ELSE
 12422*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12423*             GO TO 3130-EDIT-AGE
 12424*          END-IF
 12425        END-IF
 12426     END-IF
 12427
 12428     IF (WS-STATE-ABBREVIATION = 'OH')
 12429         AND (PB-I-RATE-CLASS NOT = 'L ')
 12430         AND (PB-I-LF-TERM GREATER THAN 60)
 12431         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12432         GO TO 3129-APR-CONT.
 12433
 12434     IF (WS-STATE-ABBREVIATION = 'RI')
 12435         AND (PB-I-LF-TERM GREATER THAN 60)
 12436         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12437         GO TO 3129-APR-CONT.
 12438
 12439     IF (WS-STATE-ABBREVIATION = 'UT')
 12440         AND (PB-I-LF-TERM GREATER THAN 62)
 12441         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12442         AND (PB-CERT-EFF-DT LESS WS-830901)
 12443         GO TO 3129-APR-CONT.
 12444
 12445     IF PB-COMPANY-ID = 'LAP'
 12446        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12447           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12448              MOVE ER-2656         TO WS-ERROR
 12449              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12450              GO TO 3130-EDIT-AGE.
 12451
 12452     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12453        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12454        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12455        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12456        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12457        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12458         GO TO 3130-EDIT-AGE.
 12459
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 228
* EL050.cbl
 12460 3129-APR-CONT.
 12461     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12462         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12463         GO TO 3130-EDIT-AGE.
 12464
 12465     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12466         WS-AH-BENEFIT-CD (1:1) = 'S')
 12467        AND (PB-COMPANY-ID = 'DCC')
 12468        AND (PB-I-LOAN-APR = ZERO)
 12469        MOVE ER-2657             TO WS-ERROR
 12470        PERFORM 9900-ERROR-FORMAT
 12471                                 THRU 9900-EXIT
 12472        GO TO 3130-EDIT-AGE
 12473     END-IF
 12474     IF PB-I-LOAN-APR = ZERO
 12475        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12476     END-IF
 12477
 12478     IF PB-I-LOAN-APR = ZERO
 12479        MOVE ER-2656             TO WS-ERROR
 12480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12481        GO TO 3130-EDIT-AGE.
 12482
 12483*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12484     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12485        MOVE ER-2657             TO WS-ERROR
 12486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12487
 12488 3130-EDIT-AGE.
 12489
 12490******************************************************************
 12491*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12492******************************************************************
 12493
 12494     IF NOT NO-LIFE-COVERAGE
 12495        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12496           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12497               MOVE ER-2628             TO WS-ERROR
 12498               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12499
 12500     IF NOT NO-AH-COVERAGE
 12501        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12502           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12503               MOVE ER-2628         TO WS-ERROR
 12504               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12505
 12506 3133-SEX-CODE.
 12507     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12508         IF WS-DEFAULT-SEX = 'M'
 12509             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12510          ELSE
 12511             IF WS-DEFAULT-SEX = 'F'
 12512             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12513
 12514     IF PB-I-INSURED-SEX = '1'
 12515         MOVE 'M' TO PB-I-INSURED-SEX.
 12516
 12517     IF PB-I-INSURED-SEX = '2'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 229
* EL050.cbl
 12518         MOVE 'F' TO PB-I-INSURED-SEX.
 12519
 12520 3134-SIG-SW-EDIT.
 12521     IF PB-I-SIG-SW = SPACE
 12522         MOVE 'N'                TO  PB-I-SIG-SW.
 12523
 12524     IF PB-COMPANY-ID = 'NCL'
 12525         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12526             NEXT SENTENCE
 12527         ELSE
 12528             MOVE ER-1923        TO  WS-ERROR
 12529             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12530     ELSE
 12531     IF PB-COMPANY-ID = 'CRI'
 12532         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12533             NEXT SENTENCE
 12534         ELSE
 12535             MOVE ER-2606        TO  WS-ERROR
 12536             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12537     ELSE
 12538     IF PB-COMPANY-ID = 'TMS'
 12539         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12540             NEXT SENTENCE
 12541         ELSE
 12542             MOVE ER-2689        TO  WS-ERROR
 12543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12544     ELSE
 12545         IF PB-I-SIG-SW = 'Y' OR 'N'
 12546             NEXT SENTENCE
 12547         ELSE
 12548             MOVE ER-2651        TO  WS-ERROR
 12549             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12550
 12551     IF PB-COMPANY-ID = 'FLA'
 12552         IF (WS-EDIT-AGE GREATER 54  OR
 12553             WS-AH-EDIT-AGE GREATER 54)  AND
 12554            PB-I-SIG-SW = 'N'
 12555            MOVE ER-2651         TO  WS-ERROR
 12556            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12557
 12558 3135-NAME-EDIT.
 12559
 12560     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12561        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12562        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12563           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12564                                 TO PB-I-JOINT-FIRST-NAME
 12565        END-PERFORM
 12566     END-IF
 12567     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12568        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12569        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12570           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12571                                 TO PB-I-JOINT-LAST-NAME
 12572        END-PERFORM
 12573     END-IF
 12574     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12575        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 230
* EL050.cbl
 12576        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12577           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12578                                 TO PB-I-INSURED-FIRST-NAME
 12579        END-PERFORM
 12580     END-IF
 12581     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12582        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12583        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12584           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12585                                 TO PB-I-INSURED-LAST-NAME
 12586        END-PERFORM
 12587     END-IF
 12588     IF PB-I-INSURED-LAST-NAME = SPACES
 12589       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12590       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12591           MOVE ER-2660    TO WS-ERROR
 12592           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12593
 12594 3136-EDIT-SEX.
 12595
 12596******************************************************************
 12597*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12598******************************************************************
 12599
 12600     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12601        (WS-AH-SPECIAL-CALC-CD = 'O')
 12602        NEXT SENTENCE
 12603     ELSE
 12604        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12605           NEXT SENTENCE
 12606        ELSE
 12607           MOVE ER-2629            TO WS-ERROR
 12608           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12609
 12610 3137-EDIT-EFF-DATE.
 12611
 12612     IF PB-REISSUED-CERT       OR
 12613        PB-POLICY-IS-DECLINED  OR
 12614        PB-POLICY-IS-VOIDED
 12615         GO TO 3139-EDIT-COVERAGE-CODES.
 12616
 12617     MOVE SPACE                  TO WS-2671-SW
 12618                                    WS-2672-SW.
 12619
 12620     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12621         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12622             MOVE ER-2703        TO WS-ERROR
 12623             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12624             GO TO 3139-EDIT-COVERAGE-CODES.
 12625
 12626     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12627         GO TO 3139-EDIT-COVERAGE-CODES.
 12628
 12629     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12630     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12631*    MOVE '1'                    TO DC-OPTION-CODE.
 12632     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12633     MOVE +0                     TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 231
* EL050.cbl
 12634                                    DC-ELAPSED-DAYS.
 12635     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12636
 12637     IF DATE-CONVERSION-ERROR
 12638         GO TO 3139-EDIT-COVERAGE-CODES.
 12639
 12640     IF DC-ELAPSED-DAYS GREATER +180
 12641         MOVE ER-2672            TO WS-ERROR
 12642         MOVE 'Y'                TO WS-2672-SW
 12643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12644     END-IF
 12645
 12646     IF WS-ERROR = ER-2671  AND
 12647        PB-COMPANY-ID  = 'LBL'
 12648        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12649        MOVE SPACE               TO WS-2671-SW
 12650        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12651
 12652     IF PB-ISSUE-DATE-FORCED  AND
 12653      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12654         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12655         MOVE ER-2673            TO WS-ERROR
 12656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12657         MOVE SPACE              TO WS-2671-SW
 12658                                    WS-2672-SW.
 12659
 12660     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12661         IF PB-ISSUE-DATE-FORCED
 12662             MOVE ER-2600          TO  WS-ERROR
 12663             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12664         ELSE
 12665             MOVE ER-2692          TO  WS-ERROR
 12666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12667
 12668
 12669 3139-EDIT-COVERAGE-CODES.
 12670
 12671     if pb-company-id not = 'AHL'
 12672        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12673           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12674           MOVE ER-2787          TO WS-ERROR
 12675           PERFORM 9900-ERROR-FORMAT
 12676                                 THRU 9900-EXIT
 12677        END-IF
 12678     end-if
 12679     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12680        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12681                                 > 250000.00
 12682           MOVE ER-2719          TO WS-ERROR
 12683           PERFORM 9900-ERROR-FORMAT
 12684                                 THRU 9900-EXIT
 12685        END-IF
 12686     END-IF
 12687
 12688     IF PB-POLICY-IS-DECLINED  OR
 12689        PB-POLICY-IS-VOIDED
 12690         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12691
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 232
* EL050.cbl
 12692     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12693        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12694         MOVE ER-2630                TO WS-ERROR
 12695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12696
 12697     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12698        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12699        PB-I-LF-PREMIUM-AMT = ZERO
 12700         GO TO 3140-CHECK-AH-FOR-ZERO.
 12701
 12702     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12703        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12704        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12705         GO TO 3140-CHECK-AH-FOR-ZERO.
 12706
 12707     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12708        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12709        MOVE ER-2631             TO WS-ERROR
 12710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12711     END-IF
 12712
 12713
 12714******************************************************************
 12715*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12716******************************************************************
 12717
 12718     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12719        NEXT SENTENCE
 12720     ELSE
 12721        IF PB-I-LF-BENEFIT-AMT = ZERO
 12722           MOVE ER-2632             TO WS-ERROR
 12723           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12724
 12725
 12726******************************************************************
 12727*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12728******************************************************************
 12729
 12730     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12731        CONTINUE
 12732     ELSE
 12733        IF PB-I-LF-PREMIUM-AMT = ZERO
 12734           IF (NOT PB-COMP-LF-PREM)
 12735              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12736              MOVE ER-2633       TO WS-ERROR
 12737              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12738           END-IF
 12739        END-IF
 12740     END-IF
 12741     .
 12742 3140-CHECK-AH-FOR-ZERO.
 12743
 12744     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12745        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12746        PB-I-AH-PREMIUM-AMT = ZERO
 12747         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12748
 12749     IF PB-COMPANY-ID = 'CSL'  AND
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 233
* EL050.cbl
 12750        PB-I-AH-BENEFIT-CD = ZERO  AND
 12751        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12752        PB-I-AH-PREMIUM-AMT = ZERO
 12753         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12754
 12755     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12756        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12757        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12758         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12759
 12760     IF PB-I-AH-BENEFIT-CD = ZERO
 12761         MOVE ER-2634            TO WS-ERROR
 12762         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12763
 12764******************************************************************
 12765*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12766******************************************************************
 12767
 12768     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12769        NEXT SENTENCE
 12770     ELSE
 12771        IF PB-I-AH-BENEFIT-AMT = ZERO
 12772           MOVE ER-2635             TO WS-ERROR
 12773           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12774
 12775******************************************************************
 12776*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12777******************************************************************
 12778
 12779     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12780        NEXT SENTENCE
 12781     ELSE
 12782        IF PB-I-AH-PREMIUM-AMT = ZERO
 12783            IF NOT PB-COMP-AH-PREM
 12784                MOVE ER-2636    TO WS-ERROR
 12785                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12786
 12787
 12788 3140-EDIT-MAX-AMT-SIZES.
 12789* CUSTOM CODE FOR CLIENT    'DMD'
 12790     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12791                                     WS-RES-MUNI-TAX
 12792                                     PB-I-STATE-TAX
 12793                                     PB-I-MUNI-TAX.
 12794
 12795     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12796
 12797     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12798        GO TO 3150-RATE-OUTSTAND-BAL.
 12799
 12800     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12801        GO TO 3150-RATE-OUTSTAND-BAL.
 12802
 12803     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12804        GO TO 3150-RATE-OUTSTAND-BAL.
 12805
 12806     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12807                             OR 'RIC')
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 234
* EL050.cbl
 12808        GO TO 3150-RATE-OUTSTAND-BAL.
 12809
 12810     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12811        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12812            GO TO 3150-RATE-OUTSTAND-BAL
 12813        ELSE
 12814           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12815               GO TO 3150-RATE-OUTSTAND-BAL.
 12816
 12817     IF NOT PB-NO-MONTHS-SKIPPED
 12818        GO TO 3150-RATE-OUTSTAND-BAL.
 12819
 12820     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12821        GO TO 3150-RATE-OUTSTAND-BAL.
 12822
 12823     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12824        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12825           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12826             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12827           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12828           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12829              MOVE ER-2693     TO WS-ERROR
 12830              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12831              GO TO 3150-RATE-OUTSTAND-BAL
 12832           ELSE
 12833              GO TO 3150-RATE-OUTSTAND-BAL.
 12834
 12835 3150-RATE-OUTSTAND-BAL.
 12836
 12837* DMD RATING TEST
 12838     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12839         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12840         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12841         MOVE ER-2687                 TO WS-ERROR
 12842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12843         MOVE 'B'                     TO PB-I-OB-FLAG
 12844         GO TO 3260-EDIT-CONTINUE.
 12845
 12846     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12847         IF  WS-ERROR    EQUAL    ER-2693
 12848             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12849                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12850                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12851                 MOVE  +0            TO  WS-ERROR.
 12852
 12853     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12854         IF  WS-ERROR    EQUAL    ER-2693
 12855             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12856                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12857                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12858                 MOVE  +0            TO  WS-ERROR.
 12859
 12860     IF PLAN-MASTER-AH-SW = 'Y'
 12861        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12862            IF  WS-ERROR    EQUAL    ER-2693
 12863              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12864                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12865                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 235
* EL050.cbl
 12866                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12867                 MOVE  ER-1910           TO  WS-ERROR
 12868                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12869
 12870     IF PLAN-MASTER-AH-SW = 'Y'
 12871        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12872            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12873               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12874               MOVE  ER-1910           TO  WS-ERROR
 12875               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12876
 12877     IF PLAN-MASTER-AH-SW = 'Y'
 12878        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12879            IF  WS-ERROR    EQUAL    ER-2693
 12880                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12881                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12882                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12883                 MOVE  +0       TO  WS-ERROR.
 12884
 12885     IF WS-ERROR = ER-2693
 12886        IF PB-COMPANY-ID = 'JAL' AND
 12887           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12888           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12889           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12890
 12891     IF WS-ERROR = ER-2693
 12892        IF PB-COMPANY-ID = 'NCL'  AND
 12893           PB-I-AH-BENEFIT-CD = 'OA'
 12894           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12895           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12896
 12897     IF WS-ERROR = ER-2693
 12898        IF PB-COMPANY-ID = 'CNL' AND
 12899           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12900           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12901           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12902
 12903     IF WS-ERROR = ER-2693
 12904        IF PB-COMPANY-ID = 'HER'
 12905           IF WS-LEVEL
 12906              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12907              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12908
 12909     IF ((LF-BENEFIT-FOUND) AND
 12910         (NOT NO-LIFE-COVERAGE)  AND
 12911         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12912       OR   ((AH-BENEFIT-FOUND) AND
 12913             (NOT NO-AH-COVERAGE)    AND
 12914             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12915         NEXT SENTENCE
 12916     ELSE
 12917         GO TO 3215-EDIT-RATES.
 12918
 12919     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12920        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12921           MOVE ER-2674          TO WS-ERROR
 12922           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12923           GO TO 3215-EDIT-RATES.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 236
* EL050.cbl
 12924
 12925     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12926        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12927           MOVE ER-2674          TO WS-ERROR
 12928           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12929           GO TO 3215-EDIT-RATES.
 12930
 12931     MOVE 'B'                    TO PB-I-OB-FLAG.
 12932
 12933     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12934         NEXT SENTENCE
 12935     ELSE
 12936         IF NOT NO-LIFE-COVERAGE
 12937             IF WS-ACCT-LF-OB-RT = ZERO
 12938                MOVE ER-2641    TO WS-ERROR
 12939                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12940
 12941     IF PB-COMPANY-ID = 'CRI'
 12942       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12943         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12944         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12945         IF WS-ERROR = ER-2675
 12946            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12947            MOVE ER-2687              TO WS-ERROR
 12948            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12949         ELSE
 12950            MOVE ER-2687              TO WS-ERROR
 12951            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12952
 12953
 12954     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12955         NEXT SENTENCE
 12956     ELSE
 12957       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12958            NEXT SENTENCE
 12959       ELSE
 12960         IF NOT NO-AH-COVERAGE
 12961             IF WS-ACCT-AH-OB-RT = ZERO
 12962                MOVE ER-2642    TO WS-ERROR
 12963                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12964
 12965     IF PB-COMPANY-ID = 'CRI'
 12966       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12967         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12968         IF WS-ERROR = ER-2676
 12969            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12970            MOVE ER-2687              TO WS-ERROR
 12971            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12972         ELSE
 12973            MOVE ER-2687              TO WS-ERROR
 12974            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12975
 12976     IF PB-COMPANY-ID NOT = 'GIC'
 12977         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12978            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12979     ELSE
 12980         IF PB-I-LF-PREM-CALC = ZEROS
 12981             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 237
* EL050.cbl
 12982                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12983
 12984     IF PB-COMPANY-ID NOT = 'GIC'
 12985         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12986            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12987     ELSE
 12988         IF PB-I-AH-PREM-CALC = ZEROS
 12989             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12990                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12991
 12992     MOVE ZEROS TO PB-I-MORT-CODE.
 12993
 12994     GO TO 3260-EDIT-CONTINUE.
 12995
 12996
 12997 3215-EDIT-RATES.
 12998     IF ACCOUNT-MAST-FOUND
 12999         NEXT SENTENCE
 13000     ELSE
 13001         GO TO 3999-END-EDIT.
 13002
 13003 3220-CHECK-LF-RATES.
 13004
 13005     IF PB-COMPANY-ID = 'DCC'
 13006        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13007        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13008        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13009           AND (NOT WS-LF-CASH))
 13010                           OR
 13011           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13012           AND (NOT WS-AH-CASH)))
 13013                       AND
 13014           (PB-I-ENTRY-STATUS NOT = '5')
 13015           MOVE 'M'              TO PB-BATCH-ENTRY
 13016                                    PB-I-ENTRY-STATUS
 13017        END-IF
 13018     END-IF
 13019     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13020                                    PB-I-AH-PREM-CALC
 13021                                    PB-I-LF-ALT-PREM-CALC
 13022                                    PB-I-LF-ALT-RATE
 13023                                    PB-I-LF-REI-RATE
 13024                                    PB-I-LF-ALT-REI-RATE
 13025                                    PB-I-AH-REI-RATE
 13026                                    PB-I-TOT-FEES-CALC.
 13027
 13028     IF PB-COMPANY-ID EQUAL 'DMD'
 13029        NEXT SENTENCE
 13030     ELSE
 13031        MOVE ZEROS               TO PB-I-LF-RATE
 13032                                    PB-I-AH-RATE.
 13033
 13034     IF PB-I-TOT-FEES NOT NUMERIC
 13035        MOVE ZEROS               TO PB-I-TOT-FEES
 13036     END-IF
 13037     IF PB-I-LIVES NOT NUMERIC
 13038         MOVE ZERO               TO PB-I-LIVES.
 13039
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 238
* EL050.cbl
 13040     IF PB-I-NUM-BILLED NOT NUMERIC
 13041         MOVE ZERO               TO PB-I-NUM-BILLED.
 13042
 13043     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13044        MOVE +0                  TO PB-I-LF-PREM-TAX
 13045     END-IF
 13046
 13047     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13048        MOVE +0                  TO PB-I-AH-PREM-TAX
 13049     END-IF
 13050
 13051     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13052        PB-I-PAY-FREQUENCY = ZEROS
 13053            MOVE 12 TO CP-PAY-FREQUENCY
 13054     ELSE
 13055            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13056
 13057     IF PB-I-STATE-TAX NOT NUMERIC
 13058         MOVE ZEROS               TO PB-I-STATE-TAX.
 13059
 13060     IF PB-I-MUNI-TAX NOT NUMERIC
 13061         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13062
 13063     MOVE SPACES                 TO CP-BEN-CATEGORY
 13064     IF PB-COMPANY-ID  = 'CSL'  AND
 13065        PB-I-LF-TERM NOT = ZERO
 13066        COMPUTE WS-PAYMENT-AMT =
 13067             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13068        COMPUTE WS-CSL-AMT1 =
 13069             PB-I-LF-TERM * AM-MAX-MON-BEN
 13070        COMPUTE WS-CSL-AMT2 =
 13071             WS-PAYMENT-AMT * PB-I-LF-TERM
 13072        IF CP-PAY-FREQUENCY NOT = 12
 13073           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13074           MOVE '8' TO WS-CSL-CALC-CD
 13075        ELSE
 13076           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13077              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13078               AM-MAX-TOT-BEN
 13079               MOVE '6' TO WS-CSL-CALC-CD
 13080           ELSE
 13081              IF (WS-CSL-AMT1  GREATER THAN
 13082                 AM-MAX-TOT-BEN) AND
 13083                 (WS-CSL-AMT2  GREATER THAN
 13084                 AM-MAX-TOT-BEN)
 13085                 MOVE '7' TO WS-CSL-CALC-CD
 13086              ELSE
 13087                 MOVE '5' TO WS-CSL-CALC-CD.
 13088
 13089     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13090         NEXT SENTENCE
 13091     ELSE
 13092         GO TO 3300-CHECK-AH-RATES.
 13093
 13094*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13095
 13096     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13097        IF (PB-I-LF-CRIT-PER    EQUAL +0)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 239
* EL050.cbl
 13098              OR
 13099           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13100           MOVE ER-2618          TO WS-ERROR
 13101           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13102           GO TO 3300-CHECK-AH-RATES.
 13103
 13104     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13105           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13106                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13107
 13108     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13109         MOVE ER-2687             TO WS-ERROR
 13110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13111         MOVE 'Z000'              TO PB-I-MORT-CODE
 13112         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13113         GO TO 3300-CHECK-AH-RATES.
 13114
 13115     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13116        IF PB-I-LIVES = ZERO
 13117           MOVE ER-2688          TO WS-ERROR
 13118           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13119
 13120     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13121
 13122     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13123     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13124     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13125     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13126     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13127     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13128     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13129     MOVE '3'                    TO CP-PROCESS-TYPE.
 13130     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13131     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13132
 13133******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13134     IF PB-COMPANY-ID EQUAL 'CDL'
 13135         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13136            CP-EARN-AS-NET-PAY)
 13137             IF PB-CERT-EFF-DT GREATER  WS-931231
 13138                 MOVE '1'        TO CP-EARNING-METHOD.
 13139*******
 13140
 13141     MOVE PB-SV-STATE            TO CP-STATE.
 13142     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13143     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13144     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13145     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13146     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13147                                    CP-RATING-BENEFIT-AMT.
 13148     IF CP-STATE-STD-ABBRV = 'OR'
 13149         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13150                                         PB-I-LF-ALT-BENEFIT-AMT.
 13151     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13152     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13153     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13154     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13155     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 240
* EL050.cbl
 13156     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13157     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13158     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13159     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13160                                    CP-REMAINING-TERM
 13161                                    CP-LOAN-TERM.
 13162
 13163     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13164         NEXT SENTENCE
 13165     ELSE
 13166         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13167             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13168                                           PB-I-LF-PREMIUM-AMT.
 13169
 13170     IF PB-COMPANY-ID EQUAL 'CSL'
 13171        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13172           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13173                                         PB-I-LF-PREMIUM-AMT.
 13174
 13175     IF PB-COMPANY-ID EQUAL 'NCB'
 13176         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13177            CP-EARN-AS-NET-PAY
 13178             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13179                 PB-I-LF-PREMIUM-AMT.
 13180
 13181     IF (CP-TRUNCATED-LIFE)
 13182        or ((pb-company-id = 'AHL')
 13183           and (pb-i-loan-term > pb-i-lf-term))
 13184        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13185
 13186     IF PB-COMPANY-ID EQUAL 'CRI'
 13187        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13188
 13189     IF CP-TERM-IS-DAYS
 13190         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13191     ELSE
 13192         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13193     IF PB-COMPANY-ID = 'DCC'
 13194        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13195        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13196        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13197        IF WS-LF-BEN-CATEGORY = 'D'
 13198           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13199           MOVE PB-I-LIFE-COMMISSION
 13200                                 TO CP-DCC-ACT-COMM
 13201           MOVE WS-LF-BEN-CATEGORY
 13202                                 TO CP-BEN-CATEGORY
 13203        END-IF
 13204        IF (CP-BENEFIT-CD (1:1) = 'P')
 13205           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13206           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13207           add pb-i-ah-premium-amt to cp-original-premium
 13208        END-IF
 13209     END-IF
 13210     IF PB-COMPANY-ID = 'CSL'
 13211         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13212         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13213         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 241
* EL050.cbl
 13214
 13215     IF PB-COMPANY-ID = 'CSL'
 13216        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13217
 13218     IF (CP-SPECIAL-CALC-CD = 'H')
 13219        OR (PB-COMPANY-ID = 'DCC')
 13220         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13221                                    TO CP-ALTERNATE-BENEFIT
 13222         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13223
 13224     IF (PB-COMPANY-ID = 'CID')
 13225        AND (WS-LF-EARNINGS-CALC = 'B')
 13226        AND (CP-STATE-STD-ABBRV = 'MN')
 13227        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13228                                 TO CP-ALTERNATE-BENEFIT
 13229        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13230     END-IF
 13231     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13232     MOVE 'R'                   TO CP-RATE-FILE.
 13233     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13234
 13235     IF CP-ERROR-RATE-NOT-FOUND
 13236        MOVE ER-2641            TO WS-ERROR
 13237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13238        GO TO 3300-CHECK-AH-RATES.
 13239
 13240     IF PB-COMPANY-ID EQUAL 'CRI'
 13241        IF CP-ERROR-NO-LIMITS-CRI
 13242           IF NOT ACCOUNT-LIFE-CHECKED
 13243              MOVE ER-2607      TO WS-ERROR
 13244              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13245
 13246******************************************************************
 13247*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13248*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13249******************************************************************
 13250
 13251* CALC LIFE AGE AT EXPIRATION.
 13252
 13253     COMPUTE WS-AGE-AT-EXPIRE =
 13254          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13255
 13256*    IF PB-STATE = 'CO' OR 'UT'
 13257*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13258*        MOVE 'F'            TO PB-FATAL-FLAG
 13259*        MOVE ER-2709        TO WS-ERROR
 13260*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13261*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13262
 13263*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13264*        MOVE 'X'            TO PB-FATAL-FLAG
 13265*        MOVE ER-2718        TO WS-ERROR
 13266*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13267*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13268
 13269* CALC A & H AGE AT EXPIRATION.
 13270
 13271     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 242
* EL050.cbl
 13272          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13273
 13274*    IF PB-STATE = 'CO' OR 'UT'
 13275*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13276*        MOVE 'F'            TO PB-FATAL-FLAG
 13277*        MOVE ER-2709        TO WS-ERROR
 13278*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13279*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13280
 13281*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13282*        MOVE 'X'            TO PB-FATAL-FLAG
 13283*        MOVE ER-2718        TO WS-ERROR
 13284*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13285*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13286
 13287     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13288        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13289
 13290     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13291        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13292
 13293     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13294        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13295
 13296     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13297         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13298         MOVE ER-2639        TO WS-ERROR
 13299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13300
 13301
 13302******************************************************************
 13303*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13304******************************************************************
 13305
 13306 PREMIUM-EDITING-IS-BYPASSED.
 13307     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13308        AND (CP-R-MAX-ATT-AGE > +0)
 13309        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13310        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13311           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13312           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13313           MOVE '1'              TO DC-OPTION-CODE
 13314           PERFORM 8500-DATE-CONVERT
 13315                                 THRU 8500-EXIT
 13316           IF NO-CONVERSION-ERROR
 13317              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13318                 MOVE ER-2661       TO WS-ERROR
 13319*                PERFORM 9900-ERROR-FORMAT
 13320*                                THRU 9900-EXIT
 13321              END-IF
 13322           END-IF
 13323        ELSE
 13324           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13325           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13326              MOVE ER-2661       TO WS-ERROR
 13327*             PERFORM 9900-ERROR-FORMAT
 13328*                                THRU 9900-EXIT
 13329           ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 243
* EL050.cbl
 13330              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13331                 MOVE ER-1570    TO WS-ERROR
 13332                 PERFORM 9900-ERROR-FORMAT
 13333                                 THRU 9900-EXIT
 13334              END-IF
 13335           END-IF
 13336        END-IF
 13337        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13338           MOVE PB-I-JOINT-BIRTHDAY
 13339                                 TO DC-BIN-DATE-1
 13340           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13341           MOVE '1'              TO DC-OPTION-CODE
 13342           PERFORM 8500-DATE-CONVERT
 13343                                 THRU 8500-EXIT
 13344           IF NO-CONVERSION-ERROR
 13345              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13346                 MOVE ER-2661       TO WS-ERROR
 13347*                PERFORM 9900-ERROR-FORMAT
 13348*                                THRU 9900-EXIT
 13349              END-IF
 13350           ELSE
 13351              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13352           END-IF
 13353        ELSE
 13354           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13355             (PB-I-LF-TERM / 12)
 13356           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13357              MOVE ER-2661       TO WS-ERROR
 13358*             PERFORM 9900-ERROR-FORMAT
 13359*                                THRU 9900-EXIT
 13360           ELSE
 13361              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13362                 MOVE ER-1571    TO WS-ERROR
 13363                 PERFORM 9900-ERROR-FORMAT
 13364                                 THRU 9900-EXIT
 13365              END-IF
 13366           END-IF
 13367        END-IF
 13368        IF WS-ERROR = ER-2661
 13369           PERFORM 9900-ERROR-FORMAT
 13370                                 THRU 9900-EXIT
 13371        END-IF
 13372     END-IF
 13373*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13374*       MOVE ER-2661             TO WS-ERROR
 13375*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13376
 13377     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13378        MOVE ER-2662             TO WS-ERROR
 13379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13380
 13381     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13382        MOVE ER-2677             TO WS-ERROR
 13383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13384
 13385     IF CP-ERROR-LOAN-TERM
 13386        MOVE ER-2648             TO WS-ERROR
 13387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 244
* EL050.cbl
 13388
 13389 3221-CHECK-ERROR-RATE-OPEN.
 13390
 13391     IF CP-ERROR-RATE-FILE-NOTOPEN
 13392         GO TO 3990-FILES-NOT-OPEN.
 13393
 13394     IF PB-COMPANY-ID NOT = 'DMD'
 13395        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13396     END-IF
 13397     .
 13398 3221-CONTINUE.
 13399     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13400                                    WS-DCC-AH-RATE
 13401     IF PB-COMPANY-ID = 'DCC'
 13402        IF WS-LF-BEN-CATEGORY = 'D'
 13403           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13404              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13405        END-IF
 13406     END-IF
 13407     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13408*   X'A4FF' = 12/31/2009
 13409     IF (PB-COMPANY-ID = 'CID')
 13410        AND (WS-LF-EARNINGS-CALC = 'B')
 13411        AND (CP-STATE-STD-ABBRV = 'MN')
 13412        AND (PB-CERT-EFF-DT > X'A4FF')
 13413        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13414     END-IF
 13415     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13416
 13417     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13418     IF (PB-COMPANY-ID = 'DCC')
 13419        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13420        AND (PB-I-POLICY-IS-MONTHLY)
 13421        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13422        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13423     END-IF
 13424     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13425     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13426     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13427     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13428     IF (PB-COMPANY-ID = 'DCC')
 13429        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13430        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13431        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13432        MOVE ER-2786             TO WS-ERROR
 13433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13434     END-IF
 13435
 13436     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13437
 13438******************************************************************
 13439*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13440******************************************************************
 13441     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13442        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13443
 13444     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13445        GO TO 3225-CHECK-ALT-LIFE-RATE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 245
* EL050.cbl
 13446     ELSE
 13447       IF PB-I-LF-RATE = ZERO
 13448          MOVE ER-2641          TO WS-ERROR
 13449          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13450
 13451 3225-CHECK-ALT-LIFE-RATE.
 13452
 13453     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13454        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13455        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13456         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13457
 13458     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13459         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13460             AND PB-COMPANY-ID NOT = 'DCC')
 13461                   OR
 13462              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13463              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13464              AND PB-COMPANY-ID NOT = 'DCC')
 13465             MOVE ER-2720        TO  WS-ERROR
 13466             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13467             GO TO 3225-RATING-CONT
 13468         ELSE
 13469             GO TO 3225-RATING-CONT.
 13470     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13471        AND (AM-GPCD = 01 OR 06 OR 15)
 13472        MOVE ER-2798             TO WS-ERROR
 13473        PERFORM 9900-ERROR-FORMAT
 13474                                 THRU 9900-EXIT
 13475*       GO TO 3225-RATING-CONT
 13476     END-IF
 13477     IF (PB-COMPANY-ID = 'CID')
 13478        AND (WS-LF-EARNINGS-CALC = 'B')
 13479        AND (CP-STATE-STD-ABBRV = 'MN')
 13480        AND (PB-CERT-EFF-DT > X'A4FF')
 13481        GO TO 3225-RATING-CONT
 13482     END-IF
 13483     IF PB-COMPANY-ID = 'DCC'
 13484        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13485           AND (PB-I-POLICY-IS-MONTHLY)
 13486           GO TO 3225-RATING-CONT
 13487        END-IF
 13488     END-IF
 13489
 13490     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13491        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13492        CP-EARN-AS-REG-BALLOON
 13493        NEXT SENTENCE
 13494     ELSE
 13495        MOVE '2'                 TO CP-EARNING-METHOD.
 13496
 13497 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13498
 13499     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13500
 13501     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13502        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13503        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 246
* EL050.cbl
 13504         NEXT SENTENCE
 13505     ELSE
 13506         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13507
 13508     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13509     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13510     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13511                                     CP-RATING-BENEFIT-AMT.
 13512     IF CP-STATE-STD-ABBRV = 'OR'
 13513         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13514                                         PB-I-LF-ALT-BENEFIT-AMT.
 13515     IF PB-COMPANY-ID = 'DCC'
 13516        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13517     END-IF
 13518     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13519     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13520     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13521                                    CP-REMAINING-TERM
 13522                                    CP-LOAN-TERM.
 13523     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13524        ADD +1                   TO CP-ORIGINAL-TERM
 13525                                    CP-REMAINING-TERM
 13526                                    CP-LOAN-TERM.
 13527
 13528     MOVE 'R'                   TO CP-RATE-FILE.
 13529     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13530
 13531     IF CP-ERROR-RATE-NOT-FOUND
 13532         MOVE ER-2641            TO WS-ERROR
 13533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534         GO TO 3300-CHECK-AH-RATES.
 13535
 13536     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13537     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13538
 13539     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13540         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13541
 13542     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13543                               + PB-I-LF-ALT-BENEFIT-AMT.
 13544
 13545     IF ACCOUNT-LIFE-CHECKED  OR
 13546        PB-POLICY-IS-VOIDED   OR
 13547        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13548        GO TO 3225-CONTINUE.
 13549
 13550     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13551        GO TO 3225-CONTINUE.
 13552
 13553     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13554                             EC-RT-LF-MAX-TOT-BEN
 13555        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13556        MOVE ER-2639       TO WS-ERROR
 13557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13558
 13559 3225-CONTINUE.
 13560     IF PB-I-LF-ALT-RATE = ZERO
 13561         MOVE ER-2659            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 247
* EL050.cbl
 13562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13563
 13564     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13565        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13566        MOVE ER-2698             TO WS-ERROR
 13567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13568
 13569 3225-RATING-CONT.
 13570
 13571     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13572         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13573         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13574         IF (PB-COMPANY-ID = 'DCC')
 13575            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13576            CONTINUE
 13577         ELSE
 13578            MOVE ER-2687         TO WS-ERROR
 13579            PERFORM 9900-ERROR-FORMAT
 13580                                 THRU 9900-EXIT
 13581         END-IF
 13582         GO TO 3290-EDIT-LF-REIN-RATE
 13583     END-IF
 13584
 13585* DMD RATING TEST
 13586     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13587         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13588         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13589         MOVE ER-2687                 TO WS-ERROR
 13590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13591         GO TO 3290-EDIT-LF-REIN-RATE.
 13592
 13593 3230-CLIENT-MORT-CD-SPECIALS.
 13594
 13595     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13596     SET BIN-TO-GREG          TO TRUE.
 13597*    MOVE ' '                 TO DC-OPTION-CODE.
 13598     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13599     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13600
 13601 C-POS-3230-MORT-CD.
 13602     IF PB-COMPANY-ID = 'POS' AND
 13603        PB-SV-CARRIER = '2'
 13604         NEXT SENTENCE
 13605     ELSE
 13606         GO TO C-POS-3240-MORT-CD.
 13607
 13608     IF PB-SV-GROUPING = '030'
 13609        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13610         MOVE '2350' TO PB-I-MORT-CODE
 13611      ELSE
 13612         MOVE '3300' TO PB-I-MORT-CODE.
 13613
 13614
 13615 C-POS-3240-MORT-CD.
 13616     IF PB-COMPANY-ID = 'POS' AND
 13617        PB-SV-CARRIER = '1'
 13618         NEXT SENTENCE
 13619     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 248
* EL050.cbl
 13620         GO TO 3230-CONTINUE.
 13621
 13622     IF PB-SV-STATE = '45' OR '47'
 13623        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13624         MOVE '5200' TO PB-I-MORT-CODE
 13625     ELSE
 13626         MOVE '8300' TO PB-I-MORT-CODE.
 13627
 13628 3230-CONTINUE.
 13629
 13630     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13631        GO TO 3240-CONTINUE
 13632     END-IF
 13633
 13634     IF PB-CERT-EFF-DT > WS-971231
 13635        GO TO 3240-CONTINUE
 13636     END-IF
 13637
 13638     IF LF-BENEFIT-FOUND AND
 13639        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13640         MOVE 'F250'       TO PB-I-MORT-CODE
 13641     ELSE
 13642         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13643             MOVE '7250'   TO PB-I-MORT-CODE
 13644         ELSE
 13645             MOVE '4251'   TO PB-I-MORT-CODE
 13646         END-IF
 13647     END-IF
 13648
 13649     .
 13650 3240-CONTINUE.
 13651
 13652     IF PB-COMPANY-ID NOT = 'GNL'
 13653         GO TO 3256-CONTINUE.
 13654
 13655     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13656         MOVE 'A300' TO PB-I-MORT-CODE
 13657     ELSE
 13658         MOVE '8350' TO PB-I-MORT-CODE.
 13659
 13660 3256-CONTINUE.
 13661     IF PB-COMPANY-ID NOT = 'ABL'
 13662         GO TO 3260-EDIT-CONTINUE.
 13663
 13664     IF PB-I-LF-TERM GREATER THAN 59
 13665         MOVE 'F550' TO PB-I-MORT-CODE
 13666     ELSE
 13667         MOVE 'E550' TO PB-I-MORT-CODE.
 13668
 13669 3260-EDIT-CONTINUE.
 13670     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13671
 13672 3290-EDIT-LF-REIN-RATE.
 13673     IF LF-REIN-NSP-NOT-USED
 13674         GO TO 3290-RATING-CONT.
 13675
 13676     IF PB-COMPANY-ID = 'DCC'
 13677        GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 249
* EL050.cbl
 13678     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13679     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13680     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13681     MOVE '3'                   TO CP-PROCESS-TYPE.
 13682     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13683
 13684******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13685     IF PB-COMPANY-ID EQUAL 'CDL'
 13686         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13687            CP-EARN-AS-NET-PAY)
 13688             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13689*            MOVE SPACE          TO DC-OPTION-CODE
 13690             SET BIN-TO-GREG     TO TRUE
 13691             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13692***  Y2K PROJ 7744
 13693             IF DC-GREG-DATE-CYMD GREATER 19931231
 13694                 MOVE '1'        TO CP-EARNING-METHOD.
 13695***  Y2K PROJ 7744
 13696*******
 13697
 13698     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13699     MOVE PB-SV-STATE           TO CP-STATE.
 13700     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13701     MOVE ZERO                  TO CP-DEVIATION-CODE
 13702                                   CP-RATE-DEV-PCT.
 13703     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13704     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13705                                   CP-RATING-BENEFIT-AMT.
 13706
 13707************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13708     IF PB-COMPANY-ID EQUAL 'NCB'
 13709         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13710            CP-EARN-AS-NET-PAY
 13711             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13712                 PB-I-LF-PREMIUM-AMT.
 13713************
 13714
 13715     IF CP-STATE-STD-ABBRV = 'OR'
 13716         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13717                                         PB-I-LF-ALT-BENEFIT-AMT.
 13718     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13719     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13720     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13721     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13722     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13723     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13724     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13725     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13726                                   CP-REMAINING-TERM
 13727                                   CP-LOAN-TERM.
 13728     IF CP-TRUNCATED-LIFE
 13729        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13730
 13731     IF CP-TERM-IS-DAYS
 13732         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13733     ELSE
 13734         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13735
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 250
* EL050.cbl
 13736     IF PB-COMPANY-ID = 'DCC'
 13737        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13738     END-IF
 13739     IF PB-COMPANY-ID NOT = 'TIC'
 13740          MOVE ZERO          TO CP-CLASS-CODE.
 13741
 13742     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13743
 13744     MOVE 'R'                   TO CP-RATE-FILE.
 13745     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13746
 13747     IF CP-ERROR-RATE-NOT-FOUND
 13748        IF PB-I-OB
 13749           MOVE ER-2625      TO WS-ERROR
 13750           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13751           GO TO 3299-EDIT-CONTINUE
 13752        ELSE
 13753           MOVE ER-2643      TO WS-ERROR
 13754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13755           GO TO 3299-EDIT-CONTINUE.
 13756
 13757     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13758
 13759     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13760     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13761
 13762     IF PB-I-LF-REI-RATE = ZERO
 13763         MOVE ER-2643        TO WS-ERROR
 13764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13765
 13766 3290-CHECK-ALT-REIN-RATE.
 13767
 13768     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13769        GO TO 3290-RATING-CONT.
 13770
 13771     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13772     MOVE '2'                    TO CP-EARNING-METHOD.
 13773     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13774     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13775     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13776     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13777                                     CP-RATING-BENEFIT-AMT.
 13778     IF CP-STATE-STD-ABBRV = 'OR'
 13779         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13780                                         PB-I-LF-ALT-BENEFIT-AMT.
 13781     IF PB-COMPANY-ID = 'DCC'
 13782        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13783     END-IF
 13784     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13785     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13786     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13787                                    CP-REMAINING-TERM
 13788                                    CP-LOAN-TERM.
 13789     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13790        ADD +1                   TO CP-ORIGINAL-TERM
 13791                                    CP-REMAINING-TERM
 13792                                    CP-LOAN-TERM.
 13793
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 251
* EL050.cbl
 13794     MOVE 'R'                   TO CP-RATE-FILE.
 13795     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13796
 13797     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13798
 13799     IF PB-I-LF-ALT-REI-RATE = ZERO
 13800         MOVE ER-2643            TO WS-ERROR
 13801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13802
 13803 3290-RATING-CONT.
 13804
 13805     IF PB-I-OB
 13806*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13807        GO TO 3300-CHECK-AH-RATES.
 13808
 13809 3299-EDIT-CONTINUE.
 13810
 13811     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13812         NEXT SENTENCE
 13813     ELSE
 13814         MOVE ER-2620           TO WS-ERROR
 13815         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13816
 13817 3300-CHECK-AH-RATES.
 13818     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13819         NEXT SENTENCE
 13820     ELSE
 13821         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13822
 13823     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13824        ((CF-COMPANY-ID = 'DMD') AND
 13825                (NO-DMD-RATING))
 13826         IF (PB-COMPANY-ID = 'DCC')
 13827            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13828            CONTINUE
 13829         ELSE
 13830            MOVE ER-2687         TO WS-ERROR
 13831            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13832         END-IF
 13833         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13834         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13835     END-IF
 13836
 13837     IF PB-I-OB
 13838        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13839
 13840     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13841         MOVE ER-2687             TO WS-ERROR
 13842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13843         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13844         GO TO 3999-END-EDIT.
 13845
 13846*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13847
 13848     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13849        IF PB-I-AH-CRIT-PER = ZERO
 13850           IF PB-COMPANY-ID = 'DCC'
 13851              AND AM-DCC-PRODUCT-CODE = 'DDF'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 252
* EL050.cbl
 13852              CONTINUE
 13853           ELSE
 13854              MOVE ER-2618       TO WS-ERROR
 13855              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13856              GO TO 3999-END-EDIT
 13857           END-IF
 13858        END-IF
 13859     END-IF
 13860     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13861     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13862     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13863     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13864     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13865     MOVE PB-SV-STATE            TO CP-STATE.
 13866     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13867     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13868     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13869*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13870     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13871     MOVE '3'                    TO CP-PROCESS-TYPE.
 13872     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13873     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13874                                    CP-RATING-BENEFIT-AMT.
 13875     IF PB-COMPANY-ID = 'CID'
 13876               OR
 13877        CP-STATE-STD-ABBRV = 'OR'
 13878         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13879                                         PB-I-AH-TERM.
 13880     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13881        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13882           AND (PB-I-POLICY-IS-MONTHLY)
 13883           MOVE PB-I-LF-BENEFIT-AMT
 13884                                 TO CP-NET-BENEFIT-AMT
 13885           move pb-i-ah-premium-amt to cp-original-premium
 13886           add pb-i-lf-premium-amt to cp-original-premium
 13887        END-IF
 13888     END-IF
 13889     MOVE SPACES                 TO CP-BEN-CATEGORY
 13890     IF PB-COMPANY-ID = 'DCC'
 13891        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13892        EVALUATE TRUE
 13893           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13894              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13895              MOVE PB-I-LF-BENEFIT-AMT
 13896                                 TO CP-RATING-BENEFIT-AMT
 13897              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13898           WHEN WS-AH-BEN-CATEGORY = 'G'
 13899              MOVE PB-I-UNPAID-CASH-PRICE
 13900                                 TO CP-RATING-BENEFIT-AMT
 13901           WHEN WS-AH-BEN-CATEGORY = 'D'
 13902              MOVE WS-AH-PMF-COMM
 13903                                 TO CP-DCC-PMF-COMM
 13904              MOVE PB-I-AH-COMMISSION
 13905                                 TO CP-DCC-ACT-COMM
 13906        END-EVALUATE
 13907     END-IF
 13908     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13909     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 253
* EL050.cbl
 13910     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13911     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13912     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13913     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13914     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13915                                    CP-REMAINING-TERM
 13916                                    WS-WORK-TERM.
 13917     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13918
 13919     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13920     SET BIN-TO-GREG             TO TRUE.
 13921*    MOVE ' '                    TO DC-OPTION-CODE.
 13922     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13923     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13924
 13925     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13926     IF NOT VALID-SKIP-CODE
 13927         MOVE ER-2683            TO WS-ERROR
 13928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13929         GO TO 3320-RATE-CONTINUE.
 13930
 13931     IF PB-NO-MONTHS-SKIPPED
 13932         GO TO 3320-RATE-CONTINUE.
 13933
 13934     MOVE SPACE TO NUMBER-OF-MONTHS.
 13935
 13936     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13937         MOVE 'S'                TO SK-MO (6).
 13938     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13939         MOVE 'S'                TO SK-MO (7).
 13940     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13941         MOVE 'S'                TO SK-MO (8).
 13942     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13943         MOVE 'S'                TO SK-MO (9).
 13944     IF PB-I-SKIP-CODE = 'A'
 13945         MOVE 'S'                TO SK-MO (10).
 13946
 13947     MOVE 1                      TO SUB2.
 13948     MOVE PB-I-AH-TERM           TO SUB3.
 13949     MOVE WS-MONTH               TO SUB1.
 13950     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13951     GO TO 3320-RATE-CONTINUE.
 13952
 13953 3310-GET-SKIP-MO.
 13954     IF SUB1 = 13
 13955         MOVE 1                  TO SUB1.
 13956
 13957     IF SK-MO (SUB1) = 'S'
 13958         SUBTRACT 1 FROM WS-WORK-TERM.
 13959
 13960     ADD 1 TO SUB2
 13961              SUB1.
 13962
 13963 3320-RATE-CONTINUE.
 13964
 13965     IF WS-WORK-TERM = ZERO
 13966         MOVE 1                  TO WS-WORK-TERM.
 13967
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 254
* EL050.cbl
 13968     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13969                                    CP-LOAN-TERM.
 13970
 13971     IF PB-COMPANY-ID EQUAL 'DMD'
 13972         NEXT SENTENCE
 13973     ELSE
 13974         MOVE ZERO               TO PB-I-AH-RATE
 13975                                    PB-I-AH-REI-RATE.
 13976
 13977
 13978     IF PB-COMPANY-ID EQUAL 'CRI'
 13979        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13980
 13981     IF PB-COMPANY-ID = 'CSL'
 13982         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13983         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13984         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13985         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13986
 13987     IF PB-COMPANY-ID = 'DCC'
 13988        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13989           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13990              PB-I-RATE-DEV-PCT-LF
 13991        END-IF
 13992        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13993                                 TO CP-ALTERNATE-BENEFIT
 13994        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13995        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13996        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13997     END-IF
 13998     IF (PB-COMPANY-ID = 'CID')
 13999        AND (WS-LF-EARNINGS-CALC = 'B')
 14000        AND (CP-STATE-STD-ABBRV = 'MN')
 14001        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14002     ELSE
 14003        MOVE ' '                 TO CP-AH-BALLOON-SW
 14004     END-IF
 14005     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14006     MOVE 'R'                   TO CP-RATE-FILE.
 14007     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14008
 14009     IF CP-ERROR-RATE-NOT-FOUND
 14010        IF PB-I-OB
 14011           MOVE ER-2624          TO WS-ERROR
 14012           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14013           GO TO 3340-CALCULATE-PREMIUM-AMT
 14014        ELSE
 14015          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14016              NEXT SENTENCE
 14017          ELSE
 14018           MOVE ER-2642          TO WS-ERROR
 14019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14020           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14021
 14022     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14023        CP-ERROR-DIV-BY-ZERO
 14024           MOVE ER-3782          TO WS-ERROR
 14025           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 255
* EL050.cbl
 14026
 14027     IF PB-COMPANY-ID EQUAL 'CRI'
 14028        IF CP-ERROR-NO-LIMITS-CRI
 14029           IF NOT ACCOUNT-AH-CHECKED
 14030              MOVE ER-2607          TO WS-ERROR
 14031              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14032
 14033     IF ACCOUNT-AH-CHECKED
 14034        NEXT SENTENCE
 14035     ELSE
 14036       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14037          MOVE ER-2640           TO WS-ERROR
 14038          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14039
 14040     IF PB-COMPANY-ID = 'CRI'
 14041         IF WS-ERROR = ER-2640
 14042             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14043     IF ACCOUNT-AH-CHECKED
 14044        CONTINUE
 14045     ELSE
 14046        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14047           AND (CP-R-MAX-ATT-AGE > +0)
 14048           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14049           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14050              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14051              MOVE PB-I-AH-EXPIRE-DT
 14052                                 TO DC-BIN-DATE-2
 14053              MOVE '1'           TO DC-OPTION-CODE
 14054              PERFORM 8500-DATE-CONVERT
 14055                                 THRU 8500-EXIT
 14056              IF NO-CONVERSION-ERROR
 14057                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14058                    MOVE ER-2661       TO WS-ERROR
 14059*                   PERFORM 9900-ERROR-FORMAT
 14060*                                THRU 9900-EXIT
 14061                 END-IF
 14062              END-IF
 14063           ELSE
 14064              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14065              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14066                 MOVE ER-2661    TO WS-ERROR
 14067*                PERFORM 9900-ERROR-FORMAT
 14068*                                THRU 9900-EXIT
 14069              ELSE
 14070                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14071                    MOVE ER-1570 TO WS-ERROR
 14072                    PERFORM 9900-ERROR-FORMAT
 14073                                 THRU 9900-EXIT
 14074                 END-IF
 14075              END-IF
 14076           END-IF
 14077           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14078              MOVE PB-I-JOINT-BIRTHDAY
 14079                                    TO DC-BIN-DATE-1
 14080              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14081              MOVE '1'              TO DC-OPTION-CODE
 14082              PERFORM 8500-DATE-CONVERT
 14083                                    THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 256
* EL050.cbl
 14084              IF NO-CONVERSION-ERROR
 14085                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14086                    MOVE ER-2661       TO WS-ERROR
 14087*                   PERFORM 9900-ERROR-FORMAT
 14088*                                   THRU 9900-EXIT
 14089                 END-IF
 14090              END-IF
 14091           ELSE
 14092              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14093                (PB-I-AH-TERM / 12)
 14094              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14095                 MOVE ER-2661       TO WS-ERROR
 14096*                PERFORM 9900-ERROR-FORMAT
 14097*                                   THRU 9900-EXIT
 14098              ELSE
 14099                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14100                    MOVE ER-1571 TO WS-ERROR
 14101                    PERFORM 9900-ERROR-FORMAT
 14102                                 THRU 9900-EXIT
 14103                 END-IF
 14104              END-IF
 14105           END-IF
 14106           IF WS-ERROR = ER-2661
 14107              PERFORM 9900-ERROR-FORMAT
 14108                                    THRU 9900-EXIT
 14109           END-IF
 14110        END-IF
 14111     END-IF
 14112*    IF ACCOUNT-AH-CHECKED
 14113*       NEXT SENTENCE
 14114*    ELSE
 14115*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14116*          MOVE ER-2661          TO WS-ERROR
 14117*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14118
 14119     IF ACCOUNT-AH-CHECKED
 14120        NEXT SENTENCE
 14121     ELSE
 14122        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14123           MOVE ER-2663          TO WS-ERROR
 14124           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14125
 14126     IF ACCOUNT-AH-CHECKED OR
 14127        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14128         PB-POLICY-IS-VOIDED
 14129        NEXT SENTENCE
 14130     ELSE
 14131        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14132           MOVE ER-2667            TO WS-ERROR
 14133           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14134
 14135     IF PB-COMPANY-ID = 'CRI'
 14136         IF WS-ERROR = ER-2667
 14137             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14138
 14139     IF ACCOUNT-AH-CHECKED
 14140        NEXT SENTENCE
 14141     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 257
* EL050.cbl
 14142        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14143           MOVE ER-2678            TO WS-ERROR
 14144           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14145
 14146     IF CP-ERROR-RATE-FILE-NOTOPEN
 14147         GO TO 3990-FILES-NOT-OPEN.
 14148
 14149 3321-CONTINUE.
 14150     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14151     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14152     IF (PB-COMPANY-ID = 'DCC')
 14153        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14154        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14155                                    PB-I-LF-ALT-PREM-CALC
 14156        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14157        IF WS-AH-BEN-CATEGORY = 'G'
 14158           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14159           + PB-I-ADDL-CLP)
 14160           * (1 + WS-TOL-CLP-PCT)
 14161*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14162        ELSE
 14163           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14164           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14165*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14166        END-IF
 14167        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14168                                 TO PB-I-AH-PREM-CALC
 14169        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14170           MOVE ER-8152          TO WS-ERROR
 14171           PERFORM 9900-ERROR-FORMAT
 14172                                 THRU 9900-EXIT
 14173        ELSE
 14174           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14175                 PB-I-ADDL-CLP)
 14176              MOVE ER-8148       TO WS-ERROR
 14177              PERFORM 9900-ERROR-FORMAT
 14178                                 THRU 9900-EXIT
 14179           END-IF
 14180        END-IF
 14181     END-IF
 14182     IF (PB-COMPANY-ID = 'DCC')
 14183        AND (PB-I-POLICY-IS-MONTHLY)
 14184        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14185        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14186        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14187           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14188        END-IF
 14189     END-IF
 14190     IF (PB-COMPANY-ID = 'DCC')
 14191        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14192        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14193        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14194        MOVE ER-2786             TO WS-ERROR
 14195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14196     END-IF
 14197     MOVE +0                     TO PB-I-AH-CLP
 14198     IF PB-COMPANY-ID = 'DCC'
 14199        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 258
* EL050.cbl
 14200           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14201              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14202        ELSE
 14203           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14204              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14205           END-IF
 14206        END-IF
 14207     END-IF
 14208     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14209
 14210     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14211         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14212
 14213     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14214         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14215
 14216     IF PB-COMPANY-ID = 'CRI'
 14217         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14218            PB-I-PAYMENT-AMOUNT = ZERO
 14219             NEXT SENTENCE
 14220         ELSE
 14221             COMPUTE PB-I-AH-PREM-CALC =
 14222                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14223                 (CP-PREMIUM-RATE / 100)
 14224             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14225                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14226                                             PB-I-RATE-DEV-PCT-AH.
 14227
 14228     IF PB-I-AH-RATE  = ZERO
 14229       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14230           NEXT SENTENCE
 14231       ELSE
 14232         MOVE ER-2642            TO WS-ERROR
 14233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14234
 14235     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14236     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14237     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14238     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14239     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14240     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14241
 14242     IF (PB-COMPANY-ID = 'DCC')
 14243        AND (WS-AH-BEN-CATEGORY = 'G')
 14244        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14245        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14246        IF CP-DEVIATION-CODE NOT = '000'
 14247           MOVE '000'            TO CP-DEVIATION-CODE
 14248           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14249           IF NO-CP-ERROR
 14250              COMPUTE PB-I-DDF-IU-RATE-UP =
 14251              PB-I-AH-CLP - CP-CALC-PREMIUM
 14252           ELSE
 14253              MOVE ER-3057        TO WS-ERROR
 14254              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14255           END-IF
 14256        END-IF
 14257     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 259
* EL050.cbl
 14258     .
 14259 3335-EDIT-AH-REIN-NSP-RATE.
 14260     IF AH-REIN-NSP-NOT-USED
 14261         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14262
 14263     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14264     IF PB-COMPANY-ID = 'DCC'
 14265         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14266     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14267     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14268     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14269     MOVE PB-SV-STATE            TO CP-STATE.
 14270     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14271     MOVE ZERO                   TO CP-DEVIATION-CODE
 14272                                    CP-RATE-DEV-PCT.
 14273*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14274     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14275     MOVE '3'                    TO CP-PROCESS-TYPE.
 14276     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14277     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14278                                    CP-RATING-BENEFIT-AMT.
 14279     IF CP-STATE-STD-ABBRV = 'OR'
 14280         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14281                                         PB-I-AH-TERM.
 14282     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14283     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14284     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14285     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14286     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14287     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14288                                    CP-REMAINING-TERM
 14289                                    WS-WORK-TERM.
 14290     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14291     IF PB-COMPANY-ID = 'DCC'
 14292        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14293     END-IF
 14294     IF  PB-COMPANY-ID = 'TIC'
 14295         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14296            MOVE ZERO TO CP-CLASS-CODE.
 14297
 14298     IF PB-COMPANY-ID NOT = 'TIC'
 14299          MOVE ZERO          TO CP-CLASS-CODE.
 14300
 14301     MOVE ZERO               TO CP-DEVIATION-CODE.
 14302
 14303     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14304
 14305     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14306
 14307     MOVE 'R'                   TO CP-RATE-FILE.
 14308     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14309
 14310     IF CP-ERROR-RATE-NOT-FOUND
 14311         MOVE ER-2645        TO WS-ERROR
 14312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14313         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14314
 14315     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 260
* EL050.cbl
 14316
 14317     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14318     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14319
 14320     IF PB-I-AH-REI-RATE = ZERO
 14321         MOVE ER-2645        TO WS-ERROR
 14322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14323
 14324
 14325 3340-CALCULATE-PREMIUM-AMT.
 14326
 14327     IF PB-COMPANY-ID = 'NCL'
 14328         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14329             WS-AH-SPECIAL-CALC-CD = 'O')
 14330             GO TO 3999-END-EDIT.
 14331
 14332     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14333                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14334                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14335                         OR 'AHL'
 14336         NEXT SENTENCE
 14337     ELSE
 14338         IF WS-STATE-ABBREVIATION = 'CT'
 14339             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14340                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14341                 COMPUTE PB-I-LF-PREM-CALC =
 14342                                     PB-I-LF-PREM-CALC * .90
 14343                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14344                                     PB-I-LF-ALT-PREM-CALC * .90
 14345                 COMPUTE PB-I-AH-PREM-CALC =
 14346                                     PB-I-AH-PREM-CALC * .90.
 14347
 14348     IF PB-COMP-LF-PREM
 14349        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14350        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14351
 14352     IF PB-COMP-AH-PREM
 14353        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14354
 14355 3340-CHECK-DCC-TOT-FEES.
 14356     IF (PB-COMPANY-ID = 'DCC')
 14357        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14358        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14359        AND (PB-I-POLICY-IS-MONTHLY)
 14360        CONTINUE
 14361     ELSE
 14362        GO TO 3340-EDIT-LF-AH-TOL
 14363     END-IF
 14364     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14365     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14366     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14367        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14368           PB-I-RATE-DEV-PCT-LF
 14369     END-IF
 14370     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14371        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14372           PB-I-RATE-DEV-PCT-AH
 14373     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 261
* EL050.cbl
 14374     MOVE 'N'                    TO CP-BEN-CATEGORY
 14375     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14376
 14377     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14378     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14379     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14380     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14381     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14382     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14383     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14384     MOVE '3'                    TO CP-PROCESS-TYPE.
 14385     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14386     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14387
 14388     MOVE PB-SV-STATE            TO CP-STATE.
 14389     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14390     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14391     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14392     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14393     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14394                                    CP-RATING-BENEFIT-AMT.
 14395     IF CP-STATE-STD-ABBRV = 'OR'
 14396         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14397                                         PB-I-LF-ALT-BENEFIT-AMT.
 14398     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14399     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14400     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14401     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14402     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14403     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14404     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14405     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14406     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14407                                    CP-REMAINING-TERM
 14408                                    CP-LOAN-TERM.
 14409     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14410         NEXT SENTENCE
 14411     ELSE
 14412         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14413             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14414                                           PB-I-LF-PREMIUM-AMT.
 14415
 14416     IF CP-TRUNCATED-LIFE
 14417        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14418
 14419     IF CP-TERM-IS-DAYS
 14420         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14421     ELSE
 14422         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14423
 14424     IF PB-COMPANY-ID = 'DCC'
 14425        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14426     END-IF
 14427     IF CP-SPECIAL-CALC-CD = 'H'
 14428         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14429                                    TO CP-ALTERNATE-BENEFIT
 14430         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14431     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 262
* EL050.cbl
 14432     MOVE 'R'                    TO CP-RATE-FILE
 14433     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14434     IF NOT CP-ERROR-RATE-NOT-FOUND
 14435        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14436        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14437           AND (CP-BENEFIT-CD (1:1) = 'S')
 14438           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14439                                    PB-I-LF-PREMIUM-AMT
 14440        END-IF
 14441     ELSE
 14442        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14443     END-IF
 14444     .
 14445 3340-EDIT-LF-AH-TOL.
 14446
 14447***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14448***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14449***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14450***
 14451     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14452         PB-I-AH-PREMIUM-AMT
 14453          GIVING WS-CALC-WORK.
 14454
 14455     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14456        AND WS-CALC-WORK NOT = ZERO
 14457         MOVE ER-2649            TO WS-ERROR
 14458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14459
 14460     SUBTRACT PB-I-LF-PREM-CALC
 14461             FROM PB-I-LF-PREMIUM-AMT
 14462                 GIVING WS-UNSIGN-WRK1.
 14463
 14464     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14465             FROM PB-I-LF-ALT-PREMIUM-AMT
 14466                 GIVING WS-UNSIGN-WRK4.
 14467
 14468     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14469                                + WS-UNSIGN-WRK4.
 14470
 14471     SUBTRACT PB-I-AH-PREM-CALC
 14472             FROM PB-I-AH-PREMIUM-AMT
 14473                 GIVING WS-UNSIGN-WRK2.
 14474
 14475******************************************************************
 14476*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14477******************************************************************
 14478
 14479     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14480         MOVE ZERO TO WS-UNSIGN-WRK1.
 14481
 14482     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14483         MOVE ZERO TO WS-UNSIGN-WRK2.
 14484
 14485     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14486             GIVING WS-UNSIGN-WRK3.
 14487
 14488 3342-CONTINUE.
 14489
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 263
* EL050.cbl
 14490     IF (PB-I-LF-RATE = ZERO  AND
 14491         PB-I-AH-RATE = ZERO)
 14492         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14493            WS-AH-SPECIAL-CALC-CD = 'O'
 14494              NEXT SENTENCE
 14495         ELSE
 14496             GO TO 3345-EDIT-CONTINUE.
 14497
 14498     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14499         NEXT SENTENCE
 14500     ELSE
 14501     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14502        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14503           IF (PB-REISSUED-CERT         OR
 14504               PB-POLICY-IS-DECLINED    OR
 14505               PB-POLICY-IS-VOIDED)
 14506              NEXT SENTENCE
 14507           ELSE
 14508              IF WS-PREM-REJECT-SW = SPACE
 14509                 MOVE ER-2652    TO WS-ERROR
 14510                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14511                 GO TO 3344-CHECK-AH
 14512              ELSE
 14513                 MOVE ER-2650    TO WS-ERROR
 14514                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14515                 GO TO 3344-CHECK-AH.
 14516
 14517***
 14518***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14519***
 14520
 14521     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14522         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14523            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14524             (1 + WS-TOL-LF-PREM-PCT)
 14525         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14526            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14527             (1 - WS-TOL-LF-PREM-PCT)
 14528     ELSE
 14529         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14530         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14531
 14532***
 14533***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14534***
 14535
 14536     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14537         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14538          WS-TOL-LF-PREM.
 14539
 14540     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14541         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14542          WS-TOL-LF-PREM.
 14543
 14544     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14545        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14546
 14547     IF PB-REISSUED-CERT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 264
* EL050.cbl
 14548        or PB-POLICY-IS-DECLINED
 14549        or PB-POLICY-IS-VOIDED
 14550        continue
 14551     ELSE
 14552        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14553              > WS-TOL-LF-HIGH-PREM-AMT)
 14554           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14555              < WS-TOL-LF-LOW-PREM-AMT))
 14556                      or
 14557           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14558              > WS-TOL-LF-HIGH-PREM-PCT)
 14559           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14560              < WS-TOL-LF-LOW-PREM-PCT))
 14561           IF WS-PREM-REJECT-SW = SPACE
 14562              MOVE ER-2652       TO WS-ERROR
 14563              PERFORM 9900-ERROR-FORMAT
 14564                                 THRU 9900-EXIT
 14565           ELSE
 14566              MOVE ER-2650       TO WS-ERROR
 14567              PERFORM 9900-ERROR-FORMAT
 14568                                 THRU 9900-EXIT
 14569           end-if
 14570        end-if
 14571     end-if
 14572
 14573*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14574*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14575*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14576*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14577
 14578     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14579        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14580                      OR
 14581           ((PB-COMPANY-ID = 'DCC')
 14582           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14583           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14584           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14585        END-IF
 14586     END-IF
 14587
 14588     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14589        IF WS-COMP-MAX-CAP GREATER THAN +0
 14590           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14591              IF (PB-REISSUED-CERT         OR
 14592                  PB-POLICY-IS-DECLINED    OR
 14593                  PB-POLICY-IS-VOIDED)
 14594                 NEXT SENTENCE
 14595              ELSE
 14596                  MOVE ER-2646   TO  WS-ERROR
 14597                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14598
 14599 3344-CVL-TOLERANCE-CHECK.
 14600
 14601      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14602          GO TO 3344-CHECK-AH.
 14603
 14604      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14605          GO TO 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 265
* EL050.cbl
 14606
 14607      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14608                                     WS-UNSIGN-WRK6.
 14609
 14610      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14611          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14612                                 + PB-I-LF-PREMIUM-AMT
 14613                                 - PB-I-LF-PREM-CALC.
 14614
 14615      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14616          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14617                                 + PB-I-LF-ALT-PREMIUM-AMT
 14618                                 - PB-I-LF-ALT-PREM-CALC.
 14619
 14620      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14621          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14622              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14623                 MOVE ER-2652    TO  WS-ERROR
 14624                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14625              ELSE
 14626                 MOVE ER-2650    TO  WS-ERROR
 14627                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14628
 14629      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14630          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14631              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14632                 MOVE ER-2652    TO  WS-ERROR
 14633                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14634              ELSE
 14635                 MOVE ER-2650    TO  WS-ERROR
 14636                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14637
 14638 3344-CHECK-AH.
 14639
 14640****************************************************************
 14641***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14642***
 14643
 14644     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14645         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14646             (1 + WS-TOL-AH-PREM-PCT)
 14647         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14648             (1 - WS-TOL-AH-PREM-PCT)
 14649     ELSE
 14650         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14651         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14652
 14653***
 14654***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14655***
 14656
 14657     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14658         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14659
 14660     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14661         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14662
 14663     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 266
* EL050.cbl
 14664        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14665
 14666     IF (PB-REISSUED-CERT)
 14667        OR (PB-POLICY-IS-DECLINED)
 14668        OR (PB-POLICY-IS-VOIDED)
 14669        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14670        CONTINUE
 14671     ELSE
 14672        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14673              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14674                          or
 14675           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14676              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14677           IF WS-PREM-REJECT-SW = SPACE
 14678              MOVE ER-3052       TO WS-ERROR
 14679              PERFORM 9900-ERROR-FORMAT
 14680                                 THRU 9900-EXIT
 14681           ELSE
 14682              MOVE ER-3050       TO WS-ERROR
 14683              PERFORM 9900-ERROR-FORMAT
 14684                                 THRU 9900-EXIT
 14685           END-IF
 14686        END-IF
 14687     END-IF
 14688     if (pb-company-id = 'DCC')
 14689        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14690        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14691        and (pb-i-policy-is-monthly)
 14692        compute ws-tol-ah-high-prem-amt =
 14693           pb-i-tot-fees-calc + ws-tol-ah-prem
 14694        compute ws-tol-ah-low-prem-amt =
 14695           pb-i-tot-fees-calc - ws-tol-ah-prem
 14696        if ws-tol-ah-prem-pct > zeros
 14697           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14698              (1 + ws-tol-ah-prem-pct)
 14699           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14700              (1 - ws-tol-ah-prem-pct)
 14701        else
 14702           move +0               to ws-tol-ah-high-prem-pct
 14703           move +9999999.99      to ws-tol-ah-low-prem-pct
 14704        end-if
 14705        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14706            or
 14707           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14708                          or
 14709           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14710           or
 14711           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14712            move er-3049         to ws-error
 14713           perform 9900-error-format
 14714                                 thru 9900-exit
 14715
 14716        end-if
 14717     end-if
 14718     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14719         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14720             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14721             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 267
* EL050.cbl
 14722
 14723     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14724        IF WS-COMP-MAX-CAP GREATER THAN +0
 14725           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14726              IF (PB-REISSUED-CERT         OR
 14727                  PB-POLICY-IS-DECLINED    OR
 14728                  PB-POLICY-IS-VOIDED)
 14729                 NEXT SENTENCE
 14730              ELSE
 14731                  MOVE ER-2646   TO  WS-ERROR
 14732                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14733
 14734     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14735        (WS-COMP-MAX-CAP EQUAL +0)
 14736           GO TO 3345-EDIT-CONTINUE.
 14737
 14738     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14739        GREATER THAN WS-COMP-MAX-CAP
 14740           MOVE ER-2646          TO  WS-ERROR
 14741           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14742
 14743 3345-EDIT-CONTINUE.
 14744
 14745*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14746*       IF PB-ENTRY-BATCH   NUMERIC
 14747*          IF PB-ISSUE
 14748*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14749*          ELSE
 14750*              IF PB-CANCELLATION
 14751*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14752
 14753*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14754*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14755*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14756*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14757*        ELSE
 14758*            MOVE  ER-1909            TO  WS-ERROR
 14759*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14760
 14761     IF PB-I-POLICY-ACCEPTED
 14762        IF PB-POLICY-IS-DECLINED  OR
 14763           PB-REISSUED-CERT  OR
 14764           PB-REIN-ONLY-CERT  OR
 14765           PB-POLICY-IS-VOIDED
 14766            MOVE  ER-1891         TO  WS-ERROR
 14767            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14768        ELSE
 14769            MOVE SPACE            TO  PB-BATCH-ENTRY
 14770            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14771
 14772     IF PB-I-POLICY-DECLINED
 14773        IF PB-REISSUED-CERT  OR
 14774           PB-REIN-ONLY-CERT  OR
 14775           PB-POLICY-IS-VOIDED
 14776            MOVE  ER-1906         TO  WS-ERROR
 14777            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14778        ELSE
 14779            MOVE  'D'             TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 268
* EL050.cbl
 14780                                      PB-I-ENTRY-STATUS.
 14781
 14782     IF PB-I-NEEDS-UNDERWRITING
 14783        IF PB-POLICY-IS-DECLINED OR
 14784           PB-REISSUED-CERT  OR
 14785           PB-REIN-ONLY-CERT  OR
 14786           PB-POLICY-IS-VOIDED
 14787            MOVE  ER-1907         TO  WS-ERROR
 14788            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14789        ELSE
 14790            MOVE 'U'              TO  PB-BATCH-ENTRY
 14791                                      PB-I-ENTRY-STATUS.
 14792
 14793     IF PB-NEEDS-UNDERWRITING
 14794        MOVE  ER-1901             TO  WS-ERROR
 14795        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14796     IF PB-COMPANY-ID = 'DCC'
 14797        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14798        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14799        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14800           AND (NOT WS-LF-CASH))
 14801                           OR
 14802           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14803           AND (NOT WS-AH-CASH)))
 14804                       AND
 14805           (PB-I-ENTRY-STATUS NOT = '5')
 14806           MOVE 'M'              TO PB-BATCH-ENTRY
 14807                                    PB-I-ENTRY-STATUS
 14808        END-IF
 14809     END-IF
 14810     IF  PB-COMPANY-ID NOT = 'NCL'
 14811         GO TO 3999-END-EDIT.
 14812
 14813     IF PB-REISSUED-CERT  OR
 14814        PB-POLICY-IS-DECLINED  OR
 14815        PB-POLICY-IS-VOIDED  OR
 14816        PB-I-OB
 14817         GO TO 3999-END-EDIT.
 14818
 14819     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14820         MOVE  ER-2644            TO  WS-ERROR
 14821         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14822         GO TO 3999-END-EDIT.
 14823
 14824     MOVE 'N'                     TO  FORM-MASTER-SW.
 14825     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14826
 14827     IF NOT FORM-MASTER-FOUND
 14828         GO TO 3999-END-EDIT.
 14829
 14830     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14831                                      FORM-MASTER-AH-SW.
 14832
 14833     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14834         MOVE  +1                 TO SUB6
 14835         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14836
 14837     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 269
* EL050.cbl
 14838         MOVE  +1                 TO SUB6
 14839         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14840
 14841     IF LF-FORM-MASTER-FOUND  OR
 14842        AH-FORM-MASTER-FOUND
 14843         GO TO 3360-CHECK-FORM-LIMITS
 14844     ELSE
 14845         GO TO 3999-END-EDIT.
 14846
 14847******************************************************************
 14848*                  3350-GET-ERFORM                               *
 14849*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14850*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14851******************************************************************
 14852
 14853 3350-GET-ERFORM.
 14854
 14855     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14856         GO TO  3350-ERFORM-GETMAIN.
 14857
 14858     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14859     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14860     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14861     MOVE 'Y'                     TO FORM-MASTER-SW.
 14862
 14863     IF PB-CANCELLATION
 14864         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14865            PB-SV-STATE          EQUAL   FO-STATE       AND
 14866            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14867              GO TO 3350-EXIT
 14868         ELSE
 14869             NEXT SENTENCE
 14870     ELSE
 14871         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14872            PB-SV-STATE          EQUAL   FO-STATE       AND
 14873            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14874              GO TO 3350-EXIT.
 14875
 14876 3350-ERFORM-GETMAIN.
 14877
 14878     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14879     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14880
 14881 3350-ERFORM-READ.
 14882
 14883     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14884     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14885     IF PB-CANCELLATION
 14886         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14887     ELSE
 14888         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14889     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14890
 14891     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14892
 14893     IF FORM-MASTER-FOUND
 14894       IF PB-CANCELLATION
 14895          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 270
* EL050.cbl
 14896             PB-SV-STATE          EQUAL   FO-STATE       AND
 14897             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14898              GO  TO 3350-EXIT
 14899          ELSE
 14900              NEXT SENTENCE
 14901       ELSE
 14902          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14903             PB-SV-STATE          EQUAL   FO-STATE       AND
 14904             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14905              GO  TO 3350-EXIT.
 14906
 14907     MOVE  'N'                    TO  FORM-MASTER-SW.
 14908     MOVE  ER-1895                TO  WS-ERROR.
 14909     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14910
 14911 3350-EXIT.
 14912      EXIT.
 14913
 14914******************************************************************
 14915*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14916*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14917*   VALID FOR THE POLICY FORM USED.                              *
 14918******************************************************************
 14919
 14920 3355-EDIT-FORM-LF-BENEFITS.
 14921
 14922     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14923        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14924         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14925         GO TO   3355-EXIT.
 14926
 14927     IF  SUB6    LESS THAN   +40
 14928         ADD  +1      TO  SUB6
 14929         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14930
 14931     MOVE  ER-1896         TO  WS-ERROR.
 14932     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14933
 14934 3355-EXIT.
 14935      EXIT.
 14936
 14937******************************************************************
 14938*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14939*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14940*   VALID FOR THE POLICY FORM USED.                              *
 14941******************************************************************
 14942
 14943 3356-EDIT-FORM-AH-BENEFITS.
 14944
 14945     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14946        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14947         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14948         GO TO  3356-EXIT.
 14949
 14950      IF  SUB6    LESS THAN     +40
 14951          ADD  +1      TO  SUB6
 14952          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14953
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 271
* EL050.cbl
 14954     MOVE  ER-1897         TO  WS-ERROR.
 14955     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14956
 14957 3356-EXIT.
 14958      EXIT.
 14959
 14960******************************************************************
 14961*                  3357-BENEFIT-SEARCH                           *
 14962*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14963*   CANCELLATIONS ONLY.                                          *
 14964******************************************************************
 14965 3357-BENEFIT-SEARCH.
 14966     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14967         MOVE +1                          TO SUB6
 14968         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14969
 14970     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14971         MOVE +1                          TO SUB6
 14972         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14973
 14974 3357-EXIT.
 14975     EXIT.
 14976
 14977******************************************************************
 14978*                  3358-BENEFIT-LIFE-SEARCH                      *
 14979*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14980*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14981*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14982******************************************************************
 14983 3358-BENEFIT-LIFE-SEARCH.
 14984     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14985       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14986         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14987           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14988              IF FO-PLAN-REFUND-METHOD (SUB6)
 14989                     IS GREATER THAN SPACES
 14990                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14991                                          WS-LF-REFUND-CALC
 14992                 GO TO 3358-EXIT.
 14993
 14994     IF SUB6 LESS THAN +40
 14995         ADD +1                 TO SUB6
 14996         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14997
 14998 3358-EXIT.
 14999     EXIT.
 15000******************************************************************
 15001*                  3359-BENEFIT-AH-SEARCH                        *
 15002*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15003*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15004*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15005******************************************************************
 15006 3359-BENEFIT-AH-SEARCH.
 15007     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15008       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15009         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15010           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15011              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 272
* EL050.cbl
 15012                      IS GREATER THAN SPACES
 15013                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15014                                          WS-AH-REFUND-CALC
 15015                 GO TO 3359-EXIT.
 15016
 15017     IF SUB6 LESS THAN +40
 15018         ADD +1                 TO SUB6
 15019         GO TO 3359-BENEFIT-AH-SEARCH.
 15020
 15021 3359-EXIT.
 15022     EXIT.
 15023
 15024******************************************************************
 15025*                  3360-CHECK-FORM-LIMITS                        *
 15026*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15027*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15028******************************************************************
 15029
 15030 3360-CHECK-FORM-LIMITS.
 15031
 15032     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15033         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15034
 15035     IF NOT LF-FORM-MASTER-FOUND
 15036         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15037
 15038 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15039
 15040     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15041       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15042        WS-LF-JOINT-INDICATOR = 'J'  AND
 15043        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15044         IF PB-COMPANY-ID = 'NCL'
 15045            MOVE  ER-1911          TO  WS-ERROR
 15046            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15047         ELSE
 15048            MOVE  ER-1892          TO  WS-ERROR
 15049            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15050
 15051 3360-CHECK-FORM-LF-ATT-AGE.
 15052
 15053     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15054
 15055     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15056         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15057         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15058            IF PB-COMPANY-ID = 'NCL'
 15059                MOVE  ER-1913      TO  WS-ERROR
 15060                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15061            ELSE
 15062                MOVE  ER-1894      TO  WS-ERROR
 15063                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15064
 15065 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15066
 15067     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15068         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15069         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 273
* EL050.cbl
 15070            IF PB-COMPANY-ID = 'NCL'
 15071                MOVE  ER-1914      TO  WS-ERROR
 15072                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15073            ELSE
 15074                MOVE  ER-1899      TO  WS-ERROR
 15075                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15076
 15077 3360-CHECK-FORM-LF-TERM-BAMT.
 15078
 15079     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15080         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15081         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15082           IF  PB-COMPANY-ID = 'NCL'
 15083               MOVE  ER-1916       TO  WS-ERROR
 15084               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15085           ELSE
 15086               MOVE  ER-1902       TO  WS-ERROR
 15087               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15088
 15089     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15090                                    PB-I-LF-ALT-BENEFIT-AMT.
 15091
 15092     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15093         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15094         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15095             IF  PB-COMPANY-ID = 'NCL'
 15096                 MOVE  ER-1918     TO  WS-ERROR
 15097                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15098             ELSE
 15099                 MOVE  ER-1904     TO  WS-ERROR
 15100                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15101
 15102******************************************************************
 15103*                  3360-CHECK-FORM-AH-LIMITS                     *
 15104*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15105*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15106******************************************************************
 15107
 15108 3360-CHECK-FORM-AH-LIMITS.
 15109
 15110     IF NOT AH-FORM-MASTER-FOUND
 15111         GO TO 3999-END-EDIT.
 15112
 15113 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15114
 15115     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15116       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15117        WS-AH-JOINT-INDICATOR = 'J'  AND
 15118        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15119         IF PB-COMPANY-ID = 'NCL'
 15120            MOVE  ER-1912          TO  WS-ERROR
 15121            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15122         ELSE
 15123            MOVE  ER-1893          TO  WS-ERROR
 15124            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15125
 15126 3360-CHECK-FORM-AH-ATT-AGE.
 15127
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 274
* EL050.cbl
 15128     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15129
 15130     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15131         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15132         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15133            IF PB-COMPANY-ID = 'NCL'
 15134                MOVE  ER-1913      TO  WS-ERROR
 15135                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15136            ELSE
 15137                MOVE  ER-1894      TO  WS-ERROR
 15138                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15139
 15140 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15141
 15142     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15143         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15144         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15145            IF PB-COMPANY-ID = 'NCL'
 15146                MOVE  ER-1915      TO  WS-ERROR
 15147                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15148            ELSE
 15149                MOVE  ER-1900      TO  WS-ERROR
 15150                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15151
 15152 3360-CHECK-FORM-AH-TERM-BAMT.
 15153
 15154     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15155         FO-AH-MAX-TERM    GREATER THAN  +0
 15156         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15157             IF  PB-COMPANY-ID = 'NCL'
 15158                 MOVE  ER-1917     TO  WS-ERROR
 15159                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15160             ELSE
 15161                  MOVE  ER-1903    TO  WS-ERROR
 15162                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15163
 15164     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15165         FO-MAX-AH-AMT    GREATER THAN  +0
 15166         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15167             IF  PB-COMPANY-ID = 'NCL'
 15168                 MOVE  ER-1919     TO  WS-ERROR
 15169                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15170             ELSE
 15171                 MOVE  ER-1905     TO  WS-ERROR
 15172                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15173
 15174     GO TO 3999-END-EDIT.
 15175
 15176******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 275
* EL050.cbl
 15178******************************************************************
 15179*                  E D I T   C A N C E L                         *
 15180******************************************************************
 15181
 15182 3700-EDIT-CANCEL.
 15183     IF PB-COMPANY-ID = 'DMD'
 15184         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15185                                         WS-RES-MUNI-TAX
 15186                                         PB-CI-STATE-TAX
 15187                                         PB-CI-MUNI-TAX
 15188         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15189
 15190*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15191*       IF PB-ENTRY-BATCH  NUMERIC
 15192*          IF PB-CANCELLATION
 15193*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15194*          ELSE
 15195*             IF PB-ISSUE
 15196*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15197
 15198     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15199        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15200     END-IF
 15201*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15202*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15203
 15204     IF CM-ENTRY-STATUS = 'V'
 15205        MOVE ER-2780             TO WS-ERROR
 15206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15207        GO TO 3999-END-EDIT.
 15208
 15209     IF CM-ENTRY-STATUS = 'D'
 15210        MOVE ER-2781             TO WS-ERROR
 15211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15212        GO TO 3999-END-EDIT.
 15213
 15214     IF CM-ENTRY-STATUS = 'U'
 15215        MOVE ER-2782             TO WS-ERROR
 15216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15217
 15218***************************************************************
 15219*                                                             *
 15220*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15221*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15222*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15223*   OF ANOTHER COVERAGE.                                      *
 15224*                                                             *
 15225***************************************************************
 15226
 15227     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15228                                    PB-C-AH-CANCEL-VOID-SW.
 15229
 15230     IF PB-C-LF-CANCEL-AMT = ZERO
 15231        NEXT SENTENCE
 15232     ELSE
 15233        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15234           AND
 15235           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 276
* EL050.cbl
 15236               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15237               MOVE ER-2745           TO WS-ERROR
 15238               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15239
 15240     IF PB-C-AH-CANCEL-AMT = ZERO
 15241        NEXT SENTENCE
 15242     ELSE
 15243        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15244           AND
 15245           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15246               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15247               MOVE ER-2745           TO WS-ERROR
 15248               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15249
 15250     IF WS-LF-EARNINGS-CALC = '4'
 15251        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15252
 15253     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15254     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15255     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15256     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15257     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15258     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15259
 15260     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15261                                      PB-C-AH-REF-CALC.
 15262     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15263
 15264******************************************************************
 15265*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15266*             TO VALIDATE COVERAGE.                              *
 15267******************************************************************
 15268
 15269     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15270        PB-C-LF-CANCEL-AMT = ZEROS
 15271          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15272      ELSE
 15273          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15274
 15275     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15276        PB-C-AH-CANCEL-AMT = ZEROS
 15277          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15278      ELSE
 15279          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15280
 15281     EVALUATE TRUE
 15282         WHEN PB-CANCEL-FORCE             OR
 15283              PB-CANCEL-DATE-FORCED       OR
 15284              PB-FORCE-OFF
 15285                  IF PB-COMPANY-ID = 'ACE'
 15286                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15287                  END-IF
 15288         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15289               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15290              (PB-COMPANY-ID = 'ACE' )
 15291                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15292         WHEN OTHER
 15293              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 277
* EL050.cbl
 15294                 MOVE ER-2794              TO WS-ERROR
 15295              ELSE
 15296                 MOVE ER-2749              TO WS-ERROR
 15297              END-IF
 15298              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15299     END-EVALUATE.
 15300
 15301
 15302*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15303*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15304*            MOVE  ER-1909            TO  WS-ERROR
 15305*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15306*        ELSE
 15307*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15308
 15309     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15310     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15311        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15312     ELSE
 15313        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15314     END-IF
 15315     .
 15316 3705-EDIT-CANCEL-DT.
 15317
 15318     IF LF-COVERAGE-CANCELLED
 15319        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15320         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15321         MOVE WS-CURRENT-MONTH-END
 15322                                 TO DC-BIN-DATE-2
 15323         SET ELAPSED-BETWEEN-BIN TO TRUE
 15324*        MOVE 1                  TO DC-OPTION-CODE
 15325         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15326         IF DATE-CONVERSION-ERROR
 15327            NEXT SENTENCE
 15328          ELSE
 15329             IF DC-ELAPSED-DAYS GREATER +180
 15330                IF PB-CANCEL-DATE-FORCED  OR
 15331                   PB-CANCEL-DATE-FORCED-NO-FEE
 15332                      MOVE ER-2751  TO WS-ERROR
 15333                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15334                 ELSE
 15335                   MOVE ER-2752  TO WS-ERROR
 15336                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15337
 15338     IF AH-COVERAGE-CANCELLED
 15339        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15340         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15341         MOVE WS-CURRENT-MONTH-END
 15342                                 TO DC-BIN-DATE-2
 15343         SET ELAPSED-BETWEEN-BIN TO TRUE
 15344*        MOVE 1                  TO DC-OPTION-CODE
 15345         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15346         IF DATE-CONVERSION-ERROR
 15347            NEXT SENTENCE
 15348          ELSE
 15349             IF DC-ELAPSED-DAYS GREATER +180
 15350                IF PB-CANCEL-DATE-FORCED OR
 15351                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 278
* EL050.cbl
 15352                      MOVE ER-2751  TO WS-ERROR
 15353                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15354                 ELSE
 15355                   MOVE ER-2752  TO WS-ERROR
 15356                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15357
 15358     IF WS-ERROR = ER-2752
 15359        AND (PB-COMPANY-ID = 'ABL'
 15360         OR  PB-COMPANY-ID = 'FGL'
 15361         OR  PB-COMPANY-ID = 'IST'
 15362         OR  PB-COMPANY-ID = 'JHL'
 15363         OR  PB-COMPANY-ID = 'LAP'
 15364         OR  PB-COMPANY-ID = 'LBL'
 15365         OR  PB-COMPANY-ID = 'NCB'
 15366         OR  PB-COMPANY-ID = 'NLI'
 15367         OR  PB-COMPANY-ID = 'OFI'
 15368         OR  PB-COMPANY-ID = 'PLI'
 15369         OR  PB-COMPANY-ID = 'TAO'
 15370         OR  PB-COMPANY-ID = 'TIC'
 15371         OR  PB-COMPANY-ID = 'HER'
 15372         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15373         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15374            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15375            MOVE ER-2762     TO WS-ERROR
 15376            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15377
 15378     IF LF-COVERAGE-CANCELLED
 15379        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15380        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15381             MOVE ER-2733         TO WS-ERROR
 15382             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15383
 15384     IF AH-COVERAGE-CANCELLED
 15385        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15386        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15387              MOVE ER-2733        TO WS-ERROR
 15388              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15389
 15390     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15391        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15392        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15393           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15394            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15395              IF PB-COMPANY-ID NOT = 'LAP'
 15396               MOVE ER-2704            TO WS-ERROR
 15397               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15398
 15399     IF CERT-WAS-NOT-FOUND
 15400         GO TO 3999-END-EDIT.
 15401
 15402     IF PB-COMPANY-ID EQUAL 'CDC'
 15403        IF LF-COVERAGE-CANCELLED
 15404           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15405            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15406            MOVE PB-C-LF-CANCEL-DT
 15407                                 TO DC-BIN-DATE-2
 15408            SET ELAPSED-BETWEEN-BIN TO TRUE
 15409*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 279
* EL050.cbl
 15410            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15411            IF DATE-CONVERSION-ERROR
 15412               NEXT SENTENCE
 15413             ELSE
 15414                IF DC-ELAPSED-DAYS GREATER +60
 15415                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15416
 15417     IF PB-COMPANY-ID EQUAL 'CDC'
 15418        IF AH-COVERAGE-CANCELLED
 15419           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15420            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15421            MOVE PB-C-AH-CANCEL-DT
 15422                                 TO DC-BIN-DATE-2
 15423            MOVE +0              TO DC-ELAPSED-DAYS
 15424                                    DC-ELAPSED-MONTHS
 15425            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15426*           MOVE 1               TO DC-OPTION-CODE
 15427            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15428            IF DATE-CONVERSION-ERROR
 15429               NEXT SENTENCE
 15430             ELSE
 15431                IF DC-ELAPSED-DAYS GREATER +60
 15432                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15433
 15434     MOVE +0                     TO DC-ELAPSED-DAYS
 15435                                    DC-ELAPSED-MONTHS.
 15436
 15437     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15438        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15439          MOVE 'Z'                TO PB-CI-OB-FLAG
 15440          MOVE ER-2767            TO WS-ERROR
 15441          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15442          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15443          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15444          GO TO 3775-OVER-REF-CHK
 15445        ELSE
 15446          MOVE ZEROS              TO PB-CI-LIVES
 15447                                     PB-C-LIVES
 15448          IF PB-CI-OB-FLAG NOT = 'B'
 15449             MOVE SPACE           TO PB-CI-OB-FLAG.
 15450
 15451     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15452         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15453     ELSE
 15454         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15455
 15456     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15457        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15458            MOVE ER-2760         TO WS-ERROR
 15459            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15460
 15461     IF LF-COVERAGE-CANCELLED
 15462        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15463         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15464            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15465               MOVE ER-2774       TO WS-ERROR
 15466               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15467
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 280
* EL050.cbl
 15468     IF AH-COVERAGE-CANCELLED
 15469        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15470         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15471            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15472               MOVE ER-2775       TO WS-ERROR
 15473               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15474
 15475     IF LF-COVERAGE-CANCELLED
 15476        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15477         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15478            MOVE ER-2776         TO WS-ERROR
 15479            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15480
 15481     IF AH-COVERAGE-CANCELLED
 15482        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15483         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15484            MOVE ER-2777         TO WS-ERROR
 15485            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15486
 15487     IF LF-COVERAGE-CANCELLED
 15488        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15489         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15490         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15491         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15492*        MOVE 6                    TO DC-OPTION-CODE
 15493         SET BIN-PLUS-ELAPSED      TO TRUE
 15494         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15495         IF DATE-CONVERSION-ERROR
 15496            NEXT SENTENCE
 15497          ELSE
 15498            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15499              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15500                             OR  'FIA'
 15501                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15502               ELSE
 15503                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15504                MOVE ER-2731       TO WS-ERROR
 15505                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15506
 15507 3705-EDIT-AH-CANCEL-DT.
 15508
 15509     IF AH-COVERAGE-CANCELLED
 15510        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15511         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15512         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15513         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15514*        MOVE 6                    TO DC-OPTION-CODE
 15515         SET BIN-PLUS-ELAPSED      TO TRUE
 15516         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15517         IF DATE-CONVERSION-ERROR
 15518            NEXT SENTENCE
 15519          ELSE
 15520            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15521              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15522                              OR 'FIA'
 15523                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15524              ELSE
 15525               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 281
* EL050.cbl
 15526               MOVE ER-2771       TO WS-ERROR
 15527               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15528
 15529 3705-EDIT-CONTINUED.
 15530
 15531*    IF LF-COVERAGE-CANCELLED
 15532*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15533*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15534*            MOVE ER-2727         TO WS-ERROR
 15535*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15536*
 15537*    IF AH-COVERAGE-CANCELLED
 15538*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15539*        IF PB-COMPANY-ID = 'ACE'
 15540*           MOVE ER-2727        TO WS-ERROR
 15541*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15542*        ELSE
 15543*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15544*              MOVE ER-2727     TO WS-ERROR
 15545*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15546
 15547     IF PB-COMPANY-ID = 'ACE'
 15548       IF AH-COVERAGE-CANCELLED
 15549         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15550           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15551              MOVE ER-2732      TO WS-ERROR
 15552              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15553
 15554     IF PB-COMPANY-ID      EQUAL   'HER'
 15555        IF WS-ERROR        EQUAL   ER-2727
 15556            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15557            MOVE  ER-2725          TO  WS-ERROR
 15558            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15559
 15560     IF PB-C-CLAIM-CREATED-CANCEL
 15561            MOVE ER-2748         TO WS-ERROR
 15562            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15563
 15564     IF PB-C-LAST-NAME NOT = SPACES
 15565         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15566            MOVE ER-2747         TO WS-ERROR
 15567            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15568
 15569 3710-EDIT-LUMP-SUM-PRIOR.
 15570
 15571     IF AH-COVERAGE-CANCELLED
 15572         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15573             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15574                MOVE ER-2735    TO WS-ERROR
 15575                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15576
 15577     IF LF-COVERAGE-CANCELLED
 15578         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15579             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15580                MOVE ER-2735    TO WS-ERROR
 15581                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15582
 15583 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 282
* EL050.cbl
 15584
 15585*    IF LF-COVERAGE-CANCELLED
 15586*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15587*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15588*           (NOT PB-CI-OB)
 15589*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15590*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15591*                   MOVE ER-2732  TO WS-ERROR
 15592*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15593*
 15594*    IF AH-COVERAGE-CANCELLED
 15595*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15596*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15597*           (NOT PB-CI-OB)
 15598*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15599*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15600*                   MOVE ER-2732  TO WS-ERROR
 15601*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15602
 15603     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15604         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15605            (NOT PB-COMP-LF-CANCEL)
 15606             NEXT SENTENCE
 15607         ELSE
 15608           IF PB-C-LF-CANCEL-VOIDED
 15609              NEXT SENTENCE
 15610           ELSE
 15611              MOVE ER-2753      TO WS-ERROR
 15612              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15613
 15614     IF CANCEL-FUTURE-DT
 15615         GO TO 3999-END-EDIT.
 15616
 15617 3715-GET-REMAIN-TERM-LF.
 15618
 15619     IF NO-LF-BENEFIT-MATCH  OR
 15620        WS-LF-BENEFIT-CD = ZEROS
 15621        GO TO 3730-GET-AH-REMAIN-TERM.
 15622
 15623     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15624     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15625     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15626     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15627     MOVE PB-SV-STATE            TO CP-STATE.
 15628     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15629     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15630     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15631     MOVE '2'                    TO CP-PROCESS-TYPE.
 15632     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15633     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15634     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15635     IF (PB-COMPANY-ID = 'CID')
 15636        AND (CP-STATE-STD-ABBRV = 'WI')
 15637        MOVE '7'                 TO CP-REM-TERM-METHOD
 15638        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15639     ELSE
 15640        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15641        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 283
* EL050.cbl
 15642                                 TO CP-REM-TRM-CALC-OPTION
 15643     END-IF
 15644**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15645     IF (PB-COMPANY-ID = 'CID')
 15646        AND (CP-STATE-STD-ABBRV = 'MO')
 15647        AND (PB-CERT-EFF-DT >= X'9B41')
 15648        AND (PB-CERT-EFF-DT <= X'A2FB')
 15649        MOVE '7'                 TO CP-REM-TERM-METHOD
 15650        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15651     END-IF
 15652     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15653                                    CP-LOAN-TERM.
 15654     IF CP-TRUNCATED-LIFE
 15655        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15656
 15657     IF CP-TERM-IS-DAYS
 15658         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15659     ELSE
 15660         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15661
 15662     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15663
 15664     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15665
 15666     IF LF-COVERAGE-CANCELLED
 15667        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15668        NEXT SENTENCE
 15669      ELSE
 15670          GO TO 3730-GET-AH-REMAIN-TERM.
 15671
 15672 3720-GET-LF-REFUND.
 15673
 15674     IF PB-C-LF-CANCEL-VOIDED OR
 15675        PB-C-AH-CANCEL-VOIDED
 15676        GO TO 3780-UPDATE-CANCEL-CERT.
 15677
 15678     IF PB-COMPANY-ID EQUAL 'BOA'
 15679         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15680         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15681         GO TO 3730-GET-AH-REMAIN-TERM.
 15682
 15683     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15684        (WS-AH-SPECIAL-CALC-CD = 'M')
 15685         MOVE ER-2767            TO WS-ERROR
 15686         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15687         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15688         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15689         GO TO 3780-UPDATE-CANCEL-CERT.
 15690
 15691     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15692
 15693     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15694     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15695     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15696     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15697     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15698     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15699     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 284
* EL050.cbl
 15700        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15701        IF PDEF-MASTER-FOUND
 15702           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15703              (V1 > +8)
 15704              OR (PD-PROD-CODE (V1) = 'L')
 15705           END-PERFORM
 15706           IF V1 < +9
 15707              MOVE PD-MAX-AMT (V1)
 15708                           TO CP-R-MAX-TOT-BEN
 15709                              EC-AM-LF-MAX-TOT-BEN
 15710           END-IF
 15711        ELSE
 15712        MOVE ' '                 TO PDEF-MASTER-SW
 15713        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15714        MOVE PB-STATE            TO ERPDEF-STATE
 15715        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15716        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15717        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15718        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15719        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15720        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15721        IF PDEF-MASTER-FOUND
 15722           MOVE 'N'              TO PDEF-MASTER-SW
 15723           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15724           IF PDEF-MASTER-FOUND
 15725              IF (ERPDEF-KEY-SAVE (1:16) =
 15726                           PD-CONTROL-PRIMARY (1:16))
 15727                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15728                 CONTINUE
 15729              ELSE
 15730                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15731                 IF (ERPDEF-KEY-SAVE (1:16) =
 15732                           PD-CONTROL-PRIMARY (1:16))
 15733                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15734                    CONTINUE
 15735                 ELSE
 15736                    MOVE 'N'     TO PDEF-MASTER-SW
 15737                 END-IF
 15738              END-IF
 15739              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15740
 15741              IF PDEF-MASTER-FOUND
 15742                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15743                    (V1 > +8)
 15744                    OR (PD-PROD-CODE (V1) = 'L')
 15745                 END-PERFORM
 15746                 IF V1 < +9
 15747                    MOVE PD-MAX-AMT (V1)
 15748                                 TO CP-R-MAX-TOT-BEN
 15749                                    EC-AM-LF-MAX-TOT-BEN
 15750                 END-IF
 15751              END-IF
 15752           END-IF
 15753           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15754        END-IF
 15755        END-IF
 15756     END-IF
 15757     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 285
* EL050.cbl
 15758
 15759     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15760
 15761     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15762                                    PB-C-LF-REM-TERM.
 15763
 15764     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15765     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15766
 15767     IF PB-COMPANY-ID EQUAL 'FLC'
 15768        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15769           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15770           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15771                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15772                    - CM-LF-ITD-DEATH-AMT
 15773           IF PB-C-LF-REF-CALC LESS THAN +0
 15774              MOVE +0            TO PB-C-LF-REF-CALC
 15775              GO TO 3730-GET-AH-REMAIN-TERM
 15776           ELSE
 15777              GO TO 3730-GET-AH-REMAIN-TERM.
 15778
 15779     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15780                            OR '4' OR '5' OR '6' OR '8'
 15781                            OR '9' OR 'G'
 15782        MOVE PB-C-LF-REFUND-OVERRIDE
 15783                                 TO CP-EARNING-METHOD.
 15784
 15785     if pb-company-id = 'AHL'
 15786        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15787        if cp-class-code = spaces
 15788           move zeros            to cp-class-code
 15789        end-if
 15790     ELSE
 15791        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15792     END-IF
 15793*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15794     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15795     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15796                                    CP-RATING-BENEFIT-AMT.
 15797     IF CP-STATE-STD-ABBRV = 'OR'
 15798         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15799                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15800     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15801     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15802     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15803     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15804     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15805     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15806     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15807     IF WS-DEFAULT-APR NOT NUMERIC
 15808         MOVE ZEROS TO WS-DEFAULT-APR.
 15809****   N O T E   ****
 15810*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15811*      THE OH HARD CODING IN ELCRFNDP
 15812
 15813     IF PB-COMPANY-ID = 'CID'
 15814        IF CP-STATE-STD-ABBRV = 'OH'
 15815           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 286
* EL050.cbl
 15816                                 TO CP-EARNING-METHOD
 15817        END-IF
 15818     END-IF
 15819
 15820****   N O T E   ****
 15821
 15822     IF CP-EARN-AS-NET-PAY
 15823         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15824            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15825                MOVE WS-DEFAULT-APR
 15826                                 TO  CP-LOAN-APR
 15827                MOVE ER-3780     TO  WS-ERROR
 15828                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15829            ELSE
 15830                MOVE ER-3781     TO  WS-ERROR
 15831                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15832     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15833     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15834
 15835     IF CP-REFUND-TYPE-USED NOT = SPACE
 15836         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15837
 15838     IF CP-ERROR-RATE-IS-ZERO OR
 15839        CP-ERROR-RATE-NOT-FOUND
 15840        MOVE ER-2740             TO WS-ERROR
 15841        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15842
 15843     IF CP-ERROR-RATE-FILE-NOTOPEN
 15844        MOVE ER-2617             TO WS-ERROR
 15845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15846
 15847     IF PB-COMPANY-ID = 'DCC'
 15848        AND PB-CI-ENTRY-STATUS = 'M'
 15849        MOVE +0                  TO PB-C-LF-REF-CALC
 15850     ELSE
 15851        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15852     END-IF
 15853
 15854     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15855         GO TO 3730-GET-AH-REMAIN-TERM.
 15856
 15857*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15858*       ADD +1                   TO PB-C-LF-REM-TERM
 15859*                                   CP-REMAINING-TERM
 15860*                                   CP-ORIGINAL-TERM.
 15861
 15862     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15863     MOVE '2'                    TO CP-EARNING-METHOD
 15864                                    CP-RATING-METHOD.
 15865     IF PB-COMPANY-ID = 'CID'
 15866        IF (CP-STATE-STD-ABBRV = 'MN')
 15867           AND (PB-CERT-EFF-DT > X'A4FF')
 15868           AND (WS-LF-EARNINGS-CALC = 'B')
 15869           MOVE '5'              TO CP-EARNING-METHOD
 15870           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15871        END-IF
 15872     END-IF
 15873     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 287
* EL050.cbl
 15874                                        CP-REMAINING-BENEFIT
 15875                                        CP-RATING-BENEFIT-AMT.
 15876     IF CP-STATE-STD-ABBRV = 'OR'
 15877         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15878                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15879     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15880     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15881
 15882     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15883
 15884     IF CP-ERROR-RATE-IS-ZERO OR
 15885        CP-ERROR-RATE-NOT-FOUND
 15886        MOVE ER-2740             TO WS-ERROR
 15887        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15888
 15889     IF CP-ERROR-RATE-FILE-NOTOPEN
 15890        MOVE ER-2617             TO WS-ERROR
 15891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15892
 15893     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15894
 15895******************************************************************
 15896
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 288
* EL050.cbl
 15898 3730-GET-AH-REMAIN-TERM.
 15899     IF NO-AH-BENEFIT-MATCH  OR
 15900        WS-AH-BENEFIT-CD = ZEROS
 15901         GO TO 3770-CHECK-REFUNDS.
 15902
 15903     IF PB-CI-AH-LUMP-SUM-DISAB
 15904         IF  PB-C-AH-CANCEL-AMT = ZERO
 15905            IF NOT PB-COMP-AH-CANCEL
 15906             GO TO 3770-CHECK-REFUNDS.
 15907
 15908     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15909     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15910     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15911     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15912     MOVE PB-SV-STATE            TO CP-STATE.
 15913     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15914     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15915     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15916     MOVE '2'                    TO CP-PROCESS-TYPE.
 15917     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15918     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15919     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15920     IF (PB-COMPANY-ID = 'CID')
 15921        AND (CP-STATE-STD-ABBRV = 'WI')
 15922        MOVE '7'                 TO CP-REM-TERM-METHOD
 15923        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15924     ELSE
 15925        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15926        MOVE WS-REM-TRM-CALC-OPTION
 15927                                 TO CP-REM-TRM-CALC-OPTION
 15928     END-IF
 15929     IF (PB-COMPANY-ID = 'CID')
 15930        AND (CP-STATE-STD-ABBRV = 'MO')
 15931        AND (PB-CERT-EFF-DT >= X'9B41')
 15932        AND (PB-CERT-EFF-DT <= X'A2FB')
 15933        MOVE '7'                 TO CP-REM-TERM-METHOD
 15934        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15935     END-IF
 15936     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15937                                    CP-LOAN-TERM.
 15938     IF NOT CP-TERM-IS-DAYS
 15939         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15940
 15941     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15942
 15943     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15944
 15945     IF AH-COVERAGE-CANCELLED
 15946        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15947        NEXT SENTENCE
 15948      ELSE
 15949         GO TO 3770-CHECK-REFUNDS.
 15950
 15951 3740-GET-AH-REFUND.
 15952
 15953     IF PB-C-LF-CANCEL-VOIDED OR
 15954        PB-C-AH-CANCEL-VOIDED
 15955        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 289
* EL050.cbl
 15956
 15957     IF PB-COMPANY-ID = 'BOA'
 15958         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15959         GO TO 3770-CHECK-REFUNDS.
 15960
 15961     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15962*    MOVE ' '                    TO DC-OPTION-CODE
 15963     SET BIN-TO-GREG             TO TRUE
 15964     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15965     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15966                                    PB-C-AH-REM-TERM.
 15967     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15968     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15969
 15970     IF PB-COMPANY-ID EQUAL 'FLC'
 15971        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15972           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15973           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15974                    - CM-AH-ITD-AH-PMT)
 15975           IF PB-C-AH-REF-CALC LESS THAN +0
 15976              MOVE +0            TO PB-C-AH-REF-CALC
 15977              GO TO 3770-CHECK-REFUNDS
 15978           ELSE
 15979              GO TO 3770-CHECK-REFUNDS.
 15980
 15981     IF PB-COMPANY-ID = 'DCC'
 15982        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15983            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15984           MOVE 'S'              TO CP-EARNING-METHOD
 15985        END-IF
 15986     END-IF
 15987     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15988                            OR '4' OR '5' OR '6' OR '8'
 15989                            OR '9' OR 'G' OR 'S'
 15990        MOVE PB-C-AH-REFUND-OVERRIDE
 15991                                 TO CP-EARNING-METHOD.
 15992
 15993     if pb-company-id = 'AHL'
 15994        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 15995        if cp-class-code = spaces
 15996           move zeros            to cp-class-code
 15997        end-if
 15998     ELSE
 15999        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16000     END-IF
 16001*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16002     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16003     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16004                                    CP-RATING-BENEFIT-AMT.
 16005     IF CP-STATE-STD-ABBRV = 'OR'
 16006         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16007                                         PB-CI-AH-TERM.
 16008     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16009     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16010     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16011     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16012     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16013     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 290
* EL050.cbl
 16014
 16015     IF CP-STATE-STD-ABBRV = 'OH'
 16016        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16017                                AND 'CID' AND 'DCC' AND 'AHL')
 16018           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16019              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16020              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16021              MOVE '6' TO CP-EARNING-METHOD
 16022           END-IF
 16023        END-IF
 16024        IF PB-COMPANY-ID = 'CID'
 16025           IF NO-LIFE-COVERAGE
 16026              IF CP-CRITICAL-PERIOD
 16027                 MOVE '2'       TO CP-EARNING-METHOD
 16028              ELSE
 16029                 MOVE '6'       TO CP-EARNING-METHOD
 16030              END-IF
 16031           ELSE
 16032              IF WS-LF-COVERAGE-TYPE = 'L'
 16033                 MOVE '2'       TO CP-EARNING-METHOD
 16034              ELSE
 16035                 IF (PB-CI-LF-TERM > +60) OR
 16036                    (WS-LF-EARNINGS-CALC = '5')
 16037                    IF CP-CRITICAL-PERIOD
 16038                       MOVE '2'  TO CP-EARNING-METHOD
 16039                    ELSE
 16040                       MOVE '6'  TO CP-EARNING-METHOD
 16041                    END-IF
 16042                 ELSE
 16043                    MOVE '1'     TO CP-EARNING-METHOD
 16044                 END-IF
 16045              END-IF
 16046           END-IF
 16047        END-IF
 16048     END-IF
 16049
 16050*    IF CP-STATE-STD-ABBRV = 'VA'
 16051*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16052*          IF CP-ORIGINAL-TERM GREATER 61
 16053*             MOVE '6' TO CP-EARNING-METHOD
 16054*          ELSE
 16055*             MOVE '1' TO CP-EARNING-METHOD.
 16056
 16057     IF WS-DEFAULT-APR NOT NUMERIC
 16058         MOVE ZEROS TO WS-DEFAULT-APR.
 16059     IF CP-EARN-AS-NET-PAY
 16060         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16061            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16062                MOVE WS-DEFAULT-APR
 16063                                 TO  CP-LOAN-APR
 16064                MOVE ER-3780     TO  WS-ERROR
 16065                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16066            ELSE
 16067                MOVE ER-3781     TO  WS-ERROR
 16068                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16069     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16070     IF PB-COMPANY-ID = 'DCC'
 16071        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 291
* EL050.cbl
 16072        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16073        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16074     END-IF
 16075     IF PB-COMPANY-ID = 'DCC'
 16076        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16077        AND (CP-EARNING-METHOD = 'D')
 16078        AND (CP-CANCEL-REASON NOT = 'R')
 16079        CONTINUE
 16080     ELSE
 16081        GO TO 3750-CONTINUE
 16082     END-IF
 16083     MOVE ' '                    TO DD-IU-SW
 16084     IF NOT PDEF-MASTER-FOUND
 16085        MOVE ' '                 TO PDEF-MASTER-SW
 16086        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16087        MOVE PB-STATE            TO ERPDEF-STATE
 16088        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16089        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16090        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16091        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16092        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16093        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16094        IF PDEF-MASTER-FOUND
 16095           MOVE 'N'              TO PDEF-MASTER-SW
 16096           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16097           IF PDEF-MASTER-FOUND
 16098              IF (ERPDEF-KEY-SAVE (1:16) =
 16099                           PD-CONTROL-PRIMARY (1:16))
 16100                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16101                 CONTINUE
 16102              ELSE
 16103                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16104                 IF (ERPDEF-KEY-SAVE (1:16) =
 16105                           PD-CONTROL-PRIMARY (1:16))
 16106                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16107                    CONTINUE
 16108                 ELSE
 16109                    MOVE ER-2740 TO WS-ERROR
 16110                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16111                    GO TO 3770-CHECK-REFUNDS
 16112                 END-IF
 16113              END-IF
 16114           END-IF
 16115           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16116        END-IF
 16117     END-IF
 16118     IF PDEF-MASTER-FOUND
 16119        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16120           (V1 > +8)
 16121           OR (PD-PROD-CODE (V1) = 'I')
 16122        END-PERFORM
 16123        IF V1 < +9
 16124           SET DD-IU-PRESENT        TO TRUE
 16125        END-IF
 16126        IF WS-AH-DCC-TRUNC = 'T'
 16127           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16128        ELSE
 16129           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 292
* EL050.cbl
 16130        END-IF
 16131        EVALUATE TRUE
 16132           WHEN WS-TERM > +168
 16133              MOVE 15               TO V1
 16134           WHEN WS-TERM > +156
 16135              MOVE 14               TO V1
 16136           WHEN WS-TERM > +144
 16137              MOVE 13               TO V1
 16138           WHEN WS-TERM > +132
 16139              MOVE 12               TO V1
 16140           WHEN WS-TERM > +120
 16141              MOVE 11               TO V1
 16142           WHEN WS-TERM > +108
 16143              MOVE 10               TO V1
 16144           WHEN WS-TERM > +96
 16145              MOVE 9                TO V1
 16146           WHEN WS-TERM > +84
 16147              MOVE 8                TO V1
 16148           WHEN WS-TERM > +72
 16149              MOVE 7                TO V1
 16150           WHEN WS-TERM > +60
 16151              MOVE 6                TO V1
 16152           WHEN WS-TERM > +48
 16153              MOVE 5                TO V1
 16154           WHEN WS-TERM > +36
 16155              MOVE 4                TO V1
 16156           WHEN WS-TERM > +24
 16157              MOVE 3                TO V1
 16158           WHEN WS-TERM > +12
 16159              MOVE 2                TO V1
 16160           WHEN OTHER
 16161              MOVE 1                TO V1
 16162        END-EVALUATE
 16163
 16164        EVALUATE TRUE
 16165*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16166*             < +13)
 16167*             AND (DD-IU-PRESENT)
 16168*             MOVE 2                TO V2
 16169*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16170*             MOVE 1                TO V2
 16171           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16172              MOVE 2                TO V2
 16173           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16174              MOVE 3                TO V2
 16175           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16176              MOVE 4                TO V2
 16177           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16178              MOVE 5                TO V2
 16179           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16180              MOVE 6                TO V2
 16181           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16182              MOVE 7                TO V2
 16183           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16184              MOVE 8                TO V2
 16185           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16186              MOVE 9                TO V2
 16187           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 293
* EL050.cbl
 16188              MOVE 10               TO V2
 16189           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16190              MOVE 11               TO V2
 16191           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16192              MOVE 12               TO V2
 16193           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16194              MOVE 13               TO V2
 16195           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16196              MOVE 14               TO V2
 16197           WHEN OTHER
 16198              MOVE 15               TO V2
 16199        END-EVALUATE
 16200
 16201        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16202                                 TO CP-DDF-LO-FACT
 16203        MOVE PD-UEP-FACTOR (V1 V2)
 16204                                 TO CP-DDF-HI-FACT
 16205
 16206        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16207        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16208        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16209           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16210        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16211        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16212        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16213           + PD-1ST-YR-ADMIN-ALLOW
 16214
 16215        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16216*       IF PI-CLP-YN = 'Y'
 16217*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16218*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16219*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16220*       END-IF
 16221
 16222        IF DD-IU-PRESENT
 16223           MOVE 'I'              TO CP-EARNING-METHOD
 16224        END-IF
 16225        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16226                                     CP-CLP-RATE-UP
 16227        IF CP-IU-RATE-UP NOT = ZEROS
 16228           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16229              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16230           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16231              / (1 - WS-WORK-FACT)
 16232        END-IF
 16233     END-IF
 16234     .
 16235 3750-CONTINUE.
 16236     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16237
 16238     IF CP-REFUND-TYPE-USED NOT = SPACE
 16239         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16240
 16241     IF CP-ERROR-RATE-IS-ZERO OR
 16242        CP-ERROR-RATE-NOT-FOUND
 16243        MOVE ER-2740             TO WS-ERROR
 16244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16245
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 294
* EL050.cbl
 16246     IF CP-ERROR-RATE-FILE-NOTOPEN
 16247        MOVE ER-2617             TO WS-ERROR
 16248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16249     IF PB-COMPANY-ID = 'DCC'
 16250        AND PB-CI-ENTRY-STATUS = 'M'
 16251        MOVE +0                  TO PB-C-AH-REF-CALC
 16252     ELSE
 16253        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16254     END-IF
 16255     IF PB-COMPANY-ID = 'DCC'
 16256        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16257        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16258        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16259        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16260        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16261        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16262        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16263        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16264        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16265     END-IF
 16266     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 295
* EL050.cbl
 16268
 16269 3770-CHECK-REFUNDS.
 16270
 16271     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16272        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16273           MOVE ER-2766          TO WS-ERROR
 16274           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16275           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16276           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16277              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16278
 16279     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16280        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16281           MOVE ER-2766          TO WS-ERROR
 16282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16283           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16284           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16285              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16286
 16287     IF PB-COMP-LF-CANCEL
 16288        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16289        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16290           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16291              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16292
 16293     IF PB-COMP-AH-CANCEL
 16294        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16295        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16296           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16297              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16298
 16299     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16300             GIVING WS-UNSIGN-WRK1
 16301     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16302             GIVING WS-UNSIGN-WRK2.
 16303
 16304     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16305         MOVE ZERO TO WS-UNSIGN-WRK1.
 16306
 16307     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16308         MOVE ZERO TO WS-UNSIGN-WRK2.
 16309
 16310     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16311
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 296
* EL050.cbl
 16313
 16314 3772-CONTINUE.
 16315
 16316**********************************
 16317*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16318*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16319*** DOUBLES THE TOLERANCE AMOUNT.
 16320***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16321**********************************
 16322     IF PB-COMPANY-ID = 'MON'
 16323     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16324         IF WS-REF-REJECT-SW = SPACE
 16325             MOVE ER-2754        TO WS-ERROR
 16326             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16327           ELSE
 16328             MOVE ER-2736        TO WS-ERROR
 16329             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16330**********************************
 16331
 16332 3773-CONTINUE.
 16333
 16334     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16335        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16336           MOVE ER-2723          TO WS-ERROR
 16337           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16338
 16339     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16340        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16341           MOVE ER-2724          TO WS-ERROR
 16342           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16343
 16344     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16345         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16346             (1 + WS-LF-REFUND-OVS-PCT)
 16347     ELSE
 16348         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16349
 16350     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16351         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16352             (1 - WS-TOL-LF-REFUND-PCT)
 16353     ELSE
 16354         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16355
 16356     IF (PB-COMPANY-ID = 'DCC')
 16357        AND (PB-CI-ENTRY-STATUS = 'M')
 16358        AND (PB-C-LF-CANCEL-AMT > +0)
 16359        MOVE ER-3843             TO WS-ERROR
 16360        PERFORM 9900-ERROR-FORMAT
 16361                                 THRU 9900-EXIT
 16362     END-IF
 16363     EVALUATE TRUE
 16364        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16365           CONTINUE
 16366        WHEN PB-C-LF-CANCEL-AMT = +0
 16367                 AND PB-C-LF-REF-CALC > +0
 16368           CONTINUE
 16369        WHEN WS-LF-REFUND-OVS-AMT = 0
 16370                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 297
* EL050.cbl
 16371           CONTINUE
 16372        WHEN OTHER
 16373           IF WS-TOL-LF-REFUND  = +0
 16374              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16375           END-IF
 16376           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16377                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16378                          (PB-C-LF-CANCEL-AMT))
 16379              CONTINUE
 16380           ELSE
 16381              IF WS-LF-REFUND-OVS-AMT = +0
 16382                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16383              END-IF
 16384              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16385                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16386                                       PB-C-LF-CANCEL-AMT)
 16387                 CONTINUE
 16388              ELSE
 16389                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16390                   MOVE ER-2754   TO  WS-ERROR
 16391                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16392                 ELSE
 16393                    MOVE ER-2736   TO  WS-ERROR
 16394                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16395                 END-IF
 16396              END-IF
 16397           END-IF
 16398     END-EVALUATE.
 16399
 16400     EVALUATE TRUE
 16401        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16402           CONTINUE
 16403        WHEN PB-C-LF-CANCEL-AMT = +0
 16404                 AND PB-C-LF-REF-CALC > +0
 16405           CONTINUE
 16406        WHEN OTHER
 16407           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16408               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16409              CONTINUE
 16410           ELSE
 16411              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16412               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16413                CONTINUE
 16414              ELSE
 16415                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16416                     MOVE ER-2754   TO  WS-ERROR
 16417                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16418                 ELSE
 16419                     MOVE ER-2736   TO  WS-ERROR
 16420                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16421                 END-IF
 16422              END-IF
 16423           END-IF
 16424     END-EVALUATE.
 16425
 16426     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16427         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16428             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 298
* EL050.cbl
 16429     ELSE
 16430         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16431
 16432     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16433         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16434             (1 - WS-TOL-AH-REFUND-PCT)
 16435     ELSE
 16436         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16437
 16438     IF (PB-COMPANY-ID = 'DCC')
 16439        AND (PB-CI-ENTRY-STATUS = 'M')
 16440        AND (PB-C-AH-CANCEL-AMT > +0)
 16441        MOVE ER-3843             TO WS-ERROR
 16442        PERFORM 9900-ERROR-FORMAT
 16443                                 THRU 9900-EXIT
 16444     END-IF
 16445     EVALUATE TRUE
 16446        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16447           CONTINUE
 16448*       WHEN PB-C-AH-REF-CALC = +0 AND
 16449*                  PB-C-AH-CANCEL-AMT > +0
 16450        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16451                   PB-C-AH-REF-CALC > +0
 16452           CONTINUE
 16453        WHEN WS-AH-REFUND-OVS-AMT = +0
 16454                AND WS-TOL-AH-REFUND = +0
 16455           CONTINUE
 16456        WHEN OTHER
 16457           IF WS-TOL-AH-REFUND = +0
 16458              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16459           END-IF
 16460           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16461               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16462                                         PB-C-AH-CANCEL-AMT)
 16463              CONTINUE
 16464           ELSE
 16465              IF WS-AH-REFUND-OVS-AMT = +0
 16466                 MOVE +9999999.99 TO
 16467                         WS-AH-REFUND-OVS-AMT
 16468              END-IF
 16469              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16470                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16471                                         PB-C-AH-CANCEL-AMT)
 16472                 CONTINUE
 16473              ELSE
 16474                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16475                    MOVE ER-2754   TO  WS-ERROR
 16476                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16477                 ELSE
 16478                    MOVE ER-2736   TO  WS-ERROR
 16479                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16480                 END-IF
 16481              END-IF
 16482           END-IF
 16483     END-EVALUATE.
 16484
 16485     EVALUATE TRUE
 16486        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 299
* EL050.cbl
 16487           CONTINUE
 16488*       WHEN PB-C-AH-REF-CALC > +0 AND
 16489*                  PB-C-AH-CANCEL-AMT = +0
 16490        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16491                   PB-C-AH-REF-CALC = +0
 16492           CONTINUE
 16493        WHEN OTHER
 16494           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16495               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16496              CONTINUE
 16497           ELSE
 16498              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16499                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16500                 CONTINUE
 16501              ELSE
 16502                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16503                     MOVE ER-2754   TO  WS-ERROR
 16504                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16505                 ELSE
 16506                     MOVE ER-2736   TO  WS-ERROR
 16507                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16508                 END-IF
 16509              END-IF
 16510           END-IF
 16511     END-EVALUATE.
 16512
 16513     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16514        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16515        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16516           AND  PB-C-LF-REF-CALC < +1.00
 16517           AND  PB-C-AH-REF-CALC < +1.00
 16518           CONTINUE
 16519        ELSE
 16520           IF (PB-COMPANY-ID = 'DCC')
 16521              AND (PB-CI-ENTRY-STATUS = 'M')
 16522              CONTINUE
 16523           ELSE
 16524              MOVE ER-2741       TO WS-ERROR
 16525              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16526           END-IF
 16527        END-IF
 16528     END-IF
 16529
 16530     IF (PB-C-LF-CANCEL-AMT = ZERO
 16531        AND WS-LF-BENEFIT-CD NOT = ZERO
 16532        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16533        AND PB-C-LF-REF-CALC NOT = ZERO)
 16534        OR
 16535        (PB-C-LF-CANCEL-AMT = ZERO
 16536        AND WS-LF-BENEFIT-CD NOT = ZERO
 16537        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16538             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16539                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16540                NEXT SENTENCE
 16541             ELSE
 16542                MOVE ER-2739        TO WS-ERROR
 16543                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16544
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 300
* EL050.cbl
 16545     IF (PB-C-AH-CANCEL-AMT = ZERO
 16546        AND WS-AH-BENEFIT-CD NOT = ZERO
 16547        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16548        AND PB-C-AH-REF-CALC NOT = ZERO)
 16549        OR
 16550        (PB-C-AH-CANCEL-AMT = ZERO
 16551        AND WS-AH-BENEFIT-CD NOT = ZERO
 16552        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16553             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16554                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16555                NEXT SENTENCE
 16556             ELSE
 16557                MOVE ER-2738        TO WS-ERROR
 16558                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16559
 16560 3775-OVER-REF-CHK.
 16561
 16562     IF PB-CI-ENTRY-STATUS = '5'
 16563        GO TO 3780-UPDATE-CANCEL-CERT.
 16564
 16565     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16566                              PB-CI-LF-ALT-PREMIUM-AMT.
 16567
 16568     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16569        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16570                                 PB-C-LF-REF-CALC
 16571      ELSE
 16572        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16573                                 PB-C-LF-CANCEL-AMT.
 16574
 16575     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16576        MOVE ER-2755             TO WS-ERROR
 16577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16578
 16579     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16580
 16581     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16582        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16583                                 PB-C-AH-REF-CALC
 16584      ELSE
 16585        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16586                                 PB-C-AH-CANCEL-AMT.
 16587
 16588     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16589        MOVE ER-2778             TO WS-ERROR
 16590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16591
 16592     IF PB-CI-OB-FLAG NOT = 'Z'
 16593        NEXT SENTENCE
 16594       ELSE
 16595         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16596            MOVE ER-2757           TO WS-ERROR
 16597            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16598
 16599 3780-UPDATE-CANCEL-CERT.
 16600
 16601     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16602        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 301
* EL050.cbl
 16603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16604
 16605     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16606         MOVE ER-2729              TO WS-ERROR
 16607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16608
 16609     IF PB-CI-LF-BENEFIT-CD = ZERO
 16610         GO TO 3780-UPDATE-CONT-1.
 16611
 16612     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16613         GO TO 3780-UPDATE-CONT-1.
 16614
 16615     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16616       AND
 16617        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16618       AND
 16619        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16620       AND
 16621        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16622            NEXT SENTENCE
 16623       ELSE
 16624        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16625          AND
 16626***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16627***       AND
 16628           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16629            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16630               MOVE ER-2730      TO WS-ERROR
 16631               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16632               GO TO 3999-END-EDIT
 16633            ELSE
 16634               GO TO 3999-END-EDIT
 16635        ELSE
 16636            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16637               MOVE ER-2765           TO WS-ERROR
 16638               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16639               GO TO 3785-CHECK-NH.
 16640*              GO TO 3999-END-EDIT.
 16641
 16642 3780-UPDATE-CONT-1.
 16643     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16644
 16645     IF PB-CI-AH-BENEFIT-CD = ZERO
 16646         GO TO 3780-UPDATE-CONT-2.
 16647
 16648     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16649         GO TO 3780-UPDATE-CONT-2.
 16650
 16651     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16652
 16653     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16654       AND
 16655        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16656       AND
 16657        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16658       AND
 16659        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16660            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 302
* EL050.cbl
 16661       ELSE
 16662        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16663          AND
 16664***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16665***       AND
 16666           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16667           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16668            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16669               MOVE ER-2773      TO WS-ERROR
 16670               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16671               GO TO 3999-END-EDIT
 16672            ELSE
 16673               GO TO 3999-END-EDIT
 16674            END-IF
 16675           ELSE
 16676             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16677                MOVE ER-2890 TO WS-ERROR
 16678                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16679                GO TO 3999-END-EDIT
 16680             ELSE
 16681                GO TO 3785-CHECK-NH
 16682             END-IF
 16683           END-IF
 16684          ELSE
 16685            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16686              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16687                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16688                   MOVE ER-2890 TO WS-ERROR
 16689                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16690                   GO TO 3999-END-EDIT
 16691                ELSE
 16692                   MOVE ER-2765 TO WS-ERROR
 16693                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16694                   GO TO 3785-CHECK-NH
 16695                END-IF
 16696              ELSE
 16697               MOVE ER-2765      TO WS-ERROR
 16698               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16699               GO TO 3785-CHECK-NH.
 16700*              GO TO 3999-END-EDIT.
 16701
 16702 3780-UPDATE-CONT-2.
 16703
 16704     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16705        AND WS-LF-BENEFIT-CD = ZERO
 16706           MOVE ER-2743           TO WS-ERROR
 16707           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16708
 16709     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16710        AND WS-AH-BENEFIT-CD = ZERO
 16711           MOVE ER-2744           TO WS-ERROR
 16712           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16713
 16714     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16715        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16716        AND
 16717        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16718         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 303
* EL050.cbl
 16719           MOVE ER-2746           TO WS-ERROR
 16720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16721
 16722     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16723       AND
 16724        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16725             MOVE ER-2737        TO WS-ERROR
 16726             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16727
 16728     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16729       AND
 16730        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16731             MOVE ER-2737        TO WS-ERROR
 16732             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16733
 16734     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16735         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16736             OR 'CID' OR 'DCC' OR 'AHL'
 16737             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16738         ELSE
 16739             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16740                 MOVE ER-2768    TO WS-ERROR
 16741                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16742             ELSE
 16743                 MOVE ER-2756    TO WS-ERROR
 16744                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16745
 16746     IF CERT-PEND-ISSUE-RETURNED
 16747        MOVE ER-2772             TO WS-ERROR
 16748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16749 3785-CHECK-NH.
 16750     IF PB-STATE NOT = 'NH'
 16751        GO TO 3999-END-EDIT
 16752     END-IF
 16753
 16754     MOVE ER-2796                TO WS-ERROR
 16755     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16756     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16757        OR (CM-NH-INTERFACE-SW = 'Y')
 16758        MOVE ER-2793             TO WS-ERROR
 16759        PERFORM 9900-ERROR-FORMAT
 16760                                 THRU 9900-EXIT
 16761     END-IF
 16762     MOVE +0                     TO WS-PAYMENT-AMT
 16763     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16764        GO TO 3999-END-EDIT
 16765     END-IF
 16766     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16767        GO TO 3999-END-EDIT
 16768     END-IF
 16769     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16770     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16771     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16772        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16773     END-IF
 16774     MOVE '1'                    TO DC-OPTION-CODE
 16775     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16776     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 304
* EL050.cbl
 16777        IF DC-ELAPSED-DAYS < +16
 16778           GO TO 3999-END-EDIT
 16779        END-IF
 16780     END-IF
 16781     MOVE +0                     TO DC-ELAPSED-DAYS
 16782     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16783     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16784     MOVE '1'                    TO DC-OPTION-CODE
 16785     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16786     IF NO-CONVERSION-ERROR
 16787        IF DC-ELAPSED-DAYS > +30
 16788           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16789        ELSE
 16790           GO TO 3999-END-EDIT
 16791        END-IF
 16792     ELSE
 16793        GO TO 3999-END-EDIT
 16794     END-IF
 16795     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16796        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16797           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16798     IF WS-PAYMENT-AMT < 600.00
 16799        GO TO 3999-END-EDIT
 16800     END-IF
 16801     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16802
 16803     IF (ERMAIL-FOUND = ' ')
 16804         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16805         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16806        GO TO 3999-END-EDIT
 16807     END-IF
 16808     MOVE ER-2795                TO WS-ERROR
 16809     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16810
 16811     GO TO 3999-END-EDIT.
 16812******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 305
* EL050.cbl
 16814 3990-FILES-NOT-OPEN.
 16815
 16816     MOVE ER-2617                TO WS-ERROR.
 16817     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16818     GO TO 9990-RETURN.
 16819
 16820 3999-END-EDIT.
 16821
 16822     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16823
 16824     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16825         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16826         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16827             PERFORM 9250-UNLOCK-RETURN
 16828             GO TO 9990-RETURN
 16829          ELSE
 16830             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16831             GO TO 9990-RETURN.
 16832
 16833     IF PB-CANCELLATION
 16834          GO TO 9990-RETURN.
 16835
 16836     IF CERT-WAS-NOT-FOUND
 16837        MOVE SPACES              TO CERTIFICATE-MASTER.
 16838
 16839     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16840
 16841     IF CERT-WAS-FOUND
 16842         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16843             PERFORM 9250-UNLOCK-RETURN
 16844          ELSE
 16845            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16846      ELSE
 16847         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16848
 16849     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16850        IF PB-COMPANY-ID = 'DCC' AND
 16851           (PB-CARRIER = '2' OR '4' OR '6')
 16852              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16853        END-IF
 16854     END-IF.
 16855
 16856     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16857         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16858     END-IF.
 16859
 16860     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16861     IF ((PB-COMPANY-ID = 'DCC')
 16862        AND (WS-NO-SECURE-PAY))
 16863                  OR
 16864        (WS-LF-SPECIAL-CALC-CD = 'O'
 16865        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16866        SET SKIP-ADDR-EDIT       TO TRUE
 16867     END-IF
 16868     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16869        AND (NOT SKIP-ADDR-EDIT)
 16870        MOVE ER-2963             TO WS-ERROR
 16871        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 306
* EL050.cbl
 16872                                 THRU 9900-EXIT
 16873        GO TO 9990-RETURN
 16874     END-IF
 16875     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16876     IF ERPNDM-FOUND NOT = 'X'
 16877        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16878           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16879           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16880           AND (NOT SKIP-ADDR-EDIT)
 16881           MOVE ER-2694          TO WS-ERROR
 16882           PERFORM 9900-ERROR-FORMAT
 16883                                 THRU 9900-EXIT
 16884        END-IF
 16885        MOVE ' '                 TO STATE-RECORD-ERROR
 16886        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16887        MOVE PM-STATE            TO CNTL-ACCESS
 16888        MOVE '3'                 TO CNTL-REC-TYPE
 16889        MOVE +0                  TO CNTL-SEQ-NO
 16890        MOVE '0'                 TO RC-SW-2
 16891        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16892        IF (NO-STATE-RECORD)
 16893           OR (CF-RECORD-TYPE NOT = '3')
 16894           OR (PM-STATE NOT = CF-STATE-CODE)
 16895           IF (PM-STATE = SPACES)
 16896              AND (SKIP-ADDR-EDIT)
 16897              CONTINUE
 16898           ELSE
 16899              MOVE ER-2963       TO WS-ERROR
 16900              PERFORM 9900-ERROR-FORMAT
 16901                                 THRU 9900-EXIT
 16902           END-IF
 16903        END-IF
 16904        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16905           MOVE ER-2883          TO WS-ERROR
 16906           PERFORM 9900-ERROR-FORMAT
 16907                                 THRU 9900-EXIT
 16908        END-IF
 16909        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16910           MOVE ' '                 TO STATE-RECORD-ERROR
 16911           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16912           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16913           MOVE '3'                 TO CNTL-REC-TYPE
 16914           MOVE +0                  TO CNTL-SEQ-NO
 16915           MOVE '0'                 TO RC-SW-2
 16916           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16917           IF NO-STATE-RECORD
 16918              OR (CF-RECORD-TYPE NOT = '3')
 16919              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16920              MOVE ER-2964          TO WS-ERROR
 16921              PERFORM 9900-ERROR-FORMAT
 16922                                    THRU 9900-EXIT
 16923           END-IF
 16924        END-IF
 16925     ELSE
 16926        IF NOT SKIP-ADDR-EDIT
 16927           MOVE ER-2393          TO WS-ERROR
 16928           PERFORM 9900-ERROR-FORMAT
 16929                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 307
* EL050.cbl
 16930        END-IF
 16931     END-IF
 16932
 16933     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16934
 16935     IF (ERMAIL-FOUND = ' ' AND
 16936        ERPNDM-FOUND = ' ')
 16937        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16938           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16939           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16940          OR
 16941           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16942          OR
 16943           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16944           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16945           GO TO 3999-UNLOCK-ERMAIL.
 16946
 16947     IF ERPNDM-FOUND = 'X'
 16948        GO TO 3999-UNLOCK-ERMAIL.
 16949
 16950     IF PM-INSURED-LAST-NAME      = SPACES
 16951        AND PM-INSURED-FIRST-NAME = SPACES
 16952        AND PM-ADDRESS-LINE-1     = SPACES
 16953        AND PM-ADDRESS-LINE-2     = SPACES
 16954        AND PM-CITY-STATE         = SPACES
 16955        AND PM-CRED-BENE-NAME     = SPACES
 16956        AND PM-CRED-BENE-ADDR     = SPACES
 16957        AND PM-CRED-BENE-CTYST    = SPACES
 16958        GO TO 3999-UNLOCK-ERMAIL
 16959     END-IF
 16960
 16961     MOVE SPACES                 TO MAILING-DATA.
 16962
 16963     MOVE 'MA'                   TO MA-RECORD-ID.
 16964     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16965     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16966     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16967     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16968     MOVE PB-SV-STATE            TO MA-STATE.
 16969     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16970     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16971
 16972     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16973     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16974
 16975     IF ERMAIL-FOUND = ' '
 16976        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16977     ELSE
 16978        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16979        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16980        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16981
 16982     GO TO 9990-RETURN.
 16983
 16984 3999-UNLOCK-ERMAIL.
 16985     IF ERMAIL-FOUND = ' '
 16986        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16987
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 308
* EL050.cbl
 16988     GO TO 9990-RETURN.
 16989******************************************************************
 16990
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 309
* EL050.cbl
 16992 4000-UPDATE-CANCELLED-CERT.
 16993     IF CERT-WAS-NOT-FOUND
 16994        GO TO 4299-EXIT.
 16995
 16996*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16997     IF PB-C-NH-INT-ON-REFS > ZEROS
 16998        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16999     END-IF
 17000     IF PB-C-REF-INTERFACE-SW = 'Y'
 17001        MOVE PB-C-REF-INTERFACE-SW
 17002                                 TO CM-NH-INTERFACE-SW
 17003     END-IF
 17004     IF PB-C-POST-CARD-IND = 'Y'
 17005        MOVE +8                  TO SUB
 17006        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17007        IF ERMAIL-FOUND = ' '
 17008           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17009              (SUB > +7)
 17010              OR (MA-MAIL-STATUS (SUB) = '1')
 17011           END-PERFORM
 17012        END-IF
 17013        IF (SUB > +7)
 17014           OR (ERMAIL-FOUND = 'X')
 17015           MOVE ER-3789          TO WS-ERROR
 17016           PERFORM 9900-ERROR-FORMAT
 17017                                 THRU 9900-EXIT
 17018        END-IF
 17019     ELSE
 17020        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17021     END-IF
 17022     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17023
 17024     IF PB-CI-OB-FLAG = 'Z'
 17025        GO TO 4150-SUMMARY-CERT-CANCEL.
 17026
 17027     IF PB-C-LF-CANCEL-VOIDED
 17028         PERFORM 4200-REVERSE-LF-CANCEL.
 17029     IF PB-C-AH-CANCEL-VOIDED
 17030         PERFORM 4200-REVERSE-AH-CANCEL.
 17031
 17032 4100-APPLY-LF-CANCEL.
 17033
 17034     MOVE +0                     TO WS-SUB.
 17035
 17036 4100-CHECK-LF-ERRORS.
 17037
 17038     ADD +1                       TO WS-SUB.
 17039
 17040     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17041        IF LF-COVERAGE-CANCELLED
 17042           GO TO 4100-LF-CANCEL-CONT
 17043        ELSE
 17044           GO TO 4100-UPDATE-LF-COVERAGE.
 17045
 17046     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17047                                   ER-2729 OR
 17048                                   ER-2730 OR
 17049                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 310
* EL050.cbl
 17050                                   ER-2732 OR
 17051                                   ER-2737 OR
 17052                                   ER-2740 OR
 17053                                   ER-2743 OR
 17054                                   ER-2749 OR
 17055                                   ER-2750 OR
 17056                                   ER-2755 OR
 17057                                   ER-2757 OR
 17058                                   ER-2760 OR
 17059                                   ER-2772 OR
 17060                                   ER-2774 OR
 17061                                   ER-2776 OR
 17062                                   ER-2794
 17063        GO TO 4100-UPDATE-LF-COVERAGE.
 17064
 17065     GO TO 4100-CHECK-LF-ERRORS.
 17066
 17067 4100-UPDATE-LF-COVERAGE.
 17068
 17069     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17070     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17071     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17072        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17073     END-IF
 17074     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17075                                      TO CM-CREDIT-INTERFACE-SW-2.
 17076     IF CM-LF-CANCEL-DT = LOW-VALUE
 17077         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17078
 17079     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17080         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17081                                         CM-LF-STATUS-AT-CANCEL.
 17082
 17083     GO TO 4100-APPLY-AH-CANCEL.
 17084
 17085 4100-LF-CANCEL-CONT.
 17086     IF PB-C-LF-CANCEL-VOIDED
 17087         GO TO 4100-APPLY-AH-CANCEL.
 17088
 17089     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17090         GO TO 4100-APPLY-AH-CANCEL.
 17091
 17092     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17093        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17094           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17095        ELSE
 17096           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17097
 17098     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17099     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17100
 17101     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17102         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17103
 17104     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17105        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17106         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17107         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 311
* EL050.cbl
 17108
 17109     IF PB-RECORD-RETURNED
 17110        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17111      ELSE
 17112        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17113
 17114 4100-APPLY-AH-CANCEL.
 17115
 17116     MOVE +0                      TO WS-SUB.
 17117
 17118 4100-CHECK-AH-ERRORS.
 17119
 17120     ADD +1                       TO WS-SUB.
 17121
 17122     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17123        IF AH-COVERAGE-CANCELLED
 17124           GO TO 4100-AH-CANCEL-CONT
 17125        ELSE
 17126           GO TO 4100-UPDATE-AH-COVERAGE.
 17127
 17128     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17129                                   ER-2729 OR
 17130                                   ER-2732 OR
 17131                                   ER-2737 OR
 17132                                   ER-2740 OR
 17133                                   ER-2744 OR
 17134                                   ER-2749 OR
 17135                                   ER-2750 OR
 17136                                   ER-2755 OR
 17137                                   ER-2757 OR
 17138                                   ER-2760 OR
 17139                                   ER-2771 OR
 17140                                   ER-2772 OR
 17141                                   ER-2773 OR
 17142                                   ER-2775 OR
 17143                                   ER-2777 OR
 17144                                   ER-2794
 17145        GO TO 4100-UPDATE-AH-COVERAGE.
 17146
 17147     GO TO 4100-CHECK-AH-ERRORS.
 17148
 17149 4100-UPDATE-AH-COVERAGE.
 17150
 17151     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17152     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17153     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17154     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17155                                      TO CM-CREDIT-INTERFACE-SW-2.
 17156     IF CM-AH-CANCEL-DT = LOW-VALUE
 17157         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17158
 17159     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17160         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17161                                         CM-AH-STATUS-AT-CANCEL.
 17162
 17163     IF LF-COVERAGE-CANCELLED
 17164         IF PB-RECORD-RETURNED
 17165              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 312
* EL050.cbl
 17166          ELSE
 17167              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17168
 17169     GO TO 4299-EXIT.
 17170
 17171 4100-AH-CANCEL-CONT.
 17172     IF PB-C-AH-CANCEL-VOIDED
 17173         GO TO 4299-EXIT.
 17174
 17175     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17176         GO TO 4299-EXIT.
 17177
 17178     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17179        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17180           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17181        ELSE
 17182           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17183
 17184     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17185     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17186
 17187     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17188         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17189
 17190     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17191         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17192         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17193
 17194     IF PB-RECORD-RETURNED
 17195        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17196      ELSE
 17197        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17198
 17199     GO TO 4299-EXIT.
 17200
 17201 4150-SUMMARY-CERT-CANCEL.
 17202     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17203
 17204     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17205        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17206                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17207     ELSE
 17208        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17209                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17210
 17211     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17212        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17213                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17214     ELSE
 17215        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17216                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17217
 17218     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17219        NEXT SENTENCE
 17220     ELSE
 17221        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17222
 17223     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 313
* EL050.cbl
 17224
 17225 4200-REVERSE-LF-CANCEL.
 17226     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17227
 17228     IF CM-LF-CANCEL-APPLIED
 17229        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17230        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17231        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17232
 17233     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17234
 17235     IF PB-RECORD-RETURNED
 17236        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17237       ELSE
 17238        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17239
 17240 4200-REVERSE-LF-EXIT.
 17241       EXIT.
 17242
 17243 4200-REVERSE-AH-CANCEL.
 17244     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17245
 17246     IF CM-AH-CANCEL-APPLIED
 17247        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17248        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17249        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17250
 17251     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17252
 17253     IF PB-RECORD-RETURNED
 17254        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17255       ELSE
 17256        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17257
 17258 4200-REVERSE-AH-EXIT.
 17259       EXIT.
 17260
 17261 4299-EXIT.
 17262       EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 314
* EL050.cbl
 17264
 17265 4500-UPDATE-NEW-CERT.
 17266     IF CERT-WAS-FOUND
 17267         NEXT SENTENCE
 17268       ELSE
 17269         GO TO 4520-BUILD-NEW-KEY.
 17270
 17271     IF  CLASIC-CREATED-CERT
 17272         GO TO 4999-EXIT.
 17273
 17274     IF  CERT-WAS-CREATED-FOR-CLAIM
 17275         GO TO 4520-BUILD-NEW-KEY.
 17276
 17277     IF CERT-ADDED-BATCH
 17278        IF CM-RECORD-ID = 'CM'
 17279            GO TO 4999-EXIT.
 17280
 17281 4520-BUILD-NEW-KEY.
 17282* BUILD CONTROL PRIMARY
 17283
 17284     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17285                                       CM-COMPANY-CD-A1
 17286                                       CM-COMPANY-CD-A2
 17287                                       CM-COMPANY-CD-A4
 17288                                       CM-COMPANY-CD-A5.
 17289
 17290     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17291     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17292     MOVE PB-SV-STATE               TO CM-STATE.
 17293     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17294     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17295     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17296     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17297
 17298     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17299
 17300     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17301     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17302     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17303     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17304
 17305     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17306        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17307
 17308     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17309         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17310         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17311         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17312         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17313     ELSE
 17314         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17315
 17316     IF PB-COMPANY-ID   EQUAL  'CRI'
 17317         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17318         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17319         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17320         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17321         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 315
* EL050.cbl
 17322
 17323     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17324        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17325         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17326
 17327     IF PB-COMPANY-ID  = 'LBL'
 17328        IF PB-I-JOINT-COVERAGE
 17329            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17330                                           PB-I-MEMBER-NO
 17331            GO TO 4550-CONT-CERT-PROCESS.
 17332
 17333     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17334        NEXT SENTENCE
 17335     ELSE
 17336        GO TO 4540-BUILD-MEMBER-NO.
 17337
 17338******************************************************************
 17339*                                                                *
 17340*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17341*    FOR 'MON'.                                                  *
 17342*                                                                *
 17343******************************************************************
 17344
 17345     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17346     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17347     MOVE +1                     TO WS-SUB1
 17348                                    WS-SUB2.
 17349
 17350 4530-EDIT-MEMB-NAME.
 17351
 17352     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17353        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17354        ADD +1                       TO WS-SUB2.
 17355
 17356     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17357        ADD +1                       TO WS-SUB1
 17358        GO TO 4530-EDIT-MEMB-NAME.
 17359
 17360     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17361     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17362     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17363*    MOVE SPACE                      TO DC-OPTION-CODE.
 17364     SET  BIN-TO-GREG                TO TRUE.
 17365     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17366     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17367
 17368     GO TO 4550-CONT-CERT-PROCESS.
 17369
 17370******************************************************************
 17371*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17372******************************************************************
 17373
 17374 4540-BUILD-MEMBER-NO.
 17375
 17376     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17377         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17378         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17379         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 316
* EL050.cbl
 17380         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17381     ELSE
 17382         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17383
 17384     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17385        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17386         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17387
 17388 4550-CONT-CERT-PROCESS.
 17389
 17390*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17391*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17392*    ELSE
 17393*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17394
 17395     IF CERT-WAS-CREATED-FOR-CLAIM
 17396        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17397        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17398
 17399     IF CERT-AND-CLAIM-ONLINE
 17400        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17401        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17402
 17403     MOVE 'CM'                     TO CM-RECORD-ID.
 17404     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17405
 17406     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17407        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17408        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17409     ELSE
 17410        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17411        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17412
 17413     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17414     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17415     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17416     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17417     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17418     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17419     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17420                                      CM-LF-ITD-CANCEL-AMT
 17421                                      CM-LF-ITD-DEATH-AMT
 17422                                      CM-AH-ITD-AH-PMT
 17423                                      CM-AH-ITD-LUMP-PMT
 17424                                      CM-AH-ITD-CANCEL-AMT
 17425                                      CM-LF-NSP-PREMIUM-AMT
 17426                                      CM-AH-NSP-PREMIUM-AMT.
 17427*                                     CM-CLAIM-DEDUCT-WITHHELD
 17428*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17429     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17430     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17431     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17432     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17433     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17434     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17435     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17436     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17437     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 317
* EL050.cbl
 17438     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17439     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17440     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17441
 17442     IF PB-I-LIVES NOT NUMERIC
 17443         MOVE ZERO                 TO PB-I-LIVES.
 17444
 17445     IF PB-I-NUM-BILLED NOT NUMERIC
 17446         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17447
 17448     MOVE PB-I-LIVES               TO CM-LIVES.
 17449     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17450
 17451     IF PB-COMPANY-ID EQUAL  'DMD'
 17452         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17453         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17454
 17455     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17456     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17457     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17458     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17459     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17460     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17461
 17462     IF PB-I-LF-POLICY-FEE NUMERIC
 17463        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17464     ELSE
 17465        MOVE +0                    TO CM-LF-POLICY-FEE.
 17466
 17467     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17468        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17469        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17470     ELSE
 17471        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17472
 17473     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17474     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17475     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17476     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17477     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17478     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17479     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17480     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17481     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17482
 17483     IF PB-I-AH-POLICY-FEE NUMERIC
 17484        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17485     ELSE
 17486        MOVE +0                    TO CM-AH-POLICY-FEE.
 17487
 17488     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17489        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17490     ELSE
 17491        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17492
 17493     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17494     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17495
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 318
* EL050.cbl
 17496     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17497                                      CM-LF-DEATH-EXIT-DT
 17498                                      CM-AH-SETTLEMENT-EXIT-DT.
 17499
 17500*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17501*                       'TIH' OR 'OFL' OR 'FLA' OR
 17502*                       'TII' OR 'TMS' OR 'CRI' OR
 17503*                       'NCL'
 17504     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17505
 17506     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17507         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17508            MOVE '2'                TO CM-PREMIUM-TYPE.
 17509
 17510     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17511         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17512            MOVE '2'                TO CM-PREMIUM-TYPE.
 17513
 17514     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17515         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17516     ELSE
 17517         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17518         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17519
 17520     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17521     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17522     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17523     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17524     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17525     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17526     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17527     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17528
 17529     IF PB-NO-MONTHS-SKIPPED
 17530         MOVE SPACE                 TO CM-SKIP-CODE
 17531     ELSE
 17532         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17533
 17534     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17535     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17536                                       CM-LF-STATUS-AT-CANCEL.
 17537
 17538     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17539     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17540                                       CM-AH-STATUS-AT-CANCEL.
 17541
 17542     MOVE '1'                       TO CM-ENTRY-STATUS.
 17543
 17544     IF PB-REISSUED-CERT
 17545        MOVE '5'                    TO CM-ENTRY-STATUS.
 17546
 17547     IF PB-MONTHLY-CERT
 17548        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17549
 17550     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17551     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17552     IF PB-POLICY-IS-DECLINED
 17553        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 319
* EL050.cbl
 17554
 17555     IF PB-POLICY-IS-VOIDED
 17556        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17557
 17558     IF PB-NEEDS-UNDERWRITING
 17559        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17560
 17561     IF PB-REIN-ONLY-CERT
 17562        MOVE '9'                    TO CM-ENTRY-STATUS.
 17563
 17564     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17565         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17566     ELSE
 17567         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17568
 17569     IF PB-RECORD-RETURNED
 17570        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17571      ELSE
 17572        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17573
 17574     IF PB-I-MAIL-ADDRS-PRESENT
 17575        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17576
 17577     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17578                                       CM-ENTRY-DT.
 17579
 17580 4999-EXIT.
 17581     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 320
* EL050.cbl
 17583
 17584 5000-PROCESS-REPS.
 17585     MOVE ' '                    TO AGTC-MASTER-SW
 17586     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17587     MOVE CO-TYPE                TO AGTC-TYPE
 17588     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17589     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17590     IF (AGTC-MASTER-SW NOT = 'N')
 17591        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17592        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17593        PERFORM 8583-READ-ERAGTC-NEXT
 17594                                 THRU 8583-EXIT
 17595     END-IF
 17596     IF AGTC-MASTER-SW = 'N'
 17597        CONTINUE
 17598     ELSE
 17599        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17600           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17601              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17602              MOVE 'Y'           TO AGTC-MASTER-SW
 17603           END-IF
 17604        END-IF
 17605     END-IF
 17606     .
 17607 5000-EXIT.
 17608     EXIT.
 17609 6370-EDIT-INPUT-LF-CODE.
 17610     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17611        MOVE +1                  TO SUB
 17612        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17613        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17614        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17615        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17616        GO TO 6370-SEARCH-LOOP.
 17617
 17618     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17619
 17620     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17621     MOVE SPACES                 TO CNTL-ACCESS.
 17622*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17623     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17624     MOVE +0                     TO CNTL-SEQ-NO.
 17625     MOVE '4' TO RC-SW-2.
 17626     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17627
 17628     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17629        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17630        GO TO 6370-NO-LF-FOUND.
 17631
 17632     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17633     MOVE +1                     TO SUB.
 17634
 17635 6370-SEARCH-LOOP.
 17636     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17637         GO TO 6370-NO-LF-FOUND.
 17638
 17639     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17640         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 321
* EL050.cbl
 17641         GO TO 6370-HER-NET-PAY-CHECK.
 17642
 17643     ADD 1   TO SUB.
 17644*    IF SUB GREATER 120
 17645     IF SUB GREATER 200
 17646         GO TO 6370-NO-LF-FOUND.
 17647
 17648     GO TO 6370-SEARCH-LOOP.
 17649
 17650 6370-NO-LF-FOUND.
 17651
 17652     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17653
 17654 6370-HER-NET-PAY-CHECK.
 17655
 17656     IF PB-COMPANY-ID = 'CID'
 17657        IF PB-SV-STATE = 'CA' OR 'MN'
 17658           IF PB-I-LF-BENEFIT-CD = '02'
 17659              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17660           ELSE
 17661              IF PB-I-LF-BENEFIT-CD = '04'
 17662                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17663              END-IF
 17664           END-IF
 17665        END-IF
 17666     END-IF
 17667
 17668     IF PB-COMPANY-ID NOT = 'HER'
 17669         GO TO 6370-EXIT.
 17670
 17671     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17672         GO TO 6370-EXIT.
 17673
 17674     IF PB-I-LF-TERM NOT NUMERIC
 17675         MOVE ZEROS              TO PB-I-LF-TERM.
 17676
 17677     IF PB-I-LOAN-TERM NOT NUMERIC
 17678         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17679
 17680     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17681         GO TO 6370-EXIT.
 17682
 17683     IF PB-I-LF-BENEFIT-CD = '33'
 17684         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17685
 17686     IF PB-I-LF-BENEFIT-CD = '34'
 17687         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17688
 17689 6370-EXIT.
 17690     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 322
* EL050.cbl
 17692
 17693 6380-EDIT-INPUT-AH-CODE.
 17694     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17695        MOVE +1                  TO SUB
 17696        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17697        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17698        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17699        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17700        GO TO 6380-SEARCH-LOOP.
 17701
 17702     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17703
 17704     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17705     MOVE SPACES                 TO CNTL-ACCESS.
 17706     MOVE 'A'                    TO CNTL-REC-TYPE.
 17707*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17708     MOVE +0                     TO CNTL-SEQ-NO.
 17709     MOVE '5' TO RC-SW-2.
 17710     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17711
 17712     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17713        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17714        GO TO 6380-NO-AH-FOUND.
 17715
 17716     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17717     MOVE +1 TO SUB.
 17718
 17719 6380-SEARCH-LOOP.
 17720     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17721         GO TO 6380-NO-AH-FOUND.
 17722
 17723     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17724         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17725         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17726
 17727     ADD 1   TO SUB.
 17728     IF SUB GREATER THAN 96
 17729*    IF SUB GREATER THAN 300
 17730         GO TO 6380-NO-AH-FOUND.
 17731
 17732     GO TO 6380-SEARCH-LOOP.
 17733
 17734 6380-NO-AH-FOUND.
 17735
 17736     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17737
 17738     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17739         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17740     ELSE
 17741         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17742
 17743 6380-CSO-AH-ONLY-CHECKS.
 17744
 17745     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17746        NEXT SENTENCE
 17747      ELSE
 17748        GO TO 6380-EXIT.
 17749
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 323
* EL050.cbl
 17750     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17751         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17752
 17753
 17754     GO TO 6380-EXIT
 17755     .
 17756 6380-CSO-LIFE-WITH-AH-CHECKS.
 17757
 17758
 17759     .
 17760 6380-EXIT.
 17761     EXIT.
 17762
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 324
* EL050.cbl
 17764
 17765 6400-COMPUTE-EXTENSION-DAYS.
 17766
 17767******************************************************************
 17768*                                                                *
 17769*                   COMPUTE EXTENSION DAYS                       *
 17770*                                                                *
 17771*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17772*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17773*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17774*    THE EXTENSION DAYS.                                         *
 17775*                                                                *
 17776******************************************************************
 17777
 17778     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17779     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17780
 17781******************************************************************
 17782*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17783*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17784******************************************************************
 17785
 17786     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17787        COMPUTE WS-ODD-DAYS-OVER =
 17788               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17789     ELSE
 17790        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17791
 17792     IF WS-ODD-DAYS-OVER = ZEROS
 17793           GO TO 6499-EXIT
 17794     ELSE
 17795        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17796           IF WS-WDF-MONTH = 02
 17797              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17798              ADD 2       TO  WS-ODD-DAYS-OVER
 17799              GO TO 6499-EXIT
 17800           ELSE
 17801              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17802                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17803                 GO TO 6499-EXIT
 17804               ELSE
 17805                 GO TO 6499-EXIT
 17806        ELSE
 17807           GO TO 6499-EXIT.
 17808
 17809 6412-CHECK-TO-DAY.
 17810
 17811        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17812           IF WS-WDT-DAY = 28
 17813              ADD 2              TO WS-ODD-DAYS-OVER
 17814           ELSE
 17815              IF WS-WDT-DAY = 29
 17816                 ADD 1           TO WS-ODD-DAYS-OVER
 17817              ELSE
 17818                 NEXT SENTENCE
 17819        ELSE
 17820           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17821              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 325
* EL050.cbl
 17822
 17823     GO TO 6499-EXIT.
 17824
 17825
 17826 6415-CHECK-LEAP-YEAR.
 17827
 17828     IF DC-DAYS-IN-MONTH = 29
 17829        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17830
 17831 6415-EXIT.
 17832     EXIT.
 17833
 17834 6499-EXIT.
 17835      EXIT.
 17836
 17837 6500-END.
 17838     EXIT.
 17839
 17840
 17841******************************************************************
 17842************* PROCEDURE DIVISION FOR EL050 ***********************
 17843********************** ELC50PD END *******************************
 17844
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 326
* EL050.cbl
 17846
 17847**START***********************************************************
 17848*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17849*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17850******************************************************************
 17851*
 17852 6600-GET-STATE-MUNICIPAL-TAX.
 17853
 17854     IF PB-COMPANY-ID NOT = 'DMD'
 17855         GO TO 6640-EXIT.
 17856
 17857     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17858     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17859     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17860*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17861*
 17862***  Y2K PROJ 7744
 17863     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17864     SET BIN-TO-GREG          TO TRUE.
 17865     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17866
 17867     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17868
 17869     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17870     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17871
 17872
 17873* EXEC CICS HANDLE CONDITION
 17874*        INVREQ    (6610-START-BROWSE)
 17875*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17876*        NOTFND    (6630-END-OF-FILE)
 17877*    END-EXEC.
 17878*    MOVE '"$8JI                 ! # #00017860' TO DFHEIV0
 17879     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17881     MOVE X'2320233030303137383630' TO DFHEIV0(25:11)
 17882     CALL 'kxdfhei1' USING DFHEIV0
 17883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17884
 17885
 17886 6610-START-BROWSE.
 17887
 17888
 17889* EXEC CICS HANDLE CONDITION
 17890*        NOTFND    (6630-END-OF-FILE)
 17891*        DISABLED  (6630-ERRESS-PROBLEM)
 17892*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17893*        ENDFILE   (6630-END-OF-FILE)
 17894*    END-EXEC.
 17895*    MOVE '"$IcJ''                ! $ #00017868' TO DFHEIV0
 17896     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17898     MOVE X'2420233030303137383638' TO DFHEIV0(25:11)
 17899     CALL 'kxdfhei1' USING DFHEIV0
 17900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17901
 17902
 17903
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 327
* EL050.cbl
 17904* EXEC CICS STARTBR
 17905*        DATASET (FILE-ID-ERRESS)
 17906*        RIDFLD  (WS-ERRESS-KEY)
 17907*        GTEQ
 17908*    END-EXEC.
 17909     MOVE 0
 17910       TO DFHEIV11
 17911*    MOVE '&,         G          &   #00017875' TO DFHEIV0
 17912     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17914     MOVE X'2020233030303137383735' TO DFHEIV0(25:11)
 17915     CALL 'kxdfhei1' USING DFHEIV0,
 17916           FILE-ID-ERRESS,
 17917           WS-ERRESS-KEY,
 17918           DFHEIV99,
 17919           DFHEIV11,
 17920           DFHEIV99
 17921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17922
 17923
 17924 6620-READ-NEXT-ERRESS-MASTER.
 17925
 17926
 17927* EXEC CICS HANDLE CONDITION
 17928*        NOTFND    (6630-END-OF-FILE)
 17929*        ENDFILE   (6630-END-OF-FILE)
 17930*        DISABLED  (6630-ERRESS-PROBLEM)
 17931*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17932*    END-EXEC.
 17933*    MOVE '"$I''cJ                ! % #00017883' TO DFHEIV0
 17934     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17936     MOVE X'2520233030303137383833' TO DFHEIV0(25:11)
 17937     CALL 'kxdfhei1' USING DFHEIV0
 17938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17939
 17940
 17941
 17942* EXEC CICS READNEXT
 17943*        DATASET (FILE-ID-ERRESS)
 17944*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17945*        RIDFLD  (WS-ERRESS-KEY)
 17946*    END-EXEC.
 17947     MOVE LENGTH OF
 17948      RESIDENT-STATE-TAX-MASTER
 17949       TO DFHEIV12
 17950     MOVE 0
 17951       TO DFHEIV11
 17952*    MOVE '&.IL                  )   #00017890' TO DFHEIV0
 17953     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17954     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17955     MOVE X'2020233030303137383930' TO DFHEIV0(25:11)
 17956     CALL 'kxdfhei1' USING DFHEIV0,
 17957           FILE-ID-ERRESS,
 17958           RESIDENT-STATE-TAX-MASTER,
 17959           DFHEIV12,
 17960           WS-ERRESS-KEY,
 17961           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 328
* EL050.cbl
 17962           DFHEIV11,
 17963           DFHEIV99,
 17964           DFHEIV99
 17965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17966
 17967
 17968     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17969
 17970* EXEC CICS ENDBR
 17971*            DATASET (FILE-ID-ERRESS)
 17972*       END-EXEC
 17973     MOVE 0
 17974       TO DFHEIV11
 17975*    MOVE '&2                    $   #00017897' TO DFHEIV0
 17976     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17977     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17978     MOVE X'2020233030303137383937' TO DFHEIV0(25:11)
 17979     CALL 'kxdfhei1' USING DFHEIV0,
 17980           FILE-ID-ERRESS,
 17981           DFHEIV11,
 17982           DFHEIV99
 17983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17984        GO TO 6630-END-OF-FILE.
 17985
 17986     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17987        NEXT SENTENCE
 17988      ELSE
 17989        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17990
 17991*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17992*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17993*
 17994     MOVE +2                     TO WS-SUB1.
 17995
 17996     IF PB-ISSUE
 17997     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17998        MOVE +1                  TO WS-SUB1.
 17999
 18000     IF PB-CANCELLATION
 18001     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18002        MOVE +1                  TO WS-SUB1.
 18003*
 18004*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18005*
 18006***  Y2K PROJ 7744
 18007     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18008***  Y2K PROJ 7744
 18009
 18010*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18011* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18012* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18013
 18014     ADD 1                    TO WS-YEAR-YY.
 18015
 18016     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18017         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18018                              TO WS-RES-STATE-TAX
 18019         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 329
* EL050.cbl
 18020                              TO WS-RES-MUNI-TAX
 18021     ELSE
 18022         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18023                              TO WS-RES-STATE-TAX
 18024         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18025                              TO WS-RES-MUNI-TAX.
 18026
 18027*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18028
 18029     IF PB-CANCELLATION
 18030         GO TO 6640-CANCEL-TAX.
 18031
 18032     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18033         COMPUTE PB-I-STATE-TAX ROUNDED =
 18034                                   PB-I-LF-PREMIUM-AMT
 18035                                 * WS-RES-STATE-TAX
 18036         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18037                                   PB-I-LF-PREMIUM-AMT
 18038                                 * WS-RES-MUNI-TAX
 18039     ELSE
 18040     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18041         COMPUTE PB-I-STATE-TAX ROUNDED =
 18042                                   PB-I-AH-PREMIUM-AMT
 18043                                 * WS-RES-STATE-TAX
 18044         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18045                                   PB-I-AH-PREMIUM-AMT
 18046                                 * WS-RES-MUNI-TAX.
 18047
 18048
 18049* EXEC CICS ENDBR
 18050*         DATASET (FILE-ID-ERRESS)
 18051*    END-EXEC.
 18052     MOVE 0
 18053       TO DFHEIV11
 18054*    MOVE '&2                    $   #00017964' TO DFHEIV0
 18055     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18056     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18057     MOVE X'2020233030303137393634' TO DFHEIV0(25:11)
 18058     CALL 'kxdfhei1' USING DFHEIV0,
 18059           FILE-ID-ERRESS,
 18060           DFHEIV11,
 18061           DFHEIV99
 18062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18063
 18064
 18065     GO TO 6640-EXIT.
 18066
 18067 6640-CANCEL-TAX.
 18068     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18069
 18070     IF PB-C-LF-CANCEL-AMT > ZEROS
 18071         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18072                                   PB-C-LF-CANCEL-AMT
 18073                                 * WS-RES-STATE-TAX
 18074         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18075                                   PB-C-LF-CANCEL-AMT
 18076                                *  WS-RES-MUNI-TAX
 18077     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 330
* EL050.cbl
 18078     IF PB-C-AH-CANCEL-AMT > ZEROS
 18079         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18080                                   PB-C-AH-CANCEL-AMT
 18081                                 * WS-RES-STATE-TAX
 18082         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18083                                   PB-C-AH-CANCEL-AMT
 18084                                *  WS-RES-MUNI-TAX.
 18085
 18086
 18087* EXEC CICS ENDBR
 18088*         DATASET (FILE-ID-ERRESS)
 18089*    END-EXEC.
 18090     MOVE 0
 18091       TO DFHEIV11
 18092*    MOVE '&2                    $   #00017989' TO DFHEIV0
 18093     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18094     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18095     MOVE X'2020233030303137393839' TO DFHEIV0(25:11)
 18096     CALL 'kxdfhei1' USING DFHEIV0,
 18097           FILE-ID-ERRESS,
 18098           DFHEIV11,
 18099           DFHEIV99
 18100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18101
 18102
 18103     GO TO 6640-EXIT.
 18104
 18105 6630-END-OF-FILE.
 18106     MOVE ER-8002              TO WS-ERROR.
 18107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18108
 18109     GO TO 6640-EXIT.
 18110
 18111 6630-ERRESS-PROBLEM.
 18112     MOVE ER-8044              TO WS-ERROR.
 18113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18114
 18115 6640-EXIT.
 18116     EXIT.
 18117
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 331
* EL050.cbl
 18119 6650-GET-RES-STATE-COMM.
 18120
 18121     IF PB-COMPANY-ID NOT = 'DMD'
 18122         GO TO 6700-COMM-EXIT.
 18123
 18124     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18125     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18126     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18127     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18128     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18129     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18130     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18131
 18132*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18133*
 18134***  Y2K PROJ 7744
 18135     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18136     SET BIN-TO-GREG          TO TRUE.
 18137     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18138
 18139     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18140***  Y2K PROJ 7744
 18141
 18142     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18143
 18144
 18145* EXEC CICS HANDLE CONDITION
 18146*        INVREQ    (6660-START-BROWSE)
 18147*        DISABLED  (6690-ERRESC-PROBLEM)
 18148*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18149*        NOTFND    (6690-END-OF-FILE)
 18150*    END-EXEC.
 18151*    MOVE '"$8cJI                ! & #00018034' TO DFHEIV0
 18152     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18154     MOVE X'2620233030303138303334' TO DFHEIV0(25:11)
 18155     CALL 'kxdfhei1' USING DFHEIV0
 18156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18157
 18158
 18159
 18160* EXEC CICS RESETBR
 18161*        DATASET (FILE-ID-ERRESC)
 18162*        RIDFLD  (WS-ERRESC-KEY)
 18163*    END-EXEC.
 18164     MOVE 0
 18165       TO DFHEIV11
 18166*    MOVE '&4         G          &   #00018041' TO DFHEIV0
 18167     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18168     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18169     MOVE X'2020233030303138303431' TO DFHEIV0(25:11)
 18170     CALL 'kxdfhei1' USING DFHEIV0,
 18171           FILE-ID-ERRESC,
 18172           WS-ERRESC-KEY,
 18173           DFHEIV99,
 18174           DFHEIV11,
 18175           DFHEIV99
 18176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 332
* EL050.cbl
 18177
 18178
 18179 6660-START-BROWSE.
 18180
 18181
 18182* EXEC CICS HANDLE CONDITION
 18183*        NOTFND    (6690-END-OF-FILE)
 18184*        DISABLED  (6690-ERRESC-PROBLEM)
 18185*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18186*        ENDFILE   (6690-END-OF-FILE)
 18187*    END-EXEC.
 18188*    MOVE '"$IcJ''                ! '' #00018048' TO DFHEIV0
 18189     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18191     MOVE X'2720233030303138303438' TO DFHEIV0(25:11)
 18192     CALL 'kxdfhei1' USING DFHEIV0
 18193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18194
 18195
 18196
 18197* EXEC CICS STARTBR
 18198*        DATASET (FILE-ID-ERRESC)
 18199*        RIDFLD  (WS-ERRESC-KEY)
 18200*        GTEQ
 18201*    END-EXEC.
 18202     MOVE 0
 18203       TO DFHEIV11
 18204*    MOVE '&,         G          &   #00018055' TO DFHEIV0
 18205     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18206     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18207     MOVE X'2020233030303138303535' TO DFHEIV0(25:11)
 18208     CALL 'kxdfhei1' USING DFHEIV0,
 18209           FILE-ID-ERRESC,
 18210           WS-ERRESC-KEY,
 18211           DFHEIV99,
 18212           DFHEIV11,
 18213           DFHEIV99
 18214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18215
 18216
 18217     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18218
 18219 6670-READ-NEXT-ERRESC-MASTER.
 18220
 18221
 18222* EXEC CICS HANDLE CONDITION
 18223*        NOTFND    (6690-END-OF-FILE)
 18224*        DISABLED  (6690-ERRESC-PROBLEM)
 18225*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18226*        ENDFILE   (6690-END-OF-FILE)
 18227*    END-EXEC.
 18228*    MOVE '"$IcJ''                ! ( #00018065' TO DFHEIV0
 18229     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18231     MOVE X'2820233030303138303635' TO DFHEIV0(25:11)
 18232     CALL 'kxdfhei1' USING DFHEIV0
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18234
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 333
* EL050.cbl
 18235
 18236
 18237* EXEC CICS READNEXT
 18238*        DATASET (FILE-ID-ERRESC)
 18239*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18240*        RIDFLD  (ERRESC-RECORD-KEY)
 18241*    END-EXEC.
 18242     MOVE LENGTH OF
 18243      ACCOUNT-RESIDENT-ST-COMMISSION
 18244       TO DFHEIV12
 18245     MOVE 0
 18246       TO DFHEIV11
 18247*    MOVE '&.IL                  )   #00018072' TO DFHEIV0
 18248     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18249     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18250     MOVE X'2020233030303138303732' TO DFHEIV0(25:11)
 18251     CALL 'kxdfhei1' USING DFHEIV0,
 18252           FILE-ID-ERRESC,
 18253           ACCOUNT-RESIDENT-ST-COMMISSION,
 18254           DFHEIV12,
 18255           ERRESC-RECORD-KEY,
 18256           DFHEIV99,
 18257           DFHEIV11,
 18258           DFHEIV99,
 18259           DFHEIV99
 18260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18261
 18262
 18263     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18264        NEXT SENTENCE
 18265     ELSE
 18266
 18267* EXEC CICS ENDBR
 18268*            DATASET (FILE-ID-ERRESC)
 18269*       END-EXEC
 18270     MOVE 0
 18271       TO DFHEIV11
 18272*    MOVE '&2                    $   #00018081' TO DFHEIV0
 18273     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18274     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18275     MOVE X'2020233030303138303831' TO DFHEIV0(25:11)
 18276     CALL 'kxdfhei1' USING DFHEIV0,
 18277           FILE-ID-ERRESC,
 18278           DFHEIV11,
 18279           DFHEIV99
 18280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18281        GO TO 6690-END-OF-FILE.
 18282
 18283     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18284
 18285* EXEC CICS ENDBR
 18286*            DATASET (FILE-ID-ERRESC)
 18287*       END-EXEC
 18288     MOVE 0
 18289       TO DFHEIV11
 18290*    MOVE '&2                    $   #00018087' TO DFHEIV0
 18291     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 334
* EL050.cbl
 18293     MOVE X'2020233030303138303837' TO DFHEIV0(25:11)
 18294     CALL 'kxdfhei1' USING DFHEIV0,
 18295           FILE-ID-ERRESC,
 18296           DFHEIV11,
 18297           DFHEIV99
 18298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18299        GO TO 6690-END-OF-FILE.
 18300
 18301     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18302        NEXT SENTENCE
 18303      ELSE
 18304        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18305
 18306* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18307*
 18308     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18309
 18310     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18311
 18312     IF WS-SUB1 > ZERO
 18313         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18314             PERFORM 6680-SET-COMMISSION
 18315         ELSE
 18316             PERFORM 6680-SET-TABLE-CODE.
 18317
 18318
 18319* EXEC CICS ENDBR
 18320*         DATASET (FILE-ID-ERRESC)
 18321*    END-EXEC.
 18322     MOVE 0
 18323       TO DFHEIV11
 18324*    MOVE '&2                    $   #00018109' TO DFHEIV0
 18325     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18326     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18327     MOVE X'2020233030303138313039' TO DFHEIV0(25:11)
 18328     CALL 'kxdfhei1' USING DFHEIV0,
 18329           FILE-ID-ERRESC,
 18330           DFHEIV11,
 18331           DFHEIV99
 18332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18333
 18334
 18335     GO TO 6700-COMM-EXIT.
 18336
 18337 6680-SET-TABLE-CODE.
 18338     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18339        MOVE ZEROS             TO WS-SUB1
 18340     ELSE
 18341* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18342* TO COMPUTE AH COMMISSION.
 18343        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18344        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18345        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18346        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18347        PERFORM 6680-READ-CTBL-TABLE
 18348        IF WS-CTBL-READ-SW NOT = 'Y'
 18349           MOVE ZEROS          TO WS-SUB1.
 18350
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 335
* EL050.cbl
 18351 6680-READ-CTBL-TABLE.
 18352*
 18353* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18354* TO COMPUTE LIFE COMMISSION
 18355
 18356     IF CTBL-SW = '0540'
 18357        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18358        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18359        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18360
 18361     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18362
 18363     IF CTBL-TABLE-FOUND
 18364        IF CTBL-SW = '0530'
 18365             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18366                                    * PB-I-AH-TERM
 18367             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18368             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18369        ELSE
 18370             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18371             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18372             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18373     ELSE
 18374        IF FIRST-TIME-THROUGH
 18375            GO TO 6680-READ-CTBL-TABLE
 18376        ELSE
 18377            MOVE ZEROS         TO WS-SUB1.
 18378
 18379 6680-SET-COMMISSION.
 18380     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18381           MOVE ZEROS          TO WS-SUB1
 18382       ELSE
 18383           MOVE RESC-COMMISSION-PER (WS-SUB)
 18384                               TO WS-COMMISSION
 18385           IF CTBL-SW = '0530'
 18386               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18387           ELSE
 18388               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18389
 18390 6680-SEARCH-CATEGORY.
 18391     ADD +1                   TO WS-SUB.
 18392     IF WS-SUB > +12
 18393         GO TO 6680-EXIT.
 18394
 18395     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18396          MOVE WS-SUB         TO WS-SUB1
 18397          GO TO 6680-EXIT.
 18398
 18399     GO TO 6680-SEARCH-CATEGORY.
 18400
 18401 6680-EXIT.
 18402     EXIT.
 18403
 18404 6690-END-OF-FILE.
 18405     GO TO 6700-COMM-EXIT.
 18406
 18407 6690-ERRESC-PROBLEM.
 18408      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 336
* EL050.cbl
 18409      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18410
 18411      GO TO 6700-COMM-EXIT.
 18412
 18413 6700-COMM-EXIT.
 18414     EXIT.
 18415
 18416 7000-GET-RATE.
 18417
 18418* EXEC CICS LINK
 18419*        PROGRAM    ('ELRATE')
 18420*        COMMAREA   (CALCULATION-PASS-AREA)
 18421*        LENGTH     (CP-COMM-LENGTH)
 18422*    END-EXEC.
 18423     MOVE 'ELRATE' TO DFHEIV1
 18424*    MOVE '."C                   (   #00018195' TO DFHEIV0
 18425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18427     MOVE X'2020233030303138313935' TO DFHEIV0(25:11)
 18428     CALL 'kxdfhei1' USING DFHEIV0,
 18429           DFHEIV1,
 18430           CALCULATION-PASS-AREA,
 18431           CP-COMM-LENGTH,
 18432           DFHEIV99,
 18433           DFHEIV99,
 18434           DFHEIV99,
 18435           DFHEIV99
 18436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18437
 18438
 18439 7000-EXIT.
 18440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 337
* EL050.cbl
 18442 7100-FIND-BENEFIT-IN-STATE.
 18443     MOVE 'N'                    TO BEN-SEARCH-SW.
 18444
 18445     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18446         VARYING SUB3 FROM 1 BY 1 UNTIL
 18447            ((SUB3 GREATER 50) OR
 18448              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18449               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18450
 18451     IF SUB3 NOT = 51
 18452         MOVE 'Y'                TO BEN-SEARCH-SW.
 18453
 18454     GO TO 7199-EXIT.
 18455
 18456 7100-BENEFIT-DUMMY.
 18457
 18458 7100-DUMMY-EXIT.
 18459     EXIT.
 18460
 18461 7199-EXIT.
 18462     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 338
* EL050.cbl
 18464 7200-FIND-BENEFIT.
 18465     MOVE 'N'                    TO BEN-SEARCH-SW.
 18466
 18467     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18468         VARYING SUB3 FROM 1 BY 1 UNTIL
 18469            ((SUB3 GREATER 8) OR
 18470            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18471
 18472     IF SUB3 NOT = 9
 18473         MOVE 'Y'                TO BEN-SEARCH-SW.
 18474
 18475     GO TO 7200-EXIT.
 18476
 18477 7200-BENEFIT-DUMMY.
 18478
 18479 7200-DUMMY-EXIT.
 18480     EXIT.
 18481
 18482 7200-EXIT.
 18483     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 339
* EL050.cbl
 18485 7250-LOOK-FOR-RESCINDED-CLAIM.
 18486     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18487                                    W-CL-COMP-CD.
 18488     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18489                                    W-CL-CERT-NO.
 18490
 18491
 18492* EXEC CICS HANDLE CONDITION
 18493*        NOTFND  (7250-CONTINUE)
 18494*        ENDFILE (7250-CONTINUE)
 18495*    END-EXEC.
 18496*    MOVE '"$I''                  ! ) #00018253' TO DFHEIV0
 18497     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18499     MOVE X'2920233030303138323533' TO DFHEIV0(25:11)
 18500     CALL 'kxdfhei1' USING DFHEIV0
 18501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18502
 18503
 18504
 18505* EXEC CICS IGNORE CONDITION
 18506*        DUPKEY
 18507*    END-EXEC.
 18508*    MOVE '"*$                   !   #00018258' TO DFHEIV0
 18509     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18511     MOVE X'2020233030303138323538' TO DFHEIV0(25:11)
 18512     CALL 'kxdfhei1' USING DFHEIV0
 18513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18514
 18515
 18516
 18517* EXEC CICS STARTBR
 18518*        DATASET   (CLMS-ID)
 18519*        RIDFLD    (ELMSTR-KEY)
 18520*        GENERIC   EQUAL
 18521*        KEYLENGTH (ELMSTR-LENGTH)
 18522*    END-EXEC.
 18523     MOVE 0
 18524       TO DFHEIV11
 18525*    MOVE '&,   KG    E          &   #00018262' TO DFHEIV0
 18526     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18527     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18528     MOVE X'2020233030303138323632' TO DFHEIV0(25:11)
 18529     CALL 'kxdfhei1' USING DFHEIV0,
 18530           CLMS-ID,
 18531           ELMSTR-KEY,
 18532           ELMSTR-LENGTH,
 18533           DFHEIV11,
 18534           DFHEIV99
 18535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18536
 18537
 18538     MOVE 'Y'                    TO W-BROWSE-SW.
 18539
 18540 7250-NEXT-CLAIM.
 18541
 18542
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 340
* EL050.cbl
 18543* EXEC CICS READNEXT
 18544*        DATASET   (CLMS-ID)
 18545*        RIDFLD    (ELMSTR-KEY)
 18546*        SET       (ADDRESS OF CLAIM-MASTER)
 18547*    END-EXEC.
 18548     MOVE 0
 18549       TO DFHEIV11
 18550*    MOVE '&.S                   )   #00018273' TO DFHEIV0
 18551     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18552     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18553     MOVE X'2020233030303138323733' TO DFHEIV0(25:11)
 18554     CALL 'kxdfhei1' USING DFHEIV0,
 18555           CLMS-ID,
 18556           DFHEIV20,
 18557           DFHEIV99,
 18558           ELMSTR-KEY,
 18559           DFHEIV99,
 18560           DFHEIV11,
 18561           DFHEIV99,
 18562           DFHEIV99
 18563     SET ADDRESS OF CLAIM-MASTER TO
 18564         DFHEIV20
 18565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18566
 18567
 18568     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18569        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18570         GO TO 7250-CONTINUE
 18571     END-IF.
 18572
 18573     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18574        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18575        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18576        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18577        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18578         GO TO 7250-NEXT-CLAIM
 18579     END-IF.
 18580
 18581     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18582        OR (CL-CLAIM-TYPE = 'I')
 18583        OR (CL-CLAIM-TYPE = 'G')
 18584          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18585              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18586              GO TO 7250-CONTINUE
 18587          END-IF
 18588     END-IF.
 18589
 18590     GO TO 7250-NEXT-CLAIM.
 18591
 18592 7250-CONTINUE.
 18593
 18594     IF W-BROWSE-SW = 'Y'
 18595
 18596* EXEC CICS ENDBR
 18597*            DATASET   (CLMS-ID)
 18598*        END-EXEC
 18599     MOVE 0
 18600       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 341
* EL050.cbl
 18601*    MOVE '&2                    $   #00018306' TO DFHEIV0
 18602     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18603     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18604     MOVE X'2020233030303138333036' TO DFHEIV0(25:11)
 18605     CALL 'kxdfhei1' USING DFHEIV0,
 18606           CLMS-ID,
 18607           DFHEIV11,
 18608           DFHEIV99
 18609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18610         MOVE 'N' TO W-BROWSE-SW
 18611     END-IF.
 18612
 18613 7250-EXIT.
 18614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 342
* EL050.cbl
 18616 7300-CHECK-FOR-OPEN-CLMS.
 18617
 18618*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18619*    MOVE SPACES                 TO CNTL-ACCESS.
 18620*    MOVE '1'                    TO CNTL-REC-TYPE.
 18621*    MOVE +0                     TO CNTL-SEQ-NO.
 18622
 18623*    MOVE '3'                    TO RC-SW-1.
 18624*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18625
 18626*    IF NOT CF-COMPANY-MASTER
 18627*         PERFORM 0099-COMPANY-NOT-FOUND
 18628*         GO TO 7300-EXIT.
 18629
 18630     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18631                                    W-CL-COMP-CD.
 18632     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18633                                    W-CL-CERT-NO.
 18634
 18635
 18636* EXEC CICS HANDLE CONDITION
 18637*        NOTFND  (7300-CONTINUE)
 18638*        ENDFILE (7300-CONTINUE)
 18639*    END-EXEC.
 18640*    MOVE '"$I''                  ! * #00018334' TO DFHEIV0
 18641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18643     MOVE X'2A20233030303138333334' TO DFHEIV0(25:11)
 18644     CALL 'kxdfhei1' USING DFHEIV0
 18645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18646
 18647
 18648
 18649* EXEC CICS IGNORE CONDITION
 18650*        DUPKEY
 18651*    END-EXEC.
 18652*    MOVE '"*$                   !   #00018339' TO DFHEIV0
 18653     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18655     MOVE X'2020233030303138333339' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0
 18657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18658
 18659
 18660
 18661* EXEC CICS STARTBR
 18662*        DATASET   (CLMS-ID)
 18663*        RIDFLD    (ELMSTR-KEY)
 18664*        GENERIC   EQUAL
 18665*        KEYLENGTH (ELMSTR-LENGTH)
 18666*    END-EXEC.
 18667     MOVE 0
 18668       TO DFHEIV11
 18669*    MOVE '&,   KG    E          &   #00018343' TO DFHEIV0
 18670     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18672     MOVE X'2020233030303138333433' TO DFHEIV0(25:11)
 18673     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 343
* EL050.cbl
 18674           CLMS-ID,
 18675           ELMSTR-KEY,
 18676           ELMSTR-LENGTH,
 18677           DFHEIV11,
 18678           DFHEIV99
 18679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18680
 18681
 18682     MOVE 'Y'                    TO W-BROWSE-SW.
 18683
 18684 7300-NEXT-CLAIM.
 18685
 18686
 18687* EXEC CICS READNEXT
 18688*        DATASET   (CLMS-ID)
 18689*        RIDFLD    (ELMSTR-KEY)
 18690*        SET       (ADDRESS OF CLAIM-MASTER)
 18691*    END-EXEC.
 18692     MOVE 0
 18693       TO DFHEIV11
 18694*    MOVE '&.S                   )   #00018354' TO DFHEIV0
 18695     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18696     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18697     MOVE X'2020233030303138333534' TO DFHEIV0(25:11)
 18698     CALL 'kxdfhei1' USING DFHEIV0,
 18699           CLMS-ID,
 18700           DFHEIV20,
 18701           DFHEIV99,
 18702           ELMSTR-KEY,
 18703           DFHEIV99,
 18704           DFHEIV11,
 18705           DFHEIV99,
 18706           DFHEIV99
 18707     SET ADDRESS OF CLAIM-MASTER TO
 18708         DFHEIV20
 18709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18710
 18711
 18712     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18713        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18714         GO TO 7300-CONTINUE.
 18715
 18716     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18717        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18718        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18719        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18720        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18721         GO TO 7300-NEXT-CLAIM.
 18722
 18723*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18724     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18725        OR (CL-CLAIM-TYPE = 'I')
 18726        OR (CL-CLAIM-TYPE = 'G')
 18727        IF CLAIM-IS-OPEN
 18728           EVALUATE TRUE
 18729             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18730                 MOVE ER-2884      TO WS-ERROR
 18731             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 344
* EL050.cbl
 18732                 MOVE ER-2887      TO WS-ERROR
 18733             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18734                 MOVE ER-2886      TO WS-ERROR
 18735             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18736                 MOVE ER-2888      TO WS-ERROR
 18737             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18738                 MOVE ER-2885      TO WS-ERROR
 18739             WHEN OTHER
 18740                 MOVE ER-2768      TO WS-ERROR
 18741           END-EVALUATE
 18742           IF PB-C-AH-CANCEL-VOIDED OR
 18743              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18744                NOT AH-COVERAGE-CANCELLED)
 18745               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18746               MOVE ER-2768      TO WS-ERROR
 18747           END-IF
 18748           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18749           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18750              PB-FORCE-CODE NOT EQUAL '8'
 18751               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18752           END-IF
 18753           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18754           GO TO 7300-CONTINUE
 18755        ELSE
 18756           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18757*****THIS IS A RESCISSION OR REFORMATION
 18758              IF (AH-COVERAGE-CANCELLED AND
 18759                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18760                    MOVE ER-2890 TO WS-ERROR
 18761                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18762                    GO TO 7300-CONTINUE
 18763              END-IF
 18764           ELSE
 18765              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18766               AND PB-C-AH-CANCEL-DT > SPACES
 18767                 MOVE ER-2756        TO WS-ERROR
 18768                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18769                 GO TO 7300-CONTINUE
 18770              END-IF
 18771           END-IF
 18772        END-IF
 18773     ELSE
 18774*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18775        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18776           IF CLAIM-IS-OPEN
 18777              MOVE ER-2889      TO WS-ERROR
 18778              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18779              GO TO 7300-CONTINUE
 18780           ELSE
 18781              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18782*****THIS IS A RESCISSION OR REFORMATION
 18783                 IF (LF-COVERAGE-CANCELLED AND
 18784                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18785                       MOVE ER-2890 TO WS-ERROR
 18786                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18787                       GO TO 7300-CONTINUE
 18788                 END-IF
 18789              ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 345
* EL050.cbl
 18790                 IF (AH-COVERAGE-CANCELLED AND
 18791                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18792                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18793                    (LF-COVERAGE-CANCELLED AND
 18794                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18795                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18796                       MOVE ER-2965 TO WS-ERROR
 18797                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18798                       GO TO 7300-CONTINUE
 18799                 END-IF
 18800                 IF LF-COVERAGE-CANCELLED
 18801                  IF CL-TOTAL-PAID-AMT > 0
 18802                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18803                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18804                        MOVE ER-2891 TO WS-ERROR
 18805                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18806                        GO TO 7300-CONTINUE
 18807                      END-IF
 18808                    ELSE
 18809                      MOVE ER-2892 TO WS-ERROR
 18810                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18811                      GO TO 7300-CONTINUE
 18812                    END-IF
 18813                  END-IF
 18814                 END-IF
 18815              END-IF
 18816           END-IF
 18817        END-IF
 18818     END-IF
 18819
 18820     GO TO 7300-NEXT-CLAIM.
 18821
 18822 7300-CONTINUE.
 18823
 18824     IF W-BROWSE-SW = 'Y'
 18825
 18826* EXEC CICS ENDBR
 18827*            DATASET   (CLMS-ID)
 18828*        END-EXEC.
 18829     MOVE 0
 18830       TO DFHEIV11
 18831*    MOVE '&2                    $   #00018473' TO DFHEIV0
 18832     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18834     MOVE X'2020233030303138343733' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0,
 18836           CLMS-ID,
 18837           DFHEIV11,
 18838           DFHEIV99
 18839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18840
 18841
 18842 7300-EXIT.
 18843     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 346
* EL050.cbl
 18845
 18846 7400-GET-REMAIN-TERM.
 18847
 18848* EXEC CICS LINK
 18849*        PROGRAM    ('ELRTRM')
 18850*        COMMAREA   (CALCULATION-PASS-AREA)
 18851*        LENGTH     (CP-COMM-LENGTH)
 18852*    END-EXEC.
 18853     MOVE 'ELRTRM' TO DFHEIV1
 18854*    MOVE '."C                   (   #00018482' TO DFHEIV0
 18855     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18857     MOVE X'2020233030303138343832' TO DFHEIV0(25:11)
 18858     CALL 'kxdfhei1' USING DFHEIV0,
 18859           DFHEIV1,
 18860           CALCULATION-PASS-AREA,
 18861           CP-COMM-LENGTH,
 18862           DFHEIV99,
 18863           DFHEIV99,
 18864           DFHEIV99,
 18865           DFHEIV99
 18866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18867
 18868
 18869 7400-EXIT.
 18870     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 347
* EL050.cbl
 18872
 18873 7500-GET-REMAIN-AMOUNT.
 18874
 18875* EXEC CICS LINK
 18876*        PROGRAM    ('ELRAMT')
 18877*        COMMAREA   (CALCULATION-PASS-AREA)
 18878*        LENGTH     (CP-COMM-LENGTH)
 18879*    END-EXEC.
 18880     MOVE 'ELRAMT' TO DFHEIV1
 18881*    MOVE '."C                   (   #00018493' TO DFHEIV0
 18882     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18884     MOVE X'2020233030303138343933' TO DFHEIV0(25:11)
 18885     CALL 'kxdfhei1' USING DFHEIV0,
 18886           DFHEIV1,
 18887           CALCULATION-PASS-AREA,
 18888           CP-COMM-LENGTH,
 18889           DFHEIV99,
 18890           DFHEIV99,
 18891           DFHEIV99,
 18892           DFHEIV99
 18893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18894
 18895
 18896 7500-EXIT.
 18897     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 348
* EL050.cbl
 18899
 18900 7600-GET-REFUND.
 18901
 18902* EXEC CICS LINK
 18903*        PROGRAM    ('ELRFND')
 18904*        COMMAREA   (CALCULATION-PASS-AREA)
 18905*        LENGTH     (CP-COMM-LENGTH)
 18906*    END-EXEC.
 18907     MOVE 'ELRFND' TO DFHEIV1
 18908*    MOVE '."C                   (   #00018504' TO DFHEIV0
 18909     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18911     MOVE X'2020233030303138353034' TO DFHEIV0(25:11)
 18912     CALL 'kxdfhei1' USING DFHEIV0,
 18913           DFHEIV1,
 18914           CALCULATION-PASS-AREA,
 18915           CP-COMM-LENGTH,
 18916           DFHEIV99,
 18917           DFHEIV99,
 18918           DFHEIV99,
 18919           DFHEIV99
 18920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18921
 18922
 18923 7600-EXIT.
 18924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 349
* EL050.cbl
 18926 7700-CALL-DL1.
 18927
 18928* EXEC CICS LINK
 18929*        PROGRAM    ('DLO001')
 18930*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18931*        LENGTH     (DLO001-COMM-LENGTH)
 18932*    END-EXEC.
 18933     MOVE 'DLO001' TO DFHEIV1
 18934*    MOVE '."C                   (   #00018514' TO DFHEIV0
 18935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18937     MOVE X'2020233030303138353134' TO DFHEIV0(25:11)
 18938     CALL 'kxdfhei1' USING DFHEIV0,
 18939           DFHEIV1,
 18940           WS-DLO-MASTER-POLICY-FORM,
 18941           DLO001-COMM-LENGTH,
 18942           DFHEIV99,
 18943           DFHEIV99,
 18944           DFHEIV99,
 18945           DFHEIV99
 18946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18947
 18948
 18949 7700-EXIT.
 18950     EXIT.
 18951
 18952 7710-CALL-DL2.
 18953
 18954* EXEC CICS LINK
 18955*        PROGRAM    ('DLO002')
 18956*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18957*        LENGTH     (DLO002-COMM-LENGTH)
 18958*    END-EXEC.
 18959     MOVE 'DLO002' TO DFHEIV1
 18960*    MOVE '."C                   (   #00018524' TO DFHEIV0
 18961     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18962     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18963     MOVE X'2020233030303138353234' TO DFHEIV0(25:11)
 18964     CALL 'kxdfhei1' USING DFHEIV0,
 18965           DFHEIV1,
 18966           WS-DLO-INTERNAL-POLICY-FORM,
 18967           DLO002-COMM-LENGTH,
 18968           DFHEIV99,
 18969           DFHEIV99,
 18970           DFHEIV99,
 18971           DFHEIV99
 18972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18973
 18974
 18975 7710-EXIT.
 18976     EXIT.
 18977
 18978 7720-CALL-DL3.
 18979
 18980* EXEC CICS LINK
 18981*        PROGRAM    ('DLO003')
 18982*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18983*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 350
* EL050.cbl
 18984*    END-EXEC.
 18985     MOVE 'DLO003' TO DFHEIV1
 18986*    MOVE '."C                   (   #00018534' TO DFHEIV0
 18987     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18989     MOVE X'2020233030303138353334' TO DFHEIV0(25:11)
 18990     CALL 'kxdfhei1' USING DFHEIV0,
 18991           DFHEIV1,
 18992           WS-DLO-VALID-BANK-ID,
 18993           DLO003-COMM-LENGTH,
 18994           DFHEIV99,
 18995           DFHEIV99,
 18996           DFHEIV99,
 18997           DFHEIV99
 18998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18999
 19000
 19001 7720-EXIT.
 19002     EXIT.
 19003
 19004 7730-CALL-DL7.
 19005
 19006* EXEC CICS LINK
 19007*        PROGRAM    ('DLO007')
 19008*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19009*        LENGTH     (DLO007-COMM-LENGTH)
 19010*    END-EXEC.
 19011     MOVE 'DLO007' TO DFHEIV1
 19012*    MOVE '."C                   (   #00018544' TO DFHEIV0
 19013     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19014     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19015     MOVE X'2020233030303138353434' TO DFHEIV0(25:11)
 19016     CALL 'kxdfhei1' USING DFHEIV0,
 19017           DFHEIV1,
 19018           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19019           DLO007-COMM-LENGTH,
 19020           DFHEIV99,
 19021           DFHEIV99,
 19022           DFHEIV99,
 19023           DFHEIV99
 19024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19025
 19026
 19027 7730-EXIT.
 19028     EXIT.
 19029
 19030 7740-CALL-DL11.
 19031
 19032* EXEC CICS LINK
 19033*        PROGRAM    ('DLO011')
 19034*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19035*        LENGTH     (DLO011-COMM-LENGTH)
 19036*    END-EXEC.
 19037     MOVE 'DLO011' TO DFHEIV1
 19038*    MOVE '."C                   (   #00018554' TO DFHEIV0
 19039     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19041     MOVE X'2020233030303138353534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 351
* EL050.cbl
 19042     CALL 'kxdfhei1' USING DFHEIV0,
 19043           DFHEIV1,
 19044           WS-DLO-PREM-RATES-BEN-TYPE,
 19045           DLO011-COMM-LENGTH,
 19046           DFHEIV99,
 19047           DFHEIV99,
 19048           DFHEIV99,
 19049           DFHEIV99
 19050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19051
 19052
 19053 7740-EXIT.
 19054     EXIT.
 19055
 19056 7750-CALL-DL17.
 19057
 19058* EXEC CICS LINK
 19059*        PROGRAM    ('DLO017')
 19060*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19061*        LENGTH     (DLO017-COMM-LENGTH)
 19062*    END-EXEC.
 19063     MOVE 'DLO017' TO DFHEIV1
 19064*    MOVE '."C                   (   #00018564' TO DFHEIV0
 19065     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19067     MOVE X'2020233030303138353634' TO DFHEIV0(25:11)
 19068     CALL 'kxdfhei1' USING DFHEIV0,
 19069           DFHEIV1,
 19070           WS-DLO-VALID-RATE-CODE,
 19071           DLO017-COMM-LENGTH,
 19072           DFHEIV99,
 19073           DFHEIV99,
 19074           DFHEIV99,
 19075           DFHEIV99
 19076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19077
 19078
 19079 7750-EXIT.
 19080     EXIT.
 19081
 19082 7755-CALL-DL19.
 19083
 19084* EXEC CICS LINK
 19085*        PROGRAM    ('DLO019')
 19086*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19087*        LENGTH     (DLO019-COMM-LENGTH)
 19088*    END-EXEC.
 19089     MOVE 'DLO019' TO DFHEIV1
 19090*    MOVE '."C                   (   #00018574' TO DFHEIV0
 19091     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19093     MOVE X'2020233030303138353734' TO DFHEIV0(25:11)
 19094     CALL 'kxdfhei1' USING DFHEIV0,
 19095           DFHEIV1,
 19096           WS-DLO-ORIG-COV-CAT,
 19097           DLO019-COMM-LENGTH,
 19098           DFHEIV99,
 19099           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 352
* EL050.cbl
 19100           DFHEIV99,
 19101           DFHEIV99
 19102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19103
 19104
 19105 7755-EXIT.
 19106     EXIT.
 19107
 19108 7760-CALL-DL21.
 19109
 19110* EXEC CICS LINK
 19111*        PROGRAM    ('DLO021')
 19112*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19113*        LENGTH     (DLO021-COMM-LENGTH)
 19114*    END-EXEC.
 19115     MOVE 'DLO021' TO DFHEIV1
 19116*    MOVE '."C                   (   #00018584' TO DFHEIV0
 19117     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19119     MOVE X'2020233030303138353834' TO DFHEIV0(25:11)
 19120     CALL 'kxdfhei1' USING DFHEIV0,
 19121           DFHEIV1,
 19122           WS-DLO-VALID-LOAN-OFFICER,
 19123           DLO021-COMM-LENGTH,
 19124           DFHEIV99,
 19125           DFHEIV99,
 19126           DFHEIV99,
 19127           DFHEIV99
 19128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19129
 19130
 19131 7760-EXIT.
 19132     EXIT.
 19133
 19134 7770-CALL-DL22.
 19135
 19136* EXEC CICS LINK
 19137*        PROGRAM    ('DLO022')
 19138*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19139*        LENGTH     (DLO022-COMM-LENGTH)
 19140*    END-EXEC.
 19141     MOVE 'DLO022' TO DFHEIV1
 19142*    MOVE '."C                   (   #00018594' TO DFHEIV0
 19143     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19145     MOVE X'2020233030303138353934' TO DFHEIV0(25:11)
 19146     CALL 'kxdfhei1' USING DFHEIV0,
 19147           DFHEIV1,
 19148           WS-DLO-VALID-STATE-CODE,
 19149           DLO022-COMM-LENGTH,
 19150           DFHEIV99,
 19151           DFHEIV99,
 19152           DFHEIV99,
 19153           DFHEIV99
 19154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19155
 19156
 19157 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 353
* EL050.cbl
 19158     EXIT.
 19159
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 354
* EL050.cbl
 19161
 19162 7800-REWRITE-CERT.
 19163******************************************************************
 19164*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19165*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19166******************************************************************
 19167
 19168     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19169        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19170        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19171        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19172
 19173* EXEC CICS REWRITE
 19174*                  DATASET (CERT-ID)
 19175*                  FROM    (CERTIFICATE-MASTER)
 19176*              END-EXEC
 19177     MOVE LENGTH OF
 19178      CERTIFICATE-MASTER
 19179       TO DFHEIV11
 19180*    MOVE '&& L                  %   #00018615' TO DFHEIV0
 19181     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19182     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19183     MOVE X'2020233030303138363135' TO DFHEIV0(25:11)
 19184     CALL 'kxdfhei1' USING DFHEIV0,
 19185           CERT-ID,
 19186           CERTIFICATE-MASTER,
 19187           DFHEIV11,
 19188           DFHEIV99
 19189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19190        GO TO 7800-EXIT.
 19191
 19192       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19193       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19194
 19195 7800-EXIT.
 19196      EXIT.
 19197
 19198 7900-DELETE-CERT.
 19199
 19200* EXEC CICS DELETE
 19201*        DATASET (CERT-ID)
 19202*    END-EXEC.
 19203*    MOVE '&(                    &   #00018628' TO DFHEIV0
 19204     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19205     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19206     MOVE X'2020233030303138363238' TO DFHEIV0(25:11)
 19207     CALL 'kxdfhei1' USING DFHEIV0,
 19208           CERT-ID,
 19209           DFHEIV99,
 19210           DFHEIV99,
 19211           DFHEIV99,
 19212           DFHEIV99
 19213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19214
 19215
 19216 7900-EXIT.
 19217     EXIT.
 19218
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 355
* EL050.cbl
 19219 8000-WRITE-CERT.
 19220
 19221* EXEC CICS HANDLE CONDITION
 19222*        DUPKEY    (8000-FREE-MAIN)
 19223*    END-EXEC.
 19224*    MOVE '"$$                   ! + #00018636' TO DFHEIV0
 19225     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19227     MOVE X'2B20233030303138363336' TO DFHEIV0(25:11)
 19228     CALL 'kxdfhei1' USING DFHEIV0
 19229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19230
 19231
 19232
 19233* EXEC CICS WRITE
 19234*        DATASET     (CERT-ID)
 19235*        FROM        (CERTIFICATE-MASTER)
 19236*        RIDFLD      (ELCERT-KEY)
 19237*    END-EXEC.
 19238     MOVE LENGTH OF
 19239      CERTIFICATE-MASTER
 19240       TO DFHEIV11
 19241*    MOVE '&$ L                  ''   #00018640' TO DFHEIV0
 19242     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19243     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19244     MOVE X'2020233030303138363430' TO DFHEIV0(25:11)
 19245     CALL 'kxdfhei1' USING DFHEIV0,
 19246           CERT-ID,
 19247           CERTIFICATE-MASTER,
 19248           DFHEIV11,
 19249           ELCERT-KEY,
 19250           DFHEIV99,
 19251           DFHEIV99
 19252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19253
 19254
 19255 8000-FREE-MAIN.
 19256
 19257 8000-EXIT.
 19258      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 356
* EL050.cbl
 19260
 19261 8100-READ-ERPNDM.
 19262
 19263* EXEC CICS HANDLE CONDITION
 19264*         NOTFND     (8100-NOTFND)
 19265*         ENDFILE    (8100-NOTFND)
 19266*    END-EXEC.
 19267*    MOVE '"$I''                  ! , #00018653' TO DFHEIV0
 19268     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19269     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19270     MOVE X'2C20233030303138363533' TO DFHEIV0(25:11)
 19271     CALL 'kxdfhei1' USING DFHEIV0
 19272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19273
 19274
 19275     MOVE SPACES                 TO ERPNDM-FOUND.
 19276     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19277
 19278
 19279* EXEC CICS READ
 19280*         DATASET   (FILE-ERPNDM)
 19281*         RIDFLD    (PM-CONTROL-PRIMARY)
 19282*         INTO      (PENDING-MAILING-DATA)
 19283*    END-EXEC.
 19284     MOVE LENGTH OF
 19285      PENDING-MAILING-DATA
 19286       TO DFHEIV11
 19287*    MOVE '&"IL       E          (   #00018661' TO DFHEIV0
 19288     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19290     MOVE X'2020233030303138363631' TO DFHEIV0(25:11)
 19291     CALL 'kxdfhei1' USING DFHEIV0,
 19292           FILE-ERPNDM,
 19293           PENDING-MAILING-DATA,
 19294           DFHEIV11,
 19295           PM-CONTROL-PRIMARY,
 19296           DFHEIV99,
 19297           DFHEIV99,
 19298           DFHEIV99
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19300
 19301
 19302     GO TO 8100-EXIT.
 19303
 19304 8100-NOTFND.
 19305
 19306     MOVE 'X'                    TO ERPNDM-FOUND.
 19307     MOVE ER-2694                TO WS-ERROR.
 19308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19309     MOVE ER-2883                TO WS-ERROR
 19310     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19311     .
 19312 8100-EXIT.
 19313     EXIT.
 19314
 19315 8110-READ-ERMAIL.
 19316
 19317* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 357
* EL050.cbl
 19318*         NOTFND     (8110-NOTFND)
 19319*         ENDFILE    (8110-NOTFND)
 19320*    END-EXEC.
 19321*    MOVE '"$I''                  ! - #00018681' TO DFHEIV0
 19322     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19324     MOVE X'2D20233030303138363831' TO DFHEIV0(25:11)
 19325     CALL 'kxdfhei1' USING DFHEIV0
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329     MOVE SPACES                 TO ERMAIL-FOUND.
 19330     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19331     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19332     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19333     MOVE PB-SV-STATE            TO MA-STATE.
 19334
 19335
 19336* EXEC CICS READ
 19337*         UPDATE
 19338*         DATASET   (FILE-ERMAIL)
 19339*         RIDFLD    (MA-CONTROL-PRIMARY)
 19340*         INTO      (MAILING-DATA)
 19341*    END-EXEC.
 19342     MOVE LENGTH OF
 19343      MAILING-DATA
 19344       TO DFHEIV11
 19345*    MOVE '&"IL       EU         (   #00018692' TO DFHEIV0
 19346     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19347     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19348     MOVE X'2020233030303138363932' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0,
 19350           FILE-ERMAIL,
 19351           MAILING-DATA,
 19352           DFHEIV11,
 19353           MA-CONTROL-PRIMARY,
 19354           DFHEIV99,
 19355           DFHEIV99,
 19356           DFHEIV99
 19357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19358
 19359
 19360     GO TO 8110-EXIT.
 19361
 19362 8110-NOTFND.
 19363     MOVE 'X'                    TO ERMAIL-FOUND.
 19364
 19365 8110-EXIT.
 19366     EXIT.
 19367
 19368 8120-REWRITE-ERMAIL.
 19369
 19370* EXEC CICS REWRITE
 19371*         DATASET    (FILE-ERMAIL)
 19372*         FROM       (MAILING-DATA)
 19373*    END-EXEC.
 19374     MOVE LENGTH OF
 19375      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 358
* EL050.cbl
 19376       TO DFHEIV11
 19377*    MOVE '&& L                  %   #00018708' TO DFHEIV0
 19378     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19379     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19380     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 19381     CALL 'kxdfhei1' USING DFHEIV0,
 19382           FILE-ERMAIL,
 19383           MAILING-DATA,
 19384           DFHEIV11,
 19385           DFHEIV99
 19386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19387
 19388
 19389 8120-EXIT.
 19390     EXIT.
 19391
 19392 8130-WRITE-ERMAIL.
 19393
 19394* EXEC CICS HANDLE CONDITION
 19395*         DUPKEY   (8130-EXIT)
 19396*    END-EXEC.
 19397*    MOVE '"$$                   ! . #00018717' TO DFHEIV0
 19398     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19400     MOVE X'2E20233030303138373137' TO DFHEIV0(25:11)
 19401     CALL 'kxdfhei1' USING DFHEIV0
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19403
 19404
 19405
 19406* EXEC CICS WRITE
 19407*         DATASET     (FILE-ERMAIL)
 19408*         RIDFLD      (MA-CONTROL-PRIMARY)
 19409*         FROM        (MAILING-DATA)
 19410*    END-EXEC.
 19411     MOVE LENGTH OF
 19412      MAILING-DATA
 19413       TO DFHEIV11
 19414*    MOVE '&$ L                  ''   #00018721' TO DFHEIV0
 19415     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19416     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19417     MOVE X'2020233030303138373231' TO DFHEIV0(25:11)
 19418     CALL 'kxdfhei1' USING DFHEIV0,
 19419           FILE-ERMAIL,
 19420           MAILING-DATA,
 19421           DFHEIV11,
 19422           MA-CONTROL-PRIMARY,
 19423           DFHEIV99,
 19424           DFHEIV99
 19425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19426
 19427
 19428 8130-EXIT.
 19429     EXIT.
 19430
 19431 8140-UNLOCK-ERMAIL.
 19432
 19433* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 359
* EL050.cbl
 19434*         DATASET   (FILE-ERMAIL)
 19435*    END-EXEC.
 19436*    MOVE '&*                    #   #00018731' TO DFHEIV0
 19437     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19438     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19439     MOVE X'2020233030303138373331' TO DFHEIV0(25:11)
 19440     CALL 'kxdfhei1' USING DFHEIV0,
 19441           FILE-ERMAIL,
 19442           DFHEIV99
 19443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19444
 19445
 19446 8140-EXIT.
 19447     EXIT.
 19448
 19449 8180-UPDATE-VIN-NUMBER.
 19450
 19451* EXEC CICS HANDLE CONDITION
 19452*        NOTFND   (8180-NOTFND)
 19453*    END-EXEC.
 19454*    MOVE '"$I                   ! / #00018739' TO DFHEIV0
 19455     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19457     MOVE X'2F20233030303138373339' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0
 19459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19460
 19461
 19462     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19463     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19464
 19465
 19466* EXEC CICS READ
 19467*        UPDATE
 19468*        DATASET  (CRTT-ID)
 19469*        RIDFLD   (WS-ELCRTT-KEY)
 19470*        INTO     (CERTIFICATE-TRAILERS)
 19471*    END-EXEC.
 19472     MOVE LENGTH OF
 19473      CERTIFICATE-TRAILERS
 19474       TO DFHEIV11
 19475*    MOVE '&"IL       EU         (   #00018746' TO DFHEIV0
 19476     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19478     MOVE X'2020233030303138373436' TO DFHEIV0(25:11)
 19479     CALL 'kxdfhei1' USING DFHEIV0,
 19480           CRTT-ID,
 19481           CERTIFICATE-TRAILERS,
 19482           DFHEIV11,
 19483           WS-ELCRTT-KEY,
 19484           DFHEIV99,
 19485           DFHEIV99,
 19486           DFHEIV99
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
 19489
 19490     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19491         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 360
* EL050.cbl
 19492
 19493* EXEC CICS REWRITE
 19494*           DATASET  (CRTT-ID)
 19495*           FROM     (CERTIFICATE-TRAILERS)
 19496*        END-EXEC
 19497     MOVE LENGTH OF
 19498      CERTIFICATE-TRAILERS
 19499       TO DFHEIV11
 19500*    MOVE '&& L                  %   #00018755' TO DFHEIV0
 19501     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19502     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19503     MOVE X'2020233030303138373535' TO DFHEIV0(25:11)
 19504     CALL 'kxdfhei1' USING DFHEIV0,
 19505           CRTT-ID,
 19506           CERTIFICATE-TRAILERS,
 19507           DFHEIV11,
 19508           DFHEIV99
 19509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19510     ELSE
 19511
 19512* EXEC CICS UNLOCK
 19513*          DATASET  (CRTT-ID)
 19514*       END-EXEC
 19515*    MOVE '&*                    #   #00018760' TO DFHEIV0
 19516     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19517     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19518     MOVE X'2020233030303138373630' TO DFHEIV0(25:11)
 19519     CALL 'kxdfhei1' USING DFHEIV0,
 19520           CRTT-ID,
 19521           DFHEIV99
 19522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19523     END-IF.
 19524
 19525     GO TO 8180-EXIT.
 19526
 19527 8180-NOTFND.
 19528
 19529     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19530     MOVE 'CS'         TO CS-RECORD-ID.
 19531     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19532     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19533     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19534     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19535
 19536* EXEC CICS WRITE
 19537*       DATASET  (CRTT-ID)
 19538*       RIDFLD   (WS-ELCRTT-KEY)
 19539*       FROM     (CERTIFICATE-TRAILERS)
 19540*    END-EXEC.
 19541     MOVE LENGTH OF
 19542      CERTIFICATE-TRAILERS
 19543       TO DFHEIV11
 19544*    MOVE '&$ L                  ''   #00018775' TO DFHEIV0
 19545     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19546     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19547     MOVE X'2020233030303138373735' TO DFHEIV0(25:11)
 19548     CALL 'kxdfhei1' USING DFHEIV0,
 19549           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 361
* EL050.cbl
 19550           CERTIFICATE-TRAILERS,
 19551           DFHEIV11,
 19552           WS-ELCRTT-KEY,
 19553           DFHEIV99,
 19554           DFHEIV99
 19555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19556
 19557
 19558 8180-EXIT.
 19559     EXIT.
 19560
 19561 8190-UPDATE-REFUND-CLAIM-FLAG.
 19562
 19563* EXEC CICS HANDLE CONDITION
 19564*        NOTFND   (8190-NOTFND)
 19565*    END-EXEC.
 19566*    MOVE '"$I                   ! 0 #00018785' TO DFHEIV0
 19567     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19569     MOVE X'3020233030303138373835' TO DFHEIV0(25:11)
 19570     CALL 'kxdfhei1' USING DFHEIV0
 19571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19572
 19573
 19574     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19575     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19576
 19577
 19578* EXEC CICS READ
 19579*        UPDATE
 19580*        DATASET  (CRTT-ID)
 19581*        RIDFLD   (WS-ELCRTT-KEY)
 19582*        INTO     (CERTIFICATE-TRAILERS)
 19583*    END-EXEC.
 19584     MOVE LENGTH OF
 19585      CERTIFICATE-TRAILERS
 19586       TO DFHEIV11
 19587*    MOVE '&"IL       EU         (   #00018792' TO DFHEIV0
 19588     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19589     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19590     MOVE X'2020233030303138373932' TO DFHEIV0(25:11)
 19591     CALL 'kxdfhei1' USING DFHEIV0,
 19592           CRTT-ID,
 19593           CERTIFICATE-TRAILERS,
 19594           DFHEIV11,
 19595           WS-ELCRTT-KEY,
 19596           DFHEIV99,
 19597           DFHEIV99,
 19598           DFHEIV99
 19599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19600
 19601
 19602     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19603
 19604* EXEC CICS REWRITE
 19605*       DATASET  (CRTT-ID)
 19606*       FROM     (CERTIFICATE-TRAILERS)
 19607*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 362
* EL050.cbl
 19608     MOVE LENGTH OF
 19609      CERTIFICATE-TRAILERS
 19610       TO DFHEIV11
 19611*    MOVE '&& L                  %   #00018800' TO DFHEIV0
 19612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19614     MOVE X'2020233030303138383030' TO DFHEIV0(25:11)
 19615     CALL 'kxdfhei1' USING DFHEIV0,
 19616           CRTT-ID,
 19617           CERTIFICATE-TRAILERS,
 19618           DFHEIV11,
 19619           DFHEIV99
 19620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19621
 19622
 19623     GO TO 8190-EXIT.
 19624
 19625 8190-NOTFND.
 19626
 19627     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19628     MOVE 'CS'         TO CS-RECORD-ID.
 19629     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19630     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19631     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19632     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19633
 19634* EXEC CICS WRITE
 19635*       DATASET  (CRTT-ID)
 19636*       RIDFLD   (WS-ELCRTT-KEY)
 19637*       FROM     (CERTIFICATE-TRAILERS)
 19638*    END-EXEC.
 19639     MOVE LENGTH OF
 19640      CERTIFICATE-TRAILERS
 19641       TO DFHEIV11
 19642*    MOVE '&$ L                  ''   #00018815' TO DFHEIV0
 19643     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19644     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19645     MOVE X'2020233030303138383135' TO DFHEIV0(25:11)
 19646     CALL 'kxdfhei1' USING DFHEIV0,
 19647           CRTT-ID,
 19648           CERTIFICATE-TRAILERS,
 19649           DFHEIV11,
 19650           WS-ELCRTT-KEY,
 19651           DFHEIV99,
 19652           DFHEIV99
 19653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19654
 19655
 19656 8190-EXIT.
 19657     EXIT.
 19658
 19659 8195-UPDATE-AGE-FLAGS.
 19660
 19661* EXEC CICS HANDLE CONDITION
 19662*        NOTFND   (8195-NOTFND)
 19663*    END-EXEC.
 19664*    MOVE '"$I                   ! 1 #00018825' TO DFHEIV0
 19665     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 363
* EL050.cbl
 19666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19667     MOVE X'3120233030303138383235' TO DFHEIV0(25:11)
 19668     CALL 'kxdfhei1' USING DFHEIV0
 19669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19670
 19671
 19672     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19673     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19674
 19675
 19676* EXEC CICS READ
 19677*        UPDATE
 19678*        DATASET  (CRTT-ID)
 19679*        RIDFLD   (WS-ELCRTT-KEY)
 19680*        INTO     (CERTIFICATE-TRAILERS)
 19681*    END-EXEC.
 19682     MOVE LENGTH OF
 19683      CERTIFICATE-TRAILERS
 19684       TO DFHEIV11
 19685*    MOVE '&"IL       EU         (   #00018832' TO DFHEIV0
 19686     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19687     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19688     MOVE X'2020233030303138383332' TO DFHEIV0(25:11)
 19689     CALL 'kxdfhei1' USING DFHEIV0,
 19690           CRTT-ID,
 19691           CERTIFICATE-TRAILERS,
 19692           DFHEIV11,
 19693           WS-ELCRTT-KEY,
 19694           DFHEIV99,
 19695           DFHEIV99,
 19696           DFHEIV99
 19697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19698
 19699
 19700     IF WS-INS-AGE-SET = 'Y'
 19701        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19702     END-IF
 19703     IF WS-JNT-AGE-SET = 'Y'
 19704        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19705     END-IF
 19706
 19707
 19708* EXEC CICS REWRITE
 19709*       DATASET  (CRTT-ID)
 19710*       FROM     (CERTIFICATE-TRAILERS)
 19711*    END-EXEC.
 19712     MOVE LENGTH OF
 19713      CERTIFICATE-TRAILERS
 19714       TO DFHEIV11
 19715*    MOVE '&& L                  %   #00018846' TO DFHEIV0
 19716     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19717     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19718     MOVE X'2020233030303138383436' TO DFHEIV0(25:11)
 19719     CALL 'kxdfhei1' USING DFHEIV0,
 19720           CRTT-ID,
 19721           CERTIFICATE-TRAILERS,
 19722           DFHEIV11,
 19723           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 364
* EL050.cbl
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727     GO TO 8195-EXIT.
 19728
 19729 8195-NOTFND.
 19730
 19731     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19732     MOVE 'CS'         TO CS-RECORD-ID.
 19733     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19734     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19735     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19736     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19737     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19738
 19739* EXEC CICS WRITE
 19740*       DATASET  (CRTT-ID)
 19741*       RIDFLD   (WS-ELCRTT-KEY)
 19742*       FROM     (CERTIFICATE-TRAILERS)
 19743*    END-EXEC.
 19744     MOVE LENGTH OF
 19745      CERTIFICATE-TRAILERS
 19746       TO DFHEIV11
 19747*    MOVE '&$ L                  ''   #00018862' TO DFHEIV0
 19748     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19749     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19750     MOVE X'2020233030303138383632' TO DFHEIV0(25:11)
 19751     CALL 'kxdfhei1' USING DFHEIV0,
 19752           CRTT-ID,
 19753           CERTIFICATE-TRAILERS,
 19754           DFHEIV11,
 19755           WS-ELCRTT-KEY,
 19756           DFHEIV99,
 19757           DFHEIV99
 19758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19759
 19760
 19761 8195-EXIT.
 19762     EXIT.
 19763
 19764 8200-READ-REIN-TABLE.
 19765
 19766* EXEC CICS HANDLE CONDITION
 19767*         NOTFND   (8200-NOTFND)
 19768*    END-EXEC.
 19769*    MOVE '"$I                   ! 2 #00018872' TO DFHEIV0
 19770     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19772     MOVE X'3220233030303138383732' TO DFHEIV0(25:11)
 19773     CALL 'kxdfhei1' USING DFHEIV0
 19774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19775
 19776
 19777
 19778* EXEC CICS READ
 19779*        DATASET     (REIN-ID)
 19780*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19781*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 365
* EL050.cbl
 19782*    END-EXEC.
 19783*    MOVE '&"S        E          (   #00018876' TO DFHEIV0
 19784     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19785     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19786     MOVE X'2020233030303138383736' TO DFHEIV0(25:11)
 19787     CALL 'kxdfhei1' USING DFHEIV0,
 19788           REIN-ID,
 19789           DFHEIV20,
 19790           DFHEIV99,
 19791           ERREIN-KEY,
 19792           DFHEIV99,
 19793           DFHEIV99,
 19794           DFHEIV99
 19795     SET ADDRESS OF REINSURANCE-RECORD TO
 19796         DFHEIV20
 19797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19798
 19799
 19800     GO TO 8200-EXIT.
 19801
 19802 8200-NOTFND.
 19803     MOVE 'N'             TO WS-REIN-READ-SW.
 19804
 19805 8200-EXIT.
 19806      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 366
* EL050.cbl
 19808
 19809 8300-READ-CTBL-TABLE.
 19810
 19811* EXEC CICS HANDLE CONDITION
 19812*        NOTFND    (8300-NOTFND)
 19813*        DISABLED  (8300-ERRESS-PROBLEM)
 19814*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19815*        ENDFILE   (8300-NOTFND)
 19816*    END-EXEC.
 19817*    MOVE '"$IcJ''                ! 3 #00018892' TO DFHEIV0
 19818     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19820     MOVE X'3320233030303138383932' TO DFHEIV0(25:11)
 19821     CALL 'kxdfhei1' USING DFHEIV0
 19822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19823
 19824
 19825
 19826* EXEC CICS READ
 19827*        DATASET     (CTBL-ID)
 19828*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19829*        RIDFLD      (ERCTBL-KEY)
 19830*    END-EXEC.
 19831*    MOVE '&"S        E          (   #00018899' TO DFHEIV0
 19832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19834     MOVE X'2020233030303138383939' TO DFHEIV0(25:11)
 19835     CALL 'kxdfhei1' USING DFHEIV0,
 19836           CTBL-ID,
 19837           DFHEIV20,
 19838           DFHEIV99,
 19839           ERCTBL-KEY,
 19840           DFHEIV99,
 19841           DFHEIV99,
 19842           DFHEIV99
 19843     SET ADDRESS OF COMM-TABLE-RECORD TO
 19844         DFHEIV20
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19846
 19847
 19848     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19849
 19850     GO TO 8300-EXIT.
 19851
 19852 8300-NOTFND.
 19853
 19854     IF CTBL-SW = '0530'
 19855         MOVE 'AA'                     TO WS-AH-COMP-CD
 19856         MOVE '0550'                   TO CTBL-SW
 19857         MOVE '1'                      TO WS-CTBL-READ-SW
 19858         GO TO 8300-EXIT.
 19859
 19860     IF CTBL-SW = '0540'
 19861         MOVE 'AA'                     TO WS-LF-COMP-CD
 19862         MOVE '0550'                   TO CTBL-SW
 19863         MOVE '1'                      TO WS-CTBL-READ-SW
 19864         GO TO 8300-EXIT.
 19865
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 367
* EL050.cbl
 19866     IF CTBL-SW = '0550'
 19867         MOVE '2'                      TO WS-CTBL-READ-SW
 19868         GO TO 8300-EXIT.
 19869
 19870     GO TO 8300-EXIT.
 19871
 19872 8300-ERRESS-PROBLEM.
 19873
 19874      MOVE ER-8050              TO WS-ERROR.
 19875      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19876
 19877     GO TO 8300-EXIT.
 19878
 19879 8300-EXIT.
 19880      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 368
* EL050.cbl
 19882
 19883
 19884 8400-GETMAIN-ERFORM.
 19885
 19886
 19887* EXEC CICS   GETMAIN
 19888*        LENGTH  (500)
 19889*        SET     (ADDRESS OF FORM-MASTER)
 19890*    END-EXEC.
 19891     MOVE 500
 19892       TO DFHEIV11
 19893*    MOVE '," L                  $   #00018943' TO DFHEIV0
 19894     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19895     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19896     MOVE X'2020233030303138393433' TO DFHEIV0(25:11)
 19897     CALL 'kxdfhei1' USING DFHEIV0,
 19898           DFHEIV20,
 19899           DFHEIV11,
 19900           DFHEIV99
 19901     SET ADDRESS OF FORM-MASTER TO
 19902         DFHEIV20
 19903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19904
 19905
 19906     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19907
 19908 8400-EXIT.
 19909      EXIT.
 19910
 19911 8450-READ-FORM-MASTER.
 19912
 19913
 19914* EXEC CICS  HANDLE CONDITION
 19915*        NOTFND   (8450-FORM-NOT-FOUND)
 19916*        ENDFILE  (8450-FORM-NOT-FOUND)
 19917*    END-EXEC.
 19918*    MOVE '"$I''                  ! 4 #00018955' TO DFHEIV0
 19919     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19921     MOVE X'3420233030303138393535' TO DFHEIV0(25:11)
 19922     CALL 'kxdfhei1' USING DFHEIV0
 19923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19924
 19925
 19926
 19927* EXEC CICS   READ
 19928*        DATASET   (FORM-ID)
 19929*        RIDFLD    (ERFORM-KEY)
 19930*        INTO      (FORM-MASTER)
 19931*        GTEQ
 19932*    END-EXEC.
 19933     MOVE LENGTH OF
 19934      FORM-MASTER
 19935       TO DFHEIV11
 19936*    MOVE '&"IL       G          (   #00018960' TO DFHEIV0
 19937     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19939     MOVE X'2020233030303138393630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 369
* EL050.cbl
 19940     CALL 'kxdfhei1' USING DFHEIV0,
 19941           FORM-ID,
 19942           FORM-MASTER,
 19943           DFHEIV11,
 19944           ERFORM-KEY,
 19945           DFHEIV99,
 19946           DFHEIV99,
 19947           DFHEIV99
 19948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19949
 19950
 19951     MOVE  'Y'           TO  FORM-MASTER-SW.
 19952
 19953     GO TO  8450-EXIT.
 19954
 19955 8450-FORM-NOT-FOUND.
 19956
 19957     MOVE  'N'           TO  FORM-MASTER-SW.
 19958
 19959 8450-EXIT.
 19960      EXIT.
 19961
 19962 8500-DATE-CONVERT.
 19963
 19964* EXEC CICS LINK
 19965*        PROGRAM    ('ELDATCV')
 19966*        COMMAREA   (DATE-CONVERSION-DATA)
 19967*        LENGTH     (DC-COMM-LENGTH)
 19968*    END-EXEC.
 19969     MOVE 'ELDATCV' TO DFHEIV1
 19970*    MOVE '."C                   (   #00018979' TO DFHEIV0
 19971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19973     MOVE X'2020233030303138393739' TO DFHEIV0(25:11)
 19974     CALL 'kxdfhei1' USING DFHEIV0,
 19975           DFHEIV1,
 19976           DATE-CONVERSION-DATA,
 19977           DC-COMM-LENGTH,
 19978           DFHEIV99,
 19979           DFHEIV99,
 19980           DFHEIV99,
 19981           DFHEIV99
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985 8500-EXIT.
 19986     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 370
* EL050.cbl
 19988
 19989 8555-RELOAD-CONTROL-FILE.
 19990     CONTINUE.
 19991
 19992 8555-EXIT.
 19993     EXIT.
 19994
 19995 8557-GETMAIN-ERPLAN.
 19996
 19997
 19998* EXEC CICS GETMAIN
 19999*        LENGTH    (840)
 20000*        SET       (ADDRESS OF PLAN-RECORDS)
 20001*    END-EXEC.
 20002     MOVE 840
 20003       TO DFHEIV11
 20004*    MOVE '," L                  $   #00018997' TO DFHEIV0
 20005     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20006     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20007     MOVE X'2020233030303138393937' TO DFHEIV0(25:11)
 20008     CALL 'kxdfhei1' USING DFHEIV0,
 20009           DFHEIV20,
 20010           DFHEIV11,
 20011           DFHEIV99
 20012     SET ADDRESS OF PLAN-RECORDS TO
 20013         DFHEIV20
 20014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20015
 20016
 20017     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20018
 20019 8557-EXIT.
 20020     EXIT.
 20021
 20022 8560-GETMAIN.
 20023
 20024* EXEC CICS GETMAIN
 20025*        LENGTH    (2000)
 20026*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20027*    END-EXEC.
 20028     MOVE 2000
 20029       TO DFHEIV11
 20030*    MOVE '," L                  $   #00019008' TO DFHEIV0
 20031     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20032     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20033     MOVE X'2020233030303139303038' TO DFHEIV0(25:11)
 20034     CALL 'kxdfhei1' USING DFHEIV0,
 20035           DFHEIV20,
 20036           DFHEIV11,
 20037           DFHEIV99
 20038     SET ADDRESS OF ACCOUNT-MASTER TO
 20039         DFHEIV20
 20040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20041
 20042
 20043     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20044
 20045 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 371
* EL050.cbl
 20046     EXIT.
 20047
 20048 8570-START-ACCOUNT-MASTER.
 20049
 20050* EXEC CICS HANDLE CONDITION
 20051*        NOTFND    (0199-ACCT-NOT-FOUND)
 20052*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20053*    END-EXEC.
 20054*    MOVE '"$I''                  ! 5 #00019019' TO DFHEIV0
 20055     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20057     MOVE X'3520233030303139303139' TO DFHEIV0(25:11)
 20058     CALL 'kxdfhei1' USING DFHEIV0
 20059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20060
 20061
 20062
 20063* EXEC CICS STARTBR
 20064*        DATASET    (ACCT-ID)
 20065*        RIDFLD     (ERACCT-KEY)
 20066*        GTEQ
 20067*    END-EXEC.
 20068     MOVE 0
 20069       TO DFHEIV11
 20070*    MOVE '&,         G          &   #00019024' TO DFHEIV0
 20071     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20072     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20073     MOVE X'2020233030303139303234' TO DFHEIV0(25:11)
 20074     CALL 'kxdfhei1' USING DFHEIV0,
 20075           ACCT-ID,
 20076           ERACCT-KEY,
 20077           DFHEIV99,
 20078           DFHEIV11,
 20079           DFHEIV99
 20080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20081
 20082
 20083 8570-EXIT.
 20084     EXIT.
 20085
 20086 8580-READ-ACCOUNT-MASTER.
 20087
 20088* EXEC CICS HANDLE CONDITION
 20089*        NOTFND    (0199-ACCT-NOT-FOUND)
 20090*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20091*    END-EXEC.
 20092*    MOVE '"$I''                  ! 6 #00019034' TO DFHEIV0
 20093     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20095     MOVE X'3620233030303139303334' TO DFHEIV0(25:11)
 20096     CALL 'kxdfhei1' USING DFHEIV0
 20097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20098
 20099
 20100
 20101* EXEC CICS READNEXT
 20102*        DATASET     (ACCT-ID)
 20103*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 372
* EL050.cbl
 20104*        RIDFLD      (ERACCT-KEY)
 20105*    END-EXEC.
 20106     MOVE LENGTH OF
 20107      ACCOUNT-MASTER
 20108       TO DFHEIV12
 20109     MOVE 0
 20110       TO DFHEIV11
 20111*    MOVE '&.IL                  )   #00019039' TO DFHEIV0
 20112     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20113     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20114     MOVE X'2020233030303139303339' TO DFHEIV0(25:11)
 20115     CALL 'kxdfhei1' USING DFHEIV0,
 20116           ACCT-ID,
 20117           ACCOUNT-MASTER,
 20118           DFHEIV12,
 20119           ERACCT-KEY,
 20120           DFHEIV99,
 20121           DFHEIV11,
 20122           DFHEIV99,
 20123           DFHEIV99
 20124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20125
 20126
 20127 8580-EXIT.
 20128     EXIT.
 20129
 20130 8582-READ-COMPENSATION-MASTER.
 20131
 20132* EXEC CICS HANDLE CONDITION
 20133*        NOTFND    (8582-COMP-NOT-FOUND)
 20134*        ENDFILE   (8582-COMP-NOT-FOUND)
 20135*    END-EXEC.
 20136*    MOVE '"$I''                  ! 7 #00019049' TO DFHEIV0
 20137     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20139     MOVE X'3720233030303139303439' TO DFHEIV0(25:11)
 20140     CALL 'kxdfhei1' USING DFHEIV0
 20141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20142
 20143
 20144
 20145* EXEC CICS READ
 20146*        DATASET     (COMP-ID)
 20147*        INTO        (COMPENSATION-MASTER)
 20148*        RIDFLD      (ERCOMP-KEY)
 20149*    END-EXEC.
 20150     MOVE LENGTH OF
 20151      COMPENSATION-MASTER
 20152       TO DFHEIV11
 20153*    MOVE '&"IL       E          (   #00019054' TO DFHEIV0
 20154     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20156     MOVE X'2020233030303139303534' TO DFHEIV0(25:11)
 20157     CALL 'kxdfhei1' USING DFHEIV0,
 20158           COMP-ID,
 20159           COMPENSATION-MASTER,
 20160           DFHEIV11,
 20161           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 373
* EL050.cbl
 20162           DFHEIV99,
 20163           DFHEIV99,
 20164           DFHEIV99
 20165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20166
 20167
 20168     MOVE 'Y'                    TO COMP-MASTER-SW
 20169
 20170     GO TO 8582-EXIT
 20171     .
 20172 8582-COMP-NOT-FOUND.
 20173
 20174     MOVE 'N'                    TO COMP-MASTER-SW.
 20175
 20176 8582-EXIT.
 20177     EXIT.
 20178
 20179 8583-READ-ERAGTC.
 20180
 20181* EXEC CICS HANDLE CONDITION
 20182*        NOTFND    (8583-AGTC-NOT-FOUND)
 20183*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20184*    END-EXEC.
 20185*    MOVE '"$I''                  ! 8 #00019072' TO DFHEIV0
 20186     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20188     MOVE X'3820233030303139303732' TO DFHEIV0(25:11)
 20189     CALL 'kxdfhei1' USING DFHEIV0
 20190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20191
 20192
 20193
 20194* EXEC CICS STARTBR
 20195*        DATASET    (AGTC-ID)
 20196*        RIDFLD     (ERAGTC-KEY)
 20197*        GTEQ
 20198*    END-EXEC.
 20199     MOVE 0
 20200       TO DFHEIV11
 20201*    MOVE '&,         G          &   #00019077' TO DFHEIV0
 20202     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20203     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20204     MOVE X'2020233030303139303737' TO DFHEIV0(25:11)
 20205     CALL 'kxdfhei1' USING DFHEIV0,
 20206           AGTC-ID,
 20207           ERAGTC-KEY,
 20208           DFHEIV99,
 20209           DFHEIV11,
 20210           DFHEIV99
 20211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20212
 20213
 20214 8583-READ-ERAGTC-NEXT.
 20215
 20216* EXEC CICS READNEXT
 20217*        DATASET     (AGTC-ID)
 20218*        INTO        (AGENT-COMMISSIONS)
 20219*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 374
* EL050.cbl
 20220*    END-EXEC.
 20221     MOVE LENGTH OF
 20222      AGENT-COMMISSIONS
 20223       TO DFHEIV12
 20224     MOVE 0
 20225       TO DFHEIV11
 20226*    MOVE '&.IL                  )   #00019084' TO DFHEIV0
 20227     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20228     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20229     MOVE X'2020233030303139303834' TO DFHEIV0(25:11)
 20230     CALL 'kxdfhei1' USING DFHEIV0,
 20231           AGTC-ID,
 20232           AGENT-COMMISSIONS,
 20233           DFHEIV12,
 20234           ERAGTC-KEY,
 20235           DFHEIV99,
 20236           DFHEIV11,
 20237           DFHEIV99,
 20238           DFHEIV99
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20240
 20241
 20242*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20243
 20244     GO TO 8583-EXIT
 20245     .
 20246 8583-AGTC-NOT-FOUND.
 20247
 20248     MOVE 'N'                    TO AGTC-MASTER-SW.
 20249
 20250 8583-EXIT.
 20251     EXIT.
 20252
 20253 8584-READ-BANK-CROSS-REF.
 20254
 20255* EXEC CICS HANDLE CONDITION
 20256*        NOTFND    (8584-BXRF-NOT-FOUND)
 20257*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20258*    END-EXEC.
 20259*    MOVE '"$I''                  ! 9 #00019102' TO DFHEIV0
 20260     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20262     MOVE X'3920233030303139313032' TO DFHEIV0(25:11)
 20263     CALL 'kxdfhei1' USING DFHEIV0
 20264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20265
 20266
 20267
 20268* EXEC CICS READ
 20269*        DATASET     (BXRF-ID)
 20270*        INTO        (BANK-CROSS-REFERENCE)
 20271*        RIDFLD      (ERBXRF-KEY)
 20272*        LENGTH      (BXRF-REC-LENGTH)
 20273*    END-EXEC.
 20274*    MOVE '&"IL       E          (   #00019107' TO DFHEIV0
 20275     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303139313037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 375
* EL050.cbl
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           BXRF-ID,
 20280           BANK-CROSS-REFERENCE,
 20281           BXRF-REC-LENGTH,
 20282           ERBXRF-KEY,
 20283           DFHEIV99,
 20284           DFHEIV99,
 20285           DFHEIV99
 20286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20287
 20288
 20289     MOVE 'Y'                    TO BXRF-MASTER-SW
 20290
 20291     GO TO 8584-EXIT
 20292     .
 20293 8584-BXRF-NOT-FOUND.
 20294
 20295     MOVE 'N'                    TO BXRF-MASTER-SW.
 20296
 20297 8584-EXIT.
 20298     EXIT.
 20299
 20300 8585-READ-PLAN-MASTER.
 20301
 20302
 20303* EXEC CICS HANDLE CONDITION
 20304*        NOTFND    (8585-PLAN-NOT-FOUND)
 20305*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20306*    END-EXEC.
 20307*    MOVE '"$I''                  ! : #00019127' TO DFHEIV0
 20308     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20310     MOVE X'3A20233030303139313237' TO DFHEIV0(25:11)
 20311     CALL 'kxdfhei1' USING DFHEIV0
 20312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20313
 20314
 20315
 20316* EXEC CICS READ
 20317*        DATASET     (PLAN-ID)
 20318*        INTO        (PLAN-MASTER)
 20319*        RIDFLD      (ERPLAN-KEY)
 20320*    END-EXEC.
 20321     MOVE LENGTH OF
 20322      PLAN-MASTER
 20323       TO DFHEIV11
 20324*    MOVE '&"IL       E          (   #00019132' TO DFHEIV0
 20325     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20327     MOVE X'2020233030303139313332' TO DFHEIV0(25:11)
 20328     CALL 'kxdfhei1' USING DFHEIV0,
 20329           PLAN-ID,
 20330           PLAN-MASTER,
 20331           DFHEIV11,
 20332           ERPLAN-KEY,
 20333           DFHEIV99,
 20334           DFHEIV99,
 20335           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 376
* EL050.cbl
 20336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20337
 20338
 20339     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20340
 20341     GO TO 8585-EXIT.
 20342
 20343 8585-PLAN-NOT-FOUND.
 20344
 20345     MOVE 'N'                    TO PLAN-MASTER-SW.
 20346
 20347 8585-EXIT.
 20348     EXIT.
 20349
 20350 8586-READ-LOAN-OFFICER.
 20351
 20352* EXEC CICS READ
 20353*        DATASET     (LOFC-ID)
 20354*        INTO        (LOAN-OFFICER-MASTER)
 20355*        RIDFLD      (ERLOFC-KEY)
 20356*        RESP        (WS-RESPONSE)
 20357*    END-EXEC
 20358     MOVE LENGTH OF
 20359      LOAN-OFFICER-MASTER
 20360       TO DFHEIV11
 20361*    MOVE '&"IL       E          (  N#00019150' TO DFHEIV0
 20362     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20364     MOVE X'204E233030303139313530' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0,
 20366           LOFC-ID,
 20367           LOAN-OFFICER-MASTER,
 20368           DFHEIV11,
 20369           ERLOFC-KEY,
 20370           DFHEIV99,
 20371           DFHEIV99,
 20372           DFHEIV99
 20373     MOVE EIBRESP  TO WS-RESPONSE
 20374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20375
 20376     IF WS-RESP-NORMAL
 20377        MOVE 'Y'                 TO LOFC-MASTER-SW
 20378     ELSE
 20379        MOVE 'N'                 TO LOFC-MASTER-SW
 20380     END-IF
 20381     .
 20382 8586-EXIT.
 20383     EXIT.
 20384 8587-START-ERPDEF.
 20385
 20386* EXEC CICS STARTBR
 20387*       DATASET   (PDEF-ID)
 20388*       RIDFLD    (ERPDEF-KEY)
 20389*       GTEQ
 20390*       RESP      (WS-RESPONSE)
 20391*    END-EXEC
 20392     MOVE 0
 20393       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 377
* EL050.cbl
 20394*    MOVE '&,         G          &  N#00019166' TO DFHEIV0
 20395     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20397     MOVE X'204E233030303139313636' TO DFHEIV0(25:11)
 20398     CALL 'kxdfhei1' USING DFHEIV0,
 20399           PDEF-ID,
 20400           ERPDEF-KEY,
 20401           DFHEIV99,
 20402           DFHEIV11,
 20403           DFHEIV99
 20404     MOVE EIBRESP  TO WS-RESPONSE
 20405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20406     IF WS-RESP-NORMAL
 20407        MOVE 'Y'                 TO PDEF-MASTER-SW
 20408     ELSE
 20409        MOVE 'N'                 TO PDEF-MASTER-SW
 20410     END-IF
 20411     .
 20412 8587-EXIT.
 20413     EXIT.
 20414 8588-READ-ERPDEF.
 20415
 20416* EXEC CICS READNEXT
 20417*       DATASET   (PDEF-ID)
 20418*       RIDFLD    (ERPDEF-KEY)
 20419*       INTO      (PRODUCT-MASTER)
 20420*       RESP      (WS-RESPONSE)
 20421*    END-EXEC
 20422     MOVE LENGTH OF
 20423      PRODUCT-MASTER
 20424       TO DFHEIV12
 20425     MOVE 0
 20426       TO DFHEIV11
 20427*    MOVE '&.IL                  )  N#00019181' TO DFHEIV0
 20428     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20429     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20430     MOVE X'204E233030303139313831' TO DFHEIV0(25:11)
 20431     CALL 'kxdfhei1' USING DFHEIV0,
 20432           PDEF-ID,
 20433           PRODUCT-MASTER,
 20434           DFHEIV12,
 20435           ERPDEF-KEY,
 20436           DFHEIV99,
 20437           DFHEIV11,
 20438           DFHEIV99,
 20439           DFHEIV99
 20440     MOVE EIBRESP  TO WS-RESPONSE
 20441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20442     IF WS-RESP-NORMAL
 20443        MOVE 'Y'                 TO PDEF-MASTER-SW
 20444     ELSE
 20445        MOVE 'N'                 TO PDEF-MASTER-SW
 20446     END-IF
 20447     .
 20448 8588-EXIT.
 20449     EXIT.
 20450 8589-ENDBR-ERPDEF.
 20451
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 378
* EL050.cbl
 20452* EXEC CICS ENDBR
 20453*       DATASET   (PDEF-ID)
 20454*    END-EXEC
 20455     MOVE 0
 20456       TO DFHEIV11
 20457*    MOVE '&2                    $   #00019196' TO DFHEIV0
 20458     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20459     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20460     MOVE X'2020233030303139313936' TO DFHEIV0(25:11)
 20461     CALL 'kxdfhei1' USING DFHEIV0,
 20462           PDEF-ID,
 20463           DFHEIV11,
 20464           DFHEIV99
 20465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20466     .
 20467 8589-EXIT.
 20468     EXIT.
 20469 8590-READ-CERT-MASTER.
 20470     IF PB-COMPANY-ID = 'UCL'
 20471         GO TO 8690-READ-CERT-MASTER-UCL.
 20472
 20473
 20474* EXEC CICS HANDLE CONDITION
 20475*         NOTFND    (0299-CERT-NOT-FOUND)
 20476*    END-EXEC.
 20477*    MOVE '"$I                   ! ; #00019206' TO DFHEIV0
 20478     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20480     MOVE X'3B20233030303139323036' TO DFHEIV0(25:11)
 20481     CALL 'kxdfhei1' USING DFHEIV0
 20482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20483
 20484
 20485
 20486* EXEC CICS READ
 20487*        DATASET     (CERT-ID)
 20488*        INTO        (CERTIFICATE-MASTER)
 20489*        RIDFLD      (ELCERT-KEY)
 20490*        UPDATE
 20491*    END-EXEC.
 20492     MOVE LENGTH OF
 20493      CERTIFICATE-MASTER
 20494       TO DFHEIV11
 20495*    MOVE '&"IL       EU         (   #00019210' TO DFHEIV0
 20496     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20497     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20498     MOVE X'2020233030303139323130' TO DFHEIV0(25:11)
 20499     CALL 'kxdfhei1' USING DFHEIV0,
 20500           CERT-ID,
 20501           CERTIFICATE-MASTER,
 20502           DFHEIV11,
 20503           ELCERT-KEY,
 20504           DFHEIV99,
 20505           DFHEIV99,
 20506           DFHEIV99
 20507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20508
 20509
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 379
* EL050.cbl
 20510 8590-EXIT.
 20511     EXIT.
 20512
 20513 8690-READ-CERT-MASTER-UCL.
 20514
 20515* EXEC CICS HANDLE CONDITION
 20516*         NOTFND    (8700-READ-CERT-MASTER)
 20517*    END-EXEC.
 20518*    MOVE '"$I                   ! < #00019221' TO DFHEIV0
 20519     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20521     MOVE X'3C20233030303139323231' TO DFHEIV0(25:11)
 20522     CALL 'kxdfhei1' USING DFHEIV0
 20523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20524
 20525
 20526 8690-READ-CERT-CONT.
 20527
 20528* EXEC CICS READ
 20529*        DATASET     (CERT-ID)
 20530*        INTO        (CERTIFICATE-MASTER)
 20531*        RIDFLD      (ELCERT-KEY)
 20532*        UPDATE
 20533*    END-EXEC.
 20534     MOVE LENGTH OF
 20535      CERTIFICATE-MASTER
 20536       TO DFHEIV11
 20537*    MOVE '&"IL       EU         (   #00019226' TO DFHEIV0
 20538     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20539     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20540     MOVE X'2020233030303139323236' TO DFHEIV0(25:11)
 20541     CALL 'kxdfhei1' USING DFHEIV0,
 20542           CERT-ID,
 20543           CERTIFICATE-MASTER,
 20544           DFHEIV11,
 20545           ELCERT-KEY,
 20546           DFHEIV99,
 20547           DFHEIV99,
 20548           DFHEIV99
 20549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20550
 20551
 20552     GO TO 8590-EXIT.
 20553
 20554 8700-READ-CERT-MASTER.
 20555     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20556     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20557
 20558* EXEC CICS HANDLE CONDITION
 20559*         DUPKEY    (8720-COMP-ACCOUNTS)
 20560*         ENDFILE   (8730-END-BROWSE)
 20561*         NOTFND    (8740-NOT-FOUND)
 20562*    END-EXEC.
 20563*    MOVE '"$$''I                 ! = #00019238' TO DFHEIV0
 20564     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20566     MOVE X'3D20233030303139323338' TO DFHEIV0(25:11)
 20567     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 380
* EL050.cbl
 20568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20569
 20570
 20571
 20572* EXEC CICS STARTBR
 20573*        DATASET     ('ELCERT5')
 20574*        RIDFLD      (ELCERT2-KEY)
 20575*        EQUAL
 20576*    END-EXEC.
 20577     MOVE 'ELCERT5' TO DFHEIV1
 20578     MOVE 0
 20579       TO DFHEIV11
 20580*    MOVE '&,         E          &   #00019244' TO DFHEIV0
 20581     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20582     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20583     MOVE X'2020233030303139323434' TO DFHEIV0(25:11)
 20584     CALL 'kxdfhei1' USING DFHEIV0,
 20585           DFHEIV1,
 20586           ELCERT2-KEY,
 20587           DFHEIV99,
 20588           DFHEIV11,
 20589           DFHEIV99
 20590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20591
 20592
 20593 8710-READ-NEXT.
 20594
 20595* EXEC CICS READNEXT
 20596*        DATASET     ('ELCERT5')
 20597*        INTO        (CERTIFICATE-MASTER)
 20598*        RIDFLD      (ELCERT2-KEY)
 20599*    END-EXEC.
 20600     MOVE LENGTH OF
 20601      CERTIFICATE-MASTER
 20602       TO DFHEIV12
 20603     MOVE 'ELCERT5' TO DFHEIV1
 20604     MOVE 0
 20605       TO DFHEIV11
 20606*    MOVE '&.IL                  )   #00019251' TO DFHEIV0
 20607     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20608     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20609     MOVE X'2020233030303139323531' TO DFHEIV0(25:11)
 20610     CALL 'kxdfhei1' USING DFHEIV0,
 20611           DFHEIV1,
 20612           CERTIFICATE-MASTER,
 20613           DFHEIV12,
 20614           ELCERT2-KEY,
 20615           DFHEIV99,
 20616           DFHEIV11,
 20617           DFHEIV99,
 20618           DFHEIV99
 20619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20620
 20621
 20622 8720-COMP-ACCOUNTS.
 20623
 20624* EXEC CICS ENTER
 20625*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 381
* EL050.cbl
 20626*         FROM (PB-C-LAST-NAME)
 20627*    END-EXEC.
 20628     MOVE 001
 20629       TO DFHEIV11
 20630*    MOVE ':$F                   %   #00019258' TO DFHEIV0
 20631     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20632     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20633     MOVE X'2020233030303139323538' TO DFHEIV0(25:11)
 20634     CALL 'kxdfhei1' USING DFHEIV0,
 20635           DFHEIV11,
 20636           PB-C-LAST-NAME,
 20637           DFHEIV99,
 20638           DFHEIV99
 20639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20640
 20641
 20642
 20643* EXEC CICS ENTER
 20644*         TRACEID (002)
 20645*         FROM (CM-INSURED-LAST-NAME)
 20646*    END-EXEC.
 20647     MOVE 002
 20648       TO DFHEIV11
 20649*    MOVE ':$F                   %   #00019263' TO DFHEIV0
 20650     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20651     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20652     MOVE X'2020233030303139323633' TO DFHEIV0(25:11)
 20653     CALL 'kxdfhei1' USING DFHEIV0,
 20654           DFHEIV11,
 20655           CM-INSURED-LAST-NAME,
 20656           DFHEIV99,
 20657           DFHEIV99
 20658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20659
 20660
 20661     IF PB-CERT-NO NOT = CM-CERT-NO
 20662         GO TO 8730-END-BROWSE.
 20663
 20664     IF PB-ACCOUNT = CM-ACCOUNT
 20665         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20666             MOVE ER-2799        TO WS-ERROR
 20667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20668             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20669             GO TO 8730-END-BROWSE.
 20670
 20671     GO TO 8710-READ-NEXT.
 20672
 20673 8730-END-BROWSE.
 20674
 20675* EXEC CICS ENDBR
 20676*         DATASET    ('ELCERT5')
 20677*    END-EXEC.
 20678     MOVE 'ELCERT5' TO DFHEIV1
 20679     MOVE 0
 20680       TO DFHEIV11
 20681*    MOVE '&2                    $   #00019281' TO DFHEIV0
 20682     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20683     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 382
* EL050.cbl
 20684     MOVE X'2020233030303139323831' TO DFHEIV0(25:11)
 20685     CALL 'kxdfhei1' USING DFHEIV0,
 20686           DFHEIV1,
 20687           DFHEIV11,
 20688           DFHEIV99
 20689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20690
 20691
 20692 8740-NOT-FOUND.
 20693     GO TO 0299-CERT-NOT-FOUND.
 20694
 20695 8750-START-ELSTAT.
 20696
 20697* EXEC CICS STARTBR
 20698*       DATASET   (STAT-ID)
 20699*       RIDFLD    (ELSTAT-KEY)
 20700*       GTEQ
 20701*       RESP      (WS-RESPONSE)
 20702*    END-EXEC
 20703     MOVE 0
 20704       TO DFHEIV11
 20705*    MOVE '&,         G          &  N#00019289' TO DFHEIV0
 20706     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20707     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20708     MOVE X'204E233030303139323839' TO DFHEIV0(25:11)
 20709     CALL 'kxdfhei1' USING DFHEIV0,
 20710           STAT-ID,
 20711           ELSTAT-KEY,
 20712           DFHEIV99,
 20713           DFHEIV11,
 20714           DFHEIV99
 20715     MOVE EIBRESP  TO WS-RESPONSE
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20717     IF WS-RESP-NORMAL
 20718        MOVE 'Y'                 TO STAT-MASTER-SW
 20719     ELSE
 20720        MOVE 'N'                 TO STAT-MASTER-SW
 20721     END-IF
 20722     .
 20723 8750-EXIT.
 20724     EXIT.
 20725 8752-READ-ELSTAT.
 20726
 20727* EXEC CICS READNEXT
 20728*       DATASET   (STAT-ID)
 20729*       RIDFLD    (ELSTAT-KEY)
 20730*       INTO      (STATE-FILE)
 20731*       RESP      (WS-RESPONSE)
 20732*    END-EXEC
 20733     MOVE LENGTH OF
 20734      STATE-FILE
 20735       TO DFHEIV12
 20736     MOVE 0
 20737       TO DFHEIV11
 20738*    MOVE '&.IL                  )  N#00019304' TO DFHEIV0
 20739     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20740     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20741     MOVE X'204E233030303139333034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 383
* EL050.cbl
 20742     CALL 'kxdfhei1' USING DFHEIV0,
 20743           STAT-ID,
 20744           STATE-FILE,
 20745           DFHEIV12,
 20746           ELSTAT-KEY,
 20747           DFHEIV99,
 20748           DFHEIV11,
 20749           DFHEIV99,
 20750           DFHEIV99
 20751     MOVE EIBRESP  TO WS-RESPONSE
 20752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20753     IF WS-RESP-NORMAL
 20754        MOVE 'Y'                 TO STAT-MASTER-SW
 20755     ELSE
 20756        MOVE 'N'                 TO STAT-MASTER-SW
 20757     END-IF
 20758     .
 20759 8752-EXIT.
 20760     EXIT.
 20761 8800-GET-COMP-RATE.
 20762     MOVE +1 TO IB.
 20763     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20764         ADD +9 TO IB
 20765         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20766             ADD +9 TO IB
 20767             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20768                MOVE ZEROS       TO WS-WK-RATE
 20769                GO TO 8800-EXIT.
 20770
 20771     IF PB-I-AGE GREATER CT-AGE (1)
 20772         ADD +3 TO IB
 20773         IF PB-I-AGE GREATER CT-AGE (2)
 20774             ADD +3 TO IB
 20775             IF PB-I-AGE GREATER CT-AGE (3)
 20776                MOVE ZEROS       TO WS-WK-RATE
 20777                GO TO 8800-EXIT.
 20778
 20779     IF WS-WORK-TERM GREATER CT-TRM (1)
 20780         ADD +1 TO IB
 20781         IF WS-WORK-TERM GREATER CT-TRM (2)
 20782             ADD +1 TO IB
 20783             IF WS-WORK-TERM GREATER CT-TRM (3)
 20784                MOVE ZEROS       TO WS-WK-RATE
 20785                GO TO 8800-EXIT.
 20786
 20787     IF CT-RT (IB) NOT NUMERIC
 20788         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20789         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20790         GO TO 8800-GET-COMP-RATE.
 20791
 20792     MOVE CT-RT (IB) TO WS-WK-RATE.
 20793
 20794 8800-EXIT.
 20795     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 384
* EL050.cbl
 20797 8900-ADDRESS-FILE.
 20798     IF ERACCT-FILE-ADDRESSED
 20799         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20800         GO TO 8900-ADDRESS-EXIT.
 20801
 20802     IF ELCNTL-FILE-ADDRESSED
 20803         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20804         GO TO 8900-ADDRESS-EXIT.
 20805
 20806     IF ERPLAN-FILE-ADDRESSED
 20807         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20808         GO TO 8900-ADDRESS-EXIT.
 20809
 20810     IF ERFORM-FILE-ADDRESSED
 20811         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20812         GO TO 8900-ADDRESS-EXIT.
 20813
 20814 8900-ADDRESS-EXIT.
 20815     EXIT.
 20816
 20817 9000-READ-CONTROL.
 20818
 20819* EXEC CICS HANDLE CONDITION
 20820*        NOTFND    (9000-NOTFND)
 20821*    END-EXEC.
 20822*    MOVE '"$I                   ! > #00019375' TO DFHEIV0
 20823     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20825     MOVE X'3E20233030303139333735' TO DFHEIV0(25:11)
 20826     CALL 'kxdfhei1' USING DFHEIV0
 20827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20828
 20829
 20830
 20831* EXEC CICS READ
 20832*        DATASET     (CNTL-ID)
 20833*        SET         (ADDRESS OF CONTROL-FILE)
 20834*        RIDFLD      (ELCNTL-KEY)
 20835*        GTEQ
 20836*    END-EXEC.
 20837*    MOVE '&"S        G          (   #00019379' TO DFHEIV0
 20838     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20840     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 20841     CALL 'kxdfhei1' USING DFHEIV0,
 20842           CNTL-ID,
 20843           DFHEIV20,
 20844           DFHEIV99,
 20845           ELCNTL-KEY,
 20846           DFHEIV99,
 20847           DFHEIV99,
 20848           DFHEIV99
 20849     SET ADDRESS OF CONTROL-FILE TO
 20850         DFHEIV20
 20851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20852
 20853
 20854     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 385
* EL050.cbl
 20855
 20856 9000-NOTFND.
 20857     IF RC-SW-1 = '1'
 20858        MOVE ER-2616              TO WS-ERROR
 20859        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20860        GO TO 9000-EXIT.
 20861
 20862     IF RC-SW-1 = '2'
 20863        MOVE ER-2602              TO WS-ERROR
 20864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20865
 20866 9000-EXIT.
 20867      EXIT.
 20868
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 386
* EL050.cbl
 20870 9100-READ-CONTROL.
 20871
 20872* EXEC CICS HANDLE CONDITION
 20873*        NOTFND  (9100-NOTFND)
 20874*        ENDFILE (9100-NOTFND)
 20875*    END-EXEC.
 20876*    MOVE '"$I''                  ! ? #00019403' TO DFHEIV0
 20877     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20879     MOVE X'3F20233030303139343033' TO DFHEIV0(25:11)
 20880     CALL 'kxdfhei1' USING DFHEIV0
 20881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20882
 20883
 20884
 20885* EXEC CICS READ
 20886*        DATASET     (CNTL-ID)
 20887*        INTO        (CONTROL-FILE)
 20888*        RIDFLD      (ELCNTL-KEY)
 20889*        GTEQ
 20890*    END-EXEC.
 20891     MOVE LENGTH OF
 20892      CONTROL-FILE
 20893       TO DFHEIV11
 20894*    MOVE '&"IL       G          (   #00019408' TO DFHEIV0
 20895     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20897     MOVE X'2020233030303139343038' TO DFHEIV0(25:11)
 20898     CALL 'kxdfhei1' USING DFHEIV0,
 20899           CNTL-ID,
 20900           CONTROL-FILE,
 20901           DFHEIV11,
 20902           ELCNTL-KEY,
 20903           DFHEIV99,
 20904           DFHEIV99,
 20905           DFHEIV99
 20906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20907
 20908
 20909     GO TO 9100-EXIT.
 20910
 20911 9100-NOTFND.
 20912     IF RC-SW-2 = '0'
 20913        MOVE '1'                  TO STATE-RECORD-ERROR
 20914        GO TO 9100-EXIT
 20915     END-IF
 20916     IF RC-SW-2 = '1'
 20917        MOVE '1'                  TO LF-BENEFIT-ERROR
 20918        MOVE ER-2604              TO WS-ERROR
 20919        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20920        GO TO 9100-EXIT.
 20921
 20922     IF RC-SW-2 = '2'
 20923        MOVE '1'                  TO AH-BENEFIT-ERROR
 20924        MOVE ER-2605              TO WS-ERROR
 20925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20926        GO TO 9100-EXIT.
 20927
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 387
* EL050.cbl
 20928     IF RC-SW-2 = '3'
 20929         MOVE ER-2603           TO WS-ERROR
 20930         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20931         GO TO 9100-EXIT.
 20932
 20933     IF RC-SW-2 = '4'
 20934         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20935         GO TO 9100-EXIT.
 20936
 20937     IF RC-SW-2 = '5'
 20938         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20939         IF WS-AH-INPUT-CD-1 = SPACE
 20940             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20941         ELSE
 20942             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20943
 20944 9100-EXIT.
 20945      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 388
* EL050.cbl
 20947 9200-CONTROL-GETMAIN.
 20948
 20949* EXEC CICS GETMAIN
 20950*         LENGTH   (750)
 20951*         SET      (ADDRESS OF CONTROL-FILE)
 20952*    END-EXEC.
 20953     MOVE 750
 20954       TO DFHEIV11
 20955*    MOVE '," L                  $   #00019454' TO DFHEIV0
 20956     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20957     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20958     MOVE X'2020233030303139343534' TO DFHEIV0(25:11)
 20959     CALL 'kxdfhei1' USING DFHEIV0,
 20960           DFHEIV20,
 20961           DFHEIV11,
 20962           DFHEIV99
 20963     SET ADDRESS OF CONTROL-FILE TO
 20964         DFHEIV20
 20965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20966
 20967
 20968     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20969
 20970 9200-EXIT.
 20971     EXIT.
 20972
 20973 9250-UNLOCK-RETURN.
 20974
 20975* EXEC CICS UNLOCK
 20976*        DATASET   (CERT-ID)
 20977*    END-EXEC.
 20978*    MOVE '&*                    #   #00019465' TO DFHEIV0
 20979     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20980     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20981     MOVE X'2020233030303139343635' TO DFHEIV0(25:11)
 20982     CALL 'kxdfhei1' USING DFHEIV0,
 20983           CERT-ID,
 20984           DFHEIV99
 20985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20986
 20987
 20988 9300-ABEND.
 20989     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20990
 20991
 20992* EXEC CICS LINK
 20993*        PROGRAM   ('EL004')
 20994*        COMMAREA  (WS-ERROR-LINE)
 20995*        LENGTH    (72)
 20996*    END-EXEC.
 20997     MOVE 'EL004' TO DFHEIV1
 20998     MOVE 72
 20999       TO DFHEIV11
 21000*    MOVE '."C                   (   #00019472' TO DFHEIV0
 21001     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21003     MOVE X'2020233030303139343732' TO DFHEIV0(25:11)
 21004     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 389
* EL050.cbl
 21005           DFHEIV1,
 21006           WS-ERROR-LINE,
 21007           DFHEIV11,
 21008           DFHEIV99,
 21009           DFHEIV99,
 21010           DFHEIV99,
 21011           DFHEIV99
 21012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21013
 21014
 21015     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21016
 21017
 21018* EXEC CICS ABEND
 21019*        ABCODE ('EL50')
 21020*    END-EXEC.
 21021     MOVE 'EL50' TO DFHEIV5
 21022*    MOVE '.,A                   "   #00019480' TO DFHEIV0
 21023     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21024     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21025     MOVE X'2020233030303139343830' TO DFHEIV0(25:11)
 21026     CALL 'kxdfhei1' USING DFHEIV0,
 21027           DFHEIV5
 21028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21029
 21030
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 390
* EL050.cbl
 21032
 21033******************************************************************
 21034*                                                                *
 21035*            E R R O R   F O R M A T   R O U T I N E             *
 21036*                                                                *
 21037******************************************************************
 21038
 21039 9900-ERROR-FORMAT.
 21040
 21041     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21042                    PB-COMMON-ERROR (2) OR
 21043                    PB-COMMON-ERROR (3) OR
 21044                    PB-COMMON-ERROR (4) OR
 21045                    PB-COMMON-ERROR (5) OR
 21046                    PB-COMMON-ERROR (6) OR
 21047                    PB-COMMON-ERROR (7) OR
 21048                    PB-COMMON-ERROR (8) OR
 21049                    PB-COMMON-ERROR (9) OR
 21050                    PB-COMMON-ERROR (10)
 21051        GO TO 9900-EXIT.
 21052
 21053     IF PB-NO-OF-ERRORS = +10
 21054        GO TO 9900-EXIT.
 21055
 21056     ADD +1  TO PB-NO-OF-ERRORS.
 21057     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21058                                       (PB-NO-OF-ERRORS).
 21059 9900-EXIT.
 21060     EXIT.
 21061
 21062 9990-RETURN.
 21063     IF BROWSE-STARTED
 21064
 21065* EXEC CICS ENDBR
 21066*            DATASET  (ACCT-ID)
 21067*       END-EXEC.
 21068     MOVE 0
 21069       TO DFHEIV11
 21070*    MOVE '&2                    $   #00019517' TO DFHEIV0
 21071     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21072     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21073     MOVE X'2020233030303139353137' TO DFHEIV0(25:11)
 21074     CALL 'kxdfhei1' USING DFHEIV0,
 21075           ACCT-ID,
 21076           DFHEIV11,
 21077           DFHEIV99
 21078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21079
 21080
 21081 9990-EXIT.
 21082     EXIT.
 21083
 21084
 21085****Check for CRTO record, add one if not found.
 21086 9991-CHECK-FOR-ELCRTO.
 21087
 21088* EXEC CICS HANDLE CONDITION
 21089*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 391
* EL050.cbl
 21090*         ENDFILE (9991-CRTO-NOT-FOUND)
 21091*     END-EXEC.
 21092*    MOVE '"$I''                  ! @ #00019527' TO DFHEIV0
 21093     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21095     MOVE X'4020233030303139353237' TO DFHEIV0(25:11)
 21096     CALL 'kxdfhei1' USING DFHEIV0
 21097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21098
 21099     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21100     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21101     MOVE +0                     TO ELCRTO-SEQ-NO
 21102
 21103
 21104* EXEC CICS READ
 21105*       DATASET   ('ELCRTO')
 21106*       INTO      (ORIGINAL-CERTIFICATE)
 21107*       RIDFLD    (ELCRTO-KEY)
 21108*       GTEQ
 21109*       RESP      (WS-RESPONSE)
 21110*    END-EXEC
 21111     MOVE LENGTH OF
 21112      ORIGINAL-CERTIFICATE
 21113       TO DFHEIV11
 21114     MOVE 'ELCRTO' TO DFHEIV1
 21115*    MOVE '&"IL       G          (  N#00019535' TO DFHEIV0
 21116     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21118     MOVE X'204E233030303139353335' TO DFHEIV0(25:11)
 21119     CALL 'kxdfhei1' USING DFHEIV0,
 21120           DFHEIV1,
 21121           ORIGINAL-CERTIFICATE,
 21122           DFHEIV11,
 21123           ELCRTO-KEY,
 21124           DFHEIV99,
 21125           DFHEIV99,
 21126           DFHEIV99
 21127     MOVE EIBRESP  TO WS-RESPONSE
 21128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21129
 21130     IF WS-RESP-NORMAL
 21131        AND (OC-CONTROL-PRIMARY (1:33) =
 21132                 PB-CONTROL-BY-ACCOUNT (1:33))
 21133        AND (OC-RECORD-TYPE =  'I')
 21134           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21135               GO TO 9991-CHECK-INDICATORS
 21136           ELSE
 21137               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21138               GO TO 9991-CRTO-ADD-REC
 21139           END-IF
 21140     END-IF.
 21141
 21142 9991-CRTO-NOT-FOUND.
 21143
 21144     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21145     MOVE 'OC'                TO OC-RECORD-ID
 21146     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21147                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 392
* EL050.cbl
 21148     MOVE +4096               TO OC-KEY-SEQ-NO.
 21149
 21150 9991-CRTO-ADD-REC.
 21151
 21152     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21153     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21154     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21155     MOVE 'I'                 TO OC-RECORD-TYPE
 21156     IF PB-ISSUE
 21157         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21158         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21159         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21160         MOVE PB-I-AGE               TO OC-INS-AGE
 21161         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21162         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21163         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21164         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21165         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21166         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21167         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21168         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21169         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21170         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21171         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21172         IF PB-I-JOINT-COMMISSION > +0
 21173             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21174         ELSE
 21175             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21176         END-IF
 21177         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21178         MOVE +0                     TO OC-LF-CANCEL-AMT
 21179                                        OC-LF-ITD-CANCEL-AMT
 21180         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21181         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21182         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21183         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21184         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21185         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21186         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21187         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21188         MOVE +0                     TO OC-AH-CANCEL-AMT
 21189                                        OC-AH-ITD-CANCEL-AMT
 21190         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21191         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21192         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21193     ELSE
 21194         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21195         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21196         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21197         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21198         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21199         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21200         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21201         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21202         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21203          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21204             MOVE SPACES             TO OC-LF-BENCD
 21205             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 393
* EL050.cbl
 21206                                        OC-LF-BEN-AMT
 21207                                        OC-LF-PRM-AMT
 21208                                        OC-LF-ALT-BEN-AMT
 21209                                        OC-LF-ALT-PRM-AMT
 21210                                        OC-LF-COMM-PCT
 21211                                        OC-LF-CANCEL-AMT
 21212             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21213             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21214         ELSE
 21215             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21216             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21217             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21218             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21219             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21220             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21221             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21222             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21223             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21224             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21225         END-IF
 21226         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21227         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21228          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21229             MOVE SPACES             TO OC-AH-BENCD
 21230             MOVE ZEROS              TO OC-AH-TERM
 21231                                        OC-AH-BEN-AMT
 21232                                        OC-AH-PRM-AMT
 21233                                        OC-AH-COMM-PCT
 21234                                        OC-AH-CANCEL-AMT
 21235                                        OC-AH-CP
 21236             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21237             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21238         ELSE
 21239             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21240             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21241             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21242             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21243             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21244             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21245             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21246             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21247             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21248         END-IF
 21249         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21250         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21251         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21252         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21253     END-IF
 21254     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21255
 21256     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21257
 21258
 21259* EXEC CICS READ
 21260*         DATASET   (FILE-ERMAIL)
 21261*         RIDFLD    (MA-CONTROL-PRIMARY)
 21262*         INTO      (MAILING-DATA)
 21263*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 394
* EL050.cbl
 21264*    END-EXEC
 21265     MOVE LENGTH OF
 21266      MAILING-DATA
 21267       TO DFHEIV11
 21268*    MOVE '&"IL       E          (  N#00019671' TO DFHEIV0
 21269     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21271     MOVE X'204E233030303139363731' TO DFHEIV0(25:11)
 21272     CALL 'kxdfhei1' USING DFHEIV0,
 21273           FILE-ERMAIL,
 21274           MAILING-DATA,
 21275           DFHEIV11,
 21276           MA-CONTROL-PRIMARY,
 21277           DFHEIV99,
 21278           DFHEIV99,
 21279           DFHEIV99
 21280     MOVE EIBRESP  TO WS-RESPONSE
 21281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21282
 21283     IF WS-RESP-NORMAL
 21284         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21285     END-IF.
 21286
 21287     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21288     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21289
 21290
 21291* EXEC CICS READ
 21292*         DATASET  (CRTT-ID)
 21293*         RIDFLD   (WS-ELCRTT-KEY)
 21294*         INTO     (CERTIFICATE-TRAILERS)
 21295*         RESP     (WS-RESPONSE)
 21296*    END-EXEC
 21297     MOVE LENGTH OF
 21298      CERTIFICATE-TRAILERS
 21299       TO DFHEIV11
 21300*    MOVE '&"IL       E          (  N#00019685' TO DFHEIV0
 21301     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21303     MOVE X'204E233030303139363835' TO DFHEIV0(25:11)
 21304     CALL 'kxdfhei1' USING DFHEIV0,
 21305           CRTT-ID,
 21306           CERTIFICATE-TRAILERS,
 21307           DFHEIV11,
 21308           WS-ELCRTT-KEY,
 21309           DFHEIV99,
 21310           DFHEIV99,
 21311           DFHEIV99
 21312     MOVE EIBRESP  TO WS-RESPONSE
 21313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21314
 21315     IF WS-RESP-NORMAL
 21316         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21317         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21318     END-IF.
 21319
 21320
 21321* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 395
* EL050.cbl
 21322*       DATASET   ('ELCRTO')
 21323*       FROM      (ORIGINAL-CERTIFICATE)
 21324*       RIDFLD    (OC-CONTROL-PRIMARY)
 21325*       RESP      (WS-RESPONSE)
 21326*    END-EXEC.
 21327     MOVE LENGTH OF
 21328      ORIGINAL-CERTIFICATE
 21329       TO DFHEIV11
 21330     MOVE 'ELCRTO' TO DFHEIV1
 21331*    MOVE '&$ L                  ''  N#00019697' TO DFHEIV0
 21332     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21334     MOVE X'204E233030303139363937' TO DFHEIV0(25:11)
 21335     CALL 'kxdfhei1' USING DFHEIV0,
 21336           DFHEIV1,
 21337           ORIGINAL-CERTIFICATE,
 21338           DFHEIV11,
 21339           OC-CONTROL-PRIMARY,
 21340           DFHEIV99,
 21341           DFHEIV99
 21342     MOVE EIBRESP  TO WS-RESPONSE
 21343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21344
 21345
 21346     GO TO 9991-EXIT.
 21347
 21348 9991-CHECK-INDICATORS.
 21349
 21350     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21351         GO TO 9991-EXIT
 21352     END-IF.
 21353
 21354     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21355         GO TO 9991-EXIT
 21356     END-IF.
 21357
 21358
 21359* EXEC CICS READ
 21360*       DATASET   ('ELCRTO')
 21361*       INTO      (ORIGINAL-CERTIFICATE)
 21362*       RIDFLD    (OC-CONTROL-PRIMARY)
 21363*       UPDATE
 21364*       RESP      (WS-RESPONSE)
 21365*    END-EXEC
 21366     MOVE LENGTH OF
 21367      ORIGINAL-CERTIFICATE
 21368       TO DFHEIV11
 21369     MOVE 'ELCRTO' TO DFHEIV1
 21370*    MOVE '&"IL       EU         (  N#00019716' TO DFHEIV0
 21371     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21372     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21373     MOVE X'204E233030303139373136' TO DFHEIV0(25:11)
 21374     CALL 'kxdfhei1' USING DFHEIV0,
 21375           DFHEIV1,
 21376           ORIGINAL-CERTIFICATE,
 21377           DFHEIV11,
 21378           OC-CONTROL-PRIMARY,
 21379           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 396
* EL050.cbl
 21380           DFHEIV99,
 21381           DFHEIV99
 21382     MOVE EIBRESP  TO WS-RESPONSE
 21383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21384     IF WS-RESP-NORMAL
 21385        IF PB-ISSUE
 21386          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21387          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21388          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21389          MOVE PB-I-AGE               TO OC-INS-AGE
 21390          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21391          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21392          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21393          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21394          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21395          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21396          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21397          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21398          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21399          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21400          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21401          IF PB-I-JOINT-COMMISSION > +0
 21402              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21403          ELSE
 21404              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21405          END-IF
 21406          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21407          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21408          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21409          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21410          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21411          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21412          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21413          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21414          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21415
 21416          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21417
 21418* EXEC CICS READ
 21419*             DATASET   (FILE-ERMAIL)
 21420*             RIDFLD    (MA-CONTROL-PRIMARY)
 21421*             INTO      (MAILING-DATA)
 21422*             RESP      (WS-RESPONSE)
 21423*         END-EXEC
 21424     MOVE LENGTH OF
 21425      MAILING-DATA
 21426       TO DFHEIV11
 21427*    MOVE '&"IL       E          (  N#00019756' TO DFHEIV0
 21428     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21430     MOVE X'204E233030303139373536' TO DFHEIV0(25:11)
 21431     CALL 'kxdfhei1' USING DFHEIV0,
 21432           FILE-ERMAIL,
 21433           MAILING-DATA,
 21434           DFHEIV11,
 21435           MA-CONTROL-PRIMARY,
 21436           DFHEIV99,
 21437           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 397
* EL050.cbl
 21438           DFHEIV99
 21439     MOVE EIBRESP  TO WS-RESPONSE
 21440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21441          IF WS-RESP-NORMAL
 21442             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21443          END-IF
 21444
 21445          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21446          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21447
 21448* EXEC CICS READ
 21449*             DATASET  (CRTT-ID)
 21450*             RIDFLD   (WS-ELCRTT-KEY)
 21451*             INTO     (CERTIFICATE-TRAILERS)
 21452*             RESP     (WS-RESPONSE)
 21453*         END-EXEC
 21454     MOVE LENGTH OF
 21455      CERTIFICATE-TRAILERS
 21456       TO DFHEIV11
 21457*    MOVE '&"IL       E          (  N#00019768' TO DFHEIV0
 21458     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21460     MOVE X'204E233030303139373638' TO DFHEIV0(25:11)
 21461     CALL 'kxdfhei1' USING DFHEIV0,
 21462           CRTT-ID,
 21463           CERTIFICATE-TRAILERS,
 21464           DFHEIV11,
 21465           WS-ELCRTT-KEY,
 21466           DFHEIV99,
 21467           DFHEIV99,
 21468           DFHEIV99
 21469     MOVE EIBRESP  TO WS-RESPONSE
 21470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21471          IF WS-RESP-NORMAL
 21472             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21473                               OC-INS-AGE-DEFAULT-FLAG
 21474             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21475                               OC-JNT-AGE-DEFAULT-FLAG
 21476          END-IF
 21477
 21478        ELSE
 21479          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21480             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21481             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21482             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21483          END-IF
 21484          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21485             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21486             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21487             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21488          END-IF
 21489          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21490        END-IF
 21491
 21492* EXEC CICS REWRITE
 21493*          DATASET   ('ELCRTO')
 21494*          FROM      (ORIGINAL-CERTIFICATE)
 21495*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 398
* EL050.cbl
 21496*       END-EXEC
 21497     MOVE LENGTH OF
 21498      ORIGINAL-CERTIFICATE
 21499       TO DFHEIV11
 21500     MOVE 'ELCRTO' TO DFHEIV1
 21501*    MOVE '&& L                  %  N#00019794' TO DFHEIV0
 21502     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21503     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21504     MOVE X'204E233030303139373934' TO DFHEIV0(25:11)
 21505     CALL 'kxdfhei1' USING DFHEIV0,
 21506           DFHEIV1,
 21507           ORIGINAL-CERTIFICATE,
 21508           DFHEIV11,
 21509           DFHEIV99
 21510     MOVE EIBRESP  TO WS-RESPONSE
 21511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21512     END-IF.
 21513
 21514 9991-EXIT.
 21515     EXIT.
 21516
 21517
 21518 9999-RETURN.
 21519     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21520
 21521
 21522* EXEC CICS RETURN
 21523*    END-EXEC.
 21524*    MOVE '.(                    ''   #00019808' TO DFHEIV0
 21525     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21526     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21527     MOVE X'2020233030303139383038' TO DFHEIV0(25:11)
 21528     CALL 'kxdfhei1' USING DFHEIV0,
 21529           DFHEIV99,
 21530           DFHEIV99,
 21531           DFHEIV99,
 21532           DFHEIV99,
 21533           DFHEIV99,
 21534           DFHEIV99
 21535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21536
 21537
 21538
 21539* GOBACK.
 21540     MOVE '9%                    "   ' TO DFHEIV0
 21541     MOVE 'EL050' TO DFHEIV1
 21542     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21543     GOBACK.
 21544
 21545 9999-DFHBACK SECTION.
 21546     MOVE '9%                    "   ' TO DFHEIV0
 21547     MOVE 'EL050' TO DFHEIV1
 21548     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21549     GOBACK.
 21550 9999-DFHEXIT.
 21551     IF DFHEIGDJ EQUAL 0001
 21552         NEXT SENTENCE
 21553     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 399
* EL050.cbl
 21554         GO TO 9300-ABEND,
 21555               3990-FILES-NOT-OPEN
 21556         DEPENDING ON DFHEIGDI
 21557     ELSE IF DFHEIGDJ EQUAL 3
 21558         GO TO 6610-START-BROWSE,
 21559               6630-ERRESS-PROBLEM,
 21560               6630-END-OF-FILE
 21561         DEPENDING ON DFHEIGDI
 21562     ELSE IF DFHEIGDJ EQUAL 4
 21563         GO TO 6630-END-OF-FILE,
 21564               6630-ERRESS-PROBLEM,
 21565               6630-ERRESS-PROBLEM,
 21566               6630-END-OF-FILE
 21567         DEPENDING ON DFHEIGDI
 21568     ELSE IF DFHEIGDJ EQUAL 5
 21569         GO TO 6630-END-OF-FILE,
 21570               6630-END-OF-FILE,
 21571               6630-ERRESS-PROBLEM,
 21572               6630-ERRESS-PROBLEM
 21573         DEPENDING ON DFHEIGDI
 21574     ELSE IF DFHEIGDJ EQUAL 6
 21575         GO TO 6660-START-BROWSE,
 21576               6690-ERRESC-PROBLEM,
 21577               6690-ERRESC-PROBLEM,
 21578               6690-END-OF-FILE
 21579         DEPENDING ON DFHEIGDI
 21580     ELSE IF DFHEIGDJ EQUAL 7
 21581         GO TO 6690-END-OF-FILE,
 21582               6690-ERRESC-PROBLEM,
 21583               6690-ERRESC-PROBLEM,
 21584               6690-END-OF-FILE
 21585         DEPENDING ON DFHEIGDI
 21586     ELSE IF DFHEIGDJ EQUAL 8
 21587         GO TO 6690-END-OF-FILE,
 21588               6690-ERRESC-PROBLEM,
 21589               6690-ERRESC-PROBLEM,
 21590               6690-END-OF-FILE
 21591         DEPENDING ON DFHEIGDI
 21592     ELSE IF DFHEIGDJ EQUAL 9
 21593         GO TO 7250-CONTINUE,
 21594               7250-CONTINUE
 21595         DEPENDING ON DFHEIGDI
 21596     ELSE IF DFHEIGDJ EQUAL 10
 21597         GO TO 7300-CONTINUE,
 21598               7300-CONTINUE
 21599         DEPENDING ON DFHEIGDI
 21600     ELSE IF DFHEIGDJ EQUAL 11
 21601         GO TO 8000-FREE-MAIN
 21602         DEPENDING ON DFHEIGDI
 21603     ELSE IF DFHEIGDJ EQUAL 12
 21604         GO TO 8100-NOTFND,
 21605               8100-NOTFND
 21606         DEPENDING ON DFHEIGDI
 21607     ELSE IF DFHEIGDJ EQUAL 13
 21608         GO TO 8110-NOTFND,
 21609               8110-NOTFND
 21610         DEPENDING ON DFHEIGDI
 21611     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 400
* EL050.cbl
 21612         GO TO 8130-EXIT
 21613         DEPENDING ON DFHEIGDI
 21614     ELSE IF DFHEIGDJ EQUAL 15
 21615         GO TO 8180-NOTFND
 21616         DEPENDING ON DFHEIGDI
 21617     ELSE IF DFHEIGDJ EQUAL 16
 21618         GO TO 8190-NOTFND
 21619         DEPENDING ON DFHEIGDI
 21620     ELSE IF DFHEIGDJ EQUAL 17
 21621         GO TO 8195-NOTFND
 21622         DEPENDING ON DFHEIGDI
 21623     ELSE IF DFHEIGDJ EQUAL 18
 21624         GO TO 8200-NOTFND
 21625         DEPENDING ON DFHEIGDI
 21626     ELSE IF DFHEIGDJ EQUAL 19
 21627         GO TO 8300-NOTFND,
 21628               8300-ERRESS-PROBLEM,
 21629               8300-ERRESS-PROBLEM,
 21630               8300-NOTFND
 21631         DEPENDING ON DFHEIGDI
 21632     ELSE IF DFHEIGDJ EQUAL 20
 21633         GO TO 8450-FORM-NOT-FOUND,
 21634               8450-FORM-NOT-FOUND
 21635         DEPENDING ON DFHEIGDI
 21636     ELSE IF DFHEIGDJ EQUAL 21
 21637         GO TO 0199-ACCT-NOT-FOUND,
 21638               0199-ACCT-NOT-FOUND
 21639         DEPENDING ON DFHEIGDI
 21640     ELSE IF DFHEIGDJ EQUAL 22
 21641         GO TO 0199-ACCT-NOT-FOUND,
 21642               0199-ACCT-NOT-FOUND
 21643         DEPENDING ON DFHEIGDI
 21644     ELSE IF DFHEIGDJ EQUAL 23
 21645         GO TO 8582-COMP-NOT-FOUND,
 21646               8582-COMP-NOT-FOUND
 21647         DEPENDING ON DFHEIGDI
 21648     ELSE IF DFHEIGDJ EQUAL 24
 21649         GO TO 8583-AGTC-NOT-FOUND,
 21650               8583-AGTC-NOT-FOUND
 21651         DEPENDING ON DFHEIGDI
 21652     ELSE IF DFHEIGDJ EQUAL 25
 21653         GO TO 8584-BXRF-NOT-FOUND,
 21654               8584-BXRF-NOT-FOUND
 21655         DEPENDING ON DFHEIGDI
 21656     ELSE IF DFHEIGDJ EQUAL 26
 21657         GO TO 8585-PLAN-NOT-FOUND,
 21658               8585-PLAN-NOT-FOUND
 21659         DEPENDING ON DFHEIGDI
 21660     ELSE IF DFHEIGDJ EQUAL 27
 21661         GO TO 0299-CERT-NOT-FOUND
 21662         DEPENDING ON DFHEIGDI
 21663     ELSE IF DFHEIGDJ EQUAL 28
 21664         GO TO 8700-READ-CERT-MASTER
 21665         DEPENDING ON DFHEIGDI
 21666     ELSE IF DFHEIGDJ EQUAL 29
 21667         GO TO 8720-COMP-ACCOUNTS,
 21668               8730-END-BROWSE,
 21669               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 15-Mar-13 10:36 Page 401
* EL050.cbl
 21670         DEPENDING ON DFHEIGDI
 21671     ELSE IF DFHEIGDJ EQUAL 30
 21672         GO TO 9000-NOTFND
 21673         DEPENDING ON DFHEIGDI
 21674     ELSE IF DFHEIGDJ EQUAL 31
 21675         GO TO 9100-NOTFND,
 21676               9100-NOTFND
 21677         DEPENDING ON DFHEIGDI
 21678     ELSE IF DFHEIGDJ EQUAL 32
 21679         GO TO 9991-CRTO-NOT-FOUND,
 21680               9991-CRTO-NOT-FOUND
 21681         DEPENDING ON DFHEIGDI.
 21682     MOVE '9%                    "   ' TO DFHEIV0
 21683     MOVE 'EL050' TO DFHEIV1
 21684     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21685     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87704
