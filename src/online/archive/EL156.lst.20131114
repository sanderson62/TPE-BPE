* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48******************************************************************
    49
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   3
* EL156.cbl
    51 ENVIRONMENT DIVISION.
    52
    53 DATA DIVISION.
    54
    55 WORKING-STORAGE SECTION.
    56 01  DFH-START PIC X(04).
    57
    58 77  FILLER  PIC X(32)  VALUE '********************************'.
    59 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    60 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    61 77  WS-SSN  PIC X(9) VALUE ZEROS.
    62 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    63 77  C0                          PIC S999 COMP-3 VALUE +0.
    64 77  C1                          PIC S999 COMP-3 VALUE +0.
    65 77  C2                          PIC S999 COMP-3 VALUE +0.
    66 77  C3                          PIC S999 COMP-3 VALUE +0.
    67 77  s1                          PIC S999 COMP-3 VALUE +0.
    68 77  s2                          pic s999 comp-3 value +0.
    69 77  P1                          PIC S999 COMP-3 VALUE +0.
    70 77  DD-IU-SW                    PIC X   VALUE ' '.
    71     88  DD-IU-PRESENT                 VALUE 'Y'.
    72 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    73 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    74 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    75 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    76 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    77 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    78 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    79 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    80 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    81
    82*    COPY ELCSCTM.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCTM                             *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-MESSAGE.
    93     12  FILLER                          PIC X(30)
    94            VALUE '** LOGIC SECURITY VIOLATION -'.
    95     12  SM-READ                         PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' PGM='.
    98     12  SM-PGM                          PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' OPR='.
   101     12  SM-PROCESSOR-ID                 PIC X(4).
   102     12  FILLER                          PIC X(6)
   103            VALUE ' TERM='.
   104     12  SM-TERMID                       PIC X(4).
   105     12  FILLER                          PIC XX   VALUE SPACE.
   106     12  SM-JUL-DATE                     PIC 9(5).
   107     12  FILLER                          PIC X    VALUE SPACE.
   108     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   4
* EL156.cbl
   109
   110
   111*    COPY ELCSCRTY.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCRTY                            *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   119*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   120*        SAVED IN PI-SECURITY-ADDRESS.                           *
   121*                                                                *
   122******************************************************************
   123 01  SECURITY-CONTROL.
   124     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   125     12  FILLER                       PIC XX    VALUE 'SC'.
   126     12  SC-CREDIT-CODES.
   127         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   128             20  SC-CREDIT-DISPLAY    PIC X.
   129             20  SC-CREDIT-UPDATE     PIC X.
   130     12  SC-CLAIMS-CODES.
   131         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   132             20  SC-CLAIMS-DISPLAY    PIC X.
   133             20  SC-CLAIMS-UPDATE     PIC X.
   134
   135 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   136 01  WS-DATE-AREA.
   137     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   138     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   139     12  SAVE-DATE-CCYYMMDD.
   140         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   141         16  SAVE-DATE-YMD.
   142             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   143             20  FILLER              PIC X(04)   VALUE SPACES.
   144
   145 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   146 01  STANDARD-AREAS.
   147     12  WS-RESPONSE         PIC S9(8)   COMP.
   148         88  WS-RESP-NORMAL              VALUE +00.
   149         88  WS-RESP-ERROR               VALUE +01.
   150         88  WS-RESP-NOTFND              VALUE +13.
   151         88  WS-RESP-DUPREC              VALUE +14.
   152         88  WS-RESP-ENDFILE             VALUE +20.
   153     12  PMT-HEAD-A.
   154         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   155         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   156         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   157-        '     RESERVES  TYPE    AMOUNT'.
   158     12  PMT-HEAD-B.
   159         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   160         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   161         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   162     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   163     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   164     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   165     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   166     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   5
* EL156.cbl
   167     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   168     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   169     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   170     12  PGM-NAME            PIC X(8).
   171     12  TIME-IN             PIC S9(7).
   172     12  TIME-OUT-R  REDEFINES TIME-IN.
   173         16  FILLER          PIC X.
   174         16  TIME-OUT        PIC 99V99.
   175         16  FILLER          PIC XX.
   176     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   177     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   178     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   179     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   180     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   181     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   182     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   183     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   184     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   185     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   186     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   187     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   188     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   189     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   190     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   191     12  WS-BLANK            PIC X       VALUE ' '.
   192
   193 01  MISC-WORK-AREAS.
   194     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   195     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   196     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   197     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   198     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   199     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   200     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   201     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   202     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   203     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   204     12  W-CALLED-NAME           PIC X(08).
   205     12  W-EOB-CODES.
   206         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   207             20  W-EOB-CODE      PIC XXX.
   208             20  W-EOB-FILLER    PIC X.
   209     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   210     12  W-NAME-LAST             PIC X(15).
   211     12  W-NAME-FIRST            PIC X(15).
   212     12  W-NAME-MIDDLE.
   213         16  FILLER              PIC X.
   214         16  W-NAME-MIDDLE-2     PIC X.
   215         16  FILLER              PIC X(13).
   216     12  W-DMD-CHECK-NO.
   217         16  W-DMD-CHECK-NO-1    PIC X(4).
   218         16  W-DMD-CHECK-NO-2    PIC X.
   219         16  W-DMD-CHECK-NO-3    PIC XX.
   220
   221     12  WS-COMPUTE-FROM-DT  PIC XX.
   222     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   223     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   224     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   6
* EL156.cbl
   225     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   226     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   227     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   228         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   229         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   230     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   231         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   232     12  WS-UPDATE-SW        PIC X VALUE ' '.
   233     12  WS-GROUPING.
   234         16  WS-GROUP-1      PIC X VALUE SPACES.
   235         16  FILLER          PIC X(05) VALUE SPACES.
   236     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   237     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   238     12  WS-WORK-STATE-ACCT.
   239         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   240         16  FILLER          PIC X       VALUE '/'.
   241         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   242     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   243     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   244     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   245     12  QID.
   246         16  QID-TERM        PIC X(4)    VALUE SPACES.
   247         16  FILLER          PIC X(4)    VALUE '156A'.
   248     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   249     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   250     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   251     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   252     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   253     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   254     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   255     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   256     12  WS-STATUS           PIC X       VALUE SPACES.
   257     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   258     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   259     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   260     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   261     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   262     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   263     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   264     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   265     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   266     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   267     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   268     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   269     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   270     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   271     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   272     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   273     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   274     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   275     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   276     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   277     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   278     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   279     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   280     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   281     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   282     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   7
* EL156.cbl
   283     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   284     12  WORK-DATE-FROM.
   285         16  WDF-MONTH       PIC 99        VALUE ZERO.
   286         16  WDF-DAY         PIC 99        VALUE ZERO.
   287         16  WDF-YEAR        PIC 99        VALUE ZERO.
   288     12  WORK-DATE-THRU.
   289         16  WDT-MONTH       PIC 99        VALUE ZERO.
   290         16  WDT-DAY         PIC 99        VALUE ZERO.
   291         16  WDT-YEAR        PIC 99        VALUE ZERO.
   292     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   293     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   294     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   295     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   296     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   297     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   298     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   299     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   300     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   301     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   302     12  WS-PY-WK REDEFINES WS-PY-WORK.
   303         16  WS-PY-NUM       PIC S9(7)V99.
   304         16  WS-PY-SIGN      PIC X.
   305     12  WS-DY-WORK          PIC S9(5).
   306     12  WS-DY-WK REDEFINES WS-DY-WORK.
   307         16  WS-DY-NUM       PIC S9(4).
   308         16  WS-DY-SIGN      PIC X.
   309     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   310         88  COMP-REC-FOUND              VALUE 'Y'.
   311     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   312         88  BENEFIT-FOUND       VALUE 'Y'.
   313         88  NO-BENEFIT-FOUND    VALUE 'N'.
   314     12  WS-TERMS.
   315         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   316         16  FILLER          PIC X       VALUE '/'.
   317         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   318         16  WST-REM-DAYS-GRP.
   319             20  WST-SLASH   PIC X       VALUE '/'.
   320             20  WST-REM-DAYS
   321                             PIC --9.
   322     12  WS-ACCESS.
   323         16  FILLER          PIC XX      VALUE SPACES.
   324         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   325     12  WS-STATE-ACCESS.
   326         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   327         16  FILLER          PIC XX      VALUE SPACES.
   328     12  WS-CARR-ACCESS.
   329         16  FILLER          PIC X(3)    VALUE SPACES.
   330         16  WS-CARR         PIC X       VALUE SPACES.
   331     12  DATE-WORK.
   332         16  FILLER          PIC XX      VALUE SPACES.
   333         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   334     12  WS-SAVE-INPUT.
   335         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   336         16  WS-PAYEE        PIC XX      VALUE SPACE.
   337         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   338         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   339         16  WS-OFFLINE      PIC X       VALUE SPACE.
   340         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   8
* EL156.cbl
   341         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   342         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   343         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   344         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   345         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   346         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   347         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   348         16  WS-ETYPE        PIC X       VALUE SPACE.
   349         16  WS-CASH         PIC X       VALUE SPACE.
   350         16  WS-GROUPED      PIC X       VALUE SPACE.
   351         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   352         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   353         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   354         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   355         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   356         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   357         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   358         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   359     12  LAST-ERROR-LINE.
   360         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   361         16  FILLER              PIC X(30)
   362             VALUE ' FATAL ERRORS ENCOUNTERED'.
   363         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   364         16  FILLER              PIC X(28)
   365             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   366     12  WS-CHECK-AREA.
   367         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   368         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   369     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   370     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   371         16  FILLER              PIC XX.
   372         16  WS-A-CHECK-NUM-5    PIC 9(5).
   373     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   374         16  FILLER              PIC X.
   375         16  WS-A-CHECK-NUM-6    PIC 9(6).
   376     12  OPTION-1-SAVE-AREA.
   377         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   378         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   379     12  WS-WORK-ZIP.
   380         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   381         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   382     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   383                                 PIC 9(9).
   384     12  WS-FLI-PMTNOTE.
   385         16  WS-PMTOPTION        PIC XX.
   386         16  WS-DOCNAME          PIC X(28).
   387         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   388             20  WS-AMOUNT       PIC X(8).
   389             20  FILLER          PIC X(20).
   390         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   391             20  WS-NUM-AMT      PIC 9(6)V99.
   392             20  FILLER          PIC X(20).
   393
   394     12  WS-HAN-PMTNOTE.
   395         16  WS-HAN-PMT-CODE     PIC X.
   396         16  WS-HAN-PMT-NOTE     PIC X(39).
   397
   398     12  WS-NCL-PMT-OPTION       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page   9
* EL156.cbl
   399         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   400
   401     12  WS-CLAIM-SEQUENCE.
   402         16  FILLER              PIC X VALUE '('.
   403         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   404         16  FILLER              PIC X(04) VALUE ' OF '.
   405         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   406         16  FILLER              PIC X VALUE ')'.
   407
   408     12  WS-REFUND-AMT           PIC Z(7).99.
   409     12  WS-CALC-INT             PIC S9(7)V99.
   410     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   411
   412     12  SUB                     PIC 99 VALUE ZEROS.
   413
   414     12  WS-BOANOTE1.
   415         16  WS-BOANOTE1-DESC    PIC X(11).
   416         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   417         16  FILLER              PIC X(17).
   418     12  WS-BOANOTE2.
   419         16  WS-BOANOTE2-DESC    PIC X(11).
   420         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   421         16  FILLER              PIC X(17).
   422
   423     12  WS-NCLNOTE1.
   424         16  WS-NCLNOTE1-DESC    PIC X(11).
   425         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   426         16  FILLER              PIC X(17).
   427     12  WS-NCLNOTE2.
   428         16  WS-NCLNOTE2-DESC    PIC X(11).
   429         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   430         16  FILLER              PIC X(17).
   431
   432     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   433     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   434     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   435     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   436     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   437     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   438     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   439     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   440     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   441     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   442
   443     12  WS-AIG-WORK-AREAS.
   444         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   445             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   446         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   447             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   448         16  WS-FROM-DATE-MDY.
   449             20  WS-FROM-MO      PIC 99.
   450             20  WS-FROM-DA      PIC 99.
   451             20  WS-FROM-YR      PIC 99.
   452         16  WS-TEMP-DATE-MDY.
   453             20  WS-TEMP-MO      PIC 99.
   454             20  WS-TEMP-DA      PIC 99.
   455             20  WS-TEMP-YR      PIC 99.
   456         16  WS-BIN-FROM-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  10
* EL156.cbl
   457         16  WS-TEMP-INC-MDY.
   458             20  WS-TEMP-INC-MO  PIC 99.
   459             20  WS-TEMP-INC-DA  PIC 99.
   460             20  WS-TEMP-INC-YR  PIC 99.
   461         16  WS-PMT-DUE-MDY.
   462             20  WS-PMT-DUE-MO   PIC 99.
   463             20  WS-PMT-DUE-DA   PIC 99.
   464             20  WS-PMT-DUE-YR   PIC 99.
   465         16  WS-PMT-DUE-DT       PIC XX.
   466         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   467         16  WS-RETRO-ELIM-DT    PIC XX.
   468         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   469             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   470         16  WS-SAVE-DUE-DA      PIC 99.
   471         16  WS-CDAYS            PIC S9(05).
   472         16  WS-DAYS-OFF         PIC S9(05).
   473         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   474             88  ELIM-SATISFIED            VALUE 'Y'.
   475         16  WS-AIG-CHECKNO.
   476             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   477             20  WS-A-CHECKNO-3-7.
   478                 24  FILLER              PIC X(3)    VALUE SPACES.
   479                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   480                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   481         16  WS-AIG-GROUPING.
   482             20  WS-A-BENE               PIC XXX.
   483             20  FILLER                  PIC XXX.
   484         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   485             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   486             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   487         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   488                 VALUE 'UNEMPLOYMENT PAYMENT'.
   489         16  WS-CHK-THRU-DT              PIC XX.
   490         16  WS-HOLD-BIN-DATE-1          PIC XX.
   491
   492 01  MISC-CSO-AREA.
   493     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   494     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   495     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   496         88  APPROVAL-NEEDED                        VALUE 'Y'.
   497     12  WS-APPROV-NOTE                  PIC X(43)
   498         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   499     12  WS-REAUDIT-NOTE                 PIC X(43)
   500         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   501     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   502     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   503     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   504     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   505     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   506     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   507     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   508         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   509     12  WS-PAYEE-CITY-STATE     PIC X(30).
   510     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   511         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   512     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   513     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   514     12  WS-WORK-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  11
* EL156.cbl
   515     12  FILLER  REDEFINES WS-WORK-NAME.
   516         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   517     12  WS-INSURED-NAME         PIC X(30).
   518     12  FILLER  REDEFINES WS-INSURED-NAME.
   519         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   520     12  WS-PAYEE-NAME           PIC X(30).
   521     12  FILLER  REDEFINES WS-PAYEE-NAME.
   522         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   523
   524 01  ERROR-MESSAGES.
   525     12  ER-0000                 PIC X(4)  VALUE '0000'.
   526     12  ER-0004                 PIC X(4)  VALUE '0004'.
   527     12  ER-0008                 PIC X(4)  VALUE '0008'.
   528     12  ER-0019                 PIC X(4)  VALUE '0019'.
   529     12  ER-0029                 PIC X(4)  VALUE '0029'.
   530     12  ER-0042                 PIC X(4)  VALUE '0042'.
   531     12  ER-0070                 PIC X(4)  VALUE '0070'.
   532     12  ER-0130                 PIC X(4)  VALUE '0130'.
   533     12  ER-0149                 PIC X(4)  VALUE '0149'.
   534     12  ER-0154                 PIC X(4)  VALUE '0154'.
   535     12  ER-0168                 PIC X(4)  VALUE '0168'.
   536     12  ER-0169                 PIC X(4)  VALUE '0169'.
   537     12  ER-0172                 PIC X(4)  VALUE '0174'.
   538     12  ER-0198                 PIC X(4)  VALUE '0198'.
   539     12  ER-0204                 PIC X(4)  VALUE '0204'.
   540     12  ER-0206                 PIC X(4)  VALUE '0206'.
   541     12  ER-0252                 PIC X(4)  VALUE '0252'.
   542     12  ER-0254                 PIC X(4)  VALUE '0254'.
   543     12  ER-0282                 PIC X(4)  VALUE '0282'.
   544     12  ER-0283                 PIC X(4)  VALUE '0283'.
   545     12  ER-0294                 PIC X(4)  VALUE '0294'.
   546     12  ER-0338                 PIC X(4)  VALUE '0338'.
   547     12  ER-0419                 PIC X(4)  VALUE '0419'.
   548     12  ER-0420                 PIC X(4)  VALUE '0420'.
   549     12  ER-0421                 PIC X(4)  VALUE '0421'.
   550     12  ER-0422                 PIC X(4)  VALUE '0422'.
   551     12  ER-0433                 PIC X(4)  VALUE '0433'.
   552     12  ER-0436                 PIC X(4)  VALUE '0436'.
   553     12  ER-0437                 PIC X(4)  VALUE '0437'.
   554     12  ER-0438                 PIC X(4)  VALUE '0438'.
   555     12  ER-0439                 PIC X(4)  VALUE '0439'.
   556     12  ER-0440                 PIC X(4)  VALUE '0440'.
   557     12  ER-0441                 PIC X(4)  VALUE '0441'.
   558     12  ER-0442                 PIC X(4)  VALUE '0442'.
   559     12  ER-0443                 PIC X(4)  VALUE '0443'.
   560     12  ER-0444                 PIC X(4)  VALUE '0444'.
   561     12  ER-0445                 PIC X(4)  VALUE '0445'.
   562     12  ER-0446                 PIC X(4)  VALUE '0446'.
   563     12  ER-0447                 PIC X(4)  VALUE '0447'.
   564     12  ER-0448                 PIC X(4)  VALUE '0448'.
   565     12  ER-0449                 PIC X(4)  VALUE '0449'.
   566     12  ER-0452                 PIC X(4)  VALUE '0452'.
   567     12  ER-0458                 PIC X(4)  VALUE '0458'.
   568     12  ER-0459                 PIC X(4)  VALUE '0459'.
   569     12  ER-0460                 PIC X(4)  VALUE '0460'.
   570     12  ER-0461                 PIC X(4)  VALUE '0461'.
   571     12  ER-0462                 PIC X(4)  VALUE '0462'.
   572     12  ER-0463                 PIC X(4)  VALUE '0463'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  12
* EL156.cbl
   573     12  ER-0464                 PIC X(4)  VALUE '0464'.
   574     12  ER-0465                 PIC X(4)  VALUE '0465'.
   575     12  ER-0466                 PIC X(4)  VALUE '0466'.
   576     12  ER-0467                 PIC X(4)  VALUE '0467'.
   577     12  ER-0468                 PIC X(4)  VALUE '0468'.
   578     12  ER-0469                 PIC X(4)  VALUE '0469'.
   579     12  ER-0473                 PIC X(4)  VALUE '0473'.
   580     12  ER-0474                 PIC X(4)  VALUE '0474'.
   581     12  ER-0475                 PIC X(4)  VALUE '0475'.
   582     12  ER-0476                 PIC X(4)  VALUE '0476'.
   583     12  ER-0477                 PIC X(4)  VALUE '0477'.
   584     12  ER-0478                 PIC X(4)  VALUE '0478'.
   585     12  ER-0479                 PIC X(4)  VALUE '0479'.
   586     12  ER-0481                 PIC X(4)  VALUE '0481'.
   587     12  ER-0491                 PIC X(4)  VALUE '0491'.
   588     12  ER-0492                 PIC X(4)  VALUE '0492'.
   589     12  ER-0493                 PIC X(4)  VALUE '0493'.
   590     12  ER-0494                 PIC X(4)  VALUE '0494'.
   591     12  ER-0495                 PIC X(4)  VALUE '0495'.
   592     12  ER-0499                 PIC X(4)  VALUE '0499'.
   593     12  ER-0500                 PIC X(4)  VALUE '0500'.
   594     12  ER-0501                 PIC X(4)  VALUE '0501'.
   595     12  ER-0502                 PIC X(4)  VALUE '0502'.
   596     12  ER-0508                 PIC X(4)  VALUE '0508'.
   597     12  ER-0513                 PIC X(4)  VALUE '0513'.
   598     12  ER-0518                 PIC X(4)  VALUE '0518'.
   599     12  ER-0524                 PIC X(4)  VALUE '0524'.
   600     12  ER-0525                 PIC X(4)  VALUE '0525'.
   601     12  ER-0526                 PIC X(4)  VALUE '0526'.
   602     12  ER-0530                 PIC X(4)  VALUE '0530'.
   603     12  ER-0540                 PIC X(4)  VALUE '0540'.
   604     12  ER-0541                 PIC X(4)  VALUE '0541'.
   605     12  ER-0542                 PIC X(4)  VALUE '0542'.
   606     12  ER-0543                 PIC X(4)  VALUE '0543'.
   607     12  ER-0545                 PIC X(4)  VALUE '0545'.
   608     12  ER-0552                 PIC X(4)  VALUE '0552'.
   609     12  ER-0555                 PIC X(4)  VALUE '0555'.
   610     12  ER-0556                 PIC X(4)  VALUE '0556'.
   611     12  ER-0557                 PIC X(4)  VALUE '0557'.
   612     12  ER-0572                 PIC X(4)  VALUE '0572'.
   613     12  ER-0573                 PIC X(4)  VALUE '0573'.
   614     12  ER-0594                 PIC X(4)  VALUE '0594'.
   615     12  ER-0616                 PIC X(4)  VALUE '0616'.
   616     12  ER-0617                 PIC X(4)  VALUE '0617'.
   617     12  ER-0618                 PIC X(4)  VALUE '0618'.
   618     12  ER-0657                 PIC X(4)  VALUE '0657'.
   619     12  ER-0658                 PIC X(4)  VALUE '0658'.
   620     12  ER-0699                 PIC X(4)  VALUE '0699'.
   621     12  ER-0730                 PIC X(4)  VALUE '0730'.
   622     12  ER-0737                 PIC X(4)  VALUE '0737'.
   623     12  ER-0760                 PIC X(4)  VALUE '0760'.
   624     12  ER-0768                 PIC X(4)  VALUE '0768'.
   625     12  ER-0769                 PIC X(4)  VALUE '0769'.
   626     12  ER-0770                 PIC X(4)  VALUE '0770'.
   627     12  ER-0802                 PIC X(4)  VALUE '0802'.
   628     12  ER-0803                 PIC X(4)  VALUE '0803'.
   629     12  ER-0819                 PIC X(4)  VALUE '0819'.
   630     12  ER-0834                 PIC X(4)  VALUE '0834'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  13
* EL156.cbl
   631     12  ER-0836                 PIC X(4)  VALUE '0836'.
   632     12  ER-0844                 PIC X(4)  VALUE '0844'.
   633     12  ER-0845                 PIC X(4)  VALUE '0845'.
   634     12  ER-0846                 PIC X(4)  VALUE '0846'.
   635     12  ER-0849                 PIC X(4)  VALUE '0849'.
   636     12  ER-0851                 PIC X(4)  VALUE '0851'.
   637     12  ER-0872                 PIC X(4)  VALUE '0872'.
   638     12  ER-0873                 PIC X(4)  VALUE '0873'.
   639     12  ER-0874                 PIC X(4)  VALUE '0874'.
   640     12  ER-0879                 PIC X(4)  VALUE '0879'.
   641     12  ER-0919                 PIC X(4)  VALUE '0919'.
   642     12  ER-0921                 PIC X(4)  VALUE '0921'.
   643     12  ER-0923                 PIC X(4)  VALUE '0923'.
   644     12  ER-0925                 PIC X(4)  VALUE '0925'.
   645     12  ER-0944                 PIC X(4)  VALUE '0944'.
   646     12  ER-0945                 PIC X(4)  VALUE '0945'.
   647     12  ER-0946                 PIC X(4)  VALUE '0946'.
   648     12  ER-0947                 PIC X(4)  VALUE '0947'.
   649     12  ER-0948                 PIC X(4)  VALUE '0948'.
   650     12  ER-0949                 PIC X(4)  VALUE '0949'.
   651     12  ER-0950                 PIC X(4)  VALUE '0950'.
   652     12  ER-0951                 PIC X(4)  VALUE '0951'.
   653     12  ER-0954                 PIC X(4)  VALUE '0954'.
   654     12  ER-0956                 PIC X(4)  VALUE '0956'.
   655     12  ER-0967                 PIC X(4)  VALUE '0967'.
   656     12  ER-0968                 PIC X(4)  VALUE '0968'.
   657     12  ER-0974                 PIC X(4)  VALUE '0974'.
   658     12  ER-0975                 PIC X(4)  VALUE '0975'.
   659     12  ER-1561                 PIC X(4)  VALUE '1561'.
   660     12  ER-1566                 PIC X(4)  VALUE '1566'.
   661     12  ER-1567                 PIC X(4)  VALUE '1567'.
   662     12  ER-1569                 PIC X(4)  VALUE '1569'.
   663     12  er-1657                 pic x(4)  value '1657'.
   664     12  er-1658                 pic x(4)  value '1658'.
   665     12  ER-1775                 PIC X(4)  VALUE '1775'.
   666     12  ER-1880                 PIC X(4)  VALUE '1880'.
   667     12  ER-2044                 PIC X(4)  VALUE '2044'.
   668     12  ER-3140                 PIC X(4)  VALUE '3140'.
   669     12  ER-3141                 PIC X(4)  VALUE '3141'.
   670     12  ER-3255                 PIC X(4)  VALUE '3255'.
   671     12  ER-3516                 PIC X(4)  VALUE '3516'.
   672     12  ER-3527                 PIC X(4)  VALUE '3527'.
   673     12  ER-3528                 PIC X(4)  VALUE '3528'.
   674     12  ER-3529                 PIC X(4)  VALUE '3529'.
   675     12  ER-3530                 PIC X(4)  VALUE '3530'.
   676     12  ER-3531                 PIC X(4)  VALUE '3531'.
   677     12  ER-3532                 PIC X(4)  VALUE '3532'.
   678     12  ER-3533                 PIC X(4)  VALUE '3533'.
   679     12  ER-3534                 PIC X(4)  VALUE '3534'.
   680     12  ER-3535                 PIC X(4)  VALUE '3535'.
   681     12  ER-3536                 PIC X(4)  VALUE '3536'.
   682     12  ER-3537                 PIC X(4)  VALUE '3537'.
   683     12  ER-3538                 PIC X(4)  VALUE '3538'.
   684     12  ER-3539                 PIC X(4)  VALUE '3539'.
   685     12  ER-3540                 PIC X(4)  VALUE '3540'.
   686     12  ER-3541                 PIC X(4)  VALUE '3541'.
   687     12  ER-3542                 PIC X(4)  VALUE '3542'.
   688     12  ER-3543                 PIC X(4)  VALUE '3543'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  14
* EL156.cbl
   689     12  ER-3546                 PIC X(4)  VALUE '3546'.
   690     12  ER-3549                 PIC X(4)  VALUE '3549'.
   691     12  ER-3818                 PIC X(4)  VALUE '3818'.
   692     12  ER-7540                 PIC X(4)  VALUE '7540'.
   693     12  ER-7576                 PIC X(4)  VALUE '7576'.
   694     12  ER-7579                 PIC X(4)  VALUE '7579'.
   695     12  ER-7830                 PIC X(4)  VALUE '7830'.
   696     12  ER-7831                 PIC X(4)  VALUE '7831'.
   697     12  ER-7832                 PIC X(4)  VALUE '7832'.
   698     12  ER-7833                 PIC X(4)  VALUE '7833'.
   699     12  ER-7834                 PIC X(4)  VALUE '7834'.
   700     12  ER-7835                 PIC X(4)  VALUE '7835'.
   701     12  ER-7836                 PIC X(4)  VALUE '7836'.
   702     12  ER-7837                 PIC X(4)  VALUE '7837'.
   703     12  ER-7838                 PIC X(4)  VALUE '7838'.
   704     12  ER-7841                 PIC X(4)  VALUE '7841'.
   705     12  ER-7844                 PIC X(4)  VALUE '7844'.
   706     12  ER-7845                 PIC X(4)  VALUE '7845'.
   707     12  ER-8000                 PIC X(4)  VALUE '8000'.
   708     12  ER-8051                 PIC X(4)  VALUE '8051'.
   709     12  ER-8052                 PIC X(4)  VALUE '8052'.
   710     12  ER-8053                 PIC X(4)  VALUE '8053'.
   711     12  ER-8054                 PIC X(4)  VALUE '8054'.
   712     12  ER-8055                 PIC X(4)  VALUE '8055'.
   713     12  ER-8056                 PIC X(4)  VALUE '8056'.
   714     12  ER-8057                 PIC X(4)  VALUE '8057'.
   715     12  ER-8058                 PIC X(4)  VALUE '8058'.
   716     12  ER-8059                 PIC X(4)  VALUE '8059'.
   717     12  ER-8060                 PIC X(4)  VALUE '8060'.
   718     12  ER-8061                 PIC X(4)  VALUE '8061'.
   719     12  ER-8062                 PIC X(4)  VALUE '8062'.
   720     12  ER-8063                 PIC X(4)  VALUE '8063'.
   721     12  ER-8064                 PIC X(4)  VALUE '8064'.
   722     12  ER-8065                 PIC X(4)  VALUE '8065'.
   723     12  ER-8066                 PIC X(4)  VALUE '8066'.
   724     12  ER-8146                 PIC X(4)  VALUE '8146'.
   725     12  ER-8147                 PIC X(4)  VALUE '8147'.
   726     12  ER-8152                 PIC X(4)  VALUE '8152'.
   727     12  ER-8153                 PIC X(4)  VALUE '8153'.
   728     12  ER-8154                 PIC X(4)  VALUE '8154'.
   729     12  ER-8155                 PIC X(4)  VALUE '8155'.
   730     12  ER-8310                 PIC X(4)  VALUE '8310'.
   731     12  ER-8311                 PIC X(4)  VALUE '8311'.
   732     12  ER-8312                 PIC X(4)  VALUE '8312'.
   733     12  ER-8313                 PIC X(4)  VALUE '8313'.
   734     12  ER-8314                 PIC X(4)  VALUE '8314'.
   735     12  ER-8315                 PIC X(4)  VALUE '8315'.
   736     12  ER-8316                 PIC X(4)  VALUE '8316'.
   737     12  ER-8317                 PIC X(4)  VALUE '8317'.
   738
   739 01  CSO-WORK-FIELDS.
   740     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   741       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   742
   743     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   744     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   745         88  CERT-NOTE-ADDED           VALUE 'Y'.
   746     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  15
* EL156.cbl
   747         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   748     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   749
   750     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   751
   752 01  SC-NP6-CERT-NOTE.
   753     12  FILLER                  PIC X(12)
   754               VALUE 'REM BENEFIT '.
   755     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   756     12  SC-NP6-COMM             PIC X(8)
   757               VALUE ' + 6 MO '.
   758     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   759     12  FILLER                  PIC X(12)
   760               VALUE ' = AMT PAID '.
   761     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   762
   763 01  SC-NP6-ORIG-NOTE.
   764     12  FILLER                  PIC X(63)  VALUE
   765         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   766 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   767     88  PDEF-FOUND                   VALUE 'Y'.
   768 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   769     88  ACCT-FOUND                   VALUE 'Y'.
   770 01  CTBL-KEY-SAVE               PIC X(5).
   771 01  CTBL-KEY.
   772     05  CTBL-COMPANY-CD         PIC X.
   773     05  CTBL-TABLE              PIC XXX.
   774     05  CTBL-BEN-TYPE           PIC X.
   775     05  CTBL-BEN-CODE           PIC XX.
   776 01  ERPDEF-KEY-SAVE             PIC X(18).
   777 01  ERPDEF-KEY.
   778     12  ERPDEF-COMPANY-CD       PIC X.
   779     12  ERPDEF-STATE            PIC XX.
   780     12  ERPDEF-PROD-CD          PIC XXX.
   781     12  F                       PIC X(7).
   782     12  ERPDEF-BEN-TYPE         PIC X.
   783     12  ERPDEF-BEN-CODE         PIC XX.
   784     12  ERPDEF-EXP-DT           PIC XX.
   785 01  ELCRTT-KEY.
   786     05  CTRLR-COMP-CD       PIC X.
   787     05  CTRLR-CARRIER       PIC X.
   788     05  CTRLR-GROUPING      PIC X(6).
   789     05  CTRLR-STATE         PIC X(2).
   790     05  CTRLR-ACCOUNT       PIC X(10).
   791     05  CTRLR-EFF-DT        PIC XX.
   792     05  CTRLR-CERT-NO       PIC X(11).
   793     05  CTRLR-REC-TYPE      PIC X.
   794 01  ACCESS-KEYS.
   795     12  ELARCH-KEY.
   796         16  ARCH-CO             PIC X.
   797         16  ARCH-NUMBER         PIC S9(08) COMP.
   798         16  ARCH-REC-TYPE       PIC X.
   799         16  ARCH-SEQ            PIC S9(04) COMP.
   800     12  ELMSTR-KEY.
   801         16  MSTR-COMP-CD        PIC X.
   802         16  MSTR-CARRIER        PIC X.
   803         16  MSTR-CLAIM-NO       PIC X(7).
   804         16  MSTR-CERT-NO        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  16
* EL156.cbl
   805     12  ELCNTL-KEY.
   806         16  CNTL-COMP-ID        PIC X(3).
   807         16  CNTL-REC-TYPE       PIC X.
   808         16  CNTL-ACCESS         PIC X(4).
   809         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   810     12  ELCERT-KEY.
   811         16  CERT-COMP-CD        PIC X.
   812         16  CERT-CARRIER        PIC X.
   813         16  CERT-GROUPING       PIC X(6).
   814         16  CERT-STATE          PIC XX.
   815         16  CERT-ACCOUNT        PIC X(10).
   816         16  CERT-EFF-DT         PIC XX.
   817         16  CERT-CERT-NO        PIC X(11).
   818     12  ELTRLR-KEY.
   819         16  TRLR-COMP-CD        PIC X.
   820         16  TRLR-CARRIER        PIC X.
   821         16  TRLR-CLAIM-NO       PIC X(7).
   822         16  TRLR-CERT-NO        PIC X(11).
   823         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   824     12  ELACTQ-KEY.
   825         16  ACTQ-COMP-CD        PIC X.
   826         16  ACTQ-CARRIER        PIC X.
   827         16  ACTQ-CLAIM-NO       PIC X(7).
   828         16  ACTQ-CERT-NO        PIC X(11).
   829     12  W-NOTE-KEY.
   830         16  W-NOTE-COMP-CD      PIC X.
   831         16  W-NOTE-CERT-KEY.
   832             20  W-NOTE-CARRIER  PIC X.
   833             20  W-NOTE-GROUPING PIC X(6).
   834             20  W-NOTE-STATE    PIC XX.
   835             20  W-NOTE-ACCOUNT  PIC X(10).
   836             20  W-NOTE-EFF-DT   PIC XX.
   837             20  W-NOTE-CERT-NO  PIC X(11).
   838     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   839     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   840     12  ERACCT-KEY.
   841         16  ERACCT-PARTIAL-KEY.
   842             20  ACCT-COMP-CD    PIC X.
   843             20  ACCT-CARRIER    PIC X.
   844             20  ACCT-GROUPING   PIC X(6).
   845             20  ACCT-STATE      PIC XX.
   846             20  ACCT-ACCOUNT    PIC X(10).
   847         16  ACCT-EXP-DT         PIC XX.
   848         16  FILLER              PIC X(4) VALUE SPACES.
   849     12  ELCHKQ-KEY.
   850         16  CHKQ-COMP-CD        PIC X.
   851         16  CHKQ-CONTROL        PIC S9(8) COMP.
   852         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   853     12  ELBENE-KEY.
   854         16  BENE-COMP-CD         PIC X.
   855         16  BENE-RECORD-TYPE     PIC X.
   856         16  BENE-NUMBER          PIC X(10).
   857     12  ERCOMP-KEY.
   858         16  COMP-COMP-CD        PIC X.
   859         16  COMP-CARRIER        PIC X.
   860         16  COMP-GROUP          PIC X(06).
   861         16  COMP-FIN-RESP       PIC X(10).
   862         16  COMP-ACCOUNT        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  17
* EL156.cbl
   863         16  COMP-TYPE           PIC X.
   864
   865     12  DLO035-KEY.
   866         16  DL35-PROCESS-TYPE   PIC X.
   867         16  DL35-CREDIT-CARD    PIC X(20).
   868         16  DL35-BEN-TYPE       PIC XX.
   869         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   870         16  DL35-RETURN-CODE    PIC XX.
   871
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  18
* EL156.cbl
   873*    COPY ELCDATE.
   874******************************************************************
   875*                                                                *
   876*                                                                *
   877*                            ELCDATE.                            *
   878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   879*                            VMOD=2.003
   880*                                                                *
   881*                                                                *
   882*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   883*                 LENGTH = 200                                   *
   884******************************************************************
   885
   886 01  DATE-CONVERSION-DATA.
   887     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   888     12  DC-OPTION-CODE                PIC X.
   889         88  BIN-TO-GREG                VALUE ' '.
   890         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   891         88  EDIT-GREG-TO-BIN           VALUE '2'.
   892         88  YMD-GREG-TO-BIN            VALUE '3'.
   893         88  MDY-GREG-TO-BIN            VALUE '4'.
   894         88  JULIAN-TO-BIN              VALUE '5'.
   895         88  BIN-PLUS-ELAPSED           VALUE '6'.
   896         88  FIND-CENTURY               VALUE '7'.
   897         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   898         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   899         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   900         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   901         88  JULIAN-TO-BIN-3            VALUE 'C'.
   902         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   903         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   904         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   905         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   906         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   907         88  CHECK-LEAP-YEAR            VALUE 'H'.
   908         88  BIN-3-TO-GREG              VALUE 'I'.
   909         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   910         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   911         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   912         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   913         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   914         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   915         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   916         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   917         88  THREE-CHARACTER-BIN
   918                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   919         88  GREGORIAN-TO-BIN
   920                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   921         88  BIN-TO-GREGORIAN
   922                  VALUES ' ' '1' 'I' '8' 'G'.
   923         88  JULIAN-TO-BINARY
   924                  VALUES '5' 'C' 'E' 'F'.
   925     12  DC-ERROR-CODE                 PIC X.
   926         88  NO-CONVERSION-ERROR        VALUE ' '.
   927         88  DATE-CONVERSION-ERROR
   928                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   929         88  DATE-IS-ZERO               VALUE '1'.
   930         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  19
* EL156.cbl
   931         88  DATE-IS-INVALID            VALUE '3'.
   932         88  DATE1-GREATER-DATE2        VALUE '4'.
   933         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   934         88  DATE-INVALID-OPTION        VALUE '9'.
   935         88  INVALID-CENTURY            VALUE 'A'.
   936         88  ONLY-CENTURY               VALUE 'B'.
   937         88  ONLY-LEAP-YEAR             VALUE 'C'.
   938         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   939     12  DC-END-OF-MONTH               PIC X.
   940         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   941     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   942         88  USE-NORMAL-PROCESS         VALUE ' '.
   943         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   944         88  ADJUST-UP-100-YRS          VALUE '2'.
   945     12  FILLER                        PIC X.
   946     12  DC-CONVERSION-DATES.
   947         16  DC-BIN-DATE-1             PIC XX.
   948         16  DC-BIN-DATE-2             PIC XX.
   949         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   950         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   951                       DC-GREG-DATE-1-EDIT.
   952             20  DC-EDIT1-MONTH        PIC 99.
   953             20  SLASH1-1              PIC X.
   954             20  DC-EDIT1-DAY          PIC 99.
   955             20  SLASH1-2              PIC X.
   956             20  DC-EDIT1-YEAR         PIC 99.
   957         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   958         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   959                     DC-GREG-DATE-2-EDIT.
   960             20  DC-EDIT2-MONTH        PIC 99.
   961             20  SLASH2-1              PIC X.
   962             20  DC-EDIT2-DAY          PIC 99.
   963             20  SLASH2-2              PIC X.
   964             20  DC-EDIT2-YEAR         PIC 99.
   965         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   966         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   967                     DC-GREG-DATE-1-YMD.
   968             20  DC-YMD-YEAR           PIC 99.
   969             20  DC-YMD-MONTH          PIC 99.
   970             20  DC-YMD-DAY            PIC 99.
   971         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   972         16  DC-GREG-DATE-1-MDY-R REDEFINES
   973                      DC-GREG-DATE-1-MDY.
   974             20  DC-MDY-MONTH          PIC 99.
   975             20  DC-MDY-DAY            PIC 99.
   976             20  DC-MDY-YEAR           PIC 99.
   977         16  DC-GREG-DATE-1-ALPHA.
   978             20  DC-ALPHA-MONTH        PIC X(10).
   979             20  DC-ALPHA-DAY          PIC 99.
   980             20  FILLER                PIC XX.
   981             20  DC-ALPHA-CENTURY.
   982                 24 DC-ALPHA-CEN-N     PIC 99.
   983             20  DC-ALPHA-YEAR         PIC 99.
   984         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   985         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   986         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   987         16  DC-JULIAN-DATE            PIC 9(05).
   988         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  20
* EL156.cbl
   989                                       PIC 9(05).
   990         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   991             20  DC-JULIAN-YEAR        PIC 99.
   992             20  DC-JULIAN-DAYS        PIC 999.
   993         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   994         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   995         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   996     12  DATE-CONVERSION-VARIBLES.
   997         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   998         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   999             20  FILLER                PIC 9(3).
  1000             20  HOLD-CEN-1-CCYY.
  1001                 24  HOLD-CEN-1-CC     PIC 99.
  1002                 24  HOLD-CEN-1-YY     PIC 99.
  1003             20  HOLD-CEN-1-MO         PIC 99.
  1004             20  HOLD-CEN-1-DA         PIC 99.
  1005         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1006             20  HOLD-CEN-1-R-MO       PIC 99.
  1007             20  HOLD-CEN-1-R-DA       PIC 99.
  1008             20  HOLD-CEN-1-R-CCYY.
  1009                 24  HOLD-CEN-1-R-CC   PIC 99.
  1010                 24  HOLD-CEN-1-R-YY   PIC 99.
  1011             20  FILLER                PIC 9(3).
  1012         16  HOLD-CENTURY-1-X.
  1013             20  FILLER                PIC X(3)  VALUE SPACES.
  1014             20  HOLD-CEN-1-X-CCYY.
  1015                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1016                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1017             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1018             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1019         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1020             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1021             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1022             20  HOLD-CEN-1-R-X-CCYY.
  1023                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1024                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1025             20  FILLER                PIC XXX.
  1026         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1027         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1028         16  DC-JULIAN-DATE-1          PIC 9(07).
  1029         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1030             20  DC-JULIAN-1-CCYY.
  1031                 24  DC-JULIAN-1-CC    PIC 99.
  1032                 24  DC-JULIAN-1-YR    PIC 99.
  1033             20  DC-JULIAN-DA-1        PIC 999.
  1034         16  DC-JULIAN-DATE-2          PIC 9(07).
  1035         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1036             20  DC-JULIAN-2-CCYY.
  1037                 24  DC-JULIAN-2-CC    PIC 99.
  1038                 24  DC-JULIAN-2-YR    PIC 99.
  1039             20  DC-JULIAN-DA-2        PIC 999.
  1040         16  DC-GREG-DATE-A-EDIT.
  1041             20  DC-EDITA-MONTH        PIC 99.
  1042             20  SLASHA-1              PIC X VALUE '/'.
  1043             20  DC-EDITA-DAY          PIC 99.
  1044             20  SLASHA-2              PIC X VALUE '/'.
  1045             20  DC-EDITA-CCYY.
  1046                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  21
* EL156.cbl
  1047                 24  DC-EDITA-YEAR     PIC 99.
  1048         16  DC-GREG-DATE-B-EDIT.
  1049             20  DC-EDITB-MONTH        PIC 99.
  1050             20  SLASHB-1              PIC X VALUE '/'.
  1051             20  DC-EDITB-DAY          PIC 99.
  1052             20  SLASHB-2              PIC X VALUE '/'.
  1053             20  DC-EDITB-CCYY.
  1054                 24  DC-EDITB-CENT     PIC 99.
  1055                 24  DC-EDITB-YEAR     PIC 99.
  1056         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1057         16  DC-GREG-DATE-CYMD-R REDEFINES
  1058                              DC-GREG-DATE-CYMD.
  1059             20  DC-CYMD-CEN           PIC 99.
  1060             20  DC-CYMD-YEAR          PIC 99.
  1061             20  DC-CYMD-MONTH         PIC 99.
  1062             20  DC-CYMD-DAY           PIC 99.
  1063         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1064         16  DC-GREG-DATE-MDCY-R REDEFINES
  1065                              DC-GREG-DATE-MDCY.
  1066             20  DC-MDCY-MONTH         PIC 99.
  1067             20  DC-MDCY-DAY           PIC 99.
  1068             20  DC-MDCY-CEN           PIC 99.
  1069             20  DC-MDCY-YEAR          PIC 99.
  1070    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1071        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1072    12  DC-EL310-DATE                  PIC X(21).
  1073    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  22
* EL156.cbl
  1075*    COPY ELCLOGOF.
  1076******************************************************************
  1077*                                                                *
  1078*                                                                *
  1079*                            ELCLOGOF.                           *
  1080*                            VMOD=2.001                          *
  1081*                                                                *
  1082*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1083*                                                                *
  1084******************************************************************
  1085 01  CLASIC-LOGOFF.
  1086     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1087     12  LOGOFF-TEXT.
  1088         16  FILLER          PIC X(5)    VALUE SPACES.
  1089         16  LOGOFF-MSG.
  1090             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1091             20  FILLER      PIC X       VALUE SPACES.
  1092             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1093         16  FILLER          PIC X(80)
  1094           VALUE '* YOU ARE NOW LOGGED OFF'.
  1095         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1096         16  FILLER          PIC X       VALUE QUOTE.
  1097         16  LOGOFF-SYS-MSG  PIC X(17)
  1098           VALUE 'S CLAS-IC SYSTEM '.
  1099     12  TEXT-MESSAGES.
  1100         16  UNACCESS-MSG    PIC X(29)
  1101             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1102         16  PGMIDERR-MSG    PIC X(17)
  1103             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  23
* EL156.cbl
  1105*    COPY ELCCALC.
  1106******************************************************************
  1107*                                                                *
  1108*                           ELCCALC.                            *
  1109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1110*                            VMOD=2.025                          *
  1111*                                                                *
  1112*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1113*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1114*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1115*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1116*                                                                *
  1117*  PASSED TO ELRTRM                                              *
  1118*  -----------------                                             *
  1119*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1120*  ORIGINAL TERM                                                 *
  1121*  BEGINNING DATE                                                *
  1122*  ENDING DATE                                                   *
  1123*  COMPANY I.D.                                                  *
  1124*  ACCOUNT MASTER USER FIELD                                     *
  1125*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1126*  FREE LOOK DAYS                                                *
  1127*                                                                *
  1128*  RETURNED FROM ELRTRM                                          *
  1129*  ---------------------                                         *
  1130*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1131*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1132*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1133*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1134*----------------------------------------------------------------*
  1135*  PASSED TO ELRAMT                                              *
  1136*  ----------------                                              *
  1137*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1138*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1139*  ORIGINAL AMOUNT                                               *
  1140*  ALTERNATE BENEFIT (BALLON)                                    *
  1141*  A.P.R. - NET PAY ONLY                                         *
  1142*  METHOD
  1143*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1144*  COMPANY I.D.                                                  *
  1145*  BENEFIT TYPE                                                  *
  1146*                                                                *
  1147*  RETURNED FROM ELRAMT                                          *
  1148*  --------------------                                          *
  1149*  REMAINING AMOUNT 1 - CURRENT                                  *
  1150*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1151*  REMAINING AMOUNT FACTOR
  1152*----------------------------------------------------------------*
  1153*  PASSED TO ELRESV                                              *
  1154*  -----------------                                             *
  1155*  CERTIFICATE EFFECTIVE DATE                                    *
  1156*  VALUATION DATE                                                *
  1157*  PAID THRU DATE                                                *
  1158*  BENEFIT                                                       *
  1159*  INCURRED DATE                                                 *
  1160*  REPORTED DATE                                                 *
  1161*  ISSUE AGE                                                     *
  1162*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  24
* EL156.cbl
  1163*  CDT PERCENT                                                   *
  1164*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1165* *CLAIM TYPE (LIFE, A/H)                                        *
  1166* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1167* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1168*                                                                *
  1169*  RETURNED FROM ELRESV                                          *
  1170*  --------------------                                          *
  1171*  CDT TABLE USED                                                *
  1172*  CDT FACTOR USED                                               *
  1173*  PAY TO CURRENT RESERVE                                        *
  1174*  I.B.N.R. - A/H ONLY                                           *
  1175*  FUTURE (ACCRUED) AH ONLY                                      *
  1176*----------------------------------------------------------------*
  1177*  PASSED TO ELRATE                                              *
  1178*  ----------------                                              *
  1179*  CERT ISSUE DATE                                               *
  1180*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1181*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1182*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1183*  STATE CODE (CLIENT DEFINED)                                   *
  1184*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1185*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1186*  DEVIATION CODE                                                *
  1187*  ISSUE AGE                                                     *
  1188*  ORIGINAL BENEFIT AMOUNT                                       *
  1189*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1190*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1191*  BENEFIT KIND (LIFE OR A/H)                                    *
  1192*  A.P.R.                                                        *
  1193*  METHOD
  1194*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1195*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1196*  COMPANY I.D. (3 CHARACTER)                                    *
  1197*  BENEFIT CODE                                                  *
  1198*  BENEFIT OVERRIDE CODE                                         *
  1199*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1200*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1201*  JOINT INDICATOR (CSL ONLY)                                    *
  1202*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1203*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1204*                                                                *
  1205*  RETURNED FROM ELRATE                                          *
  1206*  --------------------                                          *
  1207*  CALCULATED PREMIUM                                            *
  1208*  PREMIUM RATE                                                  *
  1209*  MORTALITY CODE                                                *
  1210*  MAX ATTAINED AGE                                              *
  1211*  MAX AGE                                                       *
  1212*  MAX TERM                                                      *
  1213*  MAX MONTHLY BENEFIT                                           *
  1214*  MAX TOTAL BENIFIT                                             *
  1215*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1216*----------------------------------------------------------------*
  1217*  PASSED TO ELRFND                                              *
  1218*  ----------------                                              *
  1219*  CERT ISSUE DATE                                               *
  1220*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  25
* EL156.cbl
  1221*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1222*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1223*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1224*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1225*  STATE CODE (CLIENT DEFINED)                                   *
  1226*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1227*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1228*  DEVIATION CODE                                                *
  1229*  ISSUE AGE                                                     *
  1230*  ORIGINAL BENEFIT AMOUNT                                       *
  1231*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1232*  PROCESS TYPE (CANCEL)                                         *
  1233*  BENEFIT KIND (LIFE OR A/H)                                    *
  1234*  A.P.R.                                                        *
  1235*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1236*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1237*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1238*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1239*  COMPANY I.D. (3 CHARACTER)                                    *
  1240*  BENEFIT CODE                                                  *
  1241*  BENEFIT OVERRIDE CODE                                         *
  1242*                                                                *
  1243*  RETURNED FROM ELRFND                                          *
  1244*  --------------------                                          *
  1245*  CALCULATED REFUND                                             *
  1246*----------------------------------------------------------------*
  1247*  PASSED TO ELEARN                                              *
  1248*  ----------------                                              *
  1249*  CERT ISSUE DATE                                               *
  1250*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1251*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1252*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1253*  STATE CODE (CLIENT DEFINED)                                   *
  1254*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1255*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1256*  DEVIATION CODE                                                *
  1257*  ISSUE AGE                                                     *
  1258*  ORIGINAL BENEFIT AMOUNT                                       *
  1259*  BENEFIT KIND (LIFE OR A/H)                                    *
  1260*  A.P.R.                                                        *
  1261*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1262*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1263*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1264*  COMPANY I.D. (3 CHARACTER)                                    *
  1265*  BENEFIT CODE                                                  *
  1266*  BENEFIT OVERRIDE CODE                                         *
  1267*                                                                *
  1268*  RETURNED FROM ELEARN                                          *
  1269*  --------------------                                          *
  1270*  INDICATED  EARNINGS                                           *
  1271*----------------------------------------------------------------*
  1272*                 LENGTH = 450                                   *
  1273*                                                                *
  1274******************************************************************
  1275******************************************************************
  1276*                   C H A N G E   L O G
  1277*
  1278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  26
* EL156.cbl
  1279*-----------------------------------------------------------------
  1280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1281* EFFECTIVE    NUMBER
  1282*-----------------------------------------------------------------
  1283* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1284* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1285* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1286* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1287* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1288* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1289* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1290* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1291* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1292******************************************************************
  1293
  1294 01  CALCULATION-PASS-AREA.
  1295     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1296                                     COMP.
  1297
  1298     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1299       88  NO-CP-ERROR                             VALUE ZERO.
  1300       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1301                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1302       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1303       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1304       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1305       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1306       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1307       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1308       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1309       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1310       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1311       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1312       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1313       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1314       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1315       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1316       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1317       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1318       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1319
  1320     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1321       88  NO-CP-ERROR-2                           VALUE ZERO.
  1322***********************  INPUT AREAS ****************************
  1323
  1324     12  CP-CALCULATION-AREA.
  1325         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1326         16  CP-CERT-EFF-DT        PIC XX.
  1327         16  CP-VALUATION-DT       PIC XX.
  1328         16  CP-PAID-THRU-DT       PIC XX.
  1329         16  CP-BENEFIT-TYPE       PIC X.
  1330           88  CP-AH                               VALUE 'A' 'D'
  1331                                                   'I' 'U'.
  1332           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1333           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1334         16  CP-INCURRED-DT        PIC XX.
  1335         16  CP-REPORTED-DT        PIC XX.
  1336         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  27
* EL156.cbl
  1337         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1338         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1339                                     COMP-3.
  1340         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1341                                     COMP-3.
  1342         16  CP-CDT-METHOD         PIC X.
  1343           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1344           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1345           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1346         16  CP-CLAIM-TYPE         PIC X.
  1347           88  CP-AH-CLAIM                         VALUE 'A'.
  1348           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1349         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1350                                     COMP-3.
  1351         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1352                                     COMP-3.
  1353         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1354                                     COMP-3.
  1355         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1356                                     COMP-3.
  1357         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1358                                     COMP-3.
  1359         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1360                                     COMP-3.
  1361         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1362                                     COMP-3.
  1363         16  CP-REM-TERM-METHOD    PIC X.
  1364           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1365           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1366           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1367           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1368           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1369           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1370           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1371         16  CP-EARNING-METHOD     PIC X.
  1372           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1373           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1374           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1375           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1376           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1377           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1378           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1379           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1380           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1381           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1382           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1383           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1384           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1385           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1386         16  CP-PROCESS-TYPE       PIC X.
  1387           88  CP-CLAIM                            VALUE '1'.
  1388           88  CP-CANCEL                           VALUE '2'.
  1389           88  CP-ISSUE                            VALUE '3'.
  1390         16  CP-SPECIAL-CALC-CD    PIC X.
  1391           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1392           88  CP-1-MTH-INTEREST               VALUE ' '.
  1393           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1394           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  28
* EL156.cbl
  1395           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1396           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1397           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1398           88  CP-FARM-PLAN                    VALUE 'F'.
  1399           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1400           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1401           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1402           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1403           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1404           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1405           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1406           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1407           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1408           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1409                                                     'W' 'X'.
  1410           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1411           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1412           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1413           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1414           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1415           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1416           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1417           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1418           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1419           88  CP-CSL-METH-1                   VALUE '5'.
  1420           88  CP-CSL-METH-2                   VALUE '6'.
  1421           88  CP-CSL-METH-3                   VALUE '7'.
  1422           88  CP-CSL-METH-4                   VALUE '8'.
  1423
  1424         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1425                                     COMP-3.
  1426         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1427         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1428         16  CP-STATE              PIC XX          VALUE SPACE.
  1429         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1430         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1431           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1432               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1433         16  CP-R78-OPTION         PIC X.
  1434           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1435           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1436
  1437         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1438         16  CP-IBNR-RESERVE-SW    PIC X.
  1439         16  CP-CLAIM-STATUS       PIC X.
  1440         16  CP-RATE-FILE          PIC X.
  1441         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1442                                     COMP-3.
  1443
  1444         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1445         16  CP-AH-OVERRIDE-CODE   PIC X.
  1446
  1447         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1448                                     COMP-3.
  1449         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1450                                   PIC S9(5)V99 COMP-3.
  1451         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1452                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  29
* EL156.cbl
  1453         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1454                                     COMP-3.
  1455         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1456                                     COMP-3.
  1457         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1458                                  PIC S9(7)V99 COMP-3.
  1459
  1460         16  CP-PAID-FROM-DATE     PIC X(02).
  1461         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1462         16  CP-EXT-DAYS-CALC      PIC X.
  1463           88  CP-EXT-NO-CHG                   VALUE ' '.
  1464           88  CP-EXT-CHG-LF                   VALUE '1'.
  1465           88  CP-EXT-CHG-AH                   VALUE '2'.
  1466           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1467         16  CP-DOMICILE-STATE     PIC XX.
  1468         16  CP-CARRIER            PIC X.
  1469         16  CP-REIN-FLAG          PIC X.
  1470         16  CP-REM-TRM-CALC-OPTION PIC X.
  1471           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1472                      '2' '3' '4' '5'.
  1473           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1474           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1475           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1476           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1477           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1478           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1479           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1480           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1481         16  CP-SIG-SWITCH         PIC X.
  1482         16  CP-RATING-METHOD      PIC X.
  1483           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1484           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1485           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1486           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1487           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1488           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1489           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1490           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1491           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1492         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1493                                     COMP-3.
  1494         16  CP-BEN-CATEGORY       PIC X.
  1495         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1496         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1497                                   PIC S99V9(5) COMP-3.
  1498         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1499         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1500                                   PIC S99V9(5) COMP-3.
  1501         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1502         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1503         16  CP-EXPIRE-DT          PIC XX.
  1504         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1505         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1506         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1507         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1508         16  CP-DDF-SPEC-CALC      PIC X.
  1509             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1510             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  30
* EL156.cbl
  1511         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1512         16  CP-CANCEL-REASON      PIC X.
  1513         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1514         16  CP-PMT-MODE           PIC X.
  1515         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1516         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1517         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1518         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1519         16  FILLER                PIC X.
  1520
  1521***************    OUTPUT FROM ELRESV   ************************
  1522
  1523         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1524
  1525         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1526                                     COMP-3.
  1527         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1528                                     COMP-3.
  1529         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1530                                     COMP-3.
  1531         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1532                                     COMP-3.
  1533         16  FILLER                PIC X(09).
  1534***************    OUTPUT FROM ELRTRM   *************************
  1535
  1536         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1537                                     COMP-3.
  1538         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1539                                     COMP-3.
  1540         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1541                                     COMP-3.
  1542         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1543                                     COMP-3.
  1544         16  FILLER                PIC X(12).
  1545
  1546***************    OUTPUT FROM ELRAMT   *************************
  1547
  1548         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1549                                     COMP-3.
  1550         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1551                                     COMP-3.
  1552         16  FILLER                PIC X(12).
  1553
  1554***************    OUTPUT FROM ELRATE   *************************
  1555
  1556         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1557                                     COMP-3.
  1558         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1559                                     COMP-3.
  1560         16  CP-MORTALITY-CODE     PIC X(4).
  1561         16  CP-RATE-EDIT-FLAG     PIC X.
  1562             88  CP-RATES-NEED-APR                  VALUE '1'.
  1563         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1564                                     COMP-3.
  1565         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1566         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1567         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1568                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  31
* EL156.cbl
  1569         16  FILLER                PIC X(07).
  1570
  1571***************    OUTPUT FROM ELRFND   *************************
  1572
  1573         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-REFUND-TYPE-USED   PIC X.
  1576           88  CP-R-AS-R78                         VALUE '1'.
  1577           88  CP-R-AS-PRORATA                     VALUE '2'.
  1578           88  CP-R-AS-CALIF                       VALUE '3'.
  1579           88  CP-R-AS-TEXAS                       VALUE '4'.
  1580           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1581           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1582           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1583           88  CP-R-AS-MEAN                        VALUE '8'.
  1584           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1585           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1586           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1587           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1588           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1589           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1590         16  FILLER                PIC X(12).
  1591
  1592***************    OUTPUT FROM ELEARN   *************************
  1593
  1594         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1595                                     COMP-3.
  1596         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1597                                     COMP-3.
  1598         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1599                                     COMP-3.
  1600         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1601                                     COMP-3.
  1602         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1605                                     COMP-3.
  1606         16  CP-EARNING-TYPE-USED  PIC X.
  1607           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1608           88  CP-E-AS-R78                         VALUE '1'.
  1609           88  CP-E-AS-PRORATA                     VALUE '2'.
  1610           88  CP-E-AS-TEXAS                       VALUE '4'.
  1611           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1612           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1613           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1614           88  CP-E-AS-MEAN                        VALUE '8'.
  1615           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1616         16  FILLER                PIC X(12).
  1617
  1618***************    OUTPUT FROM ELPMNT   *************************
  1619
  1620         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1621                                     COMP-3.
  1622         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1623                                     COMP-3.
  1624         16  FILLER                PIC X(12).
  1625
  1626***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  32
* EL156.cbl
  1627         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1636                                     COMP-3.
  1637         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1638                                     COMP-3.
  1639         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1640             88  OPEN-RATE-FILE                   VALUE 'O'.
  1641             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1642             88  IO-ERROR                         VALUE 'E'.
  1643
  1644         16  CP-FIRST-PAY-DATE     PIC XX.
  1645
  1646         16  CP-JOINT-INDICATOR    PIC X.
  1647
  1648         16  CP-RESERVE-REMAINING-TERM
  1649                                   PIC S9(4)V9    VALUE ZERO
  1650                                     COMP-3.
  1651
  1652         16  CP-INSURED-BIRTH-DT   PIC XX.
  1653
  1654         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1655                                     COMP-3.
  1656
  1657         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1658                                     COMP-3.
  1659
  1660         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1661                                     COMP-3.
  1662
  1663         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1664                                     COMP-3.
  1665
  1666         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1667                                     COMP-3.
  1668
  1669         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1670                                     COMP-3.
  1671
  1672         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1673                                     COMP-3.
  1674
  1675         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1676             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1677
  1678         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1679                                     COMP-3.
  1680         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1681                                     COMP-3.
  1682         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1683         16  FILLER                PIC X(15).
  1684******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  33
* EL156.cbl
  1685*    COPY ELCICALC.
  1686******************************************************************
  1687*                                                                *
  1688*                           ELCCICALC.                           *
  1689*                            VMOD=2.001                          *
  1690*                                                                *
  1691*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1692*                 CALCULATION MODULE                             *
  1693*                                                                *
  1694*  PASSED TO ELCLMI                                              *
  1695*  -----------------                                             *
  1696*  STATE                                                         *
  1697*  PRODUCT                                                       *
  1698*  COVERAGE                                                      *
  1699*  EFFECTIVE DATE                                                *
  1700*  INCURRED DATE                                                 *
  1701*  ESTABLISHED DATE                                              *
  1702*  LAST PAID DATE                                                *
  1703*  REPORTED DATE                                                 *
  1704*  CLAIM PAYMENT AMOUNT                                          *
  1705*                                                                *
  1706*  RETURNED FROM ELRTRM                                          *
  1707*  ---------------------                                         *
  1708*  RETURN CODE                                                   *
  1709*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1710*  CLAIM INTEREST AMOUNT                                         *
  1711*----------------------------------------------------------------*
  1712*----------------------------------------------------------------*
  1713*                 LENGTH = 100                                   *
  1714*                                                                *
  1715******************************************************************
  1716******************************************************************
  1717*                   C H A N G E   L O G
  1718*
  1719* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1720*-----------------------------------------------------------------
  1721*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1722* EFFECTIVE    NUMBER
  1723*-----------------------------------------------------------------
  1724* 120905    2004040700004  PEMA  NEW COPYBOOK
  1725* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1726******************************************************************
  1727
  1728 01  CLAIM-INT-PASS-AREA.
  1729     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1730                                     COMP.
  1731
  1732     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1733       88  NO-CI-ERROR                             VALUE ZERO.
  1734       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1735       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1736       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1737       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1738       88  CP-AMT-LT-5000                          VALUE '4'.
  1739       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1740       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1741       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1742       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  34
* EL156.cbl
  1743***********************  INPUT AREAS ****************************
  1744
  1745     12  CP-CALCULATION-AREA.
  1746         16  CP-COMPANY-CD         PIC X.
  1747         16  CP-STATE              PIC XX.
  1748         16  CP-PRODUCT            PIC XX.
  1749         16  CP-COVERAGE           PIC XX.
  1750         16  CP-INC-DT             PIC XX.
  1751         16  CP-EST-DT             PIC XX.
  1752         16  CP-LSTPD-DT           PIC XX.
  1753         16  CP-RPT-DT             PIC XX.
  1754         16  CP-PRF-DT             PIC XX.
  1755         16  CP-EFF-DT             PIC XX.
  1756         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1757         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1758         16  FILLER                PIC X(37).
  1759
  1760***************    OUTPUT FROM ELCLMI   ************************
  1761
  1762         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1763
  1764         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1765         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1766         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1767         16  FILLER                PIC X(19).
  1768******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  35
* EL156.cbl
  1770*    COPY ELCATTR.
  1771******************************************************************
  1772*                                                                *
  1773*                            ELCATTR.                            *
  1774*                            VMOD=2.001                          *
  1775*                                                                *
  1776*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1777*                                                                *
  1778*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1779*                                                                *
  1780*                   POS 1   P=PROTECTED                          *
  1781*                           U=UNPROTECTED                        *
  1782*                           S=ASKIP                              *
  1783*                   POS 2   A=ALPHA/NUMERIC                      *
  1784*                           N=NUMERIC                            *
  1785*                   POS 3   N=NORMAL                             *
  1786*                           B=BRIGHT                             *
  1787*                           D=DARK                               *
  1788*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1789*                           OF=MODIFIED DATA TAG OFF             *
  1790*                                                                *
  1791*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1792******************************************************************
  1793 01  ATTRIBUTE-LIST.
  1794     12  AL-PABOF            PIC X       VALUE 'Y'.
  1795     12  AL-PABON            PIC X       VALUE 'Z'.
  1796     12  AL-PADOF            PIC X       VALUE '%'.
  1797     12  AL-PADON            PIC X       VALUE '_'.
  1798     12  AL-PANOF            PIC X       VALUE '-'.
  1799     12  AL-PANON            PIC X       VALUE '/'.
  1800     12  AL-SABOF            PIC X       VALUE '8'.
  1801     12  AL-SABON            PIC X       VALUE '9'.
  1802     12  AL-SADOF            PIC X       VALUE '@'.
  1803     12  AL-SADON            PIC X       VALUE QUOTE.
  1804     12  AL-SANOF            PIC X       VALUE '0'.
  1805     12  AL-SANON            PIC X       VALUE '1'.
  1806     12  AL-UABOF            PIC X       VALUE 'H'.
  1807     12  AL-UABON            PIC X       VALUE 'I'.
  1808     12  AL-UADOF            PIC X       VALUE '<'.
  1809     12  AL-UADON            PIC X       VALUE '('.
  1810     12  AL-UANOF            PIC X       VALUE ' '.
  1811     12  AL-UANON            PIC X       VALUE 'A'.
  1812     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1813     12  AL-UNBON            PIC X       VALUE 'R'.
  1814     12  AL-UNDOF            PIC X       VALUE '*'.
  1815     12  AL-UNDON            PIC X       VALUE ')'.
  1816     12  AL-UNNOF            PIC X       VALUE '&'.
  1817     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  36
* EL156.cbl
  1819*    COPY ELCEMIB.
  1820******************************************************************
  1821*                                                                *
  1822*                                                                *
  1823*                            ELCEMIB.                            *
  1824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1825*                            VMOD=2.005                          *
  1826*                                                                *
  1827*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1828*                                                                *
  1829******************************************************************
  1830 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1831     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1832     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1833     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1834     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1835     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1836     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1837     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1838     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1839     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1840         88  EMI-NO-ERRORS                    VALUE '1'.
  1841         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1842         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1843     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1844         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1845     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1846         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1847         88  EMI-AREA1-FULL                   VALUE '2'.
  1848     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1849         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1850         88  EMI-AREA2-FULL                   VALUE '2'.
  1851     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1852         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1853         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1854         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1855         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1856         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1857     12  EMI-ERROR-LINES.
  1858         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1859         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1860         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1861         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1862             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1863                 24  EMI-ERR-NUM         PIC X(4).
  1864                 24  EMI-FILLER          PIC X.
  1865                 24  EMI-SEV             PIC X.
  1866                 24  FILLER              PIC X.
  1867             20  FILLER                  PIC X(02).
  1868     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1869         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1870             20  EMI-ERROR-NUMBER    PIC X(4).
  1871             20  EMI-FILL            PIC X.
  1872             20  EMI-SEVERITY        PIC X.
  1873             20  FILLER              PIC X.
  1874             20  EMI-ERROR-TEXT.
  1875                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1876                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  37
* EL156.cbl
  1877     12  EMI-SEVERITY-SAVE           PIC X.
  1878         88  EMI-NOTE                    VALUE 'N'.
  1879         88  EMI-WARNING                 VALUE 'W'.
  1880         88  EMI-FORCABLE                VALUE 'F'.
  1881         88  EMI-FATAL                   VALUE 'X'.
  1882     12  EMI-MESSAGE-FLAG            PIC X.
  1883         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1884         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1885     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1886     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1887         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1888         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1889         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1890     12  emi-claim-no                pic x(7).
  1891     12  emi-claim-type              pic x(6).
  1892     12  FILLER                      PIC X(124)  VALUE SPACES.
  1893     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1894     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1895     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1896     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  38
* EL156.cbl
  1898*    COPY ELCLNKLT.
  1899******************************************************************
  1900*                                                                *
  1901*                                                                *
  1902*                           ELCLNKLT                             *
  1903*                            VMOD=2.003                          *
  1904*                                                                *
  1905*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1906*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1907*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1908*                                                                *
  1909*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1910*   COMPLETING THE REQUIRED FIELDS.                              *
  1911*                                                                *
  1912*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1913*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1914*                              9999 INDICATES AN UNKNOWN ABEND   *
  1915*                                   WAS DETECTED.                *
  1916*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1917*                              CODES FOUND IN THE ERROR FILE.    *
  1918******************************************************************
  1919 01  W-1523-LINKDATA.
  1920     12  W-1523-COMMON-PI-DATA.
  1921         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1922         16  FILLER              PIC  X(67).
  1923         16  W-1523-COMPANY-CD   PIC  X(01).
  1924         16  FILLER              PIC  X(10).
  1925         16  W-1523-CONTROL-IN-PROGRESS.
  1926             20  W-1523-CARRIER  PIC  X(01).
  1927             20  W-1523-GROUPING PIC  X(06).
  1928             20  W-1523-STATE    PIC  X(02).
  1929             20  W-1523-ACCOUNT  PIC  X(10).
  1930             20  W-1523-CLAIM-CERT-GRP.
  1931                 24  W-1523-CLAIM-NO
  1932                                 PIC  X(07).
  1933                 24  W-1523-CERT-NO.
  1934                     28  W-1523-CERT-PRIME
  1935                                 PIC  X(10).
  1936                     28  W-1523-CERT-SFX
  1937                                 PIC  X(01).
  1938                 24  W-1523-CERT-EFF-DT
  1939                                 PIC  X(02).
  1940         16  FILLER              PIC X(265).
  1941
  1942     12  W-1523-WORK-AREA.
  1943         16  W-1523-FORM-NUMBER  PIC  X(04).
  1944         16  W-1523-NUMBER-COPIES
  1945                                 PIC  9(01).
  1946         16  W-1523-ADDR-TYPE    PIC  X(02).
  1947         16  W-1523-FOLLOW-UP-DATE
  1948                                 PIC  X(02).
  1949         16  W-1523-RESEND-DATE  PIC  X(02).
  1950         16  W-1523-ERROR-CODE   PIC  9(04).
  1951             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1952             88  W-1523-FATAL-ERROR
  1953                                    VALUES  0006 0013 0042
  1954                                            0154 0168 0169
  1955                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  39
* EL156.cbl
  1956                                            0179 0186 0281
  1957                                            0332 2055 3697
  1958                                            3698 3699 3770
  1959                                            3771 3772 7675
  1960                                            9106 9808 9883
  1961                                            9887.
  1962             88  W-1523-STOP-ERRORS
  1963                                    VALUES  0013 0042 0154
  1964                                            0168 0169 0172
  1965                                            0281 0332 2055
  1966                                            3698 3699 7675
  1967                                            9106 9808 9883
  1968                                            9999.
  1969         16  W-1523-REASON       PIC  X(70).
  1970         16  W-1523-ARCHIVE-NUMBER
  1971                                 PIC  9(08).
  1972     12  W-1523-POINTER-AREA.
  1973         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1974         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1975         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1976         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1977         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  40
* EL156.cbl
  1979*    COPY ELCNWA.
  1980*****************************************************************
  1981*                                                               *
  1982*                                                               *
  1983*                            ELCNWA.                            *
  1984*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1985*                            VMOD=2.003                         *
  1986*                                                               *
  1987*            M O V E   N A M E   W O R K   A R E A.             *
  1988*                                                               *
  1989*****************************************************************.
  1990
  1991 01  WS-NAME-WORK-AREA.
  1992     05  WS-INSURED-LAST-NAME        PIC X(15).
  1993     05  WS-INSURED-1ST-NAME         PIC X(12).
  1994     05  WS-INSURED-MID-INIT         PIC X.
  1995
  1996     05  WS-NAME-WORK.
  1997         10  WS-NW                   PIC X
  1998             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1999
  2000     05  WS-NAME-WORK2.
  2001         10  WS-NW2                  PIC X
  2002             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2003                                        NWA-INDEX0.
  2004
  2005     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2006                                     COMP-3.
  2007
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  41
* EL156.cbl
  2009*    COPY ELCDMO.
  2010******************************************************************
  2011*                                                                *
  2012*                                                                *
  2013*                            ELCDMO.                             *
  2014*                            VMOD=2.004                          *
  2015*                                                                *
  2016*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2017*        COMMUNICATION AREA                                      *
  2018*   FILE TYPE = NA                                               *
  2019*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2020*                                                                *
  2021******************************************************************
  2022 01  DMO-COMMUNICATION-AREA.
  2023     12  DM-RECORD-TYPE                  PIC  X(02).
  2024             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2025             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2026             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2027     12  DM-DIST-CODE                    PIC  X(04).
  2028     12  DM-MAIL-CODE                    PIC  X(05).
  2029     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2030     12  DM-INSURED-NAME                 PIC  X(30).
  2031     12  DM-CLAIM-NO                     PIC  X(07).
  2032     12  DM-CLAIM-TYPE                   PIC  X.
  2033
  2034     12  DM-STATUS-DATA-AREA.
  2035         16  DM-CLAIM-STATUS             PIC  X.
  2036             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2037             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2038             88  DM-CLOSED                        VALUE '3'.
  2039             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2040             88  DM-DEFAULT                       VALUE '9'.
  2041         16  DM-STATUS-DATE              PIC  X(08).
  2042******YYYYMMDD
  2043         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2044             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2045             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2046             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2047             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2048             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2049             88  DM-RE-OPENED                     VALUE 'R'.
  2050             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2051             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2052             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2053         16  DM-STAT-CARRIER             PIC X.
  2054
  2055     12  DM-DRAFT-DATA-AREA.
  2056         16  DM-PAYMENT-TYPE             PIC  X.
  2057             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2058         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2059         16  DM-PAYMENT-DATE             PIC  X(08).
  2060******YYYYMMDD
  2061         16  DM-CERT-NO                  PIC  X(11).
  2062         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2063         16  DM-CARRIER                  PIC  X.
  2064
  2065     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  42
* EL156.cbl
  2067*    COPY ELCDMDCD.
  2068******************************************************************
  2069*                                                                *
  2070*                                                                *
  2071*                            ELCDMDCD.                           *
  2072*                            VMOD=2.001                          *
  2073*                                                                *
  2074*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2075*       COMMUNICATIONS AREA                                      *
  2076*                                                                *
  2077******************************************************************
  2078 01  CD-COMMUNICATION-AREA.
  2079     12  CD-SYSTEM-ID            PIC  X(02).
  2080         88 CD-CLAIMS                      VALUE 'CL'.
  2081         88 CD-CREDIT                      VALUE 'CR'.
  2082     12  CD-RECORD-TYPE          PIC  X(02).
  2083         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2084         88 CD-EOB-CODE                    VALUE 'EO'.
  2085         88 CD-ICD9-CODE                   VALUE 'I9'.
  2086         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2087         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2088         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2089         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2090         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2091     12  CD-RECORD-KEY           PIC  X(06).
  2092         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2093     12  CD-RETURN-CODE          PIC  X(02).
  2094     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2095     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2096     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2097     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  43
* EL156.cbl
  2099*    COPY ELCDCTB.
  2100******************************************************************
  2101*                                                                *
  2102*                                                                *
  2103*                            ELCDCTB.                            *
  2104*                            VMOD=2.002                          *
  2105*                                                                *
  2106*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2107*       COMMUNICATIONS AREA                                      *
  2108*                                                                *
  2109******************************************************************
  2110 01  DCT-COMMUNICATION-AREA.
  2111     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2112     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2113     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2114     12  DCT-PRODUCT-CODE         PIC  X(02).
  2115     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2116     12  DCT-RETURN-CODE          PIC  X(02).
  2117     12  DCT-MAIL-CODE            PIC  X(05).
  2118     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2119     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  44
* EL156.cbl
  2121 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2122 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2123 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2124 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  45
* EL156.cbl
  2126*    COPY ELCINTF.
  2127******************************************************************
  2128*                                                                *
  2129*                                                                *
  2130*                            ELCINTF.                            *
  2131*                            VMOD=2.017                          *
  2132*                                                                *
  2133*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2134*                                                                *
  2135*       LENGTH = 1024                                            *
  2136*                                                                *
  2137******************************************************************
  2138*                   C H A N G E   L O G
  2139*
  2140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2141*-----------------------------------------------------------------
  2142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2143* EFFECTIVE    NUMBER
  2144*-----------------------------------------------------------------
  2145* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2146******************************************************************
  2147 01  PROGRAM-INTERFACE-BLOCK.
  2148     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2149     12  PI-CALLING-PROGRAM              PIC X(8).
  2150     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2151     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2152     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2153     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2154     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2155     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2156     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2157     12  PI-COMPANY-ID                   PIC XXX.
  2158     12  PI-COMPANY-CD                   PIC X.
  2159
  2160     12  PI-COMPANY-PASSWORD             PIC X(8).
  2161
  2162     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2163
  2164     12  PI-CONTROL-IN-PROGRESS.
  2165         16  PI-CARRIER                  PIC X.
  2166         16  PI-GROUPING                 PIC X(6).
  2167         16  PI-STATE                    PIC XX.
  2168         16  PI-ACCOUNT                  PIC X(10).
  2169         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2170                                         PIC X(10).
  2171         16  PI-CLAIM-CERT-GRP.
  2172             20  PI-CLAIM-NO             PIC X(7).
  2173             20  PI-CERT-NO.
  2174                 25  PI-CERT-PRIME       PIC X(10).
  2175                 25  PI-CERT-SFX         PIC X.
  2176             20  PI-CERT-EFF-DT          PIC XX.
  2177         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2178             20  PI-PLAN-CODE            PIC X(2).
  2179             20  PI-REVISION-NUMBER      PIC X(3).
  2180             20  PI-PLAN-EFF-DT          PIC X(2).
  2181             20  PI-PLAN-EXP-DT          PIC X(2).
  2182             20  FILLER                  PIC X(11).
  2183         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  46
* EL156.cbl
  2184             20  PI-OE-REFERENCE-1.
  2185                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2186                 25  PI-OE-REF-1-SUFF    PIC XX.
  2187
  2188     12  PI-SESSION-IN-PROGRESS          PIC X.
  2189         88  CLAIM-SESSION                   VALUE '1'.
  2190         88  CREDIT-SESSION                  VALUE '2'.
  2191         88  WARRANTY-SESSION                VALUE '3'.
  2192         88  MORTGAGE-SESSION                VALUE '4'.
  2193         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2194
  2195
  2196*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2197
  2198     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2199     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2200
  2201     12  PI-CREDIT-USER                  PIC X.
  2202         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2203         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2204
  2205     12  PI-CLAIM-USER                   PIC X.
  2206         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2207         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2208
  2209     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2210         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2211         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2212         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2213         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2214         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2215
  2216     12  PI-PROCESSOR-ID                 PIC X(4).
  2217
  2218     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2219
  2220     12  PI-MEMBER-CAPTION               PIC X(10).
  2221
  2222     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2223         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2224
  2225     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2226     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2227     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2228     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2229
  2230     12  PI-AH-OVERRIDE-L1               PIC X.
  2231     12  PI-AH-OVERRIDE-L2               PIC XX.
  2232     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2233     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2234
  2235     12  PI-NEW-SYSTEM                   PIC X(2).
  2236
  2237     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2238     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2239         88  PI-USES-PAID-TO                 VALUE '1'.
  2240     12  PI-CRDTCRD-SYSTEM.
  2241         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  47
* EL156.cbl
  2242             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2243             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2244         16  PI-CC-MONTH-END-DT          PIC XX.
  2245     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2246
  2247     12  PI-OE-REFERENCE-2.
  2248         16  PI-OE-REF-2-PRIME           PIC X(10).
  2249         16  PI-OE-REF-2-SUFF            PIC X.
  2250
  2251     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2252
  2253     12  PI-LANGUAGE-TYPE                PIC X.
  2254             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2255             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2256             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2257
  2258     12  PI-POLICY-LINKAGE-IND           PIC X.
  2259         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2260         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2261                                                   LOW-VALUES.
  2262
  2263     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2264     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2265         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2266         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2267
  2268     12  PI-PROCESSOR-CSR-IND            PIC X.
  2269         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2270         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2271
  2272     12  FILLER                          PIC X(3).
  2273
  2274     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2275
  2276     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2277         PI-SYSTEM-LEVEL.
  2278
  2279         16  PI-ENTRY-CODES.
  2280             20  PI-ENTRY-CD-1           PIC X.
  2281             20  PI-ENTRY-CD-2           PIC X.
  2282
  2283         16  PI-RETURN-CODES.
  2284             20  PI-RETURN-CD-1          PIC X.
  2285             20  PI-RETURN-CD-2          PIC X.
  2286
  2287         16  PI-UPDATE-STATUS-SAVE.
  2288             20  PI-UPDATE-BY            PIC X(4).
  2289             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2290
  2291         16  PI-LOWER-CASE-LETTERS       PIC X.
  2292             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2293
  2294*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2295*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2296*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2297
  2298         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2299             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  48
* EL156.cbl
  2300             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2301             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2302             88  ACCNT-CNTL                  VALUE '3'.
  2303             88  CARR-ACCNT-CNTL             VALUE '4'.
  2304
  2305         16  PI-PROCESSOR-CAP-LIST.
  2306             20  PI-SYSTEM-CONTROLS.
  2307                24 PI-SYSTEM-DISPLAY     PIC X.
  2308                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2309                24 PI-SYSTEM-MODIFY      PIC X.
  2310                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2311             20  FILLER                  PIC XX.
  2312             20  PI-DISPLAY-CAP          PIC X.
  2313                 88  DISPLAY-CAP             VALUE 'Y'.
  2314             20  PI-MODIFY-CAP           PIC X.
  2315                 88  MODIFY-CAP              VALUE 'Y'.
  2316             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2317                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2318             20  PI-FORCE-CAP            PIC X.
  2319                 88  FORCE-CAP               VALUE 'Y'.
  2320
  2321         16  PI-PROGRAM-CONTROLS.
  2322             20  PI-PGM-PRINT-OPT        PIC X.
  2323             20  PI-PGM-FORMAT-OPT       PIC X.
  2324             20  PI-PGM-PROCESS-OPT      PIC X.
  2325             20  PI-PGM-TOTALS-OPT       PIC X.
  2326
  2327         16  PI-HELP-INTERFACE.
  2328             20  PI-LAST-ERROR-NO        PIC X(4).
  2329             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2330
  2331         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2332             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2333
  2334         16  PI-CR-CONTROL-IN-PROGRESS.
  2335             20  PI-CR-CARRIER           PIC X.
  2336             20  PI-CR-GROUPING          PIC X(6).
  2337             20  PI-CR-STATE             PIC XX.
  2338             20  PI-CR-ACCOUNT           PIC X(10).
  2339             20  PI-CR-FIN-RESP          PIC X(10).
  2340             20  PI-CR-TYPE              PIC X.
  2341
  2342         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2343
  2344         16  PI-CR-MONTH-END-DT          PIC XX.
  2345
  2346         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2347             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2348             88  PI-ZERO-CARRIER             VALUE '1'.
  2349             88  PI-ZERO-GROUPING            VALUE '2'.
  2350             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2351
  2352         16  PI-CARRIER-SECURITY         PIC X.
  2353             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2354
  2355         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2356             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2357             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  49
* EL156.cbl
  2358
  2359         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2360             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2361                                         INDEXED BY PI-ACCESS-NDX
  2362                                         PIC X.
  2363
  2364         16  PI-GA-BILLING-CONTROL       PIC X.
  2365             88  PI-GA-BILLING               VALUE '1'.
  2366
  2367         16  PI-MAIL-PROCESSING          PIC X.
  2368             88  PI-MAIL-YES                 VALUE 'Y'.
  2369
  2370         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2371
  2372         16  PI-AR-SYSTEM.
  2373             20  PI-AR-PROCESSING-CNTL   PIC X.
  2374                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2375             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2376             20  PI-AR-MONTH-END-DT      PIC XX.
  2377
  2378         16  PI-MP-SYSTEM.
  2379             20  PI-MORTGAGE-USER            PIC X.
  2380                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2381                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2382             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2383                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2384                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2385                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2386                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2387                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2388             20  PI-MP-MONTH-END-DT          PIC XX.
  2389             20  PI-MP-REFERENCE-NO.
  2390                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2391                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2392
  2393         16  PI-LABEL-CONTROL            PIC X(01).
  2394             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2395             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2396
  2397         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2398             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2399
  2400         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2401             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2402             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2403
  2404         16  FILLER                      PIC X(14).
  2405
  2406     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2407******************************************************************
  2408     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2409         16  PI-SAVE-FORM        PIC X(12).
  2410         16  PI-ACCT-KEY         PIC X(26).
  2411         16  PI-PAYEE-NAME       PIC X(30).
  2412         16  PI-DAILY-RATE       PIC S9(3)V99.
  2413         16  PI-MONTH-END-SAVE   PIC XX.
  2414         16  PI-BENEFIT-SAVE.
  2415             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  50
* EL156.cbl
  2416             20  PI-BEN-TYPE     PIC X.
  2417         16  PI-MANUAL-SW        PIC 9.
  2418         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2419         16  PI-PASS-SW          PIC X.
  2420         16  PI-PFKEY-USED       PIC X.
  2421         16  PI-CK-ASSIGN        PIC X.
  2422         16  PI-FATAL-COUNT      PIC 99.
  2423         16  PI-FORCE-COUNT      PIC 99.
  2424         16  PI-SAVE-INPUT.
  2425             20  PI-PMTTYPE      PIC X.
  2426             20  PI-PAYEE.
  2427                 24  PI-PAYEE-TYPE PIC X.
  2428                 24  PI-PAYEE-SEQ  PIC X.
  2429                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2430                   PI-PAYEE-SEQ    PIC S9.
  2431             20  PI-PMTNOTE1     PIC X(60).
  2432             20  PI-PMTNOTE2     PIC X(60).
  2433             20  PI-OFFLINE      PIC X.
  2434             20  PI-ECHECKNO     PIC X(7).
  2435             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2436                 28  PI-ECHECKNO-N     PIC X.
  2437                 28  PI-ECHECKNO-6     PIC X(6).
  2438             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2439                 24  PI-ECHECKNO-CR    PIC XX.
  2440                 24  PI-ECHECKNO-5     PIC X(5).
  2441             20  PI-HOLDTIL      PIC 9(6).
  2442             20  PI-EPYFROM      PIC 9(6).
  2443             20  PI-EPYTHRU      PIC 9(6).
  2444             20  PI-EDAYS        PIC S9(5).
  2445             20  PI-EPYAMT       PIC S9(7)V99.
  2446             20  PI-ERESV        PIC S9(7)V99.
  2447             20  PI-EEXPENS      PIC 9(6)V99.
  2448             20  PI-ETYPE        PIC X.
  2449             20  PI-CASH         PIC X.
  2450             20  PI-GROUPED      PIC X.
  2451             20  PI-INT-RATE     PIC S99V9(5).
  2452             20  PI-AIGFROM      PIC 9(6).
  2453             20  PI-LOAN-NO      PIC X(20).
  2454             20  PI-PROOF-DATE   PIC 9(6).
  2455             20  PI-PRINT-EOB-YN PIC X.
  2456             20  PI-PRINT-CLM-FRM-YN PIC X.
  2457             20  PI-PRINT-SURVEY-YN PIC X.
  2458             20  PI-SPECIAL-RELEASE-YN PIC X.
  2459         16  PI-SAVE-COMPUTED.
  2460             20  PI-CCHECKNO     PIC X(7).
  2461             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2462                 28  PI-CCHECKNO-N     PIC X.
  2463                 28  PI-CCHECKNO-6     PIC X(6).
  2464             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2465                 24  PI-CCHECKNO-CR    PIC XX.
  2466                 24  PI-CCHECKNO-5     PIC X(5).
  2467             20  PI-CPYFROM      PIC XX.
  2468             20  PI-CPYTHRU      PIC XX.
  2469             20  PI-CDAYS        PIC S9(5).
  2470             20  PI-CPYAMT       PIC S9(7)V99.
  2471             20  PI-CRESV        PIC 9(6)V99.
  2472             20  PI-CEXPENS      PIC 9(6)V99.
  2473             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  51
* EL156.cbl
  2474                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2475                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2476                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2477         16  PI-PREV-CLMNO       PIC X(7).
  2478         16  PI-LF-COVERAGE-TYPE PIC X.
  2479         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2480         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2481         16  PI-PROVISIONAL-IND  PIC X.
  2482             88 PI-PROV-PMT      VALUE 'P'.
  2483         16  PI-PREV-TRLR-KEY    PIC X(22).
  2484         16  PI-SPLIT-PMT-SW     PIC X.
  2485         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2486         16  PI-ACTIVITY-CODE    PIC 99.
  2487         16  PI-RESET-SW         PIC X.
  2488         16  PI-SPECIAL-BEN-SW   PIC X.
  2489             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2490         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2491         16  PI-EXP-DT           PIC XX.
  2492         16  PI-LOAN-DUE-DAY     PIC 99.
  2493         16  PI-3RD-PARTY-SW     PIC X.
  2494         16  PI-LOAN-UPDATE-SW   PIC X.
  2495
  2496         16  PI-DMD-DATA.
  2497             20  PI-SV-CERT-KEY       PIC X(21).
  2498             20  PI-SV-CERT-NO        PIC X(11).
  2499             20  PI-SV-BEN            PIC X(10).
  2500             20  PI-SV-CCN            PIC X(16).
  2501             20  PI-INTEREST-PAID-IND PIC X.
  2502                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2503             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2504             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2505             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2506             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2507         16  PI-AT-EOB-CODES.
  2508             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2509         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2510         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2511         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2512         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2513         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2514         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2515         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2516         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2517         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2518         16  PI-LF-BENEFIT-CD         PIC X(2).
  2519         16  PI-EOB-CODES-EXIST PIC X.
  2520         16  PI-SET-NOTE2-MDT   PIC X.
  2521         16  PI-VFY-2ND-BENE          PIC X.
  2522         16  PI-CLM-TYPE              PIC X.
  2523         16  PI-APPROVAL-LEVEL        PIC X.
  2524         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2525         16  PI-REAUDIT-NEEDED        PIC X.
  2526         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2527         16  PI-AH-BENEFIT-CD         PIC XX.
  2528*00781          16  FILLER                   PIC X(176).
  2529*052506         16  FILLER                   PIC X(161).
  2530*031808         16  FILLER                   PIC X(154).
  2531*091808         16  FILLER                   PIC X(152).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  52
* EL156.cbl
  2532*041710         16  FILLER                   PIC X(94).
  2533         16  FILLER                   PIC X(81).
  2534
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  53
* EL156.cbl
  2536*    COPY ELCJPFX.
  2537******************************************************************
  2538*                                                                *
  2539*                                                                *
  2540*                            ELCJPFX.                            *
  2541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2542*                            VMOD=2.002                          *
  2543*                                                                *
  2544*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2545*                                                                *
  2546*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2547*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2548*        ELCNTL - CONTROL FILE                                   *
  2549*        ELMSTR - CLAIM MASTERS                                  *
  2550*        ELTRLR - ACTIVITY TRAILERS                              *
  2551*        ELCHKQ - CHECK QUE                                      *
  2552******************************************************************
  2553 01  JOURNAL-RECORD.
  2554     12  jp-date                     pic s9(5) comp-3.
  2555     12  jp-time                     pic s9(7) comp-3.
  2556     12  JP-USER-ID                  PIC X(4).
  2557     12  JP-FILE-ID                  PIC X(8).
  2558     12  JP-PROGRAM-ID               PIC X(8).
  2559     12  JP-RECORD-TYPE              PIC X.
  2560         88 JP-ADD              VALUE 'A'.
  2561         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2562         88 JP-AFTER-CHANGE     VALUE 'C'.
  2563         88 JP-DELETE           VALUE 'D'.
  2564         88 JP-GENERIC-DELETE   VALUE 'G'.
  2565         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2566         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2567     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2568     12  JP-RECORD-AREA
  2569
  2570
  2571                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  54
* EL156.cbl
  2573*    COPY ELCAID.
  2574******************************************************************
  2575*                                                                *
  2576*                            ELCAID.                             *
  2577*                            VMOD=2.001                          *
  2578*                                                                *
  2579*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2580*                                                                *
  2581*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2582*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2583******************************************************************
  2584
  2585 01  DFHAID.
  2586   02  DFHNULL   PIC  X  VALUE  ' '.
  2587   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2588   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2589   02  DFHPEN    PIC  X  VALUE  '='.
  2590   02  DFHOPID   PIC  X  VALUE  'W'.
  2591   02  DFHPA1    PIC  X  VALUE  '%'.
  2592   02  DFHPA2    PIC  X  VALUE  '>'.
  2593   02  DFHPA3    PIC  X  VALUE  ','.
  2594   02  DFHPF1    PIC  X  VALUE  '1'.
  2595   02  DFHPF2    PIC  X  VALUE  '2'.
  2596   02  DFHPF3    PIC  X  VALUE  '3'.
  2597   02  DFHPF4    PIC  X  VALUE  '4'.
  2598   02  DFHPF5    PIC  X  VALUE  '5'.
  2599   02  DFHPF6    PIC  X  VALUE  '6'.
  2600   02  DFHPF7    PIC  X  VALUE  '7'.
  2601   02  DFHPF8    PIC  X  VALUE  '8'.
  2602   02  DFHPF9    PIC  X  VALUE  '9'.
  2603   02  DFHPF10   PIC  X  VALUE  ':'.
  2604   02  DFHPF11   PIC  X  VALUE  '#'.
  2605   02  DFHPF12   PIC  X  VALUE  '@'.
  2606   02  DFHPF13   PIC  X  VALUE  'A'.
  2607   02  DFHPF14   PIC  X  VALUE  'B'.
  2608   02  DFHPF15   PIC  X  VALUE  'C'.
  2609   02  DFHPF16   PIC  X  VALUE  'D'.
  2610   02  DFHPF17   PIC  X  VALUE  'E'.
  2611   02  DFHPF18   PIC  X  VALUE  'F'.
  2612   02  DFHPF19   PIC  X  VALUE  'G'.
  2613   02  DFHPF20   PIC  X  VALUE  'H'.
  2614   02  DFHPF21   PIC  X  VALUE  'I'.
  2615*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2616   02  DFHPF22   PIC  X  VALUE  '['.
  2617   02  DFHPF23   PIC  X  VALUE  '.'.
  2618   02  DFHPF24   PIC  X  VALUE  '<'.
  2619   02  DFHMSRE   PIC  X  VALUE  'X'.
  2620   02  DFHSTRF   PIC  X  VALUE  'h'.
  2621   02  DFHTRIG   PIC  X  VALUE  '"'.
  2622 01  FILLER    REDEFINES DFHAID.
  2623     12  FILLER              PIC X(8).
  2624     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  55
* EL156.cbl
  2626*    COPY EL156S.
  2627 01  EL156AI.
  2628     05  FILLER            PIC  X(0012).
  2629*    -------------------------------
  2630     05  RUNDTEAL PIC S9(0004) COMP.
  2631     05  RUNDTEAF PIC  X(0001).
  2632     05  FILLER REDEFINES RUNDTEAF.
  2633         10  RUNDTEAA PIC  X(0001).
  2634     05  RUNDTEAI PIC  X(0008).
  2635*    -------------------------------
  2636     05  RUNTIMAL PIC S9(0004) COMP.
  2637     05  RUNTIMAF PIC  X(0001).
  2638     05  FILLER REDEFINES RUNTIMAF.
  2639         10  RUNTIMAA PIC  X(0001).
  2640     05  RUNTIMAI PIC  X(0005).
  2641*    -------------------------------
  2642     05  SEQUL PIC S9(0004) COMP.
  2643     05  SEQUF PIC  X(0001).
  2644     05  FILLER REDEFINES SEQUF.
  2645         10  SEQUA PIC  X(0001).
  2646     05  SEQUI PIC  X(0010).
  2647*    -------------------------------
  2648     05  CLMNOL PIC S9(0004) COMP.
  2649     05  CLMNOF PIC  X(0001).
  2650     05  FILLER REDEFINES CLMNOF.
  2651         10  CLMNOA PIC  X(0001).
  2652     05  CLMNOI PIC  X(0007).
  2653*    -------------------------------
  2654     05  CARRL PIC S9(0004) COMP.
  2655     05  CARRF PIC  X(0001).
  2656     05  FILLER REDEFINES CARRF.
  2657         10  CARRA PIC  X(0001).
  2658     05  CARRI PIC  X(0001).
  2659*    -------------------------------
  2660     05  CERTNOL PIC S9(0004) COMP.
  2661     05  CERTNOF PIC  X(0001).
  2662     05  FILLER REDEFINES CERTNOF.
  2663         10  CERTNOA PIC  X(0001).
  2664     05  CERTNOI PIC  X(0010).
  2665*    -------------------------------
  2666     05  SUFXL PIC S9(0004) COMP.
  2667     05  SUFXF PIC  X(0001).
  2668     05  FILLER REDEFINES SUFXF.
  2669         10  SUFXA PIC  X(0001).
  2670     05  SUFXI PIC  X(0001).
  2671*    -------------------------------
  2672     05  CLMTYPL PIC S9(0004) COMP.
  2673     05  CLMTYPF PIC  X(0001).
  2674     05  FILLER REDEFINES CLMTYPF.
  2675         10  CLMTYPA PIC  X(0001).
  2676     05  CLMTYPI PIC  X(0006).
  2677*    -------------------------------
  2678     05  CLMSTATL PIC S9(0004) COMP.
  2679     05  CLMSTATF PIC  X(0001).
  2680     05  FILLER REDEFINES CLMSTATF.
  2681         10  CLMSTATA PIC  X(0001).
  2682     05  CLMSTATI PIC  X(0006).
  2683*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  56
* EL156.cbl
  2684     05  LSTNMEL PIC S9(0004) COMP.
  2685     05  LSTNMEF PIC  X(0001).
  2686     05  FILLER REDEFINES LSTNMEF.
  2687         10  LSTNMEA PIC  X(0001).
  2688     05  LSTNMEI PIC  X(0015).
  2689*    -------------------------------
  2690     05  FSTNMEL PIC S9(0004) COMP.
  2691     05  FSTNMEF PIC  X(0001).
  2692     05  FILLER REDEFINES FSTNMEF.
  2693         10  FSTNMEA PIC  X(0001).
  2694     05  FSTNMEI PIC  X(0012).
  2695*    -------------------------------
  2696     05  MINITL PIC S9(0004) COMP.
  2697     05  MINITF PIC  X(0001).
  2698     05  FILLER REDEFINES MINITF.
  2699         10  MINITA PIC  X(0001).
  2700     05  MINITI PIC  X(0001).
  2701*    -------------------------------
  2702     05  PRIMHDGL PIC S9(0004) COMP.
  2703     05  PRIMHDGF PIC  X(0001).
  2704     05  FILLER REDEFINES PRIMHDGF.
  2705         10  PRIMHDGA PIC  X(0001).
  2706     05  PRIMHDGI PIC  X(0012).
  2707*    -------------------------------
  2708     05  PCERTNOL PIC S9(0004) COMP.
  2709     05  PCERTNOF PIC  X(0001).
  2710     05  FILLER REDEFINES PCERTNOF.
  2711         10  PCERTNOA PIC  X(0001).
  2712     05  PCERTNOI PIC  X(0010).
  2713*    -------------------------------
  2714     05  PSUFXL PIC S9(0004) COMP.
  2715     05  PSUFXF PIC  X(0001).
  2716     05  FILLER REDEFINES PSUFXF.
  2717         10  PSUFXA PIC  X(0001).
  2718     05  PSUFXI PIC  X(0001).
  2719*    -------------------------------
  2720     05  STATUSL PIC S9(0004) COMP.
  2721     05  STATUSF PIC  X(0001).
  2722     05  FILLER REDEFINES STATUSF.
  2723         10  STATUSA PIC  X(0001).
  2724     05  STATUSI PIC  X(0010).
  2725*    -------------------------------
  2726     05  LOANHL PIC S9(0004) COMP.
  2727     05  LOANHF PIC  X(0001).
  2728     05  FILLER REDEFINES LOANHF.
  2729         10  LOANHA PIC  X(0001).
  2730     05  LOANHI PIC  X(0014).
  2731*    -------------------------------
  2732     05  LOANNOL PIC S9(0004) COMP.
  2733     05  LOANNOF PIC  X(0001).
  2734     05  FILLER REDEFINES LOANNOF.
  2735         10  LOANNOA PIC  X(0001).
  2736     05  LOANNOI PIC  X(0025).
  2737*    -------------------------------
  2738     05  DUEDAYHL PIC S9(0004) COMP.
  2739     05  DUEDAYHF PIC  X(0001).
  2740     05  FILLER REDEFINES DUEDAYHF.
  2741         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  57
* EL156.cbl
  2742     05  DUEDAYHI PIC  X(0008).
  2743*    -------------------------------
  2744     05  DUEDAYL PIC S9(0004) COMP.
  2745     05  DUEDAYF PIC  X(0001).
  2746     05  FILLER REDEFINES DUEDAYF.
  2747         10  DUEDAYA PIC  X(0001).
  2748     05  DUEDAYI PIC  X(0002).
  2749*    -------------------------------
  2750     05  ZINTHL PIC S9(0004) COMP.
  2751     05  ZINTHF PIC  X(0001).
  2752     05  FILLER REDEFINES ZINTHF.
  2753         10  ZINTHA PIC  X(0001).
  2754     05  ZINTHI PIC  X(0009).
  2755*    -------------------------------
  2756     05  ZINTL PIC S9(0004) COMP.
  2757     05  ZINTF PIC  X(0001).
  2758     05  FILLER REDEFINES ZINTF.
  2759         10  ZINTA PIC  X(0001).
  2760     05  ZINTI PIC  99V99999.
  2761*    -------------------------------
  2762     05  PTHRHDGL PIC S9(0004) COMP.
  2763     05  PTHRHDGF PIC  X(0001).
  2764     05  FILLER REDEFINES PTHRHDGF.
  2765         10  PTHRHDGA PIC  X(0001).
  2766     05  PTHRHDGI PIC  X(0014).
  2767*    -------------------------------
  2768     05  PDTHRUL PIC S9(0004) COMP.
  2769     05  PDTHRUF PIC  X(0001).
  2770     05  FILLER REDEFINES PDTHRUF.
  2771         10  PDTHRUA PIC  X(0001).
  2772     05  PDTHRUI PIC  X(0008).
  2773*    -------------------------------
  2774     05  TOTPAIDL PIC S9(0004) COMP.
  2775     05  TOTPAIDF PIC  X(0001).
  2776     05  FILLER REDEFINES TOTPAIDF.
  2777         10  TOTPAIDA PIC  X(0001).
  2778     05  TOTPAIDI PIC  X(0010).
  2779*    -------------------------------
  2780     05  COVERL PIC S9(0004) COMP.
  2781     05  COVERF PIC  X(0001).
  2782     05  FILLER REDEFINES COVERF.
  2783         10  COVERA PIC  X(0001).
  2784     05  COVERI PIC  X(0010).
  2785*    -------------------------------
  2786     05  INCURL PIC S9(0004) COMP.
  2787     05  INCURF PIC  X(0001).
  2788     05  FILLER REDEFINES INCURF.
  2789         10  INCURA PIC  X(0001).
  2790     05  INCURI PIC  X(0008).
  2791*    -------------------------------
  2792     05  LSTDTEL PIC S9(0004) COMP.
  2793     05  LSTDTEF PIC  X(0001).
  2794     05  FILLER REDEFINES LSTDTEF.
  2795         10  LSTDTEA PIC  X(0001).
  2796     05  LSTDTEI PIC  X(0008).
  2797*    -------------------------------
  2798     05  CRTSTATL PIC S9(0004) COMP.
  2799     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  58
* EL156.cbl
  2800     05  FILLER REDEFINES CRTSTATF.
  2801         10  CRTSTATA PIC  X(0001).
  2802     05  CRTSTATI PIC  X(0010).
  2803*    -------------------------------
  2804     05  EFFECTL PIC S9(0004) COMP.
  2805     05  EFFECTF PIC  X(0001).
  2806     05  FILLER REDEFINES EFFECTF.
  2807         10  EFFECTA PIC  X(0001).
  2808     05  EFFECTI PIC  X(0008).
  2809*    -------------------------------
  2810     05  TERMSL PIC S9(0004) COMP.
  2811     05  TERMSF PIC  X(0001).
  2812     05  FILLER REDEFINES TERMSF.
  2813         10  TERMSA PIC  X(0001).
  2814     05  TERMSI PIC  X(0011).
  2815*    -------------------------------
  2816     05  STACCTL PIC S9(0004) COMP.
  2817     05  STACCTF PIC  X(0001).
  2818     05  FILLER REDEFINES STACCTF.
  2819         10  STACCTA PIC  X(0001).
  2820     05  STACCTI PIC  X(0013).
  2821*    -------------------------------
  2822     05  EXPDTEHL PIC S9(0004) COMP.
  2823     05  EXPDTEHF PIC  X(0001).
  2824     05  FILLER REDEFINES EXPDTEHF.
  2825         10  EXPDTEHA PIC  X(0001).
  2826     05  EXPDTEHI PIC  X(0014).
  2827*    -------------------------------
  2828     05  EXPDTEL PIC S9(0004) COMP.
  2829     05  EXPDTEF PIC  X(0001).
  2830     05  FILLER REDEFINES EXPDTEF.
  2831         10  EXPDTEA PIC  X(0001).
  2832     05  EXPDTEI PIC  X(0008).
  2833*    -------------------------------
  2834     05  BENECAPL PIC S9(0004) COMP.
  2835     05  BENECAPF PIC  X(0001).
  2836     05  FILLER REDEFINES BENECAPF.
  2837         10  BENECAPA PIC  X(0001).
  2838     05  BENECAPI PIC  X(0013).
  2839*    -------------------------------
  2840     05  BENEL PIC S9(0004) COMP.
  2841     05  BENEF PIC  X(0001).
  2842     05  FILLER REDEFINES BENEF.
  2843         10  BENEA PIC  X(0001).
  2844     05  BENEI PIC  X(0009).
  2845*    -------------------------------
  2846     05  FORMTYPL PIC S9(0004) COMP.
  2847     05  FORMTYPF PIC  X(0001).
  2848     05  FILLER REDEFINES FORMTYPF.
  2849         10  FORMTYPA PIC  X(0001).
  2850     05  FORMTYPI PIC  X(0001).
  2851*    -------------------------------
  2852     05  PMTTYPEL PIC S9(0004) COMP.
  2853     05  PMTTYPEF PIC  X(0001).
  2854     05  FILLER REDEFINES PMTTYPEF.
  2855         10  PMTTYPEA PIC  X(0001).
  2856     05  PMTTYPEI PIC  X(0001).
  2857*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  59
* EL156.cbl
  2858     05  PAYEEL PIC S9(0004) COMP.
  2859     05  PAYEEF PIC  X(0001).
  2860     05  FILLER REDEFINES PAYEEF.
  2861         10  PAYEEA PIC  X(0001).
  2862     05  PAYEEI PIC  X(0002).
  2863*    -------------------------------
  2864     05  CHECKNOL PIC S9(0004) COMP.
  2865     05  CHECKNOF PIC  X(0001).
  2866     05  FILLER REDEFINES CHECKNOF.
  2867         10  CHECKNOA PIC  X(0001).
  2868     05  CHECKNOI PIC  X(0007).
  2869*    -------------------------------
  2870     05  OFFLINEL PIC S9(0004) COMP.
  2871     05  OFFLINEF PIC  X(0001).
  2872     05  FILLER REDEFINES OFFLINEF.
  2873         10  OFFLINEA PIC  X(0001).
  2874     05  OFFLINEI PIC  X(0001).
  2875*    -------------------------------
  2876     05  HOLDTILL PIC S9(0004) COMP.
  2877     05  HOLDTILF PIC  X(0001).
  2878     05  FILLER REDEFINES HOLDTILF.
  2879         10  HOLDTILA PIC  X(0001).
  2880     05  HOLDTILI PIC  X(0008).
  2881*    -------------------------------
  2882     05  NOTE1L PIC S9(0004) COMP.
  2883     05  NOTE1F PIC  X(0001).
  2884     05  FILLER REDEFINES NOTE1F.
  2885         10  NOTE1A PIC  X(0001).
  2886     05  NOTE1I PIC  X(0060).
  2887*    -------------------------------
  2888     05  NOTE2L PIC S9(0004) COMP.
  2889     05  NOTE2F PIC  X(0001).
  2890     05  FILLER REDEFINES NOTE2F.
  2891         10  NOTE2A PIC  X(0001).
  2892     05  NOTE2I PIC  X(0060).
  2893*    -------------------------------
  2894     05  EOBYNL PIC S9(0004) COMP.
  2895     05  EOBYNF PIC  X(0001).
  2896     05  FILLER REDEFINES EOBYNF.
  2897         10  EOBYNA PIC  X(0001).
  2898     05  EOBYNI PIC  X(0001).
  2899*    -------------------------------
  2900     05  CLMFMYNL PIC S9(0004) COMP.
  2901     05  CLMFMYNF PIC  X(0001).
  2902     05  FILLER REDEFINES CLMFMYNF.
  2903         10  CLMFMYNA PIC  X(0001).
  2904     05  CLMFMYNI PIC  X(0001).
  2905*    -------------------------------
  2906     05  SURVYYNL PIC S9(0004) COMP.
  2907     05  SURVYYNF PIC  X(0001).
  2908     05  FILLER REDEFINES SURVYYNF.
  2909         10  SURVYYNA PIC  X(0001).
  2910     05  SURVYYNI PIC  X(0001).
  2911*    -------------------------------
  2912     05  SPRELYNL PIC S9(0004) COMP.
  2913     05  SPRELYNF PIC  X(0001).
  2914     05  FILLER REDEFINES SPRELYNF.
  2915         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  60
* EL156.cbl
  2916     05  SPRELYNI PIC  X(0001).
  2917*    -------------------------------
  2918     05  PINTHL PIC S9(0004) COMP.
  2919     05  PINTHF PIC  X(0001).
  2920     05  FILLER REDEFINES PINTHF.
  2921         10  PINTHA PIC  X(0001).
  2922     05  PINTHI PIC  X(0004).
  2923*    -------------------------------
  2924     05  PINTL PIC S9(0004) COMP.
  2925     05  PINTF PIC  X(0001).
  2926     05  FILLER REDEFINES PINTF.
  2927         10  PINTA PIC  X(0001).
  2928     05  PINTI PIC  X(0008).
  2929*    -------------------------------
  2930     05  PROOFDTL PIC S9(0004) COMP.
  2931     05  PROOFDTF PIC  X(0001).
  2932     05  FILLER REDEFINES PROOFDTF.
  2933         10  PROOFDTA PIC  X(0001).
  2934     05  PROOFDTI PIC  X(0008).
  2935*    -------------------------------
  2936     05  AIGFRMHL PIC S9(0004) COMP.
  2937     05  AIGFRMHF PIC  X(0001).
  2938     05  FILLER REDEFINES AIGFRMHF.
  2939         10  AIGFRMHA PIC  X(0001).
  2940     05  AIGFRMHI PIC  X(0012).
  2941*    -------------------------------
  2942     05  AIGFROML PIC S9(0004) COMP.
  2943     05  AIGFROMF PIC  X(0001).
  2944     05  FILLER REDEFINES AIGFROMF.
  2945         10  AIGFROMA PIC  X(0001).
  2946     05  AIGFROMI PIC  X(0008).
  2947*    -------------------------------
  2948     05  PMTHDGAL PIC S9(0004) COMP.
  2949     05  PMTHDGAF PIC  X(0001).
  2950     05  FILLER REDEFINES PMTHDGAF.
  2951         10  PMTHDGAA PIC  X(0001).
  2952     05  PMTHDGAI PIC  X(0066).
  2953*    -------------------------------
  2954     05  EPYFROML PIC S9(0004) COMP.
  2955     05  EPYFROMF PIC  X(0001).
  2956     05  FILLER REDEFINES EPYFROMF.
  2957         10  EPYFROMA PIC  X(0001).
  2958     05  EPYFROMI PIC  X(0008).
  2959*    -------------------------------
  2960     05  EPYTHRUL PIC S9(0004) COMP.
  2961     05  EPYTHRUF PIC  X(0001).
  2962     05  FILLER REDEFINES EPYTHRUF.
  2963         10  EPYTHRUA PIC  X(0001).
  2964     05  EPYTHRUI PIC  X(0008).
  2965*    -------------------------------
  2966     05  EDAYSL PIC S9(0004) COMP.
  2967     05  EDAYSF PIC  X(0001).
  2968     05  FILLER REDEFINES EDAYSF.
  2969         10  EDAYSA PIC  X(0001).
  2970     05  EDAYSI PIC  S9(6).
  2971*    -------------------------------
  2972     05  EPYAMTL PIC S9(0004) COMP.
  2973     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  61
* EL156.cbl
  2974     05  FILLER REDEFINES EPYAMTF.
  2975         10  EPYAMTA PIC  X(0001).
  2976     05  EPYAMTI PIC  S9(8)V99.
  2977*    -------------------------------
  2978     05  ERESVL PIC S9(0004) COMP.
  2979     05  ERESVF PIC  X(0001).
  2980     05  FILLER REDEFINES ERESVF.
  2981         10  ERESVA PIC  X(0001).
  2982     05  ERESVI PIC  S9(7)V99.
  2983*    -------------------------------
  2984     05  ETYPEL PIC S9(0004) COMP.
  2985     05  ETYPEF PIC  X(0001).
  2986     05  FILLER REDEFINES ETYPEF.
  2987         10  ETYPEA PIC  X(0001).
  2988     05  ETYPEI PIC  X(0001).
  2989*    -------------------------------
  2990     05  EEXPENSL PIC S9(0004) COMP.
  2991     05  EEXPENSF PIC  X(0001).
  2992     05  FILLER REDEFINES EEXPENSF.
  2993         10  EEXPENSA PIC  X(0001).
  2994     05  EEXPENSI PIC  9(6)V99.
  2995*    -------------------------------
  2996     05  CPYFROML PIC S9(0004) COMP.
  2997     05  CPYFROMF PIC  X(0001).
  2998     05  FILLER REDEFINES CPYFROMF.
  2999         10  CPYFROMA PIC  X(0001).
  3000     05  CPYFROMI PIC  X(0008).
  3001*    -------------------------------
  3002     05  CPYTHRUL PIC S9(0004) COMP.
  3003     05  CPYTHRUF PIC  X(0001).
  3004     05  FILLER REDEFINES CPYTHRUF.
  3005         10  CPYTHRUA PIC  X(0001).
  3006     05  CPYTHRUI PIC  X(0008).
  3007*    -------------------------------
  3008     05  CDAYSL PIC S9(0004) COMP.
  3009     05  CDAYSF PIC  X(0001).
  3010     05  FILLER REDEFINES CDAYSF.
  3011         10  CDAYSA PIC  X(0001).
  3012     05  CDAYSI PIC  9(6).
  3013*    -------------------------------
  3014     05  CPYAMTL PIC S9(0004) COMP.
  3015     05  CPYAMTF PIC  X(0001).
  3016     05  FILLER REDEFINES CPYAMTF.
  3017         10  CPYAMTA PIC  X(0001).
  3018     05  CPYAMTI PIC  S9(8)V99.
  3019*    -------------------------------
  3020     05  CRESVL PIC S9(0004) COMP.
  3021     05  CRESVF PIC  X(0001).
  3022     05  FILLER REDEFINES CRESVF.
  3023         10  CRESVA PIC  X(0001).
  3024     05  CRESVI PIC  9(6)V99.
  3025*    -------------------------------
  3026     05  CEXPENSL PIC S9(0004) COMP.
  3027     05  CEXPENSF PIC  X(0001).
  3028     05  FILLER REDEFINES CEXPENSF.
  3029         10  CEXPENSA PIC  X(0001).
  3030     05  CEXPENSI PIC  9(6)V99.
  3031*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  62
* EL156.cbl
  3032     05  ERRMSG0L PIC S9(0004) COMP.
  3033     05  ERRMSG0F PIC  X(0001).
  3034     05  FILLER REDEFINES ERRMSG0F.
  3035         10  ERRMSG0A PIC  X(0001).
  3036     05  ERRMSG0I PIC  X(0072).
  3037*    -------------------------------
  3038     05  ERRMSG1L PIC S9(0004) COMP.
  3039     05  ERRMSG1F PIC  X(0001).
  3040     05  FILLER REDEFINES ERRMSG1F.
  3041         10  ERRMSG1A PIC  X(0001).
  3042     05  ERRMSG1I PIC  X(0072).
  3043*    -------------------------------
  3044     05  ERRMSG2L PIC S9(0004) COMP.
  3045     05  ERRMSG2F PIC  X(0001).
  3046     05  FILLER REDEFINES ERRMSG2F.
  3047         10  ERRMSG2A PIC  X(0001).
  3048     05  ERRMSG2I PIC  X(0072).
  3049*    -------------------------------
  3050     05  ENTERPFL PIC S9(0004) COMP.
  3051     05  ENTERPFF PIC  X(0001).
  3052     05  FILLER REDEFINES ENTERPFF.
  3053         10  ENTERPFA PIC  X(0001).
  3054     05  ENTERPFI PIC  99.
  3055*    -------------------------------
  3056     05  PF6TITL PIC S9(0004) COMP.
  3057     05  PF6TITF PIC  X(0001).
  3058     05  FILLER REDEFINES PF6TITF.
  3059         10  PF6TITA PIC  X(0001).
  3060     05  PF6TITI PIC  X(0016).
  3061 01  EL156AO REDEFINES EL156AI.
  3062     05  FILLER            PIC  X(0012).
  3063*    -------------------------------
  3064     05  FILLER            PIC  X(0003).
  3065     05  RUNDTEAO PIC  X(0008).
  3066*    -------------------------------
  3067     05  FILLER            PIC  X(0003).
  3068     05  RUNTIMAO PIC  99.99.
  3069*    -------------------------------
  3070     05  FILLER            PIC  X(0003).
  3071     05  SEQUO PIC  X(0010).
  3072*    -------------------------------
  3073     05  FILLER            PIC  X(0003).
  3074     05  CLMNOO PIC  X(0007).
  3075*    -------------------------------
  3076     05  FILLER            PIC  X(0003).
  3077     05  CARRO PIC  X(0001).
  3078*    -------------------------------
  3079     05  FILLER            PIC  X(0003).
  3080     05  CERTNOO PIC  X(0010).
  3081*    -------------------------------
  3082     05  FILLER            PIC  X(0003).
  3083     05  SUFXO PIC  X(0001).
  3084*    -------------------------------
  3085     05  FILLER            PIC  X(0003).
  3086     05  CLMTYPO PIC  X(0006).
  3087*    -------------------------------
  3088     05  FILLER            PIC  X(0003).
  3089     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  63
* EL156.cbl
  3090*    -------------------------------
  3091     05  FILLER            PIC  X(0003).
  3092     05  LSTNMEO PIC  X(0015).
  3093*    -------------------------------
  3094     05  FILLER            PIC  X(0003).
  3095     05  FSTNMEO PIC  X(0012).
  3096*    -------------------------------
  3097     05  FILLER            PIC  X(0003).
  3098     05  MINITO PIC  X(0001).
  3099*    -------------------------------
  3100     05  FILLER            PIC  X(0003).
  3101     05  PRIMHDGO PIC  X(0012).
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  PCERTNOO PIC  X(0010).
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  PSUFXO PIC  X(0001).
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  STATUSO PIC  X(0010).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  LOANHO PIC  X(0014).
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  LOANNOO PIC  X(0025).
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  DUEDAYHO PIC  X(0008).
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  DUEDAYO PIC  X(0002).
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  ZINTHO PIC  X(0009).
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  ZINTO PIC  9.99999.
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  PTHRHDGO PIC  X(0014).
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  PDTHRUO PIC  X(0008).
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
  3137     05  TOTPAIDO PIC  Z(6).99-.
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  COVERO PIC  X(0010).
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  INCURO PIC  X(0008).
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  LSTDTEO PIC  X(0008).
  3147*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  64
* EL156.cbl
  3148     05  FILLER            PIC  X(0003).
  3149     05  CRTSTATO PIC  X(0010).
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  EFFECTO PIC  X(0008).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  TERMSO PIC  X(0011).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  STACCTO PIC  X(0013).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  EXPDTEHO PIC  X(0014).
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  EXPDTEO PIC  X(0008).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  BENECAPO PIC  X(0013).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  BENEO PIC  Z(6).99.
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  FORMTYPO PIC  X(0001).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  PMTTYPEO PIC  X(0001).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  PAYEEO PIC  X(0002).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  CHECKNOO PIC  X(0007).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  OFFLINEO PIC  X(0001).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  HOLDTILO PIC  99B99B99.
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  NOTE1O PIC  X(0060).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  NOTE2O PIC  X(0060).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  EOBYNO PIC  X(0001).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  CLMFMYNO PIC  X(0001).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  SURVYYNO PIC  X(0001).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  65
* EL156.cbl
  3206     05  SPRELYNO PIC  X(0001).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  PINTHO PIC  X(0004).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PINTO PIC  Z,ZZ9.99.
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PROOFDTO PIC  99B99B99.
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  AIGFRMHO PIC  X(0012).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  AIGFROMO PIC  99B99B99.
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  PMTHDGAO PIC  X(0066).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  EPYFROMO PIC  99B99B99.
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  EPYTHRUO PIC  99B99B99.
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  EDAYSO PIC  Z(4)9-.
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  EPYAMTO PIC  Z(6).99-.
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  ERESVO PIC  Z(5).99-.
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  ETYPEO PIC  X(0001).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  EEXPENSO PIC  Z(5).99.
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  CPYFROMO PIC  99B99B99.
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  CPYTHRUO PIC  99B99B99.
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  CDAYSO PIC  Z(4)9-.
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  CPYAMTO PIC  Z(6).99-.
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  CRESVO PIC  Z(5).99.
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  66
* EL156.cbl
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  ERRMSG0O PIC  X(0072).
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  ERRMSG1O PIC  X(0072).
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  ERRMSG2O PIC  X(0072).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  ENTERPFO PIC  X(0002).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  PF6TITO PIC  X(0016).
  3279*    -------------------------------
  3280 01  EL156BI REDEFINES EL156AI.
  3281     05  FILLER            PIC  X(0012).
  3282*    -------------------------------
  3283     05  RUNDTEBL PIC S9(0004) COMP.
  3284     05  RUNDTEBF PIC  X(0001).
  3285     05  FILLER REDEFINES RUNDTEBF.
  3286         10  RUNDTEBA PIC  X(0001).
  3287     05  RUNDTEBI PIC  X(0008).
  3288*    -------------------------------
  3289     05  RUNTIMBL PIC S9(0004) COMP.
  3290     05  RUNTIMBF PIC  X(0001).
  3291     05  FILLER REDEFINES RUNTIMBF.
  3292         10  RUNTIMBA PIC  X(0001).
  3293     05  RUNTIMBI PIC  X(0005).
  3294*    -------------------------------
  3295     05  PAYDTBL PIC S9(0004) COMP.
  3296     05  PAYDTBF PIC  X(0001).
  3297     05  FILLER REDEFINES PAYDTBF.
  3298         10  PAYDTBA PIC  X(0001).
  3299     05  PAYDTBI PIC  X(0008).
  3300*    -------------------------------
  3301     05  PAYTYPBL PIC S9(0004) COMP.
  3302     05  PAYTYPBF PIC  X(0001).
  3303     05  FILLER REDEFINES PAYTYPBF.
  3304         10  PAYTYPBA PIC  X(0001).
  3305     05  PAYTYPBI PIC  X(0015).
  3306*    -------------------------------
  3307     05  PAYAMTBL PIC S9(0004) COMP.
  3308     05  PAYAMTBF PIC  X(0001).
  3309     05  FILLER REDEFINES PAYAMTBF.
  3310         10  PAYAMTBA PIC  X(0001).
  3311     05  PAYAMTBI PIC  X(0011).
  3312*    -------------------------------
  3313     05  LOANHBL PIC S9(0004) COMP.
  3314     05  LOANHBF PIC  X(0001).
  3315     05  FILLER REDEFINES LOANHBF.
  3316         10  LOANHBA PIC  X(0001).
  3317     05  LOANHBI PIC  X(0012).
  3318*    -------------------------------
  3319     05  LOANNBL PIC S9(0004) COMP.
  3320     05  LOANNBF PIC  X(0001).
  3321     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  67
* EL156.cbl
  3322         10  LOANNBA PIC  X(0001).
  3323     05  LOANNBI PIC  X(0025).
  3324*    -------------------------------
  3325     05  CKNUMHDL PIC S9(0004) COMP.
  3326     05  CKNUMHDF PIC  X(0001).
  3327     05  FILLER REDEFINES CKNUMHDF.
  3328         10  CKNUMHDA PIC  X(0001).
  3329     05  CKNUMHDI PIC  X(0012).
  3330*    -------------------------------
  3331     05  CKNUMBL PIC S9(0004) COMP.
  3332     05  CKNUMBF PIC  X(0001).
  3333     05  FILLER REDEFINES CKNUMBF.
  3334         10  CKNUMBA PIC  X(0001).
  3335     05  CKNUMBI PIC  X(0007).
  3336*    -------------------------------
  3337     05  AGTHDGL PIC S9(0004) COMP.
  3338     05  AGTHDGF PIC  X(0001).
  3339     05  FILLER REDEFINES AGTHDGF.
  3340         10  AGTHDGA PIC  X(0001).
  3341     05  AGTHDGI PIC  X(0016).
  3342*    -------------------------------
  3343     05  NAMEBL PIC S9(0004) COMP.
  3344     05  NAMEBF PIC  X(0001).
  3345     05  FILLER REDEFINES NAMEBF.
  3346         10  NAMEBA PIC  X(0001).
  3347     05  NAMEBI PIC  X(0030).
  3348*    -------------------------------
  3349     05  NAMEB2L PIC S9(0004) COMP.
  3350     05  NAMEB2F PIC  X(0001).
  3351     05  FILLER REDEFINES NAMEB2F.
  3352         10  NAMEB2A PIC  X(0001).
  3353     05  NAMEB2I PIC  X(0030).
  3354*    -------------------------------
  3355     05  ADDR1BL PIC S9(0004) COMP.
  3356     05  ADDR1BF PIC  X(0001).
  3357     05  FILLER REDEFINES ADDR1BF.
  3358         10  ADDR1BA PIC  X(0001).
  3359     05  ADDR1BI PIC  X(0030).
  3360*    -------------------------------
  3361     05  ADDR1B2L PIC S9(0004) COMP.
  3362     05  ADDR1B2F PIC  X(0001).
  3363     05  FILLER REDEFINES ADDR1B2F.
  3364         10  ADDR1B2A PIC  X(0001).
  3365     05  ADDR1B2I PIC  X(0030).
  3366*    -------------------------------
  3367     05  ADDR2BL PIC S9(0004) COMP.
  3368     05  ADDR2BF PIC  X(0001).
  3369     05  FILLER REDEFINES ADDR2BF.
  3370         10  ADDR2BA PIC  X(0001).
  3371     05  ADDR2BI PIC  X(0030).
  3372*    -------------------------------
  3373     05  ADDR2B2L PIC S9(0004) COMP.
  3374     05  ADDR2B2F PIC  X(0001).
  3375     05  FILLER REDEFINES ADDR2B2F.
  3376         10  ADDR2B2A PIC  X(0001).
  3377     05  ADDR2B2I PIC  X(0030).
  3378*    -------------------------------
  3379     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  68
* EL156.cbl
  3380     05  CITYSTBF PIC  X(0001).
  3381     05  FILLER REDEFINES CITYSTBF.
  3382         10  CITYSTBA PIC  X(0001).
  3383     05  CITYSTBI PIC  X(0030).
  3384*    -------------------------------
  3385     05  CITYST2L PIC S9(0004) COMP.
  3386     05  CITYST2F PIC  X(0001).
  3387     05  FILLER REDEFINES CITYST2F.
  3388         10  CITYST2A PIC  X(0001).
  3389     05  CITYST2I PIC  X(0030).
  3390*    -------------------------------
  3391     05  ZIPBL PIC S9(0004) COMP.
  3392     05  ZIPBF PIC  X(0001).
  3393     05  FILLER REDEFINES ZIPBF.
  3394         10  ZIPBA PIC  X(0001).
  3395     05  ZIPBI PIC  X(0009).
  3396*    -------------------------------
  3397     05  ZIPB2L PIC S9(0004) COMP.
  3398     05  ZIPB2F PIC  X(0001).
  3399     05  FILLER REDEFINES ZIPB2F.
  3400         10  ZIPB2A PIC  X(0001).
  3401     05  ZIPB2I PIC  X(0009).
  3402*    -------------------------------
  3403     05  INTHDBL PIC S9(0004) COMP.
  3404     05  INTHDBF PIC  X(0001).
  3405     05  FILLER REDEFINES INTHDBF.
  3406         10  INTHDBA PIC  X(0001).
  3407     05  INTHDBI PIC  X(0012).
  3408*    -------------------------------
  3409     05  INTAMTBL PIC S9(0004) COMP.
  3410     05  INTAMTBF PIC  X(0001).
  3411     05  FILLER REDEFINES INTAMTBF.
  3412         10  INTAMTBA PIC  X(0001).
  3413     05  INTAMTBI PIC  X(0011).
  3414*    -------------------------------
  3415     05  PMTHDGBL PIC S9(0004) COMP.
  3416     05  PMTHDGBF PIC  X(0001).
  3417     05  FILLER REDEFINES PMTHDGBF.
  3418         10  PMTHDGBA PIC  X(0001).
  3419     05  PMTHDGBI PIC  X(0034).
  3420*    -------------------------------
  3421     05  CLMNOBL PIC S9(0004) COMP.
  3422     05  CLMNOBF PIC  X(0001).
  3423     05  FILLER REDEFINES CLMNOBF.
  3424         10  CLMNOBA PIC  X(0001).
  3425     05  CLMNOBI PIC  X(0007).
  3426*    -------------------------------
  3427     05  CARRBL PIC S9(0004) COMP.
  3428     05  CARRBF PIC  X(0001).
  3429     05  FILLER REDEFINES CARRBF.
  3430         10  CARRBA PIC  X(0001).
  3431     05  CARRBI PIC  X(0001).
  3432*    -------------------------------
  3433     05  CERTNOBL PIC S9(0004) COMP.
  3434     05  CERTNOBF PIC  X(0001).
  3435     05  FILLER REDEFINES CERTNOBF.
  3436         10  CERTNOBA PIC  X(0001).
  3437     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  69
* EL156.cbl
  3438*    -------------------------------
  3439     05  SUFXBL PIC S9(0004) COMP.
  3440     05  SUFXBF PIC  X(0001).
  3441     05  FILLER REDEFINES SUFXBF.
  3442         10  SUFXBA PIC  X(0001).
  3443     05  SUFXBI PIC  X(0001).
  3444*    -------------------------------
  3445     05  CLMTYPBL PIC S9(0004) COMP.
  3446     05  CLMTYPBF PIC  X(0001).
  3447     05  FILLER REDEFINES CLMTYPBF.
  3448         10  CLMTYPBA PIC  X(0001).
  3449     05  CLMTYPBI PIC  X(0006).
  3450*    -------------------------------
  3451     05  INCURBL PIC S9(0004) COMP.
  3452     05  INCURBF PIC  X(0001).
  3453     05  FILLER REDEFINES INCURBF.
  3454         10  INCURBA PIC  X(0001).
  3455     05  INCURBI PIC  X(0008).
  3456*    -------------------------------
  3457     05  PYFROMBL PIC S9(0004) COMP.
  3458     05  PYFROMBF PIC  X(0001).
  3459     05  FILLER REDEFINES PYFROMBF.
  3460         10  PYFROMBA PIC  X(0001).
  3461     05  PYFROMBI PIC  X(0008).
  3462*    -------------------------------
  3463     05  PYTHRUBL PIC S9(0004) COMP.
  3464     05  PYTHRUBF PIC  X(0001).
  3465     05  FILLER REDEFINES PYTHRUBF.
  3466         10  PYTHRUBA PIC  X(0001).
  3467     05  PYTHRUBI PIC  X(0008).
  3468*    -------------------------------
  3469     05  DAYSBL PIC S9(0004) COMP.
  3470     05  DAYSBF PIC  X(0001).
  3471     05  FILLER REDEFINES DAYSBF.
  3472         10  DAYSBA PIC  X(0001).
  3473     05  DAYSBI PIC  X(0005).
  3474*    -------------------------------
  3475     05  BYBL PIC S9(0004) COMP.
  3476     05  BYBF PIC  X(0001).
  3477     05  FILLER REDEFINES BYBF.
  3478         10  BYBA PIC  X(0001).
  3479     05  BYBI PIC  X(0004).
  3480*    -------------------------------
  3481     05  PROOFDBL PIC S9(0004) COMP.
  3482     05  PROOFDBF PIC  X(0001).
  3483     05  FILLER REDEFINES PROOFDBF.
  3484         10  PROOFDBA PIC  X(0001).
  3485     05  PROOFDBI PIC  X(0008).
  3486*    -------------------------------
  3487     05  ACCTBL PIC S9(0004) COMP.
  3488     05  ACCTBF PIC  X(0001).
  3489     05  FILLER REDEFINES ACCTBF.
  3490         10  ACCTBA PIC  X(0001).
  3491     05  ACCTBI PIC  X(0010).
  3492*    -------------------------------
  3493     05  STATEBL PIC S9(0004) COMP.
  3494     05  STATEBF PIC  X(0001).
  3495     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  70
* EL156.cbl
  3496         10  STATEBA PIC  X(0001).
  3497     05  STATEBI PIC  X(0002).
  3498*    -------------------------------
  3499     05  GROUPBL PIC S9(0004) COMP.
  3500     05  GROUPBF PIC  X(0001).
  3501     05  FILLER REDEFINES GROUPBF.
  3502         10  GROUPBA PIC  X(0001).
  3503     05  GROUPBI PIC  X(0006).
  3504*    -------------------------------
  3505     05  ACARRBL PIC S9(0004) COMP.
  3506     05  ACARRBF PIC  X(0001).
  3507     05  FILLER REDEFINES ACARRBF.
  3508         10  ACARRBA PIC  X(0001).
  3509     05  ACARRBI PIC  X(0001).
  3510*    -------------------------------
  3511     05  ACCTNMBL PIC S9(0004) COMP.
  3512     05  ACCTNMBF PIC  X(0001).
  3513     05  FILLER REDEFINES ACCTNMBF.
  3514         10  ACCTNMBA PIC  X(0001).
  3515     05  ACCTNMBI PIC  X(0030).
  3516*    -------------------------------
  3517     05  UNDISBL PIC S9(0004) COMP.
  3518     05  UNDISBF PIC  X(0001).
  3519     05  FILLER REDEFINES UNDISBF.
  3520         10  UNDISBA PIC  X(0001).
  3521     05  UNDISBI PIC  X(0010).
  3522*    -------------------------------
  3523     05  RATEBL PIC S9(0004) COMP.
  3524     05  RATEBF PIC  X(0001).
  3525     05  FILLER REDEFINES RATEBF.
  3526         10  RATEBA PIC  X(0001).
  3527     05  RATEBI PIC  X(0006).
  3528*    -------------------------------
  3529     05  ERMSG1BL PIC S9(0004) COMP.
  3530     05  ERMSG1BF PIC  X(0001).
  3531     05  FILLER REDEFINES ERMSG1BF.
  3532         10  ERMSG1BA PIC  X(0001).
  3533     05  ERMSG1BI PIC  X(0072).
  3534*    -------------------------------
  3535     05  ENTPFBL PIC S9(0004) COMP.
  3536     05  ENTPFBF PIC  X(0001).
  3537     05  FILLER REDEFINES ENTPFBF.
  3538         10  ENTPFBA PIC  X(0001).
  3539     05  ENTPFBI PIC  99.
  3540 01  EL156BO REDEFINES EL156AI.
  3541     05  FILLER            PIC  X(0012).
  3542*    -------------------------------
  3543     05  FILLER            PIC  X(0003).
  3544     05  RUNDTEBO PIC  X(0008).
  3545*    -------------------------------
  3546     05  FILLER            PIC  X(0003).
  3547     05  RUNTIMBO PIC  99.99.
  3548*    -------------------------------
  3549     05  FILLER            PIC  X(0003).
  3550     05  PAYDTBO PIC  99B99B99.
  3551*    -------------------------------
  3552     05  FILLER            PIC  X(0003).
  3553     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  71
* EL156.cbl
  3554*    -------------------------------
  3555     05  FILLER            PIC  X(0003).
  3556     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3557*    -------------------------------
  3558     05  FILLER            PIC  X(0003).
  3559     05  LOANHBO PIC  X(0012).
  3560*    -------------------------------
  3561     05  FILLER            PIC  X(0003).
  3562     05  LOANNBO PIC  X(0025).
  3563*    -------------------------------
  3564     05  FILLER            PIC  X(0003).
  3565     05  CKNUMHDO PIC  X(0012).
  3566*    -------------------------------
  3567     05  FILLER            PIC  X(0003).
  3568     05  CKNUMBO PIC  X(0007).
  3569*    -------------------------------
  3570     05  FILLER            PIC  X(0003).
  3571     05  AGTHDGO PIC  X(0016).
  3572*    -------------------------------
  3573     05  FILLER            PIC  X(0003).
  3574     05  NAMEBO PIC  X(0030).
  3575*    -------------------------------
  3576     05  FILLER            PIC  X(0003).
  3577     05  NAMEB2O PIC  X(0030).
  3578*    -------------------------------
  3579     05  FILLER            PIC  X(0003).
  3580     05  ADDR1BO PIC  X(0030).
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  ADDR1B2O PIC  X(0030).
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  ADDR2BO PIC  X(0030).
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  ADDR2B2O PIC  X(0030).
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  CITYSTBO PIC  X(0030).
  3593*    -------------------------------
  3594     05  FILLER            PIC  X(0003).
  3595     05  CITYST2O PIC  X(0030).
  3596*    -------------------------------
  3597     05  FILLER            PIC  X(0003).
  3598     05  ZIPBO PIC  ZZZZ99999.
  3599*    -------------------------------
  3600     05  FILLER            PIC  X(0003).
  3601     05  ZIPB2O PIC  ZZZZZZZZZ.
  3602*    -------------------------------
  3603     05  FILLER            PIC  X(0003).
  3604     05  INTHDBO PIC  X(0012).
  3605*    -------------------------------
  3606     05  FILLER            PIC  X(0003).
  3607     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3608*    -------------------------------
  3609     05  FILLER            PIC  X(0003).
  3610     05  PMTHDGBO PIC  X(0034).
  3611*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  72
* EL156.cbl
  3612     05  FILLER            PIC  X(0003).
  3613     05  CLMNOBO PIC  X(0007).
  3614*    -------------------------------
  3615     05  FILLER            PIC  X(0003).
  3616     05  CARRBO PIC  X(0001).
  3617*    -------------------------------
  3618     05  FILLER            PIC  X(0003).
  3619     05  CERTNOBO PIC  X(0010).
  3620*    -------------------------------
  3621     05  FILLER            PIC  X(0003).
  3622     05  SUFXBO PIC  X(0001).
  3623*    -------------------------------
  3624     05  FILLER            PIC  X(0003).
  3625     05  CLMTYPBO PIC  X(0006).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  INCURBO PIC  X(0008).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  PYFROMBO PIC  99B99B99.
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  PYTHRUBO PIC  99B99B99.
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  DAYSBO PIC  X(0005).
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  BYBO PIC  X(0004).
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  PROOFDBO PIC  99B99B99.
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  ACCTBO PIC  X(0010).
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  STATEBO PIC  X(0002).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  GROUPBO PIC  X(0006).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  ACARRBO PIC  X(0001).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  ACCTNMBO PIC  X(0030).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  UNDISBO PIC  ZZZ,Z99.99.
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  RATEBO PIC  ZZZ.99.
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  ERMSG1BO PIC  X(0072).
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  73
* EL156.cbl
  3670     05  ENTPFBO PIC  X(0002).
  3671*    -------------------------------
  3672****************************************************************
  3673*
  3674* Copyright (c) 2007 by Clerity Solutions, Inc.
  3675* All rights reserved.
  3676*
  3677****************************************************************
  3678 01  DFHEIV.
  3679   02  DFHEIV0               PIC X(35).
  3680   02  DFHEIV1               PIC X(08).
  3681   02  DFHEIV2               PIC X(08).
  3682   02  DFHEIV3               PIC X(08).
  3683   02  DFHEIV4               PIC X(06).
  3684   02  DFHEIV5               PIC X(04).
  3685   02  DFHEIV6               PIC X(04).
  3686   02  DFHEIV7               PIC X(02).
  3687   02  DFHEIV8               PIC X(02).
  3688   02  DFHEIV9               PIC X(01).
  3689   02  DFHEIV10              PIC S9(7) COMP-3.
  3690   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3691   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3692   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3693   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3694   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3695   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3696   02  DFHEIV17              PIC X(04).
  3697   02  DFHEIV18              PIC X(04).
  3698   02  DFHEIV19              PIC X(04).
  3699   02  DFHEIV20              USAGE IS POINTER.
  3700   02  DFHEIV21              USAGE IS POINTER.
  3701   02  DFHEIV22              USAGE IS POINTER.
  3702   02  DFHEIV23              USAGE IS POINTER.
  3703   02  DFHEIV24              USAGE IS POINTER.
  3704   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3705   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3706   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3707   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3708   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3709   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3710   02  FILLER                PIC X(02).
  3711   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3712   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3713   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3714   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3715   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3716 LINKAGE  SECTION.
  3717*****************************************************************
  3718*                                                               *
  3719* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3720* All rights reserved.                                          *
  3721*                                                               *
  3722*****************************************************************
  3723 01  dfheiblk.
  3724     02  eibtime          pic s9(7) comp-3.
  3725     02  eibdate          pic s9(7) comp-3.
  3726     02  eibtrnid         pic x(4).
  3727     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  74
* EL156.cbl
  3728     02  eibtrmid         pic x(4).
  3729     02  dfheigdi         pic s9(4) comp.
  3730     02  eibcposn         pic s9(4) comp.
  3731     02  eibcalen         pic s9(4) comp.
  3732     02  eibaid           pic x(1).
  3733     02  eibfiller1       pic x(1).
  3734     02  eibfn            pic x(2).
  3735     02  eibfiller2       pic x(2).
  3736     02  eibrcode         pic x(6).
  3737     02  eibfiller3       pic x(2).
  3738     02  eibds            pic x(8).
  3739     02  eibreqid         pic x(8).
  3740     02  eibrsrce         pic x(8).
  3741     02  eibsync          pic x(1).
  3742     02  eibfree          pic x(1).
  3743     02  eibrecv          pic x(1).
  3744     02  eibsend          pic x(1).
  3745     02  eibatt           pic x(1).
  3746     02  eibeoc           pic x(1).
  3747     02  eibfmh           pic x(1).
  3748     02  eibcompl         pic x(1).
  3749     02  eibsig           pic x(1).
  3750     02  eibconf          pic x(1).
  3751     02  eiberr           pic x(1).
  3752     02  eibrldbk         pic x(1).
  3753     02  eiberrcd         pic x(4).
  3754     02  eibsynrb         pic x(1).
  3755     02  eibnodat         pic x(1).
  3756     02  eibfiller5       pic x(2).
  3757     02  eibresp          pic 9(09) comp.
  3758     02  eibresp2         pic 9(09) comp.
  3759     02  dfheigdj         pic s9(4) comp.
  3760     02  dfheigdk         pic s9(4) comp.
  3761 01  DFHCOMMAREA             PIC X(1024).
  3762
  3763*    COPY ELCMSTR.
  3764******************************************************************
  3765*                                                                *
  3766*                            ELCMSTR.                            *
  3767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3768*                            VMOD=2.012                          *
  3769*                                                                *
  3770*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3771*                                                                *
  3772*   FILE TYPE = VSAM,KSDS                                        *
  3773*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3774*                                                                *
  3775*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3776*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3777*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3778*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3779*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3780*                                                 RKP=75,LEN=21  *
  3781*                                                                *
  3782*   **** NOTE ****                                               *
  3783*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3784*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3785*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  75
* EL156.cbl
  3786*   LOG = YES                                                    *
  3787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3788******************************************************************
  3789*                   C H A N G E   L O G
  3790*
  3791* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3792*-----------------------------------------------------------------
  3793*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3794* EFFECTIVE    NUMBER
  3795*-----------------------------------------------------------------
  3796* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3797* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3798* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3799******************************************************************
  3800 01  CLAIM-MASTER.
  3801     12  CL-RECORD-ID                PIC XX.
  3802         88  VALID-CL-ID         VALUE 'CL'.
  3803
  3804     12  CL-CONTROL-PRIMARY.
  3805         16  CL-COMPANY-CD           PIC X.
  3806         16  CL-CARRIER              PIC X.
  3807         16  CL-CLAIM-NO             PIC X(7).
  3808         16  CL-CERT-NO.
  3809             20  CL-CERT-PRIME       PIC X(10).
  3810             20  CL-CERT-SFX         PIC X.
  3811
  3812     12  CL-CONTROL-BY-NAME.
  3813         16  CL-COMPANY-CD-A1        PIC X.
  3814         16  CL-INSURED-LAST-NAME    PIC X(15).
  3815         16  CL-INSURED-NAME.
  3816             20  CL-INSURED-1ST-NAME PIC X(12).
  3817             20  CL-INSURED-MID-INIT PIC X.
  3818
  3819     12  CL-CONTROL-BY-SSN.
  3820         16  CL-COMPANY-CD-A2        PIC X.
  3821         16  CL-SOC-SEC-NO.
  3822             20  CL-SSN-STATE        PIC XX.
  3823             20  CL-SSN-ACCOUNT      PIC X(6).
  3824             20  CL-SSN-LN3          PIC X(3).
  3825
  3826     12  CL-CONTROL-BY-CERT-NO.
  3827         16  CL-COMPANY-CD-A4        PIC X.
  3828         16  CL-CERT-NO-A4.
  3829             20  CL-CERT-A4-PRIME    PIC X(10).
  3830             20  CL-CERT-A4-SFX      PIC X.
  3831
  3832     12  CL-CONTROL-BY-CCN.
  3833         16  CL-COMPANY-CD-A5        PIC X.
  3834         16  CL-CCN-A5.
  3835             20  CL-CCN.
  3836                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3837                 24  CL-CCN-PRIME-A5 PIC X(12).
  3838             20  CL-CCN-FILLER-A5    PIC X(4).
  3839
  3840     12  CL-INSURED-PROFILE-DATA.
  3841         16  CL-INSURED-BIRTH-DT     PIC XX.
  3842         16  CL-INSURED-SEX-CD       PIC X.
  3843             88  INSURED-IS-MALE        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  76
* EL156.cbl
  3844             88  INSURED-IS-FEMALE      VALUE 'F'.
  3845             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3846         16  CL-INSURED-OCC-CD       PIC X(6).
  3847         16  FILLER                  PIC X(5).
  3848
  3849     12  CL-PROCESSING-INFO.
  3850         16  CL-PROCESSOR-ID         PIC X(4).
  3851         16  CL-CLAIM-STATUS         PIC X.
  3852             88  CLAIM-IS-OPEN          VALUE 'O'.
  3853             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3854         16  CL-CLAIM-TYPE           PIC X.
  3855*            88  AH-CLAIM               VALUE 'A'.
  3856*            88  LIFE-CLAIM             VALUE 'L'.
  3857*            88  PROPERTY-CLAIM         VALUE 'P'.
  3858*            88  IUI-CLAIM              VALUE 'I'.
  3859*            88  GAP-CLAIM              VALUE 'G'.
  3860         16  CL-CLAIM-PREM-TYPE      PIC X.
  3861             88  SINGLE-PREMIUM         VALUE '1'.
  3862             88  O-B-COVERAGE           VALUE '2'.
  3863             88  OPEN-END-COVERAGE      VALUE '3'.
  3864         16  CL-INCURRED-DT          PIC XX.
  3865         16  CL-REPORTED-DT          PIC XX.
  3866         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3867         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3868         16  CL-LAST-PMT-DT          PIC XX.
  3869         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3870         16  CL-PAID-THRU-DT         PIC XX.
  3871         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3872         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3873         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3874         16  CL-PMT-CALC-METHOD      PIC X.
  3875             88  CL-360-DAY-YR          VALUE '1'.
  3876             88  CL-365-DAY-YR          VALUE '2'.
  3877             88  CL-FULL-MONTHS         VALUE '3'.
  3878         16  CL-CAUSE-CD             PIC X(6).
  3879
  3880         16  CL-PRIME-CERT-NO.
  3881             20  CL-PRIME-CERT-PRIME PIC X(10).
  3882             20  CL-PRIME-CERT-SFX   PIC X.
  3883
  3884         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3885             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3886             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3887
  3888         16  CL-MICROFILM-NO         PIC X(10).
  3889         16  CL-PROG-FORM-TYPE       PIC X.
  3890         16  CL-LAST-ADD-ON-DT       PIC XX.
  3891
  3892         16  CL-LAST-REOPEN-DT       PIC XX.
  3893         16  CL-LAST-CLOSE-DT        PIC XX.
  3894         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3895             88  FINAL-PAID             VALUE '1'.
  3896             88  CLAIM-DENIED           VALUE '2'.
  3897             88  AUTO-CLOSE             VALUE '3'.
  3898             88  MANUAL-CLOSE           VALUE '4'.
  3899             88  BENEFITS-CHANGED       VALUE 'C'.
  3900             88  SETUP-ERRORS           VALUE 'E'.
  3901         16  CL-ASSOC-CERT-SEQU      PIC S99.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  77
* EL156.cbl
  3902         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3903         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3904             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3905         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3906         16  FILLER                  PIC X.
  3907
  3908     12  CL-CERTIFICATE-DATA.
  3909         16  CL-CERT-ORIGIN          PIC X.
  3910             88  CERT-WAS-ONLINE        VALUE '1'.
  3911             88  CERT-WAS-CREATED       VALUE '2'.
  3912             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3913         16  CL-CERT-KEY-DATA.
  3914             20  CL-CERT-CARRIER     PIC X.
  3915             20  CL-CERT-GROUPING    PIC X(6).
  3916             20  CL-CERT-STATE       PIC XX.
  3917             20  CL-CERT-ACCOUNT.
  3918                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3919                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3920             20  CL-CERT-EFF-DT      PIC XX.
  3921
  3922     12  CL-STATUS-CONTROLS.
  3923         16  CL-PRIORITY-CD          PIC X.
  3924             88  CONFIDENTIAL-DATA      VALUE '8'.
  3925             88  HIGHEST-PRIORITY       VALUE '9'.
  3926         16  CL-SUPV-ATTN-CD         PIC X.
  3927             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3928             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3929         16  CL-PURGED-DT            PIC XX.
  3930         16  CL-RESTORED-DT          PIC XX.
  3931         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3932         16  CL-NEXT-RESEND-DT       PIC XX.
  3933         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3934         16  CL-CRITICAL-PERIOD      PIC 99.
  3935*        16  FILLER                  PIC XX.
  3936         16  CL-LAST-MAINT-DT        PIC XX.
  3937         16  CL-LAST-MAINT-USER      PIC X(4).
  3938         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3939         16  CL-LAST-MAINT-TYPE      PIC X.
  3940             88  CLAIM-SET-UP           VALUE ' '.
  3941             88  PAYMENT-MADE           VALUE '1'.
  3942             88  LETTER-SENT            VALUE '2'.
  3943             88  MASTER-WAS-ALTERED     VALUE '3'.
  3944             88  MASTER-WAS-RESTORED    VALUE '4'.
  3945             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3946             88  FILE-CONVERTED         VALUE '6'.
  3947             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3948             88  ERROR-CORRECTION       VALUE 'E'.
  3949         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3950         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3951         16  CL-BENEFICIARY          PIC X(10).
  3952         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3953         16  CL-DENIAL-TYPE          PIC X.
  3954             88  CL-TYPE-DENIAL          VALUE '1'.
  3955             88  CL-TYPE-RESCISSION      VALUE '2'.
  3956             88  CL-TYPE-REFORMATION     VALUE '3'.
  3957             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3958             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3959         16  CL-CRIT-PER-RECURRENT   PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  78
* EL156.cbl
  3960         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3961         16  CL-RTW-DT               PIC XX.
  3962
  3963     12  CL-TRAILER-CONTROLS.
  3964         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3965             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3966             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3967             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3968         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3969         16  FILLER                  PIC XX.
  3970         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3971         16  CL-ADDRESS-TRAILER-CNT.
  3972             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3973                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3974             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3975                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3976             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3977                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3978             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3979                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3980             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3981                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3982             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3983                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3984             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3985                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3986
  3987     12  CL-CV-REFERENCE-NO.
  3988         16  CL-CV-REFNO-PRIME       PIC X(18).
  3989         16  CL-CV-REFNO-SFX         PIC XX.
  3990
  3991     12  CL-FILE-LOCATION            PIC X(4).
  3992
  3993     12  CL-PROCESS-ERRORS.
  3994         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3995             88  NO-FATAL-ERRORS        VALUE ZERO.
  3996         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3997             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3998
  3999     12  CL-PRODUCT-CD               PIC X.
  4000
  4001     12  CL-CURRENT-KEY-DATA.
  4002         16  CL-CURRENT-CARRIER      PIC X.
  4003         16  CL-CURRENT-GROUPING     PIC X(6).
  4004         16  CL-CURRENT-STATE        PIC XX.
  4005         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4006
  4007     12  CL-ASSOCIATES               PIC X.
  4008         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4009         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4010         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4011         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4012
  4013     12  CL-ACTIVITY-CODE            PIC 99.
  4014     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4015     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4016
  4017     12  CL-LAPSE-REPORT-CODE        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  79
* EL156.cbl
  4018     12  CL-LAG-REPORT-CODE          PIC 9.
  4019     12  CL-LOAN-TYPE                PIC XX.
  4020     12  CL-LEGAL-STATE              PIC XX.
  4021
  4022     12  CL-YESNOSW                  PIC X.
  4023     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4024         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4025         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4026         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4027     12  cl-insured-claim            pic x.
  4028         88  cl-claim-on-primary         value 'P'.
  4029         88  cl-claim-on-secondary       value 'S'.
  4030     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  80
* EL156.cbl
  4032*    COPY ELCCNTL.
  4033******************************************************************
  4034*                                                                *
  4035*                                                                *
  4036*                            ELCCNTL.                            *
  4037*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4038*                            VMOD=2.059                          *
  4039*                                                                *
  4040*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4041*                                                                *
  4042*   FILE TYPE = VSAM,KSDS                                        *
  4043*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4044*                                                                *
  4045*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4046*       ALTERNATE INDEX = NONE                                   *
  4047*                                                                *
  4048*   LOG = YES                                                    *
  4049*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4050******************************************************************
  4051*                   C H A N G E   L O G
  4052*
  4053* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4054*-----------------------------------------------------------------
  4055*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4056* EFFECTIVE    NUMBER
  4057*-----------------------------------------------------------------
  4058* 082503                   PEMA  ADD BENEFIT GROUP
  4059* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4060* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4061* 092705    2005050300006  PEMA  ADD SPP LEASES
  4062* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4063* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4064* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4065* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4066* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4067* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4068* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4069* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4070* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4071******************************************************************
  4072*
  4073 01  CONTROL-FILE.
  4074     12  CF-RECORD-ID                       PIC XX.
  4075         88  VALID-CF-ID                        VALUE 'CF'.
  4076
  4077     12  CF-CONTROL-PRIMARY.
  4078         16  CF-COMPANY-ID                  PIC XXX.
  4079         16  CF-RECORD-TYPE                 PIC X.
  4080             88  CF-COMPANY-MASTER              VALUE '1'.
  4081             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4082             88  CF-STATE-MASTER                VALUE '3'.
  4083             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4084             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4085             88  CF-CARRIER-MASTER              VALUE '6'.
  4086             88  CF-MORTALITY-MASTER            VALUE '7'.
  4087             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4088             88  CF-TERMINAL-MASTER             VALUE '9'.
  4089             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  81
* EL156.cbl
  4090             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4091             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4092             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4093             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4094             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4095             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4096             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4097             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4098         16  CF-ACCESS-CD-GENL              PIC X(4).
  4099         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4100             20  CF-PROCESSOR               PIC X(4).
  4101         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4102             20  CF-STATE-CODE              PIC XX.
  4103             20  FILLER                     PIC XX.
  4104         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4105             20  FILLER                     PIC XX.
  4106             20  CF-HI-BEN-IN-REC           PIC XX.
  4107         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4108             20  FILLER                     PIC XXX.
  4109             20  CF-CARRIER-CNTL            PIC X.
  4110         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4111             20  FILLER                     PIC XX.
  4112             20  CF-HI-TYPE-IN-REC          PIC 99.
  4113         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4114             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4115                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4116             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4117             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4118         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4119             20  FILLER                     PIC X.
  4120             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4121         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4122             20  FILLER                     PIC XX.
  4123             20  CF-MORTGAGE-PLAN           PIC XX.
  4124         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4125
  4126     12  CF-LAST-MAINT-DT                   PIC XX.
  4127     12  CF-LAST-MAINT-BY                   PIC X(4).
  4128     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4129
  4130     12  CF-RECORD-BODY                     PIC X(728).
  4131
  4132
  4133****************************************************************
  4134*             COMPANY MASTER RECORD                            *
  4135****************************************************************
  4136
  4137     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4138         16  CF-COMPANY-ADDRESS.
  4139             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4140             20  CF-CL-IN-CARE-OF           PIC X(30).
  4141             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4142             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4143             20  CF-CL-CITY-STATE           PIC X(30).
  4144             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4145             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4146         16  CF-COMPANY-CD                  PIC X.
  4147         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  82
* EL156.cbl
  4148         16  CF-SECURITY-OPTION             PIC X.
  4149             88  ALL-SECURITY                   VALUE '1'.
  4150             88  COMPANY-VERIFY                 VALUE '2'.
  4151             88  PROCESSOR-VERIFY               VALUE '3'.
  4152             88  NO-SECURITY                    VALUE '4'.
  4153             88  ALL-BUT-TERM                   VALUE '5'.
  4154         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4155             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4156         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4157             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4158         16  CF-INFORCE-LOCATION            PIC X.
  4159             88  CERTS-ARE-ONLINE               VALUE '1'.
  4160             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4161             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4162         16  CF-LOWER-CASE-LETTERS          PIC X.
  4163         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4164             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4165             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4166             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4167             88  CF-ACCNT-CNTL                  VALUE '3'.
  4168             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4169
  4170         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4171         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4172
  4173         16  CF-LGX-CREDIT-USER             PIC X.
  4174             88  CO-IS-NOT-USER                 VALUE 'N'.
  4175             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4176
  4177         16 CF-CREDIT-CALC-CODES.
  4178             20  CF-CR-REM-TERM-CALC PIC X.
  4179               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4180               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4181               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4182               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4183               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4184               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4185               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4186             20  CF-CR-R78-METHOD           PIC X.
  4187               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4188               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4189
  4190         16  CF-CLAIM-CONTROL-COUNTS.
  4191             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4192                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4193
  4194             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4195                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4196
  4197             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4198                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4199
  4200             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4201                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4202
  4203         16  CF-CURRENT-MONTH-END           PIC XX.
  4204
  4205         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  83
* EL156.cbl
  4206             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4207             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4208             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4209             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4210                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4211                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4212             20  CF-CO-PREM-REJECT-SW       PIC X.
  4213                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4214                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4215             20  CF-CO-REF-REJECT-SW        PIC X.
  4216                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4217                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4218
  4219         16  CF-CO-REPORTING-DT             PIC XX.
  4220         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4221         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4222           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4223           88  CF-CO-MONTH-END                  VALUE '1'.
  4224
  4225         16  CF-LGX-CLAIM-USER              PIC X.
  4226             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4227             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4228
  4229         16  CF-CREDIT-EDIT-CONTROLS.
  4230             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4231             20  CF-MIN-AGE                 PIC 99.
  4232             20  CF-DEFAULT-AGE             PIC 99.
  4233             20  CF-MIN-TERM                PIC S999      COMP-3.
  4234             20  CF-MAX-TERM                PIC S999      COMP-3.
  4235             20  CF-DEFAULT-SEX             PIC X.
  4236             20  CF-JOINT-AGE-INPUT         PIC X.
  4237                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4238             20  CF-BIRTH-DATE-INPUT        PIC X.
  4239                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4240             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4241                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4242                 88  CF-ZERO-CARRIER            VALUE '1'.
  4243                 88  CF-ZERO-GROUPING           VALUE '2'.
  4244                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4245             20  CF-EDIT-SW                 PIC X.
  4246                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4247             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4248             20  CF-CR-PR-METHOD            PIC X.
  4249               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4250               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4251             20  FILLER                     PIC X.
  4252
  4253         16  CF-CREDIT-MISC-CONTROLS.
  4254             20  CF-REIN-TABLE-SW           PIC X.
  4255                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4256             20  CF-COMP-TABLE-SW           PIC X.
  4257                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4258             20  CF-EXPERIENCE-RETENTION-AGE
  4259                                            PIC S9        COMP-3.
  4260             20  CF-CONVERSION-DT           PIC XX.
  4261             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4262             20  CF-RUN-FREQUENCY-SW        PIC X.
  4263                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  84
* EL156.cbl
  4264                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4265
  4266             20  CF-CR-CHECK-NO-CONTROL.
  4267                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4268                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4269                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4270                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4271                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4272                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4273
  4274                 24  CF-CR-CHECK-COUNT       REDEFINES
  4275                     CF-CR-CHECK-COUNTER      PIC X(4).
  4276
  4277                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4278                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4279
  4280                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4281                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4282                 24  CF-MAIL-PROCESSING       PIC X.
  4283                     88  MAIL-PROCESSING          VALUE 'Y'.
  4284
  4285         16  CF-MISC-SYSTEM-CONTROL.
  4286             20  CF-SYSTEM-C                 PIC X.
  4287                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4288             20  CF-SYSTEM-D                 PIC X.
  4289                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4290             20  CF-SOC-SEC-NO-SW            PIC X.
  4291                 88  SOC-SEC-NO-USED             VALUE '1'.
  4292             20  CF-MEMBER-NO-SW             PIC X.
  4293                 88  MEMBER-NO-USED              VALUE '1'.
  4294             20  CF-TAX-ID-NUMBER            PIC X(11).
  4295             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4296             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4297                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4298                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4299                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4300                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4301             20  CF-SYSTEM-E                 PIC X.
  4302                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4303
  4304         16  CF-LGX-LIFE-USER               PIC X.
  4305             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4306             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4307
  4308         16  CF-CR-MONTH-END-DT             PIC XX.
  4309
  4310         16  CF-FILE-MAINT-DATES.
  4311             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4312                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4313             20  CF-LAST-BATCH       REDEFINES
  4314                 CF-LAST-BATCH-NO               PIC X(4).
  4315             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4316             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4317             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4318             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4319             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4320             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4321             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  85
* EL156.cbl
  4322             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4323             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4324             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4325
  4326         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4327         16  FILLER                         PIC X.
  4328
  4329         16  CF-ALT-MORT-CODE               PIC X(4).
  4330         16  CF-MEMBER-CAPTION              PIC X(10).
  4331
  4332         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4333             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4334             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4335             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4336             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4337             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4338
  4339         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4340
  4341         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4342         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4343         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4344         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4345
  4346         16  CF-AH-OVERRIDE-L1              PIC X.
  4347         16  CF-AH-OVERRIDE-L2              PIC XX.
  4348         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4349         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4350
  4351         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4352         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4353
  4354         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4355         16  CF-AR-LAST-EL860-DT            PIC XX.
  4356         16  CF-MP-MONTH-END-DT             PIC XX.
  4357
  4358         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4359         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4360             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4361
  4362         16  CF-AR-MONTH-END-DT             PIC XX.
  4363
  4364         16  CF-CRDTCRD-USER                PIC X.
  4365             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4366             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4367
  4368         16  CF-CC-MONTH-END-DT             PIC XX.
  4369
  4370         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4371
  4372         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4373             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4374             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4375             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4376         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4377         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4378         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4379         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  86
* EL156.cbl
  4380             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4381             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4382         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4383         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4384         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4385             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4386         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4387
  4388         16  CF-CL-ZIP-CODE.
  4389             20  CF-CL-ZIP-PRIME.
  4390                 24  CF-CL-ZIP-1ST          PIC X.
  4391                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4392                 24  FILLER                 PIC X(4).
  4393             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4394         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4395             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4396             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4397             20  FILLER                     PIC XXX.
  4398
  4399         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4400         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4401         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4402         16  CF-CO-OPTION-START-DATE        PIC XX.
  4403         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4404           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4405                                                      '3' '4'.
  4406           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4407           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4408           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4409           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4410           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4411           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4412
  4413         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4414
  4415         16  CF-PAYMENT-APPROVAL-LEVELS.
  4416             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4417             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4418             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4419             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4420             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4421             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4422
  4423         16  CF-END-USER-REPORTING-USER     PIC X.
  4424             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4425             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4426
  4427         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4428             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4429             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4430
  4431         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4432
  4433         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4434         16  FILLER                         PIC X.
  4435
  4436         16  CF-CREDIT-ARCHIVE-CNTL.
  4437             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  87
* EL156.cbl
  4438             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4439             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4440
  4441         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4442
  4443         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4444             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4445             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4446
  4447         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4448             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4449             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4450
  4451         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4452
  4453         16  CF-CO-ACH-ID-CODE              PIC  X.
  4454             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4455             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4456             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4457         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4458         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4459         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4460         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4461         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4462         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4463         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4464         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4465         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4466                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4467         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4468                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4469
  4470         16  CF-CO-OVER-SHORT.
  4471             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4472             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4473
  4474*         16  FILLER                         PIC X(102).
  4475         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4476             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4477             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4478
  4479         16  CF-AH-APPROVAL-DAYS.
  4480             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4481             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4482             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4483             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4484
  4485         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4486
  4487         16  CF-APPROV-LEV-5.
  4488             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4489             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4490             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4491
  4492         16  FILLER                         PIC X(68).
  4493****************************************************************
  4494*             PROCESSOR/USER RECORD                            *
  4495****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  88
* EL156.cbl
  4496
  4497     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4498         16  CF-PROCESSOR-NAME              PIC X(30).
  4499         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4500         16  CF-PROCESSOR-TITLE             PIC X(26).
  4501         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4502                 88  MESSAGE-YES                VALUE 'Y'.
  4503                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4504
  4505*****************************************************
  4506****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4507****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4508****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4509****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4510*****************************************************
  4511
  4512         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4513             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4514             20  CF-APPLICATION-FORCE       PIC X.
  4515             20  CF-INDIVIDUAL-APP.
  4516                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4517                     28  CF-BROWSE-APP      PIC X.
  4518                     28  CF-UPDATE-APP      PIC X.
  4519
  4520         16  CF-CURRENT-TERM-ON             PIC X(4).
  4521         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4522             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4523             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4524             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4525             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4526             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4527             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4528             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4529         16  CF-PROCESSOR-CARRIER           PIC X.
  4530             88  NO-CARRIER-SECURITY            VALUE ' '.
  4531         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4532             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4533         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4534             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4535         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4536             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4537
  4538         16  CF-PROC-SYS-ACCESS-SW.
  4539             20  CF-PROC-CREDIT-CLAIMS-SW.
  4540                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4541                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4542                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4543                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4544             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4545                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4546                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4547             20  CF-PROC-LIFE-GNRLDGR-SW.
  4548                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4549                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4550                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4551                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4552             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4553                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  89
* EL156.cbl
  4554                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4555         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4556             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4557             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4558         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4559
  4560         16  CF-APPROVAL-LEVEL                  PIC X.
  4561             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4562             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4563             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4564             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4565             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4566
  4567         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4568
  4569         16  CF-LANGUAGE-TYPE                   PIC X.
  4570             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4571             88  CF-LANG-IS-FR                      VALUE 'F'.
  4572
  4573         16  CF-CSR-IND                         PIC X.
  4574         16  FILLER                             PIC X(239).
  4575
  4576****************************************************************
  4577*             PROCESSOR/REMINDERS RECORD                       *
  4578****************************************************************
  4579
  4580     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4581         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4582             20  CF-START-REMIND-DT         PIC XX.
  4583             20  CF-END-REMIND-DT           PIC XX.
  4584             20  CF-REMINDER-TEXT           PIC X(50).
  4585         16  FILLER                         PIC X(296).
  4586
  4587
  4588****************************************************************
  4589*             STATE MASTER RECORD                              *
  4590****************************************************************
  4591
  4592     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4593         16  CF-STATE-ABBREVIATION          PIC XX.
  4594         16  CF-STATE-NAME                  PIC X(25).
  4595         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4596         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4597             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4598             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4599             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4600             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4601                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4602                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4603             20  CF-ST-PREM-REJECT-SW       PIC X.
  4604                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4605                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4606             20  CF-ST-REF-REJECT-SW        PIC X.
  4607                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4608                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4609         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4610         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4611         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  90
* EL156.cbl
  4612             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4613             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4614             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4615         16  CF-ST-FST-PMT-EXTENSION.
  4616             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4617             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4618                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4619                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4620                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4621                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4622         16  CF-ST-STATE-CALL.
  4623             20  CF-ST-CALL-UNEARNED        PIC X.
  4624             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4625             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4626         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4627             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4628             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4629         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4630         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4631         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4632         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4633         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4634         16  FILLER                         PIC X.
  4635         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4636             20  CF-ST-BENEFIT-CD           PIC XX.
  4637             20  CF-ST-BENEFIT-KIND         PIC X.
  4638                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4639                 88  CF-ST-AH-KIND              VALUE 'A'.
  4640             20  CF-ST-REM-TERM-CALC        PIC X.
  4641                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4642                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4643                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4644                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4645                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4646                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4647                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4648                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4649
  4650             20  CF-ST-REFUND-CALC          PIC X.
  4651                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4652                 88  ST-REFD-BY-R78             VALUE '1'.
  4653                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4654                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4655                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4656                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4657                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4658                 88  ST-REFD-UTAH               VALUE '7'.
  4659                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4660                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4661                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4662
  4663             20  CF-ST-EARNING-CALC         PIC X.
  4664                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4665                 88  ST-EARN-BY-R78             VALUE '1'.
  4666                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4667                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4668                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4669                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  91
* EL156.cbl
  4670                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4671                 88  ST-EARN-MEAN               VALUE '8'.
  4672                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4673
  4674             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4675                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4676                 88  ST-OVRD-BY-R78             VALUE '1'.
  4677                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4678                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4679                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4680                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4681                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4682                 88  ST-OVRD-MEAN               VALUE '8'.
  4683                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4684             20  FILLER                     PIC X.
  4685
  4686         16  CF-ST-COMMISSION-CAPS.
  4687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4693
  4694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4695
  4696         16  CF-ST-STATUTORY-INTEREST.
  4697             20  CF-ST-STAT-DATE-FROM       PIC X.
  4698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4705
  4706         16  CF-ST-OVER-SHORT.
  4707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4709
  4710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4711
  4712         16  CF-ST-RT-CALC                  PIC X.
  4713
  4714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4717         16  CF-ST-RF-LR-CALC               PIC X.
  4718         16  CF-ST-RF-LL-CALC               PIC X.
  4719         16  CF-ST-RF-LN-CALC               PIC X.
  4720         16  CF-ST-RF-AH-CALC               PIC X.
  4721         16  CF-ST-RF-CP-CALC               PIC X.
  4722*        16  FILLER                         PIC X(206).
  4723*CIDMOD         16  FILLER                         PIC X(192).
  4724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4727         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  92
* EL156.cbl
  4728         16  CF-ST-CAUSAL-STATE             PIC X.
  4729         16  FILLER                         PIC X(185).
  4730
  4731****************************************************************
  4732*             BENEFIT MASTER RECORD                            *
  4733****************************************************************
  4734
  4735     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4736         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4737             20  CF-BENEFIT-CODE            PIC XX.
  4738             20  CF-BENEFIT-NUMERIC  REDEFINES
  4739                 CF-BENEFIT-CODE            PIC XX.
  4740             20  CF-BENEFIT-ALPHA           PIC XXX.
  4741             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4742             20  CF-BENEFIT-COMMENT         PIC X(10).
  4743
  4744             20  CF-LF-COVERAGE-TYPE        PIC X.
  4745                 88  CF-REDUCING                VALUE 'R'.
  4746                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4747
  4748             20  CF-SPECIAL-CALC-CD         PIC X.
  4749                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4750                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4751                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4752                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4753                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4754                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4755                 88  CF-FARM-PLAN               VALUE 'F'.
  4756                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4757                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4758                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4759                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4760                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4761                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4762                 88  CF-PRUDENTIAL              VALUE 'P'.
  4763                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4764                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4765                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4766                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4767                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4768                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4769
  4770             20  CF-JOINT-INDICATOR         PIC X.
  4771                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4772
  4773*            20  FILLER                     PIC X(12).
  4774             20  FILLER                     PIC X(11).
  4775             20  CF-BENEFIT-CATEGORY        PIC X.
  4776             20  CF-LOAN-TYPE               PIC X(8).
  4777
  4778             20  CF-CO-REM-TERM-CALC        PIC X.
  4779                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4780                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4781                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4782                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4783                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4784
  4785             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  93
* EL156.cbl
  4786                 88  CO-EARN-BY-R78             VALUE '1'.
  4787                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4788                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4789                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4790                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4791                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4792                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4793                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4794
  4795             20  CF-CO-REFUND-CALC          PIC X.
  4796                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4797                 88  CO-REFD-BY-R78             VALUE '1'.
  4798                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4799                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4800                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4801                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4802                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4803                 88  CO-REFD-MEAN               VALUE '8'.
  4804                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4805                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4806                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4807
  4808             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4809                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4810                 88  CO-OVRD-BY-R78             VALUE '1'.
  4811                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4812                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4813                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4814                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4815                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4816                 88  CO-OVRD-MEAN               VALUE '8'.
  4817                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4818
  4819             20  CF-CO-BEN-I-G-CD           PIC X.
  4820                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4821                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4822                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4823
  4824         16  FILLER                         PIC X(304).
  4825
  4826
  4827****************************************************************
  4828*             CARRIER MASTER RECORD                            *
  4829****************************************************************
  4830
  4831     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4832         16  CF-ADDRESS-DATA.
  4833             20  CF-MAIL-TO-NAME            PIC X(30).
  4834             20  CF-IN-CARE-OF              PIC X(30).
  4835             20  CF-ADDRESS-LINE-1          PIC X(30).
  4836             20  CF-ADDRESS-LINE-2          PIC X(30).
  4837             20  CF-CITY-STATE              PIC X(30).
  4838             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4839             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4840
  4841         16  CF-CLAIM-NO-CONTROL.
  4842             20  CF-CLAIM-NO-METHOD         PIC X.
  4843                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  94
* EL156.cbl
  4844                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4845                 88  CLAIM-NO-SEQ               VALUE '3'.
  4846                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4847             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4848                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4849                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4850                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4851
  4852         16  CF-CHECK-NO-CONTROL.
  4853             20  CF-CHECK-NO-METHOD         PIC X.
  4854                 88  CHECK-NO-MANUAL            VALUE '1'.
  4855                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4856                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4857                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4858             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4859                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4860
  4861         16  CF-DOMICILE-STATE              PIC XX.
  4862
  4863         16  CF-EXPENSE-CONTROLS.
  4864             20  CF-EXPENSE-METHOD          PIC X.
  4865                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4866                 88  DOLLARS-PER-PMT            VALUE '2'.
  4867                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4868                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4869             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4870             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4871
  4872         16  CF-CORRESPONDENCE-CONTROL.
  4873             20  CF-LETTER-RESEND-OPT       PIC X.
  4874                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4875                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4876             20  FILLER                     PIC X(4).
  4877
  4878         16  CF-RESERVE-CONTROLS.
  4879             20  CF-MANUAL-SW               PIC X.
  4880                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4881             20  CF-FUTURE-SW               PIC X.
  4882                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4883             20  CF-PTC-SW                  PIC X.
  4884                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4885             20  CF-IBNR-SW                 PIC X.
  4886                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4887             20  CF-PTC-LF-SW               PIC X.
  4888                 88  CF-LF-PTC-USED             VALUE '1'.
  4889             20  CF-CDT-ACCESS-METHOD       PIC X.
  4890                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4891                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4892                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4893             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4894
  4895         16  CF-CLAIM-CALC-METHOD           PIC X.
  4896             88  360-PLUS-MONTHS                VALUE '1'.
  4897             88  365-PLUS-MONTHS                VALUE '2'.
  4898             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4899             88  360-DAILY                      VALUE '4'.
  4900             88  365-DAILY                      VALUE '5'.
  4901
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  95
* EL156.cbl
  4902         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4903         16  FILLER                         PIC X(11).
  4904
  4905         16  CF-LIMIT-AMOUNTS.
  4906             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4907             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4908             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4909             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4910             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4911             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4912             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4913             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4914             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4915             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4916
  4917         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4918         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4919         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4920
  4921         16  CF-ZIP-CODE.
  4922             20  CF-ZIP-PRIME.
  4923                 24  CF-ZIP-1ST             PIC X.
  4924                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4925                 24  FILLER                 PIC X(4).
  4926             20  CF-ZIP-PLUS4               PIC X(4).
  4927         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4928             20  CF-CAN-POSTAL-1            PIC XXX.
  4929             20  CF-CAN-POSTAL-2            PIC XXX.
  4930             20  FILLER                     PIC XXX.
  4931
  4932         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4933         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4934         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4935
  4936         16  CF-RATING-SWITCH               PIC X.
  4937             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4938             88  CF-NO-RATING                   VALUE 'N'.
  4939
  4940         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4941
  4942         16  CF-CARRIER-OVER-SHORT.
  4943             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4944             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4945
  4946         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4947         16  CF-SECPAY-SWITCH               PIC X.
  4948             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4949             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4950         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4951         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4952         16  FILLER                         PIC X(444).
  4953*        16  FILLER                         PIC X(452).
  4954
  4955
  4956****************************************************************
  4957*             MORTALITY MASTER RECORD                          *
  4958****************************************************************
  4959
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  96
* EL156.cbl
  4960     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4961         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4962                                INDEXED BY CF-MORT-NDX.
  4963             20  CF-MORT-TABLE              PIC X(5).
  4964             20  CF-MORT-TABLE-TYPE         PIC X.
  4965                 88  CF-MORT-JOINT              VALUE 'J'.
  4966                 88  CF-MORT-SINGLE             VALUE 'S'.
  4967                 88  CF-MORT-COMBINED           VALUE 'C'.
  4968                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4969                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4970             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4971             20  CF-MORT-AGE-METHOD         PIC XX.
  4972                 88  CF-AGE-LAST                VALUE 'AL'.
  4973                 88  CF-AGE-NEAR                VALUE 'AN'.
  4974             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4975             20  CF-MORT-ADJUSTMENT-DIRECTION
  4976                                            PIC X.
  4977                 88  CF-MINUS                   VALUE '-'.
  4978                 88  CF-PLUS                    VALUE '+'.
  4979             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4980             20  CF-MORT-JOINT-CODE         PIC X.
  4981                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4982             20  CF-MORT-PC-Q               PIC X.
  4983                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4984             20  CF-MORT-TABLE-CODE         PIC X(4).
  4985             20  CF-MORT-COMMENTS           PIC X(15).
  4986             20  FILLER                     PIC X(14).
  4987
  4988         16  FILLER                         PIC X(251).
  4989
  4990
  4991****************************************************************
  4992*             BUSSINESS TYPE MASTER RECORD                     *
  4993****************************************************************
  4994
  4995     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4996* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4997* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4998* AND RECORD 05 IS TYPES 81-99
  4999         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5000             20  CF-BUSINESS-TITLE          PIC  X(19).
  5001             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5002                                            PIC S9V9(4) COMP-3.
  5003             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5004             20  FILLER                     PIC  X.
  5005         16  FILLER                         PIC  X(248).
  5006
  5007
  5008****************************************************************
  5009*             TERMINAL MASTER RECORD                           *
  5010****************************************************************
  5011
  5012     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5013
  5014         16  CF-COMPANY-TERMINALS.
  5015             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5016                                  PIC X(4).
  5017         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  97
* EL156.cbl
  5018
  5019
  5020****************************************************************
  5021*             LIFE EDIT MASTER RECORD                          *
  5022****************************************************************
  5023
  5024     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5025         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5026             20  CF-LIFE-CODE-IN            PIC XX.
  5027             20  CF-LIFE-CODE-OUT           PIC XX.
  5028         16  FILLER                         PIC X(248).
  5029
  5030
  5031****************************************************************
  5032*             AH EDIT MASTER RECORD                            *
  5033****************************************************************
  5034
  5035     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5036         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5037             20  CF-AH-CODE-IN              PIC XXX.
  5038             20  CF-AH-CODE-OUT             PIC XX.
  5039         16  FILLER                         PIC X(248).
  5040
  5041
  5042****************************************************************
  5043*             CREDIBILITY TABLES                               *
  5044****************************************************************
  5045
  5046     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5047         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5048                             INDEXED BY CF-CRDB-NDX.
  5049             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5050             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5051             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5052         16  FILLER                         PIC  X(332).
  5053
  5054
  5055****************************************************************
  5056*             REPORT CUSTOMIZATION RECORD                      *
  5057****************************************************************
  5058
  5059     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5060         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5061             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5062             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5063             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5064**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5065****       A T-TRANSFER.                                   ****
  5066             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5067
  5068         16  FILLER                         PIC XX.
  5069
  5070         16  CF-CARRIER-CNTL-OPT.
  5071             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5072                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5073                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5074             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5075                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  98
* EL156.cbl
  5076         16  CF-GROUP-CNTL-OPT.
  5077             20  CF-GROUP-OPT-SEQ           PIC 9.
  5078                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5079                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5080             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5081                                            PIC X(6).
  5082         16  CF-STATE-CNTL-OPT.
  5083             20  CF-STATE-OPT-SEQ           PIC 9.
  5084                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5085                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5086             20  CF-STATE-SELECT OCCURS 3 TIMES
  5087                                            PIC XX.
  5088         16  CF-ACCOUNT-CNTL-OPT.
  5089             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5090                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5091                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5092             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5093                                            PIC X(10).
  5094         16  CF-BUS-TYP-CNTL-OPT.
  5095             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5096                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5097                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5098             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5099                                            PIC XX.
  5100         16  CF-LF-TYP-CNTL-OPT.
  5101             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5102                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5103                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5104             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5105                                            PIC XX.
  5106         16  CF-AH-TYP-CNTL-OPT.
  5107             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5108                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5109                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5110             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5111                                            PIC XX.
  5112         16  CF-REPTCD1-CNTL-OPT.
  5113             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5114                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5115                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5116             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5117                                            PIC X(10).
  5118         16  CF-REPTCD2-CNTL-OPT.
  5119             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5120                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5121                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5122             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5123                                            PIC X(10).
  5124         16  CF-USER1-CNTL-OPT.
  5125             20  CF-USER1-OPT-SEQ           PIC 9.
  5126                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5127                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5128             20  CF-USER1-SELECT OCCURS 3 TIMES
  5129                                            PIC X(10).
  5130         16  CF-USER2-CNTL-OPT.
  5131             20  CF-USER2-OPT-SEQ           PIC 9.
  5132                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5133                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page  99
* EL156.cbl
  5134             20  CF-USER2-SELECT OCCURS 3 TIMES
  5135                                            PIC X(10).
  5136         16  CF-USER3-CNTL-OPT.
  5137             20  CF-USER3-OPT-SEQ           PIC 9.
  5138                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5139                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5140             20  CF-USER3-SELECT OCCURS 3 TIMES
  5141                                            PIC X(10).
  5142         16  CF-USER4-CNTL-OPT.
  5143             20  CF-USER4-OPT-SEQ           PIC 9.
  5144                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5145                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5146             20  CF-USER4-SELECT OCCURS 3 TIMES
  5147                                            PIC X(10).
  5148         16  CF-USER5-CNTL-OPT.
  5149             20  CF-USER5-OPT-SEQ           PIC 9.
  5150                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5151                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5152             20  CF-USER5-SELECT OCCURS 3 TIMES
  5153                                            PIC X(10).
  5154         16  CF-REINS-CNTL-OPT.
  5155             20  CF-REINS-OPT-SEQ           PIC 9.
  5156                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5157                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5158             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5159                 24  CF-REINS-PRIME         PIC XXX.
  5160                 24  CF-REINS-SUB           PIC XXX.
  5161
  5162         16  CF-AGENT-CNTL-OPT.
  5163             20  CF-AGENT-OPT-SEQ           PIC 9.
  5164                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5165                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5166             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5167                                            PIC X(10).
  5168
  5169         16  FILLER                         PIC X(43).
  5170
  5171         16  CF-LOSS-RATIO-SELECT.
  5172             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5173             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5174         16  CF-ENTRY-DATE-SELECT.
  5175             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5176             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5177         16  CF-EFFECTIVE-DATE-SELECT.
  5178             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5179             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5180
  5181         16  CF-EXCEPTION-LIST-IND          PIC X.
  5182             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5183
  5184         16  FILLER                         PIC X(318).
  5185
  5186****************************************************************
  5187*                  EXCEPTION REPORTING RECORD                  *
  5188****************************************************************
  5189
  5190     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5191         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 100
* EL156.cbl
  5192             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5193
  5194         16  CF-COMBINED-LIFE-AH-OPT.
  5195             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5196             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5197             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5198             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5199
  5200         16  CF-LIFE-OPT.
  5201             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5202             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5203             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5204             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5205             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5206             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5207             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5208             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5209             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5210             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5211
  5212         16  CF-AH-OPT.
  5213             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5214             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5215             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5216             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5217             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5218             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5219             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5220             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5221             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5222             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5223
  5224         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5225             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5226             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5227             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5228
  5229         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5230
  5231         16  FILLER                         PIC X(673).
  5232
  5233
  5234****************************************************************
  5235*             MORTGAGE SYSTEM PLAN RECORD                      *
  5236****************************************************************
  5237
  5238     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5239         16  CF-PLAN-TYPE                   PIC X.
  5240             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5241             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5242             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5243         16  CF-PLAN-ABBREV                 PIC XXX.
  5244         16  CF-PLAN-DESCRIPT               PIC X(10).
  5245         16  CF-PLAN-NOTES                  PIC X(20).
  5246         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5247         16  CF-PLAN-UNDERWRITING.
  5248             20  CF-PLAN-TERM-DATA.
  5249                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 101
* EL156.cbl
  5250                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5251             20  CF-PLAN-AGE-DATA.
  5252                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5253                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5254                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5255             20  CF-PLAN-BENEFIT-DATA.
  5256                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5257                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5258                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5259                                            PIC S9(7)V99  COMP-3.
  5260         16  CF-PLAN-POLICY-FORMS.
  5261             20  CF-POLICY-FORM             PIC X(12).
  5262             20  CF-MASTER-APPLICATION      PIC X(12).
  5263             20  CF-MASTER-POLICY           PIC X(12).
  5264         16  CF-PLAN-RATING.
  5265             20  CF-RATE-CODE               PIC X(5).
  5266             20  CF-SEX-RATING              PIC X.
  5267                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5268                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5269             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5270             20  CF-SUB-STD-TYPE            PIC X.
  5271                 88  CF-PCT-OF-PREM            VALUE '1'.
  5272                 88  CF-PCT-OF-BENE            VALUE '2'.
  5273         16  CF-PLAN-PREM-TOLERANCES.
  5274             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5275             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5276         16  CF-PLAN-PYMT-TOLERANCES.
  5277             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5278             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5279         16  CF-PLAN-MISC-DATA.
  5280             20  FILLER                     PIC X.
  5281             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5282             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5283         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5284         16  CF-PLAN-IND-GRP                PIC X.
  5285             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5286                                                     '1'.
  5287             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5288                                                     '2'.
  5289         16  CF-MIB-SEARCH-SW               PIC X.
  5290             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5291             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5292             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5293             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5294         16  CF-ALPHA-SEARCH-SW             PIC X.
  5295             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5296             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5297             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5298             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5299             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5300             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5301             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5302             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5303             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5304             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5305                                                     'A' 'B' 'C'
  5306                                                     'X' 'Y' 'Z'.
  5307         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 102
* EL156.cbl
  5308             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5309             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5310             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5311             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5312             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5313         16  FILLER                         PIC X(4).
  5314         16  CF-HEALTH-QUESTIONS            PIC X.
  5315             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5316         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5317         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5318         16  CF-PLAN-SNGL-JNT               PIC X.
  5319             88  CF-COMBINED-PLAN              VALUE 'C'.
  5320             88  CF-JNT-PLAN                   VALUE 'J'.
  5321             88  CF-SNGL-PLAN                  VALUE 'S'.
  5322         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5323         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5324         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5325         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5326         16  CF-RERATE-CNTL                 PIC  X.
  5327             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5328             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5329             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5330             88  CF-AUTO-RECALC                 VALUE '4'.
  5331         16  CF-BENEFIT-TYPE                PIC  X.
  5332             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5333             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5334         16  CF-POLICY-FEE                  PIC S999V99
  5335                                                    COMP-3.
  5336         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5337         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5338         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5339         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5340         16  FILLER                         PIC  X(32).
  5341         16  CF-TERMINATION-FORM            PIC  X(04).
  5342         16  FILLER                         PIC  X(08).
  5343         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5344                                                       COMP-3.
  5345         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5346         16  CF-ISSUE-LETTER                PIC  X(4).
  5347         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5348         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5349             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5350             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5351         16  CF-MP-REFUND-CALC              PIC X.
  5352             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5353             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5354             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5355             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5356             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5357             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5358             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5359             88  CF-MP-REFD-MEAN                VALUE '8'.
  5360         16  CF-ALT-RATE-CODE               PIC  X(5).
  5361
  5362
  5363         16  FILLER                         PIC X(498).
  5364****************************************************************
  5365*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 103
* EL156.cbl
  5366****************************************************************
  5367
  5368     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5369         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5370         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5371             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5372             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5373             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5374             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5375             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5376
  5377         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5378         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5379         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5380         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5381         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5382
  5383         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5384             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5385         16  CF-MP-RECON-USE-IND            PIC X(1).
  5386             88  CF-MP-USE-RECON             VALUE 'Y'.
  5387         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5388             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5389         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5390             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5391             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5392         16  FILLER                         PIC X(1).
  5393         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5394             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5395         16  CF-MORTG-MIB-VERSION           PIC X.
  5396             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5397             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5398             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5399         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5400             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5401                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5402             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5403                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5404             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5405                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5406             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5407                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5408             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5409                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5410             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5411                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5412         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5413         16  FILLER                         PIC X(7).
  5414         16  CF-MORTG-DESTINATION-SYMBOL.
  5415             20  CF-MORTG-MIB-COMM          PIC X(5).
  5416             20  CF-MORTG-MIB-TERM          PIC X(5).
  5417         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5418             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5419         16  FILLER                         PIC X(03).
  5420         16  CF-MP-CHECK-NO-CONTROL.
  5421             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5422                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5423                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 104
* EL156.cbl
  5424                                                ' ' LOW-VALUES.
  5425                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5426                                               VALUE '3'.
  5427         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5428         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5429         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5430             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5431                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5432             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5433                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5434             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5435                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5436             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5437                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5438             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5439                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5440             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5441                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5442         16  CF-MORTG-BILLING-AREA.
  5443             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5444                                            PIC X.
  5445         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5446         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5447         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5448         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5449             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5450             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5451         16  FILLER                         PIC X.
  5452         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5453             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5454             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5455         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5456         16  FILLER                         PIC X(8).
  5457         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5458         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5459         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5460         16  CF-ACH-COMPANY-ID.
  5461             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5462                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5463                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5464                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5465             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5466         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5467             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5468         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5469             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5470             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5471         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5472         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5473         16  FILLER                         PIC X(536).
  5474
  5475****************************************************************
  5476*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5477****************************************************************
  5478
  5479     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5480         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5481             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 105
* EL156.cbl
  5482                 24  CF-FEMALE-FT           PIC 99.
  5483                 24  CF-FEMALE-IN           PIC 99.
  5484             20  CF-FEMALE-MIN-WT           PIC 999.
  5485             20  CF-FEMALE-MAX-WT           PIC 999.
  5486         16  FILLER                         PIC X(428).
  5487
  5488     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5489         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5490             20  CF-MALE-HEIGHT.
  5491                 24  CF-MALE-FT             PIC 99.
  5492                 24  CF-MALE-IN             PIC 99.
  5493             20  CF-MALE-MIN-WT             PIC 999.
  5494             20  CF-MALE-MAX-WT             PIC 999.
  5495         16  FILLER                         PIC X(428).
  5496******************************************************************
  5497*             AUTOMATIC ACTIVITY RECORD                          *
  5498******************************************************************
  5499     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5500         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5501             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5502             20  CF-SYS-LETTER-ID           PIC X(04).
  5503             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5504             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5505             20  CF-SYS-RESET-SW            PIC X(01).
  5506             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5507             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5508
  5509         16  FILLER                         PIC X(50).
  5510
  5511         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5512             20  CF-USER-ACTIVE-SW          PIC X(01).
  5513             20  CF-USER-LETTER-ID          PIC X(04).
  5514             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5515             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5516             20  CF-USER-RESET-SW           PIC X(01).
  5517             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5518             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5519             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5520
  5521         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 106
* EL156.cbl
  5523*    COPY ELCCERT.
  5524******************************************************************
  5525*                                                                *
  5526*                            ELCCERT.                            *
  5527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5528*                            VMOD=2.013                          *
  5529*                                                                *
  5530*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5531*                                                                *
  5532*   FILE TYPE = VSAM,KSDS                                        *
  5533*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5534*                                                                *
  5535*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5536*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5537*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5538*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5539*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5540*                                                                *
  5541*   LOG = YES                                                    *
  5542*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5543******************************************************************
  5544*                   C H A N G E   L O G
  5545*
  5546* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5547*-----------------------------------------------------------------
  5548*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5549* EFFECTIVE    NUMBER
  5550*-----------------------------------------------------------------
  5551* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5552* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5553* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5554* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5555* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5556* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5557* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5558* 032612  CR2011110200001  PEMA  AHL CHANGES
  5559******************************************************************
  5560
  5561 01  CERTIFICATE-MASTER.
  5562     12  CM-RECORD-ID                      PIC XX.
  5563         88  VALID-CM-ID                      VALUE 'CM'.
  5564
  5565     12  CM-CONTROL-PRIMARY.
  5566         16  CM-COMPANY-CD                 PIC X.
  5567         16  CM-CARRIER                    PIC X.
  5568         16  CM-GROUPING.
  5569             20  CM-GROUPING-PREFIX        PIC X(3).
  5570             20  CM-GROUPING-PRIME         PIC X(3).
  5571         16  CM-STATE                      PIC XX.
  5572         16  CM-ACCOUNT.
  5573             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5574             20  CM-ACCOUNT-PRIME          PIC X(6).
  5575         16  CM-CERT-EFF-DT                PIC XX.
  5576         16  CM-CERT-NO.
  5577             20  CM-CERT-PRIME             PIC X(10).
  5578             20  CM-CERT-SFX               PIC X.
  5579
  5580     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 107
* EL156.cbl
  5581         16  CM-COMPANY-CD-A1              PIC X.
  5582         16  CM-INSURED-LAST-NAME          PIC X(15).
  5583         16  CM-INSURED-INITIALS.
  5584             20  CM-INSURED-INITIAL1       PIC X.
  5585             20  CM-INSURED-INITIAL2       PIC X.
  5586
  5587     12  CM-CONTROL-BY-SSN.
  5588         16  CM-COMPANY-CD-A2              PIC X.
  5589         16  CM-SOC-SEC-NO.
  5590             20  CM-SSN-STATE              PIC XX.
  5591             20  CM-SSN-ACCOUNT            PIC X(6).
  5592             20  CM-SSN-LN3.
  5593                 25  CM-INSURED-INITIALS-A2.
  5594                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5595                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5596                 25 CM-PART-LAST-NAME-A2         PIC X.
  5597
  5598     12  CM-CONTROL-BY-CERT-NO.
  5599         16  CM-COMPANY-CD-A4              PIC X.
  5600         16  CM-CERT-NO-A4                 PIC X(11).
  5601
  5602     12  CM-CONTROL-BY-MEMB.
  5603         16  CM-COMPANY-CD-A5              PIC X.
  5604         16  CM-MEMBER-NO.
  5605             20  CM-MEMB-STATE             PIC XX.
  5606             20  CM-MEMB-ACCOUNT           PIC X(6).
  5607             20  CM-MEMB-LN4.
  5608                 25  CM-INSURED-INITIALS-A5.
  5609                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5610                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5611                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5612
  5613     12  CM-INSURED-PROFILE-DATA.
  5614         16  CM-INSURED-FIRST-NAME.
  5615             20  CM-INSURED-1ST-INIT       PIC X.
  5616             20  FILLER                    PIC X(9).
  5617         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5618         16  CM-INSURED-SEX                PIC X.
  5619             88  CM-SEX-MALE                  VALUE 'M'.
  5620             88  CM-SEX-FEMAL                 VALUE 'F'.
  5621         16  CM-INSURED-JOINT-AGE          PIC 99.
  5622         16  CM-JOINT-INSURED-NAME.
  5623             20  CM-JT-LAST-NAME           PIC X(15).
  5624             20  CM-JT-FIRST-NAME.
  5625                 24  CM-JT-1ST-INIT        PIC X.
  5626                 24  FILLER                PIC X(9).
  5627             20  CM-JT-INITIAL             PIC X.
  5628
  5629     12  CM-LIFE-DATA.
  5630         16  CM-LF-BENEFIT-CD              PIC XX.
  5631         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5632         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5633         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5634         16  CM-LF-DEV-CODE                PIC XXX.
  5635         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5636         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5637         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5638         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 108
* EL156.cbl
  5639         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5640         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5641         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5642         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5643         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5644         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5645         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5646         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5647         16  FILLER                        PIC XX.
  5648
  5649     12  CM-AH-DATA.
  5650         16  CM-AH-BENEFIT-CD              PIC XX.
  5651         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5652         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5653         16  CM-AH-DEV-CODE                PIC XXX.
  5654         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5655         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5656         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5657         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5658         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5659         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5660         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5661         16  CM-AH-PAID-THRU-DT            PIC XX.
  5662             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5663         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5664         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5665         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5666         16  FILLER                        PIC X.
  5667
  5668     12  CM-LOAN-INFORMATION.
  5669         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5670         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5671                                           PIC S9(5)V99  COMP-3.
  5672         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5673         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5674         16  CM-PAY-FREQUENCY              PIC S99.
  5675         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5676         16  CM-RATE-CLASS                 PIC XX.
  5677         16  CM-BENEFICIARY                PIC X(25).
  5678         16  CM-POLICY-FORM-NO             PIC X(12).
  5679         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5680         16  CM-LAST-ADD-ON-DT             PIC XX.
  5681         16  CM-DEDUCTIBLE-AMOUNTS.
  5682             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5683             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5684         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5685             20  CM-RESIDENT-STATE         PIC XX.
  5686             20  CM-RATE-CODE              PIC X(4).
  5687             20  FILLER                    PIC XX.
  5688         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5689             20  CM-LOAN-OFFICER           PIC X(5).
  5690             20  FILLER                    PIC XXX.
  5691         16  CM-CSR-CODE                   PIC XXX.
  5692         16  CM-UNDERWRITING-CODE          PIC X.
  5693             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5694         16  CM-POST-CARD-IND              PIC X.
  5695         16  CM-NH-INTERFACE-SW            PIC X.
  5696         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 109
* EL156.cbl
  5697             88  CM-SING-PRM                  VALUE '1'.
  5698             88  CM-O-B-COVERAGE              VALUE '2'.
  5699             88  CM-OPEN-END                  VALUE '3'.
  5700         16  CM-IND-GRP-TYPE               PIC X.
  5701             88  CM-INDIVIDUAL                VALUE 'I'.
  5702             88  CM-GROUP                     VALUE 'G'.
  5703         16  CM-SKIP-CODE                  PIC X.
  5704             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5705             88  SKIP-JULY                    VALUE '1'.
  5706             88  SKIP-AUGUST                  VALUE '2'.
  5707             88  SKIP-SEPTEMBER               VALUE '3'.
  5708             88  SKIP-JULY-AUG                VALUE '4'.
  5709             88  SKIP-AUG-SEPT                VALUE '5'.
  5710             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5711             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5712             88  SKIP-JUNE                    VALUE '8'.
  5713             88  SKIP-JUNE-JULY               VALUE '9'.
  5714             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5715             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5716         16  CM-PAYMENT-MODE               PIC X.
  5717             88  PAY-MONTHLY                  VALUE SPACE.
  5718             88  PAY-WEEKLY                   VALUE '1'.
  5719             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5720             88  PAY-BI-WEEKLY                VALUE '3'.
  5721             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5722         16  CM-LOAN-NUMBER                PIC X(8).
  5723         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5724         16  CM-OLD-LOF                    PIC XXX.
  5725*        16  CM-LOAN-OFFICER               PIC XXX.
  5726         16  CM-REIN-TABLE                 PIC XXX.
  5727         16  CM-SPECIAL-REIN-CODE          PIC X.
  5728         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5729         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5730         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5731
  5732     12  CM-STATUS-DATA.
  5733         16  CM-ENTRY-STATUS               PIC X.
  5734         16  CM-ENTRY-DT                   PIC XX.
  5735
  5736         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5737         16  CM-LF-CANCEL-DT               PIC XX.
  5738         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5739
  5740         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5741         16  CM-LF-DEATH-DT                PIC XX.
  5742         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5743
  5744         16  CM-LF-CURRENT-STATUS          PIC X.
  5745             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5746                                                'M' '4' '5' '9'.
  5747             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5748             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5749             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5750             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5751             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5752             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5753             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5754             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 110
* EL156.cbl
  5755             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5756             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5757             88  CM-LF-DECLINED               VALUE 'D'.
  5758             88  CM-LF-VOIDED                 VALUE 'V'.
  5759
  5760         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5761         16  CM-AH-CANCEL-DT               PIC XX.
  5762         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5763
  5764         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5765         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5766         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5767
  5768         16  CM-AH-CURRENT-STATUS          PIC X.
  5769             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5770                                                'M' '4' '5' '9'.
  5771             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5772             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5773             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5774             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5775             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5776             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5777             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5778             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5779             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5780             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5781             88  CM-AH-DECLINED               VALUE 'D'.
  5782             88  CM-AH-VOIDED                 VALUE 'V'.
  5783
  5784         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5785             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5786             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5787             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5788         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5789
  5790         16  CM-ENTRY-BATCH                PIC X(6).
  5791         16  CM-LF-EXIT-BATCH              PIC X(6).
  5792         16  CM-AH-EXIT-BATCH              PIC X(6).
  5793         16  CM-LAST-MONTH-END             PIC XX.
  5794
  5795     12  CM-NOTE-SW                        PIC X.
  5796         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5797         88  CERT-NOTES-PRESENT               VALUE '1'.
  5798         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5799         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5800         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5801         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5802         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5803         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5804     12  CM-COMP-EXCP-SW                   PIC X.
  5805         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5806         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5807     12  CM-INSURED-ADDRESS-SW             PIC X.
  5808         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5809         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5810
  5811*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5812     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 111
* EL156.cbl
  5813     12  FILLER                            PIC X.
  5814
  5815*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5816     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5817     12  FILLER                            PIC X.
  5818*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5819     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5820
  5821     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5822         88  CERT-ADDED-BATCH                 VALUE ' '.
  5823         88  CERT-ADDED-ONLINE                VALUE '1'.
  5824         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5825         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5826         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5827     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5828         88  CERT-AS-LOADED                   VALUE ' '.
  5829         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5830         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5831         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5832         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5833         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5834         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5835         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5836
  5837     12  CM-ACCOUNT-COMM-PCTS.
  5838         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5839         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5840
  5841     12  CM-USER-FIELD                     PIC X.
  5842     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5843     12  CM-CLP-STATE                      PIC XX.
  5844     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5845     12  CM-USER-RESERVED                  PIC XXX.
  5846     12  FILLER REDEFINES CM-USER-RESERVED.
  5847         16  CM-AH-CLASS-CD                PIC XX.
  5848         16  F                             PIC X.
  5849******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 112
* EL156.cbl
  5851*    COPY ELCTRLR.
  5852******************************************************************
  5853*                                                                *
  5854*                            ELCTRLR.                            *
  5855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5856*                            VMOD=2.014                          *
  5857*                                                                *
  5858*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5859*                                                                *
  5860*   FILE TYPE = VSAM,KSDS                                        *
  5861*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5862*                                                                *
  5863*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5864*       ALTERNATE INDEX = NONE                                   *
  5865*                                                                *
  5866*   LOG = YES                                                    *
  5867*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5868******************************************************************
  5869*                   C H A N G E   L O G
  5870*
  5871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5872*-----------------------------------------------------------------
  5873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5874* EFFECTIVE    NUMBER
  5875*-----------------------------------------------------------------
  5876* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5877* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5878* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5879* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5880* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5881* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5882* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5883* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5884* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5885* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5886* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5887* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5888* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5889* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5890* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5891* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5892* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5893******************************************************************
  5894 01  ACTIVITY-TRAILERS.
  5895     12  AT-RECORD-ID                    PIC XX.
  5896         88  VALID-AT-ID                       VALUE 'AT'.
  5897
  5898     12  AT-CONTROL-PRIMARY.
  5899         16  AT-COMPANY-CD               PIC X.
  5900         16  AT-CARRIER                  PIC X.
  5901         16  AT-CLAIM-NO                 PIC X(7).
  5902         16  AT-CERT-NO.
  5903             20  AT-CERT-PRIME           PIC X(10).
  5904             20  AT-CERT-SFX             PIC X.
  5905         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5906             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5907             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5908             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 113
* EL156.cbl
  5909             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5910             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5911             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5912             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5913             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5914             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5915             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5916             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5917             88  AT-BENEFICIARY-TRL           VALUE +91.
  5918             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5919             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5920             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5921             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5922
  5923     12  AT-TRAILER-TYPE                 PIC X.
  5924         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5925         88  PAYMENT-TR                       VALUE '2'.
  5926         88  AUTO-PAY-TR                      VALUE '3'.
  5927         88  CORRESPONDENCE-TR                VALUE '4'.
  5928         88  ADDRESS-TR                       VALUE '5'.
  5929         88  GENERAL-INFO-TR                  VALUE '6'.
  5930         88  AUTO-PROMPT-TR                   VALUE '7'.
  5931         88  DENIAL-TR                        VALUE '8'.
  5932         88  INCURRED-CHG-TR                  VALUE '9'.
  5933         88  FORM-CONTROL-TR                  VALUE 'A'.
  5934
  5935     12  AT-RECORDED-DT                  PIC XX.
  5936     12  AT-RECORDED-BY                  PIC X(4).
  5937     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5938
  5939     12  AT-TRAILER-BODY                 PIC X(165).
  5940
  5941     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5942         16  AT-RESERVE-CONTROLS.
  5943             20  AT-MANUAL-SW            PIC X.
  5944                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5945             20  AT-FUTURE-SW            PIC X.
  5946                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5947             20  AT-PTC-SW               PIC X.
  5948                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5949             20  AT-IBNR-SW              PIC X.
  5950                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5951             20  AT-PTC-LF-SW            PIC X.
  5952                 88  AT-LF-PTC-USED          VALUE '1'.
  5953             20  AT-CDT-ACCESS-METHOD    PIC X.
  5954                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5955                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5956                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5957             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5958         16  AT-LAST-COMPUTED-DT         PIC XX.
  5959         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5960         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5961         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5962         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5963         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5964         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5965         16  AT-EXPENSE-CONTROLS.
  5966             20  AT-EXPENSE-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 114
* EL156.cbl
  5967                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5968                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5969                 88  PERCENT-OF-PMT           VALUE '3'.
  5970                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5971             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5972             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5973         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5974         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5975
  5976         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5977         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5978
  5979*        16  FILLER                      PIC X(53).
  5980         16  FILLER                      PIC X(47).
  5981
  5982         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5983         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5984
  5985         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5986             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5987             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5988*                    C = CLOSED
  5989*                    O = OPEN
  5990             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5991*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5992
  5993     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5994         16  AT-PAYMENT-TYPE             PIC X.
  5995             88  PARTIAL-PAYMENT                VALUE '1'.
  5996             88  FINAL-PAYMENT                  VALUE '2'.
  5997             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5998             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5999             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6000             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6001             88  VOIDED-PAYMENT                 VALUE '9'.
  6002             88  TRANSFER                       VALUE 'T'.
  6003             88  LIFE-INTEREST                  VALUE 'I'.
  6004
  6005         16  AT-CLAIM-TYPE               PIC X.
  6006             88  PAID-FOR-AH                    VALUE 'A'.
  6007             88  PAID-FOR-LIFE                  VALUE 'L'.
  6008             88  PAID-FOR-IUI                   VALUE 'I'.
  6009             88  PAID-FOR-GAP                   VALUE 'G'.
  6010         16  AT-CLAIM-PREM-TYPE          PIC X.
  6011             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6012             88  AT-O-B-COVERAGE                VALUE '2'.
  6013             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6014         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6015         16  AT-CHECK-NO                 PIC X(7).
  6016         16  AT-PAID-FROM-DT             PIC XX.
  6017         16  AT-PAID-THRU-DT             PIC XX.
  6018         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6019         16  FILLER                      PIC X.
  6020         16  AT-PAYEES-NAME              PIC X(30).
  6021         16  AT-PAYMENT-ORIGIN           PIC X.
  6022             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6023             88  ONLINE-AUTO-PMT                VALUE '2'.
  6024             88  OFFLINE-PMT                    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 115
* EL156.cbl
  6025         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6026         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6027         16  AT-VOID-DATA.
  6028             20  AT-VOID-DT              PIC XX.
  6029*00144       20  AT-VOID-REASON          PIC X(30).
  6030             20  AT-VOID-REASON          PIC X(26).
  6031         16  AT-PMT-APPROVED-BY          PIC X(04).
  6032         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6033         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6034         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6035                                         PIC S99V9(5)  COMP-3.
  6036         16  AT-CREDIT-INTERFACE.
  6037             20  AT-PMT-SELECT-DT        PIC XX.
  6038                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6039             20  AT-PMT-ACCEPT-DT        PIC XX.
  6040                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6041             20  AT-VOID-SELECT-DT       PIC XX.
  6042                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6043             20  AT-VOID-ACCEPT-DT       PIC XX.
  6044                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6045
  6046         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6047                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6048                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6049         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6050
  6051         16  AT-FORCE-CONTROL            PIC X.
  6052             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6053         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6054         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6055         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6056         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6057         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6058         16  AT-BENEFIT-TYPE             PIC X.
  6059
  6060         16  AT-EXPENSE-TYPE             PIC X.
  6061         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6062
  6063         16  AT-PAYEE-TYPE-CD.
  6064             20  AT-PAYEE-TYPE           PIC X.
  6065                 88  INSURED-PAID           VALUE 'I'.
  6066                 88  BENEFICIARY-PAID       VALUE 'B'.
  6067                 88  ACCOUNT-PAID           VALUE 'A'.
  6068                 88  OTHER-1-PAID           VALUE 'O'.
  6069                 88  OTHER-2-PAID           VALUE 'Q'.
  6070                 88  DOCTOR-PAID            VALUE 'P'.
  6071                 88  EMPLOYER-PAID          VALUE 'E'.
  6072             20  AT-PAYEE-SEQ            PIC X.
  6073
  6074         16  AT-CASH-PAYMENT             PIC X.
  6075         16  AT-GROUPED-PAYMENT          PIC X.
  6076         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6077         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6078         16  AT-APPROVED-LEVEL           PIC X.
  6079         16  AT-VOID-TYPE                PIC X.
  6080             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6081             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6082         16  AT-AIG-UNEMP-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 116
* EL156.cbl
  6083             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6084         16  AT-ASSOCIATES               PIC X.
  6085             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6086             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6087
  6088         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6089         16  AT-CV-PMT-CODE              PIC X.
  6090             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6091             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6092             88  FULL-ADD-PAYMENT           VALUE '3'.
  6093             88  HALF-ADD-PAYMENT           VALUE '4'.
  6094             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6095             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6096             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6097             88  ADDL-PAYMENT               VALUE '8'.
  6098
  6099         16  AT-EOB-CODE1                PIC XXX.
  6100         16  AT-EOB-CODE2                PIC XXX.
  6101         16  AT-EOB-CODE3                PIC XXX.
  6102         16  FILLER REDEFINES AT-EOB-CODE3.
  6103             20  AT-PRINT-CLM-FORM       PIC X.
  6104             20  AT-PRINT-SURVEY         PIC X.
  6105             20  AT-SPECIAL-RELEASE      PIC X.
  6106         16  AT-EOB-CODE4                PIC XXX.
  6107         16  FILLER REDEFINES AT-EOB-CODE4.
  6108             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6109             20  FILLER                  PIC X.
  6110         16  AT-EOB-CODE5                PIC XXX.
  6111         16  FILLER REDEFINES AT-EOB-CODE5.
  6112             20  AT-PMT-PROOF-DT         PIC XX.
  6113             20  FILLER                  PIC X.
  6114
  6115         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6116             88  AT-PRINT-EOB            VALUE 'Y'.
  6117
  6118         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6119         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6120
  6121     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6122         16  AT-SCHEDULE-START-DT        PIC XX.
  6123         16  AT-SCHEDULE-END-DT          PIC XX.
  6124         16  AT-TERMINATED-DT            PIC XX.
  6125         16  AT-LAST-PMT-TYPE            PIC X.
  6126             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6127             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6128         16  AT-FIRST-PMT-DATA.
  6129             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6130             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6131             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6132         16  AT-REGULAR-PMT-DATA.
  6133             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6134             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6135             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6136         16  AT-AUTO-PAYEE-CD.
  6137             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6138                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6139                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6140                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 117
* EL156.cbl
  6141                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6142                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6143             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6144         16  AT-AUTO-PAY-DAY             PIC 99.
  6145         16  AT-AUTO-CASH                PIC X.
  6146             88  AT-CASH                      VALUE 'Y'.
  6147             88  AT-NON-CASH                  VALUE 'N'.
  6148*        16  FILLER                      PIC X(129).
  6149         16  AT-AUTO-END-LETTER          PIC X(4).
  6150         16  FILLER                      PIC X(125).
  6151
  6152         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6153         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6154
  6155     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6156         16  AT-LETTER-SENT-DT           PIC XX.
  6157         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6158         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6159         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6160         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6161         16  AT-LETTER-ORIGIN            PIC X.
  6162             88  ONLINE-CREATION              VALUE '1' '3'.
  6163             88  OFFLINE-CREATION             VALUE '2' '4'.
  6164             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6165             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6166         16  AT-STD-LETTER-FORM          PIC X(4).
  6167         16  AT-REASON-TEXT              PIC X(70).
  6168         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6169         16  AT-ADDRESEE-TYPE            PIC X.
  6170              88  INSURED-ADDRESEE            VALUE 'I'.
  6171              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6172              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6173              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6174              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6175              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6176              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6177         16  AT-ADDRESSEE-NAME           PIC X(30).
  6178         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6179         16  AT-RESEND-PRINT-DATE        PIC XX.
  6180         16  AT-CORR-SOL-UNSOL           PIC X.
  6181         16  AT-LETTER-PURGED-DT         PIC XX.
  6182*
  6183*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6184*
  6185         16  AT-CSO-REDEFINITION.
  6186             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6187             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6188             20  AT-LETTER-TO-BENE       PIC X(1).
  6189             20  AT-STOP-LETTER-DT       PIC X(2).
  6190             20  FILLER                  PIC X(19).
  6191*             20  FILLER                  PIC X(27).
  6192             20  AT-CSO-LETTER-STATUS    PIC X.
  6193                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6194                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6195                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6196             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6197             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6198*
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 118
* EL156.cbl
  6199*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6200*
  6201*        16  FILLER                      PIC X(26).
  6202*
  6203*        16  AT-DMD-BSR-CODE             PIC X.
  6204*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6205*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6206*
  6207*        16  AT-DMD-LETTER-STATUS        PIC X.
  6208*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6209*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6210*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6211*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6212*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6213
  6214         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6215         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6216
  6217     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6218         16  AT-ADDRESS-TYPE             PIC X.
  6219             88  INSURED-ADDRESS               VALUE 'I'.
  6220             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6221             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6222             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6223             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6224             88  OTHER-ADDRESS-1               VALUE 'O'.
  6225             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6226         16  AT-MAIL-TO-NAME             PIC X(30).
  6227         16  AT-ADDRESS-LINE-1           PIC X(30).
  6228         16  AT-ADDRESS-LINE-2           PIC X(30).
  6229         16  AT-CITY-STATE.
  6230             20  AT-CITY                 PIC X(28).
  6231             20  AT-STATE                PIC XX.
  6232         16  AT-ZIP.
  6233             20  AT-ZIP-CODE.
  6234                 24  AT-ZIP-1ST          PIC X.
  6235                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6236                 24  FILLER              PIC X(4).
  6237             20  AT-ZIP-PLUS4            PIC X(4).
  6238         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6239             20  AT-CAN-POSTAL-1         PIC XXX.
  6240             20  AT-CAN-POSTAL-2         PIC XXX.
  6241             20  FILLER                  PIC XXX.
  6242         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6243*         16  FILLER                      PIC X(23).
  6244         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6245         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6246         16  FILLER                      PIC X(13).
  6247         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6248         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6249
  6250     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6251         16  AT-INFO-LINE-1              PIC X(60).
  6252         16  FILLER REDEFINES AT-INFO-LINE-1.
  6253             20  AT-NOTE-ERROR-NO OCCURS 15
  6254                                         PIC X(4).
  6255         16  AT-INFO-LINE-2              PIC X(60).
  6256         16  AT-INFO-TRAILER-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 119
* EL156.cbl
  6257             88  AT-ERRORS-NOTE          VALUE 'E'.
  6258             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6259             88  AT-CALL-NOTE            VALUE 'C'.
  6260             88  AT-MAINT-NOTE           VALUE 'M'.
  6261             88  AT-CERT-CHANGE          VALUE 'X'.
  6262             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6263             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6264         16  AT-CALL-TYPE                PIC X.
  6265             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6266             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6267         16  AT-NOTE-CONTINUATION        PIC X.
  6268             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6269         16  AT-EOB-CODES-EXIST          PIC X.
  6270             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6271         16  FILLER                      PIC X(35).
  6272         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6273         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6274
  6275     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6276         16  AT-PROMPT-LINE-1            PIC X(60).
  6277         16  AT-PROMPT-LINE-2            PIC X(60).
  6278         16  AT-PROMPT-START-DT          PIC XX.
  6279         16  AT-PROMPT-END-DT            PIC XX.
  6280         16  FILLER                      PIC X(35).
  6281         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6282         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6283
  6284     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6285         16  AT-DENIAL-INFO-1            PIC X(60).
  6286         16  AT-DENIAL-INFO-2            PIC X(60).
  6287         16  AT-DENIAL-DT                PIC XX.
  6288         16  AT-RETRACTION-DT            PIC XX.
  6289         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6290*         16  FILLER                      PIC X(31).
  6291         16  AT-DENIAL-PROOF-DT          PIC XX.
  6292         16  FILLER                      PIC X(29).
  6293         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6294         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6295
  6296     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6297         16  AT-OLD-INCURRED-DT          PIC XX.
  6298         16  AT-OLD-REPORTED-DT          PIC XX.
  6299         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6300         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6301         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6302         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6303         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6304         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6305         16  FILLER                      PIC X(26).
  6306         16  AT-OLD-DIAG-CODE            PIC X(6).
  6307         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6308         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6309         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6310         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6311         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6312         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6313         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6314         16  FILLER                      PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 120
* EL156.cbl
  6315         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6316
  6317     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6318         16  AT-FORM-SEND-ON-DT          PIC XX.
  6319         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6320         16  AT-FORM-RE-SEND-DT          PIC XX.
  6321         16  AT-FORM-ANSWERED-DT         PIC XX.
  6322         16  AT-FORM-PRINTED-DT          PIC XX.
  6323         16  AT-FORM-REPRINT-DT          PIC XX.
  6324         16  AT-FORM-TYPE                PIC X.
  6325             88  INITIAL-FORM                  VALUE '1'.
  6326             88  PROGRESS-FORM                 VALUE '2'.
  6327         16  AT-INSTRUCT-LN-1            PIC X(28).
  6328         16  AT-INSTRUCT-LN-2            PIC X(28).
  6329         16  AT-INSTRUCT-LN-3            PIC X(28).
  6330         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6331         16  AT-FORM-ADDRESS             PIC X.
  6332             88  FORM-TO-INSURED              VALUE 'I'.
  6333             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6334             88  FORM-TO-OTHER-1              VALUE 'O'.
  6335             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6336         16  AT-RELATED-1.
  6337             20 AT-REL-CARR-1            PIC X.
  6338             20 AT-REL-CLAIM-1           PIC X(7).
  6339             20 AT-REL-CERT-1            PIC X(11).
  6340         16  AT-RELATED-2.
  6341             20 AT-REL-CARR-2            PIC X.
  6342             20 AT-REL-CLAIM-2           PIC X(7).
  6343             20 AT-REL-CERT-2            PIC X(11).
  6344         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6345         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6346         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6347         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6348         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6349         16  AT-STOP-FORM-DT             PIC X(2).
  6350
  6351         16  FILLER                      PIC X(09).
  6352         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6353         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6354******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 121
* EL156.cbl
  6356*    COPY ELCACTQ.
  6357******************************************************************
  6358*                                                                *
  6359*                            ELCACTQ.                            *
  6360*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6361*                            VMOD=2.004                          *
  6362*                                                                *
  6363*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6364*                                                                *
  6365*   FILE TYPE = VSAM,KSDS                                        *
  6366*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6367*                                                                *
  6368*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6369*       ALTERNATE INDEX = NONE                                   *
  6370*                                                                *
  6371*   LOG = YES                                                    *
  6372*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6373*                                                                *
  6374*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6375******************************************************************
  6376
  6377 01  ACTIVITY-QUE.
  6378     12  AQ-RECORD-ID                PIC XX.
  6379         88  VALID-AQ-ID                VALUE 'AQ'.
  6380
  6381     12  AQ-CONTROL-PRIMARY.
  6382         16  AQ-COMPANY-CD           PIC X.
  6383         16  AQ-CARRIER              PIC X.
  6384         16  AQ-CLAIM-NO             PIC X(7).
  6385         16  AQ-CERT-NO.
  6386             20  AQ-CERT-PRIME       PIC X(10).
  6387             20  AQ-CERT-SFX         PIC X.
  6388
  6389     12  AQ-PENDING-ACTIVITY-FLAGS.
  6390         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6391         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6392             88  PENDING-PAYMENTS       VALUE '1'.
  6393         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6394             88  PENDING-FULL-PRINT     VALUE '1'.
  6395             88  PENDING-PART-PRINT     VALUE '2'.
  6396         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6397             88  PENDING-LETTERS        VALUE '1'.
  6398         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6399             88  PENDING-RESTORE        VALUE 'C'.
  6400             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6401
  6402     12  FILLER                      PIC X(20).
  6403
  6404     12  AQ-RESEND-DATE              PIC XX.
  6405     12  AQ-FOLLOWUP-DATE            PIC XX.
  6406     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6407     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6408     12  AQ-AUTO-LETTER              PIC X(4).
  6409     12  FILLER                      PIC XX.
  6410     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6411*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 122
* EL156.cbl
  6413*    COPY ERCACCT.
  6414******************************************************************
  6415*                                                                *
  6416*                                                                *
  6417*                            ERCACCT                             *
  6418*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6419*                            VMOD=2.031                          *
  6420*                                                                *
  6421*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6422*                                                                *
  6423*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6424*   VSAM ACCOUNT MASTER FILES.                                   *
  6425*                                                                *
  6426*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6427*                                                                *
  6428*   FILE TYPE = VSAM,KSDS                                        *
  6429*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6430*                                                                *
  6431*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6432*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6433*                                                                *
  6434*   LOG = NO                                                     *
  6435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6436*                                                                *
  6437*                                                                *
  6438******************************************************************
  6439*                   C H A N G E   L O G
  6440*
  6441* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6442*-----------------------------------------------------------------
  6443*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6444* EFFECTIVE    NUMBER
  6445*-----------------------------------------------------------------
  6446* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6447* 092705    2005050300006  PEMA  ADD SPP LEASES
  6448* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6449* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6450* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6451* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6452* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6453******************************************************************
  6454
  6455 01  ACCOUNT-MASTER.
  6456     12  AM-RECORD-ID                      PIC XX.
  6457         88  VALID-AM-ID                      VALUE 'AM'.
  6458
  6459     12  AM-CONTROL-PRIMARY.
  6460         16  AM-COMPANY-CD                 PIC X.
  6461         16  AM-MSTR-CNTRL.
  6462             20  AM-CONTROL-A.
  6463                 24  AM-CARRIER            PIC X.
  6464                 24  AM-GROUPING.
  6465                     28 AM-GROUPING-PREFIX PIC XXX.
  6466                     28 AM-GROUPING-PRIME  PIC XXX.
  6467                 24  AM-STATE              PIC XX.
  6468                 24  AM-ACCOUNT.
  6469                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6470                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 123
* EL156.cbl
  6471             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6472                                           PIC X(19).
  6473             20  AM-CNTRL-B.
  6474                 24  AM-EXPIRATION-DT      PIC XX.
  6475                 24  FILLER                PIC X(4).
  6476             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6477                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6478
  6479     12  AM-CONTROL-BY-VAR-GRP.
  6480         16  AM-COMPANY-CD-A1              PIC X.
  6481         16  AM-VG-CARRIER                 PIC X.
  6482         16  AM-VG-GROUPING                PIC X(6).
  6483         16  AM-VG-STATE                   PIC XX.
  6484         16  AM-VG-ACCOUNT                 PIC X(10).
  6485         16  AM-VG-DATE.
  6486             20  AM-VG-EXPIRATION-DT       PIC XX.
  6487             20  FILLER                    PIC X(4).
  6488         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6489                                           PIC 9(11)      COMP-3.
  6490     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6491         16  FILLER                        PIC X(10).
  6492         16  AM-VG-KEY3.
  6493             20  AM-VG3-ACCOUNT            PIC X(10).
  6494             20  AM-VG3-EXP-DT             PIC XX.
  6495         16  FILLER                        PIC X(4).
  6496     12  AM-MAINT-INFORMATION.
  6497         16  AM-LAST-MAINT-DT              PIC XX.
  6498         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6499         16  AM-LAST-MAINT-USER            PIC X(4).
  6500         16  FILLER                        PIC XX.
  6501
  6502     12  AM-EFFECTIVE-DT                   PIC XX.
  6503     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6504
  6505     12  AM-PREV-DATES  COMP-3.
  6506         16  AM-PREV-EXP-DT                PIC 9(11).
  6507         16  AM-PREV-EFF-DT                PIC 9(11).
  6508
  6509     12  AM-REPORT-CODE-1                  PIC X(10).
  6510     12  AM-REPORT-CODE-2                  PIC X(10).
  6511
  6512     12  AM-CITY-CODE                      PIC X(4).
  6513     12  AM-COUNTY-PARISH                  PIC X(6).
  6514
  6515     12  AM-NAME                           PIC X(30).
  6516     12  AM-PERSON                         PIC X(30).
  6517     12  AM-ADDRS                          PIC X(30).
  6518     12  AM-CITY.
  6519         16  AM-ADDR-CITY                  PIC X(28).
  6520         16  AM-ADDR-STATE                 PIC XX.
  6521     12  AM-ZIP.
  6522         16  AM-ZIP-PRIME.
  6523             20  AM-ZIP-PRI-1ST            PIC X.
  6524                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6525             20  FILLER                    PIC X(4).
  6526         16  AM-ZIP-PLUS4                  PIC X(4).
  6527     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6528         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 124
* EL156.cbl
  6529         16  AM-CAN-POSTAL-2               PIC XXX.
  6530         16  FILLER                        PIC XXX.
  6531     12  AM-TEL-NO.
  6532         16  AM-AREA-CODE                  PIC 999.
  6533         16  AM-TEL-PRE                    PIC 999.
  6534         16  AM-TEL-NBR                    PIC 9(4).
  6535     12  AM-TEL-LOC                        PIC X.
  6536         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6537         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6538
  6539     12  AM-COMM-STRUCTURE.
  6540         16  AM-DEFN-1.
  6541             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6542                 24  AM-AGT.
  6543                     28  AM-AGT-PREFIX     PIC X(4).
  6544                     28  AM-AGT-PRIME      PIC X(6).
  6545                 24  AM-COM-TYP            PIC X.
  6546                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6547                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6548                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6549                 24  AM-RECALC-LV-INDIC    PIC X.
  6550                 24  AM-RETRO-LV-INDIC     PIC X.
  6551                 24  AM-GL-CODES           PIC X.
  6552                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6553                 24  FILLER                PIC X(01).
  6554         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6555             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6556                 24  FILLER                PIC X(11).
  6557                 24  AM-L-COMA             PIC XXX.
  6558                 24  AM-J-COMA             PIC XXX.
  6559                 24  AM-A-COMA             PIC XXX.
  6560                 24  FILLER                PIC X(6).
  6561
  6562     12  AM-COMM-CHANGE-STATUS             PIC X.
  6563         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6564
  6565     12  AM-CSR-CODE                       PIC X(4).
  6566
  6567     12  AM-BILLING-STATUS                 PIC X.
  6568         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6569         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6570     12  AM-AUTO-REFUND-SW                 PIC X.
  6571         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6572         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6573     12  AM-GPCD                           PIC 99.
  6574     12  AM-IG                             PIC X.
  6575         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6576         88  AM-HAS-GROUP                     VALUE '2'.
  6577     12  AM-STATUS                         PIC X.
  6578         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6579         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6580         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6581         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6582         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6583         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6584     12  AM-REMIT-TO                       PIC 99.
  6585     12  AM-ID-NO                          PIC X(11).
  6586
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 125
* EL156.cbl
  6587     12  AM-CAL-TABLE                      PIC XX.
  6588     12  AM-LF-DEVIATION                   PIC XXX.
  6589     12  AM-AH-DEVIATION                   PIC XXX.
  6590     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6591     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6592     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6593     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6594     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6595     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6596
  6597     12  AM-USER-FIELDS.
  6598         16  AM-FLD-1                      PIC XX.
  6599         16  AM-FLD-2                      PIC XX.
  6600         16  AM-FLD-3                      PIC XX.
  6601         16  AM-FLD-4                      PIC XX.
  6602         16  AM-FLD-5                      PIC XX.
  6603
  6604     12  AM-1ST-PROD-DATE.
  6605         16  AM-1ST-PROD-YR                PIC XX.
  6606         16  AM-1ST-PROD-MO                PIC XX.
  6607         16  AM-1ST-PROD-DA                PIC XX.
  6608     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6609     12  AM-CERTS-PURGED-DATE.
  6610         16  AM-PUR-YR                     PIC XX.
  6611         16  AM-PUR-MO                     PIC XX.
  6612         16  AM-PUR-DA                     PIC XX.
  6613     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6614     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6615     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6616     12  AM-INACTIVE-DATE.
  6617         16  AM-INA-MO                     PIC 99.
  6618         16  AM-INA-DA                     PIC 99.
  6619         16  AM-INA-YR                     PIC 99.
  6620     12  AM-AR-HI-CERT-DATE                PIC XX.
  6621
  6622     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6623     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6624
  6625     12  AM-OB-PAYMENT-MODE                PIC X.
  6626         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6627         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6628         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6629         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6630
  6631     12  AM-AH-ONLY-INDICATOR              PIC X.
  6632         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6633         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6634
  6635     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6636
  6637     12  AM-OVER-SHORT.
  6638         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6639         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6640
  6641     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6642     12  AM-DCC-CLP-STATE                  PIC XX.
  6643
  6644     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 126
* EL156.cbl
  6645     12  AM-RECALC-REIN                    PIC X.
  6646
  6647     12  AM-REI-TABLE                      PIC XXX.
  6648     12  AM-REI-ET-LF                      PIC X.
  6649     12  AM-REI-ET-AH                      PIC X.
  6650     12  AM-REI-PE-LF                      PIC X.
  6651     12  AM-REI-PE-AH                      PIC X.
  6652     12  AM-REI-PRT-ST                     PIC X.
  6653     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6654     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6655     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6656     12  AM-REI-GROUP-A                    PIC X(6).
  6657     12  AM-REI-MORT                       PIC X(4).
  6658     12  AM-REI-PRT-OW                     PIC X.
  6659     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6660     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6661     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6662     12  AM-REI-GROUP-B                    PIC X(6).
  6663
  6664     12  AM-TRUST-TYPE                     PIC X(2).
  6665
  6666     12  AM-EMPLOYER-STMT-USED             PIC X.
  6667     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6668
  6669     12  AM-STD-AH-TYPE                    PIC XX.
  6670     12  AM-EARN-METHODS.
  6671         16  AM-EARN-METHOD-R              PIC X.
  6672             88 AM-REF-RL-R78                 VALUE 'R'.
  6673             88 AM-REF-RL-PR                  VALUE 'P'.
  6674             88 AM-REF-RL-MEAN                VALUE 'M'.
  6675             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6676         16  AM-EARN-METHOD-L              PIC X.
  6677             88 AM-REF-LL-R78                 VALUE 'R'.
  6678             88 AM-REF-LL-PR                  VALUE 'P'.
  6679             88 AM-REF-LL-MEAN                VALUE 'M'.
  6680             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6681         16  AM-EARN-METHOD-A              PIC X.
  6682             88 AM-REF-AH-R78                 VALUE 'R'.
  6683             88 AM-REF-AH-PR                  VALUE 'P'.
  6684             88 AM-REF-AH-MEAN                VALUE 'M'.
  6685             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6686             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6687             88 AM-REF-AH-NET                 VALUE 'N'.
  6688
  6689     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6690     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6691     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6692
  6693     12  AM-RET-Y-N                        PIC X.
  6694     12  AM-RET-P-E                        PIC X.
  6695     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6696     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6697     12  AM-RET-GRP                        PIC X(6).
  6698     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6699         16  AM-POOL-PRIME                 PIC XXX.
  6700         16  AM-POOL-SUB                   PIC XXX.
  6701     12  AM-RETRO-EARNINGS.
  6702         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 127
* EL156.cbl
  6703         16  AM-RET-EARN-L                 PIC X.
  6704         16  AM-RET-EARN-A                 PIC X.
  6705     12  AM-RET-ST-TAX-USE                 PIC X.
  6706         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6707         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6708     12  AM-RETRO-BEG-EARNINGS.
  6709         16  AM-RET-BEG-EARN-R             PIC X.
  6710         16  AM-RET-BEG-EARN-L             PIC X.
  6711         16  AM-RET-BEG-EARN-A             PIC X.
  6712     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6713     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6714
  6715     12  AM-USER-SELECT-OPTIONS.
  6716         16  AM-USER-SELECT-1              PIC X(10).
  6717         16  AM-USER-SELECT-2              PIC X(10).
  6718         16  AM-USER-SELECT-3              PIC X(10).
  6719         16  AM-USER-SELECT-4              PIC X(10).
  6720         16  AM-USER-SELECT-5              PIC X(10).
  6721
  6722     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6723
  6724     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6725
  6726     12  AM-RPT045A-SWITCH                 PIC X.
  6727         88  RPT045A-OFF                   VALUE 'N'.
  6728
  6729     12  AM-INSURANCE-LIMITS.
  6730         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6731         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6732
  6733     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6734         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6735
  6736     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6737         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6738         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6739
  6740     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6741
  6742     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6743     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6744     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6745     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6746     12  AM-DCC-UEF-STATE                  PIC XX.
  6747     12  FILLER                            PIC XXX.
  6748     12  AM-REPORT-CODE-3                  PIC X(10).
  6749*    12  FILLER                            PIC X(22).
  6750
  6751     12  AM-RESERVE-DATE.
  6752         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6753         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6754         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6755
  6756     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6757     12  AM-NOTIFICATION-TYPES.
  6758         16  AM-NOTIF-OF-LETTERS           PIC X.
  6759         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6760         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 128
* EL156.cbl
  6761         16  AM-NOTIF-OF-STATUS            PIC X.
  6762
  6763     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6764         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6765         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6766         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6767         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6768
  6769     12  AM-BENEFIT-CONTROLS.
  6770         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6771             20  AM-BENEFIT-CODE           PIC XX.
  6772             20  AM-BENEFIT-TYPE           PIC X.
  6773             20  AM-BENEFIT-REVISION       PIC XXX.
  6774             20  AM-BENEFIT-REM-TERM       PIC X.
  6775             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6776             20  FILLER                    PIC XX.
  6777         16  FILLER                        PIC X(80).
  6778
  6779     12  AM-TRANSFER-DATA.
  6780         16  AM-TRANSFERRED-FROM.
  6781             20  AM-TRNFROM-CARRIER        PIC X.
  6782             20  AM-TRNFROM-GROUPING.
  6783                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6784                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6785             20  AM-TRNFROM-STATE          PIC XX.
  6786             20  AM-TRNFROM-ACCOUNT.
  6787                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6788                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6789             20  AM-TRNFROM-DTE            PIC XX.
  6790         16  AM-TRANSFERRED-TO.
  6791             20  AM-TRNTO-CARRIER          PIC X.
  6792             20  AM-TRNTO-GROUPING.
  6793                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6794                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6795             20  AM-TRNTO-STATE            PIC XX.
  6796             20  AM-TRNTO-ACCOUNT.
  6797                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6798                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6799             20  AM-TRNTO-DTE              PIC XX.
  6800         16  FILLER                        PIC X(10).
  6801
  6802     12  AM-SAVED-REMIT-TO                 PIC 99.
  6803
  6804     12  AM-COMM-STRUCTURE-SAVED.
  6805         16  AM-DEFN-1-SAVED.
  6806             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6807                 24  AM-AGT-SV             PIC X(10).
  6808                 24  AM-COM-TYP-SV         PIC X.
  6809                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6810                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6811                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6812                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6813                 24  FILLER                PIC X.
  6814                 24  AM-GL-CODES-SV        PIC X.
  6815                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6816                 24  FILLER                PIC X.
  6817         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6818             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 129
* EL156.cbl
  6819                 24  FILLER                PIC X(11).
  6820                 24  AM-L-COMA-SV          PIC XXX.
  6821                 24  AM-J-COMA-SV          PIC XXX.
  6822                 24  AM-A-COMA-SV          PIC XXX.
  6823                 24  FILLER                PIC X(6).
  6824
  6825     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6826         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6827            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6828            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6829            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6830
  6831     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6832     12  FILLER                            PIC X(120).
  6833
  6834     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6835         16  AM-CONTROL-NAME               PIC X(30).
  6836         16  AM-EXECUTIVE-ONE.
  6837             20  AM-EXEC1-NAME             PIC X(15).
  6838             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6839                                                          COMP-3.
  6840             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6841                                                          COMP-3.
  6842         16  AM-EXECUTIVE-TWO.
  6843             20  AM-EXEC2-NAME             PIC X(15).
  6844             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6845                                                          COMP-3.
  6846             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6847                                                          COMP-3.
  6848
  6849     12  AM-RETRO-ADDITIONAL-DATA.
  6850         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6851         16  AM-RETRO-PREM-P-E             PIC X.
  6852         16  AM-RETRO-CLMS-P-I             PIC X.
  6853         16  AM-RETRO-RET-BRACKET-LF.
  6854             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6855                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6856                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6857             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6858                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6859                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6860             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6861                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6862                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6863         16  AM-RETRO-RET-BRACKET-AH.
  6864             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6865                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6866                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6867                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6868             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6869                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6870                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6871             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6872                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6873                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6874
  6875     12  AM-COMMENTS.
  6876         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 130
* EL156.cbl
  6877
  6878     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6879         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6880         16  AM-FLI-BILLING-CODE           PIC X.
  6881         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6882         16  AM-FLI-UNITED-IDENT           PIC X.
  6883         16  AM-FLI-INTEREST-LOST-DATA.
  6884             20  AM-FLI-BANK-NO            PIC X(5).
  6885             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6886             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6887             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6888         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6889             20  AM-FLI-AGT                PIC X(9).
  6890             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6891             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6892         16  FILLER                        PIC X(102).
  6893
  6894     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6895         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6896             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6897             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6898             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6899             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6900             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6901         16  FILLER                          PIC X(10).
  6902******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 131
* EL156.cbl
  6904*    COPY ELCCHKQ.
  6905******************************************************************
  6906*                                                                *
  6907*                                                                *
  6908*                            ELCCHKQ.                            *
  6909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6910*                            VMOD=2.007                          *
  6911*                                                                *
  6912*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6913*                                                                *
  6914*   FILE TYPE = VSAM,KSDS                                        *
  6915*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6916*                                                                *
  6917*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6918*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6919*                                                                *
  6920*   LOG = YES                                                    *
  6921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6922******************************************************************
  6923 01  CHECK-QUE.
  6924     12  CQ-RECORD-ID                PIC XX.
  6925         88  VALID-CQ-ID         VALUE 'CQ'.
  6926
  6927     12  CQ-CONTROL-PRIMARY.
  6928         16  CQ-COMPANY-CD           PIC X.
  6929         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6930         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6931
  6932     12  CQ-CONTROL-BY-PAYEE.
  6933         16  CQ-CONTROL-BY-NUMBER.
  6934             20  CQ-COMPANY-CD-A1     PIC X.
  6935             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6936         16  CQ-PAYEE-CARRIER        PIC X.
  6937         16  CQ-PAYEE-GROUPING       PIC X(6).
  6938         16  CQ-PAYEE-STATE          PIC XX.
  6939         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6940         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6941
  6942     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6943         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6944         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6945         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6946         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6947         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6948         16  FILLER                  PIC X(3).
  6949
  6950     12  CQ-ENTRY-TYPE               PIC X.
  6951             88  CHECK-ON-QUE           VALUE 'Q'.
  6952             88  ALIGNMENT-CHECK        VALUE 'A'.
  6953             88  SPOILED-CHECK          VALUE 'S'.
  6954             88  PAYMENT-ABORTED        VALUE 'X'.
  6955
  6956     12  CQ-CLAIM-MAST-CNTL.
  6957         16  CQ-CARRIER              PIC X.
  6958         16  CQ-CLAIM-NO             PIC X(7).
  6959         16  CQ-CERT-NO.
  6960             20  CQ-CERT-PRIME       PIC X(10).
  6961             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 132
* EL156.cbl
  6962         16  CQ-CLAIM-TYPE           PIC X.
  6963             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6964             88  CQ-AH-CLAIM            VALUE 'A'.
  6965         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6966             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6967             88  CQ-O-B-COVERAGE        VALUE '2'.
  6968             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6969
  6970     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6971     12  CQ-CHECK-NUMBER             PIC X(7).
  6972     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6973     12  CQ-PAYMENT-TYPE             PIC X.
  6974             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6975             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6976             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6977             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6978             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6979             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6980             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6981             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6982     12  CQ-VOID-INDICATOR           PIC X.
  6983             88  CHECK-IS-STOPPED          VALUE 'S'.
  6984             88  CHECK-IS-VOID             VALUE 'V'.
  6985     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6986     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6987     12  CQ-CHECK-BY-USER            PIC X(4).
  6988     12  CQ-PRE-NUMBERING-SW         PIC X.
  6989       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6990       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6991
  6992     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6993     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6994     12  CQ-LEDGER-FLAG              PIC X(01).
  6995     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6996     12  CQ-LAST-UPDATED-DT          PIC XX.
  6997     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6998     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6999
  7000     12  FILLER                      PIC X(04).
  7001
  7002******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 133
* EL156.cbl
  7004*    COPY ELCBENE.
  7005******************************************************************
  7006*                                                                *
  7007*                            ELCBENE.                            *
  7008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7009*                            VMOD=2.006                          *
  7010*                                                                *
  7011*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7012*                                                                *
  7013*   FILE TYPE = VSAM,KSDS                                        *
  7014*   RECORD SIZE = 500   RECFORM = FIX                            *
  7015*                                                                *
  7016*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7017*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7018*                                                                *
  7019*   LOG = YES                                                    *
  7020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7021*                                                                *
  7022*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7023******************************************************************
  7024
  7025 01  BENEFICIARY-MASTER.
  7026     12  BE-RECORD-ID                PIC XX.
  7027         88  VALID-BE-ID                VALUE 'BE'.
  7028
  7029     12  BE-CONTROL-PRIMARY.
  7030         16  BE-COMPANY-CD           PIC X.
  7031         16  BE-RECORD-TYPE          PIC X.
  7032             88  BENEFICIARY-RECORD  VALUE 'B'.
  7033             88  ADJUSTOR-RECORD     VALUE 'A'.
  7034         16  BE-BENEFICIARY          PIC X(10).
  7035     12  BE-CONTROL-BY-NAME.
  7036         16  BE-COMPANY-CD-A1        PIC X.
  7037         16  BE-RECORD-TYPE-A1       PIC X.
  7038         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7039         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7040
  7041     12  BE-LAST-MAINT-DT            PIC XX.
  7042     12  BE-LAST-MAINT-BY            PIC X(4).
  7043     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7044
  7045     12  BE-ADDRESS-DATA.
  7046         16  BE-MAIL-TO-NAME         PIC X(30).
  7047         16  BE-ADDRESS-LINE-1       PIC X(30).
  7048         16  BE-ADDRESS-LINE-2       PIC X(30).
  7049         16  BE-ADDRESS-LINE-3       PIC X(30).
  7050         16  BE-CITY-STATE.
  7051             20  BE-CITY             PIC X(28).
  7052             20  BE-STATE            PIC XX.
  7053         16  BE-ZIP-CODE.
  7054             20  BE-ZIP-PRIME.
  7055                 24  BE-ZIP-1ST      PIC X.
  7056                     88  BE-CANADIAN-POST-CODE
  7057                                         VALUE 'A' THRU 'Z'.
  7058                 24  FILLER          PIC X(4).
  7059             20  BE-ZIP-PLUS4        PIC X(4).
  7060         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7061             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 134
* EL156.cbl
  7062             20  BE-CAN-POSTAL-2     PIC XXX.
  7063             20  FILLER              PIC XXX.
  7064         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7065         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7066
  7067******************************************************************
  7068*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7069*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7070******************************************************************
  7071     12  BE-CARRIER                  PIC X.
  7072
  7073     12  BE-ADDRESS-DATA2.
  7074         16  BE-MAIL-TO-NAME2        PIC X(30).
  7075         16  BE-ADDRESS-LINE-12      PIC X(30).
  7076         16  BE-ADDRESS-LINE-22      PIC X(30).
  7077         16  BE-ADDRESS-LINE-32      PIC X(30).
  7078         16  BE-CITY-STATE2.
  7079             20  BE-CITY2            PIC X(28).
  7080             20  BE-STATE2           PIC XX.
  7081         16  BE-ZIP-CODE2.
  7082             20  BE-ZIP-PRIME2.
  7083                 24  BE-ZIP-1ST2     PIC X.
  7084                     88  BE-CANADIAN-POST-CODE2
  7085                                         VALUE 'A' THRU 'Z'.
  7086                 24  FILLER          PIC X(4).
  7087             20  BE-ZIP-PLUS42       PIC X(4).
  7088         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7089             20  BE-CAN-POSTAL-12    PIC XXX.
  7090             20  BE-CAN-POSTAL-22    PIC XXX.
  7091             20  FILLER              PIC XXX.
  7092         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7093         16  BE-BILLING-STMT-DATA.
  7094             20  BE-BSR              PIC X.
  7095                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7096                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7097             20  BE-BSR-FROM         PIC X(30).
  7098             20  BE-BSR-DEPT         PIC X(30).
  7099             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7100             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7101             20  BE-OUTPUT-TYPE      PIC X.
  7102                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7103                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7104
  7105     12  FILLER                      PIC X(28).
  7106******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 135
* EL156.cbl
  7108*    COPY ELCARCH.
  7109******************************************************************
  7110*                                                                *
  7111*                            ELCARCH.                            *
  7112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7113*                            VMOD=2.007                          *
  7114*                                                                *
  7115*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7116*                                                                *
  7117*   FILE TYPE = VSAM,KSDS                                        *
  7118*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7119*                                                                *
  7120*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7121*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7122*                                                                *
  7123*   LOG = NO                                                     *
  7124*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7125*                                                                *
  7126*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7127******************************************************************
  7128 01  LETTER-ARCHIVE.
  7129     12  LA-RECORD-ID                PIC XX.
  7130         88  VALID-LA-ID                VALUE 'LA'.
  7131
  7132     12  LA-CONTROL-PRIMARY.
  7133         16  LA-COMPANY-CD           PIC X.
  7134         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7135         16  LA-RECORD-TYPE          PIC X.
  7136             88  LA-HEADER-DATA         VALUE '1'.
  7137             88  LA-ADDRESS-DATA        VALUE '2'.
  7138             88  LA-TEXT-DATA           VALUE '3'.
  7139             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7140         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7141
  7142     12  LA-CONTROL-BY-TYPE.
  7143         16  LA-COMPANY-CD-A1        PIC X.
  7144         16  LA-RECORD-TYPE-A1       PIC X.
  7145         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7146         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7147
  7148     12  LA-TEXT-RECORD.
  7149         16  LA-SKIP-CONTROL         PIC XX.
  7150             88  NO-LINES-SKIPPED       VALUE SPACES.
  7151             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7152         16  LA-TEXT-LINE            PIC X(70).
  7153
  7154     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7155         16  FILLER                  PIC XX.
  7156         16  LA-ADDRESS-LINE         PIC X(30).
  7157         16  FILLER                  PIC X(40).
  7158
  7159     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7160         16  FILLER                  PIC XX.
  7161         16  LA-CARRIER              PIC X.
  7162         16  LA-CLAIM-NO             PIC X(7).
  7163         16  LA-CERT-NO.
  7164             20  LA-CERT-PRIME       PIC X(10).
  7165             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 136
* EL156.cbl
  7166         16  LA-NO-OF-COPIES         PIC S9.
  7167         16  LA-RESEND-DATE          PIC XX.
  7168         16  LA-PROCESSOR-CD         PIC X(4).
  7169         16  LA-CREATION-DT          PIC XX.
  7170         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7171         16  LA-RESEND-PRINT-DATE    PIC XX.
  7172         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7173         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7174*
  7175* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7176*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7177*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7178*   I        20  LA-DMD-RES-ST           PIC XX.
  7179*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7180*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7181*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7182*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7183*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7184*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7185*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7186*   I        20  LA-DMD-UND-CODE         PIC XX.
  7187*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7188*   V    16  FILLER                  PIC X(15).
  7189* -----
  7190*
  7191* REINSERTED  CSO  MODS
  7192*
  7193         16  FILLER.
  7194             20  FILLER                  PIC X(29).
  7195             20  LA-CSO-LETTER-STATUS    PIC X.
  7196                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7197                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7198                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7199             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7200             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7201*
  7202
  7203     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7204         16  FILLER                  PIC XX.
  7205         16  LA4-CARRIER             PIC X.
  7206         16  LA4-CLAIM-NO            PIC X(7).
  7207         16  LA4-CERT-NO.
  7208             20  LA4-CERT-PRIME      PIC X(10).
  7209             20  LA4-CERT-SFX        PIC X.
  7210         16  LA4-NO-OF-COPIES        PIC S9.
  7211         16  LA4-RESEND-DATE         PIC XX.
  7212         16  LA4-PROCESSOR-CD        PIC X(4).
  7213         16  LA4-CREATION-DT         PIC XX.
  7214         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7215         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7216         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7217         16  LA4-FORM-TYPE           PIC X.
  7218             88  LA4-INITIAL-FORM    VALUE '1'.
  7219             88  LA4-PROGRESS-FORM   VALUE '2'.
  7220         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7221         16  LA4-STATE               PIC X(02).
  7222         16  FILLER                  PIC X(31).
  7223******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 137
* EL156.cbl
  7225*    COPY ELCDAR.
  7226******************************************************************
  7227*                                                                *
  7228*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7229*   FILE TYPE = VSAM,KSDS                                        *
  7230*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7231*   BASE CLUSTER = DLYACTV                                       *
  7232*   LOG = YES                                                    *
  7233*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7234*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7235*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7236*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7237*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7238*               BY PROGRAM "LGINFCE".                            *
  7239*                                                                *
  7240******************************************************************
  7241 01  DAILY-ACTIVITY-RECORD.
  7242     05  DA-KEY.
  7243         10  DA-COMP-CD          PIC X.
  7244         10  DA-CARRIER          PIC X.
  7245         10  DA-CLAIM-NO         PIC X(7).
  7246         10  DA-CERT-NO.
  7247             15  DA-CERT-PRIME   PIC X(10).
  7248             15  DA-CERT-SFX     PIC X.
  7249     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7250     05  DA-RECORD-TYPE          PIC X.
  7251     05  FILLER                  PIC X(2).
  7252******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 138
* EL156.cbl
  7254*    COPY ERCCOMP.
  7255******************************************************************
  7256*                                                                *
  7257*                                                                *
  7258*                            ERCCOMP                             *
  7259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7260*                            VMOD=2.019                          *
  7261*                                                                *
  7262*   ONLINE CREDIT SYSTEM                                         *
  7263*                                                                *
  7264*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7265*                                                                *
  7266*   FILE TYPE = VSAM,KSDS                                        *
  7267*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7268*                                                                *
  7269*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7270*       ALTERNATE PATH = NONE                                    *
  7271*                                                                *
  7272*   LOG = NO                                                     *
  7273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7274*                                                                *
  7275******************************************************************
  7276*                   C H A N G E   L O G
  7277*
  7278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7279*-----------------------------------------------------------------
  7280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7281* EFFECTIVE    NUMBER
  7282*-----------------------------------------------------------------
  7283* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7284* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7285* 092205    2005050300006  PEMA  ADD LEASE FEE
  7286* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7287* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7288* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7289* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7290* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7291* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7292******************************************************************
  7293
  7294 01  COMPENSATION-MASTER.
  7295     12  CO-RECORD-ID                          PIC XX.
  7296         88  VALID-CO-ID                          VALUE 'CO'.
  7297
  7298     12  CO-CONTROL-PRIMARY.
  7299         16  CO-COMPANY-CD                     PIC X.
  7300         16  CO-CONTROL.
  7301             20  CO-CTL-1.
  7302                 24  CO-CARR-GROUP.
  7303                     28  CO-CARRIER            PIC X.
  7304                     28  CO-GROUPING.
  7305                         32  CO-GROUP-PREFIX   PIC XXX.
  7306                         32  CO-GROUP-PRIME    PIC XXX.
  7307                 24  CO-RESP-NO.
  7308                     28  CO-RESP-PREFIX        PIC X(4).
  7309                     28  CO-RESP-PRIME         PIC X(6).
  7310             20  CO-CTL-2.
  7311                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 139
* EL156.cbl
  7312                     28  CO-ACCT-PREFIX        PIC X(4).
  7313                     28  CO-ACCT-PRIME         PIC X(6).
  7314         16  CO-TYPE                           PIC X.
  7315             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7316             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7317             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7318
  7319     12  CO-MAINT-INFORMATION.
  7320         16  CO-LAST-MAINT-DT                  PIC XX.
  7321         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7322         16  CO-LAST-MAINT-USER                PIC X(4).
  7323     12  FILLER                                PIC XX.
  7324     12  CO-STMT-TYPE                          PIC XXX.
  7325     12  CO-COMP-TYPE                          PIC X.
  7326         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7327     12  CO-STMT-OWNER                         PIC X(4).
  7328     12  CO-BALANCE-CONTROL                    PIC X.
  7329         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7330         88  CO-NO-BALANCE                        VALUE 'N'.
  7331
  7332     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7333         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7334         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7335         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7336
  7337     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7338         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7339         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7340
  7341     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7342     12  CO-GA-DIRECT-DEP                      PIC X.
  7343     12  CO-FUTURE-SPACE                       PIC X.
  7344         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7345
  7346     12  CO-ACCT-NAME                          PIC X(30).
  7347     12  CO-MAIL-NAME                          PIC X(30).
  7348     12  CO-ADDR-1                             PIC X(30).
  7349     12  CO-ADDR-2                             PIC X(30).
  7350     12  CO-ADDR-3.
  7351         16  CO-ADDR-CITY                      PIC X(27).
  7352         16  CO-ADDR-STATE                     PIC XX.
  7353     12  CO-CSO-1099                           PIC X.
  7354     12  CO-ZIP.
  7355         16  CO-ZIP-PRIME.
  7356             20  CO-ZIP-PRI-1ST                PIC X.
  7357                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7358             20  FILLER                        PIC X(4).
  7359         16  CO-ZIP-PLUS4                      PIC X(4).
  7360     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7361         16  CO-CAN-POSTAL-1                   PIC XXX.
  7362         16  CO-CAN-POSTAL-2                   PIC XXX.
  7363         16  FILLER                            PIC XXX.
  7364     12  CO-SOC-SEC                            PIC X(13).
  7365     12  CO-TELEPHONE.
  7366         16  CO-AREA-CODE                      PIC XXX.
  7367         16  CO-PREFIX                         PIC XXX.
  7368         16  CO-PHONE                          PIC X(4).
  7369
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 140
* EL156.cbl
  7370     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7371
  7372     12  CO-AR-BAL-LEVEL                       PIC X.
  7373         88  CO-AR-REF-LVL                        VALUE '1'.
  7374         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7375         88  CO-AR-BILL-LVL                       VALUE '2'.
  7376         88  CO-AR-AGT-LVL                        VALUE '3'.
  7377         88  CO-AR-FR-LVL                         VALUE '4'.
  7378
  7379     12  CO-AR-NORMAL-PRINT                    PIC X.
  7380         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7381         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7382
  7383     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7384
  7385     12  CO-AR-REPORTING                       PIC X.
  7386         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7387         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7388
  7389     12  CO-AR-PULL-CHECK                      PIC X.
  7390         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7391         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7392
  7393     12  CO-AR-BALANCE-PRINT                   PIC X.
  7394         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7395
  7396     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7397         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7398         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7399         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7400
  7401     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7402
  7403     12  CO-USER-CODE                          PIC X.
  7404     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7405
  7406******************************************************************
  7407*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7408*    THE LAST MONTH END RUN.
  7409******************************************************************
  7410
  7411     12  CO-LAST-ACTIVITY-DATE.
  7412         16  CO-ACT-YEAR                       PIC 99.
  7413         16  CO-ACT-MONTH                      PIC 99.
  7414         16  CO-ACT-DAY                        PIC 99.
  7415
  7416     12  CO-LAST-STMT-DT.
  7417         16  CO-LAST-STMT-YEAR                 PIC 99.
  7418         16  CO-LAST-STMT-MONTH                PIC 99.
  7419         16  CO-LAST-STMT-DAY                  PIC 99.
  7420
  7421     12  CO-MO-END-TOTALS.
  7422         16  CO-MONTHLY-TOTALS.
  7423             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7424             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7425             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7426             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7427             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 141
* EL156.cbl
  7428
  7429         16  CO-AGING-TOTALS.
  7430             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7431             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7432             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7433             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7434
  7435         16  CO-YTD-TOTALS.
  7436             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7437             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7438
  7439         16  CO-OVER-UNDER-TOTALS.
  7440             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7441             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7442
  7443     12  CO-MISCELLANEOUS-TOTALS.
  7444         16  CO-FICA-TOTALS.
  7445             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7446             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7447
  7448         16  CO-CLAIM-TOTALS.
  7449             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7450             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7451
  7452******************************************************************
  7453*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7454*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7455******************************************************************
  7456
  7457     12  CO-CURRENT-TOTALS.
  7458         16  CO-CURRENT-LAST-STMT-DT.
  7459             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7460             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7461             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7462
  7463         16  CO-CURRENT-MONTHLY-TOTALS.
  7464             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7465             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7466             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7467             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7468             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7469
  7470         16  CO-CURRENT-AGING-TOTALS.
  7471             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7472             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7473             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7474             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7475
  7476         16  CO-CURRENT-YTD-TOTALS.
  7477             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7478             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7479
  7480     12  CO-PAID-COMM-TOTALS.
  7481         16  CO-YTD-PAID-COMMS.
  7482             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7483             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7484
  7485     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 142
* EL156.cbl
  7486         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7487         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7488
  7489     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7490         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7491         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7492         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7493         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7494         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7495         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7496         88  CO-FINAL-LETTER                  VALUE 'F'.
  7497         88  CO-RECONCILING                   VALUE 'R'.
  7498         88  CO-PHONE-CALL                    VALUE 'P'.
  7499         88  CO-LEGAL                         VALUE 'L'.
  7500         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7501         88  CO-WRITE-OFF                     VALUE 'W'.
  7502         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7503
  7504     12  CO-CSR-CODE                       PIC X(4).
  7505
  7506     12  CO-GA-STATUS-INFO.
  7507         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7508         16  CO-GA-TERMINATION-DT          PIC XX.
  7509         16  CO-GA-STATUS-CODE             PIC X.
  7510             88  CO-GA-ACTIVE                 VALUE 'A'.
  7511             88  CO-GA-INACTIVE               VALUE 'I'.
  7512             88  CO-GA-PENDING                VALUE 'P'.
  7513         16  CO-GA-COMMENTS.
  7514             20  CO-GA-COMMENT-1           PIC X(40).
  7515             20  CO-GA-COMMENT-2           PIC X(40).
  7516             20  CO-GA-COMMENT-3           PIC X(40).
  7517             20  CO-GA-COMMENT-4           PIC X(40).
  7518
  7519     12  CO-RPTCD2                         PIC X(10).
  7520     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7521         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7522         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7523
  7524     12  CO-TYPE-AGENT                     PIC X(01).
  7525         88  CO-CORPORATION                   VALUE 'C'.
  7526         88  CO-PARTNERSHIP                   VALUE 'P'.
  7527         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7528         88  CO-TRUST                         VALUE 'T'.
  7529         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7530
  7531     12  CO-FAXNO.
  7532         16  CO-FAX-AREA-CODE                  PIC XXX.
  7533         16  CO-FAX-PREFIX                     PIC XXX.
  7534         16  CO-FAX-PHONE                      PIC X(4).
  7535
  7536     12  CO-BANK-INFORMATION.
  7537         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7538         16  CO-BANK-TRANSIT-NON REDEFINES
  7539             CO-BANK-TRANSIT-NO                PIC 9(8).
  7540
  7541         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7542     12  CO-MISC-DEDUCT-INFO REDEFINES
  7543                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 143
* EL156.cbl
  7544         16  CO-MD-GL-ACCT                     PIC X(10).
  7545         16  CO-MD-DIV                         PIC XX.
  7546         16  CO-MD-CENTER                      PIC X(4).
  7547         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7548         16  CO-CREATE-AP-CHECK                PIC X.
  7549         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7550         16  FILLER                            PIC XXX.
  7551     12  CO-ACH-STATUS                         PIC X.
  7552         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7553         88  CO-ACH-PENDING                        VALUE 'P'.
  7554
  7555     12  CO-BILL-SW                            PIC X.
  7556     12  CO-CONTROL-NAME                       PIC X(30).
  7557     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7558     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7559     12  CO-CLP-STATE                          PIC XX.
  7560     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7561     12  CO-SPP-REFUND-EDIT                    PIC X.
  7562
  7563******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 144
* EL156.cbl
  7565*    COPY ERCDMDNT.
  7566******************************************************************
  7567*                                                                *
  7568*                            ERCDMDNT                            *
  7569*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7570*                            VMOD=2.005                          *
  7571*                                                                *
  7572*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7573*                                                                *
  7574*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7575*                                                                *
  7576*        FILE TYPE= VSAM,KSDS                                    *
  7577*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7578*                                                                *
  7579*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7580*                                                                *
  7581*        LOG = YES                                               *
  7582*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7583*                                                                *
  7584******************************************************************
  7585
  7586 01  CERTIFICATE-NOTE.
  7587     12  CN-RECORD-ID                     PIC  XX.
  7588         88  VALID-CN-ID                      VALUE 'CN'.
  7589
  7590     12  CN-CONTROL-PRIMARY.
  7591         16  CN-COMPANY-CD                PIC X.
  7592         16  CN-CERT-KEY.
  7593             20  CN-CARRIER               PIC X.
  7594             20  CN-GROUPING.
  7595                 24  CN-GROUPING-PREFIX   PIC XXX.
  7596                 24  CN-GROUPING-PRIME    PIC XXX.
  7597             20  CN-STATE                 PIC XX.
  7598             20  CN-ACCOUNT.
  7599                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7600                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7601             20  CN-CERT-EFF-DT           PIC XX.
  7602             20  CN-CERT-NO.
  7603                 24  CN-CERT-PRIME        PIC X(10).
  7604                 24  CN-CERT-SFX          PIC X.
  7605
  7606     12  CN-BILLING-START-LINE-NO         PIC 99.
  7607     12  CN-BILLING-END-LINE-NO           PIC 99.
  7608
  7609     12  CN-LINES.
  7610         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7611
  7612     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7613         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7614         16  CN-CSI-GENERAL-DATA-AREA.
  7615             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7616
  7617         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7618             CN-CSI-GENERAL-DATA-AREA.
  7619             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7620             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7621             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7622             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 145
* EL156.cbl
  7623             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7624             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7625             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7626             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7627             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7628             20  FILLER                       PIC XX.
  7629             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7630             20  FILLER                       PIC X(38).
  7631
  7632         16  CN-CSI-PRODUCT-DATA-AREA.
  7633             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7634
  7635         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7636             CN-CSI-PRODUCT-DATA-AREA.
  7637             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7638             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7639             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7640             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7641             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7642             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7643             20  FILLER                   PIC XX.
  7644             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7645             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7646             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7647             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7648             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7649             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7650             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7651             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7652             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7653             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7654             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7655             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7656             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7657             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7658             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7659             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7660             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7661             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7662             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7663             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7664             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7665             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7666             20  FILLER                   PIC X(25).
  7667
  7668         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7669             CN-CSI-CREDIT-CARD-DATA.
  7670             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7671             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7672             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7673             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7674             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7675             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7676             20  FILLER                   PIC XX.
  7677             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7678             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7679             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7680             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 146
* EL156.cbl
  7681             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7682             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7683             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7684             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7685             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7686             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7687             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7688             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7689             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7690             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7691             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7692             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7693             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7694             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7695             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7696             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7697             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7698             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7699             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7700             20  FILLER                   PIC X(17).
  7701
  7702         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7703             CN-CSI-FAMILY-LEAVE-DATA.
  7704             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7705             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7706             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7707             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7708             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7709             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7710             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7711             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7712             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7713             20  CN-CSI-SL-INT-ON-PROCEEDS
  7714                                          PIC S9(5)V99  COMP-3.
  7715             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7716             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7717             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7718             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7719             20  CN-CSI-SL-POLICY-BENEFITS
  7720                                          PIC S9(5)V99  COMP-3.
  7721             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7722             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7723             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7724             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7725             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7726             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7727             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7728             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7729             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7730             20  CN-CSI-SL-STATE-NOT      PIC X.
  7731             20  FILLER                   PIC XX.
  7732
  7733         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7734             CN-CSI-SENIOR-LIFE-DATA.
  7735             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7736             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7737             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7738                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 147
* EL156.cbl
  7739             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7740             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7741             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7742             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7743             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7744             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7745             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7746             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7747             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7748             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7749             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7750             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7751             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7752             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7753             20  CN-CSI-PP-REPAIR         PIC X.
  7754             20  CN-CSI-PP-REPLACE        PIC X.
  7755             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7756             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7757             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7758             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7759             20  FILLER                   PIC X(5).
  7760
  7761         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7762             CN-CSI-PURCH-PROP-DATA.
  7763             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7764             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7765             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7766             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7767             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7768             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7769             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7770             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7771             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7772             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7773             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7774             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7775             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7776             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7777             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7778             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7779             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7780             20  CN-CSI-EW-REPLACE        PIC X.
  7781             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7782             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7783             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7784             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7785             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7786             20  FILLER                   PIC X(4).
  7787
  7788     12  CN-LAST-MAINT-DT                 PIC XX.
  7789     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7790     12  CN-LAST-MAINT-USER               PIC X(4).
  7791     12  FILLER                           PIC X(6).
  7792
  7793******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 148
* EL156.cbl
  7795*    COPY ERCCNOT.
  7796******************************************************************
  7797*                                                                *
  7798*                            ERCCNOT                             *
  7799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7800*                            VMOD=2.003                          *
  7801*                                                                *
  7802*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7803*                                                                *
  7804*        FILE TYPE= VSAM,KSDS                                    *
  7805*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7806*                                                                *
  7807*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7808*                                                                *
  7809*        LOG = YES                                               *
  7810*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7811*                                                                *
  7812******************************************************************
  7813*                   C H A N G E   L O G
  7814*
  7815* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7816*-----------------------------------------------------------------
  7817*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7818* EFFECTIVE    NUMBER
  7819*-----------------------------------------------------------------
  7820* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7821******************************************************************
  7822
  7823 01  CERT-NOTE-FILE.
  7824     12  CZ-RECORD-ID                PIC  XX.
  7825         88  VALID-CZ-ID                  VALUE 'CZ'.
  7826
  7827     12  CZ-CONTROL-PRIMARY.
  7828         16  CZ-COMPANY-CD           PIC X.
  7829         16  CZ-CARRIER              PIC X.
  7830         16  CZ-GROUPING.
  7831             20 CZ-GROUPING-PREFIX   PIC XXX.
  7832             20 CZ-GROUPING-PRIME    PIC XXX.
  7833         16  CZ-STATE                PIC XX.
  7834         16  CZ-ACCOUNT.
  7835             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7836             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7837         16  CZ-CERT-EFF-DT          PIC XX.
  7838         16  CZ-CERT-NO.
  7839             20  CZ-CERT-PRIME       PIC X(10).
  7840             20  CZ-CERT-SFX         PIC X.
  7841         16  CZ-RECORD-TYPE          PIC X.
  7842             88  CERT-NOTE           VALUE '1'.
  7843             88  CLAIM-CERT-NOTE     VALUE '2'.
  7844         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7845
  7846     12  CZ-LAST-MAINT-DT            PIC XX.
  7847     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7848     12  CZ-LAST-MAINT-USER          PIC X(4).
  7849
  7850     12  CZ-NOTE-INFORMATION.
  7851         16  CZ-NOTE                 PIC X(63).
  7852         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 149
* EL156.cbl
  7853******************************************************************
  7854*                            COPY ERCPDEF.
  7855******************************************************************
  7856*                                                                *
  7857*                                                                *
  7858*                            ERCPDEF.                            *
  7859*                                                                *
  7860*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7861*                                                                *
  7862*    FILE TYPE = VSAM,KSDS                                       *
  7863*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7864*                                                                *
  7865*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7866*                                                                *
  7867*    LOG = YES                                                   *
  7868*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7869******************************************************************
  7870 01  PRODUCT-MASTER.
  7871    12  PD-RECORD-ID                 PIC X(02).
  7872        88  VALID-PD-ID                  VALUE 'PD'.
  7873    12  PD-CONTROL-PRIMARY.
  7874        16  PD-COMPANY-CD            PIC X.
  7875        16  PD-STATE                 PIC XX.
  7876        16  PD-PRODUCT-CD            PIC XXX.
  7877        16  PD-FILLER                PIC X(7).
  7878        16  PD-BEN-TYPE              PIC X.
  7879        16  PD-BEN-CODE              PIC XX.
  7880        16  PD-PROD-EXP-DT           PIC XX.
  7881    12  FILLER                       PIC X(50).
  7882    12  PD-PRODUCT-DATA OCCURS 8.
  7883        16  PD-PROD-CODE             PIC X.
  7884            88  PD-PROD-LIFE           VALUE 'L'.
  7885            88  PD-PROD-PROP           VALUE 'P'.
  7886            88  PD-PROD-AH             VALUE 'A'.
  7887            88  PD-PROD-IU             VALUE 'I'.
  7888            88  PD-PROD-GAP            VALUE 'G'.
  7889        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7890        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7891        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7892        16  PD-MAX-TERM              PIC S999        COMP-3.
  7893        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7894        16  FILLER                   PIC X.
  7895        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7896        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7897        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7898        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7899        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7900        16  PD-REC-CRIT-PERIOD       PIC X.
  7901        16  PD-RTW-MOS               PIC 99.
  7902        16  FILLER                   PIC X(5).
  7903    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7904    12  PD-TERM-LIMITS OCCURS 15.
  7905        16  PD-LOW-TERM              PIC S999        COMP-3.
  7906        16  PD-HI-TERM               PIC S999        COMP-3.
  7907*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7908    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7909        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7910        16  PD-HI-AMT                PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 150
* EL156.cbl
  7911    12  PD-EARN-FACTORS.
  7912        16  FILLER OCCURS 15.
  7913            20  FILLER OCCURS 15.
  7914                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7915    12  PD-PRODUCT-DESC              PIC X(80).
  7916    12  PD-TRUNCATED                 PIC X.
  7917    12  FILLER                       PIC X(59).
  7918    12  PD-MAINT-INFORMATION.
  7919        16  PD-LAST-MAINT-DT         PIC X(02).
  7920        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7921        16  PD-LAST-MAINT-BY         PIC X(04).
  7922*                            COPY ELCCRTT.
  7923******************************************************************
  7924*                                                                *
  7925*                            ELCCRTT.                            *
  7926*                                                                *
  7927*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7928*                                                                *
  7929*   FILE TYPE = VSAM,KSDS                                        *
  7930*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7931*                                                                *
  7932*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7933*                                                                *
  7934*   LOG = YES                                                    *
  7935*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7936******************************************************************
  7937*                   C H A N G E   L O G
  7938*
  7939* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7940*-----------------------------------------------------------------
  7941*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7942* EFFECTIVE    NUMBER
  7943*-----------------------------------------------------------------
  7944* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7945* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7946* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7947* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7948* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7949******************************************************************
  7950
  7951 01  CERTIFICATE-TRAILERS.
  7952     12  CS-RECORD-ID                      PIC XX.
  7953         88  VALID-CS-ID                      VALUE 'CS'.
  7954
  7955     12  CS-CONTROL-PRIMARY.
  7956         16  CS-COMPANY-CD                 PIC X.
  7957         16  CS-CARRIER                    PIC X.
  7958         16  CS-GROUPING                   PIC X(6).
  7959         16  CS-STATE                      PIC XX.
  7960         16  CS-ACCOUNT                    PIC X(10).
  7961         16  CS-CERT-EFF-DT                PIC XX.
  7962         16  CS-CERT-NO.
  7963             20  CS-CERT-PRIME             PIC X(10).
  7964             20  CS-CERT-SFX               PIC X.
  7965         16  CS-TRAILER-TYPE               PIC X.
  7966             88  COMM-TRLR           VALUE 'A'.
  7967             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7968             88  CERT-DATA-TRLR      VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 151
* EL156.cbl
  7969
  7970     12  CS-DATA-AREA                      PIC X(516).
  7971
  7972     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7973         16  CS-BANK-COMMISSION-AREA.
  7974             20  CS-BANK-COMMS       OCCURS 10.
  7975                 24  CS-AGT                PIC X(10).
  7976                 24  CS-COM-TYP            PIC X.
  7977                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7978                 24  CS-RECALC-LV-INDIC    PIC X.
  7979                 24  FILLER                PIC X(10).
  7980         16  FILLER                        PIC X(256).
  7981
  7982     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7983****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7984****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7985         16  CS-MB-CLAIM-DATA OCCURS 2.
  7986             20  FILLER OCCURS 10.
  7987                 24  CS-CLAIM-TYPE         PIC X.
  7988                     88  CS-AH-CLM           VALUE 'A'.
  7989                     88  CS-IU-CLM           VALUE 'I'.
  7990                     88  CS-GP-CLM           VALUE 'G'.
  7991                     88  CS-LF-CLM           VALUE 'L'.
  7992                     88  CS-PR-CLM           VALUE 'P'.
  7993                 24  CS-BANK               PIC S999 COMP-3.
  7994                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7995                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7996                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7997         16  FILLER                        PIC X(216).
  7998     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7999         16  CS-VIN-NUMBER                 PIC X(17).
  8000         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8001         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8002         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8003         16  FILLER                        PIC X(496).
  8004******************************************************************
  8005 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8006                          CONTROL-FILE CERTIFICATE-MASTER
  8007                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8008                          ACCOUNT-MASTER CHECK-QUE
  8009                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8010                          DAILY-ACTIVITY-RECORD
  8011                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8012                          CERT-NOTE-FILE PRODUCT-MASTER
  8013                          CERTIFICATE-TRAILERS.
  8014 0000-DFHEXIT SECTION.
  8015     MOVE '9#                    $   ' TO DFHEIV0.
  8016     MOVE 'EL156' TO DFHEIV1.
  8017     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8018
  8019     IF EIBCALEN = 0
  8020         GO TO 8800-UNAUTHORIZED-ACCESS.
  8021
  8022     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8023     MOVE EIBTRMID               TO QID-TERM.
  8024     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8025     MOVE '2'                    TO EMI-SWITCH2.
  8026     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 152
* EL156.cbl
  8027     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8028
  8029     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8030     MOVE '5'                    TO DC-OPTION-CODE.
  8031     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8032     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8033                                    SAVE-BIN-DATE.
  8034     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8035     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8036
  8037     IF SAVE-DATE-YY > 70
  8038         MOVE 19                 TO SAVE-DATE-CC
  8039     ELSE
  8040         MOVE 20                 TO SAVE-DATE-CC.
  8041
  8042     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8043         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8044     END-IF.
  8045
  8046     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8047        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8048     ELSE
  8049        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8050     END-IF
  8051
  8052     IF PI-PRINT-CLM-FRM-YN = 'N'
  8053         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8054     ELSE
  8055         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8056     END-IF
  8057
  8058     IF PI-PRINT-SURVEY-YN = 'N'
  8059         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8060     ELSE
  8061         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8062     END-IF
  8063
  8064     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8065         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8066     ELSE
  8067         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8068     END-IF
  8069
  8070* EXEC CICS HANDLE CONDITION
  8071*        NOTOPEN   (9990-ABEND)
  8072*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8073*        MAPFAIL   (0400-FIRST-TIME)
  8074*        DUPREC    (6180-DUPREC)
  8075*        ERROR     (9990-ABEND)
  8076*    END-EXEC.
  8077*    MOVE '"$JL?%.               ! " #00008065' TO DFHEIV0
  8078     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8080     MOVE X'2220233030303038303635' TO DFHEIV0(25:11)
  8081     CALL 'kxdfhei1' USING DFHEIV0
  8082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8083
  8084
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 153
* EL156.cbl
  8085     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8086         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8087
  8088     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8089         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8090             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8091             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8092             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8093             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8094             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8095             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8096             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8097             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8098             MOVE LOW-VALUES           TO EL156AI
  8099             MOVE 'Y'                  TO FIRST-ENTRY
  8100         ELSE
  8101             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8102             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8103             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8104             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8105             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8106             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8107             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8108             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8109
  8110     IF RETURNED-FROM NOT = SPACES
  8111        IF (RETURNED-FROM = 'EL614')
  8112           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8113           IF WS-SAVED-EOB-CODES NOT = SPACES
  8114              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8115           ELSE
  8116              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8117           END-IF
  8118        END-IF
  8119         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8120            MOVE 'Y'             TO FIRST-ENTRY
  8121            IF RETURNED-FROM = 'EL614'
  8122               AND (PI-PASS-SW NOT = 'C')
  8123               IF WS-SAVED-EOB-CODES NOT = SPACES
  8124                  MOVE WS-SAVED-EOB-CODES
  8125                                 TO PI-PMTNOTE2
  8126                                    WS-PMTNOTE2
  8127                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8128               ELSE
  8129                  MOVE SPACES    TO PI-PMTNOTE2
  8130                                    WS-PMTNOTE2
  8131                                    PI-EOB-CODES-EXIST
  8132               END-IF
  8133            END-IF
  8134            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8135            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8136            IF RETURNED-FROM = 'EL614'
  8137               GO TO 1000-EDIT-DATA
  8138            END-IF
  8139            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8140               (PAYEEI   = LOW-VALUES OR SPACES)
  8141               GO TO 8100-SEND-INITIAL-MAP
  8142            ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 154
* EL156.cbl
  8143               GO TO 1000-EDIT-DATA.
  8144
  8145     IF EIBTRNID NOT = TRANS-ID
  8146         GO TO 0400-FIRST-TIME.
  8147
  8148     IF EIBAID = DFHCLEAR
  8149        IF PI-PASS-SW = 'C'
  8150           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8151           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8152           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8153           MOVE 'Y'            TO RETURNED-FROM-B
  8154           GO TO 1000-EDIT-DATA
  8155        ELSE
  8156           GO TO 9400-CLEAR.
  8157
  8158     IF PI-PASS-SW = 'C'
  8159         MOVE MAP-NAMEB          TO MAP-NAME
  8160         IF EIBAID = DFHPF1 OR DFHPF13
  8161             GO TO 5000-UPDATE
  8162           ELSE
  8163             IF EIBAID NOT = DFHENTER
  8164                 MOVE LOW-VALUES TO EL156BI
  8165                 MOVE MAP-NAMEB  TO MAP-NAME
  8166                 MOVE ER-0029    TO EMI-ERROR
  8167                 MOVE -1         TO  ENTPFBL
  8168                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8169                 GO TO 8200-SEND-DATAONLY.
  8170
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 155
* EL156.cbl
  8172 0200-RECEIVE.
  8173     MOVE LOW-VALUES             TO EL156AI.
  8174     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8175         MOVE ER-0008            TO EMI-ERROR
  8176         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8177         IF PI-PASS-SW = 'C'
  8178             MOVE -1             TO ENTPFBL
  8179             GO TO 8200-SEND-DATAONLY
  8180         ELSE
  8181             MOVE -1             TO PMTTYPEL
  8182             GO TO 8200-SEND-DATAONLY.
  8183
  8184     IF PI-COMPANY-ID = 'DMD'
  8185         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8186
  8187     IF PI-PASS-SW = 'C'
  8188         MOVE MAP-NAMEB          TO MAP-NAME.
  8189
  8190
  8191* EXEC CICS RECEIVE
  8192*        MAP   (MAP-NAME)
  8193*        MAPSET(MAPSET-NAME)
  8194*        ASIS
  8195*        INTO  (EL156AI)
  8196*    END-EXEC.
  8197     MOVE LENGTH OF
  8198      EL156AI
  8199       TO DFHEIV11
  8200*    MOVE '8"TAI  L              ''   #00008178' TO DFHEIV0
  8201     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8202     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8203     MOVE X'2020233030303038313738' TO DFHEIV0(25:11)
  8204     CALL 'kxdfhei1' USING DFHEIV0,
  8205           MAP-NAME,
  8206           EL156AI,
  8207           DFHEIV11,
  8208           MAPSET-NAME,
  8209           DFHEIV99,
  8210           DFHEIV99
  8211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8212
  8213
  8214     IF PI-PASS-SW NOT = 'C'
  8215         GO TO 0250-MAPA.
  8216
  8217     IF ENTPFBL NOT > ZERO
  8218         MOVE MAP-NAMEB          TO MAP-NAME
  8219         MOVE ER-0029            TO EMI-ERROR
  8220         MOVE -1                 TO  ENTPFBL
  8221         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8222         GO TO 8200-SEND-DATAONLY.
  8223
  8224     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8225         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8226       ELSE
  8227         MOVE MAP-NAMEB           TO MAP-NAME
  8228         MOVE ER-0029             TO EMI-ERROR
  8229         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 156
* EL156.cbl
  8230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8231         GO TO 8200-SEND-DATAONLY.
  8232
  8233     IF EIBAID = DFHPF1 OR DFHPF13
  8234         IF MODIFY-CAP
  8235            GO TO 5000-UPDATE
  8236          ELSE
  8237            MOVE 'UPDATE'           TO SM-READ
  8238            PERFORM 9995-SECURITY-VIOLATION
  8239            MOVE MAP-NAMEB          TO MAP-NAME
  8240            MOVE ER-0070            TO EMI-ERROR
  8241            MOVE -1                 TO  ENTPFBL
  8242            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8243            GO TO 8200-SEND-DATAONLY.
  8244
  8245 0250-MAPA.
  8246     IF ENTERPFL = 0
  8247         GO TO 0300-CHECK-PFKEYS.
  8248
  8249     IF EIBAID NOT = DFHENTER
  8250         MOVE ER-0004            TO EMI-ERROR
  8251         GO TO 0320-INPUT-ERROR.
  8252
  8253     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8254         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8255     ELSE
  8256         MOVE ER-0029            TO EMI-ERROR
  8257         GO TO 0320-INPUT-ERROR.
  8258
  8259 0300-CHECK-PFKEYS.
  8260     IF EIBAID = DFHPF7 OR DFHPF8
  8261         GO TO 8820-PF7-8.
  8262
  8263     IF EIBAID = DFHPF23
  8264         GO TO 8810-PF23.
  8265
  8266     IF EIBAID = DFHPF24
  8267         GO TO 9200-RETURN-MAIN-MENU.
  8268
  8269     IF EIBAID = DFHPF12
  8270         GO TO 9500-PF12.
  8271
  8272     IF EIBAID = DFHPF1
  8273        IF PI-PASS-SW = 'A' OR 'B'
  8274          GO TO 0330-BROWSE-FORWARD.
  8275
  8276     IF EIBAID = DFHPF2
  8277        IF PI-PASS-SW = 'A' OR 'B'
  8278          GO TO 0350-BROWSE-BACKWARD.
  8279
  8280     IF EIBAID = DFHPF6
  8281        IF PI-EOB-CODES-EXIST = 'Y'
  8282           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8283        ELSE
  8284           MOVE SPACES              TO WS-PMTNOTE2
  8285        END-IF
  8286         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8287         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 157
* EL156.cbl
  8288            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8289         END-IF
  8290         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8291         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8292             MOVE 'EL614'        TO PGM-NAME
  8293             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8294             GO TO 9300-XCTL
  8295         ELSE
  8296             MOVE XCTL-157       TO PGM-NAME
  8297             GO TO 9300-XCTL.
  8298
  8299     IF EIBAID = DFHPF9
  8300        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8301        MOVE XCTL-141            TO PGM-NAME
  8302        GO TO 9300-XCTL.
  8303
  8304     IF EIBAID = DFHPF10
  8305        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8306        MOVE XCTL-155            TO PGM-NAME
  8307        GO TO 9300-XCTL.
  8308
  8309     MOVE SPACES                 TO ERRMSG0O
  8310                                    ERRMSG1O
  8311                                    ERRMSG2O.
  8312
  8313     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8314         IF PI-PASS-SW NOT = 'B'
  8315             MOVE ER-0422        TO EMI-ERROR
  8316             GO TO 0320-INPUT-ERROR
  8317           ELSE
  8318             GO TO 0700-TEST-FOR-CHANGES.
  8319
  8320     IF EIBAID = DFHPF11
  8321        IF PI-PASS-SW = 'C'
  8322           MOVE ER-0029          TO EMI-ERROR
  8323           GO TO 0320-INPUT-ERROR.
  8324
  8325     IF EIBAID = DFHENTER OR DFHPF11
  8326        NEXT SENTENCE
  8327     ELSE
  8328        MOVE ER-0029             TO EMI-ERROR
  8329        GO TO 0320-INPUT-ERROR.
  8330
  8331     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8332
  8333     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8334         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8335         GO TO 1000-EDIT-DATA
  8336     ELSE
  8337         IF PI-FATAL-COUNT NOT = 0 OR
  8338            PI-FORCE-COUNT NOT = 0
  8339             GO TO 1000-EDIT-DATA
  8340         ELSE
  8341             GO TO 2000-EDIT-DONE.
  8342
  8343 0320-INPUT-ERROR.
  8344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8345
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 158
* EL156.cbl
  8346     IF ENTERPFL = 0
  8347         MOVE -1                 TO PMTTYPEL
  8348     ELSE
  8349         MOVE AL-UNBON           TO ENTERPFA
  8350         MOVE -1                 TO ENTERPFL.
  8351
  8352     GO TO 8200-SEND-DATAONLY.
  8353
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 159
* EL156.cbl
  8355 0330-BROWSE-FORWARD.
  8356
  8357     MOVE CLMNOI            TO PI-CLAIM-NO.
  8358     MOVE CARRI             TO PI-CARRIER.
  8359     MOVE CERTNOI           TO PI-CERT-PRIME.
  8360     MOVE SUFXI             TO PI-CERT-SFX.
  8361
  8362     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8363     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8364     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8365     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8366
  8367     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8368
  8369
  8370* EXEC CICS HANDLE CONDITION
  8371*         NOTFND   (0380-CLAIM-END-FILE)
  8372*         ENDFILE  (0380-CLAIM-END-FILE)
  8373*    END-EXEC.
  8374*    MOVE '"$I''                  ! # #00008340' TO DFHEIV0
  8375     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8376     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8377     MOVE X'2320233030303038333430' TO DFHEIV0(25:11)
  8378     CALL 'kxdfhei1' USING DFHEIV0
  8379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8380
  8381
  8382
  8383* EXEC CICS STARTBR
  8384*         DATASET    ('ELMSTR')
  8385*         RIDFLD     (ELMSTR-KEY)
  8386*         GTEQ
  8387*    END-EXEC.
  8388     MOVE 'ELMSTR' TO DFHEIV1
  8389     MOVE 0
  8390       TO DFHEIV11
  8391*    MOVE '&,         G          &   #00008345' TO DFHEIV0
  8392     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8393     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8394     MOVE X'2020233030303038333435' TO DFHEIV0(25:11)
  8395     CALL 'kxdfhei1' USING DFHEIV0,
  8396           DFHEIV1,
  8397           ELMSTR-KEY,
  8398           DFHEIV99,
  8399           DFHEIV11,
  8400           DFHEIV99
  8401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8402
  8403
  8404     MOVE 'Y' TO WS-BROWSE-START-SW.
  8405
  8406 0335-READNEXT.
  8407
  8408
  8409* EXEC CICS READNEXT
  8410*         DATASET    ('ELMSTR')
  8411*         RIDFLD     (ELMSTR-KEY)
  8412*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 160
* EL156.cbl
  8413*    END-EXEC.
  8414     MOVE 'ELMSTR' TO DFHEIV1
  8415     MOVE 0
  8416       TO DFHEIV11
  8417*    MOVE '&.S                   )   #00008355' TO DFHEIV0
  8418     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8419     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8420     MOVE X'2020233030303038333535' TO DFHEIV0(25:11)
  8421     CALL 'kxdfhei1' USING DFHEIV0,
  8422           DFHEIV1,
  8423           DFHEIV20,
  8424           DFHEIV99,
  8425           ELMSTR-KEY,
  8426           DFHEIV99,
  8427           DFHEIV11,
  8428           DFHEIV99,
  8429           DFHEIV99
  8430     SET ADDRESS OF CLAIM-MASTER TO
  8431         DFHEIV20
  8432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8433
  8434
  8435     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8436        GO TO 0380-CLAIM-END-FILE.
  8437
  8438     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8439        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8440        GO TO 0335-READNEXT.
  8441
  8442     IF PI-COMPANY-ID = 'CRI'
  8443         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8444            GO TO 0380-CLAIM-END-FILE.
  8445
  8446     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8447         GO TO 0335-READNEXT.
  8448
  8449     IF PI-CARRIER-SECURITY > SPACES
  8450         IF CL-CARRIER = PI-CARRIER-SECURITY
  8451             NEXT SENTENCE
  8452         ELSE
  8453             GO TO 0335-READNEXT.
  8454
  8455     IF PI-ACCOUNT-SECURITY > SPACES
  8456         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8457             NEXT SENTENCE
  8458         ELSE
  8459             GO TO 0335-READNEXT.
  8460
  8461     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8462     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8463     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8464
  8465     GO TO 0400-FIRST-TIME.
  8466
  8467 0350-BROWSE-BACKWARD.
  8468
  8469     MOVE CLMNOI            TO PI-CLAIM-NO
  8470                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 161
* EL156.cbl
  8471     MOVE CARRI             TO PI-CARRIER.
  8472     MOVE CERTNOI           TO PI-CERT-PRIME.
  8473     MOVE SUFXI             TO PI-CERT-SFX.
  8474
  8475     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8476
  8477     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8478     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8479     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8480
  8481
  8482* EXEC CICS HANDLE CONDITION
  8483*         NOTFND   (0380-CLAIM-END-FILE)
  8484*         ENDFILE  (0380-CLAIM-END-FILE)
  8485*    END-EXEC.
  8486*    MOVE '"$I''                  ! $ #00008407' TO DFHEIV0
  8487     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8489     MOVE X'2420233030303038343037' TO DFHEIV0(25:11)
  8490     CALL 'kxdfhei1' USING DFHEIV0
  8491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8492
  8493
  8494
  8495* EXEC CICS STARTBR
  8496*         DATASET    ('ELMSTR')
  8497*         RIDFLD     (ELMSTR-KEY)
  8498*         GTEQ
  8499*    END-EXEC.
  8500     MOVE 'ELMSTR' TO DFHEIV1
  8501     MOVE 0
  8502       TO DFHEIV11
  8503*    MOVE '&,         G          &   #00008412' TO DFHEIV0
  8504     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8505     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8506     MOVE X'2020233030303038343132' TO DFHEIV0(25:11)
  8507     CALL 'kxdfhei1' USING DFHEIV0,
  8508           DFHEIV1,
  8509           ELMSTR-KEY,
  8510           DFHEIV99,
  8511           DFHEIV11,
  8512           DFHEIV99
  8513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8514
  8515
  8516     MOVE 'Y' TO WS-BROWSE-START-SW.
  8517
  8518
  8519* EXEC CICS READNEXT
  8520*         DATASET    ('ELMSTR')
  8521*         RIDFLD     (ELMSTR-KEY)
  8522*         SET        (ADDRESS OF CLAIM-MASTER)
  8523*    END-EXEC.
  8524     MOVE 'ELMSTR' TO DFHEIV1
  8525     MOVE 0
  8526       TO DFHEIV11
  8527*    MOVE '&.S                   )   #00008420' TO DFHEIV0
  8528     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 162
* EL156.cbl
  8529     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8530     MOVE X'2020233030303038343230' TO DFHEIV0(25:11)
  8531     CALL 'kxdfhei1' USING DFHEIV0,
  8532           DFHEIV1,
  8533           DFHEIV20,
  8534           DFHEIV99,
  8535           ELMSTR-KEY,
  8536           DFHEIV99,
  8537           DFHEIV11,
  8538           DFHEIV99,
  8539           DFHEIV99
  8540     SET ADDRESS OF CLAIM-MASTER TO
  8541         DFHEIV20
  8542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8543
  8544
  8545
  8546* EXEC CICS READPREV
  8547*         DATASET    ('ELMSTR')
  8548*         RIDFLD     (ELMSTR-KEY)
  8549*         SET        (ADDRESS OF CLAIM-MASTER)
  8550*    END-EXEC.
  8551     MOVE 'ELMSTR' TO DFHEIV1
  8552     MOVE 0
  8553       TO DFHEIV11
  8554*    MOVE '&0S                   )   #00008426' TO DFHEIV0
  8555     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8556     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8557     MOVE X'2020233030303038343236' TO DFHEIV0(25:11)
  8558     CALL 'kxdfhei1' USING DFHEIV0,
  8559           DFHEIV1,
  8560           DFHEIV20,
  8561           DFHEIV99,
  8562           ELMSTR-KEY,
  8563           DFHEIV99,
  8564           DFHEIV11,
  8565           DFHEIV99,
  8566           DFHEIV99
  8567     SET ADDRESS OF CLAIM-MASTER TO
  8568         DFHEIV20
  8569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8570
  8571
  8572 0360-BROWSE-BACKWARD.
  8573
  8574
  8575* EXEC CICS READPREV
  8576*         DATASET    ('ELMSTR')
  8577*         RIDFLD     (ELMSTR-KEY)
  8578*         SET        (ADDRESS OF CLAIM-MASTER)
  8579*    END-EXEC.
  8580     MOVE 'ELMSTR' TO DFHEIV1
  8581     MOVE 0
  8582       TO DFHEIV11
  8583*    MOVE '&0S                   )   #00008434' TO DFHEIV0
  8584     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8585     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8586     MOVE X'2020233030303038343334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 163
* EL156.cbl
  8587     CALL 'kxdfhei1' USING DFHEIV0,
  8588           DFHEIV1,
  8589           DFHEIV20,
  8590           DFHEIV99,
  8591           ELMSTR-KEY,
  8592           DFHEIV99,
  8593           DFHEIV11,
  8594           DFHEIV99,
  8595           DFHEIV99
  8596     SET ADDRESS OF CLAIM-MASTER TO
  8597         DFHEIV20
  8598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8599
  8600
  8601     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8602        GO TO 0380-CLAIM-END-FILE.
  8603
  8604     IF PI-COMPANY-ID = 'CRI'
  8605         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8606            GO TO 0380-CLAIM-END-FILE.
  8607
  8608     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8609         GO TO 0360-BROWSE-BACKWARD.
  8610
  8611     IF PI-CARRIER-SECURITY > SPACES
  8612         IF CL-CARRIER = PI-CARRIER-SECURITY
  8613             NEXT SENTENCE
  8614         ELSE
  8615             GO TO 0360-BROWSE-BACKWARD.
  8616
  8617     IF PI-ACCOUNT-SECURITY > SPACES
  8618         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8619             NEXT SENTENCE
  8620         ELSE
  8621             GO TO 0360-BROWSE-BACKWARD.
  8622
  8623     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8624     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8625     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8626
  8627     GO TO 0400-FIRST-TIME.
  8628
  8629 0380-CLAIM-END-FILE.
  8630
  8631     MOVE ER-0130     TO EMI-ERROR.
  8632     MOVE -1          TO CLMNOL.
  8633     MOVE AL-UABON    TO CARRA
  8634                         CLMNOA
  8635                         CERTNOA
  8636                         SUFXA.
  8637
  8638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8639
  8640     GO TO 8200-SEND-DATAONLY.
  8641
  8642 0400-FIRST-TIME.
  8643
  8644     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 164
* EL156.cbl
  8645        MOVE 'N'         TO WS-BROWSE-START-SW
  8646
  8647* EXEC CICS ENDBR
  8648*            DATASET    ('ELMSTR')
  8649*       END-EXEC.
  8650     MOVE 'ELMSTR' TO DFHEIV1
  8651     MOVE 0
  8652       TO DFHEIV11
  8653*    MOVE '&2                    $   #00008485' TO DFHEIV0
  8654     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8655     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8656     MOVE X'2020233030303038343835' TO DFHEIV0(25:11)
  8657     CALL 'kxdfhei1' USING DFHEIV0,
  8658           DFHEIV1,
  8659           DFHEIV11,
  8660           DFHEIV99
  8661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8662
  8663
  8664     IF PI-PROCESSOR-ID = 'LGXX'
  8665         NEXT SENTENCE
  8666     ELSE
  8667
  8668* EXEC CICS READQ TS
  8669*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8670*            INTO    (SECURITY-CONTROL)
  8671*            LENGTH  (SC-COMM-LENGTH)
  8672*            ITEM    (SC-ITEM)
  8673*        END-EXEC
  8674*    MOVE '*$II   L              ''   #00008492' TO DFHEIV0
  8675     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8676     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8677     MOVE X'2020233030303038343932' TO DFHEIV0(25:11)
  8678     CALL 'kxdfhei1' USING DFHEIV0,
  8679           PI-SECURITY-TEMP-STORE-ID,
  8680           SECURITY-CONTROL,
  8681           SC-COMM-LENGTH,
  8682           SC-ITEM,
  8683           DFHEIV99,
  8684           DFHEIV99
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8686         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8687         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8688
  8689     MOVE LOW-VALUES             TO EL156AI.
  8690     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8691     MOVE 'Y'                    TO FIRST-ENTRY.
  8692     GO TO 7000-SHOW-CLAIM.
  8693
  8694 0500-CREATE-TEMP-STORAGE.
  8695     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8696
  8697
  8698* EXEC CICS WRITEQ TS
  8699*        QUEUE (QID)
  8700*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8701*        LENGTH(PI-COMM-LENGTH)
  8702*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 165
* EL156.cbl
  8703*    MOVE '*"                    ''   #00008509' TO DFHEIV0
  8704     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8706     MOVE X'2020233030303038353039' TO DFHEIV0(25:11)
  8707     CALL 'kxdfhei1' USING DFHEIV0,
  8708           QID,
  8709           PROGRAM-INTERFACE-BLOCK,
  8710           PI-COMM-LENGTH,
  8711           DFHEIV99,
  8712           DFHEIV99,
  8713           DFHEIV99
  8714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8715
  8716
  8717
  8718* EXEC CICS WRITEQ TS
  8719*        QUEUE (QID)
  8720*        FROM  (EL156AI)
  8721*        LENGTH(MAP-LENGTH)
  8722*    END-EXEC.
  8723*    MOVE '*"                    ''   #00008515' TO DFHEIV0
  8724     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8726     MOVE X'2020233030303038353135' TO DFHEIV0(25:11)
  8727     CALL 'kxdfhei1' USING DFHEIV0,
  8728           QID,
  8729           EL156AI,
  8730           MAP-LENGTH,
  8731           DFHEIV99,
  8732           DFHEIV99,
  8733           DFHEIV99
  8734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8735
  8736
  8737 0599-EXIT.
  8738      EXIT.
  8739
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 166
* EL156.cbl
  8741 0600-RECOVER-TEMP-STORAGE.
  8742
  8743* EXEC CICS READQ TS
  8744*        QUEUE (QID)
  8745*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8746*        LENGTH(PI-COMM-LENGTH)
  8747*    END-EXEC.
  8748*    MOVE '*$I    L              ''   #00008526' TO DFHEIV0
  8749     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8751     MOVE X'2020233030303038353236' TO DFHEIV0(25:11)
  8752     CALL 'kxdfhei1' USING DFHEIV0,
  8753           QID,
  8754           PROGRAM-INTERFACE-BLOCK,
  8755           PI-COMM-LENGTH,
  8756           DFHEIV99,
  8757           DFHEIV99,
  8758           DFHEIV99
  8759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8760
  8761
  8762
  8763* EXEC CICS READQ TS
  8764*        QUEUE (QID)
  8765*        INTO  (EL156AI)
  8766*        LENGTH(MAP-LENGTH)
  8767*    END-EXEC.
  8768*    MOVE '*$I    L              ''   #00008532' TO DFHEIV0
  8769     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8771     MOVE X'2020233030303038353332' TO DFHEIV0(25:11)
  8772     CALL 'kxdfhei1' USING DFHEIV0,
  8773           QID,
  8774           EL156AI,
  8775           MAP-LENGTH,
  8776           DFHEIV99,
  8777           DFHEIV99,
  8778           DFHEIV99
  8779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8780
  8781
  8782     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8783
  8784     IF PMTTYPEI NOT = LOW-VALUES
  8785         MOVE AL-UANON           TO PMTTYPEA.
  8786
  8787     IF PAYEEI NOT = LOW-VALUES
  8788         MOVE AL-UANON           TO PAYEEA.
  8789
  8790     IF NOTE1I NOT = LOW-VALUES
  8791         MOVE AL-UANON           TO NOTE1A.
  8792
  8793     IF (RETURNED-FROM = 'EL614')
  8794        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8795     END-IF
  8796*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8797*       AND (PI-EOB-CODES-EXIST = 'Y')
  8798*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 167
* EL156.cbl
  8799*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8800     IF PI-SET-NOTE2-MDT = 'Y'
  8801         MOVE AL-SANON           TO NOTE2A
  8802     END-IF
  8803
  8804     IF OFFLINEI NOT = LOW-VALUES
  8805         MOVE AL-UANON           TO OFFLINEA.
  8806
  8807*    IF GROUPEDI NOT = LOW-VALUES
  8808*        MOVE AL-UANON           TO GROUPEDA.
  8809
  8810*    IF CASHI NOT = LOW-VALUES
  8811*        MOVE AL-UANON           TO CASHA.
  8812
  8813     IF CHECKNOI NOT = LOW-VALUES
  8814         MOVE AL-UANON           TO CHECKNOA.
  8815
  8816     IF HOLDTILI NOT = LOW-VALUES
  8817         MOVE AL-UANON           TO HOLDTILA.
  8818
  8819     IF EPYFROMI NOT = LOW-VALUES
  8820         MOVE AL-UANON           TO EPYFROMA.
  8821
  8822     IF AIGFROMI NOT = LOW-VALUES
  8823         MOVE AL-UANON           TO AIGFROMA.
  8824
  8825     IF EPYTHRUI NOT = LOW-VALUES
  8826         MOVE AL-UANON           TO EPYTHRUA.
  8827
  8828     IF EDAYSI NOT = LOW-VALUES
  8829         MOVE AL-UNNON           TO EDAYSA.
  8830
  8831     IF EPYAMTL NOT = +0
  8832         MOVE AL-UNNON           TO EPYAMTA.
  8833
  8834     IF ERESVL NOT = +0
  8835         MOVE AL-UNNON           TO ERESVA.
  8836
  8837     IF EEXPENSL NOT = +0
  8838         MOVE AL-UNNON           TO EEXPENSA.
  8839
  8840     IF ETYPEI NOT = LOW-VALUES
  8841         MOVE AL-UNNON           TO ETYPEA.
  8842
  8843     IF PROOFDTI NOT = 0
  8844         MOVE AL-UNNON           TO PROOFDTA.
  8845
  8846     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8847        MOVE AL-UANON            TO EOBYNA
  8848     END-IF
  8849     IF CLMFMYNI = 'Y' OR 'N'
  8850        MOVE AL-UANON            TO CLMFMYNA
  8851     END-IF
  8852
  8853     IF SURVYYNI = 'Y' OR 'N'
  8854        IF PI-APPROVAL-LEVEL = '5'
  8855           MOVE AL-UANON         TO SURVYYNA
  8856        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 168
* EL156.cbl
  8857     END-IF
  8858
  8859     IF SPRELYNI = 'Y' OR 'N'
  8860        MOVE AL-UANON            TO SPRELYNA
  8861     END-IF
  8862
  8863     .
  8864 0699-EXIT.
  8865      EXIT.
  8866
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 169
* EL156.cbl
  8868 0700-TEST-FOR-CHANGES.
  8869     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8870         MOVE ER-0433            TO EMI-ERROR
  8871         GO TO 0750-FUNCTION-ERROR.
  8872
  8873     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8874
  8875     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8876         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8877         MOVE 'A'                TO PI-PASS-SW
  8878         GO TO 1000-EDIT-DATA.
  8879
  8880     IF PI-FATAL-COUNT NOT = 0
  8881         MOVE ER-0499            TO EMI-ERROR
  8882         GO TO 0750-FUNCTION-ERROR.
  8883
  8884     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8885         MOVE ER-0500            TO EMI-ERROR
  8886         GO TO 0750-FUNCTION-ERROR.
  8887
  8888     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8889        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8890           MOVE ER-0542          TO EMI-ERROR
  8891           MOVE -1               TO EPYAMTL
  8892           GO TO 0750-FUNCTION-ERROR.
  8893
  8894     IF PI-OFFLINE = 'Y'  OR
  8895        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8896        MOVE EIBAID              TO PI-PFKEY-USED
  8897        GO TO 5000-UPDATE.
  8898
  8899     GO TO 6000-BUILD-SCREEN-B.
  8900
  8901 0750-FUNCTION-ERROR.
  8902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8903
  8904     IF ENTERPFL > 0
  8905         MOVE -1                 TO ENTERPFL
  8906         MOVE AL-UNBON           TO ENTERPFA
  8907         GO TO 8200-SEND-DATAONLY
  8908     ELSE
  8909         MOVE -1                 TO ENTERPFL
  8910         MOVE AL-UNNOF           TO ENTERPFA
  8911         GO TO 8200-SEND-DATAONLY.
  8912
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 170
* EL156.cbl
  8914 0800-DELETE-TS.
  8915
  8916* EXEC CICS HANDLE CONDITION
  8917*        QIDERR(0800-EXIT)
  8918*    END-EXEC.
  8919*    MOVE '"$N                   ! % #00008671' TO DFHEIV0
  8920     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8922     MOVE X'2520233030303038363731' TO DFHEIV0(25:11)
  8923     CALL 'kxdfhei1' USING DFHEIV0
  8924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8925
  8926
  8927
  8928* EXEC CICS DELETEQ TS
  8929*        QUEUE(QID)
  8930*    END-EXEC.
  8931*    MOVE '*&                    #   #00008675' TO DFHEIV0
  8932     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8933     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8934     MOVE X'2020233030303038363735' TO DFHEIV0(25:11)
  8935     CALL 'kxdfhei1' USING DFHEIV0,
  8936           QID,
  8937           DFHEIV99
  8938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8939
  8940
  8941 0800-EXIT.
  8942      EXIT.
  8943 0900-GET-DDF-FACTORS.
  8944
  8945     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8946     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8947     MOVE CL-CERT-STATE          TO ERPDEF-STATE
  8948     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8949     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8950     MOVE PI-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8951     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8952
  8953     DISPLAY ' MADE 0900 ' ERPDEF-KEY (2:15)
  8954     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8955
  8956
  8957* EXEC CICS STARTBR
  8958*        DATASET  ('ERPDEF')
  8959*        RIDFLD   (ERPDEF-KEY)
  8960*        GTEQ
  8961*        RESP     (WS-RESPONSE)
  8962*    END-EXEC
  8963     MOVE 'ERPDEF' TO DFHEIV1
  8964     MOVE 0
  8965       TO DFHEIV11
  8966*    MOVE '&,         G          &  N#00008694' TO DFHEIV0
  8967     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8968     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8969     MOVE X'204E233030303038363934' TO DFHEIV0(25:11)
  8970     CALL 'kxdfhei1' USING DFHEIV0,
  8971           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 171
* EL156.cbl
  8972           ERPDEF-KEY,
  8973           DFHEIV99,
  8974           DFHEIV11,
  8975           DFHEIV99
  8976     MOVE EIBRESP  TO WS-RESPONSE
  8977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8978
  8979     IF NOT WS-RESP-NORMAL
  8980        GO TO 0900-EXIT
  8981     END-IF
  8982
  8983     .
  8984 0900-READNEXT.
  8985
  8986
  8987* EXEC CICS READNEXT
  8988*       DATASET  ('ERPDEF')
  8989*       SET      (ADDRESS OF PRODUCT-MASTER)
  8990*       RIDFLD   (ERPDEF-KEY)
  8991*       RESP     (WS-RESPONSE)
  8992*    END-EXEC
  8993     MOVE 'ERPDEF' TO DFHEIV1
  8994     MOVE 0
  8995       TO DFHEIV11
  8996*    MOVE '&.S                   )  N#00008708' TO DFHEIV0
  8997     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8998     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8999     MOVE X'204E233030303038373038' TO DFHEIV0(25:11)
  9000     CALL 'kxdfhei1' USING DFHEIV0,
  9001           DFHEIV1,
  9002           DFHEIV20,
  9003           DFHEIV99,
  9004           ERPDEF-KEY,
  9005           DFHEIV99,
  9006           DFHEIV11,
  9007           DFHEIV99,
  9008           DFHEIV99
  9009     SET ADDRESS OF PRODUCT-MASTER TO
  9010         DFHEIV20
  9011     MOVE EIBRESP  TO WS-RESPONSE
  9012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9013
  9014     IF NOT WS-RESP-NORMAL
  9015        GO TO 0900-ENDBR
  9016     END-IF
  9017
  9018     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9019        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9020           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9021        ELSE
  9022           GO TO 0900-READNEXT
  9023        END-IF
  9024     ELSE
  9025        GO TO 0900-ENDBR
  9026     END-IF
  9027
  9028     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9029        (P1 > +8)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 172
* EL156.cbl
  9030        OR (PD-PROD-CODE (P1) = 'I')
  9031     END-PERFORM
  9032     IF P1 < +9
  9033        SET DD-IU-PRESENT        TO TRUE
  9034     END-IF
  9035
  9036     IF CM-LOAN-TERM = ZEROS
  9037        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9038     END-IF
  9039
  9040     .
  9041 0900-ENDBR.
  9042
  9043
  9044* EXEC CICS ENDBR
  9045*       DATASET  ('ERPDEF')
  9046*    END-EXEC
  9047     MOVE 'ERPDEF' TO DFHEIV1
  9048     MOVE 0
  9049       TO DFHEIV11
  9050*    MOVE '&2                    $   #00008744' TO DFHEIV0
  9051     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9053     MOVE X'2020233030303038373434' TO DFHEIV0(25:11)
  9054     CALL 'kxdfhei1' USING DFHEIV0,
  9055           DFHEIV1,
  9056           DFHEIV11,
  9057           DFHEIV99
  9058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9059
  9060     .
  9061 0900-EXIT.
  9062     EXIT.
  9063 1000-EDIT-DATA.
  9064
  9065     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9066         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9067         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9068
  9069     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9070
  9071     IF NOT MODIFY-CAP
  9072         MOVE ER-0070            TO EMI-ERROR
  9073         MOVE -1                 TO PMTTYPEL
  9074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9075         GO TO 2000-EDIT-DONE.
  9076
  9077     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9078                         '5' AND '6'
  9079         MOVE ER-0420            TO EMI-ERROR
  9080         MOVE -1                 TO PMTTYPEL
  9081         MOVE AL-UABON           TO PMTTYPEA
  9082         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9083     ELSE
  9084         MOVE AL-UANON           TO PMTTYPEA.
  9085
  9086*    IF PI-OFFLINE = 'Y'
  9087*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 173
* EL156.cbl
  9088*          MOVE ER-1880         TO EMI-ERROR
  9089*          MOVE -1              TO GROUPEDL
  9090*          MOVE AL-UABON        TO GROUPEDA
  9091*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9092*
  9093*    IF GROUPEDL > +0
  9094*       IF PI-GROUPED = 'Y' OR 'N'
  9095*          MOVE AL-UANON TO GROUPEDA
  9096*       ELSE
  9097*          MOVE ER-3140            TO EMI-ERROR
  9098*          MOVE -1                 TO GROUPEDL
  9099*          MOVE AL-UABON           TO GROUPEDA
  9100*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9101*
  9102*    IF CASHL > +0
  9103*       IF PI-CASH = 'Y' OR 'N'
  9104*          MOVE AL-UANON           TO CASHA
  9105*       ELSE
  9106*          MOVE ER-3141            TO EMI-ERROR
  9107*          MOVE -1                 TO CASHL
  9108*          MOVE AL-UABON           TO CASHA
  9109*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9110
  9111     IF LOANNOL > +0
  9112         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9113
  9114 1000-EDIT-PAYEE.
  9115
  9116     IF PI-PAYEE-SEQ NOT NUMERIC
  9117         MOVE ER-0294            TO  EMI-ERROR
  9118         MOVE -1                 TO  PAYEEL
  9119         MOVE AL-UABON           TO  PAYEEA
  9120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9121         GO TO 1000-CONT-EDIT.
  9122
  9123     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9124                         'E' OR 'O' OR 'Q'
  9125         NEXT SENTENCE
  9126     ELSE
  9127         MOVE ER-0294            TO  EMI-ERROR
  9128         MOVE -1                 TO  PAYEEL
  9129         MOVE AL-UABON           TO  PAYEEA
  9130         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9131         GO TO 1000-CONT-EDIT.
  9132
  9133     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9134        (PI-PAYEE-SEQ NOT < '1' AND
  9135         PI-PAYEE-SEQ NOT > '9'))
  9136      OR
  9137        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9138         (PI-PAYEE-SEQ NOT > '9'))
  9139         MOVE AL-UANON            TO PAYEEA
  9140     ELSE
  9141         MOVE ER-0294            TO EMI-ERROR
  9142         MOVE -1                 TO PAYEEL
  9143         MOVE AL-UABON           TO PAYEEA
  9144         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9145
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 174
* EL156.cbl
  9146     IF PI-COMPANY-ID = 'DMD'
  9147         IF PI-PAYEE-TYPE = 'B' AND
  9148            PI-PAYEE-SEQ NOT = '0'
  9149               MOVE ER-7841            TO EMI-ERROR
  9150               MOVE -1                 TO PAYEEL
  9151               MOVE AL-UABON           TO PAYEEA
  9152               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9153
  9154     IF PI-COMPANY-ID = 'JHL'
  9155         IF PI-PAYEE = 'B0'
  9156             NEXT SENTENCE
  9157           ELSE
  9158
  9159* EXEC CICS HANDLE CONDITION
  9160*            ENDFILE(1950-NOT-FOUND)
  9161*            NOTFND (1950-NOT-FOUND)
  9162*        END-EXEC
  9163*    MOVE '"$''I                  ! & #00008846' TO DFHEIV0
  9164     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9166     MOVE X'2620233030303038383436' TO DFHEIV0(25:11)
  9167     CALL 'kxdfhei1' USING DFHEIV0
  9168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9169         MOVE 'N'                    TO FOUND-TOL-SW
  9170         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9171         MOVE '2'                    TO CNTL-REC-TYPE
  9172         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9173         MOVE +0                     TO CNTL-SEQ-NO
  9174         MOVE 'PROC'                 TO FILE-SWITCH
  9175         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9176         IF PI-PAYEE = 'I1' AND
  9177            APPROVAL-LEVEL-2
  9178             NEXT SENTENCE
  9179           ELSE
  9180         IF NOT PI-USER-ALMIGHTY-YES
  9181             MOVE ER-3546        TO EMI-ERROR
  9182             MOVE -1             TO PAYEEL
  9183             MOVE AL-UABON       TO PAYEEA
  9184             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9185
  9186     IF PI-PAYEE-TYPE = 'E'
  9187        IF PI-PMTTYPE = '5' OR '6'
  9188            NEXT SENTENCE
  9189        ELSE
  9190            MOVE ER-3539            TO EMI-ERROR
  9191            MOVE -1                 TO PAYEEL
  9192            MOVE AL-UABON           TO PAYEEA
  9193            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9194
  9195 1000-CONT-EDIT.
  9196
  9197     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9198        IF PI-EPYAMT NOT NEGATIVE
  9199            MOVE ER-0421         TO EMI-ERROR
  9200            MOVE -1              TO OFFLINEL
  9201            MOVE AL-UABON        TO OFFLINEA
  9202            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9203        ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 175
* EL156.cbl
  9204            MOVE AL-UANON        TO OFFLINEA.
  9205
  9206     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9207        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9208           CONTINUE
  9209        ELSE
  9210        IF PI-PRINT-EOB-YN = 'S' AND
  9211           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9212             CONTINUE
  9213        ELSE
  9214           MOVE ER-1561          TO EMI-ERROR
  9215           MOVE -1               TO EOBYNL
  9216           MOVE AL-UABON         TO EOBYNA
  9217           PERFORM 9900-ERROR-FORMAT
  9218                                 THRU 9900-EXIT
  9219        END-IF
  9220        END-IF
  9221
  9222        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9223            MOVE ER-1566        TO EMI-ERROR
  9224            MOVE -1             TO CLMFMYNL
  9225            MOVE AL-UABON       TO CLMFMYNA
  9226            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9227        END-IF
  9228
  9229        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9230            MOVE ER-1567        TO EMI-ERROR
  9231            MOVE -1             TO SURVYYNL
  9232            MOVE AL-UABON       TO SURVYYNA
  9233            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9234        END-IF
  9235
  9236        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9237            MOVE ER-1569        TO EMI-ERROR
  9238            MOVE -1             TO SPRELYNL
  9239            MOVE AL-UABON       TO SPRELYNA
  9240            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9241        END-IF
  9242
  9243     END-IF
  9244     IF PI-EPYAMT IS NEGATIVE
  9245         IF PI-OFFLINE NOT = 'Y'
  9246             MOVE ER-0836        TO  EMI-ERROR
  9247             MOVE -1             TO  OFFLINEL
  9248             MOVE AL-UABON       TO  OFFLINEA
  9249             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9250
  9251     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9252        MOVE ER-0872             TO EMI-ERROR
  9253        MOVE -1                  TO PROOFDTL
  9254        MOVE AL-UABON            TO PROOFDTA
  9255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9256     ELSE
  9257        MOVE '4'                TO DC-OPTION-CODE
  9258        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9259        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9260        IF DATE-CONVERSION-ERROR
  9261            MOVE ER-0873        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 176
* EL156.cbl
  9262            MOVE -1                  TO PROOFDTL
  9263            MOVE AL-UABON            TO PROOFDTA
  9264            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9265        ELSE
  9266            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9267            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9268                MOVE ER-0873    TO EMI-ERROR
  9269                MOVE -1                  TO PROOFDTL
  9270                MOVE AL-UABON            TO PROOFDTA
  9271                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9272            END-IF
  9273        END-IF
  9274     END-IF.
  9275
  9276     IF PI-COMPANY-ID = 'DMD'
  9277        IF NOTE1L NOT = ZEROS
  9278            MOVE ER-7844        TO  EMI-ERROR
  9279            MOVE -1             TO  NOTE1L
  9280            MOVE AL-UABON       TO  NOTE1A
  9281            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9282
  9283     IF PI-COMPANY-ID = 'DMD'
  9284        IF NOTE2L NOT = ZEROS
  9285          GO TO 1004-DMD-EOB-CHECKS.
  9286
  9287     IF NOTE1L NOT > +0
  9288         GO TO 1005-CHECK-ERRORS.
  9289
  9290     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9291         GO TO 1005-CHECK-ERRORS.
  9292
  9293     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9294         GO TO 1003-HAN-PMT-NOTES.
  9295
  9296     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9297
  9298     IF WS-PMTOPTION NUMERIC
  9299        IF WS-PMTOPTION > '00' AND < '17'
  9300           NEXT SENTENCE
  9301        ELSE
  9302           MOVE ER-0618          TO EMI-ERROR
  9303           MOVE -1               TO NOTE1L
  9304           MOVE AL-UABON         TO NOTE1A
  9305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9306     ELSE
  9307        GO TO 1005-CHECK-ERRORS.
  9308
  9309     IF WS-PMTOPTION = '05' AND
  9310        WS-DOCNAME = SPACES
  9311          MOVE ER-0616             TO EMI-ERROR
  9312          MOVE -1                  TO NOTE1L
  9313          MOVE AL-UABON            TO NOTE1A
  9314          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9315
  9316     IF WS-PMTOPTION = '15' OR '16'
  9317
  9318* EXEC CICS BIF DEEDIT
  9319*            FIELD (WS-AMOUNT)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 177
* EL156.cbl
  9320*            LENGTH(08)
  9321*        END-EXEC
  9322     MOVE 08
  9323       TO DFHEIV11
  9324*    MOVE '@"L                   #   #00008998' TO DFHEIV0
  9325     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9326     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9327     MOVE X'2020233030303038393938' TO DFHEIV0(25:11)
  9328     CALL 'kxdfhei1' USING DFHEIV0,
  9329           WS-AMOUNT,
  9330           DFHEIV11
  9331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9332        IF (WS-NUM-AMT = ZEROS) OR
  9333           (WS-AMOUNT NOT NUMERIC)
  9334           MOVE ER-0617          TO EMI-ERROR
  9335           MOVE -1               TO NOTE1L
  9336           MOVE AL-UABON         TO NOTE1A
  9337           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338
  9339     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9340
  9341     GO TO 1005-CHECK-ERRORS.
  9342
  9343 1003-HAN-PMT-NOTES.
  9344
  9345     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9346
  9347     IF WS-HAN-PMT-CODE = SPACE
  9348         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9349     ELSE
  9350     IF WS-HAN-PMT-CODE = 'A'
  9351         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9352                                 TO WS-HAN-PMT-NOTE
  9353     ELSE
  9354     IF WS-HAN-PMT-CODE = 'B'
  9355         MOVE ':FINAL PAYMENT / DECEASED'
  9356                                 TO WS-HAN-PMT-NOTE
  9357     ELSE
  9358     IF WS-HAN-PMT-CODE = 'C'
  9359         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9360                                 TO WS-HAN-PMT-NOTE
  9361     ELSE
  9362     IF WS-HAN-PMT-CODE = 'D'
  9363         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9364                                 TO WS-HAN-PMT-NOTE
  9365     ELSE
  9366     IF WS-HAN-PMT-CODE = 'E'
  9367         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9368                                 TO WS-HAN-PMT-NOTE
  9369     ELSE
  9370     IF WS-HAN-PMT-CODE = 'F'
  9371         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9372                                 TO WS-HAN-PMT-NOTE
  9373     ELSE
  9374     IF WS-HAN-PMT-CODE = 'P'
  9375         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9376
  9377     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 178
* EL156.cbl
  9378     GO TO 1005-CHECK-ERRORS.
  9379
  9380 1004-DMD-EOB-CHECKS.
  9381
  9382     INITIALIZE PI-AT-EOB-CODES.
  9383
  9384     IF NOTE2I (20:21) > SPACES
  9385         MOVE ER-7845          TO EMI-ERROR
  9386         MOVE -1               TO NOTE2L
  9387         MOVE AL-UABON         TO NOTE2A
  9388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9389         GO TO 1005-CHECK-ERRORS
  9390      ELSE
  9391         MOVE NOTE2I             TO W-EOB-CODES.
  9392
  9393     MOVE +1                     TO W-EOB-NDX.
  9394
  9395 1004-CHECK-EACH-EOB.
  9396
  9397     IF W-EOB-NDX > +5
  9398             OR
  9399        W-EOB-CODE (W-EOB-NDX) = SPACES
  9400         GO TO 1004-CHECK-DUP-EOB.
  9401
  9402     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9403         MOVE ER-0956            TO EMI-ERROR
  9404         MOVE -1                 TO NOTE2L
  9405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9406         GO TO 1005-CHECK-ERRORS.
  9407
  9408     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9409     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9410     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9411     MOVE 'DLO023'               TO PGM-NAME.
  9412
  9413
  9414* EXEC CICS LINK
  9415*        PROGRAM    (PGM-NAME)
  9416*        COMMAREA   (CD-COMMUNICATION-AREA)
  9417*        LENGTH     (CD-RCRD-LENGTH)
  9418*    END-EXEC.
  9419*    MOVE '."C                   (   #00009083' TO DFHEIV0
  9420     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9421     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9422     MOVE X'2020233030303039303833' TO DFHEIV0(25:11)
  9423     CALL 'kxdfhei1' USING DFHEIV0,
  9424           PGM-NAME,
  9425           CD-COMMUNICATION-AREA,
  9426           CD-RCRD-LENGTH,
  9427           DFHEIV99,
  9428           DFHEIV99,
  9429           DFHEIV99,
  9430           DFHEIV99
  9431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9432
  9433
  9434     IF CD-RETURN-CODE = 'OK'
  9435         GO TO 1004-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 179
* EL156.cbl
  9436
  9437     MOVE -1                     TO NOTE2L.
  9438
  9439     IF CD-RETURN-CODE = '01'
  9440         MOVE ER-8310            TO EMI-ERROR
  9441         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9442         GO TO 1005-CHECK-ERRORS.
  9443
  9444     IF CD-RETURN-CODE = '02'
  9445         MOVE ER-8311            TO EMI-ERROR
  9446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9447         GO TO 1005-CHECK-ERRORS.
  9448
  9449     IF CD-RETURN-CODE = '03'
  9450         MOVE ER-8312            TO EMI-ERROR
  9451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9452         GO TO 1005-CHECK-ERRORS.
  9453
  9454     IF CD-RETURN-CODE = '04'
  9455         MOVE ER-8313            TO EMI-ERROR
  9456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9457         GO TO 1005-CHECK-ERRORS.
  9458
  9459     IF CD-RETURN-CODE = '05'
  9460         MOVE ER-8314            TO EMI-ERROR
  9461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9462         GO TO 1005-CHECK-ERRORS.
  9463
  9464     IF CD-RETURN-CODE = '06'
  9465         MOVE ER-8315            TO EMI-ERROR
  9466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9467         GO TO 1005-CHECK-ERRORS.
  9468
  9469     IF CD-RETURN-CODE = 'E1'
  9470         MOVE ER-8316            TO EMI-ERROR
  9471         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9472         GO TO 1005-CHECK-ERRORS.
  9473
  9474     IF CD-RETURN-CODE = 'N1'
  9475         MOVE ER-8317            TO EMI-ERROR
  9476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9477         GO TO 1005-CHECK-ERRORS.
  9478
  9479 1004-CONT.
  9480     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9481
  9482     ADD +1 TO W-EOB-NDX.
  9483     GO TO 1004-CHECK-EACH-EOB.
  9484
  9485 1004-CHECK-DUP-EOB.
  9486     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9487         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9488                               PI-AT-EOB-CODE (3) OR
  9489                               PI-AT-EOB-CODE (4) OR
  9490                               PI-AT-EOB-CODE (5)))
  9491                  OR
  9492        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9493         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 180
* EL156.cbl
  9494                               PI-AT-EOB-CODE (4) OR
  9495                               PI-AT-EOB-CODE (5)))
  9496                  OR
  9497        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9498         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9499                               PI-AT-EOB-CODE (5)))
  9500                  OR
  9501        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9502         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9503            MOVE ER-8000            TO EMI-ERROR
  9504            MOVE AL-UABON           TO NOTE2A
  9505            MOVE -1                 TO NOTE2L
  9506            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9507            GO TO 1005-CHECK-ERRORS.
  9508
  9509 1005-CHECK-ERRORS.
  9510*    IF PI-COMPANY-ID NOT = 'DMD'
  9511        GO TO 1006-CHECK-ERRORS.
  9512
  9513*********  DMD CODE START ******************
  9514*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9515*       GO TO 1006-CHECK-ERRORS.
  9516*
  9517*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9518*
  9519*    COMPUTE W-PAYMENT-TOTAL
  9520*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9521*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9522*               AND
  9523*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9524*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9525*          MOVE ER-0967    TO EMI-ERROR
  9526*          MOVE -1         TO PMTTYPEL
  9527*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9528*
  9529*    GO TO 1006-CHECK-ERRORS.
  9530*********  DMD CODE END ******************
  9531
  9532 1006-CHECK-ERRORS.
  9533     IF NOT EMI-NO-ERRORS
  9534        GO TO 2000-EDIT-DONE.
  9535
  9536
  9537* EXEC CICS HANDLE CONDITION
  9538*        NOTFND(1950-NOT-FOUND)
  9539*    END-EXEC.
  9540*    MOVE '"$I                   ! '' #00009191' TO DFHEIV0
  9541     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9543     MOVE X'2720233030303039313931' TO DFHEIV0(25:11)
  9544     CALL 'kxdfhei1' USING DFHEIV0
  9545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9546
  9547
  9548     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9549     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9550     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9551     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 181
* EL156.cbl
  9552     MOVE 'MSTR'                 TO FILE-SWITCH.
  9553
  9554     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9555
  9556     IF PI-COMPANY-ID = 'DMD'
  9557         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9558
  9559     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9560        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9561           MOVE ER-0873    TO EMI-ERROR
  9562           MOVE -1                  TO PROOFDTL
  9563           MOVE AL-UABON            TO PROOFDTA
  9564           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9565        END-IF
  9566     END-IF
  9567     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9568     MOVE +95                    TO TRLR-SEQ-NO
  9569
  9570* EXEC CICS READ
  9571*       DATASET  ('ELTRLR')
  9572*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9573*       RIDFLD   (ELTRLR-KEY)
  9574*       RESP     (WS-RESPONSE)
  9575*    END-EXEC
  9576     MOVE 'ELTRLR' TO DFHEIV1
  9577*    MOVE '&"S        E          (  N#00009216' TO DFHEIV0
  9578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9580     MOVE X'204E233030303039323136' TO DFHEIV0(25:11)
  9581     CALL 'kxdfhei1' USING DFHEIV0,
  9582           DFHEIV1,
  9583           DFHEIV20,
  9584           DFHEIV99,
  9585           ELTRLR-KEY,
  9586           DFHEIV99,
  9587           DFHEIV99,
  9588           DFHEIV99
  9589     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9590         DFHEIV20
  9591     MOVE EIBRESP  TO WS-RESPONSE
  9592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9593
  9594     if ws-resp-normal
  9595        perform varying s1 from +1 by +1 until
  9596           at-note-error-no (s1) = spaces
  9597           if at-note-error-no (s1) = '1662'
  9598              continue
  9599           else
  9600              move at-note-error-no (s1)
  9601                                 to emi-error
  9602              if at-note-error-no (s1) = '1653'
  9603                 evaluate true
  9604                    when cl-claim-type = 'L'
  9605                       move '  LF  '
  9606                                 to emi-claim-type
  9607                    when cl-claim-type = 'I'
  9608                       move '  IU  '
  9609                                 to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 182
* EL156.cbl
  9610                    when other
  9611                       move '  AH  '
  9612                                 to emi-claim-type
  9613                 end-evaluate
  9614              end-if
  9615              PERFORM 9900-ERROR-FORMAT
  9616                                 THRU 9900-EXIT
  9617           end-if
  9618        end-perform
  9619     end-if
  9620     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9621         IF PI-PMTTYPE = '5' OR '6'
  9622             NEXT SENTENCE
  9623         ELSE
  9624             MOVE ER-0555             TO EMI-ERROR
  9625             MOVE -1                  TO PMTTYPEL
  9626             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9627
  9628     IF CL-LAST-CLOSE-REASON = '2'
  9629         IF CL-CLAIM-STATUS = 'C'
  9630             MOVE ER-0760        TO  EMI-ERROR
  9631             MOVE -1             TO  PMTTYPEL
  9632             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9633
  9634     IF PI-ACTIVITY-CODE = 9
  9635         MOVE ER-3538            TO  EMI-ERROR
  9636         MOVE -1                 TO  PMTTYPEL
  9637         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9638
  9639     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9640         GO TO 1008-READ-CERT.
  9641**********************AIG LOGIC STARTS *********************
  9642     IF CL-CERT-PRIME = 'INCOMPLETE'
  9643         MOVE ER-3540            TO  EMI-ERROR
  9644         MOVE -1                 TO  PMTTYPEL
  9645         MOVE AL-UABON           TO  PMTTYPEA
  9646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9647         GO TO 2000-EDIT-DONE.
  9648
  9649     IF PI-PMTTYPE = '4'
  9650         IF PI-EPYAMT IS NEGATIVE
  9651             IF PI-ECHECKNO-CR = 'CR'
  9652                 NEXT SENTENCE
  9653             ELSE
  9654                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9655
  9656     IF PI-PMTTYPE = '4'
  9657         IF PI-ECHECKNO-CR = 'CR'
  9658             IF PI-EPYAMT IS NEGATIVE
  9659                 NEXT SENTENCE
  9660             ELSE
  9661                 MOVE ER-0834    TO  EMI-ERROR
  9662                 MOVE -1         TO  EPYAMTL
  9663                 MOVE AL-UNBON   TO  EPYAMTA
  9664                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9665
  9666     IF PI-PMTTYPE = '4'
  9667         IF PI-EPYAMT IS NEGATIVE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 183
* EL156.cbl
  9668             IF PI-OFFLINE = 'Y'
  9669                 NEXT SENTENCE
  9670             ELSE
  9671                 MOVE 'Y'        TO  PI-OFFLINE
  9672                                     WS-OFFLINE
  9673                                     OFFLINEO
  9674                 MOVE AL-UANON   TO  OFFLINEA.
  9675
  9676*    IF PI-PMTTYPE = '4'
  9677*        IF PI-EPYAMT IS NEGATIVE
  9678*            IF PI-CASH = 'Y'
  9679*                NEXT SENTENCE
  9680*            ELSE
  9681*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9682*                MOVE AL-UANON   TO  CASHA
  9683*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9684*
  9685*    IF PI-CASH NOT = 'Y' AND 'N'
  9686*         IF PI-OFFLINE = 'Y'  AND
  9687*            PI-ECHECKNO-CR = 'CR'
  9688*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9689*              MOVE AL-UANON     TO  CASHA
  9690*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9691*
  9692*    IF PI-CASH NOT = 'Y' AND 'N'
  9693*        IF PI-PMTTYPE = '5' OR '6'
  9694*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9695*            MOVE AL-UANON       TO  CASHA
  9696*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9697*
  9698*    IF PI-CASH NOT = 'Y' AND 'N'
  9699*       IF CL-ASSOCIATES = 'N' OR 'A'
  9700*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9701*           MOVE AL-UANON        TO  CASHA
  9702*       ELSE
  9703*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9704*           MOVE AL-UANON        TO  CASHA.
  9705*
  9706*    IF PI-PMTTYPE = '5' OR '6'
  9707*        IF PI-CASH = 'N'
  9708*            MOVE ER-0819        TO  EMI-ERROR
  9709*            MOVE AL-UANON       TO  CASHA
  9710*            MOVE -1             TO  CASHL
  9711*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9712*
  9713*    IF CL-ASSOCIATES = 'N' OR 'A'
  9714*       IF CASHI = 'N'
  9715*        MOVE ER-3537            TO  EMI-ERROR
  9716*        MOVE AL-UANON           TO  CASHA
  9717*        MOVE -1                 TO  CASHL
  9718*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9719
  9720 1007-DEFAULT-AIG-CHECKNO.
  9721
  9722     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9723         MOVE ER-3532            TO  EMI-ERROR
  9724         MOVE -1                 TO  PMTTYPEL
  9725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 184
* EL156.cbl
  9726**********************AIG LOGIC ENDS ***********************
  9727
  9728 1008-READ-CERT.
  9729
  9730     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9731     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9732     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9733     MOVE CL-CERT-STATE          TO CERT-STATE.
  9734     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9735     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9736     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9737     MOVE 'CERT'                 TO FILE-SWITCH.
  9738
  9739     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9740
  9741     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9742         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9743     ELSE
  9744         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9745
  9746*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9747*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9748
  9749     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9750         MOVE ER-0458            TO EMI-ERROR
  9751         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9752
  9753     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9754         MOVE ER-0459            TO EMI-ERROR
  9755         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9756
  9757     IF CL-REPORTED-DT = LOW-VALUES
  9758        MOVE ER-0530             TO EMI-ERROR
  9759        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9760
  9761     IF PI-COMPANY-ID = 'NCL'
  9762        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9763            MOVE ER-0770            TO EMI-ERROR
  9764            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9765
  9766     IF PI-COMPANY-ID = 'NCL'
  9767        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9768            MOVE ER-0737            TO EMI-ERROR
  9769            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9770
  9771     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9772         MOVE ER-0768            TO  EMI-ERROR
  9773         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9774
  9775     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9776         MOVE ER-0769            TO  EMI-ERROR
  9777         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9778
  9779     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9780         GO TO 1020-DO-LIFE-EDITS
  9781     ELSE
  9782         GO TO 1030-DO-AH-EDITS.
  9783
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 185
* EL156.cbl
  9784 1010-GENERAL-ERROR.
  9785     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9786
  9787     IF EMI-MESSAGE-FORMATTED
  9788         MOVE -1                 TO PMTTYPEL.
  9789
  9790 1010-EXIT.
  9791     EXIT.
  9792
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 186
* EL156.cbl
  9794 1020-DO-LIFE-EDITS.
  9795     IF CM-LF-BENEFIT-CD = '00'
  9796         IF PI-PMTTYPE = '5' OR '6'
  9797             MOVE ER-0658        TO EMI-ERROR
  9798             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9799         ELSE
  9800             MOVE ER-1775        TO EMI-ERROR
  9801             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9802
  9803     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9804     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9805         MOVE ER-0460            TO EMI-ERROR
  9806         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9807
  9808     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9809     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9810     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9811     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9812     MOVE '4'                    TO  CNTL-REC-TYPE.
  9813     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9814     MOVE 'BENE'                 TO  FILE-SWITCH.
  9815     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9816     IF NO-BENEFIT-FOUND
  9817         GO TO 1950-NOT-FOUND.
  9818
  9819     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9820
  9821     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9822         IF PI-PMTTYPE = '4'
  9823             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9824                PI-LF-COVERAGE-TYPE = 'P'
  9825                 NEXT SENTENCE
  9826             ELSE
  9827                 MOVE ER-0461        TO EMI-ERROR
  9828                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9829         ELSE
  9830            NEXT SENTENCE
  9831     ELSE
  9832         IF PI-PMTTYPE = '2'
  9833            IF NOT CM-O-B-COVERAGE
  9834              AND CM-LF-CURRENT-STATUS = '7'
  9835                MOVE ER-0462     TO EMI-ERROR
  9836                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9837
  9838     IF PI-PMTTYPE = '2'
  9839         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9840            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9841             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9842             MOVE ER-0730            TO  EMI-ERROR
  9843             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9844             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9845
  9846     IF PI-PMTTYPE = '2'
  9847         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9848            PI-LF-COVERAGE-TYPE = 'P'
  9849             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9850                 MOVE ER-0462    TO  EMI-ERROR
  9851                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 187
* EL156.cbl
  9852
  9853     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9854       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9855         MOVE ER-0466            TO EMI-ERROR
  9856         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9857
  9858     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9859         IF PI-PMTTYPE = '3'
  9860             MOVE 0436           TO EMI-ERROR
  9861             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9862             GO TO 1045-EDIT-PAYEE-ADDR
  9863         ELSE
  9864             GO TO 1045-EDIT-PAYEE-ADDR.
  9865
  9866     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9867        PI-LF-COVERAGE-TYPE = 'P'
  9868         IF PI-PMTTYPE = '3'
  9869             MOVE ER-0436          TO  EMI-ERROR
  9870             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9871         ELSE
  9872             NEXT SENTENCE
  9873     ELSE
  9874         IF PI-PMTTYPE = '1' OR '3'
  9875             MOVE ER-0436            TO EMI-ERROR
  9876             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9877*
  9878     IF PI-COMPANY-ID = 'CID' AND
  9879        CL-CERT-STATE = 'SC'  AND
  9880        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9881           MOVE ER-0879    TO  EMI-ERROR
  9882           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9883           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9884     END-IF.
  9885     IF PI-COMPANY-ID = 'AHL'
  9886        evaluate true
  9887           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9888              MOVE ER-0879       TO  EMI-ERROR
  9889              PERFORM 1040-PMTTYPE-ERROR
  9890                                 THRU 1040-EXIT
  9891              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9892           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9893                 '6D' OR '6H' OR '6R'
  9894              MOVE ER-0879       TO  EMI-ERROR
  9895              PERFORM 1040-PMTTYPE-ERROR
  9896                                 THRU 1040-EXIT
  9897              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9898           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9899              MOVE ER-0879       TO  EMI-ERROR
  9900              PERFORM 1040-PMTTYPE-ERROR
  9901                                 THRU 1040-EXIT
  9902              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9903        end-evaluate
  9904     END-IF
  9905     GO TO 1045-EDIT-PAYEE-ADDR.
  9906
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 188
* EL156.cbl
  9908 1030-DO-AH-EDITS.
  9909     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9910     IF CM-AH-BENEFIT-CD = '00'
  9911         IF PI-PMTTYPE = '5' OR '6'
  9912             MOVE ER-0658        TO EMI-ERROR
  9913             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9914         ELSE
  9915             MOVE ER-1775        TO EMI-ERROR
  9916             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9917
  9918     IF CL-TOTAL-PAID-AMT = ZEROS
  9919         IF PI-PMTTYPE = '4'
  9920             MOVE ER-0438        TO EMI-ERROR
  9921             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9922
  9923     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9924         IF PI-PMTTYPE = '3'
  9925             MOVE ER-0463        TO EMI-ERROR
  9926             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9927         ELSE
  9928             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9929              AND CM-LF-CURRENT-STATUS = '7'
  9930                 MOVE ER-0465    TO EMI-ERROR
  9931                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9932
  9933     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9934         IF PI-PMTTYPE = '3'
  9935             MOVE ER-0464        TO EMI-ERROR
  9936             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9937         ELSE
  9938             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9939                 MOVE ER-0469    TO EMI-ERROR
  9940                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9941
  9942     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9943         IF PI-PMTTYPE = '3'
  9944             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9945                 MOVE ER-0467    TO EMI-ERROR
  9946                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9947             ELSE
  9948                 NEXT SENTENCE
  9949         ELSE
  9950             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9951                 MOVE ER-0468    TO EMI-ERROR
  9952                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9953
  9954     GO TO 1045-EDIT-PAYEE-ADDR.
  9955
  9956 1040-PMTTYPE-ERROR.
  9957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9958
  9959     IF EMI-MESSAGE-FORMATTED
  9960         MOVE -1                 TO PMTTYPEL
  9961         MOVE AL-UABON           TO PMTTYPEA.
  9962
  9963 1040-EXIT.
  9964     EXIT.
  9965
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 189
* EL156.cbl
  9967 1045-EDIT-PAYEE-ADDR.
  9968
  9969     IF PI-OFFLINE = 'N' AND
  9970        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9971           < PI-PAYEE-SEQ-NUM)
  9972        OR
  9973         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9974         (PI-PAYEE-TYPE = 'B')                 AND
  9975         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9976        OR
  9977         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9978           < PI-PAYEE-SEQ-NUM)
  9979        OR
  9980         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9981           < PI-PAYEE-SEQ-NUM)
  9982        OR
  9983         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9984           < PI-PAYEE-SEQ-NUM)
  9985        OR
  9986         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9987           < PI-PAYEE-SEQ-NUM)
  9988        OR
  9989         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9990           < PI-PAYEE-SEQ-NUM))
  9991             MOVE ER-0437        TO EMI-ERROR
  9992             MOVE -1             TO PAYEEL
  9993             MOVE AL-UABON       TO PAYEEA
  9994             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9995
  9996     IF PI-OFFLINE    = 'N' AND
  9997        PI-PAYEE-TYPE = 'B' AND
  9998        PI-PAYEE-SEQ  = '0'
  9999         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10000         IF BENE-FOUND-SW = 'N'
 10001             MOVE ER-0437        TO EMI-ERROR
 10002             MOVE -1             TO PAYEEL
 10003             MOVE AL-UABON       TO PAYEEA
 10004             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10005
 10006     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10007        IF PI-OFFLINE    = 'N'  AND
 10008           PI-PAYEE-TYPE = 'B'  AND
 10009           PI-PAYEE-SEQ  = '9'
 10010             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10011             IF BENE-FOUND-SW = 'N'
 10012                MOVE ER-0437        TO EMI-ERROR
 10013                MOVE -1             TO PAYEEL
 10014                MOVE AL-UABON       TO PAYEEA
 10015                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10016
 10017*    IF PI-COMPANY-ID = 'CRI'
 10018*        IF CL-CLAIM-TYPE = 'L'
 10019*            MOVE 'N'                TO  WS-GROUPED
 10020*                                        PI-GROUPED
 10021*                                        GROUPEDI
 10022*            MOVE AL-UANON           TO  GROUPEDA
 10023*            GO TO 1050-EDIT-CHECK-NO
 10024*        ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 190
* EL156.cbl
 10025*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10026*            IF WS-GROUP-1 = 'C'
 10027*                NEXT SENTENCE
 10028*            ELSE
 10029*                MOVE 'N'            TO  WS-GROUPED
 10030*                                        PI-GROUPED
 10031*                                        GROUPEDI
 10032*                MOVE AL-UANON       TO  GROUPEDA
 10033*                GO TO 1050-EDIT-CHECK-NO.
 10034
 10035*     IF PI-GROUPED = 'Y'
 10036*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10037*           NEXT SENTENCE
 10038*        ELSE
 10039*           MOVE ER-0437        TO EMI-ERROR
 10040*           MOVE -1             TO PAYEEL
 10041**02180            MOVE AL-UABON       TO PAYEEA
 10042*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10043*
 10044*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10045*        (PI-GROUPED    = ' ')
 10046*        NEXT SENTENCE
 10047*     ELSE
 10048*
 10049     GO TO 1050-EDIT-CHECK-NO.
 10050*     IF PI-COMPANY-ID = 'CRI'
 10051*        MOVE 'N'           TO GROUPEDI
 10052*                              PI-GROUPED
 10053*                              WS-GROUPED
 10054*        MOVE AL-UANON      TO GROUPEDA.
 10055*
 10056*     IF PI-COMPANY-ID = 'CRI'
 10057*        IF PI-PAYEE-TYPE = 'B'
 10058*           IF BENE-FOUND-SW = 'Y'
 10059*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10060*                 MOVE 'Y'           TO GROUPEDI
 10061*                                       PI-GROUPED
 10062*                                       WS-GROUPED
 10063*                 MOVE AL-UANON      TO GROUPEDA
 10064*              ELSE
 10065*                 NEXT SENTENCE
 10066*           ELSE
 10067*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10068*              IF BENE-FOUND-SW = 'Y'
 10069*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10070*                    MOVE 'Y'      TO GROUPEDI
 10071*                                     PI-GROUPED
 10072*                                     WS-GROUPED
 10073*                    MOVE AL-UANON TO GROUPEDA.
 10074*
 10075
 10076     IF PI-COMPANY-ID NOT = 'CRI'
 10077        GO TO 1050-EDIT-CHECK-NO.
 10078
 10079*************** CRI CODE START ******************
 10080     IF PI-PAYEE-TYPE NOT = 'A'
 10081        GO TO 1050-EDIT-CHECK-NO.
 10082
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 191
* EL156.cbl
 10083     MOVE LOW-VALUES             TO ERACCT-KEY.
 10084     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10085     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10086     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10087     MOVE PI-STATE               TO ACCT-STATE.
 10088     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10089     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10090     MOVE 'ACCT'                 TO FILE-SWITCH.
 10091
 10092     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10093     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10094
 10095
 10096* EXEC CICS HANDLE CONDITION
 10097*         NOTFND   (1950-NOT-FOUND)
 10098*         ENDFILE  (1950-NOT-FOUND)
 10099*    END-EXEC.
 10100*    MOVE '"$I''                  ! ( #00009724' TO DFHEIV0
 10101     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10103     MOVE X'2820233030303039373234' TO DFHEIV0(25:11)
 10104     CALL 'kxdfhei1' USING DFHEIV0
 10105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10106
 10107
 10108
 10109* EXEC CICS STARTBR
 10110*         DATASET   ('ERACCT')
 10111*         RIDFLD    (ERACCT-KEY)
 10112*         GTEQ
 10113*    END-EXEC.
 10114     MOVE 'ERACCT' TO DFHEIV1
 10115     MOVE 0
 10116       TO DFHEIV11
 10117*    MOVE '&,         G          &   #00009729' TO DFHEIV0
 10118     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10120     MOVE X'2020233030303039373239' TO DFHEIV0(25:11)
 10121     CALL 'kxdfhei1' USING DFHEIV0,
 10122           DFHEIV1,
 10123           ERACCT-KEY,
 10124           DFHEIV99,
 10125           DFHEIV11,
 10126           DFHEIV99
 10127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10128
 10129
 10130 1046-READNEXT-ERACCT.
 10131
 10132
 10133* EXEC CICS READNEXT
 10134*         DATASET   ('ERACCT')
 10135*         RIDFLD    (ERACCT-KEY)
 10136*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10137*    END-EXEC.
 10138     MOVE 'ERACCT' TO DFHEIV1
 10139     MOVE 0
 10140       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 192
* EL156.cbl
 10141*    MOVE '&.S                   )   #00009737' TO DFHEIV0
 10142     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10143     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10144     MOVE X'2020233030303039373337' TO DFHEIV0(25:11)
 10145     CALL 'kxdfhei1' USING DFHEIV0,
 10146           DFHEIV1,
 10147           DFHEIV20,
 10148           DFHEIV99,
 10149           ERACCT-KEY,
 10150           DFHEIV99,
 10151           DFHEIV11,
 10152           DFHEIV99,
 10153           DFHEIV99
 10154     SET ADDRESS OF ACCOUNT-MASTER TO
 10155         DFHEIV20
 10156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10157
 10158
 10159     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10160        IF WS-ERACCT-HOLD-RECORD = SPACES
 10161           GO TO 1950-NOT-FOUND
 10162        ELSE
 10163           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10164           GO TO 1048-CONTINUE.
 10165
 10166     IF ACCT-EXP-DT = HIGH-VALUES
 10167        NEXT SENTENCE
 10168     ELSE
 10169        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10170        GO TO 1046-READNEXT-ERACCT.
 10171
 10172 1048-CONTINUE.
 10173
 10174*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10175*       MOVE 'Y'                 TO GROUPEDI
 10176*                                   PI-GROUPED
 10177*                                   WS-GROUPED
 10178*       MOVE AL-UANON            TO GROUPEDA.
 10179*************** CRI CODE END ******************
 10180
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 193
* EL156.cbl
 10182 1050-EDIT-CHECK-NO.
 10183
 10184     IF PI-OFFLINE = 'Y'
 10185         IF PI-ECHECKNO = SPACES
 10186              MOVE ER-0439        TO EMI-ERROR
 10187              GO TO 1090-CHECK-NO-ERROR
 10188           ELSE
 10189*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10190*           IF PI-ECHECKNO-N = 'N' AND
 10191*              PI-CASH       = 'Y'
 10192*                MOVE ER-3535        TO EMI-ERROR
 10193*                GO TO 1090-CHECK-NO-ERROR
 10194*             ELSE
 10195*                MOVE AL-UANON    TO CHECKNOA
 10196*                GO TO 1100-EDIT-HOLDTIL
 10197*         ELSE
 10198            MOVE AL-UANON    TO CHECKNOA
 10199            GO TO 1100-EDIT-HOLDTIL.
 10200
 10201     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10202     MOVE '6'                    TO CNTL-REC-TYPE.
 10203
 10204     IF CONTROL-IS-ACTUAL-CARRIER
 10205         MOVE PI-CARRIER         TO WS-CARR
 10206     ELSE
 10207         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10208
 10209     IF PI-COMPANY-ID = 'FIA'
 10210         MOVE PI-CARRIER         TO WS-CARR.
 10211
 10212     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10213     MOVE 0                      TO CNTL-SEQ-NO.
 10214     MOVE 'CARR'                 TO FILE-SWITCH.
 10215
 10216     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10217
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 194
* EL156.cbl
 10219     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10220         GO TO 1051-EDIT-CHECKNO-CONT.
 10221
 10222**********************AIG LOGIC STARTS**********************
 10223     IF PI-ECHECKNO = SPACES
 10224         IF CHECK-NO-MANUAL
 10225             MOVE ER-0441        TO EMI-ERROR
 10226             GO TO 1090-CHECK-NO-ERROR
 10227         ELSE
 10228             MOVE AL-UANOF       TO CHECKNOA
 10229             GO TO 1100-EDIT-HOLDTIL.
 10230
 10231     IF PI-ECHECKNO NOT = SPACES
 10232         IF CHECK-NO-MANUAL
 10233             MOVE AL-UANON       TO CHECKNOA
 10234             GO TO 1100-EDIT-HOLDTIL.
 10235
 10236     IF PI-ECHECKNO-CR = 'CR'
 10237        IF PI-OFFLINE = 'Y'
 10238            MOVE AL-UANON       TO CHECKNOA
 10239            GO TO 1100-EDIT-HOLDTIL
 10240        ELSE
 10241            MOVE ER-3534        TO EMI-ERROR
 10242            GO TO 1090-CHECK-NO-ERROR.
 10243
 10244     IF PI-ECHECKNO-N = 'N'
 10245        IF PI-CASH = 'N'
 10246            MOVE AL-UANON       TO CHECKNOA
 10247            GO TO 1100-EDIT-HOLDTIL
 10248        ELSE
 10249            MOVE ER-3535          TO EMI-ERROR
 10250            GO TO 1090-CHECK-NO-ERROR.
 10251
 10252     MOVE ER-0442        TO EMI-ERROR
 10253     GO TO 1090-CHECK-NO-ERROR.
 10254**********************AIG LOGIC ENDS************************
 10255
 10256 1051-EDIT-CHECKNO-CONT.
 10257
 10258     IF PI-COMPANY-ID = 'DMD'
 10259        IF PI-ECHECKNO NOT = SPACES
 10260           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10261              MOVE ER-0442        TO EMI-ERROR
 10262              GO TO 1090-CHECK-NO-ERROR
 10263            ELSE
 10264              GO TO 1100-EDIT-HOLDTIL
 10265          ELSE
 10266           GO TO 1100-EDIT-HOLDTIL.
 10267
 10268     IF PI-ECHECKNO = SPACES
 10269         IF CHECK-NO-MANUAL
 10270             MOVE ER-0441        TO EMI-ERROR
 10271             GO TO 1090-CHECK-NO-ERROR
 10272         ELSE
 10273             MOVE AL-UANOF       TO CHECKNOA
 10274             GO TO 1100-EDIT-HOLDTIL
 10275     ELSE
 10276         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 195
* EL156.cbl
 10277             MOVE AL-UANON       TO CHECKNOA
 10278             GO TO 1100-EDIT-HOLDTIL
 10279         ELSE
 10280             MOVE ER-0442        TO EMI-ERROR
 10281             GO TO 1090-CHECK-NO-ERROR.
 10282
 10283 1090-CHECK-NO-ERROR.
 10284     MOVE -1                     TO CHECKNOL.
 10285     MOVE AL-UABON               TO CHECKNOA.
 10286     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10287
 10288     GO TO 2000-EDIT-DONE.
 10289
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 196
* EL156.cbl
 10291 1100-EDIT-HOLDTIL.
 10292     MOVE AL-UANON               TO HOLDTILA.
 10293
 10294     IF PI-HOLDTIL = ZEROS
 10295        IF PI-OFFLINE = 'Y'
 10296           MOVE ER-0572          TO EMI-ERROR
 10297           GO TO 1105-HOLDTIL-ERROR
 10298        ELSE
 10299           GO TO 1110-EDIT-PAID-FROM.
 10300
 10301     MOVE '4'                    TO DC-OPTION-CODE.
 10302     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10303     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10304
 10305     IF DATE-CONVERSION-ERROR
 10306         MOVE ER-0446            TO EMI-ERROR
 10307         GO TO 1105-HOLDTIL-ERROR
 10308     END-IF
 10309     IF PI-OFFLINE = 'Y'
 10310        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10311           MOVE ER-0446            TO EMI-ERROR
 10312           GO TO 1105-HOLDTIL-ERROR
 10313        END-IF
 10314     END-IF
 10315
 10316     IF PI-OFFLINE = 'Y'
 10317        GO TO 1110-EDIT-PAID-FROM.
 10318
 10319     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10320     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10321     MOVE '1'                    TO DC-OPTION-CODE.
 10322     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10323
 10324     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10325         MOVE ER-0447            TO EMI-ERROR
 10326         GO TO 1105-HOLDTIL-ERROR.
 10327
 10328     GO TO 1110-EDIT-PAID-FROM.
 10329
 10330 1105-HOLDTIL-ERROR.
 10331     MOVE -1                     TO HOLDTILL.
 10332     MOVE AL-UNBON               TO HOLDTILA.
 10333     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10334
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 197
* EL156.cbl
 10336 1110-EDIT-PAID-FROM.
 10337     MOVE AL-UANON               TO EPYFROMA.
 10338
 10339     IF PI-EPYFROM = ZEROS
 10340         GO TO 1120-CALCULATE-PAID-FROM.
 10341
 10342     IF PI-PMTTYPE = '5' OR '6'
 10343         MOVE ER-0448            TO EMI-ERROR
 10344         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10345         MOVE AL-UNBON           TO EPYFROMA
 10346         MOVE -1                 TO EPYFROML
 10347         GO TO 1150-EDIT-PAID-THRU.
 10348
 10349     MOVE '4'                    TO DC-OPTION-CODE.
 10350     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10351     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10352
 10353     IF DATE-CONVERSION-ERROR
 10354         MOVE ER-0449            TO EMI-ERROR
 10355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10356         MOVE AL-UNBON           TO EPYFROMA
 10357         MOVE -1                 TO EPYFROML
 10358     ELSE
 10359         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10360
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 198
* EL156.cbl
 10362 1120-CALCULATE-PAID-FROM.
 10363     IF PI-PMTTYPE = '5' OR '6'
 10364         GO TO 1150-EDIT-PAID-THRU.
 10365
 10366*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10367*       IF PI-PMTTYPE = '4'
 10368*         GO TO 1150-EDIT-PAID-THRU.
 10369
 10370     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10371         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10372         MOVE ' '                TO DC-OPTION-CODE
 10373         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10374         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10375         GO TO 1145-TEST-PAID-FROM.
 10376
 10377     IF PI-PMTTYPE = '4'
 10378        GO TO 1150-EDIT-PAID-THRU.
 10379
 10380     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10381     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10382     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10383     MOVE '5'                    TO CNTL-REC-TYPE.
 10384     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10385     MOVE 'BENE'                 TO FILE-SWITCH.
 10386
 10387     IF WS-BEN-CD = ZEROS
 10388         GO TO 1950-NOT-FOUND.
 10389
 10390     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10391
 10392     IF NO-BENEFIT-FOUND
 10393         GO TO 1950-NOT-FOUND.
 10394
 10395     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10396     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10397
 10398     IF PI-BEN-DAYS NOT NUMERIC
 10399        MOVE ZEROS               TO PI-BEN-DAYS.
 10400
 10401     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10402
 10403     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10404        (CL-TOTAL-PAID-AMT > ZEROS)
 10405         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10406         MOVE '6'                 TO DC-OPTION-CODE
 10407         MOVE +0                  TO DC-ELAPSED-MONTHS
 10408         MOVE +1                  TO DC-ELAPSED-DAYS
 10409         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10410         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10411         GO TO 1145-TEST-PAID-FROM.
 10412
 10413******************************************************************
 10414****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10415****** SPECIAL ENTERED DATE.
 10416******************************************************************
 10417
 10418     IF PI-AIGFROM = ZEROS
 10419         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 199
* EL156.cbl
 10420
 10421     MOVE AL-UANON TO AIGFROMA.
 10422
 10423     MOVE '4'                    TO DC-OPTION-CODE.
 10424     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10425     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10426
 10427     IF DATE-CONVERSION-ERROR
 10428         MOVE ER-0449            TO EMI-ERROR
 10429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10430         MOVE AL-UNBON           TO AIGFROMA
 10431         MOVE -1                 TO AIGFROML
 10432         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10433     ELSE
 10434         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10435         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10436
 10437     GO TO 1140-CONTINUE-PAID-FROM.
 10438
 10439 1130-CONTINUE-PAID-FROM.
 10440
 10441     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10442        (CL-TOTAL-PAID-AMT = ZEROS)
 10443           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10444
 10445 1140-CONTINUE-PAID-FROM.
 10446
 10447     IF PI-BEN-TYPE = 'R'
 10448         IF PI-BEN-DAYS = ZEROS
 10449             NEXT SENTENCE
 10450         ELSE
 10451         IF PI-COMPANY-ID NOT = 'DMD'
 10452             SUBTRACT 1 FROM PI-BEN-DAYS.
 10453
 10454     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10455
 10456     IF PI-COMPANY-ID = 'DMD'
 10457         MOVE -1                 TO DC-ELAPSED-DAYS
 10458         MOVE +0                 TO DC-ELAPSED-MONTHS
 10459         MOVE '6'                TO DC-OPTION-CODE
 10460         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10461         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10462         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10463                               REMAINDER DC-ELAPSED-DAYS
 10464      ELSE
 10465         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10466         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10467
 10468     MOVE '6'                    TO DC-OPTION-CODE.
 10469     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10470     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10471
 10472     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10473
 10474     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10475         MOVE ER-0541            TO EMI-ERROR
 10476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10477         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 200
* EL156.cbl
 10478         MOVE AL-UNBON           TO EPYFROMA.
 10479
 10480     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10481        (PI-BENEFIT-SAVE = '60E')
 10482        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10483           (CL-TOTAL-PAID-AMT = ZEROS)
 10484             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10485             MOVE 30                  TO DC-ELAPSED-DAYS
 10486             MOVE +0                  TO DC-ELAPSED-MONTHS
 10487             MOVE '6'                 TO DC-OPTION-CODE
 10488             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10489
 10490     IF PI-BEN-TYPE = 'R'
 10491         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10492     ELSE
 10493         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10494         IF WS-SV-EPYFROM = LOW-VALUES
 10495            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10496
 10497     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10498         IF WS-USE-AIG-PAYFROM   OR
 10499            WS-AIG-RECALC-PAYFROM
 10500              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10501                                      DC-BIN-DATE-1
 10502              MOVE ' '            TO  DC-OPTION-CODE
 10503              MOVE +0             TO  DC-ELAPSED-MONTHS
 10504                                      DC-ELAPSED-DAYS
 10505              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10506              IF NO-CONVERSION-ERROR
 10507                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10508
 10509     IF PI-CPYFROM < CL-INCURRED-DT
 10510        MOVE -1                  TO EPYFROML
 10511        MOVE ER-3542             TO EMI-ERROR
 10512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10513
 10514     IF CM-ENTRY-DT < CL-INCURRED-DT
 10515        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10516        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10517        MOVE +0                     TO DC-ELAPSED-DAYS
 10518        MOVE +0                     TO DC-ELAPSED-MONTHS
 10519        MOVE '1'                    TO DC-OPTION-CODE
 10520        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10521        ELSE
 10522        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10523
 10524     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10525         NEXT SENTENCE
 10526     ELSE
 10527         IF DC-ELAPSED-MONTHS < 2
 10528             MOVE ER-3255        TO EMI-ERROR
 10529             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10530
 10531 1145-TEST-PAID-FROM.
 10532     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10533         GO TO 1150-EDIT-PAID-THRU.
 10534
 10535     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 201
* EL156.cbl
 10536         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10537         MOVE ' '                TO DC-OPTION-CODE
 10538         MOVE +0                 TO DC-ELAPSED-MONTHS
 10539                                    DC-ELAPSED-DAYS
 10540         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10541         IF NO-CONVERSION-ERROR
 10542             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10543         ELSE
 10544             MOVE SPACES             TO EMI-DATE-FIELD.
 10545
 10546     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10547         IF CL-TOTAL-PAID-AMT = ZEROS
 10548             MOVE ER-3543            TO EMI-ERROR
 10549             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10550             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10551             IF EMI-MESSAGE-FORMATTED
 10552                MOVE -1             TO EPYFROML
 10553                MOVE AL-UNBON       TO EPYFROMA
 10554             ELSE
 10555                NEXT SENTENCE
 10556         ELSE
 10557             MOVE ER-0452            TO EMI-ERROR
 10558             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10559             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10560             IF EMI-MESSAGE-FORMATTED
 10561                MOVE -1             TO EPYFROML
 10562                MOVE AL-UNBON       TO EPYFROMA.
 10563
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 202
* EL156.cbl
 10565 1150-EDIT-PAID-THRU.
 10566
 10567     MOVE AL-UANON               TO EPYTHRUA.
 10568
 10569     IF PI-EPYTHRU = ZEROS
 10570         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10571             GO TO 1200-EDIT-FIND-TOLERANCES
 10572         ELSE
 10573            IF (PI-PMTTYPE = '3') OR
 10574               (PI-PMTTYPE = '2' AND
 10575                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10576               GO TO 1152-CHECK-TYPE
 10577            ELSE
 10578               MOVE ER-0473      TO EMI-ERROR
 10579               GO TO 1170-PAID-THRU-FATAL-ERROR
 10580     ELSE
 10581         IF PI-PMTTYPE = '5' OR '6'
 10582             MOVE ER-0474        TO EMI-ERROR
 10583             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10584
 10585     MOVE '4'                    TO DC-OPTION-CODE.
 10586     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10587     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10588
 10589     IF DATE-CONVERSION-ERROR
 10590         MOVE ER-0475            TO EMI-ERROR
 10591         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10592
 10593     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10594
 10595     IF PI-COMPANY-ID = 'DMD'
 10596         IF PI-PMTTYPE NOT = '2'
 10597                 AND
 10598            WS-EXP-DT > WS-SV-EPYTHRU
 10599             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10600             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10601             MOVE '1'              TO DC-OPTION-CODE
 10602             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10603             IF DATE-CONVERSION-ERROR
 10604                 MOVE ER-0944      TO EMI-ERROR
 10605                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10606             ELSE
 10607                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10608                    DC-ELAPSED-DAYS   = 1
 10609                     MOVE ER-0945  TO EMI-ERROR
 10610                     MOVE -1       TO EPYTHRUL
 10611                     MOVE AL-UABON TO EPYTHRUA
 10612                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10613
 10614     IF PI-PMTTYPE = '4'
 10615         NEXT SENTENCE
 10616     ELSE
 10617         IF WS-SV-EPYTHRU = WS-EXP-DT
 10618             IF PI-PMTTYPE NOT = '2' AND '3'
 10619                 MOVE ER-3541    TO EMI-ERROR
 10620                 MOVE -1         TO PMTTYPEL
 10621                 MOVE AL-UABON   TO PMTTYPEA
 10622                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 203
* EL156.cbl
 10623
 10624     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10625         MOVE ER-0501            TO EMI-ERROR
 10626         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10627
 10628     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10629        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10630*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10631*              MOVE ER-0540         TO EMI-ERROR
 10632*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10633*              MOVE -1              TO EPYTHRUL
 10634*              MOVE AL-UNBON        TO EPYTHRUA
 10635*          ELSE
 10636*          IF PI-COMPANY-ID = 'DMD'
 10637*              MOVE ER-7540         TO EMI-ERROR
 10638*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10639*              MOVE -1              TO EPYTHRUL
 10640*              MOVE AL-UNBON        TO EPYTHRUA
 10641*          ELSE
 10642               IF PI-PMTTYPE NOT = '2' AND '3'
 10643                  IF PI-COMPANY-ID = '???'
 10644                      MOVE ER-7540  TO EMI-ERROR
 10645                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10646                      MOVE -1       TO EPYTHRUL
 10647                      MOVE AL-UNBON TO EPYTHRUA
 10648                  ELSE
 10649                      MOVE ER-0540  TO EMI-ERROR
 10650                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10651                      MOVE -1       TO EPYTHRUL
 10652                      MOVE AL-UNBON TO EPYTHRUA.
 10653
 10654     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10655            OR
 10656        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10657         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10658            OR
 10659        (PI-CPYFROM NOT = LOW-VALUES AND
 10660         PI-CPYFROM < CL-PAID-THRU-DT)
 10661        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10662
 10663 1152-CHECK-TYPE.
 10664     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10665        OR (PI-PMTTYPE = '5' OR '6')
 10666         GO TO 1160-EDIT-PAID-THRU-AH.
 10667
 10668 1155-EDIT-PAID-THRU-LIFE.
 10669     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10670     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10671     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10672     MOVE '4'                    TO CNTL-REC-TYPE.
 10673     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10674     MOVE 'BENE'                 TO FILE-SWITCH.
 10675
 10676     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10677
 10678     IF NO-BENEFIT-FOUND
 10679         GO TO 1950-NOT-FOUND.
 10680
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 204
* EL156.cbl
 10681     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10682
 10683     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10684
 10685     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10686        PI-LF-COVERAGE-TYPE = 'P'
 10687         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10688         GO TO 1200-EDIT-FIND-TOLERANCES.
 10689
 10690     IF PI-EPYTHRU = ZEROS
 10691        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10692
 10693     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10694         MOVE ER-0476            TO EMI-ERROR
 10695         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10696
 10697     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10698*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10699     move cl-critical-period    to dc-elapsed-months
 10700     MOVE +0                    TO DC-ELAPSED-DAYS.
 10701     MOVE '6'                   TO DC-OPTION-CODE.
 10702     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10703
 10704     IF (NO-CONVERSION-ERROR AND
 10705         WS-SPECIAL-CALC-CD = 'C')
 10706        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10707            MOVE ER-0657 TO EMI-ERROR
 10708            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10709
 10710     IF PI-COMPANY-ID = 'NCL'
 10711         IF WS-SPECIAL-CALC-CD = 'C' AND
 10712            cl-critical-period = zeros
 10713*           CM-LF-CRITICAL-PERIOD = +0
 10714             MOVE ER-0844       TO EMI-ERROR
 10715             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10716
 10717     GO TO 1200-EDIT-FIND-TOLERANCES.
 10718
 10719 1160-EDIT-PAID-THRU-AH.
 10720     IF PI-EPYTHRU = ZEROS
 10721        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10722                                    WS-SV-EPYTHRU
 10723     ELSE
 10724        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10725
 10726     IF WS-SV-EPYTHRU < PI-CPYFROM
 10727         MOVE ER-0508            TO EMI-ERROR
 10728         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10729
 10730     IF PI-PMTTYPE = '3'
 10731        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10732         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10733             MOVE ER-0477        TO EMI-ERROR
 10734             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10735         ELSE
 10736             NEXT SENTENCE
 10737     ELSE
 10738         IF WS-SV-EPYTHRU > WS-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 205
* EL156.cbl
 10739             MOVE ER-0557        TO EMI-ERROR
 10740             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10741
 10742     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10743         PI-PMTTYPE NOT = '3'
 10744         MOVE ER-0541        TO EMI-ERROR
 10745         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10746
 10747     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10748        (PI-PMTTYPE NOT = '3')
 10749         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10750             MOVE ER-0478        TO EMI-ERROR
 10751             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10752
 10753     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10754        (PI-PMTTYPE NOT = '4')
 10755         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10756             MOVE ER-0479        TO EMI-ERROR
 10757             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10758
 10759     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10760         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10761             MOVE ER-0545        TO EMI-ERROR
 10762             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10763
 10764     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10765         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10766             MOVE ER-0481        TO EMI-ERROR
 10767             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10768
 10769*    IF PI-COMPANY-ID = 'NCL'
 10770*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10771*           CM-AH-CRITICAL-PERIOD = +0
 10772*            MOVE ER-0844        TO  EMI-ERROR
 10773*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10774
 10775*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10776     if (cl-critical-period = zeros)
 10777        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10778          GO TO 1200-EDIT-FIND-TOLERANCES.
 10779
 10780     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10781     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10782     MOVE '1'        TO DC-OPTION-CODE.
 10783     MOVE +0         TO DC-ELAPSED-DAYS
 10784                        DC-ELAPSED-MONTHS.
 10785     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10786
 10787*    IF NO-CONVERSION-ERROR
 10788*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10789*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10790*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10791*           MOVE ER-0657 TO EMI-ERROR
 10792*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10793
 10794     GO TO 1200-EDIT-FIND-TOLERANCES.
 10795
 10796 1165-PAID-THRU-ERROR.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 206
* EL156.cbl
 10797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10798
 10799     IF EMI-MESSAGE-FORMATTED
 10800         MOVE -1                 TO EPYTHRUL
 10801         MOVE AL-UNBON           TO EPYTHRUA.
 10802
 10803 1165-EXIT.
 10804     EXIT.
 10805
 10806 1166-CHECK-ALL-TRLRS.
 10807
 10808     IF PI-PMTTYPE = '4'
 10809        GO TO 1166-TRLR-EXIT.
 10810
 10811     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10812
 10813     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10814        WS-SV-EPYFROM = LOW-VALUES
 10815          GO TO 1166-END-CHECK.
 10816
 10817
 10818* EXEC CICS HANDLE CONDITION
 10819*        ENDFILE   (1166-END-CHECK)
 10820*        NOTFND    (1166-END-CHECK)
 10821*    END-EXEC.
 10822*    MOVE '"$''I                  ! ) #00010401' TO DFHEIV0
 10823     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10825     MOVE X'2920233030303130343031' TO DFHEIV0(25:11)
 10826     CALL 'kxdfhei1' USING DFHEIV0
 10827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10828
 10829
 10830     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10831     MOVE +100                   TO TRLR-SEQ-NO.
 10832
 10833
 10834* EXEC CICS STARTBR
 10835*         DATASET    ('ELTRLR')
 10836*         RIDFLD     (ELTRLR-KEY)
 10837*         GTEQ
 10838*    END-EXEC.
 10839     MOVE 'ELTRLR' TO DFHEIV1
 10840     MOVE 0
 10841       TO DFHEIV11
 10842*    MOVE '&,         G          &   #00010409' TO DFHEIV0
 10843     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10845     MOVE X'2020233030303130343039' TO DFHEIV0(25:11)
 10846     CALL 'kxdfhei1' USING DFHEIV0,
 10847           DFHEIV1,
 10848           ELTRLR-KEY,
 10849           DFHEIV99,
 10850           DFHEIV11,
 10851           DFHEIV99
 10852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10853
 10854
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 207
* EL156.cbl
 10855     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10856
 10857 1166-READ-TRLR-NEXT.
 10858
 10859
 10860* EXEC CICS READNEXT
 10861*         DATASET    ('ELTRLR')
 10862*         RIDFLD     (ELTRLR-KEY)
 10863*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10864*    END-EXEC.
 10865     MOVE 'ELTRLR' TO DFHEIV1
 10866     MOVE 0
 10867       TO DFHEIV11
 10868*    MOVE '&.S                   )   #00010419' TO DFHEIV0
 10869     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10870     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10871     MOVE X'2020233030303130343139' TO DFHEIV0(25:11)
 10872     CALL 'kxdfhei1' USING DFHEIV0,
 10873           DFHEIV1,
 10874           DFHEIV20,
 10875           DFHEIV99,
 10876           ELTRLR-KEY,
 10877           DFHEIV99,
 10878           DFHEIV11,
 10879           DFHEIV99,
 10880           DFHEIV99
 10881     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10882         DFHEIV20
 10883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10884
 10885
 10886     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10887        TRLR-CARRIER  = MSTR-CARRIER  AND
 10888        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10889        TRLR-CERT-NO  = MSTR-CERT-NO
 10890          NEXT SENTENCE
 10891      ELSE
 10892          GO TO 1166-END-CHECK.
 10893
 10894* **  BYPASS ALL NON-PAYMENT TRAILERS
 10895
 10896     IF AT-TRAILER-TYPE = '2'
 10897        NEXT SENTENCE
 10898     ELSE
 10899        GO TO 1166-READ-TRLR-NEXT.
 10900
 10901* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10902
 10903     IF AT-PAYMENT-TYPE = '1' OR '2'
 10904        NEXT SENTENCE
 10905     ELSE
 10906        GO TO 1166-READ-TRLR-NEXT.
 10907
 10908* **  BYPASS ALL VOID PAYMENTS
 10909
 10910     IF AT-VOID-DT NOT = LOW-VALUES
 10911        GO TO 1166-READ-TRLR-NEXT.
 10912
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 208
* EL156.cbl
 10913     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10914        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10915          GO TO 1166-READ-TRLR-NEXT.
 10916
 10917     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10918         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10919            OR
 10920        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10921         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10922        NEXT SENTENCE
 10923     ELSE
 10924         IF CL-TOTAL-PAID-AMT > ZEROS
 10925             MOVE ER-0502            TO EMI-ERROR
 10926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10927             MOVE -1                 TO EPYTHRUL
 10928             MOVE AL-UNBON           TO EPYTHRUA.
 10929
 10930     GO TO 1166-READ-TRLR-NEXT.
 10931
 10932 1166-END-CHECK.
 10933
 10934     IF WS-BROWSE-TRLR-SW = 'Y'
 10935
 10936* EXEC CICS ENDBR
 10937*            DATASET   ('ELTRLR')
 10938*       END-EXEC.
 10939     MOVE 'ELTRLR' TO DFHEIV1
 10940     MOVE 0
 10941       TO DFHEIV11
 10942*    MOVE '&2                    $   #00010474' TO DFHEIV0
 10943     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10944     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10945     MOVE X'2020233030303130343734' TO DFHEIV0(25:11)
 10946     CALL 'kxdfhei1' USING DFHEIV0,
 10947           DFHEIV1,
 10948           DFHEIV11,
 10949           DFHEIV99
 10950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10951
 10952
 10953     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10954
 10955 1166-TRLR-EXIT.
 10956     EXIT.
 10957
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 209
* EL156.cbl
 10959 1170-PAID-THRU-FATAL-ERROR.
 10960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10961
 10962     MOVE -1                     TO EPYTHRUL.
 10963     MOVE AL-UNBON               TO EPYTHRUA.
 10964
 10965 1200-EDIT-FIND-TOLERANCES.
 10966
 10967* EXEC CICS HANDLE CONDITION
 10968*        ENDFILE(1950-NOT-FOUND)
 10969*        NOTFND (1950-NOT-FOUND)
 10970*    END-EXEC.
 10971*    MOVE '"$''I                  ! * #00010491' TO DFHEIV0
 10972     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10974     MOVE X'2A20233030303130343931' TO DFHEIV0(25:11)
 10975     CALL 'kxdfhei1' USING DFHEIV0
 10976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10977
 10978
 10979     IF PI-PROCESSOR-ID = 'LGXX'
 10980        GO TO 1240-FIND-ACCT-TOLERANCES.
 10981
 10982     MOVE 'N'                    TO FOUND-TOL-SW.
 10983     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10984     MOVE '2'                    TO CNTL-REC-TYPE.
 10985     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10986     MOVE +0                     TO CNTL-SEQ-NO.
 10987     MOVE 'PROC'                 TO FILE-SWITCH.
 10988
 10989     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10990
 10991     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10992     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10993                                    PI-MAX-PMT-TOL.
 10994     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10995
 10996     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10997         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10998
 10999     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11000     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11001                                    PI-MAX-LF-PMT-TOL.
 11002
 11003     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11004         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11005
 11006     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11007                                    PI-MAX-EXP-PMT.
 11008
 11009 1240-FIND-ACCT-TOLERANCES.
 11010
 11011     IF WS-PMT-TOL NOT = +0
 11012         MOVE 'Y'                TO FOUND-TOL-SW.
 11013
 11014     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11015         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11016         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 210
* EL156.cbl
 11017         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11018         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11019         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11020         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11021     ELSE
 11022         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11023         MOVE PI-CARRIER             TO ACCT-CARRIER
 11024         MOVE PI-GROUPING            TO ACCT-GROUPING
 11025         MOVE PI-STATE               TO ACCT-STATE
 11026         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11027         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11028
 11029     MOVE 'ACCT'                 TO FILE-SWITCH.
 11030
 11031     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11032     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11033
 11034
 11035* EXEC CICS HANDLE CONDITION
 11036*         NOTFND   (1950-NOT-FOUND)
 11037*         ENDFILE  (1950-NOT-FOUND)
 11038*    END-EXEC.
 11039*    MOVE '"$I''                  ! + #00010551' TO DFHEIV0
 11040     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11042     MOVE X'2B20233030303130353531' TO DFHEIV0(25:11)
 11043     CALL 'kxdfhei1' USING DFHEIV0
 11044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11045
 11046
 11047
 11048* EXEC CICS STARTBR
 11049*        DATASET('ERACCT')
 11050*        RIDFLD (ERACCT-KEY)
 11051*        GTEQ
 11052*    END-EXEC.
 11053     MOVE 'ERACCT' TO DFHEIV1
 11054     MOVE 0
 11055       TO DFHEIV11
 11056*    MOVE '&,         G          &   #00010556' TO DFHEIV0
 11057     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11058     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11059     MOVE X'2020233030303130353536' TO DFHEIV0(25:11)
 11060     CALL 'kxdfhei1' USING DFHEIV0,
 11061           DFHEIV1,
 11062           ERACCT-KEY,
 11063           DFHEIV99,
 11064           DFHEIV11,
 11065           DFHEIV99
 11066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11067
 11068
 11069 1245-FIND-ACCT-TOLERANCES-LOOP.
 11070
 11071
 11072* EXEC CICS READNEXT
 11073*        DATASET('ERACCT')
 11074*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 211
* EL156.cbl
 11075*        RIDFLD (ERACCT-KEY)
 11076*    END-EXEC.
 11077     MOVE 'ERACCT' TO DFHEIV1
 11078     MOVE 0
 11079       TO DFHEIV11
 11080*    MOVE '&.S                   )   #00010564' TO DFHEIV0
 11081     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11082     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11083     MOVE X'2020233030303130353634' TO DFHEIV0(25:11)
 11084     CALL 'kxdfhei1' USING DFHEIV0,
 11085           DFHEIV1,
 11086           DFHEIV20,
 11087           DFHEIV99,
 11088           ERACCT-KEY,
 11089           DFHEIV99,
 11090           DFHEIV11,
 11091           DFHEIV99,
 11092           DFHEIV99
 11093     SET ADDRESS OF ACCOUNT-MASTER TO
 11094         DFHEIV20
 11095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11096
 11097
 11098     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11099        IF WS-ERACCT-HOLD-RECORD = SPACES
 11100           GO TO 1950-NOT-FOUND
 11101        ELSE
 11102           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11103           GO TO 1250-CONTINUE.
 11104
 11105     IF ACCT-EXP-DT = HIGH-VALUES
 11106        NEXT SENTENCE
 11107     ELSE
 11108        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11109        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11110
 11111 1250-CONTINUE.
 11112
 11113     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11114
 11115     IF FOUND-TOL-SW = 'N'
 11116         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11117
 11118********* 1260-FIND-STATE-TOLERANCES.
 11119
 11120     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11121     MOVE PI-STATE               TO WS-ST-ACCESS.
 11122     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11123     MOVE '3'                    TO CNTL-REC-TYPE.
 11124     MOVE +0                     TO CNTL-SEQ-NO.
 11125     MOVE 'STAT'                 TO FILE-SWITCH.
 11126
 11127     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11128
 11129     IF WS-PMT-TOL = +0
 11130         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11131
 11132     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 212
* EL156.cbl
 11133     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11134     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11135     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11136     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11137
 11138****USE THIS ROUTINE TO CHECK PAYEE NAME EQUAL TO DECEASED
 11139     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 11140*        PI-VFY-2ND-BENE = 'Y' AND
 11141        PI-PAYEE-TYPE <> 'B'
 11142           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11143     END-IF.
 11144
 11145     IF PI-PMTTYPE      = '2'  AND
 11146        PI-SPLIT-PMT-SW = 'Y'  AND
 11147        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11148          MOVE ER-3530                TO EMI-ERROR
 11149          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11150
 11151********* 1280-FIND-BENEFIT-TOLERANCES.
 11152
 11153     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11154        OR (PI-PMTTYPE = '5' OR '6')
 11155         GO TO 1300-FIND-CARR-TOLERANCES.
 11156
 11157     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11158     MOVE '4'                    TO CNTL-REC-TYPE.
 11159     MOVE +0                     TO CNTL-SEQ-NO.
 11160     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11161     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11162     MOVE 'BENE'                 TO FILE-SWITCH.
 11163
 11164     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11165
 11166     IF NO-BENEFIT-FOUND
 11167         GO TO 1950-NOT-FOUND.
 11168
 11169     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11170     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11171     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11172
 11173
 11174* EXEC CICS HANDLE CONDITION
 11175*        NOTFND(1950-NOT-FOUND)
 11176*    END-EXEC.
 11177*    MOVE '"$I                   ! , #00010645' TO DFHEIV0
 11178     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11180     MOVE X'2C20233030303130363435' TO DFHEIV0(25:11)
 11181     CALL 'kxdfhei1' USING DFHEIV0
 11182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11183
 11184
 11185 1300-FIND-CARR-TOLERANCES.
 11186     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11187     MOVE '6'                    TO CNTL-REC-TYPE.
 11188
 11189     IF CONTROL-IS-ACTUAL-CARRIER
 11190         MOVE PI-CARRIER               TO WS-CARR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 213
* EL156.cbl
 11191     ELSE
 11192         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11193
 11194     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11195     MOVE +0                     TO CNTL-SEQ-NO.
 11196     MOVE 'CARR'                 TO FILE-SWITCH.
 11197
 11198     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11199
 11200     IF WS-DAYS-TOL = +0
 11201         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11202
 11203     IF WS-PMT-TOL = +0
 11204         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11205
 11206     IF WS-MAX-DAYS-TOL = +0
 11207         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11208
 11209     IF WS-MAX-PMT-TOL = +0
 11210         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11211                                    PI-MAX-PMT-TOL.
 11212
 11213     IF WS-MAX-LF-PMT-TOL = +0
 11214        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11215                                    PI-MAX-LF-PMT-TOL.
 11216
 11217     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11218
 11219********* 1320-FIND-COMP-TOLERANCES.
 11220
 11221     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11222     MOVE '1'                    TO CNTL-REC-TYPE.
 11223     MOVE SPACES                 TO CNTL-ACCESS.
 11224     MOVE +0                     TO CNTL-SEQ-NO.
 11225     MOVE 'COMP'                 TO FILE-SWITCH.
 11226
 11227     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11228
 11229     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11230     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11231
 11232     IF WS-PMT-TOL NOT = +0
 11233        IF WS-TOL-SEVERITY NOT = ' '
 11234         GO TO 1360-EDIT-DAYS.
 11235
 11236     IF WS-PMT-TOL = +0
 11237         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11238
 11239     IF WS-TOL-SEVERITY = ' '
 11240         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11241
 11242 1360-EDIT-DAYS.
 11243     IF PI-PMTTYPE NOT = '4'
 11244        IF PI-EDAYS NEGATIVE OR
 11245           PI-EPYAMT NEGATIVE
 11246          MOVE ER-0513             TO EMI-ERROR
 11247          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11248          MOVE -1                  TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 214
* EL156.cbl
 11249
 11250     IF PI-PMTTYPE = '5' OR '6'
 11251        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11252
 11253     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11254        IF PI-PMTTYPE = '4'
 11255          MOVE PI-EDAYS          TO PI-CDAYS.
 11256
 11257     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11258         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11259
 11260     IF PI-PMTTYPE = '4'
 11261        MOVE PI-EDAYS            TO PI-CDAYS
 11262        GO TO 1400-EDIT-PAYMENT.
 11263
 11264     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11265        GO TO 1500-EDIT-EXPENSES.
 11266
 11267*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11268*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11269*          CM-AH-BENEFIT-CD = '23'              AND
 11270*          CL-CERT-STATE    = '04'              AND
 11271*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11272*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11273*            GO TO 1362-CHECK-MAX-DAYS.
 11274
 11275     IF PI-EDAYS = ZEROS
 11276*        IF PI-COMPANY-ID = 'DMD'
 11277*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11278*            MOVE -1             TO DC-ELAPSED-DAYS
 11279*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11280*            MOVE '6'            TO DC-OPTION-CODE
 11281*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11282*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11283*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11284*            MOVE '1'            TO DC-OPTION-CODE
 11285*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11286*            IF NO-CONVERSION-ERROR
 11287*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11288*                                 + DC-ODD-DAYS-OVER
 11289*               MOVE 6           TO EDAYSL
 11290*               MOVE AL-UNNON    TO EDAYSA
 11291*            ELSE
 11292*                NEXT SENTENCE
 11293*       ELSE
 11294            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11295            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11296            MOVE '1'             TO DC-OPTION-CODE
 11297            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11298            IF NO-CONVERSION-ERROR
 11299                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11300                ADD 1                 TO PI-EDAYS
 11301                MOVE AL-UNNON         TO EDAYSA.
 11302
 11303*    IF PI-COMPANY-ID = 'DMD'
 11304*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11305*        MOVE -1                 TO DC-ELAPSED-DAYS
 11306*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 215
* EL156.cbl
 11307*        MOVE '6'                TO DC-OPTION-CODE
 11308*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11309*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11310*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11311*        MOVE '1'                TO DC-OPTION-CODE
 11312*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11313*    ELSE
 11314         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11315         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11316         MOVE '1'                TO DC-OPTION-CODE.
 11317         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11318
 11319     IF NO-CONVERSION-ERROR
 11320        IF PI-COMPANY-ID = 'DMD'
 11321            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11322                             + DC-ODD-DAYS-OVER
 11323        ELSE
 11324            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11325            ADD 1                TO PI-CDAYS.
 11326
 11327     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11328        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11329        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11330
 11331     IF PI-EDAYS NOT NUMERIC
 11332         MOVE ER-0491            TO EMI-ERROR
 11333         GO TO 1370-DAYS-ERROR.
 11334
 11335     IF CL-NO-OF-PMTS-MADE = 0
 11336        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11337        AND CL-CERT-STATE = 'MI'
 11338        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11339            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11340     END-IF.
 11341
 11342 1362-CHECK-MAX-DAYS.
 11343
 11344     IF WS-MAX-DAYS-TOL = +999
 11345         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11346
 11347     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11348         IF PI-EDAYS = ZEROS
 11349             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11350         ELSE
 11351             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11352
 11353     IF WS-MAX-DAYS-TOL NOT = ZERO
 11354        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11355           PI-CDAYS > WS-MAX-DAYS-TOL
 11356             MOVE ER-0492          TO EMI-ERROR
 11357             GO TO 1370-DAYS-ERROR.
 11358
 11359 1365-SKIP-MAX-DAYS-EDIT.
 11360     IF PI-EDAYS = ZEROS
 11361        GO TO 1400-EDIT-PAYMENT.
 11362
 11363     IF WS-DAYS-TOL NOT = ZERO
 11364        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 216
* EL156.cbl
 11365           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 11366                MOVE ER-0493     TO EMI-ERROR
 11367                GO TO 1370-DAYS-ERROR.
 11368
 11369     GO TO 1400-EDIT-PAYMENT.
 11370
 11371 1370-DAYS-ERROR.
 11372     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11373
 11374     IF EMI-MESSAGE-FORMATTED
 11375         MOVE -1                 TO EDAYSL
 11376         MOVE AL-UABON           TO EDAYSA.
 11377
 11378     GO TO 1400-EDIT-PAYMENT.
 11379
 11380 1380-EDIT-EXPENSE-PMT-AMT.
 11381     IF PI-PMTTYPE = '5' OR '6'
 11382         NEXT SENTENCE
 11383     ELSE
 11384         GO TO 1400-EDIT-PAYMENT.
 11385
 11386     IF WS-MAX-EXP-PMT NOT = ZEROS
 11387        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11388            MOVE ER-3529            TO EMI-ERROR
 11389            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11390
 11391     GO TO 1500-EDIT-EXPENSES.
 11392
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 217
* EL156.cbl
 11394
 11395 1390-CHECK-PAYMENT-DAYS.
 11396
 11397     IF PI-EDAYS = 0
 11398         MOVE PI-CDAYS TO WS-PD-DAYS
 11399     ELSE
 11400         MOVE PI-EDAYS TO WS-PD-DAYS
 11401     END-IF.
 11402
 11403     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11404         IF WS-PD-DAYS = 14
 11405            GO TO 1390-EXIT
 11406         END-IF
 11407     END-IF.
 11408
 11409     IF PI-COMPANY-ID = 'AHL'  AND
 11410        CM-AH-BENEFIT-CD = '1K'
 11411         IF WS-PD-DAYS = 14
 11412            GO TO 1390-EXIT
 11413         END-IF
 11414     END-IF.
 11415
 11416     IF WS-PD-DAYS < 30
 11417         MOVE ER-3549              TO EMI-ERROR
 11418         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11419     END-IF.
 11420
 11421 1390-EXIT.
 11422      EXIT.
 11423
 11424 1400-EDIT-PAYMENT.
 11425*    IF PI-COMPANY-ID = 'DMD'
 11426*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11427*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11428
 11429     IF PI-COMPANY-ID = 'DCC'
 11430        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11431        MOVE PI-CARRIER          TO ACCT-CARRIER
 11432        MOVE PI-GROUPING         TO ACCT-GROUPING
 11433        MOVE PI-STATE            TO ACCT-STATE
 11434        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11435        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11436        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11437        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11438
 11439
 11440* EXEC CICS READ
 11441*          DATASET ('ERACCT')
 11442*          RIDFLD  (ERACCT-KEY)
 11443*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11444*          GTEQ
 11445*          resp    (WS-RESPONSE)
 11446*       END-EXEC
 11447     MOVE 'ERACCT' TO DFHEIV1
 11448*    MOVE '&"S        G          (  N#00010903' TO DFHEIV0
 11449     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11451     MOVE X'204E233030303130393033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 218
* EL156.cbl
 11452     CALL 'kxdfhei1' USING DFHEIV0,
 11453           DFHEIV1,
 11454           DFHEIV20,
 11455           DFHEIV99,
 11456           ERACCT-KEY,
 11457           DFHEIV99,
 11458           DFHEIV99,
 11459           DFHEIV99
 11460     SET ADDRESS OF ACCOUNT-MASTER TO
 11461         DFHEIV20
 11462     MOVE EIBRESP  TO WS-RESPONSE
 11463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11464        IF WS-RESP-NORMAL
 11465           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11466           and pi-cert-eff-dt < am-expiration-dt
 11467           and pi-cert-eff-dt >= am-effective-dt
 11468           move am-dcc-product-code to pi-dcc-product-code
 11469        else
 11470           move spaces           to pi-dcc-product-code
 11471        end-if
 11472        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11473           MOVE ' '              TO WS-PDEF-RECORD-SW
 11474           PERFORM 0900-GET-DDF-FACTORS
 11475                                 THRU 0900-EXIT
 11476           IF PDEF-FOUND
 11477              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11478                 (P1 > +8)
 11479                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11480              END-PERFORM
 11481              IF P1 < +9
 11482                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11483                    MOVE PD-MAX-AMT (P1)
 11484                                 TO CM-AH-BENEFIT-AMT
 11485                 end-if
 11486              END-IF
 11487           END-IF
 11488        end-if
 11489     END-IF
 11490     IF PI-PMTTYPE NOT = '4'
 11491        GO TO 1405-CALC-PAYMENT.
 11492
 11493     IF PI-EDAYS NOT NUMERIC
 11494         MOVE PI-EPYAMT           TO PI-CPYAMT
 11495         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11496         GO TO 1430-CHECK-AH-TOLERANCE.
 11497
 11498*    IF PI-COMPANY-ID = 'FIA'
 11499*       IF CERT-ACCOUNT = '0000011043'
 11500*        COMPUTE PI-DAILY-RATE ROUNDED =
 11501*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11502*        COMPUTE PI-CPYAMT ROUNDED =
 11503*                          PI-DAILY-RATE * PI-EDAYS
 11504*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11505*        GO TO 1430-CHECK-AH-TOLERANCE.
 11506
 11507     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11508         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11509         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 219
* EL156.cbl
 11510         GO TO 1420-CHECK-AIG-BENEFIT.
 11511
 11512     IF WS-CALC-METHOD = '2' OR  '5'
 11513         COMPUTE PI-DAILY-RATE ROUNDED =
 11514                        (CM-AH-BENEFIT-AMT * 12) / 365
 11515         COMPUTE PI-CPYAMT ROUNDED =
 11516                           PI-DAILY-RATE * PI-EDAYS
 11517        GO TO 1420-CHECK-AIG-BENEFIT.
 11518
 11519     IF WS-CALC-METHOD = '3'
 11520         COMPUTE PI-DAILY-RATE =
 11521                         (CM-AH-BENEFIT-AMT * 12) / 365
 11522         COMPUTE PI-CPYAMT ROUNDED =
 11523                           PI-DAILY-RATE * PI-EDAYS
 11524        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 220
* EL156.cbl
 11526*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11527
 11528****************************************************************
 11529****************************************************************
 11530*                  CALCULATED FROM      PAYMENT      PAYMENT
 11531*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11532* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11533*1-01-83  1-15-83    0    15     15        15           15
 11534*1-01-83  1-30-83    0    30     30        30           30
 11535*1-01-83  1-31-83    1     0     31        30           30
 11536*1-01-83  2-01-83    1     1     32        31           31
 11537*1-01-83  2-15-83    1    15     46        45           45
 11538*1-01-83  2-28-83    2     0     59        60           60
 11539*1-01-83  3-01-83    2     1     60        61           61
 11540*1-01-83  3-31-83    3     0     90        90           90
 11541*1-15-83  1-31-83    0    17     17        17           16
 11542*1-15-83  2-01-83    0    18     18        18           17
 11543*1-15-83  2-28-83    1    14     45        44           46
 11544*1-21-83  3-09-83    1    20     48        50           49
 11545*2-05-83  3-06-83    1     2     30        32           32
 11546*2-05-83  3-23-83    1    19     47        49           49
 11547*2-15-83  2-28-83    0    14     14        14           16
 11548*2-15-83  3-01-83    0    15     15        15           17
 11549*2-21-83  3-19-83    0    27     27        27           29
 11550*2-21-83  3-20-83    1     0     28        30           30
 11551*2-21-83  4-10-83    1    18     49        30           50
 11552*2-21-83  5-19-83    2    27     88        87           89
 11553*2-21-83  5-22-83    3     2     91        92           92
 11554*3-21-83  5-19-83    1    30     60        60           59
 11555****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 221
* EL156.cbl
 11557 1405-CALC-PAYMENT.
 11558     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11559     MOVE ' '                    TO DC-OPTION-CODE.
 11560     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11561     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11562     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11563
 11564     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11565     MOVE ' '                    TO DC-OPTION-CODE.
 11566     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11567     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11568     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11569
 11570     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11571     MOVE -1                     TO DC-ELAPSED-DAYS.
 11572     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11573     MOVE '6'                    TO DC-OPTION-CODE.
 11574     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11575     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11576
 11577     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11578     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11579     MOVE '1'                    TO DC-OPTION-CODE.
 11580     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11581
 11582     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11583     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11584     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11585
 11586******************************************************************
 11587*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11588*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11589*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11590******************************************************************
 11591
 11592     IF WS-CALC-METHOD = '1'           AND
 11593        DC-ELAPSED-MONTHS > ZERO AND
 11594        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11595        WDF-DAY > WDT-DAY
 11596          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11597          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11598          MOVE -1                  TO DC-ELAPSED-MONTHS
 11599          MOVE '6'                 TO DC-OPTION-CODE
 11600          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11601          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11602          COMPUTE WS-SAVE-ODD-DAYS =
 11603          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11604          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11605
 11606     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11607     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11608     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11609
 11610     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11611     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11612
 11613*    IF PI-COMPANY-ID = 'FIA'
 11614*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 222
* EL156.cbl
 11615*        COMPUTE PI-DAILY-RATE ROUNDED =
 11616*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11617*        COMPUTE PI-CPYAMT ROUNDED =
 11618*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11619*        GO TO 1420-CHECK-AIG-BENEFIT.
 11620
 11621*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11622*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11623*          CM-AH-BENEFIT-CD = '23'               AND
 11624*          CL-CERT-STATE    = '04'               AND
 11625*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11626*            COMPUTE WS-DAILY-RATE ROUNDED =
 11627*                               CM-AH-BENEFIT-AMT / 30
 11628*            COMPUTE PI-CPYAMT ROUNDED =
 11629*                               (WS-DAILY-RATE * PI-CDAYS)
 11630*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11631*            GO TO 1420-CHECK-AIG-BENEFIT.
 11632
 11633     IF WS-CALC-METHOD = '1'
 11634         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11635         COMPUTE PI-CPYAMT ROUNDED =
 11636             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11637             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11638         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11639         GO TO 1420-CHECK-AIG-BENEFIT.
 11640
 11641     IF WS-CALC-METHOD = '2'
 11642         COMPUTE PI-DAILY-RATE ROUNDED =
 11643                          (CM-AH-BENEFIT-AMT * 12) / 365
 11644         COMPUTE PI-CPYAMT ROUNDED =
 11645             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11646             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11647         GO TO 1420-CHECK-AIG-BENEFIT.
 11648
 11649     IF WS-CALC-METHOD = '4'
 11650         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11651         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11652         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11653         COMPUTE PI-CPYAMT ROUNDED =
 11654                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11655         GO TO 1420-CHECK-AIG-BENEFIT.
 11656
 11657     IF WS-CALC-METHOD = '5'
 11658         COMPUTE PI-DAILY-RATE ROUNDED =
 11659                            (CM-AH-BENEFIT-AMT * 12) / 365
 11660         COMPUTE PI-CPYAMT ROUNDED =
 11661                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11662         GO TO 1420-CHECK-AIG-BENEFIT.
 11663
 11664     IF WS-CALC-METHOD NOT = '3'
 11665        GO TO 1410-CHECK-PAYMENT.
 11666
 11667******   CALCULATION METHOD  3  ROUTINE
 11668     COMPUTE PI-DAILY-RATE =
 11669                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11670
 11671******CHECK TO SEE IF WITHIN SAME MONTH
 11672     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 223
* EL156.cbl
 11673        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11674                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11675         GO TO 1420-CHECK-AIG-BENEFIT.
 11676
 11677******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11678     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11679             SAVE-ODD-DAYS-OVER = ZEROS
 11680      COMPUTE PI-CPYAMT  ROUNDED =
 11681                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11682      GO TO 1420-CHECK-AIG-BENEFIT.
 11683
 11684******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11685******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11686     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11687        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11688        IF WDF-MONTH > 12
 11689           ADD 1                 TO WDF-YEAR
 11690           SUBTRACT 12         FROM WDF-MONTH.
 11691
 11692******CONVERT THE NEW FROM MONTH TO BINARY
 11693     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11694        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11695        MOVE '4'              TO DC-OPTION-CODE
 11696        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11697        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11698
 11699     IF WDF-MONTH = WDT-MONTH AND
 11700        WDF-YEAR  = WDT-YEAR
 11701          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11702                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11703                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11704        ELSE
 11705          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11706          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11707          COMPUTE PI-CPYAMT ROUNDED =
 11708       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11709       +
 11710       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11711       +
 11712       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11713
 11714     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 224
* EL156.cbl
 11716 1410-CHECK-PAYMENT.
 11717******PAYMENT OPTION 6
 11718******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11719     IF SAVE-ELAPSED-MONTHS > ZERO
 11720        IF SAVE-ODD-DAYS-OVER = ZEROS
 11721           GO TO 1412-CHECK-TO-DAY
 11722        ELSE
 11723           IF WDF-DAY > WDT-DAY
 11724              IF WDF-MONTH = 02
 11725                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11726                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11727                  GO TO 1412-CHECK-TO-DAY
 11728              ELSE
 11729                  IF FROM-DAYS-IN-MONTH = 31
 11730                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11731                     GO TO 1412-CHECK-TO-DAY
 11732                  ELSE
 11733                     GO TO 1412-CHECK-TO-DAY
 11734           ELSE
 11735               GO TO 1412-CHECK-TO-DAY.
 11736
 11737     IF WDF-MONTH NOT = WDT-MONTH
 11738        IF WDF-MONTH = 02
 11739           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11740           IF WDF-DAY = 29
 11741              ADD 1              TO SAVE-ODD-DAYS-OVER
 11742           ELSE
 11743              ADD 2              TO SAVE-ODD-DAYS-OVER
 11744        ELSE
 11745           IF FROM-DAYS-IN-MONTH = 31
 11746              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11747
 11748 1412-CHECK-TO-DAY.
 11749        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11750           IF WDT-DAY = 28
 11751              ADD 2              TO SAVE-ODD-DAYS-OVER
 11752           ELSE
 11753              IF WDT-DAY = 29
 11754                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11755              ELSE
 11756                 NEXT SENTENCE
 11757        ELSE
 11758           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11759              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11760
 11761     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11762     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11763     COMPUTE PI-CPYAMT ROUNDED =
 11764         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11765         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11766
 11767     GO TO 1420-CHECK-AIG-BENEFIT.
 11768
 11769 1415-CHECK-LEAP-YEAR.
 11770     IF FROM-DAYS-IN-MONTH = 29
 11771        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11772
 11773 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 225
* EL156.cbl
 11774     EXIT.
 11775
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 226
* EL156.cbl
 11777 1420-CHECK-AIG-BENEFIT.
 11778
 11779     IF WS-SPECIAL-CALC-CD = 'Q'
 11780         GO TO 1425-CHECK-WHOLE-MONTH.
 11781
 11782*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11783*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11784*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11785*       (PI-PMTTYPE = '1' OR '2')
 11786*        NEXT SENTENCE
 11787*    ELSE
 11788         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11789         GO TO 1430-CHECK-AH-TOLERANCE.
 11790
 11791******************AIG LOGIC STARTS**********************
 11792*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11793*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11794*    MOVE ER-3533      TO EMI-ERROR.
 11795*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11796*    GO TO 1430-CHECK-AH-TOLERANCE.
 11797******************AIG LOGIC ENDS************************
 11798
 11799 1425-CHECK-WHOLE-MONTH.
 11800******************************************************************
 11801****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11802****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11803****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11804****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11805****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11806****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11807****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11808****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11809****          PAID * MONTHLY BENEFIT.                         ****
 11810******************************************************************
 11811
 11812     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11813
 11814     IF CL-NO-OF-PMTS-MADE > +0
 11815         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11816
 11817     IF PI-CDAYS < WS-BEN-DAYS
 11818         GO TO 1430-CHECK-AH-TOLERANCE.
 11819
 11820     IF PI-CDAYS = WS-BEN-DAYS
 11821         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11822         GO TO 1430-CHECK-AH-TOLERANCE.
 11823
 11824*    IF PI-COMPANY-ID = 'ACM'
 11825*       NEXT SENTENCE
 11826*    ELSE
 11827        GO TO 1425-NOT-ACM-W15C.
 11828
 11829*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11830*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11831*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11832*    MOVE '6'                    TO  DC-OPTION-CODE.
 11833*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11834*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 227
* EL156.cbl
 11835*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11836*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11837*       MOVE '1'                 TO  DC-OPTION-CODE
 11838*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11839*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11840*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11841*       IF NO-CONVERSION-ERROR
 11842*          IF (DC-ELAPSED-MONTHS > +0) OR
 11843*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11844*             NEXT SENTENCE
 11845*          ELSE
 11846*             MOVE +0            TO  PI-CPYAMT
 11847*             MOVE ER-0846       TO  EMI-ERROR
 11848*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11849*             GO TO 1430-CHECK-AH-TOLERANCE
 11850*       ELSE
 11851*           MOVE ER-0846         TO  EMI-ERROR
 11852*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11853*           GO TO 1430-CHECK-AH-TOLERANCE.
 11854*
 11855*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11856*       ADD +1 TO DC-ELAPSED-MONTHS.
 11857*
 11858*    COMPUTE PI-CPYAMT ROUNDED =
 11859*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11860*
 11861*    GO TO 1430-CHECK-AH-TOLERANCE.
 11862
 11863 1425-NOT-ACM-W15C.
 11864
 11865     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11866     MOVE '6'                        TO  DC-OPTION-CODE.
 11867     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11868     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11869
 11870     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11871     IF NO-CONVERSION-ERROR
 11872         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11873     ELSE
 11874         MOVE ER-0846                TO  EMI-ERROR
 11875         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11876         GO TO 1430-CHECK-AH-TOLERANCE.
 11877
 11878     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11879     MOVE '1'                        TO  DC-OPTION-CODE.
 11880     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11881     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11882     IF NO-CONVERSION-ERROR
 11883         IF DC-ODD-DAYS-OVER = +0
 11884             NEXT SENTENCE
 11885         ELSE
 11886             MOVE ER-0846            TO  EMI-ERROR
 11887             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11888             GO TO 1430-CHECK-AH-TOLERANCE
 11889     ELSE
 11890         MOVE ER-0846                TO  EMI-ERROR
 11891         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11892         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 228
* EL156.cbl
 11893
 11894     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11895         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11896
 11897     GO TO 1430-CHECK-AH-TOLERANCE.
 11898
 11899 1425-CONT-WHOLE-MONTH-PMTS.
 11900******************************************************************
 11901****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11902****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11903****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11904******************************************************************
 11905
 11906     IF PI-COMPANY-ID = 'ACM'
 11907        NEXT SENTENCE
 11908     ELSE
 11909        IF DC-ODD-DAYS-OVER = +0
 11910            NEXT SENTENCE
 11911        ELSE
 11912            MOVE ER-0845            TO  EMI-ERROR
 11913            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11914            GO TO 1430-CHECK-AH-TOLERANCE.
 11915
 11916     COMPUTE PI-CPYAMT ROUNDED =
 11917                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11918
 11919 1430-CHECK-AH-TOLERANCE.
 11920     IF PI-PMT-APPR-SW = 'G'
 11921         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11922
 11923*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11924*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11925*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11926*
 11927*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11928*      IF WDF-MONTH = 02
 11929*        IF SAVE-ELAPSED-MONTHS = 0
 11930*          NEXT SENTENCE
 11931*        ELSE
 11932*          IF SAVE-ODD-DAYS-OVER > 0
 11933*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11934*            COMPUTE WS-PMT-MOS ROUNDED =
 11935*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11936*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11937*                                     WS-PMT-MOS
 11938*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11939*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11940*          ELSE
 11941*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11942*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11943*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11944*                                     WS-PMT-MOS.
 11945
 11946     IF WS-MAX-PMT-TOL NOT = ZERO
 11947        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11948           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11949            MOVE ER-0494         TO  EMI-ERROR
 11950            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 229
* EL156.cbl
 11951            GO TO 1500-EDIT-EXPENSES.
 11952
 11953 1430-CONT-CHECK-AH-TOLERANCE.
 11954
 11955     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11956        GO TO 1500-EDIT-EXPENSES.
 11957
 11958     IF CM-O-B-COVERAGE
 11959        GO TO 1500-EDIT-EXPENSES.
 11960
 11961     IF PI-COMPANY-ID = 'NCL'
 11962       IF FOUND-TOL-SW = 'Y'
 11963         IF WS-PMT-TOL NOT = ZERO
 11964           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11965              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11966                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11967                  IF WS-NCL-PMT-OPTION = SPACES
 11968                      MOVE ER-0699 TO EMI-ERROR
 11969                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11970                  ELSE
 11971                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11972                      NEXT SENTENCE
 11973                  ELSE
 11974                  IF NOT WS-VALID-NCL-OPTION
 11975                      MOVE ER-0699 TO EMI-ERROR
 11976                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11977
 11978     if pi-company-id = 'DCC'
 11979        and pdef-found
 11980        and pi-cpyamt < pi-epyamt
 11981           move er-1657          to emi-error
 11982           perform 1490-payment-error
 11983                                 thru 1490-exit
 11984     else
 11985        IF WS-PMT-TOL NOT = ZERO
 11986           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 11987              or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11988              MOVE ER-0495       TO EMI-ERROR
 11989              PERFORM 1490-PAYMENT-ERROR
 11990                                 THRU 1490-EXIT
 11991           end-if
 11992        end-if
 11993     end-if
 11994
 11995     GO TO 1500-EDIT-EXPENSES.
 11996
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 230
* EL156.cbl
 11998 1440-COMPUTE-LIFE-REMAINING.
 11999
 12000     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12001        IF PI-PMTTYPE = '4'
 12002          MOVE PI-EPYAMT TO PI-CPYAMT
 12003          GO TO 1460-TEST-TYPE.
 12004
 12005     IF WS-LF-COVERAGE-TYPE = 'L'
 12006        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12007                          - CL-TOTAL-PAID-AMT
 12008        GO TO 1450-CHECK-MAX.
 12009
 12010     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12011        PI-LF-COVERAGE-TYPE = 'P'
 12012          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12013                              CM-LF-ITD-DEATH-AMT
 12014          GO TO 1450-CHECK-MAX.
 12015
 12016     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12017     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12018     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12019     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12020     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12021     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12022     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12023     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12024     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12025
 12026     PERFORM 9800-LINK-REM-TERM.
 12027
 12028     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12029     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12030     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12031     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12032     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12033     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12034     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12035     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12036     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12037     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12038     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12039     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12040     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12041     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12042     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12043     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12044     IF PI-COMPANY-ID = 'DCC'
 12045        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12046        MOVE PI-CARRIER          TO ACCT-CARRIER
 12047        MOVE PI-GROUPING         TO ACCT-GROUPING
 12048        MOVE PI-STATE            TO ACCT-STATE
 12049        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12050        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12051        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12052        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12053
 12054
 12055* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 231
* EL156.cbl
 12056*          DATASET ('ERACCT')
 12057*          RIDFLD  (ERACCT-KEY)
 12058*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12059*          GTEQ
 12060*          resp    (WS-RESPONSE)
 12061*       END-EXEC
 12062     MOVE 'ERACCT' TO DFHEIV1
 12063*    MOVE '&"S        G          (  N#00011500' TO DFHEIV0
 12064     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12065     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12066     MOVE X'204E233030303131353030' TO DFHEIV0(25:11)
 12067     CALL 'kxdfhei1' USING DFHEIV0,
 12068           DFHEIV1,
 12069           DFHEIV20,
 12070           DFHEIV99,
 12071           ERACCT-KEY,
 12072           DFHEIV99,
 12073           DFHEIV99,
 12074           DFHEIV99
 12075     SET ADDRESS OF ACCOUNT-MASTER TO
 12076         DFHEIV20
 12077     MOVE EIBRESP  TO WS-RESPONSE
 12078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12079        IF WS-RESP-NORMAL
 12080           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12081           and (pi-cert-eff-dt < am-expiration-dt)
 12082           and (pi-cert-eff-dt >= am-effective-dt)
 12083           move am-dcc-product-code to pi-dcc-product-code
 12084        else
 12085           move spaces           to pi-dcc-product-code
 12086        end-if
 12087        if pi-dcc-product-code not = spaces
 12088           MOVE ' '              TO WS-PDEF-RECORD-SW
 12089           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12090           PERFORM 0900-GET-DDF-FACTORS
 12091                                 THRU 0900-EXIT
 12092           IF PDEF-FOUND
 12093              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12094                 (P1 > +8)
 12095                 OR (PD-PROD-CODE (P1) = 'L')
 12096              END-PERFORM
 12097              IF P1 < +9
 12098                 MOVE PD-MAX-AMT (P1)
 12099                                 TO CP-R-MAX-TOT-BEN
 12100              END-IF
 12101           END-IF
 12102        end-if
 12103     END-IF
 12104
 12105* EXEC CICS LINK
 12106*       PROGRAM  (LINK-REMAMT)
 12107*       COMMAREA (CALCULATION-PASS-AREA)
 12108*       LENGTH   (CP-COMM-LENGTH)
 12109*    END-EXEC.
 12110*    MOVE '."C                   (   #00011532' TO DFHEIV0
 12111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12113     MOVE X'2020233030303131353332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 232
* EL156.cbl
 12114     CALL 'kxdfhei1' USING DFHEIV0,
 12115           LINK-REMAMT,
 12116           CALCULATION-PASS-AREA,
 12117           CP-COMM-LENGTH,
 12118           DFHEIV99,
 12119           DFHEIV99,
 12120           DFHEIV99,
 12121           DFHEIV99
 12122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12123
 12124
 12125     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12126
 12127     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12128     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12129
 12130     IF PI-COMPANY-ID = 'BOA' AND
 12131        PI-PMTTYPE    = '2'   AND
 12132        PI-OFFLINE    = 'N'
 12133           GO TO 1441-COMPUTE-BOA-INTEREST.
 12134
 12135     IF PI-COMPANY-ID = 'NCL' AND
 12136        PI-PMTTYPE    = '2'   AND
 12137        PI-OFFLINE    = 'N'
 12138          GO TO 1442-COMPUTE-NCL-INTEREST
 12139       ELSE
 12140          GO TO 1445-CONTINUE.
 12141
 12142 1441-COMPUTE-BOA-INTEREST.
 12143     MOVE +0             TO WS-CALC-INT.
 12144
 12145     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12146     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12147     MOVE +0             TO DC-ELAPSED-MONTHS
 12148                            DC-ELAPSED-DAYS.
 12149     MOVE '1'            TO DC-OPTION-CODE.
 12150     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12151     IF NO-CONVERSION-ERROR
 12152         NEXT SENTENCE
 12153     ELSE
 12154         GO TO 1445-CONTINUE.
 12155
 12156     IF (PI-INT-RATE NOT > ZEROS)  AND
 12157        (DC-ELAPSED-DAYS > +30)
 12158         MOVE ER-3531            TO EMI-ERROR
 12159         MOVE -1                 TO PINTL
 12160         MOVE AL-UNBON           TO PINTA
 12161         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12162
 12163     IF PI-EPYAMT NOT > ZEROS
 12164         GO TO 1445-CONTINUE.
 12165
 12166     IF (PI-INT-RATE NOT > ZEROS)  OR
 12167        (DC-ELAPSED-DAYS NOT > +30)
 12168         MOVE PI-EPYAMT TO PI-CPYAMT
 12169         GO TO 1441-FORMAT-NOTE.
 12170
 12171     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 233
* EL156.cbl
 12172                                 *  PI-INT-RATE
 12173                                 *  DC-ELAPSED-DAYS
 12174                                 /  365
 12175                                 /  100.
 12176
 12177     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12178
 12179 1441-FORMAT-NOTE.
 12180
 12181     MOVE SPACES        TO WS-BOANOTE1.
 12182     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12183     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12184     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12185     MOVE AL-UANON      TO NOTE1A.
 12186
 12187     IF WS-CALC-INT > ZEROS
 12188         MOVE SPACES        TO WS-BOANOTE2
 12189         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12190         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12191         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12192         MOVE AL-UANON      TO NOTE2A.
 12193
 12194     GO TO 1445-CONTINUE.
 12195
 12196 1442-COMPUTE-NCL-INTEREST.
 12197     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12198     MOVE PI-STATE               TO WS-ST-ACCESS.
 12199     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12200     MOVE '3'                    TO CNTL-REC-TYPE.
 12201     MOVE +0                     TO CNTL-SEQ-NO.
 12202     MOVE 'STAT'                 TO FILE-SWITCH.
 12203
 12204     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12205
 12206     MOVE +0                 TO WS-CALC-INT.
 12207
 12208     IF ST-STAT-FROM-INCURRED
 12209         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12210       ELSE
 12211     IF ST-STAT-FROM-REPORTED
 12212         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12213       ELSE
 12214         GO TO 1445-CONTINUE.
 12215
 12216     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12217     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12218     MOVE +0                 TO DC-ELAPSED-MONTHS
 12219                                DC-ELAPSED-DAYS.
 12220     MOVE '1'                TO DC-OPTION-CODE.
 12221     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12222     IF NO-CONVERSION-ERROR
 12223         NEXT SENTENCE
 12224     ELSE
 12225         GO TO 1445-CONTINUE.
 12226
 12227     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12228        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12229         GO TO 1445-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 234
* EL156.cbl
 12230
 12231     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12232                                 *  CF-ST-STAT-INTEREST.
 12233
 12234     MOVE SPACES              TO WS-NCLNOTE1.
 12235     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12236     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12237     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12238                                 PI-PMTNOTE1
 12239                                 NOTE1I.
 12240     MOVE AL-UANON            TO NOTE1A.
 12241
 12242     IF WS-CALC-INT > ZEROS
 12243         MOVE SPACES          TO WS-NCLNOTE2
 12244         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12245         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12246         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12247                                 PI-PMTNOTE2
 12248                                 NOTE2I
 12249         MOVE AL-UANON        TO NOTE2A.
 12250
 12251     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12252
 12253 1445-CONTINUE.
 12254
 12255     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12256        GO TO 1460-TEST-TYPE.
 12257
 12258     IF CM-O-B-COVERAGE
 12259        GO TO 1460-TEST-TYPE.
 12260
 12261     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12262         GO TO 1450-CHECK-MAX.
 12263
 12264     if pi-company-id = 'DCC'
 12265        and pdef-found
 12266        and pi-epyamt > pd-max-amt (p1)
 12267        move er-1657             to emi-error
 12268        perform 1490-payment-error
 12269                                 thru 1490-exit
 12270        go to 1460-test-type
 12271     else
 12272        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12273           > PI-EPYAMT)
 12274                         OR
 12275           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12276           < PI-EPYAMT)
 12277           MOVE ER-0594          TO EMI-ERROR
 12278           PERFORM 1490-PAYMENT-ERROR
 12279                                 THRU 1490-EXIT
 12280           GO TO 1460-TEST-TYPE
 12281        end-if
 12282     end-if
 12283     .
 12284 1450-CHECK-MAX.
 12285
 12286     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12287        PI-LF-COVERAGE-TYPE = 'P'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 235
* EL156.cbl
 12288         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12289                                   CM-LF-ITD-DEATH-AMT
 12290     ELSE
 12291         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12292                                   CL-TOTAL-PAID-AMT.
 12293
 12294     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12295          MOVE ER-0543           TO EMI-ERROR
 12296          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12297
 12298 1460-TEST-TYPE.
 12299
 12300     IF PI-PMT-APPR-SW = 'G'
 12301       NEXT SENTENCE
 12302     ELSE
 12303       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12304         IF PI-EPYAMT = ZERO
 12305             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12306                 MOVE ER-0494    TO  EMI-ERROR
 12307                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12308                 GO TO 1500-EDIT-EXPENSES
 12309             ELSE
 12310                 NEXT SENTENCE
 12311         ELSE
 12312             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12313                 MOVE ER-0494    TO  EMI-ERROR
 12314                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12315                 GO TO 1500-EDIT-EXPENSES.
 12316
 12317     IF PI-PMTTYPE NOT = '2' OR
 12318        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12319         GO TO 1500-EDIT-EXPENSES.
 12320
 12321     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12322     MOVE ER-0526                TO EMI-ERROR.
 12323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12324
 12325     IF EMI-ERROR-NUMBER (1) = '0526'
 12326        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12327
 12328     IF EMI-ERROR-NUMBER (2) = '0526'
 12329        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12330
 12331     GO TO 1500-EDIT-EXPENSES.
 12332
 12333 1490-PAYMENT-ERROR.
 12334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12335
 12336     IF EMI-MESSAGE-FORMATTED
 12337         MOVE -1                 TO EPYAMTL
 12338         MOVE AL-UNBON           TO EPYAMTA.
 12339
 12340 1490-EXIT.
 12341      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 236
* EL156.cbl
 12343 1500-EDIT-EXPENSES.
 12344     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12345         GO TO 1500-SKIP-ERROR-0556.
 12346
 12347 1500-CONTINUE-ON.
 12348
 12349     IF CM-O-B-COVERAGE
 12350        MOVE ER-0556             TO EMI-ERROR
 12351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12352
 12353 1500-SKIP-ERROR-0556.
 12354     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12355        IF PI-EEXPENS NOT = ZEROS
 12356           MOVE ER-0524          TO EMI-ERROR
 12357           GO TO 1590-EXPENSE-ERROR
 12358        ELSE
 12359           GO TO 1600-EDIT-RESERVES.
 12360
 12361     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12362     MOVE '6'                    TO CNTL-REC-TYPE.
 12363
 12364     IF CONTROL-IS-ACTUAL-CARRIER
 12365         MOVE PI-CARRIER         TO WS-CARR
 12366     ELSE
 12367         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12368
 12369     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12370     MOVE +0                     TO CNTL-SEQ-NO.
 12371     MOVE 'CARR'                 TO FILE-SWITCH.
 12372
 12373     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12374
 12375     IF EXPENSE-CALC-MANUAL
 12376        GO TO 1600-EDIT-RESERVES.
 12377
 12378     IF DOLLARS-PER-PMT
 12379        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12380        GO TO 1600-EDIT-RESERVES.
 12381
 12382     IF DOLLARS-PER-MONTH AND
 12383        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12384       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12385       GO TO 1600-EDIT-RESERVES.
 12386
 12387     IF PERCENT-OF-PAYMENT
 12388        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12389
 12390     GO TO 1600-EDIT-RESERVES.
 12391
 12392 1590-EXPENSE-ERROR.
 12393     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12394
 12395     IF EMI-MESSAGE-FORMATTED
 12396        MOVE -1                  TO EEXPENSL
 12397        MOVE AL-UNBON            TO EEXPENSA.
 12398
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 237
* EL156.cbl
 12400 1600-EDIT-RESERVES.
 12401     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12402        IF PI-ERESV = ZEROS
 12403           GO TO 1700-EDIT-EXPENSE-TYPE
 12404        ELSE
 12405           MOVE ER-0525          TO EMI-ERROR
 12406           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12407           GO TO 1700-EDIT-EXPENSE-TYPE.
 12408
 12409     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12410     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12411     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12412
 12413     IF NOT AT-MANUAL-RESERVES-USED
 12414        IF PI-ERESV NOT = ZEROS
 12415           MOVE ER-0518          TO EMI-ERROR
 12416           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12417
 12418     IF AT-MANUAL-RESERVES-USED
 12419        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12420        GO TO 1700-EDIT-EXPENSE-TYPE.
 12421
 12422     IF AT-FUTURE-RESERVES-USED
 12423        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12424
 12425     IF AT-FUTURE-RESERVES-USED
 12426        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12427
 12428     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12429        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12430
 12431     IF AT-IBNR-RESERVES-USED
 12432        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12433
 12434     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12435     GO TO 1700-EDIT-EXPENSE-TYPE.
 12436
 12437 1690-RESERVE-ERROR.
 12438     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12439
 12440     IF EMI-MESSAGE-FORMATTED
 12441        MOVE AL-UNBON            TO ERESVA
 12442        MOVE -1                  TO ERESVL.
 12443
 12444 1690-EXIT.
 12445      EXIT.
 12446
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 238
* EL156.cbl
 12448 1700-EDIT-EXPENSE-TYPE.
 12449     IF PI-PMTTYPE NOT = '5' AND '6'
 12450        GO TO 2000-EDIT-DONE.
 12451
 12452     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12453                   '6' OR '7' OR '8' OR '9'
 12454        GO TO 2000-EDIT-DONE.
 12455
 12456 1705-EXPENSE-ERROR.
 12457     MOVE ER-0573                TO EMI-ERROR.
 12458     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12459
 12460     IF EMI-MESSAGE-FORMATTED
 12461        MOVE AL-UABON            TO ETYPEA
 12462        MOVE -1                  TO ETYPEL.
 12463
 12464     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 239
* EL156.cbl
 12466 1950-NOT-FOUND.
 12467     IF FILE-SWITCH = 'MSTR'
 12468        MOVE ER-0204             TO EMI-ERROR.
 12469
 12470     IF FILE-SWITCH = 'CARR'
 12471        MOVE ER-0252             TO EMI-ERROR.
 12472
 12473     IF FILE-SWITCH = 'COMP'
 12474        MOVE ER-0254             TO EMI-ERROR.
 12475
 12476     IF FILE-SWITCH = 'STAT'
 12477        MOVE ER-0149             TO EMI-ERROR.
 12478
 12479     IF FILE-SWITCH = 'PROC'
 12480        MOVE ER-0019             TO EMI-ERROR.
 12481
 12482     IF FILE-SWITCH = 'ACCT'
 12483        MOVE ER-0198             TO EMI-ERROR.
 12484
 12485     IF FILE-SWITCH = 'BENE'
 12486        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12487           MOVE ER-0282          TO EMI-ERROR
 12488        ELSE
 12489           MOVE ER-0283          TO EMI-ERROR.
 12490
 12491     MOVE -1                     TO PMTTYPEL.
 12492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12493
 12494     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12495                                     WS-FORCE-CTR.
 12496
 12497     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12498                                     WS-FATAL-CTR.
 12499
 12500     GO TO 8200-SEND-DATAONLY.
 12501
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 240
* EL156.cbl
 12503 2000-EDIT-DONE.
 12504     if pi-company-id = 'DCC'
 12505        and cl-critical-period > 0
 12506        perform 2210-dcc-max-benes thru 2210-exit
 12507     else
 12508     IF (WS-SPECIAL-CALC-CD = 'C')
 12509*       AND (CM-AH-CRITICAL-PERIOD) > 0
 12510        and (cl-critical-period > 0)
 12511        IF CM-AH-BENEFIT-AMT NOT = ZERO
 12512           IF PI-EPYAMT > ZEROS
 12513              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12514                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12515           ELSE
 12516              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12517                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12518           END-IF
 12519*          IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 12520           if ws-crit-period-days > cl-critical-period
 12521              MOVE ER-0657          TO EMI-ERROR
 12522              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12523           END-IF
 12524        END-IF
 12525     END-IF
 12526     end-if
 12527     IF PI-HOLDTIL NOT = ZEROS
 12528        MOVE PI-HOLDTIL          TO HOLDTILO
 12529        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12530
 12531     IF PI-EPYFROM NOT = ZEROS
 12532        MOVE PI-EPYFROM          TO EPYFROMO
 12533        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12534
 12535     IF PI-EPYTHRU NOT = ZEROS
 12536        MOVE PI-EPYTHRU            TO EPYTHRUO
 12537        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12538        IF PI-USES-PAID-TO
 12539           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12540           MOVE '4'                TO DC-OPTION-CODE
 12541           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12542           IF NO-CONVERSION-ERROR
 12543              MOVE +1              TO DC-ELAPSED-DAYS
 12544              MOVE +0              TO DC-ELAPSED-MONTHS
 12545              MOVE '6'             TO DC-OPTION-CODE
 12546              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12547              IF NO-CONVERSION-ERROR
 12548                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12549
 12550     MOVE PI-EDAYS               TO EDAYSO.
 12551
 12552     IF PI-AIGFROM NOT = ZEROS
 12553        MOVE PI-AIGFROM          TO AIGFROMO
 12554        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12555
 12556     MOVE PI-EPYAMT              TO EPYAMTO.
 12557     MOVE PI-ERESV               TO ERESVO.
 12558     MOVE PI-EEXPENS             TO EEXPENSO.
 12559
 12560     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 241
* EL156.cbl
 12561     MOVE SPACES                 TO DC-OPTION-CODE.
 12562     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12563
 12564     IF DATE-CONVERSION-ERROR
 12565        MOVE SPACES              TO CPYFROMI
 12566     ELSE
 12567        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12568        IF PI-EPYFROM = ZEROS
 12569           MOVE AL-UANON             TO EPYFROMA
 12570           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12571           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12572
 12573     IF PI-USES-PAID-TO
 12574        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12575        MOVE +1                            TO DC-ELAPSED-DAYS
 12576        MOVE +0                            TO DC-ELAPSED-MONTHS
 12577        MOVE '6'                           TO DC-OPTION-CODE
 12578        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12579        IF NO-CONVERSION-ERROR
 12580           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12581           IF PI-EPYTHRU = ZEROS
 12582              MOVE AL-UANON                TO EPYTHRUA
 12583              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12584              MOVE ' '                     TO DC-OPTION-CODE
 12585              MOVE +0                      TO DC-ELAPSED-DAYS
 12586                                              DC-ELAPSED-MONTHS
 12587              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12588              IF NO-CONVERSION-ERROR
 12589                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12590                  GO TO 2001-CONTINUE
 12591              ELSE
 12592                  GO TO 2001-CONTINUE
 12593           ELSE
 12594              GO TO 2001-CONTINUE.
 12595
 12596     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12597     MOVE SPACES                 TO DC-OPTION-CODE.
 12598     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12599
 12600     IF DATE-CONVERSION-ERROR
 12601        MOVE SPACES              TO CPYTHRUI
 12602     ELSE
 12603        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12604        IF PI-EPYTHRU = ZEROS
 12605           MOVE AL-UANON TO EPYTHRUA
 12606           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12607           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12608
 12609 2001-CONTINUE.
 12610
 12611     MOVE PI-CDAYS               TO CDAYSO.
 12612
 12613     IF PI-EDAYS = ZEROS
 12614        MOVE AL-UNNON TO EDAYSA
 12615        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12616
 12617     MOVE PI-CPYAMT              TO CPYAMTO.
 12618
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 242
* EL156.cbl
 12619     IF PI-EPYAMT = ZEROS
 12620        MOVE AL-UNNON            TO EPYAMTA
 12621        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12622
 12623     MOVE PI-CRESV               TO CRESVO.
 12624     MOVE PI-CEXPENS             TO CEXPENSO.
 12625
 12626     IF PI-EEXPENS = ZEROS
 12627        MOVE AL-UNNON TO EEXPENSA
 12628        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12629
 12630     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12631        AND (CL-CLAIM-TYPE = 'L')
 12632        AND (PI-OFFLINE NOT EQUAL 'Y')
 12633        IF PI-PMTTYPE = '2' OR '4'
 12634           PERFORM 2200-CALC-INTEREST
 12635                                 THRU 2200-EXIT
 12636        END-IF
 12637     END-IF
 12638     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12639     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12640     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12641
 12642     IF EMI-FATAL-CTR = ZEROS
 12643        MOVE 'B'                 TO PI-PASS-SW.
 12644
 12645     IF NOT EMI-MESSAGE-FORMATTED
 12646         MOVE -1                 TO EPYFROML
 12647     ELSE
 12648         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12649            EMI-ERROR-NUMBER (2) = SPACES
 12650             MOVE -1             TO EPYFROML.
 12651
 12652     GO TO 8200-SEND-DATAONLY.
 12653
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 243
* EL156.cbl
 12655 2200-CALC-INTEREST.
 12656     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12657        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12658        MOVE '4'                 TO DC-OPTION-CODE
 12659        PERFORM 9700-LINK-DATE-CONVERT
 12660        IF DATE-CONVERSION-ERROR
 12661            MOVE LOW-VALUES      TO CP-PRF-DT
 12662        ELSE
 12663           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12664        END-IF
 12665     END-IF
 12666     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12667        IN CLAIM-INT-PASS-AREA
 12668     MOVE CL-CERT-STATE          TO CP-STATE
 12669        IN CLAIM-INT-PASS-AREA
 12670     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12671     MOVE 'LF'                   TO CP-COVERAGE
 12672     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12673     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12674     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12675     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12676     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12677     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12678
 12679* EXEC CICS LINK
 12680*       PROGRAM   ('ELCLMI')
 12681*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12682*       LENGTH    (CP-CLAIM-LENGTH)
 12683*    END-EXEC
 12684     MOVE 'ELCLMI' TO DFHEIV1
 12685*    MOVE '."C                   (   #00012091' TO DFHEIV0
 12686     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12688     MOVE X'2020233030303132303931' TO DFHEIV0(25:11)
 12689     CALL 'kxdfhei1' USING DFHEIV0,
 12690           DFHEIV1,
 12691           CLAIM-INT-PASS-AREA,
 12692           CP-CLAIM-LENGTH,
 12693           DFHEIV99,
 12694           DFHEIV99,
 12695           DFHEIV99,
 12696           DFHEIV99
 12697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12698     MOVE AL-PANOF               TO PINTHA
 12699                                    PINTA
 12700     IF NO-CI-ERROR
 12701        MOVE CP-CLM-INT-AMT      TO PINTO
 12702                                    PI-INT-AMT
 12703        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12704        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12705        MOVE AL-PANOF            TO PINTHA
 12706                                    PINTA
 12707     ELSE
 12708        IF CI-RETURN-CODE = '8'
 12709           MOVE ER-3818          TO EMI-ERROR
 12710           MOVE -1               TO ZINTL
 12711           PERFORM 9900-ERROR-FORMAT
 12712                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 244
* EL156.cbl
 12713           GO TO 2200-EXIT
 12714        ELSE
 12715           MOVE ZEROS            TO PINTO
 12716                                    PI-INT-AMT
 12717                                    PI-INT-DAYS
 12718                                    PI-INT-RATE-USED
 12719        END-IF
 12720     END-IF
 12721     IF PI-INT-AMT NOT = ZEROS
 12722        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12723           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12724           CONTINUE
 12725        ELSE
 12726           MOVE CL-SOC-SEC-NO (1:3)
 12727                                 TO WS-SSN (1:3)
 12728           MOVE CL-SOC-SEC-NO (5:2)
 12729                                 TO WS-SSN (4:2)
 12730           MOVE CL-SOC-SEC-NO (8:4)
 12731                                 TO WS-SSN (6:4)
 12732           IF (WS-SSN NUMERIC)
 12733              AND (WS-SSN NOT = ZEROS)
 12734              CONTINUE
 12735           ELSE
 12736              MOVE ER-2044       TO EMI-ERROR
 12737              PERFORM 9900-ERROR-FORMAT
 12738                                 THRU 9900-EXIT
 12739           END-IF
 12740        END-IF
 12741        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12742        MOVE +51                 TO TRLR-SEQ-NO
 12743
 12744* EXEC CICS READ
 12745*          DATASET  ('ELTRLR')
 12746*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12747*          RIDFLD   (ELTRLR-KEY)
 12748*          RESP     (WS-RESPONSE)
 12749*       END-EXEC
 12750     MOVE 'ELTRLR' TO DFHEIV1
 12751*    MOVE '&"S        E          (  N#00012141' TO DFHEIV0
 12752     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12754     MOVE X'204E233030303132313431' TO DFHEIV0(25:11)
 12755     CALL 'kxdfhei1' USING DFHEIV0,
 12756           DFHEIV1,
 12757           DFHEIV20,
 12758           DFHEIV99,
 12759           ELTRLR-KEY,
 12760           DFHEIV99,
 12761           DFHEIV99,
 12762           DFHEIV99
 12763     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12764         DFHEIV20
 12765     MOVE EIBRESP  TO WS-RESPONSE
 12766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12767        IF (NOT WS-RESP-NORMAL)
 12768                    OR
 12769           ((WS-RESP-NORMAL)
 12770           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 245
* EL156.cbl
 12771           OR (AT-CITY-STATE = SPACES)))
 12772           MOVE ER-0874          TO EMI-ERROR
 12773           PERFORM 9900-ERROR-FORMAT
 12774                                 THRU 9900-EXIT
 12775        END-IF
 12776     END-IF
 12777     .
 12778 2200-EXIT.
 12779     EXIT.
 12780 2210-dcc-max-benes.
 12781
 12782     move cm-ah-benefit-amt      to ws-monthly-benefit
 12783     if pdef-found
 12784        and pd-max-amt (p1) < ws-monthly-benefit
 12785        move pd-max-amt (p1)     to ws-monthly-benefit
 12786     end-if
 12787
 12788     move cl-cert-key-data       to elcrtt-key (2:21)
 12789     move cl-company-cd          to ctrlr-comp-cd
 12790     move cl-cert-no             to ctrlr-cert-no
 12791     move 'B'                    to ctrlr-rec-type
 12792
 12793
 12794* EXEC CICS READ
 12795*       DATASET  ('ELCRTT')
 12796*       set      (address of CERTIFICATE-TRAILERS)
 12797*       RIDFLD   (ELCRTT-KEY)
 12798*       RESP     (WS-RESPONSE)
 12799*    END-EXEC
 12800     MOVE 'ELCRTT' TO DFHEIV1
 12801*    MOVE '&"S        E          (  N#00012173' TO DFHEIV0
 12802     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12803     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12804     MOVE X'204E233030303132313733' TO DFHEIV0(25:11)
 12805     CALL 'kxdfhei1' USING DFHEIV0,
 12806           DFHEIV1,
 12807           DFHEIV20,
 12808           DFHEIV99,
 12809           ELCRTT-KEY,
 12810           DFHEIV99,
 12811           DFHEIV99,
 12812           DFHEIV99
 12813     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12814         DFHEIV20
 12815     MOVE EIBRESP  TO WS-RESPONSE
 12816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12817     IF not WS-RESP-NORMAL
 12818        go to 2210-exit
 12819     end-if
 12820
 12821*    if instypei = 'P'
 12822*       move +1 to s1
 12823*    else
 12824*       MOVE +2 to s1
 12825*    end-if
 12826
 12827     move +1 to s1
 12828     evaluate cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 246
* EL156.cbl
 12829        when 'A'
 12830           move +1 to s2
 12831        when 'I'
 12832           move +2 to s2
 12833        when 'G'
 12834           move +3 to s2
 12835        when 'L'
 12836           move +4 to s2
 12837        when 'P'
 12838           move +5 to s2
 12839     end-evaluate
 12840
 12841     if pi-epyamt > zeros
 12842        compute ws-crit-period-days =
 12843           (cs-total-paid (s1 s2) + PI-EPYAMT)
 12844           / ws-monthly-benefit
 12845     else
 12846        compute ws-crit-period-days =
 12847           (cs-total-paid (s1 s2) + PI-CPYAMT)
 12848           / ws-monthly-benefit
 12849     end-if
 12850
 12851     if ws-crit-period-days > cl-critical-period
 12852*    if ws-crit-period-days > pd-crit-period (p1)
 12853        move er-1658             to emi-error
 12854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12855     end-if
 12856
 12857     .
 12858 2210-exit.
 12859     exit.
 12860
 12861 2220-update-elcrtt.
 12862
 12863
 12864* EXEC CICS GETMAIN
 12865*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 12866*       LENGTH   (ELCRTT-LENGTH)
 12867*       INITIMG  (GETMAIN-SPACE)
 12868*    END-EXEC
 12869*    MOVE ',"IL                  $   #00012225' TO DFHEIV0
 12870     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12871     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12872     MOVE X'2020233030303132323235' TO DFHEIV0(25:11)
 12873     CALL 'kxdfhei1' USING DFHEIV0,
 12874           DFHEIV20,
 12875           ELCRTT-LENGTH,
 12876           GETMAIN-SPACE
 12877     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12878         DFHEIV20
 12879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12880
 12881     move cl-cert-key-data       to elcrtt-key (2:21)
 12882     move cl-company-cd          to ctrlr-comp-cd
 12883     move cl-cert-no             to ctrlr-cert-no
 12884     move 'B'                    to ctrlr-rec-type
 12885
 12886
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 247
* EL156.cbl
 12887* EXEC CICS READ
 12888*       UPDATE
 12889*       DATASET  (ELCRTT-DSID)
 12890*       into     (CERTIFICATE-TRAILERS)
 12891*       RIDFLD   (ELCRTT-KEY)
 12892*       RESP     (WS-RESPONSE)
 12893*    END-EXEC
 12894     MOVE LENGTH OF
 12895      CERTIFICATE-TRAILERS
 12896       TO DFHEIV11
 12897*    MOVE '&"IL       EU         (  N#00012236' TO DFHEIV0
 12898     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12899     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12900     MOVE X'204E233030303132323336' TO DFHEIV0(25:11)
 12901     CALL 'kxdfhei1' USING DFHEIV0,
 12902           ELCRTT-DSID,
 12903           CERTIFICATE-TRAILERS,
 12904           DFHEIV11,
 12905           ELCRTT-KEY,
 12906           DFHEIV99,
 12907           DFHEIV99,
 12908           DFHEIV99
 12909     MOVE EIBRESP  TO WS-RESPONSE
 12910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12911
 12912     IF WS-RESP-NORMAL
 12913        perform 2225-upd-crt-trlr thru 2225-exit
 12914
 12915* EXEC CICS REWRITE
 12916*          DATASET  (ELCRTT-DSID)
 12917*          from     (CERTIFICATE-TRAILERS)
 12918*          RESP     (WS-RESPONSE)
 12919*       END-EXEC
 12920     MOVE LENGTH OF
 12921      CERTIFICATE-TRAILERS
 12922       TO DFHEIV11
 12923*    MOVE '&& L                  %  N#00012246' TO DFHEIV0
 12924     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12925     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12926     MOVE X'204E233030303132323436' TO DFHEIV0(25:11)
 12927     CALL 'kxdfhei1' USING DFHEIV0,
 12928           ELCRTT-DSID,
 12929           CERTIFICATE-TRAILERS,
 12930           DFHEIV11,
 12931           DFHEIV99
 12932     MOVE EIBRESP  TO WS-RESPONSE
 12933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12934     else
 12935        if ws-resp-notfnd
 12936           move 'CS'             to certificate-trailers
 12937           move cl-company-cd    to cs-company-cd
 12938           move cl-cert-key-data to cs-control-primary (2:21)
 12939           move cl-cert-no       to cs-cert-no
 12940           move 'B'              to cs-trailer-type
 12941           perform varying s1 from +1 by +1 until s1 > +2
 12942              perform varying s2 from +1 by +1 until s2 > +10
 12943                 move zeros      to cs-bank (s1 s2)
 12944                                    cs-no-of-claims (s1 s2)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 248
* EL156.cbl
 12945                                    cs-days-paid (s1 s2)
 12946                                    cs-total-paid (s1 s2)
 12947              end-perform
 12948           end-perform
 12949           perform 2225-upd-crt-trlr
 12950                                 thru 2225-exit
 12951
 12952* EXEC CICS WRITE
 12953*             DATASET  (ELCRTT-DSID)
 12954*             from     (CERTIFICATE-TRAILERS)
 12955*             RIDFLD   (cs-control-primary)
 12956*             RESP     (WS-RESPONSE)
 12957*          END-EXEC
 12958     MOVE LENGTH OF
 12959      CERTIFICATE-TRAILERS
 12960       TO DFHEIV11
 12961*    MOVE '&$ L                  ''  N#00012268' TO DFHEIV0
 12962     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12963     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12964     MOVE X'204E233030303132323638' TO DFHEIV0(25:11)
 12965     CALL 'kxdfhei1' USING DFHEIV0,
 12966           ELCRTT-DSID,
 12967           CERTIFICATE-TRAILERS,
 12968           DFHEIV11,
 12969           cs-control-primary,
 12970           DFHEIV99,
 12971           DFHEIV99
 12972     MOVE EIBRESP  TO WS-RESPONSE
 12973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12974        end-if
 12975     END-IF
 12976
 12977     .
 12978 2220-exit.
 12979     exit.
 12980
 12981 2225-upd-crt-trlr.
 12982
 12983*    if instypei = 'P'
 12984*       move +1 to s1
 12985*    else
 12986*       MOVE +2 to s1
 12987*    end-if
 12988
 12989     move +1 to s1
 12990     evaluate cl-claim-type
 12991        when 'A'
 12992           move +1 to s2
 12993        when 'I'
 12994           move +2 to s2
 12995        when 'G'
 12996           move +3 to s2
 12997        when 'L'
 12998           move +4 to s2
 12999        when 'P'
 13000           move +5 to s2
 13001     end-evaluate
 13002
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 249
* EL156.cbl
 13003     compute cs-total-paid (s1 s2) = cs-total-paid (s1 s2) +
 13004        at-amount-paid
 13005     compute cs-days-paid (s1 s2) = cs-days-paid (s1 s2) +
 13006        at-days-in-period
 13007
 13008     .
 13009 2225-exit.
 13010     exit.
 13011 3000-MOVE-INPUT-TO-SAVE-AREA.
 13012     IF PMTTYPEL > 0
 13013         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13014
 13015     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13016
 13017     IF WS-PMTTYPE = '9'
 13018         MOVE 'P'                TO PI-PROVISIONAL-IND
 13019         MOVE '1'                TO WS-PMTTYPE.
 13020
 13021     IF PAYEEL > 0
 13022         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13023         MOVE PAYEEI             TO WS-PAYEE.
 13024
 13025     IF NOTE1L > +0
 13026         MOVE NOTE1I             TO WS-PMTNOTE1
 13027                                    WS-FLI-PMTNOTE
 13028                                    WS-HAN-PMTNOTE.
 13029
 13030     IF NOTE2L > +0
 13031         MOVE NOTE2I             TO WS-PMTNOTE2.
 13032
 13033     IF OFFLINEL > 0
 13034         MOVE OFFLINEI           TO WS-OFFLINE.
 13035
 13036     IF PROOFDTL > 0
 13037         MOVE PROOFDTI            TO DATE-WORK
 13038         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13039         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13040         MOVE '4'                 TO DC-OPTION-CODE
 13041         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13042         IF NO-CONVERSION-ERROR
 13043            MOVE NUM-WORK         TO PROOFDTO
 13044            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13045            MOVE NUM-WORK         TO WS-PROOF-DATE
 13046         ELSE
 13047            MOVE ZEROS            TO WS-PROOF-DATE
 13048         END-IF
 13049     END-IF.
 13050
 13051     IF EOBYNL > +0
 13052         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13053         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13054     END-IF
 13055
 13056     IF CLMFMYNL > +0
 13057         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13058         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13059     END-IF
 13060
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 250
* EL156.cbl
 13061     IF SURVYYNL > +0
 13062         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13063         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13064     END-IF
 13065
 13066     IF SPRELYNL > +0
 13067         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13068         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13069     END-IF
 13070*    IF GROUPEDL > +0
 13071*        MOVE GROUPEDI           TO WS-GROUPED.
 13072*
 13073*    IF CASHL > +0
 13074*       MOVE CASHI               TO WS-CASH.
 13075     IF LOANNOL > +0
 13076         MOVE LOANNOI            TO WS-LOAN-NO.
 13077
 13078     IF CHECKNOL > 0
 13079         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13080
 13081     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13082         IF WS-AIG-CREDIT-ENTERED
 13083             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13084             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13085             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13086             MOVE AL-UANON         TO CHECKNOA.
 13087
 13088     IF HOLDTILL > 0
 13089         MOVE HOLDTILI           TO DATE-WORK
 13090         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13091         MOVE NUM-WORK           TO WS-HOLDTIL.
 13092
 13093     IF ZINTL > +0
 13094
 13095* EXEC CICS BIF DEEDIT
 13096*           FIELD   (ZINTI)
 13097*           LENGTH  (07)
 13098*       END-EXEC
 13099     MOVE 07
 13100       TO DFHEIV11
 13101*    MOVE '@"L                   #   #00012394' TO DFHEIV0
 13102     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13103     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13104     MOVE X'2020233030303132333934' TO DFHEIV0(25:11)
 13105     CALL 'kxdfhei1' USING DFHEIV0,
 13106           ZINTI,
 13107           DFHEIV11
 13108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13109        IF ZINTI NOT NUMERIC
 13110           MOVE ER-0419          TO EMI-ERROR
 13111           PERFORM 9900-ERROR-FORMAT
 13112           MOVE AL-UABON         TO ZINTA
 13113           MOVE -1               TO ZINTL
 13114        ELSE
 13115           MOVE ZINTI            TO CP-INT-RATE
 13116                                    WS-INT-RATE
 13117           MOVE CP-INT-RATE      TO ZINTO
 13118           MOVE AL-UNNON         TO ZINTA
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 251
* EL156.cbl
 13119        END-IF
 13120     ELSE
 13121        MOVE ZEROS               TO CP-INT-RATE
 13122     END-IF
 13123     IF EPYFROML > 0
 13124         MOVE EPYFROMI           TO DATE-WORK
 13125         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13126         MOVE NUM-WORK           TO WS-EPYFROM.
 13127
 13128     IF AIGFROML > 0
 13129         MOVE AIGFROMI           TO DATE-WORK
 13130         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13131         MOVE NUM-WORK           TO WS-AIGFROM
 13132     ELSE
 13133         IF (AIGFROMI = LOW-VALUES) AND
 13134            (PI-AIGFROM NOT = ZEROS)
 13135              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13136
 13137     IF EPYTHRUL > +0
 13138        MOVE EPYTHRUI           TO DATE-WORK
 13139        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13140        MOVE NUM-WORK           TO WS-EPYTHRU
 13141        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13142        MOVE '4'                TO DC-OPTION-CODE
 13143        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13144        IF NO-CONVERSION-ERROR
 13145           IF PI-USES-PAID-TO
 13146              MOVE '6'                TO DC-OPTION-CODE
 13147              MOVE -1                 TO DC-ELAPSED-DAYS
 13148              MOVE +0                 TO DC-ELAPSED-MONTHS
 13149              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13150              IF NO-CONVERSION-ERROR
 13151                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13152                 MOVE ' '             TO DC-OPTION-CODE
 13153                 MOVE +0              TO DC-ELAPSED-DAYS
 13154                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13155              IF NO-CONVERSION-ERROR
 13156                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13157
 13158*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13159*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13160     IF EDAYSL > 0
 13161
 13162* EXEC CICS BIF DEEDIT
 13163*            FIELD(EDAYSI)
 13164*            LENGTH(6)
 13165*        END-EXEC
 13166     MOVE 6
 13167       TO DFHEIV11
 13168*    MOVE '@"L                   #   #00012450' TO DFHEIV0
 13169     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13170     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13171     MOVE X'2020233030303132343530' TO DFHEIV0(25:11)
 13172     CALL 'kxdfhei1' USING DFHEIV0,
 13173           EDAYSI,
 13174           DFHEIV11
 13175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13176         MOVE EDAYSI             TO WS-DY-WORK
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 252
* EL156.cbl
 13177         IF WS-DY-SIGN = SPACES
 13178            MOVE WS-DY-NUM       TO WS-EDAYS
 13179            ADD 0                TO WS-EDAYS
 13180         ELSE
 13181            MOVE EDAYSI          TO WS-EDAYS
 13182            ADD 0                TO WS-EDAYS.
 13183
 13184*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13185*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13186     IF EPYAMTL > 0
 13187
 13188* EXEC CICS BIF DEEDIT
 13189*            FIELD(EPYAMTI)
 13190*            LENGTH(10)
 13191*        END-EXEC
 13192     MOVE 10
 13193       TO DFHEIV11
 13194*    MOVE '@"L                   #   #00012465' TO DFHEIV0
 13195     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13196     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13197     MOVE X'2020233030303132343635' TO DFHEIV0(25:11)
 13198     CALL 'kxdfhei1' USING DFHEIV0,
 13199           EPYAMTI,
 13200           DFHEIV11
 13201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13202         MOVE EPYAMTI            TO WS-PY-WORK
 13203         IF WS-PY-SIGN = SPACES
 13204            MOVE WS-PY-NUM       TO WS-EPYAMT
 13205            ADD 0                TO WS-EPYAMT
 13206         ELSE
 13207            MOVE EPYAMTI         TO WS-EPYAMT
 13208            ADD 0                TO WS-EPYAMT.
 13209
 13210     IF ERESVL > 0
 13211
 13212* EXEC CICS BIF DEEDIT
 13213*            FIELD(ERESVI)
 13214*            LENGTH(9)
 13215*        END-EXEC
 13216     MOVE 9
 13217       TO DFHEIV11
 13218*    MOVE '@"L                   #   #00012478' TO DFHEIV0
 13219     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13220     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13221     MOVE X'2020233030303132343738' TO DFHEIV0(25:11)
 13222     CALL 'kxdfhei1' USING DFHEIV0,
 13223           ERESVI,
 13224           DFHEIV11
 13225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13226         MOVE ERESVI TO WS-ERESV.
 13227
 13228     IF EEXPENSL > 0
 13229
 13230* EXEC CICS BIF DEEDIT
 13231*            FIELD(EEXPENSI)
 13232*            LENGTH(8)
 13233*        END-EXEC
 13234     MOVE 8
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 253
* EL156.cbl
 13235       TO DFHEIV11
 13236*    MOVE '@"L                   #   #00012485' TO DFHEIV0
 13237     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13238     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13239     MOVE X'2020233030303132343835' TO DFHEIV0(25:11)
 13240     CALL 'kxdfhei1' USING DFHEIV0,
 13241           EEXPENSI,
 13242           DFHEIV11
 13243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13244         MOVE EEXPENSI           TO WS-EEXPENS.
 13245
 13246     IF ETYPEL > ZEROS
 13247         MOVE ETYPEI             TO WS-ETYPE.
 13248
 13249     IF PI-COMPANY-ID = 'BOA'
 13250        IF PINTL > ZEROS
 13251
 13252* EXEC CICS BIF DEEDIT
 13253*            FIELD (PINTI)
 13254*            LENGTH(05)
 13255*          END-EXEC
 13256     MOVE 05
 13257       TO DFHEIV11
 13258*    MOVE '@"L                   #   #00012496' TO DFHEIV0
 13259     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13260     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13261     MOVE X'2020233030303132343936' TO DFHEIV0(25:11)
 13262     CALL 'kxdfhei1' USING DFHEIV0,
 13263           PINTI,
 13264           DFHEIV11
 13265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13266           IF PINTI NUMERIC
 13267               MOVE AL-UNNON     TO PINTA
 13268               MOVE PINTI        TO WS-INT-RATE
 13269               MOVE WS-INT-RATE  TO PINTO.
 13270
 13271 3000-EXIT.
 13272     EXIT.
 13273
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 254
* EL156.cbl
 13275 3050-REBUILD-ENTERED.
 13276
 13277     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13278
 13279     IF PI-PROV-PMT
 13280         MOVE '9'           TO PMTTYPEO
 13281     ELSE
 13282         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13283
 13284     MOVE PI-PAYEE          TO PAYEEO.
 13285     MOVE PI-PMTNOTE1       TO NOTE1O.
 13286     MOVE PI-PMTNOTE2       TO NOTE2O.
 13287     MOVE PI-OFFLINE        TO OFFLINEO.
 13288     IF PI-PROOF-DATE NOT = ZEROS
 13289         MOVE PI-PROOF-DATE TO PROOFDTO
 13290         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13291     END-IF.
 13292*    MOVE PI-GROUPED        TO GROUPEDO.
 13293
 13294*    MOVE PI-CASH           TO CASHO.
 13295
 13296     IF PI-INT-RATE > ZEROS
 13297         MOVE PI-INT-RATE   TO PINTO.
 13298
 13299     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13300        IF PI-INT-AMT > ZEROS
 13301           MOVE PI-INT-AMT       TO PINTO
 13302           MOVE AL-PANOF         TO PINTA
 13303                                    PINTHA
 13304        END-IF
 13305     END-IF
 13306     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13307     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13308     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13309     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13310     IF PI-HOLDTIL NOT = ZEROS
 13311        MOVE PI-HOLDTIL          TO HOLDTILO
 13312        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13313
 13314     IF PI-EPYFROM NOT = ZEROS
 13315        MOVE PI-EPYFROM          TO EPYFROMO
 13316        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13317
 13318     IF PI-AIGFROM NOT = ZEROS
 13319        MOVE PI-AIGFROM          TO AIGFROMO
 13320        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13321
 13322     IF PI-EPYTHRU NOT = ZEROS
 13323        MOVE PI-EPYTHRU          TO EPYTHRUO
 13324        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13325        IF PI-USES-PAID-TO
 13326           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13327           MOVE '4'                TO DC-OPTION-CODE
 13328           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13329           IF NO-CONVERSION-ERROR
 13330              MOVE +1 TO DC-ELAPSED-DAYS
 13331              MOVE +0 TO DC-ELAPSED-MONTHS
 13332              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 255
* EL156.cbl
 13333              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13334              IF NO-CONVERSION-ERROR
 13335                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13336
 13337     IF PI-EDAYS NOT = ZEROS
 13338        MOVE PI-EDAYS TO EDAYSO.
 13339
 13340     IF PI-EPYAMT NOT = ZEROS
 13341        MOVE PI-EPYAMT TO EPYAMTO.
 13342
 13343     IF PI-ERESV NOT = ZEROS
 13344        MOVE PI-ERESV TO ERESVO.
 13345
 13346     IF PI-EEXPENS NOT = ZEROS
 13347        MOVE PI-EEXPENS TO EEXPENSO.
 13348
 13349     MOVE PI-ETYPE TO ETYPEO.
 13350
 13351     IF PI-ECHECKNO NOT = SPACES
 13352        MOVE PI-ECHECKNO         TO CHECKNOO
 13353     ELSE
 13354        MOVE PI-CCHECKNO         TO CHECKNOO.
 13355
 13356     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13357     MOVE SPACES                 TO DC-OPTION-CODE.
 13358     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13359
 13360     IF DATE-CONVERSION-ERROR
 13361        MOVE SPACES              TO CPYFROMI
 13362     ELSE
 13363        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13364
 13365     IF PI-USES-PAID-TO
 13366        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13367        MOVE +1                  TO DC-ELAPSED-DAYS
 13368        MOVE +0                  TO DC-ELAPSED-MONTHS
 13369        MOVE '6'                 TO DC-OPTION-CODE
 13370        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13371        IF NO-CONVERSION-ERROR
 13372           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13373           GO TO 3051-CONTINUE.
 13374
 13375     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13376     MOVE SPACES                 TO DC-OPTION-CODE.
 13377     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13378
 13379     IF DATE-CONVERSION-ERROR
 13380        MOVE SPACES              TO CPYTHRUI
 13381     ELSE
 13382        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13383
 13384 3051-CONTINUE.
 13385
 13386     IF PI-CDAYS NOT = ZEROS
 13387        MOVE PI-CDAYS TO CDAYSO.
 13388
 13389     IF PI-CPYAMT NOT = ZEROS
 13390        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 256
* EL156.cbl
 13391
 13392     IF PI-CRESV NOT = ZEROS
 13393        MOVE PI-CRESV TO CRESVO.
 13394
 13395     IF PI-CEXPENS NOT = ZEROS
 13396        MOVE PI-CEXPENS TO CEXPENSO.
 13397
 13398 3059-EXIT.
 13399     EXIT.
 13400
 13401 3100-DEEDIT-DATE.
 13402
 13403* EXEC CICS BIF DEEDIT
 13404*        FIELD(DATE-WORK)
 13405*        LENGTH(8)
 13406*    END-EXEC.
 13407     MOVE 8
 13408       TO DFHEIV11
 13409*    MOVE '@"L                   #   #00012636' TO DFHEIV0
 13410     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13411     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13412     MOVE X'2020233030303132363336' TO DFHEIV0(25:11)
 13413     CALL 'kxdfhei1' USING DFHEIV0,
 13414           DATE-WORK,
 13415           DFHEIV11
 13416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13417
 13418
 13419 3100-EXIT.
 13420     EXIT.
 13421
 13422 3200-CALC-AIG-DAYS.
 13423
 13424     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13425
 13426     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13427     MOVE ' '                    TO DC-OPTION-CODE.
 13428     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13429     IF NO-CONVERSION-ERROR
 13430         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13431     ELSE
 13432         GO TO 3290-ERROR.
 13433
 13434     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13435         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13436                                WS-BIN-FROM-DT
 13437     ELSE
 13438         IF CL-TOTAL-PAID-AMT > ZEROS
 13439             IF WS-SV-EPYFROM = LOW-VALUES
 13440                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13441                                        WS-BIN-FROM-DT
 13442             ELSE
 13443                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13444                                        WS-BIN-FROM-DT
 13445         ELSE
 13446             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13447                                        WS-BIN-FROM-DT.
 13448
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 257
* EL156.cbl
 13449 3210-CONTINUE.
 13450
 13451     MOVE ' '                    TO DC-OPTION-CODE.
 13452     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13453     IF DATE-CONVERSION-ERROR
 13454         GO TO 3290-ERROR.
 13455
 13456     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13457
 13458     IF PI-LOAN-DUE-DAY = 31
 13459         MOVE 30              TO WS-PMT-DUE-DA
 13460                                 WS-SAVE-DUE-DA
 13461     ELSE
 13462         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13463                                 WS-SAVE-DUE-DA.
 13464
 13465     IF (PI-LOAN-DUE-DAY > 28) AND
 13466        (WS-PMT-DUE-MO = 2)
 13467         MOVE 'Y'                TO WS-DUE-DAY-SW
 13468         MOVE 28                 TO WS-PMT-DUE-DA.
 13469
 13470     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13471     MOVE '4'                    TO DC-OPTION-CODE.
 13472     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13473     IF NO-CONVERSION-ERROR
 13474         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13475     ELSE
 13476         GO TO 3290-ERROR.
 13477
 13478*--------------------------------------------------------------*
 13479*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13480*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13481*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13482*                                                              *
 13483*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13484*             INCURRED DATE      - 04/15/91                    *
 13485*             PMT DUE DATE       - 04/03/91                    *
 13486*             PMT DUE DATE       - 05/03/91                    *
 13487*--------------------------------------------------------------*
 13488
 13489     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13490        (WS-SV-AIGFROM = LOW-VALUES)
 13491         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13492            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13493             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13494             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13495             IF NO-CONVERSION-ERROR
 13496                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13497                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13498             ELSE
 13499                 GO TO 3290-ERROR.
 13500
 13501     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13502        (WS-SV-AIGFROM = LOW-VALUES)
 13503         GO TO 3205-CONT-CALC-PMT.
 13504
 13505     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13506     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 258
* EL156.cbl
 13507     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13508     IF NO-CONVERSION-ERROR
 13509         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13510     ELSE
 13511         GO TO 3290-ERROR.
 13512
 13513     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13514        (WS-PMT-DUE-DA < WS-FROM-DA)
 13515          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13516          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13517          IF NO-CONVERSION-ERROR
 13518              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13519              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13520          ELSE
 13521              GO TO 3290-ERROR.
 13522
 13523 3205-CONT-CALC-PMT.
 13524
 13525*--------------------------------------------------------------*
 13526*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13527*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13528*--------------------------------------------------------------*
 13529
 13530     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13531        PI-PMTTYPE = '2'
 13532          NEXT SENTENCE
 13533     ELSE
 13534        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13535           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13536             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13537             MOVE ER-3527            TO EMI-ERROR
 13538             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13539             MOVE -1                 TO EPYTHRUL
 13540             MOVE AL-UNBON           TO EPYTHRUA
 13541                                        EPYFROMA
 13542             GO TO 3299-EXIT.
 13543
 13544*--------------------------------------------------------------*
 13545*    CALCULATE RETRO ELIMINATION DATE                          *
 13546*--------------------------------------------------------------*
 13547
 13548     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13549         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13550     ELSE
 13551         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13552
 13553     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13554     MOVE +0             TO DC-ELAPSED-MONTHS.
 13555     MOVE '6'            TO DC-OPTION-CODE.
 13556     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13557     IF NO-CONVERSION-ERROR
 13558         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13559     ELSE
 13560         GO TO 3290-ERROR.
 13561
 13562 3210-CHECK-PMT-DATE.
 13563
 13564*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 259
* EL156.cbl
 13565*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13566*    THE ENTERED PAY FROM DATE                                 *
 13567*--------------------------------------------------------------*
 13568
 13569     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13570         NEXT SENTENCE
 13571     ELSE
 13572         GO TO 3220-COMPUTE-DAYS.
 13573
 13574     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13575     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13576     IF NO-CONVERSION-ERROR
 13577         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13578         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13579         GO TO 3210-CHECK-PMT-DATE
 13580     ELSE
 13581         GO TO 3290-ERROR.
 13582
 13583 3220-COMPUTE-DAYS.
 13584
 13585     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13586     MOVE ZEROS         TO WS-CDAYS.
 13587     MOVE 'N'           TO WS-ELIMINATION-SW.
 13588
 13589*--------------------------------------------------------------*
 13590*    COMPUTE CALIFORNIA DUE DAYS                               *
 13591*--------------------------------------------------------------*
 13592
 13593     IF CL-TOTAL-PAID-AMT > ZEROS
 13594         MOVE 'Y' TO WS-ELIMINATION-SW
 13595         GO TO 3240-FIRST-PMT-DUE
 13596     ELSE
 13597        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13598            NEXT SENTENCE
 13599        ELSE
 13600            GO TO 3240-FIRST-PMT-DUE.
 13601
 13602 3230-NEXT-PMT-DUE.
 13603
 13604     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13605     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13606     IF NO-CONVERSION-ERROR
 13607         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13608         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13609     ELSE
 13610         GO TO 3290-ERROR.
 13611
 13612 3240-FIRST-PMT-DUE.
 13613
 13614     IF CL-TOTAL-PAID-AMT > ZEROS
 13615         NEXT SENTENCE
 13616     ELSE
 13617        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13618            GO TO 3230-NEXT-PMT-DUE.
 13619
 13620     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13621         GO TO 3250-VERIFY-ELIMINATION.
 13622
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 260
* EL156.cbl
 13623     ADD +30 TO WS-CDAYS.
 13624     MOVE 'Y' TO WS-ELIMINATION-SW.
 13625     GO TO 3230-NEXT-PMT-DUE.
 13626
 13627 3250-VERIFY-ELIMINATION.
 13628
 13629     IF ELIM-SATISFIED
 13630         GO TO 3260-END-CALC.
 13631
 13632     IF PI-PMTTYPE = '1'
 13633         MOVE ZEROS TO WS-CDAYS
 13634         GO TO 3260-END-CALC.
 13635
 13636     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13637         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13638     ELSE
 13639         IF CL-TOTAL-PAID-AMT > ZEROS
 13640             IF WS-SV-EPYFROM = LOW-VALUES
 13641                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13642             ELSE
 13643                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13644         ELSE
 13645             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13646
 13647     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13648     MOVE '1'                    TO DC-OPTION-CODE.
 13649     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13650     IF NO-CONVERSION-ERROR
 13651         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13652     ELSE
 13653         GO TO 3290-ERROR.
 13654
 13655     IF CL-TOTAL-PAID-AMT > ZEROS
 13656         MOVE WS-DAYS-OFF TO WS-CDAYS
 13657     ELSE
 13658         IF PI-BEN-DAYS > WS-DAYS-OFF
 13659             MOVE ZEROS TO WS-CDAYS
 13660         ELSE
 13661             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13662
 13663 3260-END-CALC.
 13664
 13665     MOVE WS-CDAYS TO PI-CDAYS.
 13666
 13667     IF PI-EDAYS = ZEROS
 13668         MOVE PI-CDAYS TO PI-EDAYS
 13669         MOVE AL-UNNON TO EDAYSA.
 13670
 13671     GO TO 3299-EXIT.
 13672
 13673 3290-ERROR.
 13674
 13675     MOVE ER-3528            TO EMI-ERROR.
 13676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13677     MOVE -1                 TO CDAYSL.
 13678     MOVE AL-UNBON           TO CDAYSA.
 13679
 13680 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 261
* EL156.cbl
 13681     EXIT.
 13682
 13683 3300-BUMP-DATE.
 13684
 13685     IF WS-RESTORE-DUE-DAY
 13686         MOVE 'N'              TO WS-DUE-DAY-SW
 13687         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13688         ADD 1                 TO WS-PMT-DUE-MO
 13689         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13690         MOVE '4'              TO DC-OPTION-CODE
 13691         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13692         IF NO-CONVERSION-ERROR
 13693             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13694             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13695             GO TO 3399-EXIT
 13696         ELSE
 13697             MOVE '9'          TO DC-ERROR-CODE
 13698             GO TO 3399-EXIT.
 13699
 13700     IF (WS-PMT-DUE-MO = 1) AND
 13701        (WS-SAVE-DUE-DA > 28)
 13702           MOVE 'Y' TO WS-DUE-DAY-SW.
 13703
 13704     MOVE +0                 TO DC-ELAPSED-DAYS.
 13705     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13706     MOVE '6'                TO DC-OPTION-CODE.
 13707     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13708
 13709 3399-EXIT.
 13710     EXIT.
 13711
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 262
* EL156.cbl
 13713 3400-COMPUTE-EXPIRY.
 13714
 13715     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13716     MOVE +0                    TO DC-ELAPSED-DAYS
 13717                                   DC-ODD-DAYS-OVER.
 13718     MOVE '1'                   TO DC-END-OF-MONTH.
 13719     MOVE '6'                   TO DC-OPTION-CODE.
 13720
 13721     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13722         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13723     ELSE
 13724         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13725
 13726     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13727     IF NO-CONVERSION-ERROR
 13728         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13729     ELSE
 13730         GO TO 3390-CONTINUE.
 13731
 13732     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13733         GO TO 3390-CONTINUE.
 13734
 13735     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13736     MOVE '4'                    TO CNTL-REC-TYPE.
 13737     MOVE +0                     TO CNTL-SEQ-NO.
 13738     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13739     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13740     MOVE 'BENE'                 TO FILE-SWITCH.
 13741
 13742     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13743
 13744     IF NO-BENEFIT-FOUND
 13745         GO TO 3390-CONTINUE.
 13746
 13747     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13748        IF (PI-OFFLINE = 'Y') OR
 13749           (PI-PMTTYPE = '7')
 13750           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13751                                     THRU 9870-EXIT
 13752           IF ERROR-ON-OUTPUT
 13753             MOVE -1                 TO ENTERPFL
 13754             MOVE AL-UANON           TO ENTERPFA
 13755             MOVE MAP-NAMEA          TO MAP-NAME
 13756             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13757             GO TO 8200-SEND-DATAONLY.
 13758
 13759     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13760        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13761        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 13762          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 13763          MOVE +0        TO DC-ELAPSED-DAYS
 13764          MOVE +1        TO DC-ELAPSED-MONTHS
 13765          MOVE 6         TO DC-OPTION-CODE
 13766          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13767          IF NO-CONVERSION-ERROR
 13768              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 13769
 13770 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 263
* EL156.cbl
 13771
 13772      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13773         MOVE CM-AH-LOAN-EXPIRE-DT
 13774                                 TO DC-BIN-DATE-1
 13775      ELSE
 13776         MOVE CM-LF-LOAN-EXPIRE-DT
 13777                                 TO DC-BIN-DATE-1
 13778      END-IF
 13779
 13780      MOVE ' '                    TO DC-OPTION-CODE.
 13781      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13782      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 13783      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 13784
 13785 3499-EXIT.
 13786     EXIT.
 13787
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 264
* EL156.cbl
 13789
 13790 3600-CHECK-VERIFICATION.
 13791
 13792     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13793
 13794     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13795
 13796     IF PI-PAYEE-TYPE = 'I'
 13797        GO TO 3600-READ-TRAILER.
 13798
 13799     IF PI-PAYEE-TYPE = 'B'
 13800        ADD +10                  TO TRLR-SEQ-NO
 13801        GO TO 3600-READ-TRAILER.
 13802
 13803     IF PI-PAYEE-TYPE = 'A'
 13804        ADD +20                  TO TRLR-SEQ-NO
 13805        GO TO 3600-READ-TRAILER.
 13806
 13807     IF PI-PAYEE-TYPE = 'O'
 13808        ADD +50                  TO TRLR-SEQ-NO
 13809        GO TO 3600-READ-TRAILER.
 13810
 13811     IF PI-PAYEE-TYPE = 'Q'
 13812        ADD +60                  TO TRLR-SEQ-NO
 13813        GO TO 3600-READ-TRAILER.
 13814
 13815     IF PI-PAYEE-TYPE = 'P'
 13816        ADD +30                  TO TRLR-SEQ-NO
 13817        GO TO 3600-READ-TRAILER.
 13818
 13819     IF PI-PAYEE-TYPE = 'E'
 13820        ADD +40                  TO TRLR-SEQ-NO.
 13821
 13822 3600-READ-TRAILER.
 13823
 13824
 13825* EXEC CICS HANDLE CONDITION
 13826*         NOTFND(3600-CONTINUE)
 13827*    END-EXEC.
 13828*    MOVE '"$I                   ! - #00013046' TO DFHEIV0
 13829     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13830     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13831     MOVE X'2D20233030303133303436' TO DFHEIV0(25:11)
 13832     CALL 'kxdfhei1' USING DFHEIV0
 13833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13834
 13835
 13836     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13837
 13838 3600-CONTINUE.
 13839
 13840     IF PI-VFY-2ND-BENE = 'Y'
 13841       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 13842         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 13843           MOVE ER-7576            TO EMI-ERROR
 13844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13845           MOVE -1                 TO PAYEEL
 13846           MOVE AL-UABON           TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 265
* EL156.cbl
 13847           GO TO 3600-EXIT
 13848         END-IF
 13849       END-IF
 13850     END-IF.
 13851
 13852     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13853     MOVE 1 TO WS-SUB2
 13854     MOVE SPACES TO WS-PAYEE-NAME
 13855     PERFORM VARYING WS-SUB FROM 1 BY 1
 13856             UNTIL WS-SUB > 30
 13857         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13858            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13859                 WS-PAYEE-NAME-X (WS-SUB2)
 13860            ADD +1 TO WS-SUB2
 13861         END-IF
 13862     END-PERFORM.
 13863
 13864     STRING CL-INSURED-1ST-NAME
 13865            CL-INSURED-MID-INIT
 13866            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13867     MOVE 1 TO WS-SUB2
 13868     MOVE SPACES TO WS-INSURED-NAME
 13869     PERFORM VARYING WS-SUB FROM 1 BY 1
 13870             UNTIL WS-SUB > 30
 13871         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13872            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13873                 WS-INSURED-NAME-X (WS-SUB2)
 13874            ADD +1 TO WS-SUB2
 13875         END-IF
 13876     END-PERFORM.
 13877
 13878     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13879        MOVE ER-7579            TO EMI-ERROR
 13880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13881        MOVE -1                 TO PAYEEL
 13882        MOVE AL-UABON           TO PAYEEA
 13883     END-IF.
 13884
 13885 3600-EXIT.
 13886     EXIT.
 13887
 13888 5000-UPDATE.
 13889
 13890     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13891
 13892     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13893
 13894     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13895        PI-OFFLINE = 'Y'
 13896        NEXT SENTENCE
 13897     ELSE
 13898        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13899
 13900*    IF PI-COMPANY-ID = 'CRI'
 13901*       IF PI-PMTTYPE = '1' OR  '2'
 13902*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13903*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13904*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 266
* EL156.cbl
 13905
 13906*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13907*       IF PI-PMTTYPE = '1'
 13908*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13909*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13910
 13911     IF PI-PMTTYPE      = '2' AND
 13912        PI-SPLIT-PMT-SW = 'Y' AND
 13913        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13914          MOVE ER-3530                TO EMI-ERROR
 13915          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13916
 13917     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13918        AND (CL-CLAIM-TYPE = 'L')
 13919        IF PI-PMTTYPE = '2' OR '4'
 13920           IF PI-INT-AMT NOT = ZEROS
 13921              PERFORM 7110-BUILD-PMT-TRLR
 13922                                 THRU 7130-EXIT
 13923           ELSE
 13924              IF PI-PMTTYPE = '2'
 13925                 PERFORM 7140-BUILD-NOTE-TRLR
 13926                                 THRU 7170-EXIT
 13927              END-IF
 13928           END-IF
 13929        END-IF
 13930     END-IF
 13931*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13932*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13933*            MOVE 'N'                 TO  WS-LETTER-SW.
 13934
 13935*    IF PI-COMPANY-ID = 'DMD'
 13936*        IF CL-NO-OF-PMTS-MADE = +1
 13937*                OR
 13938*           PI-PMTTYPE = '2'
 13939*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13940
 13941     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13942
 13943*    IF PI-COMPANY-ID = 'DMD'
 13944*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13945*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13946
 13947
 13948* EXEC CICS REWRITE
 13949*         DATASET('ELMSTR')
 13950*         FROM(CLAIM-MASTER)
 13951*     END-EXEC.
 13952     MOVE LENGTH OF
 13953      CLAIM-MASTER
 13954       TO DFHEIV11
 13955     MOVE 'ELMSTR' TO DFHEIV1
 13956*    MOVE '&& L                  %   #00013161' TO DFHEIV0
 13957     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13958     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13959     MOVE X'2020233030303133313631' TO DFHEIV0(25:11)
 13960     CALL 'kxdfhei1' USING DFHEIV0,
 13961           DFHEIV1,
 13962           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 267
* EL156.cbl
 13963           DFHEIV11,
 13964           DFHEIV99
 13965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13966
 13967
 13968     IF WS-LETTER-SW = 'N'
 13969         GO TO 5000-END-UPDATE.
 13970
 13971 5000-GENERATE-AUTO-LETTER.
 13972
 13973
 13974* EXEC CICS LINK
 13975*        PROGRAM    (LINK-1523)
 13976*        COMMAREA   (W-1523-LINKDATA)
 13977*        LENGTH     (W-1523-COMM-LENGTH)
 13978*    END-EXEC.
 13979*    MOVE '."C                   (   #00013171' TO DFHEIV0
 13980     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13982     MOVE X'2020233030303133313731' TO DFHEIV0(25:11)
 13983     CALL 'kxdfhei1' USING DFHEIV0,
 13984           LINK-1523,
 13985           W-1523-LINKDATA,
 13986           W-1523-COMM-LENGTH,
 13987           DFHEIV99,
 13988           DFHEIV99,
 13989           DFHEIV99,
 13990           DFHEIV99
 13991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13992
 13993
 13994     IF W-1523-FATAL-ERROR
 13995         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13997         MOVE ER-0802                TO  EMI-ERROR
 13998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13999
 14000     IF W-1523-ERROR-CODE = 0191
 14001         MOVE ER-0803                TO  EMI-ERROR
 14002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14003
 14004     IF PI-COMPANY-ID      = 'HAN' AND
 14005        PI-PMTTYPE         = '1'   AND
 14006        PI-3RD-PARTY-SW    = 'Y'   AND
 14007        W-1523-FORM-NUMBER = 'EOB1'
 14008           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14009           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14010           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14011           GO TO 5000-GENERATE-AUTO-LETTER.
 14012
 14013 5000-END-UPDATE.
 14014
 14015     MOVE ER-0000                TO EMI-ERROR.
 14016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14017     GO TO 7000-SHOW-CLAIM.
 14018
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 268
* EL156.cbl
 14020 5000-MOVE-NAME.
 14021     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14022     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14023     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14024
 14025 5000-EXIT.
 14026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 269
* EL156.cbl
 14028 5300-CREATE-DMO.
 14029
 14030     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14031     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14032     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14033
 14034
 14035* EXEC CICS HANDLE CONDITION
 14036*         NOTFND   (5300-NOTE-NOT-FOUND)
 14037*    END-EXEC.
 14038*    MOVE '"$I                   ! . #00013217' TO DFHEIV0
 14039     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14041     MOVE X'2E20233030303133323137' TO DFHEIV0(25:11)
 14042     CALL 'kxdfhei1' USING DFHEIV0
 14043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14044
 14045
 14046
 14047* EXEC CICS READ
 14048*         DATASET('ERNOTE')
 14049*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14050*         RIDFLD (W-NOTE-KEY)
 14051*    END-EXEC.
 14052     MOVE 'ERNOTE' TO DFHEIV1
 14053*    MOVE '&"S        E          (   #00013221' TO DFHEIV0
 14054     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14055     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14056     MOVE X'2020233030303133323231' TO DFHEIV0(25:11)
 14057     CALL 'kxdfhei1' USING DFHEIV0,
 14058           DFHEIV1,
 14059           DFHEIV20,
 14060           DFHEIV99,
 14061           W-NOTE-KEY,
 14062           DFHEIV99,
 14063           DFHEIV99,
 14064           DFHEIV99
 14065     SET ADDRESS OF CERTIFICATE-NOTE TO
 14066         DFHEIV20
 14067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14068
 14069
 14070     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14071     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14072     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14073
 14074     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14075         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14076     ELSE
 14077         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14078
 14079     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14080     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14081     MOVE 'DLO006'               TO PGM-NAME.
 14082
 14083
 14084* EXEC CICS LINK
 14085*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 270
* EL156.cbl
 14086*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14087*        LENGTH     (DCT-RCRD-LENGTH)
 14088*    END-EXEC.
 14089*    MOVE '."C                   (   #00013240' TO DFHEIV0
 14090     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14092     MOVE X'2020233030303133323430' TO DFHEIV0(25:11)
 14093     CALL 'kxdfhei1' USING DFHEIV0,
 14094           PGM-NAME,
 14095           DCT-COMMUNICATION-AREA,
 14096           DCT-RCRD-LENGTH,
 14097           DFHEIV99,
 14098           DFHEIV99,
 14099           DFHEIV99,
 14100           DFHEIV99
 14101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14102
 14103
 14104     IF DCT-RETURN-CODE = 'OK'
 14105         GO TO 5300-CONT.
 14106
 14107     IF DCT-RETURN-CODE = '01' OR '02'
 14108         GO TO 5300-EXIT.
 14109
 14110     IF DCT-RETURN-CODE = '03'
 14111         MOVE ER-0951            TO EMI-ERROR
 14112         GO TO 5300-BAD-EXIT.
 14113
 14114     IF DCT-RETURN-CODE = '04'
 14115         MOVE ER-0946            TO EMI-ERROR
 14116         GO TO 5300-BAD-EXIT.
 14117
 14118     IF DCT-RETURN-CODE = '05'
 14119         MOVE ER-0947            TO EMI-ERROR
 14120         GO TO 5300-BAD-EXIT.
 14121
 14122     IF DCT-RETURN-CODE = '06'
 14123         MOVE ER-0921            TO EMI-ERROR
 14124         GO TO 5300-BAD-EXIT.
 14125
 14126     IF DCT-RETURN-CODE = '07'
 14127         MOVE ER-0849            TO EMI-ERROR
 14128         GO TO 5300-BAD-EXIT.
 14129
 14130     IF DCT-RETURN-CODE = '08'
 14131         MOVE ER-0948            TO EMI-ERROR
 14132         GO TO 5300-BAD-EXIT.
 14133
 14134     IF DCT-RETURN-CODE = 'N1'
 14135         MOVE ER-0950            TO EMI-ERROR
 14136         GO TO 5300-BAD-EXIT.
 14137
 14138     IF DCT-RETURN-CODE = 'E1'
 14139         MOVE ER-0974            TO EMI-ERROR
 14140         GO TO 5300-BAD-EXIT.
 14141
 14142     IF DCT-RETURN-CODE = 'E2'
 14143         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 271
* EL156.cbl
 14144         GO TO 5300-BAD-EXIT.
 14145
 14146     IF DCT-RETURN-CODE NOT = 'OK'
 14147         MOVE ER-0949            TO EMI-ERROR
 14148         GO TO 5300-BAD-EXIT.
 14149
 14150 5300-CONT.
 14151
 14152     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14153     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14154     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14155     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14156     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14157     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14158     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14159     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14160
 14161     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14162     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14163     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14164     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14165     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14166
 14167     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14168
 14169     IF PI-PMTTYPE = '2'
 14170         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14171         MOVE '4'                TO DM-CLAIM-STATUS
 14172     ELSE
 14173         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14174         MOVE '2'                TO DM-CLAIM-STATUS.
 14175
 14176     MOVE 'DLO025'               TO PGM-NAME.
 14177
 14178
 14179* EXEC CICS LINK
 14180*        PROGRAM    (PGM-NAME)
 14181*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14182*        LENGTH     (DM-DMO-LENGTH)
 14183*    END-EXEC.
 14184*    MOVE '."C                   (   #00013320' TO DFHEIV0
 14185     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14186     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14187     MOVE X'2020233030303133333230' TO DFHEIV0(25:11)
 14188     CALL 'kxdfhei1' USING DFHEIV0,
 14189           PGM-NAME,
 14190           DMO-COMMUNICATION-AREA,
 14191           DM-DMO-LENGTH,
 14192           DFHEIV99,
 14193           DFHEIV99,
 14194           DFHEIV99,
 14195           DFHEIV99
 14196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14197
 14198
 14199     IF DM-RETURN-CODE = 'OK'
 14200         GO TO 5300-EXIT.
 14201
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 272
* EL156.cbl
 14202     IF DM-RETURN-CODE = '01'
 14203         MOVE ER-8051            TO EMI-ERROR
 14204         GO TO 5300-BAD-EXIT.
 14205
 14206     IF DM-RETURN-CODE = '02'
 14207         MOVE ER-8052            TO EMI-ERROR
 14208         GO TO 5300-BAD-EXIT.
 14209
 14210     IF DM-RETURN-CODE = '03'
 14211         MOVE ER-8053            TO EMI-ERROR
 14212         GO TO 5300-BAD-EXIT.
 14213
 14214     IF DM-RETURN-CODE = '04'
 14215         MOVE ER-8054            TO EMI-ERROR
 14216         GO TO 5300-BAD-EXIT.
 14217
 14218     IF DM-RETURN-CODE = '05'
 14219         MOVE ER-8055            TO EMI-ERROR
 14220         GO TO 5300-BAD-EXIT.
 14221
 14222     IF DM-RETURN-CODE = '06'
 14223         MOVE ER-8056            TO EMI-ERROR
 14224         GO TO 5300-BAD-EXIT.
 14225
 14226     IF DM-RETURN-CODE = '07'
 14227         MOVE ER-8057            TO EMI-ERROR
 14228         GO TO 5300-BAD-EXIT.
 14229
 14230     IF DM-RETURN-CODE = '08'
 14231         MOVE ER-8058            TO EMI-ERROR
 14232         GO TO 5300-BAD-EXIT.
 14233
 14234     IF DM-RETURN-CODE = '09'
 14235         MOVE ER-8059            TO EMI-ERROR
 14236         GO TO 5300-BAD-EXIT.
 14237
 14238     IF DM-RETURN-CODE = '10'
 14239         MOVE ER-8060            TO EMI-ERROR
 14240         GO TO 5300-BAD-EXIT.
 14241
 14242     IF DM-RETURN-CODE = '11'
 14243         MOVE ER-8061            TO EMI-ERROR
 14244         GO TO 5300-BAD-EXIT.
 14245
 14246     IF DM-RETURN-CODE = '12'
 14247         MOVE ER-8062            TO EMI-ERROR
 14248         GO TO 5300-BAD-EXIT.
 14249
 14250     IF DM-RETURN-CODE = '13'
 14251         MOVE ER-8063            TO EMI-ERROR
 14252         GO TO 5300-BAD-EXIT.
 14253
 14254     IF DM-RETURN-CODE = '14'
 14255         MOVE ER-8064            TO EMI-ERROR
 14256         GO TO 5300-BAD-EXIT.
 14257
 14258     IF DM-RETURN-CODE = '15'
 14259         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 273
* EL156.cbl
 14260         GO TO 5300-BAD-EXIT.
 14261
 14262     IF DM-RETURN-CODE = '16'
 14263         MOVE ER-8154            TO EMI-ERROR
 14264         GO TO 5300-BAD-EXIT.
 14265
 14266     IF DM-RETURN-CODE = '17'
 14267         MOVE ER-8155            TO EMI-ERROR
 14268         GO TO 5300-BAD-EXIT.
 14269
 14270     IF DM-RETURN-CODE = 'N1'
 14271         MOVE ER-8152            TO EMI-ERROR
 14272         GO TO 5300-BAD-EXIT.
 14273
 14274     IF DM-RETURN-CODE = 'E1'
 14275         MOVE ER-8153            TO EMI-ERROR
 14276         GO TO 5300-BAD-EXIT.
 14277
 14278     MOVE ER-8066            TO EMI-ERROR.
 14279     GO TO 5300-BAD-EXIT.
 14280
 14281 5300-NOTE-NOT-FOUND.
 14282
 14283     MOVE ER-0954                TO EMI-ERROR.
 14284     GO TO 5300-BAD-EXIT.
 14285
 14286 5300-BAD-EXIT.
 14287
 14288* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14289*    MOVE '6"R                   !   #00013414' TO DFHEIV0
 14290     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14292     MOVE X'2020233030303133343134' TO DFHEIV0(25:11)
 14293     CALL 'kxdfhei1' USING DFHEIV0
 14294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14295
 14296     IF MAP-NAME = 'EL156A'
 14297         MOVE -1             TO ENTERPFL
 14298       ELSE
 14299         MOVE LOW-VALUES     TO EL156BI
 14300         MOVE -1             TO ENTPFBL.
 14301
 14302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14303     GO TO 8200-SEND-DATAONLY.
 14304
 14305 5300-EXIT.
 14306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 274
* EL156.cbl
 14308 5350-FORMAT-LAST-NAME-1ST.
 14309*****************************************************************
 14310*             M O V E   N A M E   R O U T I N E                 *
 14311*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14312*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14313*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14314*                  FIELD                   VALUE                *
 14315*           W-NAME-LAST    (CL15)      SMITH                    *
 14316*           W-NAME-FIRST   (CL15)      JOHN                     *
 14317*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14318*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14319*     CONTAIN                                                   *
 14320*                SMITH, JOHN ALLEN                              *
 14321*     OR                                                        *
 14322*                SMITH, JOHN A.                                 *
 14323*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14324*     COPYBOOK, ELCNWA.                                         *
 14325*****************************************************************.
 14326
 14327     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14328     MOVE ZERO                   TO  WS-NAME-SW.
 14329     SET NWA-INDEX               TO +1.
 14330
 14331     IF W-NAME-LAST   = SPACES AND
 14332        W-NAME-MIDDLE = SPACES
 14333         MOVE +1                 TO WS-NAME-SW.
 14334
 14335     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14336     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14337
 14338     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14339     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14340
 14341     SET NWA-INDEX UP BY +1.
 14342
 14343     IF W-NAME-MIDDLE NOT = SPACES
 14344         IF W-NAME-MIDDLE-2 = SPACES
 14345             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14346             SET NWA-INDEX UP BY +1
 14347             MOVE '.'            TO WS-NW (NWA-INDEX)
 14348             SET NWA-INDEX UP BY +2
 14349         ELSE
 14350             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14351             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14352
 14353 5350-EXIT.
 14354     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 275
* EL156.cbl
 14356 5360-MOVE-NAME.
 14357
 14358     IF WS-NAME-SW > +1
 14359         GO TO 5360-EXIT.
 14360
 14361     IF WS-NAME-WORK2 = SPACES
 14362         GO TO 5360-EXIT.
 14363
 14364     SET NWA-INDEX2            TO +1.
 14365     SET NWA-INDEX3            TO +2.
 14366
 14367 5360-MOVE-NAME-CYCLE.
 14368
 14369     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14370
 14371     IF NWA-INDEX < +30
 14372         SET NWA-INDEX UP BY +1
 14373     ELSE
 14374         ADD +2                TO  WS-NAME-SW
 14375         GO TO 5360-EXIT.
 14376
 14377     IF NWA-INDEX2 < +20
 14378         SET NWA-INDEX3 UP BY +1
 14379         SET NWA-INDEX2 UP BY +1.
 14380
 14381     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14382        WS-NW2 (NWA-INDEX3) = SPACES
 14383         IF WS-NAME-SW = ZERO
 14384             MOVE ','            TO  WS-NW (NWA-INDEX)
 14385             SET NWA-INDEX UP BY +2
 14386             MOVE +1             TO  WS-NAME-SW
 14387             GO TO 5360-EXIT
 14388         ELSE
 14389             GO TO 5360-EXIT.
 14390
 14391     GO TO 5360-MOVE-NAME-CYCLE.
 14392
 14393 5360-EXIT.
 14394     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 276
* EL156.cbl
 14396 6000-BUILD-SCREEN-B.
 14397     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14398     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14399     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14400     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14401
 14402     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14403
 14404 6050-BUILD-SCREEN.
 14405     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14406     MOVE LOW-VALUES             TO EL156BI.
 14407     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14408
 14409     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14410
 14411     IF PI-PAYEE-TYPE = 'I'
 14412        GO TO 6060-READ-TRAILER.
 14413
 14414     IF PI-PAYEE-TYPE = 'B'
 14415        ADD +10                  TO TRLR-SEQ-NO
 14416        GO TO 6060-READ-TRAILER.
 14417
 14418     IF PI-PAYEE-TYPE = 'A'
 14419        ADD +20                  TO TRLR-SEQ-NO
 14420        GO TO 6060-READ-TRAILER.
 14421
 14422     IF PI-PAYEE-TYPE = 'O'
 14423        ADD +50                  TO TRLR-SEQ-NO
 14424        GO TO 6060-READ-TRAILER.
 14425
 14426     IF PI-PAYEE-TYPE = 'Q'
 14427        ADD +60                  TO TRLR-SEQ-NO
 14428        GO TO 6060-READ-TRAILER.
 14429
 14430     IF PI-PAYEE-TYPE = 'P'
 14431        ADD +30                  TO TRLR-SEQ-NO
 14432        GO TO 6060-READ-TRAILER.
 14433
 14434     IF PI-PAYEE-TYPE = 'E'
 14435        ADD +40                  TO TRLR-SEQ-NO.
 14436
 14437 6060-READ-TRAILER.
 14438
 14439     IF PI-PAYEE-TYPE    = 'A' AND
 14440        PI-PAYEE-SEQ-NUM = 0
 14441          GO TO 6061-READ-ACCOUNT.
 14442
 14443     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14444        (PI-PAYEE-TYPE    = 'B')             AND
 14445        (PI-PAYEE-SEQ-NUM = 9)
 14446          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14447          IF BENE-FOUND-SW = 'N'
 14448            GO TO 6065-NOT-FOUND
 14449          ELSE
 14450            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14451            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14452            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14453*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 277
* EL156.cbl
 14454            STRING BE-CITY ' ' BE-STATE
 14455               DELIMITED BY '  ' INTO CITYSTBO
 14456            END-STRING
 14457            MOVE BE-ZIP-CODE       TO ZIPBO
 14458            GO TO 6061-READ-ACCOUNT.
 14459
 14460     IF PI-PAYEE-TYPE    = 'B' AND
 14461        PI-PAYEE-SEQ-NUM = 0
 14462          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14463          IF BENE-FOUND-SW = 'N'
 14464            GO TO 6065-NOT-FOUND
 14465          ELSE
 14466            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14467            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14468            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14469*           MOVE BE-CITY-STATE     TO CITYSTBO
 14470            STRING BE-CITY ' ' BE-STATE
 14471               DELIMITED BY '  ' INTO CITYSTBO
 14472            END-STRING
 14473            MOVE BE-ZIP-CODE       TO ZIPBO
 14474            GO TO 6061-READ-ACCOUNT.
 14475
 14476
 14477* EXEC CICS HANDLE CONDITION
 14478*         NOTFND(6065-NOT-FOUND)
 14479*     END-EXEC.
 14480*    MOVE '"$I                   ! / #00013595' TO DFHEIV0
 14481     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14482     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14483     MOVE X'2F20233030303133353935' TO DFHEIV0(25:11)
 14484     CALL 'kxdfhei1' USING DFHEIV0
 14485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14486
 14487
 14488     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14489
 14490     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14491     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14492     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14493     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14494*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14495     STRING AT-CITY ' ' AT-STATE
 14496        DELIMITED BY '  ' INTO CITYSTBO
 14497     END-STRING
 14498     MOVE AT-ZIP-CODE            TO ZIPBO.
 14499
 14500 6061-READ-ACCOUNT.
 14501
 14502* EXEC CICS HANDLE CONDITION
 14503*         NOTFND(6068-ACCT-NOT-FND)
 14504*     END-EXEC.
 14505*    MOVE '"$I                   ! 0 #00013612' TO DFHEIV0
 14506     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14508     MOVE X'3020233030303133363132' TO DFHEIV0(25:11)
 14509     CALL 'kxdfhei1' USING DFHEIV0
 14510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14511
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 278
* EL156.cbl
 14512
 14513
 14514* EXEC CICS READ
 14515*         DATASET('ERACCT')
 14516*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14517*         RIDFLD (PI-ACCT-KEY)
 14518*     END-EXEC.
 14519     MOVE 'ERACCT' TO DFHEIV1
 14520*    MOVE '&"S        E          (   #00013616' TO DFHEIV0
 14521     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14523     MOVE X'2020233030303133363136' TO DFHEIV0(25:11)
 14524     CALL 'kxdfhei1' USING DFHEIV0,
 14525           DFHEIV1,
 14526           DFHEIV20,
 14527           DFHEIV99,
 14528           PI-ACCT-KEY,
 14529           DFHEIV99,
 14530           DFHEIV99,
 14531           DFHEIV99
 14532     SET ADDRESS OF ACCOUNT-MASTER TO
 14533         DFHEIV20
 14534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14535
 14536
 14537     MOVE AM-CARRIER             TO ACARRBO.
 14538     MOVE AM-GROUPING            TO GROUPBO.
 14539     MOVE AM-STATE               TO STATEBO.
 14540     MOVE AM-ACCOUNT             TO ACCTBO.
 14541     MOVE AM-NAME                TO ACCTNMBO.
 14542
 14543     IF PI-PAYEE-TYPE = 'A' AND
 14544        PI-PAYEE-SEQ-NUM = 0
 14545          MOVE AM-NAME             TO NAMEBO
 14546                                      PI-PAYEE-NAME
 14547          MOVE AM-ADDRS            TO ADDR1BO
 14548          MOVE SPACES              TO ADDR2BO
 14549*         MOVE AM-CITY             TO CITYSTBO
 14550          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14551             DELIMITED BY '  ' INTO CITYSTBO
 14552          END-STRING
 14553          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14554          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14555          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14556          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14557
 14558     IF CITYSTBO EQUAL SPACES
 14559         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14560         GO TO 6070-FORMAT-DATA
 14561     END-IF.
 14562
 14563     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14564     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14565     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14566     PERFORM VARYING WS-SUB FROM 30 BY -1
 14567          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14568        IF WS-END-SUB = 0  AND
 14569           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 279
* EL156.cbl
 14570              OR LOW-VALUES  OR '.')
 14571            CONTINUE
 14572        ELSE
 14573            IF WS-END-SUB = 0
 14574                MOVE WS-SUB TO WS-END-SUB
 14575            ELSE
 14576                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14577                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14578                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14579                END-IF
 14580            END-IF
 14581        END-IF
 14582        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14583            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14584            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14585        END-IF
 14586     END-PERFORM.
 14587
 14588     IF WS-BEG-SUB > 0
 14589         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14590         IF WS-STATE-LENGTH = 2
 14591             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14592                  TO PI-CHECK-STATE-FOR-AK
 14593         ELSE
 14594             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14595                'ALASKA'
 14596                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14597             ELSE
 14598                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14599             END-IF
 14600         END-IF
 14601     ELSE
 14602         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14603     END-IF.
 14604
 14605     GO TO 6070-FORMAT-DATA.
 14606
 14607 6065-NOT-FOUND.
 14608     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14609     GO TO 6061-READ-ACCOUNT.
 14610
 14611 6068-ACCT-NOT-FND.
 14612     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14613
 14614 6070-FORMAT-DATA.
 14615     IF PI-HOLDTIL = ZEROS
 14616        MOVE SAVE-DATE           TO PAYDTBI
 14617       ELSE
 14618        MOVE PI-HOLDTIL          TO PAYDTBO
 14619        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14620
 14621     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14622     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14623
 14624     IF EIBAID = DFHPF3 OR DFHPF4
 14625        NEXT SENTENCE
 14626     ELSE
 14627       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 280
* EL156.cbl
 14628
 14629     MOVE PI-EPYFROM          TO PYFROMBO.
 14630     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14631
 14632     IF NOT PI-USES-PAID-TO
 14633        MOVE PI-EPYTHRU          TO PYTHRUBO
 14634        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14635     ELSE
 14636        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14637        MOVE '4'              TO DC-OPTION-CODE
 14638        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14639        IF NO-CONVERSION-ERROR
 14640           MOVE +1            TO DC-ELAPSED-DAYS
 14641           MOVE +0            TO DC-ELAPSED-MONTHS
 14642           MOVE '6'           TO DC-OPTION-CODE
 14643           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14644           IF NO-CONVERSION-ERROR
 14645              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14646
 14647     MOVE PI-EDAYS            TO DAYSBO.
 14648     MOVE PI-EPYAMT           TO PAYAMTBO.
 14649     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14650        IF PI-INT-AMT > ZEROS
 14651           MOVE PI-INT-AMT       TO INTAMTBO
 14652        END-IF
 14653     END-IF
 14654     GO TO 6072-SET-TYPE.
 14655
 14656 6071-CONTINUE.
 14657
 14658     IF PI-CPYFROM NOT = LOW-VALUES
 14659        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14660        MOVE SPACES              TO DC-OPTION-CODE
 14661        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14662        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14663
 14664     IF PI-CPYTHRU NOT = LOW-VALUES
 14665        IF NOT PI-USES-PAID-TO
 14666           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14667           MOVE SPACES             TO DC-OPTION-CODE
 14668           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14669           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14670        ELSE
 14671           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14672           MOVE '6'                TO DC-OPTION-CODE
 14673           MOVE +1                 TO DC-ELAPSED-DAYS
 14674           MOVE +0                 TO DC-ELAPSED-MONTHS
 14675           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14676           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14677
 14678     MOVE PI-CDAYS               TO DAYSBO.
 14679     MOVE PI-CPYAMT              TO PAYAMTBO.
 14680     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14681        IF PI-INT-AMT > ZEROS
 14682           MOVE PI-INT-AMT       TO INTAMTBO
 14683        END-IF
 14684     END-IF
 14685     .
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 281
* EL156.cbl
 14686 6072-SET-TYPE.
 14687     IF PI-PMTTYPE = '1'
 14688        MOVE 'PARTIAL'           TO PAYTYPBO.
 14689
 14690     IF PI-PMTTYPE = '2'
 14691        MOVE 'FINAL'             TO PAYTYPBO.
 14692
 14693     IF PI-PMTTYPE = '3'
 14694        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14695
 14696     IF PI-PMTTYPE = '4'
 14697        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14698
 14699     IF PI-PMTTYPE = '5'
 14700        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14701
 14702     IF PI-PMTTYPE = '6'
 14703        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14704
 14705     IF PI-PROV-PMT
 14706        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14707
 14708     IF PI-ECHECKNO NOT = SPACES
 14709        MOVE PI-ECHECKNO         TO CKNUMBO
 14710     ELSE
 14711        MOVE PI-CCHECKNO         TO CKNUMBO.
 14712
 14713     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14714        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14715        MOVE +91                 TO  TRLR-SEQ-NO
 14716
 14717* EXEC CICS READ
 14718*           DATASET  ('ELTRLR')
 14719*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14720*           RIDFLD   (ELTRLR-KEY)
 14721*           RESP     (WS-RESPONSE)
 14722*       END-EXEC
 14723     MOVE 'ELTRLR' TO DFHEIV1
 14724*    MOVE '&"S        E          (  N#00013801' TO DFHEIV0
 14725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14727     MOVE X'204E233030303133383031' TO DFHEIV0(25:11)
 14728     CALL 'kxdfhei1' USING DFHEIV0,
 14729           DFHEIV1,
 14730           DFHEIV20,
 14731           DFHEIV99,
 14732           ELTRLR-KEY,
 14733           DFHEIV99,
 14734           DFHEIV99,
 14735           DFHEIV99
 14736     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14737         DFHEIV20
 14738     MOVE EIBRESP  TO WS-RESPONSE
 14739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14740
 14741        IF WS-RESP-NORMAL
 14742           MOVE AT-INFO-LINE-1   TO  LOANNBO
 14743        ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 282
* EL156.cbl
 14744           MOVE SPACES           TO  LOANNBO
 14745        END-IF
 14746     END-IF
 14747
 14748*       MOVE PI-LOAN-NO          TO LOANNBO
 14749
 14750     IF CKNUMBO = SPACES
 14751         MOVE SPACES             TO CKNUMHDO.
 14752
 14753     MOVE CL-CLAIM-NO            TO CLMNOBO.
 14754     MOVE CL-CARRIER             TO CARRBO.
 14755     MOVE CL-CERT-PRIME          TO CERTNOBO.
 14756     MOVE CL-CERT-SFX            TO SUFXBO.
 14757
 14758     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14759        EVALUATE CL-CLAIM-TYPE
 14760           WHEN 'I'
 14761              MOVE '  IU  '      TO CLMTYPBO
 14762           WHEN 'G'
 14763              MOVE ' GAP  '      TO CLMTYPBO
 14764           WHEN OTHER
 14765              MOVE PI-AH-OVERRIDE-L6
 14766                                 TO CLMTYPBO
 14767        END-EVALUATE
 14768        MOVE ZEROS               TO UNDISBO
 14769*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 14770        IF PI-PMTTYPE = '5' OR '6'
 14771           GO TO 6073-GET-NOTIFY-DATA
 14772        ELSE
 14773           MOVE PI-DAILY-RATE    TO RATEBO
 14774           GO TO 6073-GET-NOTIFY-DATA.
 14775
 14776     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 14777
 14778     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 14779        MOVE ZEROS               TO UNDISBO
 14780     ELSE
 14781        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 14782
 14783 6073-GET-NOTIFY-DATA.
 14784
 14785     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 14786
 14787     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 14788         MOVE SPACES             TO  NAMEB2O
 14789                                     ADDR1B2O
 14790                                     ADDR2B2O
 14791                                     CITYST2O
 14792                                     AGTHDGO
 14793         MOVE ZEROS              TO  ZIPB2O
 14794         GO TO 6080-SET-INCURRED.
 14795
 14796     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 14797     MOVE +29                    TO  TRLR-SEQ-NO.
 14798
 14799
 14800* EXEC CICS HANDLE CONDITION
 14801*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 283
* EL156.cbl
 14802*    END-EXEC.
 14803*    MOVE '"$I                   ! 1 #00013866' TO DFHEIV0
 14804     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14805     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14806     MOVE X'3120233030303133383636' TO DFHEIV0(25:11)
 14807     CALL 'kxdfhei1' USING DFHEIV0
 14808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14809
 14810
 14811     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14812
 14813     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 14814     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 14815     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 14816*    MOVE AT-CITY-STATE          TO  CITYST2O.
 14817     STRING AT-CITY ' ' AT-STATE
 14818        DELIMITED BY '  ' INTO CITYST2O
 14819     END-STRING
 14820     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 14821     GO TO 6080-SET-INCURRED.
 14822
 14823 6074-GET-COMP-DATA.
 14824
 14825     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 14826         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 14827
 14828     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 14829         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 14830                                         ADDR1B2O
 14831                                         ADDR2B2O
 14832                                         CITYST2O
 14833         MOVE ZEROS                  TO  ZIPB2O
 14834         GO TO 6080-SET-INCURRED.
 14835
 14836     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 14837     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 14838     MOVE AM-CARRIER             TO  COMP-CARRIER.
 14839     MOVE AM-GROUPING            TO  COMP-GROUP.
 14840     MOVE 'A'                    TO  COMP-TYPE.
 14841     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14842                                 TO  COMP-FIN-RESP.
 14843
 14844     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 14845         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 14846                                       'G' OR 'B'
 14847             MOVE 'G'            TO  COMP-TYPE
 14848             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14849         ELSE
 14850             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14851                                 TO  COMP-ACCOUNT
 14852     ELSE
 14853         MOVE 'G'                TO  COMP-TYPE
 14854         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14855
 14856     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14857
 14858     IF COMP-REC-FOUND
 14859         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 284
* EL156.cbl
 14860         MOVE CO-ADDR-1          TO  ADDR1B2O
 14861         MOVE CO-ADDR-2          TO  ADDR2B2O
 14862*        MOVE CO-ADDR-3          TO  CITYST2O
 14863         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14864            DELIMITED BY '  ' INTO CITYST2O
 14865         END-STRING
 14866         MOVE CO-ZIP             TO  ZIPB2O
 14867     ELSE
 14868         MOVE 'NO COMP ADDRESS AVAILABLE'
 14869                                 TO  NAMEB2O
 14870                                     ADDR1B2O
 14871                                     ADDR2B2O
 14872                                     CITYST2O
 14873         MOVE ZEROS               TO ZIPB2O.
 14874
 14875 6080-SET-INCURRED.
 14876     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14877     MOVE SPACES                 TO DC-OPTION-CODE.
 14878     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14879     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14880     MOVE PI-PROCESSOR-ID        TO BYBO.
 14881     MOVE MAP-NAMEB              TO MAP-NAME.
 14882     MOVE 'C'                    TO PI-PASS-SW.
 14883     MOVE EIBAID                 TO PI-PFKEY-USED.
 14884     MOVE -1                     TO ENTPFBL.
 14885     GO TO 8100-SEND-INITIAL-MAP.
 14886
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 285
* EL156.cbl
 14888 6100-BUILD-PAYMENT-TRAILER.
 14889
 14890     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14891       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14892         GO TO 6105-STATE-CHECK-NUMBER
 14893     END-IF.
 14894
 14895     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14896     MOVE '6'                    TO CNTL-REC-TYPE.
 14897
 14898     IF CONTROL-IS-ACTUAL-CARRIER
 14899         MOVE PI-CARRIER         TO WS-CARR
 14900     ELSE
 14901         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14902
 14903     IF PI-COMPANY-ID = 'FIA'
 14904         MOVE PI-CARRIER         TO  WS-CARR.
 14905
 14906     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14907     MOVE 0                      TO CNTL-SEQ-NO.
 14908     MOVE 'CARR'                 TO FILE-SWITCH.
 14909
 14910     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14911
 14912     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14913         IF PI-OFFLINE     = 'Y' AND
 14914            PI-ECHECKNO-CR = 'CR'
 14915              GO TO 6110-READ-CONTROL
 14916         ELSE
 14917            IF PI-CASH = 'N'
 14918                GO TO 6110-READ-CONTROL.
 14919
 14920     IF CHECK-NO-MANUAL    OR
 14921        CHECK-NO-AT-PRINT  OR
 14922        PI-OFFLINE = 'Y'
 14923          GO TO 6130-BUILD-TRAILER.
 14924
 14925     IF PI-COMPANY-ID = 'FIA'
 14926         NEXT SENTENCE
 14927     ELSE
 14928         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14929             GO TO 6110-READ-CONTROL.
 14930
 14931     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14932
 14933     IF CHECK-CNT-RESET-VALUE
 14934        MOVE +1                  TO CF-CHECK-COUNTER
 14935     ELSE
 14936        ADD +1                   TO CF-CHECK-COUNTER.
 14937
 14938     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14939
 14940     IF CHECK-NO-CARR-SEQ
 14941        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14942
 14943     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14944
 14945     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 286
* EL156.cbl
 14946     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 14947        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 14948         MOVE 'Y' TO PI-REAUDIT-NEEDED
 14949         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 14950            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 14951         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 14952                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 14953     END-IF.
 14954
 14955     GO TO 6120-REWRITE.
 14956
 14957 6105-STATE-CHECK-NUMBER.
 14958     IF CHECK-NO-MANUAL    OR
 14959        CHECK-NO-AT-PRINT  OR
 14960        PI-OFFLINE = 'Y'
 14961           GO TO 6130-BUILD-TRAILER
 14962     END-IF.
 14963
 14964     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 14965     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 14966     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 14967     MOVE '3'                TO CNTL-REC-TYPE.
 14968     MOVE +0                 TO CNTL-SEQ-NO.
 14969     MOVE 'STAT'             TO FILE-SWITCH.
 14970     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14971
 14972     IF CF-ST-CHECK-CNT-RESET
 14973         MOVE +1             TO CF-ST-CHECK-COUNTER
 14974     ELSE
 14975         ADD +1              TO CF-ST-CHECK-COUNTER
 14976     END-IF.
 14977
 14978     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 14979     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 14980     GO TO 6120-REWRITE.
 14981
 14982 6110-READ-CONTROL.
 14983     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14984     MOVE '1'                    TO CNTL-REC-TYPE.
 14985     MOVE SPACES                 TO CNTL-ACCESS.
 14986     MOVE 0                      TO CNTL-SEQ-NO.
 14987
 14988     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14989
 14990     IF CO-CHECK-COUNT-RESET
 14991        MOVE +1                  TO CF-CO-CHECK-COUNTER
 14992     ELSE
 14993        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14994
 14995     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14996
 14997     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14998         IF PI-OFFLINE     = 'Y'  AND
 14999            PI-ECHECKNO-CR = 'CR'
 15000              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15001              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15002              MOVE AL-UANON           TO CHECKNOA
 15003              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 287
* EL156.cbl
 15004         ELSE
 15005         IF PI-CASH = 'N'
 15006             MOVE 'N'                TO PI-ECHECKNO-N
 15007             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15008             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15009             MOVE AL-UANON           TO CHECKNOA
 15010             GO TO 6120-REWRITE.
 15011
 15012     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15013
 15014 6120-REWRITE.
 15015
 15016* EXEC CICS REWRITE
 15017*         DATASET('ELCNTL')
 15018*         FROM(CONTROL-FILE)
 15019*     END-EXEC.
 15020     MOVE LENGTH OF
 15021      CONTROL-FILE
 15022       TO DFHEIV11
 15023     MOVE 'ELCNTL' TO DFHEIV1
 15024*    MOVE '&& L                  %   #00014074' TO DFHEIV0
 15025     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15026     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15027     MOVE X'2020233030303134303734' TO DFHEIV0(25:11)
 15028     CALL 'kxdfhei1' USING DFHEIV0,
 15029           DFHEIV1,
 15030           CONTROL-FILE,
 15031           DFHEIV11,
 15032           DFHEIV99
 15033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15034
 15035
 15036     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15037
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 288
* EL156.cbl
 15039 6130-BUILD-TRAILER.
 15040
 15041
 15042* EXEC CICS GETMAIN
 15043*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15044*         LENGTH    (200)
 15045*         INITIMG   (GETMAIN-SPACE)
 15046*     END-EXEC.
 15047     MOVE 200
 15048       TO DFHEIV11
 15049*    MOVE ',"IL                  $   #00014084' TO DFHEIV0
 15050     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15052     MOVE X'2020233030303134303834' TO DFHEIV0(25:11)
 15053     CALL 'kxdfhei1' USING DFHEIV0,
 15054           DFHEIV20,
 15055           DFHEIV11,
 15056           GETMAIN-SPACE
 15057     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15058         DFHEIV20
 15059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15060
 15061
 15062     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15063                                    AT-PREV-PAID-THRU-DT.
 15064     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15065     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15066     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15067     MOVE 'AT'                   TO AT-RECORD-ID.
 15068     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15069
 15070     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15071        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15072           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15073     ELSE
 15074           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15075           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15076
 15077     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15078         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15079             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15080             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15081           ELSE
 15082             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15083             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15084
 15085     MOVE '2'                    TO AT-TRAILER-TYPE.
 15086     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15087                                    AT-PAYMENT-LAST-MAINT-DT.
 15088     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15089                                    AT-PAYMENT-LAST-UPDATED-BY.
 15090     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15091     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15092     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15093     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15094
 15095     IF PI-PMT-APPROVED
 15096        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 289
* EL156.cbl
 15097           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15098
 15099     IF PI-PFKEY-USED = DFHPF5
 15100        GO TO 6140-PF5-ENTERED.
 15101
 15102     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15103     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15104
 15105     IF PI-AIG-SPECIAL-BENEFIT
 15106         IF WS-1ST-SPECIAL-PMT
 15107             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15108             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15109                                        AT-AMOUNT-PAID
 15110         ELSE
 15111             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15112
 15113     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15114
 15115     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15116     MOVE '4'                    TO DC-OPTION-CODE.
 15117     PERFORM 9700-LINK-DATE-CONVERT.
 15118
 15119     IF DATE-CONVERSION-ERROR
 15120        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15121     ELSE
 15122        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15123
 15124     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15125     MOVE '4'                    TO DC-OPTION-CODE.
 15126     PERFORM 9700-LINK-DATE-CONVERT.
 15127
 15128     IF DATE-CONVERSION-ERROR
 15129        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15130     ELSE
 15131        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15132
 15133     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15134     GO TO 6150-FINISH-MOVE.
 15135
 15136 6140-PF5-ENTERED.
 15137     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15138     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15139
 15140     IF PI-AIG-SPECIAL-BENEFIT
 15141         IF WS-1ST-SPECIAL-PMT
 15142             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15143             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15144                                        AT-AMOUNT-PAID
 15145         ELSE
 15146             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15147
 15148     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15149     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15150     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15151
 15152 6150-FINISH-MOVE.
 15153
 15154     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 290
* EL156.cbl
 15155         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15156     ELSE
 15157         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15158
 15159     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15160     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15161
 15162*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15163*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15164
 15165     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15166         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15167
 15168     IF PI-OFFLINE = 'N'
 15169        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15170        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15171     ELSE
 15172        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15173        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15174
 15175     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15176
 15177     IF WS-2ND-SPECIAL-PMT
 15178         MOVE 'Y'                TO AT-CASH-PAYMENT
 15179         MOVE SPACES             TO AT-CHECK-NO
 15180         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15181         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15182         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15183         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15184
 15185     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15186                                    AT-TO-BE-WRITTEN-DT.
 15187
 15188     IF PI-HOLDTIL NOT = ZEROS
 15189        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15190        MOVE '4'                 TO DC-OPTION-CODE
 15191        PERFORM 9700-LINK-DATE-CONVERT
 15192        IF PI-OFFLINE = 'N'
 15193           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15194        ELSE
 15195           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15196
 15197     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15198     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15199                                    AT-CHECK-QUE-SEQUENCE.
 15200
 15201     IF PI-PFKEY-USED = DFHPF4
 15202        MOVE '1'                 TO AT-FORCE-CONTROL.
 15203
 15204     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15205        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15206        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15207        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15208
 15209     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15210                                    AT-VOID-SELECT-DT
 15211                                    AT-VOID-ACCEPT-DT
 15212                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 291
* EL156.cbl
 15213     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15214        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15215        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15216        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15217        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15218     ELSE
 15219        MOVE ZEROS               TO AT-DAILY-RATE
 15220                                    AT-ELIMINATION-DAYS
 15221        MOVE SPACES              TO AT-BENEFIT-TYPE
 15222     END-IF
 15223     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15224     MOVE '4'                    TO DC-OPTION-CODE.
 15225     PERFORM 9700-LINK-DATE-CONVERT.
 15226     IF DATE-CONVERSION-ERROR
 15227         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15228     ELSE
 15229         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15230     END-IF.
 15231     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15232     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15233     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15234     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15235     IF PI-REAUDIT-NEEDED = 'Y'
 15236         MOVE '5' TO AT-APPROVAL-LEVEL-REQD
 15237         MOVE 'Y' TO WS-NEED-APPROVAL
 15238         GO TO 6170-WRITE
 15239     END-IF.
 15240*******************************************************
 15241     IF NOT PI-PMT-GRADUATED
 15242         GO TO 6170-WRITE.
 15243
 15244     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15245     MOVE '1'                    TO CNTL-REC-TYPE.
 15246     MOVE SPACES                 TO CNTL-ACCESS.
 15247     MOVE +0                     TO CNTL-SEQ-NO.
 15248     MOVE 'COMP'                 TO FILE-SWITCH.
 15249
 15250     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15251
 15252     IF PAID-FOR-LIFE
 15253         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15254             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15255                                     WS-PMT-APPROVAL-SW
 15256             GO TO 6170-WRITE.
 15257
 15258*05999      IF PAID-FOR-AH
 15259     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15260         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15261             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15262                                     WS-PMT-APPROVAL-SW
 15263             GO TO 6170-WRITE.
 15264
 15265     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15266
 15267******A&H Limits are set as a monthly payment.  Calculate the mont
 15268******equivalent of the amount paid today
 15269     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15270        PI-SAVE-ODD-DAYS-OVER > 0
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 292
* EL156.cbl
 15271           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15272                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15273           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15274                                  WS-CALC-PMT-MONTHS
 15275     ELSE
 15276           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15277     END-IF.
 15278*06007      IF ((PAID-FOR-AH) AND
 15279     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15280*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15281        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15282              OR
 15283        ((PAID-FOR-LIFE) AND
 15284        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15285            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15286       ELSE
 15287*06014      IF ((PAID-FOR-AH)  AND
 15288         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15289*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15290           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15291              OR
 15292        ((PAID-FOR-LIFE) AND
 15293        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15294            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15295         ELSE
 15296*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15297           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15298               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15299              OR
 15300          ((PAID-FOR-LIFE) AND
 15301          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15302            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15303       ELSE
 15304           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15305               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15306              OR
 15307          ((PAID-FOR-LIFE) AND
 15308          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15309            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15310       ELSE
 15311            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15312
 15313     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15314        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15315        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15316            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15317        END-IF
 15318     ELSE
 15319     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15320        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15321        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15322            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15323        END-IF
 15324     ELSE
 15325     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15326        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15327        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15328            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 293
* EL156.cbl
 15329        END-IF
 15330     ELSE
 15331     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15332        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15333        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15334            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15335        END-IF
 15336     ELSE
 15337     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15338            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15339
 15340     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15341
 15342     IF NOT PI-PMT-GRADUATED
 15343         GO TO 6170-WRITE.
 15344
 15345
 15346* EXEC CICS HANDLE CONDITION
 15347*        NOTFND   (6170-WRITE)
 15348*    END-EXEC.
 15349*    MOVE '"$I                   ! 2 #00014373' TO DFHEIV0
 15350     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15352     MOVE X'3220233030303134333733' TO DFHEIV0(25:11)
 15353     CALL 'kxdfhei1' USING DFHEIV0
 15354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15355
 15356
 15357     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15358     MOVE '2'                    TO CNTL-REC-TYPE.
 15359     MOVE +0                     TO CNTL-SEQ-NO.
 15360     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15361
 15362
 15363* EXEC CICS READ
 15364*         DATASET  ('ELCNTL')
 15365*         SET      (ADDRESS OF CONTROL-FILE)
 15366*         RIDFLD   (ELCNTL-KEY)
 15367*    END-EXEC.
 15368     MOVE 'ELCNTL' TO DFHEIV1
 15369*    MOVE '&"S        E          (   #00014382' TO DFHEIV0
 15370     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15371     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15372     MOVE X'2020233030303134333832' TO DFHEIV0(25:11)
 15373     CALL 'kxdfhei1' USING DFHEIV0,
 15374           DFHEIV1,
 15375           DFHEIV20,
 15376           DFHEIV99,
 15377           ELCNTL-KEY,
 15378           DFHEIV99,
 15379           DFHEIV99,
 15380           DFHEIV99
 15381     SET ADDRESS OF CONTROL-FILE TO
 15382         DFHEIV20
 15383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15384
 15385
 15386     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 294
* EL156.cbl
 15387
 15388     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15389                         OR '4' OR '5'
 15390         NEXT SENTENCE
 15391     ELSE
 15392         MOVE 'Y' TO WS-NEED-APPROVAL
 15393         GO TO 6170-WRITE.
 15394
 15395     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15396         MOVE 'Y' TO WS-NEED-APPROVAL
 15397         IF WS-APPROVAL-LEVEL = '1'
 15398             MOVE '2'        TO  AT-APPROVED-LEVEL
 15399                            WS-SAVE-APPROVED-LEVEL
 15400             GO TO 6170-WRITE
 15401         ELSE
 15402             IF WS-APPROVAL-LEVEL = '2'
 15403                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15404                                WS-SAVE-APPROVED-LEVEL
 15405                 GO TO 6170-WRITE
 15406             ELSE IF WS-APPROVAL-LEVEL = '3'
 15407                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15408                                WS-SAVE-APPROVED-LEVEL
 15409                 GO TO 6170-WRITE
 15410             ELSE IF WS-APPROVAL-LEVEL = '4'
 15411                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15412                                WS-SAVE-APPROVED-LEVEL
 15413                 GO TO 6170-WRITE.
 15414
 15415     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15416                             WS-PMT-APPROVAL-SW.
 15417     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15418                             AT-APPROVAL-LEVEL-REQD.
 15419
 15420*******************************************************
 15421
 15422 6170-WRITE.
 15423
 15424     if pi-company-id = 'DCC'
 15425        MOVE ' '                 TO WS-PDEF-RECORD-SW
 15426        PERFORM 0900-GET-DDF-FACTORS
 15427                                 THRU 0900-EXIT
 15428     end-if
 15429    perform 2220-update-elcrtt   thru 2220-exit
 15430     IF PI-COMPANY-ID = 'DMD'
 15431        IF PI-AT-EOB-CODES NOT = SPACES
 15432           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15433           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15434           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15435           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15436           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15437
 15438
 15439* EXEC CICS HANDLE CONDITION
 15440*        DUPREC    (6180-DUPREC)
 15441*    END-EXEC.
 15442*    MOVE '"$%                   ! 3 #00014440' TO DFHEIV0
 15443     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 295
* EL156.cbl
 15445     MOVE X'3320233030303134343430' TO DFHEIV0(25:11)
 15446     CALL 'kxdfhei1' USING DFHEIV0
 15447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15448
 15449
 15450
 15451* EXEC CICS WRITE
 15452*         DATASET       ('ELTRLR')
 15453*         FROM          (ACTIVITY-TRAILERS)
 15454*         RIDFLD        (AT-CONTROL-PRIMARY)
 15455*     END-EXEC.
 15456     MOVE LENGTH OF
 15457      ACTIVITY-TRAILERS
 15458       TO DFHEIV11
 15459     MOVE 'ELTRLR' TO DFHEIV1
 15460*    MOVE '&$ L                  ''   #00014444' TO DFHEIV0
 15461     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15462     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15463     MOVE X'2020233030303134343434' TO DFHEIV0(25:11)
 15464     CALL 'kxdfhei1' USING DFHEIV0,
 15465           DFHEIV1,
 15466           ACTIVITY-TRAILERS,
 15467           DFHEIV11,
 15468           AT-CONTROL-PRIMARY,
 15469           DFHEIV99,
 15470           DFHEIV99
 15471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15472
 15473
 15474     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15475        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15476*06088           GO TO 6199-EXIT.
 15477           GO TO 6176-APPROVAL-NOTE.
 15478
 15479
 15480* EXEC CICS GETMAIN
 15481*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15482*         LENGTH    (200)
 15483*         INITIMG   (GETMAIN-SPACE)
 15484*     END-EXEC.
 15485     MOVE 200
 15486       TO DFHEIV11
 15487*    MOVE ',"IL                  $   #00014455' TO DFHEIV0
 15488     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15489     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15490     MOVE X'2020233030303134343535' TO DFHEIV0(25:11)
 15491     CALL 'kxdfhei1' USING DFHEIV0,
 15492           DFHEIV20,
 15493           DFHEIV11,
 15494           GETMAIN-SPACE
 15495     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15496         DFHEIV20
 15497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15498
 15499
 15500     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15501
 15502     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 296
* EL156.cbl
 15503     MOVE 'AT'                   TO AT-RECORD-ID.
 15504     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15505     MOVE '6'                    TO AT-TRAILER-TYPE.
 15506     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15507                                    AT-GEN-INFO-LAST-MAINT-DT
 15508     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15509                                    AT-GEN-INFO-LAST-UPDATED-BY
 15510     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15511
 15512     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15513     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15514     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15515
 15516     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15517
 15518 6175-WRITE.
 15519
 15520
 15521* EXEC CICS HANDLE CONDITION
 15522*        DUPREC    (6190-DUPREC)
 15523*    END-EXEC.
 15524*    MOVE '"$%                   ! 4 #00014481' TO DFHEIV0
 15525     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15527     MOVE X'3420233030303134343831' TO DFHEIV0(25:11)
 15528     CALL 'kxdfhei1' USING DFHEIV0
 15529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15530
 15531
 15532
 15533* EXEC CICS WRITE
 15534*         DATASET     ('ELTRLR')
 15535*         FROM        (ACTIVITY-TRAILERS)
 15536*         RIDFLD      (AT-CONTROL-PRIMARY)
 15537*     END-EXEC.
 15538     MOVE LENGTH OF
 15539      ACTIVITY-TRAILERS
 15540       TO DFHEIV11
 15541     MOVE 'ELTRLR' TO DFHEIV1
 15542*    MOVE '&$ L                  ''   #00014485' TO DFHEIV0
 15543     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15544     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15545     MOVE X'2020233030303134343835' TO DFHEIV0(25:11)
 15546     CALL 'kxdfhei1' USING DFHEIV0,
 15547           DFHEIV1,
 15548           ACTIVITY-TRAILERS,
 15549           DFHEIV11,
 15550           AT-CONTROL-PRIMARY,
 15551           DFHEIV99,
 15552           DFHEIV99
 15553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15554
 15555
 15556 6176-APPROVAL-NOTE.
 15557
 15558     IF NOT APPROVAL-NEEDED
 15559         GO TO 6199-EXIT.
 15560
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 297
* EL156.cbl
 15561
 15562* EXEC CICS GETMAIN
 15563*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15564*        LENGTH    (200)
 15565*        INITIMG   (GETMAIN-SPACE)
 15566*    END-EXEC.
 15567     MOVE 200
 15568       TO DFHEIV11
 15569*    MOVE ',"IL                  $   #00014496' TO DFHEIV0
 15570     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15571     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15572     MOVE X'2020233030303134343936' TO DFHEIV0(25:11)
 15573     CALL 'kxdfhei1' USING DFHEIV0,
 15574           DFHEIV20,
 15575           DFHEIV11,
 15576           GETMAIN-SPACE
 15577     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15578         DFHEIV20
 15579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15580
 15581
 15582     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15583
 15584     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15585     MOVE 'AT'               TO AT-RECORD-ID
 15586     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15587     MOVE '6'                TO AT-TRAILER-TYPE
 15588     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15589                                AT-GEN-INFO-LAST-MAINT-DT
 15590     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15591                                AT-GEN-INFO-LAST-UPDATED-BY
 15592     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15593
 15594     IF PI-REAUDIT-NEEDED = 'Y'
 15595         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15596     ELSE
 15597         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15598     END-IF
 15599     MOVE SPACES             TO AT-INFO-LINE-2
 15600
 15601     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15602 6177-WRITE.
 15603
 15604
 15605* EXEC CICS HANDLE CONDITION
 15606*        DUPREC    (6185-DUPREC)
 15607*    END-EXEC.
 15608*    MOVE '"$%                   ! 5 #00014524' TO DFHEIV0
 15609     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15611     MOVE X'3520233030303134353234' TO DFHEIV0(25:11)
 15612     CALL 'kxdfhei1' USING DFHEIV0
 15613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15614
 15615
 15616
 15617* EXEC CICS WRITE
 15618*         DATASET     ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 298
* EL156.cbl
 15619*         FROM        (ACTIVITY-TRAILERS)
 15620*         RIDFLD      (AT-CONTROL-PRIMARY)
 15621*     END-EXEC.
 15622     MOVE LENGTH OF
 15623      ACTIVITY-TRAILERS
 15624       TO DFHEIV11
 15625     MOVE 'ELTRLR' TO DFHEIV1
 15626*    MOVE '&$ L                  ''   #00014528' TO DFHEIV0
 15627     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15629     MOVE X'2020233030303134353238' TO DFHEIV0(25:11)
 15630     CALL 'kxdfhei1' USING DFHEIV0,
 15631           DFHEIV1,
 15632           ACTIVITY-TRAILERS,
 15633           DFHEIV11,
 15634           AT-CONTROL-PRIMARY,
 15635           DFHEIV99,
 15636           DFHEIV99
 15637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15638
 15639
 15640
 15641     GO TO 6199-EXIT.
 15642
 15643 6180-DUPREC.
 15644
 15645     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15646     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15647     GO TO 6170-WRITE.
 15648
 15649 6185-DUPREC.
 15650     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15651     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15652     GO TO 6177-WRITE.
 15653
 15654 6190-DUPREC.
 15655     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15656     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15657     GO TO 6175-WRITE.
 15658
 15659 6199-EXIT.
 15660      EXIT.
 15661
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 299
* EL156.cbl
 15663 6200-UPDATE-CLAIM-MSTR.
 15664     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15665     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15666     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15667     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15668
 15669     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15670
 15671     MOVE ZEROS                  TO W-INTEREST.
 15672
 15673     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15674        IF (PI-OFFLINE = 'Y') OR
 15675           (PI-PMTTYPE = '7')
 15676           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15677                                 THRU 9870-EXIT
 15678        END-IF
 15679     END-IF
 15680     IF NOT ERROR-ON-OUTPUT
 15681        CONTINUE
 15682     ELSE
 15683
 15684* EXEC CICS REWRITE
 15685*          DATASET('ELMSTR')
 15686*          FROM(CLAIM-MASTER)
 15687*       END-EXEC
 15688     MOVE LENGTH OF
 15689      CLAIM-MASTER
 15690       TO DFHEIV11
 15691     MOVE 'ELMSTR' TO DFHEIV1
 15692*    MOVE '&& L                  %   #00014577' TO DFHEIV0
 15693     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15694     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15695     MOVE X'2020233030303134353737' TO DFHEIV0(25:11)
 15696     CALL 'kxdfhei1' USING DFHEIV0,
 15697           DFHEIV1,
 15698           CLAIM-MASTER,
 15699           DFHEIV11,
 15700           DFHEIV99
 15701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15702
 15703        MOVE -1                  TO ENTPFBL
 15704        MOVE AL-UANON            TO ENTPFBA
 15705        MOVE MAP-NAMEB           TO MAP-NAME
 15706        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15707        GO TO 8200-SEND-DATAONLY
 15708     END-IF
 15709
 15710     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15711
 15712     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15713
 15714     IF PI-AIG-SPECIAL-BENEFIT
 15715         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15716
 15717     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15718
 15719     IF PI-SPECIAL-BEN-SW = 'Y'
 15720         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 300
* EL156.cbl
 15721         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15722
 15723     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15724         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15725     ELSE
 15726         IF PI-PMTTYPE NOT = '4'
 15727            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15728
 15729     IF PI-PMTTYPE = '5' OR '6'
 15730        GO TO  6250-SET-MAINT.
 15731
 15732     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 15733                                         CL-LAG-REPORT-CODE.
 15734
 15735     IF CL-ACTIVITY-CODE = 09
 15736         GO TO 6200-CONT-UPDATE.
 15737
 15738     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15739         IF CL-ACTIVITY-CODE = 11
 15740             GO TO 6200-CONT-UPDATE.
 15741
 15742     IF WS-ACT-REC-FOUND-SW = 'N'
 15743         GO TO 6200-CONT-UPDATE.
 15744
 15745     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 15746         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 15747         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 15748         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 15749
 15750     IF WS-UPDATE-SW = 'Y'
 15751         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 15752                                         CL-NEXT-FOLLOWUP-DT.
 15753
 15754 6200-CONT-UPDATE.
 15755
 15756     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15757       IF CLAIM-IS-CLOSED
 15758         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15759           IF WS-OPEN-CLOSE-SW = '2'
 15760             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 15761                                        CL-LAST-CLOSE-DT.
 15762
 15763     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 15764        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 15765        MOVE 'O'                 TO CL-CLAIM-STATUS.
 15766
 15767     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 15768        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 15769        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 15770        MOVE 'C'                 TO CL-CLAIM-STATUS
 15771        IF PI-PMTTYPE = '2'
 15772           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15773           CONTINUE
 15774        ELSE
 15775           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15776        END-IF
 15777     ELSE
 15778        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 301
* EL156.cbl
 15779           IF PI-PMTTYPE = '2' AND
 15780              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15781              CONTINUE
 15782           ELSE
 15783              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15784           END-IF
 15785        END-IF
 15786     END-IF
 15787
 15788     IF PI-PMTTYPE = '4'
 15789        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 15790
 15791     IF PI-COMPANY-ID = 'CVL'
 15792         IF PI-LOAN-UPDATE-SW = 'Y'
 15793             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 15794             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 15795             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 15796             MOVE CL-CERT-STATE      TO  CERT-STATE
 15797             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 15798             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 15799             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 15800             MOVE 'CERT'             TO  FILE-SWITCH
 15801             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 15802             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 15803             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 15804
 15805     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 15806        GO TO 6220-USE-COMPUTED.
 15807
 15808     IF (PI-PMTTYPE = '4')  AND
 15809        (PI-EPYAMT < ZEROS)
 15810          COMPUTE CL-NO-OF-DAYS-PAID =
 15811                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 15812          IF CL-NO-OF-DAYS-PAID < +0
 15813              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15814          ELSE
 15815              NEXT SENTENCE
 15816     ELSE
 15817          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 15818
 15819     IF PI-PROCESSOR-ID = 'FIX '
 15820        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15821           NEXT SENTENCE
 15822        ELSE
 15823           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 15824     ELSE
 15825        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 15826
 15827     IF PI-PMTTYPE = '4'
 15828        GO TO 6250-SET-MAINT.
 15829
 15830     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15831
 15832     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15833     MOVE '4'                    TO DC-OPTION-CODE.
 15834     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15835     IF DATE-CONVERSION-ERROR
 15836        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 302
* EL156.cbl
 15837     ELSE
 15838        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 15839           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 15840           IF PI-AIG-SPECIAL-BENEFIT
 15841               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 15842           ELSE
 15843               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 15844
 15845     GO TO 6250-SET-MAINT.
 15846
 15847 6220-USE-COMPUTED.
 15848
 15849     IF (PI-PMTTYPE = '4')  AND
 15850        (PI-CPYAMT < ZEROS)
 15851          COMPUTE CL-NO-OF-DAYS-PAID =
 15852                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 15853          IF CL-NO-OF-DAYS-PAID < +0
 15854              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15855          ELSE
 15856              NEXT SENTENCE
 15857     ELSE
 15858          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 15859
 15860     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 15861
 15862     IF PI-PMTTYPE = '4'
 15863        GO TO 6250-SET-MAINT.
 15864
 15865     IF PI-AIG-SPECIAL-BENEFIT
 15866         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 15867     ELSE
 15868         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 15869
 15870     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15871
 15872     IF PI-CPYTHRU > CL-PAID-THRU-DT
 15873        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 15874
 15875 6250-SET-MAINT.
 15876     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 15877
 15878     IF PI-PROCESSOR-ID = 'FIX '
 15879        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 15880           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 15881        ELSE
 15882           NEXT SENTENCE
 15883     ELSE
 15884        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 15885
 15886     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 15887     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 15888     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 15889
 15890 6299-EXIT.
 15891      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 303
* EL156.cbl
 15893 6300-UPDATE-CERT.
 15894
 15895*  ADD CERTNOTE FOR SC NP+6
 15896     IF PI-COMPANY-ID = 'CID' AND
 15897       (PI-PMTTYPE = '2' OR '3') AND
 15898        CL-CERT-STATE = 'SC'  AND
 15899        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15900           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15901     END-IF.
 15902
 15903     IF PI-COMPANY-ID = 'AHL' AND
 15904       (PI-PMTTYPE = '2' OR '3') AND
 15905        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 15906           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 15907           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15908     END-IF.
 15909
 15910     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15911     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15912     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15913     MOVE CL-CERT-STATE    TO CERT-STATE.
 15914     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15915     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15916     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15917     MOVE 'CERT'           TO FILE-SWITCH.
 15918
 15919     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15920
 15921     IF CERT-NOTE-ADDED
 15922        IF CM-NOTE-SW = ' '
 15923           MOVE '4'             TO CM-NOTE-SW
 15924        ELSE
 15925           IF CM-NOTE-SW = '1'
 15926               MOVE '5'           TO CM-NOTE-SW
 15927           ELSE
 15928              IF CM-NOTE-SW = '2'
 15929                 MOVE '6'         TO CM-NOTE-SW
 15930              ELSE
 15931                 IF CM-NOTE-SW = '3'
 15932                    MOVE '7'      TO CM-NOTE-SW
 15933                 END-IF
 15934              END-IF
 15935           END-IF
 15936        END-IF
 15937     END-IF.
 15938
 15939     IF PI-COMPANY-ID = 'CVL'
 15940         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15941         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15942
 15943     IF PI-PMTTYPE NOT = '4'
 15944        GO TO 6340-UPDATE-CERT.
 15945
 15946     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15947        IF PI-PFKEY-USED = DFHPF5
 15948           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15949        ELSE
 15950           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 304
* EL156.cbl
 15951
 15952*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15953*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15954*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15955*               PI-LF-COVERAGE-TYPE = 'P'
 15956*                GO TO 6350-REWRITE-CERT.
 15957
 15958     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15959       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15960          PI-LF-COVERAGE-TYPE = 'P'
 15961           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15962                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15963                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15964                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15965                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 15966                GO TO 6350-REWRITE-CERT
 15967            ELSE
 15968                GO TO 6350-REWRITE-CERT.
 15969
 15970     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15971         GO TO 6350-REWRITE-CERT.
 15972
 15973     IF NOT CM-AH-LUMP-SUM-DISAB
 15974        GO TO 6380-UNLOCK-CERT.
 15975
 15976     IF PI-PFKEY-USED = DFHPF5
 15977        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 15978                                    CM-AH-ITD-AH-PMT
 15979        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15980        GO TO 6350-REWRITE-CERT
 15981     ELSE
 15982        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 15983                                    CM-AH-ITD-AH-PMT
 15984        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15985        GO TO 6350-REWRITE-CERT.
 15986
 15987 6340-UPDATE-CERT.
 15988
 15989     IF CL-CLAIM-TYPE = 'L'
 15990         IF PI-PFKEY-USED = DFHPF5
 15991             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 15992         ELSE
 15993             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 15994
 15995     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15996         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15997             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15998                PI-LF-COVERAGE-TYPE = 'P'
 15999                 GO TO 6350-REWRITE-CERT.
 16000
 16001     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16002       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16003          PI-LF-COVERAGE-TYPE = 'P'
 16004           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16005                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16006                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16007                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16008                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 305
* EL156.cbl
 16009                GO TO 6350-REWRITE-CERT.
 16010
 16011     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16012         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16013            PI-LF-COVERAGE-TYPE NOT = 'P'
 16014             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16015             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16016             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16017             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16018             GO TO 6350-REWRITE-CERT.
 16019
 16020     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16021         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16022         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16023         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16024         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16025         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16026         IF PI-PFKEY-USED = DFHPF5
 16027             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16028                                        CM-AH-ITD-AH-PMT
 16029             GO TO 6350-REWRITE-CERT
 16030         ELSE
 16031             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16032                                        CM-AH-ITD-AH-PMT
 16033             GO TO 6350-REWRITE-CERT.
 16034
 16035 6350-REWRITE-CERT.
 16036
 16037
 16038* EXEC CICS REWRITE
 16039*         DATASET  ('ELCERT')
 16040*         FROM(CERTIFICATE-MASTER)
 16041*     END-EXEC.
 16042     MOVE LENGTH OF
 16043      CERTIFICATE-MASTER
 16044       TO DFHEIV11
 16045     MOVE 'ELCERT' TO DFHEIV1
 16046*    MOVE '&& L                  %   #00014916' TO DFHEIV0
 16047     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16048     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16049     MOVE X'2020233030303134393136' TO DFHEIV0(25:11)
 16050     CALL 'kxdfhei1' USING DFHEIV0,
 16051           DFHEIV1,
 16052           CERTIFICATE-MASTER,
 16053           DFHEIV11,
 16054           DFHEIV99
 16055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16056
 16057
 16058     GO TO 6399-EXIT.
 16059
 16060 6380-UNLOCK-CERT.
 16061
 16062* EXEC CICS UNLOCK
 16063*         DATASET  ('ELCERT')
 16064*     END-EXEC.
 16065     MOVE 'ELCERT' TO DFHEIV1
 16066*    MOVE '&*                    #   #00014924' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 306
* EL156.cbl
 16067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16069     MOVE X'2020233030303134393234' TO DFHEIV0(25:11)
 16070     CALL 'kxdfhei1' USING DFHEIV0,
 16071           DFHEIV1,
 16072           DFHEIV99
 16073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16074
 16075
 16076 6399-EXIT.
 16077      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 307
* EL156.cbl
 16079 6400-UPDATE-ZERO-TRAILER.
 16080     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16081     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16082
 16083     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16084
 16085     IF PI-EPYAMT NOT = ZEROS
 16086         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16087     ELSE
 16088         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16089
 16090     IF PI-ERESV NOT = ZEROS
 16091        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16092
 16093     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16094        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16095
 16096     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16097        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16098     ELSE
 16099        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16100
 16101     IF PI-PMTTYPE = '5'
 16102        IF PI-EPYAMT = ZEROS
 16103           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16104        ELSE
 16105           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16106
 16107     IF PI-PMTTYPE = '6'
 16108        IF PI-EPYAMT = ZEROS
 16109           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16110        ELSE
 16111           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16112
 16113 6420-CHECK-OPEN-CLOSE.
 16114     IF PI-PMTTYPE = '5' OR '6'
 16115        GO TO 6450-REWRITE.
 16116
 16117     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16118         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16119             IF CLAIM-IS-CLOSED
 16120                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16121                 MOVE 1          TO  SUB-1
 16122                 GO TO 6440-AIG-LOOP.
 16123
 16124     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16125        GO TO 6450-REWRITE.
 16126
 16127     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16128        GO TO 6450-REWRITE.
 16129
 16130     MOVE 1                      TO SUB-1.
 16131
 16132 6430-LOOP.
 16133     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16134        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16135        IF PI-PMTTYPE = '1' OR '4'
 16136           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 308
* EL156.cbl
 16137           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16138           GO TO 6450-REWRITE
 16139        ELSE
 16140           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16141           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16142           GO TO 6450-REWRITE.
 16143
 16144     IF SUB-1 = 6
 16145      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16146      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16147      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16148      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16149      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16150      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16151      GO TO 6430-LOOP.
 16152
 16153     ADD 1                       TO SUB-1.
 16154     GO TO 6430-LOOP.
 16155
 16156
 16157 6440-AIG-LOOP.
 16158
 16159     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16160       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16161       IF WS-OPEN-CLOSE-SW = '1'
 16162         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16163         IF PI-PMTTYPE = '2'
 16164           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16165           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16166         ELSE
 16167           IF PI-PMTTYPE = '3'
 16168             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16169             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16170           ELSE
 16171             IF PI-PMTTYPE = '4'
 16172               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16173               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16174             ELSE
 16175               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16176               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16177       ELSE
 16178         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16179         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16180         GO TO 6450-REWRITE.
 16181
 16182     IF SUB-1 = 6
 16183      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16184      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16185      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16186      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16187      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16188      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16189      GO TO 6440-AIG-LOOP.
 16190
 16191     ADD 1                       TO SUB-1.
 16192     GO TO 6440-AIG-LOOP.
 16193
 16194 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 309
* EL156.cbl
 16195     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16196     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16197     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16198
 16199     IF PI-COMPANY-ID = 'DMD'
 16200         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16201         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16202         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16203         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16204         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16205
 16206
 16207* EXEC CICS REWRITE
 16208*         DATASET  ('ELTRLR')
 16209*         FROM     (ACTIVITY-TRAILERS)
 16210*     END-EXEC.
 16211     MOVE LENGTH OF
 16212      ACTIVITY-TRAILERS
 16213       TO DFHEIV11
 16214     MOVE 'ELTRLR' TO DFHEIV1
 16215*    MOVE '&& L                  %   #00015058' TO DFHEIV0
 16216     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16217     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16218     MOVE X'2020233030303135303538' TO DFHEIV0(25:11)
 16219     CALL 'kxdfhei1' USING DFHEIV0,
 16220           DFHEIV1,
 16221           ACTIVITY-TRAILERS,
 16222           DFHEIV11,
 16223           DFHEIV99
 16224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16225
 16226
 16227 6499-EXIT.
 16228      EXIT.
 16229
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 310
* EL156.cbl
 16231 6500-READ-DLO035.
 16232     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16233     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16234     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16235     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16236
 16237
 16238* EXEC CICS LINK
 16239*        PROGRAM    ('DLO035')
 16240*        COMMAREA   (DLO035-KEY)
 16241*        LENGTH     (DL35-LENGTH)
 16242*    END-EXEC.
 16243     MOVE 'DLO035' TO DFHEIV1
 16244*    MOVE '."C                   (   #00015073' TO DFHEIV0
 16245     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16247     MOVE X'2020233030303135303733' TO DFHEIV0(25:11)
 16248     CALL 'kxdfhei1' USING DFHEIV0,
 16249           DFHEIV1,
 16250           DLO035-KEY,
 16251           DL35-LENGTH,
 16252           DFHEIV99,
 16253           DFHEIV99,
 16254           DFHEIV99,
 16255           DFHEIV99
 16256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16257
 16258
 16259     IF DL35-RETURN-CODE = 'OK'
 16260         GO TO 6500-EXIT.
 16261
 16262     IF DL35-RETURN-CODE = '01'
 16263         MOVE ER-7830            TO EMI-ERROR
 16264         GO TO 6500-BAD-EXIT.
 16265
 16266     IF DL35-RETURN-CODE = '02'
 16267         MOVE ER-7831            TO EMI-ERROR
 16268         GO TO 6500-BAD-EXIT.
 16269
 16270     IF DL35-RETURN-CODE = '03'
 16271         MOVE ER-7832            TO EMI-ERROR
 16272         GO TO 6500-BAD-EXIT.
 16273
 16274     IF DL35-RETURN-CODE = '04'
 16275         MOVE ER-7833            TO EMI-ERROR
 16276         GO TO 6500-BAD-EXIT.
 16277
 16278     IF DL35-RETURN-CODE = '05'
 16279         MOVE ER-7834            TO EMI-ERROR
 16280         GO TO 6500-BAD-EXIT.
 16281
 16282     IF DL35-RETURN-CODE = '06'
 16283         MOVE ER-7835            TO EMI-ERROR
 16284         GO TO 6500-BAD-EXIT.
 16285
 16286     IF DL35-RETURN-CODE = '07'
 16287         MOVE ER-7836            TO EMI-ERROR
 16288         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 311
* EL156.cbl
 16289
 16290     IF DL35-RETURN-CODE = 'E1'
 16291         MOVE ER-7837            TO EMI-ERROR
 16292         GO TO 6500-BAD-EXIT.
 16293
 16294     IF DL35-RETURN-CODE NOT = 'OK'
 16295         MOVE ER-7838            TO EMI-ERROR
 16296         GO TO 6500-BAD-EXIT.
 16297
 16298 6500-EXIT.
 16299      EXIT.
 16300
 16301 6500-BAD-EXIT.
 16302
 16303* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16304*    MOVE '6"R                   !   #00015122' TO DFHEIV0
 16305     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16307     MOVE X'2020233030303135313232' TO DFHEIV0(25:11)
 16308     CALL 'kxdfhei1' USING DFHEIV0
 16309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16310
 16311     MOVE -1                 TO PMTTYPEL.
 16312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16313     GO TO 8200-SEND-DATAONLY.
 16314
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 312
* EL156.cbl
 16316 6600-UPDATE-DLO035.
 16317     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16318     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16319     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16320     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16321
 16322
 16323* EXEC CICS LINK
 16324*        PROGRAM    ('DLO035')
 16325*        COMMAREA   (DLO035-KEY)
 16326*        LENGTH     (DL35-LENGTH)
 16327*    END-EXEC.
 16328     MOVE 'DLO035' TO DFHEIV1
 16329*    MOVE '."C                   (   #00015134' TO DFHEIV0
 16330     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16332     MOVE X'2020233030303135313334' TO DFHEIV0(25:11)
 16333     CALL 'kxdfhei1' USING DFHEIV0,
 16334           DFHEIV1,
 16335           DLO035-KEY,
 16336           DL35-LENGTH,
 16337           DFHEIV99,
 16338           DFHEIV99,
 16339           DFHEIV99,
 16340           DFHEIV99
 16341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16342
 16343
 16344     IF DL35-RETURN-CODE = 'OK'
 16345         GO TO 6600-EXIT.
 16346
 16347     IF DL35-RETURN-CODE = '01'
 16348         MOVE ER-7830            TO EMI-ERROR
 16349         GO TO 6500-BAD-EXIT.
 16350
 16351     IF DL35-RETURN-CODE = '02'
 16352         MOVE ER-7831            TO EMI-ERROR
 16353         GO TO 6500-BAD-EXIT.
 16354
 16355     IF DL35-RETURN-CODE = '03'
 16356         MOVE ER-7832            TO EMI-ERROR
 16357         GO TO 6500-BAD-EXIT.
 16358
 16359     IF DL35-RETURN-CODE = '04'
 16360         MOVE ER-7833            TO EMI-ERROR
 16361         GO TO 6500-BAD-EXIT.
 16362
 16363     IF DL35-RETURN-CODE = '05'
 16364         MOVE ER-7834            TO EMI-ERROR
 16365         GO TO 6500-BAD-EXIT.
 16366
 16367     IF DL35-RETURN-CODE = '06'
 16368         MOVE ER-7835            TO EMI-ERROR
 16369         GO TO 6500-BAD-EXIT.
 16370
 16371     IF DL35-RETURN-CODE = '07'
 16372         MOVE ER-7836            TO EMI-ERROR
 16373         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 313
* EL156.cbl
 16374
 16375     IF DL35-RETURN-CODE = 'E1'
 16376         MOVE ER-7837            TO EMI-ERROR
 16377         GO TO 6500-BAD-EXIT.
 16378
 16379     IF DL35-RETURN-CODE NOT = 'OK'
 16380         MOVE ER-7838            TO EMI-ERROR
 16381         GO TO 6500-BAD-EXIT.
 16382
 16383 6600-EXIT.
 16384      EXIT.
 16385
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 314
* EL156.cbl
 16387 6700-UPDATE-ACTQ.
 16388***************************************************************
 16389*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16390*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16391*    ONE ALREADY THERE.                                       *
 16392***************************************************************
 16393
 16394
 16395* EXEC CICS HANDLE CONDITION
 16396*         NOTFND(6720-BUILD-NEW-RECORD)
 16397*     END-EXEC.
 16398*    MOVE '"$I                   ! 6 #00015190' TO DFHEIV0
 16399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16401     MOVE X'3620233030303135313930' TO DFHEIV0(25:11)
 16402     CALL 'kxdfhei1' USING DFHEIV0
 16403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16404
 16405
 16406
 16407* EXEC CICS READ
 16408*         DATASET('ELACTQ')
 16409*         RIDFLD (ELMSTR-KEY)
 16410*         SET    (ADDRESS OF ACTIVITY-QUE)
 16411*         UPDATE
 16412*     END-EXEC.
 16413     MOVE 'ELACTQ' TO DFHEIV1
 16414*    MOVE '&"S        EU         (   #00015194' TO DFHEIV0
 16415     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16416     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16417     MOVE X'2020233030303135313934' TO DFHEIV0(25:11)
 16418     CALL 'kxdfhei1' USING DFHEIV0,
 16419           DFHEIV1,
 16420           DFHEIV20,
 16421           DFHEIV99,
 16422           ELMSTR-KEY,
 16423           DFHEIV99,
 16424           DFHEIV99,
 16425           DFHEIV99
 16426     SET ADDRESS OF ACTIVITY-QUE TO
 16427         DFHEIV20
 16428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16429
 16430
 16431     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16432
 16433     IF PI-AIG-SPECIAL-BENEFIT AND
 16434        PI-CASH = 'Y'
 16435         ADD 2                   TO AQ-PAYMENT-COUNTER
 16436     ELSE
 16437         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16438
 16439     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16440         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16441
 16442     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16443
 16444     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 315
* EL156.cbl
 16445         IF WS-PMT-APPROVAL-SW = 'A'
 16446             NEXT SENTENCE
 16447         ELSE
 16448            IF PI-AIG-SPECIAL-BENEFIT AND
 16449               PI-CASH = 'Y'
 16450                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16451                                     WS-PMT-UNAPPROVED-CNT
 16452            ELSE
 16453                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16454                                     WS-PMT-UNAPPROVED-CNT
 16455     ELSE
 16456         IF PI-PMT-APPR-SW = 'Y'
 16457            IF PI-AIG-SPECIAL-BENEFIT AND
 16458               PI-CASH = 'Y'
 16459                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16460                                     WS-PMT-UNAPPROVED-CNT
 16461            ELSE
 16462                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16463                                     WS-PMT-UNAPPROVED-CNT.
 16464
 16465     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16466         MOVE ER-3536 TO EMI-ERROR
 16467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16468
 16469     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16470
 16471
 16472* EXEC CICS REWRITE
 16473*         DATASET('ELACTQ')
 16474*         FROM   (ACTIVITY-QUE)
 16475*     END-EXEC.
 16476     MOVE LENGTH OF
 16477      ACTIVITY-QUE
 16478       TO DFHEIV11
 16479     MOVE 'ELACTQ' TO DFHEIV1
 16480*    MOVE '&& L                  %   #00015241' TO DFHEIV0
 16481     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16482     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16483     MOVE X'2020233030303135323431' TO DFHEIV0(25:11)
 16484     CALL 'kxdfhei1' USING DFHEIV0,
 16485           DFHEIV1,
 16486           ACTIVITY-QUE,
 16487           DFHEIV11,
 16488           DFHEIV99
 16489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16490
 16491
 16492     GO TO 6799-EXIT.
 16493
 16494 6720-BUILD-NEW-RECORD.
 16495
 16496* EXEC CICS GETMAIN
 16497*         SET    (ADDRESS OF ACTIVITY-QUE)
 16498*         LENGTH (60)
 16499*         INITIMG(GETMAIN-SPACE)
 16500*     END-EXEC.
 16501     MOVE 60
 16502       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 316
* EL156.cbl
 16503*    MOVE ',"IL                  $   #00015249' TO DFHEIV0
 16504     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16505     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16506     MOVE X'2020233030303135323439' TO DFHEIV0(25:11)
 16507     CALL 'kxdfhei1' USING DFHEIV0,
 16508           DFHEIV20,
 16509           DFHEIV11,
 16510           GETMAIN-SPACE
 16511     SET ADDRESS OF ACTIVITY-QUE TO
 16512         DFHEIV20
 16513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16514
 16515
 16516     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16517
 16518     IF PI-AIG-SPECIAL-BENEFIT AND
 16519        PI-CASH = 'Y'
 16520         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16521     ELSE
 16522         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16523
 16524     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16525     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16526     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16527     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16528                                    AQ-FOLLOWUP-DATE.
 16529     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16530     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16531
 16532     IF PI-PMT-GRADUATED
 16533         IF WS-PMT-APPROVAL-SW = 'A'
 16534             NEXT SENTENCE
 16535         ELSE
 16536            IF PI-AIG-SPECIAL-BENEFIT AND
 16537               PI-CASH = 'Y'
 16538                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16539            ELSE
 16540                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16541     ELSE
 16542         IF PI-PMT-APPR-SW = 'Y'
 16543            IF PI-AIG-SPECIAL-BENEFIT AND
 16544               PI-CASH = 'Y'
 16545                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16546            ELSE
 16547                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16548
 16549     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16550         MOVE ER-3536 TO EMI-ERROR
 16551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16552
 16553
 16554* EXEC CICS WRITE
 16555*         DATASET('ELACTQ')
 16556*         RIDFLD (ELMSTR-KEY)
 16557*         FROM   (ACTIVITY-QUE)
 16558*     END-EXEC.
 16559     MOVE LENGTH OF
 16560      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 317
* EL156.cbl
 16561       TO DFHEIV11
 16562     MOVE 'ELACTQ' TO DFHEIV1
 16563*    MOVE '&$ L                  ''   #00015292' TO DFHEIV0
 16564     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16565     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16566     MOVE X'2020233030303135323932' TO DFHEIV0(25:11)
 16567     CALL 'kxdfhei1' USING DFHEIV0,
 16568           DFHEIV1,
 16569           ACTIVITY-QUE,
 16570           DFHEIV11,
 16571           ELMSTR-KEY,
 16572           DFHEIV99,
 16573           DFHEIV99
 16574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16575
 16576
 16577 6799-EXIT.
 16578      EXIT.
 16579
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 318
* EL156.cbl
 16581 6800-BUILD-FORM-TRAILER.
 16582
 16583
 16584* EXEC CICS GETMAIN
 16585*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16586*         LENGTH   (200)
 16587*         INITIMG  (GETMAIN-SPACE)
 16588*    END-EXEC.
 16589     MOVE 200
 16590       TO DFHEIV11
 16591*    MOVE ',"IL                  $   #00015304' TO DFHEIV0
 16592     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16594     MOVE X'2020233030303135333034' TO DFHEIV0(25:11)
 16595     CALL 'kxdfhei1' USING DFHEIV0,
 16596           DFHEIV20,
 16597           DFHEIV11,
 16598           GETMAIN-SPACE
 16599     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16600         DFHEIV20
 16601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16602
 16603
 16604     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16605
 16606     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16607     MOVE 'AT'                   TO AT-RECORD-ID.
 16608     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16609
 16610     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16611     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16612                                    AT-FORM-LAST-MAINT-DT
 16613                                    AT-FORM-SEND-ON-DT.
 16614     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16615                                    AT-FORM-LAST-UPDATED-BY.
 16616     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16617     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16618     MOVE '6'                    TO DC-OPTION-CODE.
 16619     MOVE +29                    TO DC-ELAPSED-DAYS.
 16620     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16621     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16622     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16623
 16624     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16625         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16626
 16627     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16628                                    AT-FORM-RE-SEND-DT
 16629                                    AT-EMP-FORM-ANSWERED-DT
 16630                                    AT-PHY-FORM-ANSWERED-DT
 16631                                    AT-EMP-FORM-SEND-ON-DT
 16632                                    AT-PHY-FORM-SEND-ON-DT
 16633                                    AT-FORM-PRINTED-DT
 16634                                    AT-FORM-REPRINT-DT.
 16635     MOVE '2'                    TO AT-FORM-TYPE.
 16636
 16637     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16638     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 319
* EL156.cbl
 16639
 16640     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16641         NEXT SENTENCE
 16642     ELSE
 16643         IF CL-PROG-FORM-TYPE NOT = 'S'
 16644            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16645
 16646
 16647* EXEC CICS WRITE
 16648*         DATASET  ('ELTRLR')
 16649*         FROM     (ACTIVITY-TRAILERS)
 16650*         RIDFLD   (AT-CONTROL-PRIMARY)
 16651*     END-EXEC.
 16652     MOVE LENGTH OF
 16653      ACTIVITY-TRAILERS
 16654       TO DFHEIV11
 16655     MOVE 'ELTRLR' TO DFHEIV1
 16656*    MOVE '&$ L                  ''   #00015352' TO DFHEIV0
 16657     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16659     MOVE X'2020233030303135333532' TO DFHEIV0(25:11)
 16660     CALL 'kxdfhei1' USING DFHEIV0,
 16661           DFHEIV1,
 16662           ACTIVITY-TRAILERS,
 16663           DFHEIV11,
 16664           AT-CONTROL-PRIMARY,
 16665           DFHEIV99,
 16666           DFHEIV99
 16667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16668
 16669
 16670 6899-EXIT.
 16671      EXIT.
 16672
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 320
* EL156.cbl
 16674 6900-BUILD-ARCHIVE-HEADER.
 16675
 16676     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16677     MOVE '1'                    TO CNTL-REC-TYPE.
 16678     MOVE +0                     TO CNTL-SEQ-NO.
 16679     MOVE SPACES                 TO CNTL-ACCESS.
 16680
 16681
 16682* EXEC CICS READ
 16683*         DATASET  ('ELCNTL')
 16684*         SET      (ADDRESS OF CONTROL-FILE)
 16685*         RIDFLD   (ELCNTL-KEY)
 16686*         UPDATE
 16687*    END-EXEC.
 16688     MOVE 'ELCNTL' TO DFHEIV1
 16689*    MOVE '&"S        EU         (   #00015369' TO DFHEIV0
 16690     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16691     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16692     MOVE X'2020233030303135333639' TO DFHEIV0(25:11)
 16693     CALL 'kxdfhei1' USING DFHEIV0,
 16694           DFHEIV1,
 16695           DFHEIV20,
 16696           DFHEIV99,
 16697           ELCNTL-KEY,
 16698           DFHEIV99,
 16699           DFHEIV99,
 16700           DFHEIV99
 16701     SET ADDRESS OF CONTROL-FILE TO
 16702         DFHEIV20
 16703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16704
 16705
 16706     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16707     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16708
 16709
 16710* EXEC CICS REWRITE
 16711*         FROM     (CONTROL-FILE)
 16712*         DATASET  ('ELCNTL')
 16713*    END-EXEC.
 16714     MOVE LENGTH OF
 16715      CONTROL-FILE
 16716       TO DFHEIV11
 16717     MOVE 'ELCNTL' TO DFHEIV1
 16718*    MOVE '&& L                  %   #00015379' TO DFHEIV0
 16719     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16720     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16721     MOVE X'2020233030303135333739' TO DFHEIV0(25:11)
 16722     CALL 'kxdfhei1' USING DFHEIV0,
 16723           DFHEIV1,
 16724           CONTROL-FILE,
 16725           DFHEIV11,
 16726           DFHEIV99
 16727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16728
 16729
 16730
 16731* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 321
* EL156.cbl
 16732*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 16733*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 16734*    END-EXEC.
 16735*    MOVE '"$$%                  ! 7 #00015384' TO DFHEIV0
 16736     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 16737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16738     MOVE X'3720233030303135333834' TO DFHEIV0(25:11)
 16739     CALL 'kxdfhei1' USING DFHEIV0
 16740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16741
 16742
 16743
 16744* EXEC CICS GETMAIN
 16745*         SET     (ADDRESS OF LETTER-ARCHIVE)
 16746*         LENGTH  (ELARCH-LENGTH)
 16747*         INITIMG (GETMAIN-SPACE)
 16748*    END-EXEC.
 16749*    MOVE ',"IL                  $   #00015389' TO DFHEIV0
 16750     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16752     MOVE X'2020233030303135333839' TO DFHEIV0(25:11)
 16753     CALL 'kxdfhei1' USING DFHEIV0,
 16754           DFHEIV20,
 16755           ELARCH-LENGTH,
 16756           GETMAIN-SPACE
 16757     SET ADDRESS OF LETTER-ARCHIVE TO
 16758         DFHEIV20
 16759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16760
 16761
 16762     MOVE 'LA'                   TO LA-RECORD-ID.
 16763     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 16764                                    LA-ARCHIVE-NO-A1.
 16765     MOVE '4'                    TO LA-RECORD-TYPE
 16766                                    LA-RECORD-TYPE-A1.
 16767     MOVE +0                     TO LA-LINE-SEQ-NO
 16768                                    LA-LINE-SEQ-NO-A1.
 16769     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 16770                                    LA-COMPANY-CD-A1.
 16771     MOVE CL-CARRIER             TO LA4-CARRIER.
 16772     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 16773     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 16774     MOVE CL-CERT-STATE          TO LA4-STATE.
 16775     MOVE +0                     TO LA4-NO-OF-COPIES.
 16776     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 16777     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 16778     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 16779                                    LA4-INITIAL-PRINT-DATE
 16780                                    LA4-RESEND-PRINT-DATE
 16781                                    LA4-FORM-REM-PRINT-DT.
 16782     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 16783     MOVE '2'                    TO LA4-FORM-TYPE.
 16784
 16785
 16786* EXEC CICS WRITE
 16787*         DATASET  ('ELARCH')
 16788*         FROM     (LETTER-ARCHIVE)
 16789*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 322
* EL156.cbl
 16790*    END-EXEC.
 16791     MOVE LENGTH OF
 16792      LETTER-ARCHIVE
 16793       TO DFHEIV11
 16794     MOVE 'ELARCH' TO DFHEIV1
 16795*    MOVE '&$ L                  ''   #00015418' TO DFHEIV0
 16796     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16797     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16798     MOVE X'2020233030303135343138' TO DFHEIV0(25:11)
 16799     CALL 'kxdfhei1' USING DFHEIV0,
 16800           DFHEIV1,
 16801           LETTER-ARCHIVE,
 16802           DFHEIV11,
 16803           LA-CONTROL-PRIMARY,
 16804           DFHEIV99,
 16805           DFHEIV99
 16806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16807
 16808
 16809 6999-EXIT.
 16810      EXIT.
 16811
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 323
* EL156.cbl
 16813 7000-SHOW-CLAIM.
 16814     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 16815     MOVE 'A'                    TO PI-PASS-SW.
 16816     MOVE LOW-VALUES             TO PI-CPYFROM
 16817                                    PI-MONTH-END-SAVE
 16818                                    PI-CPYTHRU.
 16819
 16820     MOVE ZEROS                  TO PI-FATAL-COUNT
 16821                                    PI-DAILY-RATE
 16822                                    PI-BEN-DAYS
 16823                                    PI-MANUAL-SW
 16824                                    PI-SAVE-CURSOR
 16825                                    PI-FORCE-COUNT
 16826                                    PI-HOLDTIL
 16827                                    PI-EPYFROM
 16828                                    PI-EPYTHRU
 16829                                    PI-EDAYS
 16830                                    PI-EPYAMT
 16831                                    PI-ERESV
 16832                                    PI-EEXPENS
 16833                                    PI-CDAYS
 16834                                    PI-CPYAMT
 16835                                    PI-CRESV
 16836                                    PI-CEXPENS
 16837                                    PI-INT-RATE
 16838                                    PI-AIGFROM.
 16839     MOVE ZEROS                  TO PI-PROOF-DATE.
 16840     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 16841                                    PI-REM-BEN-AMT
 16842                                    PI-MO-BEN-AMT.
 16843
 16844     MOVE LOW-VALUES             TO EL156AI.
 16845     MOVE MAP-NAMEA              TO MAP-NAME.
 16846
 16847* EXEC CICS HANDLE CONDITION
 16848*        NOTFND   (7010-BUILD-MAP)
 16849*    END-EXEC.
 16850*    MOVE '"$I                   ! 8 #00015461' TO DFHEIV0
 16851     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16853     MOVE X'3820233030303135343631' TO DFHEIV0(25:11)
 16854     CALL 'kxdfhei1' USING DFHEIV0
 16855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16856
 16857
 16858     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16859     MOVE '2'                    TO CNTL-REC-TYPE.
 16860     MOVE +0                     TO CNTL-SEQ-NO.
 16861     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16862
 16863
 16864* EXEC CICS READ
 16865*         DATASET  ('ELCNTL')
 16866*         SET      (ADDRESS OF CONTROL-FILE)
 16867*         RIDFLD   (ELCNTL-KEY)
 16868*    END-EXEC.
 16869     MOVE 'ELCNTL' TO DFHEIV1
 16870*    MOVE '&"S        E          (   #00015470' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 324
* EL156.cbl
 16871     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16873     MOVE X'2020233030303135343730' TO DFHEIV0(25:11)
 16874     CALL 'kxdfhei1' USING DFHEIV0,
 16875           DFHEIV1,
 16876           DFHEIV20,
 16877           DFHEIV99,
 16878           ELCNTL-KEY,
 16879           DFHEIV99,
 16880           DFHEIV99,
 16881           DFHEIV99
 16882     SET ADDRESS OF CONTROL-FILE TO
 16883         DFHEIV20
 16884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16885
 16886
 16887     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 16888
 16889     IF PI-APPROVAL-LEVEL = '5'
 16890         MOVE AL-UANON      TO SURVYYNA
 16891     END-IF.
 16892
 16893
 16894     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16895     MOVE '1'                    TO CNTL-REC-TYPE.
 16896     MOVE SPACES                 TO CNTL-ACCESS.
 16897     MOVE +0                     TO CNTL-SEQ-NO.
 16898
 16899
 16900* EXEC CICS READ
 16901*         DATASET  ('ELCNTL')
 16902*         SET      (ADDRESS OF CONTROL-FILE)
 16903*         RIDFLD   (ELCNTL-KEY)
 16904*    END-EXEC.
 16905     MOVE 'ELCNTL' TO DFHEIV1
 16906*    MOVE '&"S        E          (   #00015488' TO DFHEIV0
 16907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16909     MOVE X'2020233030303135343838' TO DFHEIV0(25:11)
 16910     CALL 'kxdfhei1' USING DFHEIV0,
 16911           DFHEIV1,
 16912           DFHEIV20,
 16913           DFHEIV99,
 16914           ELCNTL-KEY,
 16915           DFHEIV99,
 16916           DFHEIV99,
 16917           DFHEIV99
 16918     SET ADDRESS OF CONTROL-FILE TO
 16919         DFHEIV20
 16920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16921
 16922
 16923     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 16924
 16925 7010-BUILD-MAP.
 16926
 16927
 16928* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 325
* EL156.cbl
 16929*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16930*    END-EXEC.
 16931*    MOVE '"$I                   ! 9 #00015498' TO DFHEIV0
 16932     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16934     MOVE X'3920233030303135343938' TO DFHEIV0(25:11)
 16935     CALL 'kxdfhei1' USING DFHEIV0
 16936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16937
 16938
 16939     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16940     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16941     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16942     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16943     MOVE 'MSTR'                 TO FILE-SWITCH.
 16944
 16945     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16946
 16947     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16948     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16949     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16950     MOVE CL-CCN                 TO PI-SV-CCN.
 16951
 16952     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 16953     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 16954     MOVE CL-CLAIM-NO            TO CLMNOO.
 16955     MOVE CL-CARRIER             TO CARRO.
 16956     MOVE CL-CERT-PRIME          TO CERTNOO.
 16957     MOVE CL-CERT-SFX            TO SUFXO.
 16958
 16959     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 16960        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 16961        CONTINUE
 16962     ELSE
 16963        MOVE AL-SADOF            TO ZINTHA
 16964                                    ZINTA
 16965                                    PINTHA
 16966                                    PINTA
 16967     END-IF
 16968     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 16969     EVALUATE TRUE
 16970     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 16971         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 16972     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16973         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 16974
 16975     WHEN CL-CLAIM-TYPE = 'I'
 16976         MOVE '  IU  '           TO CLMTYPO
 16977     WHEN CL-CLAIM-TYPE = 'G'
 16978         MOVE ' GAP  '           TO CLMTYPO
 16979     END-EVALUATE.
 16980     IF CLAIM-IS-OPEN
 16981         MOVE ' OPEN'            TO CLMSTATO
 16982     ELSE
 16983         MOVE 'CLOSED'           TO CLMSTATO.
 16984
 16985     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 16986
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 326
* EL156.cbl
 16987     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 16988         MOVE SPACES             TO  PCERTNOO
 16989                                     PSUFXO
 16990                                     PRIMHDGO
 16991                                     SEQUO
 16992         MOVE AL-SADOF           TO  PCERTNOA
 16993                                     PSUFXA
 16994                                     PRIMHDGA
 16995                                     SEQUA
 16996     ELSE
 16997         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 16998         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 16999         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17000         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17001         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17002         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17003         MOVE AL-SANON               TO  PCERTNOA
 17004                                         PSUFXA
 17005                                         PRIMHDGA
 17006         MOVE AL-SABON               TO  SEQUA.
 17007
 17008     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17009
 17010     IF CL-NO-OF-PMTS-MADE = 0 AND
 17011        CL-TOTAL-PAID-AMT = 0
 17012         NEXT SENTENCE
 17013     ELSE
 17014         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17015             IF NOT PI-USES-PAID-TO
 17016                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17017                 MOVE ' '                 TO DC-OPTION-CODE
 17018                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17019                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17020             ELSE
 17021                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17022                 MOVE '6'                 TO DC-OPTION-CODE
 17023                 MOVE +1                  TO DC-ELAPSED-DAYS
 17024                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17025                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17026                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17027
 17028     IF MAP-NAME = 'EL156A'
 17029        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17030           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17031             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17032           end-if
 17033        end-if
 17034     end-if
 17035     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17036         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17037         MOVE ' '                TO DC-OPTION-CODE
 17038         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17039         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17040
 17041     IF CL-INCURRED-DT NOT = LOW-VALUES
 17042         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17043         MOVE ' '                TO DC-OPTION-CODE
 17044         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 327
* EL156.cbl
 17045         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17046
 17047     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17048
 17049     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17050         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17051         MOVE ' '                TO DC-OPTION-CODE
 17052         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17053         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17054
 17055     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17056         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17057         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17058     ELSE
 17059         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17060         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17061
 17062     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17063     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17064     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17065     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17066                                    PI-GROUPING.
 17067     MOVE CL-CERT-STATE          TO CERT-STATE
 17068                                    PI-STATE.
 17069     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17070                                    PI-ACCOUNT.
 17071     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17072     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17073     MOVE 'CERT'                 TO FILE-SWITCH.
 17074
 17075     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17076     if pi-company-id = 'DCC'
 17077        perform 7975-read-acct   thru 7975-exit
 17078     end-if
 17079     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17080     MOVE PI-STATE               TO WS-ST-ACCESS.
 17081     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17082     MOVE '3'                    TO CNTL-REC-TYPE.
 17083     MOVE +0                     TO CNTL-SEQ-NO.
 17084     MOVE 'STAT'                 TO FILE-SWITCH.
 17085
 17086     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17087
 17088     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17089     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17090
 17091     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17092        GO TO 7020-BYPASS-BENEFIT.
 17093
 17094     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17095     MOVE '4'                    TO CNTL-REC-TYPE.
 17096     MOVE +0                     TO CNTL-SEQ-NO.
 17097     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17098     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17099     MOVE 'BENE'                 TO FILE-SWITCH.
 17100
 17101     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17102
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 328
* EL156.cbl
 17103     IF NO-BENEFIT-FOUND
 17104        GO TO 7020-BYPASS-BENEFIT.
 17105
 17106     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17107     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17108     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17109
 17110 7020-BYPASS-BENEFIT.
 17111
 17112*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17113*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17114*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17115
 17116     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17117         GO TO 7021-GO-TO-LIFE.
 17118     move zeros                  to PI-MAX-BENEFIT-AMT
 17119     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17120
 17121     IF (PI-COMPANY-ID = 'DCC')
 17122        and (acct-found)
 17123        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17124        MOVE ' '                 TO WS-PDEF-RECORD-SW
 17125        PERFORM 0900-GET-DDF-FACTORS
 17126                                 THRU 0900-EXIT
 17127        IF PDEF-FOUND
 17128           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17129              (P1 > +8)
 17130              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17131           END-PERFORM
 17132           IF P1 < +9
 17133              MOVE PD-MAX-AMT (P1)
 17134                                 TO PI-MAX-BENEFIT-AMT
 17135           END-IF
 17136        END-IF
 17137     end-if
 17138     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17139     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17140     if (pi-max-benefit-amt not = zeros)
 17141        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17142        move pi-max-benefit-amt  to beneo
 17143     else
 17144        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17145     end-if
 17146     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17147     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17148                                    CP-ORIGINAL-TERM.
 17149     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17150
 17151*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17152*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17153*    ELSE
 17154         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17155
 17156     MOVE ' '                    TO DC-OPTION-CODE.
 17157     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17158     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17159
 17160     IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 329
* EL156.cbl
 17161         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17162         GO TO 7023-BYPASS-REMAINING-TERM.
 17163
 17164     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17165     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17166     GO TO 7022-AROUND-LIFE.
 17167
 17168 7021-GO-TO-LIFE.
 17169
 17170     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17171     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17172     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17173                                    CP-ORIGINAL-TERM.
 17174     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17175     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17176     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17177     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17178
 17179     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17180         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17181     ELSE
 17182         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17183
 17184     MOVE ' '                    TO DC-OPTION-CODE.
 17185     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17186     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17187
 17188 7022-AROUND-LIFE.
 17189
 17190     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17191     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17192     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17193     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17194     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17195     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17196     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17197
 17198     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17199
 17200     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17201        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17202           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17203
 17204     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17205        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17206           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17207
 17208 7023-BYPASS-REMAINING-TERM.
 17209     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17210       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17211          MOVE ZEROS                  TO BENEO
 17212       ELSE
 17213          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17214          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17215          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17216          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17217          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17218          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 330
* EL156.cbl
 17219          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17220          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17221          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17222          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17223          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17224          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17225          IF (PI-COMPANY-ID = 'DCC')
 17226             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17227             MOVE ' '            TO WS-PDEF-RECORD-SW
 17228             PERFORM 0900-GET-DDF-FACTORS
 17229                                 THRU 0900-EXIT
 17230             IF PDEF-FOUND
 17231                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17232                   (P1 > +8)
 17233                   OR (PD-PROD-CODE (P1) = 'L')
 17234                END-PERFORM
 17235                IF P1 < +9
 17236                   MOVE PD-MAX-AMT (P1)
 17237                                 TO CP-R-MAX-TOT-BEN
 17238                END-IF
 17239             END-IF
 17240          END-IF
 17241
 17242* EXEC CICS LINK
 17243*            PROGRAM  (LINK-REMAMT)
 17244*            COMMAREA (CALCULATION-PASS-AREA)
 17245*            LENGTH   (CP-COMM-LENGTH)
 17246*         END-EXEC
 17247*    MOVE '."C                   (   #00015804' TO DFHEIV0
 17248     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17250     MOVE X'2020233030303135383034' TO DFHEIV0(25:11)
 17251     CALL 'kxdfhei1' USING DFHEIV0,
 17252           LINK-REMAMT,
 17253           CALCULATION-PASS-AREA,
 17254           CP-COMM-LENGTH,
 17255           DFHEIV99,
 17256           DFHEIV99,
 17257           DFHEIV99,
 17258           DFHEIV99
 17259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17260          MOVE CP-REMAINING-AMT       TO BENEO
 17261       end-if
 17262     end-if
 17263     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17264     MOVE +95                    TO TRLR-SEQ-NO
 17265
 17266* EXEC CICS READ
 17267*       DATASET  ('ELTRLR')
 17268*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17269*       RIDFLD   (ELTRLR-KEY)
 17270*       RESP     (WS-RESPONSE)
 17271*    END-EXEC
 17272     MOVE 'ELTRLR' TO DFHEIV1
 17273*    MOVE '&"S        E          (  N#00015814' TO DFHEIV0
 17274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17276     MOVE X'204E233030303135383134' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 331
* EL156.cbl
 17277     CALL 'kxdfhei1' USING DFHEIV0,
 17278           DFHEIV1,
 17279           DFHEIV20,
 17280           DFHEIV99,
 17281           ELTRLR-KEY,
 17282           DFHEIV99,
 17283           DFHEIV99,
 17284           DFHEIV99
 17285     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17286         DFHEIV20
 17287     MOVE EIBRESP  TO WS-RESPONSE
 17288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17289
 17290     if ws-resp-normal
 17291        perform varying s1 from +1 by +1 until
 17292           at-note-error-no (s1) = spaces
 17293           move at-note-error-no (s1)
 17294                                 to emi-error
 17295           if at-note-error-no (s1) = '1653'
 17296              evaluate true
 17297                 when cl-claim-type = 'L'
 17298                    move '  LF  '
 17299                                 to emi-claim-type
 17300                 when cl-claim-type = 'I'
 17301                    move '  IU  '
 17302                                 to emi-claim-type
 17303                 when other
 17304                    move '  AH  '
 17305                                 to emi-claim-type
 17306              end-evaluate
 17307           end-if
 17308           PERFORM 9900-ERROR-FORMAT
 17309                                 THRU 9900-EXIT
 17310        end-perform
 17311     end-if
 17312     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17313         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17314            WS-LF-COVERAGE-TYPE = 'P'
 17315             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17316                                        CM-LF-ITD-DEATH-AMT
 17317             MOVE WS-REMAINING-AMT  TO  BENEO.
 17318
 17319     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17320     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17321     MOVE WS-TERMS               TO TERMSO.
 17322
 17323     IF WS-STATUS = '6' OR '7' OR '8'
 17324         MOVE AL-SABOF           TO CRTSTATA.
 17325
 17326     IF WS-STATUS = '1' OR '4'
 17327        IF CP-REMAINING-TERM-3 = ZEROS
 17328           MOVE 'EXPIRED'        TO CRTSTATO
 17329        ELSE
 17330           MOVE 'ACTIVE  '       TO CRTSTATO.
 17331
 17332     IF WS-STATUS = '2'
 17333         MOVE 'PEND    '         TO CRTSTATO.
 17334
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 332
* EL156.cbl
 17335     IF WS-STATUS = '3'
 17336         MOVE 'RESTORE '         TO CRTSTATO.
 17337
 17338     IF WS-STATUS = '5'
 17339         MOVE 'REISSUE '         TO CRTSTATO.
 17340
 17341     IF WS-STATUS = '6'
 17342         MOVE 'LMP DIS'          TO CRTSTATO.
 17343
 17344     IF WS-STATUS = '7'
 17345         MOVE 'DEATH'            TO CRTSTATO.
 17346
 17347     IF WS-STATUS = '8'
 17348         MOVE 'CANCEL'           TO CRTSTATO.
 17349
 17350     IF WS-STATUS = '9'
 17351         MOVE 'RE-ONLY '         TO CRTSTATO.
 17352
 17353     IF WS-STATUS = 'V'
 17354         MOVE 'VOID  '           TO CRTSTATO.
 17355
 17356     IF WS-STATUS = 'D'
 17357         MOVE 'DECLINE '         TO CRTSTATO.
 17358
 17359     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17360         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17361         MOVE '5'                TO CNTL-REC-TYPE
 17362     ELSE
 17363         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17364         MOVE '4'                TO CNTL-REC-TYPE.
 17365
 17366     MOVE '** NONE **'           TO COVERO.
 17367     MOVE AL-SABON               TO COVERA.
 17368
 17369     IF PI-COMPANY-ID = 'CVL'
 17370         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17371             MOVE CM-BENEFICIARY TO LOANNOO
 17372             MOVE AL-UANON       TO LOANNOA.
 17373
 17374     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17375        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17376        MOVE +91                 TO  TRLR-SEQ-NO
 17377
 17378* EXEC CICS READ
 17379*           DATASET  ('ELTRLR')
 17380*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17381*           RIDFLD   (ELTRLR-KEY)
 17382*           RESP     (WS-RESPONSE)
 17383*       END-EXEC
 17384     MOVE 'ELTRLR' TO DFHEIV1
 17385*    MOVE '&"S        E          (  N#00015908' TO DFHEIV0
 17386     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17388     MOVE X'204E233030303135393038' TO DFHEIV0(25:11)
 17389     CALL 'kxdfhei1' USING DFHEIV0,
 17390           DFHEIV1,
 17391           DFHEIV20,
 17392           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 333
* EL156.cbl
 17393           ELTRLR-KEY,
 17394           DFHEIV99,
 17395           DFHEIV99,
 17396           DFHEIV99
 17397     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17398         DFHEIV20
 17399     MOVE EIBRESP  TO WS-RESPONSE
 17400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17401
 17402        IF WS-RESP-NORMAL
 17403           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17404        ELSE
 17405           MOVE SPACES           TO  LOANNOO
 17406        END-IF
 17407*052506
 17408*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17409*052506
 17410     END-IF
 17411
 17412     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17413        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17414
 17415     IF WS-BEN-CD = ZEROS
 17416         GO TO 7050-SHOW-CONTINUE.
 17417
 17418     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17419     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17420     MOVE +0                     TO CNTL-SEQ-NO.
 17421     MOVE 'BENE'                 TO FILE-SWITCH.
 17422
 17423     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17424
 17425     IF BENEFIT-FOUND
 17426         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17427         MOVE AL-SANON                    TO COVERA.
 17428
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 334
* EL156.cbl
 17430 7050-SHOW-CONTINUE.
 17431
 17432     IF PI-COMPANY-ID = 'DMD'
 17433         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17434
 17435     MOVE -1                     TO PMTTYPEL.
 17436     GO TO 8100-SEND-INITIAL-MAP.
 17437
 17438 7100-SHOW-RECORD-NOT-FOUND.
 17439     IF FILE-SWITCH = 'MSTR'
 17440         MOVE ER-0204            TO EMI-ERROR.
 17441
 17442     IF FILE-SWITCH = 'CERT'
 17443         MOVE ER-0206            TO EMI-ERROR.
 17444
 17445     IF FILE-SWITCH = 'STAT'
 17446         MOVE ER-0149            TO EMI-ERROR.
 17447
 17448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17449
 17450     MOVE -1                     TO PMTTYPEL.
 17451     GO TO 8100-SEND-INITIAL-MAP
 17452
 17453     .
 17454 7110-BUILD-PMT-TRLR.
 17455     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17456     MOVE +51                    TO TRLR-SEQ-NO
 17457
 17458* EXEC CICS READ
 17459*        DATASET  ('ELTRLR')
 17460*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17461*        RIDFLD   (ELTRLR-KEY)
 17462*        RESP     (WS-RESPONSE)
 17463*    END-EXEC
 17464     MOVE 'ELTRLR' TO DFHEIV1
 17465*    MOVE '&"S        E          (  N#00015970' TO DFHEIV0
 17466     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17468     MOVE X'204E233030303135393730' TO DFHEIV0(25:11)
 17469     CALL 'kxdfhei1' USING DFHEIV0,
 17470           DFHEIV1,
 17471           DFHEIV20,
 17472           DFHEIV99,
 17473           ELTRLR-KEY,
 17474           DFHEIV99,
 17475           DFHEIV99,
 17476           DFHEIV99
 17477     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17478         DFHEIV20
 17479     MOVE EIBRESP  TO WS-RESPONSE
 17480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17481     IF WS-RESP-NORMAL
 17482        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 17483     END-IF
 17484     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17485
 17486* EXEC CICS GETMAIN
 17487*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 335
* EL156.cbl
 17488*         LENGTH    (200)
 17489*         INITIMG   (GETMAIN-SPACE)
 17490*     END-EXEC
 17491     MOVE 200
 17492       TO DFHEIV11
 17493*    MOVE ',"IL                  $   #00015980' TO DFHEIV0
 17494     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17495     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17496     MOVE X'2020233030303135393830' TO DFHEIV0(25:11)
 17497     CALL 'kxdfhei1' USING DFHEIV0,
 17498           DFHEIV20,
 17499           DFHEIV11,
 17500           GETMAIN-SPACE
 17501     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17502         DFHEIV20
 17503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17504     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17505                                    AT-PREV-PAID-THRU-DT
 17506     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17507     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17508     MOVE 'AT'                   TO AT-RECORD-ID
 17509     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17510     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17511     MOVE '2'                    TO AT-TRAILER-TYPE
 17512     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17513                                    AT-PAYMENT-LAST-MAINT-DT
 17514     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17515                                    AT-PAYMENT-LAST-UPDATED-BY
 17516     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17517     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17518     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17519     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17520     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17521     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17522     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17523     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17524     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17525     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17526     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17527     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17528     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17529     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17530     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17531     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17532                                    AT-TO-BE-WRITTEN-DT
 17533     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17534                                    AT-CHECK-QUE-SEQUENCE
 17535                                    AT-ADDL-RESERVE
 17536     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17537                                    AT-VOID-SELECT-DT
 17538                                    AT-VOID-ACCEPT-DT
 17539                                    AT-VOID-DT
 17540                                    AT-PMT-PROOF-DT
 17541                                    AT-INT-PMT-SELECT-DT
 17542     MOVE ZEROS                  TO AT-DAILY-RATE
 17543                                    AT-ELIMINATION-DAYS
 17544     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17545*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 336
* EL156.cbl
 17546*        DUPREC    (7120-DUPREC)
 17547*    END-EXEC
 17548     .
 17549 7115-WRITE-INT-TRLR.
 17550
 17551* EXEC CICS WRITE
 17552*         DATASET       ('ELTRLR')
 17553*         FROM          (ACTIVITY-TRAILERS)
 17554*         RIDFLD        (AT-CONTROL-PRIMARY)
 17555*         RESP          (WS-RESPONSE)
 17556*     END-EXEC
 17557     MOVE LENGTH OF
 17558      ACTIVITY-TRAILERS
 17559       TO DFHEIV11
 17560     MOVE 'ELTRLR' TO DFHEIV1
 17561*    MOVE '&$ L                  ''  N#00016031' TO DFHEIV0
 17562     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17563     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17564     MOVE X'204E233030303136303331' TO DFHEIV0(25:11)
 17565     CALL 'kxdfhei1' USING DFHEIV0,
 17566           DFHEIV1,
 17567           ACTIVITY-TRAILERS,
 17568           DFHEIV11,
 17569           AT-CONTROL-PRIMARY,
 17570           DFHEIV99,
 17571           DFHEIV99
 17572     MOVE EIBRESP  TO WS-RESPONSE
 17573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17574      IF WS-RESP-DUPREC
 17575         GO TO 7120-DUPREC
 17576      END-IF
 17577     GO TO 7130-EXIT
 17578     .
 17579 7120-DUPREC.
 17580     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17581     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17582     GO TO 7115-WRITE-INT-TRLR
 17583     .
 17584 7130-EXIT.
 17585      EXIT.
 17586 7140-BUILD-NOTE-TRLR.
 17587
 17588
 17589* EXEC CICS GETMAIN
 17590*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17591*         LENGTH    (200)
 17592*         INITIMG   (GETMAIN-SPACE)
 17593*     END-EXEC
 17594     MOVE 200
 17595       TO DFHEIV11
 17596*    MOVE ',"IL                  $   #00016051' TO DFHEIV0
 17597     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17598     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17599     MOVE X'2020233030303136303531' TO DFHEIV0(25:11)
 17600     CALL 'kxdfhei1' USING DFHEIV0,
 17601           DFHEIV20,
 17602           DFHEIV11,
 17603           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 337
* EL156.cbl
 17604     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17605         DFHEIV20
 17606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17607     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17608     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17609     MOVE 'AT'                   TO AT-RECORD-ID
 17610     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17611     MOVE '6'                    TO AT-TRAILER-TYPE
 17612     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17613                                    AT-GEN-INFO-LAST-MAINT-DT
 17614     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17615                                    AT-GEN-INFO-LAST-UPDATED-BY
 17616     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17617     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17618     .
 17619 7150-WRITE.
 17620
 17621* EXEC CICS HANDLE CONDITION
 17622*        DUPREC    (7160-DUPREC)
 17623*    END-EXEC
 17624*    MOVE '"$%                   ! : #00016069' TO DFHEIV0
 17625     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17627     MOVE X'3A20233030303136303639' TO DFHEIV0(25:11)
 17628     CALL 'kxdfhei1' USING DFHEIV0
 17629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17630
 17631* EXEC CICS WRITE
 17632*         DATASET     ('ELTRLR')
 17633*         FROM        (ACTIVITY-TRAILERS)
 17634*         RIDFLD      (AT-CONTROL-PRIMARY)
 17635*         RESP        (WS-RESPONSE)
 17636*     END-EXEC
 17637     MOVE LENGTH OF
 17638      ACTIVITY-TRAILERS
 17639       TO DFHEIV11
 17640     MOVE 'ELTRLR' TO DFHEIV1
 17641*    MOVE '&$ L                  ''  N#00016072' TO DFHEIV0
 17642     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17643     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17644     MOVE X'204E233030303136303732' TO DFHEIV0(25:11)
 17645     CALL 'kxdfhei1' USING DFHEIV0,
 17646           DFHEIV1,
 17647           ACTIVITY-TRAILERS,
 17648           DFHEIV11,
 17649           AT-CONTROL-PRIMARY,
 17650           DFHEIV99,
 17651           DFHEIV99
 17652     MOVE EIBRESP  TO WS-RESPONSE
 17653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17654      IF WS-RESP-DUPREC
 17655         GO TO 7160-DUPREC
 17656      END-IF
 17657     GO TO 7170-EXIT
 17658     .
 17659 7160-DUPREC.
 17660     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17661     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 338
* EL156.cbl
 17662     GO TO 7150-WRITE
 17663     .
 17664 7170-EXIT.
 17665      EXIT.
 17666
 17667 7180-ADD-CERT-NOTE.
 17668*ADD CERT NOTE FOR SC NP+6
 17669
 17670
 17671* EXEC CICS GETMAIN
 17672*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17673*         LENGTH    (150)
 17674*         INITIMG   (GETMAIN-SPACE)
 17675*     END-EXEC.
 17676     MOVE 150
 17677       TO DFHEIV11
 17678*    MOVE ',"IL                  $   #00016094' TO DFHEIV0
 17679     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17680     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17681     MOVE X'2020233030303136303934' TO DFHEIV0(25:11)
 17682     CALL 'kxdfhei1' USING DFHEIV0,
 17683           DFHEIV20,
 17684           DFHEIV11,
 17685           GETMAIN-SPACE
 17686     SET ADDRESS OF CERT-NOTE-FILE TO
 17687         DFHEIV20
 17688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17689
 17690
 17691     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17692     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17693     MOVE +1                     TO WRK-NOTE-SEQ.
 17694     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17695     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17696     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17697     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17698     MOVE CL-CERT-STATE          TO CZ-STATE.
 17699     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17700     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17701     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17702     MOVE '2'                    TO CZ-RECORD-TYPE.
 17703     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17704     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17705     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17706     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17707     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17708     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17709     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17710     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17711     IF PI-COMPANY-ID = 'AHL'
 17712        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17713           CONTINUE
 17714        ELSE
 17715           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17716              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17717           ELSE
 17718              MOVE ' + 2 MO '    TO SC-NP6-COMM
 17719           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 339
* EL156.cbl
 17720        END-IF
 17721     END-IF
 17722     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 17723     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 17724
 17725 7181-WRITE.
 17726
 17727
 17728* EXEC CICS WRITE
 17729*         DATASET     ('ERCNOT')
 17730*         FROM        (CERT-NOTE-FILE)
 17731*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17732*         RESP        (WS-RESPONSE)
 17733*    END-EXEC.
 17734     MOVE LENGTH OF
 17735      CERT-NOTE-FILE
 17736       TO DFHEIV11
 17737     MOVE 'ERCNOT' TO DFHEIV1
 17738*    MOVE '&$ L                  ''  N#00016136' TO DFHEIV0
 17739     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17740     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17741     MOVE X'204E233030303136313336' TO DFHEIV0(25:11)
 17742     CALL 'kxdfhei1' USING DFHEIV0,
 17743           DFHEIV1,
 17744           CERT-NOTE-FILE,
 17745           DFHEIV11,
 17746           CZ-CONTROL-PRIMARY,
 17747           DFHEIV99,
 17748           DFHEIV99
 17749     MOVE EIBRESP  TO WS-RESPONSE
 17750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17751
 17752
 17753     IF WS-RESP-DUPREC
 17754         GO TO 7182-DUPREC
 17755     END-IF.
 17756
 17757     SET CERT-NOTE-ADDED TO TRUE.
 17758
 17759     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 17760         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 17761     END-IF.
 17762
 17763     GO TO 7189-EXIT.
 17764
 17765 7182-DUPREC.
 17766
 17767     ADD +1                      TO  WRK-NOTE-SEQ.
 17768     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17769     GO TO 7181-WRITE.
 17770
 17771 7189-EXIT.
 17772      EXIT.
 17773
 17774 7190-ADD-ORIG-NOTE.
 17775
 17776
 17777* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 340
* EL156.cbl
 17778*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17779*         LENGTH    (150)
 17780*         INITIMG   (GETMAIN-SPACE)
 17781*     END-EXEC.
 17782     MOVE 150
 17783       TO DFHEIV11
 17784*    MOVE ',"IL                  $   #00016166' TO DFHEIV0
 17785     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17787     MOVE X'2020233030303136313636' TO DFHEIV0(25:11)
 17788     CALL 'kxdfhei1' USING DFHEIV0,
 17789           DFHEIV20,
 17790           DFHEIV11,
 17791           GETMAIN-SPACE
 17792     SET ADDRESS OF CERT-NOTE-FILE TO
 17793         DFHEIV20
 17794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17795
 17796
 17797     ADD +1                      TO WRK-NOTE-SEQ.
 17798     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17799     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17800     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17801     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17802     MOVE CL-CERT-STATE          TO CZ-STATE.
 17803     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17804     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17805     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17806     MOVE '2'                    TO CZ-RECORD-TYPE.
 17807     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17808     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17809     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17810     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17811     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17812     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 17813
 17814 7191-WRITE.
 17815
 17816
 17817* EXEC CICS WRITE
 17818*         DATASET     ('ERCNOT')
 17819*         FROM        (CERT-NOTE-FILE)
 17820*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17821*         RESP        (WS-RESPONSE)
 17822*    END-EXEC.
 17823     MOVE LENGTH OF
 17824      CERT-NOTE-FILE
 17825       TO DFHEIV11
 17826     MOVE 'ERCNOT' TO DFHEIV1
 17827*    MOVE '&$ L                  ''  N#00016191' TO DFHEIV0
 17828     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17830     MOVE X'204E233030303136313931' TO DFHEIV0(25:11)
 17831     CALL 'kxdfhei1' USING DFHEIV0,
 17832           DFHEIV1,
 17833           CERT-NOTE-FILE,
 17834           DFHEIV11,
 17835           CZ-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 341
* EL156.cbl
 17836           DFHEIV99,
 17837           DFHEIV99
 17838     MOVE EIBRESP  TO WS-RESPONSE
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
 17842     IF WS-RESP-DUPREC
 17843         GO TO 7192-DUPREC
 17844     END-IF.
 17845
 17846     GO TO 7199-EXIT.
 17847
 17848 7192-DUPREC.
 17849
 17850     ADD +1                      TO  WRK-NOTE-SEQ.
 17851     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17852     GO TO 7191-WRITE.
 17853
 17854 7199-EXIT.
 17855      EXIT.
 17856 7200-FIND-BENEFIT.
 17857     MOVE 'N' TO WS-BEN-SEARCH-SW.
 17858
 17859
 17860* EXEC CICS HANDLE CONDITION
 17861*        ENDFILE(7200-EXIT)
 17862*        NOTFND(7200-EXIT)
 17863*    END-EXEC.
 17864*    MOVE '"$''I                  ! ; #00016215' TO DFHEIV0
 17865     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17867     MOVE X'3B20233030303136323135' TO DFHEIV0(25:11)
 17868     CALL 'kxdfhei1' USING DFHEIV0
 17869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17870
 17871
 17872
 17873* EXEC CICS READ
 17874*        DATASET('ELCNTL')
 17875*        SET(ADDRESS OF CONTROL-FILE)
 17876*        RIDFLD(ELCNTL-KEY)
 17877*        GTEQ
 17878*    END-EXEC.
 17879     MOVE 'ELCNTL' TO DFHEIV1
 17880*    MOVE '&"S        G          (   #00016220' TO DFHEIV0
 17881     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17883     MOVE X'2020233030303136323230' TO DFHEIV0(25:11)
 17884     CALL 'kxdfhei1' USING DFHEIV0,
 17885           DFHEIV1,
 17886           DFHEIV20,
 17887           DFHEIV99,
 17888           ELCNTL-KEY,
 17889           DFHEIV99,
 17890           DFHEIV99,
 17891           DFHEIV99
 17892     SET ADDRESS OF CONTROL-FILE TO
 17893         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 342
* EL156.cbl
 17894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17895
 17896
 17897     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 17898        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 17899           GO TO 7200-EXIT.
 17900
 17901     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 17902         VARYING SUB-1 FROM 1 BY 1 UNTIL
 17903            ((SUB-1 > 8) OR
 17904            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 17905
 17906     IF SUB-1 NOT = 9
 17907         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 17908
 17909     GO TO 7200-EXIT.
 17910
 17911 7200-BENEFIT-DUMMY.
 17912
 17913 7200-DUMMY-EXIT.
 17914     EXIT.
 17915
 17916 7200-EXIT.
 17917     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 343
* EL156.cbl
 17919*052506
 17920*052506 7250-FIND-LETTER-TRLR.
 17921*052506     EXEC CICS HANDLE CONDITION
 17922*052506         ENDFILE  (7250-END)
 17923*052506         NOTFND   (7250-END)
 17924*052506     END-EXEC.
 17925*052506
 17926*052506     EXEC CICS STARTBR
 17927*052506         DATASET   ('ELTRLR')
 17928*052506         RIDFLD    (ELTRLR-KEY)
 17929*052506         GTEQ
 17930*052506     END-EXEC.
 17931*052506
 17932*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 17933*052506
 17934*052506 7250-FIND-LOOP.
 17935*052506     EXEC CICS READNEXT
 17936*052506         DATASET   ('ELTRLR')
 17937*052506         RIDFLD    (ELTRLR-KEY)
 17938*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17939*052506     END-EXEC.
 17940*052506
 17941*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17942*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17943*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17944*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 17945*052506        GO TO 7250-END
 17946*052506     END-IF.
 17947*052506
 17948*052506     IF AT-TRAILER-TYPE NOT = '4'
 17949*052506         GO TO 7250-FIND-LOOP
 17950*052506     END-IF.
 17951*052506
 17952*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 17953*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 17954*052506     END-IF.
 17955*052506
 17956*052506     GO TO 7250-FIND-LOOP.
 17957*052506
 17958*052506 7250-END.
 17959*052506
 17960*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 17961*051506         MOVE SPACES             TO  DC-OPTION-CODE
 17962*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 17963*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17964*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 17965*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 17966*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 17967*052506     END-IF.
 17968*052506
 17969*052506     EXEC CICS ENDBR
 17970*052506          DATASET    ('ELTRLR')
 17971*052506     END-EXEC.
 17972*052506
 17973*052506 7250-EXIT.
 17974*052506     EXIT.
 17975*052506     EJECT
 17976*052506
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 344
* EL156.cbl
 17977 7300-CHECK-AUTO-ACTIVITY.
 17978
 17979     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 17980         NEXT SENTENCE
 17981     ELSE
 17982         GO TO 7399-EXIT.
 17983
 17984     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 17985
 17986     IF WS-ACT-REC-FOUND-SW = 'N'
 17987         GO TO 7399-EXIT.
 17988
 17989     IF PI-ACTIVITY-CODE = 09
 17990         GO TO 7300-CONT-AUTO-ACTIVITY.
 17991
 17992     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 17993        (PI-ACTIVITY-CODE = 11)
 17994         GO TO 7300-CONT-AUTO-ACTIVITY.
 17995
 17996     IF PI-PROVISIONAL-IND = 'P'
 17997         IF PI-PMTTYPE = '1'
 17998             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 17999                 MOVE 'N'    TO  PI-RESET-SW
 18000                 GO TO 7399-EXIT.
 18001
 18002     IF PI-PMTTYPE = '1'
 18003         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18004             MOVE 'N'        TO  PI-RESET-SW
 18005             GO TO 7399-EXIT.
 18006
 18007     IF PI-PMTTYPE = '2' OR '3'
 18008         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18009             MOVE 'N'        TO  PI-RESET-SW
 18010             GO TO 7399-EXIT.
 18011
 18012     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18013         IF PI-PROVISIONAL-IND = 'P'
 18014             NEXT SENTENCE
 18015         ELSE
 18016             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18017
 18018 7300-CONT-AUTO-ACTIVITY.
 18019
 18020     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18021         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18022         MOVE '4'            TO DC-OPTION-CODE
 18023         MOVE +0             TO DC-ELAPSED-DAYS
 18024                                DC-ELAPSED-MONTHS
 18025         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18026         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18027         IF PI-USES-PAID-TO
 18028             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18029             IF NO-CONVERSION-ERROR
 18030                 MOVE +1     TO DC-ELAPSED-DAYS
 18031                 MOVE +0     TO DC-ELAPSED-MONTHS
 18032                 MOVE '6'    TO DC-OPTION-CODE
 18033                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18034                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 345
* EL156.cbl
 18035                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18036
 18037     IF PI-PFKEY-USED = DFHPF5
 18038         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18039         IF PI-USES-PAID-TO
 18040             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18041             MOVE +1                  TO DC-ELAPSED-DAYS
 18042             MOVE +0                  TO DC-ELAPSED-MONTHS
 18043             MOVE '6'                 TO DC-OPTION-CODE
 18044             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18045             IF NO-CONVERSION-ERROR
 18046                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18047
 18048     IF WS-CHK-THRU-DT < PI-EXP-DT
 18049         NEXT SENTENCE
 18050     ELSE
 18051         MOVE 03                     TO  WS-ACTIVITY-CODE
 18052         GO TO 7390-PROCESS-ACTIVITY.
 18053
 18054     IF PI-PROV-PMT
 18055         MOVE 09                     TO  WS-ACTIVITY-CODE
 18056     ELSE
 18057        IF PI-PMTTYPE = '1'
 18058            MOVE 02                  TO  WS-ACTIVITY-CODE
 18059        ELSE
 18060        IF PI-PMTTYPE = '2' OR '3'
 18061            MOVE 07                  TO  WS-ACTIVITY-CODE
 18062        ELSE
 18063        IF PI-PMTTYPE = '4'
 18064            MOVE 00                  TO  WS-ACTIVITY-CODE
 18065        ELSE
 18066            MOVE 'N'                 TO  PI-RESET-SW
 18067            GO TO 7399-EXIT.
 18068
 18069 7390-PROCESS-ACTIVITY.
 18070
 18071     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 18072
 18073 7399-EXIT.
 18074     EXIT.
 18075
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 346
* EL156.cbl
 18077 7400-CHECK-AUTO-ACTIVITY.
 18078
 18079
 18080* EXEC CICS HANDLE CONDITION
 18081*        NOTFND   (7400-NOT-FOUND)
 18082*    END-EXEC.
 18083*    MOVE '"$I                   ! < #00016409' TO DFHEIV0
 18084     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18086     MOVE X'3C20233030303136343039' TO DFHEIV0(25:11)
 18087     CALL 'kxdfhei1' USING DFHEIV0
 18088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18089
 18090
 18091     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18092     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18093     MOVE SPACES                 TO  CNTL-ACCESS.
 18094     MOVE +0                     TO  CNTL-SEQ-NO.
 18095
 18096
 18097* EXEC CICS READ
 18098*        DATASET   ('ELCNTL')
 18099*        RIDFLD    (ELCNTL-KEY)
 18100*        SET       (ADDRESS OF CONTROL-FILE)
 18101*    END-EXEC.
 18102     MOVE 'ELCNTL' TO DFHEIV1
 18103*    MOVE '&"S        E          (   #00016418' TO DFHEIV0
 18104     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18106     MOVE X'2020233030303136343138' TO DFHEIV0(25:11)
 18107     CALL 'kxdfhei1' USING DFHEIV0,
 18108           DFHEIV1,
 18109           DFHEIV20,
 18110           DFHEIV99,
 18111           ELCNTL-KEY,
 18112           DFHEIV99,
 18113           DFHEIV99,
 18114           DFHEIV99
 18115     SET ADDRESS OF CONTROL-FILE TO
 18116         DFHEIV20
 18117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18118
 18119
 18120     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18121     GO TO 7400-EXIT.
 18122
 18123 7400-NOT-FOUND.
 18124     MOVE 'N'                        TO  PI-RESET-SW
 18125                                         WS-LETTER-SW
 18126                                         WS-ACT-REC-FOUND-SW.
 18127
 18128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18129
 18130 7400-EXIT.
 18131     EXIT.
 18132
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 347
* EL156.cbl
 18134 7450-FORMAT-AUTO-LETTER.
 18135
 18136     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18137         MOVE 'Y'                    TO PI-RESET-SW
 18138         GO TO 7450-CONTINUE-PROCESS.
 18139
 18140     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18141
 18142     IF SUB > 9
 18143         SUBTRACT 9 FROM SUB
 18144         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18145     ELSE
 18146         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18147
 18148 7450-CONTINUE-PROCESS.
 18149
 18150     IF WS-ACTIVITY-CODE = ZEROS
 18151         MOVE 'N'                    TO  WS-LETTER-SW
 18152         GO TO 7499-EXIT.
 18153
 18154     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18155
 18156     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18157         MOVE 'N'                    TO  PI-RESET-SW
 18158                                         WS-LETTER-SW
 18159         GO TO 7499-EXIT.
 18160
 18161     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18162         MOVE 'N'                    TO  WS-LETTER-SW
 18163         GO TO 7499-EXIT.
 18164
 18165     MOVE 'Y'                        TO  WS-LETTER-SW.
 18166     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18167     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18168
 18169     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18170
 18171     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18172         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18173         MOVE '6'                    TO  DC-OPTION-CODE
 18174         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18175         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18176         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18177         IF NO-CONVERSION-ERROR
 18178             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18179         ELSE
 18180              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18181
 18182     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18183         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18184         MOVE '6'                    TO  DC-OPTION-CODE
 18185         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18186         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18187         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18188         IF NO-CONVERSION-ERROR
 18189             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18190         ELSE
 18191             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 348
* EL156.cbl
 18192
 18193 7499-EXIT.
 18194     EXIT.
 18195
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 349
* EL156.cbl
 18197 7500-RESET-AUTO-ACTIVITY.
 18198
 18199     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18200     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18201     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18202     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18203     MOVE +100                   TO  TRLR-SEQ-NO.
 18204
 18205 7500-STARTBR-TRLR.
 18206
 18207
 18208* EXEC CICS HANDLE CONDITION
 18209*        ENDFILE  (7590-END)
 18210*        NOTFND   (7590-END)
 18211*    END-EXEC.
 18212*    MOVE '"$''I                  ! = #00016511' TO DFHEIV0
 18213     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18215     MOVE X'3D20233030303136353131' TO DFHEIV0(25:11)
 18216     CALL 'kxdfhei1' USING DFHEIV0
 18217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18218
 18219
 18220
 18221* EXEC CICS STARTBR
 18222*        DATASET   ('ELTRLR')
 18223*        RIDFLD    (ELTRLR-KEY)
 18224*        GTEQ
 18225*    END-EXEC.
 18226     MOVE 'ELTRLR' TO DFHEIV1
 18227     MOVE 0
 18228       TO DFHEIV11
 18229*    MOVE '&,         G          &   #00016516' TO DFHEIV0
 18230     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18231     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18232     MOVE X'2020233030303136353136' TO DFHEIV0(25:11)
 18233     CALL 'kxdfhei1' USING DFHEIV0,
 18234           DFHEIV1,
 18235           ELTRLR-KEY,
 18236           DFHEIV99,
 18237           DFHEIV11,
 18238           DFHEIV99
 18239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18240
 18241
 18242     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18243
 18244 7500-READ-NEXT.
 18245
 18246
 18247* EXEC CICS READNEXT
 18248*        DATASET   ('ELTRLR')
 18249*        RIDFLD    (ELTRLR-KEY)
 18250*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18251*    END-EXEC.
 18252     MOVE 'ELTRLR' TO DFHEIV1
 18253     MOVE 0
 18254       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 350
* EL156.cbl
 18255*    MOVE '&.S                   )   #00016526' TO DFHEIV0
 18256     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18257     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18258     MOVE X'2020233030303136353236' TO DFHEIV0(25:11)
 18259     CALL 'kxdfhei1' USING DFHEIV0,
 18260           DFHEIV1,
 18261           DFHEIV20,
 18262           DFHEIV99,
 18263           ELTRLR-KEY,
 18264           DFHEIV99,
 18265           DFHEIV11,
 18266           DFHEIV99,
 18267           DFHEIV99
 18268     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18269         DFHEIV20
 18270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18271
 18272
 18273     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18274        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18275        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18276        PI-CERT-NO    NOT = TRLR-CERT-NO
 18277         GO TO 7590-END.
 18278
 18279     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18280         GO TO 7500-READ-NEXT.
 18281
 18282     IF AT-TRAILER-TYPE NOT = '4'
 18283         GO TO 7500-READ-NEXT.
 18284
 18285     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18286         GO TO 7500-READ-NEXT.
 18287
 18288     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18289        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18290         GO TO 7500-READ-NEXT.
 18291
 18292     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18293        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18294        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18295         GO TO 7500-READ-NEXT.
 18296
 18297     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18298                         AND
 18299        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18300                         AND
 18301        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18302            GO TO 7500-READ-NEXT.
 18303
 18304     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18305
 18306
 18307* EXEC CICS ENDBR
 18308*        DATASET   ('ELTRLR')
 18309*    END-EXEC.
 18310     MOVE 'ELTRLR' TO DFHEIV1
 18311     MOVE 0
 18312       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 351
* EL156.cbl
 18313*    MOVE '&2                    $   #00016565' TO DFHEIV0
 18314     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18315     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18316     MOVE X'2020233030303136353635' TO DFHEIV0(25:11)
 18317     CALL 'kxdfhei1' USING DFHEIV0,
 18318           DFHEIV1,
 18319           DFHEIV11,
 18320           DFHEIV99
 18321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18322
 18323
 18324     MOVE 'N'                        TO  WS-BROWSE-SW.
 18325
 18326
 18327* EXEC CICS READ
 18328*        DATASET   ('ELTRLR')
 18329*        RIDFLD    (ELTRLR-KEY)
 18330*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18331*        UPDATE
 18332*    END-EXEC.
 18333     MOVE 'ELTRLR' TO DFHEIV1
 18334*    MOVE '&"S        EU         (   #00016571' TO DFHEIV0
 18335     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18336     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18337     MOVE X'2020233030303136353731' TO DFHEIV0(25:11)
 18338     CALL 'kxdfhei1' USING DFHEIV0,
 18339           DFHEIV1,
 18340           DFHEIV20,
 18341           DFHEIV99,
 18342           ELTRLR-KEY,
 18343           DFHEIV99,
 18344           DFHEIV99,
 18345           DFHEIV99
 18346     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18347         DFHEIV20
 18348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18349
 18350
 18351     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18352
 18353     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18354         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18355     ELSE
 18356         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18357             NEXT SENTENCE
 18358         ELSE
 18359             GO TO 7500-REWRITE-TRLR.
 18360
 18361     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18362
 18363     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18364     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18365     MOVE '1'                        TO  ARCH-REC-TYPE.
 18366     MOVE +0                         TO  ARCH-SEQ.
 18367
 18368     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18369
 18370 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 352
* EL156.cbl
 18371
 18372
 18373* EXEC CICS REWRITE
 18374*        DATASET   ('ELTRLR')
 18375*        FROM      (ACTIVITY-TRAILERS)
 18376*    END-EXEC.
 18377     MOVE LENGTH OF
 18378      ACTIVITY-TRAILERS
 18379       TO DFHEIV11
 18380     MOVE 'ELTRLR' TO DFHEIV1
 18381*    MOVE '&& L                  %   #00016599' TO DFHEIV0
 18382     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18383     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18384     MOVE X'2020233030303136353939' TO DFHEIV0(25:11)
 18385     CALL 'kxdfhei1' USING DFHEIV0,
 18386           DFHEIV1,
 18387           ACTIVITY-TRAILERS,
 18388           DFHEIV11,
 18389           DFHEIV99
 18390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18391
 18392
 18393     GO TO 7500-STARTBR-TRLR.
 18394
 18395 7590-END.
 18396
 18397     IF WS-BROWSE-SW = 'Y'
 18398         MOVE 'N'                    TO  WS-BROWSE-SW
 18399
 18400* EXEC CICS ENDBR
 18401*            DATASET   ('ELTRLR')
 18402*        END-EXEC.
 18403     MOVE 'ELTRLR' TO DFHEIV1
 18404     MOVE 0
 18405       TO DFHEIV11
 18406*    MOVE '&2                    $   #00016610' TO DFHEIV0
 18407     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18409     MOVE X'2020233030303136363130' TO DFHEIV0(25:11)
 18410     CALL 'kxdfhei1' USING DFHEIV0,
 18411           DFHEIV1,
 18412           DFHEIV11,
 18413           DFHEIV99
 18414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18415
 18416
 18417 7599-EXIT.
 18418     EXIT.
 18419
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 353
* EL156.cbl
 18421 7600-READ-ARCH-UPDATE.
 18422
 18423
 18424* EXEC CICS HANDLE CONDITION
 18425*        NOTFND   (7699-EXIT)
 18426*    END-EXEC.
 18427*    MOVE '"$I                   ! > #00016620' TO DFHEIV0
 18428     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18430     MOVE X'3E20233030303136363230' TO DFHEIV0(25:11)
 18431     CALL 'kxdfhei1' USING DFHEIV0
 18432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18433
 18434
 18435
 18436* EXEC CICS READ
 18437*        DATASET   ('ELARCH')
 18438*        RIDFLD    (ELARCH-KEY)
 18439*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18440*        UPDATE
 18441*    END-EXEC.
 18442     MOVE 'ELARCH' TO DFHEIV1
 18443*    MOVE '&"S        EU         (   #00016624' TO DFHEIV0
 18444     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18445     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18446     MOVE X'2020233030303136363234' TO DFHEIV0(25:11)
 18447     CALL 'kxdfhei1' USING DFHEIV0,
 18448           DFHEIV1,
 18449           DFHEIV20,
 18450           DFHEIV99,
 18451           ELARCH-KEY,
 18452           DFHEIV99,
 18453           DFHEIV99,
 18454           DFHEIV99
 18455     SET ADDRESS OF LETTER-ARCHIVE TO
 18456         DFHEIV20
 18457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18458
 18459
 18460     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18461
 18462
 18463* EXEC CICS REWRITE
 18464*        DATASET   ('ELARCH')
 18465*        FROM      (LETTER-ARCHIVE)
 18466*    END-EXEC.
 18467     MOVE LENGTH OF
 18468      LETTER-ARCHIVE
 18469       TO DFHEIV11
 18470     MOVE 'ELARCH' TO DFHEIV1
 18471*    MOVE '&& L                  %   #00016633' TO DFHEIV0
 18472     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18473     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18474     MOVE X'2020233030303136363333' TO DFHEIV0(25:11)
 18475     CALL 'kxdfhei1' USING DFHEIV0,
 18476           DFHEIV1,
 18477           LETTER-ARCHIVE,
 18478           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 354
* EL156.cbl
 18479           DFHEIV99
 18480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18481
 18482
 18483 7699-EXIT.
 18484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 355
* EL156.cbl
 18486 7700-GET-DCT.
 18487
 18488     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18489     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18490     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18491     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18492                                    PI-MAX-BENEFIT-AMT
 18493                                    PI-MAX-BENEFIT-PYMT
 18494                                    PI-MIN-PAYMENT-AMT
 18495                                    PI-TIME-OF-LOSS-BAL.
 18496
 18497
 18498* EXEC CICS HANDLE CONDITION
 18499*         NOTFND (5300-NOTE-NOT-FOUND)
 18500*     END-EXEC.
 18501*    MOVE '"$I                   ! ? #00016652' TO DFHEIV0
 18502     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18504     MOVE X'3F20233030303136363532' TO DFHEIV0(25:11)
 18505     CALL 'kxdfhei1' USING DFHEIV0
 18506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18507
 18508
 18509
 18510* EXEC CICS READ
 18511*         DATASET('ERNOTE')
 18512*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18513*         RIDFLD (W-NOTE-KEY)
 18514*     END-EXEC.
 18515     MOVE 'ERNOTE' TO DFHEIV1
 18516*    MOVE '&"S        E          (   #00016656' TO DFHEIV0
 18517     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18519     MOVE X'2020233030303136363536' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0,
 18521           DFHEIV1,
 18522           DFHEIV20,
 18523           DFHEIV99,
 18524           W-NOTE-KEY,
 18525           DFHEIV99,
 18526           DFHEIV99,
 18527           DFHEIV99
 18528     SET ADDRESS OF CERTIFICATE-NOTE TO
 18529         DFHEIV20
 18530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18531
 18532
 18533     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18534     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18535     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18536     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18537     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18538
 18539     IF PI-PAYEE-TYPE NOT = 'B'
 18540         GO TO 7700-EXIT.
 18541
 18542     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18543     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 356
* EL156.cbl
 18544     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18545
 18546     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18547         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18548     ELSE
 18549         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18550
 18551     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18552     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18553     MOVE 'DLO006'               TO PGM-NAME.
 18554
 18555
 18556* EXEC CICS LINK
 18557*        PROGRAM    (PGM-NAME)
 18558*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18559*        LENGTH     (DCT-RCRD-LENGTH)
 18560*    END-EXEC.
 18561*    MOVE '."C                   (   #00016684' TO DFHEIV0
 18562     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18564     MOVE X'2020233030303136363834' TO DFHEIV0(25:11)
 18565     CALL 'kxdfhei1' USING DFHEIV0,
 18566           PGM-NAME,
 18567           DCT-COMMUNICATION-AREA,
 18568           DCT-RCRD-LENGTH,
 18569           DFHEIV99,
 18570           DFHEIV99,
 18571           DFHEIV99,
 18572           DFHEIV99
 18573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18574
 18575
 18576     IF DCT-RETURN-CODE = 'OK'
 18577         GO TO 7700-CONT.
 18578
 18579     IF DCT-RETURN-CODE = '01' OR '02'
 18580         GO TO 7700-SET-TO-YES.
 18581
 18582     IF DCT-RETURN-CODE = '03'
 18583
 18584* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18585*    MOVE '6"R                   !   #00016697' TO DFHEIV0
 18586     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18588     MOVE X'2020233030303136363937' TO DFHEIV0(25:11)
 18589     CALL 'kxdfhei1' USING DFHEIV0
 18590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18591         MOVE ER-0951            TO EMI-ERROR
 18592         MOVE -1                 TO PMTTYPEL
 18593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18594         GO TO 8200-SEND-DATAONLY.
 18595
 18596     IF DCT-RETURN-CODE = '04'
 18597
 18598* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18599*    MOVE '6"R                   !   #00016704' TO DFHEIV0
 18600     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 357
* EL156.cbl
 18602     MOVE X'2020233030303136373034' TO DFHEIV0(25:11)
 18603     CALL 'kxdfhei1' USING DFHEIV0
 18604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18605         MOVE ER-0946            TO EMI-ERROR
 18606         MOVE -1                 TO PMTTYPEL
 18607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18608         GO TO 8200-SEND-DATAONLY.
 18609
 18610     IF DCT-RETURN-CODE = '05'
 18611
 18612* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18613*    MOVE '6"R                   !   #00016711' TO DFHEIV0
 18614     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18616     MOVE X'2020233030303136373131' TO DFHEIV0(25:11)
 18617     CALL 'kxdfhei1' USING DFHEIV0
 18618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18619         MOVE ER-0947            TO EMI-ERROR
 18620         MOVE -1                 TO PMTTYPEL
 18621         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18622         GO TO 8200-SEND-DATAONLY.
 18623
 18624     IF DCT-RETURN-CODE = '06'
 18625
 18626* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18627*    MOVE '6"R                   !   #00016718' TO DFHEIV0
 18628     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18630     MOVE X'2020233030303136373138' TO DFHEIV0(25:11)
 18631     CALL 'kxdfhei1' USING DFHEIV0
 18632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18633         MOVE ER-0921            TO EMI-ERROR
 18634         MOVE -1                 TO PMTTYPEL
 18635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18636         GO TO 8200-SEND-DATAONLY.
 18637
 18638     IF DCT-RETURN-CODE = '07'
 18639
 18640* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18641*    MOVE '6"R                   !   #00016725' TO DFHEIV0
 18642     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18644     MOVE X'2020233030303136373235' TO DFHEIV0(25:11)
 18645     CALL 'kxdfhei1' USING DFHEIV0
 18646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18647         MOVE ER-0919            TO EMI-ERROR
 18648         MOVE -1                 TO PMTTYPEL
 18649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18650         GO TO 8200-SEND-DATAONLY.
 18651
 18652     IF DCT-RETURN-CODE = '08'
 18653
 18654* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18655*    MOVE '6"R                   !   #00016732' TO DFHEIV0
 18656     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18658     MOVE X'2020233030303136373332' TO DFHEIV0(25:11)
 18659     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 358
* EL156.cbl
 18660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18661         MOVE ER-0948            TO EMI-ERROR
 18662         MOVE -1                 TO PMTTYPEL
 18663         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18664         GO TO 8200-SEND-DATAONLY.
 18665
 18666     IF DCT-RETURN-CODE = 'N1'
 18667
 18668* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18669*    MOVE '6"R                   !   #00016739' TO DFHEIV0
 18670     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18672     MOVE X'2020233030303136373339' TO DFHEIV0(25:11)
 18673     CALL 'kxdfhei1' USING DFHEIV0
 18674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18675         MOVE ER-0950            TO EMI-ERROR
 18676         MOVE -1                 TO PMTTYPEL
 18677         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18678         GO TO 8200-SEND-DATAONLY.
 18679
 18680     IF DCT-RETURN-CODE = 'E1'
 18681
 18682* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18683*    MOVE '6"R                   !   #00016746' TO DFHEIV0
 18684     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18686     MOVE X'2020233030303136373436' TO DFHEIV0(25:11)
 18687     CALL 'kxdfhei1' USING DFHEIV0
 18688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18689         MOVE ER-0974            TO EMI-ERROR
 18690         MOVE -1                 TO PMTTYPEL
 18691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18692         GO TO 8200-SEND-DATAONLY.
 18693
 18694     IF DCT-RETURN-CODE = 'E2'
 18695
 18696* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18697*    MOVE '6"R                   !   #00016753' TO DFHEIV0
 18698     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18700     MOVE X'2020233030303136373533' TO DFHEIV0(25:11)
 18701     CALL 'kxdfhei1' USING DFHEIV0
 18702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18703         MOVE ER-0975            TO EMI-ERROR
 18704         MOVE -1                 TO PMTTYPEL
 18705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18706         GO TO 8200-SEND-DATAONLY.
 18707
 18708     IF DCT-RETURN-CODE NOT = 'OK'
 18709
 18710* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18711*    MOVE '6"R                   !   #00016760' TO DFHEIV0
 18712     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18714     MOVE X'2020233030303136373630' TO DFHEIV0(25:11)
 18715     CALL 'kxdfhei1' USING DFHEIV0
 18716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18717         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 359
* EL156.cbl
 18718         MOVE -1                 TO PMTTYPEL
 18719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18720         GO TO 8200-SEND-DATAONLY.
 18721
 18722 7700-CONT.
 18723
 18724*    MOVE 'N'                    TO CASHO.
 18725*    MOVE +1                     TO CASHL.
 18726*    MOVE AL-UANON               TO CASHA.
 18727
 18728     IF PI-OFFLINE = 'Y'
 18729         GO TO 7700-EXIT.
 18730
 18731     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 18732     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 18733     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 18734     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 18735     MOVE +7                     TO CHECKNOL.
 18736     MOVE AL-UANON               TO CHECKNOA.
 18737     GO TO 7700-EXIT.
 18738
 18739 7700-SET-TO-YES.
 18740
 18741*    MOVE 'Y'                    TO CASHO.
 18742*    MOVE +1                     TO CASHL.
 18743*    MOVE AL-UANON               TO CASHA.
 18744
 18745 7700-EXIT.
 18746     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 360
* EL156.cbl
 18748 7800-READ-COMP-MSTR.
 18749
 18750
 18751* EXEC CICS HANDLE CONDITION
 18752*        NOTFND   (7800-COMP-NOTFND)
 18753*    END-EXEC.
 18754*    MOVE '"$I                   ! @ #00016794' TO DFHEIV0
 18755     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18757     MOVE X'4020233030303136373934' TO DFHEIV0(25:11)
 18758     CALL 'kxdfhei1' USING DFHEIV0
 18759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18760
 18761
 18762
 18763* EXEC CICS READ
 18764*        DATASET   ('ERCOMP')
 18765*        RIDFLD    (ERCOMP-KEY)
 18766*        SET       (ADDRESS OF COMPENSATION-MASTER)
 18767*    END-EXEC.
 18768     MOVE 'ERCOMP' TO DFHEIV1
 18769*    MOVE '&"S        E          (   #00016798' TO DFHEIV0
 18770     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18772     MOVE X'2020233030303136373938' TO DFHEIV0(25:11)
 18773     CALL 'kxdfhei1' USING DFHEIV0,
 18774           DFHEIV1,
 18775           DFHEIV20,
 18776           DFHEIV99,
 18777           ERCOMP-KEY,
 18778           DFHEIV99,
 18779           DFHEIV99,
 18780           DFHEIV99
 18781     SET ADDRESS OF COMPENSATION-MASTER TO
 18782         DFHEIV20
 18783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18784
 18785
 18786     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 18787     GO TO 7800-COMP-EXIT.
 18788
 18789 7800-COMP-NOTFND.
 18790     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 18791
 18792 7800-COMP-EXIT.
 18793     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 361
* EL156.cbl
 18795 7900-READ-CLAIM.
 18796
 18797* EXEC CICS READ
 18798*        DATASET  ('ELMSTR')
 18799*        SET      (ADDRESS OF CLAIM-MASTER)
 18800*        RIDFLD   (ELMSTR-KEY)
 18801*    END-EXEC.
 18802     MOVE 'ELMSTR' TO DFHEIV1
 18803*    MOVE '&"S        E          (   #00016814' TO DFHEIV0
 18804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18806     MOVE X'2020233030303136383134' TO DFHEIV0(25:11)
 18807     CALL 'kxdfhei1' USING DFHEIV0,
 18808           DFHEIV1,
 18809           DFHEIV20,
 18810           DFHEIV99,
 18811           ELMSTR-KEY,
 18812           DFHEIV99,
 18813           DFHEIV99,
 18814           DFHEIV99
 18815     SET ADDRESS OF CLAIM-MASTER TO
 18816         DFHEIV20
 18817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18818
 18819
 18820 7900-EXIT.
 18821      EXIT.
 18822
 18823 7910-READ-CLAIM-UPDATE.
 18824
 18825* EXEC CICS READ
 18826*        DATASET  ('ELMSTR')
 18827*        SET      (ADDRESS OF CLAIM-MASTER)
 18828*        RIDFLD   (ELMSTR-KEY)
 18829*        UPDATE
 18830*    END-EXEC.
 18831     MOVE 'ELMSTR' TO DFHEIV1
 18832*    MOVE '&"S        EU         (   #00016824' TO DFHEIV0
 18833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18834     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18835     MOVE X'2020233030303136383234' TO DFHEIV0(25:11)
 18836     CALL 'kxdfhei1' USING DFHEIV0,
 18837           DFHEIV1,
 18838           DFHEIV20,
 18839           DFHEIV99,
 18840           ELMSTR-KEY,
 18841           DFHEIV99,
 18842           DFHEIV99,
 18843           DFHEIV99
 18844     SET ADDRESS OF CLAIM-MASTER TO
 18845         DFHEIV20
 18846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18847
 18848
 18849 7910-EXIT.
 18850      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 362
* EL156.cbl
 18852 7920-READ-BENE.
 18853     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 18854     MOVE 'B'                TO BENE-RECORD-TYPE.
 18855     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 18856
 18857     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18858        IF PI-PAYEE-TYPE    = 'B' AND
 18859           PI-PAYEE-SEQ-NUM = 9
 18860             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 18861             MOVE WS-A-BENE           TO BENE-NUMBER.
 18862
 18863
 18864* EXEC CICS HANDLE CONDITION
 18865*        NOTFND   (7920-NOT-FOUND)
 18866*    END-EXEC.
 18867*    MOVE '"$I                   ! A #00016845' TO DFHEIV0
 18868     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18870     MOVE X'4120233030303136383435' TO DFHEIV0(25:11)
 18871     CALL 'kxdfhei1' USING DFHEIV0
 18872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18873
 18874
 18875
 18876* EXEC CICS READ
 18877*        DATASET  ('ELBENE')
 18878*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 18879*        RIDFLD   (ELBENE-KEY)
 18880*    END-EXEC.
 18881     MOVE 'ELBENE' TO DFHEIV1
 18882*    MOVE '&"S        E          (   #00016849' TO DFHEIV0
 18883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18885     MOVE X'2020233030303136383439' TO DFHEIV0(25:11)
 18886     CALL 'kxdfhei1' USING DFHEIV0,
 18887           DFHEIV1,
 18888           DFHEIV20,
 18889           DFHEIV99,
 18890           ELBENE-KEY,
 18891           DFHEIV99,
 18892           DFHEIV99,
 18893           DFHEIV99
 18894     SET ADDRESS OF BENEFICIARY-MASTER TO
 18895         DFHEIV20
 18896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18897
 18898
 18899     MOVE 'Y' TO BENE-FOUND-SW.
 18900     GO TO 7920-EXIT.
 18901
 18902 7920-NOT-FOUND.
 18903     MOVE 'N'                    TO BENE-FOUND-SW.
 18904
 18905 7920-EXIT.
 18906      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 363
* EL156.cbl
 18908 7930-READ-CONTROL.
 18909
 18910* EXEC CICS READ
 18911*        DATASET  ('ELCNTL')
 18912*        SET      (ADDRESS OF CONTROL-FILE)
 18913*        RIDFLD   (ELCNTL-KEY)
 18914*    END-EXEC.
 18915     MOVE 'ELCNTL' TO DFHEIV1
 18916*    MOVE '&"S        E          (   #00016865' TO DFHEIV0
 18917     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18918     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18919     MOVE X'2020233030303136383635' TO DFHEIV0(25:11)
 18920     CALL 'kxdfhei1' USING DFHEIV0,
 18921           DFHEIV1,
 18922           DFHEIV20,
 18923           DFHEIV99,
 18924           ELCNTL-KEY,
 18925           DFHEIV99,
 18926           DFHEIV99,
 18927           DFHEIV99
 18928     SET ADDRESS OF CONTROL-FILE TO
 18929         DFHEIV20
 18930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18931
 18932
 18933 7930-EXIT.
 18934      EXIT.
 18935
 18936 7940-READ-CONTROL-UPDATE.
 18937
 18938* EXEC CICS READ
 18939*        DATASET  ('ELCNTL')
 18940*        SET      (ADDRESS OF CONTROL-FILE)
 18941*        RIDFLD   (ELCNTL-KEY)
 18942*        UPDATE
 18943*    END-EXEC.
 18944     MOVE 'ELCNTL' TO DFHEIV1
 18945*    MOVE '&"S        EU         (   #00016875' TO DFHEIV0
 18946     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18947     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18948     MOVE X'2020233030303136383735' TO DFHEIV0(25:11)
 18949     CALL 'kxdfhei1' USING DFHEIV0,
 18950           DFHEIV1,
 18951           DFHEIV20,
 18952           DFHEIV99,
 18953           ELCNTL-KEY,
 18954           DFHEIV99,
 18955           DFHEIV99,
 18956           DFHEIV99
 18957     SET ADDRESS OF CONTROL-FILE TO
 18958         DFHEIV20
 18959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18960
 18961
 18962 7940-EXIT.
 18963      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 364
* EL156.cbl
 18965 7950-READ-TRAILER.
 18966
 18967* EXEC CICS READ
 18968*        DATASET  ('ELTRLR')
 18969*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18970*        RIDFLD   (ELTRLR-KEY)
 18971*    END-EXEC.
 18972     MOVE 'ELTRLR' TO DFHEIV1
 18973*    MOVE '&"S        E          (   #00016886' TO DFHEIV0
 18974     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18976     MOVE X'2020233030303136383836' TO DFHEIV0(25:11)
 18977     CALL 'kxdfhei1' USING DFHEIV0,
 18978           DFHEIV1,
 18979           DFHEIV20,
 18980           DFHEIV99,
 18981           ELTRLR-KEY,
 18982           DFHEIV99,
 18983           DFHEIV99,
 18984           DFHEIV99
 18985     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18986         DFHEIV20
 18987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18988
 18989
 18990 7950-EXIT.
 18991      EXIT.
 18992
 18993 7960-READ-TRAILER-UPDATE.
 18994
 18995* EXEC CICS READ
 18996*        DATASET  ('ELTRLR')
 18997*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18998*        RIDFLD   (ELTRLR-KEY)
 18999*        UPDATE
 19000*    END-EXEC.
 19001     MOVE 'ELTRLR' TO DFHEIV1
 19002*    MOVE '&"S        EU         (   #00016896' TO DFHEIV0
 19003     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19004     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19005     MOVE X'2020233030303136383936' TO DFHEIV0(25:11)
 19006     CALL 'kxdfhei1' USING DFHEIV0,
 19007           DFHEIV1,
 19008           DFHEIV20,
 19009           DFHEIV99,
 19010           ELTRLR-KEY,
 19011           DFHEIV99,
 19012           DFHEIV99,
 19013           DFHEIV99
 19014     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19015         DFHEIV20
 19016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19017
 19018
 19019 7960-EXIT.
 19020      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 365
* EL156.cbl
 19022 7970-READ-CERT.
 19023
 19024* EXEC CICS READ
 19025*        DATASET  ('ELCERT')
 19026*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19027*        RIDFLD   (ELCERT-KEY)
 19028*    END-EXEC.
 19029     MOVE 'ELCERT' TO DFHEIV1
 19030*    MOVE '&"S        E          (   #00016907' TO DFHEIV0
 19031     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19033     MOVE X'2020233030303136393037' TO DFHEIV0(25:11)
 19034     CALL 'kxdfhei1' USING DFHEIV0,
 19035           DFHEIV1,
 19036           DFHEIV20,
 19037           DFHEIV99,
 19038           ELCERT-KEY,
 19039           DFHEIV99,
 19040           DFHEIV99,
 19041           DFHEIV99
 19042     SET ADDRESS OF CERTIFICATE-MASTER TO
 19043         DFHEIV20
 19044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19045
 19046
 19047 7970-EXIT.
 19048      EXIT.
 19049 7975-read-acct.
 19050
 19051     move spaces              to WS-ACCT-RECORD-SW
 19052                                 pi-dcc-product-code
 19053
 19054     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19055     MOVE PI-CARRIER          TO ACCT-CARRIER
 19056     MOVE PI-GROUPING         TO ACCT-GROUPING
 19057     MOVE PI-STATE            TO ACCT-STATE
 19058     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19059     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19060     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19061     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19062
 19063
 19064* EXEC CICS READ
 19065*       DATASET ('ERACCT')
 19066*       RIDFLD  (ERACCT-KEY)
 19067*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19068*       GTEQ
 19069*       resp    (WS-RESPONSE)
 19070*    END-EXEC
 19071     MOVE 'ERACCT' TO DFHEIV1
 19072*    MOVE '&"S        G          (  N#00016929' TO DFHEIV0
 19073     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19075     MOVE X'204E233030303136393239' TO DFHEIV0(25:11)
 19076     CALL 'kxdfhei1' USING DFHEIV0,
 19077           DFHEIV1,
 19078           DFHEIV20,
 19079           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 366
* EL156.cbl
 19080           ERACCT-KEY,
 19081           DFHEIV99,
 19082           DFHEIV99,
 19083           DFHEIV99
 19084     SET ADDRESS OF ACCOUNT-MASTER TO
 19085         DFHEIV20
 19086     MOVE EIBRESP  TO WS-RESPONSE
 19087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19088     IF WS-RESP-NORMAL
 19089        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19090        and pi-cert-eff-dt < am-expiration-dt
 19091        and pi-cert-eff-dt >= am-effective-dt
 19092        move am-dcc-product-code to pi-dcc-product-code
 19093        set acct-found to true
 19094     end-if
 19095
 19096     .
 19097 7975-exit.
 19098     exit.
 19099 7980-READ-CERT-UPDATE.
 19100
 19101* EXEC CICS READ
 19102*        DATASET  ('ELCERT')
 19103*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19104*        RIDFLD   (ELCERT-KEY)
 19105*        UPDATE
 19106*    END-EXEC.
 19107     MOVE 'ELCERT' TO DFHEIV1
 19108*    MOVE '&"S        EU         (   #00016948' TO DFHEIV0
 19109     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19110     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19111     MOVE X'2020233030303136393438' TO DFHEIV0(25:11)
 19112     CALL 'kxdfhei1' USING DFHEIV0,
 19113           DFHEIV1,
 19114           DFHEIV20,
 19115           DFHEIV99,
 19116           ELCERT-KEY,
 19117           DFHEIV99,
 19118           DFHEIV99,
 19119           DFHEIV99
 19120     SET ADDRESS OF CERTIFICATE-MASTER TO
 19121         DFHEIV20
 19122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19123
 19124
 19125 7980-EXIT.
 19126      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 367
* EL156.cbl
 19128 8000-LOAD-ERROR-MESSAGES.
 19129     IF PI-PASS-SW = 'C'
 19130        MOVE EMI-LINE1           TO ERMSG1BO
 19131     ELSE
 19132        MOVE EMI-LINE1           TO ERRMSG1O
 19133        MOVE EMI-LINE2           TO ERRMSG2O.
 19134
 19135 8000-EXIT.
 19136     EXIT.
 19137
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 368
* EL156.cbl
 19139
 19140 8010-DMD-ERROR-CHECKS.
 19141     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19142
 19143     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19144         GO TO 8051-ISSUE-ERROR.
 19145
 19146     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19147     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19148     MOVE '3'                    TO DC-OPTION-CODE.
 19149     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19150     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19151         GO TO 8051-ISSUE-ERROR.
 19152
 19153     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19154       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19155                           OR
 19156          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19157           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19158             MOVE ER-0851         TO EMI-ERROR
 19159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19160       END-IF
 19161       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19162             MOVE ER-8147         TO EMI-ERROR
 19163             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19164
 19165     GO TO 8090-EXIT.
 19166
 19167 8051-ISSUE-ERROR.
 19168     MOVE ER-8146            TO EMI-ERROR.
 19169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19170     GO TO 8090-EXIT.
 19171
 19172 8090-EXIT.
 19173      EXIT.
 19174
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 369
* EL156.cbl
 19176 8100-SEND-INITIAL-MAP.
 19177
 19178     MOVE SAVE-DATE              TO RUNDTEAO.
 19179     MOVE EIBTIME                TO TIME-IN.
 19180     MOVE TIME-OUT               TO RUNTIMAO.
 19181     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19182
 19183     IF MAP-NAME = 'EL156A'
 19184        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19185           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19186        END-IF
 19187     END-IF
 19188*    IF MAP-NAME = 'EL156A'
 19189*       IF PI-COMPANY-ID = 'CRI'
 19190*          NEXT SENTENCE
 19191*       ELSE
 19192*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19193
 19194     IF MAP-NAME = 'EL156A'
 19195        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19196           NEXT SENTENCE
 19197        ELSE
 19198           MOVE AL-SADOF TO  PINTA    PINTHA.
 19199
 19200     IF MAP-NAME = 'EL156A'
 19201        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19202            NEXT SENTENCE
 19203        ELSE
 19204           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19205
 19206*    IF MAP-NAME = 'EL156A'
 19207*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19208*          NEXT SENTENCE
 19209*       ELSE
 19210*          MOVE AL-SADOF TO CASHHA CASHA.
 19211
 19212     IF MAP-NAME = 'EL156A'
 19213        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19214           NEXT SENTENCE
 19215        ELSE
 19216           MOVE AL-SADOF        TO  LOANHA
 19217                                    LOANNOA.
 19218
 19219     IF MAP-NAME = 'EL156A'
 19220        MOVE -1                 TO  ENTERPFL
 19221        IF PI-USES-PAID-TO
 19222           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19223           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19224           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19225        ELSE
 19226           NEXT SENTENCE
 19227     ELSE
 19228        IF MAP-NAME = 'EL156B'
 19229           IF PI-USES-PAID-TO
 19230              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19231              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19232
 19233
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 370
* EL156.cbl
 19234* EXEC CICS SEND
 19235*        MAP   (MAP-NAME)
 19236*        MAPSET(MAPSET-NAME)
 19237*        FROM  (EL156AI)
 19238*        ERASE
 19239*        CURSOR
 19240*    END-EXEC.
 19241     MOVE LENGTH OF
 19242      EL156AI
 19243       TO DFHEIV12
 19244     MOVE -1
 19245       TO DFHEIV11
 19246*    MOVE '8$     CT  E    H L F ,   #00017063' TO DFHEIV0
 19247     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19248     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19249     MOVE X'2020233030303137303633' TO DFHEIV0(25:11)
 19250     CALL 'kxdfhei1' USING DFHEIV0,
 19251           MAP-NAME,
 19252           EL156AI,
 19253           DFHEIV12,
 19254           MAPSET-NAME,
 19255           DFHEIV99,
 19256           DFHEIV99,
 19257           DFHEIV99,
 19258           DFHEIV11,
 19259           DFHEIV99,
 19260           DFHEIV99,
 19261           DFHEIV99
 19262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19263
 19264
 19265     GO TO 9100-RETURN-TRAN.
 19266
 19267 8200-SEND-DATAONLY.
 19268
 19269     IF FIRST-ENTRY = 'Y'
 19270         GO TO 8100-SEND-INITIAL-MAP.
 19271
 19272     IF RETURNED-FROM-B = 'Y'
 19273         GO TO 8100-SEND-INITIAL-MAP.
 19274
 19275     MOVE SAVE-DATE              TO RUNDTEAO.
 19276     MOVE EIBTIME                TO TIME-IN.
 19277     MOVE TIME-OUT               TO RUNTIMAO.
 19278
 19279     IF EIBAID = DFHPF11
 19280        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19282        MOVE 'EL001   '          TO RETURNED-FROM
 19283        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19284        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19285        GO TO 8100-SEND-INITIAL-MAP.
 19286
 19287     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19288
 19289     IF MAP-NAME =  'EL156A'
 19290        MOVE -1                 TO  ENTERPFL
 19291        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 371
* EL156.cbl
 19292           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19293           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19294           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19295        ELSE
 19296           NEXT SENTENCE
 19297     ELSE
 19298        IF MAP-NAME = 'EL156B'
 19299           IF PI-USES-PAID-TO
 19300              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19301              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19302
 19303     IF MAP-NAME =  'EL156A'
 19304        IF PI-COMPANY-ID = 'BOA'
 19305            IF PI-INT-RATE NUMERIC
 19306                MOVE PI-INT-RATE TO PINTO.
 19307     IF MAP-NAME = 'EL156A'
 19308        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19309           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19310*          MOVE 'Y'              TO EOBYNO
 19311        END-IF
 19312     END-IF
 19313
 19314
 19315* EXEC CICS SEND
 19316*        MAP   (MAP-NAME)
 19317*        MAPSET(MAPSET-NAME)
 19318*        FROM  (EL156AI)
 19319*        DATAONLY
 19320*        CURSOR
 19321*    END-EXEC.
 19322     MOVE LENGTH OF
 19323      EL156AI
 19324       TO DFHEIV12
 19325     MOVE -1
 19326       TO DFHEIV11
 19327*    MOVE '8$D    CT       H L F ,   #00017120' TO DFHEIV0
 19328     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19329     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19330     MOVE X'2020233030303137313230' TO DFHEIV0(25:11)
 19331     CALL 'kxdfhei1' USING DFHEIV0,
 19332           MAP-NAME,
 19333           EL156AI,
 19334           DFHEIV12,
 19335           MAPSET-NAME,
 19336           DFHEIV99,
 19337           DFHEIV99,
 19338           DFHEIV99,
 19339           DFHEIV11,
 19340           DFHEIV99,
 19341           DFHEIV99,
 19342           DFHEIV99
 19343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19344
 19345
 19346     GO TO 9100-RETURN-TRAN.
 19347
 19348 8300-SEND-TEXT.
 19349
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 372
* EL156.cbl
 19350* EXEC CICS SEND TEXT
 19351*        FROM(LOGOFF-TEXT)
 19352*        LENGTH(LOGOFF-LENGTH)
 19353*        ERASE
 19354*        FREEKB
 19355*    END-EXEC.
 19356*    MOVE '8&      T  E F  H   F -   #00017131' TO DFHEIV0
 19357     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19358     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19359     MOVE X'2020233030303137313331' TO DFHEIV0(25:11)
 19360     CALL 'kxdfhei1' USING DFHEIV0,
 19361           LOGOFF-TEXT,
 19362           LOGOFF-LENGTH,
 19363           DFHEIV99,
 19364           DFHEIV99,
 19365           DFHEIV99,
 19366           DFHEIV99,
 19367           DFHEIV99,
 19368           DFHEIV99,
 19369           DFHEIV99,
 19370           DFHEIV99,
 19371           DFHEIV99,
 19372           DFHEIV99
 19373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19374
 19375
 19376
 19377* EXEC CICS RETURN
 19378*    END-EXEC.
 19379*    MOVE '.(                    ''   #00017138' TO DFHEIV0
 19380     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19382     MOVE X'2020233030303137313338' TO DFHEIV0(25:11)
 19383     CALL 'kxdfhei1' USING DFHEIV0,
 19384           DFHEIV99,
 19385           DFHEIV99,
 19386           DFHEIV99,
 19387           DFHEIV99,
 19388           DFHEIV99,
 19389           DFHEIV99
 19390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19391
 19392
 19393 8500-FILE-NOTOPEN.
 19394     IF FILE-SWITCH = 'MSTR'
 19395         MOVE ER-0154            TO EMI-ERROR.
 19396     IF FILE-SWITCH = 'TRLR'
 19397         MOVE ER-0172            TO EMI-ERROR.
 19398     IF FILE-SWITCH = 'CERT'
 19399         MOVE ER-0169            TO EMI-ERROR.
 19400     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19401                      'PROC' OR 'STAT'
 19402         MOVE ER-0042            TO EMI-ERROR.
 19403     IF FILE-SWITCH = 'ACTQ'
 19404         MOVE ER-0338            TO EMI-ERROR.
 19405     IF FILE-SWITCH = 'ACCT'
 19406         MOVE ER-0168            TO EMI-ERROR.
 19407
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 373
* EL156.cbl
 19408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19409     MOVE -1                     TO PMTTYPEL.
 19410
 19411     IF FIRST-ENTRY = 'Y'
 19412         GO TO 8100-SEND-INITIAL-MAP.
 19413
 19414     GO TO 8200-SEND-DATAONLY.
 19415
 19416 8600-PGRM-NOT-FOUND.
 19417
 19418     MOVE ER-0923                TO EMI-ERROR.
 19419     MOVE -1                     TO ENTPFBL.
 19420     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19421
 19422     IF FIRST-ENTRY = 'Y'
 19423         GO TO 8100-SEND-INITIAL-MAP
 19424     ELSE
 19425         GO TO 8200-SEND-DATAONLY.
 19426
 19427 8800-UNAUTHORIZED-ACCESS.
 19428     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19429     GO TO 8300-SEND-TEXT.
 19430
 19431 8810-PF23.
 19432     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19433     MOVE XCTL-005               TO PGM-NAME.
 19434     GO TO 9300-XCTL.
 19435
 19436 8820-PF7-8.
 19437     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19438     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19439                                    PI-SAVED-PROGRAM-2
 19440                                    PI-SAVED-PROGRAM-3
 19441                                    PI-SAVED-PROGRAM-4
 19442                                    PI-SAVED-PROGRAM-5
 19443                                    PI-SAVED-PROGRAM-6
 19444                                    PI-RETURN-TO-PROGRAM.
 19445     IF EIBAID = DFHPF8
 19446        MOVE XCTL-132            TO PGM-NAME
 19447     ELSE
 19448        MOVE XCTL-130            TO PGM-NAME.
 19449
 19450     GO TO 9300-XCTL.
 19451
 19452 9100-RETURN-TRAN.
 19453     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19454     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19455
 19456
 19457* EXEC CICS RETURN
 19458*        TRANSID(TRANS-ID)
 19459*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19460*        LENGTH(PI-COMM-LENGTH)
 19461*    END-EXEC.
 19462*    MOVE '.(CT                  ''   #00017204' TO DFHEIV0
 19463     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19464     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19465     MOVE X'2020233030303137323034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 374
* EL156.cbl
 19466     CALL 'kxdfhei1' USING DFHEIV0,
 19467           TRANS-ID,
 19468           PROGRAM-INTERFACE-BLOCK,
 19469           PI-COMM-LENGTH,
 19470           DFHEIV99,
 19471           DFHEIV99,
 19472           DFHEIV99
 19473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19474
 19475
 19476 9200-RETURN-MAIN-MENU.
 19477     MOVE XCTL-126               TO PGM-NAME.
 19478     GO TO 9300-XCTL.
 19479
 19480 9300-XCTL.
 19481
 19482* EXEC CICS XCTL
 19483*        PROGRAM(PGM-NAME)
 19484*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19485*        LENGTH(PI-COMM-LENGTH)
 19486*    END-EXEC.
 19487*    MOVE '.$C                   %   #00017215' TO DFHEIV0
 19488     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19489     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19490     MOVE X'2020233030303137323135' TO DFHEIV0(25:11)
 19491     CALL 'kxdfhei1' USING DFHEIV0,
 19492           PGM-NAME,
 19493           PROGRAM-INTERFACE-BLOCK,
 19494           PI-COMM-LENGTH,
 19495           DFHEIV99
 19496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19497
 19498
 19499 9400-CLEAR.
 19500     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19501     GO TO 9300-XCTL.
 19502
 19503 9500-PF12.
 19504     MOVE XCTL-010               TO PGM-NAME.
 19505     GO TO 9300-XCTL.
 19506
 19507 9700-LINK-DATE-CONVERT.
 19508     MOVE LINK-ELDATCV           TO PGM-NAME.
 19509
 19510* EXEC CICS LINK
 19511*        PROGRAM   (PGM-NAME)
 19512*        COMMAREA  (DATE-CONVERSION-DATA)
 19513*        LENGTH    (DC-COMM-LENGTH)
 19514*    END-EXEC.
 19515*    MOVE '."C                   (   #00017231' TO DFHEIV0
 19516     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19518     MOVE X'2020233030303137323331' TO DFHEIV0(25:11)
 19519     CALL 'kxdfhei1' USING DFHEIV0,
 19520           PGM-NAME,
 19521           DATE-CONVERSION-DATA,
 19522           DC-COMM-LENGTH,
 19523           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 375
* EL156.cbl
 19524           DFHEIV99,
 19525           DFHEIV99,
 19526           DFHEIV99
 19527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19528
 19529
 19530 9700-EXIT.
 19531     EXIT.
 19532
 19533 9800-LINK-REM-TERM.
 19534     MOVE LINK-REMTERM TO PGM-NAME.
 19535
 19536
 19537* EXEC CICS LINK
 19538*        PROGRAM   (PGM-NAME)
 19539*        COMMAREA  (CALCULATION-PASS-AREA)
 19540*        LENGTH    (CP-COMM-LENGTH)
 19541*    END-EXEC.
 19542*    MOVE '."C                   (   #00017243' TO DFHEIV0
 19543     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19545     MOVE X'2020233030303137323433' TO DFHEIV0(25:11)
 19546     CALL 'kxdfhei1' USING DFHEIV0,
 19547           PGM-NAME,
 19548           CALCULATION-PASS-AREA,
 19549           CP-COMM-LENGTH,
 19550           DFHEIV99,
 19551           DFHEIV99,
 19552           DFHEIV99,
 19553           DFHEIV99
 19554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19555
 19556
 19557 9800-EXIT.
 19558     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 376
* EL156.cbl
 19560 9830-DMD-REMAINING-TERM.
 19561
 19562     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19563         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19564
 19565     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19566                              CM-PMT-EXTENSION-DAYS.
 19567
 19568     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19569                                  CL-NO-OF-DAYS-PAID.
 19570
 19571     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19572         GIVING W-REM REMAINDER W-REM-DAYS.
 19573
 19574     MOVE W-REM                  TO WST-REM.
 19575
 19576     IF W-REM-DAYS > ZEROS
 19577         MOVE '/'                TO WST-SLASH
 19578         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19579     ELSE
 19580         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19581
 19582 9830-EXIT.
 19583     EXIT.
 19584
 19585 9870-OUTPUT-ACTIVITY-RECORD.
 19586
 19587
 19588* EXEC CICS GETMAIN
 19589*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19590*         LENGTH(25)
 19591*         INITIMG(WS-BLANK)
 19592*    END-EXEC.
 19593     MOVE 25
 19594       TO DFHEIV11
 19595*    MOVE ',"IL                  $   #00017279' TO DFHEIV0
 19596     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19597     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19598     MOVE X'2020233030303137323739' TO DFHEIV0(25:11)
 19599     CALL 'kxdfhei1' USING DFHEIV0,
 19600           DFHEIV20,
 19601           DFHEIV11,
 19602           WS-BLANK
 19603     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19604         DFHEIV20
 19605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19606
 19607
 19608     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19609     MOVE ELMSTR-KEY             TO DA-KEY.
 19610     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19611
 19612     IF PI-PMTTYPE EQUAL '7'
 19613         MOVE 'V'                TO DA-RECORD-TYPE
 19614     ELSE
 19615         MOVE 'P'                TO DA-RECORD-TYPE.
 19616
 19617
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 377
* EL156.cbl
 19618* EXEC CICS HANDLE CONDITION
 19619*         NOTOPEN(9870-NOTOPEN)
 19620*         DUPREC(9870-EXIT)
 19621*    END-EXEC.
 19622*    MOVE '"$J%                  ! B #00017294' TO DFHEIV0
 19623     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19625     MOVE X'4220233030303137323934' TO DFHEIV0(25:11)
 19626     CALL 'kxdfhei1' USING DFHEIV0
 19627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19628
 19629
 19630
 19631* EXEC CICS WRITE
 19632*         DATASET('DLYACTV')
 19633*         RIDFLD(DA-KEY)
 19634*         FROM(DAILY-ACTIVITY-RECORD)
 19635*         LENGTH(25)
 19636*    END-EXEC.
 19637     MOVE 'DLYACTV' TO DFHEIV1
 19638     MOVE 25
 19639       TO DFHEIV11
 19640*    MOVE '&$ L                  ''   #00017299' TO DFHEIV0
 19641     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19643     MOVE X'2020233030303137323939' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0,
 19645           DFHEIV1,
 19646           DAILY-ACTIVITY-RECORD,
 19647           DFHEIV11,
 19648           DA-KEY,
 19649           DFHEIV99,
 19650           DFHEIV99
 19651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19652
 19653     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19654     GO TO 9870-EXIT.
 19655
 19656 9870-NOTOPEN.
 19657
 19658     MOVE '2955'                 TO EMI-ERROR.
 19659     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19660
 19661 9870-EXIT.
 19662     EXIT.
 19663
 19664 9900-ERROR-FORMAT.
 19665
 19666     IF EMI-ERROR = ER-0923
 19667         MOVE PGM-NAME           TO W-CALLED-NAME.
 19668
 19669     MOVE LINK-001      TO PGM-NAME.
 19670     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19671
 19672
 19673* EXEC CICS LINK
 19674*        PROGRAM (PGM-NAME)
 19675*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 378
* EL156.cbl
 19676*        LENGTH  (EMI-COMM-LENGTH)
 19677*    END-EXEC.
 19678*    MOVE '."C                   (   #00017324' TO DFHEIV0
 19679     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19680     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19681     MOVE X'2020233030303137333234' TO DFHEIV0(25:11)
 19682     CALL 'kxdfhei1' USING DFHEIV0,
 19683           PGM-NAME,
 19684           ERROR-MESSAGE-INTERFACE-BLOCK,
 19685           EMI-COMM-LENGTH,
 19686           DFHEIV99,
 19687           DFHEIV99,
 19688           DFHEIV99,
 19689           DFHEIV99
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693     IF EMI-ERROR = ER-0923
 19694         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19695
 19696 9900-EXIT.
 19697     EXIT.
 19698
 19699 9990-ABEND.
 19700     MOVE LINK-004               TO PGM-NAME.
 19701     MOVE DFHEIBLK               TO EMI-LINE1.
 19702
 19703* EXEC CICS LINK
 19704*        PROGRAM   (PGM-NAME)
 19705*        COMMAREA  (EMI-LINE1)
 19706*        LENGTH    (64)
 19707*    END-EXEC.
 19708     MOVE 64
 19709       TO DFHEIV11
 19710*    MOVE '."C                   (   #00017339' TO DFHEIV0
 19711     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19713     MOVE X'2020233030303137333339' TO DFHEIV0(25:11)
 19714     CALL 'kxdfhei1' USING DFHEIV0,
 19715           PGM-NAME,
 19716           EMI-LINE1,
 19717           DFHEIV11,
 19718           DFHEIV99,
 19719           DFHEIV99,
 19720           DFHEIV99,
 19721           DFHEIV99
 19722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19723
 19724
 19725     MOVE 'EL156A'               TO  MAP-NAME.
 19726     MOVE LOW-VALUES             TO  EL156AO.
 19727     GO TO 8100-SEND-INITIAL-MAP.
 19728
 19729 9995-SECURITY-VIOLATION.
 19730*    COPY ELCSCTP.
 19731******************************************************************
 19732*                                                                *
 19733*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 379
* EL156.cbl
 19734*                            VMOD=2.001                          *
 19735*                                                                *
 19736*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 19737******************************************************************
 19738
 19739
 19740     MOVE EIBDATE          TO SM-JUL-DATE.
 19741     MOVE EIBTRMID         TO SM-TERMID.
 19742     MOVE THIS-PGM         TO SM-PGM.
 19743     MOVE EIBTIME          TO TIME-IN.
 19744     MOVE TIME-OUT         TO SM-TIME.
 19745     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 19746
 19747
 19748* EXEC CICS LINK
 19749*         PROGRAM  ('EL003')
 19750*         COMMAREA (SECURITY-MESSAGE)
 19751*         LENGTH   (80)
 19752*    END-EXEC.
 19753     MOVE 'EL003' TO DFHEIV1
 19754     MOVE 80
 19755       TO DFHEIV11
 19756*    MOVE '."C                   (   #00017367' TO DFHEIV0
 19757     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19758     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19759     MOVE X'2020233030303137333637' TO DFHEIV0(25:11)
 19760     CALL 'kxdfhei1' USING DFHEIV0,
 19761           DFHEIV1,
 19762           SECURITY-MESSAGE,
 19763           DFHEIV11,
 19764           DFHEIV99,
 19765           DFHEIV99,
 19766           DFHEIV99,
 19767           DFHEIV99
 19768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19769
 19770
 19771******************************************************************
 19772
 19773
 19774
 19775 9999-DFHBACK SECTION.
 19776     MOVE '9%                    "   ' TO DFHEIV0
 19777     MOVE 'EL156' TO DFHEIV1
 19778     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19779     GOBACK.
 19780 9999-DFHEXIT.
 19781     IF DFHEIGDJ EQUAL 0001
 19782         NEXT SENTENCE
 19783     ELSE IF DFHEIGDJ EQUAL 2
 19784         GO TO 9990-ABEND,
 19785               8600-PGRM-NOT-FOUND,
 19786               0400-FIRST-TIME,
 19787               6180-DUPREC,
 19788               9990-ABEND
 19789         DEPENDING ON DFHEIGDI
 19790     ELSE IF DFHEIGDJ EQUAL 3
 19791         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 380
* EL156.cbl
 19792               0380-CLAIM-END-FILE
 19793         DEPENDING ON DFHEIGDI
 19794     ELSE IF DFHEIGDJ EQUAL 4
 19795         GO TO 0380-CLAIM-END-FILE,
 19796               0380-CLAIM-END-FILE
 19797         DEPENDING ON DFHEIGDI
 19798     ELSE IF DFHEIGDJ EQUAL 5
 19799         GO TO 0800-EXIT
 19800         DEPENDING ON DFHEIGDI
 19801     ELSE IF DFHEIGDJ EQUAL 6
 19802         GO TO 1950-NOT-FOUND,
 19803               1950-NOT-FOUND
 19804         DEPENDING ON DFHEIGDI
 19805     ELSE IF DFHEIGDJ EQUAL 7
 19806         GO TO 1950-NOT-FOUND
 19807         DEPENDING ON DFHEIGDI
 19808     ELSE IF DFHEIGDJ EQUAL 8
 19809         GO TO 1950-NOT-FOUND,
 19810               1950-NOT-FOUND
 19811         DEPENDING ON DFHEIGDI
 19812     ELSE IF DFHEIGDJ EQUAL 9
 19813         GO TO 1166-END-CHECK,
 19814               1166-END-CHECK
 19815         DEPENDING ON DFHEIGDI
 19816     ELSE IF DFHEIGDJ EQUAL 10
 19817         GO TO 1950-NOT-FOUND,
 19818               1950-NOT-FOUND
 19819         DEPENDING ON DFHEIGDI
 19820     ELSE IF DFHEIGDJ EQUAL 11
 19821         GO TO 1950-NOT-FOUND,
 19822               1950-NOT-FOUND
 19823         DEPENDING ON DFHEIGDI
 19824     ELSE IF DFHEIGDJ EQUAL 12
 19825         GO TO 1950-NOT-FOUND
 19826         DEPENDING ON DFHEIGDI
 19827     ELSE IF DFHEIGDJ EQUAL 13
 19828         GO TO 3600-CONTINUE
 19829         DEPENDING ON DFHEIGDI
 19830     ELSE IF DFHEIGDJ EQUAL 14
 19831         GO TO 5300-NOTE-NOT-FOUND
 19832         DEPENDING ON DFHEIGDI
 19833     ELSE IF DFHEIGDJ EQUAL 15
 19834         GO TO 6065-NOT-FOUND
 19835         DEPENDING ON DFHEIGDI
 19836     ELSE IF DFHEIGDJ EQUAL 16
 19837         GO TO 6068-ACCT-NOT-FND
 19838         DEPENDING ON DFHEIGDI
 19839     ELSE IF DFHEIGDJ EQUAL 17
 19840         GO TO 6074-GET-COMP-DATA
 19841         DEPENDING ON DFHEIGDI
 19842     ELSE IF DFHEIGDJ EQUAL 18
 19843         GO TO 6170-WRITE
 19844         DEPENDING ON DFHEIGDI
 19845     ELSE IF DFHEIGDJ EQUAL 19
 19846         GO TO 6180-DUPREC
 19847         DEPENDING ON DFHEIGDI
 19848     ELSE IF DFHEIGDJ EQUAL 20
 19849         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 07-Nov-13 11:10 Page 381
* EL156.cbl
 19850         DEPENDING ON DFHEIGDI
 19851     ELSE IF DFHEIGDJ EQUAL 21
 19852         GO TO 6185-DUPREC
 19853         DEPENDING ON DFHEIGDI
 19854     ELSE IF DFHEIGDJ EQUAL 22
 19855         GO TO 6720-BUILD-NEW-RECORD
 19856         DEPENDING ON DFHEIGDI
 19857     ELSE IF DFHEIGDJ EQUAL 23
 19858         GO TO 6900-BUILD-ARCHIVE-HEADER,
 19859               6900-BUILD-ARCHIVE-HEADER
 19860         DEPENDING ON DFHEIGDI
 19861     ELSE IF DFHEIGDJ EQUAL 24
 19862         GO TO 7010-BUILD-MAP
 19863         DEPENDING ON DFHEIGDI
 19864     ELSE IF DFHEIGDJ EQUAL 25
 19865         GO TO 7100-SHOW-RECORD-NOT-FOUND
 19866         DEPENDING ON DFHEIGDI
 19867     ELSE IF DFHEIGDJ EQUAL 26
 19868         GO TO 7160-DUPREC
 19869         DEPENDING ON DFHEIGDI
 19870     ELSE IF DFHEIGDJ EQUAL 27
 19871         GO TO 7200-EXIT,
 19872               7200-EXIT
 19873         DEPENDING ON DFHEIGDI
 19874     ELSE IF DFHEIGDJ EQUAL 28
 19875         GO TO 7400-NOT-FOUND
 19876         DEPENDING ON DFHEIGDI
 19877     ELSE IF DFHEIGDJ EQUAL 29
 19878         GO TO 7590-END,
 19879               7590-END
 19880         DEPENDING ON DFHEIGDI
 19881     ELSE IF DFHEIGDJ EQUAL 30
 19882         GO TO 7699-EXIT
 19883         DEPENDING ON DFHEIGDI
 19884     ELSE IF DFHEIGDJ EQUAL 31
 19885         GO TO 5300-NOTE-NOT-FOUND
 19886         DEPENDING ON DFHEIGDI
 19887     ELSE IF DFHEIGDJ EQUAL 32
 19888         GO TO 7800-COMP-NOTFND
 19889         DEPENDING ON DFHEIGDI
 19890     ELSE IF DFHEIGDJ EQUAL 33
 19891         GO TO 7920-NOT-FOUND
 19892         DEPENDING ON DFHEIGDI
 19893     ELSE IF DFHEIGDJ EQUAL 34
 19894         GO TO 9870-NOTOPEN,
 19895               9870-EXIT
 19896         DEPENDING ON DFHEIGDI.
 19897     MOVE '9%                    "   ' TO DFHEIV0
 19898     MOVE 'EL156' TO DFHEIV1
 19899     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19900     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12060     Code:       73287
