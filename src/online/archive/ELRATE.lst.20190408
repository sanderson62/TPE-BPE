* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   193******************************************************************
   194
   195 01  NET-PAY-WORK-AREA.
   196     12  OPTION-SW               PIC X   VALUE 'X'.
   197        88  NPO-STD         VALUE SPACE.
   198        88  NPO-ALT         VALUE 'A'.
   199        88  NPO-SIMPLE      VALUE 'S'.
   200        88  NPO-2MO         VALUE 'I'.
   201        88  NPO-3MO         VALUE 'J'.
   202        88  NPO-4MO         VALUE 'K'.
   203        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   204        88  NPO-TRUNC-0     VALUE 'T'.
   205        88  NPO-TRUNC-1     VALUE 'U'.
   206        88  NPO-TRUNC-2     VALUE 'V'.
   207        88  NPO-TRUNC-3     VALUE 'W'.
   208        88  NPO-TRUNC-4     VALUE 'X'.
   209        88  NPO-REFUND      VALUE 'R'.
   210        88  NPO-PRUDENTIAL  VALUE 'P'.
   211
   212     12  TYPE-SW             PIC X   VALUE 'N'.
   213        88  NET-STD             VALUE 'N'.
   214        88  NET-SMP             VALUE 'S'.
   215
   216     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   217        88  NP-RATING           VALUE '1'.
   218        88  NP-REFUND           VALUE '2'.
   219        88  NP-REMAIN-AMT       VALUE '3'.
   220
   221     12  COMP-3-WORK-AREA         COMP-3.
   222         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   223         16  V               PIC SV9(13)       VALUE +.0.
   224         16  J               PIC SV9(9)        VALUE +0.
   225         16  K               PIC SV9(9)        VALUE +0.
   226         16  I               PIC SV9(10)       VALUE +.0.
   227         16  D               PIC S9(5)         VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   6
* ELRATE.cbl
   228         16  APR100          PIC SV9(9)        VALUE +.0.
   229         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   230         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   232         16  pema            pic s9(2)v9(15)   value +0.
   233         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   234         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   235         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   236         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   237         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   238         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   239         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   240         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   241         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   242         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   243         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   244         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   246         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   247         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   248         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   251         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   252         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   253         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   254         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   255         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   256         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   257         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   258         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   259         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   260         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   261         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   262         16  K1              PIC S999          VALUE +1.
   263         16  K12             PIC S999          VALUE +12.
   264         16  K100            PIC S999          VALUE +100.
   265         16  K1000           PIC S9(7)         VALUE +1000.
   266         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   267         16  Y REDEFINES NC-LR
   268                             PIC S99V9(5).
   269         16  TI              PIC S999V9(5)     VALUE +0.
   270         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   271         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   272         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   273         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   274         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   275         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   276         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   277         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   278
   279         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   280         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   281         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   282         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   283         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   284         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   285         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   7
* ELRATE.cbl
   286         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   287         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   288         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   289         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   290         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   291         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   292
   293         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   294
   295         16  ORIGINAL-TERM   PIC S999.
   296         16  M              REDEFINES ORIGINAL-TERM
   297                             PIC S999.
   298
   299         16  REMAINING-TERM  PIC S999.
   300         16  R              REDEFINES REMAINING-TERM
   301                             PIC S999.
   302
   303         16  LOAN-TERM       PIC S999.
   304         16  N              REDEFINES LOAN-TERM
   305                             PIC S999.
   306
   307         16  EXPIRED-TERM    PIC S999.
   308         16  E              REDEFINES EXPIRED-TERM
   309                             PIC S999.
   310
   311         16  PRUDENTIAL-WORK-AMT
   312                             PIC S9(7)V9(8).
   313         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   314                             PIC S9(7)V9(8).
   315
   316         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   317         16  VX              PIC S9V9(13)      VALUE +0.0.
   318         16  SV              PIC S9V9(13)      VALUE +0.0.
   319         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   320         16  SX              PIC S9V9(13)      VALUE +0.0.
   321         16  SE              PIC S9V9(10)      VALUE +0.0.
   322         16  N2              PIC S9(7)         VALUE +0.
   323         16  N3              PIC S9(7)         VALUE +0.
   324         16  K-I             PIC S9V9(8)       VALUE +0.0.
   325
   326     12  BINARY-WORK-AREA        COMP.
   327         16  X1              PIC S999        VALUE +0.
   328         16  X2              PIC S999        VALUE +0.
   329         16  MAX-X           PIC S9(5)       VALUE +0.
   330         16  B1              PIC S9(5)       VALUE +1.
   331         16  LINDX           PIC S999        VALUE ZEROS.
   332         16  AHNDX           PIC S999        VALUE ZEROS.
   333
   334     12  CSO-RATE-WORK-AREAS.
   335         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   336         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   337         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   338     12  WS-WORK-MISC.
   339         16  ws-extra-pmts       pic s999         comp-3.
   340         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   341         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   342*        16  WS-AGE              PIC 99           VALUE ZEROS.
   343         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   8
* ELRATE.cbl
   344         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   345         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   346         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   347         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   348         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   349         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   350         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   351         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   352         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   353         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   354         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   355******************************************************************
   356
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page   9
* ELRATE.cbl
   358*                            COPY ELCDATE.
   359******************************************************************
   360*                                                                *
   361*                                                                *
   362*                            ELCDATE.                            *
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   364*                            VMOD=2.003
   365*                                                                *
   366*                                                                *
   367*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   368*                 LENGTH = 200                                   *
   369******************************************************************
   370
   371 01  DATE-CONVERSION-DATA.
   372     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   373     12  DC-OPTION-CODE                PIC X.
   374         88  BIN-TO-GREG                VALUE ' '.
   375         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   376         88  EDIT-GREG-TO-BIN           VALUE '2'.
   377         88  YMD-GREG-TO-BIN            VALUE '3'.
   378         88  MDY-GREG-TO-BIN            VALUE '4'.
   379         88  JULIAN-TO-BIN              VALUE '5'.
   380         88  BIN-PLUS-ELAPSED           VALUE '6'.
   381         88  FIND-CENTURY               VALUE '7'.
   382         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   383         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   384         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   385         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   386         88  JULIAN-TO-BIN-3            VALUE 'C'.
   387         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   388         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   389         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   390         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   391         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   392         88  CHECK-LEAP-YEAR            VALUE 'H'.
   393         88  BIN-3-TO-GREG              VALUE 'I'.
   394         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   395         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   396         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   397         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   398         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   399         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   400         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   401         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   402         88  THREE-CHARACTER-BIN
   403                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   404         88  GREGORIAN-TO-BIN
   405                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   406         88  BIN-TO-GREGORIAN
   407                  VALUES ' ' '1' 'I' '8' 'G'.
   408         88  JULIAN-TO-BINARY
   409                  VALUES '5' 'C' 'E' 'F'.
   410     12  DC-ERROR-CODE                 PIC X.
   411         88  NO-CONVERSION-ERROR        VALUE ' '.
   412         88  DATE-CONVERSION-ERROR
   413                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   414         88  DATE-IS-ZERO               VALUE '1'.
   415         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  10
* ELRATE.cbl
   416         88  DATE-IS-INVALID            VALUE '3'.
   417         88  DATE1-GREATER-DATE2        VALUE '4'.
   418         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   419         88  DATE-INVALID-OPTION        VALUE '9'.
   420         88  INVALID-CENTURY            VALUE 'A'.
   421         88  ONLY-CENTURY               VALUE 'B'.
   422         88  ONLY-LEAP-YEAR             VALUE 'C'.
   423         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   424     12  DC-END-OF-MONTH               PIC X.
   425         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   426     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   427         88  USE-NORMAL-PROCESS         VALUE ' '.
   428         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   429         88  ADJUST-UP-100-YRS          VALUE '2'.
   430     12  FILLER                        PIC X.
   431     12  DC-CONVERSION-DATES.
   432         16  DC-BIN-DATE-1             PIC XX.
   433         16  DC-BIN-DATE-2             PIC XX.
   434         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   435         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   436                       DC-GREG-DATE-1-EDIT.
   437             20  DC-EDIT1-MONTH        PIC 99.
   438             20  SLASH1-1              PIC X.
   439             20  DC-EDIT1-DAY          PIC 99.
   440             20  SLASH1-2              PIC X.
   441             20  DC-EDIT1-YEAR         PIC 99.
   442         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   443         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   444                     DC-GREG-DATE-2-EDIT.
   445             20  DC-EDIT2-MONTH        PIC 99.
   446             20  SLASH2-1              PIC X.
   447             20  DC-EDIT2-DAY          PIC 99.
   448             20  SLASH2-2              PIC X.
   449             20  DC-EDIT2-YEAR         PIC 99.
   450         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   451         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   452                     DC-GREG-DATE-1-YMD.
   453             20  DC-YMD-YEAR           PIC 99.
   454             20  DC-YMD-MONTH          PIC 99.
   455             20  DC-YMD-DAY            PIC 99.
   456         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   457         16  DC-GREG-DATE-1-MDY-R REDEFINES
   458                      DC-GREG-DATE-1-MDY.
   459             20  DC-MDY-MONTH          PIC 99.
   460             20  DC-MDY-DAY            PIC 99.
   461             20  DC-MDY-YEAR           PIC 99.
   462         16  DC-GREG-DATE-1-ALPHA.
   463             20  DC-ALPHA-MONTH        PIC X(10).
   464             20  DC-ALPHA-DAY          PIC 99.
   465             20  FILLER                PIC XX.
   466             20  DC-ALPHA-CENTURY.
   467                 24 DC-ALPHA-CEN-N     PIC 99.
   468             20  DC-ALPHA-YEAR         PIC 99.
   469         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   470         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   471         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   472         16  DC-JULIAN-DATE            PIC 9(05).
   473         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  11
* ELRATE.cbl
   474                                       PIC 9(05).
   475         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   476             20  DC-JULIAN-YEAR        PIC 99.
   477             20  DC-JULIAN-DAYS        PIC 999.
   478         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   479         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   480         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   481     12  DATE-CONVERSION-VARIBLES.
   482         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   483         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   484             20  FILLER                PIC 9(3).
   485             20  HOLD-CEN-1-CCYY.
   486                 24  HOLD-CEN-1-CC     PIC 99.
   487                 24  HOLD-CEN-1-YY     PIC 99.
   488             20  HOLD-CEN-1-MO         PIC 99.
   489             20  HOLD-CEN-1-DA         PIC 99.
   490         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   491             20  HOLD-CEN-1-R-MO       PIC 99.
   492             20  HOLD-CEN-1-R-DA       PIC 99.
   493             20  HOLD-CEN-1-R-CCYY.
   494                 24  HOLD-CEN-1-R-CC   PIC 99.
   495                 24  HOLD-CEN-1-R-YY   PIC 99.
   496             20  FILLER                PIC 9(3).
   497         16  HOLD-CENTURY-1-X.
   498             20  FILLER                PIC X(3)  VALUE SPACES.
   499             20  HOLD-CEN-1-X-CCYY.
   500                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   501                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   502             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   503             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   504         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   505             20  HOLD-CEN-1-R-X-MO     PIC XX.
   506             20  HOLD-CEN-1-R-X-DA     PIC XX.
   507             20  HOLD-CEN-1-R-X-CCYY.
   508                 24  HOLD-CEN-1-R-X-CC PIC XX.
   509                 24  HOLD-CEN-1-R-X-YY PIC XX.
   510             20  FILLER                PIC XXX.
   511         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   512         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   513         16  DC-JULIAN-DATE-1          PIC 9(07).
   514         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   515             20  DC-JULIAN-1-CCYY.
   516                 24  DC-JULIAN-1-CC    PIC 99.
   517                 24  DC-JULIAN-1-YR    PIC 99.
   518             20  DC-JULIAN-DA-1        PIC 999.
   519         16  DC-JULIAN-DATE-2          PIC 9(07).
   520         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   521             20  DC-JULIAN-2-CCYY.
   522                 24  DC-JULIAN-2-CC    PIC 99.
   523                 24  DC-JULIAN-2-YR    PIC 99.
   524             20  DC-JULIAN-DA-2        PIC 999.
   525         16  DC-GREG-DATE-A-EDIT.
   526             20  DC-EDITA-MONTH        PIC 99.
   527             20  SLASHA-1              PIC X VALUE '/'.
   528             20  DC-EDITA-DAY          PIC 99.
   529             20  SLASHA-2              PIC X VALUE '/'.
   530             20  DC-EDITA-CCYY.
   531                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  12
* ELRATE.cbl
   532                 24  DC-EDITA-YEAR     PIC 99.
   533         16  DC-GREG-DATE-B-EDIT.
   534             20  DC-EDITB-MONTH        PIC 99.
   535             20  SLASHB-1              PIC X VALUE '/'.
   536             20  DC-EDITB-DAY          PIC 99.
   537             20  SLASHB-2              PIC X VALUE '/'.
   538             20  DC-EDITB-CCYY.
   539                 24  DC-EDITB-CENT     PIC 99.
   540                 24  DC-EDITB-YEAR     PIC 99.
   541         16  DC-GREG-DATE-CYMD         PIC 9(08).
   542         16  DC-GREG-DATE-CYMD-R REDEFINES
   543                              DC-GREG-DATE-CYMD.
   544             20  DC-CYMD-CEN           PIC 99.
   545             20  DC-CYMD-YEAR          PIC 99.
   546             20  DC-CYMD-MONTH         PIC 99.
   547             20  DC-CYMD-DAY           PIC 99.
   548         16  DC-GREG-DATE-MDCY         PIC 9(08).
   549         16  DC-GREG-DATE-MDCY-R REDEFINES
   550                              DC-GREG-DATE-MDCY.
   551             20  DC-MDCY-MONTH         PIC 99.
   552             20  DC-MDCY-DAY           PIC 99.
   553             20  DC-MDCY-CEN           PIC 99.
   554             20  DC-MDCY-YEAR          PIC 99.
   555    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   556        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   557    12  DC-EL310-DATE                  PIC X(21).
   558    12  FILLER                         PIC X(28).
   559
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  13
* ELRATE.cbl
   561*                            COPY ELCCALC.
   562******************************************************************
   563*                                                                *
   564*                           ELCCALC.                            *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.025                          *
   567*                                                                *
   568*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   569*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   570*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   571*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   572*                                                                *
   573*  PASSED TO ELRTRM                                              *
   574*  -----------------                                             *
   575*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   576*  ORIGINAL TERM                                                 *
   577*  BEGINNING DATE                                                *
   578*  ENDING DATE                                                   *
   579*  COMPANY I.D.                                                  *
   580*  ACCOUNT MASTER USER FIELD                                     *
   581*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   582*  FREE LOOK DAYS                                                *
   583*                                                                *
   584*  RETURNED FROM ELRTRM                                          *
   585*  ---------------------                                         *
   586*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   587*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   588*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   589*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   590*----------------------------------------------------------------*
   591*  PASSED TO ELRAMT                                              *
   592*  ----------------                                              *
   593*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   594*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   595*  ORIGINAL AMOUNT                                               *
   596*  ALTERNATE BENEFIT (BALLON)                                    *
   597*  A.P.R. - NET PAY ONLY                                         *
   598*  METHOD
   599*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   600*  COMPANY I.D.                                                  *
   601*  BENEFIT TYPE                                                  *
   602*                                                                *
   603*  RETURNED FROM ELRAMT                                          *
   604*  --------------------                                          *
   605*  REMAINING AMOUNT 1 - CURRENT                                  *
   606*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   607*  REMAINING AMOUNT FACTOR
   608*----------------------------------------------------------------*
   609*  PASSED TO ELRESV                                              *
   610*  -----------------                                             *
   611*  CERTIFICATE EFFECTIVE DATE                                    *
   612*  VALUATION DATE                                                *
   613*  PAID THRU DATE                                                *
   614*  BENEFIT                                                       *
   615*  INCURRED DATE                                                 *
   616*  REPORTED DATE                                                 *
   617*  ISSUE AGE                                                     *
   618*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  14
* ELRATE.cbl
   619*  CDT PERCENT                                                   *
   620*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   621* *CLAIM TYPE (LIFE, A/H)                                        *
   622* *REMAINING BENEFIT (FROM ELRAMT)                               *
   623* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   624*                                                                *
   625*  RETURNED FROM ELRESV                                          *
   626*  --------------------                                          *
   627*  CDT TABLE USED                                                *
   628*  CDT FACTOR USED                                               *
   629*  PAY TO CURRENT RESERVE                                        *
   630*  I.B.N.R. - A/H ONLY                                           *
   631*  FUTURE (ACCRUED) AH ONLY                                      *
   632*----------------------------------------------------------------*
   633*  PASSED TO ELRATE                                              *
   634*  ----------------                                              *
   635*  CERT ISSUE DATE                                               *
   636*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   637*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   638*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   639*  STATE CODE (CLIENT DEFINED)                                   *
   640*  STATE CODE (STANDARD P.O. ABBRV)                              *
   641*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   642*  DEVIATION CODE                                                *
   643*  ISSUE AGE                                                     *
   644*  ORIGINAL BENEFIT AMOUNT                                       *
   645*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   646*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   647*  BENEFIT KIND (LIFE OR A/H)                                    *
   648*  A.P.R.                                                        *
   649*  METHOD
   650*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   651*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   652*  COMPANY I.D. (3 CHARACTER)                                    *
   653*  BENEFIT CODE                                                  *
   654*  BENEFIT OVERRIDE CODE                                         *
   655*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   656*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   657*  JOINT INDICATOR (CSL ONLY)                                    *
   658*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   659*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   660*                                                                *
   661*  RETURNED FROM ELRATE                                          *
   662*  --------------------                                          *
   663*  CALCULATED PREMIUM                                            *
   664*  PREMIUM RATE                                                  *
   665*  MORTALITY CODE                                                *
   666*  MAX ATTAINED AGE                                              *
   667*  MAX AGE                                                       *
   668*  MAX TERM                                                      *
   669*  MAX MONTHLY BENEFIT                                           *
   670*  MAX TOTAL BENIFIT                                             *
   671*  COMPOSITE RATE (OPEN-END ONLY)                                *
   672*----------------------------------------------------------------*
   673*  PASSED TO ELRFND                                              *
   674*  ----------------                                              *
   675*  CERT ISSUE DATE                                               *
   676*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  15
* ELRATE.cbl
   677*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   678*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   679*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   680*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   681*  STATE CODE (CLIENT DEFINED)                                   *
   682*  STATE CODE (STANDARD P.O. ABBRV)                              *
   683*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   684*  DEVIATION CODE                                                *
   685*  ISSUE AGE                                                     *
   686*  ORIGINAL BENEFIT AMOUNT                                       *
   687*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   688*  PROCESS TYPE (CANCEL)                                         *
   689*  BENEFIT KIND (LIFE OR A/H)                                    *
   690*  A.P.R.                                                        *
   691*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   692*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   693*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   694*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   695*  COMPANY I.D. (3 CHARACTER)                                    *
   696*  BENEFIT CODE                                                  *
   697*  BENEFIT OVERRIDE CODE                                         *
   698*                                                                *
   699*  RETURNED FROM ELRFND                                          *
   700*  --------------------                                          *
   701*  CALCULATED REFUND                                             *
   702*----------------------------------------------------------------*
   703*  PASSED TO ELEARN                                              *
   704*  ----------------                                              *
   705*  CERT ISSUE DATE                                               *
   706*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   707*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   708*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   709*  STATE CODE (CLIENT DEFINED)                                   *
   710*  STATE CODE (STANDARD P.O. ABBRV)                              *
   711*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   712*  DEVIATION CODE                                                *
   713*  ISSUE AGE                                                     *
   714*  ORIGINAL BENEFIT AMOUNT                                       *
   715*  BENEFIT KIND (LIFE OR A/H)                                    *
   716*  A.P.R.                                                        *
   717*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   718*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   719*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   720*  COMPANY I.D. (3 CHARACTER)                                    *
   721*  BENEFIT CODE                                                  *
   722*  BENEFIT OVERRIDE CODE                                         *
   723*                                                                *
   724*  RETURNED FROM ELEARN                                          *
   725*  --------------------                                          *
   726*  INDICATED  EARNINGS                                           *
   727*----------------------------------------------------------------*
   728*                 LENGTH = 450                                   *
   729*                                                                *
   730******************************************************************
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  16
* ELRATE.cbl
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   740* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   741* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   742* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   743* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   744* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   745* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   746* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   747* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   748* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   749* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   750******************************************************************
   751
   752 01  CALCULATION-PASS-AREA.
   753     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   754                                     COMP.
   755
   756     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   757       88  NO-CP-ERROR                             VALUE ZERO.
   758       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   759                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   760       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   761       88  CP-ERROR-IN-DATES                       VALUE '2'.
   762       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   763       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   764       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   765       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   766       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   767       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   768       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   769       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   770       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   771       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   772       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   773       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   774       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   775       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   776       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   777
   778     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   779       88  NO-CP-ERROR-2                           VALUE ZERO.
   780***********************  INPUT AREAS ****************************
   781
   782     12  CP-CALCULATION-AREA.
   783         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   784         16  CP-CERT-EFF-DT        PIC XX.
   785         16  CP-VALUATION-DT       PIC XX.
   786         16  CP-PAID-THRU-DT       PIC XX.
   787         16  CP-BENEFIT-TYPE       PIC X.
   788           88  CP-AH                               VALUE 'A' 'D'
   789                                                   'I' 'U'.
   790           88  CP-REDUCING-LIFE                    VALUE 'R'.
   791           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   792         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  17
* ELRATE.cbl
   793         16  CP-REPORTED-DT        PIC XX.
   794         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   795         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   796         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-CDT-METHOD         PIC X.
   801           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   802           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   803           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   804         16  CP-CLAIM-TYPE         PIC X.
   805           88  CP-AH-CLAIM                         VALUE 'A'.
   806           88  CP-LIFE-CLAIM                       VALUE 'L'.
   807         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   808                                     COMP-3.
   809         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   810                                     COMP-3.
   811         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   812                                     COMP-3.
   813         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   814                                     COMP-3.
   815         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   816                                     COMP-3.
   817         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   818                                     COMP-3.
   819         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   820                                     COMP-3.
   821         16  CP-REM-TERM-METHOD    PIC X.
   822           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   823           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   824           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   825           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   826           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   827           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   828           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   829         16  CP-EARNING-METHOD     PIC X.
   830           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   831           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   832           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   833           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   834           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   835           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   836           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   837           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   838           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   839           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   840           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   841           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   842           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   843           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   844         16  CP-PROCESS-TYPE       PIC X.
   845           88  CP-CLAIM                            VALUE '1'.
   846           88  CP-CANCEL                           VALUE '2'.
   847           88  CP-ISSUE                            VALUE '3'.
   848         16  CP-SPECIAL-CALC-CD    PIC X.
   849           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   850           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  18
* ELRATE.cbl
   851           88  CP-0-MTH-INTEREST               VALUE 'A'.
   852           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   853           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   854           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   855           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   856           88  CP-FARM-PLAN                    VALUE 'F'.
   857           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   858           88  CP-2-MTH-INTEREST               VALUE 'I'.
   859           88  CP-3-MTH-INTEREST               VALUE 'J'.
   860           88  CP-4-MTH-INTEREST               VALUE 'K'.
   861           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   862           88  CP-MORTGAGE-REC                 VALUE 'M'.
   863           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   864           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   865           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   866           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   867                                                     'W' 'X'.
   868           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   869           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   870           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   871           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   872           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   873           88  CP-SUMMARY-REC                  VALUE 'Z'.
   874           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   875           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   876           88  CP-AD-D-BENEFIT                 VALUE '4'.
   877           88  CP-CSL-METH-1                   VALUE '5'.
   878           88  CP-CSL-METH-2                   VALUE '6'.
   879           88  CP-CSL-METH-3                   VALUE '7'.
   880           88  CP-CSL-METH-4                   VALUE '8'.
   881
   882         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   883                                     COMP-3.
   884         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   885         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   886         16  CP-STATE              PIC XX          VALUE SPACE.
   887         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   888         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   889           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   890               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   891         16  CP-R78-OPTION         PIC X.
   892           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   893           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   894
   895         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   896         16  CP-IBNR-RESERVE-SW    PIC X.
   897         16  CP-CLAIM-STATUS       PIC X.
   898         16  CP-RATE-FILE          PIC X.
   899         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   900                                     COMP-3.
   901
   902         16  CP-LIFE-OVERRIDE-CODE PIC X.
   903         16  CP-AH-OVERRIDE-CODE   PIC X.
   904
   905         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   906                                     COMP-3.
   907         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   908                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  19
* ELRATE.cbl
   909         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   910                                     COMP-3.
   911         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   912                                     COMP-3.
   913         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   914                                     COMP-3.
   915         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   916                                  PIC S9(7)V99 COMP-3.
   917
   918         16  CP-PAID-FROM-DATE     PIC X(02).
   919         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   920         16  CP-EXT-DAYS-CALC      PIC X.
   921           88  CP-EXT-NO-CHG                   VALUE ' '.
   922           88  CP-EXT-CHG-LF                   VALUE '1'.
   923           88  CP-EXT-CHG-AH                   VALUE '2'.
   924           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   925         16  CP-DOMICILE-STATE     PIC XX.
   926         16  CP-CARRIER            PIC X.
   927         16  CP-REIN-FLAG          PIC X.
   928         16  CP-REM-TRM-CALC-OPTION PIC X.
   929           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   930                      '2' '3' '4' '5'.
   931           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   932           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   933           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   934           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   935           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   936           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   937           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   938           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   939         16  CP-SIG-SWITCH         PIC X.
   940         16  CP-RATING-METHOD      PIC X.
   941           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   942           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   943           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   944           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   945           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   946           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   947           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   948           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   949           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   950         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   951                                     COMP-3.
   952         16  CP-BEN-CATEGORY       PIC X.
   953         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   954         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   955                                   PIC S99V9(5) COMP-3.
   956         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   957         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   958                                   PIC S99V9(5) COMP-3.
   959         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   960         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   961         16  CP-EXPIRE-DT          PIC XX.
   962         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   963         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   964         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   965         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  20
* ELRATE.cbl
   967             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   968             88  CP-CALC-CLP              VALUE 'C'.
   969         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   970         16  CP-CANCEL-REASON      PIC X.
   971         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   972         16  CP-PMT-MODE           PIC X.
   973         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   974         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   975         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   976         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   977         16  FILLER                PIC X.
   978
   979***************    OUTPUT FROM ELRESV   ************************
   980
   981         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   982
   983         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   986                                     COMP-3.
   987         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(09).
   992***************    OUTPUT FROM ELRTRM   *************************
   993
   994         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   995                                     COMP-3.
   996         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   997                                     COMP-3.
   998         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   999                                     COMP-3.
  1000         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1001                                     COMP-3.
  1002         16  FILLER                PIC X(12).
  1003
  1004***************    OUTPUT FROM ELRAMT   *************************
  1005
  1006         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1007                                     COMP-3.
  1008         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1009                                     COMP-3.
  1010         16  FILLER                PIC X(12).
  1011
  1012***************    OUTPUT FROM ELRATE   *************************
  1013
  1014         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1015                                     COMP-3.
  1016         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-MORTALITY-CODE     PIC X(4).
  1019         16  CP-RATE-EDIT-FLAG     PIC X.
  1020             88  CP-RATES-NEED-APR                  VALUE '1'.
  1021         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1022                                     COMP-3.
  1023         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1024         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  21
* ELRATE.cbl
  1025         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1026                                   PIC S9(7)V99 COMP-3.
  1027         16  FILLER                PIC X(07).
  1028
  1029***************    OUTPUT FROM ELRFND   *************************
  1030
  1031         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1032                                     COMP-3.
  1033         16  CP-REFUND-TYPE-USED   PIC X.
  1034           88  CP-R-AS-R78                         VALUE '1'.
  1035           88  CP-R-AS-PRORATA                     VALUE '2'.
  1036           88  CP-R-AS-CALIF                       VALUE '3'.
  1037           88  CP-R-AS-TEXAS                       VALUE '4'.
  1038           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1039           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1040           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1041           88  CP-R-AS-MEAN                        VALUE '8'.
  1042           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1043           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1044           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1045           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1046           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1047           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1048         16  FILLER                PIC X(12).
  1049
  1050***************    OUTPUT FROM ELEARN   *************************
  1051
  1052         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1053                                     COMP-3.
  1054         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1055                                     COMP-3.
  1056         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1057                                     COMP-3.
  1058         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1059                                     COMP-3.
  1060         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1061                                     COMP-3.
  1062         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1063                                     COMP-3.
  1064         16  CP-EARNING-TYPE-USED  PIC X.
  1065           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1066           88  CP-E-AS-R78                         VALUE '1'.
  1067           88  CP-E-AS-PRORATA                     VALUE '2'.
  1068           88  CP-E-AS-TEXAS                       VALUE '4'.
  1069           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1070           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1071           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1072           88  CP-E-AS-MEAN                        VALUE '8'.
  1073           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1074         16  FILLER                PIC X(12).
  1075
  1076***************    OUTPUT FROM ELPMNT   *************************
  1077
  1078         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1081                                     COMP-3.
  1082         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  22
* ELRATE.cbl
  1083
  1084***************   MISC WORK AREAS    *****************************
  1085         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1086                                     COMP-3.
  1087         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1088                                     COMP-3.
  1089         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1090                                     COMP-3.
  1091         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1092                                     COMP-3.
  1093         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1094                                     COMP-3.
  1095         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1096                                     COMP-3.
  1097         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1098             88  OPEN-RATE-FILE                   VALUE 'O'.
  1099             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1100             88  IO-ERROR                         VALUE 'E'.
  1101
  1102         16  CP-FIRST-PAY-DATE     PIC XX.
  1103
  1104         16  CP-JOINT-INDICATOR    PIC X.
  1105
  1106         16  CP-RESERVE-REMAINING-TERM
  1107                                   PIC S9(4)V9    VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-INSURED-BIRTH-DT   PIC XX.
  1111
  1112         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1113                                     COMP-3.
  1114
  1115         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1116                                     COMP-3.
  1117
  1118         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1119                                     COMP-3.
  1120
  1121         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1122                                     COMP-3.
  1123
  1124         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1125                                     COMP-3.
  1126
  1127         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1128                                     COMP-3.
  1129
  1130         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1131                                     COMP-3.
  1132
  1133         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1134             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1135
  1136         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1137                                     COMP-3.
  1138         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1139                                     COMP-3.
  1140         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  23
* ELRATE.cbl
  1141         16  cp-extra-periods      pic 9 value zeros.
  1142         16  cp-net-only-state     pic x value spaces.
  1143         16  FILLER                PIC X(13).
  1144******************************************************************
  1145
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  24
* ELRATE.cbl
  1147****************************************************************
  1148*
  1149* Copyright (c) 2007 by Clerity Solutions, Inc.
  1150* All rights reserved.
  1151*
  1152****************************************************************
  1153 01  DFHEIV.
  1154   02  DFHEIV0               PIC X(35).
  1155   02  DFHEIV1               PIC X(08).
  1156   02  DFHEIV2               PIC X(08).
  1157   02  DFHEIV3               PIC X(08).
  1158   02  DFHEIV4               PIC X(06).
  1159   02  DFHEIV5               PIC X(04).
  1160   02  DFHEIV6               PIC X(04).
  1161   02  DFHEIV7               PIC X(02).
  1162   02  DFHEIV8               PIC X(02).
  1163   02  DFHEIV9               PIC X(01).
  1164   02  DFHEIV10              PIC S9(7) COMP-3.
  1165   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1166   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1167   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1168   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1169   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1170   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1171   02  DFHEIV17              PIC X(04).
  1172   02  DFHEIV18              PIC X(04).
  1173   02  DFHEIV19              PIC X(04).
  1174   02  DFHEIV20              USAGE IS POINTER.
  1175   02  DFHEIV21              USAGE IS POINTER.
  1176   02  DFHEIV22              USAGE IS POINTER.
  1177   02  DFHEIV23              USAGE IS POINTER.
  1178   02  DFHEIV24              USAGE IS POINTER.
  1179   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1180   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1181   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1182   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1183   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1184   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1185   02  FILLER                PIC X(02).
  1186   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1187   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1188   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1189   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1190   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1191 LINKAGE  SECTION.
  1192*****************************************************************
  1193*                                                               *
  1194* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1195* All rights reserved.                                          *
  1196*                                                               *
  1197*****************************************************************
  1198 01  dfheiblk.
  1199     02  eibtime          pic s9(7) comp-3.
  1200     02  eibdate          pic s9(7) comp-3.
  1201     02  eibtrnid         pic x(4).
  1202     02  eibtaskn         pic s9(7) comp-3.
  1203     02  eibtrmid         pic x(4).
  1204     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  25
* ELRATE.cbl
  1205     02  eibcposn         pic s9(4) comp.
  1206     02  eibcalen         pic s9(4) comp.
  1207     02  eibaid           pic x(1).
  1208     02  eibfiller1       pic x(1).
  1209     02  eibfn            pic x(2).
  1210     02  eibfiller2       pic x(2).
  1211     02  eibrcode         pic x(6).
  1212     02  eibfiller3       pic x(2).
  1213     02  eibds            pic x(8).
  1214     02  eibreqid         pic x(8).
  1215     02  eibrsrce         pic x(8).
  1216     02  eibsync          pic x(1).
  1217     02  eibfree          pic x(1).
  1218     02  eibrecv          pic x(1).
  1219     02  eibsend          pic x(1).
  1220     02  eibatt           pic x(1).
  1221     02  eibeoc           pic x(1).
  1222     02  eibfmh           pic x(1).
  1223     02  eibcompl         pic x(1).
  1224     02  eibsig           pic x(1).
  1225     02  eibconf          pic x(1).
  1226     02  eiberr           pic x(1).
  1227     02  eibrldbk         pic x(1).
  1228     02  eiberrcd         pic x(4).
  1229     02  eibsynrb         pic x(1).
  1230     02  eibnodat         pic x(1).
  1231     02  eibfiller5       pic x(2).
  1232     02  eibresp          pic 9(09) comp.
  1233     02  eibresp2         pic 9(09) comp.
  1234     02  dfheigdj         pic s9(4) comp.
  1235     02  dfheigdk         pic s9(4) comp.
  1236 01  DFHCOMMAREA             PIC X(450).
  1237
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  26
* ELRATE.cbl
  1239*01 PARMLIST              COMP.
  1240*    02  FILLER              PIC S9(8).
  1241*    02  ERRATE-POINTER      PIC S9(8).
  1242
  1243*                                COPY ERCRATE.
  1244******************************************************************
  1245*                                                                *
  1246*                                                                *
  1247*                            ERCRATE                             *
  1248*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1249*                            VMOD=2.008                          *
  1250*                                                                *
  1251*   ONLINE CREDIT SYSTEM                                         *
  1252*                                                                *
  1253*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1254*                                                                *
  1255*   FILE TYPE = VSAM,KSDS                                        *
  1256*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1257*                                                                *
  1258*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1259*       ALTERNATE PATH = NONE                                    *
  1260*                                                                *
  1261*   LOG = NO                                                     *
  1262*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1263*                                                                *
  1264******************************************************************
  1265******************************************************************
  1266*                   C H A N G E   L O G
  1267*
  1268* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1269*-----------------------------------------------------------------
  1270*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1271* EFFECTIVE    NUMBER
  1272*-----------------------------------------------------------------
  1273* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1274******************************************************************
  1275
  1276 01  RATE-RECORD.
  1277     12  RT-RECORD-ID                      PIC XX.
  1278         88  VALID-RT-ID                      VALUE 'RT'.
  1279
  1280     12  RT-CONTROL-PRIMARY.
  1281         16  RT-COMPANY-CD                 PIC X.
  1282         16  RT-STATE-CODE.
  1283             20  RT-ST-CODE                PIC XX.
  1284             20  RT-ST-CLASS               PIC XX.
  1285             20  RT-ST-DEV                 PIC XXX.
  1286         16  RT-L-AH-CODE.
  1287             20  RT-L-AH                   PIC X.
  1288             20  RT-LAH-NUM                PIC XX.
  1289         16  RT-LIMITS.
  1290             20  RT-HIGH-AGE               PIC 99.
  1291             20  RT-HIGH-AMT               PIC 9(6).
  1292             20  RT-FUTURE                 PIC XX.
  1293             20  RT-SEX                    PIC X.
  1294         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1295
  1296     12  RT-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  27
* ELRATE.cbl
  1297         16  RT-LAST-MAINT-DT              PIC XX.
  1298         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1299         16  RT-LAST-MAINT-USER            PIC X(4).
  1300         16  FILLER                        PIC X(10).
  1301
  1302     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1303     12  RT-RATE-COMMENT                   PIC X(50).
  1304
  1305     12  CSL-RESERVED                      PIC X(10).
  1306     12  FILLER                            PIC X(12).
  1307
  1308     12  RT-MAX-AGE                        PIC 99.
  1309
  1310     12  RT-LIFE-LIMS-FLDS.
  1311         16  RT-LIFE-MORT-CODE             PIC X(4).
  1312         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1313             20  RT-L-EX-AGE               PIC 99.
  1314             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1315             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1316         16  FILLER                        PIC X(20).
  1317
  1318     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1319         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1320             20  RT-AH-AGE                 PIC 99.
  1321             20  RT-AH-TERM                PIC S999       COMP-3.
  1322             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1323             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1324
  1325     12  RT-LIFE-RATES.
  1326         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1327
  1328     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1329         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1330
  1331     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1332
  1333     12  RT-DISCOUNT-OPTION                PIC X.
  1334         88  RT-DO-NOT-USE                     VALUE ' '.
  1335         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1336         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1337
  1338     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1339     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1340
  1341     12  RT-COMPOSITE-OPTION               PIC X.
  1342         88  RT-NO-COMPOSITE                   VALUE ' '.
  1343         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1344
  1345     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1346
  1347     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
  1348     12  FILLER                            PIC X(13).
  1349
  1350     12  RT-TYPE-RATE                      PIC X.
  1351         88  RT-IS-STND                        VALUE ' ' 'S'.
  1352         88  RT-IS-OB                          VALUE 'O'.
  1353
  1354     12  RT-SRT-ALPHA                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  28
* ELRATE.cbl
  1355
  1356     12  RT-CONTROL-2.
  1357         16  RTC-1                         PIC X(7).
  1358         16  RTC-3                         PIC X(11).
  1359         16  RTC-4                         PIC 9(11) COMP-3.
  1360         16  RTC-2                         PIC X(3).
  1361******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  29
* ELRATE.cbl
  1363 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1364 0000-DFHEXIT SECTION.
  1365     MOVE '9#                    $   ' TO DFHEIV0.
  1366     MOVE 'ELRATE' TO DFHEIV1.
  1367     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1368
  1369     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1370
  1371 000-START-PREMIUM-CALC.
  1372     MOVE ZERO                   TO CP-RETURN-CODE
  1373                                    CP-CALC-PREMIUM
  1374                                    CP-PREMIUM-RATE
  1375                                    CP-cancel-FEE.
  1376
  1377     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1378     MOVE ALL '9'                TO ERRATE-KEY.
  1379
  1380*    IF CP-RATE-FILE = 'O'
  1381*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1382
  1383     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1384     MOVE CP-STATE               TO RATE-ST-CODE.
  1385     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1386     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1387     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1388
  1389     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1390        CP-RATING-BENEFIT-AMT = ZEROS
  1391         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1392     ELSE
  1393         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1394
  1395     IF CP-AH
  1396         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1397     ELSE
  1398         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1399
  1400     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1401     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1402     MOVE SPACE                  TO DC-OPTION-CODE.
  1403
  1404     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1405
  1406*** Y2K, PROJ 7744
  1407     IF NO-CONVERSION-ERROR
  1408         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1409                                       WS-HOLD-RATE-EXP-DT
  1410         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1411         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1412         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1413     ELSE
  1414         MOVE '2'                   TO CP-RETURN-CODE
  1415         GO TO 9999-CALC-RATE-PREM-X
  1416     END-IF.
  1417*** Y2K, PROJ 7744
  1418
  1419
  1420* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  30
* ELRATE.cbl
  1421*        NOTFND   (9999-RATE-NOTFND)
  1422*        NOTOPEN  (9999-RATE-NOTOPEN)
  1423*        ENDFILE  (9999-RATE-NOTFND)
  1424*    END-EXEC.
  1425*    MOVE '"$IJ''                 ! " #00001415' TO DFHEIV0
  1426     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1428     MOVE X'2220233030303031343135' TO DFHEIV0(25:11)
  1429     CALL 'kxdfhei1' USING DFHEIV0
  1430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1431
  1432
  1433 0050-RATE-START-BROWSE.
  1434
  1435* EXEC CICS STARTBR
  1436*        DATASET  (ERRATE-FILE-ID)
  1437*        RIDFLD   (ERRATE-KEY)
  1438*        GTEQ
  1439*    END-EXEC.
  1440     MOVE 0
  1441       TO DFHEIV11
  1442*    MOVE '&,         G          &   #00001422' TO DFHEIV0
  1443     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1444     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1445     MOVE X'2020233030303031343232' TO DFHEIV0(25:11)
  1446     CALL 'kxdfhei1' USING DFHEIV0,
  1447           ERRATE-FILE-ID,
  1448           ERRATE-KEY,
  1449           DFHEIV99,
  1450           DFHEIV11,
  1451           DFHEIV99
  1452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1453
  1454
  1455     MOVE 'Y'                  TO WS-BROWSE-SW.
  1456
  1457 0100-READ-RATE-LOOP.
  1458
  1459* EXEC CICS READNEXT
  1460*        DATASET  (ERRATE-FILE-ID)
  1461*        SET      (ADDRESS OF RATE-RECORD)
  1462*        RIDFLD   (ERRATE-KEY)
  1463*    END-EXEC.
  1464     MOVE 0
  1465       TO DFHEIV11
  1466*    MOVE '&.S                   )   #00001431' TO DFHEIV0
  1467     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1468     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1469     MOVE X'2020233030303031343331' TO DFHEIV0(25:11)
  1470     CALL 'kxdfhei1' USING DFHEIV0,
  1471           ERRATE-FILE-ID,
  1472           DFHEIV20,
  1473           DFHEIV99,
  1474           ERRATE-KEY,
  1475           DFHEIV99,
  1476           DFHEIV11,
  1477           DFHEIV99,
  1478           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  31
* ELRATE.cbl
  1479     SET ADDRESS OF RATE-RECORD TO
  1480         DFHEIV20
  1481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1482
  1483
  1484 0110-CHECK-KEYS.
  1485*                            COPY ELCRATPD.
  1486******************************************************************
  1487*                                                                *
  1488*                                                                *
  1489*                            ELCRATPD                            *
  1490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1491*                            VMOD=2.061                          *
  1492*                                                                *
  1493******************************************************************
  1494******************************************************************
  1495*                   C H A N G E   L O G
  1496*
  1497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1498*-----------------------------------------------------------------
  1499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1500* EFFECTIVE    NUMBER
  1501*-----------------------------------------------------------------
  1502* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1503* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1504* 032603                   PEMA  ADD SPECIAL AZ CALC
  1505* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1506* 120403                   PEMA  ADD SPECIAL TX CALC
  1507* 092205                   PEMA  FIX CRIT PER FOR DCC
  1508* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1509* 021207                   PEMA  ADD PA NP
  1510* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1511* 032807                   PEMA  ADD VT NP PLUS 2
  1512* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1513* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1514* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1515* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1516* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1517* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1518* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1519* 071211    2010012700001  PEMA  ADD SPPDD
  1520* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1521* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1522* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1523* 032612  CR2011110200001  PEMA  AHL CHANGES
  1524* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1525* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1526* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1527* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1528******************************************************************
  1529
  1530 0110-CHECK-KEY.
  1531     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1532        SVRT-ST-CODE    = RT-ST-CODE     AND
  1533        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1534        SVRT-ST-DEV     = RT-ST-DEV      AND
  1535        SVRT-L-AH       = RT-L-AH        AND
  1536        SVRT-LAH-NUM    = RT-LAH-NUM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  32
* ELRATE.cbl
  1537         NEXT SENTENCE
  1538     ELSE
  1539         GO TO 9999-RATE-NOTFND.
  1540
  1541     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1542         GO TO 9999-RATE-NOTFND.
  1543
  1544     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1545        GO TO 0100-READ-RATE-LOOP.
  1546
  1547     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1548         GO TO 0100-READ-RATE-LOOP.
  1549
  1550     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1551         GO TO 0100-READ-RATE-LOOP.
  1552
  1553     IF RT-MAX-AGE = ZEROS
  1554         NEXT SENTENCE
  1555     ELSE
  1556         COMPUTE WS-AGE =
  1557             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1558         IF WS-AGE >= RT-MAX-AGE
  1559             MOVE 'B'               TO CP-RETURN-CODE.
  1560
  1561     IF CP-LOAN-TERM NOT NUMERIC
  1562         MOVE +0                    TO CP-LOAN-TERM.
  1563
  1564     IF CP-LOAN-TERM = ZERO
  1565         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1566
  1567     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1568         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1569
  1570     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1571     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1572
  1573     IF CP-AH
  1574         GO TO 2000-TYPE-IS-AH.
  1575
  1576     evaluate true
  1577        when (rt-is-ob)
  1578           and (cp-company-id not = 'CID')
  1579              move cp-loan-term  to ws-rate-term
  1580        when (cp-company-id = 'DCC' OR 'VPP')
  1581           and (cp-benefit-cd (1:1) = 'P')
  1582           move cp-loan-term     to ws-rate-term
  1583        when other
  1584           move cp-original-term to ws-rate-term
  1585     end-evaluate
  1586
  1587*    IF ((RT-IS-OB)
  1588*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1589*                     OR
  1590*       ((CP-COMPANY-ID = 'DCC')
  1591*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1592*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1593*    ELSE
  1594*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  33
* ELRATE.cbl
  1595*    END-IF
  1596
  1597     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1598     MOVE SPACE                     TO DC-OPTION-CODE.
  1599
  1600     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1601
  1602 1000-TYPE-IS-LIFE.
  1603     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1604
  1605     MOVE ZERO                      TO CP-R-MAX-AGE
  1606                                       CP-R-MAX-TERM
  1607                                       CP-R-MAX-MON-BEN
  1608                                       CP-R-MAX-TOT-BEN.
  1609
  1610     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1611
  1612     IF RT-CANCEL-FEE NUMERIC
  1613        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  1614
  1615     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1616
  1617     if rt-discount-ob-rate not numeric
  1618        move zeros               to rt-discount-ob-rate
  1619     end-if
  1620     IF (RT-DISCOUNT-OPTION EQUAL
  1621                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1622        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1623        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1624         NEXT SENTENCE
  1625     ELSE
  1626         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1627            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1628             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1629                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1630                 GO TO 1050-REGULAR-RATES
  1631             ELSE
  1632                 GO TO 1050-REGULAR-RATES
  1633         ELSE
  1634             GO TO 1050-REGULAR-RATES.
  1635
  1636*    display ' discount option ' rt-discount-option
  1637     IF RT-DISCOUNT-RATE NOT NUMERIC
  1638        MOVE +0                  TO RT-DISCOUNT-RATE.
  1639
  1640     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1641        NEXT SENTENCE
  1642     ELSE
  1643        MOVE +0                  TO CP-PREMIUM-RATE
  1644                                    CP-COMPOSITE-RATE
  1645                                    CP-CALC-PREMIUM
  1646         MOVE '4'                TO CP-RETURN-CODE
  1647         GO TO 9999-CALC-RATE-PREM-X.
  1648
  1649     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1650        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1651     ELSE
  1652        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  34
* ELRATE.cbl
  1653
  1654*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1655*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1656*       GO TO 1075-BYPASS-REGULAR-RATE.
  1657
  1658     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1659        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1660        COMPUTE WS-WORK-DIS-RATE EQUAL
  1661                WS-WORK-DIS-RATE / +100
  1662        GO TO 1075-BYPASS-REGULAR-RATE.
  1663
  1664     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1665        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1666        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1667        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1668        GO TO 1075-BYPASS-REGULAR-RATE.
  1669
  1670     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1671        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1672        (CP-TRUNCATED-LIFE)
  1673        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1674        GO TO 1075-BYPASS-REGULAR-RATE.
  1675
  1676     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1677        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1678        (CP-EARN-AS-NET-PAY)
  1679*       (CP-TRUNCATED-LIFE)
  1680        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1681        GO TO 1075-BYPASS-REGULAR-RATE.
  1682
  1683     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1684        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1685                   AND
  1686        ((CP-EARN-AS-NET-PAY)
  1687               OR
  1688        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1689        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1690        GO TO 1075-BYPASS-REGULAR-RATE.
  1691
  1692     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1693        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1694        (CP-EARN-AS-NET-PAY) AND
  1695        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1696        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1697        GO TO 1075-BYPASS-REGULAR-RATE.
  1698
  1699     if (cp-company-id = 'CID')
  1700        and (cp-state-std-abbrv = 'WA')
  1701        and (rt-discount-option = '1')
  1702        and (cp-earn-as-farm-plan)
  1703        move rt-discount-ob-rate to cp-premium-rate
  1704        go to 1075-bypass-regular-rate
  1705     end-if
  1706     IF (CP-COMPANY-ID = 'CID')
  1707        AND (CP-STATE-STD-ABBRV = 'MN')
  1708        AND (RT-DISCOUNT-OPTION = '1')
  1709        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1710                     OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  35
* ELRATE.cbl
  1711            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1712            AND (CP-CERT-EFF-DT > X'A4FF'))
  1713        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1714        display ' made it to MN 1 ' cp-premium-rate
  1715        GO TO 1075-BYPASS-REGULAR-RATE
  1716     END-IF
  1717     if (cp-company-id = 'CID')
  1718        and (cp-earn-as-reg-balloon)
  1719        and (cp-ben-category = 'P' or 'I')
  1720        and (rt-discount-ob-rate not = zeros)
  1721        go to 1075-bypass-regular-rate
  1722     end-if
  1723     IF (CP-COMPANY-ID EQUAL 'CID')
  1724        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1725                      OR
  1726            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1727        AND (CP-EARN-AS-NET-PAY)
  1728        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1729        GO TO 1075-BYPASS-REGULAR-RATE
  1730     END-IF
  1731     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1732        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1733        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1734         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1735         GO TO 1075-BYPASS-REGULAR-RATE.
  1736
  1737     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1738        CONTINUE
  1739     ELSE
  1740        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1741           (CP-EARN-AS-NET-PAY ) AND
  1742           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1743            GO TO 1075-BYPASS-REGULAR-RATE
  1744        END-IF
  1745     END-IF
  1746     IF (CP-COMPANY-ID = 'CID') AND
  1747        (CP-EARN-AS-NET-PAY) AND
  1748        (CP-LEVEL-LIFE) AND
  1749        (CP-STATE-STD-ABBRV = 'CA') AND
  1750        (CP-STATE-STD-ABBRV = CP-STATE)
  1751        COMPUTE WS-WORK-DIS-RATE =
  1752             RT-DISCOUNT-RATE / +100
  1753        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1754        GO TO 1075-BYPASS-REGULAR-RATE
  1755     END-IF
  1756
  1757     IF (CP-COMPANY-ID = 'CID')
  1758        AND (CP-EARN-AS-NET-PAY)
  1759        AND (CP-STATE-STD-ABBRV = 'ME')
  1760        COMPUTE WS-WORK-DIS-RATE =
  1761             RT-DISCOUNT-RATE / +100
  1762        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1763        GO TO 1075-BYPASS-REGULAR-RATE
  1764     END-IF
  1765     IF (CP-COMPANY-ID = 'CID')
  1766        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1767           OR 'IN' OR 'AZ')
  1768        AND (CP-FARM-PLAN)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  36
* ELRATE.cbl
  1769        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1770        GO TO 1075-BYPASS-REGULAR-RATE
  1771     END-IF
  1772     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  1773        AND (CP-BEN-CATEGORY = 'D')
  1774        AND (CP-EARN-AS-NET-PAY)
  1775        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1776        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1777           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1778*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1779*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1780*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1781*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1782        GO TO 1075-BYPASS-REGULAR-RATE
  1783     END-IF
  1784     IF (CP-COMPANY-ID = 'CID') AND
  1785        (CP-EARN-AS-NET-PAY) AND
  1786        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1787                            OR 'VT')
  1788                   OR
  1789        ((CP-STATE-STD-ABBRV = 'IN') AND
  1790        (CP-CERT-EFF-DT > X'9A7F'))
  1791                   OR
  1792        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1793        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1794        (CP-STATE-STD-ABBRV = CP-STATE)
  1795        COMPUTE WS-WORK-DIS-RATE =
  1796             RT-DISCOUNT-RATE / +100
  1797        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1798        GO TO 1075-BYPASS-REGULAR-RATE
  1799     END-IF
  1800
  1801     IF (CP-COMPANY-ID = 'CID') AND
  1802        (CP-EARN-AS-NET-PAY) AND
  1803        (CP-STATE-STD-ABBRV = 'TX') AND
  1804        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1805        (WS-DISCOUNT-OPTION NOT = ' ')
  1806        COMPUTE WS-WORK-DIS-RATE =
  1807             RT-DISCOUNT-RATE / +100
  1808        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1809        GO TO 1075-BYPASS-REGULAR-RATE
  1810     END-IF
  1811
  1812     IF (CP-COMPANY-ID = 'CID') AND
  1813        (CP-EARN-AS-NET-PAY) AND
  1814        (CP-TRUNCATED-LIFE) AND
  1815        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1816        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1817        (WS-DISCOUNT-OPTION NOT = ' ')
  1818        COMPUTE WS-WORK-DIS-RATE =
  1819             RT-DISCOUNT-RATE / +100
  1820        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1821        GO TO 1075-BYPASS-REGULAR-RATE
  1822     END-IF
  1823
  1824     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1825        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1826           COMPUTE WS-WORK-DIS-RATE EQUAL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  37
* ELRATE.cbl
  1827                   WS-WORK-DIS-RATE / +100.
  1828
  1829     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1830        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1831           IF CP-MONTHLY-PAYMENT EQUAL +0
  1832            IF CP-LOAN-APR GREATER THAN +2
  1833              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1834              CP-ORIGINAL-BENEFIT /
  1835               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1836               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1837            ELSE
  1838             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1839               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1840
  1841     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1842        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1843          IF WS-WORK-DIS-RATE GREATER THAN +0
  1844           COMPUTE WK1 ROUNDED EQUAL
  1845           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1846                              (WS-RATE-TERM - +1)) /
  1847                        (WS-WORK-DIS-RATE / +12)
  1848           COMPUTE WK2 ROUNDED EQUAL
  1849           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1850                              (WS-RATE-TERM)) /
  1851                        (WS-WORK-DIS-RATE / +12)
  1852           COMPUTE WK3 EQUAL
  1853                RT-DISCOUNT-OB-RATE *
  1854                (1 + WS-WORK-DIS-RATE / +12)
  1855                MOVE WK3 TO CP-PREMIUM-RATE
  1856                COMPUTE WK5 EQUAL WK3 / +1000
  1857           GO TO 1075-BYPASS-REGULAR-RATE.
  1858*               (RT-DISCOUNT-OB-RATE / +1000) *
  1859*               (1 + WS-WORK-DIS-RATE / +12)
  1860*          GO TO 1075-BYPASS-REGULAR-RATE.
  1861
  1862     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1863        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1864           COMPUTE WK3 EQUAL
  1865           RT-DISCOUNT-OB-RATE *
  1866           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1867           MOVE WK3 TO CP-PREMIUM-RATE
  1868           COMPUTE WK5 EQUAL WK3 / +1000
  1869           GO TO 1075-BYPASS-REGULAR-RATE.
  1870
  1871     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1872        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1873        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1874        GO TO 1075-BYPASS-REGULAR-RATE.
  1875
  1876     COMPUTE WS-SIN-PREM-RATE =
  1877             (RT-DISCOUNT-OB-RATE / +1000) *
  1878             ((WS-RATE-TERM + +1) / +2).
  1879
  1880     COMPUTE CP-PREMIUM-RATE =
  1881             WS-SIN-PREM-RATE /
  1882             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1883             WS-RATE-TERM) / +24)).
  1884
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  38
* ELRATE.cbl
  1885     IF CP-PREMIUM-RATE NOT = +0
  1886        MULTIPLY +100 BY CP-PREMIUM-RATE
  1887        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1888        GO TO 1075-BYPASS-REGULAR-RATE.
  1889
  1890 1050-REGULAR-RATES.
  1891
  1892     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1893        COMPUTE WK5 EQUAL
  1894        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1895        (6 * (WS-RATE-TERM + 1))
  1896        MOVE WK5 TO CP-PREMIUM-RATE
  1897        GO TO 1075-BYPASS-REGULAR-RATE.
  1898
  1899     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1900        (CP-CSL-VALID-NP-BENEFIT-CD)
  1901        IF CP-JOINT-INDICATOR EQUAL 'J'
  1902           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1903           GO TO 1075-BYPASS-REGULAR-RATE
  1904        ELSE
  1905           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1906           GO TO 1075-BYPASS-REGULAR-RATE.
  1907
  1908     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1909        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1910        (CP-EARN-AS-NET-PAY )
  1911        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1912        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1913        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1914        MOVE '1'                 TO DC-OPTION-CODE
  1915        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1916        IF DATE-CONVERSION-ERROR
  1917            MOVE '2'                TO CP-RETURN-CODE
  1918            GO TO 9999-CALC-RATE-PREM-X
  1919        ELSE
  1920            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1921                                         DC-ODD-DAYS-OVER
  1922            GO TO 1075-BYPASS-REGULAR-RATE.
  1923
  1924     IF RT-COMPOSITE-RATE NOT NUMERIC
  1925         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1926
  1927*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1928     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1929         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1930                                              WS-PREMIUM-RATE
  1931         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1932     ELSE
  1933         MOVE +0                           TO CP-PREMIUM-RATE
  1934                                              CP-COMPOSITE-RATE
  1935                                              CP-CALC-PREMIUM
  1936         GO TO 9999-CALC-RATE-PREM-X.
  1937     IF (CP-COMPANY-ID EQUAL 'CID')
  1938        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1939        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1940        AND (CP-EARN-AS-NET-PAY)
  1941        GO TO 1075-BYPASS-REGULAR-RATE
  1942     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  39
* ELRATE.cbl
  1943******************************************************
  1944*    IF CP-COMPANY-ID NOT = 'LBL'
  1945     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1946                   or
  1947        ((cp-company-id = 'CID')
  1948        and (cp-earn-as-reg-balloon)
  1949        and (cp-ben-category = 'P' or 'I'))
  1950         GO TO 1075-BYPASS-REGULAR-RATE.
  1951
  1952     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1953     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1954     MOVE '1'                    TO DC-OPTION-CODE.
  1955     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1956     IF DATE-CONVERSION-ERROR
  1957         MOVE '2'                TO CP-RETURN-CODE
  1958         GO TO 9999-CALC-RATE-PREM-X
  1959       ELSE
  1960         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1961         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1962
  1963     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1964        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1965        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1966
  1967     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1968        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1969           NEXT SENTENCE
  1970         ELSE
  1971           GO TO 1075-BYPASS-REGULAR-RATE
  1972       ELSE
  1973        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1974           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1975           NEXT SENTENCE
  1976         ELSE
  1977           GO TO 1075-BYPASS-REGULAR-RATE.
  1978
  1979     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1980        COMPUTE CP-PREMIUM-RATE =
  1981        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1982         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1983         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1984
  1985     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1986        COMPUTE CP-PREMIUM-RATE =
  1987        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1988        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1989        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1990        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1991         * (CP-ORIGINAL-TERM - 1)).
  1992******************************************************
  1993
  1994 1075-BYPASS-REGULAR-RATE.
  1995
  1996     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1997
  1998     MOVE +1 TO LINDX.
  1999
  2000     IF CP-COMPANY-ID EQUAL 'CRI'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  40
* ELRATE.cbl
  2001        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2002           MOVE +5               TO LINDX
  2003           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  2004              MOVE 'F'           TO CP-RETURN-CODE
  2005              GO TO 1200-CALCULATE-PREMIUMS.
  2006
  2007     IF RT-L-EX-AGE (LINDX) = ZERO
  2008          GO TO 1200-CALCULATE-PREMIUMS.
  2009
  2010 1100-SEARCH-LIFE-LIMITS.
  2011
  2012     IF CP-COMPANY-ID EQUAL 'CRI'
  2013        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2014           IF LINDX GREATER THAN +4
  2015              MOVE 'A'           TO CP-RETURN-CODE
  2016              GO TO 1200-CALCULATE-PREMIUMS.
  2017
  2018     IF LINDX GREATER +8
  2019         MOVE 'A'                TO CP-RETURN-CODE
  2020         GO TO 1200-CALCULATE-PREMIUMS.
  2021
  2022     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  2023         IF RT-L-EX-AGE (LINDX) = ZEROS
  2024             ADD +1              TO LINDX
  2025             GO TO 1100-SEARCH-LIFE-LIMITS
  2026         ELSE
  2027             MOVE RT-L-EX-AGE (LINDX)
  2028                                 TO CP-R-MAX-AGE
  2029             MOVE RT-L-EX-TERM (LINDX)
  2030                                 TO CP-R-MAX-TERM
  2031             MOVE RT-L-EX-FACE (LINDX)
  2032                                 TO CP-R-MAX-TOT-BEN
  2033             ADD +1              TO LINDX
  2034             GO TO 1100-SEARCH-LIFE-LIMITS
  2035     ELSE
  2036         MOVE RT-L-EX-AGE (LINDX)
  2037                                 TO CP-R-MAX-AGE
  2038         MOVE RT-L-EX-TERM (LINDX)
  2039                                 TO CP-R-MAX-TERM
  2040         MOVE RT-L-EX-FACE (LINDX)
  2041                                 TO CP-R-MAX-TOT-BEN.
  2042
  2043     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  2044         MOVE '9'                TO CP-RETURN-CODE.
  2045
  2046     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2047         MOVE '8'                TO CP-RETURN-CODE.
  2048
  2049 1200-CALCULATE-PREMIUMS.
  2050
  2051     IF CP-COMPANY-ID = 'CSL'
  2052        IF CP-CSL-VALID-NP-BENEFIT-CD
  2053           GO TO 1240-NET-PAY-CONT
  2054        ELSE
  2055           GO TO 1250-CSL-CALC.
  2056
  2057     IF CP-COMPANY-ID = 'WDS'
  2058        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  41
* ELRATE.cbl
  2059           IF CP-EARN-AS-REG-BALLOON
  2060              GO TO 1240-NET-PAY-CONT.
  2061
  2062     IF (CP-COMPANY-ID = 'CID')
  2063        AND (CP-STATE-STD-ABBRV = 'MN')
  2064        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2065        AND (CP-CERT-EFF-DT > X'A4FF')
  2066        display ' made it to mn 2 '
  2067        GO TO 1240-NET-PAY-CONT
  2068     END-IF
  2069     IF (CP-COMPANY-ID = 'CID')
  2070        AND (CP-STATE-STD-ABBRV = 'WA')
  2071        AND (CP-FARM-PLAN)
  2072        GO TO 1240-NET-PAY-CONT
  2073     END-IF
  2074     if (cp-company-id = 'CID')
  2075        and (cp-earn-as-reg-balloon)
  2076        and (cp-ben-category = 'P' or 'I')
  2077        display ' found balloon p or i ' rt-discount-ob-rate
  2078        evaluate true
  2079           when (cp-net-only-state = 'Y')
  2080              and (rt-discount-ob-rate > zeros)
  2081              compute cp-premium-rate = rt-discount-ob-rate / 10
  2082           when (cp-net-only-state = 'Y')
  2083              and (rt-discount-ob-rate = zeros)
  2084              display ' not ob rate     ' cp-premium-rate
  2085              compute cp-premium-rate =
  2086                 cp-premium-rate / cp-original-term * 12
  2087              display ' new rate ' cp-premium-rate
  2088              display ' net only state ' cp-premium-rate
  2089              compute cp-premium-rate rounded =
  2090                (cp-premium-rate *
  2091                   (cp-original-term + 1) / 12) /
  2092                ((cp-original-term + 2) / 2)
  2093              display ' new OB rate ' cp-premium-rate
  2094           when (cp-net-only-state <> 'Y')
  2095              and (rt-discount-ob-rate = zeros)
  2096              display ' not net only st ' cp-premium-rate
  2097              compute cp-premium-rate =
  2098                 cp-premium-rate / cp-original-term * 12
  2099              display ' new rate ' cp-premium-rate
  2100        end-evaluate
  2101        go to 1240-net-pay-cont
  2102     end-if
  2103     IF (CP-COMPANY-ID = 'CID')
  2104        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2105           OR 'IN' OR 'AZ')
  2106        AND (CP-FARM-PLAN)
  2107***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2108***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2109        MOVE +1.0                TO CP-LOAN-APR
  2110        GO TO 1240-NET-PAY-CONT
  2111     END-IF
  2112     IF CP-RATE-AS-STANDARD
  2113         GO TO 1210-REGULAR-RATE.
  2114
  2115     IF CP-CRITICAL-PERIOD
  2116         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  42
* ELRATE.cbl
  2117
  2118     IF CP-EARN-AS-TEXAS
  2119         GO TO 1230-TEXAS-CONT.
  2120
  2121     IF CP-EARN-AS-NET-PAY
  2122        IF CP-STATE-STD-ABBRV = 'MD'
  2123          IF CP-COMPANY-ID = 'MON'
  2124            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2125                               '14' OR '26' OR '47'
  2126              GO TO 1210-REGULAR-RATE.
  2127
  2128     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2129        IF CP-MONTHLY-PAYMENT EQUAL +0
  2130           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2131                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2132
  2133     IF CP-COMPANY-ID EQUAL 'GTL'
  2134        NEXT SENTENCE
  2135     ELSE
  2136     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2137        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2138           COMPUTE WK3 ROUNDED EQUAL
  2139           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2140           CP-MONTHLY-PAYMENT
  2141           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2142           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2143           CP-ALTERNATE-BENEFIT)
  2144           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2145           WK3 * WK5
  2146           GO TO 9999-CALC-RATE-PREM-X
  2147        ELSE
  2148           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2149           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2150           (WS-WORK-DIS-RATE / +12)
  2151           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2152           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2153                               WK5
  2154           GO TO 9999-CALC-RATE-PREM-X.
  2155
  2156     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2157        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2158        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2159        CP-ORIGINAL-TERM LESS THAN +61
  2160        COMPUTE CP-CALC-PREMIUM EQUAL
  2161                        (CP-ORIGINAL-BENEFIT *
  2162           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2163           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2164        COMPUTE CP-CALC-PREMIUM EQUAL
  2165                CP-CALC-PREMIUM +
  2166              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2167        (CP-ORIGINAL-TERM + 1)) /
  2168        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2169        GO TO 9999-CALC-RATE-PREM-X.
  2170
  2171     IF CP-COMPANY-ID = 'GTL'     AND
  2172        CP-STATE-STD-ABBRV = 'PA' AND
  2173        CP-SPECIAL-CALC-CD = 'H'
  2174         GO TO 1260-GTL-PA-LEASE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  43
* ELRATE.cbl
  2175
  2176     IF (CP-EARN-AS-NET-PAY)
  2177*       AND (CP-LOAN-APR > ZEROS)
  2178        GO TO 1240-NET-PAY-CONT
  2179     END-IF
  2180
  2181     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2182         GO TO 1210-REGULAR-RATE.
  2183
  2184**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2185**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2186****
  2187     IF CP-DEVIATION-CODE = 'LEV' AND
  2188        CP-LOAN-APR = ZEROS
  2189         GO TO 1210-REGULAR-RATE.
  2190
  2191     IF (CP-STATE-STD-ABBRV = 'OH')
  2192        AND (CP-CLASS-CODE NOT = 'L ')
  2193        AND (CP-ORIGINAL-TERM > 60)
  2194        AND (DC-GREG-DATE-CYMD > 19831031)
  2195        AND (CP-LOAN-APR > ZEROS)
  2196        GO TO 1240-NET-PAY-CONT
  2197     END-IF
  2198
  2199     IF (CP-STATE-STD-ABBRV = 'UT')
  2200        AND (CP-ORIGINAL-TERM > 62)
  2201        AND (DC-GREG-DATE-CYMD > 19810831)
  2202        AND (DC-GREG-DATE-CYMD < 19830901)
  2203        AND (CP-LOAN-APR > ZEROS)
  2204        GO TO 1240-NET-PAY-CONT
  2205     END-IF
  2206
  2207     IF (CP-STATE-STD-ABBRV = 'RI')
  2208        AND (CP-ORIGINAL-TERM > 60)
  2209        AND (DC-GREG-DATE-CYMD > 19831231)
  2210        AND (CP-LOAN-APR > ZEROS)
  2211        GO TO 1240-NET-PAY-CONT
  2212     END-IF
  2213     .
  2214 1210-REGULAR-RATE.
  2215
  2216     IF (CP-COMPANY-ID = 'CID')
  2217        AND (CP-EARN-AS-NET-PAY)
  2218        AND (CP-LOAN-APR = 0)
  2219        IF RT-L-RATE (WS-RATE-TERM) = 0
  2220           COMPUTE WS-SIN-PREM-RATE =
  2221              (RT-DISCOUNT-OB-RATE / +1000) *
  2222              ((WS-RATE-TERM + +1) / +2)
  2223           COMPUTE CP-PREMIUM-RATE =
  2224              WS-SIN-PREM-RATE /
  2225              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2226              WS-RATE-TERM) / +24))
  2227        ELSE
  2228           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2229        END-IF
  2230     END-IF
  2231*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2232*       IF CP-MONTHLY-PAYMENT EQUAL +0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  44
* ELRATE.cbl
  2233*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2234*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2235*
  2236*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2237*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2238*          COMPUTE WK3 ROUNDED EQUAL
  2239*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2240*          CP-MONTHLY-PAYMENT
  2241*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2242*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2243*          CP-ALTERNATE-BENEFIT)
  2244*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2245*          WK3 * WK5
  2246*          GO TO 9999-CALC-RATE-PREM-X
  2247*       ELSE
  2248*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2249*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2250*          (WS-WORK-DIS-RATE / +12)
  2251*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2252*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2253*                              WK5
  2254*          GO TO 9999-CALC-RATE-PREM-X.
  2255
  2256     IF CP-TERM-IS-DAYS
  2257         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2258             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2259         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2260             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2261                          * CP-TERM-OR-EXT-DAYS
  2262           GO TO 9999-CALC-RATE-PREM-X.
  2263
  2264     if (cp-company-id = 'AHL')
  2265        and (cp-loan-term > cp-original-term)
  2266        continue
  2267     else
  2268        IF NOT CP-TRUNCATED-LIFE
  2269           GO TO 1212-GROSS-NOT-TRUNCATED
  2270        end-if
  2271     end-if
  2272
  2273****  GROSS TRUNCATED CALCULATION
  2274
  2275     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2276         MOVE 'H'                TO  CP-RETURN-CODE
  2277         GO TO 9999-CALC-RATE-PREM-X.
  2278     if cp-company-id = 'AHL'
  2279        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2280           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2281           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2282           cp-original-term) * (cp-loan-term - cp-original-term
  2283            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2284            cp-premium-rate / 100 * cp-original-term /
  2285            cp-loan-term * cp-original-benefit
  2286        else
  2287           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2288           cp-original-term) * (cp-loan-term - cp-original-term
  2289            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2290            cp-premium-rate * cp-original-benefit / 100
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  45
* ELRATE.cbl
  2291        end-if
  2292        go to 9999-calc-rate-prem-x
  2293     end-if
  2294
  2295     IF CP-COMPANY-ID = 'NCL'
  2296         COMPUTE WK-MONTHLY-RATE =
  2297               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2298                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2299                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2300                                 /
  2301                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2302                                 *
  2303                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2304         COMPUTE CP-CALC-PREMIUM =
  2305                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2306     ELSE
  2307         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2308                                 CP-ORIGINAL-TERM
  2309         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2310                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2311                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2312                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2313     END-IF
  2314     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2315        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2316           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2317           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2318     END-IF
  2319     GO TO 9999-CALC-RATE-PREM-X
  2320     .
  2321 1212-GROSS-NOT-TRUNCATED.
  2322*    DISPLAY ' ELCRATPD '
  2323*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2324*    display ' premium rate ' cp-premium-rate
  2325
  2326     IF (CP-COMPANY-ID = 'CID')
  2327        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2328           OR 'IN')
  2329        AND (CP-BENEFIT-CD = '55' OR '56')
  2330        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2331          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2332          (CP-ORIGINAL-TERM) *
  2333          ((CP-ORIGINAL-TERM) / 12) *
  2334          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2335          GO TO 9999-CALC-RATE-PREM-X
  2336     END-IF
  2337     IF (CP-COMPANY-ID = 'CID')
  2338        AND (CP-STATE-STD-ABBRV = 'GA')
  2339        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2340        COMPUTE WK3 ROUNDED =
  2341          CP-ORIGINAL-BENEFIT *
  2342          ((CP-ORIGINAL-TERM + 1) / 2) *
  2343          (RT-DISCOUNT-OB-RATE / 1000)
  2344          MOVE WK3 TO CP-CALC-PREMIUM
  2345          GO TO 9999-CALC-RATE-PREM-X
  2346     END-IF
  2347     IF (CP-COMPANY-ID EQUAL 'CID')
  2348        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  46
* ELRATE.cbl
  2349        AND (CP-LEVEL-LIFE)
  2350        AND (CP-CERT-EFF-DT > X'A4FF')
  2351        display ' made it to mn level '
  2352        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2353        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2354        MOVE '1'                 TO DC-OPTION-CODE
  2355        PERFORM 9100-CONVERT-DATE
  2356                                 THRU 9100-EXIT
  2357        IF DATE-CONVERSION-ERROR
  2358           MOVE '2'              TO CP-RETURN-CODE
  2359           MOVE ZEROS            TO FACTOR
  2360                                 CP-CALC-PREMIUM
  2361           GO TO 9999-CALC-RATE-PREM-X
  2362        END-IF
  2363        MOVE DC-ELAPSED-DAYS     TO D
  2364        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2365           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2366           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2367        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2368           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2369        GO TO 9999-CALC-RATE-PREM-X
  2370     END-IF
  2371     IF (CP-COMPANY-ID = 'CID')
  2372        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2373        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2374           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2375     ELSE
  2376        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2377                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2378     END-IF
  2379*    display ' calc premium ' cp-calc-premium
  2380
  2381*    IF CP-COMPANY-ID = 'LBL'
  2382     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2383        AND (NOT CP-EARN-AS-NET-PAY)
  2384        GO TO 9999-CALC-RATE-PREM-X
  2385     END-IF
  2386
  2387*    display ' fell through to ext days '
  2388     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2389         GO TO 9999-CALC-RATE-PREM-X.
  2390
  2391     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2392         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2393            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2394               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2395
  2396     GO TO 9999-CALC-RATE-PREM-X.
  2397
  2398 1220-CRITICAL-PERIOD-LF-CONT.
  2399     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2400               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2401
  2402     GO TO 9999-CALC-RATE-PREM-X.
  2403
  2404 1230-TEXAS-CONT.
  2405     IF CP-FARM-PLAN
  2406         GO TO 1235-TEXAS-FARM-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  47
* ELRATE.cbl
  2407
  2408     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2409               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2410
  2411     COMPUTE TEX-FACT-9 =
  2412                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2413                 (CP-ORIGINAL-TERM + 1).
  2414
  2415     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2416                 CP-CALC-PREMIUM * TEX-FACT-9.
  2417
  2418     GO TO 9999-CALC-RATE-PREM-X.
  2419
  2420 1235-TEXAS-FARM-CONT.
  2421     COMPUTE WS-FARM-TERM =
  2422               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2423
  2424     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2425     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2426
  2427
  2428     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2429              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2430
  2431     GO TO 9999-CALC-RATE-PREM-X.
  2432
  2433 1240-NET-PAY-CONT.
  2434
  2435     MOVE CP-LOAN-APR             TO N-P-APR.
  2436     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2437                                     N-P-REM
  2438                                     N-P-LOAN.
  2439
  2440     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2441
  2442     IF CP-TRUNCATED-LIFE
  2443         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2444
  2445     IF CP-COMPANY-ID EQUAL 'NCL'
  2446        NEXT SENTENCE
  2447     ELSE
  2448        GO TO 1241-NET-PAY-CONT.
  2449
  2450     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2451     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2452     MOVE '1'                    TO DC-OPTION-CODE
  2453     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2454     IF DATE-CONVERSION-ERROR
  2455         MOVE '2'                TO CP-RETURN-CODE
  2456         GO TO 9999-CALC-RATE-PREM-X
  2457     ELSE
  2458        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2459        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2460
  2461     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2462        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2463        NEXT SENTENCE
  2464     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  48
* ELRATE.cbl
  2465        MOVE +1                  TO ODF
  2466        GO TO 1241-NET-PAY-CONT.
  2467
  2468     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2469        COMPUTE CP-PREMIUM-RATE EQUAL
  2470        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2471        CP-PREMIUM-RATE) *
  2472        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2473
  2474     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2475        COMPUTE CP-PREMIUM-RATE EQUAL
  2476        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2477        N-P-LOAN * (N-P-LOAN - 1))) *
  2478        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2479        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2480
  2481     COMPUTE ODF EQUAL
  2482     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2483     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2484
  2485 1241-NET-PAY-CONT.
  2486
  2487     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2488
  2489*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2490     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2491        NEXT SENTENCE
  2492     ELSE
  2493        GO TO 9999-CALC-RATE-PREM-X.
  2494
  2495     IF RT-DISCOUNT-OPTION EQUAL '6'
  2496         GO TO 9999-CALC-RATE-PREM-X.
  2497
  2498     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2499        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2500        GO TO 9999-CALC-RATE-PREM-X.
  2501
  2502     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2503
  2504     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2505        GO TO 9999-CALC-RATE-PREM-X.
  2506
  2507     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2508        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2509        (CP-TRUNCATED-LIFE)
  2510        GO TO 9999-CALC-RATE-PREM-X.
  2511
  2512     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2513        (CP-CSL-VALID-NP-BENEFIT-CD)
  2514        GO TO 9999-CALC-RATE-PREM-X.
  2515
  2516     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2517        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2518        (CP-EARN-AS-NET-PAY)
  2519        GO TO 9999-CALC-RATE-PREM-X.
  2520
  2521*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2522*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  49
* ELRATE.cbl
  2523*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2524*       GO TO 9999-CALC-RATE-PREM-X.
  2525
  2526     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2527        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2528        (CP-EARN-AS-NET-PAY)
  2529        GO TO 9999-CALC-RATE-PREM-X.
  2530
  2531     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2532        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2533        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2534        GO TO 9999-CALC-RATE-PREM-X.
  2535
  2536     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2537        (CP-EARN-AS-NET-PAY)
  2538        GO TO 9999-CALC-RATE-PREM-X.
  2539
  2540     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2541        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2542        (CP-TRUNCATED-LIFE)
  2543        GO TO 9999-CALC-RATE-PREM-X.
  2544
  2545     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2546        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2547        (CP-EARN-AS-NET-PAY)
  2548*       (CP-TRUNCATED-LIFE)
  2549        GO TO 9999-CALC-RATE-PREM-X.
  2550
  2551     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2552        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2553                   AND
  2554        ((CP-EARN-AS-NET-PAY)
  2555               OR
  2556        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2557        GO TO 9999-CALC-RATE-PREM-X.
  2558
  2559     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2560        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2561        (CP-EARN-AS-NET-PAY) AND
  2562        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2563        GO TO 9999-CALC-RATE-PREM-X.
  2564
  2565     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2566        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2567        (CP-EARN-AS-NET-PAY)
  2568        GO TO 9999-CALC-RATE-PREM-X.
  2569
  2570     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2571        CONTINUE
  2572     ELSE
  2573        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2574           (CP-EARN-AS-NET-PAY) AND
  2575           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2576           GO TO 9999-CALC-RATE-PREM-X
  2577        END-IF
  2578     END-IF
  2579
  2580     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  50
* ELRATE.cbl
  2581        AND (CP-EARN-AS-NET-PAY)
  2582        AND (CP-STATE-STD-ABBRV = 'ME')
  2583        GO TO 9999-CALC-RATE-PREM-X
  2584     END-IF
  2585     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2586        AND (CP-BEN-CATEGORY = 'D')
  2587        AND (CP-EARN-AS-NET-PAY)
  2588        GO TO 9999-CALC-RATE-PREM-X
  2589     END-IF
  2590     IF (CP-COMPANY-ID = 'CID')
  2591        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2592           OR 'IN' OR 'AZ')
  2593        AND (CP-FARM-PLAN)
  2594        GO TO 9999-CALC-RATE-PREM-X
  2595     END-IF
  2596     IF (CP-COMPANY-ID = 'CID') AND
  2597        (CP-EARN-AS-NET-PAY) AND
  2598        (CP-LEVEL-LIFE) AND
  2599        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2600        (CP-STATE-STD-ABBRV = CP-STATE)
  2601        GO TO 9999-CALC-RATE-PREM-X
  2602     END-IF
  2603
  2604     IF (CP-COMPANY-ID = 'CID') AND
  2605        (CP-EARN-AS-NET-PAY) AND
  2606        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2607                            OR 'VT')
  2608                   OR
  2609        ((CP-STATE-STD-ABBRV = 'IN') AND
  2610        (CP-CERT-EFF-DT > X'9A7F'))
  2611                   OR
  2612        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2613        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2614        (CP-STATE-STD-ABBRV = CP-STATE)
  2615        GO TO 9999-CALC-RATE-PREM-X
  2616     END-IF
  2617
  2618     IF (CP-COMPANY-ID = 'CID') AND
  2619        (CP-EARN-AS-NET-PAY) AND
  2620        (CP-STATE-STD-ABBRV = 'TX') AND
  2621        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2622        (WS-DISCOUNT-OPTION NOT = ' ')
  2623        GO TO 9999-CALC-RATE-PREM-X
  2624     END-IF
  2625
  2626     if (cp-company-id = 'CID')
  2627        and (cp-state-std-abbrv = 'WA')
  2628        and (rt-discount-option = '1')
  2629        and (cp-earn-as-farm-plan)
  2630        go to 9999-calc-rate-prem-x
  2631     end-if
  2632     if (cp-company-id = 'CID')
  2633        and (cp-earn-as-reg-balloon)
  2634        and (cp-ben-category = 'P' or 'I')
  2635        GO TO 9999-CALC-RATE-PREM-X
  2636     end-if
  2637     IF (CP-COMPANY-ID = 'CID')
  2638        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  51
* ELRATE.cbl
  2639        AND (RT-DISCOUNT-OPTION = '1')
  2640        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2641           CP-EARN-AS-FARM-PLAN)
  2642        display ' made it to mn 4 '
  2643        GO TO 9999-CALC-RATE-PREM-X
  2644     END-IF
  2645     IF (CP-COMPANY-ID = 'CID')
  2646        AND (CP-EARN-AS-NET-PAY)
  2647        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2648                      OR
  2649            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2650        GO TO 9999-CALC-RATE-PREM-X
  2651     END-IF
  2652     IF (CP-COMPANY-ID = 'CID')
  2653        AND (CP-EARN-AS-NET-PAY)
  2654        AND (CP-STATE-STD-ABBRV = 'SC')
  2655        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2656        GO TO 9999-CALC-RATE-PREM-X
  2657     END-IF
  2658     IF (CP-COMPANY-ID = 'CID') AND
  2659        (CP-EARN-AS-NET-PAY) AND
  2660        (CP-TRUNCATED-LIFE) AND
  2661        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2662        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2663        (WS-DISCOUNT-OPTION NOT = ' ')
  2664        GO TO 9999-CALC-RATE-PREM-X
  2665     END-IF
  2666
  2667     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP') AND
  2668        (CP-EARN-AS-NET-PAY)
  2669        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2670        GO TO 9999-CALC-RATE-PREM-X
  2671     END-IF
  2672
  2673     IF (CP-COMPANY-ID EQUAL 'CID')
  2674        AND (CP-EARN-AS-NET-PAY)
  2675        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2676        GO TO 9999-CALC-RATE-PREM-X
  2677     END-IF
  2678
  2679     IF (RT-IS-OB) AND
  2680        (CP-COMPANY-ID NOT EQUAL 'CID')
  2681        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2682               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2683      ELSE
  2684         IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2685            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2686            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2687*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2688             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2689               CP-ORIGINAL-TERM
  2690             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2691             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2692        ELSE
  2693           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2694               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2695        END-IF
  2696     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  52
* ELRATE.cbl
  2697
  2698     IF CP-ROA-PREM-AT-REFUND
  2699         COMPUTE NET-BEN ROUNDED =
  2700             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2701     ELSE
  2702         COMPUTE NET-BEN ROUNDED =
  2703              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2704
  2705     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2706        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2707          COMPUTE NET-BEN ROUNDED =
  2708              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2709                         (CP-TERM-OR-EXT-DAYS / 30)).
  2710
  2711     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2712*       OR 'DCC'
  2713*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2714     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2715       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2716       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2717                        * CP-ORIGINAL-TERM / 1200))
  2718     ELSE
  2719     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2720       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2721       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2722
  2723****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2724****** INTEREST IS CHARGED ON PREMIUM.
  2725
  2726*    IF CP-STATE-STD-ABBRV = 'MI'
  2727*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2728*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2729
  2730     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2731
  2732     GO TO 9999-CALC-RATE-PREM-X.
  2733
  2734******
  2735****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2736******
  2737
  2738 1250-CSL-CALC.
  2739     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2740     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2741     MOVE '1' TO DC-OPTION-CODE.
  2742     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2743
  2744     IF DATE-CONVERSION-ERROR
  2745         MOVE '2' TO CP-RETURN-CODE
  2746         GO TO 9999-CALC-RATE-PREM-X.
  2747
  2748     IF CP-JOINT-INDICATOR = 'J'
  2749         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2750     ELSE
  2751         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2752
  2753     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2754     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  53
* ELRATE.cbl
  2755
  2756     IF CP-PAY-FREQUENCY = 12
  2757         MOVE 01               TO WS-PAY-SCH.
  2758     IF CP-PAY-FREQUENCY = 04
  2759         MOVE 03               TO WS-PAY-SCH.
  2760     IF CP-PAY-FREQUENCY = 02
  2761         MOVE 06               TO WS-PAY-SCH.
  2762     IF CP-PAY-FREQUENCY = 01
  2763         MOVE 12               TO WS-PAY-SCH.
  2764
  2765     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2766     IF CP-PAY-FREQUENCY NOT = 12
  2767         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2768                                WS-NUM-PAYMTS.
  2769
  2770     IF CP-STATE = 'SC'  AND
  2771       (CP-BENEFIT-CD = '07'  OR  '08')
  2772         GO TO 1250-CSL-CALC-LIFE-6.
  2773
  2774     IF CP-CSL-METH-1
  2775         GO TO 1250-CSL-CALC-LIFE-1.
  2776
  2777     IF CP-CSL-METH-2
  2778         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2779                          WS-MAX-TOT-BEN
  2780             GO TO 1250-CSL-CALC-LIFE-2
  2781         ELSE
  2782             GO TO 1250-CSL-CALC-LIFE-1.
  2783
  2784     IF CP-CSL-METH-3
  2785         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2786             GO TO 1250-CSL-CALC-LIFE-2
  2787         ELSE
  2788             GO TO 1250-CSL-CALC-LIFE-3.
  2789
  2790     IF CP-CSL-METH-4
  2791         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2792                          WS-MAX-TOT-BEN
  2793             GO TO 1250-CSL-CALC-LIFE-5
  2794         ELSE
  2795             GO TO 1250-CSL-CALC-LIFE-4.
  2796
  2797 1250-CSL-CALC-LIFE-1.
  2798     IF CP-JOINT-INDICATOR = 'J'
  2799         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2800     ELSE
  2801         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2802
  2803     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2804                    365) - 1) * 365 / 12.
  2805     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2806                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2807                    4380.
  2808     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2809                    WS-NUM-PAYMTS * WK-S.
  2810
  2811     GO TO 9999-CALC-RATE-PREM-X.
  2812
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  54
* ELRATE.cbl
  2813 1250-CSL-CALC-LIFE-2.
  2814     IF CP-JOINT-INDICATOR = 'J'
  2815         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2816     ELSE
  2817         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2818
  2819     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2820     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2821     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2822                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2823                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2824     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2825                    WK-S) + WK-D.
  2826
  2827     GO TO 9999-CALC-RATE-PREM-X.
  2828
  2829 1250-CSL-CALC-LIFE-3.
  2830     IF CP-JOINT-INDICATOR = 'J'
  2831         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2832     ELSE
  2833         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2834
  2835     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2836     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2837     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2838                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2839                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2840     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2841                    WK-S) + WK-D.
  2842
  2843     GO TO 9999-CALC-RATE-PREM-X.
  2844
  2845 1250-CSL-CALC-LIFE-4.
  2846     IF CP-JOINT-INDICATOR = 'J'
  2847         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2848     ELSE
  2849         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2850
  2851     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2852     COMPUTE WK-S ROUNDED =
  2853                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2854                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2855                    CP-PAY-FREQUENCY.
  2856     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2857                    WS-NUM-PAYMTS * WK-S.
  2858
  2859     GO TO 9999-CALC-RATE-PREM-X.
  2860
  2861 1250-CSL-CALC-LIFE-5.
  2862     IF CP-JOINT-INDICATOR = 'J'
  2863         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2864     ELSE
  2865         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2866
  2867     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2868     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2869                    CP-PAY-FREQUENCY.
  2870     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  55
* ELRATE.cbl
  2871                    - 1) + WS-NUM-PAYMTS) * 12) /
  2872                    CP-PAY-FREQUENCY.
  2873     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2874     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2875                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2876
  2877     GO TO 9999-CALC-RATE-PREM-X.
  2878
  2879 1250-CSL-CALC-LIFE-6.
  2880
  2881     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2882                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2883
  2884     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2885                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2886
  2887     GO TO 9999-CALC-RATE-PREM-X.
  2888
  2889******
  2890****** END OF PREMIUM CALCULATIONS FOR CSL
  2891******
  2892
  2893 1260-GTL-PA-LEASE.
  2894
  2895     IF CP-REDUCING-LIFE
  2896         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2897                                 TO  CP-PREMIUM-RATE
  2898         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2899                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2900     ELSE
  2901         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2902                                 TO  CP-PREMIUM-RATE
  2903         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2904                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2905                 (+1 + CP-SALES-TAX) / +100.
  2906
  2907     GO TO 9999-CALC-RATE-PREM-X.
  2908
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  56
* ELRATE.cbl
  2910******************************************************************
  2911 2000-TYPE-IS-AH.
  2912     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2913
  2914     MOVE ZERO                      TO CP-R-MAX-AGE
  2915                                       CP-R-MAX-TERM
  2916                                       CP-R-MAX-MON-BEN
  2917                                       CP-R-MAX-TOT-BEN.
  2918
  2919     IF RT-CANCEL-FEE NUMERIC
  2920        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  2921
  2922     IF RT-COMPOSITE-RATE NOT NUMERIC
  2923        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2924
  2925     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2926        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2927                                 TO CP-PREMIUM-RATE
  2928                                    WS-PREMIUM-RATE
  2929        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2930     ELSE
  2931         MOVE +0                 TO CP-PREMIUM-RATE
  2932                                    CP-CALC-PREMIUM
  2933         GO TO 9999-CALC-RATE-PREM-X
  2934     END-IF
  2935
  2936     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2937        AND (CP-DDF-SPEC-CALC = 'T')
  2938        AND (CP-LOAN-TERM > ZERO AND < 361)
  2939        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2940                                 TO CP-PREMIUM-RATE
  2941                                    WS-PREMIUM-RATE
  2942     END-IF
  2943*    IF (CP-COMPANY-ID = 'DCC')
  2944*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2945*       OR (CP-DDF-SPEC-CALC = 'T'))
  2946*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2947*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2948*                                TO CP-PREMIUM-RATE
  2949*                                   WS-PREMIUM-RATE
  2950*    END-IF
  2951     MOVE +1 TO AHNDX.
  2952
  2953     IF CP-COMPANY-ID EQUAL 'CRI'
  2954        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2955           MOVE +5               TO AHNDX
  2956           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2957              MOVE 'F'           TO CP-RETURN-CODE
  2958              GO TO 2200-CALCULATE-PREMIUMS.
  2959
  2960     IF RT-AH-AGE (AHNDX) = ZERO
  2961          GO TO 2200-CALCULATE-PREMIUMS.
  2962
  2963 2100-SEARCH-AH-LIMITS.
  2964
  2965     IF CP-COMPANY-ID EQUAL 'CRI'
  2966        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2967           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  57
* ELRATE.cbl
  2968              MOVE 'A'             TO CP-RETURN-CODE
  2969              GO TO 2200-CALCULATE-PREMIUMS.
  2970
  2971     IF AHNDX GREATER +8
  2972         MOVE 'A'                TO CP-RETURN-CODE
  2973         GO TO 2200-CALCULATE-PREMIUMS.
  2974
  2975     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2976         IF RT-AH-AGE (AHNDX) = ZEROS
  2977             ADD +1               TO AHNDX
  2978             GO TO 2100-SEARCH-AH-LIMITS
  2979         ELSE
  2980             MOVE RT-AH-AGE (AHNDX)
  2981                                 TO CP-R-MAX-AGE
  2982             MOVE RT-AH-TERM (AHNDX)
  2983                                 TO CP-R-MAX-TERM
  2984             MOVE RT-AH-BEN-M (AHNDX)
  2985                                 TO CP-R-MAX-MON-BEN
  2986             ADD +1               TO AHNDX
  2987             GO TO 2100-SEARCH-AH-LIMITS
  2988     ELSE
  2989         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2990         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2991         MOVE RT-AH-BEN-M (AHNDX)
  2992                                 TO CP-R-MAX-MON-BEN.
  2993
  2994     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2995         MOVE '9'                 TO CP-RETURN-CODE.
  2996
  2997     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2998         MOVE '8'                 TO CP-RETURN-CODE.
  2999
  3000     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  3001         GIVING WS-AH-FACE-BENEFIT.
  3002
  3003     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  3004         MOVE 'C'                 TO CP-RETURN-CODE.
  3005
  3006 2200-CALCULATE-PREMIUMS.
  3007
  3008     IF CP-COMPANY-ID = 'CSL'
  3009         GO TO 2250-CSL-CALC.
  3010
  3011*    IF CP-CRITICAL-PERIOD
  3012*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  3013
  3014     IF CP-CRITICAL-PERIOD
  3015        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3016           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  3017               OR 'S' OR 'P')
  3018                          OR
  3019                (CP-BEN-CATEGORY = 'G' OR 'L'))
  3020           CONTINUE
  3021        ELSE
  3022           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  3023        END-IF
  3024     END-IF
  3025
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  58
* ELRATE.cbl
  3026     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3027        AND (CP-BEN-CATEGORY = 'D')
  3028        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  3029           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  3030     END-IF
  3031     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  3032        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  3033        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  3034                                     CP-PREMIUM-RATE
  3035        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  3036        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  3037        CP-PREMIUM-RATE) / +100
  3038     ELSE
  3039        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3040           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  3041           MOVE CP-PREMIUM-RATE  TO WK-S
  3042*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  3043           IF CP-RATE-DEV-PCT NOT = ZEROS
  3044              COMPUTE WK-S ROUNDED =
  3045                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  3046           END-IF
  3047           IF CP-BENEFIT-CD (1:1) = 'M'
  3048              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3049              CP-ORIGINAL-BENEFIT * WK-S / 100
  3050           ELSE
  3051              IF CP-BENEFIT-CD (1:1) = 'H'
  3052                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3053                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3054                    WK-S) / 1000
  3055              ELSE
  3056                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  3057                    GO TO 2300-CALC-DCC-MOB-NET-AH
  3058                 ELSE
  3059                    IF CP-BEN-CATEGORY = 'D'
  3060                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3061                        CP-ORIGINAL-BENEFIT *
  3062                        CP-ORIGINAL-TERM * WK-S / 100
  3063                    ELSE
  3064                      IF CP-BENEFIT-CD (1:1) = 'P'
  3065                         GO TO 2300-CALC-DCC-BEN-P-AH
  3066                      ELSE
  3067                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3068                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3069                        WK-S) / 100
  3070                      END-IF
  3071                    END-IF
  3072                 END-IF
  3073              END-IF
  3074           END-IF
  3075           MOVE ZEROS            TO CP-RATE-DEV-PCT
  3076        ELSE
  3077           IF CP-BENEFIT-CD (1:1) = 'M'
  3078              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3079                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  3080           ELSE
  3081              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  3082                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3083                    (CP-NET-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  59
* ELRATE.cbl
  3084                    CP-PREMIUM-RATE) / 1000
  3085              ELSE
  3086                 IF CP-AH-BALLOON-SW = 'Y'
  3087                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3088                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3089                      CP-PREMIUM-RATE) / 100
  3090                 ELSE
  3091                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  3092                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3093                    CP-PREMIUM-RATE) / 100
  3094                 END-IF
  3095              END-IF
  3096           END-IF
  3097        END-IF
  3098     END-IF
  3099
  3100     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3101        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3102        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3103     END-IF
  3104     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3105         GO TO 9999-CALC-RATE-PREM-X.
  3106
  3107     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3108         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3109             CP-CALC-PREMIUM +
  3110                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3111                                       * CP-TERM-OR-EXT-DAYS).
  3112
  3113     GO TO 9999-CALC-RATE-PREM-X.
  3114
  3115 2200-CRITICAL-PERIOD-AH-CONT.
  3116
  3117     IF CP-COMPANY-ID = 'WDS'
  3118         IF CP-ORIGINAL-TERM GREATER THAN 60
  3119             MOVE 60              TO CP-LOAN-TERM.
  3120
  3121     IF CP-COMPANY-ID EQUAL 'CVL'
  3122         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3123           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3124                                       * CP-PREMIUM-RATE
  3125         GO TO 9999-CALC-RATE-PREM-X.
  3126
  3127     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3128           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3129                                       * CP-PREMIUM-RATE.
  3130
  3131     GO TO 9999-CALC-RATE-PREM-X.
  3132
  3133 2250-CSL-CALC.
  3134
  3135     IF RT-DAILY-RATE NOT NUMERIC OR
  3136        RT-DAILY-RATE = ZEROS
  3137            MOVE ZEROS TO CP-CALC-PREMIUM
  3138            MOVE '7' TO CP-RETURN-CODE
  3139            GO TO 9999-CALC-RATE-PREM-X.
  3140
  3141     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  60
* ELRATE.cbl
  3142     COMPUTE WK-MONTHLY-RATE =
  3143          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3144
  3145     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3146     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3147     MOVE '1' TO DC-OPTION-CODE.
  3148     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3149     IF DATE-CONVERSION-ERROR
  3150         MOVE '2' TO CP-RETURN-CODE
  3151         GO TO 9999-CALC-RATE-PREM-X.
  3152
  3153     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3154     IF CP-CSL-METH-1
  3155         GO TO 2250-CSL-CALC-AH-1.
  3156     IF CP-CSL-METH-2
  3157         GO TO 2250-CSL-CALC-AH-2.
  3158     IF CP-CSL-METH-3
  3159         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3160             GO TO 2250-CSL-CALC-AH-4
  3161         ELSE
  3162             GO TO 2250-CSL-CALC-AH-3.
  3163
  3164 2250-CSL-CALC-AH-1.
  3165
  3166     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3167     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3168                    + WK-MONTHLY-RATE.
  3169     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3170                    CP-ORIGINAL-TERM * WK-D.
  3171
  3172     GO TO 9999-CALC-RATE-PREM-X.
  3173
  3174
  3175 2250-CSL-CALC-AH-2.
  3176     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3177     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3178                    + WK-MONTHLY-RATE.
  3179     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3180                    CP-ORIGINAL-TERM * WK-D.
  3181
  3182     GO TO 9999-CALC-RATE-PREM-X.
  3183
  3184 2250-CSL-CALC-AH-3.
  3185
  3186     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3187     COMPUTE WK-T = WK-K + 1.
  3188     COMPUTE WK-MONTHLY-RATE-T =
  3189          RT-AH-RATE (WK-T) / 100.
  3190     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3191
  3192     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3193     IF WK-T1 EQUAL ZEROS
  3194         MOVE ZEROS TO CP-CALC-PREMIUM
  3195         MOVE 'G' TO CP-RETURN-CODE
  3196         GO TO 9999-CALC-RATE-PREM-X.
  3197
  3198     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3199                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  61
* ELRATE.cbl
  3200                    - WK-T)).
  3201     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3202     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3203                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3204                       WS-MAX-TOT-BEN).
  3205     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3206                    WK-MONTHLY-RATE-T) + WK-PREM.
  3207
  3208     GO TO 9999-CALC-RATE-PREM-X.
  3209
  3210 2250-CSL-CALC-AH-4.
  3211     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3212     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3213     COMPUTE WK-MONTHLY-RATE-J =
  3214          RT-AH-RATE (WK-J) / 100.
  3215     COMPUTE WK-T = WK-J + 1.
  3216     COMPUTE WK-MONTHLY-RATE-T =
  3217          RT-AH-RATE (WK-T) / 100.
  3218     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3219     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3220                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3221                    (CP-ORIGINAL-TERM - WK-T)).
  3222     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3223     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3224                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3225                       WS-MAX-TOT-BEN).
  3226     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3227                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3228
  3229     GO TO 9999-CALC-RATE-PREM-X.
  3230
  3231 2300-CALC-DCC-BEN-P-AH.
  3232     IF CP-NO-OF-PMTS NOT NUMERIC
  3233        MOVE +0                  TO CP-NO-OF-PMTS
  3234     END-IF
  3235     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3236        AND ' ' AND 'M'
  3237        MOVE ' '                 TO CP-PMT-MODE
  3238     END-IF
  3239******************************************************************
  3240***   Default is monthly, use loan term for rate and amort     ***
  3241******************************************************************
  3242     move cp-loan-term         to c-tot-pmts
  3243     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3244     MOVE +12                  TO C-PMTS-PER-YEAR
  3245******************************************************************
  3246
  3247     evaluate true
  3248        when cp-pmt-mode = 'W'
  3249           MOVE +52              TO C-PMTS-PER-YEAR
  3250           compute c-tot-pmts = cp-loan-term /
  3251              12 * c-pmts-per-year
  3252           MOVE +7               TO C-DAYS-IN-PMT-PER
  3253        when cp-pmt-mode = 'B'
  3254           MOVE +26              TO C-PMTS-PER-YEAR
  3255           compute c-tot-pmts = cp-loan-term /
  3256              12 * c-pmts-per-year
  3257           MOVE +14              TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  62
* ELRATE.cbl
  3258     end-evaluate
  3259     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3260     if i = zeros
  3261        move .0000000001         to i
  3262     end-if
  3263     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3264        C-DAYS-IN-PMT-PER)) / (1 + I)
  3265     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3266     COMPUTE ANGLEN-1 = ANGLEN / Y
  3267     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3268        / ANGLEN-1
  3269     if cp-net-benefit-amt = zeros
  3270        compute wk3 = cp-original-benefit - cp-original-premium
  3271     end-if
  3272     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3273     GO TO 9999-CALC-RATE-PREM-X
  3274     .
  3275 2300-CALC-DCC-MOB-NET-AH.
  3276     IF CP-ALTERNATE-BENEFIT = ZEROS
  3277        CONTINUE
  3278     ELSE
  3279        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3280     END-IF
  3281     MOVE CP-ORIGINAL-TERM       TO M
  3282     MOVE CP-LOAN-TERM           TO N
  3283     IF N = ZEROS
  3284        MOVE M                   TO N
  3285     END-IF
  3286     COMPUTE I = CP-LOAN-APR / +1200
  3287     if i = zeros
  3288        move .0000000001         to i
  3289     end-if
  3290     IF CP-BENEFIT-CD (1:1) = 'S'
  3291        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3292        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3293        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3294          (WK-S / 1000)
  3295          * 1
  3296        MOVE WK3                 TO CP-CALC-PREMIUM
  3297        GO TO 9999-CALC-RATE-PREM-X
  3298     END-IF
  3299     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3300        / (1 + I)
  3301     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3302          ** ((N - M) * -1))) / I)
  3303     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3304     COMPUTE J = I + (WK-S / +1000)
  3305     COMPUTE WK2 = (1 + J) ** (M * -1)
  3306     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3307     COMPUTE ANGLEM = ((1 - ((1 + J)
  3308          ** (M * -1))) / J) / OD
  3309     IF CP-NET-BENEFIT-AMT = ZEROS
  3310        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3311           * ANGLEM
  3312     END-IF
  3313     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3314     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3315          ** ((N - M) * -1))) / I)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  63
* ELRATE.cbl
  3316     MOVE +0                     TO WK3
  3317     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3318        (WS-COUNTER > M)
  3319        COMPUTE ANGLEM = (1 - ((1 + J)
  3320          ** ((M - WS-COUNTER + 1) * -1))) / J
  3321        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3322        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3323        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3324     END-PERFORM
  3325     MOVE WK3                    TO CP-CALC-PREMIUM
  3326     GO TO 9999-CALC-RATE-PREM-X
  3327     .
  3328 2300-CALC-DCC-MOB-BAL-AH.
  3329     IF CP-BENEFIT-CD (1:1) = 'S'
  3330        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3331     END-IF
  3332     MOVE CP-ORIGINAL-TERM       TO M
  3333     MOVE CP-LOAN-TERM           TO N
  3334     IF N = ZEROS
  3335        MOVE M                   TO N
  3336     END-IF
  3337     COMPUTE I = CP-LOAN-APR / +1200
  3338     if i = zeros
  3339        move .0000000001         to i
  3340     end-if
  3341     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3342        / (1 + I)
  3343     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3344     COMPUTE J = I + (WK-S / +1000)
  3345     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3346     MOVE I TO K
  3347     COMPUTE WK2 = (1 + J) ** (M * -1)
  3348     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3349     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3350          ** ((M - 1) * -1))) / J)
  3351     COMPUTE ANGLEM = ((1 - ((1 + J)
  3352          ** (M * -1))) / J) / OD
  3353     IF CP-NET-BENEFIT-AMT = ZEROS
  3354        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3355           * ANGLEM
  3356     END-IF
  3357     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3358        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3359        / ANGLEM-1
  3360     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3361          ** ((N - M) * -1))) / I)
  3362     MOVE +0                     TO WK3
  3363     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3364        (WS-COUNTER > M)
  3365        COMPUTE ANGLEM = (1 - ((1 + J)
  3366          ** ((M - WS-COUNTER) * -1))) / J
  3367        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3368        COMPUTE WK5-CSL = (RA * ANGLEM)
  3369        + (CP-ALTERNATE-BENEFIT * WK2)
  3370        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3371          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3372          (WK-S / 1000)
  3373     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  64
* ELRATE.cbl
  3374     MOVE WK3                    TO CP-CALC-PREMIUM
  3375     GO TO 9999-CALC-RATE-PREM-X
  3376     .
  3377 2300-CALC-DCC-MOB-BAL-AHSUM.
  3378     MOVE CP-ORIGINAL-TERM       TO M
  3379     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3380        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3381        * WK-S / 1000
  3382*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3383*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3384*       * WK-S / 1000
  3385     MOVE WK3                    TO CP-CALC-PREMIUM
  3386     GO TO 9999-CALC-RATE-PREM-X
  3387     .
  3388 9999-RATE-NOTFND.
  3389     MOVE '6'                    TO CP-RETURN-CODE.
  3390     GO TO 9999-CALC-RATE-PREM-X.
  3391
  3392 9999-RATE-NOTOPEN.
  3393     MOVE 'D'                    TO CP-RETURN-CODE.
  3394     GO TO 9999-CALC-RATE-PREM-X.
  3395
  3396 9999-CALC-RATE-PREM-X.
  3397     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3398        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3399        CONTINUE
  3400     ELSE
  3401        IF CP-RATE-DEV-PCT NOT = ZERO
  3402           COMPUTE CP-CALC-PREMIUM =
  3403              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3404
  3405
  3406     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3407
  3408     IF WS-BROWSE-STARTED
  3409
  3410* EXEC CICS ENDBR
  3411*            DATASET  (ERRATE-FILE-ID)
  3412*       END-EXEC.
  3413     MOVE 0
  3414       TO DFHEIV11
  3415*    MOVE '&2                    $   #00003362' TO DFHEIV0
  3416     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3417     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3418     MOVE X'2020233030303033333632' TO DFHEIV0(25:11)
  3419     CALL 'kxdfhei1' USING DFHEIV0,
  3420           ERRATE-FILE-ID,
  3421           DFHEIV11,
  3422           DFHEIV99
  3423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3424
  3425
  3426
  3427* EXEC CICS RETURN
  3428*    END-EXEC.
  3429*    MOVE '.(                    ''   #00003366' TO DFHEIV0
  3430     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  65
* ELRATE.cbl
  3432     MOVE X'2020233030303033333636' TO DFHEIV0(25:11)
  3433     CALL 'kxdfhei1' USING DFHEIV0,
  3434           DFHEIV99,
  3435           DFHEIV99,
  3436           DFHEIV99,
  3437           DFHEIV99,
  3438           DFHEIV99,
  3439           DFHEIV99
  3440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3441
  3442
  3443 9100-CONVERT-DATE.
  3444
  3445* EXEC CICS LINK
  3446*        PROGRAM  ('ELDATCV')
  3447*        COMMAREA (DATE-CONVERSION-DATA)
  3448*        LENGTH   (DC-COMM-LENGTH)
  3449*    END-EXEC.
  3450     MOVE 'ELDATCV' TO DFHEIV1
  3451*    MOVE '."C                   (   #00003370' TO DFHEIV0
  3452     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3454     MOVE X'2020233030303033333730' TO DFHEIV0(25:11)
  3455     CALL 'kxdfhei1' USING DFHEIV0,
  3456           DFHEIV1,
  3457           DATE-CONVERSION-DATA,
  3458           DC-COMM-LENGTH,
  3459           DFHEIV99,
  3460           DFHEIV99,
  3461           DFHEIV99,
  3462           DFHEIV99
  3463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3464
  3465
  3466 9100-EXIT.
  3467     EXIT.
  3468
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  66
* ELRATE.cbl
  3470 10000-NET-TERM SECTION.
  3471*                         COPY ERCNETP.
  3472*****************************************************************
  3473*                                                               *
  3474*                            ERCNETP                            *
  3475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3476*                            VMOD=2.029                         *
  3477*                                                               *
  3478*****************************************************************.
  3479*
  3480*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3481*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3482*                                   ORIGINAL TERM (S999)
  3483*                                   REMAINING TERM (S999)
  3484*                                   NET PAY OPTION (X)
  3485*                                   LOAN TERM (S999)
  3486*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3487*
  3488*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3489*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3490*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3491*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3492*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3493*    CHARGED.
  3494*
  3495*    OPTIONS - S = NET SIMPLE
  3496*          SPACE = NET PAY  (1 MO. INTEREST)
  3497*              A = NET PAY  (0 MO. INTEREST)
  3498*              I = NET PAY  (2 MO. INTEREST)
  3499*              J = NET PAY  (3 MO. INTEREST)
  3500*              K = NET PAY  (4 MO. INTEREST)
  3501*              T = TRUNCATED  (0 MO. INTEREST)
  3502*              U = TRUNCATED  (1 MO. INTEREST)
  3503*              V = TRUNCATED  (2 MO. INTEREST)
  3504*              W = TRUNCATED  (3 MO. INTEREST)
  3505*              X = TRUNCATED  (4 MO. INTEREST)
  3506*              R = REFUNDS (REGULAR OR TRUNCATED)
  3507******************************************************************
  3508*                   C H A N G E   L O G
  3509*
  3510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3511*-----------------------------------------------------------------
  3512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3513* EFFECTIVE    NUMBER
  3514*-----------------------------------------------------------------
  3515* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3516* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3517* 120403                   PEMA  ADD SPECIAL TX CALC
  3518* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3519* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3520* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3521* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3522* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3523* 021207                   PEMA  ADD PA NP
  3524* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3525* 032807                   PEMA  ADD VT NP PLUS 2
  3526* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3527* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  67
* ELRATE.cbl
  3528* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3529* 110207      TO 'AL' NET PAY CALC
  3530* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3531* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3532* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3533* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3534* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3535* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3536* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3537* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3538* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3539* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3540* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3541* 032612  CR2011110200001  PEMA  AHL CHANGES
  3542* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3543* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3544* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3545* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3546* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  3547* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3548******************************************************************
  3549
  3550     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3551     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3552     MOVE N-P-LOAN    TO LOAN-TERM.
  3553     MOVE N-P-REM     TO REMAINING-TERM.
  3554     MOVE N-P-OPT     TO OPTION-SW.
  3555
  3556     MOVE +0 TO FACTOR.
  3557     if cp-company-id = 'CID'
  3558        if annual-int-rate = +99.9999
  3559           go to 99000-error
  3560        end-if
  3561     else
  3562        if annual-int-rate = zero
  3563           go to 99000-error
  3564        end-if
  3565     end-if
  3566     IF ORIGINAL-TERM = ZERO
  3567         GO TO 99999-RETURN.
  3568     IF REMAINING-TERM = ZERO
  3569         GO TO 99999-RETURN.
  3570     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3571         GO TO 99000-ERROR.
  3572     IF LOAN-TERM = ZERO
  3573         GO TO 99999-RETURN.
  3574     IF LOAN-TERM LESS ORIGINAL-TERM
  3575         GO TO 99000-ERROR.
  3576
  3577*    IF ANNUAL-INT-RATE LESS +2
  3578*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3579*    IF ANNUAL-INT-RATE LESS +2
  3580*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3581*    IF ANNUAL-INT-RATE LESS +2
  3582*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3583
  3584     IF NPO-REFUND
  3585         MOVE '2' TO NP-PROCESS-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  68
* ELRATE.cbl
  3586       ELSE
  3587         IF ORIGINAL-TERM = REMAINING-TERM
  3588            MOVE '1'   TO NP-PROCESS-SW
  3589           ELSE
  3590            MOVE '3'   TO NP-PROCESS-SW.
  3591
  3592     IF NPO-SIMPLE
  3593         MOVE 'S' TO TYPE-SW
  3594     ELSE
  3595         MOVE 'N' TO TYPE-SW.
  3596
  3597     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3598     if i = zeros
  3599        move .0000000001         to i
  3600     end-if
  3601
  3602     COMPUTE V ROUNDED = K1 / (K1 + I).
  3603
  3604     MOVE V     TO VX
  3605                   SV.
  3606
  3607     MOVE +1    TO X1
  3608                   SX.
  3609
  3610     MOVE LOAN-TERM TO MAX-X.
  3611
  3612     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3613
  3614     IF MAX-X = +1
  3615        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3616
  3617     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3618
  3619     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3620         OR 'DCC' or 'VPP' OR 'NCL') AND
  3621        (NOT NP-REFUND)
  3622        NEXT SENTENCE
  3623     ELSE
  3624     IF LOAN-TERM NOT = ORIGINAL-TERM
  3625        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3626
  3627     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3628
  3629 10500-VX-LOOP.
  3630
  3631***  VX = AMORT. LOAN TERM.
  3632***  SV = AMORT. INSURANCE TERM.
  3633***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3634***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3635***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3636
  3637     IF X2 = 1
  3638        MOVE V         TO SX
  3639     END-IF
  3640     COMPUTE VX ROUNDED = VX * V.
  3641
  3642     ADD B1 TO X1.
  3643
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  69
* ELRATE.cbl
  3644     IF X1 = REMAINING-TERM
  3645          MOVE VX    TO SV.
  3646
  3647     IF X1 EQUAL SV-MINUS-ONE
  3648        MOVE VX      TO SV-MINUS-ONE.
  3649
  3650     IF X1 = X2
  3651          MOVE VX    TO SX.
  3652
  3653     IF X1 NOT = MAX-X
  3654          GO TO 10500-VX-LOOP.
  3655
  3656 10700-COMPUTE-REMAINING-FACTOR.
  3657*****  WK1 = LOAN TERM AMORT
  3658     COMPUTE WK1 = K1 - VX.
  3659*****  WK2 = INS TERM AMORT
  3660     COMPUTE WK2 = K1 - SV.
  3661*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3662     COMPUTE WK5 = K1 - SX.
  3663*****  WK6 = INS TERM - 1
  3664     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3665
  3666     IF NP-RATING
  3667         GO TO 12000-PREMIUM-RATE.
  3668
  3669     IF NP-REFUND
  3670         GO TO 11000-REFUND-CALC.
  3671
  3672     IF NET-STD
  3673         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3674
  3675     IF NET-SMP
  3676         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3677         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3678         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3679         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3680
  3681     IF REMAINING-TERM LESS THAN X2
  3682         MOVE +0 TO WK3.
  3683
  3684     MOVE WK3 TO FACTOR.
  3685
  3686     GO TO 99999-RETURN.
  3687
  3688 11000-REFUND-CALC.
  3689     IF REMAINING-TERM NOT LESS MAX-X
  3690        MOVE +1 TO FACTOR
  3691        GO TO 99999-RETURN.
  3692
  3693     IF REMAINING-TERM LESS +1
  3694        MOVE 0 TO FACTOR
  3695        GO TO 99999-RETURN.
  3696
  3697     COMPUTE WK2 ROUNDED = WK2 / I.
  3698     COMPUTE WK5 ROUNDED = WK5 / I.
  3699     COMPUTE WK1 ROUNDED = WK1 / I.
  3700
  3701     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  70
* ELRATE.cbl
  3702        AND (CP-STATE-STD-ABBRV = 'MN')
  3703        AND (CP-CERT-EFF-DT > X'A4FF')
  3704        AND (CP-RATE-AS-REG-BALLOON)
  3705        AND (CP-EARN-AS-NET-PAY)
  3706        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3707        CONTINUE
  3708     ELSE
  3709        GO TO 11000-CHECK-MN-LEV-BALLOON
  3710     END-IF
  3711
  3712     COMPUTE R = M - E
  3713     COMPUTE FACTOR = (R - WK2 + WK5) /
  3714        (M - WK1 + WK5)
  3715
  3716     GO TO 99999-RETURN
  3717
  3718      .
  3719 11000-CHECK-MN-LEV-BALLOON.
  3720
  3721     IF (CP-COMPANY-ID EQUAL 'CID')
  3722        AND (CP-STATE-STD-ABBRV = 'MN')
  3723        AND (CP-CERT-EFF-DT > X'A4FF')
  3724        AND (CP-RATE-AS-REG-BALLOON)
  3725        AND (CP-EARN-AS-NET-PAY)
  3726        AND (CP-DEVIATION-CODE = 'LEV')
  3727        CONTINUE
  3728     ELSE
  3729        GO TO 11000-CONTINUE-REFUND
  3730     END-IF
  3731
  3732     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3733     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3734        ** (M - E)) / I
  3735
  3736     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3737
  3738     GO TO 99999-RETURN
  3739
  3740     .
  3741 11000-CONTINUE-REFUND.
  3742*    IF CP-GAP-ACTUARIAL
  3743*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3744*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3745*       COMPUTE WK3 = WK2 / ANGLEN
  3746*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3747     IF CP-GAP-ACTUARIAL
  3748        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3749           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3750        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3751     ELSE
  3752        COMPUTE WK3 ROUNDED =
  3753          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3754     END-IF
  3755
  3756     MOVE WK3  TO FACTOR.
  3757
  3758     GO TO 99999-RETURN.
  3759
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  71
* ELRATE.cbl
  3760 12000-PREMIUM-RATE.
  3761*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3762*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3763*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3764*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3765*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3766*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3767
  3768     COMPUTE K-I = K1 + I.
  3769     MOVE K-I TO ONE-PLUS-I.
  3770
  3771     IF NPO-ALT OR NPO-TRUNC-0
  3772         MOVE K1 TO K-I.
  3773
  3774     IF NPO-2MO OR NPO-TRUNC-2
  3775         COMPUTE K-I = K1 + (2 * I).
  3776
  3777     IF NPO-3MO OR NPO-TRUNC-3
  3778         COMPUTE K-I = K1 + (3 * I).
  3779
  3780     IF NPO-4MO OR NPO-TRUNC-4
  3781         COMPUTE K-I = K1 + (4 * I).
  3782
  3783     COMPUTE RA ROUNDED = 1 -
  3784             ((X2 * (X2 + 1)) /
  3785              (N *  (N  + 1))).
  3786
  3787     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3788        (CP-CSL-VALID-NP-BENEFIT-CD)
  3789        NEXT SENTENCE
  3790     ELSE
  3791        GO TO XXXX-CHECK-DISCOUNT-5.
  3792
  3793     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3794     MOVE ' ' TO DC-OPTION-CODE.
  3795     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3796
  3797     IF DATE-CONVERSION-ERROR
  3798        MOVE '2'                 TO CP-RETURN-CODE
  3799        MOVE ZEROS               TO FACTOR
  3800                                    CP-CALC-PREMIUM
  3801         GO TO 99999-RETURN.
  3802
  3803     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3804     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3805     MOVE ' ' TO DC-OPTION-CODE
  3806     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3807
  3808     IF DATE-CONVERSION-ERROR
  3809        MOVE '2'                 TO CP-RETURN-CODE
  3810        MOVE ZEROS               TO FACTOR
  3811                                    CP-CALC-PREMIUM
  3812         GO TO 99999-RETURN.
  3813
  3814     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3815
  3816     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3817
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  72
* ELRATE.cbl
  3818     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3819        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3820        CP-PAY-FREQUENCY / 365) * I
  3821     ELSE
  3822        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3823        CP-PAY-FREQUENCY / 365) * I.
  3824
  3825     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3826     13).
  3827
  3828     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3829     (N - ( ANGLEN-1 / WK3)).
  3830
  3831     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3832
  3833     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3834       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3835
  3836     COMPUTE WS-Y-X-FACTOR EQUAL
  3837       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3838       WS-CALC-FREQ-RATE).
  3839
  3840     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3841       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3842
  3843     COMPUTE WS-X-Y-FACTOR EQUAL
  3844       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3845
  3846     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3847       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3848       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3849
  3850     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3851
  3852     GO TO 99999-RETURN.
  3853
  3854 XXXX-CHECK-DISCOUNT-5.
  3855
  3856     IF WS-DISCOUNT-OPTION EQUAL '5'
  3857        NEXT SENTENCE
  3858     ELSE
  3859        GO TO 12000-CHECK-CLIENT.
  3860
  3861      COMPUTE ANGLEN EQUAL WK1 / I.
  3862
  3863      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3864
  3865      COMPUTE WK3 EQUAL
  3866        (12 *
  3867        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3868        CP-ORIGINAL-BENEFIT)) /
  3869        APR100.
  3870
  3871     COMPUTE WK3 EQUAL
  3872        (WK3 * CP-PREMIUM-RATE) / +1000.
  3873
  3874     COMPUTE WK3 EQUAL
  3875        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  73
* ELRATE.cbl
  3876
  3877      MOVE WK3 TO CP-CALC-PREMIUM.
  3878
  3879     GO TO 99999-RETURN.
  3880
  3881 12000-CHECK-CLIENT.
  3882
  3883     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3884        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3885        (CP-TRUNCATED-LIFE)
  3886        NEXT SENTENCE
  3887     ELSE
  3888        GO TO 12000-CHECK-NEXT.
  3889
  3890     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3891
  3892     COMPUTE ANGLEN EQUAL WK1 / I.
  3893     COMPUTE ANGLEM EQUAL WK2 / I.
  3894
  3895     COMPUTE FM EQUAL
  3896                    (((ONE-PLUS-I ** M) * I * M) /
  3897                    ((ONE-PLUS-I ** M) - 1))
  3898                    - 1.
  3899
  3900     COMPUTE FN EQUAL
  3901                    (((ONE-PLUS-I ** N) * I * N) /
  3902                    ((ONE-PLUS-I ** N) - 1))
  3903                    - 1.
  3904
  3905     COMPUTE FNM EQUAL
  3906                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3907                    ((ONE-PLUS-I ** (N - M)) - 1))
  3908                    - 1.
  3909
  3910     COMPUTE GR EQUAL
  3911                    (WS-WORK-RATE * ANGLEM * I) /
  3912                    (M - ANGLEM).
  3913
  3914     COMPUTE ODF EQUAL
  3915                     (1 +
  3916                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3917                     360)) /
  3918                     ONE-PLUS-I.
  3919
  3920     COMPUTE OD EQUAL
  3921                    (1 + (ODF * (FN / I - 1))) +
  3922                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3923
  3924     COMPUTE WK3 EQUAL
  3925*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3926                    ((1 + FN) * ODF *
  3927                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3928                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3929                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3930
  3931     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3932     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3933
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  74
* ELRATE.cbl
  3934     COMPUTE WK3 EQUAL
  3935                    (WK3 / (ODF * (1 + FN))) -
  3936*                   CP-ORIGINAL-BENEFIT.
  3937                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3938
  3939      MOVE WK3 TO CP-CALC-PREMIUM.
  3940
  3941     GO TO 99999-RETURN.
  3942
  3943 12000-CHECK-NEXT.
  3944
  3945     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3946        NEXT SENTENCE
  3947     ELSE
  3948        GO TO 12000-CHECK-PA-TRUNC.
  3949
  3950      IF WS-WORK-DIS-RATE EQUAL +0
  3951         MOVE '7'                TO CP-RETURN-CODE
  3952         MOVE ZEROS              TO FACTOR
  3953                                    CP-CALC-PREMIUM
  3954         GO TO 99999-RETURN.
  3955
  3956      COMPUTE ANGLEN EQUAL WK1 / I.
  3957
  3958      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3959
  3960      IF WS-WORK-DIS-RATE EQUAL APR100
  3961         ADD .00001 TO APR100.
  3962
  3963      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3964      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3965
  3966     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3967        / (1 + I)
  3968     COMPUTE ANGLEN-1 = ANGLEN / Y
  3969      IF CP-COMPANY-ID EQUAL 'CDL'
  3970         COMPUTE WK3 EQUAL
  3971
  3972          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3973          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3974
  3975          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3976
  3977          ((WK8 ** N) /
  3978          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3979
  3980          ((WK9 ** N) /
  3981          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3982
  3983      ELSE
  3984         COMPUTE WK3 EQUAL
  3985
  3986          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3987          (12 + WS-WORK-DIS-RATE) * 12) *
  3988
  3989          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3990
  3991          ((WK8 ** N) /
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  75
* ELRATE.cbl
  3992          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3993
  3994          ((WK9 ** N) /
  3995          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3996
  3997      COMPUTE WK3 EQUAL
  3998          (WK3 * CP-PREMIUM-RATE) / +1000.
  3999
  4000      MOVE WK3 TO CP-CALC-PREMIUM.
  4001
  4002     GO TO 99999-RETURN.
  4003
  4004 12000-CHECK-PA-TRUNC.
  4005
  4006     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4007        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  4008        (CP-EARN-AS-NET-PAY) AND
  4009        (CP-TRUNCATED-LIFE)
  4010        NEXT SENTENCE
  4011     ELSE
  4012        GO TO 12000-CHECK-MD-TRUNC.
  4013
  4014     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4015
  4016     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4017     COMPUTE ANGLEN EQUAL WK1 / I.
  4018
  4019     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4020
  4021     COMPUTE WK3 EQUAL
  4022        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  4023        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  4024
  4025     MOVE WK3 TO CP-CALC-PREMIUM.
  4026
  4027     GO TO 99999-RETURN.
  4028
  4029 12000-CHECK-MD-TRUNC.
  4030
  4031     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4032        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4033        (CP-EARN-AS-NET-PAY) AND
  4034        (CP-TRUNCATED-LIFE)
  4035        NEXT SENTENCE
  4036     ELSE
  4037        GO TO 12000-CHECK-MD.
  4038
  4039     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4040
  4041     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4042     COMPUTE ANGLEM EQUAL WK2 / I.
  4043     COMPUTE ANGLEN EQUAL WK1 / I.
  4044
  4045     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4046
  4047     COMPUTE WK3 EQUAL
  4048        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4049        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  76
* ELRATE.cbl
  4050        (ANGLEN-1 * (M - ANGLEM))).
  4051
  4052     MOVE WK3 TO CP-CALC-PREMIUM.
  4053
  4054     GO TO 99999-RETURN.
  4055
  4056 12000-CHECK-MD.
  4057
  4058     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4059        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4060        (CP-EARN-AS-NET-PAY)
  4061        NEXT SENTENCE
  4062     ELSE
  4063        GO TO 12000-CHECK-ME-TRUNC.
  4064
  4065     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4066
  4067     COMPUTE WK3 EQUAL
  4068        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  4069
  4070     MOVE WK3 TO CP-CALC-PREMIUM.
  4071
  4072     GO TO 99999-RETURN.
  4073
  4074 12000-CHECK-ME-TRUNC.
  4075
  4076     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  4077        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4078        AND (CP-EARN-AS-NET-PAY)
  4079        AND (CP-TRUNCATED-LIFE)
  4080        CONTINUE
  4081     ELSE
  4082        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4083     END-IF
  4084
  4085     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4086     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4087     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4088     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4089     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4090     COMPUTE ANGLEN-1 = ANGLEN / Y
  4091     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4092     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4093     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4094     COMPUTE WK3
  4095        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4096        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4097            * (1 / (1.0635 ** (M / 12))))
  4098*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  4099*    COMPUTE WK9 EQUAL
  4100*       1 / (1 + (.045 * (N - M) / 24))
  4101*    COMPUTE WK7 EQUAL
  4102*       WS-WORK-RATE * 20 / (M + 1).
  4103*    COMPUTE WK3 EQUAL
  4104*       ((( N - ANGLEN) * WK7 * WK8) /
  4105*       (10 * ANGLEN-1 * I)) -
  4106*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  4107*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  77
* ELRATE.cbl
  4108*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4109*
  4110     MOVE WK3 TO CP-CALC-PREMIUM.
  4111
  4112     GO TO 99999-RETURN
  4113      .
  4114 12000-CHECK-CID-WA-FARMPLAN.
  4115
  4116     IF (CP-COMPANY-ID EQUAL 'CID')
  4117        AND (CP-STATE-STD-ABBRV = 'WA')
  4118        AND (CP-FARM-PLAN)
  4119        CONTINUE
  4120     ELSE
  4121        GO TO 12000-CHECK-CID-FARMPLAN
  4122     END-IF
  4123**  This was removed due to IR 2015022300001
  4124    GO TO 12000-CHECK-CID-FARMPLAN
  4125
  4126     move cp-original-term       to n
  4127     move cp-no-of-pmts          TO C-TOT-PMTS
  4128     compute c-pmts-per-year = 12 / cp-pay-frequency
  4129     move cp-pay-frequency       to m
  4130     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4131     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4132     if i = zeros
  4133        move .0000000001         to i
  4134     end-if
  4135     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4136
  4137     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4138        (m * 30))) / (1 + I)
  4139     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4140        ** CP-PAY-FREQUENCY) - 1
  4141     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4142     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4143        ** TI) / WS-WORK-DIS-RATE
  4144     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4145     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4146     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4147        ** m) / WS-WORK-DIS-RATE
  4148     COMPUTE WK2 = WK2 * (1 + J)
  4149     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4150     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4151     COMPUTE WK3 = WK3 * (1 + J)
  4152     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4153        ** (c-tot-pmts - 1))) / J
  4154     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4155        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4156        (CP-PREMIUM-RATE / 1000)
  4157     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4158     COMPUTE WK6 = (WK7 * GR)
  4159
  4160     MOVE WK6 TO CP-CALC-PREMIUM
  4161
  4162     GO TO 99999-RETURN
  4163
  4164     .
  4165 12000-CHECK-CID-FARMPLAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  78
* ELRATE.cbl
  4166     IF (CP-COMPANY-ID EQUAL 'CID')
  4167        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4168           OR 'IN' OR 'AZ')
  4169        AND (CP-FARM-PLAN)
  4170        CONTINUE
  4171     ELSE
  4172        GO TO 12000-CHECK-SC-CID
  4173     END-IF
  4174     COMPUTE N = M / CP-PAY-FREQUENCY
  4175     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4176     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4177        ** CP-PAY-FREQUENCY) - 1
  4178     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4179     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4180        ** TI) / WS-WORK-DIS-RATE
  4181     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4182     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4183     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4184        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4185     COMPUTE WK2 = WK2 * (1 + J)
  4186     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4187     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4188     COMPUTE WK3 = WK3 * (1 + J)
  4189     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4190        ** (N - 1))) / J
  4191     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4192        ((N * WK2) - WK5)) + (N * WK1)) *
  4193        (CP-PREMIUM-RATE / 1000)
  4194     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4195     COMPUTE WK6 = (WK7 * GR)
  4196     MOVE WK6 TO CP-CALC-PREMIUM
  4197     GO TO 99999-RETURN
  4198     .
  4199 12000-CHECK-SC-CID.
  4200     IF (CP-COMPANY-ID = 'CID')
  4201        AND (CP-STATE-STD-ABBRV = 'SC')
  4202        AND (CP-EARN-AS-NET-PAY)
  4203        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4204        move 6                   to ws-extra-pmts
  4205     ELSE
  4206        GO TO 12000-CHECK-AL-CID
  4207     END-IF
  4208     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4209     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4210     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4211        / 12)) / ((M + 1) / 2)
  4212
  4213     if i = .0000000001
  4214        compute wk4 = cp-original-benefit / n
  4215        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4216            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4217        display ' hit sc wo apr - wk2 ' wk2
  4218     else
  4219        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4220        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4221        COMPUTE ANGLEN-1 = ANGLEN / Y
  4222        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4223        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  79
* ELRATE.cbl
  4224           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4225     end-if
  4226*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4227*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4228*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4229*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4230*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4231*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4232*       / 12)) / ((M + 1) / 2)
  4233*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4234*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4235*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4236     MOVE WK3 TO CP-CALC-PREMIUM
  4237     GO TO 99999-RETURN
  4238     .
  4239 12000-CHECK-AL-CID.
  4240     IF (CP-COMPANY-ID EQUAL 'CID')
  4241        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4242        AND (CP-EARN-AS-NET-PAY)
  4243        CONTINUE
  4244     ELSE
  4245        GO TO 12000-CHECK-NH-CID
  4246     END-IF
  4247     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4248     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4249     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4250     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4251                   / (1 + I)
  4252     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4253     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4254     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4255        (CP-PREMIUM-RATE / 1000)
  4256     MOVE WK3 TO CP-CALC-PREMIUM
  4257     GO TO 99999-RETURN
  4258     .
  4259 12000-CHECK-NH-CID.
  4260     IF (CP-COMPANY-ID EQUAL 'CID')
  4261        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4262        AND (CP-EARN-AS-NET-PAY)
  4263        CONTINUE
  4264     ELSE
  4265        GO TO 12000-CHECK-PA-CID
  4266     END-IF
  4267     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4268     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4269     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4270                   / (1 + I)
  4271     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4272     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4273     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4274        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4275     MOVE WK3 TO CP-CALC-PREMIUM
  4276     GO TO 99999-RETURN
  4277     .
  4278 12000-CHECK-PA-CID.
  4279     IF (CP-COMPANY-ID EQUAL 'CID')
  4280        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4281        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  80
* ELRATE.cbl
  4282        CONTINUE
  4283     ELSE
  4284        GO TO 12000-CHECK-ME-CID
  4285     END-IF
  4286
  4287     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4288     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4289     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4290     COMPUTE ANGLEN-1 = ANGLEN / Y
  4291     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4292     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4293     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4294     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4295        * WK5
  4296     MOVE WK3 TO CP-CALC-PREMIUM
  4297     GO TO 99999-RETURN
  4298     .
  4299 12000-CHECK-ME-CID.
  4300     IF (CP-COMPANY-ID EQUAL 'CID')
  4301        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4302        AND (CP-EARN-AS-NET-PAY)
  4303        CONTINUE
  4304     ELSE
  4305        GO TO 12000-CHECK-VT-TRUNC
  4306     END-IF
  4307     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4308     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4309     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4310     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4311     COMPUTE ANGLEN-1 = ANGLEN / Y
  4312     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4313     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4314     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4315        * WK5
  4316     MOVE WK3 TO CP-CALC-PREMIUM
  4317     GO TO 99999-RETURN
  4318     .
  4319 12000-CHECK-VT-TRUNC.
  4320
  4321     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4322        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4323        (CP-EARN-AS-NET-PAY) AND
  4324        (CP-TRUNCATED-LIFE)
  4325        NEXT SENTENCE
  4326     ELSE
  4327        GO TO 12000-CHECK-VT.
  4328
  4329      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4330
  4331      COMPUTE ANGLEN EQUAL WK1 / I.
  4332
  4333      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4334
  4335      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4336      COMPUTE WK9 EQUAL
  4337        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4338        ((.0054 - I) / (1 + I)).
  4339      COMPUTE WK7 EQUAL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  81
* ELRATE.cbl
  4340        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4341      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4342        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4343
  4344      MOVE WK3 TO CP-CALC-PREMIUM.
  4345
  4346     GO TO 99999-RETURN.
  4347
  4348 12000-CHECK-VT.
  4349
  4350     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4351        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4352        (CP-EARN-AS-NET-PAY)
  4353        NEXT SENTENCE
  4354     ELSE
  4355        GO TO 12000-CHECK-MINN-WDS.
  4356
  4357      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4358
  4359      COMPUTE ANGLEN EQUAL WK1 / I.
  4360
  4361      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4362
  4363      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4364                        (ANGLEN-1 * I)) *
  4365
  4366                        (((1.0054 ** N - 1) /
  4367                        (1.0054 ** (N - 1) * .0054)) -
  4368
  4369                        ((V * (1 - 1.0054 ** N * VX)) /
  4370                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4371
  4372      MOVE WK3 TO CP-CALC-PREMIUM.
  4373
  4374     GO TO 99999-RETURN.
  4375
  4376 12000-CHECK-MINN-WDS.
  4377
  4378     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4379        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4380        (CP-EARN-AS-NET-PAY)
  4381        NEXT SENTENCE
  4382     ELSE
  4383        GO TO 12000-CHECK-MINN-BALL-LEV.
  4384
  4385     COMPUTE ANGLEN EQUAL WK1 / I.
  4386     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4387              (N / +12) * (2 / (N + 1)).
  4388     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4389         WK3 * ((N - ANGLEN) / I).
  4390
  4391      MOVE WK3 TO CP-CALC-PREMIUM.
  4392
  4393     GO TO 99999-RETURN.
  4394
  4395 12000-CHECK-MINN-BALL-LEV.
  4396
  4397     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  82
* ELRATE.cbl
  4398        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4399        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4400        (CP-EARN-AS-REG-BALLOON)
  4401        NEXT SENTENCE
  4402     ELSE
  4403        GO TO 12000-CHECK-MINN-BALL.
  4404
  4405     COMPUTE ANGLEN EQUAL WK1 / I.
  4406
  4407     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4408
  4409     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4410        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4411
  4412     MOVE WK3 TO CP-CALC-PREMIUM.
  4413
  4414     GO TO 99999-RETURN.
  4415
  4416 12000-CHECK-MINN-BALL.
  4417
  4418     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4419        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4420        (CP-EARN-AS-REG-BALLOON)
  4421        NEXT SENTENCE
  4422     ELSE
  4423        GO TO 12000-CHECK-CID-MN-BALL.
  4424
  4425     COMPUTE ANGLEN EQUAL WK1 / I.
  4426     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4427
  4428     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4429     / +100 * (N - 1) / 12 * 2 / N *
  4430     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4431
  4432      MOVE WK3 TO CP-CALC-PREMIUM.
  4433
  4434     GO TO 99999-RETURN.
  4435
  4436 12000-CHECK-CID-MN-BALL.
  4437     IF (CP-COMPANY-ID EQUAL 'CID')
  4438        AND (CP-STATE-STD-ABBRV = 'MN')
  4439        AND (CP-CERT-EFF-DT > X'A4FF')
  4440        AND (CP-EARN-AS-REG-BALLOON)
  4441        CONTINUE
  4442     ELSE
  4443        GO TO 12000-CHECK-CID-MN-FARM
  4444     END-IF
  4445     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4446     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4447     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4448     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4449     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4450     COMPUTE V = 1 / (1 + I)
  4451     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4452     COMPUTE Y = (1 + (D * I) / +30)
  4453        / (1 + I)
  4454     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4455        * CP-PREMIUM-RATE / 1000
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  83
* ELRATE.cbl
  4456*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4457*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4458*    ELSE
  4459*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4460*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4461*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4462*       DISPLAY ' BALLOON TOP ' WK6
  4463*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4464*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4465*          / 100
  4466*       DISPLAY ' BALLOON BOTTOM ' WK7
  4467*       COMPUTE GR = WK6 / WK7
  4468*       DISPLAY ' BALLOON PAYMENT ' GR
  4469*    END-IF
  4470     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4471     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4472        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4473     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4474     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4475        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4476           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4477           * CP-PREMIUM-RATE / 1000
  4478     MOVE WK3                    TO CP-CALC-PREMIUM
  4479     GO TO 99999-RETURN.
  4480     .
  4481 12000-CHECK-CID-MN-FARM.
  4482
  4483     IF (CP-COMPANY-ID EQUAL 'CID')
  4484        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4485        AND (CP-CERT-EFF-DT > X'A4FF')
  4486        AND (CP-EARN-AS-FARM-PLAN)
  4487        CONTINUE
  4488     ELSE
  4489        GO TO 12000-CHECK-CID-NET-BALLoons
  4490     END-IF
  4491
  4492     EVALUATE CP-PMT-MODE
  4493        WHEN 'B'
  4494           MOVE +14              TO C-DAYS-IN-PMT-PER
  4495           MOVE +26              TO C-PMTS-PER-YEAR
  4496           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4497        WHEN 'S'
  4498           MOVE +15              TO C-DAYS-IN-PMT-PER
  4499           MOVE +24              TO C-PMTS-PER-YEAR
  4500           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4501        WHEN 'T'
  4502           MOVE +360             TO C-DAYS-IN-PMT-PER
  4503           MOVE +1               TO C-PMTS-PER-YEAR
  4504           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4505        WHEN 'W'
  4506           MOVE +7               TO C-DAYS-IN-PMT-PER
  4507           MOVE +52              TO C-PMTS-PER-YEAR
  4508           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4509        WHEN OTHER
  4510           move cp-no-of-pmts    to c-tot-pmts
  4511           if cp-pay-frequency > zeros
  4512              compute c-pmts-per-year =
  4513                 12 / cp-pay-frequency
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  84
* ELRATE.cbl
  4514              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4515           else
  4516              MOVE +30           TO C-DAYS-IN-PMT-PER
  4517              MOVE +12           TO C-PMTS-PER-YEAR
  4518              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4519           end-if
  4520     END-EVALUATE
  4521
  4522     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4523     if i = zeros
  4524        move .0000000001         to i
  4525     end-if
  4526
  4527     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4528        C-DAYS-IN-PMT-PER)) / (1 + I)
  4529
  4530     compute cp-premium-rate =
  4531        cp-premium-rate * 12 / c-pmts-per-year / 10
  4532     move c-tot-pmts to n m
  4533     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4534     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4535     COMPUTE ANGLEN-1 = ANGLEN / Y
  4536     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4537
  4538     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4539        (cp-premium-rate / 100)
  4540
  4541
  4542     MOVE WK3                    TO CP-CALC-PREMIUM
  4543
  4544     GO TO 99999-RETURN.
  4545
  4546     .
  4547 12000-check-cid-net-balloons.
  4548     IF (CP-COMPANY-ID EQUAL 'CID')
  4549        AND (CP-EARN-AS-REG-BALLOON)
  4550        and (CP-NET-ONLY-STATE not = 'Y')
  4551        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4552        CONTINUE
  4553     ELSE
  4554        GO TO 12000-check-cid-net-only-balls
  4555     END-IF
  4556     display ' *** NOT NET ONLY STATE BALLOONS *** '
  4557     COMPUTE Y =
  4558        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4559     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4560     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4561     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4562     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4563     COMPUTE ANGLEMY = ANGLEM / Y
  4564     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4565     COMPUTE ANGLENY = ANGLEN / Y
  4566     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4567     compute cp-original-benefit =
  4568        cp-original-benefit + cp-alternate-benefit
  4569     COMPUTE PVBALLOON rounded =
  4570        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4571     compute wk4 rounded =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  85
* ELRATE.cbl
  4572        cp-original-benefit - pvballoon
  4573     compute wk6 rounded =
  4574        (cp-original-benefit - cp-alternate-benefit)
  4575***  compute ra = wk4 / anglem-1y
  4576     compute ra = wk4 / anglemy
  4577     compute wk6 rounded = wk6 / anglemy
  4578     display ' rate before ' cp-premium-rate
  4579     compute cp-premium-rate =
  4580        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4581            / 30) / 12))     /
  4582           ((m + 1) / 2)
  4583     display '************************************'
  4584     display ' orign ben    ' cp-original-benefit
  4585     display ' balloon      ' cp-alternate-benefit
  4586     display ' ra           ' ra
  4587     display ' wk6          ' wk6
  4588     display ' m            ' m
  4589     display ' anglemy      ' anglemy
  4590     display ' anglem-1     ' anglem-1y
  4591     display ' i            ' i
  4592     display ' extra per    ' cp-extra-periods
  4593     display ' prem rate    ' cp-premium-rate
  4594***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4595***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4596     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4597        (cp-extra-periods * i)) * cp-premium-rate / 100
  4598     move wk3                    to cp-calc-premium
  4599     display ' wk3          ' wk3
  4600     display '************************************'
  4601*    compute wk3 rounded =
  4602*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4603*    move wk3                    to cp-lf-balloon-prem
  4604     GO TO 99999-RETURN.
  4605     .
  4606 12000-check-cid-net-only-balls.
  4607     IF (CP-COMPANY-ID EQUAL 'CID')
  4608        AND (CP-EARN-AS-REG-BALLOON)
  4609        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4610        CONTINUE
  4611     ELSE
  4612        GO TO 12000-CHECK-NC-WDS
  4613     END-IF
  4614     display ' *** NET ONLY STATE BALLOONS *** '
  4615     COMPUTE Y =
  4616        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4617     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4618     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4619     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4620     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4621     COMPUTE ANGLEMY = ANGLEM / Y
  4622     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4623     COMPUTE ANGLENY = ANGLEN / Y
  4624     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4625     COMPUTE PVBALLOON rounded =
  4626        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4627     compute wk4 rounded =
  4628        cp-original-benefit - pvballoon
  4629*    compute cp-premium-rate =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  86
* ELRATE.cbl
  4630*       (cp-premium-rate * (m + 1) / 12)  /
  4631*          ((m + 2) / 2)
  4632***  compute ra = wk4 / anglem-1y
  4633     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4634        pvballoon) / anglemy
  4635     display '************************************'
  4636     display ' ra           ' ra
  4637     display ' m            ' m
  4638     display ' anglemy      ' anglemy
  4639     display ' anglem-1     ' anglem-1y
  4640     display ' i            ' i
  4641     display ' extra per    ' cp-extra-periods
  4642     display ' prem rate    ' cp-premium-rate
  4643     display '************************************'
  4644***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4645***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4646     compute wk3 = ra * (m - anglemy) / i * (1 +
  4647        (cp-extra-periods * i)) * cp-premium-rate / 100
  4648     move wk3                    to cp-calc-premium
  4649     compute wk3 rounded =
  4650        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4651     move wk3                    to cp-lf-balloon-prem
  4652     GO TO 99999-RETURN.
  4653     .
  4654 12000-CHECK-NC-WDS.
  4655
  4656     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4657        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4658        (CP-EARN-AS-NET-PAY)
  4659        NEXT SENTENCE
  4660     ELSE
  4661        GO TO 12000-CHECK-NC-BALL-LEV.
  4662
  4663     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4664     COMPUTE ANGLEN EQUAL WK1 / I.
  4665     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4666              CP-PREMIUM-RATE / +100 *
  4667              N / +12 * 2 / (N + 1) *
  4668              (WK4 - ANGLEN) / (I * ANGLEN).
  4669
  4670      MOVE WK3 TO CP-CALC-PREMIUM.
  4671
  4672     GO TO 99999-RETURN.
  4673
  4674 12000-CHECK-NC-BALL-LEV.
  4675
  4676     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4677        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4678        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4679        (CP-EARN-AS-REG-BALLOON)
  4680        NEXT SENTENCE
  4681     ELSE
  4682        GO TO 12000-CHECK-NC-BALL.
  4683
  4684     COMPUTE ANGLEN EQUAL WK1 / I.
  4685
  4686**** VX = 1 / (1 + I)**N.
  4687
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  87
* ELRATE.cbl
  4688     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4689        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4690
  4691     MOVE WK3 TO CP-CALC-PREMIUM.
  4692
  4693     GO TO 99999-RETURN.
  4694
  4695 12000-CHECK-NC-BALL.
  4696
  4697     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4698        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4699        (CP-EARN-AS-REG-BALLOON)
  4700        NEXT SENTENCE
  4701     ELSE
  4702        GO TO 12000-CHECK-MINN-TRUNC.
  4703
  4704     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4705     COMPUTE ANGLEN EQUAL WK1 / I.
  4706     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4707**** VX = 1 / (1 + I)**N.
  4708
  4709     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4710     / +100 * (N - 1) / 12 * 2 / N *
  4711     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4712
  4713      MOVE WK3 TO CP-CALC-PREMIUM.
  4714
  4715     GO TO 99999-RETURN.
  4716
  4717 12000-CHECK-MINN-TRUNC.
  4718
  4719     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4720        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4721        (M GREATER THAN +63) AND
  4722        (CP-EARN-AS-NET-PAY) AND
  4723        (CP-TRUNCATED-LIFE)
  4724        NEXT SENTENCE
  4725     ELSE
  4726        GO TO 12000-CHECK-MINN.
  4727
  4728      COMPUTE ANGLEN EQUAL WK1 / I.
  4729      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4730
  4731      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4732
  4733      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4734       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4735       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4736
  4737      MOVE WK3 TO CP-CALC-PREMIUM.
  4738
  4739     GO TO 99999-RETURN.
  4740
  4741 12000-CHECK-MINN.
  4742
  4743     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4744        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4745        (M GREATER THAN +63) AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  88
* ELRATE.cbl
  4746        (CP-EARN-AS-NET-PAY)
  4747        NEXT SENTENCE
  4748     ELSE
  4749        GO TO 12000-CHECK-MONTANA-TRUNC.
  4750
  4751      COMPUTE ANGLEN EQUAL WK1 / I.
  4752
  4753      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4754
  4755      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4756       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4757       (((N - ANGLEN) / I) + (2 * N)).
  4758
  4759      MOVE WK3 TO CP-CALC-PREMIUM.
  4760
  4761     GO TO 99999-RETURN.
  4762
  4763 12000-CHECK-MONTANA-TRUNC.
  4764
  4765     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4766        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4767        (M GREATER THAN +63) AND
  4768        (CP-EARN-AS-NET-PAY) AND
  4769        (CP-TRUNCATED-LIFE)
  4770        NEXT SENTENCE
  4771     ELSE
  4772        GO TO 12000-CHECK-MONTANA.
  4773
  4774      COMPUTE ANGLEN EQUAL WK1 / I.
  4775      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4776
  4777      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4778
  4779      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4780      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4781       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4782
  4783      MOVE WK3 TO CP-CALC-PREMIUM.
  4784
  4785     GO TO 99999-RETURN.
  4786
  4787 12000-CHECK-MONTANA.
  4788
  4789     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4790        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4791        (M GREATER THAN +63) AND
  4792        (CP-EARN-AS-NET-PAY)
  4793        NEXT SENTENCE
  4794     ELSE
  4795        GO TO 12001-CONTINUE-NCL-TRUNC.
  4796
  4797      COMPUTE ANGLEN EQUAL WK1 / I.
  4798
  4799      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4800
  4801      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4802       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4803       (((N - ANGLEN) / I) + (4 * N)).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  89
* ELRATE.cbl
  4804
  4805      MOVE WK3 TO CP-CALC-PREMIUM.
  4806
  4807     GO TO 99999-RETURN.
  4808
  4809 12001-CONTINUE-NCL-TRUNC.
  4810
  4811     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4812        (CP-EARN-AS-NET-PAY) AND
  4813        (CP-TRUNCATED-LIFE)
  4814        NEXT SENTENCE
  4815     ELSE
  4816        GO TO 12001-CONTINUE-NCL.
  4817
  4818      COMPUTE ANGLEN EQUAL WK1 / I.
  4819      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4820
  4821      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4822
  4823      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4824      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4825      (ANGLEN-1 * (N + 1) * I).
  4826
  4827      MOVE WK3 TO CP-CALC-PREMIUM.
  4828
  4829     GO TO 99999-RETURN.
  4830
  4831 12001-CONTINUE-NCL.
  4832
  4833     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4834        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4835        (CP-EARN-AS-NET-PAY)
  4836        GO TO 12001-CHECK-NC-NET-PLUS3.
  4837
  4838     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4839        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4840        (CP-EARN-AS-NET-PAY)
  4841        GO TO 12001-CHECK-CA.
  4842
  4843     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4844        (CP-EARN-AS-NET-PAY)
  4845        NEXT SENTENCE
  4846     ELSE
  4847        GO TO 12000-CONTINUE-NET.
  4848
  4849      COMPUTE ANGLEN EQUAL WK1 / I.
  4850      MOVE ANGLEN                TO ANGLEN-1.
  4851
  4852      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4853
  4854      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4855       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4856       ((N - ANGLEN) / I).
  4857
  4858      MOVE WK3 TO CP-CALC-PREMIUM.
  4859
  4860     GO TO 99999-RETURN.
  4861
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  90
* ELRATE.cbl
  4862 12000-CONTINUE-NET.
  4863
  4864     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4865        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4866        (CP-EARN-AS-NET-PAY)
  4867        NEXT SENTENCE
  4868     ELSE
  4869        GO TO 12001-CONTINUE-MINN.
  4870
  4871      COMPUTE ANGLEN EQUAL WK6 / I.
  4872      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4873
  4874      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4875      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4876      COMPUTE WK3 EQUAL (WK3 / I) *
  4877       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4878
  4879      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4880         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4881
  4882      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4883
  4884      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4885         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4886         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4887
  4888      MOVE WK3 TO CP-CALC-PREMIUM.
  4889
  4890     GO TO 99999-RETURN.
  4891
  4892 12001-CONTINUE-MINN.
  4893
  4894     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4895        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4896        (CP-TRUNCATED-LIFE)
  4897        NEXT SENTENCE
  4898     ELSE
  4899        GO TO 12001-CHECK-RI-GTL.
  4900
  4901      COMPUTE ANGLEN EQUAL WK1 / I.
  4902      COMPUTE ANGLEM EQUAL WK2 / I.
  4903
  4904      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4905       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4906       * M / 2400) * 1000 + .5) / 1000000.
  4907
  4908      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4909       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4910
  4911     GO TO 99999-RETURN.
  4912
  4913 12001-CHECK-RI-GTL.
  4914
  4915     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4916        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4917        (CP-EARN-AS-NET-PAY)
  4918        NEXT SENTENCE
  4919     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  91
* ELRATE.cbl
  4920        GO TO 12001-CHECK-RI-LEASE-GTL.
  4921
  4922      COMPUTE ANGLEN EQUAL WK1 / I.
  4923*     COMPUTE ANGLEM EQUAL WK2 / I.
  4924
  4925      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4926               (1 + WS-WORK-DIS-RATE * N).
  4927      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4928         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4929
  4930
  4931     GO TO 99999-RETURN.
  4932
  4933 12001-CHECK-RI-LEASE-GTL.
  4934
  4935     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4936        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4937        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4938        NEXT SENTENCE
  4939     ELSE
  4940        GO TO 12001-CHECK-OR-GTL.
  4941
  4942     COMPUTE ANGLEN EQUAL WK1 / I.
  4943
  4944     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4945        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4946                        /
  4947        (1000 * I * (1 + .0021 * N)).
  4948     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4949       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4950                            /
  4951       (1000 * (1 + .0027 * (N + 1))).
  4952
  4953     GO TO 99999-RETURN.
  4954
  4955 12001-CHECK-OR-GTL.
  4956
  4957     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4958        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4959        (CP-EARN-AS-NET-PAY)
  4960        NEXT SENTENCE
  4961     ELSE
  4962        GO TO 12001-CHECK-GA-GTL.
  4963
  4964     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4965     COMPUTE ANGLEN EQUAL WK1 / I.
  4966
  4967     IF M LESS THAN +64
  4968        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4969         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4970                   /
  4971         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4972        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4973     ELSE
  4974        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4975        CP-PREMIUM-RATE * (1 + I))
  4976                  /
  4977        (+1000 * I * ANGLEN)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  92
* ELRATE.cbl
  4978        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4979*    MOVE WK3 TO CP-CALC-PREMIUM.
  4980     GO TO 99999-RETURN.
  4981
  4982 12001-CHECK-GA-GTL.
  4983
  4984     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4985        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4986        (CP-EARN-AS-NET-PAY)
  4987*       (CP-TRUNCATED-LIFE)
  4988        NEXT SENTENCE
  4989     ELSE
  4990        GO TO 12001-CHECK-MA-GTL.
  4991
  4992     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4993     COMPUTE ANGLEN EQUAL WK1 / I.
  4994
  4995     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4996     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4997      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4998     MOVE WK3 TO CP-CALC-PREMIUM.
  4999
  5000     GO TO 99999-RETURN.
  5001
  5002 12001-CHECK-MA-GTL.
  5003
  5004     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5005        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  5006        (CP-EARN-AS-NET-PAY) AND
  5007        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5008        NEXT SENTENCE
  5009     ELSE
  5010        GO TO 12001-CHECK-NV-NET.
  5011
  5012     COMPUTE ANGLEN EQUAL WK1 / I.
  5013
  5014     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  5015      CP-ALTERNATE-BENEFIT * N.
  5016
  5017     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  5018     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  5019
  5020     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  5021     WK7 * (N - ANGLEN) / I.
  5022     MOVE WK3 TO CP-CALC-PREMIUM.
  5023
  5024     GO TO 99999-RETURN.
  5025
  5026 12001-CHECK-NV-NET.
  5027     IF (CP-COMPANY-ID EQUAL 'CID')
  5028        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5029        AND (CP-EARN-AS-NET-PAY)
  5030        CONTINUE
  5031     ELSE
  5032        GO TO 12001-CHECK-MN-NET
  5033     END-IF
  5034     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5035     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  93
* ELRATE.cbl
  5036     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5037                   / (1 + I)
  5038     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5039     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5040     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5041        (CP-PREMIUM-RATE * K-I / 1000)
  5042     MOVE WK3                    TO CP-CALC-PREMIUM
  5043     GO TO 99999-RETURN
  5044      .
  5045 12001-CHECK-MN-NET.
  5046     IF (CP-COMPANY-ID EQUAL 'CID')
  5047        AND (CP-STATE-STD-ABBRV = 'MN')
  5048        AND (CP-EARN-AS-NET-PAY)
  5049        AND (NOT CP-LEVEL-LIFE)
  5050        AND (WS-DISCOUNT-OPTION = '1')
  5051        CONTINUE
  5052     ELSE
  5053        GO TO 12001-CHECK-NC-NET
  5054     END-IF
  5055     if i = .0000000001
  5056        compute wk4 = cp-original-benefit / n
  5057        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5058           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5059        move wk3 to cp-calc-premium
  5060        go to 99999-return
  5061     end-if
  5062     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5063     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5064     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5065                   / (1 + I)
  5066     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5067     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5068     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5069        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5070     MOVE WK3                    TO CP-CALC-PREMIUM
  5071     GO TO 99999-RETURN
  5072      .
  5073 12001-CHECK-NC-NET.
  5074
  5075     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  5076        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5077        (CP-EARN-AS-NET-PAY)
  5078        NEXT SENTENCE
  5079     ELSE
  5080        GO TO 12001-CHECK-NC-NET-PLUS3.
  5081
  5082      COMPUTE ANGLEN EQUAL WK1 / I.
  5083      COMPUTE ANGLEN-M EQUAL WK5 / I.
  5084
  5085      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  5086          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  5087          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  5088          N * (CP-PREMIUM-RATE / 1000)).
  5089
  5090      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  5091          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  5092
  5093      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  94
* ELRATE.cbl
  5094          ((N - ANGLEN) / I + 3) / ANGLEN) /
  5095          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  5096          (ANGLEN * 2))
  5097
  5098      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  5099
  5100      IF ANGLEN IS NOT LESS THAN WK7
  5101          COMPUTE CP-PREMIUM-RATE ROUNDED =
  5102              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  5103          COMPUTE WK3 ROUNDED =
  5104              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  5105
  5106     MOVE WK3 TO CP-CALC-PREMIUM.
  5107
  5108     GO TO 99999-RETURN.
  5109
  5110 12001-CHECK-NC-NET-PLUS3.
  5111
  5112     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5113        (CP-EARN-AS-NET-PAY) AND
  5114        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  5115        NEXT SENTENCE
  5116     ELSE
  5117        GO TO 12001-CHECK-CA.
  5118
  5119     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  5120     MOVE ' ' TO DC-OPTION-CODE.
  5121     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  5122
  5123     IF DATE-CONVERSION-ERROR
  5124        MOVE '2'                 TO CP-RETURN-CODE
  5125        MOVE ZEROS               TO FACTOR
  5126                                    CP-CALC-PREMIUM
  5127         GO TO 99999-RETURN.
  5128
  5129     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  5130        NEXT SENTENCE
  5131     ELSE
  5132        GO TO 12001-CONTINUE-NET.
  5133
  5134     COMPUTE ANGLEN EQUAL WK1 / I.
  5135     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5136
  5137     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  5138
  5139     COMPUTE NC-R = 20 *
  5140                    ((NC-LR * ORIGINAL-TERM) / 12)
  5141                          / (ORIGINAL-TERM + 1).
  5142
  5143     COMPUTE NC-OB = NC-R / 1000.
  5144
  5145     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  5146                    (NC-OB * ORIGINAL-TERM * 3).
  5147
  5148     IF CP-EXT-CHG-LF
  5149         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  5150     ELSE
  5151         MOVE 30                 TO  NC-BIG-D.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  95
* ELRATE.cbl
  5152
  5153     COMPUTE NC-LITTLE-D = (1 + I) /
  5154             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  5155
  5156     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  5157             (ANGLEN * NC-LITTLE-D ).
  5158
  5159     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  5160
  5161     GO TO 99999-RETURN.
  5162
  5163 12001-CHECK-CA.
  5164
  5165     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5166        (WS-DISCOUNT-OPTION = '6')
  5167        NEXT SENTENCE
  5168     ELSE
  5169        GO TO 12001-CHECK-GTL-IA.
  5170
  5171     COMPUTE CA-J = CA-DISCOUNT / 12.
  5172     COMPUTE ANGLEN EQUAL WK1 / I.
  5173     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  5174     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  5175     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  5176     COMPUTE CA-VI = (1 + I)** -1.
  5177     COMPUTE CP-CALC-PREMIUM =
  5178         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  5179         ((1 + CA-J) / I) *
  5180         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  5181         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  5182         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  5183
  5184     GO TO 99999-RETURN.
  5185
  5186 12001-CHECK-GTL-IA.
  5187
  5188     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  5189        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  5190        (CP-EARN-AS-NET-PAY)
  5191        NEXT SENTENCE
  5192     ELSE
  5193        GO TO 12001-CHECK-CID-TRN-VA.
  5194
  5195***************************************************************
  5196
  5197     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  5198
  5199     IF GTL-IA-ODD-DAYS = ZEROS
  5200         MOVE ZERO               TO  GTL-IA-SGN
  5201     ELSE
  5202         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  5203             MOVE +1             TO  GTL-IA-SGN
  5204         ELSE
  5205             MOVE -1             TO  GTL-IA-SGN.
  5206
  5207     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  5208     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  5209
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  96
* ELRATE.cbl
  5210     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  5211                          GTL-IA-SGN.
  5212
  5213     COMPUTE ANGLEN EQUAL WK1 / I.
  5214     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5215
  5216     IF GTL-IA-ODF NOT = ZERO
  5217         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  5218         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  5219
  5220     COMPUTE GTL-IA-DIVIDEND =
  5221           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  5222                             (ANGLEN - ANGLEN-M))) *
  5223           ((K1 + I) * CP-PREMIUM-RATE *
  5224                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  5225
  5226     COMPUTE GTL-IA-DIVISOR =
  5227      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  5228
  5229     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  5230
  5231     COMPUTE CP-CALC-PREMIUM =
  5232                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  5233     GO TO 99999-RETURN.
  5234
  5235
  5236 12001-CHECK-CID-TRN-VA.
  5237
  5238     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5239        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  5240        (CP-EARN-AS-NET-PAY) AND
  5241        (CP-TRUNCATED-LIFE) AND
  5242        (CP-STATE-STD-ABBRV = CP-STATE)
  5243        CONTINUE
  5244     ELSE
  5245        GO TO 12001-CHECK-CID-TX
  5246     END-IF
  5247
  5248     COMPUTE ANGLEN EQUAL WK1 / I
  5249     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5250     IF WS-WORK-DIS-RATE = ZEROS
  5251        CONTINUE
  5252     ELSE
  5253        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5254        COMPUTE WK7 = (1 / I) *
  5255              (((WK4 ** M - 1) / (WK4 - 1)) -
  5256              ((WK4 ** M * SX - VX) /
  5257              (WK4 * (1 + I) - 1))) *
  5258              (CP-PREMIUM-RATE / 1000)
  5259        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5260        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5261        COMPUTE CP-CALC-PREMIUM =
  5262           WK8 *  ((WK4 * ANGLEN) / 100)
  5263     END-IF
  5264
  5265     GO TO 99999-RETURN
  5266
  5267     .
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  97
* ELRATE.cbl
  5268
  5269 12001-CHECK-CID-TX.
  5270     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5271        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5272        (CP-EARN-AS-NET-PAY) AND
  5273        (WS-WORK-DIS-RATE > ZEROS) AND
  5274        (CP-STATE-STD-ABBRV = CP-STATE)
  5275        CONTINUE
  5276     ELSE
  5277        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5278     END-IF
  5279* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5280     COMPUTE K-I = 1 + (1 * I)
  5281     COMPUTE ANGLEN EQUAL WK1 / I
  5282     COMPUTE ANGLEM EQUAL WK2 / I
  5283     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5284     IF WS-WORK-DIS-RATE = ZEROS
  5285        CONTINUE
  5286     ELSE
  5287        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5288        COMPUTE WK7 = (K-I / I) *
  5289              (((WK4 ** M - 1) / (WK4 - 1)) -
  5290*             ((WK4 ** M * SX - VX) /
  5291              ((WK4 ** M * SX) - VX) /
  5292*             (WK4 * (1 + I) - 1))) *
  5293              (WK4 * (1 + I) - 1)) *
  5294              (CP-PREMIUM-RATE / 1000)
  5295        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5296        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5297        COMPUTE CP-CALC-PREMIUM =
  5298           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5299     END-IF
  5300
  5301     GO TO 99999-RETURN
  5302     .
  5303 12001-CHECK-CID-LEV-MN-NEW.
  5304*    IF (CP-COMPANY-ID EQUAL 'CID')
  5305*       AND (CP-STATE-STD-ABBRV = 'MN')
  5306*       AND (CP-EARN-AS-NET-PAY)
  5307*       AND (CP-LEVEL-LIFE)
  5308*       AND (CP-CERT-EFF-DT > X'A4FF')
  5309*       CONTINUE
  5310*    ELSE
  5311*       GO TO 12001-CHECK-CID-LEV-MN
  5312*    END-IF
  5313*
  5314*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5315*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5316*    MOVE '1'                    TO DC-OPTION-CODE
  5317*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5318*
  5319*    IF DATE-CONVERSION-ERROR
  5320*       MOVE '2'                 TO CP-RETURN-CODE
  5321*       MOVE ZEROS               TO FACTOR
  5322*                                   CP-CALC-PREMIUM
  5323*       GO TO 99999-RETURN
  5324*    END-IF
  5325*
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  98
* ELRATE.cbl
  5326*    COMPUTE I = CP-LOAN-APR / 100
  5327*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5328*
  5329*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5330*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5331*      * 12 / 360 * D)
  5332*
  5333*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5334*       * 12 / 360 * D
  5335*
  5336*    GO TO 99999-RETURN
  5337      .
  5338 12001-CHECK-CID-LEV-MN.
  5339
  5340     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5341        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5342        (CP-EARN-AS-NET-PAY) AND
  5343        (CP-LEVEL-LIFE) AND
  5344        (CP-STATE-STD-ABBRV = CP-STATE)
  5345        CONTINUE
  5346     ELSE
  5347        GO TO 12001-CHECK-CID-LEV-CA
  5348     END-IF
  5349
  5350     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5351         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5352         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5353
  5354     GO TO 99999-RETURN
  5355
  5356      .
  5357 12001-CHECK-CID-LEV-CA.
  5358
  5359     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5360        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5361        (CP-EARN-AS-NET-PAY) AND
  5362        (CP-LEVEL-LIFE) AND
  5363        (CP-STATE-STD-ABBRV = CP-STATE)
  5364        CONTINUE
  5365     ELSE
  5366        GO TO 12001-CHECK-CID-TRN-CA
  5367     END-IF
  5368
  5369     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5370     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5371     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5372     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5373     COMPUTE CP-CALC-PREMIUM =
  5374          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5375          (CP-PREMIUM-RATE / 1000)) /
  5376          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5377
  5378     GO TO 99999-RETURN
  5379
  5380      .
  5381 12001-CHECK-CID-TRN-CA.
  5382
  5383     IF (CP-COMPANY-ID EQUAL 'CID')     AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page  99
* ELRATE.cbl
  5384        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5385        (CP-EARN-AS-NET-PAY) AND
  5386        (CP-TRUNCATED-LIFE) AND
  5387        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5388        (WS-DISCOUNT-OPTION NOT = ' ')
  5389        CONTINUE
  5390     ELSE
  5391        GO TO 12001-CHECK-CID-TRN-MT
  5392     END-IF
  5393
  5394     COMPUTE ANGLEN EQUAL WK1 / I
  5395     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5396     IF WS-WORK-DIS-RATE = ZEROS
  5397        CONTINUE
  5398     ELSE
  5399        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5400        COMPUTE WK7 = (1 / I) *
  5401              (((WK4 ** M - 1) / (WK4 - 1)) -
  5402              ((WK4 ** M * SX - VX) /
  5403              (WK4 * (1 + I) - 1))) *
  5404              (CP-PREMIUM-RATE / 1000)
  5405        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5406        COMPUTE CP-CALC-PREMIUM =
  5407           WK4 *  WK7
  5408     END-IF
  5409
  5410     GO TO 99999-RETURN
  5411
  5412      .
  5413 12001-CHECK-CID-TRN-MT.
  5414
  5415     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5416        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5417                   OR
  5418        ((CP-STATE-STD-ABBRV = 'IN') AND
  5419        (CP-CERT-EFF-DT > X'9A7F'))
  5420                   OR
  5421        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5422        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5423        (CP-EARN-AS-NET-PAY) AND
  5424        (CP-TRUNCATED-LIFE) AND
  5425        (CP-STATE-STD-ABBRV = CP-STATE)
  5426        CONTINUE
  5427     ELSE
  5428        GO TO 12001-CHECK-CID-MT
  5429     END-IF
  5430
  5431* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5432     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5433        MOVE 0                   TO K-I
  5434     ELSE
  5435        MOVE 2                   TO K-I
  5436     END-IF
  5437     COMPUTE CP-TERM-OR-EXT-DAYS =
  5438           CP-TERM-OR-EXT-DAYS + 30
  5439
  5440     COMPUTE ANGLEN EQUAL WK1 / I
  5441     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 100
* ELRATE.cbl
  5442     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5443                   / (1 + I)
  5444     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5445     IF WS-WORK-DIS-RATE = ZEROS
  5446        CONTINUE
  5447     ELSE
  5448        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5449*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5450        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5451              (((WK4 ** M - 1) / (WK4 - 1)) -
  5452              ((WK4 ** M * SX - VX) /
  5453              (WK4 * (1 + I) - 1))) *
  5454              (CP-PREMIUM-RATE / 1000)
  5455        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5456*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5457        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5458        COMPUTE CP-CALC-PREMIUM =
  5459           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5460*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5461     END-IF
  5462
  5463     GO TO 99999-RETURN
  5464
  5465     .
  5466 12001-CHECK-CID-MT.
  5467
  5468     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5469        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5470                                OR 'VT')
  5471                   OR
  5472        ((CP-STATE-STD-ABBRV = 'IN') AND
  5473        (CP-CERT-EFF-DT > X'9A7F'))
  5474                   OR
  5475        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5476        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5477        (CP-EARN-AS-NET-PAY) AND
  5478        (CP-STATE-STD-ABBRV = CP-STATE)
  5479        CONTINUE
  5480     ELSE
  5481        GO TO 12001-CHECK-DCC-DD
  5482     END-IF
  5483
  5484     COMPUTE CP-TERM-OR-EXT-DAYS =
  5485           CP-TERM-OR-EXT-DAYS + 30
  5486
  5487* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5488     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5489        MOVE 0                   TO K-I
  5490     ELSE
  5491        IF CP-STATE-STD-ABBRV = 'NJ'
  5492           MOVE 1                TO K-I
  5493        ELSE
  5494           MOVE 2                TO K-I
  5495        END-IF
  5496     END-IF
  5497     COMPUTE ANGLEN EQUAL WK1 / I
  5498     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5499     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 101
* ELRATE.cbl
  5500                   / (1 + I)
  5501     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5502     IF WS-WORK-DIS-RATE = ZEROS
  5503        CONTINUE
  5504     ELSE
  5505        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5506*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5507        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5508              (((WK4 ** N - 1) / (WK4 - 1)) -
  5509              ((WK4 ** N - SV) /
  5510              (WK4 * (1 + I) - 1))) *
  5511              (CP-PREMIUM-RATE / 1000)
  5512        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5513*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5514        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5515        COMPUTE CP-CALC-PREMIUM =
  5516           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5517*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5518     END-IF
  5519
  5520     GO TO 99999-RETURN
  5521
  5522     .
  5523 12001-CHECK-DCC-DD.
  5524     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5525        AND (CP-EARN-AS-NET-PAY)
  5526        AND (CP-BEN-CATEGORY = 'D')
  5527        CONTINUE
  5528     ELSE
  5529        GO TO 12001-CHECK-DCC-NET
  5530     END-IF
  5531
  5532     COMPUTE CP-TERM-OR-EXT-DAYS =
  5533           CP-TERM-OR-EXT-DAYS + 30
  5534
  5535     COMPUTE ANGLEN EQUAL WK1 / I.
  5536     COMPUTE ANGLEM EQUAL WK2 / I.
  5537     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5538
  5539     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5540           / (1 + I)
  5541     COMPUTE GR     = ANGLEN / ODF
  5542*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5543*      CP-RATE-DEV-PCT
  5544     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5545     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5546       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5547     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5548     MOVE WK3                    TO CP-CALC-PREMIUM
  5549
  5550     GO TO 99999-RETURN
  5551
  5552     .
  5553 12001-CHECK-DCC-NET.
  5554
  5555     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5556        AND (CP-EARN-AS-NET-PAY)
  5557        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 102
* ELRATE.cbl
  5558             AND 'H' AND 'S' AND 'P')
  5559        CONTINUE
  5560     ELSE
  5561        GO TO 12001-CHECK-DCC-PNET
  5562     END-IF
  5563
  5564     COMPUTE CP-TERM-OR-EXT-DAYS =
  5565           CP-TERM-OR-EXT-DAYS + 30
  5566
  5567     COMPUTE ANGLEN EQUAL WK1 / I.
  5568     COMPUTE ANGLEM EQUAL WK2 / I.
  5569     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5570
  5571     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5572           / (1 + I)
  5573     COMPUTE GR     = ANGLEN / ODF
  5574     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5575     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5576       CP-RATE-DEV-PCT
  5577     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5578*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5579
  5580     COMPUTE WK8 = CP-PREMIUM-RATE *
  5581        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5582     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5583     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5584     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5585       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5586     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5587     MOVE WK3                    TO CP-CALC-PREMIUM
  5588
  5589     GO TO 99999-RETURN
  5590
  5591     .
  5592 12001-CHECK-DCC-PNET.
  5593     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5594        AND (CP-EARN-AS-NET-PAY)
  5595        AND (CP-BENEFIT-CD (1:1) = 'P')
  5596        CONTINUE
  5597     ELSE
  5598        GO TO 12001-CHECK-DCC-MNET
  5599     END-IF
  5600     IF CP-NO-OF-PMTS NOT NUMERIC
  5601        MOVE +0                  TO CP-NO-OF-PMTS
  5602     END-IF
  5603     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5604        AND ' ' AND 'M'
  5605        MOVE ' '                 TO CP-PMT-MODE
  5606     END-IF
  5607******************************************************************
  5608***   Default is monthly, use loan term for rate and amort     ***
  5609******************************************************************
  5610     move cp-loan-term         to c-tot-pmts
  5611     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5612     MOVE +12                  TO C-PMTS-PER-YEAR
  5613******************************************************************
  5614
  5615     evaluate true
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 103
* ELRATE.cbl
  5616        when cp-pmt-mode = 'W'
  5617           MOVE +52              TO C-PMTS-PER-YEAR
  5618           compute c-tot-pmts = cp-loan-term /
  5619              12 * c-pmts-per-year
  5620           MOVE +7               TO C-DAYS-IN-PMT-PER
  5621        when cp-pmt-mode = 'B'
  5622           MOVE +26              TO C-PMTS-PER-YEAR
  5623           compute c-tot-pmts = cp-loan-term /
  5624              12 * c-pmts-per-year
  5625           MOVE +14              TO C-DAYS-IN-PMT-PER
  5626     end-evaluate
  5627     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5628     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5629        C-DAYS-IN-PMT-PER)) / (1 + I)
  5630     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5631*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5632     COMPUTE ANGLEN-1 = ANGLEN / Y
  5633     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5634     IF CP-RATE-DEV-PCT NOT = ZEROS
  5635        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5636           CP-PREMIUM-RATE
  5637     END-IF
  5638     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5639     GO TO 99999-RETURN
  5640     .
  5641 12001-CHECK-DCC-MNET.
  5642
  5643     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5644        AND (CP-EARN-AS-NET-PAY)
  5645        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5646        CONTINUE
  5647     ELSE
  5648        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5649     END-IF
  5650
  5651*    COMPUTE ANGLEN EQUAL WK1 / I.
  5652*    COMPUTE ANGLEM EQUAL WK2 / I.
  5653*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5654
  5655     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5656     MOVE WK3                    TO CP-CALC-PREMIUM
  5657
  5658     GO TO 99999-RETURN
  5659
  5660     .
  5661 12001-CHECK-DCC-MNET-LF-BAL.
  5662
  5663     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5664        AND (CP-EARN-AS-NET-PAY)
  5665        AND (CP-BENEFIT-CD (1:1) = 'N')
  5666        AND (CP-BEN-CATEGORY NOT = 'N')
  5667        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5668        CONTINUE
  5669     ELSE
  5670        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5671     END-IF
  5672
  5673     IF CP-RATE-DEV-PCT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 104
* ELRATE.cbl
  5674        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5675           CP-PREMIUM-RATE
  5676     END-IF
  5677*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5678     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5679        / (1 + I)
  5680     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5681     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5682     COMPUTE WK2 = (1 + J) ** (M * -1)
  5683     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5684     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5685          ** ((M - 1) * -1))) / J)
  5686     COMPUTE ANGLEM = ((1 - ((1 + J)
  5687          ** (M * -1))) / J) / OD
  5688     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5689        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5690        / ANGLEM-1
  5691     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5692          ** ((N - M) * -1))) / I)
  5693     MOVE +0                     TO WK3
  5694     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5695        (WS-COUNTER > M)
  5696        COMPUTE ANGLEM = (1 - ((1 + J)
  5697          ** ((M - WS-COUNTER) * -1))) / J
  5698        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5699        COMPUTE WK5-CSL = (RA * ANGLEM)
  5700        + (CP-ALTERNATE-BENEFIT * WK2)
  5701        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5702     END-PERFORM
  5703     MOVE WK3                    TO CP-CALC-PREMIUM
  5704
  5705     GO TO 99999-RETURN
  5706
  5707     .
  5708 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5709
  5710     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5711        AND (CP-EARN-AS-NET-PAY)
  5712        AND (CP-BENEFIT-CD (1:1) = 'S')
  5713        AND (CP-BEN-CATEGORY NOT = 'N')
  5714        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5715        CONTINUE
  5716     ELSE
  5717        GO TO 12001-CHECK-DCC-MNET-LF
  5718     END-IF
  5719
  5720     IF CP-RATE-DEV-PCT NOT = ZEROS
  5721        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5722           CP-PREMIUM-RATE
  5723     END-IF
  5724     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5725     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5726          ** ((M - 1) * -1))) / K)
  5727     COMPUTE ANGLEM = ((1 - ((1 + K)
  5728          ** (M * -1))) / K)
  5729     MOVE CP-MONTHLY-PAYMENT     TO RA
  5730     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5731        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 105
* ELRATE.cbl
  5732        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5733        CP-PREMIUM-RATE / 1000
  5734     MOVE WK3                    TO CP-CALC-PREMIUM
  5735
  5736     GO TO 99999-RETURN
  5737
  5738     .
  5739 12001-CHECK-DCC-MNET-LF.
  5740
  5741     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5742        AND (CP-EARN-AS-NET-PAY)
  5743        AND (CP-BENEFIT-CD (1:1) = 'N')
  5744        AND (CP-BEN-CATEGORY NOT = 'N')
  5745        CONTINUE
  5746     ELSE
  5747        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5748     END-IF
  5749
  5750     IF CP-RATE-DEV-PCT NOT = ZEROS
  5751        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5752           CP-PREMIUM-RATE
  5753     END-IF
  5754*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5755     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5756        / (1 + I)
  5757     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5758     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5759     COMPUTE WK2 = (1 + J) ** (M * -1)
  5760     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5761     COMPUTE ANGLEM = ((1 - ((1 + J)
  5762          ** (M * -1))) / J) / OD
  5763     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5764     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5765          ** ((N - M) * -1))) / I)
  5766     MOVE +0                     TO WK3
  5767     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5768        (WS-COUNTER > M)
  5769        COMPUTE ANGLEM = (1 - ((1 + J)
  5770          ** ((M - WS-COUNTER + 1) * -1))) / J
  5771        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5772        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5773        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5774     END-PERFORM
  5775     MOVE WK3                    TO CP-CALC-PREMIUM
  5776
  5777     GO TO 99999-RETURN
  5778
  5779     .
  5780 12001-CHECK-DCC-MNET-SUMLF.
  5781
  5782     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5783        AND (CP-EARN-AS-NET-PAY)
  5784        AND (CP-BENEFIT-CD (1:1) = 'S')
  5785        AND (CP-BEN-CATEGORY NOT = 'N')
  5786        CONTINUE
  5787     ELSE
  5788        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5789     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 106
* ELRATE.cbl
  5790
  5791     IF CP-RATE-DEV-PCT NOT = ZEROS
  5792        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5793           CP-PREMIUM-RATE
  5794     END-IF
  5795     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5796     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5797        / (1 + K)
  5798     COMPUTE ANGLEN-M = (WK5 / I)
  5799     COMPUTE WK2 = (1 + K) ** (M * -1)
  5800     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5801     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5802     COMPUTE ANGLEM = ((1 - ((1 + K)
  5803          ** (M * -1))) / K) / Y
  5804     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5805     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5806        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5807        - 1)) / K) * RA
  5808     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5809        + (CP-DAYS-TO-1ST-PMT - +30)
  5810        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5811        +0 / 1000 * 12 / 12)
  5812     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5813        * (12 / 12)
  5814     MOVE WK3                    TO CP-CALC-PREMIUM
  5815
  5816     GO TO 99999-RETURN
  5817
  5818     .
  5819 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5820
  5821     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5822        AND (CP-EARN-AS-NET-PAY)
  5823        AND (CP-BENEFIT-CD (1:1) = 'N')
  5824        AND (CP-BEN-CATEGORY = 'N')
  5825        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5826        CONTINUE
  5827     ELSE
  5828        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5829     END-IF
  5830
  5831*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5832     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5833        / (1 + I)
  5834     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5835     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5836     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5837     COMPUTE WK2 = (1 + J) ** (M * -1)
  5838     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5839     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5840          ** ((M - 1) * -1))) / J)
  5841     COMPUTE ANGLEM = ((1 - ((1 + J)
  5842          ** (M * -1))) / J) / OD
  5843     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5844        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5845        / ANGLEM-1
  5846     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5847          ** ((N - M) * -1))) / I)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 107
* ELRATE.cbl
  5848     MOVE +0                     TO WK3
  5849     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5850        (WS-COUNTER > M)
  5851        COMPUTE ANGLEM = (1 - ((1 + J)
  5852          ** ((M - WS-COUNTER) * -1))) / J
  5853        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5854        COMPUTE WK5-CSL = (RA * ANGLEM)
  5855        + (CP-ALTERNATE-BENEFIT * WK2)
  5856        COMPUTE WK3 = WK3 +
  5857         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5858        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5859          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5860          (CP-DCC-AH-RATE / 1000)
  5861     END-PERFORM
  5862     MOVE WK3                    TO CP-CALC-PREMIUM
  5863
  5864     GO TO 99999-RETURN
  5865
  5866     .
  5867 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5868
  5869     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5870        AND (CP-EARN-AS-NET-PAY)
  5871        AND (CP-BENEFIT-CD (1:1) = 'S')
  5872        AND (CP-BEN-CATEGORY = 'N')
  5873        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5874        CONTINUE
  5875     ELSE
  5876        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5877     END-IF
  5878
  5879     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5880     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5881          ** ((M - 1) * -1))) / K)
  5882     COMPUTE ANGLEM = ((1 - ((1 + K)
  5883          ** (M * -1))) / K)
  5884     MOVE CP-MONTHLY-PAYMENT     TO RA
  5885     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5886        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5887        * CP-DCC-AH-RATE / 1000))
  5888        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5889        CP-DCC-LF-RATE / 1000
  5890     MOVE WK3                    TO CP-LF-PREM
  5891     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5892        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5893        * CP-DCC-AH-RATE / 1000
  5894     COMPUTE WK3 = WK3 + WK5-CSL
  5895     MOVE WK3                    TO CP-CALC-PREMIUM
  5896
  5897     GO TO 99999-RETURN
  5898      .
  5899 12001-CHECK-DCC-MNET-TOT-N.
  5900
  5901     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5902        AND (CP-EARN-AS-NET-PAY)
  5903        AND (CP-BENEFIT-CD (1:1) = 'N')
  5904        AND (CP-BEN-CATEGORY = 'N')
  5905        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 108
* ELRATE.cbl
  5906     ELSE
  5907        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5908     END-IF
  5909
  5910*    I = APR/1200
  5911*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5912*    RA = PAYMENT AMOUNT
  5913*    WK5-CSL = THE BALANCE (PAY OFF )
  5914*    WK3 = THE ACCUMULATED PREMIUM
  5915*    WK2 = (1 + I) ^ (m * -1)
  5916*    OD  = GAMMA
  5917*
  5918*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5919     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5920        / (1 + I)
  5921     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5922     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5923        (CP-DCC-AH-RATE / +1000)
  5924     COMPUTE WK2 = (1 + J) ** (M * -1)
  5925     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5926     COMPUTE ANGLEM = ((1 - ((1 + J)
  5927          ** (M * -1))) / J) / OD
  5928     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5929     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5930          ** ((N - M) * -1))) / I)
  5931     MOVE +0                     TO WK3
  5932     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5933        (WS-COUNTER > M)
  5934        COMPUTE ANGLEM = (1 - ((1 + J)
  5935          ** ((M - WS-COUNTER + 1) * -1))) / J
  5936        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5937        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5938        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5939           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5940     END-PERFORM
  5941     MOVE WK3                    TO CP-CALC-PREMIUM
  5942
  5943     GO TO 99999-RETURN
  5944
  5945     .
  5946 12001-CHECK-DCC-MNET-TOT-S.
  5947
  5948     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5949        AND (CP-EARN-AS-NET-PAY)
  5950        AND (CP-BENEFIT-CD (1:1) = 'S')
  5951        AND (CP-BEN-CATEGORY = 'N')
  5952        CONTINUE
  5953     ELSE
  5954        GO TO 12001-CONTINUE-NET
  5955     END-IF
  5956
  5957*    I = APR/1200
  5958*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5959*    RA = PAYMENT AMOUNT
  5960*    WK5-CSL = THE BALANCE (PAY OFF )
  5961*    WK3 = THE ACCUMULATED PREMIUM
  5962*    WK2 = (1 + I) ^ (m * -1)
  5963*    OD  = GAMMA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 109
* ELRATE.cbl
  5964*
  5965     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5966     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5967        / (1 + J)
  5968     COMPUTE ANGLEM = ((1 - ((1 + J)
  5969          ** (M * -1))) / J) / OD
  5970     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5971          ** ((N - M) * -1))) / I)
  5972          * (1 + J) ** (-1 * M)
  5973     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5974     MOVE CP-MONTHLY-PAYMENT     TO RA
  5975     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5976        / +30)
  5977     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5978        ** (WK1) - 1)) / J) * RA
  5979     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5980        + (CP-DAYS-TO-1ST-PMT - +30)
  5981        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5982        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5983     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5984        (12 / 12)
  5985     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5986        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5987        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5988     COMPUTE WK3 = WK3 + WK5-CSL
  5989     MOVE WK3                    TO CP-CALC-PREMIUM
  5990     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5991     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5992        / (1 + K)
  5993     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5994          ** ((N - M) * -1))) / I)
  5995     COMPUTE WK2 = (1 + K) ** (M * -1)
  5996     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5997     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5998     COMPUTE ANGLEM = ((1 - ((1 + K)
  5999          ** (M * -1))) / K) / Y
  6000*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6001     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  6002        ((1 + K) ** (M + 1 / Y
  6003        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6004        - 1)) / K) * RA
  6005     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6006        + (CP-DAYS-TO-1ST-PMT - +30)
  6007        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6008        CP-DCC-AH-RATE / 1000 * 12 / 12)
  6009     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  6010        * (12 / 12)
  6011     MOVE WK3                    TO CP-LF-PREM
  6012
  6013     GO TO 99999-RETURN
  6014
  6015     .
  6016 12001-CONTINUE-NET.
  6017
  6018     IF NET-STD
  6019        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  6020*          OR 'DCC'
  6021         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 110
* ELRATE.cbl
  6022         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6023         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6024         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6025                               * ((1 + N) / (1 + M))
  6026         if (i = .0000000001)
  6027            and (wk3 = zeros)
  6028            move 1               to wk3
  6029         end-if
  6030        ELSE
  6031         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6032         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6033         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6034         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  6035
  6036     IF NET-SMP
  6037         COMPUTE N2 = N * N
  6038         COMPUTE N3 = N2 * N
  6039         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  6040         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  6041         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  6042         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  6043         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  6044
  6045     IF NPO-PRUDENTIAL
  6046       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  6047           VARYING WS-COUNTER FROM 1 BY 1
  6048               UNTIL WS-COUNTER = N
  6049       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  6050       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  6051
  6052     MOVE WK3 TO FACTOR.
  6053
  6054     GO TO 99999-RETURN.
  6055
  6056 12100-PRU-CALC.
  6057     IF WS-COUNTER = 1
  6058         COMPUTE PWK = (I + 1)
  6059     ELSE
  6060         COMPUTE PWK = PWK * (I + 1).
  6061
  6062 12199-EXIT.
  6063      EXIT.
  6064
  6065 99000-ERROR.
  6066     MOVE +9999.999999999 TO N-P-FACTOR.
  6067     MOVE '4'             TO CP-RETURN-CODE.
  6068
  6069     GO TO 99999-EXIT.
  6070
  6071 99999-RETURN.
  6072     MOVE FACTOR          TO N-P-FACTOR.
  6073
  6074 99999-EXIT.
  6075      EXIT.
  6076 99999-DUMMY-STOP-RUN.
  6077
  6078* GOBACK.
  6079     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:22 Page 111
* ELRATE.cbl
  6080     MOVE 'ELRATE' TO DFHEIV1
  6081     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6082     GOBACK.
  6083
  6084
  6085 9999-DFHBACK SECTION.
  6086     MOVE '9%                    "   ' TO DFHEIV0
  6087     MOVE 'ELRATE' TO DFHEIV1
  6088     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6089     GOBACK.
  6090 9999-DFHEXIT.
  6091     IF DFHEIGDJ EQUAL 0001
  6092         NEXT SENTENCE
  6093     ELSE IF DFHEIGDJ EQUAL 2
  6094         GO TO 9999-RATE-NOTFND,
  6095               9999-RATE-NOTOPEN,
  6096               9999-RATE-NOTFND
  6097         DEPENDING ON DFHEIGDI.
  6098     MOVE '9%                    "   ' TO DFHEIV0
  6099     MOVE 'ELRATE' TO DFHEIV1
  6100     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6101     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2620     Code:       56416
