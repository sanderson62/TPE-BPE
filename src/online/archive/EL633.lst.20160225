* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56* 110315  CR2015101400001  PEMA ADD NEW DCC G/L #'S FOR ACH
    57* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    58******************************************************************
    59
    60 ENVIRONMENT DIVISION.
    61 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   3
* EL633.cbl
    63 WORKING-STORAGE SECTION.
    64 01  DFH-START PIC X(04).
    65 77  FILLER  PIC X(32)  VALUE '********************************'.
    66 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    67 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    68
    69*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    70*77  SV-COFA PIC X(42)  VALUE SPACES.
    71*77  K-SPACE PIC X(11)  VALUE SPACES.
    72
    73 01  DATE-WORK-AREAS.
    74     05  WS-GREG-STORE.
    75         10  WS-GS-MM  PIC XX.
    76         10  FILLER    PIC X.
    77         10  WS-GS-DD  PIC XX.
    78         10  FILLER    PIC X.
    79         10  WS-GS-YY  PIC XX.
    80     05  WS-SDTE-STORE.
    81         10  WS-SS-MM  PIC XX.
    82         10  WS-SS-DD  PIC XX.
    83         10  WS-SS-YY  PIC XX.
    84*                            COPY ELCSCTM.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCTM                             *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-MESSAGE.
    95     12  FILLER                          PIC X(30)
    96            VALUE '** LOGIC SECURITY VIOLATION -'.
    97     12  SM-READ                         PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' PGM='.
   100     12  SM-PGM                          PIC X(6).
   101     12  FILLER                          PIC X(5)
   102            VALUE ' OPR='.
   103     12  SM-PROCESSOR-ID                 PIC X(4).
   104     12  FILLER                          PIC X(6)
   105            VALUE ' TERM='.
   106     12  SM-TERMID                       PIC X(4).
   107     12  FILLER                          PIC XX   VALUE SPACE.
   108     12  SM-JUL-DATE                     PIC 9(5).
   109     12  FILLER                          PIC X    VALUE SPACE.
   110     12  SM-TIME                         PIC 99.99.
   111
   112*                            COPY ELCSCRTY.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCSCRTY                            *
   117*                            VMOD=2.001                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   120*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   4
* EL633.cbl
   121*        SAVED IN PI-SECURITY-ADDRESS.                           *
   122*                                                                *
   123******************************************************************
   124 01  SECURITY-CONTROL.
   125     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   126     12  FILLER                       PIC XX    VALUE 'SC'.
   127     12  SC-CREDIT-CODES.
   128         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   129             20  SC-CREDIT-DISPLAY    PIC X.
   130             20  SC-CREDIT-UPDATE     PIC X.
   131     12  SC-CLAIMS-CODES.
   132         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   133             20  SC-CLAIMS-DISPLAY    PIC X.
   134             20  SC-CLAIMS-UPDATE     PIC X.
   135
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   5
* EL633.cbl
   137
   138 01  STANDARD-AREAS.
   139     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   140     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   141     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   142     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   143     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   144     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   145     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   146     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   147     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   148     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   149     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   150     12  PGM-NAME            PIC  X(8).
   151     12  TIME-IN             PIC S9(7).
   152     12  TIME-OUT-R  REDEFINES  TIME-IN.
   153         16  FILLER          PIC  X.
   154         16  TIME-OUT        PIC  99V99.
   155         16  FILLER          PIC  X(2).
   156     12  EL640               PIC  X(8)       VALUE 'EL640'.
   157     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   158     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   159     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   160     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   161     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   162     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   163     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   164     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   165     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   166     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   167     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   168     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   169     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   170     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   171     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   172     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   173     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   174         88  PYAJ-1ST-READ                   VALUE 'Y'.
   175     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   176         88  FIRST-ADD                       VALUE 'Y'.
   177     12  ZERO-NDX            PIC  9          VALUE ZERO.
   178     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   179     12  WORK-SEQ-TIME       PIC  9(6).
   180     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   181         16  WORK-SEQ-HHMMS  PIC  9(5).
   182         16  FILLER          PIC  9.
   183     12  WORK-DATE-JULIAN.
   184         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   185         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   186     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   187     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   188         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   189                                                    'S' 'T' 'U'
   190                                                    'X' 'Y' 'Z'
   191                                                    'F'.
   192     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   193         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   194     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   6
* EL633.cbl
   195         88  FORCE-SHOW                      VALUE  'Y'.
   196
   197     12  WS-EOM-DTS OCCURS 13  TIMES
   198                              INDEXED BY PINDEX.
   199         16  WS-EOM-DT               PIC XX.
   200*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   201
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   7
* EL633.cbl
   203     12  WS-ERROR-CODES.
   204         16  ER-0000         PIC  X(4)       VALUE '0000'.
   205         16  ER-0008         PIC  X(4)       VALUE '0008'.
   206         16  ER-0023         PIC  X(4)       VALUE '0023'.
   207         16  ER-0029         PIC  X(4)       VALUE '0029'.
   208         16  ER-0070         PIC  X(4)       VALUE '0070'.
   209         16  ER-0587         PIC  X(4)       VALUE '0587'.
   210         16  ER-2056         PIC  X(4)       VALUE '2056'.
   211         16  ER-2230         PIC  X(4)       VALUE '2230'.
   212         16  ER-2231         PIC  X(4)       VALUE '2231'.
   213         16  ER-2232         PIC  X(4)       VALUE '2232'.
   214         16  ER-2233         PIC  X(4)       VALUE '2233'.
   215         16  ER-2234         PIC  X(4)       VALUE '2234'.
   216         16  ER-2235         PIC  X(4)       VALUE '2235'.
   217         16  ER-2236         PIC  X(4)       VALUE '2236'.
   218         16  ER-2237         PIC  X(4)       VALUE '2237'.
   219         16  ER-2238         PIC  X(4)       VALUE '2238'.
   220         16  ER-2239         PIC  X(4)       VALUE '2239'.
   221         16  ER-2244         PIC  X(4)       VALUE '2244'.
   222         16  ER-2245         PIC  X(4)       VALUE '2245'.
   223         16  ER-2246         PIC  X(4)       VALUE '2246'.
   224         16  ER-2370         PIC  X(4)       VALUE '2370'.
   225         16  ER-2432         PIC  X(4)       VALUE '2432'.
   226         16  ER-2449         PIC  X(4)       VALUE '2449'.
   227         16  ER-2587         PIC  X(4)       VALUE '2587'.
   228         16  ER-2588         PIC  X(4)       VALUE '2588'.
   229         16  ER-2595         PIC  X(4)       VALUE '2595'.
   230         16  ER-2596         PIC  X(4)       VALUE '2596'.
   231         16  ER-2763         PIC  X(4)       VALUE '2763'.
   232         16  ER-2929         PIC  X(4)       VALUE '2929'.
   233         16  ER-2957         PIC  X(4)       VALUE '2957'.
   234         16  ER-2958         PIC  X(4)       VALUE '2958'.
   235*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   236         16  ER-2960         PIC  X(4)       VALUE '2960'.
   237         16  ER-3020         PIC  X(4)       VALUE '3020'.
   238
   239*************************************************************
   240*                      TABLE OF STATE NAMES
   241*************************************************************
   242
   243 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   244     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   245                                   'CD' 'CO' 'CT' 'DC' 'DE'
   246                                   'FL' 'GA' 'GM' 'HI' 'IA'
   247                                   'ID' 'IL' 'IN' 'KS' 'KY'
   248                                   'LA' 'MA' 'MD' 'ME' 'MI'
   249                                   'MN' 'MO' 'MS' 'MT' 'MX'
   250                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   251                                   'NM' 'NV' 'NY' 'OF' 'OH'
   252                                   'OK' 'OR' 'PA' 'PI' 'PR'
   253                                   'RI' 'SC' 'SD' 'TN' 'TX'
   254                                   'UT' 'VA' 'VI' 'VT' 'WA'
   255                                   'WI' 'WV' 'WY'.
   256
   257 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   258     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   259                                 '1108124700'
   260                                 '1108125100'
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   8
* EL633.cbl
   261                                 '1721211400'
   262                                 '1825011200'
   263                                 '1825011300'
   264                                 '1825091000'
   265                                 '1825099050'
   266                                 '8505700033'
   267                                 '8506400030'
   268                                 '8507200020'
   269                                 '8507200010'.
   270     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   271                                     '2725040320'
   272                                     '2725040330'
   273                                     '2725040310'
   274                                     '8506400030'
   275                                     '8507200010'
   276                                     '1108121250'.
   277     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   278                                     '2725040110'
   279                                     '2725040120'
   280                                     '2725040130'
   281                                     '2725020400'.
   282
   283     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   284                                     '1825013200'
   285                                     '1825013300'
   286                                     '1825013400'
   287                                     '8506400030'
   288                                     '8507200010'
   289                                     '8507200020'
   290                                     '1108121010'.
   291
   292*01  WS-ACCT-BREAK.
   293*    05  WS-ACCT-1               PIC X.
   294*    05  FILLER                  PIC X(6).
   295*
   296 01  WORK-AREA.
   297     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   298     12  QID.
   299         16  QID-TERM        PIC X(04).
   300         16  FILLER          PIC X(04)       VALUE '633A'.
   301     12  DEEDIT-FIELD        PIC X(11).
   302     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   303     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   304     12  DATE-TEST-AREA      PIC  9(6).
   305     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   306         16  DATE-TEST-MM    PIC  99.
   307         16  DATE-TEST-DD    PIC  99.
   308         16  DATE-TEST-YY    PIC  99.
   309     12  DIVIDE-RESULT       PIC  99.
   310     12  DIVIDE-REMAINDER    PIC  9.
   311     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   312     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   313     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   314     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   315     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   316     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   317     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   318     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page   9
* EL633.cbl
   319
   320 01  ACCESS-KEYS.
   321     12  ERPYAJ-KEY.
   322         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   323         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   324         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   325         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   326         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   327         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   328         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   329
   330     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   331     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   332
   333     12  ERCHKQ-KEY.
   334         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   335         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   336         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   337     12  ERCOMP-KEY.
   338         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   339         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   340         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   341         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   342         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   343         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   344*    12  COFA-KEY-X.
   345*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   346*        16  COFA-ACCOUNT.
   347*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   348*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   349*
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  10
* EL633.cbl
   351*                                    COPY ELCDATE.
   352******************************************************************
   353*                                                                *
   354*                                                                *
   355*                            ELCDATE.                            *
   356*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   357*                            VMOD=2.003
   358*                                                                *
   359*                                                                *
   360*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   361*                 LENGTH = 200                                   *
   362******************************************************************
   363
   364 01  DATE-CONVERSION-DATA.
   365     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   366     12  DC-OPTION-CODE                PIC X.
   367         88  BIN-TO-GREG                VALUE ' '.
   368         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   369         88  EDIT-GREG-TO-BIN           VALUE '2'.
   370         88  YMD-GREG-TO-BIN            VALUE '3'.
   371         88  MDY-GREG-TO-BIN            VALUE '4'.
   372         88  JULIAN-TO-BIN              VALUE '5'.
   373         88  BIN-PLUS-ELAPSED           VALUE '6'.
   374         88  FIND-CENTURY               VALUE '7'.
   375         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   376         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   377         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   378         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   379         88  JULIAN-TO-BIN-3            VALUE 'C'.
   380         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   381         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   382         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   383         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   384         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   385         88  CHECK-LEAP-YEAR            VALUE 'H'.
   386         88  BIN-3-TO-GREG              VALUE 'I'.
   387         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   388         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   389         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   390         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   391         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   392         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   393         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   394         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   395         88  THREE-CHARACTER-BIN
   396                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   397         88  GREGORIAN-TO-BIN
   398                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   399         88  BIN-TO-GREGORIAN
   400                  VALUES ' ' '1' 'I' '8' 'G'.
   401         88  JULIAN-TO-BINARY
   402                  VALUES '5' 'C' 'E' 'F'.
   403     12  DC-ERROR-CODE                 PIC X.
   404         88  NO-CONVERSION-ERROR        VALUE ' '.
   405         88  DATE-CONVERSION-ERROR
   406                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   407         88  DATE-IS-ZERO               VALUE '1'.
   408         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  11
* EL633.cbl
   409         88  DATE-IS-INVALID            VALUE '3'.
   410         88  DATE1-GREATER-DATE2        VALUE '4'.
   411         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   412         88  DATE-INVALID-OPTION        VALUE '9'.
   413         88  INVALID-CENTURY            VALUE 'A'.
   414         88  ONLY-CENTURY               VALUE 'B'.
   415         88  ONLY-LEAP-YEAR             VALUE 'C'.
   416         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   417     12  DC-END-OF-MONTH               PIC X.
   418         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   419     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   420         88  USE-NORMAL-PROCESS         VALUE ' '.
   421         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   422         88  ADJUST-UP-100-YRS          VALUE '2'.
   423     12  FILLER                        PIC X.
   424     12  DC-CONVERSION-DATES.
   425         16  DC-BIN-DATE-1             PIC XX.
   426         16  DC-BIN-DATE-2             PIC XX.
   427         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   428         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   429                       DC-GREG-DATE-1-EDIT.
   430             20  DC-EDIT1-MONTH        PIC 99.
   431             20  SLASH1-1              PIC X.
   432             20  DC-EDIT1-DAY          PIC 99.
   433             20  SLASH1-2              PIC X.
   434             20  DC-EDIT1-YEAR         PIC 99.
   435         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   436         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   437                     DC-GREG-DATE-2-EDIT.
   438             20  DC-EDIT2-MONTH        PIC 99.
   439             20  SLASH2-1              PIC X.
   440             20  DC-EDIT2-DAY          PIC 99.
   441             20  SLASH2-2              PIC X.
   442             20  DC-EDIT2-YEAR         PIC 99.
   443         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   444         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   445                     DC-GREG-DATE-1-YMD.
   446             20  DC-YMD-YEAR           PIC 99.
   447             20  DC-YMD-MONTH          PIC 99.
   448             20  DC-YMD-DAY            PIC 99.
   449         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   450         16  DC-GREG-DATE-1-MDY-R REDEFINES
   451                      DC-GREG-DATE-1-MDY.
   452             20  DC-MDY-MONTH          PIC 99.
   453             20  DC-MDY-DAY            PIC 99.
   454             20  DC-MDY-YEAR           PIC 99.
   455         16  DC-GREG-DATE-1-ALPHA.
   456             20  DC-ALPHA-MONTH        PIC X(10).
   457             20  DC-ALPHA-DAY          PIC 99.
   458             20  FILLER                PIC XX.
   459             20  DC-ALPHA-CENTURY.
   460                 24 DC-ALPHA-CEN-N     PIC 99.
   461             20  DC-ALPHA-YEAR         PIC 99.
   462         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   463         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   464         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   465         16  DC-JULIAN-DATE            PIC 9(05).
   466         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  12
* EL633.cbl
   467                                       PIC 9(05).
   468         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   469             20  DC-JULIAN-YEAR        PIC 99.
   470             20  DC-JULIAN-DAYS        PIC 999.
   471         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   472         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   473         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   474     12  DATE-CONVERSION-VARIBLES.
   475         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   476         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   477             20  FILLER                PIC 9(3).
   478             20  HOLD-CEN-1-CCYY.
   479                 24  HOLD-CEN-1-CC     PIC 99.
   480                 24  HOLD-CEN-1-YY     PIC 99.
   481             20  HOLD-CEN-1-MO         PIC 99.
   482             20  HOLD-CEN-1-DA         PIC 99.
   483         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   484             20  HOLD-CEN-1-R-MO       PIC 99.
   485             20  HOLD-CEN-1-R-DA       PIC 99.
   486             20  HOLD-CEN-1-R-CCYY.
   487                 24  HOLD-CEN-1-R-CC   PIC 99.
   488                 24  HOLD-CEN-1-R-YY   PIC 99.
   489             20  FILLER                PIC 9(3).
   490         16  HOLD-CENTURY-1-X.
   491             20  FILLER                PIC X(3)  VALUE SPACES.
   492             20  HOLD-CEN-1-X-CCYY.
   493                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   494                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   495             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   496             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   497         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   498             20  HOLD-CEN-1-R-X-MO     PIC XX.
   499             20  HOLD-CEN-1-R-X-DA     PIC XX.
   500             20  HOLD-CEN-1-R-X-CCYY.
   501                 24  HOLD-CEN-1-R-X-CC PIC XX.
   502                 24  HOLD-CEN-1-R-X-YY PIC XX.
   503             20  FILLER                PIC XXX.
   504         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   505         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   506         16  DC-JULIAN-DATE-1          PIC 9(07).
   507         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   508             20  DC-JULIAN-1-CCYY.
   509                 24  DC-JULIAN-1-CC    PIC 99.
   510                 24  DC-JULIAN-1-YR    PIC 99.
   511             20  DC-JULIAN-DA-1        PIC 999.
   512         16  DC-JULIAN-DATE-2          PIC 9(07).
   513         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   514             20  DC-JULIAN-2-CCYY.
   515                 24  DC-JULIAN-2-CC    PIC 99.
   516                 24  DC-JULIAN-2-YR    PIC 99.
   517             20  DC-JULIAN-DA-2        PIC 999.
   518         16  DC-GREG-DATE-A-EDIT.
   519             20  DC-EDITA-MONTH        PIC 99.
   520             20  SLASHA-1              PIC X VALUE '/'.
   521             20  DC-EDITA-DAY          PIC 99.
   522             20  SLASHA-2              PIC X VALUE '/'.
   523             20  DC-EDITA-CCYY.
   524                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  13
* EL633.cbl
   525                 24  DC-EDITA-YEAR     PIC 99.
   526         16  DC-GREG-DATE-B-EDIT.
   527             20  DC-EDITB-MONTH        PIC 99.
   528             20  SLASHB-1              PIC X VALUE '/'.
   529             20  DC-EDITB-DAY          PIC 99.
   530             20  SLASHB-2              PIC X VALUE '/'.
   531             20  DC-EDITB-CCYY.
   532                 24  DC-EDITB-CENT     PIC 99.
   533                 24  DC-EDITB-YEAR     PIC 99.
   534         16  DC-GREG-DATE-CYMD         PIC 9(08).
   535         16  DC-GREG-DATE-CYMD-R REDEFINES
   536                              DC-GREG-DATE-CYMD.
   537             20  DC-CYMD-CEN           PIC 99.
   538             20  DC-CYMD-YEAR          PIC 99.
   539             20  DC-CYMD-MONTH         PIC 99.
   540             20  DC-CYMD-DAY           PIC 99.
   541         16  DC-GREG-DATE-MDCY         PIC 9(08).
   542         16  DC-GREG-DATE-MDCY-R REDEFINES
   543                              DC-GREG-DATE-MDCY.
   544             20  DC-MDCY-MONTH         PIC 99.
   545             20  DC-MDCY-DAY           PIC 99.
   546             20  DC-MDCY-CEN           PIC 99.
   547             20  DC-MDCY-YEAR          PIC 99.
   548    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   549        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   550    12  DC-EL310-DATE                  PIC X(21).
   551    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  14
* EL633.cbl
   553*                                    COPY ELCLOGOF.
   554******************************************************************
   555*                                                                *
   556*                                                                *
   557*                            ELCLOGOF.                           *
   558*                            VMOD=2.001                          *
   559*                                                                *
   560*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   561*                                                                *
   562******************************************************************
   563 01  CLASIC-LOGOFF.
   564     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   565     12  LOGOFF-TEXT.
   566         16  FILLER          PIC X(5)    VALUE SPACES.
   567         16  LOGOFF-MSG.
   568             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   569             20  FILLER      PIC X       VALUE SPACES.
   570             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   571         16  FILLER          PIC X(80)
   572           VALUE '* YOU ARE NOW LOGGED OFF'.
   573         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   574         16  FILLER          PIC X       VALUE QUOTE.
   575         16  LOGOFF-SYS-MSG  PIC X(17)
   576           VALUE 'S CLAS-IC SYSTEM '.
   577     12  TEXT-MESSAGES.
   578         16  UNACCESS-MSG    PIC X(29)
   579             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   580         16  PGMIDERR-MSG    PIC X(17)
   581             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  15
* EL633.cbl
   583*                                    COPY ELCATTR.
   584******************************************************************
   585*                                                                *
   586*                            ELCATTR.                            *
   587*                            VMOD=2.001                          *
   588*                                                                *
   589*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   590*                                                                *
   591*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   592*                                                                *
   593*                   POS 1   P=PROTECTED                          *
   594*                           U=UNPROTECTED                        *
   595*                           S=ASKIP                              *
   596*                   POS 2   A=ALPHA/NUMERIC                      *
   597*                           N=NUMERIC                            *
   598*                   POS 3   N=NORMAL                             *
   599*                           B=BRIGHT                             *
   600*                           D=DARK                               *
   601*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   602*                           OF=MODIFIED DATA TAG OFF             *
   603*                                                                *
   604*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   605******************************************************************
   606 01  ATTRIBUTE-LIST.
   607     12  AL-PABOF            PIC X       VALUE 'Y'.
   608     12  AL-PABON            PIC X       VALUE 'Z'.
   609     12  AL-PADOF            PIC X       VALUE '%'.
   610     12  AL-PADON            PIC X       VALUE '_'.
   611     12  AL-PANOF            PIC X       VALUE '-'.
   612     12  AL-PANON            PIC X       VALUE '/'.
   613     12  AL-SABOF            PIC X       VALUE '8'.
   614     12  AL-SABON            PIC X       VALUE '9'.
   615     12  AL-SADOF            PIC X       VALUE '@'.
   616     12  AL-SADON            PIC X       VALUE QUOTE.
   617     12  AL-SANOF            PIC X       VALUE '0'.
   618     12  AL-SANON            PIC X       VALUE '1'.
   619     12  AL-UABOF            PIC X       VALUE 'H'.
   620     12  AL-UABON            PIC X       VALUE 'I'.
   621     12  AL-UADOF            PIC X       VALUE '<'.
   622     12  AL-UADON            PIC X       VALUE '('.
   623     12  AL-UANOF            PIC X       VALUE ' '.
   624     12  AL-UANON            PIC X       VALUE 'A'.
   625     12  AL-UNBOF            PIC X       VALUE 'Q'.
   626     12  AL-UNBON            PIC X       VALUE 'R'.
   627     12  AL-UNDOF            PIC X       VALUE '*'.
   628     12  AL-UNDON            PIC X       VALUE ')'.
   629     12  AL-UNNOF            PIC X       VALUE '&'.
   630     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  16
* EL633.cbl
   632*                                    COPY ELCEMIB.
   633******************************************************************
   634*                                                                *
   635*                                                                *
   636*                            ELCEMIB.                            *
   637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   638*                            VMOD=2.005                          *
   639*                                                                *
   640*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   641*                                                                *
   642******************************************************************
   643 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   644     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   645     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   646     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   647     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   648     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   649     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   650     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   651     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   652     12  EMI-SWITCH1             PIC X        VALUE '1'.
   653         88  EMI-NO-ERRORS                    VALUE '1'.
   654         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   655         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   656     12  EMI-SWITCH2             PIC X        VALUE '1'.
   657         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   658     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   659         88  EMI-AREA1-EMPTY                  VALUE '1'.
   660         88  EMI-AREA1-FULL                   VALUE '2'.
   661     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   662         88  EMI-AREA2-EMPTY                  VALUE '1'.
   663         88  EMI-AREA2-FULL                   VALUE '2'.
   664     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   665         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   666         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   667         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   668         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   669         88  EMI-BYPASS-FATALS                VALUE 'X'.
   670     12  EMI-ERROR-LINES.
   671         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   672         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   673         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   674         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   675             20  EMI-ERR-CODES OCCURS 10 TIMES.
   676                 24  EMI-ERR-NUM         PIC X(4).
   677                 24  EMI-FILLER          PIC X.
   678                 24  EMI-SEV             PIC X.
   679                 24  FILLER              PIC X.
   680             20  FILLER                  PIC X(02).
   681     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   682         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   683             20  EMI-ERROR-NUMBER    PIC X(4).
   684             20  EMI-FILL            PIC X.
   685             20  EMI-SEVERITY        PIC X.
   686             20  FILLER              PIC X.
   687             20  EMI-ERROR-TEXT.
   688                 24  EMI-TEXT-VARIABLE   PIC X(10).
   689                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  17
* EL633.cbl
   690     12  EMI-SEVERITY-SAVE           PIC X.
   691         88  EMI-NOTE                    VALUE 'N'.
   692         88  EMI-WARNING                 VALUE 'W'.
   693         88  EMI-FORCABLE                VALUE 'F'.
   694         88  EMI-FATAL                   VALUE 'X'.
   695     12  EMI-MESSAGE-FLAG            PIC X.
   696         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   697         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   698     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   699     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   700         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   701         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   702         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   703     12  emi-claim-no                pic x(7).
   704     12  emi-claim-type              pic x(6).
   705     12  FILLER                      PIC X(124)  VALUE SPACES.
   706     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   707     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   708     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   709     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  18
* EL633.cbl
   711*                                    COPY ELCINTF.
   712******************************************************************
   713*                                                                *
   714*                                                                *
   715*                            ELCINTF.                            *
   716*                            VMOD=2.017                          *
   717*                                                                *
   718*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   719*                                                                *
   720*       LENGTH = 1024                                            *
   721*                                                                *
   722******************************************************************
   723*                   C H A N G E   L O G
   724*
   725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   726*-----------------------------------------------------------------
   727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   728* EFFECTIVE    NUMBER
   729*-----------------------------------------------------------------
   730* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   731******************************************************************
   732 01  PROGRAM-INTERFACE-BLOCK.
   733     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   734     12  PI-CALLING-PROGRAM              PIC X(8).
   735     12  PI-SAVED-PROGRAM-1              PIC X(8).
   736     12  PI-SAVED-PROGRAM-2              PIC X(8).
   737     12  PI-SAVED-PROGRAM-3              PIC X(8).
   738     12  PI-SAVED-PROGRAM-4              PIC X(8).
   739     12  PI-SAVED-PROGRAM-5              PIC X(8).
   740     12  PI-SAVED-PROGRAM-6              PIC X(8).
   741     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   742     12  PI-COMPANY-ID                   PIC XXX.
   743     12  PI-COMPANY-CD                   PIC X.
   744
   745     12  PI-COMPANY-PASSWORD             PIC X(8).
   746
   747     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   748
   749     12  PI-CONTROL-IN-PROGRESS.
   750         16  PI-CARRIER                  PIC X.
   751         16  PI-GROUPING                 PIC X(6).
   752         16  PI-STATE                    PIC XX.
   753         16  PI-ACCOUNT                  PIC X(10).
   754         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   755                                         PIC X(10).
   756         16  PI-CLAIM-CERT-GRP.
   757             20  PI-CLAIM-NO             PIC X(7).
   758             20  PI-CERT-NO.
   759                 25  PI-CERT-PRIME       PIC X(10).
   760                 25  PI-CERT-SFX         PIC X.
   761             20  PI-CERT-EFF-DT          PIC XX.
   762         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   763             20  PI-PLAN-CODE            PIC X(2).
   764             20  PI-REVISION-NUMBER      PIC X(3).
   765             20  PI-PLAN-EFF-DT          PIC X(2).
   766             20  PI-PLAN-EXP-DT          PIC X(2).
   767             20  FILLER                  PIC X(11).
   768         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  19
* EL633.cbl
   769             20  PI-OE-REFERENCE-1.
   770                 25  PI-OE-REF-1-PRIME   PIC X(18).
   771                 25  PI-OE-REF-1-SUFF    PIC XX.
   772
   773     12  PI-SESSION-IN-PROGRESS          PIC X.
   774         88  CLAIM-SESSION                   VALUE '1'.
   775         88  CREDIT-SESSION                  VALUE '2'.
   776         88  WARRANTY-SESSION                VALUE '3'.
   777         88  MORTGAGE-SESSION                VALUE '4'.
   778         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   779
   780
   781*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   782
   783     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   784     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   785
   786     12  PI-CREDIT-USER                  PIC X.
   787         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   788         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   789
   790     12  PI-CLAIM-USER                   PIC X.
   791         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   792         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   793
   794     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   795         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   796         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   797         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   798         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   799         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   800
   801     12  PI-PROCESSOR-ID                 PIC X(4).
   802
   803     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   804
   805     12  PI-MEMBER-CAPTION               PIC X(10).
   806
   807     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   808         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   809
   810     12  PI-LIFE-OVERRIDE-L1             PIC X.
   811     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   812     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   813     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   814
   815     12  PI-AH-OVERRIDE-L1               PIC X.
   816     12  PI-AH-OVERRIDE-L2               PIC XX.
   817     12  PI-AH-OVERRIDE-L6               PIC X(6).
   818     12  PI-AH-OVERRIDE-L12              PIC X(12).
   819
   820     12  PI-NEW-SYSTEM                   PIC X(2).
   821
   822     12  PI-PRIMARY-CERT-NO              PIC X(11).
   823     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   824         88  PI-USES-PAID-TO                 VALUE '1'.
   825     12  PI-CRDTCRD-SYSTEM.
   826         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  20
* EL633.cbl
   827             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   828             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   829         16  PI-CC-MONTH-END-DT          PIC XX.
   830     12  PI-PROCESSOR-PRINTER            PIC X(4).
   831
   832     12  PI-OE-REFERENCE-2.
   833         16  PI-OE-REF-2-PRIME           PIC X(10).
   834         16  PI-OE-REF-2-SUFF            PIC X.
   835
   836     12  PI-REM-TRM-CALC-OPTION          PIC X.
   837
   838     12  PI-LANGUAGE-TYPE                PIC X.
   839             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   840             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   841             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   842
   843     12  PI-POLICY-LINKAGE-IND           PIC X.
   844         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   845         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   846                                                   LOW-VALUES.
   847
   848     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   849     12  PI-CLAIM-PW-SESSION             PIC X(1).
   850         88  PI-CLAIM-CREDIT                 VALUE '1'.
   851         88  PI-CLAIM-CONVEN                 VALUE '2'.
   852
   853     12  PI-PROCESSOR-CSR-IND            PIC X.
   854         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   855         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   856
   857     12  FILLER                          PIC X(3).
   858
   859     12  PI-SYSTEM-LEVEL                 PIC X(145).
   860
   861     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   862         PI-SYSTEM-LEVEL.
   863
   864         16  PI-ENTRY-CODES.
   865             20  PI-ENTRY-CD-1           PIC X.
   866             20  PI-ENTRY-CD-2           PIC X.
   867
   868         16  PI-RETURN-CODES.
   869             20  PI-RETURN-CD-1          PIC X.
   870             20  PI-RETURN-CD-2          PIC X.
   871
   872         16  PI-UPDATE-STATUS-SAVE.
   873             20  PI-UPDATE-BY            PIC X(4).
   874             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   875
   876         16  PI-LOWER-CASE-LETTERS       PIC X.
   877             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   878
   879*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   880*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   881*            88  CARRIER-CLM-CNTL            VALUE '2'.
   882
   883         16  PI-CERT-ACCESS-CONTROL      PIC X.
   884             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  21
* EL633.cbl
   885             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   886             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   887             88  ACCNT-CNTL                  VALUE '3'.
   888             88  CARR-ACCNT-CNTL             VALUE '4'.
   889
   890         16  PI-PROCESSOR-CAP-LIST.
   891             20  PI-SYSTEM-CONTROLS.
   892                24 PI-SYSTEM-DISPLAY     PIC X.
   893                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   894                24 PI-SYSTEM-MODIFY      PIC X.
   895                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   896             20  FILLER                  PIC XX.
   897             20  PI-DISPLAY-CAP          PIC X.
   898                 88  DISPLAY-CAP             VALUE 'Y'.
   899             20  PI-MODIFY-CAP           PIC X.
   900                 88  MODIFY-CAP              VALUE 'Y'.
   901             20  PI-MSG-AT-LOGON-CAP     PIC X.
   902                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   903             20  PI-FORCE-CAP            PIC X.
   904                 88  FORCE-CAP               VALUE 'Y'.
   905
   906         16  PI-PROGRAM-CONTROLS.
   907             20  PI-PGM-PRINT-OPT        PIC X.
   908             20  PI-PGM-FORMAT-OPT       PIC X.
   909             20  PI-PGM-PROCESS-OPT      PIC X.
   910             20  PI-PGM-TOTALS-OPT       PIC X.
   911
   912         16  PI-HELP-INTERFACE.
   913             20  PI-LAST-ERROR-NO        PIC X(4).
   914             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   915
   916         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   917             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   918
   919         16  PI-CR-CONTROL-IN-PROGRESS.
   920             20  PI-CR-CARRIER           PIC X.
   921             20  PI-CR-GROUPING          PIC X(6).
   922             20  PI-CR-STATE             PIC XX.
   923             20  PI-CR-ACCOUNT           PIC X(10).
   924             20  PI-CR-FIN-RESP          PIC X(10).
   925             20  PI-CR-TYPE              PIC X.
   926
   927         16  PI-CR-BATCH-NUMBER          PIC X(6).
   928
   929         16  PI-CR-MONTH-END-DT          PIC XX.
   930
   931         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   932             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   933             88  PI-ZERO-CARRIER             VALUE '1'.
   934             88  PI-ZERO-GROUPING            VALUE '2'.
   935             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   936
   937         16  PI-CARRIER-SECURITY         PIC X.
   938             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   939
   940         16  PI-ACCOUNT-SECURITY         PIC X(10).
   941             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   942             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  22
* EL633.cbl
   943
   944         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   945             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   946                                         INDEXED BY PI-ACCESS-NDX
   947                                         PIC X.
   948
   949         16  PI-GA-BILLING-CONTROL       PIC X.
   950             88  PI-GA-BILLING               VALUE '1'.
   951
   952         16  PI-MAIL-PROCESSING          PIC X.
   953             88  PI-MAIL-YES                 VALUE 'Y'.
   954
   955         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   956
   957         16  PI-AR-SYSTEM.
   958             20  PI-AR-PROCESSING-CNTL   PIC X.
   959                 88  PI-AR-PROCESSING        VALUE 'Y'.
   960             20  PI-AR-SUMMARY-CODE      PIC X(6).
   961             20  PI-AR-MONTH-END-DT      PIC XX.
   962
   963         16  PI-MP-SYSTEM.
   964             20  PI-MORTGAGE-USER            PIC X.
   965                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   966                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   967             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   968                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   969                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   970                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   971                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   972                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   973             20  PI-MP-MONTH-END-DT          PIC XX.
   974             20  PI-MP-REFERENCE-NO.
   975                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   976                 24  PI-MP-REFERENCE-SFX     PIC XX.
   977
   978         16  PI-LABEL-CONTROL            PIC X(01).
   979             88  PI-CREATE-LABELS                    VALUE 'Y'.
   980             88  PI-BYPASS-LABELS                    VALUE 'N'.
   981
   982         16  PI-BILL-GROUPING-CODE       PIC X(01).
   983             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   984
   985         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   986             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   987             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   988
   989         16  FILLER                      PIC X(14).
   990
   991     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   992******************************************************************
   993     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   994         16  PI-PYAJ-FILE-SW             PIC  X.
   995             88  END-OF-ACCT                 VALUE 'A'.
   996             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   997             88  END-OF-FILE                 VALUE 'X'.
   998             88  TOP-OF-FILE                 VALUE 'T'.
   999             88  PAGE-FULL                   VALUE 'F'.
  1000             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  23
* EL633.cbl
  1001             88  NOT-OPEN                    VALUE 'Z'.
  1002         16  PI-PREV-FUNCTION            PIC  X.
  1003         16  PI-SAV-FUNCTION             PIC  X.
  1004         16  PI-PREV-PFKEY               PIC  X.
  1005         16  PI-SEQ-NOS.
  1006             20  FILLER  OCCURS 13 TIMES
  1007                             INDEXED BY NDX.
  1008                 24  PI-REC-TYPE         PIC  X.
  1009                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1010         16  PI-SAV-ENDING-PYAJ-KEY.
  1011             20  PI-SAV-COMP-CD          PIC  X.
  1012             20  PI-SAV-COMP-CONTROL.
  1013                 24  PI-SAV-CARRIER      PIC  X.
  1014                 24  PI-SAV-GROUPING     PIC  X(6).
  1015                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1016                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1017                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1018                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1019         16  PI-START-PYAJ-KEY           PIC  X(33).
  1020         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1021         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1022         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1023         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1024         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1025             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1026         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1027         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1028         16  PI-FRST-RECORD-TYPE         PIC  X.
  1029         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1030         16  PI-PREV-RECORD-TYPE         PIC  X.
  1031         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1032         16  PI-LAST-RECORD-TYPE         PIC  X.
  1033         16  PI-PAGE-SW                  PIC  X.
  1034             88  FIRST-PAGE                          VALUE 'Y'.
  1035         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  24
* EL633.cbl
  1037*                            COPY ELCJPFX.
  1038******************************************************************
  1039*                                                                *
  1040*                                                                *
  1041*                            ELCJPFX.                            *
  1042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1043*                            VMOD=2.002                          *
  1044*                                                                *
  1045*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1046*                                                                *
  1047*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1048*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1049*        ELCNTL - CONTROL FILE                                   *
  1050*        ELMSTR - CLAIM MASTERS                                  *
  1051*        ELTRLR - ACTIVITY TRAILERS                              *
  1052*        ELCHKQ - CHECK QUE                                      *
  1053******************************************************************
  1054 01  JOURNAL-RECORD.
  1055     12  jp-date                     pic s9(5) comp-3.
  1056     12  jp-time                     pic s9(7) comp-3.
  1057     12  JP-USER-ID                  PIC X(4).
  1058     12  JP-FILE-ID                  PIC X(8).
  1059     12  JP-PROGRAM-ID               PIC X(8).
  1060     12  JP-RECORD-TYPE              PIC X.
  1061         88 JP-ADD              VALUE 'A'.
  1062         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1063         88 JP-AFTER-CHANGE     VALUE 'C'.
  1064         88 JP-DELETE           VALUE 'D'.
  1065         88 JP-GENERIC-DELETE   VALUE 'G'.
  1066         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1067         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1068     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1069     12  JP-RECORD-AREA
  1070
  1071
  1072                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  25
* EL633.cbl
  1074*                            COPY ELCAID.
  1075******************************************************************
  1076*                                                                *
  1077*                            ELCAID.                             *
  1078*                            VMOD=2.001                          *
  1079*                                                                *
  1080*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1081*                                                                *
  1082*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1083*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1084******************************************************************
  1085
  1086 01  DFHAID.
  1087   02  DFHNULL   PIC  X  VALUE  ' '.
  1088   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1089   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1090   02  DFHPEN    PIC  X  VALUE  '='.
  1091   02  DFHOPID   PIC  X  VALUE  'W'.
  1092   02  DFHPA1    PIC  X  VALUE  '%'.
  1093   02  DFHPA2    PIC  X  VALUE  '>'.
  1094   02  DFHPA3    PIC  X  VALUE  ','.
  1095   02  DFHPF1    PIC  X  VALUE  '1'.
  1096   02  DFHPF2    PIC  X  VALUE  '2'.
  1097   02  DFHPF3    PIC  X  VALUE  '3'.
  1098   02  DFHPF4    PIC  X  VALUE  '4'.
  1099   02  DFHPF5    PIC  X  VALUE  '5'.
  1100   02  DFHPF6    PIC  X  VALUE  '6'.
  1101   02  DFHPF7    PIC  X  VALUE  '7'.
  1102   02  DFHPF8    PIC  X  VALUE  '8'.
  1103   02  DFHPF9    PIC  X  VALUE  '9'.
  1104   02  DFHPF10   PIC  X  VALUE  ':'.
  1105   02  DFHPF11   PIC  X  VALUE  '#'.
  1106   02  DFHPF12   PIC  X  VALUE  '@'.
  1107   02  DFHPF13   PIC  X  VALUE  'A'.
  1108   02  DFHPF14   PIC  X  VALUE  'B'.
  1109   02  DFHPF15   PIC  X  VALUE  'C'.
  1110   02  DFHPF16   PIC  X  VALUE  'D'.
  1111   02  DFHPF17   PIC  X  VALUE  'E'.
  1112   02  DFHPF18   PIC  X  VALUE  'F'.
  1113   02  DFHPF19   PIC  X  VALUE  'G'.
  1114   02  DFHPF20   PIC  X  VALUE  'H'.
  1115   02  DFHPF21   PIC  X  VALUE  'I'.
  1116*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1117   02  DFHPF22   PIC  X  VALUE  '['.
  1118   02  DFHPF23   PIC  X  VALUE  '.'.
  1119   02  DFHPF24   PIC  X  VALUE  '<'.
  1120   02  DFHMSRE   PIC  X  VALUE  'X'.
  1121   02  DFHSTRF   PIC  X  VALUE  'h'.
  1122   02  DFHTRIG   PIC  X  VALUE  '"'.
  1123
  1124 01  FILLER  REDEFINES  DFHAID.
  1125     12  FILLER              PIC  X(8).
  1126     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  26
* EL633.cbl
  1128*                            COPY EL633S.
  1129 01  EL633AI.
  1130     05  FILLER            PIC  X(0012).
  1131*    -------------------------------
  1132     05  DATEL PIC S9(0004) COMP.
  1133     05  DATEF PIC  X(0001).
  1134     05  FILLER REDEFINES DATEF.
  1135         10  DATEA PIC  X(0001).
  1136     05  DATEI PIC  X(0008).
  1137*    -------------------------------
  1138     05  TIMEL PIC S9(0004) COMP.
  1139     05  TIMEF PIC  X(0001).
  1140     05  FILLER REDEFINES TIMEF.
  1141         10  TIMEA PIC  X(0001).
  1142     05  TIMEI PIC  X(0005).
  1143*    -------------------------------
  1144     05  CMPNYIDL PIC S9(0004) COMP.
  1145     05  CMPNYIDF PIC  X(0001).
  1146     05  FILLER REDEFINES CMPNYIDF.
  1147         10  CMPNYIDA PIC  X(0001).
  1148     05  CMPNYIDI PIC  X(0003).
  1149*    -------------------------------
  1150     05  USERIDL PIC S9(0004) COMP.
  1151     05  USERIDF PIC  X(0001).
  1152     05  FILLER REDEFINES USERIDF.
  1153         10  USERIDA PIC  X(0001).
  1154     05  USERIDI PIC  X(0004).
  1155*    -------------------------------
  1156     05  MAINTL PIC S9(0004) COMP.
  1157     05  MAINTF PIC  X(0001).
  1158     05  FILLER REDEFINES MAINTF.
  1159         10  MAINTA PIC  X(0001).
  1160     05  MAINTI PIC  X(0001).
  1161*    -------------------------------
  1162     05  CARRIERL PIC S9(0004) COMP.
  1163     05  CARRIERF PIC  X(0001).
  1164     05  FILLER REDEFINES CARRIERF.
  1165         10  CARRIERA PIC  X(0001).
  1166     05  CARRIERI PIC  X(0001).
  1167*    -------------------------------
  1168     05  GROUPL PIC S9(0004) COMP.
  1169     05  GROUPF PIC  X(0001).
  1170     05  FILLER REDEFINES GROUPF.
  1171         10  GROUPA PIC  X(0001).
  1172     05  GROUPI PIC  X(0006).
  1173*    -------------------------------
  1174     05  FINRESPL PIC S9(0004) COMP.
  1175     05  FINRESPF PIC  X(0001).
  1176     05  FILLER REDEFINES FINRESPF.
  1177         10  FINRESPA PIC  X(0001).
  1178     05  FINRESPI PIC  X(0010).
  1179*    -------------------------------
  1180     05  ACCTL PIC S9(0004) COMP.
  1181     05  ACCTF PIC  X(0001).
  1182     05  FILLER REDEFINES ACCTF.
  1183         10  ACCTA PIC  X(0001).
  1184     05  ACCTI PIC  X(0010).
  1185*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  27
* EL633.cbl
  1186     05  MSAAC1L PIC S9(0004) COMP.
  1187     05  MSAAC1F PIC  X(0001).
  1188     05  FILLER REDEFINES MSAAC1F.
  1189         10  MSAAC1A PIC  X(0001).
  1190     05  MSAAC1I PIC  X(0010).
  1191*    -------------------------------
  1192     05  MSAST1L PIC S9(0004) COMP.
  1193     05  MSAST1F PIC  X(0001).
  1194     05  FILLER REDEFINES MSAST1F.
  1195         10  MSAST1A PIC  X(0001).
  1196     05  MSAST1I PIC  X(0002).
  1197*    -------------------------------
  1198     05  MSACN1L PIC S9(0004) COMP.
  1199     05  MSACN1F PIC  X(0001).
  1200     05  FILLER REDEFINES MSACN1F.
  1201         10  MSACN1A PIC  X(0001).
  1202     05  MSACN1I PIC  X(0001).
  1203*    -------------------------------
  1204     05  MSACM1L PIC S9(0004) COMP.
  1205     05  MSACM1F PIC  X(0001).
  1206     05  FILLER REDEFINES MSACM1F.
  1207         10  MSACM1A PIC  X(0001).
  1208     05  MSACM1I PIC  X(0010).
  1209*    -------------------------------
  1210     05  TYPE1L PIC S9(0004) COMP.
  1211     05  TYPE1F PIC  X(0001).
  1212     05  FILLER REDEFINES TYPE1F.
  1213         10  TYPE1A PIC  X(0001).
  1214     05  TYPE1I PIC  X(0001).
  1215*    -------------------------------
  1216     05  AMT1L PIC S9(0004) COMP.
  1217     05  AMT1F PIC  X(0001).
  1218     05  FILLER REDEFINES AMT1F.
  1219         10  AMT1A PIC  X(0001).
  1220     05  AMT1I PIC  X(0011).
  1221*    -------------------------------
  1222     05  VOID1L PIC S9(0004) COMP.
  1223     05  VOID1F PIC  X(0001).
  1224     05  FILLER REDEFINES VOID1F.
  1225         10  VOID1A PIC  X(0001).
  1226     05  VOID1I PIC  X(0001).
  1227*    -------------------------------
  1228     05  MDT1L PIC S9(0004) COMP.
  1229     05  MDT1F PIC  X(0001).
  1230     05  FILLER REDEFINES MDT1F.
  1231         10  MDT1A PIC  X(0001).
  1232     05  MDT1I PIC  X(0006).
  1233*    -------------------------------
  1234     05  BDT1L PIC S9(0004) COMP.
  1235     05  BDT1F PIC  X(0001).
  1236     05  FILLER REDEFINES BDT1F.
  1237         10  BDT1A PIC  X(0001).
  1238     05  BDT1I PIC  X(0006).
  1239*    -------------------------------
  1240     05  SDT1L PIC S9(0004) COMP.
  1241     05  SDT1F PIC  X(0001).
  1242     05  FILLER REDEFINES SDT1F.
  1243         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  28
* EL633.cbl
  1244     05  SDT1I PIC  X(0006).
  1245*    -------------------------------
  1246     05  MSAAC2L PIC S9(0004) COMP.
  1247     05  MSAAC2F PIC  X(0001).
  1248     05  FILLER REDEFINES MSAAC2F.
  1249         10  MSAAC2A PIC  X(0001).
  1250     05  MSAAC2I PIC  X(0010).
  1251*    -------------------------------
  1252     05  MSAST2L PIC S9(0004) COMP.
  1253     05  MSAST2F PIC  X(0001).
  1254     05  FILLER REDEFINES MSAST2F.
  1255         10  MSAST2A PIC  X(0001).
  1256     05  MSAST2I PIC  X(0002).
  1257*    -------------------------------
  1258     05  MSACN2L PIC S9(0004) COMP.
  1259     05  MSACN2F PIC  X(0001).
  1260     05  FILLER REDEFINES MSACN2F.
  1261         10  MSACN2A PIC  X(0001).
  1262     05  MSACN2I PIC  X(0001).
  1263*    -------------------------------
  1264     05  MSACM2L PIC S9(0004) COMP.
  1265     05  MSACM2F PIC  X(0001).
  1266     05  FILLER REDEFINES MSACM2F.
  1267         10  MSACM2A PIC  X(0001).
  1268     05  MSACM2I PIC  X(0010).
  1269*    -------------------------------
  1270     05  TYPE2L PIC S9(0004) COMP.
  1271     05  TYPE2F PIC  X(0001).
  1272     05  FILLER REDEFINES TYPE2F.
  1273         10  TYPE2A PIC  X(0001).
  1274     05  TYPE2I PIC  X(0001).
  1275*    -------------------------------
  1276     05  AMT2L PIC S9(0004) COMP.
  1277     05  AMT2F PIC  X(0001).
  1278     05  FILLER REDEFINES AMT2F.
  1279         10  AMT2A PIC  X(0001).
  1280     05  AMT2I PIC  X(0011).
  1281*    -------------------------------
  1282     05  VOID2L PIC S9(0004) COMP.
  1283     05  VOID2F PIC  X(0001).
  1284     05  FILLER REDEFINES VOID2F.
  1285         10  VOID2A PIC  X(0001).
  1286     05  VOID2I PIC  X(0001).
  1287*    -------------------------------
  1288     05  MDT2L PIC S9(0004) COMP.
  1289     05  MDT2F PIC  X(0001).
  1290     05  FILLER REDEFINES MDT2F.
  1291         10  MDT2A PIC  X(0001).
  1292     05  MDT2I PIC  X(0006).
  1293*    -------------------------------
  1294     05  BDT2L PIC S9(0004) COMP.
  1295     05  BDT2F PIC  X(0001).
  1296     05  FILLER REDEFINES BDT2F.
  1297         10  BDT2A PIC  X(0001).
  1298     05  BDT2I PIC  X(0006).
  1299*    -------------------------------
  1300     05  SDT2L PIC S9(0004) COMP.
  1301     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  29
* EL633.cbl
  1302     05  FILLER REDEFINES SDT2F.
  1303         10  SDT2A PIC  X(0001).
  1304     05  SDT2I PIC  X(0006).
  1305*    -------------------------------
  1306     05  MSAAC3L PIC S9(0004) COMP.
  1307     05  MSAAC3F PIC  X(0001).
  1308     05  FILLER REDEFINES MSAAC3F.
  1309         10  MSAAC3A PIC  X(0001).
  1310     05  MSAAC3I PIC  X(0010).
  1311*    -------------------------------
  1312     05  MSAST3L PIC S9(0004) COMP.
  1313     05  MSAST3F PIC  X(0001).
  1314     05  FILLER REDEFINES MSAST3F.
  1315         10  MSAST3A PIC  X(0001).
  1316     05  MSAST3I PIC  X(0002).
  1317*    -------------------------------
  1318     05  MSACN3L PIC S9(0004) COMP.
  1319     05  MSACN3F PIC  X(0001).
  1320     05  FILLER REDEFINES MSACN3F.
  1321         10  MSACN3A PIC  X(0001).
  1322     05  MSACN3I PIC  X(0001).
  1323*    -------------------------------
  1324     05  MSACM3L PIC S9(0004) COMP.
  1325     05  MSACM3F PIC  X(0001).
  1326     05  FILLER REDEFINES MSACM3F.
  1327         10  MSACM3A PIC  X(0001).
  1328     05  MSACM3I PIC  X(0010).
  1329*    -------------------------------
  1330     05  TYPE3L PIC S9(0004) COMP.
  1331     05  TYPE3F PIC  X(0001).
  1332     05  FILLER REDEFINES TYPE3F.
  1333         10  TYPE3A PIC  X(0001).
  1334     05  TYPE3I PIC  X(0001).
  1335*    -------------------------------
  1336     05  AMT3L PIC S9(0004) COMP.
  1337     05  AMT3F PIC  X(0001).
  1338     05  FILLER REDEFINES AMT3F.
  1339         10  AMT3A PIC  X(0001).
  1340     05  AMT3I PIC  X(0011).
  1341*    -------------------------------
  1342     05  VOID3L PIC S9(0004) COMP.
  1343     05  VOID3F PIC  X(0001).
  1344     05  FILLER REDEFINES VOID3F.
  1345         10  VOID3A PIC  X(0001).
  1346     05  VOID3I PIC  X(0001).
  1347*    -------------------------------
  1348     05  MDT3L PIC S9(0004) COMP.
  1349     05  MDT3F PIC  X(0001).
  1350     05  FILLER REDEFINES MDT3F.
  1351         10  MDT3A PIC  X(0001).
  1352     05  MDT3I PIC  X(0006).
  1353*    -------------------------------
  1354     05  BDT3L PIC S9(0004) COMP.
  1355     05  BDT3F PIC  X(0001).
  1356     05  FILLER REDEFINES BDT3F.
  1357         10  BDT3A PIC  X(0001).
  1358     05  BDT3I PIC  X(0006).
  1359*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  30
* EL633.cbl
  1360     05  SDT3L PIC S9(0004) COMP.
  1361     05  SDT3F PIC  X(0001).
  1362     05  FILLER REDEFINES SDT3F.
  1363         10  SDT3A PIC  X(0001).
  1364     05  SDT3I PIC  X(0006).
  1365*    -------------------------------
  1366     05  MSAAC4L PIC S9(0004) COMP.
  1367     05  MSAAC4F PIC  X(0001).
  1368     05  FILLER REDEFINES MSAAC4F.
  1369         10  MSAAC4A PIC  X(0001).
  1370     05  MSAAC4I PIC  X(0010).
  1371*    -------------------------------
  1372     05  MSAST4L PIC S9(0004) COMP.
  1373     05  MSAST4F PIC  X(0001).
  1374     05  FILLER REDEFINES MSAST4F.
  1375         10  MSAST4A PIC  X(0001).
  1376     05  MSAST4I PIC  X(0002).
  1377*    -------------------------------
  1378     05  MSACN4L PIC S9(0004) COMP.
  1379     05  MSACN4F PIC  X(0001).
  1380     05  FILLER REDEFINES MSACN4F.
  1381         10  MSACN4A PIC  X(0001).
  1382     05  MSACN4I PIC  X(0001).
  1383*    -------------------------------
  1384     05  MSACM4L PIC S9(0004) COMP.
  1385     05  MSACM4F PIC  X(0001).
  1386     05  FILLER REDEFINES MSACM4F.
  1387         10  MSACM4A PIC  X(0001).
  1388     05  MSACM4I PIC  X(0010).
  1389*    -------------------------------
  1390     05  TYPE4L PIC S9(0004) COMP.
  1391     05  TYPE4F PIC  X(0001).
  1392     05  FILLER REDEFINES TYPE4F.
  1393         10  TYPE4A PIC  X(0001).
  1394     05  TYPE4I PIC  X(0001).
  1395*    -------------------------------
  1396     05  AMT4L PIC S9(0004) COMP.
  1397     05  AMT4F PIC  X(0001).
  1398     05  FILLER REDEFINES AMT4F.
  1399         10  AMT4A PIC  X(0001).
  1400     05  AMT4I PIC  X(0011).
  1401*    -------------------------------
  1402     05  VOID4L PIC S9(0004) COMP.
  1403     05  VOID4F PIC  X(0001).
  1404     05  FILLER REDEFINES VOID4F.
  1405         10  VOID4A PIC  X(0001).
  1406     05  VOID4I PIC  X(0001).
  1407*    -------------------------------
  1408     05  MDT4L PIC S9(0004) COMP.
  1409     05  MDT4F PIC  X(0001).
  1410     05  FILLER REDEFINES MDT4F.
  1411         10  MDT4A PIC  X(0001).
  1412     05  MDT4I PIC  X(0006).
  1413*    -------------------------------
  1414     05  BDT4L PIC S9(0004) COMP.
  1415     05  BDT4F PIC  X(0001).
  1416     05  FILLER REDEFINES BDT4F.
  1417         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  31
* EL633.cbl
  1418     05  BDT4I PIC  X(0006).
  1419*    -------------------------------
  1420     05  SDT4L PIC S9(0004) COMP.
  1421     05  SDT4F PIC  X(0001).
  1422     05  FILLER REDEFINES SDT4F.
  1423         10  SDT4A PIC  X(0001).
  1424     05  SDT4I PIC  X(0006).
  1425*    -------------------------------
  1426     05  MSAAC5L PIC S9(0004) COMP.
  1427     05  MSAAC5F PIC  X(0001).
  1428     05  FILLER REDEFINES MSAAC5F.
  1429         10  MSAAC5A PIC  X(0001).
  1430     05  MSAAC5I PIC  X(0010).
  1431*    -------------------------------
  1432     05  MSAST5L PIC S9(0004) COMP.
  1433     05  MSAST5F PIC  X(0001).
  1434     05  FILLER REDEFINES MSAST5F.
  1435         10  MSAST5A PIC  X(0001).
  1436     05  MSAST5I PIC  X(0002).
  1437*    -------------------------------
  1438     05  MSACN5L PIC S9(0004) COMP.
  1439     05  MSACN5F PIC  X(0001).
  1440     05  FILLER REDEFINES MSACN5F.
  1441         10  MSACN5A PIC  X(0001).
  1442     05  MSACN5I PIC  X(0001).
  1443*    -------------------------------
  1444     05  MSACM5L PIC S9(0004) COMP.
  1445     05  MSACM5F PIC  X(0001).
  1446     05  FILLER REDEFINES MSACM5F.
  1447         10  MSACM5A PIC  X(0001).
  1448     05  MSACM5I PIC  X(0010).
  1449*    -------------------------------
  1450     05  TYPE5L PIC S9(0004) COMP.
  1451     05  TYPE5F PIC  X(0001).
  1452     05  FILLER REDEFINES TYPE5F.
  1453         10  TYPE5A PIC  X(0001).
  1454     05  TYPE5I PIC  X(0001).
  1455*    -------------------------------
  1456     05  AMT5L PIC S9(0004) COMP.
  1457     05  AMT5F PIC  X(0001).
  1458     05  FILLER REDEFINES AMT5F.
  1459         10  AMT5A PIC  X(0001).
  1460     05  AMT5I PIC  X(0011).
  1461*    -------------------------------
  1462     05  VOID5L PIC S9(0004) COMP.
  1463     05  VOID5F PIC  X(0001).
  1464     05  FILLER REDEFINES VOID5F.
  1465         10  VOID5A PIC  X(0001).
  1466     05  VOID5I PIC  X(0001).
  1467*    -------------------------------
  1468     05  MDT5L PIC S9(0004) COMP.
  1469     05  MDT5F PIC  X(0001).
  1470     05  FILLER REDEFINES MDT5F.
  1471         10  MDT5A PIC  X(0001).
  1472     05  MDT5I PIC  X(0006).
  1473*    -------------------------------
  1474     05  BDT5L PIC S9(0004) COMP.
  1475     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  32
* EL633.cbl
  1476     05  FILLER REDEFINES BDT5F.
  1477         10  BDT5A PIC  X(0001).
  1478     05  BDT5I PIC  X(0006).
  1479*    -------------------------------
  1480     05  SDT5L PIC S9(0004) COMP.
  1481     05  SDT5F PIC  X(0001).
  1482     05  FILLER REDEFINES SDT5F.
  1483         10  SDT5A PIC  X(0001).
  1484     05  SDT5I PIC  X(0006).
  1485*    -------------------------------
  1486     05  MSAAC6L PIC S9(0004) COMP.
  1487     05  MSAAC6F PIC  X(0001).
  1488     05  FILLER REDEFINES MSAAC6F.
  1489         10  MSAAC6A PIC  X(0001).
  1490     05  MSAAC6I PIC  X(0010).
  1491*    -------------------------------
  1492     05  MSAST6L PIC S9(0004) COMP.
  1493     05  MSAST6F PIC  X(0001).
  1494     05  FILLER REDEFINES MSAST6F.
  1495         10  MSAST6A PIC  X(0001).
  1496     05  MSAST6I PIC  X(0002).
  1497*    -------------------------------
  1498     05  MSACN6L PIC S9(0004) COMP.
  1499     05  MSACN6F PIC  X(0001).
  1500     05  FILLER REDEFINES MSACN6F.
  1501         10  MSACN6A PIC  X(0001).
  1502     05  MSACN6I PIC  X(0001).
  1503*    -------------------------------
  1504     05  MSACM6L PIC S9(0004) COMP.
  1505     05  MSACM6F PIC  X(0001).
  1506     05  FILLER REDEFINES MSACM6F.
  1507         10  MSACM6A PIC  X(0001).
  1508     05  MSACM6I PIC  X(0010).
  1509*    -------------------------------
  1510     05  TYPE6L PIC S9(0004) COMP.
  1511     05  TYPE6F PIC  X(0001).
  1512     05  FILLER REDEFINES TYPE6F.
  1513         10  TYPE6A PIC  X(0001).
  1514     05  TYPE6I PIC  X(0001).
  1515*    -------------------------------
  1516     05  AMT6L PIC S9(0004) COMP.
  1517     05  AMT6F PIC  X(0001).
  1518     05  FILLER REDEFINES AMT6F.
  1519         10  AMT6A PIC  X(0001).
  1520     05  AMT6I PIC  X(0011).
  1521*    -------------------------------
  1522     05  VOID6L PIC S9(0004) COMP.
  1523     05  VOID6F PIC  X(0001).
  1524     05  FILLER REDEFINES VOID6F.
  1525         10  VOID6A PIC  X(0001).
  1526     05  VOID6I PIC  X(0001).
  1527*    -------------------------------
  1528     05  MDT6L PIC S9(0004) COMP.
  1529     05  MDT6F PIC  X(0001).
  1530     05  FILLER REDEFINES MDT6F.
  1531         10  MDT6A PIC  X(0001).
  1532     05  MDT6I PIC  X(0006).
  1533*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  33
* EL633.cbl
  1534     05  BDT6L PIC S9(0004) COMP.
  1535     05  BDT6F PIC  X(0001).
  1536     05  FILLER REDEFINES BDT6F.
  1537         10  BDT6A PIC  X(0001).
  1538     05  BDT6I PIC  X(0006).
  1539*    -------------------------------
  1540     05  SDT6L PIC S9(0004) COMP.
  1541     05  SDT6F PIC  X(0001).
  1542     05  FILLER REDEFINES SDT6F.
  1543         10  SDT6A PIC  X(0001).
  1544     05  SDT6I PIC  X(0006).
  1545*    -------------------------------
  1546     05  MSAAC7L PIC S9(0004) COMP.
  1547     05  MSAAC7F PIC  X(0001).
  1548     05  FILLER REDEFINES MSAAC7F.
  1549         10  MSAAC7A PIC  X(0001).
  1550     05  MSAAC7I PIC  X(0010).
  1551*    -------------------------------
  1552     05  MSAST7L PIC S9(0004) COMP.
  1553     05  MSAST7F PIC  X(0001).
  1554     05  FILLER REDEFINES MSAST7F.
  1555         10  MSAST7A PIC  X(0001).
  1556     05  MSAST7I PIC  X(0002).
  1557*    -------------------------------
  1558     05  MSACN7L PIC S9(0004) COMP.
  1559     05  MSACN7F PIC  X(0001).
  1560     05  FILLER REDEFINES MSACN7F.
  1561         10  MSACN7A PIC  X(0001).
  1562     05  MSACN7I PIC  X(0001).
  1563*    -------------------------------
  1564     05  MSACM7L PIC S9(0004) COMP.
  1565     05  MSACM7F PIC  X(0001).
  1566     05  FILLER REDEFINES MSACM7F.
  1567         10  MSACM7A PIC  X(0001).
  1568     05  MSACM7I PIC  X(0010).
  1569*    -------------------------------
  1570     05  TYPE7L PIC S9(0004) COMP.
  1571     05  TYPE7F PIC  X(0001).
  1572     05  FILLER REDEFINES TYPE7F.
  1573         10  TYPE7A PIC  X(0001).
  1574     05  TYPE7I PIC  X(0001).
  1575*    -------------------------------
  1576     05  AMT7L PIC S9(0004) COMP.
  1577     05  AMT7F PIC  X(0001).
  1578     05  FILLER REDEFINES AMT7F.
  1579         10  AMT7A PIC  X(0001).
  1580     05  AMT7I PIC  X(0011).
  1581*    -------------------------------
  1582     05  VOID7L PIC S9(0004) COMP.
  1583     05  VOID7F PIC  X(0001).
  1584     05  FILLER REDEFINES VOID7F.
  1585         10  VOID7A PIC  X(0001).
  1586     05  VOID7I PIC  X(0001).
  1587*    -------------------------------
  1588     05  MDT7L PIC S9(0004) COMP.
  1589     05  MDT7F PIC  X(0001).
  1590     05  FILLER REDEFINES MDT7F.
  1591         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  34
* EL633.cbl
  1592     05  MDT7I PIC  X(0006).
  1593*    -------------------------------
  1594     05  BDT7L PIC S9(0004) COMP.
  1595     05  BDT7F PIC  X(0001).
  1596     05  FILLER REDEFINES BDT7F.
  1597         10  BDT7A PIC  X(0001).
  1598     05  BDT7I PIC  X(0006).
  1599*    -------------------------------
  1600     05  SDT7L PIC S9(0004) COMP.
  1601     05  SDT7F PIC  X(0001).
  1602     05  FILLER REDEFINES SDT7F.
  1603         10  SDT7A PIC  X(0001).
  1604     05  SDT7I PIC  X(0006).
  1605*    -------------------------------
  1606     05  MSAAC8L PIC S9(0004) COMP.
  1607     05  MSAAC8F PIC  X(0001).
  1608     05  FILLER REDEFINES MSAAC8F.
  1609         10  MSAAC8A PIC  X(0001).
  1610     05  MSAAC8I PIC  X(0010).
  1611*    -------------------------------
  1612     05  MSAST8L PIC S9(0004) COMP.
  1613     05  MSAST8F PIC  X(0001).
  1614     05  FILLER REDEFINES MSAST8F.
  1615         10  MSAST8A PIC  X(0001).
  1616     05  MSAST8I PIC  X(0002).
  1617*    -------------------------------
  1618     05  MSACN8L PIC S9(0004) COMP.
  1619     05  MSACN8F PIC  X(0001).
  1620     05  FILLER REDEFINES MSACN8F.
  1621         10  MSACN8A PIC  X(0001).
  1622     05  MSACN8I PIC  X(0001).
  1623*    -------------------------------
  1624     05  MSACM8L PIC S9(0004) COMP.
  1625     05  MSACM8F PIC  X(0001).
  1626     05  FILLER REDEFINES MSACM8F.
  1627         10  MSACM8A PIC  X(0001).
  1628     05  MSACM8I PIC  X(0010).
  1629*    -------------------------------
  1630     05  TYPE8L PIC S9(0004) COMP.
  1631     05  TYPE8F PIC  X(0001).
  1632     05  FILLER REDEFINES TYPE8F.
  1633         10  TYPE8A PIC  X(0001).
  1634     05  TYPE8I PIC  X(0001).
  1635*    -------------------------------
  1636     05  AMT8L PIC S9(0004) COMP.
  1637     05  AMT8F PIC  X(0001).
  1638     05  FILLER REDEFINES AMT8F.
  1639         10  AMT8A PIC  X(0001).
  1640     05  AMT8I PIC  X(0011).
  1641*    -------------------------------
  1642     05  VOID8L PIC S9(0004) COMP.
  1643     05  VOID8F PIC  X(0001).
  1644     05  FILLER REDEFINES VOID8F.
  1645         10  VOID8A PIC  X(0001).
  1646     05  VOID8I PIC  X(0001).
  1647*    -------------------------------
  1648     05  MDT8L PIC S9(0004) COMP.
  1649     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  35
* EL633.cbl
  1650     05  FILLER REDEFINES MDT8F.
  1651         10  MDT8A PIC  X(0001).
  1652     05  MDT8I PIC  X(0006).
  1653*    -------------------------------
  1654     05  BDT8L PIC S9(0004) COMP.
  1655     05  BDT8F PIC  X(0001).
  1656     05  FILLER REDEFINES BDT8F.
  1657         10  BDT8A PIC  X(0001).
  1658     05  BDT8I PIC  X(0006).
  1659*    -------------------------------
  1660     05  SDT8L PIC S9(0004) COMP.
  1661     05  SDT8F PIC  X(0001).
  1662     05  FILLER REDEFINES SDT8F.
  1663         10  SDT8A PIC  X(0001).
  1664     05  SDT8I PIC  X(0006).
  1665*    -------------------------------
  1666     05  MSAAC9L PIC S9(0004) COMP.
  1667     05  MSAAC9F PIC  X(0001).
  1668     05  FILLER REDEFINES MSAAC9F.
  1669         10  MSAAC9A PIC  X(0001).
  1670     05  MSAAC9I PIC  X(0010).
  1671*    -------------------------------
  1672     05  MSAST9L PIC S9(0004) COMP.
  1673     05  MSAST9F PIC  X(0001).
  1674     05  FILLER REDEFINES MSAST9F.
  1675         10  MSAST9A PIC  X(0001).
  1676     05  MSAST9I PIC  X(0002).
  1677*    -------------------------------
  1678     05  MSACN9L PIC S9(0004) COMP.
  1679     05  MSACN9F PIC  X(0001).
  1680     05  FILLER REDEFINES MSACN9F.
  1681         10  MSACN9A PIC  X(0001).
  1682     05  MSACN9I PIC  X(0001).
  1683*    -------------------------------
  1684     05  MSACM9L PIC S9(0004) COMP.
  1685     05  MSACM9F PIC  X(0001).
  1686     05  FILLER REDEFINES MSACM9F.
  1687         10  MSACM9A PIC  X(0001).
  1688     05  MSACM9I PIC  X(0010).
  1689*    -------------------------------
  1690     05  TYPE9L PIC S9(0004) COMP.
  1691     05  TYPE9F PIC  X(0001).
  1692     05  FILLER REDEFINES TYPE9F.
  1693         10  TYPE9A PIC  X(0001).
  1694     05  TYPE9I PIC  X(0001).
  1695*    -------------------------------
  1696     05  AMT9L PIC S9(0004) COMP.
  1697     05  AMT9F PIC  X(0001).
  1698     05  FILLER REDEFINES AMT9F.
  1699         10  AMT9A PIC  X(0001).
  1700     05  AMT9I PIC  X(0011).
  1701*    -------------------------------
  1702     05  VOID9L PIC S9(0004) COMP.
  1703     05  VOID9F PIC  X(0001).
  1704     05  FILLER REDEFINES VOID9F.
  1705         10  VOID9A PIC  X(0001).
  1706     05  VOID9I PIC  X(0001).
  1707*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  36
* EL633.cbl
  1708     05  MDT9L PIC S9(0004) COMP.
  1709     05  MDT9F PIC  X(0001).
  1710     05  FILLER REDEFINES MDT9F.
  1711         10  MDT9A PIC  X(0001).
  1712     05  MDT9I PIC  X(0006).
  1713*    -------------------------------
  1714     05  BDT9L PIC S9(0004) COMP.
  1715     05  BDT9F PIC  X(0001).
  1716     05  FILLER REDEFINES BDT9F.
  1717         10  BDT9A PIC  X(0001).
  1718     05  BDT9I PIC  X(0006).
  1719*    -------------------------------
  1720     05  SDT9L PIC S9(0004) COMP.
  1721     05  SDT9F PIC  X(0001).
  1722     05  FILLER REDEFINES SDT9F.
  1723         10  SDT9A PIC  X(0001).
  1724     05  SDT9I PIC  X(0006).
  1725*    -------------------------------
  1726     05  MSAAC10L PIC S9(0004) COMP.
  1727     05  MSAAC10F PIC  X(0001).
  1728     05  FILLER REDEFINES MSAAC10F.
  1729         10  MSAAC10A PIC  X(0001).
  1730     05  MSAAC10I PIC  X(0010).
  1731*    -------------------------------
  1732     05  MSAST10L PIC S9(0004) COMP.
  1733     05  MSAST10F PIC  X(0001).
  1734     05  FILLER REDEFINES MSAST10F.
  1735         10  MSAST10A PIC  X(0001).
  1736     05  MSAST10I PIC  X(0002).
  1737*    -------------------------------
  1738     05  MSACN10L PIC S9(0004) COMP.
  1739     05  MSACN10F PIC  X(0001).
  1740     05  FILLER REDEFINES MSACN10F.
  1741         10  MSACN10A PIC  X(0001).
  1742     05  MSACN10I PIC  X(0001).
  1743*    -------------------------------
  1744     05  MSACM10L PIC S9(0004) COMP.
  1745     05  MSACM10F PIC  X(0001).
  1746     05  FILLER REDEFINES MSACM10F.
  1747         10  MSACM10A PIC  X(0001).
  1748     05  MSACM10I PIC  X(0010).
  1749*    -------------------------------
  1750     05  TYPE10L PIC S9(0004) COMP.
  1751     05  TYPE10F PIC  X(0001).
  1752     05  FILLER REDEFINES TYPE10F.
  1753         10  TYPE10A PIC  X(0001).
  1754     05  TYPE10I PIC  X(0001).
  1755*    -------------------------------
  1756     05  AMT10L PIC S9(0004) COMP.
  1757     05  AMT10F PIC  X(0001).
  1758     05  FILLER REDEFINES AMT10F.
  1759         10  AMT10A PIC  X(0001).
  1760     05  AMT10I PIC  X(0011).
  1761*    -------------------------------
  1762     05  VOID10L PIC S9(0004) COMP.
  1763     05  VOID10F PIC  X(0001).
  1764     05  FILLER REDEFINES VOID10F.
  1765         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  37
* EL633.cbl
  1766     05  VOID10I PIC  X(0001).
  1767*    -------------------------------
  1768     05  MDT10L PIC S9(0004) COMP.
  1769     05  MDT10F PIC  X(0001).
  1770     05  FILLER REDEFINES MDT10F.
  1771         10  MDT10A PIC  X(0001).
  1772     05  MDT10I PIC  X(0006).
  1773*    -------------------------------
  1774     05  BDT10L PIC S9(0004) COMP.
  1775     05  BDT10F PIC  X(0001).
  1776     05  FILLER REDEFINES BDT10F.
  1777         10  BDT10A PIC  X(0001).
  1778     05  BDT10I PIC  X(0006).
  1779*    -------------------------------
  1780     05  SDT10L PIC S9(0004) COMP.
  1781     05  SDT10F PIC  X(0001).
  1782     05  FILLER REDEFINES SDT10F.
  1783         10  SDT10A PIC  X(0001).
  1784     05  SDT10I PIC  X(0006).
  1785*    -------------------------------
  1786     05  MSAAC11L PIC S9(0004) COMP.
  1787     05  MSAAC11F PIC  X(0001).
  1788     05  FILLER REDEFINES MSAAC11F.
  1789         10  MSAAC11A PIC  X(0001).
  1790     05  MSAAC11I PIC  X(0010).
  1791*    -------------------------------
  1792     05  MSAST11L PIC S9(0004) COMP.
  1793     05  MSAST11F PIC  X(0001).
  1794     05  FILLER REDEFINES MSAST11F.
  1795         10  MSAST11A PIC  X(0001).
  1796     05  MSAST11I PIC  X(0002).
  1797*    -------------------------------
  1798     05  MSACN11L PIC S9(0004) COMP.
  1799     05  MSACN11F PIC  X(0001).
  1800     05  FILLER REDEFINES MSACN11F.
  1801         10  MSACN11A PIC  X(0001).
  1802     05  MSACN11I PIC  X(0001).
  1803*    -------------------------------
  1804     05  MSACM11L PIC S9(0004) COMP.
  1805     05  MSACM11F PIC  X(0001).
  1806     05  FILLER REDEFINES MSACM11F.
  1807         10  MSACM11A PIC  X(0001).
  1808     05  MSACM11I PIC  X(0010).
  1809*    -------------------------------
  1810     05  TYPE11L PIC S9(0004) COMP.
  1811     05  TYPE11F PIC  X(0001).
  1812     05  FILLER REDEFINES TYPE11F.
  1813         10  TYPE11A PIC  X(0001).
  1814     05  TYPE11I PIC  X(0001).
  1815*    -------------------------------
  1816     05  AMT11L PIC S9(0004) COMP.
  1817     05  AMT11F PIC  X(0001).
  1818     05  FILLER REDEFINES AMT11F.
  1819         10  AMT11A PIC  X(0001).
  1820     05  AMT11I PIC  X(0011).
  1821*    -------------------------------
  1822     05  VOID11L PIC S9(0004) COMP.
  1823     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  38
* EL633.cbl
  1824     05  FILLER REDEFINES VOID11F.
  1825         10  VOID11A PIC  X(0001).
  1826     05  VOID11I PIC  X(0001).
  1827*    -------------------------------
  1828     05  MDT11L PIC S9(0004) COMP.
  1829     05  MDT11F PIC  X(0001).
  1830     05  FILLER REDEFINES MDT11F.
  1831         10  MDT11A PIC  X(0001).
  1832     05  MDT11I PIC  X(0006).
  1833*    -------------------------------
  1834     05  BDT11L PIC S9(0004) COMP.
  1835     05  BDT11F PIC  X(0001).
  1836     05  FILLER REDEFINES BDT11F.
  1837         10  BDT11A PIC  X(0001).
  1838     05  BDT11I PIC  X(0006).
  1839*    -------------------------------
  1840     05  SDT11L PIC S9(0004) COMP.
  1841     05  SDT11F PIC  X(0001).
  1842     05  FILLER REDEFINES SDT11F.
  1843         10  SDT11A PIC  X(0001).
  1844     05  SDT11I PIC  X(0006).
  1845*    -------------------------------
  1846     05  MSAAC12L PIC S9(0004) COMP.
  1847     05  MSAAC12F PIC  X(0001).
  1848     05  FILLER REDEFINES MSAAC12F.
  1849         10  MSAAC12A PIC  X(0001).
  1850     05  MSAAC12I PIC  X(0010).
  1851*    -------------------------------
  1852     05  MSAST12L PIC S9(0004) COMP.
  1853     05  MSAST12F PIC  X(0001).
  1854     05  FILLER REDEFINES MSAST12F.
  1855         10  MSAST12A PIC  X(0001).
  1856     05  MSAST12I PIC  X(0002).
  1857*    -------------------------------
  1858     05  MSACN12L PIC S9(0004) COMP.
  1859     05  MSACN12F PIC  X(0001).
  1860     05  FILLER REDEFINES MSACN12F.
  1861         10  MSACN12A PIC  X(0001).
  1862     05  MSACN12I PIC  X(0001).
  1863*    -------------------------------
  1864     05  MSACM12L PIC S9(0004) COMP.
  1865     05  MSACM12F PIC  X(0001).
  1866     05  FILLER REDEFINES MSACM12F.
  1867         10  MSACM12A PIC  X(0001).
  1868     05  MSACM12I PIC  X(0010).
  1869*    -------------------------------
  1870     05  TYPE12L PIC S9(0004) COMP.
  1871     05  TYPE12F PIC  X(0001).
  1872     05  FILLER REDEFINES TYPE12F.
  1873         10  TYPE12A PIC  X(0001).
  1874     05  TYPE12I PIC  X(0001).
  1875*    -------------------------------
  1876     05  AMT12L PIC S9(0004) COMP.
  1877     05  AMT12F PIC  X(0001).
  1878     05  FILLER REDEFINES AMT12F.
  1879         10  AMT12A PIC  X(0001).
  1880     05  AMT12I PIC  X(0011).
  1881*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  39
* EL633.cbl
  1882     05  VOID12L PIC S9(0004) COMP.
  1883     05  VOID12F PIC  X(0001).
  1884     05  FILLER REDEFINES VOID12F.
  1885         10  VOID12A PIC  X(0001).
  1886     05  VOID12I PIC  X(0001).
  1887*    -------------------------------
  1888     05  MDT12L PIC S9(0004) COMP.
  1889     05  MDT12F PIC  X(0001).
  1890     05  FILLER REDEFINES MDT12F.
  1891         10  MDT12A PIC  X(0001).
  1892     05  MDT12I PIC  X(0006).
  1893*    -------------------------------
  1894     05  BDT12L PIC S9(0004) COMP.
  1895     05  BDT12F PIC  X(0001).
  1896     05  FILLER REDEFINES BDT12F.
  1897         10  BDT12A PIC  X(0001).
  1898     05  BDT12I PIC  X(0006).
  1899*    -------------------------------
  1900     05  SDT12L PIC S9(0004) COMP.
  1901     05  SDT12F PIC  X(0001).
  1902     05  FILLER REDEFINES SDT12F.
  1903         10  SDT12A PIC  X(0001).
  1904     05  SDT12I PIC  X(0006).
  1905*    -------------------------------
  1906     05  MSAAC13L PIC S9(0004) COMP.
  1907     05  MSAAC13F PIC  X(0001).
  1908     05  FILLER REDEFINES MSAAC13F.
  1909         10  MSAAC13A PIC  X(0001).
  1910     05  MSAAC13I PIC  X(0010).
  1911*    -------------------------------
  1912     05  MSAST13L PIC S9(0004) COMP.
  1913     05  MSAST13F PIC  X(0001).
  1914     05  FILLER REDEFINES MSAST13F.
  1915         10  MSAST13A PIC  X(0001).
  1916     05  MSAST13I PIC  X(0002).
  1917*    -------------------------------
  1918     05  MSACN13L PIC S9(0004) COMP.
  1919     05  MSACN13F PIC  X(0001).
  1920     05  FILLER REDEFINES MSACN13F.
  1921         10  MSACN13A PIC  X(0001).
  1922     05  MSACN13I PIC  X(0001).
  1923*    -------------------------------
  1924     05  MSACM13L PIC S9(0004) COMP.
  1925     05  MSACM13F PIC  X(0001).
  1926     05  FILLER REDEFINES MSACM13F.
  1927         10  MSACM13A PIC  X(0001).
  1928     05  MSACM13I PIC  X(0010).
  1929*    -------------------------------
  1930     05  TYPE13L PIC S9(0004) COMP.
  1931     05  TYPE13F PIC  X(0001).
  1932     05  FILLER REDEFINES TYPE13F.
  1933         10  TYPE13A PIC  X(0001).
  1934     05  TYPE13I PIC  X(0001).
  1935*    -------------------------------
  1936     05  AMT13L PIC S9(0004) COMP.
  1937     05  AMT13F PIC  X(0001).
  1938     05  FILLER REDEFINES AMT13F.
  1939         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  40
* EL633.cbl
  1940     05  AMT13I PIC  X(0011).
  1941*    -------------------------------
  1942     05  VOID13L PIC S9(0004) COMP.
  1943     05  VOID13F PIC  X(0001).
  1944     05  FILLER REDEFINES VOID13F.
  1945         10  VOID13A PIC  X(0001).
  1946     05  VOID13I PIC  X(0001).
  1947*    -------------------------------
  1948     05  MDT13L PIC S9(0004) COMP.
  1949     05  MDT13F PIC  X(0001).
  1950     05  FILLER REDEFINES MDT13F.
  1951         10  MDT13A PIC  X(0001).
  1952     05  MDT13I PIC  X(0006).
  1953*    -------------------------------
  1954     05  BDT13L PIC S9(0004) COMP.
  1955     05  BDT13F PIC  X(0001).
  1956     05  FILLER REDEFINES BDT13F.
  1957         10  BDT13A PIC  X(0001).
  1958     05  BDT13I PIC  X(0006).
  1959*    -------------------------------
  1960     05  SDT13L PIC S9(0004) COMP.
  1961     05  SDT13F PIC  X(0001).
  1962     05  FILLER REDEFINES SDT13F.
  1963         10  SDT13A PIC  X(0001).
  1964     05  SDT13I PIC  X(0006).
  1965*    -------------------------------
  1966     05  ERRMSG1L PIC S9(0004) COMP.
  1967     05  ERRMSG1F PIC  X(0001).
  1968     05  FILLER REDEFINES ERRMSG1F.
  1969         10  ERRMSG1A PIC  X(0001).
  1970     05  ERRMSG1I PIC  X(0079).
  1971*    -------------------------------
  1972     05  ERRMSG2L PIC S9(0004) COMP.
  1973     05  ERRMSG2F PIC  X(0001).
  1974     05  FILLER REDEFINES ERRMSG2F.
  1975         10  ERRMSG2A PIC  X(0001).
  1976     05  ERRMSG2I PIC  X(0079).
  1977*    -------------------------------
  1978     05  PFENTERL PIC S9(0004) COMP.
  1979     05  PFENTERF PIC  X(0001).
  1980     05  FILLER REDEFINES PFENTERF.
  1981         10  PFENTERA PIC  X(0001).
  1982     05  PFENTERI PIC  9(2).
  1983 01  EL633AO REDEFINES EL633AI.
  1984     05  FILLER            PIC  X(0012).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  DATEO PIC  X(0008).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  TIMEO PIC  99.99.
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  CMPNYIDO PIC  X(0003).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  USERIDO PIC  X(0004).
  1997*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  41
* EL633.cbl
  1998     05  FILLER            PIC  X(0003).
  1999     05  MAINTO PIC  X(0001).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  CARRIERO PIC  X(0001).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  GROUPO PIC  X(0006).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  FINRESPO PIC  X(0010).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  ACCTO PIC  X(0010).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  MSAAC1O PIC  X(0010).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  MSAST1O PIC  X(0002).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  MSACN1O PIC  X(0001).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  MSACM1O PIC  X(0010).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  TYPE1O PIC  X(0001).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  AMT1O PIC  X(0011).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  VOID1O PIC  X(0001).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  MDT1O PIC  X(0006).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  BDT1O PIC  X(0006).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  SDT1O PIC  X(0006).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  MSAAC2O PIC  X(0010).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  MSAST2O PIC  X(0002).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  MSACN2O PIC  X(0001).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  MSACM2O PIC  X(0010).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  42
* EL633.cbl
  2056     05  TYPE2O PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  AMT2O PIC  X(0011).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  VOID2O PIC  X(0001).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  MDT2O PIC  X(0006).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  BDT2O PIC  X(0006).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  SDT2O PIC  X(0006).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  MSAAC3O PIC  X(0010).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  MSAST3O PIC  X(0002).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  MSACN3O PIC  X(0001).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  MSACM3O PIC  X(0010).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  TYPE3O PIC  X(0001).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  AMT3O PIC  X(0011).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  VOID3O PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  MDT3O PIC  X(0006).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  BDT3O PIC  X(0006).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  SDT3O PIC  X(0006).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  MSAAC4O PIC  X(0010).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  MSAST4O PIC  X(0002).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  MSACN4O PIC  X(0001).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  43
* EL633.cbl
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  TYPE4O PIC  X(0001).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  AMT4O PIC  X(0011).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  VOID4O PIC  X(0001).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  MDT4O PIC  X(0006).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  BDT4O PIC  X(0006).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  SDT4O PIC  X(0006).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  MSAAC5O PIC  X(0010).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  MSAST5O PIC  X(0002).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  MSACN5O PIC  X(0001).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  MSACM5O PIC  X(0010).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  TYPE5O PIC  X(0001).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  AMT5O PIC  X(0011).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  VOID5O PIC  X(0001).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  MDT5O PIC  X(0006).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  BDT5O PIC  X(0006).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  SDT5O PIC  X(0006).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  MSAAC6O PIC  X(0010).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  MSAST6O PIC  X(0002).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  MSACN6O PIC  X(0001).
  2171*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  44
* EL633.cbl
  2172     05  FILLER            PIC  X(0003).
  2173     05  MSACM6O PIC  X(0010).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  TYPE6O PIC  X(0001).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  AMT6O PIC  X(0011).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  VOID6O PIC  X(0001).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  MDT6O PIC  X(0006).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  BDT6O PIC  X(0006).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  SDT6O PIC  X(0006).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  MSAAC7O PIC  X(0010).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  MSAST7O PIC  X(0002).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  MSACN7O PIC  X(0001).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  MSACM7O PIC  X(0010).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  TYPE7O PIC  X(0001).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  AMT7O PIC  X(0011).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  VOID7O PIC  X(0001).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  MDT7O PIC  X(0006).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  BDT7O PIC  X(0006).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  SDT7O PIC  X(0006).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  MSAAC8O PIC  X(0010).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  MSAST8O PIC  X(0002).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  45
* EL633.cbl
  2230     05  MSACN8O PIC  X(0001).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  MSACM8O PIC  X(0010).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  TYPE8O PIC  X(0001).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  AMT8O PIC  X(0011).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  VOID8O PIC  X(0001).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  MDT8O PIC  X(0006).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  BDT8O PIC  X(0006).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  SDT8O PIC  X(0006).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  MSAAC9O PIC  X(0010).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  MSAST9O PIC  X(0002).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  MSACN9O PIC  X(0001).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  MSACM9O PIC  X(0010).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  TYPE9O PIC  X(0001).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  AMT9O PIC  X(0011).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  VOID9O PIC  X(0001).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  MDT9O PIC  X(0006).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  BDT9O PIC  X(0006).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  SDT9O PIC  X(0006).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  MSAAC10O PIC  X(0010).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  46
* EL633.cbl
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  MSACN10O PIC  X(0001).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  MSACM10O PIC  X(0010).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  TYPE10O PIC  X(0001).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  AMT10O PIC  X(0011).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  VOID10O PIC  X(0001).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  MDT10O PIC  X(0006).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  BDT10O PIC  X(0006).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  SDT10O PIC  X(0006).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  MSAAC11O PIC  X(0010).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  MSAST11O PIC  X(0002).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  MSACN11O PIC  X(0001).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  MSACM11O PIC  X(0010).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  TYPE11O PIC  X(0001).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  AMT11O PIC  X(0011).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  VOID11O PIC  X(0001).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  MDT11O PIC  X(0006).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  BDT11O PIC  X(0006).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  SDT11O PIC  X(0006).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  MSAAC12O PIC  X(0010).
  2345*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  47
* EL633.cbl
  2346     05  FILLER            PIC  X(0003).
  2347     05  MSAST12O PIC  X(0002).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  MSACN12O PIC  X(0001).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  MSACM12O PIC  X(0010).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  TYPE12O PIC  X(0001).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  AMT12O PIC  X(0011).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  VOID12O PIC  X(0001).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  MDT12O PIC  X(0006).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  BDT12O PIC  X(0006).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  SDT12O PIC  X(0006).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  MSAAC13O PIC  X(0010).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  MSAST13O PIC  X(0002).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  MSACN13O PIC  X(0001).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  MSACM13O PIC  X(0010).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  TYPE13O PIC  X(0001).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  AMT13O PIC  X(0011).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  VOID13O PIC  X(0001).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  MDT13O PIC  X(0006).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  BDT13O PIC  X(0006).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  SDT13O PIC  X(0006).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  48
* EL633.cbl
  2404     05  ERRMSG1O PIC  X(0079).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  ERRMSG2O PIC  X(0079).
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  PFENTERO PIC  X(0002).
  2411*    -------------------------------
  2412
  2413 01  MAP-EL633A  REDEFINES  EL633AI.
  2414     12  FILLER                  PIC  X(87).
  2415     12  DATA-AREA       OCCURS 13 TIMES
  2416                             INDEXED BY PINDX.
  2417         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2418         16  GL-ACCT-ATTRB       PIC  X.
  2419         16  GL-ACCT             PIC  X(10).
  2420         16  WSL-COMM  REDEFINES GL-ACCT.
  2421             20  WSL-COMM-DTE.
  2422                 24  WSL-MO      PIC  X(2).
  2423                 24  WSL-DA      PIC  X(2).
  2424                 24  WSL-YR      PIC  X(2).
  2425             20  WSL-COMM-REST   PIC  X(4).
  2426         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2427         16  GL-STATE-ATTRB      PIC  X.
  2428         16  GL-STATE            PIC  X(02).
  2429         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2430         16  GL-CANC-ATTRB       PIC  X.
  2431         16  GL-CANC             PIC  X.
  2432         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2433         16  GL-COMM-ATTRB       PIC  X.
  2434         16  GL-COMM             PIC  X(10).
  2435         16  RTYPE-LEN           PIC S9(4)              COMP.
  2436         16  RTYPE-ATTRB         PIC  X.
  2437         16  RTYPE               PIC  X.
  2438         16  AMT-LEN             PIC S9(4)              COMP.
  2439         16  AMT-ATTRB           PIC  X.
  2440         16  AMT                 PIC S9(9)V9(2).
  2441         16  AMTO  REDEFINES
  2442             AMT                 PIC Z(7).9(2)-.
  2443         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2444         16  VOID-SW-ATTRB       PIC  X.
  2445         16  VOID-SW             PIC  X.
  2446         16  MDTE-LEN            PIC S9(4)              COMP.
  2447         16  MDTE-ATTRB          PIC  X.
  2448         16  MDTE                PIC  X(6).
  2449         16  BDTE-LEN            PIC S9(4)              COMP.
  2450         16  BDTE-ATTRB          PIC  X.
  2451         16  BDTE                PIC  X(6).
  2452         16  SDTE-LEN            PIC S9(4)              COMP.
  2453         16  SDTE-ATTRB          PIC  X.
  2454         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  49
* EL633.cbl
  2456****************************************************************
  2457*
  2458* Copyright (c) 2007 by Clerity Solutions, Inc.
  2459* All rights reserved.
  2460*
  2461****************************************************************
  2462 01  DFHEIV.
  2463   02  DFHEIV0               PIC X(35).
  2464   02  DFHEIV1               PIC X(08).
  2465   02  DFHEIV2               PIC X(08).
  2466   02  DFHEIV3               PIC X(08).
  2467   02  DFHEIV4               PIC X(06).
  2468   02  DFHEIV5               PIC X(04).
  2469   02  DFHEIV6               PIC X(04).
  2470   02  DFHEIV7               PIC X(02).
  2471   02  DFHEIV8               PIC X(02).
  2472   02  DFHEIV9               PIC X(01).
  2473   02  DFHEIV10              PIC S9(7) COMP-3.
  2474   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2475   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2476   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2477   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2478   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2479   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2480   02  DFHEIV17              PIC X(04).
  2481   02  DFHEIV18              PIC X(04).
  2482   02  DFHEIV19              PIC X(04).
  2483   02  DFHEIV20              USAGE IS POINTER.
  2484   02  DFHEIV21              USAGE IS POINTER.
  2485   02  DFHEIV22              USAGE IS POINTER.
  2486   02  DFHEIV23              USAGE IS POINTER.
  2487   02  DFHEIV24              USAGE IS POINTER.
  2488   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2489   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2490   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2491   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2492   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2493   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2494   02  FILLER                PIC X(02).
  2495   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2496   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2497   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2498   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2499   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2500 LINKAGE  SECTION.
  2501*****************************************************************
  2502*                                                               *
  2503* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2504* All rights reserved.                                          *
  2505*                                                               *
  2506*****************************************************************
  2507 01  dfheiblk.
  2508     02  eibtime          pic s9(7) comp-3.
  2509     02  eibdate          pic s9(7) comp-3.
  2510     02  eibtrnid         pic x(4).
  2511     02  eibtaskn         pic s9(7) comp-3.
  2512     02  eibtrmid         pic x(4).
  2513     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  50
* EL633.cbl
  2514     02  eibcposn         pic s9(4) comp.
  2515     02  eibcalen         pic s9(4) comp.
  2516     02  eibaid           pic x(1).
  2517     02  eibfiller1       pic x(1).
  2518     02  eibfn            pic x(2).
  2519     02  eibfiller2       pic x(2).
  2520     02  eibrcode         pic x(6).
  2521     02  eibfiller3       pic x(2).
  2522     02  eibds            pic x(8).
  2523     02  eibreqid         pic x(8).
  2524     02  eibrsrce         pic x(8).
  2525     02  eibsync          pic x(1).
  2526     02  eibfree          pic x(1).
  2527     02  eibrecv          pic x(1).
  2528     02  eibsend          pic x(1).
  2529     02  eibatt           pic x(1).
  2530     02  eibeoc           pic x(1).
  2531     02  eibfmh           pic x(1).
  2532     02  eibcompl         pic x(1).
  2533     02  eibsig           pic x(1).
  2534     02  eibconf          pic x(1).
  2535     02  eiberr           pic x(1).
  2536     02  eibrldbk         pic x(1).
  2537     02  eiberrcd         pic x(4).
  2538     02  eibsynrb         pic x(1).
  2539     02  eibnodat         pic x(1).
  2540     02  eibfiller5       pic x(2).
  2541     02  eibresp          pic 9(09) comp.
  2542     02  eibresp2         pic 9(09) comp.
  2543     02  dfheigdj         pic s9(4) comp.
  2544     02  dfheigdk         pic s9(4) comp.
  2545 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  51
* EL633.cbl
  2546/
  2547*                            COPY ERCCHKQ.
  2548******************************************************************
  2549*                                                                *
  2550*                                                                *
  2551*                            ERCCHKQ                             *
  2552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2553*                            VMOD=2.005                          *
  2554*                                                                *
  2555*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2556*                                                                *
  2557*   FILE TYPE = VSAM,KSDS                                        *
  2558*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2559*                                                                *
  2560*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2561*       ALTERNATE PATH  = NONE                                   *
  2562*                                                                *
  2563*   LOG = YES                                                    *
  2564*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2565******************************************************************
  2566 01  CHECK-QUE.
  2567     12  CQ-RECORD-ID                PIC XX.
  2568         88  VALID-CQ-ID                     VALUE 'CQ'.
  2569
  2570     12  CQ-CONTROL-PRIMARY.
  2571         16  CQ-COMPANY-CD           PIC X.
  2572         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2573         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2574
  2575     12  CQ-ENTRY-TYPE               PIC X.
  2576             88  CHECK-ON-QUE           VALUE 'Q'.
  2577             88  ALIGNMENT-CHECK        VALUE 'A'.
  2578             88  MANUAL-CHECK           VALUE 'M'.
  2579             88  SPOILED-CHECK          VALUE 'S'.
  2580             88  VOIDED-CHECK           VALUE 'V'.
  2581             88  PAYMENT-ABORTED        VALUE 'X'.
  2582
  2583     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2584
  2585     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2586         CQ-CREDIT-MASTER-CNTL.
  2587         16  CQ-PYAJ-CARRIER         PIC X.
  2588         16  CQ-PYAJ-GROUPING        PIC X(6).
  2589         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2590         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2591         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2592         16  CQ-PYAJ-REC-TYPE        PIC X.
  2593         16  FILLER                  PIC X(18).
  2594
  2595     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2596         CQ-CREDIT-MASTER-CNTL.
  2597         16  CQ-CHEK-CARRIER         PIC X.
  2598         16  CQ-CHEK-GROUPING        PIC X(6).
  2599         16  CQ-CHEK-STATE           PIC XX.
  2600         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2601         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2602         16  CQ-CHEK-CERT-NO.
  2603             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  52
* EL633.cbl
  2604             20  CQ-CHEK-CERT-SFX    PIC X.
  2605         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2606         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2607         16  FILLER                  PIC X(06).
  2608
  2609     12  CQ-CHECK-NUMBER             PIC X(7).
  2610     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2611     12  CQ-PAYMENT-TYPE             PIC X.
  2612             88  CQ-BILLING-CREDIT         VALUE '1'.
  2613             88  CQ-REFUND-PMT             VALUE '2'.
  2614             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2615     12  CQ-VOID-INDICATOR           PIC X.
  2616             88  CHECK-IS-VOID             VALUE 'V'.
  2617     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2618     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2619     12  CQ-CHECK-BY-USER            PIC X(4).
  2620     12  CQ-PRE-NUMBERING-SW         PIC X.
  2621       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2622       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2623
  2624     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2625     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2626     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2627     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2628
  2629     12  CQ-LETTERS-IND              PIC X.
  2630         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2631
  2632******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  53
* EL633.cbl
  2633/
  2634*                            COPY ERCPYAJ.
  2635******************************************************************
  2636*                                                                *
  2637*                            ERCPYAJ                             *
  2638*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2639*                            VMOD=2.015                          *
  2640*                                                                *
  2641*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2642*                                                                *
  2643*                                                                *
  2644*   FILE TYPE = VSAM,KSDS                                        *
  2645*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2646*                                                                *
  2647*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2648*       ALTERNATE PATHS = NONE                                   *
  2649*                                                                *
  2650*   LOG = YES                                                    *
  2651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2652******************************************************************
  2653******************************************************************
  2654*                   C H A N G E   L O G
  2655*
  2656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2657*-----------------------------------------------------------------
  2658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2659* EFFECTIVE    NUMBER
  2660*-----------------------------------------------------------------
  2661* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2662* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2663******************************************************************
  2664
  2665 01  PENDING-PAY-ADJ.
  2666     12  PY-RECORD-ID                     PIC XX.
  2667         88  VALID-PY-ID                        VALUE 'PY'.
  2668
  2669     12  PY-CONTROL-PRIMARY.
  2670         16  PY-COMPANY-CD                PIC X.
  2671         16  PY-CARRIER                   PIC X.
  2672         16  PY-GROUPING                  PIC X(6).
  2673         16  PY-FIN-RESP                  PIC X(10).
  2674         16  PY-ACCOUNT                   PIC X(10).
  2675         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2676                                          PIC X(10).
  2677         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2678         16  PY-RECORD-TYPE               PIC X.
  2679             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2680             88  PY-DEPOSIT                   VALUE 'D'.
  2681             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2682             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2683             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2684             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2685             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2686             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2687             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2688             88  PY-FICA-ENTRY                VALUE 'F'.
  2689             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2690             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  54
* EL633.cbl
  2691             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2692
  2693     12  PY-PYMT-TYPE                     PIC X.
  2694             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2695             88  PY-REINS-PYMT                VALUE 'R'.
  2696             88  PY-EXP-PYMT                  VALUE 'E'.
  2697
  2698     12  PY-BIL-INV                       PIC X(6).
  2699     12  PY-REF-NO                        PIC X(12).
  2700
  2701     12  PY-LAST-MAINT-DT                 PIC XX.
  2702     12  PY-LAST-MAINT-BY                 PIC X(4).
  2703     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2704
  2705     12  PY-PYADJ-RECORD.
  2706         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2707         16  PY-ENTRY-COMMENT             PIC X(30).
  2708         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2709             20  PY-GL-ACCOUNT            PIC X(10).
  2710             20  PY-GL-STATE              PIC X(02).
  2711             20  PY-GL-CANC-SW            PIC X(01).
  2712                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2713                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2714             20  PY-GL-COMMENT            PIC X(10).
  2715             20  FILLER      REDEFINES PY-GL-COMMENT.
  2716                 24  PY-GL-CHECK-NO       PIC 9(06).
  2717                 24  FILLER               PIC X(04).
  2718             20  FILLER                   PIC X(07).
  2719         16  PY-SAVE-ACCOUNT              PIC X(10).
  2720         16  PY-SAVE-TYPE                 PIC X(01).
  2721
  2722         16  PY-LETTERS.
  2723             20  PY-LETTER OCCURS 3 TIMES
  2724                           INDEXED BY PY-LET-NDX
  2725                                          PIC X(04).
  2726
  2727         16  PY-ERCOMP-TYPE               PIC X.
  2728             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2729             88  PY-GA-TYPE                   VALUE 'G'.
  2730             88  PY-BANK-TYPE                 VALUE 'B'.
  2731         16  FILLER                       PIC X(05).
  2732
  2733     12  PY-RECORD-STATUS.
  2734         16  PY-CREDIT-SELECT-DT          PIC XX.
  2735         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2736         16  PY-BILLED-DATE               PIC XX.
  2737         16  PY-REPORTED-DT               PIC XX.
  2738         16  PY-PMT-APPLIED               PIC X.
  2739             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2740             88  PY-GA-PMT                    VALUE 'G'.
  2741             88  PY-OVWRITE-PMT               VALUE 'O'.
  2742             88  PY-NON-AR-PMT                VALUE 'N'.
  2743         16  FILLER                       PIC X(5).
  2744         16  PY-INPUT-DT                  PIC XX.
  2745         16  PY-CHECK-NUMBER              PIC X(6).
  2746         16  PY-VOID-SW                   PIC X.
  2747             88  PY-CHECK-VOIDED              VALUE 'V'.
  2748         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  55
* EL633.cbl
  2749             88  PY-BILLING-CHECK             VALUE 'B'.
  2750             88  PY-REFUND-CHECK              VALUE 'R'.
  2751             88  PY-GA-CHECK                  VALUE 'G'.
  2752             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2753             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2754         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2755         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2756         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2757         16  PY-BILL-FLAG                 PIC X.
  2758             88  PY-BILLED                    VALUE 'B'.
  2759         16  PY-AR-FLAG                   PIC X.
  2760             88  PY-AR-CYCLE                  VALUE 'C'.
  2761             88  PY-AR-MONTH-END              VALUE 'M'.
  2762         16  PY-AR-DATE                   PIC XX.
  2763
  2764     12  PY-GL-CODES.
  2765         16  PY-GL-DB                     PIC X(14).
  2766         16  PY-GL-CR                     PIC X(14).
  2767         16  PY-GL-FLAG                   PIC X.
  2768         16  PY-GL-DATE                   PIC XX.
  2769
  2770     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2771     12  FILLER                           PIC X(3).
  2772******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  56
* EL633.cbl
  2773/
  2774*                            COPY ERCCOMP.
  2775******************************************************************
  2776*                                                                *
  2777*                                                                *
  2778*                            ERCCOMP                             *
  2779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2780*                            VMOD=2.019                          *
  2781*                                                                *
  2782*   ONLINE CREDIT SYSTEM                                         *
  2783*                                                                *
  2784*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2785*                                                                *
  2786*   FILE TYPE = VSAM,KSDS                                        *
  2787*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2788*                                                                *
  2789*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2790*       ALTERNATE PATH = NONE                                    *
  2791*                                                                *
  2792*   LOG = NO                                                     *
  2793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2794*                                                                *
  2795******************************************************************
  2796*                   C H A N G E   L O G
  2797*
  2798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2799*-----------------------------------------------------------------
  2800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2801* EFFECTIVE    NUMBER
  2802*-----------------------------------------------------------------
  2803* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2804* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2805* 092205    2005050300006  PEMA  ADD LEASE FEE
  2806* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2807* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2808* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2809* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2810* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2811* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2812******************************************************************
  2813
  2814 01  COMPENSATION-MASTER.
  2815     12  CO-RECORD-ID                          PIC XX.
  2816         88  VALID-CO-ID                          VALUE 'CO'.
  2817
  2818     12  CO-CONTROL-PRIMARY.
  2819         16  CO-COMPANY-CD                     PIC X.
  2820         16  CO-CONTROL.
  2821             20  CO-CTL-1.
  2822                 24  CO-CARR-GROUP.
  2823                     28  CO-CARRIER            PIC X.
  2824                     28  CO-GROUPING.
  2825                         32  CO-GROUP-PREFIX   PIC XXX.
  2826                         32  CO-GROUP-PRIME    PIC XXX.
  2827                 24  CO-RESP-NO.
  2828                     28  CO-RESP-PREFIX        PIC X(4).
  2829                     28  CO-RESP-PRIME         PIC X(6).
  2830             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  57
* EL633.cbl
  2831                 24  CO-ACCOUNT.
  2832                     28  CO-ACCT-PREFIX        PIC X(4).
  2833                     28  CO-ACCT-PRIME         PIC X(6).
  2834         16  CO-TYPE                           PIC X.
  2835             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2836             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2837             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2838
  2839     12  CO-MAINT-INFORMATION.
  2840         16  CO-LAST-MAINT-DT                  PIC XX.
  2841         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2842         16  CO-LAST-MAINT-USER                PIC X(4).
  2843     12  FILLER                                PIC XX.
  2844     12  CO-STMT-TYPE                          PIC XXX.
  2845     12  CO-COMP-TYPE                          PIC X.
  2846         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2847     12  CO-STMT-OWNER                         PIC X(4).
  2848     12  CO-BALANCE-CONTROL                    PIC X.
  2849         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2850         88  CO-NO-BALANCE                        VALUE 'N'.
  2851
  2852     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2853         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2854         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2855         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2856
  2857     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2858         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2859         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2860
  2861     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2862     12  CO-GA-DIRECT-DEP                      PIC X.
  2863     12  CO-FUTURE-SPACE                       PIC X.
  2864         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2865
  2866     12  CO-ACCT-NAME                          PIC X(30).
  2867     12  CO-MAIL-NAME                          PIC X(30).
  2868     12  CO-ADDR-1                             PIC X(30).
  2869     12  CO-ADDR-2                             PIC X(30).
  2870     12  CO-ADDR-3.
  2871         16  CO-ADDR-CITY                      PIC X(27).
  2872         16  CO-ADDR-STATE                     PIC XX.
  2873     12  CO-CSO-1099                           PIC X.
  2874     12  CO-ZIP.
  2875         16  CO-ZIP-PRIME.
  2876             20  CO-ZIP-PRI-1ST                PIC X.
  2877                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2878             20  FILLER                        PIC X(4).
  2879         16  CO-ZIP-PLUS4                      PIC X(4).
  2880     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2881         16  CO-CAN-POSTAL-1                   PIC XXX.
  2882         16  CO-CAN-POSTAL-2                   PIC XXX.
  2883         16  FILLER                            PIC XXX.
  2884     12  CO-SOC-SEC                            PIC X(13).
  2885     12  CO-TELEPHONE.
  2886         16  CO-AREA-CODE                      PIC XXX.
  2887         16  CO-PREFIX                         PIC XXX.
  2888         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  58
* EL633.cbl
  2889
  2890     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2891
  2892     12  CO-AR-BAL-LEVEL                       PIC X.
  2893         88  CO-AR-REF-LVL                        VALUE '1'.
  2894         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2895         88  CO-AR-BILL-LVL                       VALUE '2'.
  2896         88  CO-AR-AGT-LVL                        VALUE '3'.
  2897         88  CO-AR-FR-LVL                         VALUE '4'.
  2898
  2899     12  CO-AR-NORMAL-PRINT                    PIC X.
  2900         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2901         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2902
  2903     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2904
  2905     12  CO-AR-REPORTING                       PIC X.
  2906         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2907         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2908
  2909     12  CO-AR-PULL-CHECK                      PIC X.
  2910         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2911         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2912
  2913     12  CO-AR-BALANCE-PRINT                   PIC X.
  2914         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2915
  2916     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2917         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2918         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2919         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2920
  2921     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2922
  2923     12  CO-USER-CODE                          PIC X.
  2924     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2925
  2926******************************************************************
  2927*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2928*    THE LAST MONTH END RUN.
  2929******************************************************************
  2930
  2931     12  CO-LAST-ACTIVITY-DATE.
  2932         16  CO-ACT-YEAR                       PIC 99.
  2933         16  CO-ACT-MONTH                      PIC 99.
  2934         16  CO-ACT-DAY                        PIC 99.
  2935
  2936     12  CO-LAST-STMT-DT.
  2937         16  CO-LAST-STMT-YEAR                 PIC 99.
  2938         16  CO-LAST-STMT-MONTH                PIC 99.
  2939         16  CO-LAST-STMT-DAY                  PIC 99.
  2940
  2941     12  CO-MO-END-TOTALS.
  2942         16  CO-MONTHLY-TOTALS.
  2943             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2944             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2945             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2946             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  59
* EL633.cbl
  2947             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2948
  2949         16  CO-AGING-TOTALS.
  2950             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2951             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2952             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2953             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2954
  2955         16  CO-YTD-TOTALS.
  2956             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2957             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2958
  2959         16  CO-OVER-UNDER-TOTALS.
  2960             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2961             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2962
  2963     12  CO-MISCELLANEOUS-TOTALS.
  2964         16  CO-FICA-TOTALS.
  2965             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2966             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2967
  2968         16  CO-CLAIM-TOTALS.
  2969             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2970             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2971
  2972******************************************************************
  2973*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2974*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2975******************************************************************
  2976
  2977     12  CO-CURRENT-TOTALS.
  2978         16  CO-CURRENT-LAST-STMT-DT.
  2979             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2980             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2981             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2982
  2983         16  CO-CURRENT-MONTHLY-TOTALS.
  2984             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2985             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2986             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2987             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2988             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2989
  2990         16  CO-CURRENT-AGING-TOTALS.
  2991             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2992             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2993             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2994             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2995
  2996         16  CO-CURRENT-YTD-TOTALS.
  2997             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2998             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2999
  3000     12  CO-PAID-COMM-TOTALS.
  3001         16  CO-YTD-PAID-COMMS.
  3002             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3003             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3004
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  60
* EL633.cbl
  3005     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3006         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3007         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3008
  3009     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3010         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3011         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3012         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3013         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3014         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3015         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3016         88  CO-FINAL-LETTER                  VALUE 'F'.
  3017         88  CO-RECONCILING                   VALUE 'R'.
  3018         88  CO-PHONE-CALL                    VALUE 'P'.
  3019         88  CO-LEGAL                         VALUE 'L'.
  3020         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3021         88  CO-WRITE-OFF                     VALUE 'W'.
  3022         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3023
  3024     12  CO-CSR-CODE                       PIC X(4).
  3025
  3026     12  CO-GA-STATUS-INFO.
  3027         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3028         16  CO-GA-TERMINATION-DT          PIC XX.
  3029         16  CO-GA-STATUS-CODE             PIC X.
  3030             88  CO-GA-ACTIVE                 VALUE 'A'.
  3031             88  CO-GA-INACTIVE               VALUE 'I'.
  3032             88  CO-GA-PENDING                VALUE 'P'.
  3033         16  CO-GA-COMMENTS.
  3034             20  CO-GA-COMMENT-1           PIC X(40).
  3035             20  CO-GA-COMMENT-2           PIC X(40).
  3036             20  CO-GA-COMMENT-3           PIC X(40).
  3037             20  CO-GA-COMMENT-4           PIC X(40).
  3038
  3039     12  CO-RPTCD2                         PIC X(10).
  3040     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3041         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3042         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3043
  3044     12  CO-TYPE-AGENT                     PIC X(01).
  3045         88  CO-CORPORATION                   VALUE 'C'.
  3046         88  CO-PARTNERSHIP                   VALUE 'P'.
  3047         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3048         88  CO-TRUST                         VALUE 'T'.
  3049         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3050
  3051     12  CO-FAXNO.
  3052         16  CO-FAX-AREA-CODE                  PIC XXX.
  3053         16  CO-FAX-PREFIX                     PIC XXX.
  3054         16  CO-FAX-PHONE                      PIC X(4).
  3055
  3056     12  CO-BANK-INFORMATION.
  3057         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3058         16  CO-BANK-TRANSIT-NON REDEFINES
  3059             CO-BANK-TRANSIT-NO                PIC 9(8).
  3060
  3061         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3062     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  61
* EL633.cbl
  3063                  CO-BANK-INFORMATION.
  3064         16  CO-MD-GL-ACCT                     PIC X(10).
  3065         16  CO-MD-DIV                         PIC XX.
  3066         16  CO-MD-CENTER                      PIC X(4).
  3067         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3068         16  CO-CREATE-AP-CHECK                PIC X.
  3069         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3070         16  FILLER                            PIC XXX.
  3071     12  CO-ACH-STATUS                         PIC X.
  3072         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3073         88  CO-ACH-PENDING                        VALUE 'P'.
  3074
  3075     12  CO-BILL-SW                            PIC X.
  3076     12  CO-CONTROL-NAME                       PIC X(30).
  3077     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3078     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3079     12  CO-CLP-STATE                          PIC XX.
  3080     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3081     12  CO-SPP-REFUND-EDIT                    PIC X.
  3082
  3083******************************************************************
  3084*
  3085*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  62
* EL633.cbl
  3086/
  3087 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3088                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3089 0000-DFHEXIT SECTION.
  3090     MOVE '9#                    $   ' TO DFHEIV0.
  3091     MOVE 'EL633' TO DFHEIV1.
  3092     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3093
  3094     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3095     MOVE EIBTRMID               TO  QID-TERM.
  3096     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3097
  3098     IF EIBCALEN = ZERO
  3099         GO TO 8800-UNAUTHORIZED-ACCESS.
  3100
  3101     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3102         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3103
  3104     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3105     MOVE '5'                    TO  DC-OPTION-CODE.
  3106
  3107     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3108
  3109     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3110     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3111
  3112     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3113         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3114             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3115             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3116             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3117             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3118             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3119             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3120             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3121             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3122         ELSE
  3123             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3124             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3125             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3126             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3127             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3128             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3129             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3130             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3131
  3132     MOVE LOW-VALUES             TO  EL633AI.
  3133
  3134     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3135     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3136     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3137     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3138
  3139     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3140                                     TOTAL-ACCT-NET.
  3141
  3142     IF RETURNED-FROM = XCTL-6331 OR
  3143                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  63
* EL633.cbl
  3144                        XCTL-642  OR
  3145                        XCTL-652
  3146         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3147
  3148     IF EIBTRNID NOT = TRANS-ID
  3149         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3150         MOVE 'Y'                TO  PI-PAGE-SW
  3151         MOVE ZEROS              TO  PI-SEQ-NOS
  3152         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3153                                     PI-SAV-ACCT-NET
  3154                                     PI-SAV-PREV-AMT
  3155                                     PI-SAV-PREV-NET
  3156         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3157             EIBTRNID NOT = EL642-TRANS-ID  AND
  3158             EIBTRNID NOT = EL652-TRANS-ID) OR
  3159             PI-CR-FIN-RESP = SPACES
  3160             GO TO 8100-SEND-INITIAL-MAP
  3161         ELSE
  3162             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3163                            EL640-TRANS-ID   OR
  3164                            EL642-TRANS-ID)  AND
  3165                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3166                GO TO 8100-SEND-INITIAL-MAP
  3167             ELSE
  3168                 MOVE DFHENTER   TO  EIBAID
  3169                 MOVE 'S'        TO  MAINTI
  3170                 MOVE PI-CR-CARRIER
  3171                                 TO  CARRIERI
  3172                 MOVE PI-CR-GROUPING
  3173                                 TO  GROUPI
  3174                 MOVE PI-CR-FIN-RESP
  3175                                 TO  FINRESPI
  3176                 MOVE PI-CR-ACCOUNT
  3177                                 TO  ACCTI
  3178                 MOVE 1          TO  CARRIERL  MAINTA
  3179                 MOVE 3          TO  GROUPL
  3180                 MOVE 6          TO  FINRESPL  ACCTL
  3181                 GO TO 0400-VALIDATE-KEY-DATA.
  3182
  3183
  3184* EXEC CICS HANDLE CONDITION
  3185*        PGMIDERR  (9600-PGMID-ERROR)
  3186*        ERROR     (9990-ABEND)
  3187*    END-EXEC.
  3188*    MOVE '"$L.                  ! " #00003179' TO DFHEIV0
  3189     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3191     MOVE X'2220233030303033313739' TO DFHEIV0(25:11)
  3192     CALL 'kxdfhei1' USING DFHEIV0
  3193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3194
  3195
  3196     IF EIBAID = DFHCLEAR
  3197         GO TO 9400-CLEAR.
  3198
  3199     IF PI-PROCESSOR-ID = 'LGXX'
  3200         GO TO 0200-RECEIVE.
  3201
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  64
* EL633.cbl
  3202
  3203* EXEC CICS READQ TS
  3204*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3205*        INTO   (SECURITY-CONTROL)
  3206*        LENGTH (SC-COMM-LENGTH)
  3207*        ITEM   (SC-ITEM)
  3208*    END-EXEC.
  3209*    MOVE '*$II   L              ''   #00003190' TO DFHEIV0
  3210     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3211     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3212     MOVE X'2020233030303033313930' TO DFHEIV0(25:11)
  3213     CALL 'kxdfhei1' USING DFHEIV0,
  3214           PI-SECURITY-TEMP-STORE-ID,
  3215           SECURITY-CONTROL,
  3216           SC-COMM-LENGTH,
  3217           SC-ITEM,
  3218           DFHEIV99,
  3219           DFHEIV99
  3220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3221
  3222
  3223     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3224     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3225
  3226     IF NOT DISPLAY-CAP
  3227         MOVE 'READ'          TO SM-READ
  3228         PERFORM 9995-SECURITY-VIOLATION
  3229         MOVE ER-0070         TO  EMI-ERROR
  3230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3231         GO TO 8100-SEND-INITIAL-MAP.
  3232
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  65
* EL633.cbl
  3234 0200-RECEIVE.
  3235
  3236     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3237         MOVE ER-0008            TO  EMI-ERROR
  3238         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3239         MOVE -1                 TO  MAINTL
  3240         GO TO 8200-SEND-DATAONLY.
  3241
  3242
  3243* EXEC CICS RECEIVE
  3244*        MAP     (MAP-NAME)
  3245*        MAPSET  (MAPSET-NAME)
  3246*        INTO    (EL633AI)
  3247*    END-EXEC.
  3248     MOVE LENGTH OF
  3249      EL633AI
  3250       TO DFHEIV11
  3251*    MOVE '8"T I  L              ''   #00003216' TO DFHEIV0
  3252     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3254     MOVE X'2020233030303033323136' TO DFHEIV0(25:11)
  3255     CALL 'kxdfhei1' USING DFHEIV0,
  3256           MAP-NAME,
  3257           EL633AI,
  3258           DFHEIV11,
  3259           MAPSET-NAME,
  3260           DFHEIV99,
  3261           DFHEIV99
  3262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3263
  3264
  3265     IF MAINTI = 'S' AND
  3266        EIBAID = DFHENTER
  3267         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3268                                     PI-SAV-ACCT-NET
  3269                                     PI-SAV-PREV-AMT
  3270                                     PI-SAV-PREV-NET
  3271                                     PI-FRST-FILE-SEQ-NO
  3272         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3273
  3274     IF PFENTERL = ZERO
  3275         GO TO 0300-CHECK-PFKEYS.
  3276
  3277     IF (PFENTERI  IS NUMERIC)
  3278       AND (PFENTERI GREATER 0 AND LESS 25)
  3279         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3280     ELSE
  3281         MOVE ER-0029               TO  EMI-ERROR
  3282         GO TO 0320-INPUT-ERROR.
  3283
  3284 0300-CHECK-PFKEYS.
  3285     IF EIBAID = DFHPF23
  3286         GO TO 8810-PF23.
  3287
  3288     IF EIBAID = DFHPF24
  3289         GO TO 9200-RETURN-MAIN-MENU.
  3290
  3291     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  66
* EL633.cbl
  3292         GO TO 9500-PF12.
  3293
  3294     IF EIBAID = DFHPF3
  3295         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3296             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3297             MOVE XCTL-652       TO  PGM-NAME
  3298             IF ERCOMP-KEY  NOT =      SPACES
  3299                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3300                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3301                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3302                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3303             END-IF
  3304
  3305             IF PI-CR-ACCOUNT = LOW-VALUES
  3306                 MOVE 'G'        TO  PI-CR-TYPE
  3307                 GO TO 9300-XCTL
  3308             ELSE
  3309                 MOVE 'A'        TO  PI-CR-TYPE
  3310                 GO TO 9300-XCTL
  3311         ELSE
  3312            MOVE ER-3020         TO  EMI-ERROR
  3313            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3314            GO TO 8100-SEND-INITIAL-MAP.
  3315
  3316     IF EIBAID = DFHPF4
  3317         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3318         MOVE XCTL-6331          TO  PGM-NAME
  3319         GO TO 9300-XCTL.
  3320
  3321     IF EIBAID = DFHPF5
  3322         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3323         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3324         MOVE XCTL-640           TO  PGM-NAME
  3325         IF PI-CR-ACCOUNT = LOW-VALUES
  3326             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3327             IF ACCTI = LOW-VALUES
  3328                MOVE 'G'         TO  PI-CR-TYPE
  3329             END-IF
  3330             GO TO 9300-XCTL
  3331         ELSE
  3332             MOVE 'A'        TO  PI-CR-TYPE
  3333             GO TO 9300-XCTL.
  3334
  3335     IF EIBAID = DFHPF6
  3336        IF PI-GA-BILLING
  3337            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3338            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3339            MOVE XCTL-642        TO  PGM-NAME
  3340            IF PI-CR-ACCOUNT = LOW-VALUES
  3341                 MOVE 'G'        TO  PI-CR-TYPE
  3342                 GO TO 9300-XCTL
  3343             ELSE
  3344                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3345                 GO TO 9300-XCTL
  3346        ELSE
  3347            MOVE ER-2929         TO  EMI-ERROR
  3348            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3349            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  67
* EL633.cbl
  3350            IF PFENTERL = ZERO
  3351                MOVE -1          TO  MAINTL
  3352                GO TO 8200-SEND-DATAONLY
  3353            ELSE
  3354                MOVE -1          TO  PFENTERL
  3355                GO TO 8200-SEND-DATAONLY.
  3356
  3357     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3358         GO TO 0400-VALIDATE-KEY-DATA.
  3359
  3360 0320-INPUT-ERROR.
  3361     MOVE ER-0029                TO  EMI-ERROR.
  3362
  3363     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3364
  3365     MOVE AL-UNBON               TO  PFENTERA.
  3366
  3367     IF PFENTERL = ZERO
  3368         MOVE -1                 TO  MAINTL
  3369     ELSE
  3370         MOVE -1                 TO  PFENTERL.
  3371
  3372     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  68
* EL633.cbl
  3374 0400-VALIDATE-KEY-DATA.
  3375     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3376         NEXT SENTENCE
  3377       ELSE
  3378        IF MAINTI NOT = 'S'
  3379         MOVE 'UPDATE'       TO SM-READ
  3380         PERFORM 9995-SECURITY-VIOLATION
  3381         MOVE ER-0070        TO EMI-ERROR
  3382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3383         GO TO 8100-SEND-INITIAL-MAP.
  3384
  3385     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3386
  3387     IF EIBAID = DFHPF1
  3388         GO TO 4000-BROWSE-FRWD.
  3389
  3390     IF EIBAID   = DFHPF1   AND
  3391        CARRIERL = ZEROS    AND
  3392        GROUPL   = ZEROS    AND
  3393        FINRESPL = ZEROS    AND
  3394        ACCTL    = ZEROS
  3395         GO TO 4000-BROWSE-FRWD.
  3396
  3397     IF PI-PROCESSOR-ID = 'LGXX'
  3398         IF MAINTI = 'C'
  3399             MOVE AL-UANON       TO MAINTA
  3400             MOVE MAINTI         TO PI-SAV-FUNCTION
  3401             GO TO CSO-BRANCH
  3402         END-IF
  3403     END-IF.
  3404
  3405     IF MAINTI = 'C' OR  'S'
  3406         MOVE AL-UANON           TO  MAINTA
  3407         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3408     ELSE
  3409         MOVE -1                 TO  MAINTL
  3410         MOVE ER-0023            TO  EMI-ERROR
  3411         MOVE AL-UABON           TO  MAINTA
  3412         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3413
  3414 CSO-BRANCH.
  3415
  3416     IF MAINTI = 'C'
  3417       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3418         MOVE -1                 TO  MAINTL
  3419         MOVE ER-2056            TO  EMI-ERROR
  3420         MOVE AL-UABON           TO  MAINTA
  3421         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3422
  3423     IF CARRIERL = ZEROS  AND
  3424        GROUPL   = ZEROS  AND
  3425        FINRESPL = ZEROS  AND
  3426        ACCTL    = ZEROS
  3427         MOVE -1                 TO  CARRIERL
  3428         MOVE ER-2231            TO  EMI-ERROR
  3429         MOVE AL-UABON           TO  CARRIERA
  3430                                     GROUPA
  3431                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  69
* EL633.cbl
  3432                                     ACCTA
  3433         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3434         GO TO 8200-SEND-DATAONLY.
  3435
  3436     IF CARRIERL NOT = ZEROS
  3437         MOVE AL-UANON           TO  CARRIERA
  3438         MOVE CARRIERI           TO  COMP-CARRIER
  3439                                     PI-SAV-CARRIER
  3440                                     PI-CR-CARRIER
  3441         IF CARRIERI NOT = ZEROS
  3442           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3443             MOVE ER-2587        TO  EMI-ERROR
  3444             MOVE -1             TO  CARRIERL
  3445             MOVE AL-UABON       TO  CARRIERA
  3446             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3447         ELSE
  3448             NEXT SENTENCE
  3449     ELSE
  3450         MOVE LOW-VALUES          TO  COMP-CARRIER
  3451                                      PI-SAV-CARRIER.
  3452
  3453     IF CARRIERL NOT = ZEROS
  3454         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3455             IF PI-CARRIER-SECURITY = CARRIERI
  3456                 NEXT SENTENCE
  3457             ELSE
  3458                 MOVE -1         TO  CARRIERL
  3459                 MOVE ER-2370    TO  EMI-ERROR
  3460                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3461
  3462     IF GROUPL NOT = ZEROS
  3463         MOVE AL-UANON           TO  GROUPA
  3464         MOVE GROUPI             TO  COMP-GROUPING
  3465                                     PI-SAV-GROUPING
  3466                                     PI-CR-GROUPING
  3467         IF GROUPI NOT = ZEROS
  3468           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3469             MOVE ER-2588        TO  EMI-ERROR
  3470             MOVE -1             TO  GROUPL
  3471             MOVE AL-UABON       TO  GROUPA
  3472             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3473         ELSE
  3474             NEXT SENTENCE
  3475     ELSE
  3476         MOVE LOW-VALUES         TO  COMP-GROUPING
  3477                                     PI-SAV-GROUPING.
  3478
  3479     IF FINRESPL NOT = ZEROS
  3480         MOVE AL-UANON           TO  FINRESPA
  3481         MOVE FINRESPI           TO  COMP-FIN-RESP
  3482                                     PI-SAV-FIN-RESP
  3483                                     PI-CR-FIN-RESP
  3484     ELSE
  3485         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3486                                     PI-SAV-FIN-RESP.
  3487
  3488     IF ACCTL NOT = ZEROS
  3489         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  70
* EL633.cbl
  3490         MOVE ACCTI              TO  COMP-ACCOUNT
  3491                                     PI-SAV-ACCOUNT
  3492                                     PI-CR-ACCOUNT
  3493     ELSE
  3494         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3495                                     PI-SAV-ACCOUNT
  3496                                     PI-CR-ACCOUNT.
  3497
  3498     IF EMI-ERROR = ZEROS
  3499         NEXT SENTENCE
  3500     ELSE
  3501         IF EIBTRNID = EL640-TRANS-ID OR
  3502            EIBTRNID = EL642-TRANS-ID OR
  3503            EIBTRNID = EL6331-TRANS-ID
  3504             GO TO 8100-SEND-INITIAL-MAP
  3505         ELSE
  3506             GO TO 8200-SEND-DATAONLY.
  3507
  3508     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3509
  3510     IF MAINTI = 'S'
  3511         IF EIBAID = DFHPF1              OR  DFHENTER
  3512             GO TO 4000-BROWSE-FRWD
  3513         ELSE
  3514             GO TO 4100-BROWSE-BKWD.
  3515
  3516     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3517     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3518
  3519
  3520* EXEC CICS HANDLE CONDITION
  3521*        NOTFND   (0410-NO-COMP-MSTR)
  3522*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3523*        END-EXEC.
  3524*    MOVE '"$IJ                  ! # #00003476' TO DFHEIV0
  3525     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3527     MOVE X'2320233030303033343736' TO DFHEIV0(25:11)
  3528     CALL 'kxdfhei1' USING DFHEIV0
  3529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3530
  3531
  3532
  3533* EXEC CICS READ
  3534*        DATASET  (COMP-FILE-ID)
  3535*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3536*        RIDFLD   (ERCOMP-KEY)
  3537*        GTEQ
  3538*        END-EXEC.
  3539*    MOVE '&"S        G          (   #00003481' TO DFHEIV0
  3540     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3542     MOVE X'2020233030303033343831' TO DFHEIV0(25:11)
  3543     CALL 'kxdfhei1' USING DFHEIV0,
  3544           COMP-FILE-ID,
  3545           DFHEIV20,
  3546           DFHEIV99,
  3547           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  71
* EL633.cbl
  3548           DFHEIV99,
  3549           DFHEIV99,
  3550           DFHEIV99
  3551     SET ADDRESS OF COMPENSATION-MASTER TO
  3552         DFHEIV20
  3553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3554
  3555
  3556     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3557        COMP-CARRIER  = CO-CARRIER     AND
  3558        COMP-GROUPING = CO-GROUPING    AND
  3559        COMP-FIN-RESP = CO-RESP-NO    AND
  3560        COMP-ACCOUNT  = CO-ACCOUNT
  3561         NEXT SENTENCE
  3562     ELSE
  3563         GO TO 0410-NO-COMP-MSTR.
  3564
  3565     IF PI-COMPANY-ID = 'NCL'
  3566         IF CO-GA-INACTIVE
  3567             GO TO 0420-INACTIVE-COMP.
  3568
  3569     IF MAINTI = 'C'
  3570         GO TO 1000-EDIT-DATA.
  3571
  3572     IF EIBAID = DFHPF1
  3573       OR DFHENTER
  3574         GO TO 4000-BROWSE-FRWD.
  3575
  3576     IF EIBAID = DFHPF2
  3577         GO TO 4100-BROWSE-BKWD.
  3578
  3579 0410-NO-COMP-MSTR.
  3580     MOVE ER-2230                TO  EMI-ERROR.
  3581     MOVE -1                     TO  CARRIERL.
  3582     MOVE AL-UABON               TO  CARRIERA
  3583                                     GROUPA
  3584                                     FINRESPA
  3585                                     ACCTA.
  3586
  3587     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3588
  3589     GO TO 8200-SEND-DATAONLY.
  3590
  3591 0420-INACTIVE-COMP.
  3592     MOVE ER-2763                TO  EMI-ERROR.
  3593     MOVE -1                     TO  CARRIERL.
  3594     MOVE AL-UABON               TO  CARRIERA
  3595                                     GROUPA
  3596                                     FINRESPA
  3597                                     ACCTA.
  3598
  3599     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3600
  3601     GO TO 8200-SEND-DATAONLY.
  3602
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  72
* EL633.cbl
  3604 0500-CREATE-TEMP-STORAGE.
  3605
  3606     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3607
  3608
  3609* EXEC CICS WRITEQ TS
  3610*        QUEUE  (QID)
  3611*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3612*        LENGTH (PI-COMM-LENGTH)
  3613*    END-EXEC.
  3614*    MOVE '*"                    ''   #00003540' TO DFHEIV0
  3615     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3616     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3617     MOVE X'2020233030303033353430' TO DFHEIV0(25:11)
  3618     CALL 'kxdfhei1' USING DFHEIV0,
  3619           QID,
  3620           PROGRAM-INTERFACE-BLOCK,
  3621           PI-COMM-LENGTH,
  3622           DFHEIV99,
  3623           DFHEIV99,
  3624           DFHEIV99
  3625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3626
  3627
  3628 0590-EXIT.
  3629      EXIT.
  3630
  3631 0600-RECOVER-TEMP-STORAGE.
  3632
  3633* EXEC CICS READQ TS
  3634*        QUEUE  (QID)
  3635*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3636*        LENGTH (PI-COMM-LENGTH)
  3637*    END-EXEC.
  3638*    MOVE '*$I    L              ''   #00003550' TO DFHEIV0
  3639     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3640     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3641     MOVE X'2020233030303033353530' TO DFHEIV0(25:11)
  3642     CALL 'kxdfhei1' USING DFHEIV0,
  3643           QID,
  3644           PROGRAM-INTERFACE-BLOCK,
  3645           PI-COMM-LENGTH,
  3646           DFHEIV99,
  3647           DFHEIV99,
  3648           DFHEIV99
  3649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3650
  3651
  3652     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3653
  3654 0690-EXIT.
  3655      EXIT.
  3656
  3657 0800-DELETE-TS.
  3658
  3659* EXEC CICS HANDLE CONDITION
  3660*        QIDERR (0890-EXIT)
  3661*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  73
* EL633.cbl
  3662*    MOVE '"$N                   ! $ #00003562' TO DFHEIV0
  3663     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3665     MOVE X'2420233030303033353632' TO DFHEIV0(25:11)
  3666     CALL 'kxdfhei1' USING DFHEIV0
  3667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3668
  3669
  3670
  3671* EXEC CICS DELETEQ TS
  3672*        QUEUE  (QID)
  3673*    END-EXEC.
  3674*    MOVE '*&                    #   #00003566' TO DFHEIV0
  3675     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3676     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3677     MOVE X'2020233030303033353636' TO DFHEIV0(25:11)
  3678     CALL 'kxdfhei1' USING DFHEIV0,
  3679           QID,
  3680           DFHEIV99
  3681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3682
  3683
  3684
  3685* EXEC CICS SYNCPOINT
  3686*    END-EXEC.
  3687*    MOVE '6"                    !   #00003570' TO DFHEIV0
  3688     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3690     MOVE X'2020233030303033353730' TO DFHEIV0(25:11)
  3691     CALL 'kxdfhei1' USING DFHEIV0
  3692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3693
  3694
  3695 0890-EXIT.
  3696      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  74
* EL633.cbl
  3698
  3699 1000-EDIT-DATA.
  3700     SET PINDX                   TO  1.
  3701
  3702     .
  3703 1010-EDIT-LOOP.
  3704     SET NDX                     TO  PINDX.
  3705     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3706        GL-STATE-LEN (PINDX) = ZEROS   AND
  3707        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3708        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3709        RTYPE-LEN (PINDX)     = ZEROS  AND
  3710        AMT-LEN (PINDX)       = ZEROS  AND
  3711        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3712        SDTE-LEN (PINDX)      = ZEROS
  3713         GO TO 1020-INCREMENT-PINDX.
  3714
  3715     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3716         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3717         IF PI-COMPANY-ID NOT = 'WSL'
  3718             NEXT SENTENCE
  3719         ELSE
  3720             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3721             MOVE '4'                   TO  DC-OPTION-CODE
  3722             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3723             IF NO-CONVERSION-ERROR
  3724                 NEXT SENTENCE
  3725             ELSE
  3726                 MOVE ER-2595    TO  EMI-ERROR
  3727                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3728                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3729                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3730     ELSE
  3731         IF PI-COMPANY-ID = 'WSL'
  3732           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3733             MOVE ER-2596        TO  EMI-ERROR
  3734             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3735             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3736             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3737
  3738
  3739     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3740*        MOVE K-SPACE            TO COFA-FILLER
  3741*        MOVE '0001'             TO COFA-COMPANY-X
  3742*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3743         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3744     ELSE
  3745         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3746             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3747             MOVE ER-2957        TO EMI-ERROR
  3748             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3749             PERFORM 9900-ERROR-FORMAT THRU
  3750                     9900-EXIT
  3751             GO TO 1040-CONTINUE-EDIT
  3752         ELSE
  3753             GO TO 1040-CONTINUE-EDIT
  3754         END-IF
  3755     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  75
* EL633.cbl
  3756
  3757     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
  3758        AND (RTYPE (PINDX) = 'P')
  3759        GO TO 1040-CONTINUE-EDIT
  3760     END-IF
  3761     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3762        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3763     ELSE
  3764        MOVE SPACES              TO CHECK-GL-ACCT
  3765     END-IF
  3766
  3767     EVALUATE TRUE
  3768        WHEN (PI-COMPANY-ID = 'DCC' or 'CAP')
  3769           AND (CO-CARRIER = '1' OR '2' or '9')
  3770           AND (VALID-DCC-GL-ACCOUNT)
  3771           GO TO 1040-CONTINUE-EDIT
  3772        WHEN (PI-COMPANY-ID = 'DCC' or 'CAP')
  3773           AND (CO-CARRIER = '3' OR '4')
  3774           AND VALID-CSI-GL-ACCOUNT
  3775           GO TO 1040-CONTINUE-EDIT
  3776        WHEN (PI-COMPANY-ID = 'DCC' or 'CAP')
  3777           AND (CO-CARRIER = '5' OR '6' or '7')
  3778           AND (VALID-CCC-GL-ACCOUNT)
  3779           GO TO 1040-CONTINUE-EDIT
  3780        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3781           AND (VALID-GL-ACCOUNT)
  3782           GO TO 1040-CONTINUE-EDIT
  3783     END-EVALUATE
  3784*    EXEC CICS HANDLE CONDITION
  3785*         NOTFND (1040-NO-COFA-MSTR)
  3786*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3787*    END-EXEC.
  3788*
  3789*    EXEC CICS READ
  3790*         DATASET (COFA-FILE-ID)
  3791*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3792*         RIDFLD  (COFA-KEY-X)
  3793*    END-EXEC.
  3794*
  3795*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3796*    GO TO 1040-CONTINUE-EDIT.
  3797*
  3798*1040-NO-COFA-MSTR.
  3799
  3800     MOVE ER-2960                TO EMI-ERROR.
  3801     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3802     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3803     PERFORM 9900-ERROR-FORMAT THRU
  3804             9900-EXIT.
  3805
  3806 1040-CONTINUE-EDIT.
  3807
  3808*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3809     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3810         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3811         IF NOT VALID-STATE-CODE
  3812             MOVE -1             TO GL-STATE-LEN (PINDX)
  3813             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  76
* EL633.cbl
  3814             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3815             PERFORM 9900-ERROR-FORMAT THRU
  3816                     9900-EXIT
  3817         ELSE
  3818             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3819         END-IF
  3820     END-IF.
  3821
  3822 1040-CSO-SKIP.
  3823
  3824     IF GL-CANC (PINDX) = LOW-VALUES
  3825         MOVE SPACES             TO GL-CANC (PINDX)
  3826     END-IF.
  3827
  3828     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3829         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3830         IF NOT VALID-CANC-TYPE
  3831             MOVE -1             TO GL-CANC-LEN (PINDX)
  3832             MOVE ER-2958        TO EMI-ERROR
  3833             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3834             PERFORM 9900-ERROR-FORMAT THRU
  3835                     9900-EXIT
  3836         ELSE
  3837             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3838         END-IF
  3839     END-IF.
  3840
  3841     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3842        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3843        IF (PI-COMPANY-ID = 'DCC' or 'CAP')
  3844           AND (RTYPE (PINDX) = 'P')
  3845           SET VALID-REC-TYPE   TO TRUE
  3846        END-IF
  3847         IF NOT VALID-REC-TYPE
  3848             MOVE -1             TO  RTYPE-LEN (PINDX)
  3849             MOVE ER-2234        TO  EMI-ERROR
  3850             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3851             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3852         ELSE
  3853             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3854     ELSE
  3855         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3856             MOVE -1             TO  RTYPE-LEN (PINDX)
  3857             MOVE ER-2235        TO  EMI-ERROR
  3858             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3859             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3860
  3861     IF AMT-LEN (PINDX) NOT = ZEROS
  3862
  3863* EXEC CICS BIF DEEDIT
  3864*           FIELD (AMT (PINDX))
  3865*           LENGTH (11)
  3866*       END-EXEC
  3867     MOVE 11
  3868       TO DFHEIV11
  3869*    MOVE '@"L                   #   #00003740' TO DFHEIV0
  3870     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3871     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  77
* EL633.cbl
  3872     MOVE X'2020233030303033373430' TO DFHEIV0(25:11)
  3873     CALL 'kxdfhei1' USING DFHEIV0,
  3874           AMT(PINDX),
  3875           DFHEIV11
  3876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3877         IF AMT (PINDX) = ZEROS
  3878             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3879                 NEXT SENTENCE
  3880             ELSE
  3881                 MOVE ER-2245    TO  EMI-ERROR
  3882                 MOVE -1         TO  AMT-LEN(PINDX)
  3883                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3884                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3885         ELSE
  3886             IF AMT (PINDX) NUMERIC
  3887                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3888             ELSE
  3889                 MOVE ER-2245    TO  EMI-ERROR
  3890                 MOVE -1         TO  AMT-LEN(PINDX)
  3891                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3892                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3893     ELSE
  3894         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3895             MOVE -1             TO  AMT-LEN (PINDX)
  3896             MOVE ER-2236        TO  EMI-ERROR
  3897             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3898             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3899
  3900     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3901         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3902           AND (PI-REC-TYPE (NDX) = 'C')
  3903             IF VOID-SW (PINDX) = 'V'
  3904                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3905             ELSE
  3906                 MOVE ER-2246    TO  EMI-ERROR
  3907                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3908                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3909                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3910         ELSE
  3911             MOVE ER-2449        TO  EMI-ERROR
  3912             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3913             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3914             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3915
  3916     IF SDTE-LEN (PINDX) = ZEROS
  3917        GO TO 1020-INCREMENT-PINDX.
  3918
  3919     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3920
  3921     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3922     PERFORM 8600-DEEDIT.
  3923
  3924     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3925        GO TO 1015-DAY-ERROR.
  3926
  3927     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3928     MOVE '4'                    TO  DC-OPTION-CODE.
  3929     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  78
* EL633.cbl
  3930
  3931     IF NO-CONVERSION-ERROR
  3932        SET PINDEX               TO  PINDX
  3933        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3934     ELSE
  3935        GO TO 1015-DAY-ERROR.
  3936
  3937     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3938
  3939     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3940         IF DATE-TEST-DD  NOT = 30
  3941             GO TO 1015-DAY-ERROR
  3942         ELSE
  3943             GO TO 1020-INCREMENT-PINDX.
  3944
  3945     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3946                             8  OR  10  OR  12
  3947         IF DATE-TEST-DD  NOT = 31
  3948             GO TO 1015-DAY-ERROR
  3949         ELSE
  3950             GO TO 1020-INCREMENT-PINDX.
  3951
  3952     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3953         REMAINDER  DIVIDE-REMAINDER.
  3954
  3955     IF (DATE-TEST-YY = ZERO)
  3956       OR (DIVIDE-REMAINDER NOT = ZERO)
  3957         IF DATE-TEST-DD  NOT = 28
  3958             GO TO 1015-DAY-ERROR
  3959         ELSE
  3960             GO TO 1020-INCREMENT-PINDX
  3961     ELSE
  3962         IF DATE-TEST-DD = 29
  3963             GO TO 1020-INCREMENT-PINDX.
  3964
  3965 1015-DAY-ERROR.
  3966     MOVE -1                     TO  SDTE-LEN (PINDX).
  3967     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3968     MOVE ER-0587                TO  EMI-ERROR.
  3969
  3970     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3971
  3972 1020-INCREMENT-PINDX.
  3973     SET PINDX  UP  BY  1.
  3974
  3975     IF PINDX  IS NOT GREATER THAN  13
  3976         GO TO 1010-EDIT-LOOP.
  3977
  3978     IF EMI-ERROR = ZEROS
  3979         NEXT SENTENCE
  3980     ELSE
  3981         MOVE 'S'                TO  PI-PREV-FUNCTION
  3982         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  79
* EL633.cbl
  3984 2000-UPDATE-THE-FILE.
  3985     SET PINDX                   TO  ZERO-NDX.
  3986*    SET NDX                     TO  ZERO-NDX.
  3987*    SET NDX  UP  BY  1.
  3988
  3989     IF PI-PYAJ-FILE-SW = 'B'
  3990         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3991         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3992     ELSE
  3993         MOVE PI-LAST-FILE-SEQ-NO
  3994                                 TO  PI-SAV-FILE-SEQ-NO
  3995         MOVE PI-LAST-RECORD-TYPE
  3996                                 TO  PI-SAV-RECORD-TYPE.
  3997
  3998 2100-UPDATE-LOOP.
  3999     SET PINDX  UP  BY  1.
  4000     SET NDX                     TO  PINDX.
  4001
  4002     IF PINDX  IS GREATER THAN  13
  4003         GO TO 2200-UPDATE-COMPLETE.
  4004
  4005     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4006        GL-STATE-LEN (PINDX) = ZEROS AND
  4007        GL-CANC-LEN (PINDX)   = ZEROS AND
  4008        GL-COMM-LEN (PINDX)   = ZEROS AND
  4009        RTYPE-LEN (PINDX)   = ZEROS  AND
  4010        AMT-LEN (PINDX)     = ZEROS  AND
  4011        VOID-SW-LEN (PINDX) = ZEROS  AND
  4012        SDTE-LEN (PINDX)    = ZEROS
  4013         GO TO 2100-UPDATE-LOOP.
  4014
  4015
  4016* EXEC CICS BIF DEEDIT
  4017*         FIELD (AMT (PINDX))
  4018*         LENGTH (11)
  4019*    END-EXEC.
  4020     MOVE 11
  4021       TO DFHEIV11
  4022*    MOVE '@"L                   #   #00003882' TO DFHEIV0
  4023     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4024     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4025     MOVE X'2020233030303033383832' TO DFHEIV0(25:11)
  4026     CALL 'kxdfhei1' USING DFHEIV0,
  4027           AMT(PINDX),
  4028           DFHEIV11
  4029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4030
  4031
  4032     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4033         NEXT SENTENCE
  4034     ELSE
  4035         GO TO 2110-ADD-RECORD.
  4036
  4037
  4038* EXEC CICS HANDLE CONDITION
  4039*        NOTFND  (2110-ADD-RECORD)
  4040*    END-EXEC.
  4041*    MOVE '"$I                   ! % #00003892' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  80
* EL633.cbl
  4042     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4044     MOVE X'2520233030303033383932' TO DFHEIV0(25:11)
  4045     CALL 'kxdfhei1' USING DFHEIV0
  4046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4047
  4048
  4049     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4050     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4051     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4052
  4053
  4054* EXEC CICS READ
  4055*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4056*        DATASET  (PYAJ-FILE-ID)
  4057*        RIDFLD   (ERPYAJ-KEY)
  4058*        UPDATE
  4059*    END-EXEC.
  4060*    MOVE '&"S        EU         (   #00003900' TO DFHEIV0
  4061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4062     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4063     MOVE X'2020233030303033393030' TO DFHEIV0(25:11)
  4064     CALL 'kxdfhei1' USING DFHEIV0,
  4065           PYAJ-FILE-ID,
  4066           DFHEIV20,
  4067           DFHEIV99,
  4068           ERPYAJ-KEY,
  4069           DFHEIV99,
  4070           DFHEIV99,
  4071           DFHEIV99
  4072     SET ADDRESS OF PENDING-PAY-ADJ TO
  4073         DFHEIV20
  4074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4075
  4076
  4077
  4078     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4079        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4080            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4081            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4082            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4083
  4084     IF AMT-LEN (PINDX) NOT = ZEROS
  4085         IF AMT (PINDX) = ZEROS
  4086             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4087                 GO TO 2120-DELETE-RECORD
  4088             ELSE
  4089                 MOVE ER-2244       TO  EMI-ERROR
  4090                 MOVE -1            TO  AMT-LEN (PINDX)
  4091                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4092                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4093                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4094
  4095* EXEC CICS UNLOCK
  4096*                    DATASET  (PYAJ-FILE-ID)
  4097*                END-EXEC
  4098*    MOVE '&*                    #   #00003924' TO DFHEIV0
  4099     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  81
* EL633.cbl
  4100     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4101     MOVE X'2020233030303033393234' TO DFHEIV0(25:11)
  4102     CALL 'kxdfhei1' USING DFHEIV0,
  4103           PYAJ-FILE-ID,
  4104           DFHEIV99
  4105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4106                 GO TO 8200-SEND-DATAONLY.
  4107
  4108     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4109     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4110     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4111
  4112     PERFORM 8400-LOG-JOURNAL-RECORD.
  4113
  4114     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4115     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4116     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4117
  4118     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4119         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4120     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4121         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4122     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4123         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4124     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4125         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4126     IF AMT-LEN (PINDX) NOT = ZEROS
  4127         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4128
  4129     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4130         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4131
  4132     IF SDTE-LEN (PINDX) NOT = ZEROS
  4133        SET PINDEX               TO  PINDX
  4134        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4135
  4136     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4137     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4138     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4139
  4140
  4141* EXEC CICS REWRITE
  4142*        DATASET  (PYAJ-FILE-ID)
  4143*        FROM     (PENDING-PAY-ADJ)
  4144*    END-EXEC.
  4145     MOVE LENGTH OF
  4146      PENDING-PAY-ADJ
  4147       TO DFHEIV11
  4148*    MOVE '&& L                  %   #00003961' TO DFHEIV0
  4149     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4150     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4151     MOVE X'2020233030303033393631' TO DFHEIV0(25:11)
  4152     CALL 'kxdfhei1' USING DFHEIV0,
  4153           PYAJ-FILE-ID,
  4154           PENDING-PAY-ADJ,
  4155           DFHEIV11,
  4156           DFHEIV99
  4157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  82
* EL633.cbl
  4158
  4159
  4160     PERFORM 8400-LOG-JOURNAL-RECORD.
  4161
  4162     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  83
* EL633.cbl
  4164 2110-ADD-RECORD.
  4165
  4166* EXEC CICS GETMAIN
  4167*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4168*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4169*        INITIMG  (GETMAIN-SPACE)
  4170*    END-EXEC.
  4171*    MOVE ',"IL                  $   #00003971' TO DFHEIV0
  4172     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4173     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4174     MOVE X'2020233030303033393731' TO DFHEIV0(25:11)
  4175     CALL 'kxdfhei1' USING DFHEIV0,
  4176           DFHEIV20,
  4177           ERPYAJ-RECORD-LENGTH,
  4178           GETMAIN-SPACE
  4179     SET ADDRESS OF PENDING-PAY-ADJ TO
  4180         DFHEIV20
  4181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4182
  4183
  4184     MOVE 'PY'                   TO  PY-RECORD-ID.
  4185     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4186     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4187     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4188     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4189     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4190
  4191     ADD +1                      TO  WORK-SEQ-NO.
  4192     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4193
  4194     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4195     MOVE GL-STATE (PINDX)       TO  PY-GL-STATE.
  4196     MOVE GL-CANC (PINDX)        TO  PY-GL-CANC-SW.
  4197     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4198
  4199     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4200     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4201     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4202        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4203     END-IF
  4204     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4205     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4206     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4207                                     PY-INPUT-DT.
  4208     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4209                                     PY-CHECK-QUE-SEQUENCE.
  4210     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4211                                     PY-BILLED-DATE
  4212                                     PY-AR-DATE
  4213                                     PY-REPORTED-DT
  4214                                     PY-CHECK-WRITTEN-DT.
  4215     IF SDTE-LEN (PINDX) = ZEROS
  4216         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4217         GO TO 2115-WRITE-REC
  4218     END-IF.
  4219
  4220     IF SDTE (PINDX) IS NUMERIC
  4221         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  84
* EL633.cbl
  4222         MOVE '4'            TO  DC-OPTION-CODE
  4223         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4224         IF DATE-CONVERSION-ERROR
  4225             MOVE PI-CR-MONTH-END-DT
  4226                             TO  PY-CREDIT-SELECT-DT
  4227         ELSE
  4228             MOVE DC-BIN-DATE-1
  4229                             TO  PY-CREDIT-SELECT-DT
  4230         END-IF
  4231     ELSE
  4232         MOVE PI-CR-MONTH-END-DT
  4233                             TO  PY-CREDIT-SELECT-DT
  4234     END-IF
  4235
  4236     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4237         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4238         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4239
  4240     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4241         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4242         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4243
  4244     MOVE 'N'                    TO  FIRST-ADD-SW.
  4245
  4246     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4247     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4248     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4249 2115-WRITE-REC.
  4250
  4251* EXEC CICS WRITE
  4252*        DATASET  (PYAJ-FILE-ID)
  4253*        FROM     (PENDING-PAY-ADJ)
  4254*        RIDFLD   (PY-CONTROL-PRIMARY)
  4255*    END-EXEC.
  4256     MOVE LENGTH OF
  4257      PENDING-PAY-ADJ
  4258       TO DFHEIV11
  4259*    MOVE '&$ L                  ''   #00004043' TO DFHEIV0
  4260     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4261     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4262     MOVE X'2020233030303034303433' TO DFHEIV0(25:11)
  4263     CALL 'kxdfhei1' USING DFHEIV0,
  4264           PYAJ-FILE-ID,
  4265           PENDING-PAY-ADJ,
  4266           DFHEIV11,
  4267           PY-CONTROL-PRIMARY,
  4268           DFHEIV99,
  4269           DFHEIV99
  4270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4271
  4272
  4273     PERFORM 8400-LOG-JOURNAL-RECORD.
  4274
  4275     GO TO 2100-UPDATE-LOOP.
  4276
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  85
* EL633.cbl
  4278 2120-DELETE-RECORD.
  4279     IF PY-RECORD-TYPE NOT = 'C'
  4280         GO TO 2120-DELETE-CONT.
  4281
  4282     IF PY-CHECK-QUE-CONTROL = ZEROS
  4283       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4284         GO TO 2120-DELETE-CONT.
  4285
  4286
  4287* EXEC CICS HANDLE CONDITION
  4288*        NOTFND  (2120-DELETE-CONT)
  4289*    END-EXEC.
  4290*    MOVE '"$I                   ! & #00004062' TO DFHEIV0
  4291     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4293     MOVE X'2620233030303034303632' TO DFHEIV0(25:11)
  4294     CALL 'kxdfhei1' USING DFHEIV0
  4295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4296
  4297
  4298     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4299     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4300     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4301
  4302
  4303* EXEC CICS READ
  4304*        SET      (ADDRESS OF CHECK-QUE)
  4305*        DATASET  (CHKQ-FILE-ID)
  4306*        RIDFLD   (ERCHKQ-KEY)
  4307*        UPDATE
  4308*    END-EXEC.
  4309*    MOVE '&"S        EU         (   #00004070' TO DFHEIV0
  4310     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4311     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4312     MOVE X'2020233030303034303730' TO DFHEIV0(25:11)
  4313     CALL 'kxdfhei1' USING DFHEIV0,
  4314           CHKQ-FILE-ID,
  4315           DFHEIV20,
  4316           DFHEIV99,
  4317           ERCHKQ-KEY,
  4318           DFHEIV99,
  4319           DFHEIV99,
  4320           DFHEIV99
  4321     SET ADDRESS OF CHECK-QUE TO
  4322         DFHEIV20
  4323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4324
  4325
  4326*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4327*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4328*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4329*
  4330*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4331
  4332
  4333* EXEC CICS DELETE
  4334*        DATASET  (CHKQ-FILE-ID)
  4335*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  86
* EL633.cbl
  4336*    MOVE '&(                    &   #00004083' TO DFHEIV0
  4337     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4338     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4339     MOVE X'2020233030303034303833' TO DFHEIV0(25:11)
  4340     CALL 'kxdfhei1' USING DFHEIV0,
  4341           CHKQ-FILE-ID,
  4342           DFHEIV99,
  4343           DFHEIV99,
  4344           DFHEIV99,
  4345           DFHEIV99
  4346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4347
  4348
  4349 2120-DELETE-CONT.
  4350*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4351*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4352*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4353*
  4354*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4355
  4356     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4357         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4358         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4359         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4360                                     PI-SAV-ACCT-NET
  4361                                     PI-SAV-PREV-AMT
  4362                                     PI-SAV-PREV-NET.
  4363
  4364
  4365* EXEC CICS DELETE
  4366*        DATASET(PYAJ-FILE-ID)
  4367*    END-EXEC.
  4368*    MOVE '&(                    &   #00004102' TO DFHEIV0
  4369     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4370     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4371     MOVE X'2020233030303034313032' TO DFHEIV0(25:11)
  4372     CALL 'kxdfhei1' USING DFHEIV0,
  4373           PYAJ-FILE-ID,
  4374           DFHEIV99,
  4375           DFHEIV99,
  4376           DFHEIV99,
  4377           DFHEIV99
  4378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4379
  4380
  4381     GO TO 2100-UPDATE-LOOP.
  4382
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  87
* EL633.cbl
  4384
  4385 2190-CHANGE-RECORD-TYPE.
  4386
  4387*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4388*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4389*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4390*
  4391*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4392
  4393
  4394* EXEC CICS DELETE
  4395*        DATASET(PYAJ-FILE-ID)
  4396*    END-EXEC.
  4397*    MOVE '&(                    &   #00004118' TO DFHEIV0
  4398     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4399     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4400     MOVE X'2020233030303034313138' TO DFHEIV0(25:11)
  4401     CALL 'kxdfhei1' USING DFHEIV0,
  4402           PYAJ-FILE-ID,
  4403           DFHEIV99,
  4404           DFHEIV99,
  4405           DFHEIV99,
  4406           DFHEIV99
  4407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4408
  4409
  4410
  4411* EXEC CICS GETMAIN
  4412*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4413*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4414*        INITIMG  (GETMAIN-SPACE)
  4415*    END-EXEC.
  4416*    MOVE ',"IL                  $   #00004122' TO DFHEIV0
  4417     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4418     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4419     MOVE X'2020233030303034313232' TO DFHEIV0(25:11)
  4420     CALL 'kxdfhei1' USING DFHEIV0,
  4421           DFHEIV20,
  4422           ERPYAJ-RECORD-LENGTH,
  4423           GETMAIN-SPACE
  4424     SET ADDRESS OF PENDING-PAY-ADJ TO
  4425         DFHEIV20
  4426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4427
  4428
  4429*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4430*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4431
  4432     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4433     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4434                                    PYAJ-RECORD-TYPE.
  4435
  4436
  4437* EXEC CICS HANDLE CONDITION
  4438*        DUPREC (2190-DUP-RECORD)
  4439*    END-EXEC.
  4440*    MOVE '"$%                   ! '' #00004135' TO DFHEIV0
  4441     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  88
* EL633.cbl
  4442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4443     MOVE X'2720233030303034313335' TO DFHEIV0(25:11)
  4444     CALL 'kxdfhei1' USING DFHEIV0
  4445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4446
  4447
  4448*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4449*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4450*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4451
  4452 2190-RETRY-WRITE.
  4453
  4454
  4455* EXEC CICS WRITE
  4456*        DATASET  (PYAJ-FILE-ID)
  4457*        FROM     (PENDING-PAY-ADJ)
  4458*        RIDFLD   (PY-CONTROL-PRIMARY)
  4459*    END-EXEC.
  4460     MOVE LENGTH OF
  4461      PENDING-PAY-ADJ
  4462       TO DFHEIV11
  4463*    MOVE '&$ L                  ''   #00004145' TO DFHEIV0
  4464     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4465     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4466     MOVE X'2020233030303034313435' TO DFHEIV0(25:11)
  4467     CALL 'kxdfhei1' USING DFHEIV0,
  4468           PYAJ-FILE-ID,
  4469           PENDING-PAY-ADJ,
  4470           DFHEIV11,
  4471           PY-CONTROL-PRIMARY,
  4472           DFHEIV99,
  4473           DFHEIV99
  4474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4475
  4476
  4477*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4478
  4479
  4480* EXEC CICS READ
  4481*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4482*        DATASET  (PYAJ-FILE-ID)
  4483*        RIDFLD   (ERPYAJ-KEY)
  4484*        UPDATE
  4485*    END-EXEC.
  4486*    MOVE '&"S        EU         (   #00004153' TO DFHEIV0
  4487     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4488     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4489     MOVE X'2020233030303034313533' TO DFHEIV0(25:11)
  4490     CALL 'kxdfhei1' USING DFHEIV0,
  4491           PYAJ-FILE-ID,
  4492           DFHEIV20,
  4493           DFHEIV99,
  4494           ERPYAJ-KEY,
  4495           DFHEIV99,
  4496           DFHEIV99,
  4497           DFHEIV99
  4498     SET ADDRESS OF PENDING-PAY-ADJ TO
  4499         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  89
* EL633.cbl
  4500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4501
  4502
  4503     GO TO 2190-EXIT.
  4504
  4505 2190-DUP-RECORD.
  4506
  4507     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4508
  4509     GO TO 2190-RETRY-WRITE.
  4510
  4511 2190-EXIT.
  4512     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  90
* EL633.cbl
  4514
  4515 2200-UPDATE-COMPLETE.
  4516     IF EIBAID = DFHPF1
  4517         GO TO 4000-BROWSE-FRWD.
  4518
  4519     IF EIBAID = DFHPF2
  4520         GO TO 4100-BROWSE-BKWD.
  4521
  4522     MOVE LOW-VALUES             TO  EL633AI.
  4523
  4524     MOVE ER-0000                TO  EMI-ERROR.
  4525     MOVE -1                     TO  MAINTL.
  4526
  4527     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4528
  4529     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4530     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4531
  4532*    GO TO 4000-BROWSE-FRWD.
  4533
  4534*    GO TO 8100-SEND-INITIAL-MAP.
  4535
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  91
* EL633.cbl
  4537 4000-BROWSE-FRWD.
  4538     MOVE '1'                     TO  PI-PREV-PFKEY.
  4539     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4540
  4541     IF EIBAID = DFHPF1
  4542         IF PAGE-FULL
  4543             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4544                                      TO  PYAJ-FILE-SEQ-NO
  4545             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4546             MOVE 'N'                 TO  PYAJ-READ-SW
  4547             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4548             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4549             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4550             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4551         ELSE
  4552             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4553                                          PI-SAV-ACCT-NET
  4554                                          PI-SAV-PREV-AMT
  4555                                          PI-SAV-PREV-NET
  4556             MOVE 'Y'                 TO  PI-PAGE-SW
  4557             IF NOT END-OF-FILE
  4558                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4559                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4560             END-IF
  4561             IF TOP-OF-FILE
  4562                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4563                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4564                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4565             ELSE
  4566                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4567                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4568     ELSE
  4569         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4570         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4571         IF MAINTI = 'S'
  4572             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4573             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4574
  4575
  4576     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4577
  4578     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4579         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4580
  4581 4000-BROWSE-FRWD-FOR-PREV.
  4582*    IF END-OF-FILE
  4583*        IF EIBAID = DFHPF1
  4584*           IF PI-TOTAL-DISPLAYED
  4585*              NEXT SENTENCE
  4586*           ELSE
  4587*              MOVE -1                 TO  MAINTL
  4588*              MOVE ER-2237            TO  EMI-ERROR
  4589*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4590*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4591*              SET PINDX               TO  +2
  4592*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4593*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4594*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  92
* EL633.cbl
  4595*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4596*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4597*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4598*                                          PI-SAV-ACCT-NET
  4599*              GO TO 8100-SEND-INITIAL-MAP.
  4600*
  4601*     IF END-OF-FILE
  4602*        IF EIBAID = DFHPF1
  4603*           MOVE -1             TO  MAINTL
  4604*           MOVE ER-2237        TO  EMI-ERROR
  4605*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4606*           GO TO 8200-SEND-DATAONLY.
  4607*
  4608     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4609
  4610     IF NO-RECORDS
  4611        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4612        MOVE LOW-VALUES         TO  EL633AO
  4613        MOVE ER-2239            TO  EMI-ERROR
  4614        MOVE -1                 TO  MAINTL
  4615        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4616        GO TO 8100-SEND-INITIAL-MAP.
  4617
  4618     IF NOT-OPEN
  4619         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4620
  4621     MOVE LOW-VALUES             TO  EL633AO.
  4622     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4623
  4624     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4625          VARYING  PINDX  FROM  1  BY  1
  4626             UNTIL  END-OF-ACCT
  4627                 OR  END-OF-FILE
  4628                     OR  PAGE-FULL
  4629                         OR  NO-RECORDS.
  4630
  4631     IF NO-RECORDS
  4632         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4633         MOVE LOW-VALUES         TO  EL633AO
  4634         MOVE ER-2239            TO  EMI-ERROR
  4635         MOVE -1                 TO  MAINTL
  4636         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4637         GO TO 8100-SEND-INITIAL-MAP.
  4638
  4639     IF END-OF-FILE
  4640         IF EIBAID = DFHPF2
  4641             MOVE ER-2238        TO  EMI-ERROR
  4642             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4643             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4644         ELSE
  4645             MOVE ER-2237        TO  EMI-ERROR
  4646             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4647
  4648     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4649                                     PI-SAV-FUNCTION.
  4650
  4651     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  93
* EL633.cbl
  4653 4100-BROWSE-BKWD.
  4654     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4655                                      PI-TOTAL-DISPLAYED-SW.
  4656     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4657     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4658     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4659     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4660                                      PI-SAV-ACCT-NET
  4661                                      PI-SAV-PREV-AMT
  4662                                      PI-SAV-PREV-NET.
  4663
  4664     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4665
  4666     IF NO-RECORDS
  4667         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4668         MOVE LOW-VALUES         TO  EL633AO
  4669         MOVE ER-2239            TO  EMI-ERROR
  4670         MOVE -1                 TO  MAINTL
  4671         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4672         GO TO 8100-SEND-INITIAL-MAP.
  4673
  4674     IF NOT-OPEN
  4675         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4676
  4677
  4678* EXEC CICS READNEXT
  4679*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4680*        DATASET  (PYAJ-FILE-ID)
  4681*        RIDFLD   (ERPYAJ-KEY)
  4682*    END-EXEC.
  4683     MOVE 0
  4684       TO DFHEIV11
  4685*    MOVE '&.S                   )   #00004334' TO DFHEIV0
  4686     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4687     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4688     MOVE X'2020233030303034333334' TO DFHEIV0(25:11)
  4689     CALL 'kxdfhei1' USING DFHEIV0,
  4690           PYAJ-FILE-ID,
  4691           DFHEIV20,
  4692           DFHEIV99,
  4693           ERPYAJ-KEY,
  4694           DFHEIV99,
  4695           DFHEIV11,
  4696           DFHEIV99,
  4697           DFHEIV99
  4698     SET ADDRESS OF PENDING-PAY-ADJ TO
  4699         DFHEIV20
  4700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4701
  4702
  4703     IF FIRST-PAGE OR
  4704        PI-PREV-PFKEY = '2'
  4705         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4706         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4707
  4708     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4709
  4710     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  94
* EL633.cbl
  4711     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4712     MOVE '2'                     TO  PI-PREV-PFKEY.
  4713
  4714     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  95
* EL633.cbl
  4716 5000-START-BROWSE.
  4717
  4718* EXEC CICS HANDLE CONDITION
  4719*        NOTOPEN  (5010-NOT-OPEN)
  4720*        NOTFND   (5020-NO-RECORDS)
  4721*        ENDFILE  (5020-NO-RECORDS)
  4722*    END-EXEC.
  4723*    MOVE '"$JI''                 ! ( #00004354' TO DFHEIV0
  4724     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4726     MOVE X'2820233030303034333534' TO DFHEIV0(25:11)
  4727     CALL 'kxdfhei1' USING DFHEIV0
  4728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4729
  4730
  4731
  4732* EXEC CICS STARTBR
  4733*        DATASET  (PYAJ-FILE-ID)
  4734*        RIDFLD   (ERPYAJ-KEY)
  4735*    END-EXEC.
  4736     MOVE 0
  4737       TO DFHEIV11
  4738*    MOVE '&,         G          &   #00004360' TO DFHEIV0
  4739     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4740     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4741     MOVE X'2020233030303034333630' TO DFHEIV0(25:11)
  4742     CALL 'kxdfhei1' USING DFHEIV0,
  4743           PYAJ-FILE-ID,
  4744           ERPYAJ-KEY,
  4745           DFHEIV99,
  4746           DFHEIV11,
  4747           DFHEIV99
  4748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4749
  4750
  4751     GO TO 5030-EXIT.
  4752
  4753 5010-NOT-OPEN.
  4754     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4755
  4756     GO TO 5030-EXIT.
  4757
  4758 5020-NO-RECORDS.
  4759     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4760     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4761
  4762 5030-EXIT.
  4763     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  96
* EL633.cbl
  4765 5100-READ-PREVIOUS.
  4766
  4767* EXEC CICS HANDLE CONDITION
  4768*        ENDFILE  (5110-END-OF-FILE)
  4769*        NOTFND   (5110-END-OF-FILE)
  4770*    END-EXEC.
  4771*    MOVE '"$''I                  ! ) #00004380' TO DFHEIV0
  4772     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4774     MOVE X'2920233030303034333830' TO DFHEIV0(25:11)
  4775     CALL 'kxdfhei1' USING DFHEIV0
  4776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4777
  4778
  4779
  4780* EXEC CICS READPREV
  4781*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4782*        DATASET  (PYAJ-FILE-ID)
  4783*        RIDFLD   (ERPYAJ-KEY)
  4784*    END-EXEC.
  4785     MOVE 0
  4786       TO DFHEIV11
  4787*    MOVE '&0S                   )   #00004385' TO DFHEIV0
  4788     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4789     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4790     MOVE X'2020233030303034333835' TO DFHEIV0(25:11)
  4791     CALL 'kxdfhei1' USING DFHEIV0,
  4792           PYAJ-FILE-ID,
  4793           DFHEIV20,
  4794           DFHEIV99,
  4795           ERPYAJ-KEY,
  4796           DFHEIV99,
  4797           DFHEIV11,
  4798           DFHEIV99,
  4799           DFHEIV99
  4800     SET ADDRESS OF PENDING-PAY-ADJ TO
  4801         DFHEIV20
  4802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4803
  4804
  4805     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4806         IF PI-CARRIER-SECURITY = PY-CARRIER
  4807             NEXT SENTENCE
  4808         ELSE
  4809             GO TO 5110-END-OF-FILE.
  4810
  4811     GO TO 5120-EXIT.
  4812
  4813 5110-END-OF-FILE.
  4814     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4815     MOVE ER-2238                TO  EMI-ERROR.
  4816     MOVE -1                     TO  PFENTERL.
  4817
  4818     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4819
  4820     GO TO 8200-SEND-DATAONLY.
  4821
  4822 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  97
* EL633.cbl
  4823     EXIT.
  4824
  4825 5200-END-BROWSE.
  4826
  4827* EXEC CICS ENDBR
  4828*        DATASET  (PYAJ-FILE-ID)
  4829*    END-EXEC.
  4830     MOVE 0
  4831       TO DFHEIV11
  4832*    MOVE '&2                    $   #00004412' TO DFHEIV0
  4833     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4834     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4835     MOVE X'2020233030303034343132' TO DFHEIV0(25:11)
  4836     CALL 'kxdfhei1' USING DFHEIV0,
  4837           PYAJ-FILE-ID,
  4838           DFHEIV11,
  4839           DFHEIV99
  4840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4841
  4842
  4843 5200-EXIT.
  4844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  98
* EL633.cbl
  4846 6000-READ-AND-FORMAT-SCREEN.
  4847
  4848* EXEC CICS HANDLE CONDITION
  4849*        ENDFILE  (6100-END-OF-FILE)
  4850*        NOTFND   (6100-END-OF-FILE)
  4851*    END-EXEC.
  4852*    MOVE '"$''I                  ! * #00004420' TO DFHEIV0
  4853     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4855     MOVE X'2A20233030303034343230' TO DFHEIV0(25:11)
  4856     CALL 'kxdfhei1' USING DFHEIV0
  4857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4858
  4859
  4860*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4861*    INITIALIZE  PI-SEQ-NOS.
  4862
  4863 6010-READ-NEXT.
  4864
  4865
  4866* EXEC CICS READNEXT
  4867*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4868*        DATASET  (PYAJ-FILE-ID)
  4869*        RIDFLD   (ERPYAJ-KEY)
  4870*    END-EXEC.
  4871     MOVE 0
  4872       TO DFHEIV11
  4873*    MOVE '&.S                   )   #00004430' TO DFHEIV0
  4874     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4875     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4876     MOVE X'2020233030303034343330' TO DFHEIV0(25:11)
  4877     CALL 'kxdfhei1' USING DFHEIV0,
  4878           PYAJ-FILE-ID,
  4879           DFHEIV20,
  4880           DFHEIV99,
  4881           ERPYAJ-KEY,
  4882           DFHEIV99,
  4883           DFHEIV11,
  4884           DFHEIV99,
  4885           DFHEIV99
  4886     SET ADDRESS OF PENDING-PAY-ADJ TO
  4887         DFHEIV20
  4888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4889
  4890
  4891     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4892       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4893         GO TO 6100-END-OF-FILE.
  4894
  4895     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4896         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4897             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4898                 GO TO 6100-END-OF-FILE.
  4899
  4900     IF PYAJ-1ST-READ
  4901       AND EIBAID NOT = DFHENTER
  4902       AND NOT PAGE-FULL
  4903         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page  99
* EL633.cbl
  4904         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4905         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4906         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4907         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4908
  4909     IF PYAJ-1ST-READ
  4910         MOVE PI-SAV-ENDING-PYAJ-KEY
  4911                                 TO  PI-START-PYAJ-KEY.
  4912
  4913     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4914        PI-SAV-CARRIER  = PY-CARRIER     AND
  4915        PI-SAV-GROUPING = PY-GROUPING    AND
  4916        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4917        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4918         NEXT SENTENCE
  4919     ELSE
  4920         IF PYAJ-1ST-READ
  4921             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4922             MOVE SPACE          TO  PYAJ-READ-SW
  4923             GO TO 6200-EXIT
  4924         ELSE
  4925             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4926             IF PINDX  IS LESS THAN  12
  4927                 SET PINDX  UP  BY  1
  4928                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4929                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4930                 SET PINDX  UP  BY  1
  4931                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4932                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4933                     GO TO 6200-EXIT
  4934             ELSE
  4935                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4936                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4937                 SET PINDX  UP  BY  1
  4938                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4939                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4940                 GO TO 6200-EXIT.
  4941
  4942*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4943
  4944     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4945         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4946
  4947*    SET PINDX  UP  BY +1.
  4948
  4949     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4950
  4951     IF PINDX  IS GREATER THAN  13
  4952         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4953         MOVE +13                TO  PI-FULL-INDX
  4954         MOVE PI-FRST-FILE-SEQ-NO
  4955                                 TO  PI-LAST-FILE-SEQ-NO
  4956         MOVE PI-FRST-RECORD-TYPE
  4957                                 TO  PI-LAST-RECORD-TYPE
  4958         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4959         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4960         GO TO 6200-EXIT.
  4961
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 100
* EL633.cbl
  4962     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4963     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4964
  4965     IF PYAJ-1ST-READ
  4966         MOVE SPACE              TO  PYAJ-READ-SW.
  4967
  4968     IF PINDX = 1
  4969         MOVE PI-PREV-FILE-SEQ-NO
  4970                                 TO  PI-FRST-FILE-SEQ-NO
  4971         MOVE PI-PREV-RECORD-TYPE
  4972                                 TO  PI-FRST-RECORD-TYPE
  4973         MOVE PI-PREV-FILE-SEQ-NO
  4974                                 TO  PI-LAST-FILE-SEQ-NO
  4975         MOVE PI-PREV-RECORD-TYPE
  4976                                 TO  PI-LAST-RECORD-TYPE.
  4977
  4978     SET NDX                     TO  PINDX.
  4979     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4980
  4981     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4982
  4983     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4984     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4985     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4986     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4987     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4988
  4989     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4990
  4991     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4992         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4993     ELSE
  4994         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  4995
  4996     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  4997                                     PI-REC-TYPE (NDX).
  4998
  4999     IF PY-VOID-SW NOT = SPACE
  5000         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  5001
  5002     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5003         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5004     ELSE
  5005         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5006                                     PREV-BIN-MAINT-DT
  5007         MOVE SPACE              TO  DC-OPTION-CODE
  5008         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5009* DAN    MOVE DC-GREG-DATE-1-EDIT
  5010         MOVE DC-GREG-DATE-1-MDY
  5011                                 TO  MDTE (PINDX)
  5012                                     PREV-MAINT-DT.
  5013
  5014*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5015     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5016         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5017         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5018*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5019*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 101
* EL633.cbl
  5020     END-IF.
  5021
  5022     IF PY-BILLED-DATE NOT = LOW-VALUES
  5023         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5024                                     AMT-ATTRB (PINDX)
  5025                                     VOID-SW-ATTRB (PINDX)
  5026         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5027             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5028         ELSE
  5029             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5030                                     PREV-BIN-BL-DT
  5031             MOVE SPACE          TO  DC-OPTION-CODE
  5032             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5033* DAN        MOVE DC-GREG-DATE-1-EDIT
  5034             MOVE DC-GREG-DATE-1-MDY
  5035                                 TO  BDTE (PINDX)
  5036                                     PREV-BL-DT.
  5037
  5038     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5039         NEXT SENTENCE
  5040     ELSE
  5041         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5042                                     AMT-ATTRB     (PINDX).
  5043
  5044     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5045         MOVE PY-CREDIT-SELECT-DT
  5046                                 TO  DC-BIN-DATE-1
  5047         MOVE SPACE              TO  DC-OPTION-CODE
  5048         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5049
  5050         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5051         MOVE WS-GS-MM             TO  WS-SS-MM
  5052         MOVE WS-GS-DD             TO  WS-SS-DD
  5053         MOVE WS-GS-YY             TO  WS-SS-YY
  5054         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5055     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5056        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5057         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5058                                    AMT-ATTRB      (PINDX)
  5059                                    GL-ACCT-ATTRB  (PINDX)
  5060                                    GL-COMM-ATTRB  (PINDX)
  5061                                    VOID-SW-ATTRB  (PINDX)
  5062                                    GL-STATE-ATTRB (PINDX)
  5063                                    GL-CANC-ATTRB  (PINDX)
  5064                                    SDTE-ATTRB     (PINDX)
  5065
  5066     END-IF
  5067
  5068*    GO TO 6010-READ-NEXT.
  5069     GO TO 6200-EXIT.
  5070
  5071 6100-END-OF-FILE.
  5072     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5073
  5074     IF PINDX  IS LESS THAN  12
  5075         SET PINDX  UP  BY  1
  5076         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5077         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 102
* EL633.cbl
  5078         SET PINDX  UP  BY  1
  5079         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5080         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5081         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5082     ELSE
  5083         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5084         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5085         SET PINDX  UP  BY  1
  5086         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5087         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5088
  5089 6200-EXIT.
  5090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 103
* EL633.cbl
  5092 7000-PYAJ-FILE-NOTOPEN.
  5093     MOVE -1                     TO  MAINTL.
  5094     MOVE ER-2232                TO  EMI-ERROR.
  5095
  5096     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5097
  5098     GO TO 8200-SEND-DATAONLY.
  5099
  5100 7100-COMP-FILE-NOTOPEN.
  5101     MOVE -1                     TO  MAINTL.
  5102     MOVE ER-2233                TO  EMI-ERROR.
  5103
  5104     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5105
  5106     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 104
* EL633.cbl
  5108*
  5109*7100-COFA-FILE-NOTOPEN.
  5110*    MOVE -1                     TO PFENTERL.
  5111*    MOVE ER-2959                TO EMI-ERROR.
  5112*    PERFORM 9900-ERROR-FORMAT THRU
  5113*            9900-EXIT.
  5114*    GO TO 8200-SEND-DATAONLY.
  5115*
  5116 8100-SEND-INITIAL-MAP.
  5117     MOVE WS-CURRENT-DT          TO  DATEO.
  5118     MOVE EIBTIME                TO  TIME-IN.
  5119     MOVE TIME-OUT               TO  TIMEO.
  5120     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5121     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5122     MOVE -1                     TO  MAINTL.
  5123     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5124     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5125
  5126     IF EIBTRNID = TRANS-ID
  5127       OR EL640-TRANS-ID
  5128       OR EL642-TRANS-ID
  5129       OR EL652-TRANS-ID
  5130       OR EL6331-TRANS-ID
  5131         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5132             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5133             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5134             MOVE PI-SAV-GROUPING  TO  GROUPO
  5135             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5136             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5137             MOVE AL-UANON         TO  MAINTA
  5138                                       CARRIERA
  5139                                       GROUPA
  5140                                       FINRESPA
  5141                                       ACCTA
  5142         ELSE
  5143             NEXT SENTENCE.
  5144
  5145
  5146* EXEC CICS SEND
  5147*        MAP     (MAP-NAME)
  5148*        MAPSET  (MAPSET-NAME)
  5149*        FROM    (EL633AO)
  5150*        ERASE
  5151*        CURSOR
  5152*        END-EXEC.
  5153     MOVE LENGTH OF
  5154      EL633AO
  5155       TO DFHEIV12
  5156     MOVE -1
  5157       TO DFHEIV11
  5158*    MOVE '8$     CT  E    H L F ,   #00004690' TO DFHEIV0
  5159     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5160     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5161     MOVE X'2020233030303034363930' TO DFHEIV0(25:11)
  5162     CALL 'kxdfhei1' USING DFHEIV0,
  5163           MAP-NAME,
  5164           EL633AO,
  5165           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 105
* EL633.cbl
  5166           MAPSET-NAME,
  5167           DFHEIV99,
  5168           DFHEIV99,
  5169           DFHEIV99,
  5170           DFHEIV11,
  5171           DFHEIV99,
  5172           DFHEIV99,
  5173           DFHEIV99
  5174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5175
  5176
  5177     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 106
* EL633.cbl
  5179 8200-SEND-DATAONLY.
  5180     MOVE WS-CURRENT-DT          TO  DATEO.
  5181     MOVE EIBTIME                TO  TIME-IN.
  5182     MOVE TIME-OUT               TO  TIMEO.
  5183     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5184     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5185     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5186     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5187
  5188
  5189* EXEC CICS SEND
  5190*        MAP     (MAP-NAME)
  5191*        MAPSET  (MAPSET-NAME)
  5192*        FROM    (EL633AO)
  5193*        DATAONLY
  5194*        CURSOR
  5195*    END-EXEC.
  5196     MOVE LENGTH OF
  5197      EL633AO
  5198       TO DFHEIV12
  5199     MOVE -1
  5200       TO DFHEIV11
  5201*    MOVE '8$D    CT       H L F ,   #00004709' TO DFHEIV0
  5202     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5203     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5204     MOVE X'2020233030303034373039' TO DFHEIV0(25:11)
  5205     CALL 'kxdfhei1' USING DFHEIV0,
  5206           MAP-NAME,
  5207           EL633AO,
  5208           DFHEIV12,
  5209           MAPSET-NAME,
  5210           DFHEIV99,
  5211           DFHEIV99,
  5212           DFHEIV99,
  5213           DFHEIV11,
  5214           DFHEIV99,
  5215           DFHEIV99,
  5216           DFHEIV99
  5217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5218
  5219
  5220     GO TO 9100-RETURN-TRAN.
  5221
  5222 8300-SEND-TEXT.
  5223
  5224* EXEC CICS SEND TEXT
  5225*        FROM    (LOGOFF-TEXT)
  5226*        LENGTH  (LOGOFF-LENGTH)
  5227*        ERASE
  5228*        FREEKB
  5229*    END-EXEC.
  5230*    MOVE '8&      T  E F  H   F -   #00004720' TO DFHEIV0
  5231     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5232     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5233     MOVE X'2020233030303034373230' TO DFHEIV0(25:11)
  5234     CALL 'kxdfhei1' USING DFHEIV0,
  5235           LOGOFF-TEXT,
  5236           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 107
* EL633.cbl
  5237           DFHEIV99,
  5238           DFHEIV99,
  5239           DFHEIV99,
  5240           DFHEIV99,
  5241           DFHEIV99,
  5242           DFHEIV99,
  5243           DFHEIV99,
  5244           DFHEIV99,
  5245           DFHEIV99,
  5246           DFHEIV99
  5247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5248
  5249
  5250
  5251* EXEC CICS RETURN
  5252*    END-EXEC.
  5253*    MOVE '.(                    ''   #00004727' TO DFHEIV0
  5254     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5256     MOVE X'2020233030303034373237' TO DFHEIV0(25:11)
  5257     CALL 'kxdfhei1' USING DFHEIV0,
  5258           DFHEIV99,
  5259           DFHEIV99,
  5260           DFHEIV99,
  5261           DFHEIV99,
  5262           DFHEIV99,
  5263           DFHEIV99
  5264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5265
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 108
* EL633.cbl
  5267 8400-LOG-JOURNAL-RECORD.
  5268*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5269*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5270
  5271*    EXEC CICS JOURNAL
  5272*        JFILEID  (PI-JOURNAL-FILE-ID)
  5273*        JTYPEID  ('EL')
  5274*        FROM     (JOURNAL-RECORD)
  5275*        LENGTH   (223)
  5276*        END-EXEC.
  5277
  5278 8500-DATE-CONVERT.
  5279
  5280* EXEC CICS LINK
  5281*        PROGRAM   (LINK-CLDATCV)
  5282*        COMMAREA  (DATE-CONVERSION-DATA)
  5283*        LENGTH    (DC-COMM-LENGTH)
  5284*    END-EXEC.
  5285*    MOVE '."C                   (   #00004742' TO DFHEIV0
  5286     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5288     MOVE X'2020233030303034373432' TO DFHEIV0(25:11)
  5289     CALL 'kxdfhei1' USING DFHEIV0,
  5290           LINK-CLDATCV,
  5291           DATE-CONVERSION-DATA,
  5292           DC-COMM-LENGTH,
  5293           DFHEIV99,
  5294           DFHEIV99,
  5295           DFHEIV99,
  5296           DFHEIV99
  5297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5298
  5299
  5300 8500-EXIT.
  5301     EXIT.
  5302
  5303 8600-DEEDIT.
  5304
  5305* EXEC CICS BIF DEEDIT
  5306*        FIELD   (DEEDIT-FIELD)
  5307*        LENGTH  (11)
  5308*    END-EXEC.
  5309     MOVE 11
  5310       TO DFHEIV11
  5311*    MOVE '@"L                   #   #00004752' TO DFHEIV0
  5312     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5313     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5314     MOVE X'2020233030303034373532' TO DFHEIV0(25:11)
  5315     CALL 'kxdfhei1' USING DFHEIV0,
  5316           DEEDIT-FIELD,
  5317           DFHEIV11
  5318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5319
  5320
  5321 8600-EXIT.
  5322     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 109
* EL633.cbl
  5324 8800-UNAUTHORIZED-ACCESS.
  5325     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5326
  5327     GO TO 8300-SEND-TEXT.
  5328
  5329 8810-PF23.
  5330     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5331     MOVE XCTL-005               TO  PGM-NAME.
  5332
  5333     GO TO 9300-XCTL.
  5334
  5335 9100-RETURN-TRAN.
  5336     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5337     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5338
  5339
  5340* EXEC CICS RETURN
  5341*        TRANSID   (TRANS-ID)
  5342*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5343*        LENGTH    (PI-COMM-LENGTH)
  5344*    END-EXEC.
  5345*    MOVE '.(CT                  ''   #00004775' TO DFHEIV0
  5346     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5347     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5348     MOVE X'2020233030303034373735' TO DFHEIV0(25:11)
  5349     CALL 'kxdfhei1' USING DFHEIV0,
  5350           TRANS-ID,
  5351           PROGRAM-INTERFACE-BLOCK,
  5352           PI-COMM-LENGTH,
  5353           DFHEIV99,
  5354           DFHEIV99,
  5355           DFHEIV99
  5356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5357
  5358
  5359 9200-RETURN-MAIN-MENU.
  5360     MOVE XCTL-626               TO  PGM-NAME.
  5361
  5362     GO TO 9300-XCTL.
  5363
  5364 9300-XCTL.
  5365
  5366* EXEC CICS XCTL
  5367*        PROGRAM   (PGM-NAME)
  5368*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5369*        LENGTH    (PI-COMM-LENGTH)
  5370*    END-EXEC.
  5371*    MOVE '.$C                   %   #00004787' TO DFHEIV0
  5372     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5373     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5374     MOVE X'2020233030303034373837' TO DFHEIV0(25:11)
  5375     CALL 'kxdfhei1' USING DFHEIV0,
  5376           PGM-NAME,
  5377           PROGRAM-INTERFACE-BLOCK,
  5378           PI-COMM-LENGTH,
  5379           DFHEIV99
  5380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5381
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 110
* EL633.cbl
  5382
  5383 9400-CLEAR.
  5384     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5385
  5386     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5387     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5388                                     PI-SAV-COMP-CONTROL.
  5389
  5390     GO TO 9300-XCTL.
  5391
  5392 9500-PF12.
  5393     MOVE XCTL-010               TO  PGM-NAME.
  5394
  5395     GO TO 9300-XCTL.
  5396
  5397 9600-PGMID-ERROR.
  5398
  5399* EXEC CICS HANDLE CONDITION
  5400*        PGMIDERR  (8300-SEND-TEXT)
  5401*    END-EXEC.
  5402*    MOVE '"$L                   ! + #00004808' TO DFHEIV0
  5403     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5405     MOVE X'2B20233030303034383038' TO DFHEIV0(25:11)
  5406     CALL 'kxdfhei1' USING DFHEIV0
  5407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5408
  5409
  5410     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5411     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5412     MOVE XCTL-005               TO  PGM-NAME.
  5413     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5414     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5415
  5416     GO TO 9300-XCTL.
  5417
  5418 9900-ERROR-FORMAT.
  5419     IF NOT EMI-ERRORS-COMPLETE
  5420         MOVE LINK-001           TO  PGM-NAME
  5421
  5422* EXEC CICS LINK
  5423*            PROGRAM   (PGM-NAME)
  5424*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5425*            LENGTH    (EMI-COMM-LENGTH)
  5426*        END-EXEC.
  5427*    MOVE '."C                   (   #00004823' TO DFHEIV0
  5428     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5430     MOVE X'2020233030303034383233' TO DFHEIV0(25:11)
  5431     CALL 'kxdfhei1' USING DFHEIV0,
  5432           PGM-NAME,
  5433           ERROR-MESSAGE-INTERFACE-BLOCK,
  5434           EMI-COMM-LENGTH,
  5435           DFHEIV99,
  5436           DFHEIV99,
  5437           DFHEIV99,
  5438           DFHEIV99
  5439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 111
* EL633.cbl
  5440
  5441
  5442 9900-EXIT.
  5443     EXIT.
  5444
  5445 9990-ABEND.
  5446     MOVE LINK-004               TO  PGM-NAME.
  5447     MOVE DFHEIBLK               TO  EMI-LINE1.
  5448
  5449
  5450* EXEC CICS LINK
  5451*        PROGRAM   (PGM-NAME)
  5452*        COMMAREA  (EMI-LINE1)
  5453*        LENGTH    (72)
  5454*    END-EXEC.
  5455     MOVE 72
  5456       TO DFHEIV11
  5457*    MOVE '."C                   (   #00004836' TO DFHEIV0
  5458     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5460     MOVE X'2020233030303034383336' TO DFHEIV0(25:11)
  5461     CALL 'kxdfhei1' USING DFHEIV0,
  5462           PGM-NAME,
  5463           EMI-LINE1,
  5464           DFHEIV11,
  5465           DFHEIV99,
  5466           DFHEIV99,
  5467           DFHEIV99,
  5468           DFHEIV99
  5469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5470
  5471
  5472     MOVE -1                     TO  PFENTERL.
  5473
  5474     GO TO 8200-SEND-DATAONLY.
  5475
  5476 9995-SECURITY-VIOLATION.
  5477*                            COPY ELCSCTP.
  5478******************************************************************
  5479*                                                                *
  5480*                            ELCSCTP                             *
  5481*                            VMOD=2.001                          *
  5482*                                                                *
  5483*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5484******************************************************************
  5485
  5486
  5487     MOVE EIBDATE          TO SM-JUL-DATE.
  5488     MOVE EIBTRMID         TO SM-TERMID.
  5489     MOVE THIS-PGM         TO SM-PGM.
  5490     MOVE EIBTIME          TO TIME-IN.
  5491     MOVE TIME-OUT         TO SM-TIME.
  5492     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5493
  5494
  5495* EXEC CICS LINK
  5496*         PROGRAM  ('EL003')
  5497*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 112
* EL633.cbl
  5498*         LENGTH   (80)
  5499*    END-EXEC.
  5500     MOVE 'EL003' TO DFHEIV1
  5501     MOVE 80
  5502       TO DFHEIV11
  5503*    MOVE '."C                   (   #00004864' TO DFHEIV0
  5504     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5506     MOVE X'2020233030303034383634' TO DFHEIV0(25:11)
  5507     CALL 'kxdfhei1' USING DFHEIV0,
  5508           DFHEIV1,
  5509           SECURITY-MESSAGE,
  5510           DFHEIV11,
  5511           DFHEIV99,
  5512           DFHEIV99,
  5513           DFHEIV99,
  5514           DFHEIV99
  5515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5516
  5517
  5518******************************************************************
  5519
  5520
  5521 9995-EXIT.
  5522     EXIT.
  5523
  5524
  5525 9999-DFHBACK SECTION.
  5526     MOVE '9%                    "   ' TO DFHEIV0
  5527     MOVE 'EL633' TO DFHEIV1
  5528     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5529     GOBACK.
  5530 9999-DFHEXIT.
  5531     IF DFHEIGDJ EQUAL 0001
  5532         NEXT SENTENCE
  5533     ELSE IF DFHEIGDJ EQUAL 2
  5534         GO TO 9600-PGMID-ERROR,
  5535               9990-ABEND
  5536         DEPENDING ON DFHEIGDI
  5537     ELSE IF DFHEIGDJ EQUAL 3
  5538         GO TO 0410-NO-COMP-MSTR,
  5539               7100-COMP-FILE-NOTOPEN
  5540         DEPENDING ON DFHEIGDI
  5541     ELSE IF DFHEIGDJ EQUAL 4
  5542         GO TO 0890-EXIT
  5543         DEPENDING ON DFHEIGDI
  5544     ELSE IF DFHEIGDJ EQUAL 5
  5545         GO TO 2110-ADD-RECORD
  5546         DEPENDING ON DFHEIGDI
  5547     ELSE IF DFHEIGDJ EQUAL 6
  5548         GO TO 2120-DELETE-CONT
  5549         DEPENDING ON DFHEIGDI
  5550     ELSE IF DFHEIGDJ EQUAL 7
  5551         GO TO 2190-DUP-RECORD
  5552         DEPENDING ON DFHEIGDI
  5553     ELSE IF DFHEIGDJ EQUAL 8
  5554         GO TO 5010-NOT-OPEN,
  5555               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:07 Page 113
* EL633.cbl
  5556               5020-NO-RECORDS
  5557         DEPENDING ON DFHEIGDI
  5558     ELSE IF DFHEIGDJ EQUAL 9
  5559         GO TO 5110-END-OF-FILE,
  5560               5110-END-OF-FILE
  5561         DEPENDING ON DFHEIGDI
  5562     ELSE IF DFHEIGDJ EQUAL 10
  5563         GO TO 6100-END-OF-FILE,
  5564               6100-END-OF-FILE
  5565         DEPENDING ON DFHEIGDI
  5566     ELSE IF DFHEIGDJ EQUAL 11
  5567         GO TO 8300-SEND-TEXT
  5568         DEPENDING ON DFHEIGDI.
  5569     MOVE '9%                    "   ' TO DFHEIV0
  5570     MOVE 'EL633' TO DFHEIV1
  5571     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5572     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5640     Code:       16821
