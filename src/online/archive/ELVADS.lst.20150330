* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* ELVADS.cbl
* Options: int("ELVADS.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELVADS.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELVADS.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELVADS.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 ELVADS.
     3*AUTHOR.  PABLO.
     4*         OMAHA, NEBRASKA.
     5*SECURITY.   *****************************************************
     6*            *                                                   *
     7*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
     8*            *   HEALTH AND LIFE CO. OF OMAHA                    *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* ELVADS.cbl
    14*            *****************************************************
    15*REMARKS. TRANSACTION VADS - VA DISCLOSURE PRINT TEST
    16*                        C H A N G E   L O G
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST  PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 103107    2007092500001   PEMA  NEW PROGRAM
    22* 100111    2011022800001   AJRA  NAPERSOFT
    23******************************************************************
    24*
    25 ENVIRONMENT DIVISION.
    26 DATA DIVISION.
    27 WORKING-STORAGE SECTION.
    28 01  DFH-START PIC X(04).
    29 77  FILLER  PIC  X(32) VALUE '********************************'.
    30 77  FILLER  PIC  X(32) VALUE '*   ELVADS WORKING STORAGE     *'.
    31 77  FILLER  PIC  X(32) VALUE '********* V/M 2.001 ************'.
    32 77  VA-RATE-SW                  PIC X  VALUE ' '.
    33     88  FOUND-VA-RATE               VALUE 'F'.
    34     88  NO-VA-RATE-FOUND            VALUE 'N'.
    35 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    36 77  E1                          PIC S999 COMP-3 VALUE +0.
    37 77  ARCH-STATUS                 PIC X.
    38     88  ARCH-OK                        VALUE "P".
    39     88  ARCH-FAIL                      VALUE "F".
    40 01  WS-CALC-SWITCHES.
    41     05  WS-TYPE-OF-CERT         PIC X.
    42         88  GROSS-CERT              VALUE 'G'.
    43         88  NET-CERT                VALUE 'N'.
    44         88  LEVEL-CERT              VALUE 'L'.
    45         88  AH-ONLY                 VALUE 'A'.
    46     05  WS-CALC-LF-GROSS        PIC X.
    47         88  CALC-LF-GROSS           VALUE 'Y'.
    48     05  WS-CALC-LF-NET          PIC X.
    49         88  CALC-LF-NET             VALUE 'Y'.
    50     05  WS-CALC-LF-LEVEL        PIC X.
    51         88  CALC-LF-LEVEL           VALUE 'Y'.
    52     05  WS-CALC-AH              PIC X.
    53         88  CALC-AH                 VALUE 'Y'.
    54 01  WS-CALC-AREA.
    55     05  WS-NET-PMT-1            PIC S9(7)V99 COMP-3 VALUE +0.
    56     05  WS-NET-PMT-2            PIC S9(7)V99 COMP-3 VALUE +0.
    57     05  WS-NET-PMT-3            PIC S9(7)V99 COMP-3 VALUE +0.
    58     05  WS-NET-PMT-4            PIC S9(7)V99 COMP-3 VALUE +0.
    59     05  WS-GROSS-PMT-1          PIC S9(7)V99 COMP-3 VALUE +0.
    60     05  WS-GROSS-PMT-2          PIC S9(7)V99 COMP-3 VALUE +0.
    61     05  WS-GROSS-PMT-3          PIC S9(7)V99 COMP-3 VALUE +0.
    62     05  WS-GROSS-PMT-4          PIC S9(7)V99 COMP-3 VALUE +0.
    63     05  WS-LEVEL-PMT-1          PIC S9(7)V99 COMP-3 VALUE +0.
    64     05  WS-LEVEL-PMT-2          PIC S9(7)V99 COMP-3 VALUE +0.
    65     05  WS-LEVEL-PMT-3          PIC S9(7)V99 COMP-3 VALUE +0.
    66     05  WS-LEVEL-PMT-4          PIC S9(7)V99 COMP-3 VALUE +0.
    67     05  WS-NET-PREM-1           PIC S9(7)V99 COMP-3 VALUE +0.
    68     05  WS-NET-PREM-2           PIC S9(7)V99 COMP-3 VALUE +0.
    69     05  WS-NET-PREM-3           PIC S9(7)V99 COMP-3 VALUE +0.
    70     05  WS-NET-PREM-4           PIC S9(7)V99 COMP-3 VALUE +0.
    71     05  WS-GROSS-PREM-1         PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* ELVADS.cbl
    72     05  WS-GROSS-PREM-2         PIC S9(7)V99 COMP-3 VALUE +0.
    73     05  WS-GROSS-PREM-3         PIC S9(7)V99 COMP-3 VALUE +0.
    74     05  WS-GROSS-PREM-4         PIC S9(7)V99 COMP-3 VALUE +0.
    75     05  WS-LEVEL-PREM-1         PIC S9(7)V99 COMP-3 VALUE +0.
    76     05  WS-LEVEL-PREM-2         PIC S9(7)V99 COMP-3 VALUE +0.
    77     05  WS-LEVEL-PREM-3         PIC S9(7)V99 COMP-3 VALUE +0.
    78     05  WS-LEVEL-PREM-4         PIC S9(7)V99 COMP-3 VALUE +0.
    79     05  ANNUAL-DISCOUNT         PIC S99V999  COMP-3 VALUE +0.
    80     05  CUR-PMT                 PIC S9(7)V99 COMP-3 VALUE +0.
    81     05  AMT-FINANCED            PIC S9(9)V99 COMP-3 VALUE +0.
    82     05  PRINC-AMT               PIC S9(9)V99 COMP-3 VALUE +0.
    83     05  LFPREM                  PIC S9(7)V99 COMP-3 VALUE +0.
    84     05  AHPREM                  PIC S9(7)V99 COMP-3 VALUE +0.
    85     05  LFAMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    86     05  AHRATE                  PIC S99V9(5) COMP-3 VALUE +0.
    87     05  LF-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
    88     05  OBRATE                  PIC S99V9(5) COMP-3 VALUE +0.
    89     05  I                       PIC SV9(9)   COMP-3 VALUE +0.
    90     05  Z                       PIC S999     COMP-3 VALUE +0.
    91     05  D                       PIC S9(5)    COMP-3 VALUE +0.
    92     05  T                       PIC S9(5)    COMP-3 VALUE +0.
    93     05  DISC                    PIC SV9(9)   COMP-3 VALUE +0.
    94     05  V-M                     PIC S99V9(9) COMP-3 VALUE +0.
    95     05  VM-N                    PIC S99V9(9) COMP-3 VALUE +0.
    96     05  VM                      PIC S99V9(9) COMP-3 VALUE +0.
    97     05  V                       PIC S99V9(9) COMP-3 VALUE +0.
    98     05  X                       PIC S99V9(9) COMP-3 VALUE +0.
    99     05  Y                       PIC S99V9(9) COMP-3 VALUE +0.
   100     05  N                       PIC S999     COMP-3 VALUE +0.
   101     05  M                       PIC S999     COMP-3 VALUE +0.
   102     05  R                       PIC S9(7)V99 COMP-3 VALUE +0.
   103     05  FILLER PIC X(12) VALUE ' SP IS NEXT '.
   104     05  SP                      PIC S99V9(9) COMP-3 VALUE +0.
   105     05  ANGLEN                  PIC S999V9(9) COMP-3 VALUE +0.
   106     05  ANGLENY                 PIC S999V9(9) COMP-3 VALUE +0.
   107     05  ANGLEN-LEVEL            PIC S999V9(9) COMP-3 VALUE +0.
   108     05  ANGLENY-LEVEL           PIC S999V9(9) COMP-3 VALUE +0.
   109     05  LDPN                    PIC S9(5)V99  COMP-3 VALUE +0.
   110     05  AHPN                    PIC S9(5)V99  COMP-3 VALUE +0.
   111     05  FILLER PIC X(12) VALUE ' LF IS NEXT '.
   112     05  LF                      PIC S99V9(11) COMP-3 VALUE +0.
   113     05  PPY                     PIC S999V9(7) COMP-3 VALUE +0.
   114 01  WS-HOLD-RATE-EXP.
   115     05  WS-HOLD-RATE-EXP-AL     PIC X(11).
   116     05  WS-HOLD-RATE-EXP-DT REDEFINES
   117         WS-HOLD-RATE-EXP-AL     PIC 9(11).
   118 01  ERRATE-KEY.
   119     05  RATE-COMPANY-CD         PIC X       VALUE SPACE.
   120     05  RATE-STATE-CODE.
   121         10  RATE-ST-CODE        PIC XX      VALUE SPACES.
   122         10  RATE-ST-CLASS       PIC XX      VALUE SPACES.
   123         10  RATE-ST-DEV         PIC XXX     VALUE SPACES.
   124     05  RATE-L-AH-CODE.
   125         10  RATE-L-AH           PIC X       VALUE SPACE.
   126         10  RATE-LAH-NUM        PIC XX      VALUE ZEROS.
   127     05  RATE-LIMITS.
   128         10  RATE-HIGH-AGE       PIC 99      VALUE ZEROS.
   129         10  RATE-HIGH-AMT       PIC 9(6)    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* ELVADS.cbl
   130         10  RATE-FUTURE         PIC XX      VALUE SPACES.
   131         10  RATE-SEX            PIC X       VALUE '9'.
   132     05  RATE-EXPIRY-DATE        PIC 9(11)   COMP-3.
   133 01  SAVE-ERRATE-KEY.
   134     05  SVRT-COMPANY-CD         PIC X       VALUE SPACE.
   135     05  SVRT-STATE-CODE.
   136         10  SVRT-ST-CODE        PIC XX      VALUE SPACES.
   137         10  SVRT-ST-CLASS       PIC XX      VALUE SPACES.
   138         10  SVRT-ST-DEV         PIC XXX     VALUE SPACES.
   139     05  SVRT-L-AH-CODE.
   140         10  SVRT-L-AH           PIC X       VALUE SPACE.
   141         10  SVRT-LAH-NUM        PIC XX      VALUE ZEROS.
   142     05  SVRT-LIMITS.
   143         10  SVRT-HIGH-AGE       PIC 99      VALUE ZEROS.
   144         10  SVRT-HIGH-AMT       PIC 9(6)    VALUE ZEROS.
   145         10  SVRT-FUTURE         PIC XX      VALUE SPACES.
   146         10  SVRT-SEX            PIC X       VALUE '9'.
   147     05  SVRT-EXPIRY-DATE        PIC 9(11)   COMP-3.
   148*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   149*                         COPY ELCZREC.
   150******************************************************************
   151*                                                                *
   152*                                                                *
   153*                            ELCZREC.                            *
   154*                                                                *
   155*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   156*                                                                *
   157******************************************************************
   158*-----------------------------------------------------------------
   159*                   C H A N G E   L O G
   160*
   161* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   162*-----------------------------------------------------------------
   163*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   164* EFFECTIVE    NUMBER
   165*-----------------------------------------------------------------
   166* 122011    2011022800001  AJRA  NEW FILE
   167* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   168*-----------------------------------------------------------------
   169 01  W-Z-CONTROL-DATA.
   170     05  W-NUMBER-OF-COPIES      PIC  9.
   171     05  FILLER                  PIC  X.
   172     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   173     05  FILLER                  PIC  X.
   174     05  W-DAYS-TO-RESEND        PIC  999.
   175     05  FILLER                  PIC  X.
   176     05  W-FORM-TO-RESEND        PIC  X(4).
   177     05  FILLER                  PIC  X.
   178     05  W-PROMPT-LETTER         PIC  X.
   179     05  FILLER                  PIC  X.
   180     05  W-ENCLOSURE-CD          PIC  XXX.
   181     05  FILLER                  PIC  X.
   182     05  W-AUTO-CLOSE-IND        PIC  X.
   183     05  FILLER                  PIC  X.
   184     05  W-LETTER-TO-BENE        PIC  X.
   185     05  FILLER                  PIC  X.
   186     05  W-LETTER-TO-ACCT        PIC  X.
   187     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* ELVADS.cbl
   188     05  W-LETTER-TYPE           PIC  X.
   189     05  FILLER                  PIC  X.
   190     05  W-PRINT-CERTIFICATE     PIC  X.
   191     05  FILLER                  PIC  X.
   192     05  W-REFUND-REQUIRED       PIC  X.
   193     05  FILLER                  PIC  X.
   194     05  W-ONBASE-CODE           PIC  XX.
   195     05  FILLER                  PIC  X.
   196     05  W-ACCT-SUMM             PIC  X.
   197     05  FILLER                  PIC  X.
   198     05  W-CSO-SUMM              PIC  X.
   199     05  FILLER                  PIC  X(31).
   200
   201 01  WS-ELLETR-KEY.
   202     05  WS-ELLETR-COMPANY-CD    PIC X.
   203     05  WS-ELLETR-LETTER-ID     PIC X(12).
   204     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   205 01  WS-ELCNTL-KEY.
   206     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   207     05  WS-ELCNTL-REC-TYPE      PIC X.
   208     05  WS-ELCNTL-GENL.
   209         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   210         10  WS-ELCNTL-BEN-CD.
   211             15  F               PIC X.
   212             15  WS-ELCNTL-CARR  PIC X.
   213     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   214 01  WS-ELENCC-KEY.
   215     05  WS-ELENCC-COMPANY-CD    PIC X.
   216     05  WS-ELENCC-REC-TYPE      PIC X.
   217     05  WS-ELENCC-ENC-CODE      PIC X(5).
   218     05  F                       PIC X(9).
   219
   220 01  WORK-AREA.
   221     05  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   222     05  PGM-NAME                PIC X(8).
   223     05  WS-RESPONSE             PIC S9(8)   COMP.
   224         88  RESP-NORMAL                  VALUE +00.
   225         88  RESP-NOTFND                  VALUE +13.
   226         88  RESP-DUPREC                  VALUE +14.
   227         88  RESP-DUPKEY                  VALUE +15.
   228         88  RESP-NOTOPEN                 VALUE +19.
   229         88  RESP-ENDFILE                 VALUE +20.
   230     05  WS-COMPANY-CD           PIC X  VALUE LOW-VALUES.
   231     05  WS-ARCHIVE-NO           PIC S9(8)  COMP VALUE +0.
   232     05  WS-FOLLOW-UP-DT         PIC XX  VALUE LOW-VALUES.
   233     05  WS-RESEND-DT            PIC XX  VALUE LOW-VALUES.
   234     05  WS-AUTO-LAST-SCHED-DT   PIC XX  VALUE LOW-VALUES.
   235     05  WS-LAST-ACT-DT          PIC XX  VALUE LOW-VALUES.
   236     05  WS-ACTIVITY-DT          PIC XX  VALUE LOW-VALUES.
   237     05  WS-FORM                 PIC XXXX  VALUE SPACES.
   238     05  WS-MESSAGE              PIC X(50) VALUE SPACES.
   239
   240 01  VAPRINT-LINE.
   241     05  VA-LETTER               PIC X(06) VALUE SPACES.
   242     05  VA-PROC-ID              PIC X(04) VALUE SPACES.
   243     05  VA-PROC-NAME            PIC X(30) VALUE SPACES.
   244     05  VA-PROC-TITLE           PIC X(30) VALUE SPACES.
   245     05  VA-CSR-CODE             PIC X(4) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* ELVADS.cbl
   246     05  VA-CSR-NAME             PIC X(30) VALUE SPACES.
   247     05  VA-CSR-TITLE            PIC X(30) VALUE SPACES.
   248     05  VA-CARRIER              PIC X(01) VALUE SPACES.
   249     05  VA-GROUPING             PIC X(06) VALUE SPACES.
   250     05  VA-STATE                PIC X(02) VALUE SPACES.
   251     05  VA-ACCOUNT              PIC X(10) VALUE SPACES.
   252     05  VA-EFFDATE              PIC X(10) VALUE SPACES.
   253     05  VA-CERT-NO              PIC X(11) VALUE SPACES.
   254     05  VA-FIRSTNAME            PIC X(10) VALUE SPACES.
   255     05  VA-MIDINIT              PIC X(1) VALUE SPACES.
   256     05  VA-LASTNAME             PIC X(15) VALUE SPACES.
   257     05  VA-ADDR1                PIC X(30) VALUE SPACES.
   258     05  VA-ADDR2                PIC X(30) VALUE SPACES.
   259     05  VA-ADDR-CITY            PIC X(28) VALUE SPACES.
   260     05  VA-ADDR-ST              PIC X(2) VALUE SPACES.
   261     05  VA-ADDR-ZIP             PIC X(9) VALUE SPACES.
   262     05  VA-JNT-FIRSTNAME        PIC X(10) VALUE SPACES.
   263     05  VA-JNT-MIDINIT          PIC X(1) VALUE SPACES.
   264     05  VA-JNT-LASTNAME         PIC X(15) VALUE SPACES.
   265     05  VA-ARCH-NO              PIC 9(9) VALUE ZEROS.
   266     05  VA-ENC-LINE             PIC X(50) VALUE SPACES.
   267     05  VA-ATTACH               PIC X(50) VALUE SPACES.
   268     05  VA-STACK                PIC X(10) VALUE SPACES.
   269     05  VA-PRINT-NOW            PIC X(01) VALUE SPACES.
   270     05  VA-BORROWER             PIC X(30) VALUE SPACES.
   271     05  VA-BENE                 PIC X(30) VALUE SPACES.
   272     05  VA-ACCT-NAME            PIC X(30) VALUE SPACES.
   273     05  VA-SL                   PIC X VALUE SPACES.
   274     05  VA-JL                   PIC X VALUE SPACES.
   275     05  VA-SA                   PIC X VALUE SPACES.
   276     05  VA-JA                   PIC X VALUE SPACES.
   277     05  VA-GD                   PIC X VALUE SPACES.
   278     05  VA-NP                   PIC X VALUE SPACES.
   279     05  VA-7R                   PIC X VALUE SPACES.
   280     05  VA-LL                   PIC X VALUE SPACES.
   281     05  VA-TN                   PIC X VALUE SPACES.
   282     05  VA-14R                  PIC X VALUE SPACES.
   283     05  VA-14E                  PIC X VALUE SPACES.
   284     05  VA-30R                  PIC X VALUE SPACES.
   285     05  VA-30E                  PIC X VALUE SPACES.
   286     05  VA-CL-NET-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   287     05  VA-CL-GRS-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   288     05  VA-CL-LEV-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   289     05  VA-CL-NET-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   290     05  VA-CL-GRS-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   291     05  VA-CL-LEV-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   292     05  VA-CL-NET-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   293     05  VA-CL-GRS-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   294     05  VA-CL-LEV-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   295     05  VA-CD-NET-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   296     05  VA-CD-GRS-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   297     05  VA-CD-LEV-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   298     05  VA-CD-NET-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   299     05  VA-CD-GRS-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   300     05  VA-CD-LEV-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   301     05  VA-CD-NET-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   302     05  VA-CD-GRS-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   303     05  VA-CD-LEV-PRM           PIC 9(5).99  BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* ELVADS.cbl
   304     05  VA-CLD-NET-AMT          PIC 9(7).99 BLANK WHEN ZERO.
   305     05  VA-CLD-GRS-AMT          PIC 9(7).99 BLANK WHEN ZERO.
   306     05  VA-CLD-LEV-AMT          PIC 9(7).99 BLANK WHEN ZERO.
   307     05  VA-CLD-NET-PMT          PIC 9(5).99  BLANK WHEN ZERO.
   308     05  VA-CLD-GRS-PMT          PIC 9(5).99  BLANK WHEN ZERO.
   309     05  VA-CLD-LEV-PMT          PIC 9(5).99  BLANK WHEN ZERO.
   310     05  VA-CLD-NET-PRM          PIC 9(5).99  BLANK WHEN ZERO.
   311     05  VA-CLD-GRS-PRM          PIC 9(5).99  BLANK WHEN ZERO.
   312     05  VA-CLD-LEV-PRM          PIC 9(5).99  BLANK WHEN ZERO.
   313     05  VA-NO-NET-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   314     05  VA-NO-GRS-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   315     05  VA-NO-LEV-AMT           PIC 9(7).99 BLANK WHEN ZERO.
   316     05  VA-NO-NET-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   317     05  VA-NO-GRS-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   318     05  VA-NO-LEV-PMT           PIC 9(5).99  BLANK WHEN ZERO.
   319     05  VA-NO-NET-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   320     05  VA-NO-GRS-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   321     05  VA-NO-LEV-PRM           PIC 9(5).99  BLANK WHEN ZERO.
   322*                                COPY ERCRATE.
   323******************************************************************
   324*                                                                *
   325*                                                                *
   326*                            ERCRATE                             *
   327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   328*                            VMOD=2.008                          *
   329*                                                                *
   330*   ONLINE CREDIT SYSTEM                                         *
   331*                                                                *
   332*   FILE DESCRIPTION = RATES MASTER FILE                         *
   333*                                                                *
   334*   FILE TYPE = VSAM,KSDS                                        *
   335*   RECORD SIZE = 1765  RECFORM = FIXED                          *
   336*                                                                *
   337*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
   338*       ALTERNATE PATH = NONE                                    *
   339*                                                                *
   340*   LOG = NO                                                     *
   341*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   342*                                                                *
   343******************************************************************
   344
   345 01  RATE-RECORD.
   346     12  RT-RECORD-ID                      PIC XX.
   347         88  VALID-RT-ID                      VALUE 'RT'.
   348
   349     12  RT-CONTROL-PRIMARY.
   350         16  RT-COMPANY-CD                 PIC X.
   351         16  RT-STATE-CODE.
   352             20  RT-ST-CODE                PIC XX.
   353             20  RT-ST-CLASS               PIC XX.
   354             20  RT-ST-DEV                 PIC XXX.
   355         16  RT-L-AH-CODE.
   356             20  RT-L-AH                   PIC X.
   357             20  RT-LAH-NUM                PIC XX.
   358         16  RT-LIMITS.
   359             20  RT-HIGH-AGE               PIC 99.
   360             20  RT-HIGH-AMT               PIC 9(6).
   361             20  RT-FUTURE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* ELVADS.cbl
   362             20  RT-SEX                    PIC X.
   363         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
   364
   365     12  RT-MAINT-INFORMATION.
   366         16  RT-LAST-MAINT-DT              PIC XX.
   367         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   368         16  RT-LAST-MAINT-USER            PIC X(4).
   369         16  FILLER                        PIC X(10).
   370
   371     12  RT-STRUCTURE-COMMENT              PIC X(50).
   372     12  RT-RATE-COMMENT                   PIC X(50).
   373
   374     12  CSL-RESERVED                      PIC X(10).
   375     12  FILLER                            PIC X(12).
   376
   377     12  RT-MAX-AGE                        PIC 99.
   378
   379     12  RT-LIFE-LIMS-FLDS.
   380         16  RT-LIFE-MORT-CODE             PIC X(4).
   381         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
   382             20  RT-L-EX-AGE               PIC 99.
   383             20  RT-L-EX-TERM              PIC S999       COMP-3.
   384             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
   385         16  FILLER                        PIC X(20).
   386
   387     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
   388         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
   389             20  RT-AH-AGE                 PIC 99.
   390             20  RT-AH-TERM                PIC S999       COMP-3.
   391             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
   392             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
   393
   394     12  RT-LIFE-RATES.
   395         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
   396
   397     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
   398         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
   399
   400     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
   401
   402     12  RT-DISCOUNT-OPTION                PIC X.
   403         88  RT-DO-NOT-USE                     VALUE ' '.
   404         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
   405         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
   406
   407     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
   408     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
   409
   410     12  RT-COMPOSITE-OPTION               PIC X.
   411         88  RT-NO-COMPOSITE                   VALUE ' '.
   412         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
   413
   414     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
   415
   416     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
   417     12  FILLER                            PIC X(13).
   418
   419     12  RT-TYPE-RATE                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* ELVADS.cbl
   420         88  RT-IS-STND                        VALUE ' ' 'S'.
   421         88  RT-IS-OB                          VALUE 'O'.
   422
   423     12  RT-SRT-ALPHA                      PIC X.
   424
   425     12  RT-CONTROL-2.
   426         16  RTC-1                         PIC X(7).
   427         16  RTC-3                         PIC X(11).
   428         16  RTC-4                         PIC 9(11) COMP-3.
   429         16  RTC-2                         PIC X(3).
   430******************************************************************
   431*                                COPY ELCVADS.
   432******************************************************************
   433*                                                                *
   434*                                                                *
   435*                            ELCVADS.                            *
   436*                                                                *
   437*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   438*   ELVADS                  LENGTH = 350                         *
   439******************************************************************
   440******************************************************************
   441*                   C H A N G E   L O G
   442*
   443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   444*-----------------------------------------------------------------
   445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   446* EFFECTIVE    NUMBER
   447*-----------------------------------------------------------------
   448* 100111    2011022800001  AJRA  NAPERSOFT
   449******************************************************************
   450
   451 01  VIRGINIA-DISCLOSURE.
   452     12  VD-COMPANY-CD              PIC X.
   453     12  VD-CARRIER                 PIC X.
   454     12  VD-GROUPING.
   455         20  VD-GROUPING-PREFIX     PIC XXX.
   456         20  VD-GROUPING-PRIME      PIC XXX.
   457     12  VD-STATE                   PIC XX.
   458     12  VD-ACCOUNT.
   459         20  VD-ACCOUNT-PREFIX      PIC X(4).
   460         20  VD-ACCOUNT-PRIME       PIC X(6).
   461     12  VD-CERT-EFF-DT             PIC XX.
   462     12  VD-CERT-NO.
   463         20  VD-CERT-PRIME          PIC X(10).
   464         20  VD-CERT-SFX            PIC X.
   465     12  VD-ENTRY-BATCH             PIC X(6).
   466     12  VD-CSR-ID                  PIC X(4).
   467     12  VD-NAME.
   468         20  VD-INSURED-LAST-NAME   PIC X(15).
   469         20  VD-INSURED-FIRST-NAME.
   470             24  VD-INSURED-1ST-INIT PIC X.
   471             24  FILLER             PIC X(9).
   472         20  VD-INSURED-MIDDLE-INIT PIC X.
   473     12  VD-JOINT-INSURED.
   474         20 VD-JOINT-LAST-NAME      PIC X(15).
   475         20 VD-JOINT-FIRST-NAME.
   476            24  VD-JOINT-FIRST-INIT PIC X.
   477            24  FILLER              PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* ELVADS.cbl
   478         20 VD-JOINT-MIDDLE-INIT    PIC X.
   479     12  VD-INSURED-ADDRESS-1       PIC X(30).
   480     12  VD-INSURED-ADDRESS-2       PIC X(30).
   481     12  VD-INSURED-CITY-STATE.
   482         20  VD-INSURED-CITY        PIC X(28).
   483         20  VD-INSURED-STATE       PIC XX.
   484     12  VD-INSURED-ZIP-CODE.
   485         20  VD-INSURED-ZIP-PRIME.
   486             24  VD-INSURED-ZIP-1   PIC X.
   487                 88  VD-CANADIAN-POST-CODE
   488                                       VALUE 'A' THRU 'Z'.
   489             24  FILLER             PIC X(4).
   490         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   491     12  VD-BENEFICIARY-NAME        PIC X(30).
   492     12  VD-ACCOUNT-NAME            PIC X(30).
   493     12  VD-LOAN-TERM               PIC S999   COMP-3.
   494     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   495     12  VD-1ST-PMT-DT              PIC XX.
   496     12  VD-LIFE-BENEFIT-CD         PIC XX.
   497         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   498         88  VD-INVALID-LIFE           VALUE '  ' '00'
   499                                             '90' THRU '99'.
   500     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   501                                    PIC XX.
   502     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   503     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   504     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   505     12  VD-LF-TERM                 PIC S999   COMP-3.
   506     12  VD-AH-BENEFIT-CD           PIC XX.
   507         88  VD-VALID-AH               VALUE '01' THRU '89'.
   508         88  VD-INVALID-AH             VALUE '  ' '00'
   509                                             '90' THRU '99'.
   510     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   511     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   512     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   513     12  VD-AH-TERM                 PIC S999   COMP-3.
   514     12  VD-LETTER-ID               PIC X(4).
   515     12  VD-PROC-ID                 PIC X(4).
   516     12  VD-COMP-ID                 PIC X(3).
   517     12  VD-CURRENT-DATE            PIC XX.
   518     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   519     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   520     12  FILLER                     PIC X(32).
   521*                                COPY ELCDATE.
   522******************************************************************
   523*                                                                *
   524*                                                                *
   525*                            ELCDATE.                            *
   526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   527*                            VMOD=2.003
   528*                                                                *
   529*                                                                *
   530*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   531*                 LENGTH = 200                                   *
   532******************************************************************
   533
   534 01  DATE-CONVERSION-DATA.
   535     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* ELVADS.cbl
   536     12  DC-OPTION-CODE                PIC X.
   537         88  BIN-TO-GREG                VALUE ' '.
   538         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   539         88  EDIT-GREG-TO-BIN           VALUE '2'.
   540         88  YMD-GREG-TO-BIN            VALUE '3'.
   541         88  MDY-GREG-TO-BIN            VALUE '4'.
   542         88  JULIAN-TO-BIN              VALUE '5'.
   543         88  BIN-PLUS-ELAPSED           VALUE '6'.
   544         88  FIND-CENTURY               VALUE '7'.
   545         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   546         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   547         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   548         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   549         88  JULIAN-TO-BIN-3            VALUE 'C'.
   550         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   551         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   552         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   553         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   554         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   555         88  CHECK-LEAP-YEAR            VALUE 'H'.
   556         88  BIN-3-TO-GREG              VALUE 'I'.
   557         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   558         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   559         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   560         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   561         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   562         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   563         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   564         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   565         88  THREE-CHARACTER-BIN
   566                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   567         88  GREGORIAN-TO-BIN
   568                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   569         88  BIN-TO-GREGORIAN
   570                  VALUES ' ' '1' 'I' '8' 'G'.
   571         88  JULIAN-TO-BINARY
   572                  VALUES '5' 'C' 'E' 'F'.
   573     12  DC-ERROR-CODE                 PIC X.
   574         88  NO-CONVERSION-ERROR        VALUE ' '.
   575         88  DATE-CONVERSION-ERROR
   576                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   577         88  DATE-IS-ZERO               VALUE '1'.
   578         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   579         88  DATE-IS-INVALID            VALUE '3'.
   580         88  DATE1-GREATER-DATE2        VALUE '4'.
   581         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   582         88  DATE-INVALID-OPTION        VALUE '9'.
   583         88  INVALID-CENTURY            VALUE 'A'.
   584         88  ONLY-CENTURY               VALUE 'B'.
   585         88  ONLY-LEAP-YEAR             VALUE 'C'.
   586         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   587     12  DC-END-OF-MONTH               PIC X.
   588         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   589     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   590         88  USE-NORMAL-PROCESS         VALUE ' '.
   591         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   592         88  ADJUST-UP-100-YRS          VALUE '2'.
   593     12  FILLER                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* ELVADS.cbl
   594     12  DC-CONVERSION-DATES.
   595         16  DC-BIN-DATE-1             PIC XX.
   596         16  DC-BIN-DATE-2             PIC XX.
   597         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   598         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   599                       DC-GREG-DATE-1-EDIT.
   600             20  DC-EDIT1-MONTH        PIC 99.
   601             20  SLASH1-1              PIC X.
   602             20  DC-EDIT1-DAY          PIC 99.
   603             20  SLASH1-2              PIC X.
   604             20  DC-EDIT1-YEAR         PIC 99.
   605         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   606         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   607                     DC-GREG-DATE-2-EDIT.
   608             20  DC-EDIT2-MONTH        PIC 99.
   609             20  SLASH2-1              PIC X.
   610             20  DC-EDIT2-DAY          PIC 99.
   611             20  SLASH2-2              PIC X.
   612             20  DC-EDIT2-YEAR         PIC 99.
   613         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   614         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   615                     DC-GREG-DATE-1-YMD.
   616             20  DC-YMD-YEAR           PIC 99.
   617             20  DC-YMD-MONTH          PIC 99.
   618             20  DC-YMD-DAY            PIC 99.
   619         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   620         16  DC-GREG-DATE-1-MDY-R REDEFINES
   621                      DC-GREG-DATE-1-MDY.
   622             20  DC-MDY-MONTH          PIC 99.
   623             20  DC-MDY-DAY            PIC 99.
   624             20  DC-MDY-YEAR           PIC 99.
   625         16  DC-GREG-DATE-1-ALPHA.
   626             20  DC-ALPHA-MONTH        PIC X(10).
   627             20  DC-ALPHA-DAY          PIC 99.
   628             20  FILLER                PIC XX.
   629             20  DC-ALPHA-CENTURY.
   630                 24 DC-ALPHA-CEN-N     PIC 99.
   631             20  DC-ALPHA-YEAR         PIC 99.
   632         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   633         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   634         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   635         16  DC-JULIAN-DATE            PIC 9(05).
   636         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   637                                       PIC 9(05).
   638         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   639             20  DC-JULIAN-YEAR        PIC 99.
   640             20  DC-JULIAN-DAYS        PIC 999.
   641         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   642         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   643         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   644     12  DATE-CONVERSION-VARIBLES.
   645         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   646         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   647             20  FILLER                PIC 9(3).
   648             20  HOLD-CEN-1-CCYY.
   649                 24  HOLD-CEN-1-CC     PIC 99.
   650                 24  HOLD-CEN-1-YY     PIC 99.
   651             20  HOLD-CEN-1-MO         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* ELVADS.cbl
   652             20  HOLD-CEN-1-DA         PIC 99.
   653         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   654             20  HOLD-CEN-1-R-MO       PIC 99.
   655             20  HOLD-CEN-1-R-DA       PIC 99.
   656             20  HOLD-CEN-1-R-CCYY.
   657                 24  HOLD-CEN-1-R-CC   PIC 99.
   658                 24  HOLD-CEN-1-R-YY   PIC 99.
   659             20  FILLER                PIC 9(3).
   660         16  HOLD-CENTURY-1-X.
   661             20  FILLER                PIC X(3)  VALUE SPACES.
   662             20  HOLD-CEN-1-X-CCYY.
   663                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   664                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   665             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   666             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   667         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   668             20  HOLD-CEN-1-R-X-MO     PIC XX.
   669             20  HOLD-CEN-1-R-X-DA     PIC XX.
   670             20  HOLD-CEN-1-R-X-CCYY.
   671                 24  HOLD-CEN-1-R-X-CC PIC XX.
   672                 24  HOLD-CEN-1-R-X-YY PIC XX.
   673             20  FILLER                PIC XXX.
   674         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   675         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   676         16  DC-JULIAN-DATE-1          PIC 9(07).
   677         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   678             20  DC-JULIAN-1-CCYY.
   679                 24  DC-JULIAN-1-CC    PIC 99.
   680                 24  DC-JULIAN-1-YR    PIC 99.
   681             20  DC-JULIAN-DA-1        PIC 999.
   682         16  DC-JULIAN-DATE-2          PIC 9(07).
   683         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   684             20  DC-JULIAN-2-CCYY.
   685                 24  DC-JULIAN-2-CC    PIC 99.
   686                 24  DC-JULIAN-2-YR    PIC 99.
   687             20  DC-JULIAN-DA-2        PIC 999.
   688         16  DC-GREG-DATE-A-EDIT.
   689             20  DC-EDITA-MONTH        PIC 99.
   690             20  SLASHA-1              PIC X VALUE '/'.
   691             20  DC-EDITA-DAY          PIC 99.
   692             20  SLASHA-2              PIC X VALUE '/'.
   693             20  DC-EDITA-CCYY.
   694                 24  DC-EDITA-CENT     PIC 99.
   695                 24  DC-EDITA-YEAR     PIC 99.
   696         16  DC-GREG-DATE-B-EDIT.
   697             20  DC-EDITB-MONTH        PIC 99.
   698             20  SLASHB-1              PIC X VALUE '/'.
   699             20  DC-EDITB-DAY          PIC 99.
   700             20  SLASHB-2              PIC X VALUE '/'.
   701             20  DC-EDITB-CCYY.
   702                 24  DC-EDITB-CENT     PIC 99.
   703                 24  DC-EDITB-YEAR     PIC 99.
   704         16  DC-GREG-DATE-CYMD         PIC 9(08).
   705         16  DC-GREG-DATE-CYMD-R REDEFINES
   706                              DC-GREG-DATE-CYMD.
   707             20  DC-CYMD-CEN           PIC 99.
   708             20  DC-CYMD-YEAR          PIC 99.
   709             20  DC-CYMD-MONTH         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* ELVADS.cbl
   710             20  DC-CYMD-DAY           PIC 99.
   711         16  DC-GREG-DATE-MDCY         PIC 9(08).
   712         16  DC-GREG-DATE-MDCY-R REDEFINES
   713                              DC-GREG-DATE-MDCY.
   714             20  DC-MDCY-MONTH         PIC 99.
   715             20  DC-MDCY-DAY           PIC 99.
   716             20  DC-MDCY-CEN           PIC 99.
   717             20  DC-MDCY-YEAR          PIC 99.
   718    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   719        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   720    12  DC-EL310-DATE                  PIC X(21).
   721    12  FILLER                         PIC X(28).
   722*                                COPY ELCTEXT.
   723******************************************************************
   724*                                                                *
   725*                                                                *
   726*                            ELCTEXT.                            *
   727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   728*                            VMOD=2.008                          *
   729*                                                                *
   730*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   731*                                     FORM LETTERS,              *
   732*                                     CERT FORM DISPLAY.
   733*                                                                *
   734*   FILE TYPE = VSAM,KSDS                                        *
   735*   RECORD SIZE = 100   RECFORM = FIXED                          *
   736*                                                                *
   737*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   738*       ALTERNATE INDEX = NONE                                   *
   739*                                                                *
   740*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   741*       ALTERNATE INDEX = NONE                                   *
   742*                                                                *
   743*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   744*       ALTERNATE INDEX = NONE                                   *
   745*                                                                *
   746*   LOG = NO                                                     *
   747*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   748******************************************************************
   749 01  TEXT-FILES.
   750     12  TEXT-FILE-ID                PIC XX.
   751         88  FORMS-FILE-TEXT            VALUE 'TF'.
   752         88  LETTER-FILE-TEXT           VALUE 'TL'.
   753         88  HELP-FILE-TEXT             VALUE 'TH'.
   754
   755     12  TX-CONTROL-PRIMARY.
   756         16  TX-COMPANY-CD           PIC X.
   757             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   758         16  TX-ACCESS-CD-GENL       PIC X(12).
   759
   760         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   761             20  TX-LETTER-NO        PIC X(4).
   762             20  FILLER              PIC X(8).
   763
   764         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   765             20  TX-FORM-NO          PIC X(12).
   766
   767         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* ELVADS.cbl
   768             20  TX-HELP-TYPE        PIC X.
   769                 88  HELP-FOR-GENERAL   VALUE ' '.
   770                 88  HELP-BY-SCREEN     VALUE 'S'.
   771                 88  HELP-BY-ERROR      VALUE 'E'.
   772             20  TX-SCREEN-OR-ERROR  PIC X(4).
   773                 88  GENERAL-INFO-HELP  VALUE '0000'.
   774             20  TX-HELP-FOR-COMPANY  PIC XXX.
   775                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   776             20  FILLER              PIC X(4).
   777
   778         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   779
   780     12  TX-PROCESS-CONTROL          PIC XX.
   781         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   782
   783     12  TX-TEXT-LINE                PIC X(70).
   784
   785     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   786         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   787         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   788         88  TX-VALID-FORM-SQUEEZE-VALUE
   789                                        VALUE 'Y' ' '.
   790
   791     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   792         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   793         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   794         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   795         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   796         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   797         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   798         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   799                                              'K' 'N' ' '
   800                                              'Z'.
   801
   802     12  TX-ARCHIVE-SW               PIC X.
   803         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   804         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   805         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   806
   807     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   808     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   809
   810     12  TX-BSR-CODE                 PIC X.
   811         88  TX-BSR-LETTER              VALUE 'B'.
   812         88  TX-NON-BSR-LETTER          VALUE ' '.
   813
   814     12  FILLER                      PIC X.
   815*****************************************************************
   816*                                COPY ELCCNTL.
   817******************************************************************
   818*                                                                *
   819*                                                                *
   820*                            ELCCNTL.                            *
   821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   822*                            VMOD=2.059                          *
   823*                                                                *
   824*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   825*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* ELVADS.cbl
   826*   FILE TYPE = VSAM,KSDS                                        *
   827*   RECORD SIZE = 750  RECFORM = FIXED                           *
   828*                                                                *
   829*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   830*       ALTERNATE INDEX = NONE                                   *
   831*                                                                *
   832*   LOG = YES                                                    *
   833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   834******************************************************************
   835*                   C H A N G E   L O G
   836*
   837* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   838*-----------------------------------------------------------------
   839*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   840* EFFECTIVE    NUMBER
   841*-----------------------------------------------------------------
   842* 082503                   PEMA  ADD BENEFIT GROUP
   843* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   844* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   845* 092705    2005050300006  PEMA  ADD SPP LEASES
   846* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   847* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   848* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   849* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   850* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   851* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   852******************************************************************
   853*
   854 01  CONTROL-FILE.
   855     12  CF-RECORD-ID                       PIC XX.
   856         88  VALID-CF-ID                        VALUE 'CF'.
   857
   858     12  CF-CONTROL-PRIMARY.
   859         16  CF-COMPANY-ID                  PIC XXX.
   860         16  CF-RECORD-TYPE                 PIC X.
   861             88  CF-COMPANY-MASTER              VALUE '1'.
   862             88  CF-PROCESSOR-MASTER            VALUE '2'.
   863             88  CF-STATE-MASTER                VALUE '3'.
   864             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   865             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   866             88  CF-CARRIER-MASTER              VALUE '6'.
   867             88  CF-MORTALITY-MASTER            VALUE '7'.
   868             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   869             88  CF-TERMINAL-MASTER             VALUE '9'.
   870             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   871             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   872             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   873             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   874             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   875             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   876             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   877             88  CF-REMINDERS-MASTER            VALUE 'R'.
   878             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   879         16  CF-ACCESS-CD-GENL              PIC X(4).
   880         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   881             20  CF-PROCESSOR               PIC X(4).
   882         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   883             20  CF-STATE-CODE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* ELVADS.cbl
   884             20  FILLER                     PIC XX.
   885         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   886             20  FILLER                     PIC XX.
   887             20  CF-HI-BEN-IN-REC           PIC XX.
   888         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   889             20  FILLER                     PIC XXX.
   890             20  CF-CARRIER-CNTL            PIC X.
   891         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   892             20  FILLER                     PIC XX.
   893             20  CF-HI-TYPE-IN-REC          PIC 99.
   894         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   895             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   896                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   897             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   898             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   899         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   900             20  FILLER                     PIC X.
   901             20  CF-CUSTOM-REPORT-NO        PIC 999.
   902         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   903             20  FILLER                     PIC XX.
   904             20  CF-MORTGAGE-PLAN           PIC XX.
   905         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   906
   907     12  CF-LAST-MAINT-DT                   PIC XX.
   908     12  CF-LAST-MAINT-BY                   PIC X(4).
   909     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   910
   911     12  CF-RECORD-BODY                     PIC X(728).
   912
   913
   914****************************************************************
   915*             COMPANY MASTER RECORD                            *
   916****************************************************************
   917
   918     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   919         16  CF-COMPANY-ADDRESS.
   920             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   921             20  CF-CL-IN-CARE-OF           PIC X(30).
   922             20  CF-CL-ADDR-LINE-1          PIC X(30).
   923             20  CF-CL-ADDR-LINE-2          PIC X(30).
   924             20  CF-CL-CITY-STATE           PIC X(30).
   925             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   926             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   927         16  CF-COMPANY-CD                  PIC X.
   928         16  CF-COMPANY-PASSWORD            PIC X(8).
   929         16  CF-SECURITY-OPTION             PIC X.
   930             88  ALL-SECURITY                   VALUE '1'.
   931             88  COMPANY-VERIFY                 VALUE '2'.
   932             88  PROCESSOR-VERIFY               VALUE '3'.
   933             88  NO-SECURITY                    VALUE '4'.
   934             88  ALL-BUT-TERM                   VALUE '5'.
   935         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   936             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   937         16  CF-LGX-INTERFACE-CNTL          PIC X.
   938             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   939         16  CF-INFORCE-LOCATION            PIC X.
   940             88  CERTS-ARE-ONLINE               VALUE '1'.
   941             88  CERTS-ARE-OFFLINE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* ELVADS.cbl
   942             88  NO-CERTS-AVAILABLE             VALUE '3'.
   943         16  CF-LOWER-CASE-LETTERS          PIC X.
   944         16  CF-CERT-ACCESS-CONTROL         PIC X.
   945             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   946             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   947             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   948             88  CF-ACCNT-CNTL                  VALUE '3'.
   949             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   950
   951         16  CF-FORMS-PRINTER-ID            PIC X(4).
   952         16  CF-CHECK-PRINTER-ID            PIC X(4).
   953
   954         16  CF-LGX-CREDIT-USER             PIC X.
   955             88  CO-IS-NOT-USER                 VALUE 'N'.
   956             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   957
   958         16 CF-CREDIT-CALC-CODES.
   959             20  CF-CR-REM-TERM-CALC PIC X.
   960               88  CR-EARN-AFTER-15TH           VALUE '1'.
   961               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   962               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   963               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   964               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   965               88  CR-EARN-AFTER-14TH           VALUE '6'.
   966               88  CR-EARN-AFTER-16TH           VALUE '7'.
   967             20  CF-CR-R78-METHOD           PIC X.
   968               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   969               88  DONT-USE-PLUS-ONE            VALUE '1'.
   970
   971         16  CF-CLAIM-CONTROL-COUNTS.
   972             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   973                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   974
   975             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   976                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   977
   978             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   979                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   980
   981             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   982                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   983
   984         16  CF-CURRENT-MONTH-END           PIC XX.
   985
   986         16  CF-CO-CALC-QUOTE-TOLERANCE.
   987             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   988             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   989             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   990             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   991                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   992                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   993             20  CF-CO-PREM-REJECT-SW       PIC X.
   994                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   995                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   996             20  CF-CO-REF-REJECT-SW        PIC X.
   997                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   998                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   999
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* ELVADS.cbl
  1000         16  CF-CO-REPORTING-DT             PIC XX.
  1001         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1002         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1003           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1004           88  CF-CO-MONTH-END                  VALUE '1'.
  1005
  1006         16  CF-LGX-CLAIM-USER              PIC X.
  1007             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1008             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1009
  1010         16  CF-CREDIT-EDIT-CONTROLS.
  1011             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1012             20  CF-MIN-AGE                 PIC 99.
  1013             20  CF-DEFAULT-AGE             PIC 99.
  1014             20  CF-MIN-TERM                PIC S999      COMP-3.
  1015             20  CF-MAX-TERM                PIC S999      COMP-3.
  1016             20  CF-DEFAULT-SEX             PIC X.
  1017             20  CF-JOINT-AGE-INPUT         PIC X.
  1018                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1019             20  CF-BIRTH-DATE-INPUT        PIC X.
  1020                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1021             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1022                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1023                 88  CF-ZERO-CARRIER            VALUE '1'.
  1024                 88  CF-ZERO-GROUPING           VALUE '2'.
  1025                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1026             20  CF-EDIT-SW                 PIC X.
  1027                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1028             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1029             20  CF-CR-PR-METHOD            PIC X.
  1030               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1031               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1032             20  FILLER                     PIC X.
  1033
  1034         16  CF-CREDIT-MISC-CONTROLS.
  1035             20  CF-REIN-TABLE-SW           PIC X.
  1036                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1037             20  CF-COMP-TABLE-SW           PIC X.
  1038                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1039             20  CF-EXPERIENCE-RETENTION-AGE
  1040                                            PIC S9        COMP-3.
  1041             20  CF-CONVERSION-DT           PIC XX.
  1042             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1043             20  CF-RUN-FREQUENCY-SW        PIC X.
  1044                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1045                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1046
  1047             20  CF-CR-CHECK-NO-CONTROL.
  1048                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1049                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1050                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1051                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1052                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1053                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1054
  1055                 24  CF-CR-CHECK-COUNT       REDEFINES
  1056                     CF-CR-CHECK-COUNTER      PIC X(4).
  1057
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* ELVADS.cbl
  1058                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1059                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1060
  1061                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1062                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1063                 24  CF-MAIL-PROCESSING       PIC X.
  1064                     88  MAIL-PROCESSING          VALUE 'Y'.
  1065
  1066         16  CF-MISC-SYSTEM-CONTROL.
  1067             20  CF-SYSTEM-C                 PIC X.
  1068                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1069             20  CF-SYSTEM-D                 PIC X.
  1070                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1071             20  CF-SOC-SEC-NO-SW            PIC X.
  1072                 88  SOC-SEC-NO-USED             VALUE '1'.
  1073             20  CF-MEMBER-NO-SW             PIC X.
  1074                 88  MEMBER-NO-USED              VALUE '1'.
  1075             20  CF-TAX-ID-NUMBER            PIC X(11).
  1076             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1077             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1078                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1079                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1080                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1081                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1082             20  CF-SYSTEM-E                 PIC X.
  1083                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1084
  1085         16  CF-LGX-LIFE-USER               PIC X.
  1086             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1087             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1088
  1089         16  CF-CR-MONTH-END-DT             PIC XX.
  1090
  1091         16  CF-FILE-MAINT-DATES.
  1092             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1093                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1094             20  CF-LAST-BATCH       REDEFINES
  1095                 CF-LAST-BATCH-NO               PIC X(4).
  1096             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1097             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1098             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1099             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1100             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1101             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1102             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1103             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1104             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1105             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1106
  1107         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1108         16  FILLER                         PIC X.
  1109
  1110         16  CF-ALT-MORT-CODE               PIC X(4).
  1111         16  CF-MEMBER-CAPTION              PIC X(10).
  1112
  1113         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1114             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1115             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* ELVADS.cbl
  1116             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1117             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1118             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1119
  1120         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1121
  1122         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1123         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1124         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1125         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1126
  1127         16  CF-AH-OVERRIDE-L1              PIC X.
  1128         16  CF-AH-OVERRIDE-L2              PIC XX.
  1129         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1130         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1131
  1132         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1133         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1134
  1135         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1136         16  CF-AR-LAST-EL860-DT            PIC XX.
  1137         16  CF-MP-MONTH-END-DT             PIC XX.
  1138
  1139         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1140         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1141             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1142
  1143         16  CF-AR-MONTH-END-DT             PIC XX.
  1144
  1145         16  CF-CRDTCRD-USER                PIC X.
  1146             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1147             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1148
  1149         16  CF-CC-MONTH-END-DT             PIC XX.
  1150
  1151         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1152
  1153         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1154             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1155             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1156             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1157         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1158         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1159         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1160         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1161             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1162             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1163         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1164         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1165         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1166             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1167         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1168
  1169         16  CF-CL-ZIP-CODE.
  1170             20  CF-CL-ZIP-PRIME.
  1171                 24  CF-CL-ZIP-1ST          PIC X.
  1172                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1173                 24  FILLER                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* ELVADS.cbl
  1174             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1175         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1176             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1177             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1178             20  FILLER                     PIC XXX.
  1179
  1180         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1181         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1182         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1183         16  CF-CO-OPTION-START-DATE        PIC XX.
  1184         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1185           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1186                                                      '3' '4'.
  1187           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1188           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1189           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1190           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1191           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1192           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1193
  1194         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1195
  1196         16  CF-PAYMENT-APPROVAL-LEVELS.
  1197             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1198             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1199             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1200             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1201             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1202             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1203
  1204         16  CF-END-USER-REPORTING-USER     PIC X.
  1205             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1206             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1207
  1208         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1209             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1210             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1211
  1212         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1213
  1214         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1215         16  FILLER                         PIC X.
  1216
  1217         16  CF-CREDIT-ARCHIVE-CNTL.
  1218             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1219             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1220             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1221
  1222         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1223
  1224         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1225             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1226             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1227
  1228         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1229             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1230             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1231
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* ELVADS.cbl
  1232         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1233
  1234         16  CF-CO-ACH-ID-CODE              PIC  X.
  1235             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1236             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1237             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1238         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1239         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1240         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1241         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1242         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1243         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1244         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1245         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1246         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1247                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1248         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1249                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1250
  1251         16  CF-CO-OVER-SHORT.
  1252             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1253             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1254
  1255*         16  FILLER                         PIC X(102).
  1256         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1257             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1258             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1259
  1260         16  CF-AH-APPROVAL-DAYS.
  1261             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1262             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1263             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1264             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1265
  1266         16  FILLER                         PIC X(82).
  1267****************************************************************
  1268*             PROCESSOR/USER RECORD                            *
  1269****************************************************************
  1270
  1271     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1272         16  CF-PROCESSOR-NAME              PIC X(30).
  1273         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1274         16  CF-PROCESSOR-TITLE             PIC X(26).
  1275         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1276                 88  MESSAGE-YES                VALUE 'Y'.
  1277                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1278
  1279*****************************************************
  1280****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1281****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1282****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1283****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1284*****************************************************
  1285
  1286         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1287             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1288             20  CF-APPLICATION-FORCE       PIC X.
  1289             20  CF-INDIVIDUAL-APP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* ELVADS.cbl
  1290                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1291                     28  CF-BROWSE-APP      PIC X.
  1292                     28  CF-UPDATE-APP      PIC X.
  1293
  1294         16  CF-CURRENT-TERM-ON             PIC X(4).
  1295         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1296             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1297             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1298             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1299             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1300             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1301             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1302             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1303         16  CF-PROCESSOR-CARRIER           PIC X.
  1304             88  NO-CARRIER-SECURITY            VALUE ' '.
  1305         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1306             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1307         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1308             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1309         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1310             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1311
  1312         16  CF-PROC-SYS-ACCESS-SW.
  1313             20  CF-PROC-CREDIT-CLAIMS-SW.
  1314                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1315                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1316                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1317                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1318             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1319                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1320                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1321             20  CF-PROC-LIFE-GNRLDGR-SW.
  1322                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1323                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1324                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1325                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1326             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1327                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1328                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1329         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1330             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1331             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1332         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1333
  1334         16  CF-APPROVAL-LEVEL                  PIC X.
  1335             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1336             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1337             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1338             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1339
  1340         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1341
  1342         16  CF-LANGUAGE-TYPE                   PIC X.
  1343             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1344             88  CF-LANG-IS-FR                      VALUE 'F'.
  1345
  1346         16  CF-CSR-IND                         PIC X.
  1347         16  FILLER                             PIC X(239).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* ELVADS.cbl
  1348
  1349****************************************************************
  1350*             PROCESSOR/REMINDERS RECORD                       *
  1351****************************************************************
  1352
  1353     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1354         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1355             20  CF-START-REMIND-DT         PIC XX.
  1356             20  CF-END-REMIND-DT           PIC XX.
  1357             20  CF-REMINDER-TEXT           PIC X(50).
  1358         16  FILLER                         PIC X(296).
  1359
  1360
  1361****************************************************************
  1362*             STATE MASTER RECORD                              *
  1363****************************************************************
  1364
  1365     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1366         16  CF-STATE-ABBREVIATION          PIC XX.
  1367         16  CF-STATE-NAME                  PIC X(25).
  1368         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1369         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1370             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1371             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1372             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1373             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1374                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1375                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1376             20  CF-ST-PREM-REJECT-SW       PIC X.
  1377                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1378                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1379             20  CF-ST-REF-REJECT-SW        PIC X.
  1380                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1381                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1382         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1383         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1384         16  CF-ST-REFUND-RULES.
  1385             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1386             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1387             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1388         16  CF-ST-FST-PMT-EXTENSION.
  1389             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1390             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1391                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1392                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1393                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1394                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1395         16  CF-ST-STATE-CALL.
  1396             20  CF-ST-CALL-UNEARNED        PIC X.
  1397             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1398             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1399         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1400             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1401             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1402         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1403         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1404         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1405         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* ELVADS.cbl
  1406         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1407         16  FILLER                         PIC X.
  1408         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1409             20  CF-ST-BENEFIT-CD           PIC XX.
  1410             20  CF-ST-BENEFIT-KIND         PIC X.
  1411                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1412                 88  CF-ST-AH-KIND              VALUE 'A'.
  1413             20  CF-ST-REM-TERM-CALC        PIC X.
  1414                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1415                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1416                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1417                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1418                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1419                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1420                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1421                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1422
  1423             20  CF-ST-REFUND-CALC          PIC X.
  1424                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1425                 88  ST-REFD-BY-R78             VALUE '1'.
  1426                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1427                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1428                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1429                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1430                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1431                 88  ST-REFD-UTAH               VALUE '7'.
  1432                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1433                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1434                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1435
  1436             20  CF-ST-EARNING-CALC         PIC X.
  1437                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1438                 88  ST-EARN-BY-R78             VALUE '1'.
  1439                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1440                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1441                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1442                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1443                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1444                 88  ST-EARN-MEAN               VALUE '8'.
  1445                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1446
  1447             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1448                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1449                 88  ST-OVRD-BY-R78             VALUE '1'.
  1450                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1451                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1452                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1453                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1454                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1455                 88  ST-OVRD-MEAN               VALUE '8'.
  1456                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1457             20  FILLER                     PIC X.
  1458
  1459         16  CF-ST-COMMISSION-CAPS.
  1460             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1461             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1462             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1463             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* ELVADS.cbl
  1464         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1465                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1466
  1467         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1468
  1469         16  CF-ST-STATUTORY-INTEREST.
  1470             20  CF-ST-STAT-DATE-FROM       PIC X.
  1471                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1472                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1473             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1474             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1475             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1476             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1477             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1478
  1479         16  CF-ST-OVER-SHORT.
  1480             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1481             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1482
  1483         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1484
  1485         16  CF-ST-RT-CALC                  PIC X.
  1486
  1487         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1488         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1489         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1490         16  CF-ST-RF-LR-CALC               PIC X.
  1491         16  CF-ST-RF-LL-CALC               PIC X.
  1492         16  CF-ST-RF-LN-CALC               PIC X.
  1493         16  CF-ST-RF-AH-CALC               PIC X.
  1494         16  CF-ST-RF-CP-CALC               PIC X.
  1495*        16  FILLER                         PIC X(206).
  1496*CIDMOD         16  FILLER                         PIC X(192).
  1497         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1498             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1499         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1500         16  CF-ST-VFY-2ND-BENE             PIC X.
  1501         16  FILLER                         PIC X(186).
  1502
  1503****************************************************************
  1504*             BENEFIT MASTER RECORD                            *
  1505****************************************************************
  1506
  1507     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1508         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1509             20  CF-BENEFIT-CODE            PIC XX.
  1510             20  CF-BENEFIT-NUMERIC  REDEFINES
  1511                 CF-BENEFIT-CODE            PIC XX.
  1512             20  CF-BENEFIT-ALPHA           PIC XXX.
  1513             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1514             20  CF-BENEFIT-COMMENT         PIC X(10).
  1515
  1516             20  CF-LF-COVERAGE-TYPE        PIC X.
  1517                 88  CF-REDUCING                VALUE 'R'.
  1518                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1519
  1520             20  CF-SPECIAL-CALC-CD         PIC X.
  1521                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* ELVADS.cbl
  1522                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1523                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1524                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1525                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1526                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1527                 88  CF-FARM-PLAN               VALUE 'F'.
  1528                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1529                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1530                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1531                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1532                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1533                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1534                 88  CF-PRUDENTIAL              VALUE 'P'.
  1535                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1536                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1537                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1538                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1539                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1540                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1541
  1542             20  CF-JOINT-INDICATOR         PIC X.
  1543                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1544
  1545*            20  FILLER                     PIC X(12).
  1546             20  FILLER                     PIC X(11).
  1547             20  CF-BENEFIT-CATEGORY        PIC X.
  1548             20  CF-LOAN-TYPE               PIC X(8).
  1549
  1550             20  CF-CO-REM-TERM-CALC        PIC X.
  1551                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1552                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1553                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1554                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1555                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1556
  1557             20  CF-CO-EARNINGS-CALC        PIC X.
  1558                 88  CO-EARN-BY-R78             VALUE '1'.
  1559                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1560                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1561                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1562                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1563                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1564                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1565                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1566
  1567             20  CF-CO-REFUND-CALC          PIC X.
  1568                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1569                 88  CO-REFD-BY-R78             VALUE '1'.
  1570                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1571                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1572                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1573                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1574                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1575                 88  CO-REFD-MEAN               VALUE '8'.
  1576                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1577                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1578                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1579
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* ELVADS.cbl
  1580             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1581                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1582                 88  CO-OVRD-BY-R78             VALUE '1'.
  1583                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1584                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1585                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1586                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1587                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1588                 88  CO-OVRD-MEAN               VALUE '8'.
  1589                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1590
  1591             20  CF-CO-BEN-I-G-CD           PIC X.
  1592                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1593                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1594                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1595
  1596         16  FILLER                         PIC X(304).
  1597
  1598
  1599****************************************************************
  1600*             CARRIER MASTER RECORD                            *
  1601****************************************************************
  1602
  1603     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1604         16  CF-ADDRESS-DATA.
  1605             20  CF-MAIL-TO-NAME            PIC X(30).
  1606             20  CF-IN-CARE-OF              PIC X(30).
  1607             20  CF-ADDRESS-LINE-1          PIC X(30).
  1608             20  CF-ADDRESS-LINE-2          PIC X(30).
  1609             20  CF-CITY-STATE              PIC X(30).
  1610             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1611             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1612
  1613         16  CF-CLAIM-NO-CONTROL.
  1614             20  CF-CLAIM-NO-METHOD         PIC X.
  1615                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1616                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1617                 88  CLAIM-NO-SEQ               VALUE '3'.
  1618                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1619             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1620                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1621                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1622                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1623
  1624         16  CF-CHECK-NO-CONTROL.
  1625             20  CF-CHECK-NO-METHOD         PIC X.
  1626                 88  CHECK-NO-MANUAL            VALUE '1'.
  1627                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1628                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1629                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1630             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1631                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1632
  1633         16  CF-DOMICILE-STATE              PIC XX.
  1634
  1635         16  CF-EXPENSE-CONTROLS.
  1636             20  CF-EXPENSE-METHOD          PIC X.
  1637                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* ELVADS.cbl
  1638                 88  DOLLARS-PER-PMT            VALUE '2'.
  1639                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1640                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1641             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1642             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1643
  1644         16  CF-CORRESPONDENCE-CONTROL.
  1645             20  CF-LETTER-RESEND-OPT       PIC X.
  1646                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1647                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1648             20  FILLER                     PIC X(4).
  1649
  1650         16  CF-RESERVE-CONTROLS.
  1651             20  CF-MANUAL-SW               PIC X.
  1652                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1653             20  CF-FUTURE-SW               PIC X.
  1654                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1655             20  CF-PTC-SW                  PIC X.
  1656                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1657             20  CF-IBNR-SW                 PIC X.
  1658                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1659             20  CF-PTC-LF-SW               PIC X.
  1660                 88  CF-LF-PTC-USED             VALUE '1'.
  1661             20  CF-CDT-ACCESS-METHOD       PIC X.
  1662                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1663                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1664                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1665             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1666
  1667         16  CF-CLAIM-CALC-METHOD           PIC X.
  1668             88  360-PLUS-MONTHS                VALUE '1'.
  1669             88  365-PLUS-MONTHS                VALUE '2'.
  1670             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1671             88  360-DAILY                      VALUE '4'.
  1672             88  365-DAILY                      VALUE '5'.
  1673
  1674         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1675         16  FILLER                         PIC X(11).
  1676
  1677         16  CF-LIMIT-AMOUNTS.
  1678             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1679             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1680             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1681             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1682             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1683             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1684             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1685             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1686             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1687             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1688
  1689         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1690         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1691         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1692
  1693         16  CF-ZIP-CODE.
  1694             20  CF-ZIP-PRIME.
  1695                 24  CF-ZIP-1ST             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* ELVADS.cbl
  1696                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1697                 24  FILLER                 PIC X(4).
  1698             20  CF-ZIP-PLUS4               PIC X(4).
  1699         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1700             20  CF-CAN-POSTAL-1            PIC XXX.
  1701             20  CF-CAN-POSTAL-2            PIC XXX.
  1702             20  FILLER                     PIC XXX.
  1703
  1704         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1705         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1706         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1707
  1708         16  CF-RATING-SWITCH               PIC X.
  1709             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1710             88  CF-NO-RATING                   VALUE 'N'.
  1711
  1712         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1713
  1714         16  CF-CARRIER-OVER-SHORT.
  1715             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1716             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1717
  1718         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1719         16  CF-SECPAY-SWITCH               PIC X.
  1720             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1721             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1722         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1723         16  FILLER                         PIC X(448).
  1724*        16  FILLER                         PIC X(452).
  1725
  1726
  1727****************************************************************
  1728*             MORTALITY MASTER RECORD                          *
  1729****************************************************************
  1730
  1731     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1732         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1733                                INDEXED BY CF-MORT-NDX.
  1734             20  CF-MORT-TABLE              PIC X(5).
  1735             20  CF-MORT-TABLE-TYPE         PIC X.
  1736                 88  CF-MORT-JOINT              VALUE 'J'.
  1737                 88  CF-MORT-SINGLE             VALUE 'S'.
  1738                 88  CF-MORT-COMBINED           VALUE 'C'.
  1739                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1740                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1741             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1742             20  CF-MORT-AGE-METHOD         PIC XX.
  1743                 88  CF-AGE-LAST                VALUE 'AL'.
  1744                 88  CF-AGE-NEAR                VALUE 'AN'.
  1745             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1746             20  CF-MORT-ADJUSTMENT-DIRECTION
  1747                                            PIC X.
  1748                 88  CF-MINUS                   VALUE '-'.
  1749                 88  CF-PLUS                    VALUE '+'.
  1750             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1751             20  CF-MORT-JOINT-CODE         PIC X.
  1752                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1753             20  CF-MORT-PC-Q               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* ELVADS.cbl
  1754                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1755             20  CF-MORT-TABLE-CODE         PIC X(4).
  1756             20  CF-MORT-COMMENTS           PIC X(15).
  1757             20  FILLER                     PIC X(14).
  1758
  1759         16  FILLER                         PIC X(251).
  1760
  1761
  1762****************************************************************
  1763*             BUSSINESS TYPE MASTER RECORD                     *
  1764****************************************************************
  1765
  1766     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1767* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1768* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1769* AND RECORD 05 IS TYPES 81-99
  1770         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1771             20  CF-BUSINESS-TITLE          PIC  X(19).
  1772             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1773                                            PIC S9V9(4) COMP-3.
  1774             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1775             20  FILLER                     PIC  X.
  1776         16  FILLER                         PIC  X(248).
  1777
  1778
  1779****************************************************************
  1780*             TERMINAL MASTER RECORD                           *
  1781****************************************************************
  1782
  1783     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1784
  1785         16  CF-COMPANY-TERMINALS.
  1786             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1787                                  PIC X(4).
  1788         16  FILLER               PIC X(248).
  1789
  1790
  1791****************************************************************
  1792*             LIFE EDIT MASTER RECORD                          *
  1793****************************************************************
  1794
  1795     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1796         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1797             20  CF-LIFE-CODE-IN            PIC XX.
  1798             20  CF-LIFE-CODE-OUT           PIC XX.
  1799         16  FILLER                         PIC X(248).
  1800
  1801
  1802****************************************************************
  1803*             AH EDIT MASTER RECORD                            *
  1804****************************************************************
  1805
  1806     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1807         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1808             20  CF-AH-CODE-IN              PIC XXX.
  1809             20  CF-AH-CODE-OUT             PIC XX.
  1810         16  FILLER                         PIC X(248).
  1811
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* ELVADS.cbl
  1812
  1813****************************************************************
  1814*             CREDIBILITY TABLES                               *
  1815****************************************************************
  1816
  1817     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1818         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1819                             INDEXED BY CF-CRDB-NDX.
  1820             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1821             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1822             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1823         16  FILLER                         PIC  X(332).
  1824
  1825
  1826****************************************************************
  1827*             REPORT CUSTOMIZATION RECORD                      *
  1828****************************************************************
  1829
  1830     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1831         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1832             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1833             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1834             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1835**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1836****       A T-TRANSFER.                                   ****
  1837             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1838
  1839         16  FILLER                         PIC XX.
  1840
  1841         16  CF-CARRIER-CNTL-OPT.
  1842             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1843                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1844                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1845             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1846                                            PIC X.
  1847         16  CF-GROUP-CNTL-OPT.
  1848             20  CF-GROUP-OPT-SEQ           PIC 9.
  1849                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1850                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1851             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1852                                            PIC X(6).
  1853         16  CF-STATE-CNTL-OPT.
  1854             20  CF-STATE-OPT-SEQ           PIC 9.
  1855                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1856                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1857             20  CF-STATE-SELECT OCCURS 3 TIMES
  1858                                            PIC XX.
  1859         16  CF-ACCOUNT-CNTL-OPT.
  1860             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1861                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1862                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1863             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1864                                            PIC X(10).
  1865         16  CF-BUS-TYP-CNTL-OPT.
  1866             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1867                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1868                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1869             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* ELVADS.cbl
  1870                                            PIC XX.
  1871         16  CF-LF-TYP-CNTL-OPT.
  1872             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1873                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1874                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1875             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1876                                            PIC XX.
  1877         16  CF-AH-TYP-CNTL-OPT.
  1878             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1879                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1880                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1881             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1882                                            PIC XX.
  1883         16  CF-REPTCD1-CNTL-OPT.
  1884             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1885                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1886                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1887             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1888                                            PIC X(10).
  1889         16  CF-REPTCD2-CNTL-OPT.
  1890             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1891                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1892                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1893             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1894                                            PIC X(10).
  1895         16  CF-USER1-CNTL-OPT.
  1896             20  CF-USER1-OPT-SEQ           PIC 9.
  1897                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1898                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1899             20  CF-USER1-SELECT OCCURS 3 TIMES
  1900                                            PIC X(10).
  1901         16  CF-USER2-CNTL-OPT.
  1902             20  CF-USER2-OPT-SEQ           PIC 9.
  1903                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1904                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1905             20  CF-USER2-SELECT OCCURS 3 TIMES
  1906                                            PIC X(10).
  1907         16  CF-USER3-CNTL-OPT.
  1908             20  CF-USER3-OPT-SEQ           PIC 9.
  1909                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1910                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1911             20  CF-USER3-SELECT OCCURS 3 TIMES
  1912                                            PIC X(10).
  1913         16  CF-USER4-CNTL-OPT.
  1914             20  CF-USER4-OPT-SEQ           PIC 9.
  1915                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1916                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1917             20  CF-USER4-SELECT OCCURS 3 TIMES
  1918                                            PIC X(10).
  1919         16  CF-USER5-CNTL-OPT.
  1920             20  CF-USER5-OPT-SEQ           PIC 9.
  1921                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1922                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1923             20  CF-USER5-SELECT OCCURS 3 TIMES
  1924                                            PIC X(10).
  1925         16  CF-REINS-CNTL-OPT.
  1926             20  CF-REINS-OPT-SEQ           PIC 9.
  1927                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* ELVADS.cbl
  1928                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1929             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1930                 24  CF-REINS-PRIME         PIC XXX.
  1931                 24  CF-REINS-SUB           PIC XXX.
  1932
  1933         16  CF-AGENT-CNTL-OPT.
  1934             20  CF-AGENT-OPT-SEQ           PIC 9.
  1935                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1936                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1937             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1938                                            PIC X(10).
  1939
  1940         16  FILLER                         PIC X(43).
  1941
  1942         16  CF-LOSS-RATIO-SELECT.
  1943             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1944             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1945         16  CF-ENTRY-DATE-SELECT.
  1946             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1947             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1948         16  CF-EFFECTIVE-DATE-SELECT.
  1949             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1950             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1951
  1952         16  CF-EXCEPTION-LIST-IND          PIC X.
  1953             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1954
  1955         16  FILLER                         PIC X(318).
  1956
  1957****************************************************************
  1958*                  EXCEPTION REPORTING RECORD                  *
  1959****************************************************************
  1960
  1961     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1962         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1963             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1964
  1965         16  CF-COMBINED-LIFE-AH-OPT.
  1966             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1967             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1968             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1969             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1970
  1971         16  CF-LIFE-OPT.
  1972             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1973             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1974             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1975             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1976             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1977             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1978             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1979             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1980             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1981             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1982
  1983         16  CF-AH-OPT.
  1984             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1985             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* ELVADS.cbl
  1986             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1987             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1988             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1989             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1990             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1991             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1992             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1993             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1994
  1995         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1996             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1997             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1998             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1999
  2000         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2001
  2002         16  FILLER                         PIC X(673).
  2003
  2004
  2005****************************************************************
  2006*             MORTGAGE SYSTEM PLAN RECORD                      *
  2007****************************************************************
  2008
  2009     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2010         16  CF-PLAN-TYPE                   PIC X.
  2011             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2012             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2013             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2014         16  CF-PLAN-ABBREV                 PIC XXX.
  2015         16  CF-PLAN-DESCRIPT               PIC X(10).
  2016         16  CF-PLAN-NOTES                  PIC X(20).
  2017         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2018         16  CF-PLAN-UNDERWRITING.
  2019             20  CF-PLAN-TERM-DATA.
  2020                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2021                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2022             20  CF-PLAN-AGE-DATA.
  2023                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2024                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2025                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2026             20  CF-PLAN-BENEFIT-DATA.
  2027                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2028                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2029                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2030                                            PIC S9(7)V99  COMP-3.
  2031         16  CF-PLAN-POLICY-FORMS.
  2032             20  CF-POLICY-FORM             PIC X(12).
  2033             20  CF-MASTER-APPLICATION      PIC X(12).
  2034             20  CF-MASTER-POLICY           PIC X(12).
  2035         16  CF-PLAN-RATING.
  2036             20  CF-RATE-CODE               PIC X(5).
  2037             20  CF-SEX-RATING              PIC X.
  2038                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2039                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2040             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2041             20  CF-SUB-STD-TYPE            PIC X.
  2042                 88  CF-PCT-OF-PREM            VALUE '1'.
  2043                 88  CF-PCT-OF-BENE            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* ELVADS.cbl
  2044         16  CF-PLAN-PREM-TOLERANCES.
  2045             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2046             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2047         16  CF-PLAN-PYMT-TOLERANCES.
  2048             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2049             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2050         16  CF-PLAN-MISC-DATA.
  2051             20  FILLER                     PIC X.
  2052             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2053             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2054         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2055         16  CF-PLAN-IND-GRP                PIC X.
  2056             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2057                                                     '1'.
  2058             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2059                                                     '2'.
  2060         16  CF-MIB-SEARCH-SW               PIC X.
  2061             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2062             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2063             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2064             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2065         16  CF-ALPHA-SEARCH-SW             PIC X.
  2066             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2067             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2068             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2069             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2070             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2071             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2072             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2073             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2074             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2075             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2076                                                     'A' 'B' 'C'
  2077                                                     'X' 'Y' 'Z'.
  2078         16  CF-EFF-DT-RULE-SW              PIC X.
  2079             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2080             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2081             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2082             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2083             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2084         16  FILLER                         PIC X(4).
  2085         16  CF-HEALTH-QUESTIONS            PIC X.
  2086             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2087         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2088         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2089         16  CF-PLAN-SNGL-JNT               PIC X.
  2090             88  CF-COMBINED-PLAN              VALUE 'C'.
  2091             88  CF-JNT-PLAN                   VALUE 'J'.
  2092             88  CF-SNGL-PLAN                  VALUE 'S'.
  2093         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2094         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2095         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2096         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2097         16  CF-RERATE-CNTL                 PIC  X.
  2098             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2099             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2100             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2101             88  CF-AUTO-RECALC                 VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* ELVADS.cbl
  2102         16  CF-BENEFIT-TYPE                PIC  X.
  2103             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2104             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2105         16  CF-POLICY-FEE                  PIC S999V99
  2106                                                    COMP-3.
  2107         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2108         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2109         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2110         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2111         16  FILLER                         PIC  X(32).
  2112         16  CF-TERMINATION-FORM            PIC  X(04).
  2113         16  FILLER                         PIC  X(08).
  2114         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2115                                                       COMP-3.
  2116         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2117         16  CF-ISSUE-LETTER                PIC  X(4).
  2118         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2119         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2120             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2121             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2122         16  CF-MP-REFUND-CALC              PIC X.
  2123             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2124             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2125             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2126             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2127             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2128             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2129             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2130             88  CF-MP-REFD-MEAN                VALUE '8'.
  2131         16  CF-ALT-RATE-CODE               PIC  X(5).
  2132
  2133
  2134         16  FILLER                         PIC X(498).
  2135****************************************************************
  2136*             MORTGAGE COMPANY MASTER RECORD                   *
  2137****************************************************************
  2138
  2139     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2140         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2141         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2142             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2143             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2144             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2145             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2146             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2147
  2148         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2149         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2150         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2151         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2152         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2153
  2154         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2155             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2156         16  CF-MP-RECON-USE-IND            PIC X(1).
  2157             88  CF-MP-USE-RECON             VALUE 'Y'.
  2158         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2159             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* ELVADS.cbl
  2160         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2161             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2162             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2163         16  FILLER                         PIC X(1).
  2164         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2165             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2166         16  CF-MORTG-MIB-VERSION           PIC X.
  2167             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2168             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2169             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2170         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2171             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2172                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2173             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2174                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2175             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2176                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2177             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2178                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2179             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2180                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2181             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2182                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2183         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2184         16  FILLER                         PIC X(7).
  2185         16  CF-MORTG-DESTINATION-SYMBOL.
  2186             20  CF-MORTG-MIB-COMM          PIC X(5).
  2187             20  CF-MORTG-MIB-TERM          PIC X(5).
  2188         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2189             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2190         16  FILLER                         PIC X(03).
  2191         16  CF-MP-CHECK-NO-CONTROL.
  2192             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2193                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2194                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2195                                                ' ' LOW-VALUES.
  2196                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2197                                               VALUE '3'.
  2198         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2199         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2200         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2201             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2202                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2203             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2204                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2205             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2206                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2207             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2208                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2209             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2210                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2211             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2212                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2213         16  CF-MORTG-BILLING-AREA.
  2214             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2215                                            PIC X.
  2216         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2217         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* ELVADS.cbl
  2218         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2219         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2220             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2221             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2222         16  FILLER                         PIC X.
  2223         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2224             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2225             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2226         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2227         16  FILLER                         PIC X(8).
  2228         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2229         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2230         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2231         16  CF-ACH-COMPANY-ID.
  2232             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2233                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2234                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2235                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2236             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2237         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2238             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2239         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2240             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2241             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2242         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2243         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2244         16  FILLER                         PIC X(536).
  2245
  2246****************************************************************
  2247*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2248****************************************************************
  2249
  2250     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2251         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2252             20  CF-FEMALE-HEIGHT.
  2253                 24  CF-FEMALE-FT           PIC 99.
  2254                 24  CF-FEMALE-IN           PIC 99.
  2255             20  CF-FEMALE-MIN-WT           PIC 999.
  2256             20  CF-FEMALE-MAX-WT           PIC 999.
  2257         16  FILLER                         PIC X(428).
  2258
  2259     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2260         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2261             20  CF-MALE-HEIGHT.
  2262                 24  CF-MALE-FT             PIC 99.
  2263                 24  CF-MALE-IN             PIC 99.
  2264             20  CF-MALE-MIN-WT             PIC 999.
  2265             20  CF-MALE-MAX-WT             PIC 999.
  2266         16  FILLER                         PIC X(428).
  2267******************************************************************
  2268*             AUTOMATIC ACTIVITY RECORD                          *
  2269******************************************************************
  2270     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2271         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2272             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2273             20  CF-SYS-LETTER-ID           PIC X(04).
  2274             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2275             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* ELVADS.cbl
  2276             20  CF-SYS-RESET-SW            PIC X(01).
  2277             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2278             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2279
  2280         16  FILLER                         PIC X(50).
  2281
  2282         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2283             20  CF-USER-ACTIVE-SW          PIC X(01).
  2284             20  CF-USER-LETTER-ID          PIC X(04).
  2285             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2286             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2287             20  CF-USER-RESET-SW           PIC X(01).
  2288             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2289             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2290             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2291
  2292         16  FILLER                         PIC X(246).
  2293*                                COPY ERCARCH.
  2294******************************************************************
  2295*                                                                *
  2296*                            ERCARCH.                            *
  2297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2298*                            VMOD=2.002                          *
  2299*                                                                *
  2300*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2301*                                                                *
  2302*   FILE TYPE = VSAM,KSDS                                        *
  2303*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2304*                                                                *
  2305*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2306*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2307*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2308*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2309*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2310*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2311*                                                                *
  2312*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2313******************************************************************
  2314*                   C H A N G E   L O G
  2315*
  2316* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2317*-----------------------------------------------------------------
  2318*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2319* EFFECTIVE    NUMBER
  2320*-----------------------------------------------------------------
  2321* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2322* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2323******************************************************************
  2324 01  LETTER-ARCHIVE.
  2325     12  LA-RECORD-ID                PIC  X(02).
  2326         88  LA-VALID-ID                VALUE 'LA'.
  2327
  2328     12  LA-CONTROL-PRIMARY.
  2329         16  LA-COMPANY-CD           PIC  X(01).
  2330         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2331
  2332     12  LA-CONTROL-BY-CERT-RESP.
  2333         16  LA-COMPANY-CD-A2        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* ELVADS.cbl
  2334         16  LA-CERT-NO-A2.
  2335             20  LA-CERT-PRIME-A2    PIC  X(10).
  2336             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2337         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2338             20  LA-RESP-PERSON-A2   PIC  X(10).
  2339             20  LA-TYPE-A2          PIC  X(01).
  2340         16  LA-CARRIER-A2           PIC  X(01).
  2341         16  LA-GROUPING-A2          PIC  X(06).
  2342         16  LA-STATE-A2             PIC  X(02).
  2343         16  LA-ACCOUNT-A2           PIC  X(10).
  2344         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2345         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2346
  2347     12  LA-CONTROL-BY-FORM.
  2348         16  LA-COMPANY-CD-A3        PIC  X(01).
  2349         16  LA-FORM-A3              PIC  X(04).
  2350         16  LA-CARRIER-A3           PIC  X(01).
  2351         16  LA-GROUPING-A3          PIC  X(06).
  2352         16  LA-STATE-A3             PIC  X(02).
  2353         16  LA-ACCOUNT-A3           PIC  X(10).
  2354         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2355
  2356     12  LA-CONTROL-BY-PROCESSOR.
  2357         16  LA-COMPANY-CD-A4        PIC  X(01).
  2358         16  LA-PROCESSOR-CD         PIC  X(04).
  2359         16  LA-CARRIER-A4           PIC  X(01).
  2360         16  LA-GROUPING-A4          PIC  X(06).
  2361         16  LA-STATE-A4             PIC  X(02).
  2362         16  LA-ACCOUNT-A4           PIC  X(10).
  2363         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2364
  2365     12  LA-CONTROL-BY-KEY-FIELDS.
  2366         16  LA-COMPANY-CD-A5        PIC  X(01).
  2367         16  LA-CARRIER-A5           PIC  X(01).
  2368         16  LA-GROUPING-A5          PIC  X(06).
  2369         16  LA-STATE-A5             PIC  X(02).
  2370         16  LA-ACCOUNT-A5           PIC  X(10).
  2371         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2372
  2373     12  LA-CONTROL-BY-GROUP-CODE.
  2374         16  LA-COMPANY-CD-A6        PIC  X(01).
  2375         16  LA-ENTRY-A6.
  2376             20  LA-FILLER           PIC  X(02).
  2377             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2378         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2379
  2380     12  FILLER                      PIC  X(09).
  2381
  2382     12  LA-HEADER-RECORD.
  2383         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2384         16  LA-CREATION-DATE        PIC  X(02).
  2385         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2386         16  LA-FINAL-ACT-DATE       REDEFINES
  2387               LA-FOLLOW-UP-DATE     PIC  X(02).
  2388         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2389         16  LA-NO-OF-COPIES         PIC S9(01).
  2390         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2391         16  LA-REPLY-DATE           PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* ELVADS.cbl
  2392         16  LA-RESEND-DATES.
  2393             20  LA-RESEND-DATE      PIC  X(02).
  2394             20  LA-SENT-DATE        PIC  X(02).
  2395             20  FILLER              PIC  X(08).
  2396         16  LA-SOURCE-INFORMATION.
  2397             20  LA-DATA-SOURCE      PIC  X(01).
  2398             20  LA-ADDR-SOURCE      PIC  X(01).
  2399         16  LA-STATUS               PIC  X(01).
  2400             88  LA-STATUS-ACTIVE         VALUE 'A'.
  2401             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2402             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2403             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2404             88  LA-STATUS-PURGED         VALUE 'P'.
  2405             88  LA-STATUS-VOIDED         VALUE 'V'.
  2406         16  LA-LAST-RESENT-PRINT-DATE
  2407                                     PIC  X(02).
  2408         16  LA-PRINT-RESTRICTION    PIC  X(01).
  2409             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2410                                          VALUE 'C'.
  2411             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2412                                          VALUE 'F'.
  2413             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2414                                          VALUE 'P'.
  2415         16  LA-PURGED-DATE          PIC  X(02).
  2416         16  LA-VOIDED-DATE          PIC  X(02).
  2417         16  LA-RESEND-LETR          PIC  X(4).
  2418         16  FILLER                  PIC  X(08).
  2419*        16  LA-RESEND-LETR-2        PIC  X(4).
  2420*        16  LA-RESEND-LETR-3        PIC  X(4).
  2421*        16  FILLER                  PIC  X(59).
  2422         16  LA-ARCHIVE-STATUS       PIC  X.
  2423             88  LA-TEMP                VALUE 'T'.
  2424             88  LA-QWS                 VALUE 'Q'.
  2425             88  LA-BATCH               VALUE 'B'.
  2426         16  LA-FINAL-ACT-IND        PIC  X(1).
  2427         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2428         16  FILLER                  PIC  X(46).
  2429*        16  FILLER                  PIC  X(71).
  2430         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2431         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2432         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2433                                     PIC  X(4).
  2434         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2435
  2436******************************************************************
  2437*                                COPY ELCENCC.
  2438******************************************************************
  2439*                                                                *
  2440*                                                                *
  2441*                            ELCENCC                             *
  2442*                            VMOD=2.001                          *
  2443*                                                                *
  2444*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  2445*                                                                *
  2446*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  2447*   A NAPERSOFT DOCUMENT                                         *
  2448*                                                                *
  2449*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* ELVADS.cbl
  2450*                                                                *
  2451*   FILE TYPE = VSAM,KSDS                                        *
  2452*   RECORD SIZE = 400   RECFORM = FIX                            *
  2453*                                                                *
  2454*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  2455*                                                                *
  2456*   LOG = NO                                                     *
  2457*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2458*                                                                *
  2459*                                                                *
  2460******************************************************************
  2461*                   C H A N G E   L O G
  2462*
  2463* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2464*-----------------------------------------------------------------
  2465*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2466* EFFECTIVE    NUMBER
  2467*-----------------------------------------------------------------
  2468* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  2469******************************************************************
  2470 01  ENCLOSURE-CODES.
  2471     12  NC-RECORD-ID                      PIC XX.
  2472         88  VALID-NC-ID                      VALUE 'NC'.
  2473     12  NC-CONTROL-PRIMARY.
  2474         16  NC-COMPANY-CD                 PIC X.
  2475         16  NC-REC-TYPE                   PIC X.
  2476             88  NC-CLAIMS                   VALUE '1'.
  2477             88  NC-ADMIN                    VALUE '2'.
  2478         16  NC-ENC-CODE                   PIC X(5).
  2479         16  FILLER                        PIC X(09).
  2480     12  NC-MAINT-INFORMATION.
  2481         16  NC-LAST-MAINT-DT              PIC XX.
  2482         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2483         16  NC-LAST-MAINT-USER            PIC X(4).
  2484         16  FILLER                        PIC XX.
  2485     12  NC-OUTPUT-STACK                   PIC XXX.
  2486     12  NC-ENCLOSURE-LINE                 PIC X(100).
  2487     12  NC-ATTACHMENTS                    PIC X(100).
  2488     12  NC-FUTURE                         PIC X(50).
  2489     12  FILLER                            PIC X(117).
  2490******************************************************************
  2491*                                COPY NSCASEXTR.
  2492******************************************************************
  2493*                                                                *
  2494*                                                                *
  2495*                            NSCASEXTR.                          *
  2496*                            VMOD=2.001                          *
  2497*                                                                *
  2498*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
  2499*                                                                *
  2500*   FILE TYPE = VSAM,KSDS                                        *
  2501*   RECORD SIZE = 4500 RECFORM = FIXED                           *
  2502*                                                                *
  2503*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
  2504*                                                                *
  2505*   LOG = NO                                                     *
  2506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2507******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* ELVADS.cbl
  2508*-----------------------------------------------------------------
  2509*                   C H A N G E   L O G
  2510*
  2511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2512*-----------------------------------------------------------------
  2513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2514* EFFECTIVE    NUMBER
  2515*-----------------------------------------------------------------
  2516* 072211    2011022800001  PEMA  NEW FILE
  2517*-----------------------------------------------------------------
  2518 01 NSAS-EXTRACT-RECORD.
  2519    05  NSAS-CONTROL-PRIMARY.
  2520        10  NSAS-COMPANY-CD      PIC X.
  2521        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
  2522        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
  2523    05  NSAS-LETTER-VARIABLES    PIC X(4350).
  2524    05  FILLER                   PIC X(143).
  2525     01  WS-PASS-AREA.
  2526         05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
  2527         05  WS-COMMAREA.
  2528             10  WS-PASS-VADS-REC    PIC X(350).
  2529****************************************************************
  2530*
  2531* Copyright (c) 2007 by Clerity Solutions, Inc.
  2532* All rights reserved.
  2533*
  2534****************************************************************
  2535 01  DFHEIV.
  2536   02  DFHEIV0               PIC X(35).
  2537   02  DFHEIV1               PIC X(08).
  2538   02  DFHEIV2               PIC X(08).
  2539   02  DFHEIV3               PIC X(08).
  2540   02  DFHEIV4               PIC X(06).
  2541   02  DFHEIV5               PIC X(04).
  2542   02  DFHEIV6               PIC X(04).
  2543   02  DFHEIV7               PIC X(02).
  2544   02  DFHEIV8               PIC X(02).
  2545   02  DFHEIV9               PIC X(01).
  2546   02  DFHEIV10              PIC S9(7) COMP-3.
  2547   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2548   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2549   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2550   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2551   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2552   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2553   02  DFHEIV17              PIC X(04).
  2554   02  DFHEIV18              PIC X(04).
  2555   02  DFHEIV19              PIC X(04).
  2556   02  DFHEIV20              USAGE IS POINTER.
  2557   02  DFHEIV21              USAGE IS POINTER.
  2558   02  DFHEIV22              USAGE IS POINTER.
  2559   02  DFHEIV23              USAGE IS POINTER.
  2560   02  DFHEIV24              USAGE IS POINTER.
  2561   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2562   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2563   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2564   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2565   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* ELVADS.cbl
  2566   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2567   02  FILLER                PIC X(02).
  2568   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2569   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2570   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2571   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2572   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2573 LINKAGE  SECTION.
  2574*****************************************************************
  2575*                                                               *
  2576* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2577* All rights reserved.                                          *
  2578*                                                               *
  2579*****************************************************************
  2580 01  dfheiblk.
  2581     02  eibtime          pic s9(7) comp-3.
  2582     02  eibdate          pic s9(7) comp-3.
  2583     02  eibtrnid         pic x(4).
  2584     02  eibtaskn         pic s9(7) comp-3.
  2585     02  eibtrmid         pic x(4).
  2586     02  dfheigdi         pic s9(4) comp.
  2587     02  eibcposn         pic s9(4) comp.
  2588     02  eibcalen         pic s9(4) comp.
  2589     02  eibaid           pic x(1).
  2590     02  eibfiller1       pic x(1).
  2591     02  eibfn            pic x(2).
  2592     02  eibfiller2       pic x(2).
  2593     02  eibrcode         pic x(6).
  2594     02  eibfiller3       pic x(2).
  2595     02  eibds            pic x(8).
  2596     02  eibreqid         pic x(8).
  2597     02  eibrsrce         pic x(8).
  2598     02  eibsync          pic x(1).
  2599     02  eibfree          pic x(1).
  2600     02  eibrecv          pic x(1).
  2601     02  eibsend          pic x(1).
  2602     02  eibatt           pic x(1).
  2603     02  eibeoc           pic x(1).
  2604     02  eibfmh           pic x(1).
  2605     02  eibcompl         pic x(1).
  2606     02  eibsig           pic x(1).
  2607     02  eibconf          pic x(1).
  2608     02  eiberr           pic x(1).
  2609     02  eibrldbk         pic x(1).
  2610     02  eiberrcd         pic x(4).
  2611     02  eibsynrb         pic x(1).
  2612     02  eibnodat         pic x(1).
  2613     02  eibfiller5       pic x(2).
  2614     02  eibresp          pic 9(09) comp.
  2615     02  eibresp2         pic 9(09) comp.
  2616     02  dfheigdj         pic s9(4) comp.
  2617     02  dfheigdk         pic s9(4) comp.
  2618
  2619 01  DFHCOMMAREA                     PIC X(1000).
  2620 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2621 0000-DFHEXIT SECTION.
  2622     MOVE '9#                    $   ' TO DFHEIV0.
  2623     MOVE 'ELVADS' TO DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* ELVADS.cbl
  2624     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2625
  2626     MOVE DFHCOMMAREA          TO  WS-PASS-AREA.
  2627
  2628     MOVE WS-PASS-VADS-REC       TO VIRGINIA-DISCLOSURE
  2629     MOVE SPACES                 TO WS-CALC-SWITCHES
  2630     MOVE VD-COMPANY-CD          TO WS-COMPANY-CD
  2631     MOVE VD-LETTER-ID           TO VA-LETTER
  2632     MOVE VD-CARRIER             TO VA-CARRIER
  2633     MOVE VD-GROUPING            TO VA-GROUPING
  2634     MOVE VD-STATE               TO VA-STATE
  2635     MOVE VD-ACCOUNT             TO VA-ACCOUNT
  2636     MOVE VD-INSURED-LAST-NAME   TO VA-LASTNAME
  2637     MOVE VD-INSURED-FIRST-NAME  TO VA-FIRSTNAME
  2638     MOVE VD-INSURED-MIDDLE-INIT TO VA-MIDINIT
  2639     MOVE VD-INSURED-ADDRESS-1   TO VA-ADDR1
  2640     MOVE VD-INSURED-ADDRESS-2   TO VA-ADDR2
  2641     MOVE VD-INSURED-CITY        TO VA-ADDR-CITY
  2642     MOVE VD-INSURED-STATE       TO VA-ADDR-ST
  2643     MOVE VD-INSURED-ZIP-CODE    TO VA-ADDR-ZIP
  2644     MOVE VD-JOINT-LAST-NAME     TO VA-JNT-LASTNAME
  2645     MOVE VD-JOINT-FIRST-NAME    TO VA-JNT-FIRSTNAME
  2646     MOVE VD-JOINT-MIDDLE-INIT   TO VA-JNT-MIDINIT
  2647     IF VD-LF-BENEFIT-CD = '01' OR '03'
  2648        SET GROSS-CERT           TO TRUE
  2649        SET CALC-LF-GROSS        TO TRUE
  2650        SET CALC-LF-NET          TO TRUE
  2651     END-IF
  2652     IF VD-LF-BENEFIT-CD = '05' OR '06'
  2653        SET NET-CERT             TO TRUE
  2654        SET CALC-LF-NET          TO TRUE
  2655     END-IF
  2656     IF VD-LF-BENEFIT-CD = '02' OR '04'
  2657        SET CALC-LF-LEVEL        TO TRUE
  2658        SET LEVEL-CERT           TO TRUE
  2659     END-IF
  2660     IF VD-AH-BENEFIT-CD NOT = '00' AND '  '
  2661        SET CALC-AH              TO TRUE
  2662     END-IF
  2663     IF (VD-LF-BENEFIT-CD = '00' OR '  ')
  2664        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  2665        SET AH-ONLY              TO TRUE
  2666     END-IF
  2667     MOVE VD-LF-PREMIUM-AMT      TO LFPREM
  2668     MOVE VD-AH-PREMIUM-AMT      TO AHPREM
  2669     MOVE VD-LF-BENEFIT-AMT      TO LFAMT
  2670     IF VD-LF-BENEFIT-CD NOT = '00' AND '  '
  2671        MOVE VD-LF-TERM          TO N
  2672     ELSE
  2673        MOVE VD-AH-TERM          TO N
  2674     END-IF
  2675     MOVE VD-LOAN-TERM           TO M
  2676     IF M = 0
  2677        MOVE N                   TO M
  2678     END-IF
  2679     COMPUTE I = VD-LOAN-APR / +1200
  2680     MOVE ZEROS                  TO Z
  2681     MOVE +30                    TO T
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* ELVADS.cbl
  2682     MOVE +3.63                  TO ANNUAL-DISCOUNT
  2683     MOVE VD-CERT-EFF-DT         TO DC-BIN-DATE-1
  2684     MOVE VD-1ST-PMT-DT          TO DC-BIN-DATE-2
  2685     MOVE '1'                    TO DC-OPTION-CODE
  2686     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  2687     IF NO-CONVERSION-ERROR
  2688        COMPUTE D = (DC-ELAPSED-MONTHS * 30) + DC-ODD-DAYS-OVER
  2689     END-IF
  2690     IF VD-AH-BENEFIT-CD NOT = '  ' AND '00'
  2691        MOVE VD-AH-RATE          TO AHRATE
  2692     END-IF
  2693     IF GROSS-CERT OR LEVEL-CERT
  2694        COMPUTE LF-RATE = VD-LF-RATE / (N / 12)
  2695     END-IF
  2696     IF NET-CERT
  2697        MOVE VD-LF-RATE          TO OBRATE
  2698     END-IF
  2699     IF GROSS-CERT
  2700        PERFORM 1000-GET-ERRATE  THRU 1000-EXIT
  2701     END-IF
  2702     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2703     COMPUTE DISC = ANNUAL-DISCOUNT / 1200
  2704     COMPUTE V-M = (1 / (1 + I)) ** N
  2705     COMPUTE VM = (1 / (1 + I)) ** M
  2706     COMPUTE VM-N = (1 / (1 + I)) ** (M - N)
  2707     COMPUTE V = 1 / (1 + I)
  2708     COMPUTE X = 1 / (1 + DISC)
  2709     COMPUTE Y = (1 + (D * I / T)) / (1 + I)
  2710     COMPUTE ANGLENY = ANGLEN / Y
  2711     COMPUTE LF = ((1 + (Z * I)) / I)
  2712        * (((X ** N - 1) / (X - 1))
  2713        - ((X ** N * VM-N - VM) / (X * (1 + I) - 1)))
  2714        * (OBRATE / 1000)
  2715*    COMPUTE LFA = (1 + (Z * I)) / I
  2716*    COMPUTE LFB = X ** N - 1
  2717*    COMPUTE LFC = X - 1
  2718*    COMPUTE LFD = LFB / LFC
  2719*    COMPUTE LFE = (((X ** N) * (V ** (M - N))) - (V ** M)) /
  2720*       ((X * (1 + I)) - 1)
  2721*    COMPUTE LF = LFA * (LFD - LFE) * (OBRATE / 1000)
  2722     COMPUTE R = LFAMT / (ANGLENY - LF - N * AHRATE / 100)
  2723     COMPUTE SP = (LF * 100) / (ANGLENY * (1 + (Z * I)))
  2724     COMPUTE LDPN = SP * R * ANGLENY * (1 + (Z * I)) / 100
  2725     COMPUTE AHPN = R * N * AHRATE / 100
  2726     COMPUTE Y = (1 + (D * I / T)) / (1 + I)
  2727     COMPUTE ANGLENY = ANGLEN / Y
  2728     IF GROSS-CERT
  2729        COMPUTE CUR-PMT = LFAMT / VD-LF-TERM
  2730        COMPUTE AMT-FINANCED = CUR-PMT * ANGLEN
  2731        COMPUTE PRINC-AMT = AMT-FINANCED - LFPREM - AHPREM
  2732     ELSE
  2733        IF NET-CERT
  2734           COMPUTE PRINC-AMT = LFAMT - LFPREM - AHPREM
  2735           MOVE LFAMT TO AMT-FINANCED
  2736        END-IF
  2737     END-IF
  2738     MOVE 000000.00              TO VA-CL-NET-AMT
  2739                                    VA-CL-GRS-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* ELVADS.cbl
  2740                                    VA-CL-LEV-AMT
  2741                                    VA-CD-NET-AMT
  2742                                    VA-CD-GRS-AMT
  2743                                    VA-CD-LEV-AMT
  2744                                    VA-CLD-NET-AMT
  2745                                    VA-CLD-GRS-AMT
  2746                                    VA-CLD-LEV-AMT
  2747                                    VA-NO-NET-AMT
  2748                                    VA-NO-GRS-AMT
  2749                                    VA-NO-LEV-AMT
  2750     MOVE 00000.00               TO VA-CL-NET-PMT
  2751                                    VA-CL-GRS-PMT
  2752                                    VA-CL-LEV-PMT
  2753                                    VA-CD-NET-PMT
  2754                                    VA-CD-GRS-PMT
  2755                                    VA-CD-LEV-PMT
  2756                                    VA-CLD-NET-PMT
  2757                                    VA-CLD-GRS-PMT
  2758                                    VA-CLD-LEV-PMT
  2759                                    VA-NO-NET-PMT
  2760                                    VA-NO-GRS-PMT
  2761                                    VA-NO-LEV-PMT
  2762     MOVE 00000.00               TO VA-CL-NET-PRM
  2763                                    VA-CL-GRS-PRM
  2764                                    VA-CL-LEV-PRM
  2765                                    VA-CD-NET-PRM
  2766                                    VA-CD-GRS-PRM
  2767                                    VA-CD-LEV-PRM
  2768                                    VA-CLD-NET-PRM
  2769                                    VA-CLD-GRS-PRM
  2770                                    VA-CLD-LEV-PRM
  2771                                    VA-NO-NET-PRM
  2772                                    VA-NO-GRS-PRM
  2773                                    VA-NO-LEV-PRM
  2774     IF NET-CERT
  2775        PERFORM 2000-BUILD-NET-AMTS
  2776                                 THRU 2000-EXIT
  2777     END-IF
  2778     IF GROSS-CERT
  2779        PERFORM 2000-BUILD-NET-AMTS
  2780                                 THRU 2000-EXIT
  2781        PERFORM 3000-BUILD-GROSS-AMTS
  2782                                 THRU 3000-EXIT
  2783     END-IF
  2784     IF LEVEL-CERT
  2785        PERFORM 4000-BUILD-LEVEL-AMTS
  2786                                 THRU 4000-EXIT
  2787     END-IF
  2788     IF AH-ONLY
  2789        PERFORM 3500-BUILD-AH-AMTS
  2790                                 THRU 3500-EXIT
  2791     END-IF
  2792     STRING VD-INSURED-FIRST-NAME ' '
  2793        VD-INSURED-LAST-NAME DELIMITED BY '  '
  2794        INTO VA-BORROWER
  2795     END-STRING
  2796     MOVE VD-CERT-NO             TO VA-CERT-NO
  2797     MOVE VD-ACCOUNT-NAME        TO VA-ACCT-NAME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* ELVADS.cbl
  2798     MOVE VD-BENEFICIARY-NAME    TO VA-BENE
  2799     IF VD-LF-BENEFIT-CD = '03' OR '04' OR '06'
  2800        MOVE 'X'                 TO VA-JL
  2801     ELSE
  2802        IF VD-LF-BENEFIT-CD NOT = '00' AND '  '
  2803           MOVE 'X'              TO VA-SL
  2804        END-IF
  2805     END-IF
  2806     IF GROSS-CERT
  2807        MOVE 'X'                 TO VA-GD
  2808     ELSE
  2809        IF LEVEL-CERT
  2810           MOVE 'X'              TO VA-LL
  2811        ELSE
  2812           IF NET-CERT
  2813              MOVE 'X'           TO VA-NP
  2814           END-IF
  2815        END-IF
  2816     END-IF
  2817     IF CALC-AH
  2818        MOVE 'X'                 TO VA-SA
  2819        EVALUATE TRUE
  2820         WHEN VD-AH-BENEFIT-CD = '53' OR '54' OR
  2821           '55' OR '56' OR '57'
  2822           MOVE 'X'              TO VA-JA
  2823           MOVE ' '              TO VA-SA
  2824         WHEN VD-AH-BENEFIT-CD = '03' OR '53'
  2825           MOVE 'X'              TO VA-7R
  2826         WHEN VD-AH-BENEFIT-CD = '01' OR '54'
  2827           MOVE 'X'              TO VA-14R
  2828         WHEN VD-AH-BENEFIT-CD = '05' OR '56'
  2829           MOVE 'X'              TO VA-14E
  2830         WHEN VD-AH-BENEFIT-CD = '04' OR '55'
  2831           MOVE 'X'              TO VA-30R
  2832         WHEN VD-AH-BENEFIT-CD = '02' OR '57'
  2833           MOVE 'X'              TO VA-30E
  2834        END-EVALUATE
  2835     END-IF
  2836*    MOVE 'X'                    TO VA-SL VA-JL VA-SA VA-JA VA-GD
  2837*       VA-NP VA-7R VA-LL VA-TN VA-14R VA-14E VA-30R VA-30E
  2838     MOVE VD-CERT-EFF-DT         TO DC-BIN-DATE-1
  2839     MOVE SPACE                  TO DC-OPTION-CODE
  2840     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  2841     IF NO-CONVERSION-ERROR
  2842        STRING DC-GREG-DATE-CYMD-R (5:2) '/'
  2843               DC-GREG-DATE-CYMD-R (7:2) '/'
  2844               DC-GREG-DATE-CYMD-R (1:4) DELIMITED BY SIZE
  2845           INTO VA-EFFDATE
  2846        END-STRING
  2847     ELSE
  2848        MOVE '00/00/0000'        TO VA-EFFDATE
  2849     END-IF
  2850     PERFORM 4100-CREATE-ARCHIVE THRU 4100-EXIT.
  2851     GO TO 8000-RETURN
  2852     .
  2853 1000-GET-ERRATE.
  2854     MOVE ALL '9'                TO ERRATE-KEY
  2855     MOVE VD-COMPANY-CD          TO RATE-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* ELVADS.cbl
  2856     MOVE ZEROS                  TO RATE-STATE-CODE
  2857     MOVE VD-STATE               TO RATE-ST-CODE
  2858     MOVE 'L'                    TO RATE-L-AH
  2859     IF GROSS-CERT
  2860        IF VD-LF-BENEFIT-CD = '01'
  2861           MOVE '05'             TO RATE-LAH-NUM
  2862        ELSE
  2863           MOVE '06'             TO RATE-LAH-NUM
  2864        END-IF
  2865     END-IF
  2866     IF NET-CERT
  2867        IF VD-LF-BENEFIT-CD = '05'
  2868           MOVE '01'             TO RATE-LAH-NUM
  2869        ELSE
  2870           MOVE '03'             TO RATE-LAH-NUM
  2871        END-IF
  2872     END-IF
  2873     MOVE 99                     TO RATE-HIGH-AGE
  2874     MOVE VD-LF-BENEFIT-AMT    TO RATE-HIGH-AMT
  2875     MOVE VD-CERT-EFF-DT         TO DC-BIN-DATE-1
  2876     MOVE SPACE                  TO DC-OPTION-CODE
  2877     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  2878     IF NO-CONVERSION-ERROR
  2879        MOVE ZEROS               TO RATE-EXPIRY-DATE
  2880                                    WS-HOLD-RATE-EXP-DT
  2881        MOVE DC-GREG-DATE-CYMD   TO WS-HOLD-RATE-EXP-AL(4:8)
  2882        MOVE WS-HOLD-RATE-EXP-DT TO RATE-EXPIRY-DATE
  2883        MOVE ERRATE-KEY          TO SAVE-ERRATE-KEY
  2884     ELSE
  2885        MOVE 00099999999         TO RATE-EXPIRY-DATE
  2886     END-IF
  2887     PERFORM 1010-STARTBR-ERRATE THRU 1010-EXIT
  2888     IF RESP-NORMAL
  2889       PERFORM UNTIL
  2890        (FOUND-VA-RATE)
  2891        OR (NO-VA-RATE-FOUND)
  2892        OR (NOT RESP-NORMAL)
  2893        PERFORM 1020-READNEXT-ERRATE
  2894                                 THRU 1020-EXIT
  2895        IF (RT-STATE-CODE = SVRT-STATE-CODE)
  2896           AND (RT-L-AH-CODE = SVRT-L-AH-CODE)
  2897           IF (RT-HIGH-AMT > SVRT-HIGH-AMT)
  2898              AND (RT-EXPIRY-DATE > SVRT-EXPIRY-DATE)
  2899              SET FOUND-VA-RATE     TO TRUE
  2900              IF SVRT-LAH-NUM = '05' OR '06'
  2901                 MOVE RT-DISCOUNT-OB-RATE
  2902                                 TO OBRATE
  2903              ELSE
  2904                 COMPUTE LF-RATE = RT-L-RATE (N) / (N / 12)
  2905              END-IF
  2906           END-IF
  2907        ELSE
  2908           SET NO-VA-RATE-FOUND  TO TRUE
  2909        END-IF
  2910       END-PERFORM
  2911     END-IF
  2912     .
  2913 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* ELVADS.cbl
  2914     EXIT.
  2915 1010-STARTBR-ERRATE.
  2916
  2917* EXEC CICS STARTBR
  2918*       DATASET    ('ERRATE')
  2919*       RIDFLD     (ERRATE-KEY)
  2920*       RESP       (WS-RESPONSE)
  2921*    END-EXEC
  2922     MOVE 'ERRATE' TO DFHEIV1
  2923     MOVE 0
  2924       TO DFHEIV11
  2925*    MOVE '&,         G          &  N#00002912' TO DFHEIV0
  2926     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2927     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2928     MOVE X'204E233030303032393132' TO DFHEIV0(25:11)
  2929     CALL 'kxdfhei1' USING DFHEIV0,
  2930           DFHEIV1,
  2931           ERRATE-KEY,
  2932           DFHEIV99,
  2933           DFHEIV11,
  2934           DFHEIV99
  2935     MOVE EIBRESP  TO WS-RESPONSE
  2936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2937     .
  2938 1010-EXIT.
  2939     EXIT.
  2940 1020-READNEXT-ERRATE.
  2941
  2942* EXEC CICS READNEXT
  2943*       DATASET    ('ERRATE')
  2944*       RIDFLD     (ERRATE-KEY)
  2945*       INTO       (RATE-RECORD)
  2946*       RESP       (WS-RESPONSE)
  2947*    END-EXEC
  2948     MOVE LENGTH OF
  2949      RATE-RECORD
  2950       TO DFHEIV12
  2951     MOVE 'ERRATE' TO DFHEIV1
  2952     MOVE 0
  2953       TO DFHEIV11
  2954*    MOVE '&.IL                  )  N#00002921' TO DFHEIV0
  2955     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2956     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2957     MOVE X'204E233030303032393231' TO DFHEIV0(25:11)
  2958     CALL 'kxdfhei1' USING DFHEIV0,
  2959           DFHEIV1,
  2960           RATE-RECORD,
  2961           DFHEIV12,
  2962           ERRATE-KEY,
  2963           DFHEIV99,
  2964           DFHEIV11,
  2965           DFHEIV99,
  2966           DFHEIV99
  2967     MOVE EIBRESP  TO WS-RESPONSE
  2968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2969     .
  2970 1020-EXIT.
  2971     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* ELVADS.cbl
  2972 2000-BUILD-NET-AMTS.
  2973     COMPUTE WS-NET-PMT-1 = PRINC-AMT / (ANGLEN - LF)
  2974     IF AHRATE NOT = ZEROS
  2975        COMPUTE WS-NET-PMT-2 = PRINC-AMT /
  2976         (ANGLEN - (N * AHRATE / 100))
  2977     END-IF
  2978     COMPUTE WS-NET-PMT-3 = PRINC-AMT /
  2979       (ANGLEN - LF - (N * AHRATE / 100))
  2980     COMPUTE WS-NET-PMT-4 = PRINC-AMT / ANGLEN
  2981     COMPUTE WS-NET-PREM-1 = SP * WS-NET-PMT-1 * ANGLEN *
  2982       (1 + (Z * I)) / 100
  2983     COMPUTE WS-NET-PREM-2 = WS-NET-PMT-2 * N * AHRATE / 100
  2984     COMPUTE WS-NET-PREM-3 = (SP * WS-NET-PMT-3 * ANGLEN *
  2985       (1 + (Z * I)) / 100) + (WS-NET-PMT-3 * N * AHRATE / 100)
  2986     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  2987        AND (VD-AH-BENEFIT-CD = '00' OR '  ')
  2988        COMPUTE VA-CL-NET-AMT = PRINC-AMT + WS-NET-PREM-1
  2989        MOVE WS-NET-PMT-1        TO VA-CL-NET-PMT
  2990        MOVE WS-NET-PREM-1       TO VA-CL-NET-PRM
  2991     END-IF
  2992     IF (VD-LF-BENEFIT-CD = '00' OR '  ')
  2993        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  2994        IF WS-NET-PREM-2 NOT = ZEROS
  2995           COMPUTE VA-CD-NET-AMT = PRINC-AMT + WS-NET-PREM-2
  2996        END-IF
  2997        MOVE WS-NET-PMT-2        TO VA-CD-NET-PMT
  2998        MOVE WS-NET-PREM-2       TO VA-CD-NET-PRM
  2999     END-IF
  3000     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  3001        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  3002        COMPUTE VA-CLD-NET-AMT = PRINC-AMT + WS-NET-PREM-3
  3003        MOVE WS-NET-PMT-3        TO VA-CLD-NET-PMT
  3004        MOVE WS-NET-PREM-3       TO VA-CLD-NET-PRM
  3005     END-IF
  3006     MOVE PRINC-AMT              TO VA-NO-NET-AMT
  3007     MOVE WS-NET-PMT-4           TO VA-NO-NET-PMT
  3008     MOVE WS-NET-PREM-4           TO VA-NO-NET-PRM
  3009     .
  3010 2000-EXIT.
  3011     EXIT.
  3012 3000-BUILD-GROSS-AMTS.
  3013*    COMPUTE WS-GROSS-PMT-1 = PRINC-AMT /
  3014*      (ANGLENY - (N * (N + ((D - T) / T)) / 12 * LF-RATE / 100))
  3015*    COMPUTE WS-GROSS-PMT-1 = AMT-FINANCED / ANGLEN
  3016     COMPUTE WS-GROSS-PMT-1 = PRINC-AMT / (ANGLEN -
  3017       (N * N / 12 * LF-RATE / 100))
  3018*    COMPUTE WS-GROSS-PMT-2 = PRINC-AMT /
  3019*      (ANGLENY - (N * AHRATE / 100))
  3020     COMPUTE WS-GROSS-PMT-2 = PRINC-AMT /
  3021       (ANGLEN - (N * AHRATE / 100))
  3022*    COMPUTE WS-GROSS-PMT-3 = PRINC-AMT /
  3023*      (ANGLENY - ((N * (N + ((D - T) / T)) /
  3024*      12 * LF-RATE / 100) + (N * AHRATE / 100)))
  3025*    COMPUTE WS-GROSS-PMT-3 = (AMT-FINANCED / ANGLEN)
  3026*      + (N * AHRATE / 100)
  3027     COMPUTE WS-GROSS-PMT-3 = PRINC-AMT /
  3028        (ANGLEN - ((N * N / 12 * LF-RATE / 100)
  3029       + (N * AHRATE / 100)))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* ELVADS.cbl
  3030*    COMPUTE WS-GROSS-PMT-4 = PRINC-AMT / ANGLENY
  3031     COMPUTE WS-GROSS-PMT-4 = PRINC-AMT / ANGLEN
  3032*    COMPUTE WS-GROSS-PREM-1 = WS-GROSS-PMT-1 *
  3033*      N * (N + ((D - T) / T)) / 12 * LF-RATE / 100
  3034     COMPUTE WS-GROSS-PREM-1 = WS-GROSS-PMT-1 *
  3035       N * N / 12 * LF-RATE / 100
  3036     COMPUTE WS-GROSS-PREM-2 = WS-GROSS-PMT-2 * N * AHRATE / 100
  3037*    COMPUTE WS-GROSS-PREM-3 = (WS-GROSS-PMT-3 * N *
  3038*      (N + ((D - T) / T)) / 12 * LF-RATE / 100) +
  3039*      (WS-GROSS-PMT-3 * N * AHRATE / 100)
  3040     COMPUTE WS-GROSS-PREM-3 = (WS-GROSS-PMT-3 * N *
  3041       N / 12 * LF-RATE / 100) +
  3042       (WS-GROSS-PMT-3 * N * AHRATE / 100)
  3043     MOVE ZEROS                  TO WS-GROSS-PREM-4
  3044     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  3045        AND (VD-AH-BENEFIT-CD = '00' OR '  ')
  3046        COMPUTE VA-CL-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-1
  3047        MOVE WS-GROSS-PMT-1      TO VA-CL-GRS-PMT
  3048        MOVE WS-GROSS-PREM-1     TO VA-CL-GRS-PRM
  3049     END-IF
  3050     IF (VD-LF-BENEFIT-CD = '00' OR '  ')
  3051        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  3052        COMPUTE VA-CD-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-2
  3053        MOVE WS-GROSS-PMT-2      TO VA-CD-GRS-PMT
  3054        MOVE WS-GROSS-PREM-2     TO VA-CD-GRS-PRM
  3055     END-IF
  3056     IF (VD-LF-BENEFIT-CD NOT = '00' AND '  ')
  3057        AND (VD-AH-BENEFIT-CD NOT = '00' AND '  ')
  3058        COMPUTE VA-CLD-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-3
  3059        MOVE WS-GROSS-PMT-3      TO VA-CLD-GRS-PMT
  3060        MOVE WS-GROSS-PREM-3     TO VA-CLD-GRS-PRM
  3061     END-IF
  3062     COMPUTE VA-NO-GRS-AMT = PRINC-AMT
  3063     MOVE WS-GROSS-PMT-4           TO VA-NO-GRS-PMT
  3064     MOVE WS-GROSS-PREM-4           TO VA-NO-GRS-PRM
  3065     .
  3066 3000-EXIT.
  3067     EXIT.
  3068 3500-BUILD-AH-AMTS.
  3069     MOVE VD-AH-BENEFIT-AMT    TO CUR-PMT
  3070     COMPUTE AMT-FINANCED = CUR-PMT * ANGLEN
  3071     COMPUTE PRINC-AMT = AMT-FINANCED - LFPREM - AHPREM
  3072     COMPUTE WS-GROSS-PMT-2 = PRINC-AMT /
  3073       (ANGLEN - (N * AHRATE / 100))
  3074     COMPUTE WS-GROSS-PMT-4 = PRINC-AMT / ANGLEN
  3075     COMPUTE WS-GROSS-PREM-2 = WS-GROSS-PMT-2 * N * AHRATE / 100
  3076     MOVE ZEROS                  TO WS-GROSS-PREM-4
  3077     COMPUTE VA-CD-GRS-AMT = PRINC-AMT + WS-GROSS-PREM-2
  3078     COMPUTE VA-NO-GRS-AMT = PRINC-AMT
  3079*    MOVE WS-GROSS-PMT-1           TO VA-CL-GRS-PMT
  3080     MOVE WS-GROSS-PMT-2           TO VA-CD-GRS-PMT
  3081*    MOVE WS-GROSS-PMT-3           TO VA-CLD-GRS-PMT
  3082     MOVE WS-GROSS-PMT-4           TO VA-NO-GRS-PMT
  3083*    MOVE WS-GROSS-PREM-1           TO VA-CL-GRS-PRM
  3084     MOVE WS-GROSS-PREM-2           TO VA-CD-GRS-PRM
  3085*    MOVE WS-GROSS-PREM-3           TO VA-CLD-GRS-PRM
  3086     MOVE WS-GROSS-PREM-4           TO VA-NO-GRS-PRM
  3087     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* ELVADS.cbl
  3088 3500-EXIT.
  3089     EXIT.
  3090 4000-BUILD-LEVEL-AMTS.
  3091     MOVE 1                      TO N
  3092     COMPUTE PPY = 1 / M * 12
  3093     COMPUTE T = 360 * M / 12
  3094     COMPUTE D = D + T
  3095     COMPUTE I = VD-LOAN-APR / PPY / 100
  3096     COMPUTE Y = (1 + (D * I / T)) / (1 + I)
  3097     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** 1) / I
  3098     COMPUTE ANGLENY = ANGLEN / Y
  3099     COMPUTE PRINC-AMT = (LFAMT * ANGLENY) - LFPREM
  3100     COMPUTE WS-LEVEL-PMT-1 = PRINC-AMT / (ANGLENY -
  3101        (1 * ((1 + (D - T) / T) / PPY) * (LF-RATE / 100)))
  3102     COMPUTE WS-LEVEL-PMT-4 = PRINC-AMT / ANGLENY
  3103     COMPUTE WS-LEVEL-PREM-1 = WS-LEVEL-PMT-1 *
  3104        (1 * ((1 + (D - T) / T) / PPY) * (LF-RATE / 100))
  3105     MOVE ZEROS                  TO WS-LEVEL-PREM-4
  3106     MOVE WS-LEVEL-PMT-1           TO VA-CL-LEV-PMT
  3107     MOVE WS-LEVEL-PMT-4           TO VA-NO-LEV-PMT
  3108     MOVE WS-LEVEL-PREM-1           TO VA-CL-LEV-PRM
  3109     MOVE WS-LEVEL-PREM-4           TO VA-NO-LEV-PRM
  3110     COMPUTE VA-CL-LEV-AMT = PRINC-AMT + WS-LEVEL-PREM-1
  3111     MOVE PRINC-AMT              TO VA-NO-LEV-AMT
  3112     .
  3113 4000-EXIT.
  3114     EXIT.
  3115
  3116 4100-CREATE-ARCHIVE.
  3117
  3118     PERFORM 4125-GET-CSR-INFO THRU 4125-EXIT.
  3119     PERFORM 4250-GET-ELLETR   THRU 4250-EXIT.
  3120     PERFORM 4500-GET-ARCH-NO  THRU 4500-EXIT.
  3121     PERFORM 4700-GET-ELENCC   THRU 4700-EXIT.
  3122     PERFORM 5700-WRITE-EXTR THRU 5700-EXIT.
  3123
  3124 4100-EXIT.
  3125     EXIT.
  3126
  3127 4125-GET-CSR-INFO.
  3128
  3129     MOVE VD-PROC-ID             TO VA-PROC-ID
  3130     MOVE VD-CSR-ID              TO VA-CSR-CODE
  3131     MOVE VD-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  3132     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  3133     MOVE VD-CSR-ID              TO WS-ELCNTL-GENL
  3134     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  3135
  3136* EXEC CICS READ
  3137*       INTO    (CONTROL-FILE)
  3138*       DATASET ('ELCNTL')
  3139*       RIDFLD  (WS-ELCNTL-KEY)
  3140*       RESP    (WS-RESPONSE)
  3141*    END-EXEC
  3142     MOVE LENGTH OF
  3143      CONTROL-FILE
  3144       TO DFHEIV11
  3145     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* ELVADS.cbl
  3146*    MOVE '&"IL       E          (  N#00003093' TO DFHEIV0
  3147     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3149     MOVE X'204E233030303033303933' TO DFHEIV0(25:11)
  3150     CALL 'kxdfhei1' USING DFHEIV0,
  3151           DFHEIV1,
  3152           CONTROL-FILE,
  3153           DFHEIV11,
  3154           WS-ELCNTL-KEY,
  3155           DFHEIV99,
  3156           DFHEIV99,
  3157           DFHEIV99
  3158     MOVE EIBRESP  TO WS-RESPONSE
  3159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3160     IF RESP-NORMAL
  3161        MOVE CF-PROCESSOR-NAME   TO VA-CSR-NAME
  3162                                    VA-PROC-NAME
  3163        MOVE VD-CSR-ID           TO VA-CSR-TITLE
  3164                                    VA-PROC-TITLE
  3165     END-IF
  3166
  3167     IF VD-PROC-ID NOT = VD-CSR-ID
  3168        MOVE VD-COMP-ID          TO WS-ELCNTL-COMPANY-ID
  3169        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  3170        MOVE VD-PROC-ID          TO WS-ELCNTL-GENL
  3171        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  3172
  3173* EXEC CICS READ
  3174*          INTO    (CONTROL-FILE)
  3175*          DATASET ('ELCNTL')
  3176*          RIDFLD  (WS-ELCNTL-KEY)
  3177*          RESP    (WS-RESPONSE)
  3178*       END-EXEC
  3179     MOVE LENGTH OF
  3180      CONTROL-FILE
  3181       TO DFHEIV11
  3182     MOVE 'ELCNTL' TO DFHEIV1
  3183*    MOVE '&"IL       E          (  N#00003111' TO DFHEIV0
  3184     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3186     MOVE X'204E233030303033313131' TO DFHEIV0(25:11)
  3187     CALL 'kxdfhei1' USING DFHEIV0,
  3188           DFHEIV1,
  3189           CONTROL-FILE,
  3190           DFHEIV11,
  3191           WS-ELCNTL-KEY,
  3192           DFHEIV99,
  3193           DFHEIV99,
  3194           DFHEIV99
  3195     MOVE EIBRESP  TO WS-RESPONSE
  3196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3197        IF RESP-NORMAL
  3198           MOVE CF-PROCESSOR-NAME   TO VA-PROC-NAME
  3199           MOVE VD-PROC-ID          TO VA-PROC-TITLE
  3200        END-IF
  3201     END-IF
  3202
  3203     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* ELVADS.cbl
  3204 4125-EXIT.
  3205     EXIT.
  3206
  3207 4250-GET-ELLETR.
  3208
  3209     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  3210     MOVE VD-LETTER-ID           TO WS-ELLETR-LETTER-ID
  3211     MOVE +0                     TO WS-ELLETR-SEQ-NO
  3212     MOVE SPACES                 TO W-Z-CONTROL-DATA
  3213
  3214
  3215* EXEC CICS READ
  3216*         DATASET    ('ELLETR')
  3217*         INTO       (TEXT-FILES)
  3218*         RIDFLD     (WS-ELLETR-KEY)
  3219*         RESP       (WS-RESPONSE)
  3220*         GTEQ
  3221*    END-EXEC
  3222     MOVE LENGTH OF
  3223      TEXT-FILES
  3224       TO DFHEIV11
  3225     MOVE 'ELLETR' TO DFHEIV1
  3226*    MOVE '&"IL       G          (  N#00003134' TO DFHEIV0
  3227     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  3228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3229     MOVE X'204E233030303033313334' TO DFHEIV0(25:11)
  3230     CALL 'kxdfhei1' USING DFHEIV0,
  3231           DFHEIV1,
  3232           TEXT-FILES,
  3233           DFHEIV11,
  3234           WS-ELLETR-KEY,
  3235           DFHEIV99,
  3236           DFHEIV99,
  3237           DFHEIV99
  3238     MOVE EIBRESP  TO WS-RESPONSE
  3239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3240
  3241     IF RESP-NORMAL
  3242        IF (LETTER-FILE-TEXT)
  3243           AND (VD-LETTER-ID = TX-LETTER-NO)
  3244           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  3245           PERFORM 4280-PROCESS-Z-CONTROLS
  3246                                 THRU 4280-EXIT
  3247        END-IF
  3248     END-IF
  3249
  3250     .
  3251 4250-EXIT.
  3252     EXIT.
  3253
  3254
  3255 4280-PROCESS-Z-CONTROLS.
  3256
  3257     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  3258
  3259     .
  3260 4280-EXIT.
  3261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* ELVADS.cbl
  3262
  3263
  3264 4500-GET-ARCH-NO.
  3265
  3266     MOVE VD-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  3267     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  3268     MOVE SPACES                 TO WS-ELCNTL-GENL
  3269     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  3270
  3271
  3272* EXEC CICS READ
  3273*       INTO    (CONTROL-FILE)
  3274*       DATASET ('ELCNTL')
  3275*       RIDFLD  (WS-ELCNTL-KEY)
  3276*       UPDATE
  3277*       RESP    (WS-RESPONSE)
  3278*    END-EXEC
  3279     MOVE LENGTH OF
  3280      CONTROL-FILE
  3281       TO DFHEIV11
  3282     MOVE 'ELCNTL' TO DFHEIV1
  3283*    MOVE '&"IL       EU         (  N#00003172' TO DFHEIV0
  3284     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3285     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3286     MOVE X'204E233030303033313732' TO DFHEIV0(25:11)
  3287     CALL 'kxdfhei1' USING DFHEIV0,
  3288           DFHEIV1,
  3289           CONTROL-FILE,
  3290           DFHEIV11,
  3291           WS-ELCNTL-KEY,
  3292           DFHEIV99,
  3293           DFHEIV99,
  3294           DFHEIV99
  3295     MOVE EIBRESP  TO WS-RESPONSE
  3296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3297
  3298     IF RESP-NORMAL
  3299        AND (CF-COMPANY-ID  = VD-COMP-ID)
  3300        AND (CF-RECORD-TYPE = '1')
  3301        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  3302        MOVE CF-CREDIT-LAST-ARCH-NUM
  3303                                 TO WS-ARCHIVE-NO
  3304
  3305* EXEC CICS REWRITE
  3306*          FROM    (CONTROL-FILE)
  3307*          DATASET ('ELCNTL')
  3308*       END-EXEC
  3309     MOVE LENGTH OF
  3310      CONTROL-FILE
  3311       TO DFHEIV11
  3312     MOVE 'ELCNTL' TO DFHEIV1
  3313*    MOVE '&& L                  %   #00003186' TO DFHEIV0
  3314     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3315     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3316     MOVE X'2020233030303033313836' TO DFHEIV0(25:11)
  3317     CALL 'kxdfhei1' USING DFHEIV0,
  3318           DFHEIV1,
  3319           CONTROL-FILE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* ELVADS.cbl
  3320           DFHEIV11,
  3321           DFHEIV99
  3322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3323     ELSE
  3324        MOVE +0                  TO WS-ARCHIVE-NO
  3325     END-IF
  3326
  3327*** IF AN ARCHIVE NUMBER IS PASSED TO THIS PGM THEN
  3328*** IT IS SAVED IN VA-ARCH-NO.  THE VA DISC LETTER
  3329*** WILL CREATE A DIFFERENT ARCH NO.
  3330     IF VD-ARCHIVE-NO GREATER THAN ZERO
  3331         MOVE VD-ARCHIVE-NO      TO VA-ARCH-NO
  3332     ELSE
  3333         MOVE WS-ARCHIVE-NO      TO VA-ARCH-NO
  3334     END-IF
  3335    .
  3336 4500-EXIT.
  3337     EXIT.
  3338
  3339
  3340 4700-GET-ELENCC.
  3341
  3342     MOVE SPACES                 TO WS-ELENCC-KEY
  3343     MOVE WS-COMPANY-CD          TO WS-ELENCC-COMPANY-CD
  3344     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  3345     MOVE W-ENCLOSURE-CD         TO WS-ELENCC-ENC-CODE
  3346     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  3347        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  3348        OR (E1 > +5)
  3349     END-PERFORM
  3350
  3351     IF E1 < +5
  3352        MOVE VD-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  3353     END-IF
  3354
  3355
  3356* EXEC CICS READ
  3357*        DATASET   ('ELENCC')
  3358*        INTO      (ENCLOSURE-CODES)
  3359*        RIDFLD    (WS-ELENCC-KEY)
  3360*        RESP      (WS-RESPONSE)
  3361*    END-EXEC
  3362     MOVE LENGTH OF
  3363      ENCLOSURE-CODES
  3364       TO DFHEIV11
  3365     MOVE 'ELENCC' TO DFHEIV1
  3366*    MOVE '&"IL       E          (  N#00003222' TO DFHEIV0
  3367     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3369     MOVE X'204E233030303033323232' TO DFHEIV0(25:11)
  3370     CALL 'kxdfhei1' USING DFHEIV0,
  3371           DFHEIV1,
  3372           ENCLOSURE-CODES,
  3373           DFHEIV11,
  3374           WS-ELENCC-KEY,
  3375           DFHEIV99,
  3376           DFHEIV99,
  3377           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* ELVADS.cbl
  3378     MOVE EIBRESP  TO WS-RESPONSE
  3379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3380
  3381     IF NOT RESP-NORMAL
  3382        MOVE W-ENCLOSURE-CD    TO WS-ELENCC-ENC-CODE
  3383
  3384* EXEC CICS READ
  3385*           DATASET   ('ELENCC')
  3386*           INTO      (ENCLOSURE-CODES)
  3387*           RIDFLD    (WS-ELENCC-KEY)
  3388*           RESP      (WS-RESPONSE)
  3389*       END-EXEC
  3390     MOVE LENGTH OF
  3391      ENCLOSURE-CODES
  3392       TO DFHEIV11
  3393     MOVE 'ELENCC' TO DFHEIV1
  3394*    MOVE '&"IL       E          (  N#00003231' TO DFHEIV0
  3395     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3397     MOVE X'204E233030303033323331' TO DFHEIV0(25:11)
  3398     CALL 'kxdfhei1' USING DFHEIV0,
  3399           DFHEIV1,
  3400           ENCLOSURE-CODES,
  3401           DFHEIV11,
  3402           WS-ELENCC-KEY,
  3403           DFHEIV99,
  3404           DFHEIV99,
  3405           DFHEIV99
  3406     MOVE EIBRESP  TO WS-RESPONSE
  3407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3408     END-IF
  3409
  3410     IF RESP-NORMAL
  3411        MOVE NC-OUTPUT-STACK     TO VA-STACK
  3412        MOVE NC-ENCLOSURE-LINE   TO VA-ENC-LINE
  3413        MOVE NC-ATTACHMENTS      TO VA-ATTACH
  3414        MOVE 'N'                 TO VA-PRINT-NOW
  3415     END-IF
  3416
  3417     .
  3418 4700-EXIT.
  3419     EXIT.
  3420
  3421
  3422 5000-BUILD-ERARCH.
  3423
  3424* DATA SOURCE MEANINGS  BL-DATA-SRCE
  3425*    1) FROM ACCT MAINT
  3426*    2) FROM CERT UPDATE
  3427*    3) FROM COMP MAINT
  3428*    4) FROM REVIEW AND CORRECTIONS
  3429******************************************************************
  3430
  3431
  3432     MOVE 'LA'                   TO LETTER-ARCHIVE
  3433
  3434     MOVE WS-ARCHIVE-NO          TO LA-ARCHIVE-NO
  3435                                    LA-ARCHIVE-NO-A2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* ELVADS.cbl
  3436                                    LA-ARCHIVE-NO-A3
  3437                                    LA-ARCHIVE-NO-A4
  3438                                    LA-ARCHIVE-NO-A5
  3439                                    LA-ARCHIVE-NO-A6
  3440
  3441     MOVE VD-COMPANY-CD          TO LA-COMPANY-CD
  3442                                    LA-COMPANY-CD-A2
  3443                                    LA-COMPANY-CD-A3
  3444                                    LA-COMPANY-CD-A4
  3445                                    LA-COMPANY-CD-A5
  3446                                    LA-COMPANY-CD-A6
  3447     MOVE VD-CARRIER             TO LA-CARRIER-A2
  3448                                    LA-CARRIER-A3
  3449                                    LA-CARRIER-A4
  3450                                    LA-CARRIER-A5
  3451     MOVE VD-GROUPING            TO LA-GROUPING-A2
  3452                                    LA-GROUPING-A3
  3453                                    LA-GROUPING-A4
  3454                                    LA-GROUPING-A5
  3455     MOVE VD-ACCOUNT             TO LA-ACCOUNT-A2
  3456                                    LA-ACCOUNT-A3
  3457                                    LA-ACCOUNT-A4
  3458                                    LA-ACCOUNT-A5
  3459     MOVE VD-STATE               TO LA-STATE-A2
  3460                                    LA-STATE-A3
  3461                                    LA-STATE-A4
  3462                                    LA-STATE-A5
  3463     MOVE VD-CERT-EFF-DT         TO LA-EFFECT-DATE-A2
  3464     MOVE VD-CERT-NO             TO LA-CERT-NO-A2
  3465
  3466     MOVE VD-ENTRY-BATCH         TO LA-ENTRY-A6
  3467
  3468     MOVE VD-PROC-ID             TO LA-PROCESSOR-CD
  3469
  3470     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  3471                                    LA-INITIAL-PRINT-DATE
  3472                                    LA-SENT-DATE
  3473                                    LA-REPLY-DATE
  3474                                    LA-RESEND-DATE
  3475                                    LA-FOLLOW-UP-DATE
  3476
  3477     MOVE 'A'                    TO LA-STATUS
  3478     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  3479     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  3480     MOVE VD-LETTER-ID           TO LA-FORM-A3
  3481     MOVE SPACES                 TO LA-DATA-SOURCE
  3482     MOVE 'B'                    TO LA-ARCHIVE-STATUS
  3483     MOVE VD-CURRENT-DATE        TO LA-CREATION-DATE
  3484     MOVE 'Y'                    TO LA-VA-DISCLOSURE-IND
  3485     MOVE VD-CURRENT-DATE        TO LA-LAST-MAINT-DATE
  3486     MOVE VD-CURRENT-TIME        TO LA-LAST-MAINT-TIME
  3487     MOVE VD-PROC-ID             TO LA-LAST-UPDATED-BY
  3488
  3489     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  3490                                    LA-NO-OF-TEXT-RECORDS
  3491
  3492
  3493* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* ELVADS.cbl
  3494*         DATASET   ('ERARCH')
  3495*         FROM      (LETTER-ARCHIVE)
  3496*         RIDFLD    (LA-CONTROL-PRIMARY)
  3497*         RESP      (WS-RESPONSE)
  3498*    END-EXEC
  3499     MOVE LENGTH OF
  3500      LETTER-ARCHIVE
  3501       TO DFHEIV11
  3502     MOVE 'ERARCH' TO DFHEIV1
  3503*    MOVE '&$ L                  ''  N#00003321' TO DFHEIV0
  3504     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3506     MOVE X'204E233030303033333231' TO DFHEIV0(25:11)
  3507     CALL 'kxdfhei1' USING DFHEIV0,
  3508           DFHEIV1,
  3509           LETTER-ARCHIVE,
  3510           DFHEIV11,
  3511           LA-CONTROL-PRIMARY,
  3512           DFHEIV99,
  3513           DFHEIV99
  3514     MOVE EIBRESP  TO WS-RESPONSE
  3515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3516
  3517     IF NOT RESP-NORMAL
  3518        SET ARCH-FAIL TO TRUE
  3519     END-IF
  3520
  3521     .
  3522 5000-EXIT.
  3523     EXIT.
  3524
  3525
  3526 5700-WRITE-EXTR.
  3527
  3528     PERFORM 5000-BUILD-ERARCH   THRU 5000-EXIT
  3529     IF ARCH-FAIL
  3530        MOVE ' COULDNT BUILD ERARCH ' TO WS-MESSAGE
  3531        GO TO 5700-EXIT
  3532     END-IF
  3533     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  3534     MOVE WS-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  3535     MOVE +0                     TO NSAS-SEQ-NO
  3536     PERFORM 5710-BUILD-NSASEXTR THRU 5710-EXIT
  3537     PERFORM 5720-WRITE-NSASEXTR THRU 5720-EXIT
  3538     IF ARCH-FAIL
  3539        MOVE ' COULDNT BUILD STD NSASEXTR ' TO WS-MESSAGE
  3540        GO TO 5700-EXIT
  3541     END-IF
  3542     IF W-LETTER-TO-ACCT NOT = SPACES
  3543        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  3544        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  3545        MOVE WS-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  3546        MOVE +1                  TO NSAS-SEQ-NO
  3547        PERFORM 5720-WRITE-NSASEXTR
  3548                                 THRU 5720-EXIT
  3549        IF ARCH-FAIL
  3550           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO WS-MESSAGE
  3551           GO TO 5700-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* ELVADS.cbl
  3552        END-IF
  3553     END-IF
  3554
  3555     IF W-LETTER-TO-BENE NOT = SPACES
  3556        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  3557        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  3558        MOVE WS-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  3559        MOVE +2                  TO NSAS-SEQ-NO
  3560        PERFORM 5720-WRITE-NSASEXTR
  3561                                 THRU 5720-EXIT
  3562        IF ARCH-FAIL
  3563           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO WS-MESSAGE
  3564        END-IF
  3565     END-IF
  3566
  3567     .
  3568 5700-EXIT.
  3569     EXIT.
  3570
  3571 5710-BUILD-NSASEXTR.
  3572
  3573***  i added the extra space in front of the 1st ~
  3574***  only because there may be a letter to acct or bene
  3575
  3576     STRING
  3577         VA-LETTER                ' ~'
  3578         VA-PROC-ID               '~'
  3579         VA-PROC-NAME             '~'
  3580         VA-PROC-TITLE            '~'
  3581         VA-CSR-CODE              '~'
  3582         VA-CSR-NAME              '~'
  3583         VA-CSR-TITLE             '~'
  3584         VA-CARRIER               '~'
  3585         VA-GROUPING              '~'
  3586         VA-STATE                 '~'
  3587         VA-ACCOUNT               '~'
  3588         VA-EFFDATE               '~'
  3589         VA-CERT-NO               '~'
  3590         VA-FIRSTNAME             '~'
  3591         VA-MIDINIT               '~'
  3592         VA-LASTNAME              '~'
  3593         VA-ADDR1                 '~'
  3594         VA-ADDR2                 '~'
  3595         VA-ADDR-CITY             '~'
  3596         VA-ADDR-ST               '~'
  3597         VA-ADDR-ZIP              '~'
  3598         VA-JNT-FIRSTNAME         '~'
  3599         VA-JNT-MIDINIT           '~'
  3600         VA-JNT-LASTNAME          '~'
  3601         VA-ARCH-NO               '~'
  3602         VA-ENC-LINE              '~'
  3603         VA-ATTACH                '~'
  3604         VA-STACK                 '~'
  3605         VA-PRINT-NOW             '~'
  3606         VA-BORROWER              '~'
  3607         VA-BENE                  '~'
  3608         VA-ACCT-NAME             '~'
  3609         VA-SL                    '~'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* ELVADS.cbl
  3610         VA-JL                    '~'
  3611         VA-SA                    '~'
  3612         VA-JA                    '~'
  3613         VA-GD                    '~'
  3614         VA-NP                    '~'
  3615         VA-7R                    '~'
  3616         VA-LL                    '~'
  3617         VA-TN                    '~'
  3618         VA-14R                   '~'
  3619         VA-14E                   '~'
  3620         VA-30R                   '~'
  3621         VA-30E                   '~'
  3622         VA-CL-NET-AMT            '~'
  3623         VA-CL-GRS-AMT            '~'
  3624         VA-CL-LEV-AMT            '~'
  3625         VA-CL-NET-PMT            '~'
  3626         VA-CL-GRS-PMT            '~'
  3627         VA-CL-LEV-PMT            '~'
  3628         VA-CL-NET-PRM            '~'
  3629         VA-CL-GRS-PRM            '~'
  3630         VA-CL-LEV-PRM            '~'
  3631         VA-CD-NET-AMT            '~'
  3632         VA-CD-GRS-AMT            '~'
  3633         VA-CD-LEV-AMT            '~'
  3634         VA-CD-NET-PMT            '~'
  3635         VA-CD-GRS-PMT            '~'
  3636         VA-CD-LEV-PMT            '~'
  3637         VA-CD-NET-PRM            '~'
  3638         VA-CD-GRS-PRM            '~'
  3639         VA-CD-LEV-PRM            '~'
  3640         VA-CLD-NET-AMT           '~'
  3641         VA-CLD-GRS-AMT           '~'
  3642         VA-CLD-LEV-AMT           '~'
  3643         VA-CLD-NET-PMT           '~'
  3644         VA-CLD-GRS-PMT           '~'
  3645         VA-CLD-LEV-PMT           '~'
  3646         VA-CLD-NET-PRM           '~'
  3647         VA-CLD-GRS-PRM           '~'
  3648         VA-CLD-LEV-PRM           '~'
  3649         VA-NO-NET-AMT            '~'
  3650         VA-NO-GRS-AMT            '~'
  3651         VA-NO-LEV-AMT            '~'
  3652         VA-NO-NET-PMT            '~'
  3653         VA-NO-GRS-PMT            '~'
  3654         VA-NO-LEV-PMT            '~'
  3655         VA-NO-NET-PRM            '~'
  3656         VA-NO-GRS-PRM            '~'
  3657         VA-NO-LEV-PRM            '~'
  3658            DELIMITED BY '  ' INTO NSAS-LETTER-VARIABLES
  3659     END-STRING
  3660
  3661     .
  3662 5710-EXIT.
  3663     EXIT.
  3664
  3665 5720-WRITE-NSASEXTR.
  3666
  3667
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* ELVADS.cbl
  3668* EXEC CICS WRITE
  3669*       DATASET    ('NSASEXTR')
  3670*       FROM       (NSAS-EXTRACT-RECORD)
  3671*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  3672*       RESP       (WS-RESPONSE)
  3673*    END-EXEC
  3674     MOVE LENGTH OF
  3675      NSAS-EXTRACT-RECORD
  3676       TO DFHEIV11
  3677     MOVE 'NSASEXTR' TO DFHEIV1
  3678*    MOVE '&$ L                  ''  N#00003478' TO DFHEIV0
  3679     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3680     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3681     MOVE X'204E233030303033343738' TO DFHEIV0(25:11)
  3682     CALL 'kxdfhei1' USING DFHEIV0,
  3683           DFHEIV1,
  3684           NSAS-EXTRACT-RECORD,
  3685           DFHEIV11,
  3686           NSAS-CONTROL-PRIMARY,
  3687           DFHEIV99,
  3688           DFHEIV99
  3689     MOVE EIBRESP  TO WS-RESPONSE
  3690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3691
  3692     IF NOT RESP-NORMAL
  3693        SET ARCH-FAIL TO TRUE
  3694     END-IF
  3695
  3696     .
  3697 5720-EXIT.
  3698     EXIT.
  3699
  3700 8000-RETURN.
  3701
  3702* EXEC CICS RETURN
  3703*    END-EXEC
  3704*    MOVE '.(                    &   #00003494' TO DFHEIV0
  3705     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3707     MOVE X'2020233030303033343934' TO DFHEIV0(25:11)
  3708     CALL 'kxdfhei1' USING DFHEIV0,
  3709           DFHEIV99,
  3710           DFHEIV99,
  3711           DFHEIV99,
  3712           DFHEIV99,
  3713           DFHEIV99
  3714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3715
  3716* GOBACK
  3717
  3718     MOVE '9%                    "   ' TO DFHEIV0
  3719     MOVE 'ELVADS' TO DFHEIV1
  3720     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3721     GOBACK
  3722     .
  3723 9700-DATE-LINK.
  3724     MOVE LINK-ELDATCV           TO PGM-NAME
  3725
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* ELVADS.cbl
  3726* EXEC CICS LINK
  3727*       PROGRAM    (PGM-NAME)
  3728*       COMMAREA   (DATE-CONVERSION-DATA)
  3729*       LENGTH     (DC-COMM-LENGTH)
  3730*    END-EXEC
  3731*    MOVE '."C                   ''   #00003500' TO DFHEIV0
  3732     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3733     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3734     MOVE X'2020233030303033353030' TO DFHEIV0(25:11)
  3735     CALL 'kxdfhei1' USING DFHEIV0,
  3736           PGM-NAME,
  3737           DATE-CONVERSION-DATA,
  3738           DC-COMM-LENGTH,
  3739           DFHEIV99,
  3740           DFHEIV99,
  3741           DFHEIV99
  3742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3743     .
  3744 9700-EXIT.
  3745     EXIT.
  3746
  3747 9999-DFHBACK SECTION.
  3748     MOVE '9%                    "   ' TO DFHEIV0
  3749     MOVE 'ELVADS' TO DFHEIV1
  3750     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3751     GOBACK.
  3752 9999-DFHEXIT.
  3753     IF DFHEIGDJ EQUAL 0001
  3754         NEXT SENTENCE.
  3755     MOVE '9%                    "   ' TO DFHEIV0
  3756     MOVE 'ELVADS' TO DFHEIV1
  3757     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3758     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       11260     Code:       17111
