* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1044.cbl
* Options: int("EL1044.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1044.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1044.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1044.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1044.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1044.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS FOR ACCOUNT SERVICES
    19*    SCREENS     - EL1044Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122011    2011022800001  AJRA  ADD ELCZREC COPYBOOK
    40* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*   EL1044 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    48 77  M1                          PIC S999 COMP-3 VALUE +0.
    49 77  M2                          PIC S999 COMP-3 VALUE +0.
    50 77  WS-STOP-SW                  PIC X  VALUE ' '.
    51     88  I-SAY-TO-STOP              VALUE 'Y'.
    52 77  WS-FIND-SW                  PIC X  VALUE ' '.
    53     88  WE-FOUND-IT                VALUE 'Y'.
    54 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    55 01  ACCESS-KEYS.
    56     12  ELLETR-KEY.
    57         16  ELLETR-COMPANY-CD   PIC X.
    58         16  ELLETR-ACCESS-CD    PIC X(12).
    59         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    60 01  WS-DATE-AREA.
    61     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    62     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    63 01  MISC-WORK-AREAS.
    64     12  WS-RESPONSE             PIC S9(8)   COMP.
    65         88  RESP-NORMAL              VALUE +00.
    66         88  RESP-ERROR               VALUE +01.
    67         88  RESP-NOTFND              VALUE +13.
    68         88  RESP-NOTOPEN             VALUE +19.
    69         88  RESP-ENDFILE             VALUE +20.
    70     12  WS-NUMVAL.
    71         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1044.cbl
    72         16  WS-9V999-OF-DEEDIT REDEFINES
    73             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    74     12  DEEDIT-FIELD                PIC X(11).
    75     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    76                                     PIC S9(11).
    77     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    78                                     PIC S9(09)V99.
    79 01  STANDARD-AREAS.
    80     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    81     12  TRANS-ID                    PIC X(04)   VALUE 'EX1F'.
    82     12  PGM-NAME                    PIC X(08).
    83     12  TIME-IN                     PIC S9(07).
    84     12  TIME-OUT-R  REDEFINES TIME-IN.
    85         16  FILLER                  PIC X(01).
    86         16  TIME-OUT                PIC 99V99.
    87         16  FILLER                  PIC X(02).
    88     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
    89     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
    90     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
    91     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
    92     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
    93     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
    94     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
    95     12  THIS-PGM                    PIC X(08)   VALUE 'EL1044'.
    96     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
    97     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
    98     12  SUB                         PIC 9(02).
    99     12  SUB-1                       PIC 9(02).
   100     12  SUB2                        PIC 9(02).
   101     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   102     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1044S'.
   103     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL1044Z'.
   104     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   105****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   106*                                    COPY ELCZREC.
   107******************************************************************
   108*                                                                *
   109*                                                                *
   110*                            ELCZREC.                            *
   111*                                                                *
   112*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   113*                                                                *
   114******************************************************************
   115*-----------------------------------------------------------------
   116*                   C H A N G E   L O G
   117*
   118* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   119*-----------------------------------------------------------------
   120*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   121* EFFECTIVE    NUMBER
   122*-----------------------------------------------------------------
   123* 122011    2011022800001  AJRA  NEW FILE
   124* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   125*-----------------------------------------------------------------
   126 01  W-Z-CONTROL-DATA.
   127     05  W-NUMBER-OF-COPIES      PIC  9.
   128     05  FILLER                  PIC  X.
   129     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1044.cbl
   130     05  FILLER                  PIC  X.
   131     05  W-DAYS-TO-RESEND        PIC  999.
   132     05  FILLER                  PIC  X.
   133     05  W-FORM-TO-RESEND        PIC  X(4).
   134     05  FILLER                  PIC  X.
   135     05  W-PROMPT-LETTER         PIC  X.
   136     05  FILLER                  PIC  X.
   137     05  W-ENCLOSURE-CD          PIC  XXX.
   138     05  FILLER                  PIC  X.
   139     05  W-AUTO-CLOSE-IND        PIC  X.
   140     05  FILLER                  PIC  X.
   141     05  W-LETTER-TO-BENE        PIC  X.
   142     05  FILLER                  PIC  X.
   143     05  W-LETTER-TO-ACCT        PIC  X.
   144     05  FILLER                  PIC  X.
   145     05  W-LETTER-TYPE           PIC  X.
   146     05  FILLER                  PIC  X.
   147     05  W-PRINT-CERTIFICATE     PIC  X.
   148     05  FILLER                  PIC  X.
   149     05  W-REFUND-REQUIRED       PIC  X.
   150     05  FILLER                  PIC  X.
   151     05  W-ONBASE-CODE           PIC  XX.
   152     05  FILLER                  PIC  X.
   153     05  W-ACCT-SUMM             PIC  X.
   154     05  FILLER                  PIC  X.
   155     05  W-CSO-SUMM              PIC  X.
   156     05  FILLER                  PIC  X(31).
   157*                                    COPY ELCSCTM.
   158******************************************************************
   159*                                                                *
   160*                                                                *
   161*                            ELCSCTM                             *
   162*                            VMOD=2.001                          *
   163*                                                                *
   164*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   165*                                                                *
   166******************************************************************
   167 01  SECURITY-MESSAGE.
   168     12  FILLER                          PIC X(30)
   169            VALUE '** LOGIC SECURITY VIOLATION -'.
   170     12  SM-READ                         PIC X(6).
   171     12  FILLER                          PIC X(5)
   172            VALUE ' PGM='.
   173     12  SM-PGM                          PIC X(6).
   174     12  FILLER                          PIC X(5)
   175            VALUE ' OPR='.
   176     12  SM-PROCESSOR-ID                 PIC X(4).
   177     12  FILLER                          PIC X(6)
   178            VALUE ' TERM='.
   179     12  SM-TERMID                       PIC X(4).
   180     12  FILLER                          PIC XX   VALUE SPACE.
   181     12  SM-JUL-DATE                     PIC 9(5).
   182     12  FILLER                          PIC X    VALUE SPACE.
   183     12  SM-TIME                         PIC 99.99.
   184
   185*                                    COPY ELCSCRTY.
   186******************************************************************
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1044.cbl
   188*                                                                *
   189*                            ELCSCRTY                            *
   190*                            VMOD=2.001                          *
   191*                                                                *
   192*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   193*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   194*        SAVED IN PI-SECURITY-ADDRESS.                           *
   195*                                                                *
   196******************************************************************
   197 01  SECURITY-CONTROL.
   198     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   199     12  FILLER                       PIC XX    VALUE 'SC'.
   200     12  SC-CREDIT-CODES.
   201         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   202             20  SC-CREDIT-DISPLAY    PIC X.
   203             20  SC-CREDIT-UPDATE     PIC X.
   204     12  SC-CLAIMS-CODES.
   205         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   206             20  SC-CLAIMS-DISPLAY    PIC X.
   207             20  SC-CLAIMS-UPDATE     PIC X.
   208 01  ERROR-MESSAGES.
   209     12  ER-0000                     PIC X(04)   VALUE '0000'.
   210     12  ER-0005                     PIC X(04)   VALUE '0005'.
   211     12  ER-0023                     PIC X(04)   VALUE '0023'.
   212     12  ER-0029                     PIC X(04)   VALUE '0029'.
   213     12  ER-0050                     PIC X(04)   VALUE '0050'.
   214     12  ER-0068                     PIC X(04)   VALUE '0068'.
   215     12  ER-0070                     PIC X(04)   VALUE '0070'.
   216     12  ER-0130                     PIC X(04)   VALUE '0130'.
   217     12  ER-0131                     PIC X(04)   VALUE '0131'.
   218     12  ER-0132                     PIC X(04)   VALUE '0132'.
   219     12  ER-0138                     PIC X(04)   VALUE '0138'.
   220     12  ER-0144                     PIC X(04)   VALUE '0144'.
   221     12  ER-0145                     PIC X(04)   VALUE '0145'.
   222     12  ER-0184                     PIC X(04)   VALUE '0184'.
   223     12  ER-0418                     PIC X(04)   VALUE '0418'.
   224     12  ER-0491                     PIC X(04)   VALUE '0491'.
   225     12  ER-0582                     PIC X(04)   VALUE '0582'.
   226     12  ER-0627                     PIC X(04)   VALUE '0627'.
   227     12  ER-0701                     PIC X(04)   VALUE '0701'.
   228     12  ER-0702                     PIC X(04)   VALUE '0702'.
   229     12  ER-0703                     PIC X(04)   VALUE '0703'.
   230     12  ER-0704                     PIC X(04)   VALUE '0704'.
   231     12  ER-0705                     PIC X(04)   VALUE '0705'.
   232     12  ER-0706                     PIC X(04)   VALUE '0706'.
   233     12  ER-0707                     PIC X(04)   VALUE '0707'.
   234     12  ER-0708                     PIC X(04)   VALUE '0708'.
   235     12  ER-0709                     PIC X(04)   VALUE '0709'.
   236     12  ER-0710                     PIC X(04)   VALUE '0710'.
   237     12  ER-0711                     PIC X(04)   VALUE '0711'.
   238     12  ER-0712                     PIC X(04)   VALUE '0712'.
   239     12  ER-0713                     PIC X(04)   VALUE '0713'.
   240     12  ER-0717                     PIC X(04)   VALUE '0717'.
   241     12  ER-0718                     PIC X(04)   VALUE '0718'.
   242     12  ER-0719                     PIC X(04)   VALUE '0719'.
   243     12  ER-0720                     PIC X(04)   VALUE '0720'.
   244     12  ER-0721                     PIC X(04)   VALUE '0721'.
   245     12  ER-0722                     PIC X(04)   VALUE '0722'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1044.cbl
   246     12  ER-0723                     PIC X(04)   VALUE '0723'.
   247     12  ER-0724                     PIC X(04)   VALUE '0724'.
   248     12  ER-0725                     PIC X(04)   VALUE '0725'.
   249     12  ER-0726                     PIC X(04)   VALUE '0726'.
   250     12  ER-0727                     PIC X(04)   VALUE '0727'.
   251     12  ER-0729                     PIC X(04)   VALUE '0729'.
   252     12  ER-0754                     PIC X(04)   VALUE '0754'.
   253     12  ER-1560                     PIC X(04)   VALUE '1560'.
   254     12  ER-1562                     PIC X(04)   VALUE '1562'.
   255     12  ER-1564                     PIC X(04)   VALUE '1564'.
   256     12  ER-2241                     PIC X(04)   VALUE '2241'.
   257     12  ER-2276                     PIC X(04)   VALUE '2276'.
   258     12  ER-3804                     PIC X(04)   VALUE '3804'.
   259     12  ER-3820                     PIC X(04)   VALUE '3820'.
   260     12  ER-3821                     PIC X(04)   VALUE '3821'.
   261     12  ER-7008                     PIC X(04)   VALUE '7008'.
   262     12  ER-7031                     PIC X(04)   VALUE '7031'.
   263     12  ER-7123                     PIC X(04)   VALUE '7123'.
   264     12  ER-8150                     PIC X(04)   VALUE '8150'.
   265     12  ER-9999                     PIC XXXX    VALUE '9999'.
   266*                                    COPY ELCDATE.
   267******************************************************************
   268*                                                                *
   269*                                                                *
   270*                            ELCDATE.                            *
   271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   272*                            VMOD=2.003
   273*                                                                *
   274*                                                                *
   275*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   276*                 LENGTH = 200                                   *
   277******************************************************************
   278
   279 01  DATE-CONVERSION-DATA.
   280     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   281     12  DC-OPTION-CODE                PIC X.
   282         88  BIN-TO-GREG                VALUE ' '.
   283         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   284         88  EDIT-GREG-TO-BIN           VALUE '2'.
   285         88  YMD-GREG-TO-BIN            VALUE '3'.
   286         88  MDY-GREG-TO-BIN            VALUE '4'.
   287         88  JULIAN-TO-BIN              VALUE '5'.
   288         88  BIN-PLUS-ELAPSED           VALUE '6'.
   289         88  FIND-CENTURY               VALUE '7'.
   290         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   291         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   292         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   293         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   294         88  JULIAN-TO-BIN-3            VALUE 'C'.
   295         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   296         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   297         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   298         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   299         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   300         88  CHECK-LEAP-YEAR            VALUE 'H'.
   301         88  BIN-3-TO-GREG              VALUE 'I'.
   302         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   303         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1044.cbl
   304         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   305         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   306         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   307         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   308         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   309         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   310         88  THREE-CHARACTER-BIN
   311                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   312         88  GREGORIAN-TO-BIN
   313                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   314         88  BIN-TO-GREGORIAN
   315                  VALUES ' ' '1' 'I' '8' 'G'.
   316         88  JULIAN-TO-BINARY
   317                  VALUES '5' 'C' 'E' 'F'.
   318     12  DC-ERROR-CODE                 PIC X.
   319         88  NO-CONVERSION-ERROR        VALUE ' '.
   320         88  DATE-CONVERSION-ERROR
   321                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   322         88  DATE-IS-ZERO               VALUE '1'.
   323         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   324         88  DATE-IS-INVALID            VALUE '3'.
   325         88  DATE1-GREATER-DATE2        VALUE '4'.
   326         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   327         88  DATE-INVALID-OPTION        VALUE '9'.
   328         88  INVALID-CENTURY            VALUE 'A'.
   329         88  ONLY-CENTURY               VALUE 'B'.
   330         88  ONLY-LEAP-YEAR             VALUE 'C'.
   331         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   332     12  DC-END-OF-MONTH               PIC X.
   333         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   334     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   335         88  USE-NORMAL-PROCESS         VALUE ' '.
   336         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   337         88  ADJUST-UP-100-YRS          VALUE '2'.
   338     12  FILLER                        PIC X.
   339     12  DC-CONVERSION-DATES.
   340         16  DC-BIN-DATE-1             PIC XX.
   341         16  DC-BIN-DATE-2             PIC XX.
   342         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   343         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   344                       DC-GREG-DATE-1-EDIT.
   345             20  DC-EDIT1-MONTH        PIC 99.
   346             20  SLASH1-1              PIC X.
   347             20  DC-EDIT1-DAY          PIC 99.
   348             20  SLASH1-2              PIC X.
   349             20  DC-EDIT1-YEAR         PIC 99.
   350         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   351         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   352                     DC-GREG-DATE-2-EDIT.
   353             20  DC-EDIT2-MONTH        PIC 99.
   354             20  SLASH2-1              PIC X.
   355             20  DC-EDIT2-DAY          PIC 99.
   356             20  SLASH2-2              PIC X.
   357             20  DC-EDIT2-YEAR         PIC 99.
   358         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   359         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   360                     DC-GREG-DATE-1-YMD.
   361             20  DC-YMD-YEAR           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1044.cbl
   362             20  DC-YMD-MONTH          PIC 99.
   363             20  DC-YMD-DAY            PIC 99.
   364         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   365         16  DC-GREG-DATE-1-MDY-R REDEFINES
   366                      DC-GREG-DATE-1-MDY.
   367             20  DC-MDY-MONTH          PIC 99.
   368             20  DC-MDY-DAY            PIC 99.
   369             20  DC-MDY-YEAR           PIC 99.
   370         16  DC-GREG-DATE-1-ALPHA.
   371             20  DC-ALPHA-MONTH        PIC X(10).
   372             20  DC-ALPHA-DAY          PIC 99.
   373             20  FILLER                PIC XX.
   374             20  DC-ALPHA-CENTURY.
   375                 24 DC-ALPHA-CEN-N     PIC 99.
   376             20  DC-ALPHA-YEAR         PIC 99.
   377         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   378         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   379         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   380         16  DC-JULIAN-DATE            PIC 9(05).
   381         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   382                                       PIC 9(05).
   383         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   384             20  DC-JULIAN-YEAR        PIC 99.
   385             20  DC-JULIAN-DAYS        PIC 999.
   386         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   387         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   388         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   389     12  DATE-CONVERSION-VARIBLES.
   390         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   391         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   392             20  FILLER                PIC 9(3).
   393             20  HOLD-CEN-1-CCYY.
   394                 24  HOLD-CEN-1-CC     PIC 99.
   395                 24  HOLD-CEN-1-YY     PIC 99.
   396             20  HOLD-CEN-1-MO         PIC 99.
   397             20  HOLD-CEN-1-DA         PIC 99.
   398         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   399             20  HOLD-CEN-1-R-MO       PIC 99.
   400             20  HOLD-CEN-1-R-DA       PIC 99.
   401             20  HOLD-CEN-1-R-CCYY.
   402                 24  HOLD-CEN-1-R-CC   PIC 99.
   403                 24  HOLD-CEN-1-R-YY   PIC 99.
   404             20  FILLER                PIC 9(3).
   405         16  HOLD-CENTURY-1-X.
   406             20  FILLER                PIC X(3)  VALUE SPACES.
   407             20  HOLD-CEN-1-X-CCYY.
   408                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   409                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   410             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   411             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   412         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   413             20  HOLD-CEN-1-R-X-MO     PIC XX.
   414             20  HOLD-CEN-1-R-X-DA     PIC XX.
   415             20  HOLD-CEN-1-R-X-CCYY.
   416                 24  HOLD-CEN-1-R-X-CC PIC XX.
   417                 24  HOLD-CEN-1-R-X-YY PIC XX.
   418             20  FILLER                PIC XXX.
   419         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1044.cbl
   420         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   421         16  DC-JULIAN-DATE-1          PIC 9(07).
   422         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   423             20  DC-JULIAN-1-CCYY.
   424                 24  DC-JULIAN-1-CC    PIC 99.
   425                 24  DC-JULIAN-1-YR    PIC 99.
   426             20  DC-JULIAN-DA-1        PIC 999.
   427         16  DC-JULIAN-DATE-2          PIC 9(07).
   428         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   429             20  DC-JULIAN-2-CCYY.
   430                 24  DC-JULIAN-2-CC    PIC 99.
   431                 24  DC-JULIAN-2-YR    PIC 99.
   432             20  DC-JULIAN-DA-2        PIC 999.
   433         16  DC-GREG-DATE-A-EDIT.
   434             20  DC-EDITA-MONTH        PIC 99.
   435             20  SLASHA-1              PIC X VALUE '/'.
   436             20  DC-EDITA-DAY          PIC 99.
   437             20  SLASHA-2              PIC X VALUE '/'.
   438             20  DC-EDITA-CCYY.
   439                 24  DC-EDITA-CENT     PIC 99.
   440                 24  DC-EDITA-YEAR     PIC 99.
   441         16  DC-GREG-DATE-B-EDIT.
   442             20  DC-EDITB-MONTH        PIC 99.
   443             20  SLASHB-1              PIC X VALUE '/'.
   444             20  DC-EDITB-DAY          PIC 99.
   445             20  SLASHB-2              PIC X VALUE '/'.
   446             20  DC-EDITB-CCYY.
   447                 24  DC-EDITB-CENT     PIC 99.
   448                 24  DC-EDITB-YEAR     PIC 99.
   449         16  DC-GREG-DATE-CYMD         PIC 9(08).
   450         16  DC-GREG-DATE-CYMD-R REDEFINES
   451                              DC-GREG-DATE-CYMD.
   452             20  DC-CYMD-CEN           PIC 99.
   453             20  DC-CYMD-YEAR          PIC 99.
   454             20  DC-CYMD-MONTH         PIC 99.
   455             20  DC-CYMD-DAY           PIC 99.
   456         16  DC-GREG-DATE-MDCY         PIC 9(08).
   457         16  DC-GREG-DATE-MDCY-R REDEFINES
   458                              DC-GREG-DATE-MDCY.
   459             20  DC-MDCY-MONTH         PIC 99.
   460             20  DC-MDCY-DAY           PIC 99.
   461             20  DC-MDCY-CEN           PIC 99.
   462             20  DC-MDCY-YEAR          PIC 99.
   463    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   464        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   465    12  DC-EL310-DATE                  PIC X(21).
   466    12  FILLER                         PIC X(28).
   467*                                    COPY ELCLOGOF.
   468******************************************************************
   469*                                                                *
   470*                                                                *
   471*                            ELCLOGOF.                           *
   472*                            VMOD=2.001                          *
   473*                                                                *
   474*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   475*                                                                *
   476******************************************************************
   477 01  CLASIC-LOGOFF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1044.cbl
   478     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   479     12  LOGOFF-TEXT.
   480         16  FILLER          PIC X(5)    VALUE SPACES.
   481         16  LOGOFF-MSG.
   482             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   483             20  FILLER      PIC X       VALUE SPACES.
   484             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   485         16  FILLER          PIC X(80)
   486           VALUE '* YOU ARE NOW LOGGED OFF'.
   487         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   488         16  FILLER          PIC X       VALUE QUOTE.
   489         16  LOGOFF-SYS-MSG  PIC X(17)
   490           VALUE 'S CLAS-IC SYSTEM '.
   491     12  TEXT-MESSAGES.
   492         16  UNACCESS-MSG    PIC X(29)
   493             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   494         16  PGMIDERR-MSG    PIC X(17)
   495             VALUE 'PROGRAM NOT FOUND'.
   496*                                    COPY ELCATTR.
   497******************************************************************
   498*                                                                *
   499*                            ELCATTR.                            *
   500*                            VMOD=2.001                          *
   501*                                                                *
   502*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   503*                                                                *
   504*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   505*                                                                *
   506*                   POS 1   P=PROTECTED                          *
   507*                           U=UNPROTECTED                        *
   508*                           S=ASKIP                              *
   509*                   POS 2   A=ALPHA/NUMERIC                      *
   510*                           N=NUMERIC                            *
   511*                   POS 3   N=NORMAL                             *
   512*                           B=BRIGHT                             *
   513*                           D=DARK                               *
   514*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   515*                           OF=MODIFIED DATA TAG OFF             *
   516*                                                                *
   517*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   518******************************************************************
   519 01  ATTRIBUTE-LIST.
   520     12  AL-PABOF            PIC X       VALUE 'Y'.
   521     12  AL-PABON            PIC X       VALUE 'Z'.
   522     12  AL-PADOF            PIC X       VALUE '%'.
   523     12  AL-PADON            PIC X       VALUE '_'.
   524     12  AL-PANOF            PIC X       VALUE '-'.
   525     12  AL-PANON            PIC X       VALUE '/'.
   526     12  AL-SABOF            PIC X       VALUE '8'.
   527     12  AL-SABON            PIC X       VALUE '9'.
   528     12  AL-SADOF            PIC X       VALUE '@'.
   529     12  AL-SADON            PIC X       VALUE QUOTE.
   530     12  AL-SANOF            PIC X       VALUE '0'.
   531     12  AL-SANON            PIC X       VALUE '1'.
   532     12  AL-UABOF            PIC X       VALUE 'H'.
   533     12  AL-UABON            PIC X       VALUE 'I'.
   534     12  AL-UADOF            PIC X       VALUE '<'.
   535     12  AL-UADON            PIC X       VALUE '('.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1044.cbl
   536     12  AL-UANOF            PIC X       VALUE ' '.
   537     12  AL-UANON            PIC X       VALUE 'A'.
   538     12  AL-UNBOF            PIC X       VALUE 'Q'.
   539     12  AL-UNBON            PIC X       VALUE 'R'.
   540     12  AL-UNDOF            PIC X       VALUE '*'.
   541     12  AL-UNDON            PIC X       VALUE ')'.
   542     12  AL-UNNOF            PIC X       VALUE '&'.
   543     12  AL-UNNON            PIC X       VALUE 'J'.
   544*                                    COPY ELCEMIB.
   545******************************************************************
   546*                                                                *
   547*                                                                *
   548*                            ELCEMIB.                            *
   549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   550*                            VMOD=2.005                          *
   551*                                                                *
   552*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   553*                                                                *
   554******************************************************************
   555 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   556     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   557     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   558     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   559     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   560     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   561     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   562     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   563     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   564     12  EMI-SWITCH1             PIC X        VALUE '1'.
   565         88  EMI-NO-ERRORS                    VALUE '1'.
   566         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   567         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   568     12  EMI-SWITCH2             PIC X        VALUE '1'.
   569         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   570     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   571         88  EMI-AREA1-EMPTY                  VALUE '1'.
   572         88  EMI-AREA1-FULL                   VALUE '2'.
   573     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   574         88  EMI-AREA2-EMPTY                  VALUE '1'.
   575         88  EMI-AREA2-FULL                   VALUE '2'.
   576     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   577         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   578         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   579         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   580         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   581         88  EMI-BYPASS-FATALS                VALUE 'X'.
   582     12  EMI-ERROR-LINES.
   583         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   584         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   585         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   586         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   587             20  EMI-ERR-CODES OCCURS 10 TIMES.
   588                 24  EMI-ERR-NUM         PIC X(4).
   589                 24  EMI-FILLER          PIC X.
   590                 24  EMI-SEV             PIC X.
   591                 24  FILLER              PIC X.
   592             20  FILLER                  PIC X(02).
   593     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1044.cbl
   594         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   595             20  EMI-ERROR-NUMBER    PIC X(4).
   596             20  EMI-FILL            PIC X.
   597             20  EMI-SEVERITY        PIC X.
   598             20  FILLER              PIC X.
   599             20  EMI-ERROR-TEXT.
   600                 24  EMI-TEXT-VARIABLE   PIC X(10).
   601                 24  FILLER          PIC X(55).
   602     12  EMI-SEVERITY-SAVE           PIC X.
   603         88  EMI-NOTE                    VALUE 'N'.
   604         88  EMI-WARNING                 VALUE 'W'.
   605         88  EMI-FORCABLE                VALUE 'F'.
   606         88  EMI-FATAL                   VALUE 'X'.
   607     12  EMI-MESSAGE-FLAG            PIC X.
   608         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   609         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   610     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   611     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   612         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   613         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   614         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   615     12  FILLER                      PIC X(137)  VALUE SPACES.
   616     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   617     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   618     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   619     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   620*                                    COPY ELCJPFX.
   621******************************************************************
   622*                                                                *
   623*                                                                *
   624*                            ELCJPFX.                            *
   625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   626*                            VMOD=2.002                          *
   627*                                                                *
   628*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   629*                                                                *
   630*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   631*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   632*        ELCNTL - CONTROL FILE                                   *
   633*        ELMSTR - CLAIM MASTERS                                  *
   634*        ELTRLR - ACTIVITY TRAILERS                              *
   635*        ELCHKQ - CHECK QUE                                      *
   636******************************************************************
   637 01  JOURNAL-RECORD.
   638     12  JP-USER-ID                  PIC X(4).
   639     12  JP-FILE-ID                  PIC X(8).
   640     12  JP-PROGRAM-ID               PIC X(8).
   641     12  JP-RECORD-TYPE              PIC X.
   642         88 JP-ADD              VALUE 'A'.
   643         88 JP-BEFORE-CHANGE    VALUE 'B'.
   644         88 JP-AFTER-CHANGE     VALUE 'C'.
   645         88 JP-DELETE           VALUE 'D'.
   646         88 JP-GENERIC-DELETE   VALUE 'G'.
   647         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   648         88 JP-KEY-CHG-ADD      VALUE 'N'.
   649     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   650     12  JP-RECORD-AREA
   651
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1044.cbl
   652
   653                                     PIC X(530).
   654*                                    COPY ELCINTF.
   655******************************************************************
   656*                                                                *
   657*                                                                *
   658*                            ELCINTF.                            *
   659*                            VMOD=2.017                          *
   660*                                                                *
   661*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   662*                                                                *
   663*       LENGTH = 1024                                            *
   664*                                                                *
   665******************************************************************
   666*                   C H A N G E   L O G
   667*
   668* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   669*-----------------------------------------------------------------
   670*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   671* EFFECTIVE    NUMBER
   672*-----------------------------------------------------------------
   673* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   674******************************************************************
   675 01  PROGRAM-INTERFACE-BLOCK.
   676     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   677     12  PI-CALLING-PROGRAM              PIC X(8).
   678     12  PI-SAVED-PROGRAM-1              PIC X(8).
   679     12  PI-SAVED-PROGRAM-2              PIC X(8).
   680     12  PI-SAVED-PROGRAM-3              PIC X(8).
   681     12  PI-SAVED-PROGRAM-4              PIC X(8).
   682     12  PI-SAVED-PROGRAM-5              PIC X(8).
   683     12  PI-SAVED-PROGRAM-6              PIC X(8).
   684     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   685     12  PI-COMPANY-ID                   PIC XXX.
   686     12  PI-COMPANY-CD                   PIC X.
   687
   688     12  PI-COMPANY-PASSWORD             PIC X(8).
   689
   690     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   691
   692     12  PI-CONTROL-IN-PROGRESS.
   693         16  PI-CARRIER                  PIC X.
   694         16  PI-GROUPING                 PIC X(6).
   695         16  PI-STATE                    PIC XX.
   696         16  PI-ACCOUNT                  PIC X(10).
   697         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   698                                         PIC X(10).
   699         16  PI-CLAIM-CERT-GRP.
   700             20  PI-CLAIM-NO             PIC X(7).
   701             20  PI-CERT-NO.
   702                 25  PI-CERT-PRIME       PIC X(10).
   703                 25  PI-CERT-SFX         PIC X.
   704             20  PI-CERT-EFF-DT          PIC XX.
   705         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   706             20  PI-PLAN-CODE            PIC X(2).
   707             20  PI-REVISION-NUMBER      PIC X(3).
   708             20  PI-PLAN-EFF-DT          PIC X(2).
   709             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1044.cbl
   710             20  FILLER                  PIC X(11).
   711         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   712             20  PI-OE-REFERENCE-1.
   713                 25  PI-OE-REF-1-PRIME   PIC X(18).
   714                 25  PI-OE-REF-1-SUFF    PIC XX.
   715
   716     12  PI-SESSION-IN-PROGRESS          PIC X.
   717         88  CLAIM-SESSION                   VALUE '1'.
   718         88  CREDIT-SESSION                  VALUE '2'.
   719         88  WARRANTY-SESSION                VALUE '3'.
   720         88  MORTGAGE-SESSION                VALUE '4'.
   721         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   722
   723
   724*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   725
   726     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   727     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   728
   729     12  PI-CREDIT-USER                  PIC X.
   730         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   731         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   732
   733     12  PI-CLAIM-USER                   PIC X.
   734         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   735         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   736
   737     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   738         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   739         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   740         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   741         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   742         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   743
   744     12  PI-PROCESSOR-ID                 PIC X(4).
   745
   746     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   747
   748     12  PI-MEMBER-CAPTION               PIC X(10).
   749
   750     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   751         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   752
   753     12  PI-LIFE-OVERRIDE-L1             PIC X.
   754     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   755     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   756     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   757
   758     12  PI-AH-OVERRIDE-L1               PIC X.
   759     12  PI-AH-OVERRIDE-L2               PIC XX.
   760     12  PI-AH-OVERRIDE-L6               PIC X(6).
   761     12  PI-AH-OVERRIDE-L12              PIC X(12).
   762
   763     12  PI-NEW-SYSTEM                   PIC X(2).
   764
   765     12  PI-PRIMARY-CERT-NO              PIC X(11).
   766     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   767         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1044.cbl
   768     12  PI-CRDTCRD-SYSTEM.
   769         16  PI-CRDTCRD-USER             PIC X.
   770             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   771             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   772         16  PI-CC-MONTH-END-DT          PIC XX.
   773     12  PI-PROCESSOR-PRINTER            PIC X(4).
   774
   775     12  PI-OE-REFERENCE-2.
   776         16  PI-OE-REF-2-PRIME           PIC X(10).
   777         16  PI-OE-REF-2-SUFF            PIC X.
   778
   779     12  PI-REM-TRM-CALC-OPTION          PIC X.
   780
   781     12  PI-LANGUAGE-TYPE                PIC X.
   782             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   783             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   784             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   785
   786     12  PI-POLICY-LINKAGE-IND           PIC X.
   787         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   788         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   789                                                   LOW-VALUES.
   790
   791     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   792     12  PI-CLAIM-PW-SESSION             PIC X(1).
   793         88  PI-CLAIM-CREDIT                 VALUE '1'.
   794         88  PI-CLAIM-CONVEN                 VALUE '2'.
   795
   796     12  PI-PROCESSOR-CSR-IND            PIC X.
   797         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   798         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   799
   800     12  FILLER                          PIC X(3).
   801
   802     12  PI-SYSTEM-LEVEL                 PIC X(145).
   803
   804     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   805         PI-SYSTEM-LEVEL.
   806
   807         16  PI-ENTRY-CODES.
   808             20  PI-ENTRY-CD-1           PIC X.
   809             20  PI-ENTRY-CD-2           PIC X.
   810
   811         16  PI-RETURN-CODES.
   812             20  PI-RETURN-CD-1          PIC X.
   813             20  PI-RETURN-CD-2          PIC X.
   814
   815         16  PI-UPDATE-STATUS-SAVE.
   816             20  PI-UPDATE-BY            PIC X(4).
   817             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   818
   819         16  PI-LOWER-CASE-LETTERS       PIC X.
   820             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   821
   822*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   823*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   824*            88  CARRIER-CLM-CNTL            VALUE '2'.
   825
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1044.cbl
   826         16  PI-CERT-ACCESS-CONTROL      PIC X.
   827             88  ST-ACCNT-CNTL               VALUE ' '.
   828             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   829             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   830             88  ACCNT-CNTL                  VALUE '3'.
   831             88  CARR-ACCNT-CNTL             VALUE '4'.
   832
   833         16  PI-PROCESSOR-CAP-LIST.
   834             20  PI-SYSTEM-CONTROLS.
   835                24 PI-SYSTEM-DISPLAY     PIC X.
   836                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   837                24 PI-SYSTEM-MODIFY      PIC X.
   838                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   839             20  FILLER                  PIC XX.
   840             20  PI-DISPLAY-CAP          PIC X.
   841                 88  DISPLAY-CAP             VALUE 'Y'.
   842             20  PI-MODIFY-CAP           PIC X.
   843                 88  MODIFY-CAP              VALUE 'Y'.
   844             20  PI-MSG-AT-LOGON-CAP     PIC X.
   845                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   846             20  PI-FORCE-CAP            PIC X.
   847                 88  FORCE-CAP               VALUE 'Y'.
   848
   849         16  PI-PROGRAM-CONTROLS.
   850             20  PI-PGM-PRINT-OPT        PIC X.
   851             20  PI-PGM-FORMAT-OPT       PIC X.
   852             20  PI-PGM-PROCESS-OPT      PIC X.
   853             20  PI-PGM-TOTALS-OPT       PIC X.
   854
   855         16  PI-HELP-INTERFACE.
   856             20  PI-LAST-ERROR-NO        PIC X(4).
   857             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   858
   859         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   860             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   861
   862         16  PI-CR-CONTROL-IN-PROGRESS.
   863             20  PI-CR-CARRIER           PIC X.
   864             20  PI-CR-GROUPING          PIC X(6).
   865             20  PI-CR-STATE             PIC XX.
   866             20  PI-CR-ACCOUNT           PIC X(10).
   867             20  PI-CR-FIN-RESP          PIC X(10).
   868             20  PI-CR-TYPE              PIC X.
   869
   870         16  PI-CR-BATCH-NUMBER          PIC X(6).
   871
   872         16  PI-CR-MONTH-END-DT          PIC XX.
   873
   874         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   875             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   876             88  PI-ZERO-CARRIER             VALUE '1'.
   877             88  PI-ZERO-GROUPING            VALUE '2'.
   878             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   879
   880         16  PI-CARRIER-SECURITY         PIC X.
   881             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   882
   883         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1044.cbl
   884             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   885             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   886
   887         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   888             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   889                                         INDEXED BY PI-ACCESS-NDX
   890                                         PIC X.
   891
   892         16  PI-GA-BILLING-CONTROL       PIC X.
   893             88  PI-GA-BILLING               VALUE '1'.
   894
   895         16  PI-MAIL-PROCESSING          PIC X.
   896             88  PI-MAIL-YES                 VALUE 'Y'.
   897
   898         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   899
   900         16  PI-AR-SYSTEM.
   901             20  PI-AR-PROCESSING-CNTL   PIC X.
   902                 88  PI-AR-PROCESSING        VALUE 'Y'.
   903             20  PI-AR-SUMMARY-CODE      PIC X(6).
   904             20  PI-AR-MONTH-END-DT      PIC XX.
   905
   906         16  PI-MP-SYSTEM.
   907             20  PI-MORTGAGE-USER            PIC X.
   908                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   909                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   910             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   911                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   912                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   913                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   914                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   915                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   916             20  PI-MP-MONTH-END-DT          PIC XX.
   917             20  PI-MP-REFERENCE-NO.
   918                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   919                 24  PI-MP-REFERENCE-SFX     PIC XX.
   920
   921         16  PI-LABEL-CONTROL            PIC X(01).
   922             88  PI-CREATE-LABELS                    VALUE 'Y'.
   923             88  PI-BYPASS-LABELS                    VALUE 'N'.
   924
   925         16  PI-BILL-GROUPING-CODE       PIC X(01).
   926             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   927
   928         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   929             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   930             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   931
   932         16  FILLER                      PIC X(14).
   933
   934     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   935******************************************************************
   936     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   937*                                    COPY ELC1042.
   938******************************************************************
   939*                                                                *
   940*                                                                *
   941*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1044.cbl
   942*                            VMOD=2.002                          *
   943*                                                                *
   944*    NOTE                                                        *
   945*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   946*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   947*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   948*        TO THESE PROGRAMS.                                      *
   949*                                                                *
   950*    NOTE                                                        *
   951*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   952*        USE ONLY!                                               *
   953*                                                                *
   954******************************************************************
   955
   956         16  PI-1042-WA.
   957             20  PI-ACTION       PIC  X(01).
   958                 88 PI-SHOW-MODE           VALUE '1'.
   959                 88 PI-CLEAR-MODE          VALUE '2'.
   960                 88 PI-CREATE-MODE         VALUE '3'.
   961             20  PI-COMM-CONTROL PIC  X(12).
   962             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   963             20  PI-EOF-SW       PIC  X(01).
   964                 88  PI-FILE-EOF           VALUE 'Y'.
   965             20  PI-FILETYP      PIC  X(01).
   966             20  PI-FORM-SQUEEZE-CONTROL
   967                                 PIC  X(01).
   968                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   969                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   970             20  PI-LAST-CONTROL PIC  X(12).
   971             20  PI-TEMP-STOR-ITEMS
   972                                 PIC S9(04) COMP.
   973             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   974             20  PI-UPDATE-SW    PIC  9(01).
   975                 88 ANY-UPDATES            VALUE 1.
   976             20  PI-104-SCREEN-SENT-IND
   977                                 PIC  X(01).
   978                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   979                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   980             20  PI-1042-SCREEN-SENT-IND
   981                                 PIC  X(01).
   982                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   983                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   984             20  PI-1042-ARCHIVE-IND
   985                                 PIC  X(01).
   986                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   987             20  FILLER          PIC  X(29).
   988         16  PI-PREV-LETR-KEY        PIC X(15).
   989         16  PI-CURR-LETR-KEY        PIC X(15).
   990         16  PI-UPDATE-DT            PIC XX.
   991         16  FILLER                  PIC X(556).
   992*                                    COPY ELCAID.
   993******************************************************************
   994*                                                                *
   995*                            ELCAID.                             *
   996*                            VMOD=2.001                          *
   997*                                                                *
   998*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1044.cbl
  1000*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1001*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1002******************************************************************
  1003
  1004 01  DFHAID.
  1005   02  DFHNULL   PIC  X  VALUE  ' '.
  1006   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1007   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1008   02  DFHPEN    PIC  X  VALUE  '='.
  1009   02  DFHOPID   PIC  X  VALUE  'W'.
  1010   02  DFHPA1    PIC  X  VALUE  '%'.
  1011   02  DFHPA2    PIC  X  VALUE  '>'.
  1012   02  DFHPA3    PIC  X  VALUE  ','.
  1013   02  DFHPF1    PIC  X  VALUE  '1'.
  1014   02  DFHPF2    PIC  X  VALUE  '2'.
  1015   02  DFHPF3    PIC  X  VALUE  '3'.
  1016   02  DFHPF4    PIC  X  VALUE  '4'.
  1017   02  DFHPF5    PIC  X  VALUE  '5'.
  1018   02  DFHPF6    PIC  X  VALUE  '6'.
  1019   02  DFHPF7    PIC  X  VALUE  '7'.
  1020   02  DFHPF8    PIC  X  VALUE  '8'.
  1021   02  DFHPF9    PIC  X  VALUE  '9'.
  1022   02  DFHPF10   PIC  X  VALUE  ':'.
  1023   02  DFHPF11   PIC  X  VALUE  '#'.
  1024   02  DFHPF12   PIC  X  VALUE  '@'.
  1025   02  DFHPF13   PIC  X  VALUE  'A'.
  1026   02  DFHPF14   PIC  X  VALUE  'B'.
  1027   02  DFHPF15   PIC  X  VALUE  'C'.
  1028   02  DFHPF16   PIC  X  VALUE  'D'.
  1029   02  DFHPF17   PIC  X  VALUE  'E'.
  1030   02  DFHPF18   PIC  X  VALUE  'F'.
  1031   02  DFHPF19   PIC  X  VALUE  'G'.
  1032   02  DFHPF20   PIC  X  VALUE  'H'.
  1033   02  DFHPF21   PIC  X  VALUE  'I'.
  1034*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1035   02  DFHPF22   PIC  X  VALUE  '['.
  1036   02  DFHPF23   PIC  X  VALUE  '.'.
  1037   02  DFHPF24   PIC  X  VALUE  '<'.
  1038   02  DFHMSRE   PIC  X  VALUE  'X'.
  1039   02  DFHSTRF   PIC  X  VALUE  'h'.
  1040   02  DFHTRIG   PIC  X  VALUE  '"'.
  1041 01  FILLER    REDEFINES DFHAID.
  1042     12  FILLER                      PIC X(08).
  1043     12  PF-VALUES                   PIC X         OCCURS 24.
  1044*                                    COPY EL1044S.
  1045 01  EL1044ZI.
  1046     05  FILLER            PIC  X(0012).
  1047*    -------------------------------
  1048     05  DATEL PIC S9(0004) COMP.
  1049     05  DATEF PIC  X(0001).
  1050     05  FILLER REDEFINES DATEF.
  1051         10  DATEA PIC  X(0001).
  1052     05  FILLER            PIC  X(3).
  1053     05  DATEI PIC  X(0008).
  1054*    -------------------------------
  1055     05  TIMEL PIC S9(0004) COMP.
  1056     05  TIMEF PIC  X(0001).
  1057     05  FILLER REDEFINES TIMEF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1044.cbl
  1058         10  TIMEA PIC  X(0001).
  1059     05  FILLER            PIC  X(3).
  1060     05  TIMEI PIC  X(0005).
  1061*    -------------------------------
  1062     05  CMPNYIDL PIC S9(0004) COMP.
  1063     05  CMPNYIDF PIC  X(0001).
  1064     05  FILLER REDEFINES CMPNYIDF.
  1065         10  CMPNYIDA PIC  X(0001).
  1066     05  FILLER            PIC  X(3).
  1067     05  CMPNYIDI PIC  X(0003).
  1068*    -------------------------------
  1069     05  USERIDL PIC S9(0004) COMP.
  1070     05  USERIDF PIC  X(0001).
  1071     05  FILLER REDEFINES USERIDF.
  1072         10  USERIDA PIC  X(0001).
  1073     05  FILLER            PIC  X(3).
  1074     05  USERIDI PIC  X(0004).
  1075*    -------------------------------
  1076     05  MAINTL PIC S9(0004) COMP.
  1077     05  MAINTF PIC  X(0001).
  1078     05  FILLER REDEFINES MAINTF.
  1079         10  MAINTA PIC  X(0001).
  1080     05  FILLER            PIC  X(3).
  1081     05  MAINTI PIC  X(0001).
  1082*    -------------------------------
  1083     05  LSTUSRL PIC S9(0004) COMP.
  1084     05  LSTUSRF PIC  X(0001).
  1085     05  FILLER REDEFINES LSTUSRF.
  1086         10  LSTUSRA PIC  X(0001).
  1087     05  FILLER            PIC  X(3).
  1088     05  LSTUSRI PIC  X(0004).
  1089*    -------------------------------
  1090     05  LSTDTEL PIC S9(0004) COMP.
  1091     05  LSTDTEF PIC  X(0001).
  1092     05  FILLER REDEFINES LSTDTEF.
  1093         10  LSTDTEA PIC  X(0001).
  1094     05  FILLER            PIC  X(3).
  1095     05  LSTDTEI PIC  X(0008).
  1096*    -------------------------------
  1097     05  ZLETRL PIC S9(0004) COMP.
  1098     05  ZLETRF PIC  X(0001).
  1099     05  FILLER REDEFINES ZLETRF.
  1100         10  ZLETRA PIC  X(0001).
  1101     05  FILLER            PIC  X(3).
  1102     05  ZLETRI PIC  X(0004).
  1103*    -------------------------------
  1104     05  ZCOPIESL PIC S9(0004) COMP.
  1105     05  ZCOPIESF PIC  X(0001).
  1106     05  FILLER REDEFINES ZCOPIESF.
  1107         10  ZCOPIESA PIC  X(0001).
  1108     05  FILLER            PIC  X(3).
  1109     05  ZCOPIESI PIC  X(0001).
  1110*    -------------------------------
  1111     05  ZPROMPTL PIC S9(0004) COMP.
  1112     05  ZPROMPTF PIC  X(0001).
  1113     05  FILLER REDEFINES ZPROMPTF.
  1114         10  ZPROMPTA PIC  X(0001).
  1115     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1044.cbl
  1116     05  ZPROMPTI PIC  X(0001).
  1117*    -------------------------------
  1118     05  ZENCCDL PIC S9(0004) COMP.
  1119     05  ZENCCDF PIC  X(0001).
  1120     05  FILLER REDEFINES ZENCCDF.
  1121         10  ZENCCDA PIC  X(0001).
  1122     05  FILLER            PIC  X(3).
  1123     05  ZENCCDI PIC  X(0003).
  1124*    -------------------------------
  1125     05  ZRDAYSL PIC S9(0004) COMP.
  1126     05  ZRDAYSF PIC  X(0001).
  1127     05  FILLER REDEFINES ZRDAYSF.
  1128         10  ZRDAYSA PIC  X(0001).
  1129     05  FILLER            PIC  X(3).
  1130     05  ZRDAYSI PIC  X(0003).
  1131*    -------------------------------
  1132     05  ZFORML PIC S9(0004) COMP.
  1133     05  ZFORMF PIC  X(0001).
  1134     05  FILLER REDEFINES ZFORMF.
  1135         10  ZFORMA PIC  X(0001).
  1136     05  FILLER            PIC  X(3).
  1137     05  ZFORMI PIC  X(0004).
  1138*    -------------------------------
  1139     05  ZBENEL PIC S9(0004) COMP.
  1140     05  ZBENEF PIC  X(0001).
  1141     05  FILLER REDEFINES ZBENEF.
  1142         10  ZBENEA PIC  X(0001).
  1143     05  FILLER            PIC  X(3).
  1144     05  ZBENEI PIC  X(0001).
  1145*    -------------------------------
  1146     05  ZACCTL PIC S9(0004) COMP.
  1147     05  ZACCTF PIC  X(0001).
  1148     05  FILLER REDEFINES ZACCTF.
  1149         10  ZACCTA PIC  X(0001).
  1150     05  FILLER            PIC  X(3).
  1151     05  ZACCTI PIC  X(0001).
  1152*    -------------------------------
  1153     05  ZTYPEL PIC S9(0004) COMP.
  1154     05  ZTYPEF PIC  X(0001).
  1155     05  FILLER REDEFINES ZTYPEF.
  1156         10  ZTYPEA PIC  X(0001).
  1157     05  FILLER            PIC  X(3).
  1158     05  ZTYPEI PIC  X(0001).
  1159*    -------------------------------
  1160     05  ZPRTCRTL PIC S9(0004) COMP.
  1161     05  ZPRTCRTF PIC  X(0001).
  1162     05  FILLER REDEFINES ZPRTCRTF.
  1163         10  ZPRTCRTA PIC  X(0001).
  1164     05  FILLER            PIC  X(3).
  1165     05  ZPRTCRTI PIC  X(0001).
  1166*    -------------------------------
  1167     05  ZREFREQL PIC S9(0004) COMP.
  1168     05  ZREFREQF PIC  X(0001).
  1169     05  FILLER REDEFINES ZREFREQF.
  1170         10  ZREFREQA PIC  X(0001).
  1171     05  FILLER            PIC  X(3).
  1172     05  ZREFREQI PIC  X(0001).
  1173*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1044.cbl
  1174     05  ZONBASEL PIC S9(0004) COMP.
  1175     05  ZONBASEF PIC  X(0001).
  1176     05  FILLER REDEFINES ZONBASEF.
  1177         10  ZONBASEA PIC  X(0001).
  1178     05  FILLER            PIC  X(3).
  1179     05  ZONBASEI PIC  X(0002).
  1180*    -------------------------------
  1181     05  ZACTSUML PIC S9(0004) COMP.
  1182     05  ZACTSUMF PIC  X(0001).
  1183     05  FILLER REDEFINES ZACTSUMF.
  1184         10  ZACTSUMA PIC  X(0001).
  1185     05  FILLER            PIC  X(3).
  1186     05  ZACTSUMI PIC  X(0001).
  1187*    -------------------------------
  1188     05  ZCSOSUML PIC S9(0004) COMP.
  1189     05  ZCSOSUMF PIC  X(0001).
  1190     05  FILLER REDEFINES ZCSOSUMF.
  1191         10  ZCSOSUMA PIC  X(0001).
  1192     05  FILLER            PIC  X(3).
  1193     05  ZCSOSUMI PIC  X(0001).
  1194*    -------------------------------
  1195     05  ZFADAYSL PIC S9(0004) COMP.
  1196     05  ZFADAYSF PIC  X(0001).
  1197     05  FILLER REDEFINES ZFADAYSF.
  1198         10  ZFADAYSA PIC  X(0001).
  1199     05  FILLER            PIC  X(3).
  1200     05  ZFADAYSI PIC  X(0003).
  1201*    -------------------------------
  1202     05  ZACLOSEL PIC S9(0004) COMP.
  1203     05  ZACLOSEF PIC  X(0001).
  1204     05  FILLER REDEFINES ZACLOSEF.
  1205         10  ZACLOSEA PIC  X(0001).
  1206     05  FILLER            PIC  X(3).
  1207     05  ZACLOSEI PIC  X(0001).
  1208*    -------------------------------
  1209     05  ERRMSGL PIC S9(0004) COMP.
  1210     05  ERRMSGF PIC  X(0001).
  1211     05  FILLER REDEFINES ERRMSGF.
  1212         10  ERRMSGA PIC  X(0001).
  1213     05  FILLER            PIC  X(3).
  1214     05  ERRMSGI PIC  X(0072).
  1215*    -------------------------------
  1216     05  PFKEYL PIC S9(0004) COMP.
  1217     05  PFKEYF PIC  X(0001).
  1218     05  FILLER REDEFINES PFKEYF.
  1219         10  PFKEYA PIC  X(0001).
  1220     05  FILLER            PIC  X(3).
  1221     05  PFKEYI PIC  99.
  1222 01  EL1044ZO REDEFINES EL1044ZI.
  1223     05  FILLER            PIC  X(0012).
  1224*    -------------------------------
  1225     05  FILLER            PIC  X(3).
  1226     05  DATEC PIC  X(0001).
  1227     05  DATEH PIC  X(0001).
  1228     05  DATEU PIC  X(0001).
  1229     05  DATEO PIC  X(0008).
  1230*    -------------------------------
  1231     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1044.cbl
  1232     05  TIMEC PIC  X(0001).
  1233     05  TIMEH PIC  X(0001).
  1234     05  TIMEU PIC  X(0001).
  1235     05  TIMEO PIC  99.99.
  1236*    -------------------------------
  1237     05  FILLER            PIC  X(3).
  1238     05  CMPNYIDC PIC  X(0001).
  1239     05  CMPNYIDH PIC  X(0001).
  1240     05  CMPNYIDU PIC  X(0001).
  1241     05  CMPNYIDO PIC  X(0003).
  1242*    -------------------------------
  1243     05  FILLER            PIC  X(3).
  1244     05  USERIDC PIC  X(0001).
  1245     05  USERIDH PIC  X(0001).
  1246     05  USERIDU PIC  X(0001).
  1247     05  USERIDO PIC  X(0004).
  1248*    -------------------------------
  1249     05  FILLER            PIC  X(3).
  1250     05  MAINTC PIC  X(0001).
  1251     05  MAINTH PIC  X(0001).
  1252     05  MAINTU PIC  X(0001).
  1253     05  MAINTO PIC  X(0001).
  1254*    -------------------------------
  1255     05  FILLER            PIC  X(3).
  1256     05  LSTUSRC PIC  X(0001).
  1257     05  LSTUSRH PIC  X(0001).
  1258     05  LSTUSRU PIC  X(0001).
  1259     05  LSTUSRO PIC  X(0004).
  1260*    -------------------------------
  1261     05  FILLER            PIC  X(3).
  1262     05  LSTDTEC PIC  X(0001).
  1263     05  LSTDTEH PIC  X(0001).
  1264     05  LSTDTEU PIC  X(0001).
  1265     05  LSTDTEO PIC  X(0008).
  1266*    -------------------------------
  1267     05  FILLER            PIC  X(3).
  1268     05  ZLETRC PIC  X(0001).
  1269     05  ZLETRH PIC  X(0001).
  1270     05  ZLETRU PIC  X(0001).
  1271     05  ZLETRO PIC  X(0004).
  1272*    -------------------------------
  1273     05  FILLER            PIC  X(3).
  1274     05  ZCOPIESC PIC  X(0001).
  1275     05  ZCOPIESH PIC  X(0001).
  1276     05  ZCOPIESU PIC  X(0001).
  1277     05  ZCOPIESO PIC  9.
  1278*    -------------------------------
  1279     05  FILLER            PIC  X(3).
  1280     05  ZPROMPTC PIC  X(0001).
  1281     05  ZPROMPTH PIC  X(0001).
  1282     05  ZPROMPTU PIC  X(0001).
  1283     05  ZPROMPTO PIC  X(0001).
  1284*    -------------------------------
  1285     05  FILLER            PIC  X(3).
  1286     05  ZENCCDC PIC  X(0001).
  1287     05  ZENCCDH PIC  X(0001).
  1288     05  ZENCCDU PIC  X(0001).
  1289     05  ZENCCDO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1044.cbl
  1290*    -------------------------------
  1291     05  FILLER            PIC  X(3).
  1292     05  ZRDAYSC PIC  X(0001).
  1293     05  ZRDAYSH PIC  X(0001).
  1294     05  ZRDAYSU PIC  X(0001).
  1295     05  ZRDAYSO PIC  999.
  1296*    -------------------------------
  1297     05  FILLER            PIC  X(3).
  1298     05  ZFORMC PIC  X(0001).
  1299     05  ZFORMH PIC  X(0001).
  1300     05  ZFORMU PIC  X(0001).
  1301     05  ZFORMO PIC  X(0004).
  1302*    -------------------------------
  1303     05  FILLER            PIC  X(3).
  1304     05  ZBENEC PIC  X(0001).
  1305     05  ZBENEH PIC  X(0001).
  1306     05  ZBENEU PIC  X(0001).
  1307     05  ZBENEO PIC  X(0001).
  1308*    -------------------------------
  1309     05  FILLER            PIC  X(3).
  1310     05  ZACCTC PIC  X(0001).
  1311     05  ZACCTH PIC  X(0001).
  1312     05  ZACCTU PIC  X(0001).
  1313     05  ZACCTO PIC  X(0001).
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(3).
  1316     05  ZTYPEC PIC  X(0001).
  1317     05  ZTYPEH PIC  X(0001).
  1318     05  ZTYPEU PIC  X(0001).
  1319     05  ZTYPEO PIC  X(0001).
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(3).
  1322     05  ZPRTCRTC PIC  X(0001).
  1323     05  ZPRTCRTH PIC  X(0001).
  1324     05  ZPRTCRTU PIC  X(0001).
  1325     05  ZPRTCRTO PIC  X(0001).
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(3).
  1328     05  ZREFREQC PIC  X(0001).
  1329     05  ZREFREQH PIC  X(0001).
  1330     05  ZREFREQU PIC  X(0001).
  1331     05  ZREFREQO PIC  X(0001).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(3).
  1334     05  ZONBASEC PIC  X(0001).
  1335     05  ZONBASEH PIC  X(0001).
  1336     05  ZONBASEU PIC  X(0001).
  1337     05  ZONBASEO PIC  X(0002).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(3).
  1340     05  ZACTSUMC PIC  X(0001).
  1341     05  ZACTSUMH PIC  X(0001).
  1342     05  ZACTSUMU PIC  X(0001).
  1343     05  ZACTSUMO PIC  X(0001).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(3).
  1346     05  ZCSOSUMC PIC  X(0001).
  1347     05  ZCSOSUMH PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1044.cbl
  1348     05  ZCSOSUMU PIC  X(0001).
  1349     05  ZCSOSUMO PIC  X(0001).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(3).
  1352     05  ZFADAYSC PIC  X(0001).
  1353     05  ZFADAYSH PIC  X(0001).
  1354     05  ZFADAYSU PIC  X(0001).
  1355     05  ZFADAYSO PIC  999.
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(3).
  1358     05  ZACLOSEC PIC  X(0001).
  1359     05  ZACLOSEH PIC  X(0001).
  1360     05  ZACLOSEU PIC  X(0001).
  1361     05  ZACLOSEO PIC  X(0001).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(3).
  1364     05  ERRMSGC PIC  X(0001).
  1365     05  ERRMSGH PIC  X(0001).
  1366     05  ERRMSGU PIC  X(0001).
  1367     05  ERRMSGO PIC  X(0072).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(3).
  1370     05  PFKEYC PIC  X(0001).
  1371     05  PFKEYH PIC  X(0001).
  1372     05  PFKEYU PIC  X(0001).
  1373     05  PFKEYO PIC  99.
  1374*    -------------------------------
  1375****************************************************************
  1376*
  1377* Copyright (c) 2007 by Clerity Solutions, Inc.
  1378* All rights reserved.
  1379*
  1380****************************************************************
  1381 01  DFHEIV.
  1382   02  DFHEIV0               PIC X(35).
  1383   02  DFHEIV1               PIC X(08).
  1384   02  DFHEIV2               PIC X(08).
  1385   02  DFHEIV3               PIC X(08).
  1386   02  DFHEIV4               PIC X(06).
  1387   02  DFHEIV5               PIC X(04).
  1388   02  DFHEIV6               PIC X(04).
  1389   02  DFHEIV7               PIC X(02).
  1390   02  DFHEIV8               PIC X(02).
  1391   02  DFHEIV9               PIC X(01).
  1392   02  DFHEIV10              PIC S9(7) COMP-3.
  1393   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1394   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1395   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1396   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1397   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1398   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1399   02  DFHEIV17              PIC X(04).
  1400   02  DFHEIV18              PIC X(04).
  1401   02  DFHEIV19              PIC X(04).
  1402   02  DFHEIV20              USAGE IS POINTER.
  1403   02  DFHEIV21              USAGE IS POINTER.
  1404   02  DFHEIV22              USAGE IS POINTER.
  1405   02  DFHEIV23              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1044.cbl
  1406   02  DFHEIV24              USAGE IS POINTER.
  1407   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1408   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1409   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1410   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1411   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1412   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1413   02  FILLER                PIC X(02).
  1414   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1415   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1416   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1417   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1418   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1419 LINKAGE  SECTION.
  1420*****************************************************************
  1421*                                                               *
  1422* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1423* All rights reserved.                                          *
  1424*                                                               *
  1425*****************************************************************
  1426 01  dfheiblk.
  1427     02  eibtime          pic s9(7) comp-3.
  1428     02  eibdate          pic s9(7) comp-3.
  1429     02  eibtrnid         pic x(4).
  1430     02  eibtaskn         pic s9(7) comp-3.
  1431     02  eibtrmid         pic x(4).
  1432     02  dfheigdi         pic s9(4) comp.
  1433     02  eibcposn         pic s9(4) comp.
  1434     02  eibcalen         pic s9(4) comp.
  1435     02  eibaid           pic x(1).
  1436     02  eibfiller1       pic x(1).
  1437     02  eibfn            pic x(2).
  1438     02  eibfiller2       pic x(2).
  1439     02  eibrcode         pic x(6).
  1440     02  eibfiller3       pic x(2).
  1441     02  eibds            pic x(8).
  1442     02  eibreqid         pic x(8).
  1443     02  eibrsrce         pic x(8).
  1444     02  eibsync          pic x(1).
  1445     02  eibfree          pic x(1).
  1446     02  eibrecv          pic x(1).
  1447     02  eibsend          pic x(1).
  1448     02  eibatt           pic x(1).
  1449     02  eibeoc           pic x(1).
  1450     02  eibfmh           pic x(1).
  1451     02  eibcompl         pic x(1).
  1452     02  eibsig           pic x(1).
  1453     02  eibconf          pic x(1).
  1454     02  eiberr           pic x(1).
  1455     02  eibrldbk         pic x(1).
  1456     02  eiberrcd         pic x(4).
  1457     02  eibsynrb         pic x(1).
  1458     02  eibnodat         pic x(1).
  1459     02  eibfiller5       pic x(2).
  1460     02  eibresp          pic 9(09) comp.
  1461     02  eibresp2         pic 9(09) comp.
  1462     02  dfheigdj         pic s9(4) comp.
  1463     02  dfheigdk         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1044.cbl
  1464 01  DFHCOMMAREA                     PIC X(1024).
  1465*                                    COPY ELCTEXT.
  1466******************************************************************
  1467*                                                                *
  1468*                                                                *
  1469*                            ELCTEXT.                            *
  1470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1471*                            VMOD=2.008                          *
  1472*                                                                *
  1473*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1474*                                     FORM LETTERS,              *
  1475*                                     CERT FORM DISPLAY.
  1476*                                                                *
  1477*   FILE TYPE = VSAM,KSDS                                        *
  1478*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1479*                                                                *
  1480*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1481*       ALTERNATE INDEX = NONE                                   *
  1482*                                                                *
  1483*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1484*       ALTERNATE INDEX = NONE                                   *
  1485*                                                                *
  1486*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1487*       ALTERNATE INDEX = NONE                                   *
  1488*                                                                *
  1489*   LOG = NO                                                     *
  1490*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1491******************************************************************
  1492 01  TEXT-FILES.
  1493     12  TEXT-FILE-ID                PIC XX.
  1494         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1495         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1496         88  HELP-FILE-TEXT             VALUE 'TH'.
  1497
  1498     12  TX-CONTROL-PRIMARY.
  1499         16  TX-COMPANY-CD           PIC X.
  1500             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1501         16  TX-ACCESS-CD-GENL       PIC X(12).
  1502
  1503         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1504             20  TX-LETTER-NO        PIC X(4).
  1505             20  FILLER              PIC X(8).
  1506
  1507         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1508             20  TX-FORM-NO          PIC X(12).
  1509
  1510         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1511             20  TX-HELP-TYPE        PIC X.
  1512                 88  HELP-FOR-GENERAL   VALUE ' '.
  1513                 88  HELP-BY-SCREEN     VALUE 'S'.
  1514                 88  HELP-BY-ERROR      VALUE 'E'.
  1515             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1516                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1517             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1518                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1519             20  FILLER              PIC X(4).
  1520
  1521         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1044.cbl
  1522
  1523     12  TX-PROCESS-CONTROL          PIC XX.
  1524         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1525
  1526     12  TX-TEXT-LINE                PIC X(70).
  1527
  1528     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1529         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1530         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1531         88  TX-VALID-FORM-SQUEEZE-VALUE
  1532                                        VALUE 'Y' ' '.
  1533
  1534     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1535         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1536         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1537         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1538         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1539         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1540         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1541         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1542                                              'K' 'N' ' '
  1543                                              'Z'.
  1544
  1545     12  TX-ARCHIVE-SW               PIC X.
  1546         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1547         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1548         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1549
  1550     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1551     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1552
  1553     12  TX-BSR-CODE                 PIC X.
  1554         88  TX-BSR-LETTER              VALUE 'B'.
  1555         88  TX-NON-BSR-LETTER          VALUE ' '.
  1556
  1557     12  FILLER                      PIC X.
  1558*****************************************************************
  1559 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  1560 0000-DFHEXIT SECTION.
  1561     MOVE '9#                    $   ' TO DFHEIV0.
  1562     MOVE 'EL1044' TO DFHEIV1.
  1563     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1564     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1565     MOVE '5'                    TO DC-OPTION-CODE
  1566     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1567     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1568     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1569     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1570     IF EIBCALEN = 0
  1571        GO TO 8800-UNAUTHORIZED-ACCESS.
  1572     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1573     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1574     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1575
  1576* EXEC CICS HANDLE CONDITION
  1577*        DUPREC     (8850-DUPREC)
  1578*        NOTOPEN    (8870-NOTOPEN)
  1579*        NOTFND     (8880-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1044.cbl
  1580*        PGMIDERR   (9600-PGMID-ERROR)
  1581*        ERROR      (9990-ABEND)
  1582*    END-EXEC.
  1583*    MOVE '"$%JIL.               ! " #00001571' TO DFHEIV0
  1584     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1586     MOVE X'2220233030303031353731' TO DFHEIV0(25:11)
  1587     CALL 'kxdfhei1' USING DFHEIV0
  1588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1589
  1590     .
  1591 0150-SET-PROGRAM-SAVES.
  1592     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1593         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1594             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1595             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1596             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1597             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1598             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1599             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1600             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1601             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1602         ELSE
  1603             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1604             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1605             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1606             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1607             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1608             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1609             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1610             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1611     ELSE
  1612         GO TO 0200-RECEIVE.
  1613*    DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1614     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1615     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1616     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1617     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1618                                    PI-PREV-LETR-KEY
  1619     GO TO 1000-SHOW-LETR-RECORD
  1620     .
  1621 0200-RECEIVE.
  1622     IF EIBAID = DFHCLEAR
  1623        GO TO 9400-CLEAR.
  1624     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1625         MOVE LOW-VALUES             TO  EL1044ZI
  1626         MOVE ER-7008                TO  EMI-ERROR
  1627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1628         MOVE -1                     TO  MAINTL
  1629         GO TO 8200-SEND-DATAONLY.
  1630     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1631         NEXT SENTENCE
  1632     ELSE
  1633
  1634* EXEC CICS READQ TS
  1635*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1636*            INTO   (SECURITY-CONTROL)
  1637*            LENGTH (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1044.cbl
  1638*            ITEM   (SC-ITEM)
  1639*        END-EXEC
  1640*    MOVE '*$II   L              ''   #00001621' TO DFHEIV0
  1641     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1643     MOVE X'2020233030303031363231' TO DFHEIV0(25:11)
  1644     CALL 'kxdfhei1' USING DFHEIV0,
  1645           PI-SECURITY-TEMP-STORE-ID,
  1646           SECURITY-CONTROL,
  1647           SC-COMM-LENGTH,
  1648           SC-ITEM,
  1649           DFHEIV99,
  1650           DFHEIV99
  1651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1652         MOVE SC-CREDIT-DISPLAY (3)  TO  PI-DISPLAY-CAP
  1653         MOVE SC-CREDIT-UPDATE  (3)  TO  PI-MODIFY-CAP.
  1654
  1655* EXEC CICS RECEIVE
  1656*        MAP      (WS-MAP-NAME)
  1657*        MAPSET   (MAPSET-NAME)
  1658*        INTO     (EL1044ZI)
  1659*    END-EXEC
  1660     MOVE LENGTH OF
  1661      EL1044ZI
  1662       TO DFHEIV11
  1663*    MOVE '8"T I  L              ''   #00001629' TO DFHEIV0
  1664     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1665     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1666     MOVE X'2020233030303031363239' TO DFHEIV0(25:11)
  1667     CALL 'kxdfhei1' USING DFHEIV0,
  1668           WS-MAP-NAME,
  1669           EL1044ZI,
  1670           DFHEIV11,
  1671           MAPSET-NAME,
  1672           DFHEIV99,
  1673           DFHEIV99
  1674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1675     IF PFKEYL = +0
  1676         GO TO 0300-CHECK-PFKEYS.
  1677     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1678         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1679     ELSE
  1680         MOVE ER-0029                TO  EMI-ERROR
  1681         GO TO 0320-INPUT-ERROR.
  1682 0300-CHECK-PFKEYS.
  1683*    DISPLAY ' MADE IT TO 0300 '
  1684     IF EIBAID EQUAL DFHPF23
  1685         GO TO 8810-PF23.
  1686     IF EIBAID EQUAL DFHPF24
  1687         GO TO 9200-RETURN-MAIN-MENU.
  1688     IF EIBAID EQUAL DFHPF12
  1689         GO TO 9500-PF12.
  1690     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1691         MOVE ER-0050            TO EMI-ERROR
  1692         GO TO 0320-INPUT-ERROR.
  1693     IF EIBAID EQUAL DFHENTER
  1694         GO TO 0330-EDIT-DATA.
  1695     MOVE ER-0029                    TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1044.cbl
  1696 0320-INPUT-ERROR.
  1697*    DISPLAY ' MADE IT TO 0320 '
  1698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1699     MOVE AL-UNBON                   TO  PFKEYA.
  1700     MOVE -1                         TO  PFKEYL.
  1701     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1044.cbl
  1703 0330-EDIT-DATA.
  1704     IF NOT DISPLAY-CAP
  1705         MOVE 'READ'                 TO  SM-READ
  1706         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1707         MOVE ER-0070                TO  EMI-ERROR
  1708         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1709         MOVE -1                     TO  MAINTL
  1710         GO TO 8100-SEND-INITIAL-MAP.
  1711     IF MAINTI EQUAL 'S'
  1712        GO TO 1000-SHOW-LETR-RECORD.
  1713     IF MAINTI = 'C' OR 'A'
  1714        IF NOT MODIFY-CAP
  1715           PERFORM 9995-SECURITY-VIOLATION
  1716                                 THRU 9995-EXIT
  1717           MOVE ER-0070          TO EMI-ERROR
  1718           PERFORM 9900-ERROR-FORMAT
  1719                                 THRU 9900-EXIT
  1720           MOVE LOW-VALUES       TO EL1044ZO
  1721           MOVE -1               TO MAINTL
  1722           GO TO 8100-SEND-INITIAL-MAP
  1723        END-IF
  1724     END-IF
  1725     IF MAINTI = 'C'
  1726        GO TO 2000-CHANGE-LETR-RECORD
  1727     END-IF
  1728     IF MAINTI = 'A'
  1729        GO TO 3000-ADD-LETR-RECORD
  1730     END-IF
  1731     MOVE ER-0023                    TO  EMI-ERROR.
  1732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1733     MOVE -1                         TO  MAINTL.
  1734     MOVE AL-UABON                   TO  MAINTA.
  1735     GO TO 8200-SEND-DATAONLY.
  1736 1000-SHOW-LETR-RECORD.
  1737     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1738
  1739* EXEC CICS STARTBR
  1740*        DATASET   (ELLETR-FILE-ID)
  1741*        RIDFLD    (ELLETR-KEY)
  1742*        GTEQ
  1743*        RESP      (WS-RESPONSE)
  1744*    END-EXEC
  1745     MOVE 0
  1746       TO DFHEIV11
  1747*    MOVE '&,         G          &  N#00001697' TO DFHEIV0
  1748     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1750     MOVE X'204E233030303031363937' TO DFHEIV0(25:11)
  1751     CALL 'kxdfhei1' USING DFHEIV0,
  1752           ELLETR-FILE-ID,
  1753           ELLETR-KEY,
  1754           DFHEIV99,
  1755           DFHEIV11,
  1756           DFHEIV99
  1757     MOVE EIBRESP  TO WS-RESPONSE
  1758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1759     IF RESP-NORMAL
  1760        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1044.cbl
  1761           OR WE-FOUND-IT
  1762
  1763* EXEC CICS READNEXT
  1764*              DATASET    (ELLETR-FILE-ID)
  1765*              SET        (ADDRESS OF TEXT-FILES)
  1766*              RIDFLD     (ELLETR-KEY)
  1767*              RESP       (WS-RESPONSE)
  1768*          END-EXEC
  1769     MOVE 0
  1770       TO DFHEIV11
  1771*    MOVE '&.S                   )  N#00001706' TO DFHEIV0
  1772     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1773     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1774     MOVE X'204E233030303031373036' TO DFHEIV0(25:11)
  1775     CALL 'kxdfhei1' USING DFHEIV0,
  1776           ELLETR-FILE-ID,
  1777           DFHEIV20,
  1778           DFHEIV99,
  1779           ELLETR-KEY,
  1780           DFHEIV99,
  1781           DFHEIV11,
  1782           DFHEIV99,
  1783           DFHEIV99
  1784     SET ADDRESS OF TEXT-FILES TO
  1785         DFHEIV20
  1786     MOVE EIBRESP  TO WS-RESPONSE
  1787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1788           IF (RESP-NORMAL)
  1789              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1790              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1791                 SET WE-FOUND-IT   TO TRUE
  1792              END-IF
  1793           ELSE
  1794              SET I-SAY-TO-STOP  TO TRUE
  1795           END-IF
  1796        END-PERFORM
  1797     END-IF
  1798     IF WE-FOUND-IT
  1799        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1800                                    PI-PREV-LETR-KEY
  1801        GO TO 7000-BUILD-OUTPUT-MAP
  1802     END-IF
  1803     MOVE ER-0418                TO EMI-ERROR.
  1804     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1805     MOVE -1                     TO MAINTL
  1806     MOVE 'A'                    TO MAINTI
  1807     MOVE AL-UANON               TO MAINTA
  1808     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1809     MOVE +4                     TO ZLETRL
  1810     MOVE AL-UANON               TO ZLETRA
  1811     GO TO 8100-SEND-INITIAL-MAP
  1812     .
  1813 2000-CHANGE-LETR-RECORD.
  1814*    display ' made it to 2000 '
  1815*    display ' curr   ' pi-curr-letr-key
  1816*    display ' prev   ' pi-prev-letr-key
  1817     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1818        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1044.cbl
  1819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1820        MOVE -1                  TO MAINTL
  1821        GO TO 8200-SEND-DATAONLY
  1822     END-IF
  1823     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1824     IF NOT EMI-NO-ERRORS
  1825         GO TO 8200-SEND-DATAONLY.
  1826     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1827     .
  1828 2000-CHANGE-CONTINUE.
  1829
  1830* EXEC CICS READ
  1831*        DATASET    (ELLETR-FILE-ID)
  1832*        SET        (ADDRESS OF TEXT-FILES)
  1833*        RIDFLD     (ELLETR-KEY)
  1834*        UPDATE
  1835*        RESP       (WS-RESPONSE)
  1836*    END-EXEC
  1837*    MOVE '&"S        EU         (  N#00001753' TO DFHEIV0
  1838     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1839     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1840     MOVE X'204E233030303031373533' TO DFHEIV0(25:11)
  1841     CALL 'kxdfhei1' USING DFHEIV0,
  1842           ELLETR-FILE-ID,
  1843           DFHEIV20,
  1844           DFHEIV99,
  1845           ELLETR-KEY,
  1846           DFHEIV99,
  1847           DFHEIV99,
  1848           DFHEIV99
  1849     SET ADDRESS OF TEXT-FILES TO
  1850         DFHEIV20
  1851     MOVE EIBRESP  TO WS-RESPONSE
  1852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1853     IF RESP-NOTFND
  1854        IF ELLETR-SEQ-NO = +0
  1855           GO TO 2000-CONTINUE-CHANGE
  1856        END-IF
  1857     END-IF
  1858     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1859        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1860
  1861* EXEC CICS UNLOCK
  1862*            DATASET   (ELLETR-FILE-ID)
  1863*        END-EXEC
  1864*    MOVE '&*                    #   #00001767' TO DFHEIV0
  1865     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1866     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1867     MOVE X'2020233030303031373637' TO DFHEIV0(25:11)
  1868     CALL 'kxdfhei1' USING DFHEIV0,
  1869           ELLETR-FILE-ID,
  1870           DFHEIV99
  1871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1872         MOVE ER-0068                TO  EMI-ERROR
  1873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1874         GO TO 1000-SHOW-LETR-RECORD.
  1875     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1876     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1044.cbl
  1877     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1878     IF ZCOPIESL > +0
  1879        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1880     END-IF
  1881     IF ZFADAYSL > +0
  1882        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1883     END-IF
  1884     IF ZRDAYSL > +0
  1885        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  1886     END-IF
  1887     IF ZFORML > +0
  1888        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1889     END-IF
  1890     IF ZPROMPTL > +0
  1891        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1892     END-IF
  1893     IF ZENCCDL > +0
  1894        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1895     END-IF
  1896     IF ZACLOSEL > +0
  1897        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1898     END-IF
  1899     IF ZBENEL > +0
  1900        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1901     END-IF
  1902     IF ZACCTL > +0
  1903        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  1904     END-IF
  1905     IF ZTYPEL > +0
  1906        MOVE ZTYPEI              TO W-LETTER-TYPE
  1907     END-IF
  1908     IF ZPRTCRTL > +0
  1909        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  1910     END-IF
  1911     IF ZREFREQL > +0
  1912        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  1913     END-IF
  1914     IF ZONBASEL > +0
  1915         MOVE ZONBASEI           TO W-ONBASE-CODE
  1916     END-IF
  1917
  1918     IF ZACTSUML > +0
  1919         MOVE ZACTSUMI           TO W-ACCT-SUMM
  1920     END-IF
  1921
  1922     IF ZCSOSUML > +0
  1923         MOVE ZCSOSUMI           TO W-CSO-SUMM
  1924     END-IF
  1925     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1926     .
  1927 2000-CONTINUE-CHANGE.
  1928*    DISPLAY ' ABOUT TO REWRITE '
  1929
  1930* EXEC CICS REWRITE
  1931*        DATASET   (ELLETR-FILE-ID)
  1932*        FROM      (TEXT-FILES)
  1933*    END-EXEC.
  1934     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1044.cbl
  1935      TEXT-FILES
  1936       TO DFHEIV11
  1937*    MOVE '&& L                  %   #00001827' TO DFHEIV0
  1938     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1939     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1940     MOVE X'2020233030303031383237' TO DFHEIV0(25:11)
  1941     CALL 'kxdfhei1' USING DFHEIV0,
  1942           ELLETR-FILE-ID,
  1943           TEXT-FILES,
  1944           DFHEIV11,
  1945           DFHEIV99
  1946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1947
  1948     MOVE ER-0000                    TO  EMI-ERROR.
  1949     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1950     GO TO 1000-SHOW-LETR-RECORD
  1951     .
  1952 3000-ADD-LETR-RECORD.
  1953*    display ' made it to 3000 '
  1954*    display ' curr   ' pi-curr-letr-key
  1955*    display ' prev   ' pi-prev-letr-key
  1956     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1957     .
  1958 3000-CONTINUE-ADD.
  1959     IF NOT EMI-NO-ERRORS
  1960        GO TO 8200-SEND-DATAONLY
  1961     END-IF
  1962     MOVE SPACES                 TO ELLETR-KEY
  1963     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  1964     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  1965     MOVE +0                     TO ELLETR-SEQ-NO
  1966
  1967* EXEC CICS READ
  1968*        DATASET    (ELLETR-FILE-ID)
  1969*        SET        (ADDRESS OF TEXT-FILES)
  1970*        RIDFLD     (ELLETR-KEY)
  1971*        GTEQ
  1972*        RESP       (WS-RESPONSE)
  1973*    END-EXEC
  1974*    MOVE '&"S        G          (  N#00001849' TO DFHEIV0
  1975     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  1976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1977     MOVE X'204E233030303031383439' TO DFHEIV0(25:11)
  1978     CALL 'kxdfhei1' USING DFHEIV0,
  1979           ELLETR-FILE-ID,
  1980           DFHEIV20,
  1981           DFHEIV99,
  1982           ELLETR-KEY,
  1983           DFHEIV99,
  1984           DFHEIV99,
  1985           DFHEIV99
  1986     SET ADDRESS OF TEXT-FILES TO
  1987         DFHEIV20
  1988     MOVE EIBRESP  TO WS-RESPONSE
  1989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1990     IF RESP-NORMAL
  1991        IF TX-LETTER-NO = ZLETRI
  1992           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1044.cbl
  1993              MOVE ER-0132       TO EMI-ERROR
  1994              PERFORM 9900-ERROR-FORMAT
  1995                                 THRU 9900-EXIT
  1996              MOVE -1            TO ZLETRL
  1997              MOVE AL-UABON      TO ZLETRA
  1998              GO TO 8200-SEND-DATAONLY
  1999           ELSE
  2000              MOVE +0            TO WS-SEQ-NO-TO-USE
  2001           END-IF
  2002        ELSE
  2003           MOVE +1               TO WS-SEQ-NO-TO-USE
  2004        END-IF
  2005     ELSE
  2006        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2007     END-IF
  2008
  2009* EXEC CICS GETMAIN
  2010*       SET(ADDRESS OF TEXT-FILES)
  2011*       LENGTH(ELLETR-LENGTH)
  2012*    END-EXEC
  2013*    MOVE '," L                  $   #00001874' TO DFHEIV0
  2014     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2015     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2016     MOVE X'2020233030303031383734' TO DFHEIV0(25:11)
  2017     CALL 'kxdfhei1' USING DFHEIV0,
  2018           DFHEIV20,
  2019           ELLETR-LENGTH,
  2020           DFHEIV99
  2021     SET ADDRESS OF TEXT-FILES TO
  2022         DFHEIV20
  2023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2024     MOVE SPACES                 TO TEXT-FILES
  2025     MOVE 'TL'                   TO TEXT-FILE-ID
  2026     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2027     MOVE ZLETRI                 TO TX-LETTER-NO
  2028     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2029     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2030     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2031     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2032     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2033     IF ZCOPIESL > +0
  2034        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2035     ELSE
  2036        MOVE 1                   TO W-NUMBER-OF-COPIES
  2037     END-IF
  2038     IF ZFADAYSL > +0
  2039        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2040     END-IF
  2041     IF ZRDAYSL > +0
  2042        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2043     ELSE
  2044        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2045     END-IF
  2046     IF ZFORML > +0
  2047        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2048     END-IF
  2049     IF ZPROMPTL > +0
  2050        MOVE ZPROMPTI            TO W-PROMPT-LETTER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1044.cbl
  2051     END-IF
  2052     IF ZENCCDL > +0
  2053        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2054     END-IF
  2055     IF ZACLOSEL > +0
  2056        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2057     END-IF
  2058     IF ZBENEL > +0
  2059        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2060     END-IF
  2061     IF ZACCTL > +0
  2062        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2063     END-IF
  2064     IF ZTYPEL > +0
  2065        MOVE ZTYPEI              TO W-LETTER-TYPE
  2066     END-IF
  2067     IF ZPRTCRTL > +0
  2068        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2069     END-IF
  2070     IF ZREFREQL > +0
  2071        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2072     END-IF
  2073     IF ZONBASEL > +0
  2074        MOVE ZONBASEI            TO W-ONBASE-CODE
  2075     END-IF
  2076
  2077     IF ZACTSUML > +0
  2078         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2079     END-IF
  2080
  2081     IF ZCSOSUML > +0
  2082         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2083     END-IF
  2084     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2085*    DISPLAY ' ABOUT TO WRITE '
  2086     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2087                                    PI-CURR-LETR-KEY
  2088                                    PI-PREV-LETR-KEY
  2089
  2090* EXEC CICS WRITE
  2091*       DATASET (ELLETR-FILE-ID)
  2092*       FROM    (TEXT-FILES)
  2093*       RIDFLD  (ELLETR-KEY)
  2094*    END-EXEC
  2095     MOVE LENGTH OF
  2096      TEXT-FILES
  2097       TO DFHEIV11
  2098*    MOVE '&$ L                  ''   #00001943' TO DFHEIV0
  2099     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2101     MOVE X'2020233030303031393433' TO DFHEIV0(25:11)
  2102     CALL 'kxdfhei1' USING DFHEIV0,
  2103           ELLETR-FILE-ID,
  2104           TEXT-FILES,
  2105           DFHEIV11,
  2106           ELLETR-KEY,
  2107           DFHEIV99,
  2108           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1044.cbl
  2109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2110     MOVE ER-0000                    TO  EMI-ERROR.
  2111     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2112     GO TO 1000-SHOW-LETR-RECORD
  2113     .
  2114 5000-FIND-NEXT-PROD-RECORD.
  2115*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2116*
  2117*    EXEC CICS STARTBR
  2118*        DATASET   (ELLETR-FILE-ID)
  2119*        RIDFLD    (ELLETR-KEY)
  2120*        GTEQ
  2121*        RESP      (WS-RESPONSE)
  2122*    END-EXEC
  2123*
  2124*    IF NOT RESP-NORMAL
  2125*       MOVE -1                  TO PFKEYL
  2126*       MOVE ER-0130             TO EMI-ERROR
  2127*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2128*       GO TO 8200-SEND-DATAONLY
  2129*    END-IF
  2130     .
  2131 5000-READNEXT-LOOP.
  2132*    EXEC CICS READNEXT
  2133*        DATASET   (ELLETR-FILE-ID)
  2134*        SET       (ADDRESS OF PRODUCT-MASTER)
  2135*        RIDFLD    (ELLETR-KEY)
  2136*        RESP      (WS-RESPONSE)
  2137*    END-EXEC
  2138*
  2139*    IF (NOT RESP-NORMAL)
  2140*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2141*       PERFORM 5000-END-BROWSE
  2142*       MOVE -1                  TO PFKEYL
  2143*       MOVE ER-0130             TO EMI-ERROR
  2144*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2145*       GO TO 1000-SHOW-LETR-RECORD
  2146*    END-IF
  2147*
  2148*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2149*       GO TO 5000-READNEXT-LOOP
  2150*    END-IF
  2151*
  2152*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2153*
  2154*    PERFORM 5000-END-BROWSE
  2155*    GO TO 7000-BUILD-OUTPUT-MAP
  2156     .
  2157 5000-END-BROWSE.
  2158*    EXEC CICS ENDBR
  2159*        DATASET   (ELLETR-FILE-ID)
  2160*    END-EXEC
  2161     .
  2162 5100-FIND-PREV-PROD-RECORD.
  2163*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2164*    IF STATEL > +0
  2165*       MOVE STATEI              TO ELLETR-STATE
  2166*    END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1044.cbl
  2167*    IF PRODCDL > +0
  2168*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2169*    END-IF
  2170*    IF BENTYPL > +0
  2171*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2172*    IF BENCODEL > +0
  2173*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2174*    IF EXPDTL IS GREATER THAN +0
  2175*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2176*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2177*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2178*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2179*        ELSE
  2180*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2181*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2182*          END-STRING
  2183*           MOVE 'L'                    TO  DC-OPTION-CODE
  2184*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2185*            IF NO-CONVERSION-ERROR
  2186*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2187*            ELSE
  2188*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2189*
  2190*    EXEC CICS HANDLE CONDITION
  2191*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2192*    END-EXEC.
  2193*
  2194*    EXEC CICS STARTBR
  2195*        DATASET   (ELLETR-FILE-ID)
  2196*        RIDFLD    (ELLETR-KEY)
  2197*        GTEQ
  2198*    END-EXEC.
  2199 5100-READPREV-LOOP.
  2200*    EXEC CICS READPREV
  2201*        DATASET   (ELLETR-FILE-ID)
  2202*        SET       (ADDRESS OF PRODUCT-MASTER)
  2203*        RIDFLD    (ELLETR-KEY)
  2204*    END-EXEC.
  2205*
  2206*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2207*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2208*
  2209*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2210*        GO TO 5100-READPREV-LOOP.
  2211*
  2212*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2213*
  2214*    GO TO 7000-BUILD-OUTPUT-MAP.
  2215 5100-END-BROWSE.
  2216*    EXEC CICS ENDBR
  2217*        DATASET   (ELLETR-FILE-ID)
  2218*    END-EXEC.
  2219 5100-UNSUCCESSFUL-SEARCH.
  2220     PERFORM 5100-END-BROWSE.
  2221     MOVE ER-0131                    TO  EMI-ERROR.
  2222     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2223     GO TO 1000-SHOW-LETR-RECORD.
  2224     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1044.cbl
  2225 6000-EDIT-INPUT-DATA.
  2226     IF MAINTI = 'A'
  2227        IF ZLETRL > +0
  2228           AND ZLETRI NOT = SPACES
  2229           CONTINUE
  2230        ELSE
  2231           MOVE AL-UNBON         TO ZCOPIESA
  2232           MOVE -1               TO ZCOPIESL
  2233           MOVE ER-0005          TO EMI-ERROR
  2234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2235        END-IF
  2236     END-IF
  2237     IF ZCOPIESL > +0
  2238        IF ZCOPIESI NUMERIC
  2239           CONTINUE
  2240        ELSE
  2241           MOVE AL-UNBON         TO ZCOPIESA
  2242           MOVE -1               TO ZCOPIESL
  2243           MOVE ER-0184          TO EMI-ERROR
  2244           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2245        END-IF
  2246     END-IF
  2247     IF ZFADAYSL > +0
  2248       IF ZFADAYSI NOT EQUAL SPACES
  2249          IF ZFADAYSI NUMERIC
  2250             CONTINUE
  2251          ELSE
  2252             MOVE AL-UNBON         TO ZFADAYSA
  2253             MOVE -1               TO ZFADAYSL
  2254             MOVE ER-0491          TO EMI-ERROR
  2255             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2256          END-IF
  2257       END-IF
  2258     END-IF
  2259     IF ZRDAYSL > +0
  2260       IF ZRDAYSI NOT EQUAL SPACES
  2261          IF ZRDAYSI NUMERIC
  2262             CONTINUE
  2263          ELSE
  2264             MOVE AL-UNBON         TO ZRDAYSA
  2265             MOVE -1               TO ZRDAYSL
  2266             MOVE ER-0491          TO EMI-ERROR
  2267             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2268          END-IF
  2269       END-IF
  2270     END-IF
  2271     IF ZPROMPTL > +0
  2272        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2273           CONTINUE
  2274        ELSE
  2275           MOVE AL-UABON         TO ZPROMPTA
  2276           MOVE -1               TO ZPROMPTL
  2277           MOVE ER-0627          TO EMI-ERROR
  2278           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2279        END-IF
  2280     END-IF
  2281     IF MAINTI = 'A'
  2282        AND ZENCCDL <= 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1044.cbl
  2283        MOVE AL-UABON            TO ZENCCDA
  2284        MOVE -1                  TO ZENCCDL
  2285        MOVE ER-1560             TO EMI-ERROR
  2286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2287     END-IF
  2288     IF ZENCCDL > +0
  2289        IF ZENCCDI = 'E' OR 'ENV' OR '0' OR '@'
  2290                  OR 'A' OR 'C' OR 'CLM'
  2291                  OR 'RE'
  2292                  OR '1' OR '2' OR '3' OR 'B' OR 'D'
  2293           CONTINUE
  2294        ELSE
  2295           MOVE AL-UABON         TO ZENCCDA
  2296           MOVE -1               TO ZENCCDL
  2297           MOVE ER-1560          TO EMI-ERROR
  2298           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2299        END-IF
  2300     END-IF
  2301     IF MAINTI = 'A'
  2302        AND ZTYPEL <= 0
  2303        MOVE AL-UABON            TO ZTYPEA
  2304        MOVE -1                  TO ZTYPEL
  2305        MOVE ER-1564             TO EMI-ERROR
  2306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2307     END-IF
  2308     IF ZTYPEL > +0
  2309        IF ZTYPEI = 'C' OR 'P' OR 'U'
  2310           CONTINUE
  2311        ELSE
  2312           MOVE -1               TO ZTYPEL
  2313           MOVE AL-UABON         TO ZTYPEA
  2314           MOVE ER-1564          TO EMI-ERROR
  2315           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2316        END-IF
  2317     END-IF
  2318     IF ZACLOSEL > +0
  2319        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2320           CONTINUE
  2321        ELSE
  2322           MOVE -1               TO ZACLOSEL
  2323           MOVE AL-UABON         TO ZACLOSEA
  2324           MOVE ER-1562          TO EMI-ERROR
  2325           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2326        END-IF
  2327     END-IF
  2328     IF ZPRTCRTL > +0
  2329        IF ZPRTCRTI = 'Y' OR 'N' OR ' '
  2330           CONTINUE
  2331        ELSE
  2332           MOVE AL-UABON         TO ZPRTCRTA
  2333           MOVE -1               TO ZPRTCRTL
  2334           MOVE ER-0627          TO EMI-ERROR
  2335           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2336        END-IF
  2337     END-IF
  2338     IF ZREFREQL > +0
  2339        IF ZREFREQI = 'Y' OR 'N' OR ' '
  2340           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1044.cbl
  2341        ELSE
  2342           MOVE AL-UABON         TO ZREFREQA
  2343           MOVE -1               TO ZREFREQL
  2344           MOVE ER-0627          TO EMI-ERROR
  2345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2346        END-IF
  2347     END-IF
  2348     IF MAINTI = 'A'
  2349        AND ZONBASEL <= 0
  2350        MOVE AL-UABON            TO ZONBASEA
  2351        MOVE -1                  TO ZONBASEL
  2352        MOVE ER-3804             TO EMI-ERROR
  2353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2354     END-IF
  2355     IF ZONBASEL > +0
  2356        IF ZONBASEI = ' '
  2357           MOVE AL-UABON            TO ZONBASEA
  2358           MOVE -1                  TO ZONBASEL
  2359           MOVE ER-3804             TO EMI-ERROR
  2360           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2361        END-IF
  2362     END-IF
  2363
  2364     IF ZACTSUML > +0
  2365        IF ZACTSUMI = '1' OR '2' OR ' '
  2366           CONTINUE
  2367        ELSE
  2368           MOVE AL-UABON         TO ZACTSUMA
  2369           MOVE -1               TO ZACTSUML
  2370           MOVE ER-3820          TO EMI-ERROR
  2371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2372        END-IF
  2373     END-IF
  2374
  2375     IF ZCSOSUML > +0
  2376        IF ZCSOSUMI = '3' OR '4' OR ' '
  2377           CONTINUE
  2378        ELSE
  2379           MOVE AL-UABON         TO ZCSOSUMA
  2380           MOVE -1               TO ZCSOSUML
  2381           MOVE ER-3821          TO EMI-ERROR
  2382           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2383        END-IF
  2384     END-IF
  2385
  2386     .
  2387 6000-EXIT.
  2388     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1044.cbl
  2390 7000-BUILD-OUTPUT-MAP.
  2391     MOVE LOW-VALUES             TO EL1044ZO
  2392     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2393     MOVE TX-LETTER-NO           TO ZLETRO
  2394     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2395     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2396     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2397     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2398     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2399     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2400     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2401     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2402     MOVE W-LETTER-TO-ACCT       TO ZACCTO
  2403     MOVE W-LETTER-TYPE          TO ZTYPEO
  2404     MOVE W-PRINT-CERTIFICATE    TO ZPRTCRTO
  2405     MOVE W-REFUND-REQUIRED      TO ZREFREQO
  2406     MOVE W-ONBASE-CODE          TO ZONBASEO
  2407     MOVE W-ACCT-SUMM            TO ZACTSUMO
  2408     MOVE W-CSO-SUMM             TO ZCSOSUMO
  2409     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2410                                    PI-UPDATE-BY
  2411     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2412                                    DC-BIN-DATE-1
  2413     MOVE ' '                    TO DC-OPTION-CODE
  2414     MOVE +0                     TO DC-ELAPSED-DAYS
  2415                                     DC-ELAPSED-MONTHS.
  2416     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2417     IF NO-CONVERSION-ERROR
  2418        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2419     ELSE
  2420        MOVE LOW-VALUES          TO LSTDTEO
  2421     END-IF
  2422     MOVE -1                     TO MAINTL
  2423     .
  2424 8100-SEND-INITIAL-MAP.
  2425     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2426     MOVE EIBTIME                    TO  TIME-IN.
  2427     MOVE SAVE-DATE                  TO  DATEO.
  2428     MOVE TIME-OUT                   TO  TIMEO
  2429     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2430     MOVE PI-PROCESSOR-ID        TO USERIDO
  2431
  2432* EXEC CICS SEND
  2433*        MAP      (WS-MAP-NAME)
  2434*        MAPSET   (MAPSET-NAME)
  2435*        FROM     (EL1044ZO)
  2436*        ERASE
  2437*        CURSOR
  2438*    END-EXEC.
  2439     MOVE LENGTH OF
  2440      EL1044ZO
  2441       TO DFHEIV12
  2442     MOVE -1
  2443       TO DFHEIV11
  2444*    MOVE '8$     CT  E    H L F ,   #00002269' TO DFHEIV0
  2445     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2446     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2447     MOVE X'2020233030303032323639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1044.cbl
  2448     CALL 'kxdfhei1' USING DFHEIV0,
  2449           WS-MAP-NAME,
  2450           EL1044ZO,
  2451           DFHEIV12,
  2452           MAPSET-NAME,
  2453           DFHEIV99,
  2454           DFHEIV99,
  2455           DFHEIV99,
  2456           DFHEIV11,
  2457           DFHEIV99,
  2458           DFHEIV99,
  2459           DFHEIV99
  2460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2461
  2462     MOVE '044Z'                 TO PI-CURRENT-SCREEN-NO
  2463     GO TO 9100-RETURN-TRAN
  2464     .
  2465 8200-SEND-DATAONLY.
  2466*    DISPLAY ' MADE IT TO 8200 '
  2467     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2468     MOVE EIBTIME                    TO  TIME-IN.
  2469     MOVE SAVE-DATE                  TO  DATEO.
  2470     MOVE TIME-OUT                   TO  TIMEO.
  2471     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2472     MOVE PI-PROCESSOR-ID        TO USERIDO
  2473
  2474* EXEC CICS SEND
  2475*        MAP      (WS-MAP-NAME)
  2476*        MAPSET   (MAPSET-NAME)
  2477*        FROM     (EL1044ZO)
  2478*        DATAONLY
  2479*        CURSOR
  2480*    END-EXEC.
  2481     MOVE LENGTH OF
  2482      EL1044ZO
  2483       TO DFHEIV12
  2484     MOVE -1
  2485       TO DFHEIV11
  2486*    MOVE '8$D    CT       H L F ,   #00002287' TO DFHEIV0
  2487     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2488     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2489     MOVE X'2020233030303032323837' TO DFHEIV0(25:11)
  2490     CALL 'kxdfhei1' USING DFHEIV0,
  2491           WS-MAP-NAME,
  2492           EL1044ZO,
  2493           DFHEIV12,
  2494           MAPSET-NAME,
  2495           DFHEIV99,
  2496           DFHEIV99,
  2497           DFHEIV99,
  2498           DFHEIV11,
  2499           DFHEIV99,
  2500           DFHEIV99,
  2501           DFHEIV99
  2502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2503
  2504     GO TO 9100-RETURN-TRAN
  2505     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1044.cbl
  2506 8300-SEND-TEXT.
  2507
  2508* EXEC CICS SEND TEXT
  2509*        FROM  (LOGOFF-TEXT)
  2510*        LENGTH(LOGOFF-LENGTH)
  2511*        ERASE
  2512*        FREEKB
  2513*    END-EXEC.
  2514*    MOVE '8&      T  E F  H   F -   #00002297' TO DFHEIV0
  2515     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2516     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2517     MOVE X'2020233030303032323937' TO DFHEIV0(25:11)
  2518     CALL 'kxdfhei1' USING DFHEIV0,
  2519           LOGOFF-TEXT,
  2520           LOGOFF-LENGTH,
  2521           DFHEIV99,
  2522           DFHEIV99,
  2523           DFHEIV99,
  2524           DFHEIV99,
  2525           DFHEIV99,
  2526           DFHEIV99,
  2527           DFHEIV99,
  2528           DFHEIV99,
  2529           DFHEIV99,
  2530           DFHEIV99
  2531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2532
  2533
  2534* EXEC CICS RETURN
  2535*        END-EXEC.
  2536*    MOVE '.(                    &   #00002303' TO DFHEIV0
  2537     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2538     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2539     MOVE X'2020233030303032333033' TO DFHEIV0(25:11)
  2540     CALL 'kxdfhei1' USING DFHEIV0,
  2541           DFHEIV99,
  2542           DFHEIV99,
  2543           DFHEIV99,
  2544           DFHEIV99,
  2545           DFHEIV99
  2546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2547
  2548     .
  2549 8500-DEEDIT.
  2550     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2551                                 TO WS-9V999-OF-DEEDIT
  2552     .
  2553 8500-EXIT.
  2554     EXIT.
  2555 8600-DEEDIT.
  2556     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2557                                 TO WS-NUMVAL-OF-DEEDIT
  2558     .
  2559 8600-EXIT.
  2560     EXIT.
  2561 8800-UNAUTHORIZED-ACCESS.
  2562     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2563     GO TO 8300-SEND-TEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1044.cbl
  2564 8810-PF23.
  2565     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2566     MOVE XCTL-005                   TO  PGM-NAME.
  2567     GO TO 9300-XCTL.
  2568 8850-DUPREC.
  2569     MOVE ER-0132                    TO  EMI-ERROR.
  2570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2571     MOVE -1                         TO  MAINTL
  2572     MOVE AL-UABON                   TO  ZLETRA
  2573     GO TO 8100-SEND-INITIAL-MAP.
  2574 8870-NOTOPEN.
  2575     MOVE LOW-VALUES                 TO  EL1044ZO.
  2576     MOVE -1                         TO  MAINTL.
  2577     MOVE ER-0701                    TO  EMI-ERROR.
  2578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2579     GO TO 8100-SEND-INITIAL-MAP.
  2580 8880-NOT-FOUND.
  2581     MOVE ER-0702                    TO  EMI-ERROR.
  2582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2583     MOVE -1                         TO  MAINTL
  2584     MOVE AL-UABON                   TO  ZLETRA
  2585     GO TO 8100-SEND-INITIAL-MAP.
  2586     .
  2587 9100-RETURN-TRAN.
  2588     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2589
  2590* EXEC CICS RETURN
  2591*        TRANSID    (TRANS-ID)
  2592*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2593*        LENGTH     (PI-COMM-LENGTH)
  2594*    END-EXEC.
  2595*    MOVE '.(CT                  &   #00002346' TO DFHEIV0
  2596     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2597     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2598     MOVE X'2020233030303032333436' TO DFHEIV0(25:11)
  2599     CALL 'kxdfhei1' USING DFHEIV0,
  2600           TRANS-ID,
  2601           PROGRAM-INTERFACE-BLOCK,
  2602           PI-COMM-LENGTH,
  2603           DFHEIV99,
  2604           DFHEIV99
  2605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2606
  2607 9200-RETURN-MAIN-MENU.
  2608     MOVE XCTL-626                   TO  PGM-NAME.
  2609     GO TO 9300-XCTL.
  2610 9300-XCTL.
  2611
  2612* EXEC CICS XCTL
  2613*        PROGRAM    (PGM-NAME)
  2614*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2615*        LENGTH     (PI-COMM-LENGTH)
  2616*    END-EXEC.
  2617*    MOVE '.$C                   $   #00002355' TO DFHEIV0
  2618     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2619     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2620     MOVE X'2020233030303032333535' TO DFHEIV0(25:11)
  2621     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1044.cbl
  2622           PGM-NAME,
  2623           PROGRAM-INTERFACE-BLOCK,
  2624           PI-COMM-LENGTH
  2625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2626
  2627 9400-CLEAR.
  2628     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2629     GO TO 9300-XCTL.
  2630 9500-PF12.
  2631     MOVE XCTL-010                   TO  PGM-NAME.
  2632     GO TO 9300-XCTL.
  2633 9600-PGMID-ERROR.
  2634
  2635* EXEC CICS HANDLE CONDITION
  2636*        PGMIDERR   (8300-SEND-TEXT)
  2637*    END-EXEC.
  2638*    MOVE '"$L                   ! # #00002367' TO DFHEIV0
  2639     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2641     MOVE X'2320233030303032333637' TO DFHEIV0(25:11)
  2642     CALL 'kxdfhei1' USING DFHEIV0
  2643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2644
  2645     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2646     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2647     MOVE XCTL-005                   TO  PGM-NAME.
  2648     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2649     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2650     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1044.cbl
  2652 9700-LINK-DATE-CONVERT.
  2653
  2654* EXEC CICS LINK
  2655*        PROGRAM    ('ELDATCV')
  2656*        COMMAREA   (DATE-CONVERSION-DATA)
  2657*        LENGTH     (DC-COMM-LENGTH)
  2658*    END-EXEC.
  2659     MOVE 'ELDATCV' TO DFHEIV1
  2660*    MOVE '."C                   ''   #00002378' TO DFHEIV0
  2661     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2662     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2663     MOVE X'2020233030303032333738' TO DFHEIV0(25:11)
  2664     CALL 'kxdfhei1' USING DFHEIV0,
  2665           DFHEIV1,
  2666           DATE-CONVERSION-DATA,
  2667           DC-COMM-LENGTH,
  2668           DFHEIV99,
  2669           DFHEIV99,
  2670           DFHEIV99
  2671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2672
  2673 9700-EXIT.
  2674     EXIT.
  2675 9900-ERROR-FORMAT.
  2676     IF NOT EMI-ERRORS-COMPLETE
  2677         MOVE LINK-001               TO  PGM-NAME
  2678
  2679* EXEC CICS LINK
  2680*            PROGRAM    (PGM-NAME)
  2681*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2682*            LENGTH     (EMI-COMM-LENGTH)
  2683*        END-EXEC.
  2684*    MOVE '."C                   ''   #00002388' TO DFHEIV0
  2685     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2686     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2687     MOVE X'2020233030303032333838' TO DFHEIV0(25:11)
  2688     CALL 'kxdfhei1' USING DFHEIV0,
  2689           PGM-NAME,
  2690           ERROR-MESSAGE-INTERFACE-BLOCK,
  2691           EMI-COMM-LENGTH,
  2692           DFHEIV99,
  2693           DFHEIV99,
  2694           DFHEIV99
  2695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2696
  2697 9900-EXIT.
  2698     EXIT.
  2699 9990-ABEND.
  2700     MOVE LINK-004                   TO  PGM-NAME.
  2701     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2702
  2703* EXEC CICS LINK
  2704*        PROGRAM   (PGM-NAME)
  2705*        COMMAREA  (EMI-LINE1)
  2706*        LENGTH    (72)
  2707*    END-EXEC.
  2708     MOVE 72
  2709       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1044.cbl
  2710*    MOVE '."C                   ''   #00002398' TO DFHEIV0
  2711     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2712     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2713     MOVE X'2020233030303032333938' TO DFHEIV0(25:11)
  2714     CALL 'kxdfhei1' USING DFHEIV0,
  2715           PGM-NAME,
  2716           EMI-LINE1,
  2717           DFHEIV11,
  2718           DFHEIV99,
  2719           DFHEIV99,
  2720           DFHEIV99
  2721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2722
  2723     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1044.cbl
  2725 9995-SECURITY-VIOLATION.
  2726*                            COPY ELCSCTP.
  2727******************************************************************
  2728*                                                                *
  2729*                            ELCSCTP                             *
  2730*                            VMOD=2.001                          *
  2731*                                                                *
  2732*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2733******************************************************************
  2734
  2735
  2736     MOVE EIBDATE          TO SM-JUL-DATE.
  2737     MOVE EIBTRMID         TO SM-TERMID.
  2738     MOVE THIS-PGM         TO SM-PGM.
  2739     MOVE EIBTIME          TO TIME-IN.
  2740     MOVE TIME-OUT         TO SM-TIME.
  2741     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2742
  2743
  2744* EXEC CICS LINK
  2745*         PROGRAM  ('EL003')
  2746*         COMMAREA (SECURITY-MESSAGE)
  2747*         LENGTH   (80)
  2748*    END-EXEC.
  2749     MOVE 'EL003' TO DFHEIV1
  2750     MOVE 80
  2751       TO DFHEIV11
  2752*    MOVE '."C                   ''   #00002423' TO DFHEIV0
  2753     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2754     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2755     MOVE X'2020233030303032343233' TO DFHEIV0(25:11)
  2756     CALL 'kxdfhei1' USING DFHEIV0,
  2757           DFHEIV1,
  2758           SECURITY-MESSAGE,
  2759           DFHEIV11,
  2760           DFHEIV99,
  2761           DFHEIV99,
  2762           DFHEIV99
  2763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2764
  2765
  2766******************************************************************
  2767
  2768 9995-EXIT.
  2769     EXIT.
  2770
  2771 9999-DFHBACK SECTION.
  2772     MOVE '9%                    "   ' TO DFHEIV0
  2773     MOVE 'EL1044' TO DFHEIV1
  2774     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2775     GOBACK.
  2776 9999-DFHEXIT.
  2777     IF DFHEIGDJ EQUAL 0001
  2778         NEXT SENTENCE
  2779     ELSE IF DFHEIGDJ EQUAL 2
  2780         GO TO 8850-DUPREC,
  2781               8870-NOTOPEN,
  2782               8880-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1044.cbl
  2783               9600-PGMID-ERROR,
  2784               9990-ABEND
  2785         DEPENDING ON DFHEIGDI
  2786     ELSE IF DFHEIGDJ EQUAL 3
  2787         GO TO 8300-SEND-TEXT
  2788         DEPENDING ON DFHEIGDI.
  2789     MOVE '9%                    "   ' TO DFHEIV0
  2790     MOVE 'EL1044' TO DFHEIV1
  2791     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2792     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4616     Code:        6775
