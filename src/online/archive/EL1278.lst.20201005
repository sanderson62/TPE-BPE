* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57* 050713  CR2011062300001  PEMA  REM CHG FOR EXT DYS FOR ROA REF
    58* 041514  CR2012110200003  AJRA  REMOVE PF11 FROM SCREEN,
    59*                                CANCEL QUOTE SCRIPT WILL DO PF11
    60* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    61* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
    62* 072616  CR2016020400001  PEMA  ADD PF10 CONFIRMATION
    63* 032117  CR2017030300002  PEMA  ADD COMM % AND COMM AMT
    64* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    65******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   3
* EL1278.cbl
    67 ENVIRONMENT DIVISION.
    68 DATA DIVISION.
    69 WORKING-STORAGE SECTION.
    70 01  DFH-START PIC X(04).
    71 77  FILLER  PIC  X(32) VALUE '********************************'.
    72 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    73 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    74 77  S1                          PIC S999 COMP-3 VALUE +0.
    75 77  P1                          PIC S999 COMP-3 VALUE +0.
    76 77  P2                          PIC S999 COMP-3 VALUE +0.
    77 77  C0                          PIC S999 COMP-3 VALUE +0.
    78 77  C1                          PIC S999 COMP-3 VALUE +0.
    79 77  C2                          PIC S999 COMP-3 VALUE +0.
    80 77  C3                          PIC S999 COMP-3 VALUE +0.
    81 77  WS-STOP-SW                  PIC X  VALUE ' '.
    82     88  I-SAY-TO-STOP      VALUE 'Y'.
    83 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    84     88  OPEN-LF-CLAIM              VALUE 'Y'.
    85 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    86     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    87 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    88     88  OPEN-AH-CLAIM              VALUE 'Y'.
    89 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    90     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    91 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    92     88  FOUND-A-CLAIM              VALUE 'Y'.
    93 77  WS-CLAIM-TYPE               PIC X  VALUE ' '.
    94     88  LIFE-CLAIM                 VALUE 'L'.
    95     88  OTHER-CLAIM                VALUE 'O'.
    96 77  WS-CLAIM-LIT                PIC X(06)  VALUE SPACES.
    97 77  WS-ST-REF-IND               PIC X.
    98 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    99 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
   100 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
   101 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
   102 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
   103 77  DD-IU-SW                    PIC X   VALUE ' '.
   104     88  DD-IU-PRESENT                 VALUE 'Y'.
   105 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   106 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   107 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   108 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   109 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   110 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   111 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   112 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   113 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   114     88  NO-CERT-RW                 VALUE 'N'.
   115     88  CERT-RW                    VALUE 'Y'.
   116 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   117     88  ERMAIL-FOUND                 VALUE 'Y'.
   118 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   119
   120*                            COPY ELCSCTM.
   121******************************************************************
   122*                                                                *
   123*                                                                *
   124*                            ELCSCTM                             *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   4
* EL1278.cbl
   125*                            VMOD=2.001                          *
   126*                                                                *
   127*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   128*                                                                *
   129******************************************************************
   130 01  SECURITY-MESSAGE.
   131     12  FILLER                          PIC X(30)
   132            VALUE '** LOGIC SECURITY VIOLATION -'.
   133     12  SM-READ                         PIC X(6).
   134     12  FILLER                          PIC X(5)
   135            VALUE ' PGM='.
   136     12  SM-PGM                          PIC X(6).
   137     12  FILLER                          PIC X(5)
   138            VALUE ' OPR='.
   139     12  SM-PROCESSOR-ID                 PIC X(4).
   140     12  FILLER                          PIC X(6)
   141            VALUE ' TERM='.
   142     12  SM-TERMID                       PIC X(4).
   143     12  FILLER                          PIC XX   VALUE SPACE.
   144     12  SM-JUL-DATE                     PIC 9(5).
   145     12  FILLER                          PIC X    VALUE SPACE.
   146     12  SM-TIME                         PIC 99.99.
   147
   148
   149*                            COPY ELCSCRTY.
   150******************************************************************
   151*                                                                *
   152*                                                                *
   153*                            ELCSCRTY                            *
   154*                            VMOD=2.001                          *
   155*                                                                *
   156*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   157*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   158*        SAVED IN PI-SECURITY-ADDRESS.                           *
   159*                                                                *
   160******************************************************************
   161 01  SECURITY-CONTROL.
   162     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   163     12  FILLER                       PIC XX    VALUE 'SC'.
   164     12  SC-CREDIT-CODES.
   165         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   166             20  SC-CREDIT-DISPLAY    PIC X.
   167             20  SC-CREDIT-UPDATE     PIC X.
   168     12  SC-CLAIMS-CODES.
   169         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   170             20  SC-CLAIMS-DISPLAY    PIC X.
   171             20  SC-CLAIMS-UPDATE     PIC X.
   172
   173 01  FILLER          COMP-3.
   174     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   175     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   176     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   177     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   178     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   179     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   180     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   181     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   182     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   5
* EL1278.cbl
   183
   184 01  WS-DATE-AREA.
   185     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   186     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   187     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   188     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   189     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   190     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   191
   192 01  ERPDEF-KEY-SAVE             PIC X(18).
   193 01  ERPDEF-KEY.
   194     12  ERPDEF-COMPANY-CD       PIC X.
   195     12  ERPDEF-STATE            PIC XX.
   196     12  ERPDEF-PROD-CD          PIC XXX.
   197     12  F                       PIC X(7).
   198     12  ERPDEF-BEN-TYPE         PIC X.
   199     12  ERPDEF-BEN-CODE         PIC XX.
   200     12  ERPDEF-EXP-DT           PIC XX.
   201 01  ELMSTR-KEY.
   202     12  ELMSTR-COMP-CD          PIC X.
   203     12  ELMSTR-CERT-NO          PIC X(11).
   204 01  ELCRTT-KEY.
   205     12  ELCRTT-PRIMARY          PIC X(33).
   206     12  ELCRTT-REC-TYPE         PIC X(1).
   207
   208 01  ELCRTO-KEY.
   209     05  ELCRTO-COMPANY-CD       PIC X.
   210     05  ELCRTO-CARRIER          PIC X.
   211     05  ELCRTO-GROUPING         PIC X(6).
   212     05  ELCRTO-STATE            PIC XX.
   213     05  ELCRTO-ACCOUNT          PIC X(10).
   214     05  ELCRTO-CERT-EFF-DT      PIC XX.
   215     05  ELCRTO-CERT-NO.
   216         10  ELCRTO-CERT-PRIME   PIC X(10).
   217         10  ELCRTO-CERT-SFX     PIC X.
   218     05  ELCRTO-RECORD-TYPE      PIC X.
   219     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   220
   221 01  STANDARD-AREAS.
   222     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   223     12  SUB3                    PIC S9(04) COMP VALUE +0.
   224     12  SUB4                    PIC S9(04) COMP VALUE +0.
   225     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   226     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   227     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   228     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   229     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   230     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   231     12  PGM-NAME                PIC  X(08).
   232     12  TIME-IN                 PIC S9(07).
   233     12  TIME-OUT-R  REDEFINES  TIME-IN.
   234         16  FILLER              PIC  X(01).
   235         16  TIME-OUT            PIC  9(02)V99.
   236         16  FILLER              PIC  X(02).
   237     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   238     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   239     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   240     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   6
* EL1278.cbl
   241     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   242     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   243     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   244     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
   245     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   246     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   247     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   248     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   249     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   250     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   251     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   252     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   253     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   254     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   255         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   256     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   257         88  BROWSE-STARTED                      VALUE 'Y'.
   258     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   259         88  FORM-FOUND                          VALUE 'Y'.
   260     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   261         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   262     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   263         88  WS-REDUCING                         VALUE 'R'.
   264         88  WS-LEVEL                            VALUE 'L'  'P'.
   265     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   266         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   267     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   268         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   269     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   270     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   271         'CLAIM PMTS'.
   272     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   273         'ITD REFUND'.
   274     12  WS-ACCESS.
   275         16  FILLER              PIC  X(02).
   276         16  WS-BEN-CD           PIC  X(02).
   277     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   278     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   279     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   280     12  WS-LOOKUP-TYPE          PIC  X(01).
   281     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   282     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   283     12  WS-CALC-CD              PIC  X(01).
   284     12  DEEDIT-FIELD            PIC  X(15).
   285     12  DEEDIT-FIELD-V0  REDEFINES
   286         DEEDIT-FIELD            PIC S9(15).
   287     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   288     12  RETURN-FROM             PIC  X(08).
   289     12  QID.
   290         16  QID-TERM            PIC  X(04).
   291         16  FILLER              PIC  X(04)      VALUE '127H'.
   292     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   293         88  FIRST-ENTRY                         VALUE 'Y'.
   294     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   295         88  PDEF-FOUND                          VALUE 'Y'.
   296     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   297         88  CERT-FOUND                          VALUE 'Y'.
   298         88  CERT-NOT-FOUND                      VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   7
* EL1278.cbl
   299     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   300         88  CNTL-FOUND                          VALUE 'Y'.
   301         88  CNTL-NOT-FOUND                      VALUE 'N'.
   302     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
   303         88  BEN-FOUND                           VALUE 'Y'.
   304     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   305         88  STATE-FOUND                         VALUE 'Y'.
   306     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   307         88  ST-BEN-FOUND                        VALUE 'Y'.
   308     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   309         88  ACCT-FOUND                          VALUE 'Y'.
   310     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   311         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   312     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   313                                                 VALUE ZERO.
   314         88  BENEFIT-FOUND                       VALUE +1.
   315     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   316                                                 VALUE ZERO.
   317     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   318                                                 VALUE ZERO.
   319     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   320     12  WS-SUB1                 PIC S99    COMP.
   321     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   322     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   323     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   324     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   325     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   326     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   327     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   328     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   329     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   330     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   331     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   332     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   333     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   334     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   335     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   336     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   337     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   338     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   339     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   340     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   341     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   342     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   343     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   344     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   345     12  ERROR-MESSAGES.
   346         16  ER-0000             PIC  X(04)      VALUE '0000'.
   347         16  ER-0004             PIC  X(04)      VALUE '0004'.
   348         16  ER-0008             PIC  X(04)      VALUE '0008'.
   349         16  ER-0028             PIC  X(04)      VALUE '0028'.
   350         16  ER-0029             PIC  X(04)      VALUE '0029'.
   351         16  ER-0070             PIC  X(04)      VALUE '0070'.
   352         16  ER-0142             PIC  X(04)      VALUE '0142'.
   353         16  ER-0214             PIC  X(04)      VALUE '0214'.
   354         16  ER-0681             PIC  X(04)      VALUE '0681'.
   355         16  ER-0682             PIC  X(04)      VALUE '0682'.
   356         16  ER-0683             PIC  X(04)      VALUE '0683'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   8
* EL1278.cbl
   357         16  ER-0684             PIC  X(04)      VALUE '0684'.
   358         16  ER-2227             PIC  X(04)      VALUE '2227'.
   359         16  ER-2601             PIC  X(04)      VALUE '2601'.
   360         16  ER-2616             PIC  X(04)      VALUE '2616'.
   361         16  ER-2617             PIC  X(04)      VALUE '2617'.
   362         16  ER-2619             PIC  X(04)      VALUE '2619'.
   363         16  ER-2740             PIC  X(04)      VALUE '2740'.
   364         16  ER-2756             PIC  X(04)      VALUE '2756'.
   365         16  ER-2768             PIC  X(04)      VALUE '2768'.
   366         16  ER-2774             PIC  X(04)      VALUE '2774'.
   367         16  ER-2775             PIC  X(04)      VALUE '2775'.
   368         16  ER-2965             PIC  X(04)      VALUE '2965'.
   369         16  ER-2966             PIC  X(04)      VALUE '2966'.
   370         16  ER-2967             PIC  X(04)      VALUE '2967'.
   371         16  ER-2968             PIC  X(04)      VALUE '2968'.
   372         16  ER-2969             PIC  X(04)      VALUE '2969'.
   373         16  ER-2998             PIC  X(04)      VALUE '2998'.
   374         16  ER-3037             PIC  X(04)      VALUE '3037'.
   375         16  ER-3038             PIC  X(04)      VALUE '3038'.
   376         16  ER-3039             PIC  X(04)      VALUE '3039'.
   377         16  ER-3780             PIC  X(04)      VALUE '3780'.
   378         16  ER-3781             PIC  X(04)      VALUE '3781'.
   379         16  ER-3830             PIC  X(04)      VALUE '3830'.
   380         16  er-3847             pic  x(04)      value '3847'.
   381         16  ER-8160             PIC  X(04)      VALUE '8160'.
   382         16  ER-8161             PIC  X(04)      VALUE '8161'.
   383         16  ER-9999             PIC  X(04)      VALUE '9999'.
   384     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   385     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   386     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   387     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   388
   389     12  WS-RESPONSE             PIC S9(8)       COMP.
   390         88  WS-RESP-NORMAL                      VALUE +00.
   391         88  WS-RESP-NOTFND                      VALUE +13.
   392         88  WS-RESP-DUPREC                      VALUE +14.
   393         88  WS-RESP-DUPKEY                      VALUE +15.
   394         88  WS-RESP-NOTOPEN                     VALUE +19.
   395         88  WS-RESP-ENDFILE                     VALUE +20.
   396
   397     12  WS-01-CANCEL-ERR        PIC X(25)
   398         VALUE 'CANCEL DATE ERROR'.
   399     12  WS-02-CANCEL-ERR        PIC X(25)
   400         VALUE 'CERT NOT FOUND'.
   401     12  WS-04-CANCEL-ERR        PIC X(25)
   402         VALUE 'CANCEL AMOUNT ERROR'.
   403     12  WS-05-CANCEL-ERR        PIC X(25)
   404         VALUE 'CANCEL OPTION ERROR'.
   405     12  WS-06-CANCEL-ERR        PIC X(25)
   406         VALUE 'PREVIOUSLY CANCELLED'.
   407     12  WS-07-CANCEL-ERR        PIC X(25)
   408         VALUE 'INVALID DATA'.
   409     12  WS-08-CANCEL-ERR        PIC X(25)
   410         VALUE 'NO ACCOUNT MASTER'.
   411     12  WS-09-CANCEL-ERR        PIC X(25)
   412         VALUE 'SUFFIX ALREADY EXISTS'.
   413     12  WS-99-CANCEL-ERR        PIC X(25)
   414         VALUE 'MISC CANCEL ERROR'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page   9
* EL1278.cbl
   415
   416 01  WS-SAVE-ALLOWABLE-BENEFIT.
   417     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   418     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   419     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   420     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   421     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   422     16  FILLER                    PIC XX.
   423 01  CTBL-KEY-SAVE               PIC X(5).
   424 01  CTBL-KEY.
   425     05  CTBL-COMPANY-CD         PIC X.
   426     05  CTBL-TABLE              PIC XXX.
   427     05  CTBL-BEN-TYPE           PIC X.
   428     05  CTBL-BEN-CODE           PIC XX.
   429 01  CANCEL-GEN-PASS-AREA.
   430     05  CG-OPTION-CODE          PIC X.
   431         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   432         88  CG-FLAT-CANCEL        VALUE '1'.
   433         88  CG-CANCEL             VALUE '2'.
   434         88  CG-CANCEL-REISSUE     VALUE '3'.
   435     05  CG-ERROR-CODE           PIC 99.
   436         88  CG-SUCCESS            VALUE 00.
   437         88  CG-DATE-ERROR         VALUE 01.
   438         88  CG-CERT-NOT-FOUND     VALUE 02.
   439         88  CG-AMOUNT-ERROR       VALUE 04.
   440         88  CG-OPTION-ERROR       VALUE 05.
   441         88  CG-PREV-CAN           VALUE 06.
   442         88  CG-INVALID-DATA       VALUE 07.
   443         88  CG-NO-ACCT-MSTR       VALUE 08.
   444         88  CG-SFX-A-EXIST        VALUE 09.
   445         88  CG-MISC-ERROR         VALUE 99.
   446     05  CG-COMPANY-ID           PIC XXX.
   447     05  CG-PROC-ID              PIC XXXX.
   448     05  CG-CURRENT-DT           PIC XX.
   449     05  CG-MONTH-END-DT         PIC XX.
   450     05  CG-CERT-KEY.
   451         10  CG-CERT-COMPANY-CD  PIC X.
   452         10  CG-CERT-CARRIER     PIC X.
   453         10  CG-CERT-GROUP       PIC X(6).
   454         10  CG-CERT-STATE       PIC XX.
   455         10  CG-CERT-ACCOUNT     PIC X(10).
   456         10  CG-CERT-EFF-DT      PIC XX.
   457         10  CG-CERT-CERT-NO     PIC X(11).
   458     05  CG-LF-CAN-DATA.
   459         10  CG-LF-CAN-DT        PIC XX.
   460         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   461     05  CG-AH-CAN-DATA.
   462         10  CG-AH-CAN-DT        PIC XX.
   463         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   464     05  CG-CERT-PROFILE-DATA.
   465         10  CG-INS-LNAME        PIC X(15).
   466         10  CG-INS-FNAME        PIC X(10).
   467         10  CG-INS-MID-INIT     PIC X.
   468         10  CG-INS-AGE          PIC 99.
   469         10  CG-JNT-LNAME        PIC X(15).
   470         10  CG-JNT-FNAME        PIC X(10).
   471         10  CG-JNT-MID-INIT     PIC X.
   472         10  CG-JNT-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  10
* EL1278.cbl
   473     05  CG-LF-ISS-DATA.
   474         10  CG-LF-BENCD         PIC XX.
   475         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   476         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   477     05  CG-AH-ISS-DATA.
   478         10  CG-AH-BENCD         PIC XX.
   479         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   480     05  CG-BATCH-NO             PIC X(6).
   481     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   482     05  FILLER                  PIC X(306).
   483 01  WS-CAN-QUOTE-NOTE.
   484     12  WS-CN-CANCEL-DT         PIC  X(09).
   485     12  FILLER                  PIC  X(10)      VALUE
   486         'RF QUOTE: '.
   487     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   488     12  FILLER                  PIC  X(4)       VALUE
   489         ' LF '.
   490     12  WS-CN-LF-REF-METH       PIC  X.
   491     12  FILLER                  PIC  X          VALUE ','.
   492     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   493     12  FILLER                  PIC  X(5)       VALUE
   494         ' AH '.
   495     12  WS-CN-AH-REF-METH       PIC  X.
   496     12  FILLER                  PIC  XX         VALUE ','.
   497     12  FILLER                  PIC  X(6)       VALUE
   498         'TOTAL '.
   499     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   500     12  FILLER                  PIC  X(01)      VALUE ' '.
   501     12  WS-CN-DT-QUOTED         PIC  X(08).
   502     12  FILLER                  PIC  X(01)      VALUE ';'.
   503     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   504
   505 01  WS-CM-CONTROL-PRIMARY.
   506     12  WS-CM-COMPANY-CD        PIC  X(01).
   507     12  WS-CM-CARRIER           PIC  X(01).
   508     12  WS-CM-GROUPING          PIC  X(06).
   509     12  WS-CM-STATE             PIC  X(02).
   510     12  WS-CM-ACCOUNT           PIC  X(10).
   511     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   512     12  WS-CM-CERT-NO.
   513         16  WS-CM-CERT-PRIME    PIC  X(10).
   514         16  WS-CM-CERT-SFX      PIC  X(01).
   515
   516 01  WS-MA-CONTROL-PRIMARY.
   517     12  WS-MA-COMPANY-CD        PIC  X(01).
   518     12  WS-MA-CARRIER           PIC  X(01).
   519     12  WS-MA-GROUPING          PIC  X(06).
   520     12  WS-MA-STATE             PIC  X(02).
   521     12  WS-MA-ACCOUNT           PIC  X(10).
   522     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   523     12  WS-MA-CERT-NO.
   524         16  WS-MA-CERT-PRIME    PIC  X(10).
   525         16  WS-MA-CERT-SFX      PIC  X(01).
   526 01  WS-CF-CONTROL-PRIMARY.
   527     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   528     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   529*        88  COMPANY-MASTER                      VALUE '1'.
   530*        88  STATE-MASTER                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  11
* EL1278.cbl
   531*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   532*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   533     12  WS-CF-ACCESS.
   534         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   535         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   536             20  FILLER          PIC  X(01).
   537             20  WS-CF-CARRIER   PIC  X(01).
   538     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   539
   540 01  WS-AM-CONTROL-PRIMARY.
   541     12  WS-AM-COMPANY-CD        PIC  X(01).
   542     12  WS-AM-CARRIER           PIC  X(01).
   543     12  WS-AM-GROUPING          PIC  X(06).
   544     12  WS-AM-STATE             PIC  X(02).
   545     12  WS-AM-ACCOUNT           PIC  X(10).
   546     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   547     12  WS-AM-FILLER            PIC  X(04).
   548
   549 01  WS-CN-CONTROL-PRIMARY.
   550     12  WS-CN-COMPANY-CD        PIC  X(01).
   551     12  WS-CN-CARRIER           PIC  X(01).
   552     12  WS-CN-GROUPING          PIC  X(06).
   553     12  WS-CN-STATE             PIC  X(02).
   554     12  WS-CN-ACCOUNT           PIC  X(10).
   555     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   556     12  WS-CN-CERT-NO.
   557         16  WS-CN-CERT-PRIME    PIC  X(10).
   558         16  WS-CN-CERT-SFX      PIC  X.
   559     12  WS-CN-REC-TYPE          PIC X.
   560     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   561
   562 01  WS-FO-CONTROL-PRIMARY.
   563     12  WS-FO-COMPANY-CD        PIC  X(01).
   564     12  WS-FO-STATE             PIC  X(02).
   565     12  WS-FO-FORM-ID           PIC  X(12).
   566     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  12
* EL1278.cbl
   568*                            COPY ERCCNOT.
   569******************************************************************
   570*                                                                *
   571*                            ERCCNOT                             *
   572*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   573*                            VMOD=2.003                          *
   574*                                                                *
   575*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   576*                                                                *
   577*        FILE TYPE= VSAM,KSDS                                    *
   578*        RECORD SIZE = 150    RECFORM = FIXED                    *
   579*                                                                *
   580*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   581*                                                                *
   582*        LOG = YES                                               *
   583*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   584*                                                                *
   585******************************************************************
   586*                   C H A N G E   L O G
   587*
   588* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   589*-----------------------------------------------------------------
   590*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   591* EFFECTIVE    NUMBER
   592*-----------------------------------------------------------------
   593* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   594******************************************************************
   595
   596 01  CERT-NOTE-FILE.
   597     12  CZ-RECORD-ID                PIC  XX.
   598         88  VALID-CZ-ID                  VALUE 'CZ'.
   599
   600     12  CZ-CONTROL-PRIMARY.
   601         16  CZ-COMPANY-CD           PIC X.
   602         16  CZ-CARRIER              PIC X.
   603         16  CZ-GROUPING.
   604             20 CZ-GROUPING-PREFIX   PIC XXX.
   605             20 CZ-GROUPING-PRIME    PIC XXX.
   606         16  CZ-STATE                PIC XX.
   607         16  CZ-ACCOUNT.
   608             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   609             20 CZ-ACCOUNT-PRIME     PIC X(6).
   610         16  CZ-CERT-EFF-DT          PIC XX.
   611         16  CZ-CERT-NO.
   612             20  CZ-CERT-PRIME       PIC X(10).
   613             20  CZ-CERT-SFX         PIC X.
   614         16  CZ-RECORD-TYPE          PIC X.
   615             88  CERT-NOTE           VALUE '1'.
   616             88  CLAIM-CERT-NOTE     VALUE '2'.
   617         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   618
   619     12  CZ-LAST-MAINT-DT            PIC XX.
   620     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   621     12  CZ-LAST-MAINT-USER          PIC X(4).
   622
   623     12  CZ-NOTE-INFORMATION.
   624         16  CZ-NOTE                 PIC X(63).
   625         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  13
* EL1278.cbl
   626******************************************************************
   627*                            COPY ELCDATE.
   628******************************************************************
   629*                                                                *
   630*                                                                *
   631*                            ELCDATE.                            *
   632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   633*                            VMOD=2.003
   634*                                                                *
   635*                                                                *
   636*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   637*                 LENGTH = 200                                   *
   638******************************************************************
   639
   640 01  DATE-CONVERSION-DATA.
   641     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   642     12  DC-OPTION-CODE                PIC X.
   643         88  BIN-TO-GREG                VALUE ' '.
   644         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   645         88  EDIT-GREG-TO-BIN           VALUE '2'.
   646         88  YMD-GREG-TO-BIN            VALUE '3'.
   647         88  MDY-GREG-TO-BIN            VALUE '4'.
   648         88  JULIAN-TO-BIN              VALUE '5'.
   649         88  BIN-PLUS-ELAPSED           VALUE '6'.
   650         88  FIND-CENTURY               VALUE '7'.
   651         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   652         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   653         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   654         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   655         88  JULIAN-TO-BIN-3            VALUE 'C'.
   656         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   657         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   658         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   659         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   660         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   661         88  CHECK-LEAP-YEAR            VALUE 'H'.
   662         88  BIN-3-TO-GREG              VALUE 'I'.
   663         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   664         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   665         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   666         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   667         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   668         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   669         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   670         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   671         88  THREE-CHARACTER-BIN
   672                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   673         88  GREGORIAN-TO-BIN
   674                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   675         88  BIN-TO-GREGORIAN
   676                  VALUES ' ' '1' 'I' '8' 'G'.
   677         88  JULIAN-TO-BINARY
   678                  VALUES '5' 'C' 'E' 'F'.
   679     12  DC-ERROR-CODE                 PIC X.
   680         88  NO-CONVERSION-ERROR        VALUE ' '.
   681         88  DATE-CONVERSION-ERROR
   682                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   683         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  14
* EL1278.cbl
   684         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   685         88  DATE-IS-INVALID            VALUE '3'.
   686         88  DATE1-GREATER-DATE2        VALUE '4'.
   687         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   688         88  DATE-INVALID-OPTION        VALUE '9'.
   689         88  INVALID-CENTURY            VALUE 'A'.
   690         88  ONLY-CENTURY               VALUE 'B'.
   691         88  ONLY-LEAP-YEAR             VALUE 'C'.
   692         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   693     12  DC-END-OF-MONTH               PIC X.
   694         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   695     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   696         88  USE-NORMAL-PROCESS         VALUE ' '.
   697         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   698         88  ADJUST-UP-100-YRS          VALUE '2'.
   699     12  FILLER                        PIC X.
   700     12  DC-CONVERSION-DATES.
   701         16  DC-BIN-DATE-1             PIC XX.
   702         16  DC-BIN-DATE-2             PIC XX.
   703         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   704         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   705                       DC-GREG-DATE-1-EDIT.
   706             20  DC-EDIT1-MONTH        PIC 99.
   707             20  SLASH1-1              PIC X.
   708             20  DC-EDIT1-DAY          PIC 99.
   709             20  SLASH1-2              PIC X.
   710             20  DC-EDIT1-YEAR         PIC 99.
   711         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   712         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   713                     DC-GREG-DATE-2-EDIT.
   714             20  DC-EDIT2-MONTH        PIC 99.
   715             20  SLASH2-1              PIC X.
   716             20  DC-EDIT2-DAY          PIC 99.
   717             20  SLASH2-2              PIC X.
   718             20  DC-EDIT2-YEAR         PIC 99.
   719         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   720         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   721                     DC-GREG-DATE-1-YMD.
   722             20  DC-YMD-YEAR           PIC 99.
   723             20  DC-YMD-MONTH          PIC 99.
   724             20  DC-YMD-DAY            PIC 99.
   725         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   726         16  DC-GREG-DATE-1-MDY-R REDEFINES
   727                      DC-GREG-DATE-1-MDY.
   728             20  DC-MDY-MONTH          PIC 99.
   729             20  DC-MDY-DAY            PIC 99.
   730             20  DC-MDY-YEAR           PIC 99.
   731         16  DC-GREG-DATE-1-ALPHA.
   732             20  DC-ALPHA-MONTH        PIC X(10).
   733             20  DC-ALPHA-DAY          PIC 99.
   734             20  FILLER                PIC XX.
   735             20  DC-ALPHA-CENTURY.
   736                 24 DC-ALPHA-CEN-N     PIC 99.
   737             20  DC-ALPHA-YEAR         PIC 99.
   738         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   739         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   740         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   741         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  15
* EL1278.cbl
   742         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   743                                       PIC 9(05).
   744         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   745             20  DC-JULIAN-YEAR        PIC 99.
   746             20  DC-JULIAN-DAYS        PIC 999.
   747         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   748         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   749         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   750     12  DATE-CONVERSION-VARIBLES.
   751         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   752         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   753             20  FILLER                PIC 9(3).
   754             20  HOLD-CEN-1-CCYY.
   755                 24  HOLD-CEN-1-CC     PIC 99.
   756                 24  HOLD-CEN-1-YY     PIC 99.
   757             20  HOLD-CEN-1-MO         PIC 99.
   758             20  HOLD-CEN-1-DA         PIC 99.
   759         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   760             20  HOLD-CEN-1-R-MO       PIC 99.
   761             20  HOLD-CEN-1-R-DA       PIC 99.
   762             20  HOLD-CEN-1-R-CCYY.
   763                 24  HOLD-CEN-1-R-CC   PIC 99.
   764                 24  HOLD-CEN-1-R-YY   PIC 99.
   765             20  FILLER                PIC 9(3).
   766         16  HOLD-CENTURY-1-X.
   767             20  FILLER                PIC X(3)  VALUE SPACES.
   768             20  HOLD-CEN-1-X-CCYY.
   769                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   770                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   771             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   772             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   773         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   774             20  HOLD-CEN-1-R-X-MO     PIC XX.
   775             20  HOLD-CEN-1-R-X-DA     PIC XX.
   776             20  HOLD-CEN-1-R-X-CCYY.
   777                 24  HOLD-CEN-1-R-X-CC PIC XX.
   778                 24  HOLD-CEN-1-R-X-YY PIC XX.
   779             20  FILLER                PIC XXX.
   780         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   781         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   782         16  DC-JULIAN-DATE-1          PIC 9(07).
   783         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   784             20  DC-JULIAN-1-CCYY.
   785                 24  DC-JULIAN-1-CC    PIC 99.
   786                 24  DC-JULIAN-1-YR    PIC 99.
   787             20  DC-JULIAN-DA-1        PIC 999.
   788         16  DC-JULIAN-DATE-2          PIC 9(07).
   789         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   790             20  DC-JULIAN-2-CCYY.
   791                 24  DC-JULIAN-2-CC    PIC 99.
   792                 24  DC-JULIAN-2-YR    PIC 99.
   793             20  DC-JULIAN-DA-2        PIC 999.
   794         16  DC-GREG-DATE-A-EDIT.
   795             20  DC-EDITA-MONTH        PIC 99.
   796             20  SLASHA-1              PIC X VALUE '/'.
   797             20  DC-EDITA-DAY          PIC 99.
   798             20  SLASHA-2              PIC X VALUE '/'.
   799             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  16
* EL1278.cbl
   800                 24  DC-EDITA-CENT     PIC 99.
   801                 24  DC-EDITA-YEAR     PIC 99.
   802         16  DC-GREG-DATE-B-EDIT.
   803             20  DC-EDITB-MONTH        PIC 99.
   804             20  SLASHB-1              PIC X VALUE '/'.
   805             20  DC-EDITB-DAY          PIC 99.
   806             20  SLASHB-2              PIC X VALUE '/'.
   807             20  DC-EDITB-CCYY.
   808                 24  DC-EDITB-CENT     PIC 99.
   809                 24  DC-EDITB-YEAR     PIC 99.
   810         16  DC-GREG-DATE-CYMD         PIC 9(08).
   811         16  DC-GREG-DATE-CYMD-R REDEFINES
   812                              DC-GREG-DATE-CYMD.
   813             20  DC-CYMD-CEN           PIC 99.
   814             20  DC-CYMD-YEAR          PIC 99.
   815             20  DC-CYMD-MONTH         PIC 99.
   816             20  DC-CYMD-DAY           PIC 99.
   817         16  DC-GREG-DATE-MDCY         PIC 9(08).
   818         16  DC-GREG-DATE-MDCY-R REDEFINES
   819                              DC-GREG-DATE-MDCY.
   820             20  DC-MDCY-MONTH         PIC 99.
   821             20  DC-MDCY-DAY           PIC 99.
   822             20  DC-MDCY-CEN           PIC 99.
   823             20  DC-MDCY-YEAR          PIC 99.
   824    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   825        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   826    12  DC-EL310-DATE                  PIC X(21).
   827    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  17
* EL1278.cbl
   829*                            COPY ELCLOGOF.
   830******************************************************************
   831*                                                                *
   832*                                                                *
   833*                            ELCLOGOF.                           *
   834*                            VMOD=2.001                          *
   835*                                                                *
   836*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   837*                                                                *
   838******************************************************************
   839 01  CLASIC-LOGOFF.
   840     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   841     12  LOGOFF-TEXT.
   842         16  FILLER          PIC X(5)    VALUE SPACES.
   843         16  LOGOFF-MSG.
   844             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   845             20  FILLER      PIC X       VALUE SPACES.
   846             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   847         16  FILLER          PIC X(80)
   848           VALUE '* YOU ARE NOW LOGGED OFF'.
   849         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   850         16  FILLER          PIC X       VALUE QUOTE.
   851         16  LOGOFF-SYS-MSG  PIC X(17)
   852           VALUE 'S CLAS-IC SYSTEM '.
   853     12  TEXT-MESSAGES.
   854         16  UNACCESS-MSG    PIC X(29)
   855             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   856         16  PGMIDERR-MSG    PIC X(17)
   857             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  18
* EL1278.cbl
   859*                            COPY ELCATTR.
   860******************************************************************
   861*                                                                *
   862*                            ELCATTR.                            *
   863*                            VMOD=2.001                          *
   864*                                                                *
   865*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   866*                                                                *
   867*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   868*                                                                *
   869*                   POS 1   P=PROTECTED                          *
   870*                           U=UNPROTECTED                        *
   871*                           S=ASKIP                              *
   872*                   POS 2   A=ALPHA/NUMERIC                      *
   873*                           N=NUMERIC                            *
   874*                   POS 3   N=NORMAL                             *
   875*                           B=BRIGHT                             *
   876*                           D=DARK                               *
   877*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   878*                           OF=MODIFIED DATA TAG OFF             *
   879*                                                                *
   880*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   881******************************************************************
   882 01  ATTRIBUTE-LIST.
   883     12  AL-PABOF            PIC X       VALUE 'Y'.
   884     12  AL-PABON            PIC X       VALUE 'Z'.
   885     12  AL-PADOF            PIC X       VALUE '%'.
   886     12  AL-PADON            PIC X       VALUE '_'.
   887     12  AL-PANOF            PIC X       VALUE '-'.
   888     12  AL-PANON            PIC X       VALUE '/'.
   889     12  AL-SABOF            PIC X       VALUE '8'.
   890     12  AL-SABON            PIC X       VALUE '9'.
   891     12  AL-SADOF            PIC X       VALUE '@'.
   892     12  AL-SADON            PIC X       VALUE QUOTE.
   893     12  AL-SANOF            PIC X       VALUE '0'.
   894     12  AL-SANON            PIC X       VALUE '1'.
   895     12  AL-UABOF            PIC X       VALUE 'H'.
   896     12  AL-UABON            PIC X       VALUE 'I'.
   897     12  AL-UADOF            PIC X       VALUE '<'.
   898     12  AL-UADON            PIC X       VALUE '('.
   899     12  AL-UANOF            PIC X       VALUE ' '.
   900     12  AL-UANON            PIC X       VALUE 'A'.
   901     12  AL-UNBOF            PIC X       VALUE 'Q'.
   902     12  AL-UNBON            PIC X       VALUE 'R'.
   903     12  AL-UNDOF            PIC X       VALUE '*'.
   904     12  AL-UNDON            PIC X       VALUE ')'.
   905     12  AL-UNNOF            PIC X       VALUE '&'.
   906     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  19
* EL1278.cbl
   908*                            COPY ELCEMIB.
   909******************************************************************
   910*                                                                *
   911*                                                                *
   912*                            ELCEMIB.                            *
   913*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   914*                            VMOD=2.005                          *
   915*                                                                *
   916*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   917*                                                                *
   918******************************************************************
   919 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   920     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   921     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   922     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   923     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   924     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   925     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   926     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   927     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   928     12  EMI-SWITCH1             PIC X        VALUE '1'.
   929         88  EMI-NO-ERRORS                    VALUE '1'.
   930         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   931         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   932     12  EMI-SWITCH2             PIC X        VALUE '1'.
   933         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   934     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   935         88  EMI-AREA1-EMPTY                  VALUE '1'.
   936         88  EMI-AREA1-FULL                   VALUE '2'.
   937     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   938         88  EMI-AREA2-EMPTY                  VALUE '1'.
   939         88  EMI-AREA2-FULL                   VALUE '2'.
   940     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   941         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   942         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   943         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   944         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   945         88  EMI-BYPASS-FATALS                VALUE 'X'.
   946     12  EMI-ERROR-LINES.
   947         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   948         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   949         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   950         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   951             20  EMI-ERR-CODES OCCURS 10 TIMES.
   952                 24  EMI-ERR-NUM         PIC X(4).
   953                 24  EMI-FILLER          PIC X.
   954                 24  EMI-SEV             PIC X.
   955                 24  FILLER              PIC X.
   956             20  FILLER                  PIC X(02).
   957     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   958         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   959             20  EMI-ERROR-NUMBER    PIC X(4).
   960             20  EMI-FILL            PIC X.
   961             20  EMI-SEVERITY        PIC X.
   962             20  FILLER              PIC X.
   963             20  EMI-ERROR-TEXT.
   964                 24  EMI-TEXT-VARIABLE   PIC X(10).
   965                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  20
* EL1278.cbl
   966     12  EMI-SEVERITY-SAVE           PIC X.
   967         88  EMI-NOTE                    VALUE 'N'.
   968         88  EMI-WARNING                 VALUE 'W'.
   969         88  EMI-FORCABLE                VALUE 'F'.
   970         88  EMI-FATAL                   VALUE 'X'.
   971     12  EMI-MESSAGE-FLAG            PIC X.
   972         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   973         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   974     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   975     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   976         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   977         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   978         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   979     12  emi-claim-no                pic x(7).
   980     12  emi-claim-type              pic x(6).
   981     12  FILLER                      PIC X(124)  VALUE SPACES.
   982     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   983     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   984     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   985     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  21
* EL1278.cbl
   987 01  WS-PASS-631.
   988     12  WS-PASS-WORK-AREA         PIC X(384).
   989     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   990     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   991*        COPY ELC631PI.
   992******************************************************************
   993*                                                                *
   994*                                                                *
   995*                            ELC631PI                            *
   996*                            VMOD=2.012                          *
   997*                                                                *
   998*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   999*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  1000*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1001*                                                                *
  1002*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1003*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  1004*    BETWEEN PROGRAMS.                                           *
  1005*                                                                *
  1006*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1007*                                                                *
  1008*               EL631 - EL6311 - EL6312 - EL6313                 *
  1009*                                                                *
  1010******************************************************************
  1011*                   C H A N G E   L O G
  1012*
  1013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1014*-----------------------------------------------------------------
  1015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1016* EFFECTIVE    NUMBER
  1017*-----------------------------------------------------------------
  1018* 021414    2003053000001  PEMA  changes for auto chk request
  1019******************************************************************
  1020
  1021         16  PI-631-DATA.
  1022             20  PI-ERPNDB-KEY.
  1023                 24  PI-PB-COMPANY-CD     PIC X.
  1024                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1025                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1026                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1027
  1028             20  PI-ERPNDB-ALT-KEY.
  1029                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1030                 24  PI-PB-CARRIER        PIC X.
  1031                 24  PI-PB-GROUPING       PIC X(6).
  1032                 24  PI-PB-STATE          PIC XX.
  1033                 24  PI-PB-ACCOUNT        PIC X(10).
  1034                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1035                 24  PI-PB-CERT-NO.
  1036                     28  PI-PB-CERT-PRIME PIC X(10).
  1037                     28  PI-PB-CERT-SFX   PIC X.
  1038                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1039                 24  PI-PB-RECORD-TYPE    PIC X.
  1040
  1041             20  PI-ERPNDB-CSR-KEY.
  1042                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1043                 24  PI-PB-CSR-ID             PIC X(4).
  1044                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  22
* EL1278.cbl
  1045                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1046                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1047
  1048             20  PI-BROWSE-TYPE               PIC X.
  1049                 88  PI-FILE-BROWSE             VALUE ' '.
  1050                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1051                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1052                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1053                 88  PI-CSR-BROWSE              VALUE '4'.
  1054
  1055             20  PI-MAINT-FUNCTION            PIC X.
  1056                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1057                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1058                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1059                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1060                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1061                 88  PI-PF5-FUNCTION            VALUE '5'.
  1062                 88  PI-PF6-FUNCTION            VALUE '6'.
  1063
  1064             20  PI-FILE-SWITCHES.
  1065                 24  PI-ALL-ISSUES-SW         PIC X.
  1066                     88  ALL-ISSUES             VALUE 'Y'.
  1067                 24  PI-ALL-CANCELS-SW        PIC X.
  1068                     88  ALL-CANCELS            VALUE 'Y'.
  1069                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1070                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1071                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1072                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1073                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1074                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1075                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1076                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1077                 24  PI-HOLD-REC-SW           PIC X.
  1078                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1079                 24  PI-CHANGE-REC-SW         PIC X.
  1080                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1081                 24  PI-CHK-REQ-REC-SW        PIC X.
  1082                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1083                 24  PI-ISSUE-WARNING-SW      PIC X.
  1084                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1085                 24  PI-CANCEL-WARNING-SW     PIC X.
  1086                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1087             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1088                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1089             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1090                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1091
  1092             20  PI-MAP-NAME                  PIC X(8).
  1093
  1094             20  PI-CURSOR                    PIC S9(4) COMP.
  1095
  1096             20  PI-PREV-ALT-KEY              PIC X(36).
  1097             20  PI-PREV-CSR-KEY              PIC X(15).
  1098             20  PI-PREV-KEY.
  1099                 24  PI-PREV-COMPANY-CD       PIC X.
  1100                 24  PI-PREV-BATCH            PIC X(6).
  1101                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1102                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  23
* EL1278.cbl
  1103             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1104             20  PI-BROWSE-SW                 PIC X.
  1105                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1106                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1107             20  PI-SV-CARRIER                PIC X.
  1108             20  PI-SV-GROUPING               PIC X(6).
  1109             20  PI-SV-STATE                  PIC XX.
  1110             20  PI-EDIT-SW                   PIC X.
  1111             20  PI-DISPLAY-SW                PIC XX.
  1112                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1113                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1114             20  PI-CRITERIA-DATA             PIC X(350).
  1115             20  PI-BMODE                     PIC X.
  1116             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1117             20  PI-BPMTS                     PIC S999     COMP-3.
  1118             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1119             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1120             20  PI-CSR-SESSION-SW            PIC X.
  1121                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1122             20  PI-ERRORS-SW                 PIC X.
  1123                 88  FATAL-ERRORS               VALUE 'X'.
  1124*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1125             20  pi-unforced-sw               pic x.
  1126                 88  unforced-errors            value 'X'.
  1127             20  FILLER                       PIC X(4).
  1128
  1129         16  FILLER                PIC X(94).
  1130
  1131
  1132*                            COPY ELCINTF.
  1133******************************************************************
  1134*                                                                *
  1135*                                                                *
  1136*                            ELCINTF.                            *
  1137*                            VMOD=2.017                          *
  1138*                                                                *
  1139*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1140*                                                                *
  1141*       LENGTH = 1024                                            *
  1142*                                                                *
  1143******************************************************************
  1144*                   C H A N G E   L O G
  1145*
  1146* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1147*-----------------------------------------------------------------
  1148*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1149* EFFECTIVE    NUMBER
  1150*-----------------------------------------------------------------
  1151* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1152******************************************************************
  1153 01  PROGRAM-INTERFACE-BLOCK.
  1154     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1155     12  PI-CALLING-PROGRAM              PIC X(8).
  1156     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1157     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1158     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1159     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1160     12  PI-SAVED-PROGRAM-5              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  24
* EL1278.cbl
  1161     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1162     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1163     12  PI-COMPANY-ID                   PIC XXX.
  1164     12  PI-COMPANY-CD                   PIC X.
  1165
  1166     12  PI-COMPANY-PASSWORD             PIC X(8).
  1167
  1168     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1169
  1170     12  PI-CONTROL-IN-PROGRESS.
  1171         16  PI-CARRIER                  PIC X.
  1172         16  PI-GROUPING                 PIC X(6).
  1173         16  PI-STATE                    PIC XX.
  1174         16  PI-ACCOUNT                  PIC X(10).
  1175         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1176                                         PIC X(10).
  1177         16  PI-CLAIM-CERT-GRP.
  1178             20  PI-CLAIM-NO             PIC X(7).
  1179             20  PI-CERT-NO.
  1180                 25  PI-CERT-PRIME       PIC X(10).
  1181                 25  PI-CERT-SFX         PIC X.
  1182             20  PI-CERT-EFF-DT          PIC XX.
  1183         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1184             20  PI-PLAN-CODE            PIC X(2).
  1185             20  PI-REVISION-NUMBER      PIC X(3).
  1186             20  PI-PLAN-EFF-DT          PIC X(2).
  1187             20  PI-PLAN-EXP-DT          PIC X(2).
  1188             20  FILLER                  PIC X(11).
  1189         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1190             20  PI-OE-REFERENCE-1.
  1191                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1192                 25  PI-OE-REF-1-SUFF    PIC XX.
  1193
  1194     12  PI-SESSION-IN-PROGRESS          PIC X.
  1195         88  CLAIM-SESSION                   VALUE '1'.
  1196         88  CREDIT-SESSION                  VALUE '2'.
  1197         88  WARRANTY-SESSION                VALUE '3'.
  1198         88  MORTGAGE-SESSION                VALUE '4'.
  1199         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1200
  1201
  1202*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1203
  1204     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1205     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1206
  1207     12  PI-CREDIT-USER                  PIC X.
  1208         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1209         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1210
  1211     12  PI-CLAIM-USER                   PIC X.
  1212         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1213         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1214
  1215     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1216         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1217         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1218         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  25
* EL1278.cbl
  1219         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1220         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1221
  1222     12  PI-PROCESSOR-ID                 PIC X(4).
  1223
  1224     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1225
  1226     12  PI-MEMBER-CAPTION               PIC X(10).
  1227
  1228     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1229         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1230
  1231     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1232     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1233     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1234     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1235
  1236     12  PI-AH-OVERRIDE-L1               PIC X.
  1237     12  PI-AH-OVERRIDE-L2               PIC XX.
  1238     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1239     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1240
  1241     12  PI-NEW-SYSTEM                   PIC X(2).
  1242
  1243     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1244     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1245         88  PI-USES-PAID-TO                 VALUE '1'.
  1246     12  PI-CRDTCRD-SYSTEM.
  1247         16  PI-CRDTCRD-USER             PIC X.
  1248             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1249             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1250         16  PI-CC-MONTH-END-DT          PIC XX.
  1251     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1252
  1253     12  PI-OE-REFERENCE-2.
  1254         16  PI-OE-REF-2-PRIME           PIC X(10).
  1255         16  PI-OE-REF-2-SUFF            PIC X.
  1256
  1257     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1258
  1259     12  PI-LANGUAGE-TYPE                PIC X.
  1260             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1261             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1262             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1263
  1264     12  PI-POLICY-LINKAGE-IND           PIC X.
  1265         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1266         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1267                                                   LOW-VALUES.
  1268
  1269     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1270     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1271         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1272         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1273
  1274     12  PI-PROCESSOR-CSR-IND            PIC X.
  1275         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1276         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  26
* EL1278.cbl
  1277
  1278     12  FILLER                          PIC X(3).
  1279
  1280     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1281
  1282     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1283         PI-SYSTEM-LEVEL.
  1284
  1285         16  PI-ENTRY-CODES.
  1286             20  PI-ENTRY-CD-1           PIC X.
  1287             20  PI-ENTRY-CD-2           PIC X.
  1288
  1289         16  PI-RETURN-CODES.
  1290             20  PI-RETURN-CD-1          PIC X.
  1291             20  PI-RETURN-CD-2          PIC X.
  1292
  1293         16  PI-UPDATE-STATUS-SAVE.
  1294             20  PI-UPDATE-BY            PIC X(4).
  1295             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1296
  1297         16  PI-LOWER-CASE-LETTERS       PIC X.
  1298             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1299
  1300*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1301*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1302*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1303
  1304         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1305             88  ST-ACCNT-CNTL               VALUE ' '.
  1306             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1307             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1308             88  ACCNT-CNTL                  VALUE '3'.
  1309             88  CARR-ACCNT-CNTL             VALUE '4'.
  1310
  1311         16  PI-PROCESSOR-CAP-LIST.
  1312             20  PI-SYSTEM-CONTROLS.
  1313                24 PI-SYSTEM-DISPLAY     PIC X.
  1314                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1315                24 PI-SYSTEM-MODIFY      PIC X.
  1316                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1317             20  FILLER                  PIC XX.
  1318             20  PI-DISPLAY-CAP          PIC X.
  1319                 88  DISPLAY-CAP             VALUE 'Y'.
  1320             20  PI-MODIFY-CAP           PIC X.
  1321                 88  MODIFY-CAP              VALUE 'Y'.
  1322             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1323                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1324             20  PI-FORCE-CAP            PIC X.
  1325                 88  FORCE-CAP               VALUE 'Y'.
  1326
  1327         16  PI-PROGRAM-CONTROLS.
  1328             20  PI-PGM-PRINT-OPT        PIC X.
  1329             20  PI-PGM-FORMAT-OPT       PIC X.
  1330             20  PI-PGM-PROCESS-OPT      PIC X.
  1331             20  PI-PGM-TOTALS-OPT       PIC X.
  1332
  1333         16  PI-HELP-INTERFACE.
  1334             20  PI-LAST-ERROR-NO        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  27
* EL1278.cbl
  1335             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1336
  1337         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1338             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1339
  1340         16  PI-CR-CONTROL-IN-PROGRESS.
  1341             20  PI-CR-CARRIER           PIC X.
  1342             20  PI-CR-GROUPING          PIC X(6).
  1343             20  PI-CR-STATE             PIC XX.
  1344             20  PI-CR-ACCOUNT           PIC X(10).
  1345             20  PI-CR-FIN-RESP          PIC X(10).
  1346             20  PI-CR-TYPE              PIC X.
  1347
  1348         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1349
  1350         16  PI-CR-MONTH-END-DT          PIC XX.
  1351
  1352         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1353             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1354             88  PI-ZERO-CARRIER             VALUE '1'.
  1355             88  PI-ZERO-GROUPING            VALUE '2'.
  1356             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1357
  1358         16  PI-CARRIER-SECURITY         PIC X.
  1359             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1360
  1361         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1362             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1363             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1364
  1365         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1366             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1367                                         INDEXED BY PI-ACCESS-NDX
  1368                                         PIC X.
  1369
  1370         16  PI-GA-BILLING-CONTROL       PIC X.
  1371             88  PI-GA-BILLING               VALUE '1'.
  1372
  1373         16  PI-MAIL-PROCESSING          PIC X.
  1374             88  PI-MAIL-YES                 VALUE 'Y'.
  1375
  1376         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1377
  1378         16  PI-AR-SYSTEM.
  1379             20  PI-AR-PROCESSING-CNTL   PIC X.
  1380                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1381             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1382             20  PI-AR-MONTH-END-DT      PIC XX.
  1383
  1384         16  PI-MP-SYSTEM.
  1385             20  PI-MORTGAGE-USER            PIC X.
  1386                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1387                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1388             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1389                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1390                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1391                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1392                 88  PI-MP-PROD-CNTL                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  28
* EL1278.cbl
  1393                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1394             20  PI-MP-MONTH-END-DT          PIC XX.
  1395             20  PI-MP-REFERENCE-NO.
  1396                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1397                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1398
  1399         16  PI-LABEL-CONTROL            PIC X(01).
  1400             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1401             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1402
  1403         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1404             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1405
  1406         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1407             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1408             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1409
  1410         16  FILLER                      PIC X(14).
  1411
  1412     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1413******************************************************************
  1414     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1415         16  FILLER                PIC  X(500).
  1416         16  PI-PEND-SW            PIC  X(01).
  1417         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1418         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1419         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1420         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1421         16  PI-EARNING-METHOD-LF  PIC  X.
  1422         16  PI-EARNING-METHOD-AH  PIC  X.
  1423         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1424         16  PI-LF-REFUND-METH     PIC  X.
  1425         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1426         16  PI-AH-REFUND-METH     PIC  X.
  1427         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1428         16  PI-MODIFY-CERT-CAP    PIC  X.
  1429             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1430         16  PI-CLP-YN             PIC X.
  1431         16  PI-CANCEL-REASON      PIC X.
  1432         16  PI-PF10-OK            PIC X.
  1433         16  FILLER                PIC  X(96).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  29
* EL1278.cbl
  1435*                            COPY ELCAID.
  1436******************************************************************
  1437*                                                                *
  1438*                            ELCAID.                             *
  1439*                            VMOD=2.001                          *
  1440*                                                                *
  1441*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1442*                                                                *
  1443*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1444*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1445******************************************************************
  1446
  1447 01  DFHAID.
  1448   02  DFHNULL   PIC  X  VALUE  ' '.
  1449   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1450   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1451   02  DFHPEN    PIC  X  VALUE  '='.
  1452   02  DFHOPID   PIC  X  VALUE  'W'.
  1453   02  DFHPA1    PIC  X  VALUE  '%'.
  1454   02  DFHPA2    PIC  X  VALUE  '>'.
  1455   02  DFHPA3    PIC  X  VALUE  ','.
  1456   02  DFHPF1    PIC  X  VALUE  '1'.
  1457   02  DFHPF2    PIC  X  VALUE  '2'.
  1458   02  DFHPF3    PIC  X  VALUE  '3'.
  1459   02  DFHPF4    PIC  X  VALUE  '4'.
  1460   02  DFHPF5    PIC  X  VALUE  '5'.
  1461   02  DFHPF6    PIC  X  VALUE  '6'.
  1462   02  DFHPF7    PIC  X  VALUE  '7'.
  1463   02  DFHPF8    PIC  X  VALUE  '8'.
  1464   02  DFHPF9    PIC  X  VALUE  '9'.
  1465   02  DFHPF10   PIC  X  VALUE  ':'.
  1466   02  DFHPF11   PIC  X  VALUE  '#'.
  1467   02  DFHPF12   PIC  X  VALUE  '@'.
  1468   02  DFHPF13   PIC  X  VALUE  'A'.
  1469   02  DFHPF14   PIC  X  VALUE  'B'.
  1470   02  DFHPF15   PIC  X  VALUE  'C'.
  1471   02  DFHPF16   PIC  X  VALUE  'D'.
  1472   02  DFHPF17   PIC  X  VALUE  'E'.
  1473   02  DFHPF18   PIC  X  VALUE  'F'.
  1474   02  DFHPF19   PIC  X  VALUE  'G'.
  1475   02  DFHPF20   PIC  X  VALUE  'H'.
  1476   02  DFHPF21   PIC  X  VALUE  'I'.
  1477*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1478   02  DFHPF22   PIC  X  VALUE  '['.
  1479   02  DFHPF23   PIC  X  VALUE  '.'.
  1480   02  DFHPF24   PIC  X  VALUE  '<'.
  1481   02  DFHMSRE   PIC  X  VALUE  'X'.
  1482   02  DFHSTRF   PIC  X  VALUE  'h'.
  1483   02  DFHTRIG   PIC  X  VALUE  '"'.
  1484
  1485 01  FILLER  REDEFINES  DFHAID.
  1486     12  FILLER                  PIC  X(08).
  1487     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  30
* EL1278.cbl
  1489*                            COPY EL1278S.
  1490 01  EL127HI.
  1491     05  FILLER            PIC  X(0012).
  1492*    -------------------------------
  1493     05  HDATEL PIC S9(0004) COMP.
  1494     05  HDATEF PIC  X(0001).
  1495     05  FILLER REDEFINES HDATEF.
  1496         10  HDATEA PIC  X(0001).
  1497     05  HDATEI PIC  X(0008).
  1498*    -------------------------------
  1499     05  HTIMEL PIC S9(0004) COMP.
  1500     05  HTIMEF PIC  X(0001).
  1501     05  FILLER REDEFINES HTIMEF.
  1502         10  HTIMEA PIC  X(0001).
  1503     05  HTIMEI PIC  999V99.
  1504*    -------------------------------
  1505     05  CMPNYIDL PIC S9(0004) COMP.
  1506     05  CMPNYIDF PIC  X(0001).
  1507     05  FILLER REDEFINES CMPNYIDF.
  1508         10  CMPNYIDA PIC  X(0001).
  1509     05  CMPNYIDI PIC  X(0003).
  1510*    -------------------------------
  1511     05  USERIDL PIC S9(0004) COMP.
  1512     05  USERIDF PIC  X(0001).
  1513     05  FILLER REDEFINES USERIDF.
  1514         10  USERIDA PIC  X(0001).
  1515     05  USERIDI PIC  X(0004).
  1516*    -------------------------------
  1517     05  HCARIERL PIC S9(0004) COMP.
  1518     05  HCARIERF PIC  X(0001).
  1519     05  FILLER REDEFINES HCARIERF.
  1520         10  HCARIERA PIC  X(0001).
  1521     05  HCARIERI PIC  X(0001).
  1522*    -------------------------------
  1523     05  HGROUPL PIC S9(0004) COMP.
  1524     05  HGROUPF PIC  X(0001).
  1525     05  FILLER REDEFINES HGROUPF.
  1526         10  HGROUPA PIC  X(0001).
  1527     05  HGROUPI PIC  X(0006).
  1528*    -------------------------------
  1529     05  HSTATEL PIC S9(0004) COMP.
  1530     05  HSTATEF PIC  X(0001).
  1531     05  FILLER REDEFINES HSTATEF.
  1532         10  HSTATEA PIC  X(0001).
  1533     05  HSTATEI PIC  X(0002).
  1534*    -------------------------------
  1535     05  HACCTNOL PIC S9(0004) COMP.
  1536     05  HACCTNOF PIC  X(0001).
  1537     05  FILLER REDEFINES HACCTNOF.
  1538         10  HACCTNOA PIC  X(0001).
  1539     05  HACCTNOI PIC  X(0010).
  1540*    -------------------------------
  1541     05  HEFFDTL PIC S9(0004) COMP.
  1542     05  HEFFDTF PIC  X(0001).
  1543     05  FILLER REDEFINES HEFFDTF.
  1544         10  HEFFDTA PIC  X(0001).
  1545     05  HEFFDTI PIC  X(0008).
  1546*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  31
* EL1278.cbl
  1547     05  HCERTNOL PIC S9(0004) COMP.
  1548     05  HCERTNOF PIC  X(0001).
  1549     05  FILLER REDEFINES HCERTNOF.
  1550         10  HCERTNOA PIC  X(0001).
  1551     05  HCERTNOI PIC  X(0010).
  1552*    -------------------------------
  1553     05  HCRTSFXL PIC S9(0004) COMP.
  1554     05  HCRTSFXF PIC  X(0001).
  1555     05  FILLER REDEFINES HCRTSFXF.
  1556         10  HCRTSFXA PIC  X(0001).
  1557     05  HCRTSFXI PIC  X(0001).
  1558*    -------------------------------
  1559     05  HLNAMEL PIC S9(0004) COMP.
  1560     05  HLNAMEF PIC  X(0001).
  1561     05  FILLER REDEFINES HLNAMEF.
  1562         10  HLNAMEA PIC  X(0001).
  1563     05  HLNAMEI PIC  X(0015).
  1564*    -------------------------------
  1565     05  HFNAMEL PIC S9(0004) COMP.
  1566     05  HFNAMEF PIC  X(0001).
  1567     05  FILLER REDEFINES HFNAMEF.
  1568         10  HFNAMEA PIC  X(0001).
  1569     05  HFNAMEI PIC  X(0010).
  1570*    -------------------------------
  1571     05  HINITL PIC S9(0004) COMP.
  1572     05  HINITF PIC  X(0001).
  1573     05  FILLER REDEFINES HINITF.
  1574         10  HINITA PIC  X(0001).
  1575     05  HINITI PIC  X(0001).
  1576*    -------------------------------
  1577     05  LCLMDTHL PIC S9(0004) COMP.
  1578     05  LCLMDTHF PIC  X(0001).
  1579     05  FILLER REDEFINES LCLMDTHF.
  1580         10  LCLMDTHA PIC  X(0001).
  1581     05  LCLMDTHI PIC  X(0022).
  1582*    -------------------------------
  1583     05  LCLMDTL PIC S9(0004) COMP.
  1584     05  LCLMDTF PIC  X(0001).
  1585     05  FILLER REDEFINES LCLMDTF.
  1586         10  LCLMDTA PIC  X(0001).
  1587     05  LCLMDTI PIC  X(0008).
  1588*    -------------------------------
  1589     05  HPCYNL PIC S9(0004) COMP.
  1590     05  HPCYNF PIC  X(0001).
  1591     05  FILLER REDEFINES HPCYNF.
  1592         10  HPCYNA PIC  X(0001).
  1593     05  HPCYNI PIC  X(0001).
  1594*    -------------------------------
  1595     05  ACLMDTHL PIC S9(0004) COMP.
  1596     05  ACLMDTHF PIC  X(0001).
  1597     05  FILLER REDEFINES ACLMDTHF.
  1598         10  ACLMDTHA PIC  X(0001).
  1599     05  ACLMDTHI PIC  X(0023).
  1600*    -------------------------------
  1601     05  ACLMDTL PIC S9(0004) COMP.
  1602     05  ACLMDTF PIC  X(0001).
  1603     05  FILLER REDEFINES ACLMDTF.
  1604         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  32
* EL1278.cbl
  1605     05  ACLMDTI PIC  X(0008).
  1606*    -------------------------------
  1607     05  PMTHDL PIC S9(0004) COMP.
  1608     05  PMTHDF PIC  X(0001).
  1609     05  FILLER REDEFINES PMTHDF.
  1610         10  PMTHDA PIC  X(0001).
  1611     05  PMTHDI PIC  X(0010).
  1612*    -------------------------------
  1613     05  CNCDTHDL PIC S9(0004) COMP.
  1614     05  CNCDTHDF PIC  X(0001).
  1615     05  FILLER REDEFINES CNCDTHDF.
  1616         10  CNCDTHDA PIC  X(0001).
  1617     05  CNCDTHDI PIC  X(0007).
  1618*    -------------------------------
  1619     05  HLKINDL PIC S9(0004) COMP.
  1620     05  HLKINDF PIC  X(0001).
  1621     05  FILLER REDEFINES HLKINDF.
  1622         10  HLKINDA PIC  X(0001).
  1623     05  HLKINDI PIC  X(0002).
  1624*    -------------------------------
  1625     05  HLCDL PIC S9(0004) COMP.
  1626     05  HLCDF PIC  X(0001).
  1627     05  FILLER REDEFINES HLCDF.
  1628         10  HLCDA PIC  X(0001).
  1629     05  HLCDI PIC  X(0002).
  1630*    -------------------------------
  1631     05  HLEDESCL PIC S9(0004) COMP.
  1632     05  HLEDESCF PIC  X(0001).
  1633     05  FILLER REDEFINES HLEDESCF.
  1634         10  HLEDESCA PIC  X(0001).
  1635     05  HLEDESCI PIC  X(0003).
  1636*    -------------------------------
  1637     05  HLTERML PIC S9(0004) COMP.
  1638     05  HLTERMF PIC  X(0001).
  1639     05  FILLER REDEFINES HLTERMF.
  1640         10  HLTERMA PIC  X(0001).
  1641     05  HLTERMI PIC  9(3).
  1642*    -------------------------------
  1643     05  HLREML PIC S9(0004) COMP.
  1644     05  HLREMF PIC  X(0001).
  1645     05  FILLER REDEFINES HLREMF.
  1646         10  HLREMA PIC  X(0001).
  1647     05  HLREMI PIC  X(0003).
  1648*    -------------------------------
  1649     05  HLPREML PIC S9(0004) COMP.
  1650     05  HLPREMF PIC  X(0001).
  1651     05  FILLER REDEFINES HLPREMF.
  1652         10  HLPREMA PIC  X(0001).
  1653     05  HLPREMI PIC  X(0011).
  1654*    -------------------------------
  1655     05  HLITDRL PIC S9(0004) COMP.
  1656     05  HLITDRF PIC  X(0001).
  1657     05  FILLER REDEFINES HLITDRF.
  1658         10  HLITDRA PIC  X(0001).
  1659     05  HLITDRI PIC  X(0011).
  1660*    -------------------------------
  1661     05  HLREFNDL PIC S9(0004) COMP.
  1662     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  33
* EL1278.cbl
  1663     05  FILLER REDEFINES HLREFNDF.
  1664         10  HLREFNDA PIC  X(0001).
  1665     05  HLREFNDI PIC  X(0011).
  1666*    -------------------------------
  1667     05  HLCANCL PIC S9(0004) COMP.
  1668     05  HLCANCF PIC  X(0001).
  1669     05  FILLER REDEFINES HLCANCF.
  1670         10  HLCANCA PIC  X(0001).
  1671     05  HLCANCI PIC  X(0008).
  1672*    -------------------------------
  1673     05  HLCAL1L PIC S9(0004) COMP.
  1674     05  HLCAL1F PIC  X(0001).
  1675     05  FILLER REDEFINES HLCAL1F.
  1676         10  HLCAL1A PIC  X(0001).
  1677     05  HLCAL1I PIC  X(0001).
  1678*    -------------------------------
  1679     05  HLCALCL PIC S9(0004) COMP.
  1680     05  HLCALCF PIC  X(0001).
  1681     05  FILLER REDEFINES HLCALCF.
  1682         10  HLCALCA PIC  X(0001).
  1683     05  HLCALCI PIC  X(0012).
  1684*    -------------------------------
  1685     05  HLCPCTL PIC S9(0004) COMP.
  1686     05  HLCPCTF PIC  X(0001).
  1687     05  FILLER REDEFINES HLCPCTF.
  1688         10  HLCPCTA PIC  X(0001).
  1689     05  HLCPCTI PIC  X(0006).
  1690*    -------------------------------
  1691     05  HLCAMTL PIC S9(0004) COMP.
  1692     05  HLCAMTF PIC  X(0001).
  1693     05  FILLER REDEFINES HLCAMTF.
  1694         10  HLCAMTA PIC  X(0001).
  1695     05  HLCAMTI PIC  X(0009).
  1696*    -------------------------------
  1697     05  HAKINDL PIC S9(0004) COMP.
  1698     05  HAKINDF PIC  X(0001).
  1699     05  FILLER REDEFINES HAKINDF.
  1700         10  HAKINDA PIC  X(0001).
  1701     05  HAKINDI PIC  X(0002).
  1702*    -------------------------------
  1703     05  HACDL PIC S9(0004) COMP.
  1704     05  HACDF PIC  X(0001).
  1705     05  FILLER REDEFINES HACDF.
  1706         10  HACDA PIC  X(0001).
  1707     05  HACDI PIC  X(0002).
  1708*    -------------------------------
  1709     05  HAEDESCL PIC S9(0004) COMP.
  1710     05  HAEDESCF PIC  X(0001).
  1711     05  FILLER REDEFINES HAEDESCF.
  1712         10  HAEDESCA PIC  X(0001).
  1713     05  HAEDESCI PIC  X(0003).
  1714*    -------------------------------
  1715     05  HATERML PIC S9(0004) COMP.
  1716     05  HATERMF PIC  X(0001).
  1717     05  FILLER REDEFINES HATERMF.
  1718         10  HATERMA PIC  X(0001).
  1719     05  HATERMI PIC  9(3).
  1720*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  34
* EL1278.cbl
  1721     05  HAREML PIC S9(0004) COMP.
  1722     05  HAREMF PIC  X(0001).
  1723     05  FILLER REDEFINES HAREMF.
  1724         10  HAREMA PIC  X(0001).
  1725     05  HAREMI PIC  X(0003).
  1726*    -------------------------------
  1727     05  HAPREML PIC S9(0004) COMP.
  1728     05  HAPREMF PIC  X(0001).
  1729     05  FILLER REDEFINES HAPREMF.
  1730         10  HAPREMA PIC  X(0001).
  1731     05  HAPREMI PIC  X(0011).
  1732*    -------------------------------
  1733     05  HAITDRL PIC S9(0004) COMP.
  1734     05  HAITDRF PIC  X(0001).
  1735     05  FILLER REDEFINES HAITDRF.
  1736         10  HAITDRA PIC  X(0001).
  1737     05  HAITDRI PIC  X(0011).
  1738*    -------------------------------
  1739     05  HAREFNDL PIC S9(0004) COMP.
  1740     05  HAREFNDF PIC  X(0001).
  1741     05  FILLER REDEFINES HAREFNDF.
  1742         10  HAREFNDA PIC  X(0001).
  1743     05  HAREFNDI PIC  X(0011).
  1744*    -------------------------------
  1745     05  HACANCL PIC S9(0004) COMP.
  1746     05  HACANCF PIC  X(0001).
  1747     05  FILLER REDEFINES HACANCF.
  1748         10  HACANCA PIC  X(0001).
  1749     05  HACANCI PIC  X(0008).
  1750*    -------------------------------
  1751     05  HACAL1L PIC S9(0004) COMP.
  1752     05  HACAL1F PIC  X(0001).
  1753     05  FILLER REDEFINES HACAL1F.
  1754         10  HACAL1A PIC  X(0001).
  1755     05  HACAL1I PIC  X(0001).
  1756*    -------------------------------
  1757     05  HACALCL PIC S9(0004) COMP.
  1758     05  HACALCF PIC  X(0001).
  1759     05  FILLER REDEFINES HACALCF.
  1760         10  HACALCA PIC  X(0001).
  1761     05  HACALCI PIC  X(0012).
  1762*    -------------------------------
  1763     05  HACPCTL PIC S9(0004) COMP.
  1764     05  HACPCTF PIC  X(0001).
  1765     05  FILLER REDEFINES HACPCTF.
  1766         10  HACPCTA PIC  X(0001).
  1767     05  HACPCTI PIC  X(0006).
  1768*    -------------------------------
  1769     05  HACAMTL PIC S9(0004) COMP.
  1770     05  HACAMTF PIC  X(0001).
  1771     05  FILLER REDEFINES HACAMTF.
  1772         10  HACAMTA PIC  X(0001).
  1773     05  HACAMTI PIC  X(0009).
  1774*    -------------------------------
  1775     05  CANFEEHL PIC S9(0004) COMP.
  1776     05  CANFEEHF PIC  X(0001).
  1777     05  FILLER REDEFINES CANFEEHF.
  1778         10  CANFEEHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  35
* EL1278.cbl
  1779     05  CANFEEHI PIC  X(0012).
  1780*    -------------------------------
  1781     05  CANFEEL PIC S9(0004) COMP.
  1782     05  CANFEEF PIC  X(0001).
  1783     05  FILLER REDEFINES CANFEEF.
  1784         10  CANFEEA PIC  X(0001).
  1785     05  CANFEEI PIC  X(0006).
  1786*    -------------------------------
  1787     05  TOPREML PIC S9(0004) COMP.
  1788     05  TOPREMF PIC  X(0001).
  1789     05  FILLER REDEFINES TOPREMF.
  1790         10  TOPREMA PIC  X(0001).
  1791     05  TOPREMI PIC  X(0011).
  1792*    -------------------------------
  1793     05  TOITDRL PIC S9(0004) COMP.
  1794     05  TOITDRF PIC  X(0001).
  1795     05  FILLER REDEFINES TOITDRF.
  1796         10  TOITDRA PIC  X(0001).
  1797     05  TOITDRI PIC  X(0011).
  1798*    -------------------------------
  1799     05  TORFNDL PIC S9(0004) COMP.
  1800     05  TORFNDF PIC  X(0001).
  1801     05  FILLER REDEFINES TORFNDF.
  1802         10  TORFNDA PIC  X(0001).
  1803     05  TORFNDI PIC  X(0011).
  1804*    -------------------------------
  1805     05  CANREAHL PIC S9(0004) COMP.
  1806     05  CANREAHF PIC  X(0001).
  1807     05  FILLER REDEFINES CANREAHF.
  1808         10  CANREAHA PIC  X(0001).
  1809     05  CANREAHI PIC  X(0015).
  1810*    -------------------------------
  1811     05  CANREAL PIC S9(0004) COMP.
  1812     05  CANREAF PIC  X(0001).
  1813     05  FILLER REDEFINES CANREAF.
  1814         10  CANREAA PIC  X(0001).
  1815     05  CANREAI PIC  X(0001).
  1816*    -------------------------------
  1817     05  CLPYNHL PIC S9(0004) COMP.
  1818     05  CLPYNHF PIC  X(0001).
  1819     05  FILLER REDEFINES CLPYNHF.
  1820         10  CLPYNHA PIC  X(0001).
  1821     05  CLPYNHI PIC  X(0005).
  1822*    -------------------------------
  1823     05  CLPYNL PIC S9(0004) COMP.
  1824     05  CLPYNF PIC  X(0001).
  1825     05  FILLER REDEFINES CLPYNF.
  1826         10  CLPYNA PIC  X(0001).
  1827     05  CLPYNI PIC  X(0001).
  1828*    -------------------------------
  1829     05  REFDUEHL PIC S9(0004) COMP.
  1830     05  REFDUEHF PIC  X(0001).
  1831     05  FILLER REDEFINES REFDUEHF.
  1832         10  REFDUEHA PIC  X(0001).
  1833     05  REFDUEHI PIC  X(0018).
  1834*    -------------------------------
  1835     05  REFDUEL PIC S9(0004) COMP.
  1836     05  REFDUEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  36
* EL1278.cbl
  1837     05  FILLER REDEFINES REFDUEF.
  1838         10  REFDUEA PIC  X(0001).
  1839     05  REFDUEI PIC  X(0010).
  1840*    -------------------------------
  1841     05  HLREDL PIC S9(0004) COMP.
  1842     05  HLREDF PIC  X(0001).
  1843     05  FILLER REDEFINES HLREDF.
  1844         10  HLREDA PIC  X(0001).
  1845     05  HLREDI PIC  X(0014).
  1846*    -------------------------------
  1847     05  FREMTRML PIC S9(0004) COMP.
  1848     05  FREMTRMF PIC  X(0001).
  1849     05  FILLER REDEFINES FREMTRMF.
  1850         10  FREMTRMA PIC  X(0001).
  1851     05  FREMTRMI PIC  X(0003).
  1852*    -------------------------------
  1853     05  HERMSG1L PIC S9(0004) COMP.
  1854     05  HERMSG1F PIC  X(0001).
  1855     05  FILLER REDEFINES HERMSG1F.
  1856         10  HERMSG1A PIC  X(0001).
  1857     05  HERMSG1I PIC  X(0079).
  1858*    -------------------------------
  1859     05  HERMSG2L PIC S9(0004) COMP.
  1860     05  HERMSG2F PIC  X(0001).
  1861     05  FILLER REDEFINES HERMSG2F.
  1862         10  HERMSG2A PIC  X(0001).
  1863     05  HERMSG2I PIC  X(0079).
  1864*    -------------------------------
  1865     05  HPFKEYL PIC S9(0004) COMP.
  1866     05  HPFKEYF PIC  X(0001).
  1867     05  FILLER REDEFINES HPFKEYF.
  1868         10  HPFKEYA PIC  X(0001).
  1869     05  HPFKEYI PIC  99.
  1870*    -------------------------------
  1871     05  PFKEY11L PIC S9(0004) COMP.
  1872     05  PFKEY11F PIC  X(0001).
  1873     05  FILLER REDEFINES PFKEY11F.
  1874         10  PFKEY11A PIC  X(0001).
  1875     05  PFKEY11I PIC  X(0014).
  1876 01  EL127HO REDEFINES EL127HI.
  1877     05  FILLER            PIC  X(0012).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  HDATEO PIC  X(0008).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  HTIMEO PIC  99.99.
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  CMPNYIDO PIC  X(0003).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  USERIDO PIC  X(0004).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  HCARIERO PIC  X(0001).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  37
* EL1278.cbl
  1895     05  HGROUPO PIC  X(0006).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  HSTATEO PIC  X(0002).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  HACCTNOO PIC  X(0010).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  HEFFDTO PIC  X(0008).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  HCERTNOO PIC  X(0010).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  HCRTSFXO PIC  X(0001).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  HLNAMEO PIC  X(0015).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  HFNAMEO PIC  X(0010).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  HINITO PIC  X(0001).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  LCLMDTHO PIC  X(0022).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  LCLMDTO PIC  X(0008).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  HPCYNO PIC  X(0001).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  ACLMDTHO PIC  X(0023).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  ACLMDTO PIC  X(0008).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  PMTHDO PIC  X(0010).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  CNCDTHDO PIC  X(0007).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  HLKINDO PIC  X(0002).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  HLCDO PIC  X(0002).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  HLEDESCO PIC  X(0003).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  HLTERMO PIC  ZZ9.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  38
* EL1278.cbl
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  HLREMO PIC  ZZ9.
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  HLCANCO PIC  X(0008).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  HLCAL1O PIC  X(0001).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  HLCALCO PIC  X(0012).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  HLCPCTO PIC  .99999.
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  HLCAMTO PIC  ZZ,ZZ9.99.
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  HAKINDO PIC  X(0002).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  HACDO PIC  X(0002).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  HAEDESCO PIC  X(0003).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  HATERMO PIC  ZZ9.
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  HAREMO PIC  ZZ9.
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  HACANCO PIC  X(0008).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  HACAL1O PIC  X(0001).
  2010*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  39
* EL1278.cbl
  2011     05  FILLER            PIC  X(0003).
  2012     05  HACALCO PIC  X(0012).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  HACPCTO PIC  .99999.
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  HACAMTO PIC  ZZ,ZZ9.99.
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  CANFEEHO PIC  X(0012).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  CANFEEO PIC  ZZ9.99.
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  CANREAHO PIC  X(0015).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  CANREAO PIC  X(0001).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  CLPYNHO PIC  X(0005).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  CLPYNO PIC  X(0001).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  REFDUEHO PIC  X(0018).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  REFDUEO PIC  ZZZ,ZZ9.99.
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  FREMTRMO PIC  ZZ9.
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  HERMSG1O PIC  X(0079).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  HERMSG2O PIC  X(0079).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  HPFKEYO PIC  99.
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  40
* EL1278.cbl
  2069     05  PFKEY11O PIC  X(0014).
  2070*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  41
* EL1278.cbl
  2072*                            COPY ELCCALC.
  2073******************************************************************
  2074*                                                                *
  2075*                           ELCCALC.                            *
  2076*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2077*                            VMOD=2.025                          *
  2078*                                                                *
  2079*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2080*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2081*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2082*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2083*                                                                *
  2084*  PASSED TO ELRTRM                                              *
  2085*  -----------------                                             *
  2086*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2087*  ORIGINAL TERM                                                 *
  2088*  BEGINNING DATE                                                *
  2089*  ENDING DATE                                                   *
  2090*  COMPANY I.D.                                                  *
  2091*  ACCOUNT MASTER USER FIELD                                     *
  2092*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2093*  FREE LOOK DAYS                                                *
  2094*                                                                *
  2095*  RETURNED FROM ELRTRM                                          *
  2096*  ---------------------                                         *
  2097*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2098*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2099*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2100*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2101*----------------------------------------------------------------*
  2102*  PASSED TO ELRAMT                                              *
  2103*  ----------------                                              *
  2104*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2105*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2106*  ORIGINAL AMOUNT                                               *
  2107*  ALTERNATE BENEFIT (BALLON)                                    *
  2108*  A.P.R. - NET PAY ONLY                                         *
  2109*  METHOD
  2110*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2111*  COMPANY I.D.                                                  *
  2112*  BENEFIT TYPE                                                  *
  2113*                                                                *
  2114*  RETURNED FROM ELRAMT                                          *
  2115*  --------------------                                          *
  2116*  REMAINING AMOUNT 1 - CURRENT                                  *
  2117*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2118*  REMAINING AMOUNT FACTOR
  2119*----------------------------------------------------------------*
  2120*  PASSED TO ELRESV                                              *
  2121*  -----------------                                             *
  2122*  CERTIFICATE EFFECTIVE DATE                                    *
  2123*  VALUATION DATE                                                *
  2124*  PAID THRU DATE                                                *
  2125*  BENEFIT                                                       *
  2126*  INCURRED DATE                                                 *
  2127*  REPORTED DATE                                                 *
  2128*  ISSUE AGE                                                     *
  2129*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  42
* EL1278.cbl
  2130*  CDT PERCENT                                                   *
  2131*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2132* *CLAIM TYPE (LIFE, A/H)                                        *
  2133* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2134* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2135*                                                                *
  2136*  RETURNED FROM ELRESV                                          *
  2137*  --------------------                                          *
  2138*  CDT TABLE USED                                                *
  2139*  CDT FACTOR USED                                               *
  2140*  PAY TO CURRENT RESERVE                                        *
  2141*  I.B.N.R. - A/H ONLY                                           *
  2142*  FUTURE (ACCRUED) AH ONLY                                      *
  2143*----------------------------------------------------------------*
  2144*  PASSED TO ELRATE                                              *
  2145*  ----------------                                              *
  2146*  CERT ISSUE DATE                                               *
  2147*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2148*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2149*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2150*  STATE CODE (CLIENT DEFINED)                                   *
  2151*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2152*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2153*  DEVIATION CODE                                                *
  2154*  ISSUE AGE                                                     *
  2155*  ORIGINAL BENEFIT AMOUNT                                       *
  2156*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2157*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2158*  BENEFIT KIND (LIFE OR A/H)                                    *
  2159*  A.P.R.                                                        *
  2160*  METHOD
  2161*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2162*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2163*  COMPANY I.D. (3 CHARACTER)                                    *
  2164*  BENEFIT CODE                                                  *
  2165*  BENEFIT OVERRIDE CODE                                         *
  2166*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2167*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2168*  JOINT INDICATOR (CSL ONLY)                                    *
  2169*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2170*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2171*                                                                *
  2172*  RETURNED FROM ELRATE                                          *
  2173*  --------------------                                          *
  2174*  CALCULATED PREMIUM                                            *
  2175*  PREMIUM RATE                                                  *
  2176*  MORTALITY CODE                                                *
  2177*  MAX ATTAINED AGE                                              *
  2178*  MAX AGE                                                       *
  2179*  MAX TERM                                                      *
  2180*  MAX MONTHLY BENEFIT                                           *
  2181*  MAX TOTAL BENIFIT                                             *
  2182*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2183*----------------------------------------------------------------*
  2184*  PASSED TO ELRFND                                              *
  2185*  ----------------                                              *
  2186*  CERT ISSUE DATE                                               *
  2187*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  43
* EL1278.cbl
  2188*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2189*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2190*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2191*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2192*  STATE CODE (CLIENT DEFINED)                                   *
  2193*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2194*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2195*  DEVIATION CODE                                                *
  2196*  ISSUE AGE                                                     *
  2197*  ORIGINAL BENEFIT AMOUNT                                       *
  2198*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2199*  PROCESS TYPE (CANCEL)                                         *
  2200*  BENEFIT KIND (LIFE OR A/H)                                    *
  2201*  A.P.R.                                                        *
  2202*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2203*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2204*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2205*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2206*  COMPANY I.D. (3 CHARACTER)                                    *
  2207*  BENEFIT CODE                                                  *
  2208*  BENEFIT OVERRIDE CODE                                         *
  2209*                                                                *
  2210*  RETURNED FROM ELRFND                                          *
  2211*  --------------------                                          *
  2212*  CALCULATED REFUND                                             *
  2213*----------------------------------------------------------------*
  2214*  PASSED TO ELEARN                                              *
  2215*  ----------------                                              *
  2216*  CERT ISSUE DATE                                               *
  2217*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2218*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2219*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2220*  STATE CODE (CLIENT DEFINED)                                   *
  2221*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2222*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2223*  DEVIATION CODE                                                *
  2224*  ISSUE AGE                                                     *
  2225*  ORIGINAL BENEFIT AMOUNT                                       *
  2226*  BENEFIT KIND (LIFE OR A/H)                                    *
  2227*  A.P.R.                                                        *
  2228*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2229*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2230*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2231*  COMPANY I.D. (3 CHARACTER)                                    *
  2232*  BENEFIT CODE                                                  *
  2233*  BENEFIT OVERRIDE CODE                                         *
  2234*                                                                *
  2235*  RETURNED FROM ELEARN                                          *
  2236*  --------------------                                          *
  2237*  INDICATED  EARNINGS                                           *
  2238*----------------------------------------------------------------*
  2239*                 LENGTH = 450                                   *
  2240*                                                                *
  2241******************************************************************
  2242******************************************************************
  2243*                   C H A N G E   L O G
  2244*
  2245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  44
* EL1278.cbl
  2246*-----------------------------------------------------------------
  2247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2248* EFFECTIVE    NUMBER
  2249*-----------------------------------------------------------------
  2250* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2251* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2252* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2253* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2254* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2255* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2256* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2257* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2258* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2259* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2260* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2261******************************************************************
  2262
  2263 01  CALCULATION-PASS-AREA.
  2264     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2265                                     COMP.
  2266
  2267     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2268       88  NO-CP-ERROR                             VALUE ZERO.
  2269       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2270                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2271       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2272       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2273       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2274       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2275       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2276       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2277       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2278       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2279       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2280       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2281       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2282       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2283       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2284       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2285       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2286       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2287       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2288
  2289     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2290       88  NO-CP-ERROR-2                           VALUE ZERO.
  2291***********************  INPUT AREAS ****************************
  2292
  2293     12  CP-CALCULATION-AREA.
  2294         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2295         16  CP-CERT-EFF-DT        PIC XX.
  2296         16  CP-VALUATION-DT       PIC XX.
  2297         16  CP-PAID-THRU-DT       PIC XX.
  2298         16  CP-BENEFIT-TYPE       PIC X.
  2299           88  CP-AH                               VALUE 'A' 'D'
  2300                                                   'I' 'U'.
  2301           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2302           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2303         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  45
* EL1278.cbl
  2304         16  CP-REPORTED-DT        PIC XX.
  2305         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2306         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2307         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2308                                     COMP-3.
  2309         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2310                                     COMP-3.
  2311         16  CP-CDT-METHOD         PIC X.
  2312           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2313           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2314           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2315         16  CP-CLAIM-TYPE         PIC X.
  2316           88  CP-AH-CLAIM                         VALUE 'A'.
  2317           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2318         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2319                                     COMP-3.
  2320         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2321                                     COMP-3.
  2322         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2323                                     COMP-3.
  2324         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2325                                     COMP-3.
  2326         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2327                                     COMP-3.
  2328         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2329                                     COMP-3.
  2330         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2331                                     COMP-3.
  2332         16  CP-REM-TERM-METHOD    PIC X.
  2333           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2334           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2335           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2336           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2337           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2338           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2339           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2340         16  CP-EARNING-METHOD     PIC X.
  2341           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2342           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2343           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2344           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2345           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2346           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2347           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2348           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2349           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2350           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2351           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2352           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2353           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2354           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2355         16  CP-PROCESS-TYPE       PIC X.
  2356           88  CP-CLAIM                            VALUE '1'.
  2357           88  CP-CANCEL                           VALUE '2'.
  2358           88  CP-ISSUE                            VALUE '3'.
  2359         16  CP-SPECIAL-CALC-CD    PIC X.
  2360           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2361           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  46
* EL1278.cbl
  2362           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2363           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2364           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2365           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2366           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2367           88  CP-FARM-PLAN                    VALUE 'F'.
  2368           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2369           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2370           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2371           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2372           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2373           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2374           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2375           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2376           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2377           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2378                                                     'W' 'X'.
  2379           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2380           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2381           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2382           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2383           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2384           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2385           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2386           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2387           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2388           88  CP-CSL-METH-1                   VALUE '5'.
  2389           88  CP-CSL-METH-2                   VALUE '6'.
  2390           88  CP-CSL-METH-3                   VALUE '7'.
  2391           88  CP-CSL-METH-4                   VALUE '8'.
  2392
  2393         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2394                                     COMP-3.
  2395         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2396         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2397         16  CP-STATE              PIC XX          VALUE SPACE.
  2398         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2399         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2400           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2401               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2402         16  CP-R78-OPTION         PIC X.
  2403           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2404           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2405
  2406         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2407         16  CP-IBNR-RESERVE-SW    PIC X.
  2408         16  CP-CLAIM-STATUS       PIC X.
  2409         16  CP-RATE-FILE          PIC X.
  2410         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2411                                     COMP-3.
  2412
  2413         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2414         16  CP-AH-OVERRIDE-CODE   PIC X.
  2415
  2416         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2417                                     COMP-3.
  2418         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2419                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  47
* EL1278.cbl
  2420         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2421                                     COMP-3.
  2422         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2423                                     COMP-3.
  2424         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2425                                     COMP-3.
  2426         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2427                                  PIC S9(7)V99 COMP-3.
  2428
  2429         16  CP-PAID-FROM-DATE     PIC X(02).
  2430         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2431         16  CP-EXT-DAYS-CALC      PIC X.
  2432           88  CP-EXT-NO-CHG                   VALUE ' '.
  2433           88  CP-EXT-CHG-LF                   VALUE '1'.
  2434           88  CP-EXT-CHG-AH                   VALUE '2'.
  2435           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2436         16  CP-DOMICILE-STATE     PIC XX.
  2437         16  CP-CARRIER            PIC X.
  2438         16  CP-REIN-FLAG          PIC X.
  2439         16  CP-REM-TRM-CALC-OPTION PIC X.
  2440           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2441                      '2' '3' '4' '5'.
  2442           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2443           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2444           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2445           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2446           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2447           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2448           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2449           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2450         16  CP-SIG-SWITCH         PIC X.
  2451         16  CP-RATING-METHOD      PIC X.
  2452           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2453           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2454           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2455           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2456           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2457           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2458           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2459           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2460           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2461         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2462                                     COMP-3.
  2463         16  CP-BEN-CATEGORY       PIC X.
  2464         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2465         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2466                                   PIC S99V9(5) COMP-3.
  2467         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2468         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2469                                   PIC S99V9(5) COMP-3.
  2470         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2471         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2472         16  CP-EXPIRE-DT          PIC XX.
  2473         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2474         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2475         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2476         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2477         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  48
* EL1278.cbl
  2478             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2479             88  CP-CALC-CLP              VALUE 'C'.
  2480         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2481         16  CP-CANCEL-REASON      PIC X.
  2482         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2483         16  CP-PMT-MODE           PIC X.
  2484         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2485         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2486         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2487         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2488         16  FILLER                PIC X.
  2489
  2490***************    OUTPUT FROM ELRESV   ************************
  2491
  2492         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2493
  2494         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2495                                     COMP-3.
  2496         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2497                                     COMP-3.
  2498         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2499                                     COMP-3.
  2500         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2501                                     COMP-3.
  2502         16  FILLER                PIC X(09).
  2503***************    OUTPUT FROM ELRTRM   *************************
  2504
  2505         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2506                                     COMP-3.
  2507         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2508                                     COMP-3.
  2509         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2510                                     COMP-3.
  2511         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2512                                     COMP-3.
  2513         16  FILLER                PIC X(12).
  2514
  2515***************    OUTPUT FROM ELRAMT   *************************
  2516
  2517         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2518                                     COMP-3.
  2519         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2520                                     COMP-3.
  2521         16  FILLER                PIC X(12).
  2522
  2523***************    OUTPUT FROM ELRATE   *************************
  2524
  2525         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2526                                     COMP-3.
  2527         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2528                                     COMP-3.
  2529         16  CP-MORTALITY-CODE     PIC X(4).
  2530         16  CP-RATE-EDIT-FLAG     PIC X.
  2531             88  CP-RATES-NEED-APR                  VALUE '1'.
  2532         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2533                                     COMP-3.
  2534         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2535         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  49
* EL1278.cbl
  2536         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2537                                   PIC S9(7)V99 COMP-3.
  2538         16  FILLER                PIC X(07).
  2539
  2540***************    OUTPUT FROM ELRFND   *************************
  2541
  2542         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2543                                     COMP-3.
  2544         16  CP-REFUND-TYPE-USED   PIC X.
  2545           88  CP-R-AS-R78                         VALUE '1'.
  2546           88  CP-R-AS-PRORATA                     VALUE '2'.
  2547           88  CP-R-AS-CALIF                       VALUE '3'.
  2548           88  CP-R-AS-TEXAS                       VALUE '4'.
  2549           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2550           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2551           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2552           88  CP-R-AS-MEAN                        VALUE '8'.
  2553           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2554           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2555           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2556           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2557           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2558           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2559         16  FILLER                PIC X(12).
  2560
  2561***************    OUTPUT FROM ELEARN   *************************
  2562
  2563         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2566                                     COMP-3.
  2567         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2568                                     COMP-3.
  2569         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2570                                     COMP-3.
  2571         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2572                                     COMP-3.
  2573         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2574                                     COMP-3.
  2575         16  CP-EARNING-TYPE-USED  PIC X.
  2576           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2577           88  CP-E-AS-R78                         VALUE '1'.
  2578           88  CP-E-AS-PRORATA                     VALUE '2'.
  2579           88  CP-E-AS-TEXAS                       VALUE '4'.
  2580           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2581           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2582           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2583           88  CP-E-AS-MEAN                        VALUE '8'.
  2584           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2585         16  FILLER                PIC X(12).
  2586
  2587***************    OUTPUT FROM ELPMNT   *************************
  2588
  2589         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2590                                     COMP-3.
  2591         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2592                                     COMP-3.
  2593         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  50
* EL1278.cbl
  2594
  2595***************   MISC WORK AREAS    *****************************
  2596         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2597                                     COMP-3.
  2598         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2599                                     COMP-3.
  2600         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2601                                     COMP-3.
  2602         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2603                                     COMP-3.
  2604         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2605                                     COMP-3.
  2606         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2607                                     COMP-3.
  2608         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2609             88  OPEN-RATE-FILE                   VALUE 'O'.
  2610             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2611             88  IO-ERROR                         VALUE 'E'.
  2612
  2613         16  CP-FIRST-PAY-DATE     PIC XX.
  2614
  2615         16  CP-JOINT-INDICATOR    PIC X.
  2616
  2617         16  CP-RESERVE-REMAINING-TERM
  2618                                   PIC S9(4)V9    VALUE ZERO
  2619                                     COMP-3.
  2620
  2621         16  CP-INSURED-BIRTH-DT   PIC XX.
  2622
  2623         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2624                                     COMP-3.
  2625
  2626         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2627                                     COMP-3.
  2628
  2629         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2630                                     COMP-3.
  2631
  2632         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2633                                     COMP-3.
  2634
  2635         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2636                                     COMP-3.
  2637
  2638         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2639                                     COMP-3.
  2640
  2641         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2642                                     COMP-3.
  2643
  2644         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2645             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2646
  2647         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2648                                     COMP-3.
  2649         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2650                                     COMP-3.
  2651         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  51
* EL1278.cbl
  2652         16  cp-extra-periods      pic 9 value zeros.
  2653         16  cp-net-only-state     pic x value spaces.
  2654         16  FILLER                PIC X(13).
  2655******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  52
* EL1278.cbl
  2657*                            COPY ERCNOTE.
  2658******************************************************************
  2659*                                                                *
  2660*                                                                *
  2661*                            ERCNOTE                             *
  2662*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2663*                            VMOD=2.003                          *
  2664*                                                                *
  2665*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2666*                                                                *
  2667*        FILE TYPE= VSAM,KSDS                                    *
  2668*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2669*                                                                *
  2670*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2671*                                                                *
  2672*        LOG = YES                                               *
  2673*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2674*                                                                *
  2675******************************************************************
  2676*                   C H A N G E   L O G
  2677*
  2678* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2679*-----------------------------------------------------------------
  2680*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2681* EFFECTIVE    NUMBER
  2682*-----------------------------------------------------------------
  2683* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2684*                                FILE WILL CONTAIN BILLING NOTES O
  2685******************************************************************
  2686
  2687 01  CERTIFICATE-NOTE.
  2688     12  CN-RECORD-ID                PIC  XX.
  2689         88  VALID-CN-ID                  VALUE 'CN'.
  2690
  2691     12  CN-CONTROL-PRIMARY.
  2692         16  CN-COMPANY-CD           PIC X.
  2693         16  CN-CARRIER              PIC X.
  2694         16  CN-GROUPING.
  2695             20 CN-GROUPING-PREFIX   PIC XXX.
  2696             20 CN-GROUPING-PRIME    PIC XXX.
  2697         16  CN-STATE                PIC XX.
  2698         16  CN-ACCOUNT.
  2699             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2700             20 CN-ACCOUNT-PRIME     PIC X(6).
  2701         16  CN-CERT-EFF-DT          PIC XX.
  2702         16  CN-CERT-NO.
  2703             20  CN-CERT-PRIME       PIC X(10).
  2704             20  CN-CERT-SFX         PIC X.
  2705
  2706     12  CN-BILLING-START-LINE-NO    PIC 99.
  2707     12  CN-BILLING-END-LINE-NO      PIC 99.
  2708
  2709     12  CN-LINES.
  2710         16  CN-LINE OCCURS 10       PIC X(77).
  2711
  2712     12  CN-LAST-MAINT-DT            PIC XX.
  2713     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2714     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  53
* EL1278.cbl
  2715     12  FILLER                      PIC X(6).
  2716******************************************************************
  2717*                            COPY ERCCTBL.
  2718******************************************************************
  2719*                                                                *
  2720*                                                                *
  2721*                            ERCCTBL                             *
  2722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2723*                            VMOD=2.003
  2724*                                                                *
  2725*   ONLINE CREDIT SYSTEM                                         *
  2726*                                                                *
  2727*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2728*                                                                *
  2729*   FILE TYPE = VSAM,KSDS                                        *
  2730*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2731*                                                                *
  2732*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2733*       ALTERNATE PATH = NONE                                    *
  2734*                                                                *
  2735*   LOG = NO                                                     *
  2736*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2737*                                                                *
  2738*                                                                *
  2739******************************************************************
  2740
  2741 01  COMM-TABLE-RECORD.
  2742     12  CT-RECORD-ID                      PIC XX.
  2743         88  VALID-CT-ID                      VALUE 'CT'.
  2744
  2745     12  CT-CONTROL-PRIMARY.
  2746         16  CT-COMPANY-CD                 PIC X.
  2747         16  CT-TABLE                      PIC XXX.
  2748         16  CT-CNTRL-2.
  2749             20  CT-BEN-TYPE               PIC X.
  2750             20  CT-BEN-CODE               PIC XX.
  2751
  2752     12  CT-MAINT-INFORMATION.
  2753         16  CT-LAST-MAINT-DT              PIC XX.
  2754         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2755         16  CT-LAST-MAINT-USER            PIC X(4).
  2756         16  FILLER                        PIC X(31).
  2757
  2758     12  CT-LIMITS.
  2759         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2760
  2761         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2762
  2763         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2764
  2765     12  CT-RATES.
  2766         16  CT-RTX          OCCURS 27 TIMES.
  2767             20  CT-RT                     PIC SV9(5)     COMP-3.
  2768             20  CT-RT-R   REDEFINES
  2769                 CT-RT                     PIC XXX.
  2770
  2771     12  FILLER                            PIC  X(42).
  2772
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  54
* EL1278.cbl
  2773******************************************************************
  2774
  2775****************************************************************
  2776*
  2777* Copyright (c) 2007-2013 Dell Inc.
  2778* All rights reserved.
  2779*
  2780****************************************************************
  2781 01  DFHEIV.
  2782   02  DFHEIV0               PIC X(35).
  2783   02  DFHEIV1               PIC X(08).
  2784   02  DFHEIV2               PIC X(08).
  2785   02  DFHEIV3               PIC X(08).
  2786   02  DFHEIV4               PIC X(06).
  2787   02  DFHEIV5               PIC X(04).
  2788   02  DFHEIV6               PIC X(04).
  2789   02  DFHEIV7               PIC X(02).
  2790   02  DFHEIV8               PIC X(02).
  2791   02  DFHEIV9               PIC X(01).
  2792   02  DFHEIV10              PIC S9(7) COMP-3.
  2793   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2794   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2795   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2796   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2797   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2798   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2799   02  DFHEIV17              PIC X(04).
  2800   02  DFHEIV18              PIC X(04).
  2801   02  DFHEIV19              PIC X(04).
  2802   02  DFHEIV20              USAGE IS POINTER.
  2803   02  DFHEIV21              USAGE IS POINTER.
  2804   02  DFHEIV22              USAGE IS POINTER.
  2805   02  DFHEIV23              USAGE IS POINTER.
  2806   02  DFHEIV24              USAGE IS POINTER.
  2807   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2808   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2809   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2810   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2811   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2812   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2813   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2814   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2815   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2816   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2817   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2818   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2819   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2820   02  FILLER                PIC X(02).
  2821   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2822   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2823   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2824   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2825   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2826   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2827   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2828 LINKAGE  SECTION.
  2829*****************************************************************
  2830*                                                               *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  55
* EL1278.cbl
  2831* Copyright (c) 2007-2013 Dell Inc.                             *
  2832* All rights reserved.                                          *
  2833*                                                               *
  2834*****************************************************************
  2835 01  dfheiblk.
  2836     02  eibtime          pic s9(7) comp-3.
  2837     02  eibdate          pic s9(7) comp-3.
  2838     02  eibtrnid         pic x(4).
  2839     02  eibtaskn         pic s9(7) comp-3.
  2840     02  eibtrmid         pic x(4).
  2841     02  dfheigdi         pic s9(4) comp.
  2842     02  eibcposn         pic s9(4) comp.
  2843     02  eibcalen         pic s9(4) comp.
  2844     02  eibaid           pic x(1).
  2845     02  eibfiller1       pic x(1).
  2846     02  eibfn            pic x(2).
  2847     02  eibfiller2       pic x(2).
  2848     02  eibrcode         pic x(6).
  2849     02  eibfiller3       pic x(2).
  2850     02  eibds            pic x(8).
  2851     02  eibreqid         pic x(8).
  2852     02  eibrsrce         pic x(8).
  2853     02  eibsync          pic x(1).
  2854     02  eibfree          pic x(1).
  2855     02  eibrecv          pic x(1).
  2856     02  eibsend          pic x(1).
  2857     02  eibatt           pic x(1).
  2858     02  eibeoc           pic x(1).
  2859     02  eibfmh           pic x(1).
  2860     02  eibcompl         pic x(1).
  2861     02  eibsig           pic x(1).
  2862     02  eibconf          pic x(1).
  2863     02  eiberr           pic x(1).
  2864     02  eibrldbk         pic x(1).
  2865     02  eiberrcd         pic x(4).
  2866     02  eibsynrb         pic x(1).
  2867     02  eibnodat         pic x(1).
  2868     02  eibfiller5       pic x(2).
  2869     02  eibresp          pic s9(8) comp.
  2870     02  eibresp2         pic s9(8) comp.
  2871     02  dfheigdj         pic s9(4) comp.
  2872     02  dfheigdk         pic s9(4) comp.
  2873
  2874 01  DFHCOMMAREA                 PIC  X(1024).
  2875
  2876*01 PARMLIST .
  2877*    12  FILLER                  PIC S9(08)      COMP.
  2878*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2879*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2880*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2881*                            COPY ELCCNTL.
  2882******************************************************************
  2883*                                                                *
  2884*                                                                *
  2885*                            ELCCNTL.                            *
  2886*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2887*                            VMOD=2.059                          *
  2888*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  56
* EL1278.cbl
  2889*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2890*                                                                *
  2891*   FILE TYPE = VSAM,KSDS                                        *
  2892*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2893*                                                                *
  2894*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2895*       ALTERNATE INDEX = NONE                                   *
  2896*                                                                *
  2897*   LOG = YES                                                    *
  2898*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2899******************************************************************
  2900*                   C H A N G E   L O G
  2901*
  2902* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2903*-----------------------------------------------------------------
  2904*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2905* EFFECTIVE    NUMBER
  2906*-----------------------------------------------------------------
  2907* 082503                   PEMA  ADD BENEFIT GROUP
  2908* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2909* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2910* 092705    2005050300006  PEMA  ADD SPP LEASES
  2911* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2912* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2913* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2914* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2915* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2916* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2917* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2918* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2919* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2920* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2921* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2922******************************************************************
  2923*
  2924 01  CONTROL-FILE.
  2925     12  CF-RECORD-ID                       PIC XX.
  2926         88  VALID-CF-ID                        VALUE 'CF'.
  2927
  2928     12  CF-CONTROL-PRIMARY.
  2929         16  CF-COMPANY-ID                  PIC XXX.
  2930         16  CF-RECORD-TYPE                 PIC X.
  2931             88  CF-COMPANY-MASTER              VALUE '1'.
  2932             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2933             88  CF-STATE-MASTER                VALUE '3'.
  2934             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2935             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2936             88  CF-CARRIER-MASTER              VALUE '6'.
  2937             88  CF-MORTALITY-MASTER            VALUE '7'.
  2938             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2939             88  CF-TERMINAL-MASTER             VALUE '9'.
  2940             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2941             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2942             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2943             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2944             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2945             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2946             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  57
* EL1278.cbl
  2947             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2948             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2949         16  CF-ACCESS-CD-GENL              PIC X(4).
  2950         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2951             20  CF-PROCESSOR               PIC X(4).
  2952         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2953             20  CF-STATE-CODE              PIC XX.
  2954             20  FILLER                     PIC XX.
  2955         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2956             20  FILLER                     PIC XX.
  2957             20  CF-HI-BEN-IN-REC           PIC XX.
  2958         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2959             20  FILLER                     PIC XXX.
  2960             20  CF-CARRIER-CNTL            PIC X.
  2961         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2962             20  FILLER                     PIC XX.
  2963             20  CF-HI-TYPE-IN-REC          PIC 99.
  2964         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2965             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2966                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2967             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2968             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2969         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2970             20  FILLER                     PIC X.
  2971             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2972         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2973             20  FILLER                     PIC XX.
  2974             20  CF-MORTGAGE-PLAN           PIC XX.
  2975         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2976
  2977     12  CF-LAST-MAINT-DT                   PIC XX.
  2978     12  CF-LAST-MAINT-BY                   PIC X(4).
  2979     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2980
  2981     12  CF-RECORD-BODY                     PIC X(728).
  2982
  2983
  2984****************************************************************
  2985*             COMPANY MASTER RECORD                            *
  2986****************************************************************
  2987
  2988     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2989         16  CF-COMPANY-ADDRESS.
  2990             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2991             20  CF-CL-IN-CARE-OF           PIC X(30).
  2992             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2993             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2994             20  CF-CL-CITY-STATE           PIC X(30).
  2995             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2996             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2997         16  CF-COMPANY-CD                  PIC X.
  2998         16  CF-COMPANY-PASSWORD            PIC X(8).
  2999         16  CF-SECURITY-OPTION             PIC X.
  3000             88  ALL-SECURITY                   VALUE '1'.
  3001             88  COMPANY-VERIFY                 VALUE '2'.
  3002             88  PROCESSOR-VERIFY               VALUE '3'.
  3003             88  NO-SECURITY                    VALUE '4'.
  3004             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  58
* EL1278.cbl
  3005         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3006             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3007         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3008             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3009         16  CF-INFORCE-LOCATION            PIC X.
  3010             88  CERTS-ARE-ONLINE               VALUE '1'.
  3011             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3012             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3013         16  CF-LOWER-CASE-LETTERS          PIC X.
  3014         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3015             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3016             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3017             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3018             88  CF-ACCNT-CNTL                  VALUE '3'.
  3019             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3020
  3021         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3022         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3023
  3024         16  CF-LGX-CREDIT-USER             PIC X.
  3025             88  CO-IS-NOT-USER                 VALUE 'N'.
  3026             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3027
  3028         16 CF-CREDIT-CALC-CODES.
  3029             20  CF-CR-REM-TERM-CALC PIC X.
  3030               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3031               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3032               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3033               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3034               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3035               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3036               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3037             20  CF-CR-R78-METHOD           PIC X.
  3038               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3039               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3040
  3041         16  CF-CLAIM-CONTROL-COUNTS.
  3042             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3043                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3044
  3045             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3046                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3047
  3048             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3049                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3050
  3051             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3052                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3053
  3054         16  CF-CURRENT-MONTH-END           PIC XX.
  3055
  3056         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3057             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3058             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3059             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3060             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3061                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3062                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  59
* EL1278.cbl
  3063             20  CF-CO-PREM-REJECT-SW       PIC X.
  3064                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3065                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3066             20  CF-CO-REF-REJECT-SW        PIC X.
  3067                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3068                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3069
  3070         16  CF-CO-REPORTING-DT             PIC XX.
  3071         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3072         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3073           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3074           88  CF-CO-MONTH-END                  VALUE '1'.
  3075
  3076         16  CF-LGX-CLAIM-USER              PIC X.
  3077             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3078             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3079
  3080         16  CF-CREDIT-EDIT-CONTROLS.
  3081             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3082             20  CF-MIN-AGE                 PIC 99.
  3083             20  CF-DEFAULT-AGE             PIC 99.
  3084             20  CF-MIN-TERM                PIC S999      COMP-3.
  3085             20  CF-MAX-TERM                PIC S999      COMP-3.
  3086             20  CF-DEFAULT-SEX             PIC X.
  3087             20  CF-JOINT-AGE-INPUT         PIC X.
  3088                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3089             20  CF-BIRTH-DATE-INPUT        PIC X.
  3090                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3091             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3092                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3093                 88  CF-ZERO-CARRIER            VALUE '1'.
  3094                 88  CF-ZERO-GROUPING           VALUE '2'.
  3095                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3096             20  CF-EDIT-SW                 PIC X.
  3097                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3098             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3099             20  CF-CR-PR-METHOD            PIC X.
  3100               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3101               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3102             20  FILLER                     PIC X.
  3103
  3104         16  CF-CREDIT-MISC-CONTROLS.
  3105             20  CF-REIN-TABLE-SW           PIC X.
  3106                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3107             20  CF-COMP-TABLE-SW           PIC X.
  3108                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3109             20  CF-EXPERIENCE-RETENTION-AGE
  3110                                            PIC S9        COMP-3.
  3111             20  CF-CONVERSION-DT           PIC XX.
  3112             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3113             20  CF-RUN-FREQUENCY-SW        PIC X.
  3114                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3115                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3116
  3117             20  CF-CR-CHECK-NO-CONTROL.
  3118                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3119                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3120                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  60
* EL1278.cbl
  3121                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3122                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3123                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3124
  3125                 24  CF-CR-CHECK-COUNT       REDEFINES
  3126                     CF-CR-CHECK-COUNTER      PIC X(4).
  3127
  3128                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3129                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3130
  3131                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3132                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3133                 24  CF-MAIL-PROCESSING       PIC X.
  3134                     88  MAIL-PROCESSING          VALUE 'Y'.
  3135
  3136         16  CF-MISC-SYSTEM-CONTROL.
  3137             20  CF-SYSTEM-C                 PIC X.
  3138                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3139             20  CF-SYSTEM-D                 PIC X.
  3140                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3141             20  CF-SOC-SEC-NO-SW            PIC X.
  3142                 88  SOC-SEC-NO-USED             VALUE '1'.
  3143             20  CF-MEMBER-NO-SW             PIC X.
  3144                 88  MEMBER-NO-USED              VALUE '1'.
  3145             20  CF-TAX-ID-NUMBER            PIC X(11).
  3146             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3147             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3148                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3149                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3150                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3151                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3152             20  CF-SYSTEM-E                 PIC X.
  3153                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3154
  3155         16  CF-LGX-LIFE-USER               PIC X.
  3156             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3157             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3158
  3159         16  CF-CR-MONTH-END-DT             PIC XX.
  3160
  3161         16  CF-FILE-MAINT-DATES.
  3162             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3163                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3164             20  CF-LAST-BATCH       REDEFINES
  3165                 CF-LAST-BATCH-NO               PIC X(4).
  3166             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3167             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3168             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3169             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3170             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3171             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3172             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3173             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3174             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3175             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3176
  3177         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3178         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  61
* EL1278.cbl
  3179
  3180         16  CF-ALT-MORT-CODE               PIC X(4).
  3181         16  CF-MEMBER-CAPTION              PIC X(10).
  3182
  3183         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3184             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3185             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3186             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3187             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3188             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3189
  3190         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3191
  3192         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3193         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3194         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3195         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3196
  3197         16  CF-AH-OVERRIDE-L1              PIC X.
  3198         16  CF-AH-OVERRIDE-L2              PIC XX.
  3199         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3200         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3201
  3202         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3203         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3204
  3205         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3206         16  CF-AR-LAST-EL860-DT            PIC XX.
  3207         16  CF-MP-MONTH-END-DT             PIC XX.
  3208
  3209         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3210         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3211             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3212
  3213         16  CF-AR-MONTH-END-DT             PIC XX.
  3214
  3215         16  CF-CRDTCRD-USER                PIC X.
  3216             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3217             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3218
  3219         16  CF-CC-MONTH-END-DT             PIC XX.
  3220
  3221         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3222
  3223         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3224             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3225             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3226             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3227         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3228         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3229         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3230         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3231             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3232             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3233         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3234         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3235         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3236             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  62
* EL1278.cbl
  3237         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3238
  3239         16  CF-CL-ZIP-CODE.
  3240             20  CF-CL-ZIP-PRIME.
  3241                 24  CF-CL-ZIP-1ST          PIC X.
  3242                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3243                 24  FILLER                 PIC X(4).
  3244             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3245         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3246             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3247             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3248             20  FILLER                     PIC XXX.
  3249
  3250         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3251         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3252         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3253         16  CF-CO-OPTION-START-DATE        PIC XX.
  3254         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3255           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3256                                                      '3' '4'.
  3257           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3258           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3259           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3260           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3261           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3262           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3263
  3264         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3265
  3266         16  CF-PAYMENT-APPROVAL-LEVELS.
  3267             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3268             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3269             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3270             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3271             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3272             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3273
  3274         16  CF-END-USER-REPORTING-USER     PIC X.
  3275             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3276             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3277
  3278         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3279             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3280             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3281
  3282         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3283
  3284         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3285         16  FILLER                         PIC X.
  3286
  3287         16  CF-CREDIT-ARCHIVE-CNTL.
  3288             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3289             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3290             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3291
  3292         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3293
  3294         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  63
* EL1278.cbl
  3295             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3296             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3297
  3298         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3299             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3300             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3301
  3302         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3303
  3304         16  CF-CO-ACH-ID-CODE              PIC  X.
  3305             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3306             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3307             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3308         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3309         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3310         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3311         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3312         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3313         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3314         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3315         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3316         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3317                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3318         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3319                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3320
  3321         16  CF-CO-OVER-SHORT.
  3322             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3323             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3324
  3325*         16  FILLER                         PIC X(102).
  3326         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3327             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3328             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3329
  3330         16  CF-AH-APPROVAL-DAYS.
  3331             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3332             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3333             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3334             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3335
  3336         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3337
  3338         16  CF-APPROV-LEV-5.
  3339             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3340             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3341             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3342
  3343         16  FILLER                         PIC X(68).
  3344****************************************************************
  3345*             PROCESSOR/USER RECORD                            *
  3346****************************************************************
  3347
  3348     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3349         16  CF-PROCESSOR-NAME              PIC X(30).
  3350         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3351         16  CF-PROCESSOR-TITLE             PIC X(26).
  3352         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  64
* EL1278.cbl
  3353                 88  MESSAGE-YES                VALUE 'Y'.
  3354                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3355
  3356*****************************************************
  3357****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3358****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3359****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3360****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3361*****************************************************
  3362
  3363         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3364             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3365             20  CF-APPLICATION-FORCE       PIC X.
  3366             20  CF-INDIVIDUAL-APP.
  3367                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3368                     28  CF-BROWSE-APP      PIC X.
  3369                     28  CF-UPDATE-APP      PIC X.
  3370
  3371         16  CF-CURRENT-TERM-ON             PIC X(4).
  3372         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3373             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3374             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3375             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3376             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3377             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3378             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3379             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3380         16  CF-PROCESSOR-CARRIER           PIC X.
  3381             88  NO-CARRIER-SECURITY            VALUE ' '.
  3382         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3383             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3384         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3385             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3386         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3387             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3388
  3389         16  CF-PROC-SYS-ACCESS-SW.
  3390             20  CF-PROC-CREDIT-CLAIMS-SW.
  3391                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3392                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3393                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3394                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3395             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3396                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3397                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3398             20  CF-PROC-LIFE-GNRLDGR-SW.
  3399                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3400                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3401                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3402                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3403             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3404                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3405                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3406         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3407             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3408             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3409         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3410
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  65
* EL1278.cbl
  3411         16  CF-APPROVAL-LEVEL                  PIC X.
  3412             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3413             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3414             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3415             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3416             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3417
  3418         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3419
  3420         16  CF-LANGUAGE-TYPE                   PIC X.
  3421             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3422             88  CF-LANG-IS-FR                      VALUE 'F'.
  3423
  3424         16  CF-CSR-IND                         PIC X.
  3425         16  FILLER                             PIC X(239).
  3426
  3427****************************************************************
  3428*             PROCESSOR/REMINDERS RECORD                       *
  3429****************************************************************
  3430
  3431     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3432         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3433             20  CF-START-REMIND-DT         PIC XX.
  3434             20  CF-END-REMIND-DT           PIC XX.
  3435             20  CF-REMINDER-TEXT           PIC X(50).
  3436         16  FILLER                         PIC X(296).
  3437
  3438
  3439****************************************************************
  3440*             STATE MASTER RECORD                              *
  3441****************************************************************
  3442
  3443     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3444         16  CF-STATE-ABBREVIATION          PIC XX.
  3445         16  CF-STATE-NAME                  PIC X(25).
  3446         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3447         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3448             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3449             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3450             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3451             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3452                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3453                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3454             20  CF-ST-PREM-REJECT-SW       PIC X.
  3455                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3456                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3457             20  CF-ST-REF-REJECT-SW        PIC X.
  3458                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3459                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3460         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3461         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3462         16  CF-ST-REFUND-RULES.
  3463             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3464             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3465             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3466         16  CF-ST-FST-PMT-EXTENSION.
  3467             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3468             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  66
* EL1278.cbl
  3469                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3470                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3471                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3472                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3473         16  CF-ST-STATE-CALL.
  3474             20  CF-ST-CALL-UNEARNED        PIC X.
  3475             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3476             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3477         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3478             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3479             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3480         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3481         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3482         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3483         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3484         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3485         16  FILLER                         PIC X.
  3486         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3487             20  CF-ST-BENEFIT-CD           PIC XX.
  3488             20  CF-ST-BENEFIT-KIND         PIC X.
  3489                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3490                 88  CF-ST-AH-KIND              VALUE 'A'.
  3491             20  CF-ST-REM-TERM-CALC        PIC X.
  3492                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3493                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3494                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3495                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3496                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3497                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3498                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3499                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3500
  3501             20  CF-ST-REFUND-CALC          PIC X.
  3502                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3503                 88  ST-REFD-BY-R78             VALUE '1'.
  3504                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3505                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3506                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3507                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3508                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3509                 88  ST-REFD-UTAH               VALUE '7'.
  3510                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3511                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3512                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3513
  3514             20  CF-ST-EARNING-CALC         PIC X.
  3515                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3516                 88  ST-EARN-BY-R78             VALUE '1'.
  3517                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3518                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3519                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3520                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3521                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3522                 88  ST-EARN-MEAN               VALUE '8'.
  3523                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3524
  3525             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3526                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  67
* EL1278.cbl
  3527                 88  ST-OVRD-BY-R78             VALUE '1'.
  3528                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3529                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3530                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3531                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3532                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3533                 88  ST-OVRD-MEAN               VALUE '8'.
  3534                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3535             20  cf-st-extra-periods        pic 9.
  3536*            20  FILLER                     PIC X.
  3537
  3538         16  CF-ST-COMMISSION-CAPS.
  3539             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3540             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3541             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3542             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3543         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3544                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3545                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3546                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3547
  3548         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3549
  3550         16  CF-ST-STATUTORY-INTEREST.
  3551             20  CF-ST-STAT-DATE-FROM       PIC X.
  3552                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3553                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3554             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3555             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3556             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3557             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3558             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3559
  3560         16  CF-ST-OVER-SHORT.
  3561             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3562             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3563
  3564         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3565
  3566         16  CF-ST-RT-CALC                  PIC X.
  3567
  3568         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3569         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3570         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3571         16  CF-ST-RF-LR-CALC               PIC X.
  3572         16  CF-ST-RF-LL-CALC               PIC X.
  3573         16  CF-ST-RF-LN-CALC               PIC X.
  3574         16  CF-ST-RF-AH-CALC               PIC X.
  3575         16  CF-ST-RF-CP-CALC               PIC X.
  3576*        16  FILLER                         PIC X(206).
  3577*CIDMOD         16  FILLER                         PIC X(192).
  3578         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3579             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3580         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3581         16  CF-ST-VFY-2ND-BENE             PIC X.
  3582         16  CF-ST-CAUSAL-STATE             PIC X.
  3583         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3584         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  68
* EL1278.cbl
  3585         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3586             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3587         16  CF-ST-NET-ONLY-STATE           PIC X.
  3588             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3589         16  cf-commission-cap-required     pic x.
  3590         16  CF-ST-GA-COMMISSION-CAPS.
  3591             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3592             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3593             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3594             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3595         16  CF-ST-TOT-COMMISSION-CAPS.
  3596             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3597             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3598             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3599             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3600         16  FILLER                         PIC X(156).
  3601
  3602****************************************************************
  3603*             BENEFIT MASTER RECORD                            *
  3604****************************************************************
  3605
  3606     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3607         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3608             20  CF-BENEFIT-CODE            PIC XX.
  3609             20  CF-BENEFIT-NUMERIC  REDEFINES
  3610                 CF-BENEFIT-CODE            PIC XX.
  3611             20  CF-BENEFIT-ALPHA           PIC XXX.
  3612             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3613             20  CF-BENEFIT-COMMENT         PIC X(10).
  3614
  3615             20  CF-LF-COVERAGE-TYPE        PIC X.
  3616                 88  CF-REDUCING                VALUE 'R'.
  3617                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3618
  3619             20  CF-SPECIAL-CALC-CD         PIC X.
  3620                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3621                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3622                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3623                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3624                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3625                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3626                 88  CF-FARM-PLAN               VALUE 'F'.
  3627                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3628                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3629                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3630                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3631                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3632                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3633                 88  CF-PRUDENTIAL              VALUE 'P'.
  3634                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3635                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3636                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3637                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3638                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3639                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3640
  3641             20  CF-JOINT-INDICATOR         PIC X.
  3642                 88  CF-JOINT-COVERAGE          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  69
* EL1278.cbl
  3643
  3644*            20  FILLER                     PIC X(12).
  3645             20  cf-maximum-benefits        pic s999 comp-3.
  3646             20  FILLER                     PIC X(09).
  3647             20  CF-BENEFIT-CATEGORY        PIC X.
  3648             20  CF-LOAN-TYPE               PIC X(8).
  3649
  3650             20  CF-CO-REM-TERM-CALC        PIC X.
  3651                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3652                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3653                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3654                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3655                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3656
  3657             20  CF-CO-EARNINGS-CALC        PIC X.
  3658                 88  CO-EARN-BY-R78             VALUE '1'.
  3659                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3660                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3661                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3662                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3663                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3664                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3665                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3666
  3667             20  CF-CO-REFUND-CALC          PIC X.
  3668                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3669                 88  CO-REFD-BY-R78             VALUE '1'.
  3670                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3671                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3672                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3673                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3674                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3675                 88  CO-REFD-MEAN               VALUE '8'.
  3676                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3677                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3678                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3679
  3680             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3681                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3682                 88  CO-OVRD-BY-R78             VALUE '1'.
  3683                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3684                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3685                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3686                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3687                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3688                 88  CO-OVRD-MEAN               VALUE '8'.
  3689                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3690
  3691             20  CF-CO-BEN-I-G-CD           PIC X.
  3692                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3693                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3694                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3695
  3696         16  FILLER                         PIC X(304).
  3697
  3698
  3699****************************************************************
  3700*             CARRIER MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  70
* EL1278.cbl
  3701****************************************************************
  3702
  3703     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3704         16  CF-ADDRESS-DATA.
  3705             20  CF-MAIL-TO-NAME            PIC X(30).
  3706             20  CF-IN-CARE-OF              PIC X(30).
  3707             20  CF-ADDRESS-LINE-1          PIC X(30).
  3708             20  CF-ADDRESS-LINE-2          PIC X(30).
  3709             20  CF-CITY-STATE              PIC X(30).
  3710             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3711             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3712
  3713         16  CF-CLAIM-NO-CONTROL.
  3714             20  CF-CLAIM-NO-METHOD         PIC X.
  3715                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3716                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3717                 88  CLAIM-NO-SEQ               VALUE '3'.
  3718                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3719             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3720                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3721                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3722                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3723
  3724         16  CF-CHECK-NO-CONTROL.
  3725             20  CF-CHECK-NO-METHOD         PIC X.
  3726                 88  CHECK-NO-MANUAL            VALUE '1'.
  3727                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3728                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3729                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3730             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3731                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3732
  3733         16  CF-DOMICILE-STATE              PIC XX.
  3734
  3735         16  CF-EXPENSE-CONTROLS.
  3736             20  CF-EXPENSE-METHOD          PIC X.
  3737                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3738                 88  DOLLARS-PER-PMT            VALUE '2'.
  3739                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3740                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3741             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3742             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3743
  3744         16  CF-CORRESPONDENCE-CONTROL.
  3745             20  CF-LETTER-RESEND-OPT       PIC X.
  3746                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3747                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3748             20  FILLER                     PIC X(4).
  3749
  3750         16  CF-RESERVE-CONTROLS.
  3751             20  CF-MANUAL-SW               PIC X.
  3752                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3753             20  CF-FUTURE-SW               PIC X.
  3754                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3755             20  CF-PTC-SW                  PIC X.
  3756                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3757             20  CF-IBNR-SW                 PIC X.
  3758                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  71
* EL1278.cbl
  3759             20  CF-PTC-LF-SW               PIC X.
  3760                 88  CF-LF-PTC-USED             VALUE '1'.
  3761             20  CF-CDT-ACCESS-METHOD       PIC X.
  3762                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3763                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3764                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3765             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3766
  3767         16  CF-CLAIM-CALC-METHOD           PIC X.
  3768             88  360-PLUS-MONTHS                VALUE '1'.
  3769             88  365-PLUS-MONTHS                VALUE '2'.
  3770             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3771             88  360-DAILY                      VALUE '4'.
  3772             88  365-DAILY                      VALUE '5'.
  3773
  3774         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3775         16  FILLER                         PIC X(11).
  3776
  3777         16  CF-LIMIT-AMOUNTS.
  3778             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3779             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3780             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3781             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3782             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3783             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3784             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3785             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3786             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3787             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3788
  3789         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3790         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3791         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3792
  3793         16  CF-ZIP-CODE.
  3794             20  CF-ZIP-PRIME.
  3795                 24  CF-ZIP-1ST             PIC X.
  3796                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3797                 24  FILLER                 PIC X(4).
  3798             20  CF-ZIP-PLUS4               PIC X(4).
  3799         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3800             20  CF-CAN-POSTAL-1            PIC XXX.
  3801             20  CF-CAN-POSTAL-2            PIC XXX.
  3802             20  FILLER                     PIC XXX.
  3803
  3804         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3805         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3806         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3807
  3808         16  CF-RATING-SWITCH               PIC X.
  3809             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3810             88  CF-NO-RATING                   VALUE 'N'.
  3811
  3812         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3813
  3814         16  CF-CARRIER-OVER-SHORT.
  3815             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3816             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  72
* EL1278.cbl
  3817
  3818         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3819         16  CF-SECPAY-SWITCH               PIC X.
  3820             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3821             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3822         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3823         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3824         16  FILLER                         PIC X(444).
  3825*        16  FILLER                         PIC X(452).
  3826
  3827
  3828****************************************************************
  3829*             MORTALITY MASTER RECORD                          *
  3830****************************************************************
  3831
  3832     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3833         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3834                                INDEXED BY CF-MORT-NDX.
  3835             20  CF-MORT-TABLE              PIC X(5).
  3836             20  CF-MORT-TABLE-TYPE         PIC X.
  3837                 88  CF-MORT-JOINT              VALUE 'J'.
  3838                 88  CF-MORT-SINGLE             VALUE 'S'.
  3839                 88  CF-MORT-COMBINED           VALUE 'C'.
  3840                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3841                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3842             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3843             20  CF-MORT-AGE-METHOD         PIC XX.
  3844                 88  CF-AGE-LAST                VALUE 'AL'.
  3845                 88  CF-AGE-NEAR                VALUE 'AN'.
  3846             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3847             20  CF-MORT-ADJUSTMENT-DIRECTION
  3848                                            PIC X.
  3849                 88  CF-MINUS                   VALUE '-'.
  3850                 88  CF-PLUS                    VALUE '+'.
  3851             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3852             20  CF-MORT-JOINT-CODE         PIC X.
  3853                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3854             20  CF-MORT-PC-Q               PIC X.
  3855                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3856             20  CF-MORT-TABLE-CODE         PIC X(4).
  3857             20  CF-MORT-COMMENTS           PIC X(15).
  3858             20  FILLER                     PIC X(14).
  3859
  3860         16  FILLER                         PIC X(251).
  3861
  3862
  3863****************************************************************
  3864*             BUSSINESS TYPE MASTER RECORD                     *
  3865****************************************************************
  3866
  3867     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3868* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3869* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3870* AND RECORD 05 IS TYPES 81-99
  3871         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3872             20  CF-BUSINESS-TITLE          PIC  X(19).
  3873             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3874                                            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  73
* EL1278.cbl
  3875             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3876             20  FILLER                     PIC  X.
  3877         16  FILLER                         PIC  X(248).
  3878
  3879
  3880****************************************************************
  3881*             TERMINAL MASTER RECORD                           *
  3882****************************************************************
  3883
  3884     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3885
  3886         16  CF-COMPANY-TERMINALS.
  3887             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3888                                  PIC X(4).
  3889         16  FILLER               PIC X(248).
  3890
  3891
  3892****************************************************************
  3893*             LIFE EDIT MASTER RECORD                          *
  3894****************************************************************
  3895
  3896     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3897         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3898             20  CF-LIFE-CODE-IN            PIC XX.
  3899             20  CF-LIFE-CODE-OUT           PIC XX.
  3900         16  FILLER                         PIC X(248).
  3901
  3902
  3903****************************************************************
  3904*             AH EDIT MASTER RECORD                            *
  3905****************************************************************
  3906
  3907     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3908         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3909             20  CF-AH-CODE-IN              PIC XXX.
  3910             20  CF-AH-CODE-OUT             PIC XX.
  3911         16  FILLER                         PIC X(248).
  3912
  3913
  3914****************************************************************
  3915*             CREDIBILITY TABLES                               *
  3916****************************************************************
  3917
  3918     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3919         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3920                             INDEXED BY CF-CRDB-NDX.
  3921             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3922             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3923             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3924         16  FILLER                         PIC  X(332).
  3925
  3926
  3927****************************************************************
  3928*             REPORT CUSTOMIZATION RECORD                      *
  3929****************************************************************
  3930
  3931     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3932         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  74
* EL1278.cbl
  3933             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3934             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3935             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3936**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3937****       A T-TRANSFER.                                   ****
  3938             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3939
  3940         16  FILLER                         PIC XX.
  3941
  3942         16  CF-CARRIER-CNTL-OPT.
  3943             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3944                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3945                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3946             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3947                                            PIC X.
  3948         16  CF-GROUP-CNTL-OPT.
  3949             20  CF-GROUP-OPT-SEQ           PIC 9.
  3950                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3951                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3952             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3953                                            PIC X(6).
  3954         16  CF-STATE-CNTL-OPT.
  3955             20  CF-STATE-OPT-SEQ           PIC 9.
  3956                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3957                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3958             20  CF-STATE-SELECT OCCURS 3 TIMES
  3959                                            PIC XX.
  3960         16  CF-ACCOUNT-CNTL-OPT.
  3961             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3962                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3963                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3964             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3965                                            PIC X(10).
  3966         16  CF-BUS-TYP-CNTL-OPT.
  3967             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3968                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3969                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3970             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3971                                            PIC XX.
  3972         16  CF-LF-TYP-CNTL-OPT.
  3973             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3974                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3975                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3976             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3977                                            PIC XX.
  3978         16  CF-AH-TYP-CNTL-OPT.
  3979             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3980                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3981                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3982             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3983                                            PIC XX.
  3984         16  CF-REPTCD1-CNTL-OPT.
  3985             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3986                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3987                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3988             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3989                                            PIC X(10).
  3990         16  CF-REPTCD2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  75
* EL1278.cbl
  3991             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3992                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3993                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3994             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3995                                            PIC X(10).
  3996         16  CF-USER1-CNTL-OPT.
  3997             20  CF-USER1-OPT-SEQ           PIC 9.
  3998                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3999                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4000             20  CF-USER1-SELECT OCCURS 3 TIMES
  4001                                            PIC X(10).
  4002         16  CF-USER2-CNTL-OPT.
  4003             20  CF-USER2-OPT-SEQ           PIC 9.
  4004                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4005                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4006             20  CF-USER2-SELECT OCCURS 3 TIMES
  4007                                            PIC X(10).
  4008         16  CF-USER3-CNTL-OPT.
  4009             20  CF-USER3-OPT-SEQ           PIC 9.
  4010                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4011                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4012             20  CF-USER3-SELECT OCCURS 3 TIMES
  4013                                            PIC X(10).
  4014         16  CF-USER4-CNTL-OPT.
  4015             20  CF-USER4-OPT-SEQ           PIC 9.
  4016                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4017                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4018             20  CF-USER4-SELECT OCCURS 3 TIMES
  4019                                            PIC X(10).
  4020         16  CF-USER5-CNTL-OPT.
  4021             20  CF-USER5-OPT-SEQ           PIC 9.
  4022                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4023                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4024             20  CF-USER5-SELECT OCCURS 3 TIMES
  4025                                            PIC X(10).
  4026         16  CF-REINS-CNTL-OPT.
  4027             20  CF-REINS-OPT-SEQ           PIC 9.
  4028                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4029                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4030             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4031                 24  CF-REINS-PRIME         PIC XXX.
  4032                 24  CF-REINS-SUB           PIC XXX.
  4033
  4034         16  CF-AGENT-CNTL-OPT.
  4035             20  CF-AGENT-OPT-SEQ           PIC 9.
  4036                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4037                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4038             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4039                                            PIC X(10).
  4040
  4041         16  FILLER                         PIC X(43).
  4042
  4043         16  CF-LOSS-RATIO-SELECT.
  4044             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4045             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4046         16  CF-ENTRY-DATE-SELECT.
  4047             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4048             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  76
* EL1278.cbl
  4049         16  CF-EFFECTIVE-DATE-SELECT.
  4050             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4051             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4052
  4053         16  CF-EXCEPTION-LIST-IND          PIC X.
  4054             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4055
  4056         16  FILLER                         PIC X(318).
  4057
  4058****************************************************************
  4059*                  EXCEPTION REPORTING RECORD                  *
  4060****************************************************************
  4061
  4062     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4063         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4064             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4065
  4066         16  CF-COMBINED-LIFE-AH-OPT.
  4067             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4068             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4069             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4070             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4071
  4072         16  CF-LIFE-OPT.
  4073             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4074             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4075             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4076             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4077             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4078             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4079             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4080             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4081             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4082             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4083
  4084         16  CF-AH-OPT.
  4085             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4086             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4087             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4088             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4089             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4090             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4091             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4092             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4093             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4094             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4095
  4096         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4097             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4098             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4099             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4100
  4101         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4102
  4103         16  FILLER                         PIC X(673).
  4104
  4105
  4106****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  77
* EL1278.cbl
  4107*             MORTGAGE SYSTEM PLAN RECORD                      *
  4108****************************************************************
  4109
  4110     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4111         16  CF-PLAN-TYPE                   PIC X.
  4112             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4113             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4114             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4115         16  CF-PLAN-ABBREV                 PIC XXX.
  4116         16  CF-PLAN-DESCRIPT               PIC X(10).
  4117         16  CF-PLAN-NOTES                  PIC X(20).
  4118         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4119         16  CF-PLAN-UNDERWRITING.
  4120             20  CF-PLAN-TERM-DATA.
  4121                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4122                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4123             20  CF-PLAN-AGE-DATA.
  4124                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4125                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4126                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4127             20  CF-PLAN-BENEFIT-DATA.
  4128                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4129                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4130                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4131                                            PIC S9(7)V99  COMP-3.
  4132         16  CF-PLAN-POLICY-FORMS.
  4133             20  CF-POLICY-FORM             PIC X(12).
  4134             20  CF-MASTER-APPLICATION      PIC X(12).
  4135             20  CF-MASTER-POLICY           PIC X(12).
  4136         16  CF-PLAN-RATING.
  4137             20  CF-RATE-CODE               PIC X(5).
  4138             20  CF-SEX-RATING              PIC X.
  4139                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4140                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4141             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4142             20  CF-SUB-STD-TYPE            PIC X.
  4143                 88  CF-PCT-OF-PREM            VALUE '1'.
  4144                 88  CF-PCT-OF-BENE            VALUE '2'.
  4145         16  CF-PLAN-PREM-TOLERANCES.
  4146             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4147             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4148         16  CF-PLAN-PYMT-TOLERANCES.
  4149             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4150             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4151         16  CF-PLAN-MISC-DATA.
  4152             20  FILLER                     PIC X.
  4153             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4154             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4155         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4156         16  CF-PLAN-IND-GRP                PIC X.
  4157             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4158                                                     '1'.
  4159             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4160                                                     '2'.
  4161         16  CF-MIB-SEARCH-SW               PIC X.
  4162             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4163             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4164             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  78
* EL1278.cbl
  4165             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4166         16  CF-ALPHA-SEARCH-SW             PIC X.
  4167             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4168             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4169             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4170             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4171             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4172             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4173             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4174             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4175             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4176             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4177                                                     'A' 'B' 'C'
  4178                                                     'X' 'Y' 'Z'.
  4179         16  CF-EFF-DT-RULE-SW              PIC X.
  4180             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4181             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4182             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4183             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4184             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4185         16  FILLER                         PIC X(4).
  4186         16  CF-HEALTH-QUESTIONS            PIC X.
  4187             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4188         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4189         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4190         16  CF-PLAN-SNGL-JNT               PIC X.
  4191             88  CF-COMBINED-PLAN              VALUE 'C'.
  4192             88  CF-JNT-PLAN                   VALUE 'J'.
  4193             88  CF-SNGL-PLAN                  VALUE 'S'.
  4194         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4195         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4196         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4197         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4198         16  CF-RERATE-CNTL                 PIC  X.
  4199             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4200             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4201             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4202             88  CF-AUTO-RECALC                 VALUE '4'.
  4203         16  CF-BENEFIT-TYPE                PIC  X.
  4204             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4205             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4206         16  CF-POLICY-FEE                  PIC S999V99
  4207                                                    COMP-3.
  4208         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4209         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4210         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4211         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4212         16  FILLER                         PIC  X(32).
  4213         16  CF-TERMINATION-FORM            PIC  X(04).
  4214         16  FILLER                         PIC  X(08).
  4215         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4216                                                       COMP-3.
  4217         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4218         16  CF-ISSUE-LETTER                PIC  X(4).
  4219         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4220         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4221             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4222             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  79
* EL1278.cbl
  4223         16  CF-MP-REFUND-CALC              PIC X.
  4224             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4225             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4226             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4227             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4228             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4229             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4230             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4231             88  CF-MP-REFD-MEAN                VALUE '8'.
  4232         16  CF-ALT-RATE-CODE               PIC  X(5).
  4233
  4234
  4235         16  FILLER                         PIC X(498).
  4236****************************************************************
  4237*             MORTGAGE COMPANY MASTER RECORD                   *
  4238****************************************************************
  4239
  4240     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4241         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4242         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4243             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4244             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4245             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4246             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4247             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4248
  4249         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4250         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4251         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4252         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4253         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4254
  4255         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4256             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4257         16  CF-MP-RECON-USE-IND            PIC X(1).
  4258             88  CF-MP-USE-RECON             VALUE 'Y'.
  4259         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4260             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4261         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4262             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4263             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4264         16  FILLER                         PIC X(1).
  4265         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4266             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4267         16  CF-MORTG-MIB-VERSION           PIC X.
  4268             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4269             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4270             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4271         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4272             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4273                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4274             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4275                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4276             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4277                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4278             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4279                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4280             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  80
* EL1278.cbl
  4281                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4282             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4283                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4284         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4285         16  FILLER                         PIC X(7).
  4286         16  CF-MORTG-DESTINATION-SYMBOL.
  4287             20  CF-MORTG-MIB-COMM          PIC X(5).
  4288             20  CF-MORTG-MIB-TERM          PIC X(5).
  4289         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4290             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4291         16  FILLER                         PIC X(03).
  4292         16  CF-MP-CHECK-NO-CONTROL.
  4293             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4294                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4295                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4296                                                ' ' LOW-VALUES.
  4297                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4298                                               VALUE '3'.
  4299         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4300         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4301         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4302             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4303                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4304             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4305                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4306             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4307                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4308             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4309                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4310             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4311                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4312             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4313                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4314         16  CF-MORTG-BILLING-AREA.
  4315             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4316                                            PIC X.
  4317         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4318         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4319         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4320         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4321             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4322             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4323         16  FILLER                         PIC X.
  4324         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4325             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4326             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4327         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4328         16  FILLER                         PIC X(8).
  4329         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4330         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4331         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4332         16  CF-ACH-COMPANY-ID.
  4333             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4334                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4335                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4336                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4337             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4338         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  81
* EL1278.cbl
  4339             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4340         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4341             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4342             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4343         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4344         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4345         16  FILLER                         PIC X(536).
  4346
  4347****************************************************************
  4348*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4349****************************************************************
  4350
  4351     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4352         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4353             20  CF-FEMALE-HEIGHT.
  4354                 24  CF-FEMALE-FT           PIC 99.
  4355                 24  CF-FEMALE-IN           PIC 99.
  4356             20  CF-FEMALE-MIN-WT           PIC 999.
  4357             20  CF-FEMALE-MAX-WT           PIC 999.
  4358         16  FILLER                         PIC X(428).
  4359
  4360     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4361         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4362             20  CF-MALE-HEIGHT.
  4363                 24  CF-MALE-FT             PIC 99.
  4364                 24  CF-MALE-IN             PIC 99.
  4365             20  CF-MALE-MIN-WT             PIC 999.
  4366             20  CF-MALE-MAX-WT             PIC 999.
  4367         16  FILLER                         PIC X(428).
  4368******************************************************************
  4369*             AUTOMATIC ACTIVITY RECORD                          *
  4370******************************************************************
  4371     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4372         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4373             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4374             20  CF-SYS-LETTER-ID           PIC X(04).
  4375             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4376             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4377             20  CF-SYS-RESET-SW            PIC X(01).
  4378             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4379             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4380
  4381         16  FILLER                         PIC X(50).
  4382
  4383         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4384             20  CF-USER-ACTIVE-SW          PIC X(01).
  4385             20  CF-USER-LETTER-ID          PIC X(04).
  4386             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4387             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4388             20  CF-USER-RESET-SW           PIC X(01).
  4389             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4390             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4391             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4392
  4393         16  FILLER                         PIC X(246).
  4394*                            COPY ERCACCT.
  4395******************************************************************
  4396*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  82
* EL1278.cbl
  4397*                                                                *
  4398*                            ERCACCT                             *
  4399*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4400*                            VMOD=2.031                          *
  4401*                                                                *
  4402*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4403*                                                                *
  4404*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4405*   VSAM ACCOUNT MASTER FILES.                                   *
  4406*                                                                *
  4407*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4408*                                                                *
  4409*   FILE TYPE = VSAM,KSDS                                        *
  4410*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4411*                                                                *
  4412*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4413*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4414*                                                                *
  4415*   LOG = NO                                                     *
  4416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4417*                                                                *
  4418*                                                                *
  4419******************************************************************
  4420*                   C H A N G E   L O G
  4421*
  4422* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4423*-----------------------------------------------------------------
  4424*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4425* EFFECTIVE    NUMBER
  4426*-----------------------------------------------------------------
  4427* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4428* 092705    2005050300006  PEMA  ADD SPP LEASES
  4429* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4430* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4431* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4432* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4433* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4434* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  4435******************************************************************
  4436
  4437 01  ACCOUNT-MASTER.
  4438     12  AM-RECORD-ID                      PIC XX.
  4439         88  VALID-AM-ID                      VALUE 'AM'.
  4440
  4441     12  AM-CONTROL-PRIMARY.
  4442         16  AM-COMPANY-CD                 PIC X.
  4443         16  AM-MSTR-CNTRL.
  4444             20  AM-CONTROL-A.
  4445                 24  AM-CARRIER            PIC X.
  4446                 24  AM-GROUPING.
  4447                     28 AM-GROUPING-PREFIX PIC XXX.
  4448                     28 AM-GROUPING-PRIME  PIC XXX.
  4449                 24  AM-STATE              PIC XX.
  4450                 24  AM-ACCOUNT.
  4451                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4452                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4453             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4454                                           PIC X(19).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  83
* EL1278.cbl
  4455             20  AM-CNTRL-B.
  4456                 24  AM-EXPIRATION-DT      PIC XX.
  4457                 24  FILLER                PIC X(4).
  4458             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4459                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4460
  4461     12  AM-CONTROL-BY-VAR-GRP.
  4462         16  AM-COMPANY-CD-A1              PIC X.
  4463         16  AM-VG-CARRIER                 PIC X.
  4464         16  AM-VG-GROUPING                PIC X(6).
  4465         16  AM-VG-STATE                   PIC XX.
  4466         16  AM-VG-ACCOUNT                 PIC X(10).
  4467         16  AM-VG-DATE.
  4468             20  AM-VG-EXPIRATION-DT       PIC XX.
  4469             20  FILLER                    PIC X(4).
  4470         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4471                                           PIC 9(11)      COMP-3.
  4472     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4473         16  FILLER                        PIC X(10).
  4474         16  AM-VG-KEY3.
  4475             20  AM-VG3-ACCOUNT            PIC X(10).
  4476             20  AM-VG3-EXP-DT             PIC XX.
  4477         16  FILLER                        PIC X(4).
  4478     12  AM-MAINT-INFORMATION.
  4479         16  AM-LAST-MAINT-DT              PIC XX.
  4480         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4481         16  AM-LAST-MAINT-USER            PIC X(4).
  4482         16  FILLER                        PIC XX.
  4483
  4484     12  AM-EFFECTIVE-DT                   PIC XX.
  4485     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4486
  4487     12  AM-PREV-DATES  COMP-3.
  4488         16  AM-PREV-EXP-DT                PIC 9(11).
  4489         16  AM-PREV-EFF-DT                PIC 9(11).
  4490
  4491     12  AM-REPORT-CODE-1                  PIC X(10).
  4492     12  AM-REPORT-CODE-2                  PIC X(10).
  4493
  4494     12  AM-CITY-CODE                      PIC X(4).
  4495     12  AM-COUNTY-PARISH                  PIC X(6).
  4496
  4497     12  AM-NAME                           PIC X(30).
  4498     12  AM-PERSON                         PIC X(30).
  4499     12  AM-ADDRS                          PIC X(30).
  4500     12  AM-CITY.
  4501         16  AM-ADDR-CITY                  PIC X(28).
  4502         16  AM-ADDR-STATE                 PIC XX.
  4503     12  AM-ZIP.
  4504         16  AM-ZIP-PRIME.
  4505             20  AM-ZIP-PRI-1ST            PIC X.
  4506                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4507             20  FILLER                    PIC X(4).
  4508         16  AM-ZIP-PLUS4                  PIC X(4).
  4509     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4510         16  AM-CAN-POSTAL-1               PIC XXX.
  4511         16  AM-CAN-POSTAL-2               PIC XXX.
  4512         16  FILLER                        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  84
* EL1278.cbl
  4513     12  AM-TEL-NO.
  4514         16  AM-AREA-CODE                  PIC 999.
  4515         16  AM-TEL-PRE                    PIC 999.
  4516         16  AM-TEL-NBR                    PIC 9(4).
  4517     12  AM-TEL-LOC                        PIC X.
  4518         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4519         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4520
  4521     12  AM-COMM-STRUCTURE.
  4522         16  AM-DEFN-1.
  4523             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4524                 24  AM-AGT.
  4525                     28  AM-AGT-PREFIX     PIC X(4).
  4526                     28  AM-AGT-PRIME      PIC X(6).
  4527                 24  AM-COM-TYP            PIC X.
  4528                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4529                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4530                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4531                 24  AM-RECALC-LV-INDIC    PIC X.
  4532                 24  AM-RETRO-LV-INDIC     PIC X.
  4533                 24  AM-GL-CODES           PIC X.
  4534                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4535                 24  FILLER                PIC X(01).
  4536         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4537             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4538                 24  FILLER                PIC X(11).
  4539                 24  AM-L-COMA             PIC XXX.
  4540                 24  AM-J-COMA             PIC XXX.
  4541                 24  AM-A-COMA             PIC XXX.
  4542                 24  FILLER                PIC X(6).
  4543
  4544     12  AM-COMM-CHANGE-STATUS             PIC X.
  4545         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4546
  4547     12  AM-CSR-CODE                       PIC X(4).
  4548
  4549     12  AM-BILLING-STATUS                 PIC X.
  4550         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4551         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4552     12  AM-AUTO-REFUND-SW                 PIC X.
  4553         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4554         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4555     12  AM-GPCD                           PIC 99.
  4556     12  AM-IG                             PIC X.
  4557         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4558         88  AM-HAS-GROUP                     VALUE '2'.
  4559     12  AM-STATUS                         PIC X.
  4560         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4561         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4562         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4563         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4564         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4565         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4566         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  4567         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  4568         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  4569         88  AM-ACCOUNT-PENDING               VALUE '9'.
  4570     12  AM-REMIT-TO                       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  85
* EL1278.cbl
  4571     12  AM-ID-NO                          PIC X(11).
  4572
  4573     12  AM-CAL-TABLE                      PIC XX.
  4574     12  AM-LF-DEVIATION                   PIC XXX.
  4575     12  AM-AH-DEVIATION                   PIC XXX.
  4576     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4577     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4578     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4579     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4580     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4581     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4582
  4583     12  AM-USER-FIELDS.
  4584         16  AM-FLD-1                      PIC XX.
  4585         16  AM-FLD-2                      PIC XX.
  4586         16  AM-FLD-3                      PIC XX.
  4587         16  AM-FLD-4                      PIC XX.
  4588         16  AM-FLD-5                      PIC XX.
  4589
  4590     12  AM-1ST-PROD-DATE.
  4591         16  AM-1ST-PROD-YR                PIC XX.
  4592         16  AM-1ST-PROD-MO                PIC XX.
  4593         16  AM-1ST-PROD-DA                PIC XX.
  4594     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4595     12  AM-CERTS-PURGED-DATE.
  4596         16  AM-PUR-YR                     PIC XX.
  4597         16  AM-PUR-MO                     PIC XX.
  4598         16  AM-PUR-DA                     PIC XX.
  4599     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4600     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4601     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4602     12  AM-INACTIVE-DATE.
  4603         16  AM-INA-MO                     PIC 99.
  4604         16  AM-INA-DA                     PIC 99.
  4605         16  AM-INA-YR                     PIC 99.
  4606     12  AM-AR-HI-CERT-DATE                PIC XX.
  4607
  4608     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4609     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4610
  4611     12  AM-OB-PAYMENT-MODE                PIC X.
  4612         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4613         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4614         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4615         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4616
  4617     12  AM-AH-ONLY-INDICATOR              PIC X.
  4618         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4619         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4620
  4621     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4622
  4623     12  AM-OVER-SHORT.
  4624         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4625         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4626
  4627     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4628     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  86
* EL1278.cbl
  4629
  4630     12  AM-RECALC-COMM                    PIC X.
  4631     12  AM-RECALC-REIN                    PIC X.
  4632
  4633     12  AM-REI-TABLE                      PIC XXX.
  4634     12  AM-REI-ET-LF                      PIC X.
  4635     12  AM-REI-ET-AH                      PIC X.
  4636     12  AM-REI-PE-LF                      PIC X.
  4637     12  AM-REI-PE-AH                      PIC X.
  4638     12  AM-REI-PRT-ST                     PIC X.
  4639     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4640     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4641     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4642     12  AM-REI-GROUP-A                    PIC X(6).
  4643     12  AM-REI-MORT                       PIC X(4).
  4644     12  AM-REI-PRT-OW                     PIC X.
  4645     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4646     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4647     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4648     12  AM-REI-GROUP-B                    PIC X(6).
  4649
  4650     12  AM-TRUST-TYPE                     PIC X(2).
  4651
  4652     12  AM-EMPLOYER-STMT-USED             PIC X.
  4653     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4654
  4655     12  AM-STD-AH-TYPE                    PIC XX.
  4656     12  AM-EARN-METHODS.
  4657         16  AM-EARN-METHOD-R              PIC X.
  4658             88 AM-REF-RL-R78                 VALUE 'R'.
  4659             88 AM-REF-RL-PR                  VALUE 'P'.
  4660             88 AM-REF-RL-MEAN                VALUE 'M'.
  4661             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4662         16  AM-EARN-METHOD-L              PIC X.
  4663             88 AM-REF-LL-R78                 VALUE 'R'.
  4664             88 AM-REF-LL-PR                  VALUE 'P'.
  4665             88 AM-REF-LL-MEAN                VALUE 'M'.
  4666             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4667         16  AM-EARN-METHOD-A              PIC X.
  4668             88 AM-REF-AH-R78                 VALUE 'R'.
  4669             88 AM-REF-AH-PR                  VALUE 'P'.
  4670             88 AM-REF-AH-MEAN                VALUE 'M'.
  4671             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4672             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4673             88 AM-REF-AH-NET                 VALUE 'N'.
  4674
  4675     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4676     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4677     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4678
  4679     12  AM-RET-Y-N                        PIC X.
  4680     12  AM-RET-P-E                        PIC X.
  4681     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4682     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4683     12  AM-RET-GRP                        PIC X(6).
  4684     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4685         16  AM-POOL-PRIME                 PIC XXX.
  4686         16  AM-POOL-SUB                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  87
* EL1278.cbl
  4687     12  AM-RETRO-EARNINGS.
  4688         16  AM-RET-EARN-R                 PIC X.
  4689         16  AM-RET-EARN-L                 PIC X.
  4690         16  AM-RET-EARN-A                 PIC X.
  4691     12  AM-RET-ST-TAX-USE                 PIC X.
  4692         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4693         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4694     12  AM-RETRO-BEG-EARNINGS.
  4695         16  AM-RET-BEG-EARN-R             PIC X.
  4696         16  AM-RET-BEG-EARN-L             PIC X.
  4697         16  AM-RET-BEG-EARN-A             PIC X.
  4698     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4699     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4700
  4701     12  AM-USER-SELECT-OPTIONS.
  4702         16  AM-USER-SELECT-1              PIC X(10).
  4703         16  AM-USER-SELECT-2              PIC X(10).
  4704         16  AM-USER-SELECT-3              PIC X(10).
  4705         16  AM-USER-SELECT-4              PIC X(10).
  4706         16  AM-USER-SELECT-5              PIC X(10).
  4707
  4708     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4709
  4710     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4711
  4712     12  AM-RPT045A-SWITCH                 PIC X.
  4713         88  RPT045A-OFF                   VALUE 'N'.
  4714
  4715     12  AM-INSURANCE-LIMITS.
  4716         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4717         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4718
  4719     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4720         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4721
  4722     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4723         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4724         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4725
  4726     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4727
  4728     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4729     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4730     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4731     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4732     12  AM-DCC-UEF-STATE                  PIC XX.
  4733     12  FILLER                            PIC XXX.
  4734     12  AM-REPORT-CODE-3                  PIC X(10).
  4735*    12  FILLER                            PIC X(22).
  4736
  4737     12  AM-RESERVE-DATE.
  4738         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4739         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4740         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4741
  4742     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4743     12  AM-NOTIFICATION-TYPES.
  4744         16  AM-NOTIF-OF-LETTERS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  88
* EL1278.cbl
  4745         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4746         16  AM-NOTIF-OF-REPORTS           PIC X.
  4747         16  AM-NOTIF-OF-STATUS            PIC X.
  4748
  4749     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4750         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4751         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4752         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4753         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4754
  4755     12  AM-BENEFIT-CONTROLS.
  4756         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4757             20  AM-BENEFIT-CODE           PIC XX.
  4758             20  AM-BENEFIT-TYPE           PIC X.
  4759             20  AM-BENEFIT-REVISION       PIC XXX.
  4760             20  AM-BENEFIT-REM-TERM       PIC X.
  4761             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4762             20  FILLER                    PIC XX.
  4763         16  FILLER                        PIC X(80).
  4764
  4765     12  AM-TRANSFER-DATA.
  4766         16  AM-TRANSFERRED-FROM.
  4767             20  AM-TRNFROM-CARRIER        PIC X.
  4768             20  AM-TRNFROM-GROUPING.
  4769                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4770                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4771             20  AM-TRNFROM-STATE          PIC XX.
  4772             20  AM-TRNFROM-ACCOUNT.
  4773                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4774                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4775             20  AM-TRNFROM-DTE            PIC XX.
  4776         16  AM-TRANSFERRED-TO.
  4777             20  AM-TRNTO-CARRIER          PIC X.
  4778             20  AM-TRNTO-GROUPING.
  4779                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4780                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4781             20  AM-TRNTO-STATE            PIC XX.
  4782             20  AM-TRNTO-ACCOUNT.
  4783                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4784                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4785             20  AM-TRNTO-DTE              PIC XX.
  4786         16  FILLER                        PIC X(10).
  4787
  4788     12  AM-SAVED-REMIT-TO                 PIC 99.
  4789
  4790     12  AM-COMM-STRUCTURE-SAVED.
  4791         16  AM-DEFN-1-SAVED.
  4792             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4793                 24  AM-AGT-SV             PIC X(10).
  4794                 24  AM-COM-TYP-SV         PIC X.
  4795                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4796                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4797                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4798                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4799                 24  FILLER                PIC X.
  4800                 24  AM-GL-CODES-SV        PIC X.
  4801                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4802                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  89
* EL1278.cbl
  4803         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4804             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4805                 24  FILLER                PIC X(11).
  4806                 24  AM-L-COMA-SV          PIC XXX.
  4807                 24  AM-J-COMA-SV          PIC XXX.
  4808                 24  AM-A-COMA-SV          PIC XXX.
  4809                 24  FILLER                PIC X(6).
  4810
  4811     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4812         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4813            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4814            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4815            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4816
  4817     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4818     12  FILLER                            PIC X(120).
  4819
  4820     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4821         16  AM-CONTROL-NAME               PIC X(30).
  4822         16  AM-EXECUTIVE-ONE.
  4823             20  AM-EXEC1-NAME             PIC X(15).
  4824             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4825                                                          COMP-3.
  4826             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4827                                                          COMP-3.
  4828         16  AM-EXECUTIVE-TWO.
  4829             20  AM-EXEC2-NAME             PIC X(15).
  4830             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4831                                                          COMP-3.
  4832             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4833                                                          COMP-3.
  4834
  4835     12  AM-RETRO-ADDITIONAL-DATA.
  4836         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4837         16  AM-RETRO-PREM-P-E             PIC X.
  4838         16  AM-RETRO-CLMS-P-I             PIC X.
  4839         16  AM-RETRO-RET-BRACKET-LF.
  4840             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4841                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4842                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4843             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4844                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4845                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4846             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4847                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4848                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4849         16  AM-RETRO-RET-BRACKET-AH.
  4850             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4851                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4852                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4853                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4854             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4855                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4856                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4857             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4858                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4859                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4860
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  90
* EL1278.cbl
  4861     12  AM-COMMENTS.
  4862         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4863
  4864     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4865         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4866         16  AM-FLI-BILLING-CODE           PIC X.
  4867         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4868         16  AM-FLI-UNITED-IDENT           PIC X.
  4869         16  AM-FLI-INTEREST-LOST-DATA.
  4870             20  AM-FLI-BANK-NO            PIC X(5).
  4871             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4872             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4873             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4874         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4875             20  AM-FLI-AGT                PIC X(9).
  4876             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4877             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4878         16  FILLER                        PIC X(102).
  4879
  4880     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4881         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4882             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4883             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4884             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4885             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4886             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4887         16  FILLER                          PIC X(10).
  4888******************************************************************
  4889*                            COPY ELCCERT.
  4890******************************************************************
  4891*                                                                *
  4892*                            ELCCERT.                            *
  4893*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4894*                            VMOD=2.013                          *
  4895*                                                                *
  4896*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4897*                                                                *
  4898*   FILE TYPE = VSAM,KSDS                                        *
  4899*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4900*                                                                *
  4901*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4902*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4903*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4904*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4905*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4906*                                                                *
  4907*   LOG = YES                                                    *
  4908*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4909******************************************************************
  4910*                   C H A N G E   L O G
  4911*
  4912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4913*-----------------------------------------------------------------
  4914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4915* EFFECTIVE    NUMBER
  4916*-----------------------------------------------------------------
  4917* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4918* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  91
* EL1278.cbl
  4919* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4920* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4921* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4922* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4923* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4924* 032612  CR2011110200001  PEMA  AHL CHANGES
  4925* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4926* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4927* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4928******************************************************************
  4929
  4930 01  CERTIFICATE-MASTER.
  4931     12  CM-RECORD-ID                      PIC XX.
  4932         88  VALID-CM-ID                      VALUE 'CM'.
  4933
  4934     12  CM-CONTROL-PRIMARY.
  4935         16  CM-COMPANY-CD                 PIC X.
  4936         16  CM-CARRIER                    PIC X.
  4937         16  CM-GROUPING.
  4938             20  CM-GROUPING-PREFIX        PIC X(3).
  4939             20  CM-GROUPING-PRIME         PIC X(3).
  4940         16  CM-STATE                      PIC XX.
  4941         16  CM-ACCOUNT.
  4942             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4943             20  CM-ACCOUNT-PRIME          PIC X(6).
  4944         16  CM-CERT-EFF-DT                PIC XX.
  4945         16  CM-CERT-NO.
  4946             20  CM-CERT-PRIME             PIC X(10).
  4947             20  CM-CERT-SFX               PIC X.
  4948
  4949     12  CM-CONTROL-BY-NAME.
  4950         16  CM-COMPANY-CD-A1              PIC X.
  4951         16  CM-INSURED-LAST-NAME          PIC X(15).
  4952         16  CM-INSURED-INITIALS.
  4953             20  CM-INSURED-INITIAL1       PIC X.
  4954             20  CM-INSURED-INITIAL2       PIC X.
  4955
  4956     12  CM-CONTROL-BY-SSN.
  4957         16  CM-COMPANY-CD-A2              PIC X.
  4958         16  CM-SOC-SEC-NO.
  4959             20  CM-SSN-STATE              PIC XX.
  4960             20  CM-SSN-ACCOUNT            PIC X(6).
  4961             20  CM-SSN-LN3.
  4962                 25  CM-INSURED-INITIALS-A2.
  4963                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4964                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4965                 25 CM-PART-LAST-NAME-A2         PIC X.
  4966
  4967     12  CM-CONTROL-BY-CERT-NO.
  4968         16  CM-COMPANY-CD-A4              PIC X.
  4969         16  CM-CERT-NO-A4                 PIC X(11).
  4970
  4971     12  CM-CONTROL-BY-MEMB.
  4972         16  CM-COMPANY-CD-A5              PIC X.
  4973         16  CM-MEMBER-NO.
  4974             20  CM-MEMB-STATE             PIC XX.
  4975             20  CM-MEMB-ACCOUNT           PIC X(6).
  4976             20  CM-MEMB-LN4.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  92
* EL1278.cbl
  4977                 25  CM-INSURED-INITIALS-A5.
  4978                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4979                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4980                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4981
  4982     12  CM-INSURED-PROFILE-DATA.
  4983         16  CM-INSURED-FIRST-NAME.
  4984             20  CM-INSURED-1ST-INIT       PIC X.
  4985             20  FILLER                    PIC X(9).
  4986         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4987         16  CM-INSURED-SEX                PIC X.
  4988             88  CM-SEX-MALE                  VALUE 'M'.
  4989             88  CM-SEX-FEMAL                 VALUE 'F'.
  4990         16  CM-INSURED-JOINT-AGE          PIC 99.
  4991         16  CM-JOINT-INSURED-NAME.
  4992             20  CM-JT-LAST-NAME           PIC X(15).
  4993             20  CM-JT-FIRST-NAME.
  4994                 24  CM-JT-1ST-INIT        PIC X.
  4995                 24  FILLER                PIC X(9).
  4996             20  CM-JT-INITIAL             PIC X.
  4997
  4998     12  CM-LIFE-DATA.
  4999         16  CM-LF-BENEFIT-CD              PIC XX.
  5000         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5001         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5002         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5003         16  CM-LF-DEV-CODE                PIC XXX.
  5004         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5005         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5006         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5007         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5008         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5009         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5010         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5011         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5012         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5013         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5014         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5015         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5016         16  cm-temp-epiq                  pic xx.
  5017             88  EPIQ-CLASS                  value 'EQ'.
  5018*        16  FILLER                        PIC XX.
  5019
  5020     12  CM-AH-DATA.
  5021         16  CM-AH-BENEFIT-CD              PIC XX.
  5022         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5023         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5024         16  CM-AH-DEV-CODE                PIC XXX.
  5025         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5026         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5027         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5028         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5029         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5030         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5031         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5032         16  CM-AH-PAID-THRU-DT            PIC XX.
  5033             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5034         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  93
* EL1278.cbl
  5035         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5036         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5037         16  FILLER                        PIC X.
  5038
  5039     12  CM-LOAN-INFORMATION.
  5040         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5041         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5042                                           PIC S9(5)V99  COMP-3.
  5043         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5044         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5045         16  CM-PAY-FREQUENCY              PIC S99.
  5046         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5047         16  CM-RATE-CLASS                 PIC XX.
  5048         16  CM-BENEFICIARY                PIC X(25).
  5049         16  CM-POLICY-FORM-NO             PIC X(12).
  5050         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5051         16  CM-LAST-ADD-ON-DT             PIC XX.
  5052         16  CM-DEDUCTIBLE-AMOUNTS.
  5053             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5054             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5055         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5056             20  CM-RESIDENT-STATE         PIC XX.
  5057             20  CM-RATE-CODE              PIC X(4).
  5058             20  FILLER                    PIC XX.
  5059         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5060             20  CM-LOAN-OFFICER           PIC X(5).
  5061             20  FILLER                    PIC XXX.
  5062         16  CM-CSR-CODE                   PIC XXX.
  5063         16  CM-UNDERWRITING-CODE          PIC X.
  5064             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5065         16  CM-POST-CARD-IND              PIC X.
  5066         16  CM-REF-INTERFACE-SW           PIC X.
  5067         16  CM-PREMIUM-TYPE               PIC X.
  5068             88  CM-SING-PRM                  VALUE '1'.
  5069             88  CM-O-B-COVERAGE              VALUE '2'.
  5070             88  CM-OPEN-END                  VALUE '3'.
  5071         16  CM-IND-GRP-TYPE               PIC X.
  5072             88  CM-INDIVIDUAL                VALUE 'I'.
  5073             88  CM-GROUP                     VALUE 'G'.
  5074         16  CM-SKIP-CODE                  PIC X.
  5075             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5076             88  SKIP-JULY                    VALUE '1'.
  5077             88  SKIP-AUGUST                  VALUE '2'.
  5078             88  SKIP-SEPTEMBER               VALUE '3'.
  5079             88  SKIP-JULY-AUG                VALUE '4'.
  5080             88  SKIP-AUG-SEPT                VALUE '5'.
  5081             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5082             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5083             88  SKIP-JUNE                    VALUE '8'.
  5084             88  SKIP-JUNE-JULY               VALUE '9'.
  5085             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5086             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5087         16  CM-PAYMENT-MODE               PIC X.
  5088             88  PAY-MONTHLY                  VALUE SPACE.
  5089             88  PAY-WEEKLY                   VALUE '1'.
  5090             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5091             88  PAY-BI-WEEKLY                VALUE '3'.
  5092             88  PAY-SEMI-ANUALLY             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  94
* EL1278.cbl
  5093         16  CM-LOAN-NUMBER                PIC X(8).
  5094         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5095         16  CM-OLD-LOF                    PIC XXX.
  5096*        16  CM-LOAN-OFFICER               PIC XXX.
  5097         16  CM-REIN-TABLE                 PIC XXX.
  5098         16  CM-SPECIAL-REIN-CODE          PIC X.
  5099         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5100         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5101         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5102
  5103     12  CM-STATUS-DATA.
  5104         16  CM-ENTRY-STATUS               PIC X.
  5105         16  CM-ENTRY-DT                   PIC XX.
  5106
  5107         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5108         16  CM-LF-CANCEL-DT               PIC XX.
  5109         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5110
  5111         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5112         16  CM-LF-DEATH-DT                PIC XX.
  5113         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5114
  5115         16  CM-LF-CURRENT-STATUS          PIC X.
  5116             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5117                                                'M' '4' '5' '9'.
  5118             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5119             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5120             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5121             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5122             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5123             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5124             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5125             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5126             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5127             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5128             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5129             88  CM-LF-DECLINED               VALUE 'D'.
  5130             88  CM-LF-VOIDED                 VALUE 'V'.
  5131
  5132         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5133         16  CM-AH-CANCEL-DT               PIC XX.
  5134         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5135
  5136         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5137         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5138         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5139
  5140         16  CM-AH-CURRENT-STATUS          PIC X.
  5141             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5142                                                'M' '4' '5' '9'.
  5143             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5144             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5145             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5146             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5147             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5148             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5149             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5150             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  95
* EL1278.cbl
  5151             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5152             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5153             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5154             88  CM-AH-DECLINED               VALUE 'D'.
  5155             88  CM-AH-VOIDED                 VALUE 'V'.
  5156
  5157         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5158             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5159             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5160             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5161         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5162
  5163         16  CM-ENTRY-BATCH                PIC X(6).
  5164         16  CM-LF-EXIT-BATCH              PIC X(6).
  5165         16  CM-AH-EXIT-BATCH              PIC X(6).
  5166         16  CM-LAST-MONTH-END             PIC XX.
  5167
  5168     12  CM-NOTE-SW                        PIC X.
  5169         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5170         88  CERT-NOTES-PRESENT               VALUE '1'.
  5171         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5172         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5173         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5174         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5175         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5176         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5177     12  CM-COMP-EXCP-SW                   PIC X.
  5178         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5179         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5180     12  CM-INSURED-ADDRESS-SW             PIC X.
  5181         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5182         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5183
  5184*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5185     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5186     12  FILLER                            PIC X.
  5187
  5188*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5189     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5190     12  FILLER                            PIC X.
  5191*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5192     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5193
  5194     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5195         88  CERT-ADDED-BATCH                 VALUE ' '.
  5196         88  CERT-ADDED-ONLINE                VALUE '1'.
  5197         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5198         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5199         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5200     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5201         88  CERT-AS-LOADED                   VALUE ' '.
  5202         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5203         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5204         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5205         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5206         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5207         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5208         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  96
* EL1278.cbl
  5209
  5210     12  CM-ACCOUNT-COMM-PCTS.
  5211         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5212         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5213
  5214     12  CM-USER-FIELD                     PIC X.
  5215     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5216     12  CM-CLP-STATE                      PIC XX.
  5217     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5218     12  CM-USER-RESERVED                  PIC XXX.
  5219     12  FILLER REDEFINES CM-USER-RESERVED.
  5220         16  CM-AH-CLASS-CD                PIC XX.
  5221         16  F                             PIC X.
  5222******************************************************************
  5223*                            COPY ERCMAIL.
  5224******************************************************************
  5225*                                                                *
  5226*                                                                *
  5227*                            ERCMAIL                             *
  5228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5229*                            VMOD=2.003                          *
  5230*                                                                *
  5231*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5232*                                                                *
  5233*   FILE TYPE = VSAM,KSDS                                        *
  5234*   RECORD SIZE = 374   RECFORM = FIX                            *
  5235*                                                                *
  5236*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5237*   ALTERNATE PATH    = NOT USED                                 *
  5238*                                                                *
  5239*   LOG = YES                                                    *
  5240*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5241******************************************************************
  5242*                   C H A N G E   L O G
  5243*
  5244* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5245*-----------------------------------------------------------------
  5246*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5247* EFFECTIVE    NUMBER
  5248*-----------------------------------------------------------------
  5249* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5250* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5251* 111108                   PEMA  ADD CRED BENE ADDR2
  5252******************************************************************
  5253
  5254 01  MAILING-DATA.
  5255     12  MA-RECORD-ID                      PIC XX.
  5256         88  VALID-MA-ID                       VALUE 'MA'.
  5257
  5258     12  MA-CONTROL-PRIMARY.
  5259         16  MA-COMPANY-CD                 PIC X.
  5260         16  MA-CARRIER                    PIC X.
  5261         16  MA-GROUPING.
  5262             20  MA-GROUPING-PREFIX        PIC XXX.
  5263             20  MA-GROUPING-PRIME         PIC XXX.
  5264         16  MA-STATE                      PIC XX.
  5265         16  MA-ACCOUNT.
  5266             20  MA-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  97
* EL1278.cbl
  5267             20  MA-ACCOUNT-PRIME          PIC X(6).
  5268         16  MA-CERT-EFF-DT                PIC XX.
  5269         16  MA-CERT-NO.
  5270             20  MA-CERT-PRIME             PIC X(10).
  5271             20  MA-CERT-SFX               PIC X.
  5272
  5273     12  FILLER                            PIC XX.
  5274
  5275     12  MA-ACCESS-CONTROL.
  5276         16  MA-SOURCE-SYSTEM              PIC XX.
  5277             88  MA-FROM-CREDIT                VALUE 'CR'.
  5278             88  MA-FROM-VSI                   VALUE 'VS'.
  5279             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5280             88  MA-FROM-OTHER                 VALUE 'OT'.
  5281         16  MA-RECORD-ADD-DT              PIC XX.
  5282         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5283         16  MA-LAST-MAINT-DT              PIC XX.
  5284         16  MA-LAST-MAINT-BY              PIC XXXX.
  5285         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5286
  5287     12  MA-PROFILE-INFO.
  5288         16  MA-QUALIFY-CODE-1             PIC XX.
  5289         16  MA-QUALIFY-CODE-2             PIC XX.
  5290         16  MA-QUALIFY-CODE-3             PIC XX.
  5291         16  MA-QUALIFY-CODE-4             PIC XX.
  5292         16  MA-QUALIFY-CODE-5             PIC XX.
  5293
  5294         16  MA-INSURED-LAST-NAME          PIC X(15).
  5295         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5296         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5297         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5298         16  MA-INSURED-BIRTH-DT           PIC XX.
  5299         16  MA-INSURED-SEX                PIC X.
  5300             88  MA-SEX-MALE                   VALUE 'M'.
  5301             88  MA-SEX-FEMALE                 VALUE 'F'.
  5302         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5303
  5304         16  MA-ADDRESS-CORRECTED          PIC X.
  5305         16  MA-JOINT-BIRTH-DT             PIC XX.
  5306*        16  FILLER                        PIC X(12).
  5307
  5308         16  MA-ADDRESS-LINE-1             PIC X(30).
  5309         16  MA-ADDRESS-LINE-2             PIC X(30).
  5310         16  MA-CITY-STATE.
  5311             20  MA-CITY                   PIC X(28).
  5312             20  MA-ADDR-STATE             PIC XX.
  5313         16  MA-ZIP.
  5314             20  MA-ZIP-CODE.
  5315                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5316                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5317                 24  FILLER                PIC X(4).
  5318             20  MA-ZIP-PLUS4              PIC X(4).
  5319         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5320             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5321             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5322             20  FILLER                    PIC X(3).
  5323
  5324         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  98
* EL1278.cbl
  5325
  5326         16  FILLER                        PIC XXX.
  5327*        16  FILLER                        PIC X(10).
  5328
  5329     12  MA-CRED-BENE-INFO.
  5330         16  MA-CRED-BENE-NAME                 PIC X(25).
  5331         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5332         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5333         16  MA-CRED-BENE-CTYST.
  5334             20  MA-CRED-BENE-CITY             PIC X(28).
  5335             20  MA-CRED-BENE-STATE            PIC XX.
  5336         16  MA-CRED-BENE-ZIP.
  5337             20  MA-CB-ZIP-CODE.
  5338                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5339                     88  MA-CB-CANADIAN-POST-CODE
  5340                                           VALUE 'A' THRU 'Z'.
  5341                 24  FILLER                    PIC X(4).
  5342             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5343         16  MA-CB-CANADIAN-POSTAL-CODE
  5344                            REDEFINES MA-CRED-BENE-ZIP.
  5345             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5346             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5347             20  FILLER                        PIC X(3).
  5348     12  MA-POST-CARD-MAIL-DATA.
  5349         16  MA-MAIL-DATA OCCURS 7.
  5350             20  MA-MAIL-TYPE              PIC X.
  5351                 88  MA-12MO-MAILING           VALUE '1'.
  5352                 88  MA-EXP-MAILING            VALUE '2'.
  5353             20  MA-MAIL-STATUS            PIC X.
  5354                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5355                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5356                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5357             20  MA-MAIL-DATE              PIC XX.
  5358     12  FILLER                            PIC XX.
  5359     12  FILLER                            PIC XX.
  5360*    12  FILLER                            PIC X(30).
  5361******************************************************************
  5362*                            COPY ELCCRTO.
  5363******************************************************************
  5364*                                                                *
  5365*                            ELCCRTO.                            *
  5366*                                                                *
  5367*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5368*                                                                *
  5369*   FILE TYPE = VSAM,KSDS                                        *
  5370*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5371*                                                                *
  5372*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5373*                                                                *
  5374*   LOG = YES                                                    *
  5375*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5376******************************************************************
  5377*                   C H A N G E   L O G
  5378*
  5379* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5380*-----------------------------------------------------------------
  5381*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5382* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page  99
* EL1278.cbl
  5383*-----------------------------------------------------------------
  5384* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5385* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5386* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5387* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5388* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5389******************************************************************
  5390 01  ORIGINAL-CERTIFICATE.
  5391     12  OC-RECORD-ID                      PIC XX.
  5392         88  VALID-OC-ID                      VALUE 'OC'.
  5393     12  OC-CONTROL-PRIMARY.
  5394         16  OC-COMPANY-CD                 PIC X.
  5395         16  OC-CARRIER                    PIC X.
  5396         16  OC-GROUPING                   PIC X(6).
  5397         16  OC-STATE                      PIC XX.
  5398         16  OC-ACCOUNT                    PIC X(10).
  5399         16  OC-CERT-EFF-DT                PIC XX.
  5400         16  OC-CERT-NO.
  5401             20  OC-CERT-PRIME             PIC X(10).
  5402             20  OC-CERT-SFX               PIC X.
  5403         16  OC-RECORD-TYPE                PIC X.
  5404         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5405     12  OC-LAST-MAINT-DT                  PIC XX.
  5406     12  OC-LAST-MAINT-BY                  PIC X(4).
  5407     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5408     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5409     12  FILLER                            PIC X(49).
  5410     12  OC-ORIG-REC.
  5411         16  OC-INS-LAST-NAME              PIC X(15).
  5412         16  OC-INS-FIRST-NAME             PIC X(10).
  5413         16  OC-INS-MIDDLE-INIT            PIC X.
  5414         16  OC-INS-AGE                    PIC S999     COMP-3.
  5415         16  OC-JNT-LAST-NAME              PIC X(15).
  5416         16  OC-JNT-FIRST-NAME             PIC X(10).
  5417         16  OC-JNT-MIDDLE-INIT            PIC X.
  5418         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5419         16  OC-LF-BENCD                   PIC XX.
  5420         16  OC-LF-TERM                    PIC S999      COMP-3.
  5421         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5422         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5423         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5424         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5425         16  OC-LF-EXP-DT                  PIC XX.
  5426         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5427         16  OC-LF-CANCEL-DT               PIC XX.
  5428         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5429         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5430         16  OC-AH-BENCD                   PIC XX.
  5431         16  OC-AH-TERM                    PIC S999      COMP-3.
  5432         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5433         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5434         16  OC-AH-EXP-DT                  PIC XX.
  5435         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5436         16  OC-AH-CP                      PIC 99.
  5437         16  OC-AH-CANCEL-DT               PIC XX.
  5438         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5439         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5440         16  OC-CRED-BENE-NAME             PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 100
* EL1278.cbl
  5441         16  OC-1ST-PMT-DT                 PIC XX.
  5442         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5443         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5444         16  OC-ISSUE-TRAN-IND             PIC X.
  5445         16  OC-CANCEL-TRAN-IND            PIC X.
  5446         16  FILLER                        PIC X(211).
  5447
  5448     12  FILLER                            PIC X(50).
  5449******************************************************************
  5450*                            COPY ERCFORM.
  5451******************************************************************
  5452*                                                                *
  5453*                                                                *
  5454*                            ERCFORM.                            *
  5455*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5456*                            VMOD=2.003                          *
  5457*                                                                *
  5458*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5459*                                                                *
  5460*    FILE TYPE = VSAM,KSDS                                       *
  5461*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5462*                                                                *
  5463*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5464*                                                                *
  5465*    LOG = YES                                                   *
  5466*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5467******************************************************************
  5468 01  FORM-MASTER.
  5469    12  FO-RECORD-ID                 PIC X(02).
  5470        88  VALID-FO-ID                  VALUE 'FO'.
  5471
  5472    12  FO-CONTROL-PRIMARY.
  5473        16  FO-COMPANY-CD            PIC X(01).
  5474        16  FO-STATE                 PIC X(02).
  5475        16  FO-FORM-ID               PIC X(12).
  5476        16  FO-FORM-EXP-DT           PIC X(02).
  5477
  5478    12  FO-POLICY-FORM-DATA.
  5479        16  FO-IND-GRP-CD            PIC X(01).
  5480        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5481        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5482        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5483        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5484        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5485        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5486        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5487        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5488        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5489        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5490        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5491        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5492        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5493        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5494        16  FO-APP-CERT-USE-CD       PIC X(01).
  5495
  5496    12  FILLER                       PIC X(29).
  5497
  5498    12  FO-FORM-PLAN-TABLE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 101
* EL1278.cbl
  5499        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5500            20  FO-PLAN-TYPE         PIC X(01).
  5501            20  FO-PLAN-ID           PIC X(02).
  5502            20  FO-PLAN-TERM         PIC 9(03).
  5503            20  FO-PLAN-REFUND-METHOD
  5504                                     PIC X.
  5505
  5506    12  FILLER                       PIC X(30).
  5507
  5508    12  FO-COMMENTS-AREA.
  5509        16  FO-COMMENT-LINE-1        PIC X(78).
  5510
  5511    12  FILLER                       PIC X(20).
  5512
  5513    12  FO-MAINT-INFORMATION.
  5514        16  FO-LAST-MAINT-DT         PIC X(02).
  5515        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5516        16  FO-LAST-MAINT-BY         PIC X(04).
  5517*                            COPY ELCMSTR.
  5518******************************************************************
  5519*                                                                *
  5520*                            ELCMSTR.                            *
  5521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5522*                            VMOD=2.012                          *
  5523*                                                                *
  5524*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5525*                                                                *
  5526*   FILE TYPE = VSAM,KSDS                                        *
  5527*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5528*                                                                *
  5529*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5530*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5531*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5532*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5533*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5534*                                                 RKP=75,LEN=21  *
  5535*                                                                *
  5536*   **** NOTE ****                                               *
  5537*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5538*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5539*                                                                *
  5540*   LOG = YES                                                    *
  5541*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5542******************************************************************
  5543*                   C H A N G E   L O G
  5544*
  5545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5546*-----------------------------------------------------------------
  5547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5548* EFFECTIVE    NUMBER
  5549*-----------------------------------------------------------------
  5550* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5551* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5552* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  5553* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5554* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5555* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  5556* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 102
* EL1278.cbl
  5557******************************************************************
  5558 01  CLAIM-MASTER.
  5559     12  CL-RECORD-ID                PIC XX.
  5560         88  VALID-CL-ID         VALUE 'CL'.
  5561
  5562     12  CL-CONTROL-PRIMARY.
  5563         16  CL-COMPANY-CD           PIC X.
  5564         16  CL-CARRIER              PIC X.
  5565         16  CL-CLAIM-NO             PIC X(7).
  5566         16  CL-CERT-NO.
  5567             20  CL-CERT-PRIME       PIC X(10).
  5568             20  CL-CERT-SFX         PIC X.
  5569
  5570     12  CL-CONTROL-BY-NAME.
  5571         16  CL-COMPANY-CD-A1        PIC X.
  5572         16  CL-INSURED-LAST-NAME    PIC X(15).
  5573         16  CL-INSURED-NAME.
  5574             20  CL-INSURED-1ST-NAME PIC X(12).
  5575             20  CL-INSURED-MID-INIT PIC X.
  5576
  5577     12  CL-CONTROL-BY-SSN.
  5578         16  CL-COMPANY-CD-A2        PIC X.
  5579         16  CL-SOC-SEC-NO.
  5580             20  CL-SSN-STATE        PIC XX.
  5581             20  CL-SSN-ACCOUNT      PIC X(6).
  5582             20  CL-SSN-LN3          PIC X(3).
  5583
  5584     12  CL-CONTROL-BY-CERT-NO.
  5585         16  CL-COMPANY-CD-A4        PIC X.
  5586         16  CL-CERT-NO-A4.
  5587             20  CL-CERT-A4-PRIME    PIC X(10).
  5588             20  CL-CERT-A4-SFX      PIC X.
  5589
  5590     12  CL-CONTROL-BY-CCN.
  5591         16  CL-COMPANY-CD-A5        PIC X.
  5592         16  CL-CCN-A5.
  5593             20  CL-CCN.
  5594                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5595                 24  CL-CCN-PRIME-A5 PIC X(12).
  5596             20  CL-CCN-FILLER-A5    PIC X(4).
  5597
  5598     12  CL-INSURED-PROFILE-DATA.
  5599         16  CL-INSURED-BIRTH-DT     PIC XX.
  5600         16  CL-INSURED-SEX-CD       PIC X.
  5601             88  INSURED-IS-MALE        VALUE 'M'.
  5602             88  INSURED-IS-FEMALE      VALUE 'F'.
  5603             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5604         16  CL-INSURED-OCC-CD       PIC X(6).
  5605         16  FILLER                  PIC X(5).
  5606
  5607     12  CL-PROCESSING-INFO.
  5608         16  CL-PROCESSOR-ID         PIC X(4).
  5609         16  CL-CLAIM-STATUS         PIC X.
  5610             88  CLAIM-IS-OPEN          VALUE 'O'.
  5611             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5612         16  CL-CLAIM-TYPE           PIC X.
  5613*            88  AH-CLAIM               VALUE 'A'.
  5614*            88  LIFE-CLAIM             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 103
* EL1278.cbl
  5615*            88  PROPERTY-CLAIM         VALUE 'P'.
  5616*            88  IUI-CLAIM              VALUE 'I'.
  5617*            88  GAP-CLAIM              VALUE 'G'.
  5618*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  5619*            88  OTHER-CLAIM            VALUE 'O'.
  5620         16  CL-CLAIM-PREM-TYPE      PIC X.
  5621             88  SINGLE-PREMIUM         VALUE '1'.
  5622             88  O-B-COVERAGE           VALUE '2'.
  5623             88  OPEN-END-COVERAGE      VALUE '3'.
  5624         16  CL-INCURRED-DT          PIC XX.
  5625         16  CL-REPORTED-DT          PIC XX.
  5626         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5627         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5628         16  CL-LAST-PMT-DT          PIC XX.
  5629         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5630         16  CL-PAID-THRU-DT         PIC XX.
  5631         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5632         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5633         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5634         16  CL-PMT-CALC-METHOD      PIC X.
  5635             88  CL-360-DAY-YR          VALUE '1'.
  5636             88  CL-365-DAY-YR          VALUE '2'.
  5637             88  CL-FULL-MONTHS         VALUE '3'.
  5638         16  CL-CAUSE-CD             PIC X(6).
  5639
  5640         16  CL-PRIME-CERT-NO.
  5641             20  CL-PRIME-CERT-PRIME PIC X(10).
  5642             20  CL-PRIME-CERT-SFX   PIC X.
  5643
  5644         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5645             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5646             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5647
  5648         16  CL-MICROFILM-NO         PIC X(10).
  5649         16  FILLER REDEFINES CL-MICROFILM-NO.
  5650             20  CL-BENEFIT-PERIOD   PIC 99.
  5651             20  FILLER              PIC X(8).
  5652         16  CL-PROG-FORM-TYPE       PIC X.
  5653         16  CL-LAST-ADD-ON-DT       PIC XX.
  5654
  5655         16  CL-LAST-REOPEN-DT       PIC XX.
  5656         16  CL-LAST-CLOSE-DT        PIC XX.
  5657         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5658             88  FINAL-PAID             VALUE '1'.
  5659             88  CLAIM-DENIED           VALUE '2'.
  5660             88  AUTO-CLOSE             VALUE '3'.
  5661             88  MANUAL-CLOSE           VALUE '4'.
  5662             88  BENEFITS-CHANGED       VALUE 'C'.
  5663             88  SETUP-ERRORS           VALUE 'E'.
  5664         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5665         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5666         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5667             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5668         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5669         16  FILLER                  PIC X.
  5670
  5671     12  CL-CERTIFICATE-DATA.
  5672         16  CL-CERT-ORIGIN          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 104
* EL1278.cbl
  5673             88  CERT-WAS-ONLINE        VALUE '1'.
  5674             88  CERT-WAS-CREATED       VALUE '2'.
  5675             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5676         16  CL-CERT-KEY-DATA.
  5677             20  CL-CERT-CARRIER     PIC X.
  5678             20  CL-CERT-GROUPING    PIC X(6).
  5679             20  CL-CERT-STATE       PIC XX.
  5680             20  CL-CERT-ACCOUNT.
  5681                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5682                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5683             20  CL-CERT-EFF-DT      PIC XX.
  5684
  5685     12  CL-STATUS-CONTROLS.
  5686         16  CL-PRIORITY-CD          PIC X.
  5687             88  CONFIDENTIAL-DATA      VALUE '8'.
  5688             88  HIGHEST-PRIORITY       VALUE '9'.
  5689         16  CL-SUPV-ATTN-CD         PIC X.
  5690             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5691             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5692         16  CL-PURGED-DT            PIC XX.
  5693         16  CL-RESTORED-DT          PIC XX.
  5694         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5695         16  CL-NEXT-RESEND-DT       PIC XX.
  5696         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5697         16  CL-CRITICAL-PERIOD      PIC 99.
  5698*        16  FILLER                  PIC XX.
  5699         16  CL-LAST-MAINT-DT        PIC XX.
  5700         16  CL-LAST-MAINT-USER      PIC X(4).
  5701         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5702         16  CL-LAST-MAINT-TYPE      PIC X.
  5703             88  CLAIM-SET-UP           VALUE ' '.
  5704             88  PAYMENT-MADE           VALUE '1'.
  5705             88  LETTER-SENT            VALUE '2'.
  5706             88  MASTER-WAS-ALTERED     VALUE '3'.
  5707             88  MASTER-WAS-RESTORED    VALUE '4'.
  5708             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5709             88  FILE-CONVERTED         VALUE '6'.
  5710             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5711             88  ERROR-CORRECTION       VALUE 'E'.
  5712         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5713         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5714         16  CL-BENEFICIARY          PIC X(10).
  5715         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5716         16  CL-DENIAL-TYPE          PIC X.
  5717             88  CL-TYPE-DENIAL          VALUE '1'.
  5718             88  CL-TYPE-RESCISSION      VALUE '2'.
  5719             88  CL-TYPE-REFORMATION     VALUE '3'.
  5720             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5721             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5722         16  CL-NO-OF-EXTENSIONS     PIC 99.
  5723         16  filler                  pic x(3).
  5724*        16  CL-CRIT-PER-RECURRENT   PIC X.
  5725*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  5726*        16  CL-RTW-DT               PIC XX.
  5727
  5728     12  CL-TRAILER-CONTROLS.
  5729         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5730             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 105
* EL1278.cbl
  5731             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5732             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5733         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5734         16  FILLER                  PIC XX.
  5735         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5736         16  CL-ADDRESS-TRAILER-CNT.
  5737             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5738                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5739             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5740                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5741             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5742                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5743             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5744                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5745             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5746                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5747             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5748                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5749             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5750                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5751
  5752     12  CL-CV-REFERENCE-NO.
  5753         16  CL-CV-REFNO-PRIME       PIC X(18).
  5754         16  CL-CV-REFNO-SFX         PIC XX.
  5755
  5756     12  CL-FILE-LOCATION            PIC X(4).
  5757
  5758     12  CL-PROCESS-ERRORS.
  5759         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5760             88  NO-FATAL-ERRORS        VALUE ZERO.
  5761         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5762             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5763
  5764     12  CL-PRODUCT-CD               PIC X.
  5765
  5766     12  CL-CURRENT-KEY-DATA.
  5767         16  CL-CURRENT-CARRIER      PIC X.
  5768         16  CL-CURRENT-GROUPING     PIC X(6).
  5769         16  CL-CURRENT-STATE        PIC XX.
  5770         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5771
  5772     12  CL-ASSOCIATES               PIC X.
  5773         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5774         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5775         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5776         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5777
  5778     12  CL-ACTIVITY-CODE            PIC 99.
  5779     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5780     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5781
  5782     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5783     12  CL-LAG-REPORT-CODE          PIC 9.
  5784     12  CL-LOAN-TYPE                PIC XX.
  5785     12  CL-LEGAL-STATE              PIC XX.
  5786
  5787     12  CL-YESNOSW                  PIC X.
  5788     12  CL-ACCIDENT-CLAIM-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 106
* EL1278.cbl
  5789         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  5790         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  5791         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  5792     12  cl-insured-type             pic x.
  5793         88  cl-claim-on-primary         value 'P'.
  5794         88  cl-claim-on-co-borrower     value 'C'.
  5795     12  cl-benefit-expiration-dt    PIC XX.
  5796*                            COPY ERCPDEF.
  5797******************************************************************
  5798*                                                                *
  5799*                                                                *
  5800*                            ERCPDEF.                            *
  5801*                                                                *
  5802*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5803*                                                                *
  5804*    FILE TYPE = VSAM,KSDS                                       *
  5805*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5806*                                                                *
  5807*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5808*                                                                *
  5809*    LOG = YES                                                   *
  5810*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5811******************************************************************
  5812*                   C H A N G E   L O G
  5813*
  5814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5815*-----------------------------------------------------------------
  5816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5817* EFFECTIVE    NUMBER
  5818*-----------------------------------------------------------------
  5819* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5820* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5821* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  5822* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5823******************************************************************
  5824 01  PRODUCT-MASTER.
  5825    12  PD-RECORD-ID                 PIC X(02).
  5826        88  VALID-PD-ID                  VALUE 'PD'.
  5827    12  PD-CONTROL-PRIMARY.
  5828        16  PD-COMPANY-CD            PIC X.
  5829        16  PD-STATE                 PIC XX.
  5830        16  PD-PRODUCT-CD            PIC XXX.
  5831        16  PD-FILLER                PIC X(7).
  5832        16  PD-BEN-TYPE              PIC X.
  5833        16  PD-BEN-CODE              PIC XX.
  5834        16  PD-PROD-EXP-DT           PIC XX.
  5835    12  FILLER                       PIC X(50).
  5836    12  PD-PRODUCT-DATA OCCURS 8.
  5837        16  PD-PROD-CODE             PIC X.
  5838            88  PD-PROD-LIFE           VALUE 'L'.
  5839            88  PD-PROD-PROP           VALUE 'P'.
  5840            88  PD-PROD-AH             VALUE 'A'.
  5841            88  PD-PROD-IU             VALUE 'I'.
  5842            88  PD-PROD-GAP            VALUE 'G'.
  5843            88  PD-PROD-FAML           VALUE 'F'.
  5844            88  PD-PROD-OTH            VALUE 'O'.
  5845        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5846        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 107
* EL1278.cbl
  5847        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5848        16  PD-MAX-TERM              PIC S999        COMP-3.
  5849        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5850        16  FILLER                   PIC X.
  5851        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5852        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5853        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5854        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5855        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5856        16  PD-REC-CRIT-PERIOD       PIC 99.
  5857        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5858            20  PD-RECURRING-YN      PIC X.
  5859            20  FILLER               PIC X.
  5860        16  PD-RTW-MOS               PIC 99.
  5861        16  PD-MAX-EXTENSION         PIC 99.
  5862        16  pd-ben-pct               pic sv999 comp-3.
  5863*       16  FILLER                   PIC XX.
  5864    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5865    12  PD-TERM-LIMITS OCCURS 15.
  5866        16  PD-LOW-TERM              PIC S999        COMP-3.
  5867        16  PD-HI-TERM               PIC S999        COMP-3.
  5868*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5869    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5870        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5871        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5872    12  PD-EARN-FACTORS.
  5873        16  FILLER OCCURS 15.
  5874            20  FILLER OCCURS 15.
  5875                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5876    12  PD-PRODUCT-DESC              PIC X(80).
  5877    12  PD-TRUNCATED                 PIC X.
  5878    12  FILLER                       PIC X(59).
  5879    12  PD-MAINT-INFORMATION.
  5880        16  PD-LAST-MAINT-DT         PIC X(02).
  5881        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5882        16  PD-LAST-MAINT-BY         PIC X(04).
  5883*                            COPY ELCCRTT.
  5884******************************************************************
  5885*                                                                *
  5886*                            ELCCRTT.                            *
  5887*                                                                *
  5888*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5889*                                                                *
  5890*   FILE TYPE = VSAM,KSDS                                        *
  5891*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5892*                                                                *
  5893*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5894*                                                                *
  5895*   LOG = YES                                                    *
  5896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5897******************************************************************
  5898*                   C H A N G E   L O G
  5899*
  5900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5901*-----------------------------------------------------------------
  5902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5903* EFFECTIVE    NUMBER
  5904*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 108
* EL1278.cbl
  5905* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5906* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5907* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5908* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5909* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5910* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5911* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5912* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5913* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5914* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5915* 091318  CR2018073000001  PEMA  ADD Refund methods
  5916* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5917******************************************************************
  5918
  5919 01  CERTIFICATE-TRAILERS.
  5920     12  CS-RECORD-ID                      PIC XX.
  5921         88  VALID-CS-ID                      VALUE 'CS'.
  5922
  5923     12  CS-CONTROL-PRIMARY.
  5924         16  CS-COMPANY-CD                 PIC X.
  5925         16  CS-CARRIER                    PIC X.
  5926         16  CS-GROUPING                   PIC X(6).
  5927         16  CS-STATE                      PIC XX.
  5928         16  CS-ACCOUNT                    PIC X(10).
  5929         16  CS-CERT-EFF-DT                PIC XX.
  5930         16  CS-CERT-NO.
  5931             20  CS-CERT-PRIME             PIC X(10).
  5932             20  CS-CERT-SFX               PIC X.
  5933         16  CS-TRAILER-TYPE               PIC X.
  5934             88  COMM-TRLR           VALUE 'A'.
  5935             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5936             88  CERT-DATA-TRLR      VALUE 'C'.
  5937
  5938     12  CS-DATA-AREA                      PIC X(516).
  5939
  5940     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5941         16  CS-BANK-COMMISSION-AREA.
  5942             20  CS-BANK-COMMS       OCCURS 10.
  5943                 24  CS-AGT                PIC X(10).
  5944                 24  CS-COM-TYP            PIC X.
  5945                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5946                 24  CS-RECALC-LV-INDIC    PIC X.
  5947                 24  FILLER                PIC X(10).
  5948         16  FILLER                        PIC X(256).
  5949
  5950     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5951****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5952         16  CS-MB-CLAIM-DATA OCCURS 24.
  5953             20  CS-CLAIM-NO               PIC X(7).
  5954             20  CS-CLAIM-TYPE             PIC X.
  5955                 88  CS-AH-CLM               VALUE 'A'.
  5956                 88  CS-IU-CLM               VALUE 'I'.
  5957                 88  CS-GP-CLM               VALUE 'G'.
  5958                 88  CS-LF-CLM               VALUE 'L'.
  5959                 88  CS-PR-CLM               VALUE 'P'.
  5960                 88  CS-FL-CLM               VALUE 'F'.
  5961                 88  CS-OT-CLM               VALUE 'O'.
  5962             20  CS-INSURED-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 109
* EL1278.cbl
  5963                 88  CS-PRIM-INSURED          VALUE 'P'.
  5964                 88  CS-CO-BORROWER           VALUE 'C'.
  5965             20  CS-BENEFIT-PERIOD         PIC 99.
  5966             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5967             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5968             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5969         16  FILLER                        PIC X(12).
  5970     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5971         16  CS-VIN-NUMBER                 PIC X(17).
  5972         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5973         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5974         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5975         16  cs-agent-name.
  5976             20  cs-agent-fname            pic x(20).
  5977             20  cs-agent-mi               pic x.
  5978             20  cs-agent-lname            pic x(25).
  5979         16  cs-license-no                 pic x(15).
  5980         16  cs-npn-number                 pic x(10).
  5981         16  cs-agent-edit-status          pic x.
  5982             88  cs-ae-refer-to-manager      value 'M'.
  5983             88  cs-ae-cover-sheet           value 'C'.
  5984             88  cs-ae-sig-form              value 'S'.
  5985             88  cs-ae-verified              value 'V'.
  5986             88  cs-unidentified-signature   value 'U'.
  5987             88  cs-cert-returned            value 'R'.
  5988             88  cs-accept-no-commission     value 'N'.
  5989         16  cs-year                       pic 9999.
  5990         16  cs-make                       pic x(20).
  5991         16  cs-model                      pic x(20).
  5992         16  cs-future                     pic x(20).
  5993         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5994         16  cs-claim-verification-status  pic x.
  5995             88  cs-clm-ver-eligible         value 'A'.
  5996             88  cs-clm-ver-partial-elig     value 'B'.
  5997             88  cs-clm-ver-not-eligible     value 'C'.
  5998             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5999             88  cs-clm-ver-not-part-elig-rw value 'E'.
  6000             88  cs-clm-ver-ND-CERT          value 'F'.
  6001             88  cs-clm-ver-spec-other       value 'G'.
  6002             88  cs-clam-ver-pratial-corrected
  6003                                             value 'H'.
  6004             88  cs-clm-ver-no-matches       value 'I'.
  6005             88  cs-clm-ver-not-elig-corrected
  6006                                             value 'J'.
  6007             88  cs-clm-ver-needs-review     value 'R'.
  6008             88  cs-clm-ver-sent-to-claims   value 'W'.
  6009         16  CS-LF-REFUND-METHOD           PIC X.
  6010         16  CS-AH-REFUND-METHOD           PIC X.
  6011         16  FILLER                        PIC X(353). *> was 420
  6012*        16  FILLER                        PIC X(496).
  6013 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  6014                          ACCOUNT-MASTER CERTIFICATE-MASTER
  6015                          MAILING-DATA ORIGINAL-CERTIFICATE
  6016                          FORM-MASTER CLAIM-MASTER
  6017                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  6018 0000-DFHEXIT SECTION.
  6019     MOVE '9#                    $   ' TO DFHEIV0.
  6020     MOVE 'EL1278' TO DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 110
* EL1278.cbl
  6021     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6022*    SERVICE RELOAD PARMLIST.
  6023
  6024     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6025     MOVE '5'                    TO  DC-OPTION-CODE.
  6026
  6027     PERFORM 9600-DATE-LINK.
  6028
  6029     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6030     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6031     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  6032     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  6033     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  6034     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  6035     MOVE EIBTRMID               TO  QID-TERM.
  6036
  6037     IF EIBCALEN  IS EQUAL TO  ZERO
  6038         GO TO 8700-UNAUTHORIZED-ACCESS.
  6039
  6040     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  6041         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  6042             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  6043             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  6044             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  6045             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  6046             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  6047             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  6048             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  6049             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  6050         ELSE
  6051             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  6052             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  6053             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  6054             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  6055             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  6056             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  6057             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  6058             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  6059             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  6060
  6061     IF EIBAID  IS EQUAL TO  DFHCLEAR
  6062         GO TO 9300-CLEAR.
  6063
  6064     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  6065         NEXT SENTENCE
  6066     ELSE
  6067
  6068* EXEC CICS READQ TS
  6069*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6070*            INTO    (SECURITY-CONTROL)
  6071*            LENGTH  (SC-COMM-LENGTH)
  6072*            ITEM    (SC-ITEM)
  6073*        END-EXEC
  6074*    MOVE '*$II   L              ''   #00006063' TO DFHEIV0
  6075     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6076     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6077     MOVE X'2020233030303036303633' TO DFHEIV0(25:11)
  6078     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 111
* EL1278.cbl
  6079           PI-SECURITY-TEMP-STORE-ID,
  6080           SECURITY-CONTROL,
  6081           SC-COMM-LENGTH,
  6082           SC-ITEM,
  6083           DFHEIV99,
  6084           DFHEIV99
  6085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6086         MOVE SC-CREDIT-DISPLAY (33)
  6087                                 TO  PI-DISPLAY-CAP
  6088         MOVE SC-CREDIT-UPDATE  (33)
  6089                                 TO  PI-MODIFY-CAP
  6090         MOVE SC-CREDIT-UPDATE  (32)
  6091                                 TO  PI-MODIFY-CERT-CAP
  6092         IF NOT  DISPLAY-CAP
  6093             MOVE 'READ'         TO  SM-READ
  6094             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6095             MOVE ER-0070        TO  EMI-ERROR
  6096             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6097             GO TO 8100-SEND-INITIAL-MAP.
  6098
  6099     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  6100         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  6101         MOVE LOW-VALUES         TO  EL127HI
  6102         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  6103                                     PI-LF-CANCEL-DATE
  6104                                     WS-AH-CANCEL-DATE
  6105                                     PI-AH-CANCEL-DATE
  6106         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  6107                                     PI-LF-CANCEL-DATE-ED
  6108                                     WS-AH-CANCEL-DATE-ED
  6109                                     PI-AH-CANCEL-DATE-ED
  6110         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  6111                                     PI-EARNING-METHOD-AH
  6112         PERFORM 0500-FORMAT-SCREEN
  6113         GO TO 8100-SEND-INITIAL-MAP.
  6114
  6115     IF NOT  MODIFY-CAP
  6116         MOVE 'UPDATE'           TO  SM-READ
  6117         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6118         MOVE ER-0070            TO  EMI-ERROR
  6119         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6120         GO TO 8100-SEND-INITIAL-MAP.
  6121
  6122
  6123* EXEC CICS HANDLE CONDITION
  6124*        PGMIDERR  (9500-PGMID-ERROR)
  6125*        ERROR     (9900-ABEND)
  6126*    END-EXEC.
  6127*    MOVE '"$L.                  ! " #00006105' TO DFHEIV0
  6128     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  6129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6130     MOVE X'2220233030303036313035' TO DFHEIV0(25:11)
  6131     CALL 'kxdfhei1' USING DFHEIV0
  6132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6133
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 112
* EL1278.cbl
  6135 0200-RECEIVE.
  6136     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  6137         MOVE ER-0008            TO  EMI-ERROR
  6138         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6139         MOVE -1                 TO  HLCANCL
  6140         GO TO 8200-SEND-DATAONLY.
  6141
  6142
  6143* EXEC CICS RECEIVE
  6144*        MAP     (MAP-NAME)
  6145*        MAPSET  (MAPSET-NAME)
  6146*        INTO    (EL127HI)
  6147*    END-EXEC.
  6148     MOVE LENGTH OF
  6149      EL127HI
  6150       TO DFHEIV11
  6151*    MOVE '8"T I  L              ''   #00006117' TO DFHEIV0
  6152     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6154     MOVE X'2020233030303036313137' TO DFHEIV0(25:11)
  6155     CALL 'kxdfhei1' USING DFHEIV0,
  6156           MAP-NAME,
  6157           EL127HI,
  6158           DFHEIV11,
  6159           MAPSET-NAME,
  6160           DFHEIV99,
  6161           DFHEIV99
  6162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6163
  6164
  6165     IF HPFKEYL  IS EQUAL TO  ZERO
  6166         GO TO 0300-CHECK-PFKEYS.
  6167
  6168     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  6169         MOVE ER-0004            TO  EMI-ERROR
  6170         GO TO 0320-INPUT-ERROR.
  6171
  6172     IF HPFKEYI NUMERIC
  6173         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  6174             MOVE PF-VALUES (HPFKEYI)
  6175                                 TO  EIBAID
  6176         ELSE
  6177             MOVE ER-0029        TO  EMI-ERROR
  6178             GO TO 0320-INPUT-ERROR.
  6179
  6180 0300-CHECK-PFKEYS.
  6181     IF EIBAID  IS EQUAL TO  DFHPF23
  6182         GO TO 8800-PF23.
  6183
  6184     IF EIBAID  IS EQUAL TO  DFHPF24
  6185         GO TO 9100-RETURN-MAIN-MENU.
  6186     if eibaid not = dfhpf10
  6187        move 'N'                 to pi-pf10-ok
  6188     end-if
  6189     IF EIBAID = DFHPF11
  6190        GO TO 1700-WRITE-CERT-NOTE
  6191     END-IF
  6192
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 113
* EL1278.cbl
  6193     IF EIBAID  IS EQUAL TO  DFHPF12
  6194         GO TO 9400-PF12.
  6195
  6196     IF EIBAID = DFHENTER OR DFHPF10
  6197        GO TO 0400-EDIT-INPUT-DATA
  6198     END-IF
  6199
  6200     MOVE ER-0029                TO  EMI-ERROR.
  6201
  6202 0320-INPUT-ERROR.
  6203     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6204
  6205     MOVE AL-UNBON               TO  HPFKEYA.
  6206
  6207     IF HPFKEYL  IS EQUAL TO  ZERO
  6208         MOVE -1                 TO  HLCANCL
  6209     ELSE
  6210         MOVE -1                 TO  HPFKEYL.
  6211
  6212     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 114
* EL1278.cbl
  6214 0400-EDIT-INPUT-DATA.
  6215     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  6216                                     WS-NEW-LF-CANCEL-SW.
  6217
  6218     IF (HPCYNL > 0)
  6219        AND (HPCYNI = 'Y' OR 'N')
  6220        PERFORM 1800-READ-ELCERT-UPDATE
  6221                                 THRU 1800-EXIT
  6222        IF WS-RESP-NORMAL
  6223           MOVE HPCYNI           TO CM-POST-CARD-IND
  6224           PERFORM 1810-REWRITE-ELCERT
  6225                                 THRU 1810-EXIT
  6226        END-IF
  6227     END-IF
  6228     IF HLCAL1L GREATER ZERO
  6229         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  6230     IF CLPYNI = 'Y'
  6231        MOVE 'Y'                   TO PI-CLP-YN
  6232        MOVE AL-UANON              TO CLPYNA
  6233     ELSE
  6234        MOVE ' '                   TO PI-CLP-YN
  6235        MOVE AL-UANON              TO CLPYNA
  6236     END-IF
  6237     IF CANREAI = 'R'
  6238        MOVE 'R'                 TO PI-CANCEL-REASON
  6239        MOVE AL-UANON            TO CANREAA
  6240     ELSE
  6241        MOVE ' '                 TO PI-CANCEL-REASON
  6242        MOVE AL-UANON            TO CANREAA
  6243     END-IF
  6244
  6245     IF HLCANCL  IS EQUAL TO  ZERO
  6246       AND HACANCL  IS EQUAL TO  ZERO
  6247         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6248         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6249         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6250         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6251         GO TO 0420-CHECK-ERRORS.
  6252
  6253     IF HLCANCL  IS EQUAL TO  ZERO
  6254         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6255         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6256         GO TO 0410-CHECK-AH-DATE.
  6257
  6258     IF HLCANCI = SPACES
  6259        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  6260                                      WS-LF-CANCEL-DATE
  6261        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  6262                                      WS-LF-CANCEL-DATE-ED
  6263                                      PI-LF-REFUND-METH
  6264        MOVE +0                    TO PI-LF-REFUND-AMT
  6265        GO TO 0410-CHECK-AH-DATE
  6266     END-IF
  6267
  6268     MOVE AL-UNNON               TO  HLCANCA.
  6269     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6270     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6271
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 115
* EL1278.cbl
  6272     PERFORM 8600-DEEDIT.
  6273
  6274     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6275     MOVE '4'                    TO  DC-OPTION-CODE.
  6276
  6277     PERFORM 9600-DATE-LINK.
  6278
  6279     IF DATE-CONVERSION-ERROR
  6280         MOVE -1                 TO  HLCANCL
  6281         MOVE AL-UABON           TO  HLCANCA
  6282         MOVE ER-2227            TO  EMI-ERROR
  6283         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6284     ELSE
  6285        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6286           MOVE -1               TO  HACANCL
  6287           MOVE AL-UABON         TO  HACANCA
  6288           MOVE ER-2774          TO  EMI-ERROR
  6289           PERFORM 9700-ERROR-FORMAT
  6290                                 THRU  9799-EXIT
  6291        ELSE
  6292           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6293                                    PI-LF-CANCEL-DATE
  6294           MOVE DC-GREG-DATE-1-EDIT
  6295                                 TO HLCANCO
  6296                                    WS-LF-CANCEL-DATE-ED
  6297                                    PI-LF-CANCEL-DATE-ED
  6298        END-IF
  6299     END-IF
  6300     .
  6301 0410-CHECK-AH-DATE.
  6302     IF HACAL1L GREATER ZERO
  6303         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6304
  6305     IF HACANCL  IS EQUAL TO  ZERO
  6306         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6307         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6308         GO TO 0420-CHECK-ERRORS.
  6309     IF HACANCI = SPACES
  6310        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6311                                      WS-AH-CANCEL-DATE
  6312        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6313                                      WS-AH-CANCEL-DATE-ED
  6314                                      PI-AH-REFUND-METH
  6315        MOVE +0                    TO PI-AH-REFUND-AMT
  6316        GO TO 0420-CHECK-ERRORS
  6317     END-IF
  6318
  6319     MOVE AL-UNNON               TO  HACANCA.
  6320     MOVE HACANCI                TO  DEEDIT-FIELD.
  6321     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6322
  6323     PERFORM 8600-DEEDIT.
  6324
  6325     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6326     MOVE '4'                    TO  DC-OPTION-CODE.
  6327
  6328     PERFORM 9600-DATE-LINK.
  6329
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 116
* EL1278.cbl
  6330     IF DATE-CONVERSION-ERROR
  6331         MOVE -1                 TO  HACANCL
  6332         MOVE AL-UABON           TO  HACANCA
  6333         MOVE ER-2227            TO  EMI-ERROR
  6334         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6335     ELSE
  6336        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6337           MOVE -1               TO  HACANCL
  6338           MOVE AL-UABON         TO  HACANCA
  6339           MOVE ER-2775          TO  EMI-ERROR
  6340           PERFORM 9700-ERROR-FORMAT
  6341                                 THRU  9799-EXIT
  6342        ELSE
  6343           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6344                                    PI-AH-CANCEL-DATE
  6345           MOVE DC-GREG-DATE-1-EDIT
  6346                                 TO HACANCO
  6347                                    WS-AH-CANCEL-DATE-ED
  6348                                    PI-AH-CANCEL-DATE-ED
  6349        END-IF
  6350     END-IF
  6351     .
  6352 0420-CHECK-ERRORS.
  6353     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6354         NEXT SENTENCE
  6355     ELSE
  6356         GO TO 8200-SEND-DATAONLY.
  6357
  6358     PERFORM 0500-FORMAT-SCREEN.
  6359     if eibaid = dfhpf10
  6360        if pi-pf10-ok not = 'Y'
  6361           move 'Y'              to pi-pf10-ok
  6362           move er-3847          to emi-error
  6363           move -1               to hlcancl
  6364           perform 9700-error-format
  6365                                 thru 9799-exit
  6366           go to 8200-send-dataonly
  6367        end-if
  6368     end-if
  6369     IF EIBAID = DFHPF10
  6370        perform 4000-GEN-CANCEL-TRANS
  6371                                 thru 4000-exit
  6372        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6373        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6374        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6375        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6376        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6377        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6378                               PI-ALL-CANCELS-SW
  6379        IF PI-PROCESSOR-IS-CSR
  6380            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6381        ELSE
  6382            MOVE ' '        TO PI-CSR-SESSION-SW
  6383        END-IF
  6384        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6385                               PI-CANCELS-IN-ERROR-SW
  6386                               PI-ONLY-BATCH-HEADERS-SW
  6387                               PI-ALL-OUT-OF-BAL-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 117
* EL1278.cbl
  6388                               PI-HOLD-REC-SW
  6389                               PI-CHANGE-REC-SW
  6390                               PI-CHK-REQ-REC-SW
  6391                               PI-ISSUE-WARNING-SW
  6392                               PI-CANCEL-WARNING-SW
  6393        MOVE '1'            TO PI-BROWSE-TYPE
  6394        MOVE DFHENTER       TO  EIBAID
  6395
  6396
  6397* EXEC CICS XCTL
  6398*           PROGRAM    ('EL6311')
  6399*           COMMAREA   (WS-PASS-631)
  6400*           LENGTH     (1300)
  6401*       END-EXEC
  6402     MOVE 'EL6311' TO DFHEIV1
  6403     MOVE 1300
  6404       TO DFHEIV11
  6405*    MOVE '.$C                   %   #00006354' TO DFHEIV0
  6406     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6407     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6408     MOVE X'2020233030303036333534' TO DFHEIV0(25:11)
  6409     CALL 'kxdfhei1' USING DFHEIV0,
  6410           DFHEIV1,
  6411           WS-PASS-631,
  6412           DFHEIV11,
  6413           DFHEIV99
  6414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6415
  6416*        PERFORM 0500-FORMAT-SCREEN
  6417     END-IF
  6418     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 118
* EL1278.cbl
  6420 0500-FORMAT-SCREEN  SECTION.
  6421     MOVE LOW-VALUES             TO  EL127HO.
  6422     MOVE PI-CARRIER             TO  HCARIERO.
  6423     MOVE PI-GROUPING            TO  HGROUPO.
  6424     MOVE PI-STATE               TO  HSTATEO.
  6425     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6426     MOVE ' '                    TO  DC-OPTION-CODE.
  6427     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6428
  6429     PERFORM 9600-DATE-LINK.
  6430
  6431     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6432     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6433     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6434     MOVE PI-CLP-YN              TO  CLPYNO
  6435     MOVE PI-CANCEL-REASON       TO  CANREAO
  6436     .
  6437 0510-GET-CERT.
  6438     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6439     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6440     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6441     MOVE PI-STATE               TO  WS-CM-STATE.
  6442     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6443     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6444     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6445     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6446
  6447     PERFORM 0900-READ-CERT-FILE.
  6448
  6449     IF CERT-NOT-FOUND
  6450         MOVE -1                 TO  HLCANCL
  6451         MOVE AL-SANON           TO  HLCANCA
  6452         MOVE ER-0214            TO  EMI-ERROR
  6453         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6454         GO TO 8100-SEND-INITIAL-MAP.
  6455
  6456     IF CM-CLAIM-ATTACHED-COUNT = +0
  6457        GO TO 0510-SKIP-CLAIM-CHECK
  6458     END-IF
  6459     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6460     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6461
  6462* EXEC CICS STARTBR
  6463*       DATASET     ('ELMSTR5')
  6464*       RIDFLD      (ELMSTR-KEY)
  6465*       RESP        (WS-RESPONSE)
  6466*    END-EXEC
  6467     MOVE 'ELMSTR5' TO DFHEIV1
  6468     MOVE 0
  6469       TO DFHEIV11
  6470*    MOVE '&,         G          &  N#00006406' TO DFHEIV0
  6471     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6472     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6473     MOVE X'204E233030303036343036' TO DFHEIV0(25:11)
  6474     CALL 'kxdfhei1' USING DFHEIV0,
  6475           DFHEIV1,
  6476           ELMSTR-KEY,
  6477           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 119
* EL1278.cbl
  6478           DFHEIV11,
  6479           DFHEIV99
  6480     MOVE EIBRESP  TO WS-RESPONSE
  6481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6482     IF WS-RESP-NORMAL
  6483     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6484
  6485* EXEC CICS READNEXT
  6486*          DATASET   ('ELMSTR5')
  6487*          RIDFLD    (ELMSTR-KEY)
  6488*          SET       (ADDRESS OF CLAIM-MASTER)
  6489*          RESP      (WS-RESPONSE)
  6490*       END-EXEC
  6491     MOVE 'ELMSTR5' TO DFHEIV1
  6492     MOVE 0
  6493       TO DFHEIV11
  6494*    MOVE '&.S                   )  N#00006413' TO DFHEIV0
  6495     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6496     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6497     MOVE X'204E233030303036343133' TO DFHEIV0(25:11)
  6498     CALL 'kxdfhei1' USING DFHEIV0,
  6499           DFHEIV1,
  6500           DFHEIV20,
  6501           DFHEIV99,
  6502           ELMSTR-KEY,
  6503           DFHEIV99,
  6504           DFHEIV11,
  6505           DFHEIV99,
  6506           DFHEIV99
  6507     SET ADDRESS OF CLAIM-MASTER TO
  6508         DFHEIV20
  6509     MOVE EIBRESP  TO WS-RESPONSE
  6510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6511        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6512           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6513           AND (CM-CERT-NO = CL-CERT-NO)
  6514           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6515              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6516              SET FOUND-A-CLAIM  TO TRUE
  6517              MOVE CL-CLAIM-TYPE TO WS-CLAIM-TYPE
  6518              IF CL-CLAIM-TYPE = 'L' OR 'O'
  6519                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6520                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6521                 END-IF
  6522                 IF CLAIM-IS-OPEN
  6523                    SET OPEN-LF-CLAIM TO TRUE
  6524                 ELSE
  6525                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6526                       MOVE CL-LAST-CLOSE-DT
  6527                                 TO WS-LF-LAST-CLOSE-DT
  6528                    END-IF
  6529                    SET CLOSED-LF-CLAIM TO TRUE
  6530                 END-IF
  6531              ELSE
  6532                 IF CLAIM-IS-OPEN
  6533                    MOVE CL-PAID-THRU-DT
  6534                                 TO WS-AH-PAID-THRU-DT
  6535                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 120
* EL1278.cbl
  6536                 ELSE
  6537                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6538                       MOVE CL-PAID-THRU-DT
  6539                                 TO WS-AH-PAID-THRU-DT
  6540                    END-IF
  6541                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6542                       MOVE CL-LAST-CLOSE-DT
  6543                                 TO WS-AH-LAST-CLOSE-DT
  6544                    END-IF
  6545                    SET CLOSED-AH-CLAIM TO TRUE
  6546                 END-IF
  6547              END-IF
  6548           END-IF
  6549        ELSE
  6550           SET I-SAY-TO-STOP TO TRUE
  6551        END-IF
  6552     END-PERFORM
  6553     END-IF
  6554     IF FOUND-A-CLAIM
  6555        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6556           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6557           MOVE ' '              TO DC-OPTION-CODE
  6558           PERFORM 9600-DATE-LINK
  6559           IF NO-CONVERSION-ERROR
  6560              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6561              MOVE AL-SANOF      TO LCLMDTHA
  6562           END-IF
  6563        END-IF
  6564        IF WS-CLAIM-TYPE = 'O'
  6565           MOVE 'CLAIM TYPE O INCURRED' TO LCLMDTHO
  6566           MOVE 'OTHER' TO WS-CLAIM-LIT
  6567        ELSE
  6568           MOVE 'LIFE ' TO WS-CLAIM-LIT
  6569        END-IF
  6570        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6571           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6572           MOVE ' '              TO DC-OPTION-CODE
  6573           PERFORM 9600-DATE-LINK
  6574           IF NO-CONVERSION-ERROR
  6575              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6576              MOVE AL-SANOF      TO ACLMDTHA
  6577           END-IF
  6578        END-IF
  6579        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6580        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6581        MOVE CM-STATE            TO WS-CF-ACCESS
  6582        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6583
  6584* EXEC CICS READ
  6585*          DATASET  (ELCNTL-ID)
  6586*          SET      (ADDRESS OF CONTROL-FILE)
  6587*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6588*          RESP     (WS-RESPONSE)
  6589*       END-EXEC
  6590*    MOVE '&"S        E          (  N#00006491' TO DFHEIV0
  6591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6592     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6593     MOVE X'204E233030303036343931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 121
* EL1278.cbl
  6594     CALL 'kxdfhei1' USING DFHEIV0,
  6595           ELCNTL-ID,
  6596           DFHEIV20,
  6597           DFHEIV99,
  6598           WS-CF-CONTROL-PRIMARY,
  6599           DFHEIV99,
  6600           DFHEIV99,
  6601           DFHEIV99
  6602     SET ADDRESS OF CONTROL-FILE TO
  6603         DFHEIV20
  6604     MOVE EIBRESP  TO WS-RESPONSE
  6605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6606        IF WS-RESP-NORMAL
  6607           MOVE CF-ST-REF-AH-DEATH-IND
  6608                                 TO WS-ST-REF-IND
  6609        END-IF
  6610     END-IF
  6611     .
  6612 0510-SKIP-CLAIM-CHECK.
  6613     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6614     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6615     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6616     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6617
  6618* EXEC CICS READ
  6619*        DATASET  (ERMAIL-ID)
  6620*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6621*        SET      (ADDRESS OF MAILING-DATA)
  6622*        RESP     (WS-RESPONSE)
  6623*    END-EXEC.
  6624*    MOVE '&"S        E          (  N#00006508' TO DFHEIV0
  6625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6627     MOVE X'204E233030303036353038' TO DFHEIV0(25:11)
  6628     CALL 'kxdfhei1' USING DFHEIV0,
  6629           ERMAIL-ID,
  6630           DFHEIV20,
  6631           DFHEIV99,
  6632           WS-MA-CONTROL-PRIMARY,
  6633           DFHEIV99,
  6634           DFHEIV99,
  6635           DFHEIV99
  6636     SET ADDRESS OF MAILING-DATA TO
  6637         DFHEIV20
  6638     MOVE EIBRESP  TO WS-RESPONSE
  6639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6640
  6641     IF WS-RESP-NORMAL
  6642        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6643           (S1 > +7)
  6644           OR (MA-MAIL-STATUS (S1) = '1')
  6645        END-PERFORM
  6646        IF S1 > +7
  6647           MOVE AL-SANOF         TO HPCYNA
  6648        END-IF
  6649     END-IF
  6650     IF CM-POST-CARD-IND = 'Y'
  6651        MOVE 'Y'                 TO HPCYNO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 122
* EL1278.cbl
  6652     ELSE
  6653        MOVE 'N'                 TO HPCYNO
  6654     END-IF
  6655     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6656        OR (NOT CERT-AS-LOADED)
  6657        MOVE AL-SANOF            TO HPCYNA
  6658     END-IF
  6659*    IF (CERT-ADDED-BATCH)
  6660*       CONTINUE
  6661*    ELSE
  6662*       MOVE AL-SANOF            TO HPCYNA
  6663*    END-IF
  6664     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6665     MOVE '5'                    TO  DC-OPTION-CODE.
  6666
  6667     PERFORM 9600-DATE-LINK.
  6668
  6669     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6670     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6671     MOVE '1'                    TO  DC-OPTION-CODE.
  6672
  6673     PERFORM 9600-DATE-LINK.
  6674
  6675     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6676
  6677     MOVE ZEROS TO WS-TOT-ITDR.
  6678     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6679
  6680 0510-CHECK-LF-STATUS.
  6681
  6682     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6683         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6684                                    PI-LF-CANCEL-DATE
  6685         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6686                                    PI-LF-CANCEL-DATE-ED
  6687                                    PI-LF-REFUND-METH
  6688         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6689         GO TO 0510-CHECK-AH-STATUS.
  6690
  6691     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6692        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6693          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6694          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6695          IF FIRST-ENTRY
  6696              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6697              MOVE SPACES               TO DC-OPTION-CODE
  6698              PERFORM 9600-DATE-LINK
  6699              IF NOT DATE-CONVERSION-ERROR
  6700                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6701                                            PI-LF-CANCEL-DATE-ED
  6702                                            WS-LF-CANCEL-DATE-ED
  6703                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6704                                            WS-LF-CANCEL-DATE.
  6705
  6706     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6707        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6708          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6709          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 123
* EL1278.cbl
  6710          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6711        IF FIRST-ENTRY
  6712            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6713            MOVE SPACES               TO DC-OPTION-CODE
  6714            PERFORM 9600-DATE-LINK
  6715            IF NOT DATE-CONVERSION-ERROR
  6716                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6717                                          PI-LF-CANCEL-DATE-ED
  6718                                          WS-LF-CANCEL-DATE-ED
  6719                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6720                                          WS-LF-CANCEL-DATE.
  6721
  6722 0510-CHECK-AH-STATUS.
  6723
  6724     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6725         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6726                                    PI-AH-CANCEL-DATE
  6727         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6728                                    PI-AH-CANCEL-DATE-ED
  6729                                    PI-AH-REFUND-METH
  6730         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6731         GO TO 0510-CONT.
  6732
  6733     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6734        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6735          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6736          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6737        IF FIRST-ENTRY
  6738            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6739            MOVE SPACES               TO DC-OPTION-CODE
  6740            PERFORM 9600-DATE-LINK
  6741            IF NOT DATE-CONVERSION-ERROR
  6742                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6743                                            PI-AH-CANCEL-DATE-ED
  6744                                            WS-AH-CANCEL-DATE-ED
  6745                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6746                                            WS-AH-CANCEL-DATE.
  6747
  6748     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6749        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6750          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6751          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6752          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6753         IF FIRST-ENTRY
  6754             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6755             MOVE SPACES               TO DC-OPTION-CODE
  6756             PERFORM 9600-DATE-LINK
  6757             IF NOT DATE-CONVERSION-ERROR
  6758                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6759                                            PI-AH-CANCEL-DATE-ED
  6760                                            WS-AH-CANCEL-DATE-ED
  6761                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6762                                            WS-AH-CANCEL-DATE.
  6763
  6764     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6765         MOVE 'CANC DT'              TO  CNCDTHDO
  6766         GO TO 0510-CONT.
  6767
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 124
* EL1278.cbl
  6768     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6769         MOVE 'DTH DT '              TO  CNCDTHDO
  6770         IF FIRST-ENTRY
  6771             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6772             MOVE ' '                TO  DC-OPTION-CODE
  6773             PERFORM 9600-DATE-LINK
  6774             IF NOT DATE-CONVERSION-ERROR
  6775                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6776                                             PI-AH-CANCEL-DATE-ED
  6777                                             WS-AH-CANCEL-DATE-ED
  6778                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6779                                             WS-AH-CANCEL-DATE.
  6780
  6781 0510-CONT.
  6782
  6783     IF WS-TOT-ITDR GREATER THAN ZEROS
  6784         MOVE WS-TOT-ITDR TO TOITDRO.
  6785
  6786 0520-GET-COMPANY-RECORD.
  6787     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6788     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6789     MOVE SPACES                 TO  WS-CF-ACCESS.
  6790     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6791
  6792     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6793
  6794     IF CNTL-NOT-FOUND
  6795         MOVE -1                 TO  HLCANCL
  6796         MOVE AL-SANON           TO  HLCANCA
  6797         MOVE ER-2616            TO  EMI-ERROR
  6798         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6799         GO TO 8100-SEND-INITIAL-MAP.
  6800
  6801     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6802       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6803         MOVE CF-LIFE-OVERRIDE-L1
  6804                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6805         MOVE CF-LIFE-OVERRIDE-L2
  6806                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6807         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6808         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6809         MOVE CF-CR-REM-TERM-CALC
  6810                                 TO  WS-CF-CR-REM-TERM-CALC
  6811         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6812         IF CF-DEFAULT-APR NUMERIC
  6813             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6814             GO TO 0525-GET-LF-BENEFIT
  6815         ELSE
  6816             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6817             GO TO 0525-GET-LF-BENEFIT.
  6818
  6819     MOVE -1                     TO  HLCANCL.
  6820     MOVE AL-SANON               TO  HLCANCA.
  6821     MOVE ER-2616                TO  EMI-ERROR.
  6822
  6823     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6824
  6825     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 125
* EL1278.cbl
  6826
  6827 0525-GET-LF-BENEFIT.
  6828
  6829     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6830        GO TO 0527-GET-AH-BENEFIT
  6831     END-IF
  6832
  6833     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6834     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6835                                     HLCDO.
  6836     MOVE WS-CF-LIFE-OVERRIDE-L2
  6837                                 TO  HLKINDO.
  6838
  6839     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6840
  6841     IF BENEFIT-FOUND
  6842         NEXT SENTENCE
  6843     ELSE
  6844         MOVE -1                 TO  HLCDL
  6845         MOVE AL-SANON           TO  HLCDA
  6846         MOVE ER-0028            TO  EMI-ERROR
  6847         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6848         GO TO 8100-SEND-INITIAL-MAP.
  6849
  6850     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6851         MOVE AL-UNNOF           TO  HLTERMA.
  6852
  6853*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6854     MOVE WS-KIND                TO WS-LF-KIND
  6855     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6856                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6857
  6858     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6859         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6860                                 TO  WS-LF-CO-REM-TERM-CALC.
  6861
  6862     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6863         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6864                                 TO  WS-LF-CO-EARNINGS-CALC
  6865                                     WS-LF-CO-REFUND-CALC.
  6866
  6867     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6868         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6869                                 TO  WS-LF-SPECIAL-CALC-CD.
  6870
  6871     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6872         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6873                                 TO  WS-LF-CO-REFUND-CALC.
  6874
  6875 0527-GET-AH-BENEFIT.
  6876
  6877     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6878        GO TO 0530-GET-STATE-RECORD
  6879     END-IF
  6880
  6881     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6882     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6883                                     HACDO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 126
* EL1278.cbl
  6884     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6885
  6886     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6887
  6888     IF BENEFIT-FOUND
  6889         NEXT SENTENCE
  6890     ELSE
  6891         MOVE -1                 TO  HACDL
  6892         MOVE AL-SANON           TO  HACDA
  6893         MOVE ER-0028            TO  EMI-ERROR
  6894         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6895         GO TO 8100-SEND-INITIAL-MAP.
  6896
  6897     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6898         MOVE AL-UNNOF           TO  HATERMA.
  6899
  6900*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6901     MOVE WS-KIND                TO  WS-AH-KIND
  6902
  6903     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6904         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6905                                 TO  WS-AH-CO-REM-TERM-CALC.
  6906
  6907     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6908         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6909                                 TO  WS-AH-CO-EARNINGS-CALC
  6910                                     WS-AH-CO-REFUND-CALC.
  6911
  6912     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6913         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6914                                 TO  WS-AH-SPECIAL-CALC-CD.
  6915
  6916     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6917         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6918                                 TO  WS-AH-CO-REFUND-CALC.
  6919     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6920        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6921                                 TO WS-AH-BEN-CATEGORY
  6922     END-IF
  6923     .
  6924 0530-GET-STATE-RECORD.
  6925     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6926     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6927     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6928     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6929
  6930     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6931
  6932     IF CNTL-NOT-FOUND
  6933         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6934                                     WS-LF-ST-REM-TERM-CALC
  6935         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6936         GO TO 0560-FIND-ACCOUNT.
  6937
  6938     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6939       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6940       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6941         MOVE 'Y'                TO  WS-STATE-RECORD-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 127
* EL1278.cbl
  6942     ELSE
  6943         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6944                                     WS-LF-ST-REM-TERM-CALC
  6945         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6946         GO TO 0560-FIND-ACCOUNT.
  6947
  6948     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6949     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6950
  6951     IF CM-LF-BENEFIT-CD  = '00'
  6952         GO TO 0550-GET-AH-BEN-IN-STATE.
  6953
  6954 0540-GET-LF-BEN-IN-STATE.
  6955     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6956     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6957
  6958     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6959     IF CF-ST-RT-CALC NOT = SPACES
  6960        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6961     END-IF
  6962
  6963     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6964        IF CF-ST-RF-LR-CALC > '0'
  6965           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6966        END-IF
  6967        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6968           IF CF-ST-RF-LN-CALC > '0'
  6969              MOVE CF-ST-RF-LN-CALC
  6970                                 TO WS-LF-ST-REFUND-CALC
  6971           END-IF
  6972        END-IF
  6973     ELSE
  6974        IF CF-ST-RF-LL-CALC > '0'
  6975           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6976        END-IF
  6977     END-IF
  6978
  6979     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6980
  6981     IF NO-BENEFIT-FOUND
  6982*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6983         GO TO 0550-GET-AH-BEN-IN-STATE.
  6984
  6985     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6986         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6987                                 TO  WS-LF-ST-REM-TERM-CALC.
  6988
  6989     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6990         MOVE CF-ST-REFUND-CALC (SUB3)
  6991                                 TO  WS-LF-ST-REFUND-CALC.
  6992
  6993 0550-GET-AH-BEN-IN-STATE.
  6994     IF CM-AH-BENEFIT-CD  = '00'
  6995         GO TO 0560-FIND-ACCOUNT.
  6996
  6997     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6998     IF CF-ST-RT-CALC NOT = SPACES
  6999        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 128
* EL1278.cbl
  7000     END-IF
  7001
  7002     IF CF-ST-RF-AH-CALC > '0'
  7003        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  7004     END-IF
  7005     IF WS-AH-SPECIAL-CALC-CD = 'C'
  7006        IF CF-ST-RF-CP-CALC > '0'
  7007           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  7008        END-IF
  7009     END-IF
  7010
  7011     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  7012     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  7013
  7014     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  7015
  7016     IF NO-BENEFIT-FOUND
  7017*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  7018         GO TO 0560-FIND-ACCOUNT.
  7019
  7020     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  7021         MOVE CF-ST-REM-TERM-CALC (SUB3)
  7022                                 TO  WS-AH-ST-REM-TERM-CALC.
  7023
  7024     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  7025         MOVE CF-ST-REFUND-CALC (SUB3)
  7026                                 TO  WS-AH-ST-REFUND-CALC.
  7027
  7028 0560-FIND-ACCOUNT.
  7029     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  7030     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  7031     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  7032     MOVE CM-STATE               TO  WS-AM-STATE.
  7033     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  7034     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  7035     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  7036
  7037     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  7038
  7039     IF ACCT-FOUND
  7040         NEXT SENTENCE
  7041     ELSE
  7042         GO TO 0585-NO-ACCT.
  7043
  7044 0570-READ-NEXT-RANGE.
  7045     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  7046
  7047     IF ACCT-FOUND
  7048         NEXT SENTENCE
  7049     ELSE
  7050         GO TO 0580-ACCT-NOT-FOUND.
  7051
  7052     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  7053       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  7054       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  7055       AND CM-STATE  IS EQUAL TO  AM-STATE
  7056       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  7057         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 129
* EL1278.cbl
  7058     ELSE
  7059         GO TO 0580-ACCT-NOT-FOUND.
  7060
  7061     MOVE 'X'                    TO  DATE-RANGE-SW.
  7062
  7063     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
  7064         MOVE 'X'                TO  DATE-RANGE-SW
  7065         GO TO 0580-ACCT-NOT-FOUND.
  7066
  7067     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  7068         GO TO 0570-READ-NEXT-RANGE.
  7069
  7070     IF WS-BROWSE-STARTED-SW = 'Y'
  7071
  7072* EXEC CICS ENDBR
  7073*          DATASET    ('ERACCT')
  7074*       END-EXEC
  7075     MOVE 'ERACCT' TO DFHEIV1
  7076     MOVE 0
  7077       TO DFHEIV11
  7078*    MOVE '&2                    $   #00006944' TO DFHEIV0
  7079     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7080     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7081     MOVE X'2020233030303036393434' TO DFHEIV0(25:11)
  7082     CALL 'kxdfhei1' USING DFHEIV0,
  7083           DFHEIV1,
  7084           DFHEIV11,
  7085           DFHEIV99
  7086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7087        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  7088     END-IF
  7089     MOVE ' '                    TO  DATE-RANGE-SW.
  7090     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  7091
  7092     GO TO 0590-SET-ACCOUNT.
  7093
  7094 0580-ACCT-NOT-FOUND.
  7095     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  7096         MOVE ER-2601            TO  EMI-ERROR
  7097     ELSE
  7098         MOVE ER-2619            TO  EMI-ERROR.
  7099
  7100     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  7101
  7102     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7103
  7104 0585-NO-ACCT.
  7105     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  7106     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  7107                                     WS-AM-EARN-METHOD-R
  7108                                     WS-AM-EARN-METHOD-A
  7109                                     WS-LF-AM-REM-TERM-CALC
  7110                                     WS-AH-AM-REM-TERM-CALC.
  7111
  7112     GO TO 0600-CHECK-FOR-LIFE.
  7113
  7114 0590-SET-ACCOUNT.
  7115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 130
* EL1278.cbl
  7116******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  7117******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  7118******* METHODS.
  7119******************************************************************
  7120     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  7121     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
  7122     IF PI-COMPANY-ID EQUAL TO 'NCL'
  7123          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  7124                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  7125                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  7126                  IF FORM-FOUND
  7127                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  7128******************************************************************
  7129
  7130     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  7131     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  7132                                     WS-AM-EARN-METHOD-R
  7133                                     WS-AM-EARN-METHOD-A.
  7134
  7135*    EVALUATE AM-EARN-METHOD-R
  7136*       WHEN 'R'
  7137*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  7138*       WHEN 'P'
  7139*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  7140*       WHEN 'C'
  7141*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  7142*       WHEN 'A'
  7143*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  7144*       WHEN 'M'
  7145*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  7146*       WHEN 'S'
  7147*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  7148*    END-EVALUATE.
  7149
  7150*    EVALUATE AM-EARN-METHOD-L
  7151*       WHEN 'R'
  7152*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  7153*       WHEN 'P'
  7154*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  7155*       WHEN 'C'
  7156*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  7157*       WHEN 'A'
  7158*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  7159*       WHEN 'M'
  7160*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  7161*       WHEN 'S'
  7162*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  7163*    END-EVALUATE.
  7164
  7165*    EVALUATE AM-EARN-METHOD-A
  7166*       WHEN 'R'
  7167*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  7168*       WHEN 'P'
  7169*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  7170*       WHEN 'C'
  7171*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  7172*       WHEN 'A'
  7173*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 131
* EL1278.cbl
  7174*       WHEN 'M'
  7175*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  7176*       WHEN 'N'
  7177*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  7178*       WHEN 'S'
  7179*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
  7180*    END-EVALUATE.
  7181
  7182     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  7183                                     WS-TOT-LF-PREM
  7184                                     WS-TOT-AH-RFND
  7185                                     WS-TOT-LF-RFND.
  7186
  7187 0600-CHECK-FOR-LIFE.
  7188     IF CM-LF-BENEFIT-CD  = '00'
  7189         GO TO 0640-AH-BENEFIT.
  7190
  7191 0610-GET-LIFE-BENEFIT.
  7192
  7193     IF ACCT-FOUND
  7194         MOVE +1                 TO SUB3
  7195         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  7196     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7197     MOVE WS-LF-KIND             TO  HLEDESCO.
  7198     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7199     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7200        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7201                             + CM-LF-ALT-PREMIUM-AMT
  7202     ELSE
  7203        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7204     END-IF
  7205
  7206     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7207     EVALUATE TRUE
  7208        WHEN ((OPEN-LF-CLAIM)
  7209           OR (CLOSED-LF-CLAIM))
  7210           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7211           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  7212                                    WS-TOT-LF-RFND
  7213                                    PI-LF-REFUND-AMT
  7214           IF CM-AH-BENEFIT-CD NOT = '00'
  7215              MOVE ZEROS         TO HAREFNDO
  7216                                    WS-TOT-AH-RFND
  7217                                    PI-AH-REFUND-AMT
  7218              MOVE SPACES        TO PI-AH-REFUND-METH
  7219           END-IF
  7220           IF OTHER-CLAIM
  7221              MOVE ER-2998          TO EMI-ERROR
  7222           ELSE
  7223              MOVE ER-2965          TO EMI-ERROR
  7224           END-IF
  7225           PERFORM 9700-ERROR-FORMAT
  7226                                 THRU  9799-EXIT
  7227           GO TO 0640-AH-BENEFIT
  7228        WHEN OPEN-LF-CLAIM
  7229           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7230           AND WS-ST-REF-IND = '4'
  7231           MOVE ER-2966          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 132
* EL1278.cbl
  7232           MOVE WS-CLAIM-LIT     TO EMI-CLAIM-TYPE
  7233           PERFORM 9700-ERROR-FORMAT
  7234                                 THRU  9799-EXIT
  7235        WHEN OPEN-LF-CLAIM
  7236           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7237           AND WS-ST-REF-IND NOT = '4'
  7238           MOVE ER-2967          TO EMI-ERROR
  7239           MOVE WS-CLAIM-LIT     TO EMI-CLAIM-TYPE
  7240           PERFORM 9700-ERROR-FORMAT
  7241                                 THRU  9799-EXIT
  7242           GO TO 0640-AH-BENEFIT
  7243        WHEN CLOSED-LF-CLAIM
  7244           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7245           AND WS-ST-REF-IND = '4'
  7246           MOVE ER-2968          TO EMI-ERROR
  7247           MOVE WS-CLAIM-LIT     TO EMI-CLAIM-TYPE
  7248           PERFORM 9700-ERROR-FORMAT
  7249                                 THRU  9799-EXIT
  7250        WHEN CLOSED-LF-CLAIM
  7251           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7252           AND WS-ST-REF-IND NOT = '4'
  7253           MOVE ER-2969          TO EMI-ERROR
  7254           MOVE WS-CLAIM-LIT     TO EMI-CLAIM-TYPE
  7255           PERFORM 9700-ERROR-FORMAT
  7256                                 THRU  9799-EXIT
  7257           GO TO 0640-AH-BENEFIT
  7258        WHEN OTHER
  7259           CONTINUE
  7260     END-EVALUATE
  7261     .
  7262 0620-GET-REM-TERM.
  7263     MOVE WS-CF-LIFE-OVERRIDE-L1
  7264                                 TO  CP-LIFE-OVERRIDE-CODE.
  7265     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7266     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7267     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  7268     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7269     MOVE CM-STATE               TO  CP-STATE.
  7270     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7271     MOVE WS-CF-LF-COVERAGE-TYPE
  7272                                 TO  CP-BENEFIT-TYPE.
  7273     MOVE WS-LF-KIND             TO  HLEDESCO.
  7274     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7275     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7276     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7277     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7278     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7279     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7280     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7281     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7282     MOVE WS-CF-CR-REM-TERM-CALC
  7283                                 TO  CP-REM-TERM-METHOD.
  7284
  7285     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7286         MOVE WS-LF-CO-REM-TERM-CALC
  7287                                 TO  CP-REM-TERM-METHOD.
  7288
  7289     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 133
* EL1278.cbl
  7290         MOVE WS-LF-ST-REM-TERM-CALC
  7291                                 TO  CP-REM-TERM-METHOD.
  7292
  7293     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7294         MOVE WS-LF-AM-REM-TERM-CALC
  7295                                 TO  CP-REM-TERM-METHOD.
  7296
  7297     IF (PI-COMPANY-ID = 'CID')
  7298        AND (CP-STATE-STD-ABBRV = 'WI')
  7299        MOVE '7'                 TO CP-REM-TERM-METHOD
  7300        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7301     END-IF
  7302     IF (PI-COMPANY-ID = 'CID')
  7303        AND (CP-STATE-STD-ABBRV = 'MO')
  7304        AND (CM-CERT-EFF-DT >= X'9B41')
  7305        AND (CM-CERT-EFF-DT <= X'A2FB')
  7306        MOVE '7'                 TO CP-REM-TERM-METHOD
  7307        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7308     END-IF
  7309     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7310                                     CP-ORIGINAL-TERM
  7311                                     CP-LOAN-TERM.
  7312
  7313     IF CP-TRUNCATED-LIFE
  7314         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7315
  7316     IF CP-TERM-IS-DAYS
  7317         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7318             MOVE CM-LF-TERM-IN-DAYS
  7319                                 TO  CP-TERM-OR-EXT-DAYS
  7320         ELSE
  7321             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7322     ELSE
  7323         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7324             MOVE CM-PMT-EXTENSION-DAYS
  7325                                 TO  CP-TERM-OR-EXT-DAYS
  7326         ELSE
  7327             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7328
  7329*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7330     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7331     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7332     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7333     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7334
  7335
  7336* EXEC CICS READ
  7337*        DATASET  (ELCNTL-ID)
  7338*        SET      (ADDRESS OF CONTROL-FILE)
  7339*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7340*        RESP     (WS-RESPONSE)
  7341*    END-EXEC.
  7342*    MOVE '&"S        E          (  N#00007195' TO DFHEIV0
  7343     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7345     MOVE X'204E233030303037313935' TO DFHEIV0(25:11)
  7346     CALL 'kxdfhei1' USING DFHEIV0,
  7347           ELCNTL-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 134
* EL1278.cbl
  7348           DFHEIV20,
  7349           DFHEIV99,
  7350           WS-CF-CONTROL-PRIMARY,
  7351           DFHEIV99,
  7352           DFHEIV99,
  7353           DFHEIV99
  7354     SET ADDRESS OF CONTROL-FILE TO
  7355         DFHEIV20
  7356     MOVE EIBRESP  TO WS-RESPONSE
  7357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7358
  7359
  7360     IF WS-RESP-NOTOPEN
  7361         MOVE ER-2617            TO  EMI-ERROR
  7362         GO TO 0320-INPUT-ERROR.
  7363
  7364     IF WS-RESP-NOTFND
  7365         MOVE ZERO               TO  CP-FREE-LOOK
  7366     ELSE
  7367         MOVE CF-ST-FREE-LOOK-PERIOD
  7368                                 TO CP-FREE-LOOK.
  7369
  7370     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7371        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7372        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7373     END-IF
  7374
  7375     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7376
  7377     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7378        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7379        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7380        COMPUTE CP-REMAINING-TERM-1 =
  7381                CP-REMAINING-TERM-1 - +1
  7382        COMPUTE CP-REMAINING-TERM-2 =
  7383                CP-REMAINING-TERM-2 - +1
  7384     END-IF
  7385
  7386     IF CP-REMAINING-TERM-1 NEGATIVE
  7387        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7388     END-IF
  7389     IF CP-REMAINING-TERM-2 NEGATIVE
  7390        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7391     END-IF
  7392     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7393
  7394     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7395         GO TO 0640-AH-BENEFIT.
  7396*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7397*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7398
  7399     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7400         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7401             MOVE ER-0681        TO  EMI-ERROR
  7402             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7403
  7404     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7405         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 135
* EL1278.cbl
  7406             MOVE ER-0682        TO  EMI-ERROR
  7407             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7408
  7409 0630-CONTINUE-LIFE.
  7410
  7411     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7412        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7413        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7414                                    FREMTRMO
  7415     ELSE
  7416        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7417                                     FREMTRMO
  7418     END-IF
  7419     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  7420     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7421     if pi-company-id = 'AHL'
  7422        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7423        if cp-class-code = spaces
  7424           move zeros            to cp-class-code
  7425        end-if
  7426     ELSE
  7427        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7428     END-IF
  7429     IF (PI-COMPANY-ID = 'DCC')
  7430        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7431        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7432        PERFORM 0730-GET-DDF-FACTORS
  7433                                 THRU 0730-EXIT
  7434        IF PDEF-FOUND
  7435           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7436              (P1 > +8)
  7437              OR (PD-PROD-CODE (P1) = 'L')
  7438           END-PERFORM
  7439           IF P1 < +9
  7440              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7441           END-IF
  7442        END-IF
  7443     END-IF
  7444     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7445
  7446     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7447
  7448     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7449        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7450                             + CM-LF-ALT-PREMIUM-AMT
  7451     ELSE
  7452        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7453     END-IF
  7454
  7455     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7456                                     WS-TOT-LF-PREM.
  7457
  7458     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7459        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7460        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7461     ELSE
  7462        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7463     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 136
* EL1278.cbl
  7464
  7465     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7466     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7467
  7468     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7469         MOVE WS-LF-ST-REFUND-CALC
  7470                                 TO  CP-EARNING-METHOD.
  7471
  7472     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7473         MOVE WS-LF-FO-REFUND-CALC
  7474                                 TO  CP-EARNING-METHOD.
  7475
  7476     if (pi-company-id = 'CID')
  7477        and (cp-state-std-abbrv = 'MN' OR 'WA')
  7478        continue
  7479     else
  7480        IF CP-RATING-METHOD = '4'
  7481           MOVE '4'              TO CP-EARNING-METHOD
  7482        END-IF
  7483     end-if
  7484*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7485*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7486*            MOVE WS-AM-EARN-METHOD-R
  7487*                                TO  CP-EARNING-METHOD
  7488*        END-IF
  7489*    ELSE
  7490*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7491*            MOVE WS-AM-EARN-METHOD-L
  7492*                                TO  CP-EARNING-METHOD.
  7493
  7494     if pi-company-id = 'AHL'
  7495        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7496        if cp-class-code = spaces
  7497           move zeros            to cp-class-code
  7498        end-if
  7499     ELSE
  7500        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7501     END-IF
  7502     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7503     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7504                                     CP-RATING-BENEFIT-AMT.
  7505     IF CP-STATE-STD-ABBRV = 'OR'
  7506         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7507                                         CM-LF-ALT-BENEFIT-AMT.
  7508****   N O T E   ****
  7509*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7510*      THE OH HARD CODING IN ELCRFNDP
  7511
  7512     IF PI-COMPANY-ID = 'CID'
  7513        IF CP-STATE-STD-ABBRV = 'OH'
  7514           MOVE WS-LF-CO-EARNINGS-CALC
  7515                                 TO CP-EARNING-METHOD
  7516        END-IF
  7517     END-IF
  7518
  7519****   N O T E   ****
  7520
  7521****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 137
* EL1278.cbl
  7522****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7523****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7524****     THE APPROPRIATE OPTIONS HERE
  7525*    IF PI-COMPANY-ID = 'CID'
  7526*       IF (CP-STATE-STD-ABBRV = 'MN')
  7527*          AND (CM-CERT-EFF-DT > X'A4FF')
  7528*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7529*          MOVE '5'              TO CP-EARNING-METHOD
  7530*       END-IF
  7531*    END-IF
  7532     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7533     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7534     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7535     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7536     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7537     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7538
  7539*    IF CP-EARN-AS-NET-PAY
  7540*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7541*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7542*               MOVE WS-CF-DEFAULT-APR
  7543*                                TO  CP-LOAN-APR
  7544*               MOVE ER-3780     TO  EMI-ERROR
  7545*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7546*           ELSE
  7547*               MOVE ER-3781     TO  EMI-ERROR
  7548*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7549
  7550*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7551*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7552*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7553*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7554*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7555*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7556*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7557*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7558*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7559*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7560*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7561*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7562*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7563*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7564*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7565*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7566*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7567*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7568     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7569
  7570     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7571
  7572     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7573
  7574     IF CP-ERROR-RATE-IS-ZERO
  7575       OR CP-ERROR-RATE-NOT-FOUND
  7576         MOVE ER-2740            TO  EMI-ERROR
  7577         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7578
  7579     IF CP-ERROR-RATE-FILE-NOTOPEN
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 138
* EL1278.cbl
  7580         MOVE ER-2617            TO  EMI-ERROR
  7581         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7582
  7583     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7584     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7585                                     WS-TOT-LF-RFND
  7586                                     PI-LF-REFUND-AMT.
  7587     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7588
  7589     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7590     move cm-life-comm-pct       to hlcpcto
  7591     compute hlcamto rounded =
  7592        cp-calc-refund * cm-life-comm-pct
  7593     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7594         GO TO 0640-AH-BENEFIT.
  7595
  7596*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7597*        ADD +1                  TO  CP-REMAINING-TERM
  7598*                                    CP-ORIGINAL-TERM.
  7599
  7600     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7601     MOVE '2'                    TO  CP-EARNING-METHOD
  7602                                     CP-RATING-METHOD.
  7603     IF PI-COMPANY-ID = 'CID'
  7604        IF (CP-STATE-STD-ABBRV = 'MN')
  7605           AND (CM-CERT-EFF-DT > X'A4FF')
  7606           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7607           MOVE '5'              TO CP-EARNING-METHOD
  7608           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7609        END-IF
  7610     END-IF
  7611     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7612                                     CP-REMAINING-BENEFIT
  7613                                     CP-RATING-BENEFIT-AMT.
  7614     IF CP-STATE-STD-ABBRV = 'OR'
  7615         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7616                                         CM-LF-ALT-BENEFIT-AMT.
  7617     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7618     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7619
  7620     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7621
  7622     IF CP-ERROR-RATE-IS-ZERO
  7623       OR CP-ERROR-RATE-NOT-FOUND
  7624         MOVE ER-2740            TO  EMI-ERROR
  7625         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7626
  7627     IF CP-ERROR-RATE-FILE-NOTOPEN
  7628         MOVE ER-2617            TO  EMI-ERROR
  7629         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7630
  7631     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7632
  7633     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7634                                     WS-TOT-LF-RFND
  7635                                     PI-LF-REFUND-AMT.
  7636
  7637     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 139
* EL1278.cbl
  7638
  7639 0640-AH-BENEFIT.
  7640     IF CM-AH-BENEFIT-CD = '00'
  7641         GO TO 0680-CONTINUE.
  7642
  7643 0650-GET-AH-BENEFIT.
  7644     IF ACCT-FOUND
  7645         MOVE +1                 TO SUB3
  7646         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7647     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7648     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7649     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7650     MOVE WS-AH-KIND             TO  HAEDESCO.
  7651     EVALUATE TRUE
  7652        WHEN ((OPEN-LF-CLAIM)
  7653           OR (CLOSED-LF-CLAIM))
  7654           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7655           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7656                                    WS-TOT-AH-RFND
  7657                                    PI-AH-REFUND-AMT
  7658           MOVE SPACES           TO PI-AH-REFUND-METH
  7659           IF OTHER-CLAIM
  7660              MOVE ER-2998          TO EMI-ERROR
  7661           ELSE
  7662              MOVE ER-2965          TO EMI-ERROR
  7663           END-IF
  7664           PERFORM 9700-ERROR-FORMAT
  7665                                 THRU  9799-EXIT
  7666           GO TO 0680-CONTINUE
  7667        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7668           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7669           AND ((EMI-ERROR = ER-2965) OR (EMI-ERROR = ER-2998))
  7670           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7671           MOVE ZEROS            TO HAREFNDO
  7672                                    WS-TOT-AH-RFND
  7673                                    PI-AH-REFUND-AMT
  7674           MOVE SPACES           TO PI-AH-REFUND-METH
  7675           GO TO 0680-CONTINUE
  7676        WHEN (OPEN-AH-CLAIM)
  7677           AND (WS-ST-REF-IND = '1')
  7678           MOVE ZEROS            TO HAREFNDO
  7679                                    WS-TOT-AH-RFND
  7680                                    PI-AH-REFUND-AMT
  7681           MOVE ER-3039          TO EMI-ERROR
  7682           PERFORM 9700-ERROR-FORMAT
  7683                                 THRU  9799-EXIT
  7684           GO TO 0680-CONTINUE
  7685        WHEN (OPEN-AH-CLAIM)
  7686           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7687           MOVE ER-3037          TO EMI-ERROR
  7688           PERFORM 9700-ERROR-FORMAT
  7689                                 THRU  9799-EXIT
  7690*          CONTINUE
  7691        WHEN (OPEN-AH-CLAIM)
  7692           AND (WS-ST-REF-IND = '5')
  7693           MOVE ER-3038          TO EMI-ERROR
  7694           PERFORM 9700-ERROR-FORMAT
  7695                                 THRU  9799-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 140
* EL1278.cbl
  7696*          CONTINUE
  7697        WHEN (OPEN-AH-CLAIM)
  7698           AND (WS-ST-REF-IND = ' ')
  7699           MOVE ER-2768          TO EMI-ERROR
  7700           PERFORM 9700-ERROR-FORMAT
  7701                                 THRU  9799-EXIT
  7702        WHEN (CLOSED-AH-CLAIM)
  7703           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7704           MOVE ZEROS            TO HAREFNDO
  7705                                    WS-TOT-AH-RFND
  7706                                    PI-AH-REFUND-AMT
  7707           MOVE ER-2756          TO EMI-ERROR
  7708           PERFORM 9700-ERROR-FORMAT
  7709                                 THRU  9799-EXIT
  7710           IF WS-TOT-LF-RFND > 0
  7711              MOVE ZEROS         TO HLREFNDO
  7712                                    WS-TOT-LF-RFND
  7713                                    PI-LF-REFUND-AMT
  7714              MOVE SPACES        TO PI-LF-REFUND-METH
  7715           END-IF
  7716           GO TO 0680-CONTINUE
  7717*       WHEN OTHER
  7718*          CONTINUE
  7719     END-EVALUATE
  7720     .
  7721 0660-GET-REM-TERM.
  7722     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7723     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7724     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7725     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7726     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7727*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7728     MOVE WS-AH-KIND             TO  HAEDESCO.
  7729     MOVE CM-STATE               TO  CP-STATE.
  7730     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7731     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7732     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7733     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7734     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7735     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7736     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7737     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7738     MOVE WS-CF-CR-REM-TERM-CALC
  7739                                 TO  CP-REM-TERM-METHOD.
  7740
  7741     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7742         MOVE WS-AH-CO-REM-TERM-CALC
  7743                                 TO  CP-REM-TERM-METHOD.
  7744
  7745     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7746         MOVE WS-AH-ST-REM-TERM-CALC
  7747                                 TO  CP-REM-TERM-METHOD.
  7748
  7749     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7750         MOVE WS-AH-AM-REM-TERM-CALC
  7751                                 TO  CP-REM-TERM-METHOD.
  7752     IF (PI-COMPANY-ID = 'CID')
  7753        AND (CP-STATE-STD-ABBRV = 'WI')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 141
* EL1278.cbl
  7754        MOVE '7'                 TO CP-REM-TERM-METHOD
  7755        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7756     END-IF
  7757     IF (PI-COMPANY-ID = 'CID')
  7758        AND (CP-STATE-STD-ABBRV = 'MO')
  7759        AND (CM-CERT-EFF-DT >= X'9B41')
  7760        AND (CM-CERT-EFF-DT <= X'A2FB')
  7761        MOVE '7'                 TO CP-REM-TERM-METHOD
  7762        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7763     END-IF
  7764
  7765     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7766                                     CP-ORIGINAL-TERM
  7767                                     CP-LOAN-TERM.
  7768
  7769     IF  NOT  CP-TERM-IS-DAYS
  7770         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7771             MOVE CM-PMT-EXTENSION-DAYS
  7772                                 TO  CP-TERM-OR-EXT-DAYS
  7773         ELSE
  7774             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7775
  7776*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7777     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7778     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7779     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7780     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7781
  7782
  7783* EXEC CICS READ
  7784*        DATASET  (ELCNTL-ID)
  7785*        SET      (ADDRESS OF CONTROL-FILE)
  7786*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7787*        RESP     (WS-RESPONSE)
  7788*    END-EXEC.
  7789*    MOVE '&"S        E          (  N#00007624' TO DFHEIV0
  7790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7792     MOVE X'204E233030303037363234' TO DFHEIV0(25:11)
  7793     CALL 'kxdfhei1' USING DFHEIV0,
  7794           ELCNTL-ID,
  7795           DFHEIV20,
  7796           DFHEIV99,
  7797           WS-CF-CONTROL-PRIMARY,
  7798           DFHEIV99,
  7799           DFHEIV99,
  7800           DFHEIV99
  7801     SET ADDRESS OF CONTROL-FILE TO
  7802         DFHEIV20
  7803     MOVE EIBRESP  TO WS-RESPONSE
  7804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7805
  7806
  7807     IF WS-RESP-NOTOPEN
  7808         MOVE ER-2617            TO  EMI-ERROR
  7809         GO TO 0320-INPUT-ERROR.
  7810
  7811     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 142
* EL1278.cbl
  7812         MOVE ZERO               TO CP-FREE-LOOK
  7813     ELSE
  7814         MOVE CF-ST-FREE-LOOK-PERIOD
  7815                                 TO CP-FREE-LOOK.
  7816
  7817     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7818
  7819     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7820
  7821     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7822         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7823             MOVE ER-0683        TO  EMI-ERROR
  7824             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7825
  7826     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7827         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7828             MOVE ER-0684        TO  EMI-ERROR
  7829             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7830
  7831 0670-CONTINUE-AH.
  7832     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7833                                     WS-TOT-AH-PREM
  7834     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7835
  7836     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7837         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7838
  7839     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7840        GO TO 0680-CONTINUE.
  7841     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7842     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7843     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7844
  7845     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7846         MOVE WS-AH-ST-REFUND-CALC
  7847                                 TO  CP-EARNING-METHOD.
  7848
  7849     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7850         MOVE WS-AH-FO-REFUND-CALC
  7851                                 TO  CP-EARNING-METHOD.
  7852
  7853*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7854*        MOVE WS-AM-EARN-METHOD-A
  7855*                                TO  CP-EARNING-METHOD.
  7856
  7857     if pi-company-id = 'AHL'
  7858        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7859        if cp-class-code = spaces
  7860           move zeros            to cp-class-code
  7861        end-if
  7862     ELSE
  7863        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7864     END-IF
  7865     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7866     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7867                                     CP-RATING-BENEFIT-AMT.
  7868     IF CP-STATE-STD-ABBRV = 'OR'
  7869         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 143
* EL1278.cbl
  7870                                         CM-AH-ORIG-TERM.
  7871     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7872     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7873     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7874     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7875     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7876     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7877
  7878     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7879     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7880     MOVE ' '                    TO  DC-OPTION-CODE.
  7881
  7882     PERFORM 9600-DATE-LINK.
  7883
  7884     IF CP-STATE-STD-ABBRV = 'OH'
  7885        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7886         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7887           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7888           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7889             MOVE '6'            TO  CP-EARNING-METHOD
  7890         END-IF
  7891        END-IF
  7892        IF PI-COMPANY-ID = 'CID'
  7893           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7894                           LOW-VALUES)
  7895              IF CP-CRITICAL-PERIOD
  7896                 MOVE '2'       TO CP-EARNING-METHOD
  7897              ELSE
  7898                 MOVE '6'       TO CP-EARNING-METHOD
  7899              END-IF
  7900           ELSE
  7901              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7902                 MOVE '2'       TO CP-EARNING-METHOD
  7903              ELSE
  7904                 IF ((CM-LF-ORIG-TERM > 60) AND
  7905                    (CM-RATE-CLASS NOT = 'L '))
  7906                               OR
  7907                    (WS-LF-CO-EARNINGS-CALC = '5')
  7908                    IF CP-CRITICAL-PERIOD
  7909                       MOVE '2'  TO CP-EARNING-METHOD
  7910                    ELSE
  7911                       MOVE '6'  TO CP-EARNING-METHOD
  7912                    END-IF
  7913                 ELSE
  7914                    MOVE '1'     TO CP-EARNING-METHOD
  7915                 END-IF
  7916              END-IF
  7917           END-IF
  7918        END-IF
  7919     END-IF
  7920
  7921     IF CP-STATE-STD-ABBRV = 'VA'
  7922       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7923         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7924            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7925                MOVE '6'            TO  CP-EARNING-METHOD
  7926            ELSE
  7927                MOVE '1'            TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 144
* EL1278.cbl
  7928
  7929     IF CP-EARN-AS-NET-PAY
  7930         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7931            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7932                MOVE WS-CF-DEFAULT-APR
  7933                                 TO  CP-LOAN-APR
  7934                MOVE ER-3780     TO  EMI-ERROR
  7935                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7936            ELSE
  7937                MOVE ER-3781     TO  EMI-ERROR
  7938                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7939     IF PI-COMPANY-ID = 'DCC'
  7940        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7941           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7942           MOVE 'S'              TO CP-EARNING-METHOD
  7943        END-IF
  7944     END-IF
  7945     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7946     IF (PI-COMPANY-ID = 'DCC')
  7947        AND (CP-EARNING-METHOD = 'D')
  7948        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7949                                    WS-DDF-CSO-ADMIN-FEE
  7950                                    WS-DDF-1ST-YR-TOT-EXP
  7951                                    WS-DDF-COMM-AND-MFEE
  7952        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7953           S1 > +10
  7954           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7955              IF (AM-A-COM (S1) NUMERIC)
  7956                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7957                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7958              ELSE
  7959                 MOVE +0         TO WS-COMM-PCT C0
  7960                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7961                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7962              END-IF
  7963              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7964                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7965                    + WS-COMM-PCT
  7966              END-IF
  7967              IF AM-COM-TYP (S1) = 'N'
  7968                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7969                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7970              END-IF
  7971              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7972                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7973                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7974              END-IF
  7975              IF AM-COM-TYP (S1) = 'I'
  7976                 COMPUTE WS-DDF-COMM-AND-MFEE
  7977                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7978              END-IF
  7979           END-IF
  7980        END-PERFORM
  7981        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7982        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7983        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7984           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7985     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 145
* EL1278.cbl
  7986     IF (PI-COMPANY-ID = 'DCC')
  7987        AND (CP-EARNING-METHOD = 'D')
  7988        AND (PI-CANCEL-REASON NOT = 'R')
  7989        PERFORM 0730-GET-DDF-FACTORS
  7990                                 THRU 0730-EXIT
  7991        IF NOT PDEF-FOUND
  7992           MOVE ER-9999          TO EMI-ERROR
  7993           PERFORM 9700-ERROR-FORMAT
  7994                                 THRU 9799-EXIT
  7995           GO TO 8200-SEND-DATAONLY
  7996        END-IF
  7997        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7998                                 TO CP-DDF-LO-FACT
  7999        MOVE PD-UEP-FACTOR (P1 P2)
  8000                                 TO CP-DDF-HI-FACT
  8001        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  8002        MOVE CM-AH-CLP           TO CP-DDF-CLP
  8003        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  8004        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  8005           + PD-1ST-YR-ADMIN-ALLOW
  8006        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  8007        IF PI-CLP-YN = 'Y'
  8008           MOVE 'C'              TO CP-DDF-SPEC-CALC
  8009           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  8010                                    CP-DDF-CLP
  8011           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  8012        END-IF
  8013        IF DD-IU-PRESENT
  8014           MOVE 'I'              TO CP-EARNING-METHOD
  8015        END-IF
  8016        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  8017                                    CP-CLP-RATE-UP
  8018        IF (CP-CALC-GROSS-FEE)
  8019           AND (CP-IU-RATE-UP NOT = ZEROS)
  8020           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  8021              / CP-ORIGINAL-PREMIUM)
  8022           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  8023              / (1 - TEX-FACT-8)
  8024        END-IF
  8025     END-IF
  8026     if pi-company-id = 'VPP'
  8027        IF PI-CLP-YN = 'Y'
  8028           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  8029                                    hapremo
  8030                                    CP-DDF-CLP
  8031        END-IF
  8032     end-if
  8033     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  8034
  8035     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  8036
  8037     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  8038
  8039     IF CP-ERROR-RATE-IS-ZERO
  8040       OR CP-ERROR-RATE-NOT-FOUND
  8041         MOVE ER-2740            TO  EMI-ERROR
  8042         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8043
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 146
* EL1278.cbl
  8044     IF CP-ERROR-RATE-FILE-NOTOPEN
  8045         MOVE ER-2617            TO  EMI-ERROR
  8046         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8047
  8048     MOVE ZEROS                  TO  WS-CALC-REFUND.
  8049     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  8050                                     WS-TOT-AH-RFND
  8051                                     PI-AH-REFUND-AMT.
  8052     move cm-ah-comm-pct         to hacpcto
  8053     compute hacamto rounded =
  8054        cp-calc-refund * cm-ah-comm-pct
  8055     if pi-company-id = 'VPP'
  8056        if cp-calc-refund < cm-cancel-fee
  8057           move cp-calc-refund   to cm-cancel-fee
  8058        end-if
  8059        if cp-calc-refund = cm-ah-premium-amt
  8060           move zeros            to cm-cancel-fee
  8061        end-if
  8062        move cm-cancel-fee       to canfeeo
  8063        compute refdueo =
  8064           cp-calc-refund - cm-cancel-fee
  8065     end-if
  8066
  8067     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  8068
  8069     MOVE AL-UANON               TO  HACANCA.
  8070
  8071 0680-CONTINUE.
  8072     IF BROWSE-STARTED
  8073         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  8074         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  8075
  8076     IF CM-LF-BENEFIT-CD = '00'
  8077         MOVE -1                 TO  HACANCL
  8078     ELSE
  8079         MOVE -1                 TO  HLCANCL.
  8080
  8081     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  8082                           WS-TOT-PREM.
  8083     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  8084                           WS-TOT-RFND.
  8085
  8086     MOVE WS-TOT-PREM            TO  TOPREMO.
  8087     MOVE WS-TOT-RFND            TO  TORFNDO.
  8088
  8089 0680-EXIT.
  8090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 147
* EL1278.cbl
  8092 0700-LINK-REM-TERM SECTION.
  8093
  8094* EXEC CICS LINK
  8095*        PROGRAM   (ELRTRM-ID)
  8096*        COMMAREA  (CALCULATION-PASS-AREA)
  8097*        LENGTH    (CP-COMM-LENGTH)
  8098*    END-EXEC.
  8099*    MOVE '."C                   (   #00007917' TO DFHEIV0
  8100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8102     MOVE X'2020233030303037393137' TO DFHEIV0(25:11)
  8103     CALL 'kxdfhei1' USING DFHEIV0,
  8104           ELRTRM-ID,
  8105           CALCULATION-PASS-AREA,
  8106           CP-COMM-LENGTH,
  8107           DFHEIV99,
  8108           DFHEIV99,
  8109           DFHEIV99,
  8110           DFHEIV99
  8111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8112
  8113
  8114 0700-EXIT.
  8115     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 148
* EL1278.cbl
  8117 0710-LINK-REM-AMOUNT SECTION.
  8118
  8119* EXEC CICS LINK
  8120*        PROGRAM   (ELRAMT-ID)
  8121*        COMMAREA  (CALCULATION-PASS-AREA)
  8122*        LENGTH    (CP-COMM-LENGTH)
  8123*    END-EXEC.
  8124*    MOVE '."C                   (   #00007927' TO DFHEIV0
  8125     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8127     MOVE X'2020233030303037393237' TO DFHEIV0(25:11)
  8128     CALL 'kxdfhei1' USING DFHEIV0,
  8129           ELRAMT-ID,
  8130           CALCULATION-PASS-AREA,
  8131           CP-COMM-LENGTH,
  8132           DFHEIV99,
  8133           DFHEIV99,
  8134           DFHEIV99,
  8135           DFHEIV99
  8136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8137
  8138
  8139 0710-EXIT.
  8140     EXIT.
  8141 0730-GET-DDF-FACTORS.
  8142     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8143     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8144     MOVE CM-STATE               TO ERPDEF-STATE
  8145     if cm-clp-state <> cm-state and spaces
  8146                  and low-values and zeros
  8147        move cm-clp-state        to erpdef-state
  8148     end-if
  8149     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8150     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8151     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8152     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8153     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8154
  8155* EXEC CICS STARTBR
  8156*        DATASET  ('ERPDEF')
  8157*        RIDFLD   (ERPDEF-KEY)
  8158*        GTEQ
  8159*        RESP     (WS-RESPONSE)
  8160*    END-EXEC
  8161     MOVE 'ERPDEF' TO DFHEIV1
  8162     MOVE 0
  8163       TO DFHEIV11
  8164*    MOVE '&,         G          &  N#00007948' TO DFHEIV0
  8165     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8166     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8167     MOVE X'204E233030303037393438' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0,
  8169           DFHEIV1,
  8170           ERPDEF-KEY,
  8171           DFHEIV99,
  8172           DFHEIV11,
  8173           DFHEIV99
  8174     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 149
* EL1278.cbl
  8175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8176     IF NOT WS-RESP-NORMAL
  8177        GO TO 0730-EXIT
  8178     END-IF
  8179     .
  8180 0730-READNEXT.
  8181
  8182* EXEC CICS READNEXT
  8183*       DATASET  ('ERPDEF')
  8184*       SET      (ADDRESS OF PRODUCT-MASTER)
  8185*       RIDFLD   (ERPDEF-KEY)
  8186*       RESP     (WS-RESPONSE)
  8187*    END-EXEC
  8188     MOVE 'ERPDEF' TO DFHEIV1
  8189     MOVE 0
  8190       TO DFHEIV11
  8191*    MOVE '&.S                   )  N#00007959' TO DFHEIV0
  8192     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8193     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8194     MOVE X'204E233030303037393539' TO DFHEIV0(25:11)
  8195     CALL 'kxdfhei1' USING DFHEIV0,
  8196           DFHEIV1,
  8197           DFHEIV20,
  8198           DFHEIV99,
  8199           ERPDEF-KEY,
  8200           DFHEIV99,
  8201           DFHEIV11,
  8202           DFHEIV99,
  8203           DFHEIV99
  8204     SET ADDRESS OF PRODUCT-MASTER TO
  8205         DFHEIV20
  8206     MOVE EIBRESP  TO WS-RESPONSE
  8207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8208     IF NOT WS-RESP-NORMAL
  8209        GO TO 0730-ENDBR
  8210     END-IF
  8211     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8212        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8213           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8214        ELSE
  8215           GO TO 0730-READNEXT
  8216        END-IF
  8217     ELSE
  8218        GO TO 0730-ENDBR
  8219     END-IF
  8220     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8221        (P1 > +8)
  8222        OR (PD-PROD-CODE (P1) = 'I')
  8223     END-PERFORM
  8224     IF P1 < +9
  8225        SET DD-IU-PRESENT        TO TRUE
  8226     END-IF
  8227     IF CM-LOAN-TERM = ZEROS
  8228        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  8229     END-IF
  8230     IF PD-TRUNCATED = 'Y'
  8231        MOVE CM-LOAN-TERM        TO WS-TERM
  8232     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 150
* EL1278.cbl
  8233        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  8234     END-IF
  8235     EVALUATE TRUE
  8236        WHEN WS-TERM > +168
  8237           MOVE 15               TO P1
  8238        WHEN WS-TERM > +156
  8239           MOVE 14               TO P1
  8240        WHEN WS-TERM > +144
  8241           MOVE 13               TO P1
  8242        WHEN WS-TERM > +132
  8243           MOVE 12               TO P1
  8244        WHEN WS-TERM > +120
  8245           MOVE 11               TO P1
  8246        WHEN WS-TERM > +108
  8247           MOVE 10               TO P1
  8248        WHEN WS-TERM > +96
  8249           MOVE 9                TO P1
  8250        WHEN WS-TERM > +84
  8251           MOVE 8                TO P1
  8252        WHEN WS-TERM > +72
  8253           MOVE 7                TO P1
  8254        WHEN WS-TERM > +60
  8255           MOVE 6                TO P1
  8256        WHEN WS-TERM > +48
  8257           MOVE 5                TO P1
  8258        WHEN WS-TERM > +36
  8259           MOVE 4                TO P1
  8260        WHEN WS-TERM > +24
  8261           MOVE 3                TO P1
  8262        WHEN WS-TERM > +12
  8263           MOVE 2                TO P1
  8264        WHEN OTHER
  8265           MOVE 1                TO P1
  8266     END-EVALUATE
  8267     EVALUATE TRUE
  8268*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  8269*          AND (DD-IU-PRESENT)
  8270*          MOVE 2                TO P2
  8271*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  8272*          MOVE 1                TO P2
  8273        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  8274           MOVE 2                TO P2
  8275        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  8276           MOVE 3                TO P2
  8277        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  8278           MOVE 4                TO P2
  8279        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  8280           MOVE 5                TO P2
  8281        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  8282           MOVE 6                TO P2
  8283        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  8284           MOVE 7                TO P2
  8285        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  8286           MOVE 8                TO P2
  8287        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  8288           MOVE 9                TO P2
  8289        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  8290           MOVE 10               TO P2
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 151
* EL1278.cbl
  8291        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  8292           MOVE 11               TO P2
  8293        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  8294           MOVE 12               TO P2
  8295        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  8296           MOVE 13               TO P2
  8297        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  8298           MOVE 14               TO P2
  8299        WHEN OTHER
  8300           MOVE 15               TO P2
  8301     END-EVALUATE
  8302     .
  8303 0730-ENDBR.
  8304
  8305* EXEC CICS ENDBR
  8306*       DATASET  ('ERPDEF')
  8307*    END-EXEC
  8308     MOVE 'ERPDEF' TO DFHEIV1
  8309     MOVE 0
  8310       TO DFHEIV11
  8311*    MOVE '&2                    $   #00008061' TO DFHEIV0
  8312     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8313     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8314     MOVE X'2020233030303038303631' TO DFHEIV0(25:11)
  8315     CALL 'kxdfhei1' USING DFHEIV0,
  8316           DFHEIV1,
  8317           DFHEIV11,
  8318           DFHEIV99
  8319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8320     .
  8321 0730-EXIT.
  8322     EXIT.
  8323 0740-GET-ERCTBL.
  8324     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8325     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8326     MOVE 'A'                    TO CTBL-BEN-TYPE
  8327     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8328     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8329     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8330     IF WS-RESP-NORMAL
  8331        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8332     ELSE
  8333        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8334        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8335        MOVE 'A'                    TO CTBL-BEN-TYPE
  8336        MOVE 'AA'                   TO CTBL-BEN-CODE
  8337        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8338        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8339        IF WS-RESP-NORMAL
  8340           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8341        END-IF
  8342     END-IF
  8343     .
  8344 0740-EXIT.
  8345     EXIT.
  8346 0750-READ-ERCTBL.
  8347
  8348* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 152
* EL1278.cbl
  8349*         INTO    (COMM-TABLE-RECORD)
  8350*         DATASET ('ERCTBL')
  8351*         RIDFLD  (CTBL-KEY)
  8352*         RESP    (WS-RESPONSE)
  8353*    END-EXEC
  8354     MOVE LENGTH OF
  8355      COMM-TABLE-RECORD
  8356       TO DFHEIV11
  8357     MOVE 'ERCTBL' TO DFHEIV1
  8358*    MOVE '&"IL       E          (  N#00008091' TO DFHEIV0
  8359     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8361     MOVE X'204E233030303038303931' TO DFHEIV0(25:11)
  8362     CALL 'kxdfhei1' USING DFHEIV0,
  8363           DFHEIV1,
  8364           COMM-TABLE-RECORD,
  8365           DFHEIV11,
  8366           CTBL-KEY,
  8367           DFHEIV99,
  8368           DFHEIV99,
  8369           DFHEIV99
  8370     MOVE EIBRESP  TO WS-RESPONSE
  8371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8372     .
  8373 0750-EXIT.
  8374     EXIT.
  8375 0760-FIND-COMM.
  8376     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8377        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8378        OR (C1 > +3)
  8379     END-PERFORM
  8380     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8381        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8382        OR (C2 > +3)
  8383     END-PERFORM
  8384     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8385        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8386        OR (C3 > +3)
  8387     END-PERFORM
  8388     IF C1 > +3
  8389        MOVE +1                  TO C1
  8390     END-IF
  8391     IF C2 > +3
  8392        MOVE +1                  TO C2
  8393     END-IF
  8394     IF C3 > +3
  8395        MOVE +1                  TO C3
  8396     END-IF
  8397     IF C1 = +3
  8398        MOVE +18                 TO C0
  8399     ELSE
  8400        IF C1 = +2
  8401           MOVE +9               TO C0
  8402        END-IF
  8403     END-IF
  8404     IF C2 = +3
  8405        ADD +6                   TO C0
  8406     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 153
* EL1278.cbl
  8407        IF C2 = +2
  8408           ADD +3                TO C0
  8409        END-IF
  8410     END-IF
  8411     ADD C3                      TO C0
  8412     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8413     .
  8414 0760-EXIT.
  8415     EXIT.
  8416 0800-LINK-REFUND SECTION.
  8417     IF CP-AH
  8418       IF PI-EARNING-METHOD-AH NOT = SPACES
  8419         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8420        ELSE
  8421         NEXT SENTENCE
  8422      ELSE
  8423       IF PI-EARNING-METHOD-LF NOT = SPACES
  8424         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8425
  8426
  8427* EXEC CICS LINK
  8428*        PROGRAM   (ELRFND-ID)
  8429*        COMMAREA  (CALCULATION-PASS-AREA)
  8430*        LENGTH    (CP-COMM-LENGTH)
  8431*    END-EXEC.
  8432*    MOVE '."C                   (   #00008151' TO DFHEIV0
  8433     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8435     MOVE X'2020233030303038313531' TO DFHEIV0(25:11)
  8436     CALL 'kxdfhei1' USING DFHEIV0,
  8437           ELRFND-ID,
  8438           CALCULATION-PASS-AREA,
  8439           CP-COMM-LENGTH,
  8440           DFHEIV99,
  8441           DFHEIV99,
  8442           DFHEIV99,
  8443           DFHEIV99
  8444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8445
  8446
  8447 0899-EXIT.
  8448     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 154
* EL1278.cbl
  8450 0900-READ-CERT-FILE  SECTION.
  8451
  8452* EXEC CICS HANDLE CONDITION
  8453*        NOTFND  (0910-NOT-FOUND)
  8454*    END-EXEC.
  8455*    MOVE '"$I                   ! # #00008161' TO DFHEIV0
  8456     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8458     MOVE X'2320233030303038313631' TO DFHEIV0(25:11)
  8459     CALL 'kxdfhei1' USING DFHEIV0
  8460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8461
  8462
  8463
  8464* EXEC CICS READ
  8465*        DATASET  (ELCERT-ID)
  8466*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8467*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8468*    END-EXEC.
  8469*    MOVE '&"S        E          (   #00008165' TO DFHEIV0
  8470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8472     MOVE X'2020233030303038313635' TO DFHEIV0(25:11)
  8473     CALL 'kxdfhei1' USING DFHEIV0,
  8474           ELCERT-ID,
  8475           DFHEIV20,
  8476           DFHEIV99,
  8477           WS-CM-CONTROL-PRIMARY,
  8478           DFHEIV99,
  8479           DFHEIV99,
  8480           DFHEIV99
  8481     SET ADDRESS OF CERTIFICATE-MASTER TO
  8482         DFHEIV20
  8483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8484
  8485
  8486*    SERVICE RELOAD CERTIFICATE-MASTER.
  8487
  8488     GO TO 0999-EXIT.
  8489
  8490 0910-NOT-FOUND.
  8491     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8492
  8493 0999-EXIT.
  8494     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 155
* EL1278.cbl
  8496 1000-READ-CONTROL  SECTION.
  8497
  8498* EXEC CICS HANDLE CONDITION
  8499*        NOTFND   (1010-NOTFND)
  8500*        NOTOPEN  (1020-NOTOPEN)
  8501*    END-EXEC.
  8502*    MOVE '"$IJ                  ! $ #00008182' TO DFHEIV0
  8503     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8505     MOVE X'2420233030303038313832' TO DFHEIV0(25:11)
  8506     CALL 'kxdfhei1' USING DFHEIV0
  8507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8508
  8509
  8510
  8511* EXEC CICS READ
  8512*        DATASET  (ELCNTL-ID)
  8513*        SET      (ADDRESS OF CONTROL-FILE)
  8514*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8515*        GTEQ
  8516*    END-EXEC.
  8517*    MOVE '&"S        G          (   #00008187' TO DFHEIV0
  8518     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8520     MOVE X'2020233030303038313837' TO DFHEIV0(25:11)
  8521     CALL 'kxdfhei1' USING DFHEIV0,
  8522           ELCNTL-ID,
  8523           DFHEIV20,
  8524           DFHEIV99,
  8525           WS-CF-CONTROL-PRIMARY,
  8526           DFHEIV99,
  8527           DFHEIV99,
  8528           DFHEIV99
  8529     SET ADDRESS OF CONTROL-FILE TO
  8530         DFHEIV20
  8531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8532
  8533
  8534*    SERVICE RELOAD CONTROL-FILE.
  8535
  8536     GO TO 1099-EXIT.
  8537
  8538 1010-NOTFND.
  8539     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8540
  8541     GO TO 1099-EXIT.
  8542
  8543 1020-NOTOPEN.
  8544     MOVE ER-2617                TO  EMI-ERROR.
  8545
  8546     GO TO 0320-INPUT-ERROR.
  8547
  8548 1099-EXIT.
  8549     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 156
* EL1278.cbl
  8551 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8552     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8553
  8554     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8555         VARYING  SUB3  FROM  1  BY  1
  8556             UNTIL  ((SUB3  IS GREATER THAN  50)
  8557               OR ((CF-ST-BENEFIT-CD (SUB3)
  8558                      IS EQUAL TO  WS-BEN-CD)
  8559               AND (WS-LOOKUP-TYPE
  8560                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8561
  8562     IF SUB3  IS NOT EQUAL TO  51
  8563         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8564
  8565     GO TO 1199-EXIT.
  8566
  8567 1110-BENEFIT-DUMMY.
  8568
  8569 1119-EXIT.
  8570     EXIT.
  8571
  8572 1199-EXIT.
  8573     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 157
* EL1278.cbl
  8575 1200-START-ACCOUNT-MASTER  SECTION.
  8576
  8577* EXEC CICS HANDLE CONDITION
  8578*        NOTFND   (1290-ACCT-NOT-FOUND)
  8579*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8580*    END-EXEC.
  8581*    MOVE '"$I''                  ! % #00008236' TO DFHEIV0
  8582     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8583     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8584     MOVE X'2520233030303038323336' TO DFHEIV0(25:11)
  8585     CALL 'kxdfhei1' USING DFHEIV0
  8586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8587
  8588
  8589     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8590
  8591
  8592* EXEC CICS STARTBR
  8593*        DATASET  (ERACCT-ID)
  8594*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8595*        GTEQ
  8596*    END-EXEC.
  8597     MOVE 0
  8598       TO DFHEIV11
  8599*    MOVE '&,         G          &   #00008243' TO DFHEIV0
  8600     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8602     MOVE X'2020233030303038323433' TO DFHEIV0(25:11)
  8603     CALL 'kxdfhei1' USING DFHEIV0,
  8604           ERACCT-ID,
  8605           WS-AM-CONTROL-PRIMARY,
  8606           DFHEIV99,
  8607           DFHEIV11,
  8608           DFHEIV99
  8609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8610
  8611
  8612     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8613     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8614
  8615     GO TO 1299-EXIT.
  8616
  8617 1290-ACCT-NOT-FOUND.
  8618     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8619
  8620 1299-EXIT.
  8621     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 158
* EL1278.cbl
  8623 1300-READ-ACCOUNT-MASTER  SECTION.
  8624
  8625* EXEC CICS HANDLE CONDITION
  8626*        NOTFND   (0580-ACCT-NOT-FOUND)
  8627*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8628*    END-EXEC.
  8629*    MOVE '"$I''                  ! & #00008261' TO DFHEIV0
  8630     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8632     MOVE X'2620233030303038323631' TO DFHEIV0(25:11)
  8633     CALL 'kxdfhei1' USING DFHEIV0
  8634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8635
  8636
  8637
  8638* EXEC CICS READNEXT
  8639*        DATASET  (ERACCT-ID)
  8640*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8641*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8642*    END-EXEC.
  8643     MOVE 0
  8644       TO DFHEIV11
  8645*    MOVE '&.S                   )   #00008266' TO DFHEIV0
  8646     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8647     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8648     MOVE X'2020233030303038323636' TO DFHEIV0(25:11)
  8649     CALL 'kxdfhei1' USING DFHEIV0,
  8650           ERACCT-ID,
  8651           DFHEIV20,
  8652           DFHEIV99,
  8653           WS-AM-CONTROL-PRIMARY,
  8654           DFHEIV99,
  8655           DFHEIV11,
  8656           DFHEIV99,
  8657           DFHEIV99
  8658     SET ADDRESS OF ACCOUNT-MASTER TO
  8659         DFHEIV20
  8660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8661
  8662
  8663*    SERVICE RELOAD ACCOUNT-MASTER.
  8664
  8665 1399-EXIT.
  8666     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 159
* EL1278.cbl
  8668 1400-GET-REFUND-TYPE  SECTION.
  8669     IF LIFE-REFUND-SEARCH
  8670         NEXT SENTENCE
  8671     ELSE
  8672         GO TO 1410-AH-REFUND-TYPE.
  8673
  8674     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8675         MOVE SPACES             TO  HLCALCO
  8676                                     HLCAL1O
  8677         GO TO 1499-EXIT.
  8678
  8679     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8680
  8681     EVALUATE TRUE
  8682        WHEN CP-R-AS-REPOSSESSION
  8683           MOVE 'REPOSSESSION'     TO  HLCALCO
  8684        WHEN CP-R-AS-R78
  8685           MOVE 'RULE 78'          TO  HLCALCO
  8686        WHEN  CP-R-AS-PRORATA
  8687           MOVE 'PRO RATA'         TO  HLCALCO
  8688        WHEN CP-R-AS-CALIF
  8689           MOVE 'CALIF'            TO  HLCALCO
  8690        WHEN CP-R-AS-TEXAS
  8691           MOVE 'IRREG'            TO  HLCALCO
  8692        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8693           MOVE 'UTAH'             TO  HLCALCO
  8694        WHEN CP-R-AS-FARM-PLAN
  8695           MOVE 'FARM PLAN'        TO  HLCALCO
  8696        WHEN CP-R-AS-NET-PAY
  8697           MOVE 'NET PAY'          TO  HLCALCO
  8698        WHEN CP-R-AS-ANTICIPATION
  8699           MOVE 'ANTICIPATION'     TO  HLCALCO
  8700        WHEN CP-R-AS-MEAN
  8701           MOVE 'MEAN'             TO  HLCALCO
  8702        WHEN CP-R-AS-SUM-OF-DIGITS
  8703           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8704        WHEN OTHER
  8705           MOVE 'UNDEFINED'        TO  HLCALCO
  8706     END-EVALUATE.
  8707
  8708     GO TO 1499-EXIT.
  8709
  8710 1410-AH-REFUND-TYPE.
  8711     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8712         MOVE SPACES             TO  HACALCO
  8713                                     HACAL1O
  8714         GO TO 1499-EXIT.
  8715
  8716     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8717
  8718     EVALUATE TRUE
  8719        WHEN CP-R-AS-REPOSSESSION
  8720           MOVE 'REPOSSESSION'     TO HACALCO
  8721        WHEN CP-R-AS-R78
  8722           MOVE 'RULE 78'          TO HACALCO
  8723        WHEN CP-R-AS-PRORATA
  8724           MOVE 'PRO RATA'         TO HACALCO
  8725        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 160
* EL1278.cbl
  8726           MOVE 'CALIF'            TO HACALCO
  8727        WHEN CP-R-AS-TEXAS
  8728           MOVE 'IRREG'            TO HACALCO
  8729        WHEN CP-R-AS-FARM-PLAN
  8730           MOVE 'FARM PLAN'        TO HACALCO
  8731        WHEN CP-R-AS-NET-PAY
  8732           MOVE 'NET PAY'          TO HACALCO
  8733        WHEN CP-R-AS-ANTICIPATION
  8734           MOVE 'ANTICIPATION'     TO HACALCO
  8735        WHEN CP-R-AS-MEAN
  8736           MOVE 'MEAN'             TO HACALCO
  8737        WHEN CP-R-AS-SUM-OF-DIGITS
  8738           MOVE 'SUM OF DIGIT'     TO HACALCO
  8739        WHEN CP-GAP-ACTUARIAL
  8740           MOVE 'SP ACTUARIAL'     TO HACALCO
  8741        WHEN CP-R-AS-SPP-DDF
  8742           MOVE 'SPEC DDF'         TO HACALCO
  8743        WHEN CP-R-AS-SPP-DDF-IU
  8744           MOVE 'SPEC DDF IU'      TO HACALCO
  8745        WHEN OTHER
  8746           MOVE 'UNKNOWN'          TO HLCALCO
  8747     END-EVALUATE
  8748     .
  8749 1499-EXIT.
  8750     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 161
* EL1278.cbl
  8752 1500-END-BROWSE  SECTION.
  8753     IF BROWSE-STARTED
  8754
  8755* EXEC CICS ENDBR
  8756*            DATASET  (ERACCT-ID)
  8757*        END-EXEC.
  8758     MOVE 0
  8759       TO DFHEIV11
  8760*    MOVE '&2                    $   #00008363' TO DFHEIV0
  8761     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8762     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8763     MOVE X'2020233030303038333633' TO DFHEIV0(25:11)
  8764     CALL 'kxdfhei1' USING DFHEIV0,
  8765           ERACCT-ID,
  8766           DFHEIV11,
  8767           DFHEIV99
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771 1599-EXIT.
  8772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 162
* EL1278.cbl
  8774 1600-LOCATE-BENEFIT  SECTION.
  8775
  8776* EXEC CICS HANDLE CONDITION
  8777*        NOTFND  (1699-EXIT)
  8778*    END-EXEC.
  8779*    MOVE '"$I                   ! '' #00008371' TO DFHEIV0
  8780     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8782     MOVE X'2720233030303038333731' TO DFHEIV0(25:11)
  8783     CALL 'kxdfhei1' USING DFHEIV0
  8784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8785
  8786
  8787     MOVE SPACES                 TO  WS-KIND.
  8788     MOVE ZERO                   TO  WS-NOT-FOUND.
  8789     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8790     MOVE SPACES                 TO  WS-CF-STATE.
  8791     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8792
  8793
  8794* EXEC CICS READ
  8795*        DATASET  (ELCNTL-ID)
  8796*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8797*        SET      (ADDRESS OF CONTROL-FILE)
  8798*        GTEQ
  8799*    END-EXEC.
  8800*    MOVE '&"S        G          (   #00008381' TO DFHEIV0
  8801     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8803     MOVE X'2020233030303038333831' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0,
  8805           ELCNTL-ID,
  8806           DFHEIV20,
  8807           DFHEIV99,
  8808           WS-CF-CONTROL-PRIMARY,
  8809           DFHEIV99,
  8810           DFHEIV99,
  8811           DFHEIV99
  8812     SET ADDRESS OF CONTROL-FILE TO
  8813         DFHEIV20
  8814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8815
  8816
  8817*    SERVICE RELOAD CONTROL-FILE.
  8818
  8819     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8820       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8821         GO TO 1699-EXIT.
  8822
  8823     MOVE +1                     TO  WS-INDEX.
  8824
  8825 1610-LOOKUP-BENEFIT.
  8826     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8827         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8828                                 TO  WS-KIND
  8829         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8830                                 TO  WS-CALC-CD
  8831         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 163
* EL1278.cbl
  8832                                 TO  WS-BENEFIT-DESCRIP
  8833         MOVE +1                 TO  WS-NOT-FOUND
  8834         GO TO 1699-EXIT.
  8835
  8836     IF CF-BENEFIT-CODE (WS-INDEX)
  8837             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8838         GO TO 1699-EXIT.
  8839
  8840     IF WS-INDEX  IS LESS THAN  +8
  8841         ADD +1                  TO  WS-INDEX
  8842         GO TO 1610-LOOKUP-BENEFIT.
  8843
  8844 1699-EXIT.
  8845     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 164
* EL1278.cbl
  8847 1700-WRITE-CERT-NOTE      SECTION.
  8848     IF NOT MODIFY-CERT-CAP
  8849         MOVE 'UPDATE'           TO  SM-READ
  8850         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8851         MOVE ER-0070            TO  EMI-ERROR
  8852         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8853         GO TO 8200-SEND-DATAONLY.
  8854
  8855**MOVE CANCEL QUOTE NOTE INFO
  8856     IF PI-LF-REFUND-AMT NUMERIC
  8857        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8858        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8859     ELSE
  8860        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8861                                    PI-LF-REFUND-AMT
  8862        MOVE SPACE               TO WS-CN-LF-REF-METH
  8863                                    PI-LF-REFUND-METH.
  8864
  8865     IF PI-AH-REFUND-AMT NUMERIC
  8866        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8867        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8868     ELSE
  8869        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8870                                    PI-AH-REFUND-AMT
  8871        MOVE SPACE               TO WS-CN-AH-REF-METH
  8872                                    PI-AH-REFUND-METH.
  8873
  8874     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8875                                   PI-AH-REFUND-AMT.
  8876
  8877     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8878
  8879     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8880     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8881     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8882        MOVE PI-LF-CANCEL-DATE-ED
  8883                                 TO WS-CN-CANCEL-DT
  8884     ELSE
  8885        MOVE PI-AH-CANCEL-DATE-ED
  8886                                 TO WS-CN-CANCEL-DT
  8887     END-IF
  8888     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8889     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8890     MOVE PI-CARRIER             TO CZ-CARRIER
  8891     MOVE PI-GROUPING            TO CZ-GROUPING
  8892     MOVE PI-STATE               TO CZ-STATE
  8893     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8894     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8895     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8896     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8897     MOVE '1'                    TO CZ-RECORD-TYPE
  8898     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8899     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8900     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8901     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8902     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8903     MOVE ' '                    TO WS-STOP-SW
  8904     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 165
* EL1278.cbl
  8905
  8906* EXEC CICS WRITE
  8907*           FROM      (CERT-NOTE-FILE)
  8908*           DATASET   (ERNOTE-ID)
  8909*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8910*           RESP      (WS-RESPONSE)
  8911*       END-EXEC
  8912     MOVE LENGTH OF
  8913      CERT-NOTE-FILE
  8914       TO DFHEIV11
  8915*    MOVE '&$ L                  ''  N#00008476' TO DFHEIV0
  8916     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8918     MOVE X'204E233030303038343736' TO DFHEIV0(25:11)
  8919     CALL 'kxdfhei1' USING DFHEIV0,
  8920           ERNOTE-ID,
  8921           CERT-NOTE-FILE,
  8922           DFHEIV11,
  8923           CZ-CONTROL-PRIMARY,
  8924           DFHEIV99,
  8925           DFHEIV99
  8926     MOVE EIBRESP  TO WS-RESPONSE
  8927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8928        IF WS-RESP-DUPREC
  8929           ADD +1                TO CZ-NOTE-SEQUENCE
  8930        ELSE
  8931           SET I-SAY-TO-STOP     TO TRUE
  8932        END-IF
  8933     END-PERFORM
  8934     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8935     IF WS-RESP-NORMAL
  8936        EVALUATE CM-NOTE-SW
  8937           WHEN '1'
  8938           WHEN '3'
  8939           WHEN '5'
  8940           WHEN '7'
  8941              SET NO-CERT-RW     TO TRUE
  8942           WHEN ' '
  8943              MOVE '1'           TO CM-NOTE-SW
  8944           WHEN '2'
  8945              MOVE '3'           TO CM-NOTE-SW
  8946           WHEN '4'
  8947              MOVE '5'           TO CM-NOTE-SW
  8948           WHEN '6'
  8949              MOVE '7'           TO CM-NOTE-SW
  8950        END-EVALUATE
  8951     END-IF
  8952     IF NOT NO-CERT-RW
  8953        PERFORM 1810-REWRITE-ELCERT
  8954                                 THRU 1810-EXIT
  8955     ELSE
  8956
  8957* EXEC CICS UNLOCK
  8958*          DATASET    (ELCERT-ID)
  8959*       END-EXEC
  8960*    MOVE '&*                    #   #00008510' TO DFHEIV0
  8961     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8962     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 166
* EL1278.cbl
  8963     MOVE X'2020233030303038353130' TO DFHEIV0(25:11)
  8964     CALL 'kxdfhei1' USING DFHEIV0,
  8965           ELCERT-ID,
  8966           DFHEIV99
  8967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8968     END-IF
  8969     MOVE ER-8160                TO EMI-ERROR.
  8970     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8971     GO TO 8200-SEND-DATAONLY.
  8972
  8973 1799-EXIT.
  8974     EXIT.
  8975 1800-READ-ELCERT-UPDATE.
  8976     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8977     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8978     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8979     MOVE PI-STATE               TO  WS-CM-STATE.
  8980     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8981     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8982     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8983     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8984
  8985* EXEC CICS READ
  8986*        UPDATE
  8987*        DATASET  (ELCERT-ID)
  8988*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8989*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8990*        RESP     (WS-RESPONSE)
  8991*    END-EXEC
  8992*    MOVE '&"S        EU         (  N#00008529' TO DFHEIV0
  8993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8994     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8995     MOVE X'204E233030303038353239' TO DFHEIV0(25:11)
  8996     CALL 'kxdfhei1' USING DFHEIV0,
  8997           ELCERT-ID,
  8998           DFHEIV20,
  8999           DFHEIV99,
  9000           WS-CM-CONTROL-PRIMARY,
  9001           DFHEIV99,
  9002           DFHEIV99,
  9003           DFHEIV99
  9004     SET ADDRESS OF CERTIFICATE-MASTER TO
  9005         DFHEIV20
  9006     MOVE EIBRESP  TO WS-RESPONSE
  9007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9008     .
  9009 1800-EXIT.
  9010     EXIT.
  9011 1810-REWRITE-ELCERT.
  9012
  9013* EXEC CICS REWRITE
  9014*        FROM      (CERTIFICATE-MASTER)
  9015*        DATASET   (ELCERT-ID)
  9016*        RESP     (WS-RESPONSE)
  9017*    END-EXEC.
  9018     MOVE LENGTH OF
  9019      CERTIFICATE-MASTER
  9020       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 167
* EL1278.cbl
  9021*    MOVE '&& L                  %  N#00008540' TO DFHEIV0
  9022     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9023     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9024     MOVE X'204E233030303038353430' TO DFHEIV0(25:11)
  9025     CALL 'kxdfhei1' USING DFHEIV0,
  9026           ELCERT-ID,
  9027           CERTIFICATE-MASTER,
  9028           DFHEIV11,
  9029           DFHEIV99
  9030     MOVE EIBRESP  TO WS-RESPONSE
  9031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9032
  9033     .
  9034 1810-EXIT.
  9035     EXIT.
  9036 4000-GEN-CANCEL-TRANS.
  9037     IF PI-LF-REFUND-AMT NOT NUMERIC
  9038         MOVE +0 TO PI-LF-REFUND-AMT
  9039     END-IF
  9040     IF PI-AH-REFUND-AMT NOT NUMERIC
  9041         MOVE +0 TO PI-AH-REFUND-AMT
  9042     END-IF
  9043
  9044     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  9045
  9046     MOVE '2'                    TO CG-OPTION-CODE
  9047     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  9048     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  9049     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  9050     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  9051     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  9052     MOVE PI-GROUPING            TO CG-CERT-GROUP
  9053     MOVE PI-STATE               TO CG-CERT-STATE
  9054     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  9055     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  9056     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  9057     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  9058     MOVE ZEROS                  TO CG-LF-BENCD
  9059                                    CG-AH-BENCD
  9060                                    CG-LF-CAN-AMT
  9061                                    CG-AH-CAN-AMT
  9062     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  9063                                    CG-AH-CAN-DT
  9064     MOVE SPACES                 TO CG-BATCH-NO
  9065     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  9066       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  9067        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  9068           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  9069           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  9070           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  9071        END-IF
  9072     END-IF
  9073     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  9074       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  9075        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  9076           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  9077           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  9078           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 168
* EL1278.cbl
  9079        END-IF
  9080     END-IF
  9081
  9082* EXEC CICS LINK
  9083*        PROGRAM  ('ELCANC')
  9084*        COMMAREA (CANCEL-GEN-PASS-AREA)
  9085*    END-EXEC
  9086     MOVE LENGTH OF
  9087      CANCEL-GEN-PASS-AREA
  9088       TO DFHEIV11
  9089     MOVE 'ELCANC' TO DFHEIV1
  9090*    MOVE '."C                   (   #00008593' TO DFHEIV0
  9091     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9093     MOVE X'2020233030303038353933' TO DFHEIV0(25:11)
  9094     CALL 'kxdfhei1' USING DFHEIV0,
  9095           DFHEIV1,
  9096           CANCEL-GEN-PASS-AREA,
  9097           DFHEIV11,
  9098           DFHEIV99,
  9099           DFHEIV99,
  9100           DFHEIV99,
  9101           DFHEIV99
  9102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9103     IF CG-SUCCESS
  9104        CONTINUE
  9105     ELSE
  9106        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  9107        move '3'                 to emi-switch1
  9108        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  9109        EVALUATE TRUE
  9110           WHEN CG-DATE-ERROR
  9111             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9112           WHEN CG-CERT-NOT-FOUND
  9113             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9114           WHEN CG-AMOUNT-ERROR
  9115             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9116           WHEN CG-OPTION-ERROR
  9117             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9118           WHEN CG-PREV-CAN
  9119             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9120           WHEN CG-INVALID-DATA
  9121             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9122           WHEN CG-NO-ACCT-MSTR
  9123             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9124           WHEN CG-SFX-A-EXIST
  9125             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9126           WHEN CG-MISC-ERROR
  9127             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9128           WHEN OTHER
  9129             move ' error - elcanc - return '
  9130                                 to emi-error-text (1) (12:25)
  9131        END-EVALUATE
  9132        go to 8200-send-dataonly
  9133     end-if
  9134     .
  9135 4000-exit.
  9136     exit.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 169
* EL1278.cbl
  9137
  9138 4400-ADD-ORIG-REC.
  9139
  9140     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  9141     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  9142     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  9143     MOVE PI-STATE               TO  WS-CM-STATE.
  9144     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  9145     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  9146     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  9147     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  9148
  9149
  9150* EXEC CICS READ
  9151*        DATASET  (ELCERT-ID)
  9152*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  9153*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9154*        RESP     (WS-RESPONSE)
  9155*    END-EXEC
  9156*    MOVE '&"S        E          (  N#00008643' TO DFHEIV0
  9157     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9159     MOVE X'204E233030303038363433' TO DFHEIV0(25:11)
  9160     CALL 'kxdfhei1' USING DFHEIV0,
  9161           ELCERT-ID,
  9162           DFHEIV20,
  9163           DFHEIV99,
  9164           WS-CM-CONTROL-PRIMARY,
  9165           DFHEIV99,
  9166           DFHEIV99,
  9167           DFHEIV99
  9168     SET ADDRESS OF CERTIFICATE-MASTER TO
  9169         DFHEIV20
  9170     MOVE EIBRESP  TO WS-RESPONSE
  9171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9172     IF WS-RESP-NORMAL
  9173         CONTINUE
  9174     ELSE
  9175        MOVE ER-0142                TO EMI-ERROR
  9176        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  9177        GO TO 8100-SEND-INITIAL-MAP
  9178     END-IF
  9179
  9180******************************************************************
  9181*            A D D   O R I G   C E R T   I N F O                 *
  9182******************************************************************
  9183
  9184     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  9185
  9186     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  9187     MOVE ' '                    TO WS-ERMAIL-SW
  9188
  9189
  9190* EXEC CICS READ
  9191*       DATASET   ('ERMAIL')
  9192*       SET       (ADDRESS OF MAILING-DATA)
  9193*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9194*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 170
* EL1278.cbl
  9195*    END-EXEC
  9196     MOVE 'ERMAIL' TO DFHEIV1
  9197*    MOVE '&"S        E          (  N#00008666' TO DFHEIV0
  9198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9199     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9200     MOVE X'204E233030303038363636' TO DFHEIV0(25:11)
  9201     CALL 'kxdfhei1' USING DFHEIV0,
  9202           DFHEIV1,
  9203           DFHEIV20,
  9204           DFHEIV99,
  9205           WS-MA-CONTROL-PRIMARY,
  9206           DFHEIV99,
  9207           DFHEIV99,
  9208           DFHEIV99
  9209     SET ADDRESS OF MAILING-DATA TO
  9210         DFHEIV20
  9211     MOVE EIBRESP  TO WS-RESPONSE
  9212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9213
  9214     IF WS-RESP-NORMAL
  9215        SET ERMAIL-FOUND TO TRUE
  9216     END-IF
  9217
  9218     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  9219     MOVE 'C'                   TO ELCRTT-REC-TYPE
  9220     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  9221
  9222
  9223* EXEC CICS READ
  9224*         DATASET  (ELCRTT-ID)
  9225*         RIDFLD   (ELCRTT-KEY)
  9226*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  9227*         RESP     (WS-RESPONSE)
  9228*    END-EXEC
  9229*    MOVE '&"S        E          (  N#00008681' TO DFHEIV0
  9230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9232     MOVE X'204E233030303038363831' TO DFHEIV0(25:11)
  9233     CALL 'kxdfhei1' USING DFHEIV0,
  9234           ELCRTT-ID,
  9235           DFHEIV20,
  9236           DFHEIV99,
  9237           ELCRTT-KEY,
  9238           DFHEIV99,
  9239           DFHEIV99,
  9240           DFHEIV99
  9241     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  9242         DFHEIV20
  9243     MOVE EIBRESP  TO WS-RESPONSE
  9244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9245
  9246     IF NOT WS-RESP-NORMAL
  9247        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  9248     END-IF
  9249
  9250     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  9251     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  9252     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 171
* EL1278.cbl
  9253
  9254
  9255* EXEC CICS READ
  9256*       DATASET   ('ELCRTO')
  9257*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9258*       RIDFLD    (ELCRTO-KEY)
  9259*       GTEQ
  9260*       RESP      (WS-RESPONSE)
  9261*    END-EXEC
  9262     MOVE 'ELCRTO' TO DFHEIV1
  9263*    MOVE '&"S        G          (  N#00008696' TO DFHEIV0
  9264     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9266     MOVE X'204E233030303038363936' TO DFHEIV0(25:11)
  9267     CALL 'kxdfhei1' USING DFHEIV0,
  9268           DFHEIV1,
  9269           DFHEIV20,
  9270           DFHEIV99,
  9271           ELCRTO-KEY,
  9272           DFHEIV99,
  9273           DFHEIV99,
  9274           DFHEIV99
  9275     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9276         DFHEIV20
  9277     MOVE EIBRESP  TO WS-RESPONSE
  9278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9279
  9280     IF WS-RESP-NORMAL
  9281        AND (OC-CONTROL-PRIMARY (1:33) =
  9282                 WS-CM-CONTROL-PRIMARY)
  9283        AND (OC-RECORD-TYPE = 'I')
  9284        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  9285
  9286* EXEC CICS READ
  9287*             DATASET   ('ELCRTO')
  9288*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9289*             RIDFLD    (OC-CONTROL-PRIMARY)
  9290*             UPDATE
  9291*             RESP      (WS-RESPONSE)
  9292*          END-EXEC
  9293     MOVE 'ELCRTO' TO DFHEIV1
  9294*    MOVE '&"S        EU         (  N#00008709' TO DFHEIV0
  9295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9297     MOVE X'204E233030303038373039' TO DFHEIV0(25:11)
  9298     CALL 'kxdfhei1' USING DFHEIV0,
  9299           DFHEIV1,
  9300           DFHEIV20,
  9301           DFHEIV99,
  9302           OC-CONTROL-PRIMARY,
  9303           DFHEIV99,
  9304           DFHEIV99,
  9305           DFHEIV99
  9306     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9307         DFHEIV20
  9308     MOVE EIBRESP  TO WS-RESPONSE
  9309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9310           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 172
* EL1278.cbl
  9311           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9312           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9313           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9314           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9315           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9316           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9317           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9318           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9319            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9320               MOVE SPACES             TO OC-LF-BENCD
  9321               MOVE ZEROS              TO OC-LF-TERM
  9322                                          OC-LF-BEN-AMT
  9323                                          OC-LF-PRM-AMT
  9324                                          OC-LF-ALT-BEN-AMT
  9325                                          OC-LF-ALT-PRM-AMT
  9326                                          OC-LF-COMM-PCT
  9327                                          OC-LF-CANCEL-AMT
  9328               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9329               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9330           ELSE
  9331               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9332               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9333               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9334               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9335               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9336               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9337               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9338               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9339               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9340               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9341           END-IF
  9342           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9343           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9344            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9345               MOVE SPACES             TO OC-AH-BENCD
  9346               MOVE ZEROS              TO OC-AH-TERM
  9347                                          OC-AH-BEN-AMT
  9348                                          OC-AH-PRM-AMT
  9349                                          OC-AH-COMM-PCT
  9350                                          OC-AH-CANCEL-AMT
  9351                                          OC-AH-CP
  9352               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9353               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9354           ELSE
  9355               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9356               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9357               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9358               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9359               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9360               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9361               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9362               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9363               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9364           END-IF
  9365           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9366           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9367           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9368           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 173
* EL1278.cbl
  9369           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9370           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9371           MOVE '5'                    TO DC-OPTION-CODE
  9372           PERFORM 9600-DATE-LINK
  9373           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9374           IF ERMAIL-FOUND
  9375               MOVE MA-CRED-BENE-NAME
  9376                           TO OC-CRED-BENE-NAME
  9377           END-IF
  9378           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9379               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9380                                  OC-INS-AGE-DEFAULT-FLAG
  9381               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9382                                  OC-JNT-AGE-DEFAULT-FLAG
  9383           END-IF
  9384
  9385
  9386* EXEC CICS REWRITE
  9387*             DATASET   ('ELCRTO')
  9388*             FROM      (ORIGINAL-CERTIFICATE)
  9389*             RESP      (WS-RESPONSE)
  9390*          END-EXEC
  9391     MOVE LENGTH OF
  9392      ORIGINAL-CERTIFICATE
  9393       TO DFHEIV11
  9394     MOVE 'ELCRTO' TO DFHEIV1
  9395*    MOVE '&& L                  %  N#00008791' TO DFHEIV0
  9396     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9397     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9398     MOVE X'204E233030303038373931' TO DFHEIV0(25:11)
  9399     CALL 'kxdfhei1' USING DFHEIV0,
  9400           DFHEIV1,
  9401           ORIGINAL-CERTIFICATE,
  9402           DFHEIV11,
  9403           DFHEIV99
  9404     MOVE EIBRESP  TO WS-RESPONSE
  9405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9406           IF NOT WS-RESP-NORMAL
  9407              MOVE ER-3830          TO EMI-ERROR
  9408              PERFORM 9700-ERROR-FORMAT
  9409                                 THRU 9799-EXIT
  9410              GO TO 8200-SEND-DATAONLY
  9411           END-IF
  9412
  9413           GO TO 4400-EXIT
  9414
  9415        ELSE
  9416           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9417        END-IF
  9418     ELSE
  9419        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9420        MOVE 'OC'                TO OC-RECORD-ID
  9421        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9422        MOVE 'I'                 TO OC-RECORD-TYPE
  9423        MOVE +4096               TO OC-KEY-SEQ-NO
  9424     END-IF
  9425
  9426     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 174
* EL1278.cbl
  9427     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9428     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9429     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9430     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9431     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9432     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9433     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9434     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9435      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9436         MOVE SPACES             TO OC-LF-BENCD
  9437         MOVE ZEROS              TO OC-LF-TERM
  9438                                    OC-LF-BEN-AMT
  9439                                    OC-LF-PRM-AMT
  9440                                    OC-LF-ALT-BEN-AMT
  9441                                    OC-LF-ALT-PRM-AMT
  9442                                    OC-LF-COMM-PCT
  9443                                    OC-LF-CANCEL-AMT
  9444         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9445         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9446     ELSE
  9447         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9448         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9449         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9450         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9451         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9452         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9453         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9454         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9455         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9456         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9457     END-IF
  9458     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9459     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9460      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9461         MOVE SPACES             TO OC-AH-BENCD
  9462         MOVE ZEROS              TO OC-AH-TERM
  9463                                    OC-AH-BEN-AMT
  9464                                    OC-AH-PRM-AMT
  9465                                    OC-AH-COMM-PCT
  9466                                    OC-AH-CANCEL-AMT
  9467                                    OC-AH-CP
  9468         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9469         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9470     ELSE
  9471         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9472         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9473         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9474         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9475         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9476         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9477         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9478         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9479         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9480         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9481     END-IF
  9482     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9483     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9484     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 175
* EL1278.cbl
  9485     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9486     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9487     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9488     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9489     MOVE '5'                    TO DC-OPTION-CODE
  9490     PERFORM 9600-DATE-LINK
  9491     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9492     IF ERMAIL-FOUND
  9493         MOVE MA-CRED-BENE-NAME
  9494                     TO OC-CRED-BENE-NAME
  9495     END-IF
  9496     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9497         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9498                            OC-INS-AGE-DEFAULT-FLAG
  9499         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9500                            OC-JNT-AGE-DEFAULT-FLAG
  9501     END-IF
  9502
  9503     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9504     .
  9505 4400-WRITE-ELCRTO.
  9506
  9507
  9508* EXEC CICS WRITE
  9509*       DATASET   ('ELCRTO')
  9510*       FROM      (ORIGINAL-CERTIFICATE)
  9511*       RIDFLD    (OC-CONTROL-PRIMARY)
  9512*       RESP      (WS-RESPONSE)
  9513*    END-EXEC
  9514     MOVE LENGTH OF
  9515      ORIGINAL-CERTIFICATE
  9516       TO DFHEIV11
  9517     MOVE 'ELCRTO' TO DFHEIV1
  9518*    MOVE '&$ L                  ''  N#00008897' TO DFHEIV0
  9519     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9520     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9521     MOVE X'204E233030303038383937' TO DFHEIV0(25:11)
  9522     CALL 'kxdfhei1' USING DFHEIV0,
  9523           DFHEIV1,
  9524           ORIGINAL-CERTIFICATE,
  9525           DFHEIV11,
  9526           OC-CONTROL-PRIMARY,
  9527           DFHEIV99,
  9528           DFHEIV99
  9529     MOVE EIBRESP  TO WS-RESPONSE
  9530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9531
  9532    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9533        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9534        GO TO 4400-WRITE-ELCRTO
  9535    ELSE
  9536        IF NOT WS-RESP-NORMAL
  9537           MOVE ER-3830          TO EMI-ERROR
  9538           PERFORM 9700-ERROR-FORMAT
  9539                                 THRU 9799-EXIT
  9540           GO TO 8200-SEND-DATAONLY
  9541        END-IF
  9542    END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 176
* EL1278.cbl
  9543
  9544     .
  9545 4400-EXIT.
  9546    EXIT.
  9547
  9548
  9549 5000-GET-LF-AM-REM-TERM.
  9550     MOVE +1                     TO SUB3.
  9551
  9552 5100-GET-LF-AM-REM-TERM.
  9553     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9554        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9555           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9556                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9557           GO TO 5300-MOVE-LF-REM-TERM.
  9558
  9559     IF SUB3 LESS THAN +20
  9560        ADD +1                   TO SUB3
  9561        GO TO 5100-GET-LF-AM-REM-TERM.
  9562
  9563     MOVE +1                     TO SUB3.
  9564
  9565     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9566         GO TO 5200-EDIT-FOR-NINETY-LF.
  9567
  9568 5100-GET-LF-DMD-AM-REM-TERM.
  9569
  9570     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9571        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9572           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9573                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9574           GO TO 5300-MOVE-LF-REM-TERM.
  9575
  9576     IF SUB3 LESS THAN +30
  9577        ADD +1                   TO SUB3
  9578        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9579
  9580     MOVE +1                     TO SUB3.
  9581
  9582 5200-EDIT-FOR-NINETY-LF.
  9583
  9584***************************************************************
  9585*                                                             *
  9586*    NINETY BENEFIT PLAN TYPES:                               *
  9587*                                                             *
  9588*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9589*      92 = ALL GROUP REDUCING BENEFITS                       *
  9590*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9591*      94 = ALL GROUP LEVEL BENEFITS                          *
  9592*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9593*           BENEFIT CONTROLS.                                 *
  9594*      99 = ALL BENEFITS                                      *
  9595*                                                             *
  9596***************************************************************
  9597
  9598     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9599                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9600
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 177
* EL1278.cbl
  9601     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9602       AND
  9603        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9604           GO TO 5300-MOVE-LF-REM-TERM.
  9605
  9606     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9607       AND
  9608        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9609        IF CF-REDUCING (WS-INDEX)
  9610           IF CM-INDIVIDUAL
  9611               GO TO 5300-MOVE-LF-REM-TERM.
  9612
  9613     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9614       AND
  9615        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9616        IF CF-REDUCING (WS-INDEX)
  9617           IF CM-GROUP
  9618               GO TO 5300-MOVE-LF-REM-TERM.
  9619
  9620     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9621       AND
  9622        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9623        IF CF-LEVEL (WS-INDEX)
  9624           IF CM-INDIVIDUAL
  9625               GO TO 5300-MOVE-LF-REM-TERM.
  9626
  9627     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9628       AND
  9629        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9630        IF CF-LEVEL (WS-INDEX)
  9631           IF CM-GROUP
  9632               GO TO 5300-MOVE-LF-REM-TERM.
  9633
  9634     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9635       AND
  9636        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9637            GO TO 5300-MOVE-LF-REM-TERM.
  9638
  9639     IF SUB3 LESS THAN +20
  9640        ADD +1           TO SUB3
  9641          GO TO 5200-EDIT-FOR-NINETY-LF.
  9642
  9643     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9644
  9645     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9646         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9647         GO TO 5900-EXIT.
  9648
  9649     MOVE 1                       TO SUB3.
  9650
  9651 5200-EDIT-FOR-DMD-NINETY-LF.
  9652
  9653     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9654                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9655
  9656     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9657       AND
  9658        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 178
* EL1278.cbl
  9659           GO TO 5300-MOVE-LF-REM-TERM.
  9660
  9661     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9662       AND
  9663        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9664        IF CF-REDUCING (WS-INDEX)
  9665           IF CM-INDIVIDUAL
  9666               GO TO 5300-MOVE-LF-REM-TERM.
  9667
  9668     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9669       AND
  9670        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9671        IF CF-REDUCING (WS-INDEX)
  9672           IF CM-GROUP
  9673               GO TO 5300-MOVE-LF-REM-TERM.
  9674
  9675     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9676       AND
  9677        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9678        IF CF-LEVEL (WS-INDEX)
  9679           IF CM-INDIVIDUAL
  9680               GO TO 5300-MOVE-LF-REM-TERM.
  9681
  9682     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9683       AND
  9684        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9685        IF CF-LEVEL (WS-INDEX)
  9686           IF CM-GROUP
  9687               GO TO 5300-MOVE-LF-REM-TERM.
  9688
  9689     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9690       AND
  9691        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9692            GO TO 5300-MOVE-LF-REM-TERM.
  9693
  9694     IF SUB3 LESS THAN +30
  9695        ADD +1                   TO SUB3
  9696          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9697
  9698     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9699
  9700     GO TO 5900-EXIT.
  9701
  9702 5300-MOVE-LF-REM-TERM.
  9703     MOVE WS-SAVE-BENEFIT-REM-TERM
  9704                                 TO WS-LF-AM-REM-TERM-CALC.
  9705
  9706 5900-EXIT.
  9707      EXIT.
  9708
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 179
* EL1278.cbl
  9710
  9711 6000-GET-AH-AM-REM-TERM.
  9712     MOVE +1                     TO SUB3.
  9713
  9714 6100-GET-AH-AM-REM-TERM.
  9715
  9716     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9717        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9718           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9719                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9720           GO TO 6300-MOVE-AH-REM-TERM.
  9721
  9722     IF SUB3 LESS THAN +20
  9723        ADD +1                   TO SUB3
  9724        GO TO 6100-GET-AH-AM-REM-TERM.
  9725
  9726     MOVE +1                     TO SUB3.
  9727
  9728     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9729         GO TO 6200-EDIT-FOR-NINETY-AH.
  9730
  9731 6100-GET-AH-AM-DMD-REM-TERM.
  9732     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9733        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9734           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9735                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9736           GO TO 6300-MOVE-AH-REM-TERM.
  9737
  9738     IF SUB3 LESS THAN +30
  9739        ADD +1                   TO SUB3
  9740        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9741
  9742     MOVE +1                     TO SUB3.
  9743
  9744 6200-EDIT-FOR-NINETY-AH.
  9745
  9746***************************************************************
  9747*                                                             *
  9748*    NINETY BENEFIT PLAN TYPES:                               *
  9749*                                                             *
  9750*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9751*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9752*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9753*           BENEFIT CONTROLS.                                 *
  9754*      99 = ALL BENEFITS.                                     *
  9755*                                                             *
  9756***************************************************************
  9757
  9758     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9759                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9760
  9761     IF AM-BENEFIT-CODE (SUB3) = '99'
  9762       AND
  9763        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9764           GO TO 6300-MOVE-AH-REM-TERM.
  9765
  9766     IF AM-BENEFIT-CODE (SUB3) = '91'
  9767       AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 180
* EL1278.cbl
  9768        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9769           IF CM-INDIVIDUAL
  9770               GO TO 6300-MOVE-AH-REM-TERM.
  9771
  9772     IF AM-BENEFIT-CODE (SUB3) = '92'
  9773       AND
  9774        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9775           IF CM-GROUP
  9776               GO TO 6300-MOVE-AH-REM-TERM.
  9777
  9778     IF AM-BENEFIT-CODE (SUB3) = '98'
  9779       AND
  9780        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9781           GO TO 6300-MOVE-AH-REM-TERM.
  9782
  9783     IF SUB3 LESS THAN +20
  9784        ADD +1                    TO SUB3
  9785        GO TO 6200-EDIT-FOR-NINETY-AH.
  9786
  9787     MOVE +1                      TO SUB3.
  9788
  9789     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9790         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9791         GO TO 6900-EXIT.
  9792
  9793 6200-EDIT-FOR-DMD-NINETY-AH.
  9794
  9795     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9796                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9797
  9798     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9799       AND
  9800        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9801           GO TO 6300-MOVE-AH-REM-TERM.
  9802
  9803     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9804       AND
  9805        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9806           IF CM-INDIVIDUAL
  9807               GO TO 6300-MOVE-AH-REM-TERM.
  9808
  9809     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9810       AND
  9811        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9812           IF CM-GROUP
  9813               GO TO 6300-MOVE-AH-REM-TERM.
  9814
  9815     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9816       AND
  9817        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9818           GO TO 6300-MOVE-AH-REM-TERM.
  9819
  9820     IF SUB3 LESS THAN +30
  9821        ADD +1                   TO SUB3
  9822        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9823
  9824     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9825
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 181
* EL1278.cbl
  9826     GO TO 6900-EXIT.
  9827
  9828 6300-MOVE-AH-REM-TERM.
  9829
  9830     MOVE WS-SAVE-BENEFIT-REM-TERM
  9831                                 TO WS-AH-AM-REM-TERM-CALC.
  9832
  9833 6900-EXIT.
  9834      EXIT.
  9835
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 182
* EL1278.cbl
  9837 7000-GET-ERFORM     SECTION.
  9838
  9839* EXEC CICS HANDLE CONDITION
  9840*        NOTFND  (7000-EXIT)
  9841*    END-EXEC.
  9842*    MOVE '"$I                   ! ( #00009210' TO DFHEIV0
  9843     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9845     MOVE X'2820233030303039323130' TO DFHEIV0(25:11)
  9846     CALL 'kxdfhei1' USING DFHEIV0
  9847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9848
  9849
  9850     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9851     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9852     MOVE PI-STATE               TO  WS-FO-STATE.
  9853     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9854     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9855
  9856
  9857* EXEC CICS READ
  9858*        DATASET  (ERFORM-ID)
  9859*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9860*        SET      (ADDRESS OF FORM-MASTER)
  9861*        GTEQ
  9862*    END-EXEC.
  9863*    MOVE '&"S        G          (   #00009220' TO DFHEIV0
  9864     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9866     MOVE X'2020233030303039323230' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0,
  9868           ERFORM-ID,
  9869           DFHEIV20,
  9870           DFHEIV99,
  9871           WS-FO-CONTROL-PRIMARY,
  9872           DFHEIV99,
  9873           DFHEIV99,
  9874           DFHEIV99
  9875     SET ADDRESS OF FORM-MASTER TO
  9876         DFHEIV20
  9877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9878
  9879
  9880     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9881        PI-STATE          EQUAL FO-STATE      AND
  9882        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9883         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9884         GO TO 7000-EXIT.
  9885 7000-EXIT.
  9886     EXIT.
  9887 7100-BENEFIT-SEARCH SECTION.
  9888
  9889     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9890        MOVE +1                  TO  SUB4
  9891        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9892
  9893     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9894        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 183
* EL1278.cbl
  9895        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9896 7100-EXIT.
  9897     EXIT.
  9898 7150-BENEFIT-LIFE-SEARCH.
  9899     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9900       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9901         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9902          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9903            IF FO-PLAN-REFUND-METHOD (SUB4)
  9904                    IS GREATER THAN SPACES
  9905               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9906                                    WS-LF-FO-REFUND-CALC
  9907               GO TO 7150-EXIT.
  9908
  9909     IF SUB4 LESS THAN +40
  9910         ADD +1              TO SUB4
  9911         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9912
  9913 7150-EXIT.
  9914     EXIT.
  9915 7250-BENEFIT-AH-SEARCH.
  9916     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9917       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9918         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9919          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9920            IF FO-PLAN-REFUND-METHOD (SUB4)
  9921                    IS GREATER THAN SPACES
  9922               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9923                                    WS-AH-FO-REFUND-CALC
  9924               GO TO 7250-EXIT.
  9925
  9926     IF SUB4 LESS THAN +40
  9927         ADD +1              TO SUB4
  9928         GO TO 7250-BENEFIT-AH-SEARCH.
  9929
  9930 7250-EXIT.
  9931     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 184
* EL1278.cbl
  9933
  9934 8100-SEND-INITIAL-MAP  SECTION.
  9935     MOVE SAVE-DATE              TO  HDATEO.
  9936     MOVE EIBTIME                TO  TIME-IN.
  9937     MOVE TIME-OUT               TO  HTIMEO.
  9938     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9939     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9940     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9941     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9942
  9943     IF CM-LF-BENEFIT-CD = '00'
  9944         MOVE -1                 TO  HACANCL
  9945     ELSE
  9946         MOVE -1                 TO  HLCANCL.
  9947
  9948     if pi-company-id = 'VPP'
  9949        move al-sanof            to refdueha
  9950                                    canfeeha
  9951        move al-uanof            to refduea
  9952                                    canfeea
  9953     end-if
  9954     IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9955        MOVE AL-SADOF            TO CANREAHA
  9956                                    CLPYNHA
  9957                                    CANREAA
  9958                                    CLPYNA
  9959     END-IF
  9960
  9961
  9962* EXEC CICS SEND
  9963*        FROM    (EL127HO)
  9964*        MAPSET  (MAPSET-NAME)
  9965*        MAP     (MAP-NAME)
  9966*        CURSOR
  9967*        ERASE
  9968*    END-EXEC.
  9969     MOVE LENGTH OF
  9970      EL127HO
  9971       TO DFHEIV12
  9972     MOVE -1
  9973       TO DFHEIV11
  9974*    MOVE '8$     CT  E    H L F ,   #00009308' TO DFHEIV0
  9975     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9976     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9977     MOVE X'2020233030303039333038' TO DFHEIV0(25:11)
  9978     CALL 'kxdfhei1' USING DFHEIV0,
  9979           MAP-NAME,
  9980           EL127HO,
  9981           DFHEIV12,
  9982           MAPSET-NAME,
  9983           DFHEIV99,
  9984           DFHEIV99,
  9985           DFHEIV99,
  9986           DFHEIV11,
  9987           DFHEIV99,
  9988           DFHEIV99,
  9989           DFHEIV99
  9990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 185
* EL1278.cbl
  9991
  9992
  9993     GO TO 9000-RETURN-TRAN.
  9994
  9995 8200-SEND-DATAONLY  SECTION.
  9996     IF FIRST-ENTRY
  9997         GO TO 8100-SEND-INITIAL-MAP.
  9998
  9999     MOVE SAVE-DATE              TO  HDATEO.
 10000     MOVE EIBTIME                TO  TIME-IN.
 10001     MOVE TIME-OUT               TO  HTIMEO.
 10002     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
 10003     MOVE PI-PROCESSOR-ID        TO  USERIDO.
 10004     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
 10005     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
 10006     MOVE -1                     TO  HLCANCL.
 10007
 10008
 10009* EXEC CICS SEND DATAONLY
 10010*        FROM    (EL127HO)
 10011*        MAPSET  (MAPSET-NAME)
 10012*        MAP     (MAP-NAME)
 10013*        CURSOR
 10014*    END-EXEC.
 10015     MOVE LENGTH OF
 10016      EL127HO
 10017       TO DFHEIV12
 10018     MOVE -1
 10019       TO DFHEIV11
 10020*    MOVE '8$D    CT       H L F ,   #00009331' TO DFHEIV0
 10021     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10022     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10023     MOVE X'2020233030303039333331' TO DFHEIV0(25:11)
 10024     CALL 'kxdfhei1' USING DFHEIV0,
 10025           MAP-NAME,
 10026           EL127HO,
 10027           DFHEIV12,
 10028           MAPSET-NAME,
 10029           DFHEIV99,
 10030           DFHEIV99,
 10031           DFHEIV99,
 10032           DFHEIV11,
 10033           DFHEIV99,
 10034           DFHEIV99,
 10035           DFHEIV99
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10037
 10038
 10039     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 186
* EL1278.cbl
 10041 8300-SEND-TEXT  SECTION.
 10042
 10043* EXEC CICS SEND TEXT
 10044*        FROM    (LOGOFF-TEXT)
 10045*        LENGTH  (LOGOFF-LENGTH)
 10046*        ERASE
 10047*        FREEKB
 10048*    END-EXEC.
 10049*    MOVE '8&      T  E F  H   F -   #00009341' TO DFHEIV0
 10050     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10051     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10052     MOVE X'2020233030303039333431' TO DFHEIV0(25:11)
 10053     CALL 'kxdfhei1' USING DFHEIV0,
 10054           LOGOFF-TEXT,
 10055           LOGOFF-LENGTH,
 10056           DFHEIV99,
 10057           DFHEIV99,
 10058           DFHEIV99,
 10059           DFHEIV99,
 10060           DFHEIV99,
 10061           DFHEIV99,
 10062           DFHEIV99,
 10063           DFHEIV99,
 10064           DFHEIV99,
 10065           DFHEIV99
 10066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10067
 10068
 10069
 10070* EXEC CICS RETURN
 10071*    END-EXEC.
 10072*    MOVE '.(                    ''   #00009348' TO DFHEIV0
 10073     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10074     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10075     MOVE X'2020233030303039333438' TO DFHEIV0(25:11)
 10076     CALL 'kxdfhei1' USING DFHEIV0,
 10077           DFHEIV99,
 10078           DFHEIV99,
 10079           DFHEIV99,
 10080           DFHEIV99,
 10081           DFHEIV99,
 10082           DFHEIV99
 10083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10084
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 187
* EL1278.cbl
 10086 8600-DEEDIT  SECTION.
 10087
 10088* EXEC CICS BIF DEEDIT
 10089*        FIELD   (DEEDIT-FIELD)
 10090*        LENGTH  (15)
 10091*    END-EXEC.
 10092     MOVE 15
 10093       TO DFHEIV11
 10094*    MOVE '@"L                   #   #00009352' TO DFHEIV0
 10095     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10096     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10097     MOVE X'2020233030303039333532' TO DFHEIV0(25:11)
 10098     CALL 'kxdfhei1' USING DFHEIV0,
 10099           DEEDIT-FIELD,
 10100           DFHEIV11
 10101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10102
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 188
* EL1278.cbl
 10104 8700-UNAUTHORIZED-ACCESS  SECTION.
 10105     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10106
 10107     GO TO 8300-SEND-TEXT.
 10108
 10109 8800-PF23  SECTION.
 10110     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10111     MOVE XCTL-005               TO  PGM-NAME.
 10112
 10113     GO TO 9200-XCTL.
 10114
 10115 8900-RETURN-CICS  SECTION.
 10116
 10117* EXEC CICS RETURN
 10118*    END-EXEC.
 10119*    MOVE '.(                    ''   #00009369' TO DFHEIV0
 10120     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10121     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10122     MOVE X'2020233030303039333639' TO DFHEIV0(25:11)
 10123     CALL 'kxdfhei1' USING DFHEIV0,
 10124           DFHEIV99,
 10125           DFHEIV99,
 10126           DFHEIV99,
 10127           DFHEIV99,
 10128           DFHEIV99,
 10129           DFHEIV99
 10130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10131
 10132
 10133 9000-RETURN-TRAN  SECTION.
 10134     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10135     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10136
 10137
 10138* EXEC CICS RETURN
 10139*        TRANSID   (TRANS-ID)
 10140*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10141*        LENGTH    (PI-COMM-LENGTH)
 10142*    END-EXEC.
 10143*    MOVE '.(CT                  ''   #00009376' TO DFHEIV0
 10144     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10146     MOVE X'2020233030303039333736' TO DFHEIV0(25:11)
 10147     CALL 'kxdfhei1' USING DFHEIV0,
 10148           TRANS-ID,
 10149           PROGRAM-INTERFACE-BLOCK,
 10150           PI-COMM-LENGTH,
 10151           DFHEIV99,
 10152           DFHEIV99,
 10153           DFHEIV99
 10154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10155
 10156
 10157 9100-RETURN-MAIN-MENU  SECTION.
 10158     MOVE XCTL-126               TO  PGM-NAME.
 10159
 10160     GO TO 9200-XCTL.
 10161
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 189
* EL1278.cbl
 10162 9200-XCTL  SECTION.
 10163
 10164* EXEC CICS XCTL
 10165*        PROGRAM   (PGM-NAME)
 10166*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10167*        LENGTH    (PI-COMM-LENGTH)
 10168*    END-EXEC.
 10169*    MOVE '.$C                   %   #00009388' TO DFHEIV0
 10170     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10171     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10172     MOVE X'2020233030303039333838' TO DFHEIV0(25:11)
 10173     CALL 'kxdfhei1' USING DFHEIV0,
 10174           PGM-NAME,
 10175           PROGRAM-INTERFACE-BLOCK,
 10176           PI-COMM-LENGTH,
 10177           DFHEIV99
 10178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10179
 10180
 10181 9300-CLEAR  SECTION.
 10182     MOVE ' '                    TO  PI-PEND-SW.
 10183     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10184
 10185     GO TO 9200-XCTL.
 10186
 10187 9400-PF12  SECTION.
 10188     MOVE XCTL-010               TO  PGM-NAME.
 10189
 10190     GO TO 9200-XCTL.
 10191
 10192 9500-PGMID-ERROR  SECTION.
 10193
 10194* EXEC CICS HANDLE CONDITION
 10195*        PGMIDERR  (8300-SEND-TEXT)
 10196*    END-EXEC.
 10197*    MOVE '"$L                   ! ) #00009406' TO DFHEIV0
 10198     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10200     MOVE X'2920233030303039343036' TO DFHEIV0(25:11)
 10201     CALL 'kxdfhei1' USING DFHEIV0
 10202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10203
 10204
 10205     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10206     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10207     MOVE XCTL-005               TO  PGM-NAME.
 10208     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10209     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10210
 10211     GO TO 9200-XCTL.
 10212
 10213 9600-DATE-LINK  SECTION.
 10214     MOVE LINK-ELDATCV           TO  PGM-NAME
 10215
 10216
 10217* EXEC CICS LINK
 10218*        PROGRAM   (PGM-NAME)
 10219*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 190
* EL1278.cbl
 10220*        LENGTH    (DC-COMM-LENGTH)
 10221*    END-EXEC.
 10222*    MOVE '."C                   (   #00009421' TO DFHEIV0
 10223     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10224     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10225     MOVE X'2020233030303039343231' TO DFHEIV0(25:11)
 10226     CALL 'kxdfhei1' USING DFHEIV0,
 10227           PGM-NAME,
 10228           DATE-CONVERSION-DATA,
 10229           DC-COMM-LENGTH,
 10230           DFHEIV99,
 10231           DFHEIV99,
 10232           DFHEIV99,
 10233           DFHEIV99
 10234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10235
 10236
 10237
 10238 9700-ERROR-FORMAT  SECTION.
 10239     IF NOT EMI-ERRORS-COMPLETE
 10240         MOVE LINK-001               TO  PGM-NAME
 10241
 10242* EXEC CICS LINK
 10243*            PROGRAM   (PGM-NAME)
 10244*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10245*            LENGTH    (EMI-COMM-LENGTH)
 10246*        END-EXEC.
 10247*    MOVE '."C                   (   #00009431' TO DFHEIV0
 10248     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10250     MOVE X'2020233030303039343331' TO DFHEIV0(25:11)
 10251     CALL 'kxdfhei1' USING DFHEIV0,
 10252           PGM-NAME,
 10253           ERROR-MESSAGE-INTERFACE-BLOCK,
 10254           EMI-COMM-LENGTH,
 10255           DFHEIV99,
 10256           DFHEIV99,
 10257           DFHEIV99,
 10258           DFHEIV99
 10259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10260
 10261
 10262 9799-EXIT.
 10263     EXIT.
 10264
 10265 9800-SECURITY-VIOLATION  SECTION.
 10266*                            COPY ELCSCTP.
 10267******************************************************************
 10268*                                                                *
 10269*                            ELCSCTP                             *
 10270*                            VMOD=2.001                          *
 10271*                                                                *
 10272*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10273******************************************************************
 10274
 10275
 10276     MOVE EIBDATE          TO SM-JUL-DATE.
 10277     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 191
* EL1278.cbl
 10278     MOVE THIS-PGM         TO SM-PGM.
 10279     MOVE EIBTIME          TO TIME-IN.
 10280     MOVE TIME-OUT         TO SM-TIME.
 10281     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10282
 10283
 10284* EXEC CICS LINK
 10285*         PROGRAM  ('EL003')
 10286*         COMMAREA (SECURITY-MESSAGE)
 10287*         LENGTH   (80)
 10288*    END-EXEC.
 10289     MOVE 'EL003' TO DFHEIV1
 10290     MOVE 80
 10291       TO DFHEIV11
 10292*    MOVE '."C                   (   #00009458' TO DFHEIV0
 10293     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10295     MOVE X'2020233030303039343538' TO DFHEIV0(25:11)
 10296     CALL 'kxdfhei1' USING DFHEIV0,
 10297           DFHEIV1,
 10298           SECURITY-MESSAGE,
 10299           DFHEIV11,
 10300           DFHEIV99,
 10301           DFHEIV99,
 10302           DFHEIV99,
 10303           DFHEIV99
 10304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10305
 10306
 10307******************************************************************
 10308
 10309
 10310 9899-EXIT.
 10311     EXIT.
 10312
 10313 9900-ABEND  SECTION.
 10314     MOVE LINK-004               TO  PGM-NAME.
 10315     MOVE DFHEIBLK               TO  EMI-LINE1.
 10316
 10317
 10318* EXEC CICS LINK
 10319*        PROGRAM   (PGM-NAME)
 10320*        COMMAREA  (EMI-LINE1)
 10321*        LENGTH    (72)
 10322*    END-EXEC.
 10323     MOVE 72
 10324       TO DFHEIV11
 10325*    MOVE '."C                   (   #00009474' TO DFHEIV0
 10326     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10327     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10328     MOVE X'2020233030303039343734' TO DFHEIV0(25:11)
 10329     CALL 'kxdfhei1' USING DFHEIV0,
 10330           PGM-NAME,
 10331           EMI-LINE1,
 10332           DFHEIV11,
 10333           DFHEIV99,
 10334           DFHEIV99,
 10335           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 192
* EL1278.cbl
 10336           DFHEIV99
 10337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10338
 10339
 10340     MOVE -1                     TO  HLCANCL.
 10341
 10342     GO TO 8200-SEND-DATAONLY.
 10343
 10344 9999-LAST-PARAGRAPH.
 10345
 10346* GOBACK.
 10347     MOVE '9%                    "   ' TO DFHEIV0
 10348     MOVE 'EL1278' TO DFHEIV1
 10349     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10350     GOBACK.
 10351
 10352 9999-DFHBACK SECTION.
 10353     MOVE '9%                    "   ' TO DFHEIV0
 10354     MOVE 'EL1278' TO DFHEIV1
 10355     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10356     GOBACK.
 10357 9999-DFHEXIT.
 10358     IF DFHEIGDJ EQUAL 0001
 10359         NEXT SENTENCE
 10360     ELSE IF DFHEIGDJ EQUAL 2
 10361         GO TO 9500-PGMID-ERROR,
 10362               9900-ABEND
 10363         DEPENDING ON DFHEIGDI
 10364     ELSE IF DFHEIGDJ EQUAL 3
 10365         GO TO 0910-NOT-FOUND
 10366         DEPENDING ON DFHEIGDI
 10367     ELSE IF DFHEIGDJ EQUAL 4
 10368         GO TO 1010-NOTFND,
 10369               1020-NOTOPEN
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 5
 10372         GO TO 1290-ACCT-NOT-FOUND,
 10373               1290-ACCT-NOT-FOUND
 10374         DEPENDING ON DFHEIGDI
 10375     ELSE IF DFHEIGDJ EQUAL 6
 10376         GO TO 0580-ACCT-NOT-FOUND,
 10377               0580-ACCT-NOT-FOUND
 10378         DEPENDING ON DFHEIGDI
 10379     ELSE IF DFHEIGDJ EQUAL 7
 10380         GO TO 1699-EXIT
 10381         DEPENDING ON DFHEIGDI
 10382     ELSE IF DFHEIGDJ EQUAL 8
 10383         GO TO 7000-EXIT
 10384         DEPENDING ON DFHEIGDI
 10385     ELSE IF DFHEIGDJ EQUAL 9
 10386         GO TO 8300-SEND-TEXT
 10387         DEPENDING ON DFHEIGDI.
 10388     MOVE '9%                    "   ' TO DFHEIV0
 10389     MOVE 'EL1278' TO DFHEIV1
 10390     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10391     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:01 Page 193
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        9248     Code:       26850
