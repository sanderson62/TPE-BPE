* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL106.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL106.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL106.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL106.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:41:00.
     7*                            VMOD=2.026.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL106.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION- EX10 - STATE MAINTENANCE
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* Changes are marked by the Change Effective date.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100108    2008022800002  AJRA  ADD CHECK NUMBER TO STATE FOR AK
    34* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
    35******************************************************************
    36
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL106.cbl
    38 ENVIRONMENT DIVISION.
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL106 WORKING STORAGE     *'.
    44 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.026 ***********'.
    45
    46*                                COPY ELCSCTM.
    47******************************************************************
    48*                                                                *
    49*                                                                *
    50*                            ELCSCTM                             *
    51*                            VMOD=2.001                          *
    52*                                                                *
    53*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    54*                                                                *
    55******************************************************************
    56 01  SECURITY-MESSAGE.
    57     12  FILLER                          PIC X(30)
    58            VALUE '** LOGIC SECURITY VIOLATION -'.
    59     12  SM-READ                         PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' PGM='.
    62     12  SM-PGM                          PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' OPR='.
    65     12  SM-PROCESSOR-ID                 PIC X(4).
    66     12  FILLER                          PIC X(6)
    67            VALUE ' TERM='.
    68     12  SM-TERMID                       PIC X(4).
    69     12  FILLER                          PIC XX   VALUE SPACE.
    70     12  SM-JUL-DATE                     PIC 9(5).
    71     12  FILLER                          PIC X    VALUE SPACE.
    72     12  SM-TIME                         PIC 99.99.
    73
    74*                                COPY ELCSCRTY.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCRTY                            *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    82*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    83*        SAVED IN PI-SECURITY-ADDRESS.                           *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-CONTROL.
    87     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    88     12  FILLER                       PIC XX    VALUE 'SC'.
    89     12  SC-CREDIT-CODES.
    90         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    91             20  SC-CREDIT-DISPLAY    PIC X.
    92             20  SC-CREDIT-UPDATE     PIC X.
    93     12  SC-CLAIMS-CODES.
    94         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    95             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL106.cbl
    96             20  SC-CLAIMS-UPDATE     PIC X.
    97*                                COPY MPCSCRT.
    98******************************************************************
    99*                                                                *
   100*                            MPCSCRT                             *
   101*                            VMOD=1.001                          *
   102*                                                                *
   103*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   104*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   105*                                      (MP MORTGAGE PROTECTION)  *
   106*                                                                *
   107******************************************************************
   108*
   109 01  SECURITY-CONTROL-E.
   110     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   111     12  FILLER                       PIC  X(02) VALUE 'SC'.
   112     12  SC-QUID-KEY.
   113         16  SC-QUID-TERMINAL         PIC  X(04).
   114         16  SC-QUID-SYSTEM           PIC  X(04).
   115     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   116     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   117     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   118         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   119         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   120     12  SC-MP-CODES.
   121         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   122             20  SC-MP-DISPLAY        PIC  X(01).
   123             20  SC-MP-UPDATE         PIC  X(01).
   124     12  FILLER                       PIC  X(40).
   125
   126 01  WS-DATE-AREA.
   127     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   128     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   129
   130 01  WS.
   131     05  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +29.
   132     05  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   133     05  WS-COMM-LENGTH      PIC S9(4) COMP VALUE +1500.
   134     05  WS-MAP-LENGTH       PIC S9(4) COMP VALUE +500.
   135     05  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   136     05  QID.
   137         16  QID-TERM        PIC X(4).
   138         16  FILLER          PIC X(4)    VALUE '106A'.
   139
   140     05  WS-ST-TOL-PREM-PCT  PIC S9V9(4)    VALUE +0.
   141     05  WS-ST-TOL-REF-PCT   PIC S9V9(4)    VALUE +0.
   142     05  WS-ST-OVR-SHT-PCT   PIC S9V9(4)    VALUE +0.
   143     05  WS-ST-LF-PREM-TAX   PIC S9V9(4)    VALUE +0.
   144     05  WS-ST-AH-PREM-TAX-I PIC S9V9(4)    VALUE +0.
   145     05  WS-ST-AH-PREM-TAX-G PIC S9V9(4)    VALUE +0.
   146     05  WS-ST-LF-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   147     05  WS-ST-AH-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   148     05  WS-ST-TARGET-LOSS-RATIO
   149                             PIC S9V9(4)    VALUE +0.
   150     05  WS-ST-CALC-INTEREST PIC S9V9(4)    VALUE +0.
   151     05  WS-COMSL            PIC S9V9(4)    VALUE +0.
   152     05  WS-COMJL            PIC S9V9(4)    VALUE +0.
   153     05  WS-COMSA            PIC S9V9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL106.cbl
   154     05  WS-COMJA            PIC S9V9(4)    VALUE +0.
   155     05  WS-RESIDENT-TAX     PIC S9V9(4)    VALUE +0.
   156     05  WS-IRATE            PIC S9V9(4)    VALUE +0.
   157     05  WS-IRATE1           PIC S9V9(4)    VALUE +0.
   158     05  WS-IRATE2           PIC S9V9(4)    VALUE +0.
   159     05  WS-IRATE3           PIC S9V9(4)    VALUE +0.
   160     05  WS-FREE-LOOK-DAYS   PIC S9(3)      VALUE +0.
   161
   162 01  STANDARD-AREAS.
   163     12  MAP-NAME            PIC X(8)    VALUE 'EL106A'.
   164     12  MAPSET-NAME         PIC X(8)    VALUE 'EL106S'.
   165     12  TRANS-ID            PIC X(4)    VALUE 'EX10'.
   166     12  PGM-NAME            PIC X(8).
   167     12  TIME-IN             PIC S9(7).
   168     12  TIME-OUT-R  REDEFINES TIME-IN.
   169         16  FILLER          PIC X.
   170         16  TIME-OUT        PIC 99V99.
   171         16  FILLER          PIC XX.
   172     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   173     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   174     12  XCTL-EL126          PIC X(8)    VALUE 'EL126'.
   175     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   176     12  XCTL-EL6565         PIC X(8)    VALUE 'EL6565'.
   177     12  XCTL-EL6507         PIC X(8)    VALUE 'EL6507'.
   178     12  XCTL-EL1061         PIC X(8)    VALUE 'EL1061'.
   179     12  XCTL-EM626          PIC X(8)    VALUE 'EM626'.
   180     12  XCTL-GL800          PIC X(8)    VALUE 'GL800'.
   181     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   182     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   183     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   184     12  THIS-PGM            PIC X(8)    VALUE 'EL106'.
   185     12  ELCNTL-ID           PIC X(8)    VALUE 'ELCNTL'.
   186     12  ELLETR-ID           PIC X(8)    VALUE 'ELLETR'.
   187     12  SUB                 PIC S9(4)   COMP.
   188     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   189     12  WS-FIRST-TIME-SW    PIC X       VALUE 'Y'.
   190         88  FIRST-TIME                  VALUE 'Y'.
   191     12  WS-DISPLAY-SW       PIC X       VALUE 'N'.
   192         88  RETURN-DISPLAY              VALUE 'Y'.
   193
   194 01  ACCESS-KEYS.
   195     12  ELCNTL-KEY.
   196         16  CK-COMP-ID      PIC X(3).
   197         16  FILLER          PIC X       VALUE '3'.
   198         16  CK-STATE-CD     PIC X(4)    VALUE SPACES.
   199         16  CK-SEQ          PIC S9(4)   VALUE +0    COMP.
   200     12  W-WORKING-TEXT-KEY.
   201         16  W-TEXT-COMPANY-CD
   202                             PIC X.
   203         16  W-TEXT-FORM-NO  PIC X(12).
   204         16  W-TEXT-LINE-SEQ PIC S9(4)   COMP.
   205
   206 01  ERROR-MESSAGES.
   207     12  ER-0000                 PIC X(4)  VALUE '0000'.
   208     12  ER-0004                 PIC X(4)  VALUE '0004'.
   209     12  ER-0013                 PIC X(4)  VALUE '0013'.
   210     12  ER-0023                 PIC X(4)  VALUE '0023'.
   211     12  ER-0029                 PIC X(4)  VALUE '0029'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL106.cbl
   212     12  ER-0042                 PIC X(4)  VALUE '0042'.
   213     12  ER-0050                 PIC X(4)  VALUE '0050'.
   214     12  ER-0068                 PIC X(4)  VALUE '0068'.
   215     12  ER-0070                 PIC X(4)  VALUE '0070'.
   216     12  ER-0141                 PIC X(4)  VALUE '0141'.
   217     12  ER-0144                 PIC X(4)  VALUE '0144'.
   218     12  ER-0145                 PIC X(4)  VALUE '0145'.
   219     12  ER-0146                 PIC X(4)  VALUE '0146'.
   220     12  ER-0147                 PIC X(4)  VALUE '0147'.
   221     12  ER-0148                 PIC X(4)  VALUE '0148'.
   222     12  ER-0149                 PIC X(4)  VALUE '0149'.
   223     12  ER-0150                 PIC X(4)  VALUE '0150'.
   224     12  ER-0151                 PIC X(4)  VALUE '0151'.
   225     12  ER-0152                 PIC X(4)  VALUE '0152'.
   226     12  ER-0153                 PIC X(4)  VALUE '0153'.
   227     12  ER-0159                 PIC X(4)  VALUE '0159'.
   228     12  ER-0160                 PIC X(4)  VALUE '0160'.
   229     12  ER-0161                 PIC X(4)  VALUE '0161'.
   230     12  ER-0582                 PIC X(4)  VALUE '0582'.
   231     12  ER-0805                 PIC X(4)  VALUE '0805'.
   232     12  ER-1614                 PIC X(4)  VALUE '1614'.
   233     12  ER-2009                 PIC X(4)  VALUE '2009'.
   234     12  ER-2010                 PIC X(4)  VALUE '2010'.
   235     12  ER-2012                 PIC X(4)  VALUE '2012'.
   236     12  ER-2014                 PIC X(4)  VALUE '2014'.
   237     12  ER-2024                 PIC X(4)  VALUE '2024'.
   238     12  ER-2028                 PIC X(4)  VALUE '2028'.
   239     12  ER-2032                 PIC X(4)  VALUE '2032'.
   240     12  ER-2033                 PIC X(4)  VALUE '2033'.
   241     12  ER-2082                 PIC X(4)  VALUE '2082'.
   242     12  ER-2084                 PIC X(4)  VALUE '2084'.
   243     12  ER-2137                 PIC X(4)  VALUE '2137'.
   244     12  ER-2298                 PIC X(4)  VALUE '2298'.
   245     12  ER-2299                 PIC X(4)  VALUE '2299'.
   246     12  ER-3030                 PIC X(4)  VALUE '3030'.
   247     12  ER-3031                 PIC X(4)  VALUE '3031'.
   248     12  ER-3032                 PIC X(4)  VALUE '3032'.
   249     12  ER-3033                 PIC X(4)  VALUE '3033'.
   250     12  ER-3034                 PIC X(4)  VALUE '3034'.
   251     12  ER-3035                 PIC X(4)  VALUE '3035'.
   252     12  ER-3036                 PIC X(4)  VALUE '3036'.
   253     12  ER-7008                 PIC X(4)  VALUE '7008'.
   254     12  ER-7346                 PIC X(4)  VALUE '7346'.
   255     12  ER-7531                 PIC X(4)  VALUE '7531'.
   256     12  ER-7532                 PIC X(4)  VALUE '7532'.
   257     12  ER-7536                 PIC X(4)  VALUE '7536'.
   258     12  ER-7717                 PIC X(4)  VALUE '7717'.
   259     12  ER-7735                 PIC X(4)  VALUE '7735'.
   260     12  ER-8159                 PIC X(4)  VALUE '8159'.
   261     12  ER-9074                 PIC X(4)  VALUE '9074'.
   262     12  ER-9097                 PIC X(4)  VALUE '9097'.
   263     12  ER-9447                 PIC X(4)  VALUE '9447'.
   264     12  ER-9448                 PIC X(4)  VALUE '9448'.
   265     12  ER-9478                 PIC X(4)  VALUE '9478'.
   266     12  ER-9999                 PIC X(4)  VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL106.cbl
   268*    COPY ELCDATE.
   269******************************************************************
   270*                                                                *
   271*                                                                *
   272*                            ELCDATE.                            *
   273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   274*                            VMOD=2.003
   275*                                                                *
   276*                                                                *
   277*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   278*                 LENGTH = 200                                   *
   279******************************************************************
   280
   281 01  DATE-CONVERSION-DATA.
   282     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   283     12  DC-OPTION-CODE                PIC X.
   284         88  BIN-TO-GREG                VALUE ' '.
   285         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   286         88  EDIT-GREG-TO-BIN           VALUE '2'.
   287         88  YMD-GREG-TO-BIN            VALUE '3'.
   288         88  MDY-GREG-TO-BIN            VALUE '4'.
   289         88  JULIAN-TO-BIN              VALUE '5'.
   290         88  BIN-PLUS-ELAPSED           VALUE '6'.
   291         88  FIND-CENTURY               VALUE '7'.
   292         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   293         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   294         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   295         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   296         88  JULIAN-TO-BIN-3            VALUE 'C'.
   297         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   298         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   299         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   300         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   301         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   302         88  CHECK-LEAP-YEAR            VALUE 'H'.
   303         88  BIN-3-TO-GREG              VALUE 'I'.
   304         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   305         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   306         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   307         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   308         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   309         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   310         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   311         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   312         88  THREE-CHARACTER-BIN
   313                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   314         88  GREGORIAN-TO-BIN
   315                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   316         88  BIN-TO-GREGORIAN
   317                  VALUES ' ' '1' 'I' '8' 'G'.
   318         88  JULIAN-TO-BINARY
   319                  VALUES '5' 'C' 'E' 'F'.
   320     12  DC-ERROR-CODE                 PIC X.
   321         88  NO-CONVERSION-ERROR        VALUE ' '.
   322         88  DATE-CONVERSION-ERROR
   323                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   324         88  DATE-IS-ZERO               VALUE '1'.
   325         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL106.cbl
   326         88  DATE-IS-INVALID            VALUE '3'.
   327         88  DATE1-GREATER-DATE2        VALUE '4'.
   328         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   329         88  DATE-INVALID-OPTION        VALUE '9'.
   330         88  INVALID-CENTURY            VALUE 'A'.
   331         88  ONLY-CENTURY               VALUE 'B'.
   332         88  ONLY-LEAP-YEAR             VALUE 'C'.
   333         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   334     12  DC-END-OF-MONTH               PIC X.
   335         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   336     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   337         88  USE-NORMAL-PROCESS         VALUE ' '.
   338         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   339         88  ADJUST-UP-100-YRS          VALUE '2'.
   340     12  FILLER                        PIC X.
   341     12  DC-CONVERSION-DATES.
   342         16  DC-BIN-DATE-1             PIC XX.
   343         16  DC-BIN-DATE-2             PIC XX.
   344         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   345         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   346                       DC-GREG-DATE-1-EDIT.
   347             20  DC-EDIT1-MONTH        PIC 99.
   348             20  SLASH1-1              PIC X.
   349             20  DC-EDIT1-DAY          PIC 99.
   350             20  SLASH1-2              PIC X.
   351             20  DC-EDIT1-YEAR         PIC 99.
   352         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   353         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   354                     DC-GREG-DATE-2-EDIT.
   355             20  DC-EDIT2-MONTH        PIC 99.
   356             20  SLASH2-1              PIC X.
   357             20  DC-EDIT2-DAY          PIC 99.
   358             20  SLASH2-2              PIC X.
   359             20  DC-EDIT2-YEAR         PIC 99.
   360         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   361         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   362                     DC-GREG-DATE-1-YMD.
   363             20  DC-YMD-YEAR           PIC 99.
   364             20  DC-YMD-MONTH          PIC 99.
   365             20  DC-YMD-DAY            PIC 99.
   366         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   367         16  DC-GREG-DATE-1-MDY-R REDEFINES
   368                      DC-GREG-DATE-1-MDY.
   369             20  DC-MDY-MONTH          PIC 99.
   370             20  DC-MDY-DAY            PIC 99.
   371             20  DC-MDY-YEAR           PIC 99.
   372         16  DC-GREG-DATE-1-ALPHA.
   373             20  DC-ALPHA-MONTH        PIC X(10).
   374             20  DC-ALPHA-DAY          PIC 99.
   375             20  FILLER                PIC XX.
   376             20  DC-ALPHA-CENTURY.
   377                 24 DC-ALPHA-CEN-N     PIC 99.
   378             20  DC-ALPHA-YEAR         PIC 99.
   379         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   380         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   381         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   382         16  DC-JULIAN-DATE            PIC 9(05).
   383         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL106.cbl
   384                                       PIC 9(05).
   385         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   386             20  DC-JULIAN-YEAR        PIC 99.
   387             20  DC-JULIAN-DAYS        PIC 999.
   388         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   389         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   390         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   391     12  DATE-CONVERSION-VARIBLES.
   392         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   393         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   394             20  FILLER                PIC 9(3).
   395             20  HOLD-CEN-1-CCYY.
   396                 24  HOLD-CEN-1-CC     PIC 99.
   397                 24  HOLD-CEN-1-YY     PIC 99.
   398             20  HOLD-CEN-1-MO         PIC 99.
   399             20  HOLD-CEN-1-DA         PIC 99.
   400         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   401             20  HOLD-CEN-1-R-MO       PIC 99.
   402             20  HOLD-CEN-1-R-DA       PIC 99.
   403             20  HOLD-CEN-1-R-CCYY.
   404                 24  HOLD-CEN-1-R-CC   PIC 99.
   405                 24  HOLD-CEN-1-R-YY   PIC 99.
   406             20  FILLER                PIC 9(3).
   407         16  HOLD-CENTURY-1-X.
   408             20  FILLER                PIC X(3)  VALUE SPACES.
   409             20  HOLD-CEN-1-X-CCYY.
   410                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   411                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   412             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   413             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   414         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   415             20  HOLD-CEN-1-R-X-MO     PIC XX.
   416             20  HOLD-CEN-1-R-X-DA     PIC XX.
   417             20  HOLD-CEN-1-R-X-CCYY.
   418                 24  HOLD-CEN-1-R-X-CC PIC XX.
   419                 24  HOLD-CEN-1-R-X-YY PIC XX.
   420             20  FILLER                PIC XXX.
   421         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   422         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   423         16  DC-JULIAN-DATE-1          PIC 9(07).
   424         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   425             20  DC-JULIAN-1-CCYY.
   426                 24  DC-JULIAN-1-CC    PIC 99.
   427                 24  DC-JULIAN-1-YR    PIC 99.
   428             20  DC-JULIAN-DA-1        PIC 999.
   429         16  DC-JULIAN-DATE-2          PIC 9(07).
   430         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   431             20  DC-JULIAN-2-CCYY.
   432                 24  DC-JULIAN-2-CC    PIC 99.
   433                 24  DC-JULIAN-2-YR    PIC 99.
   434             20  DC-JULIAN-DA-2        PIC 999.
   435         16  DC-GREG-DATE-A-EDIT.
   436             20  DC-EDITA-MONTH        PIC 99.
   437             20  SLASHA-1              PIC X VALUE '/'.
   438             20  DC-EDITA-DAY          PIC 99.
   439             20  SLASHA-2              PIC X VALUE '/'.
   440             20  DC-EDITA-CCYY.
   441                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL106.cbl
   442                 24  DC-EDITA-YEAR     PIC 99.
   443         16  DC-GREG-DATE-B-EDIT.
   444             20  DC-EDITB-MONTH        PIC 99.
   445             20  SLASHB-1              PIC X VALUE '/'.
   446             20  DC-EDITB-DAY          PIC 99.
   447             20  SLASHB-2              PIC X VALUE '/'.
   448             20  DC-EDITB-CCYY.
   449                 24  DC-EDITB-CENT     PIC 99.
   450                 24  DC-EDITB-YEAR     PIC 99.
   451         16  DC-GREG-DATE-CYMD         PIC 9(08).
   452         16  DC-GREG-DATE-CYMD-R REDEFINES
   453                              DC-GREG-DATE-CYMD.
   454             20  DC-CYMD-CEN           PIC 99.
   455             20  DC-CYMD-YEAR          PIC 99.
   456             20  DC-CYMD-MONTH         PIC 99.
   457             20  DC-CYMD-DAY           PIC 99.
   458         16  DC-GREG-DATE-MDCY         PIC 9(08).
   459         16  DC-GREG-DATE-MDCY-R REDEFINES
   460                              DC-GREG-DATE-MDCY.
   461             20  DC-MDCY-MONTH         PIC 99.
   462             20  DC-MDCY-DAY           PIC 99.
   463             20  DC-MDCY-CEN           PIC 99.
   464             20  DC-MDCY-YEAR          PIC 99.
   465    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   466        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   467    12  DC-EL310-DATE                  PIC X(21).
   468    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL106.cbl
   470*    COPY ELCLOGOF.
   471******************************************************************
   472*                                                                *
   473*                                                                *
   474*                            ELCLOGOF.                           *
   475*                            VMOD=2.001                          *
   476*                                                                *
   477*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   478*                                                                *
   479******************************************************************
   480 01  CLASIC-LOGOFF.
   481     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   482     12  LOGOFF-TEXT.
   483         16  FILLER          PIC X(5)    VALUE SPACES.
   484         16  LOGOFF-MSG.
   485             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   486             20  FILLER      PIC X       VALUE SPACES.
   487             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   488         16  FILLER          PIC X(80)
   489           VALUE '* YOU ARE NOW LOGGED OFF'.
   490         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   491         16  FILLER          PIC X       VALUE QUOTE.
   492         16  LOGOFF-SYS-MSG  PIC X(17)
   493           VALUE 'S CLAS-IC SYSTEM '.
   494     12  TEXT-MESSAGES.
   495         16  UNACCESS-MSG    PIC X(29)
   496             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   497         16  PGMIDERR-MSG    PIC X(17)
   498             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL106.cbl
   500*    COPY ELCATTR.
   501******************************************************************
   502*                                                                *
   503*                            ELCATTR.                            *
   504*                            VMOD=2.001                          *
   505*                                                                *
   506*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   507*                                                                *
   508*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   509*                                                                *
   510*                   POS 1   P=PROTECTED                          *
   511*                           U=UNPROTECTED                        *
   512*                           S=ASKIP                              *
   513*                   POS 2   A=ALPHA/NUMERIC                      *
   514*                           N=NUMERIC                            *
   515*                   POS 3   N=NORMAL                             *
   516*                           B=BRIGHT                             *
   517*                           D=DARK                               *
   518*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   519*                           OF=MODIFIED DATA TAG OFF             *
   520*                                                                *
   521*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   522******************************************************************
   523 01  ATTRIBUTE-LIST.
   524     12  AL-PABOF            PIC X       VALUE 'Y'.
   525     12  AL-PABON            PIC X       VALUE 'Z'.
   526     12  AL-PADOF            PIC X       VALUE '%'.
   527     12  AL-PADON            PIC X       VALUE '_'.
   528     12  AL-PANOF            PIC X       VALUE '-'.
   529     12  AL-PANON            PIC X       VALUE '/'.
   530     12  AL-SABOF            PIC X       VALUE '8'.
   531     12  AL-SABON            PIC X       VALUE '9'.
   532     12  AL-SADOF            PIC X       VALUE '@'.
   533     12  AL-SADON            PIC X       VALUE QUOTE.
   534     12  AL-SANOF            PIC X       VALUE '0'.
   535     12  AL-SANON            PIC X       VALUE '1'.
   536     12  AL-UABOF            PIC X       VALUE 'H'.
   537     12  AL-UABON            PIC X       VALUE 'I'.
   538     12  AL-UADOF            PIC X       VALUE '<'.
   539     12  AL-UADON            PIC X       VALUE '('.
   540     12  AL-UANOF            PIC X       VALUE ' '.
   541     12  AL-UANON            PIC X       VALUE 'A'.
   542     12  AL-UNBOF            PIC X       VALUE 'Q'.
   543     12  AL-UNBON            PIC X       VALUE 'R'.
   544     12  AL-UNDOF            PIC X       VALUE '*'.
   545     12  AL-UNDON            PIC X       VALUE ')'.
   546     12  AL-UNNOF            PIC X       VALUE '&'.
   547     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL106.cbl
   549*    COPY ELCEMIB.
   550******************************************************************
   551*                                                                *
   552*                                                                *
   553*                            ELCEMIB.                            *
   554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   555*                            VMOD=2.005                          *
   556*                                                                *
   557*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   558*                                                                *
   559******************************************************************
   560 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   561     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   562     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   563     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   564     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   565     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   566     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   567     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   568     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   569     12  EMI-SWITCH1             PIC X        VALUE '1'.
   570         88  EMI-NO-ERRORS                    VALUE '1'.
   571         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   572         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   573     12  EMI-SWITCH2             PIC X        VALUE '1'.
   574         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   575     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   576         88  EMI-AREA1-EMPTY                  VALUE '1'.
   577         88  EMI-AREA1-FULL                   VALUE '2'.
   578     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   579         88  EMI-AREA2-EMPTY                  VALUE '1'.
   580         88  EMI-AREA2-FULL                   VALUE '2'.
   581     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   582         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   583         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   584         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   585         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   586         88  EMI-BYPASS-FATALS                VALUE 'X'.
   587     12  EMI-ERROR-LINES.
   588         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   589         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   590         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   591         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   592             20  EMI-ERR-CODES OCCURS 10 TIMES.
   593                 24  EMI-ERR-NUM         PIC X(4).
   594                 24  EMI-FILLER          PIC X.
   595                 24  EMI-SEV             PIC X.
   596                 24  FILLER              PIC X.
   597             20  FILLER                  PIC X(02).
   598     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   599         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   600             20  EMI-ERROR-NUMBER    PIC X(4).
   601             20  EMI-FILL            PIC X.
   602             20  EMI-SEVERITY        PIC X.
   603             20  FILLER              PIC X.
   604             20  EMI-ERROR-TEXT.
   605                 24  EMI-TEXT-VARIABLE   PIC X(10).
   606                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL106.cbl
   607     12  EMI-SEVERITY-SAVE           PIC X.
   608         88  EMI-NOTE                    VALUE 'N'.
   609         88  EMI-WARNING                 VALUE 'W'.
   610         88  EMI-FORCABLE                VALUE 'F'.
   611         88  EMI-FATAL                   VALUE 'X'.
   612     12  EMI-MESSAGE-FLAG            PIC X.
   613         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   614         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   615     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   616     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   617         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   618         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   619         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   620     12  FILLER                      PIC X(137)  VALUE SPACES.
   621     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   622     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   623     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   624     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL106.cbl
   626*    COPY ELCJPFX.
   627******************************************************************
   628*                                                                *
   629*                                                                *
   630*                            ELCJPFX.                            *
   631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   632*                            VMOD=2.002                          *
   633*                                                                *
   634*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   635*                                                                *
   636*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   637*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   638*        ELCNTL - CONTROL FILE                                   *
   639*        ELMSTR - CLAIM MASTERS                                  *
   640*        ELTRLR - ACTIVITY TRAILERS                              *
   641*        ELCHKQ - CHECK QUE                                      *
   642******************************************************************
   643 01  JOURNAL-RECORD.
   644     12  JP-USER-ID                  PIC X(4).
   645     12  JP-FILE-ID                  PIC X(8).
   646     12  JP-PROGRAM-ID               PIC X(8).
   647     12  JP-RECORD-TYPE              PIC X.
   648         88 JP-ADD              VALUE 'A'.
   649         88 JP-BEFORE-CHANGE    VALUE 'B'.
   650         88 JP-AFTER-CHANGE     VALUE 'C'.
   651         88 JP-DELETE           VALUE 'D'.
   652         88 JP-GENERIC-DELETE   VALUE 'G'.
   653         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   654         88 JP-KEY-CHG-ADD      VALUE 'N'.
   655     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   656     12  JP-RECORD-AREA
   657
   658
   659             PIC X(530).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL106.cbl
   661*    COPY ELCINTF.
   662******************************************************************
   663*                                                                *
   664*                                                                *
   665*                            ELCINTF.                            *
   666*                            VMOD=2.017                          *
   667*                                                                *
   668*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   669*                                                                *
   670*       LENGTH = 1024                                            *
   671*                                                                *
   672******************************************************************
   673 01  PROGRAM-INTERFACE-BLOCK.
   674     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   675     12  PI-CALLING-PROGRAM              PIC X(8).
   676     12  PI-SAVED-PROGRAM-1              PIC X(8).
   677     12  PI-SAVED-PROGRAM-2              PIC X(8).
   678     12  PI-SAVED-PROGRAM-3              PIC X(8).
   679     12  PI-SAVED-PROGRAM-4              PIC X(8).
   680     12  PI-SAVED-PROGRAM-5              PIC X(8).
   681     12  PI-SAVED-PROGRAM-6              PIC X(8).
   682     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   683     12  PI-COMPANY-ID                   PIC XXX.
   684     12  PI-COMPANY-CD                   PIC X.
   685
   686     12  PI-COMPANY-PASSWORD             PIC X(8).
   687
   688     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   689
   690     12  PI-CONTROL-IN-PROGRESS.
   691         16  PI-CARRIER                  PIC X.
   692         16  PI-GROUPING                 PIC X(6).
   693         16  PI-STATE                    PIC XX.
   694         16  PI-ACCOUNT                  PIC X(10).
   695         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   696                                         PIC X(10).
   697         16  PI-CLAIM-CERT-GRP.
   698             20  PI-CLAIM-NO             PIC X(7).
   699             20  PI-CERT-NO.
   700                 25  PI-CERT-PRIME       PIC X(10).
   701                 25  PI-CERT-SFX         PIC X.
   702             20  PI-CERT-EFF-DT          PIC XX.
   703         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   704             20  PI-PLAN-CODE            PIC X(2).
   705             20  PI-REVISION-NUMBER      PIC X(3).
   706             20  PI-PLAN-EFF-DT          PIC X(2).
   707             20  PI-PLAN-EXP-DT          PIC X(2).
   708             20  FILLER                  PIC X(11).
   709         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   710             20  PI-OE-REFERENCE-1.
   711                 25  PI-OE-REF-1-PRIME   PIC X(18).
   712                 25  PI-OE-REF-1-SUFF    PIC XX.
   713
   714     12  PI-SESSION-IN-PROGRESS          PIC X.
   715         88  CLAIM-SESSION                   VALUE '1'.
   716         88  CREDIT-SESSION                  VALUE '2'.
   717         88  WARRANTY-SESSION                VALUE '3'.
   718         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL106.cbl
   719         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   720
   721
   722*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   723
   724     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   725     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   726
   727     12  PI-CREDIT-USER                  PIC X.
   728         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   729         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   730
   731     12  PI-CLAIM-USER                   PIC X.
   732         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   733         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   734
   735     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   736         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   737         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   738         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   739         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   740         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   741
   742     12  PI-PROCESSOR-ID                 PIC X(4).
   743
   744     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   745
   746     12  PI-MEMBER-CAPTION               PIC X(10).
   747
   748     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   749         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   750
   751     12  PI-LIFE-OVERRIDE-L1             PIC X.
   752     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   753     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   754     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   755
   756     12  PI-AH-OVERRIDE-L1               PIC X.
   757     12  PI-AH-OVERRIDE-L2               PIC XX.
   758     12  PI-AH-OVERRIDE-L6               PIC X(6).
   759     12  PI-AH-OVERRIDE-L12              PIC X(12).
   760
   761     12  PI-NEW-SYSTEM                   PIC X(2).
   762
   763     12  PI-PRIMARY-CERT-NO              PIC X(11).
   764     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   765         88  PI-USES-PAID-TO                 VALUE '1'.
   766     12  PI-CRDTCRD-SYSTEM.
   767         16  PI-CRDTCRD-USER             PIC X.
   768             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   769             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   770         16  PI-CC-MONTH-END-DT          PIC XX.
   771     12  PI-PROCESSOR-PRINTER            PIC X(4).
   772
   773     12  PI-OE-REFERENCE-2.
   774         16  PI-OE-REF-2-PRIME           PIC X(10).
   775         16  PI-OE-REF-2-SUFF            PIC X.
   776
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL106.cbl
   777     12  PI-REM-TRM-CALC-OPTION          PIC X.
   778
   779     12  PI-LANGUAGE-TYPE                PIC X.
   780             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   781             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   782             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   783
   784     12  PI-POLICY-LINKAGE-IND           PIC X.
   785         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   786         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   787                                                   LOW-VALUES.
   788
   789     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   790     12  PI-CLAIM-PW-SESSION             PIC X(1).
   791         88  PI-CLAIM-CREDIT                 VALUE '1'.
   792         88  PI-CLAIM-CONVEN                 VALUE '2'.
   793     12  FILLER                          PIC X(4).
   794
   795     12  PI-SYSTEM-LEVEL                 PIC X(145).
   796
   797     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   798         PI-SYSTEM-LEVEL.
   799
   800         16  PI-ENTRY-CODES.
   801             20  PI-ENTRY-CD-1           PIC X.
   802             20  PI-ENTRY-CD-2           PIC X.
   803
   804         16  PI-RETURN-CODES.
   805             20  PI-RETURN-CD-1          PIC X.
   806             20  PI-RETURN-CD-2          PIC X.
   807
   808         16  PI-UPDATE-STATUS-SAVE.
   809             20  PI-UPDATE-BY            PIC X(4).
   810             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   811
   812         16  PI-LOWER-CASE-LETTERS       PIC X.
   813             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   814
   815*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   816*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   817*            88  CARRIER-CLM-CNTL            VALUE '2'.
   818
   819         16  PI-CERT-ACCESS-CONTROL      PIC X.
   820             88  ST-ACCNT-CNTL               VALUE ' '.
   821             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   822             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   823             88  ACCNT-CNTL                  VALUE '3'.
   824             88  CARR-ACCNT-CNTL             VALUE '4'.
   825
   826         16  PI-PROCESSOR-CAP-LIST.
   827             20  PI-SYSTEM-CONTROLS.
   828                24 PI-SYSTEM-DISPLAY     PIC X.
   829                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   830                24 PI-SYSTEM-MODIFY      PIC X.
   831                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   832             20  FILLER                  PIC XX.
   833             20  PI-DISPLAY-CAP          PIC X.
   834                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL106.cbl
   835             20  PI-MODIFY-CAP           PIC X.
   836                 88  MODIFY-CAP              VALUE 'Y'.
   837             20  PI-MSG-AT-LOGON-CAP     PIC X.
   838                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   839             20  PI-FORCE-CAP            PIC X.
   840                 88  FORCE-CAP               VALUE 'Y'.
   841
   842         16  PI-PROGRAM-CONTROLS.
   843             20  PI-PGM-PRINT-OPT        PIC X.
   844             20  PI-PGM-FORMAT-OPT       PIC X.
   845             20  PI-PGM-PROCESS-OPT      PIC X.
   846             20  PI-PGM-TOTALS-OPT       PIC X.
   847
   848         16  PI-HELP-INTERFACE.
   849             20  PI-LAST-ERROR-NO        PIC X(4).
   850             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   851
   852         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   853             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   854
   855         16  PI-CR-CONTROL-IN-PROGRESS.
   856             20  PI-CR-CARRIER           PIC X.
   857             20  PI-CR-GROUPING          PIC X(6).
   858             20  PI-CR-STATE             PIC XX.
   859             20  PI-CR-ACCOUNT           PIC X(10).
   860             20  PI-CR-FIN-RESP          PIC X(10).
   861             20  PI-CR-TYPE              PIC X.
   862
   863         16  PI-CR-BATCH-NUMBER          PIC X(6).
   864
   865         16  PI-CR-MONTH-END-DT          PIC XX.
   866
   867         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   868             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   869             88  PI-ZERO-CARRIER             VALUE '1'.
   870             88  PI-ZERO-GROUPING            VALUE '2'.
   871             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   872
   873         16  PI-CARRIER-SECURITY         PIC X.
   874             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   875
   876         16  PI-ACCOUNT-SECURITY         PIC X(10).
   877             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   878             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   879
   880         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   881             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   882                                         INDEXED BY PI-ACCESS-NDX
   883                                         PIC X.
   884
   885         16  PI-GA-BILLING-CONTROL       PIC X.
   886             88  PI-GA-BILLING               VALUE '1'.
   887
   888         16  PI-MAIL-PROCESSING          PIC X.
   889             88  PI-MAIL-YES                 VALUE 'Y'.
   890
   891         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   892
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL106.cbl
   893         16  PI-AR-SYSTEM.
   894             20  PI-AR-PROCESSING-CNTL   PIC X.
   895                 88  PI-AR-PROCESSING        VALUE 'Y'.
   896             20  PI-AR-SUMMARY-CODE      PIC X(6).
   897             20  PI-AR-MONTH-END-DT      PIC XX.
   898
   899         16  PI-MP-SYSTEM.
   900             20  PI-MORTGAGE-USER            PIC X.
   901                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   902                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   903             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   904                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   905                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   906                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   907                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   908                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   909             20  PI-MP-MONTH-END-DT          PIC XX.
   910             20  PI-MP-REFERENCE-NO.
   911                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   912                 24  PI-MP-REFERENCE-SFX     PIC XX.
   913
   914         16  PI-LABEL-CONTROL            PIC X(01).
   915             88  PI-CREATE-LABELS                    VALUE 'Y'.
   916             88  PI-BYPASS-LABELS                    VALUE 'N'.
   917
   918         16  PI-BILL-GROUPING-CODE       PIC X(01).
   919             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   920
   921         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   922             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   923             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   924
   925         16  FILLER                      PIC X(14).
   926
   927     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   928******************************************************************
   929     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   930         16  FILLER              PIC X(101).
   931         16  PI-WS-STATE         PIC XX.
   932         16  PI-WS-CLASS         PIC XX.
   933         16  PI-WS-DEV           PIC XXX.
   934         16  PI-WS-TYPE          PIC X.
   935         16  PI-WS-PLAN          PIC XX.
   936         16  PI-PREV-STATE       PIC X(4).
   937         16  FILLER              PIC X(525).
   938
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL106.cbl
   940*    COPY ELCAID.
   941******************************************************************
   942*                                                                *
   943*                            ELCAID.                             *
   944*                            VMOD=2.001                          *
   945*                                                                *
   946*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   947*                                                                *
   948*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   949*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   950******************************************************************
   951
   952 01  DFHAID.
   953   02  DFHNULL   PIC  X  VALUE  ' '.
   954   02  DFHENTER  PIC  X  VALUE  QUOTE.
   955   02  DFHCLEAR  PIC  X  VALUE  '_'.
   956   02  DFHPEN    PIC  X  VALUE  '='.
   957   02  DFHOPID   PIC  X  VALUE  'W'.
   958   02  DFHPA1    PIC  X  VALUE  '%'.
   959   02  DFHPA2    PIC  X  VALUE  '>'.
   960   02  DFHPA3    PIC  X  VALUE  ','.
   961   02  DFHPF1    PIC  X  VALUE  '1'.
   962   02  DFHPF2    PIC  X  VALUE  '2'.
   963   02  DFHPF3    PIC  X  VALUE  '3'.
   964   02  DFHPF4    PIC  X  VALUE  '4'.
   965   02  DFHPF5    PIC  X  VALUE  '5'.
   966   02  DFHPF6    PIC  X  VALUE  '6'.
   967   02  DFHPF7    PIC  X  VALUE  '7'.
   968   02  DFHPF8    PIC  X  VALUE  '8'.
   969   02  DFHPF9    PIC  X  VALUE  '9'.
   970   02  DFHPF10   PIC  X  VALUE  ':'.
   971   02  DFHPF11   PIC  X  VALUE  '#'.
   972   02  DFHPF12   PIC  X  VALUE  '@'.
   973   02  DFHPF13   PIC  X  VALUE  'A'.
   974   02  DFHPF14   PIC  X  VALUE  'B'.
   975   02  DFHPF15   PIC  X  VALUE  'C'.
   976   02  DFHPF16   PIC  X  VALUE  'D'.
   977   02  DFHPF17   PIC  X  VALUE  'E'.
   978   02  DFHPF18   PIC  X  VALUE  'F'.
   979   02  DFHPF19   PIC  X  VALUE  'G'.
   980   02  DFHPF20   PIC  X  VALUE  'H'.
   981   02  DFHPF21   PIC  X  VALUE  'I'.
   982*00039    02  DFHPF22   PIC  X  VALUE  ''.
   983   02  DFHPF22   PIC  X  VALUE  '['.
   984   02  DFHPF23   PIC  X  VALUE  '.'.
   985   02  DFHPF24   PIC  X  VALUE  '<'.
   986   02  DFHMSRE   PIC  X  VALUE  'X'.
   987   02  DFHSTRF   PIC  X  VALUE  'h'.
   988   02  DFHTRIG   PIC  X  VALUE  '"'.
   989 01  FILLER REDEFINES DFHAID.
   990     12  FILLER              PIC X(8).
   991     12  PF-VALUES           PIC X       OCCURS 2.
   992
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL106.cbl
   994*    COPY EL106S.
   995 01  EL106AI.
   996     05  FILLER            PIC  X(0012).
   997*    -------------------------------
   998     05  RUNDTEL PIC S9(0004) COMP.
   999     05  RUNDTEF PIC  X(0001).
  1000     05  FILLER REDEFINES RUNDTEF.
  1001         10  RUNDTEA PIC  X(0001).
  1002     05  RUNDTEI PIC  X(0008).
  1003*    -------------------------------
  1004     05  RUNTIMEL PIC S9(0004) COMP.
  1005     05  RUNTIMEF PIC  X(0001).
  1006     05  FILLER REDEFINES RUNTIMEF.
  1007         10  RUNTIMEA PIC  X(0001).
  1008     05  RUNTIMEI PIC  X(0005).
  1009*    -------------------------------
  1010     05  MAINTL PIC S9(0004) COMP.
  1011     05  MAINTF PIC  X(0001).
  1012     05  FILLER REDEFINES MAINTF.
  1013         10  MAINTA PIC  X(0001).
  1014     05  MAINTI PIC  X(0001).
  1015*    -------------------------------
  1016     05  STCDL PIC S9(0004) COMP.
  1017     05  STCDF PIC  X(0001).
  1018     05  FILLER REDEFINES STCDF.
  1019         10  STCDA PIC  X(0001).
  1020     05  STCDI PIC  X(0002).
  1021*    -------------------------------
  1022     05  STABRL PIC S9(0004) COMP.
  1023     05  STABRF PIC  X(0001).
  1024     05  FILLER REDEFINES STABRF.
  1025         10  STABRA PIC  X(0001).
  1026     05  STABRI PIC  X(0002).
  1027*    -------------------------------
  1028     05  STNAMEL PIC S9(0004) COMP.
  1029     05  STNAMEF PIC  X(0001).
  1030     05  FILLER REDEFINES STNAMEF.
  1031         10  STNAMEA PIC  X(0001).
  1032     05  STNAMEI PIC  X(0025).
  1033*    -------------------------------
  1034     05  LEXPLBLL PIC S9(0004) COMP.
  1035     05  LEXPLBLF PIC  X(0001).
  1036     05  FILLER REDEFINES LEXPLBLF.
  1037         10  LEXPLBLA PIC  X(0001).
  1038     05  LEXPLBLI PIC  X(0006).
  1039*    -------------------------------
  1040     05  LFEXPL PIC S9(0004) COMP.
  1041     05  LFEXPF PIC  X(0001).
  1042     05  FILLER REDEFINES LFEXPF.
  1043         10  LFEXPA PIC  X(0001).
  1044     05  LFEXPI PIC  S9(3)V9999.
  1045*    -------------------------------
  1046     05  AEXPLBLL PIC S9(0004) COMP.
  1047     05  AEXPLBLF PIC  X(0001).
  1048     05  FILLER REDEFINES AEXPLBLF.
  1049         10  AEXPLBLA PIC  X(0001).
  1050     05  AEXPLBLI PIC  X(0006).
  1051*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL106.cbl
  1052     05  AHEXPL PIC S9(0004) COMP.
  1053     05  AHEXPF PIC  X(0001).
  1054     05  FILLER REDEFINES AHEXPF.
  1055         10  AHEXPA PIC  X(0001).
  1056     05  AHEXPI PIC  S9(3)V9999.
  1057*    -------------------------------
  1058     05  REMTERML PIC S9(0004) COMP.
  1059     05  REMTERMF PIC  X(0001).
  1060     05  FILLER REDEFINES REMTERMF.
  1061         10  REMTERMA PIC  X(0001).
  1062     05  REMTERMI PIC  X(0001).
  1063*    -------------------------------
  1064     05  QUOTCALL PIC S9(0004) COMP.
  1065     05  QUOTCALF PIC  X(0001).
  1066     05  FILLER REDEFINES QUOTCALF.
  1067         10  QUOTCALA PIC  X(0001).
  1068     05  QUOTCALI PIC  S9(4)V99.
  1069*    -------------------------------
  1070     05  PREMTOLL PIC S9(0004) COMP.
  1071     05  PREMTOLF PIC  X(0001).
  1072     05  FILLER REDEFINES PREMTOLF.
  1073         10  PREMTOLA PIC  X(0001).
  1074     05  PREMTOLI PIC  S9(4)V99.
  1075*    -------------------------------
  1076     05  REFTOLL PIC S9(0004) COMP.
  1077     05  REFTOLF PIC  X(0001).
  1078     05  FILLER REDEFINES REFTOLF.
  1079         10  REFTOLA PIC  X(0001).
  1080     05  REFTOLI PIC  S9(4)V99.
  1081*    -------------------------------
  1082     05  PRMPCTL PIC S9(0004) COMP.
  1083     05  PRMPCTF PIC  X(0001).
  1084     05  FILLER REDEFINES PRMPCTF.
  1085         10  PRMPCTA PIC  X(0001).
  1086     05  PRMPCTI PIC  S9(1)V9(4).
  1087*    -------------------------------
  1088     05  REFPCTL PIC S9(0004) COMP.
  1089     05  REFPCTF PIC  X(0001).
  1090     05  FILLER REDEFINES REFPCTF.
  1091         10  REFPCTA PIC  X(0001).
  1092     05  REFPCTI PIC  S9(1)V9(4).
  1093*    -------------------------------
  1094     05  OVSAMTL PIC S9(0004) COMP.
  1095     05  OVSAMTF PIC  X(0001).
  1096     05  FILLER REDEFINES OVSAMTF.
  1097         10  OVSAMTA PIC  X(0001).
  1098     05  OVSAMTI PIC  S9(4)V99.
  1099*    -------------------------------
  1100     05  OVSPCTL PIC S9(0004) COMP.
  1101     05  OVSPCTF PIC  X(0001).
  1102     05  FILLER REDEFINES OVSPCTF.
  1103         10  OVSPCTA PIC  X(0001).
  1104     05  OVSPCTI PIC  S9(1)V9(4).
  1105*    -------------------------------
  1106     05  CLREJECL PIC S9(0004) COMP.
  1107     05  CLREJECF PIC  X(0001).
  1108     05  FILLER REDEFINES CLREJECF.
  1109         10  CLREJECA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL106.cbl
  1110     05  CLREJECI PIC  X(0001).
  1111*    -------------------------------
  1112     05  ISSREJL PIC S9(0004) COMP.
  1113     05  ISSREJF PIC  X(0001).
  1114     05  FILLER REDEFINES ISSREJF.
  1115         10  ISSREJA PIC  X(0001).
  1116     05  ISSREJI PIC  X(0001).
  1117*    -------------------------------
  1118     05  REFREJL PIC S9(0004) COMP.
  1119     05  REFREJF PIC  X(0001).
  1120     05  FILLER REDEFINES REFREJF.
  1121         10  REFREJA PIC  X(0001).
  1122     05  REFREJI PIC  X(0001).
  1123*    -------------------------------
  1124     05  REFMINL PIC S9(0004) COMP.
  1125     05  REFMINF PIC  X(0001).
  1126     05  FILLER REDEFINES REFMINF.
  1127         10  REFMINA PIC  X(0001).
  1128     05  REFMINI PIC  S9(4)V99.
  1129*    -------------------------------
  1130     05  REFDAY1L PIC S9(0004) COMP.
  1131     05  REFDAY1F PIC  X(0001).
  1132     05  FILLER REDEFINES REFDAY1F.
  1133         10  REFDAY1A PIC  X(0001).
  1134     05  REFDAY1I PIC  X(0002).
  1135*    -------------------------------
  1136     05  REFDAYSL PIC S9(0004) COMP.
  1137     05  REFDAYSF PIC  X(0001).
  1138     05  FILLER REDEFINES REFDAYSF.
  1139         10  REFDAYSA PIC  X(0001).
  1140     05  REFDAYSI PIC  X(0002).
  1141*    -------------------------------
  1142     05  SPLPMTL PIC S9(0004) COMP.
  1143     05  SPLPMTF PIC  X(0001).
  1144     05  FILLER REDEFINES SPLPMTF.
  1145         10  SPLPMTA PIC  X(0001).
  1146     05  SPLPMTI PIC  X(0001).
  1147*    -------------------------------
  1148     05  STUEL PIC S9(0004) COMP.
  1149     05  STUEF PIC  X(0001).
  1150     05  FILLER REDEFINES STUEF.
  1151         10  STUEA PIC  X(0001).
  1152     05  STUEI PIC  X(0001).
  1153*    -------------------------------
  1154     05  STCNTLL PIC S9(0004) COMP.
  1155     05  STCNTLF PIC  X(0001).
  1156     05  FILLER REDEFINES STCNTLF.
  1157         10  STCNTLA PIC  X(0001).
  1158     05  STCNTLI PIC  X(0001).
  1159*    -------------------------------
  1160     05  STDEVL PIC S9(0004) COMP.
  1161     05  STDEVF PIC  X(0001).
  1162     05  FILLER REDEFINES STDEVF.
  1163         10  STDEVA PIC  X(0001).
  1164     05  STDEVI PIC  X(0003).
  1165*    -------------------------------
  1166     05  EXTDAYSL PIC S9(0004) COMP.
  1167     05  EXTDAYSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL106.cbl
  1168     05  FILLER REDEFINES EXTDAYSF.
  1169         10  EXTDAYSA PIC  X(0001).
  1170     05  EXTDAYSI PIC  X(0003).
  1171*    -------------------------------
  1172     05  EXTCHGL PIC S9(0004) COMP.
  1173     05  EXTCHGF PIC  X(0001).
  1174     05  FILLER REDEFINES EXTCHGF.
  1175         10  EXTCHGA PIC  X(0001).
  1176     05  EXTCHGI PIC  X(0001).
  1177*    -------------------------------
  1178     05  LFTAXL PIC S9(0004) COMP.
  1179     05  LFTAXF PIC  X(0001).
  1180     05  FILLER REDEFINES LFTAXF.
  1181         10  LFTAXA PIC  X(0001).
  1182     05  LFTAXI PIC  S9(1)V9(4).
  1183*    -------------------------------
  1184     05  REPLAWL PIC S9(0004) COMP.
  1185     05  REPLAWF PIC  X(0001).
  1186     05  FILLER REDEFINES REPLAWF.
  1187         10  REPLAWA PIC  X(0001).
  1188     05  REPLAWI PIC  X(0001).
  1189*    -------------------------------
  1190     05  REPLETRL PIC S9(0004) COMP.
  1191     05  REPLETRF PIC  X(0001).
  1192     05  FILLER REDEFINES REPLETRF.
  1193         10  REPLETRA PIC  X(0001).
  1194     05  REPLETRI PIC  X(0004).
  1195*    -------------------------------
  1196     05  AHITAXL PIC S9(0004) COMP.
  1197     05  AHITAXF PIC  X(0001).
  1198     05  FILLER REDEFINES AHITAXF.
  1199         10  AHITAXA PIC  X(0001).
  1200     05  AHITAXI PIC  S9(1)V9(4).
  1201*    -------------------------------
  1202     05  TARRATL PIC S9(0004) COMP.
  1203     05  TARRATF PIC  X(0001).
  1204     05  FILLER REDEFINES TARRATF.
  1205         10  TARRATA PIC  X(0001).
  1206     05  TARRATI PIC  S9(2)V9(4).
  1207*    -------------------------------
  1208     05  CALCINTL PIC S9(0004) COMP.
  1209     05  CALCINTF PIC  X(0001).
  1210     05  FILLER REDEFINES CALCINTF.
  1211         10  CALCINTA PIC  X(0001).
  1212     05  CALCINTI PIC  S9(2)V9(4).
  1213*    -------------------------------
  1214     05  AHGTAXL PIC S9(0004) COMP.
  1215     05  AHGTAXF PIC  X(0001).
  1216     05  FILLER REDEFINES AHGTAXF.
  1217         10  AHGTAXA PIC  X(0001).
  1218     05  AHGTAXI PIC  S9(1)V9(4).
  1219*    -------------------------------
  1220     05  COMSLL PIC S9(0004) COMP.
  1221     05  COMSLF PIC  X(0001).
  1222     05  FILLER REDEFINES COMSLF.
  1223         10  COMSLA PIC  X(0001).
  1224     05  COMSLI PIC  S99V9(4).
  1225*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL106.cbl
  1226     05  LIMITL PIC S9(0004) COMP.
  1227     05  LIMITF PIC  X(0001).
  1228     05  FILLER REDEFINES LIMITF.
  1229         10  LIMITA PIC  X(0001).
  1230     05  LIMITI PIC  X(0001).
  1231*    -------------------------------
  1232     05  COMJLL PIC S9(0004) COMP.
  1233     05  COMJLF PIC  X(0001).
  1234     05  FILLER REDEFINES COMJLF.
  1235         10  COMJLA PIC  X(0001).
  1236     05  COMJLI PIC  S99V9(4).
  1237*    -------------------------------
  1238     05  LFREDL PIC S9(0004) COMP.
  1239     05  LFREDF PIC  X(0001).
  1240     05  FILLER REDEFINES LFREDF.
  1241         10  LFREDA PIC  X(0001).
  1242     05  LFREDI PIC  X(0001).
  1243*    -------------------------------
  1244     05  LFLEVL PIC S9(0004) COMP.
  1245     05  LFLEVF PIC  X(0001).
  1246     05  FILLER REDEFINES LFLEVF.
  1247         10  LFLEVA PIC  X(0001).
  1248     05  LFLEVI PIC  X(0001).
  1249*    -------------------------------
  1250     05  LFNETL PIC S9(0004) COMP.
  1251     05  LFNETF PIC  X(0001).
  1252     05  FILLER REDEFINES LFNETF.
  1253         10  LFNETA PIC  X(0001).
  1254     05  LFNETI PIC  X(0001).
  1255*    -------------------------------
  1256     05  COMSAL PIC S9(0004) COMP.
  1257     05  COMSAF PIC  X(0001).
  1258     05  FILLER REDEFINES COMSAF.
  1259         10  COMSAA PIC  X(0001).
  1260     05  COMSAI PIC  S99V9(4).
  1261*    -------------------------------
  1262     05  AHAHL PIC S9(0004) COMP.
  1263     05  AHAHF PIC  X(0001).
  1264     05  FILLER REDEFINES AHAHF.
  1265         10  AHAHA PIC  X(0001).
  1266     05  AHAHI PIC  X(0001).
  1267*    -------------------------------
  1268     05  AHCPL PIC S9(0004) COMP.
  1269     05  AHCPF PIC  X(0001).
  1270     05  FILLER REDEFINES AHCPF.
  1271         10  AHCPA PIC  X(0001).
  1272     05  AHCPI PIC  X(0001).
  1273*    -------------------------------
  1274     05  COMJAL PIC S9(0004) COMP.
  1275     05  COMJAF PIC  X(0001).
  1276     05  FILLER REDEFINES COMJAF.
  1277         10  COMJAA PIC  X(0001).
  1278     05  COMJAI PIC  S99V9(4).
  1279*    -------------------------------
  1280     05  STCHKHDL PIC S9(0004) COMP.
  1281     05  STCHKHDF PIC  X(0001).
  1282     05  FILLER REDEFINES STCHKHDF.
  1283         10  STCHKHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL106.cbl
  1284     05  STCHKHDI PIC  X(0013).
  1285*    -------------------------------
  1286     05  STCHKNOL PIC S9(0004) COMP.
  1287     05  STCHKNOF PIC  X(0001).
  1288     05  FILLER REDEFINES STCHKNOF.
  1289         10  STCHKNOA PIC  X(0001).
  1290     05  STCHKNOI PIC  9(8).
  1291*    -------------------------------
  1292     05  RESTAXL PIC S9(0004) COMP.
  1293     05  RESTAXF PIC  X(0001).
  1294     05  FILLER REDEFINES RESTAXF.
  1295         10  RESTAXA PIC  X(0001).
  1296     05  RESTAXI PIC  S99V9(4).
  1297*    -------------------------------
  1298     05  FREELKL PIC S9(0004) COMP.
  1299     05  FREELKF PIC  X(0001).
  1300     05  FILLER REDEFINES FREELKF.
  1301         10  FREELKA PIC  X(0001).
  1302     05  FREELKI PIC  X(0003).
  1303*    -------------------------------
  1304     05  LSTUSRL PIC S9(0004) COMP.
  1305     05  LSTUSRF PIC  X(0001).
  1306     05  FILLER REDEFINES LSTUSRF.
  1307         10  LSTUSRA PIC  X(0001).
  1308     05  LSTUSRI PIC  X(0004).
  1309*    -------------------------------
  1310     05  REFCLML PIC S9(0004) COMP.
  1311     05  REFCLMF PIC  X(0001).
  1312     05  FILLER REDEFINES REFCLMF.
  1313         10  REFCLMA PIC  X(0001).
  1314     05  REFCLMI PIC  X(0001).
  1315*    -------------------------------
  1316     05  LSTDTEL PIC S9(0004) COMP.
  1317     05  LSTDTEF PIC  X(0001).
  1318     05  FILLER REDEFINES LSTDTEF.
  1319         10  LSTDTEA PIC  X(0001).
  1320     05  LSTDTEI PIC  X(0008).
  1321*    -------------------------------
  1322     05  LSTTIMEL PIC S9(0004) COMP.
  1323     05  LSTTIMEF PIC  X(0001).
  1324     05  FILLER REDEFINES LSTTIMEF.
  1325         10  LSTTIMEA PIC  X(0001).
  1326     05  LSTTIMEI PIC  X(0005).
  1327*    -------------------------------
  1328     05  ERRMSG1L PIC S9(0004) COMP.
  1329     05  ERRMSG1F PIC  X(0001).
  1330     05  FILLER REDEFINES ERRMSG1F.
  1331         10  ERRMSG1A PIC  X(0001).
  1332     05  ERRMSG1I PIC  X(0076).
  1333*    -------------------------------
  1334     05  ERRMSG2L PIC S9(0004) COMP.
  1335     05  ERRMSG2F PIC  X(0001).
  1336     05  FILLER REDEFINES ERRMSG2F.
  1337         10  ERRMSG2A PIC  X(0001).
  1338     05  ERRMSG2I PIC  X(0076).
  1339*    -------------------------------
  1340     05  ENTERPFL PIC S9(0004) COMP.
  1341     05  ENTERPFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL106.cbl
  1342     05  FILLER REDEFINES ENTERPFF.
  1343         10  ENTERPFA PIC  X(0001).
  1344     05  ENTERPFI PIC  9(2).
  1345 01  EL106AO REDEFINES EL106AI.
  1346     05  FILLER            PIC  X(0012).
  1347*    -------------------------------
  1348     05  FILLER            PIC  X(0003).
  1349     05  RUNDTEO PIC  X(0008).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(0003).
  1352     05  RUNTIMEO PIC  99.99.
  1353*    -------------------------------
  1354     05  FILLER            PIC  X(0003).
  1355     05  MAINTO PIC  X(0001).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(0003).
  1358     05  STCDO PIC  X(0002).
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(0003).
  1361     05  STABRO PIC  X(0002).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  STNAMEO PIC  X(0025).
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  LEXPLBLO PIC  X(0006).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  LFEXPO PIC  99.9999.
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  AEXPLBLO PIC  X(0006).
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  AHEXPO PIC  99.9999.
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  REMTERMO PIC  X(0001).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  QUOTCALO PIC  ZZ9.99.
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  PREMTOLO PIC  ZZ9.99.
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(0003).
  1388     05  REFTOLO PIC  ZZ9.99.
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  PRMPCTO PIC  .9999.
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  REFPCTO PIC  .9999.
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  OVSAMTO PIC  ZZ9.99.
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL106.cbl
  1400     05  OVSPCTO PIC  .9999.
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
  1403     05  CLREJECO PIC  X(0001).
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  ISSREJO PIC  X(0001).
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  REFREJO PIC  X(0001).
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  REFMINO PIC  ZZ9.99.
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  REFDAY1O PIC  99.
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  REFDAYSO PIC  99.
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  SPLPMTO PIC  X(0001).
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  STUEO PIC  X(0001).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  STCNTLO PIC  X(0001).
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  STDEVO PIC  X(0003).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  EXTDAYSO PIC  999.
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  EXTCHGO PIC  X(0001).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  LFTAXO PIC  .9999.
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  REPLAWO PIC  X(0001).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  REPLETRO PIC  X(0004).
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  AHITAXO PIC  .9999.
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  TARRATO PIC  9.9999.
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  CALCINTO PIC  9.9999.
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  AHGTAXO PIC  .9999.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL106.cbl
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  COMSLO PIC  9.9999.
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  LIMITO PIC  X(0001).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  COMJLO PIC  9.9999.
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  LFREDO PIC  X(0001).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  LFLEVO PIC  X(0001).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  LFNETO PIC  X(0001).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  COMSAO PIC  9.9999.
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  AHAHO PIC  X(0001).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  AHCPO PIC  X(0001).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  COMJAO PIC  9.9999.
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  STCHKHDO PIC  X(0013).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  STCHKNOO PIC  9(8).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  RESTAXO PIC  9.9999.
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  FREELKO PIC  999.
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  LSTUSRO PIC  X(0004).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  REFCLMO PIC  X(0001).
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  LSTDTEO PIC  X(0008).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  LSTTIMEO PIC  99.99.
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  ERRMSG1O PIC  X(0076).
  1515*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL106.cbl
  1516     05  FILLER            PIC  X(0003).
  1517     05  ERRMSG2O PIC  X(0076).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  ENTERPFO PIC  X(0002).
  1521*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL106.cbl
  1523****************************************************************
  1524*
  1525* Copyright (c) 2007 by Clerity Solutions, Inc.
  1526* All rights reserved.
  1527*
  1528****************************************************************
  1529 01  DFHEIV.
  1530   02  DFHEIV0               PIC X(35).
  1531   02  DFHEIV1               PIC X(08).
  1532   02  DFHEIV2               PIC X(08).
  1533   02  DFHEIV3               PIC X(08).
  1534   02  DFHEIV4               PIC X(06).
  1535   02  DFHEIV5               PIC X(04).
  1536   02  DFHEIV6               PIC X(04).
  1537   02  DFHEIV7               PIC X(02).
  1538   02  DFHEIV8               PIC X(02).
  1539   02  DFHEIV9               PIC X(01).
  1540   02  DFHEIV10              PIC S9(7) COMP-3.
  1541   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1542   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1543   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1544   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1545   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1546   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1547   02  DFHEIV17              PIC X(04).
  1548   02  DFHEIV18              PIC X(04).
  1549   02  DFHEIV19              PIC X(04).
  1550   02  DFHEIV20              USAGE IS POINTER.
  1551   02  DFHEIV21              USAGE IS POINTER.
  1552   02  DFHEIV22              USAGE IS POINTER.
  1553   02  DFHEIV23              USAGE IS POINTER.
  1554   02  DFHEIV24              USAGE IS POINTER.
  1555   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1556   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1557   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1558   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1559   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1560   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1561   02  FILLER                PIC X(02).
  1562   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1563   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1564   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1565   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1566   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1567 LINKAGE  SECTION.
  1568*****************************************************************
  1569*                                                               *
  1570* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1571* All rights reserved.                                          *
  1572*                                                               *
  1573*****************************************************************
  1574 01  dfheiblk.
  1575     02  eibtime          pic s9(7) comp-3.
  1576     02  eibdate          pic s9(7) comp-3.
  1577     02  eibtrnid         pic x(4).
  1578     02  eibtaskn         pic s9(7) comp-3.
  1579     02  eibtrmid         pic x(4).
  1580     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL106.cbl
  1581     02  eibcposn         pic s9(4) comp.
  1582     02  eibcalen         pic s9(4) comp.
  1583     02  eibaid           pic x(1).
  1584     02  eibfiller1       pic x(1).
  1585     02  eibfn            pic x(2).
  1586     02  eibfiller2       pic x(2).
  1587     02  eibrcode         pic x(6).
  1588     02  eibfiller3       pic x(2).
  1589     02  eibds            pic x(8).
  1590     02  eibreqid         pic x(8).
  1591     02  eibrsrce         pic x(8).
  1592     02  eibsync          pic x(1).
  1593     02  eibfree          pic x(1).
  1594     02  eibrecv          pic x(1).
  1595     02  eibsend          pic x(1).
  1596     02  eibatt           pic x(1).
  1597     02  eibeoc           pic x(1).
  1598     02  eibfmh           pic x(1).
  1599     02  eibcompl         pic x(1).
  1600     02  eibsig           pic x(1).
  1601     02  eibconf          pic x(1).
  1602     02  eiberr           pic x(1).
  1603     02  eibrldbk         pic x(1).
  1604     02  eiberrcd         pic x(4).
  1605     02  eibsynrb         pic x(1).
  1606     02  eibnodat         pic x(1).
  1607     02  eibfiller5       pic x(2).
  1608     02  eibresp          pic 9(09) comp.
  1609     02  eibresp2         pic 9(09) comp.
  1610     02  dfheigdj         pic s9(4) comp.
  1611     02  dfheigdk         pic s9(4) comp.
  1612 01  DFHCOMMAREA             PIC X(1500).
  1613*01 PARMLIST .
  1614*    02  FILLER              PIC S9(8)   COMP.
  1615*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  1616*    02  ELLETR-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL106.cbl
  1618*    COPY ELCCNTL.
  1619******************************************************************
  1620*                                                                *
  1621*                                                                *
  1622*                            ELCCNTL.                            *
  1623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1624*                            VMOD=2.059                          *
  1625*                                                                *
  1626*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1627*                                                                *
  1628*   FILE TYPE = VSAM,KSDS                                        *
  1629*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1630*                                                                *
  1631*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1632*       ALTERNATE INDEX = NONE                                   *
  1633*                                                                *
  1634*   LOG = YES                                                    *
  1635*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1636******************************************************************
  1637*                   C H A N G E   L O G
  1638*
  1639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1640*-----------------------------------------------------------------
  1641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1642* EFFECTIVE    NUMBER
  1643*-----------------------------------------------------------------
  1644* 082503                   PEMA  ADD BENEFIT GROUP
  1645* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1646* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1647* 092705    2005050300006  PEMA  ADD SPP LEASES
  1648* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1649* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1650* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1651* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1652******************************************************************
  1653*
  1654 01  CONTROL-FILE.
  1655     12  CF-RECORD-ID                       PIC XX.
  1656         88  VALID-CF-ID                        VALUE 'CF'.
  1657
  1658     12  CF-CONTROL-PRIMARY.
  1659         16  CF-COMPANY-ID                  PIC XXX.
  1660         16  CF-RECORD-TYPE                 PIC X.
  1661             88  CF-COMPANY-MASTER              VALUE '1'.
  1662             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1663             88  CF-STATE-MASTER                VALUE '3'.
  1664             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1665             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1666             88  CF-CARRIER-MASTER              VALUE '6'.
  1667             88  CF-MORTALITY-MASTER            VALUE '7'.
  1668             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1669             88  CF-TERMINAL-MASTER             VALUE '9'.
  1670             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1671             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1672             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1673             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1674             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1675             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL106.cbl
  1676             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1677             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1678             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1679         16  CF-ACCESS-CD-GENL              PIC X(4).
  1680         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1681             20  CF-PROCESSOR               PIC X(4).
  1682         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1683             20  CF-STATE-CODE              PIC XX.
  1684             20  FILLER                     PIC XX.
  1685         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1686             20  FILLER                     PIC XX.
  1687             20  CF-HI-BEN-IN-REC           PIC XX.
  1688         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1689             20  FILLER                     PIC XXX.
  1690             20  CF-CARRIER-CNTL            PIC X.
  1691         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1692             20  FILLER                     PIC XX.
  1693             20  CF-HI-TYPE-IN-REC          PIC 99.
  1694         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1695             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1696                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1697             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1698             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1699         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1700             20  FILLER                     PIC X.
  1701             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1702         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1703             20  FILLER                     PIC XX.
  1704             20  CF-MORTGAGE-PLAN           PIC XX.
  1705         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1706
  1707     12  CF-LAST-MAINT-DT                   PIC XX.
  1708     12  CF-LAST-MAINT-BY                   PIC X(4).
  1709     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1710
  1711     12  CF-RECORD-BODY                     PIC X(728).
  1712
  1713
  1714****************************************************************
  1715*             COMPANY MASTER RECORD                            *
  1716****************************************************************
  1717
  1718     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1719         16  CF-COMPANY-ADDRESS.
  1720             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1721             20  CF-CL-IN-CARE-OF           PIC X(30).
  1722             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1723             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1724             20  CF-CL-CITY-STATE           PIC X(30).
  1725             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1726             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1727         16  CF-COMPANY-CD                  PIC X.
  1728         16  CF-COMPANY-PASSWORD            PIC X(8).
  1729         16  CF-SECURITY-OPTION             PIC X.
  1730             88  ALL-SECURITY                   VALUE '1'.
  1731             88  COMPANY-VERIFY                 VALUE '2'.
  1732             88  PROCESSOR-VERIFY               VALUE '3'.
  1733             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL106.cbl
  1734             88  ALL-BUT-TERM                   VALUE '5'.
  1735         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1736             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1737         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1738             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1739         16  CF-INFORCE-LOCATION            PIC X.
  1740             88  CERTS-ARE-ONLINE               VALUE '1'.
  1741             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1742             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1743         16  CF-LOWER-CASE-LETTERS          PIC X.
  1744         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1745             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1746             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1747             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1748             88  CF-ACCNT-CNTL                  VALUE '3'.
  1749             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1750
  1751         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1752         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1753
  1754         16  CF-LGX-CREDIT-USER             PIC X.
  1755             88  CO-IS-NOT-USER                 VALUE 'N'.
  1756             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1757
  1758         16 CF-CREDIT-CALC-CODES.
  1759             20  CF-CR-REM-TERM-CALC PIC X.
  1760               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1761               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1762               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1763               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1764               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1765               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1766               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1767             20  CF-CR-R78-METHOD           PIC X.
  1768               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1769               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1770
  1771         16  CF-CLAIM-CONTROL-COUNTS.
  1772             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1773                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1774
  1775             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1776                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1777
  1778             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1779                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1780
  1781             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1782                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1783
  1784         16  CF-CURRENT-MONTH-END           PIC XX.
  1785
  1786         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1787             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1788             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1789             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1790             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1791                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL106.cbl
  1792                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1793             20  CF-CO-PREM-REJECT-SW       PIC X.
  1794                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1795                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1796             20  CF-CO-REF-REJECT-SW        PIC X.
  1797                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1798                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1799
  1800         16  CF-CO-REPORTING-DT             PIC XX.
  1801         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1802         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1803           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1804           88  CF-CO-MONTH-END                  VALUE '1'.
  1805
  1806         16  CF-LGX-CLAIM-USER              PIC X.
  1807             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1808             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1809
  1810         16  CF-CREDIT-EDIT-CONTROLS.
  1811             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1812             20  CF-MIN-AGE                 PIC 99.
  1813             20  CF-DEFAULT-AGE             PIC 99.
  1814             20  CF-MIN-TERM                PIC S999      COMP-3.
  1815             20  CF-MAX-TERM                PIC S999      COMP-3.
  1816             20  CF-DEFAULT-SEX             PIC X.
  1817             20  CF-JOINT-AGE-INPUT         PIC X.
  1818                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1819             20  CF-BIRTH-DATE-INPUT        PIC X.
  1820                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1821             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1822                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1823                 88  CF-ZERO-CARRIER            VALUE '1'.
  1824                 88  CF-ZERO-GROUPING           VALUE '2'.
  1825                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1826             20  CF-EDIT-SW                 PIC X.
  1827                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1828             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1829             20  CF-CR-PR-METHOD            PIC X.
  1830               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1831               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1832             20  FILLER                     PIC X.
  1833
  1834         16  CF-CREDIT-MISC-CONTROLS.
  1835             20  CF-REIN-TABLE-SW           PIC X.
  1836                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1837             20  CF-COMP-TABLE-SW           PIC X.
  1838                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1839             20  CF-EXPERIENCE-RETENTION-AGE
  1840                                            PIC S9        COMP-3.
  1841             20  CF-CONVERSION-DT           PIC XX.
  1842             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1843             20  CF-RUN-FREQUENCY-SW        PIC X.
  1844                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1845                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1846
  1847             20  CF-CR-CHECK-NO-CONTROL.
  1848                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1849                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL106.cbl
  1850                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1851                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1852                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1853                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1854
  1855                 24  CF-CR-CHECK-COUNT       REDEFINES
  1856                     CF-CR-CHECK-COUNTER      PIC X(4).
  1857
  1858                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1859                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1860
  1861                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1862                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1863                 24  CF-MAIL-PROCESSING       PIC X.
  1864                     88  MAIL-PROCESSING          VALUE 'Y'.
  1865
  1866         16  CF-MISC-SYSTEM-CONTROL.
  1867             20  CF-SYSTEM-C                 PIC X.
  1868                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1869             20  CF-SYSTEM-D                 PIC X.
  1870                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1871             20  CF-SOC-SEC-NO-SW            PIC X.
  1872                 88  SOC-SEC-NO-USED             VALUE '1'.
  1873             20  CF-MEMBER-NO-SW             PIC X.
  1874                 88  MEMBER-NO-USED              VALUE '1'.
  1875             20  CF-TAX-ID-NUMBER            PIC X(11).
  1876             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1877             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1878                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1879                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1880                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1881                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1882             20  CF-SYSTEM-E                 PIC X.
  1883                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1884
  1885         16  CF-LGX-LIFE-USER               PIC X.
  1886             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1887             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1888
  1889         16  CF-CR-MONTH-END-DT             PIC XX.
  1890
  1891         16  CF-FILE-MAINT-DATES.
  1892             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1893                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1894             20  CF-LAST-BATCH       REDEFINES
  1895                 CF-LAST-BATCH-NO               PIC X(4).
  1896             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1897             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1898             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1899             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1900             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1901             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1902             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1903             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1904             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1905             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1906
  1907         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL106.cbl
  1908         16  FILLER                         PIC X.
  1909
  1910         16  CF-ALT-MORT-CODE               PIC X(4).
  1911         16  CF-MEMBER-CAPTION              PIC X(10).
  1912
  1913         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1914             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1915             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1916             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1917             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1918             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1919
  1920         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1921
  1922         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1923         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1924         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1925         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1926
  1927         16  CF-AH-OVERRIDE-L1              PIC X.
  1928         16  CF-AH-OVERRIDE-L2              PIC XX.
  1929         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1930         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1931
  1932         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1933         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1934
  1935         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1936         16  CF-AR-LAST-EL860-DT            PIC XX.
  1937         16  CF-MP-MONTH-END-DT             PIC XX.
  1938
  1939         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1940         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1941             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1942
  1943         16  CF-AR-MONTH-END-DT             PIC XX.
  1944
  1945         16  CF-CRDTCRD-USER                PIC X.
  1946             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1947             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1948
  1949         16  CF-CC-MONTH-END-DT             PIC XX.
  1950
  1951         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1952
  1953         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1954             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1955             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1956             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1957         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1958         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1959         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1960         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1961             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1962             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1963         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1964         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1965         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL106.cbl
  1966             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1967         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1968
  1969         16  CF-CL-ZIP-CODE.
  1970             20  CF-CL-ZIP-PRIME.
  1971                 24  CF-CL-ZIP-1ST          PIC X.
  1972                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1973                 24  FILLER                 PIC X(4).
  1974             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1975         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1976             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1977             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1978             20  FILLER                     PIC XXX.
  1979
  1980         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1981         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1982         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1983         16  CF-CO-OPTION-START-DATE        PIC XX.
  1984         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1985           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1986                                                      '3' '4'.
  1987           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1988           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1989           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1990           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1991           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1992           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1993
  1994         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1995
  1996         16  CF-PAYMENT-APPROVAL-LEVELS.
  1997             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1998             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1999             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2000             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2001             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2002             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2003
  2004         16  CF-END-USER-REPORTING-USER     PIC X.
  2005             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2006             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2007
  2008         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2009             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2010             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2011
  2012         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2013
  2014         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2015         16  FILLER                         PIC X.
  2016
  2017         16  CF-CREDIT-ARCHIVE-CNTL.
  2018             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2019             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2020             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2021
  2022         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2023
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL106.cbl
  2024         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2025             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2026             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2027
  2028         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2029             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2030             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2031
  2032         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2033
  2034         16  CF-CO-ACH-ID-CODE              PIC  X.
  2035             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2036             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2037             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2038         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2039         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2040         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2041         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2042         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2043         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2044         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2045         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2046         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2047                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2048         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2049                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2050
  2051         16  CF-CO-OVER-SHORT.
  2052             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2053             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2054
  2055*         16  FILLER                         PIC X(102).
  2056         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2057             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2058             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2059
  2060         16  CF-AH-APPROVAL-DAYS.
  2061             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2062             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2063             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2064             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2065
  2066         16  FILLER                         PIC X(82).
  2067****************************************************************
  2068*             PROCESSOR/USER RECORD                            *
  2069****************************************************************
  2070
  2071     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2072         16  CF-PROCESSOR-NAME              PIC X(30).
  2073         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2074         16  CF-PROCESSOR-TITLE             PIC X(26).
  2075         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2076                 88  MESSAGE-YES                VALUE 'Y'.
  2077                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2078
  2079*****************************************************
  2080****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2081****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL106.cbl
  2082****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2083****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2084*****************************************************
  2085
  2086         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2087             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2088             20  CF-APPLICATION-FORCE       PIC X.
  2089             20  CF-INDIVIDUAL-APP.
  2090                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2091                     28  CF-BROWSE-APP      PIC X.
  2092                     28  CF-UPDATE-APP      PIC X.
  2093
  2094         16  CF-CURRENT-TERM-ON             PIC X(4).
  2095         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2096             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2097             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2098             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2099             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2100             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2101             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2102             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2103         16  CF-PROCESSOR-CARRIER           PIC X.
  2104             88  NO-CARRIER-SECURITY            VALUE ' '.
  2105         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2106             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2107         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2108             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2109         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2110             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2111
  2112         16  CF-PROC-SYS-ACCESS-SW.
  2113             20  CF-PROC-CREDIT-CLAIMS-SW.
  2114                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2115                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2116                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2117                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2118             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2119                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2120                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2121             20  CF-PROC-LIFE-GNRLDGR-SW.
  2122                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2123                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2124                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2125                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2126             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2127                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2128                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2129         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2130             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2131             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2132         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2133
  2134         16  CF-APPROVAL-LEVEL                  PIC X.
  2135             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2136             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2137             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2138             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2139
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL106.cbl
  2140         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2141
  2142         16  CF-LANGUAGE-TYPE                   PIC X.
  2143             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2144             88  CF-LANG-IS-FR                      VALUE 'F'.
  2145         16  FILLER                             PIC  X(240).
  2146
  2147****************************************************************
  2148*             PROCESSOR/REMINDERS RECORD                       *
  2149****************************************************************
  2150
  2151     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2152         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2153             20  CF-START-REMIND-DT         PIC XX.
  2154             20  CF-END-REMIND-DT           PIC XX.
  2155             20  CF-REMINDER-TEXT           PIC X(50).
  2156         16  FILLER                         PIC X(296).
  2157
  2158
  2159****************************************************************
  2160*             STATE MASTER RECORD                              *
  2161****************************************************************
  2162
  2163     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2164         16  CF-STATE-ABBREVIATION          PIC XX.
  2165         16  CF-STATE-NAME                  PIC X(25).
  2166         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2167         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2168             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2169             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2170             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2171             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2172                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2173                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2174             20  CF-ST-PREM-REJECT-SW       PIC X.
  2175                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2176                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2177             20  CF-ST-REF-REJECT-SW        PIC X.
  2178                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2179                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2180         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2181         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2182         16  CF-ST-REFUND-RULES.
  2183             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2184             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2185             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2186         16  CF-ST-FST-PMT-EXTENSION.
  2187             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2188             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2189                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2190                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2191                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2192                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2193         16  CF-ST-STATE-CALL.
  2194             20  CF-ST-CALL-UNEARNED        PIC X.
  2195             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2196             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2197         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL106.cbl
  2198             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2199             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2200         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2201         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2202         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2203         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2204         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2205         16  FILLER                         PIC X.
  2206         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2207             20  CF-ST-BENEFIT-CD           PIC XX.
  2208             20  CF-ST-BENEFIT-KIND         PIC X.
  2209                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2210                 88  CF-ST-AH-KIND              VALUE 'A'.
  2211             20  CF-ST-REM-TERM-CALC        PIC X.
  2212                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2213                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2214                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2215                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2216                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2217                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2218                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2219                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2220
  2221             20  CF-ST-REFUND-CALC          PIC X.
  2222                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2223                 88  ST-REFD-BY-R78             VALUE '1'.
  2224                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2225                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2226                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2227                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2228                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2229                 88  ST-REFD-UTAH               VALUE '7'.
  2230                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2231                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2232                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2233
  2234             20  CF-ST-EARNING-CALC         PIC X.
  2235                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2236                 88  ST-EARN-BY-R78             VALUE '1'.
  2237                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2238                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2239                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2240                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2241                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2242                 88  ST-EARN-MEAN               VALUE '8'.
  2243                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2244
  2245             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2246                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2247                 88  ST-OVRD-BY-R78             VALUE '1'.
  2248                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2249                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2250                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2251                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2252                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2253                 88  ST-OVRD-MEAN               VALUE '8'.
  2254                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2255             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL106.cbl
  2256
  2257         16  CF-ST-COMMISSION-CAPS.
  2258             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2259             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2260             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2261             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2262         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2263                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2264
  2265         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2266
  2267         16  CF-ST-STATUTORY-INTEREST.
  2268             20  CF-ST-STAT-DATE-FROM       PIC X.
  2269                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2270                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2271             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2272             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2273             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2274             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2275             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2276
  2277         16  CF-ST-OVER-SHORT.
  2278             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2279             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2280
  2281         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2282
  2283         16  CF-ST-RT-CALC                  PIC X.
  2284
  2285         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2286         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2287         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2288         16  CF-ST-RF-LR-CALC               PIC X.
  2289         16  CF-ST-RF-LL-CALC               PIC X.
  2290         16  CF-ST-RF-LN-CALC               PIC X.
  2291         16  CF-ST-RF-AH-CALC               PIC X.
  2292         16  CF-ST-RF-CP-CALC               PIC X.
  2293*        16  FILLER                         PIC X(206).
  2294*CIDMOD         16  FILLER                         PIC X(192).
  2295         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2296             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2297         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2298         16  FILLER                         PIC X(187).
  2299
  2300****************************************************************
  2301*             BENEFIT MASTER RECORD                            *
  2302****************************************************************
  2303
  2304     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2305         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2306             20  CF-BENEFIT-CODE            PIC XX.
  2307             20  CF-BENEFIT-NUMERIC  REDEFINES
  2308                 CF-BENEFIT-CODE            PIC XX.
  2309             20  CF-BENEFIT-ALPHA           PIC XXX.
  2310             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2311             20  CF-BENEFIT-COMMENT         PIC X(10).
  2312
  2313             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL106.cbl
  2314                 88  CF-REDUCING                VALUE 'R'.
  2315                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2316
  2317             20  CF-SPECIAL-CALC-CD         PIC X.
  2318                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2319                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2320                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2321                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2322                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2323                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2324                 88  CF-FARM-PLAN               VALUE 'F'.
  2325                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2326                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2327                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2328                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2329                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2330                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2331                 88  CF-PRUDENTIAL              VALUE 'P'.
  2332                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2333                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2334                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2335                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2336                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2337                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2338
  2339             20  CF-JOINT-INDICATOR         PIC X.
  2340                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2341
  2342*            20  FILLER                     PIC X(12).
  2343             20  FILLER                     PIC X(11).
  2344             20  CF-BENEFIT-CATEGORY        PIC X.
  2345             20  CF-LOAN-TYPE               PIC X(8).
  2346
  2347             20  CF-CO-REM-TERM-CALC        PIC X.
  2348                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2349                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2350                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2351                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2352                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2353
  2354             20  CF-CO-EARNINGS-CALC        PIC X.
  2355                 88  CO-EARN-BY-R78             VALUE '1'.
  2356                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2357                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2358                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2359                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2360                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2361                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2362                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2363
  2364             20  CF-CO-REFUND-CALC          PIC X.
  2365                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2366                 88  CO-REFD-BY-R78             VALUE '1'.
  2367                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2368                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2369                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2370                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2371                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL106.cbl
  2372                 88  CO-REFD-MEAN               VALUE '8'.
  2373                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2374                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2375                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2376
  2377             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2378                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2379                 88  CO-OVRD-BY-R78             VALUE '1'.
  2380                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2381                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2382                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2383                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2384                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2385                 88  CO-OVRD-MEAN               VALUE '8'.
  2386                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2387
  2388             20  CF-CO-BEN-I-G-CD           PIC X.
  2389                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2390                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2391                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2392
  2393         16  FILLER                         PIC X(304).
  2394
  2395
  2396****************************************************************
  2397*             CARRIER MASTER RECORD                            *
  2398****************************************************************
  2399
  2400     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2401         16  CF-ADDRESS-DATA.
  2402             20  CF-MAIL-TO-NAME            PIC X(30).
  2403             20  CF-IN-CARE-OF              PIC X(30).
  2404             20  CF-ADDRESS-LINE-1          PIC X(30).
  2405             20  CF-ADDRESS-LINE-2          PIC X(30).
  2406             20  CF-CITY-STATE              PIC X(30).
  2407             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2408             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2409
  2410         16  CF-CLAIM-NO-CONTROL.
  2411             20  CF-CLAIM-NO-METHOD         PIC X.
  2412                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2413                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2414                 88  CLAIM-NO-SEQ               VALUE '3'.
  2415                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2416             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2417                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2418                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2419                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2420
  2421         16  CF-CHECK-NO-CONTROL.
  2422             20  CF-CHECK-NO-METHOD         PIC X.
  2423                 88  CHECK-NO-MANUAL            VALUE '1'.
  2424                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2425                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2426                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2427             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2428                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2429
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL106.cbl
  2430         16  CF-DOMICILE-STATE              PIC XX.
  2431
  2432         16  CF-EXPENSE-CONTROLS.
  2433             20  CF-EXPENSE-METHOD          PIC X.
  2434                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2435                 88  DOLLARS-PER-PMT            VALUE '2'.
  2436                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2437                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2438             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2439             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2440
  2441         16  CF-CORRESPONDENCE-CONTROL.
  2442             20  CF-LETTER-RESEND-OPT       PIC X.
  2443                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2444                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2445             20  FILLER                     PIC X(4).
  2446
  2447         16  CF-RESERVE-CONTROLS.
  2448             20  CF-MANUAL-SW               PIC X.
  2449                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2450             20  CF-FUTURE-SW               PIC X.
  2451                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2452             20  CF-PTC-SW                  PIC X.
  2453                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2454             20  CF-IBNR-SW                 PIC X.
  2455                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2456             20  CF-PTC-LF-SW               PIC X.
  2457                 88  CF-LF-PTC-USED             VALUE '1'.
  2458             20  CF-CDT-ACCESS-METHOD       PIC X.
  2459                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2460                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2461                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2462             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2463
  2464         16  CF-CLAIM-CALC-METHOD           PIC X.
  2465             88  360-PLUS-MONTHS                VALUE '1'.
  2466             88  365-PLUS-MONTHS                VALUE '2'.
  2467             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2468             88  360-DAILY                      VALUE '4'.
  2469             88  365-DAILY                      VALUE '5'.
  2470
  2471         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2472         16  FILLER                         PIC X(11).
  2473
  2474         16  CF-LIMIT-AMOUNTS.
  2475             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2476             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2477             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2478             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2479             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2480             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2481             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2482             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2483             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2484             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2485
  2486         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2487         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL106.cbl
  2488         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2489
  2490         16  CF-ZIP-CODE.
  2491             20  CF-ZIP-PRIME.
  2492                 24  CF-ZIP-1ST             PIC X.
  2493                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2494                 24  FILLER                 PIC X(4).
  2495             20  CF-ZIP-PLUS4               PIC X(4).
  2496         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2497             20  CF-CAN-POSTAL-1            PIC XXX.
  2498             20  CF-CAN-POSTAL-2            PIC XXX.
  2499             20  FILLER                     PIC XXX.
  2500
  2501         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2502         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2503         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2504
  2505         16  CF-RATING-SWITCH               PIC X.
  2506             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2507             88  CF-NO-RATING                   VALUE 'N'.
  2508
  2509         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2510
  2511         16  CF-CARRIER-OVER-SHORT.
  2512             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2513             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2514
  2515         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2516         16  CF-SECPAY-SWITCH               PIC X.
  2517             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2518             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2519         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2520         16  FILLER                         PIC X(448).
  2521*        16  FILLER                         PIC X(452).
  2522
  2523
  2524****************************************************************
  2525*             MORTALITY MASTER RECORD                          *
  2526****************************************************************
  2527
  2528     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2529         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2530                                INDEXED BY CF-MORT-NDX.
  2531             20  CF-MORT-TABLE              PIC X(5).
  2532             20  CF-MORT-TABLE-TYPE         PIC X.
  2533                 88  CF-MORT-JOINT              VALUE 'J'.
  2534                 88  CF-MORT-SINGLE             VALUE 'S'.
  2535                 88  CF-MORT-COMBINED           VALUE 'C'.
  2536                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2537                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2538             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2539             20  CF-MORT-AGE-METHOD         PIC XX.
  2540                 88  CF-AGE-LAST                VALUE 'AL'.
  2541                 88  CF-AGE-NEAR                VALUE 'AN'.
  2542             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2543             20  CF-MORT-ADJUSTMENT-DIRECTION
  2544                                            PIC X.
  2545                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL106.cbl
  2546                 88  CF-PLUS                    VALUE '+'.
  2547             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2548             20  CF-MORT-JOINT-CODE         PIC X.
  2549                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2550             20  CF-MORT-PC-Q               PIC X.
  2551                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2552             20  CF-MORT-TABLE-CODE         PIC X(4).
  2553             20  CF-MORT-COMMENTS           PIC X(15).
  2554             20  FILLER                     PIC X(14).
  2555
  2556         16  FILLER                         PIC X(251).
  2557
  2558
  2559****************************************************************
  2560*             BUSSINESS TYPE MASTER RECORD                     *
  2561****************************************************************
  2562
  2563     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2564* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2565* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2566* AND RECORD 05 IS TYPES 81-99
  2567         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2568             20  CF-BUSINESS-TITLE          PIC  X(19).
  2569             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2570                                            PIC S9V9(4) COMP-3.
  2571             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2572             20  FILLER                     PIC  X.
  2573         16  FILLER                         PIC  X(248).
  2574
  2575
  2576****************************************************************
  2577*             TERMINAL MASTER RECORD                           *
  2578****************************************************************
  2579
  2580     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2581
  2582         16  CF-COMPANY-TERMINALS.
  2583             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2584                                  PIC X(4).
  2585         16  FILLER               PIC X(248).
  2586
  2587
  2588****************************************************************
  2589*             LIFE EDIT MASTER RECORD                          *
  2590****************************************************************
  2591
  2592     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2593         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2594             20  CF-LIFE-CODE-IN            PIC XX.
  2595             20  CF-LIFE-CODE-OUT           PIC XX.
  2596         16  FILLER                         PIC X(248).
  2597
  2598
  2599****************************************************************
  2600*             AH EDIT MASTER RECORD                            *
  2601****************************************************************
  2602
  2603     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL106.cbl
  2604         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2605             20  CF-AH-CODE-IN              PIC XXX.
  2606             20  CF-AH-CODE-OUT             PIC XX.
  2607         16  FILLER                         PIC X(248).
  2608
  2609
  2610****************************************************************
  2611*             CREDIBILITY TABLES                               *
  2612****************************************************************
  2613
  2614     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2615         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2616                             INDEXED BY CF-CRDB-NDX.
  2617             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2618             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2619             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2620         16  FILLER                         PIC  X(332).
  2621
  2622
  2623****************************************************************
  2624*             REPORT CUSTOMIZATION RECORD                      *
  2625****************************************************************
  2626
  2627     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2628         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2629             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2630             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2631             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2632**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2633****       A T-TRANSFER.                                   ****
  2634             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2635
  2636         16  FILLER                         PIC XX.
  2637
  2638         16  CF-CARRIER-CNTL-OPT.
  2639             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2640                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2641                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2642             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2643                                            PIC X.
  2644         16  CF-GROUP-CNTL-OPT.
  2645             20  CF-GROUP-OPT-SEQ           PIC 9.
  2646                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2647                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2648             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2649                                            PIC X(6).
  2650         16  CF-STATE-CNTL-OPT.
  2651             20  CF-STATE-OPT-SEQ           PIC 9.
  2652                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2653                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2654             20  CF-STATE-SELECT OCCURS 3 TIMES
  2655                                            PIC XX.
  2656         16  CF-ACCOUNT-CNTL-OPT.
  2657             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2658                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2659                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2660             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2661                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL106.cbl
  2662         16  CF-BUS-TYP-CNTL-OPT.
  2663             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2664                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2665                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2666             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2667                                            PIC XX.
  2668         16  CF-LF-TYP-CNTL-OPT.
  2669             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2670                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2671                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2672             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2673                                            PIC XX.
  2674         16  CF-AH-TYP-CNTL-OPT.
  2675             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2676                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2677                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2678             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2679                                            PIC XX.
  2680         16  CF-REPTCD1-CNTL-OPT.
  2681             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2682                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2683                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2684             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2685                                            PIC X(10).
  2686         16  CF-REPTCD2-CNTL-OPT.
  2687             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2688                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2689                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2690             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2691                                            PIC X(10).
  2692         16  CF-USER1-CNTL-OPT.
  2693             20  CF-USER1-OPT-SEQ           PIC 9.
  2694                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2695                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2696             20  CF-USER1-SELECT OCCURS 3 TIMES
  2697                                            PIC X(10).
  2698         16  CF-USER2-CNTL-OPT.
  2699             20  CF-USER2-OPT-SEQ           PIC 9.
  2700                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2701                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2702             20  CF-USER2-SELECT OCCURS 3 TIMES
  2703                                            PIC X(10).
  2704         16  CF-USER3-CNTL-OPT.
  2705             20  CF-USER3-OPT-SEQ           PIC 9.
  2706                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2707                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2708             20  CF-USER3-SELECT OCCURS 3 TIMES
  2709                                            PIC X(10).
  2710         16  CF-USER4-CNTL-OPT.
  2711             20  CF-USER4-OPT-SEQ           PIC 9.
  2712                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2713                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2714             20  CF-USER4-SELECT OCCURS 3 TIMES
  2715                                            PIC X(10).
  2716         16  CF-USER5-CNTL-OPT.
  2717             20  CF-USER5-OPT-SEQ           PIC 9.
  2718                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2719                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL106.cbl
  2720             20  CF-USER5-SELECT OCCURS 3 TIMES
  2721                                            PIC X(10).
  2722         16  CF-REINS-CNTL-OPT.
  2723             20  CF-REINS-OPT-SEQ           PIC 9.
  2724                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2725                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2726             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2727                 24  CF-REINS-PRIME         PIC XXX.
  2728                 24  CF-REINS-SUB           PIC XXX.
  2729
  2730         16  CF-AGENT-CNTL-OPT.
  2731             20  CF-AGENT-OPT-SEQ           PIC 9.
  2732                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2733                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2734             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2735                                            PIC X(10).
  2736
  2737         16  FILLER                         PIC X(43).
  2738
  2739         16  CF-LOSS-RATIO-SELECT.
  2740             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2741             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2742         16  CF-ENTRY-DATE-SELECT.
  2743             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2744             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2745         16  CF-EFFECTIVE-DATE-SELECT.
  2746             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2747             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2748
  2749         16  CF-EXCEPTION-LIST-IND          PIC X.
  2750             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2751
  2752         16  FILLER                         PIC X(318).
  2753
  2754****************************************************************
  2755*                  EXCEPTION REPORTING RECORD                  *
  2756****************************************************************
  2757
  2758     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2759         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2760             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2761
  2762         16  CF-COMBINED-LIFE-AH-OPT.
  2763             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2764             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2765             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2766             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2767
  2768         16  CF-LIFE-OPT.
  2769             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2770             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2771             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2772             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2773             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2774             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2775             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2776             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2777             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL106.cbl
  2778             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2779
  2780         16  CF-AH-OPT.
  2781             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2782             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2783             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2784             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2785             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2786             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2787             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2788             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2789             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2790             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2791
  2792         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2793             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2794             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2795             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2796
  2797         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2798
  2799         16  FILLER                         PIC X(673).
  2800
  2801
  2802****************************************************************
  2803*             MORTGAGE SYSTEM PLAN RECORD                      *
  2804****************************************************************
  2805
  2806     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2807         16  CF-PLAN-TYPE                   PIC X.
  2808             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2809             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2810             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2811         16  CF-PLAN-ABBREV                 PIC XXX.
  2812         16  CF-PLAN-DESCRIPT               PIC X(10).
  2813         16  CF-PLAN-NOTES                  PIC X(20).
  2814         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2815         16  CF-PLAN-UNDERWRITING.
  2816             20  CF-PLAN-TERM-DATA.
  2817                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2818                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2819             20  CF-PLAN-AGE-DATA.
  2820                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2821                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2822                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2823             20  CF-PLAN-BENEFIT-DATA.
  2824                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2825                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2826                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2827                                            PIC S9(7)V99  COMP-3.
  2828         16  CF-PLAN-POLICY-FORMS.
  2829             20  CF-POLICY-FORM             PIC X(12).
  2830             20  CF-MASTER-APPLICATION      PIC X(12).
  2831             20  CF-MASTER-POLICY           PIC X(12).
  2832         16  CF-PLAN-RATING.
  2833             20  CF-RATE-CODE               PIC X(5).
  2834             20  CF-SEX-RATING              PIC X.
  2835                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL106.cbl
  2836                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2837             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2838             20  CF-SUB-STD-TYPE            PIC X.
  2839                 88  CF-PCT-OF-PREM            VALUE '1'.
  2840                 88  CF-PCT-OF-BENE            VALUE '2'.
  2841         16  CF-PLAN-PREM-TOLERANCES.
  2842             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2843             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2844         16  CF-PLAN-PYMT-TOLERANCES.
  2845             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2846             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2847         16  CF-PLAN-MISC-DATA.
  2848             20  FILLER                     PIC X.
  2849             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2850             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2851         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2852         16  CF-PLAN-IND-GRP                PIC X.
  2853             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2854                                                     '1'.
  2855             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2856                                                     '2'.
  2857         16  CF-MIB-SEARCH-SW               PIC X.
  2858             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2859             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2860             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2861             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2862         16  CF-ALPHA-SEARCH-SW             PIC X.
  2863             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2864             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2865             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2866             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2867             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2868             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2869             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2870             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2871             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2872             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2873                                                     'A' 'B' 'C'
  2874                                                     'X' 'Y' 'Z'.
  2875         16  CF-EFF-DT-RULE-SW              PIC X.
  2876             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2877             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2878             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2879             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2880             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2881         16  FILLER                         PIC X(4).
  2882         16  CF-HEALTH-QUESTIONS            PIC X.
  2883             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2884         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2885         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2886         16  CF-PLAN-SNGL-JNT               PIC X.
  2887             88  CF-COMBINED-PLAN              VALUE 'C'.
  2888             88  CF-JNT-PLAN                   VALUE 'J'.
  2889             88  CF-SNGL-PLAN                  VALUE 'S'.
  2890         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2891         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2892         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2893         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL106.cbl
  2894         16  CF-RERATE-CNTL                 PIC  X.
  2895             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2896             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2897             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2898             88  CF-AUTO-RECALC                 VALUE '4'.
  2899         16  CF-BENEFIT-TYPE                PIC  X.
  2900             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2901             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2902         16  CF-POLICY-FEE                  PIC S999V99
  2903                                                    COMP-3.
  2904         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2905         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2906         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2907         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2908         16  FILLER                         PIC  X(32).
  2909         16  CF-TERMINATION-FORM            PIC  X(04).
  2910         16  FILLER                         PIC  X(08).
  2911         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2912                                                       COMP-3.
  2913         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2914         16  CF-ISSUE-LETTER                PIC  X(4).
  2915         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2916         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2917             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2918             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2919         16  CF-MP-REFUND-CALC              PIC X.
  2920             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2921             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2922             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2923             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2924             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2925             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2926             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2927             88  CF-MP-REFD-MEAN                VALUE '8'.
  2928         16  CF-ALT-RATE-CODE               PIC  X(5).
  2929
  2930
  2931         16  FILLER                         PIC X(498).
  2932****************************************************************
  2933*             MORTGAGE COMPANY MASTER RECORD                   *
  2934****************************************************************
  2935
  2936     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2937         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2938         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2939             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2940             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2941             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2942             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2943             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2944
  2945         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2946         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2947         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2948         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2949         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2950
  2951         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL106.cbl
  2952             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2953         16  CF-MP-RECON-USE-IND            PIC X(1).
  2954             88  CF-MP-USE-RECON             VALUE 'Y'.
  2955         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2956             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2957         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2958             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2959             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2960         16  FILLER                         PIC X(1).
  2961         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2962             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2963         16  CF-MORTG-MIB-VERSION           PIC X.
  2964             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2965             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2966             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2967         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2968             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2969                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2970             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2971                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2972             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2973                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2974             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2975                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2976             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2977                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2978             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2979                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2980         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2981         16  FILLER                         PIC X(7).
  2982         16  CF-MORTG-DESTINATION-SYMBOL.
  2983             20  CF-MORTG-MIB-COMM          PIC X(5).
  2984             20  CF-MORTG-MIB-TERM          PIC X(5).
  2985         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2986             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2987         16  FILLER                         PIC X(03).
  2988         16  CF-MP-CHECK-NO-CONTROL.
  2989             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2990                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2991                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2992                                                ' ' LOW-VALUES.
  2993                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2994                                               VALUE '3'.
  2995         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2996         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2997         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2998             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2999                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3000             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3001                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3002             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3003                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3004             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3005                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3006             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3007                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3008             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3009                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL106.cbl
  3010         16  CF-MORTG-BILLING-AREA.
  3011             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3012                                            PIC X.
  3013         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3014         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3015         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3016         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3017             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3018             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3019         16  FILLER                         PIC X.
  3020         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3021             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3022             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3023         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3024         16  FILLER                         PIC X(8).
  3025         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3026         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3027         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3028         16  CF-ACH-COMPANY-ID.
  3029             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3030                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3031                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3032                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3033             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3034         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3035             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3036         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3037             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3038             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3039         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3040         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3041         16  FILLER                         PIC X(536).
  3042
  3043****************************************************************
  3044*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3045****************************************************************
  3046
  3047     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3048         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3049             20  CF-FEMALE-HEIGHT.
  3050                 24  CF-FEMALE-FT           PIC 99.
  3051                 24  CF-FEMALE-IN           PIC 99.
  3052             20  CF-FEMALE-MIN-WT           PIC 999.
  3053             20  CF-FEMALE-MAX-WT           PIC 999.
  3054         16  FILLER                         PIC X(428).
  3055
  3056     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3057         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3058             20  CF-MALE-HEIGHT.
  3059                 24  CF-MALE-FT             PIC 99.
  3060                 24  CF-MALE-IN             PIC 99.
  3061             20  CF-MALE-MIN-WT             PIC 999.
  3062             20  CF-MALE-MAX-WT             PIC 999.
  3063         16  FILLER                         PIC X(428).
  3064******************************************************************
  3065*             AUTOMATIC ACTIVITY RECORD                          *
  3066******************************************************************
  3067     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL106.cbl
  3068         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3069             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3070             20  CF-SYS-LETTER-ID           PIC X(04).
  3071             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3072             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3073             20  CF-SYS-RESET-SW            PIC X(01).
  3074             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3075             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3076
  3077         16  FILLER                         PIC X(50).
  3078
  3079         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3080             20  CF-USER-ACTIVE-SW          PIC X(01).
  3081             20  CF-USER-LETTER-ID          PIC X(04).
  3082             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3083             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3084             20  CF-USER-RESET-SW           PIC X(01).
  3085             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3086             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3087             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3088
  3089         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL106.cbl
  3091*    COPY ELCTEXT.
  3092******************************************************************
  3093*                                                                *
  3094*                                                                *
  3095*                            ELCTEXT.                            *
  3096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3097*                            VMOD=2.008                          *
  3098*                                                                *
  3099*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3100*                                     FORM LETTERS,              *
  3101*                                     CERT FORM DISPLAY.
  3102*                                                                *
  3103*   FILE TYPE = VSAM,KSDS                                        *
  3104*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3105*                                                                *
  3106*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3107*       ALTERNATE INDEX = NONE                                   *
  3108*                                                                *
  3109*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3110*       ALTERNATE INDEX = NONE                                   *
  3111*                                                                *
  3112*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3113*       ALTERNATE INDEX = NONE                                   *
  3114*                                                                *
  3115*   LOG = NO                                                     *
  3116*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3117******************************************************************
  3118 01  TEXT-FILES.
  3119     12  TEXT-FILE-ID                PIC XX.
  3120         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3121         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3122         88  HELP-FILE-TEXT             VALUE 'TH'.
  3123
  3124     12  TX-CONTROL-PRIMARY.
  3125         16  TX-COMPANY-CD           PIC X.
  3126             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3127         16  TX-ACCESS-CD-GENL       PIC X(12).
  3128
  3129         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3130             20  TX-LETTER-NO        PIC X(4).
  3131             20  FILLER              PIC X(8).
  3132
  3133         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3134             20  TX-FORM-NO          PIC X(12).
  3135
  3136         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3137             20  TX-HELP-TYPE        PIC X.
  3138                 88  HELP-FOR-GENERAL   VALUE ' '.
  3139                 88  HELP-BY-SCREEN     VALUE 'S'.
  3140                 88  HELP-BY-ERROR      VALUE 'E'.
  3141             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3142                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3143             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3144                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3145             20  FILLER              PIC X(4).
  3146
  3147         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3148
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL106.cbl
  3149     12  TX-PROCESS-CONTROL          PIC XX.
  3150         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3151
  3152     12  TX-TEXT-LINE                PIC X(70).
  3153
  3154     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3155         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3156         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3157         88  TX-VALID-FORM-SQUEEZE-VALUE
  3158                                        VALUE 'Y' ' '.
  3159
  3160     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3161         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3162         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3163         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3164         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3165         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3166         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3167         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3168                                              'K' 'N' ' '
  3169                                              'Z'.
  3170
  3171     12  TX-ARCHIVE-SW               PIC X.
  3172         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3173         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3174         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3175
  3176     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3177     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3178
  3179     12  TX-BSR-CODE                 PIC X.
  3180         88  TX-BSR-LETTER              VALUE 'B'.
  3181         88  TX-NON-BSR-LETTER          VALUE ' '.
  3182
  3183     12  FILLER                      PIC X.
  3184*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL106.cbl
  3186 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  3187                          TEXT-FILES.
  3188 0000-DFHEXIT SECTION.
  3189     MOVE '9#                    $   ' TO DFHEIV0.
  3190     MOVE 'EL106' TO DFHEIV1.
  3191     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3192
  3193     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3194     MOVE '5'                   TO DC-OPTION-CODE.
  3195     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3196     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3197     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3198
  3199     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  3200     MOVE 2                     TO EMI-NUMBER-OF-LINES
  3201                                   EMI-SWITCH2.
  3202
  3203     MOVE EIBTRMID              TO QID-TERM.
  3204
  3205     IF EIBCALEN = 0
  3206         GO TO 8800-UNAUTHORIZED-ACCESS.
  3207
  3208     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3209         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  3210       ELSE
  3211         MOVE SPACES             TO RETURNED-FROM.
  3212
  3213     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3214         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3215             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3216             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3217             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3218             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3219             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3220             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3221             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3222             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3223             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  3224         ELSE
  3225             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3226             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3227             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3228             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3229             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3230             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3231             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3232             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3233
  3234     MOVE 'N' TO WS-DISPLAY-SW.
  3235
  3236
  3237* EXEC CICS HANDLE CONDITION
  3238*        DUPREC  (8850-DUPREC)
  3239*        NOTOPEN (8870-NOTOPEN)
  3240*        NOTFND  (8880-NOT-FOUND)
  3241*        PGMIDERR(9600-PGMID-ERROR)
  3242*        ERROR   (9990-ABEND)
  3243*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL106.cbl
  3244*    MOVE '"$%JIL.               ! " #00003232' TO DFHEIV0
  3245     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  3246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3247     MOVE X'2220233030303033323332' TO DFHEIV0(25:11)
  3248     CALL 'kxdfhei1' USING DFHEIV0
  3249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3250
  3251
  3252     IF EIBTRNID NOT = TRANS-ID
  3253       IF RETURNED-FROM = XCTL-EL6565
  3254           MOVE LOW-VALUES           TO EL106AO
  3255           PERFORM 6500-RECOVER-TEMP-STORAGE THRU 6500-EXIT
  3256           GO TO 8100-SEND-INITIAL-MAP
  3257        ELSE
  3258       IF RETURNED-FROM = XCTL-EL1061
  3259           MOVE LOW-VALUES           TO EL106AO
  3260           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3261               GO TO 8100-SEND-INITIAL-MAP
  3262           ELSE
  3263               MOVE PI-WS-STATE TO STCDI
  3264               MOVE 'Y' TO WS-DISPLAY-SW
  3265               GO TO 1000-SHOW-STATE
  3266        ELSE
  3267       IF PI-RETURN-TO-PROGRAM = XCTL-EL6507
  3268           MOVE LOW-VALUES           TO EL106AO
  3269           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3270               GO TO 8100-SEND-INITIAL-MAP
  3271           ELSE
  3272               MOVE PI-WS-STATE TO STCDI
  3273               MOVE 'Y' TO WS-DISPLAY-SW
  3274               GO TO 1000-SHOW-STATE
  3275        ELSE
  3276         MOVE LOW-VALUES           TO EL106AO
  3277         GO TO 8100-SEND-INITIAL-MAP.
  3278
  3279     IF EIBAID = DFHCLEAR
  3280         GO TO 9400-CLEAR.
  3281
  3282     IF NOT DISPLAY-CAP
  3283         MOVE 'READ'         TO SM-READ
  3284         PERFORM 9995-SECURITY-VIOLATION
  3285         MOVE ER-0070        TO EMI-ERROR
  3286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3287         GO TO 8100-SEND-INITIAL-MAP.
  3288
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL106.cbl
  3290 0200-RECEIVE.
  3291     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3292         MOVE LOW-VALUES TO EL106AI
  3293         MOVE ER-7008    TO EMI-ERROR
  3294         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3295         MOVE -1 TO MAINTL
  3296         GO TO 8200-SEND-DATAONLY.
  3297
  3298
  3299* EXEC CICS RECEIVE
  3300*        MAP   (MAP-NAME)
  3301*        MAPSET(MAPSET-NAME)
  3302*        INTO  (EL106AI)
  3303*    END-EXEC.
  3304     MOVE LENGTH OF
  3305      EL106AI
  3306       TO DFHEIV11
  3307*    MOVE '8"T I  L              ''   #00003286' TO DFHEIV0
  3308     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3309     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3310     MOVE X'2020233030303033323836' TO DFHEIV0(25:11)
  3311     CALL 'kxdfhei1' USING DFHEIV0,
  3312           MAP-NAME,
  3313           EL106AI,
  3314           DFHEIV11,
  3315           MAPSET-NAME,
  3316           DFHEIV99,
  3317           DFHEIV99
  3318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3319
  3320
  3321     IF ENTERPFL = 0
  3322         GO TO 0300-CHECK-PFKEYS.
  3323
  3324     IF EIBAID NOT = DFHENTER
  3325         MOVE ER-0004 TO EMI-ERROR
  3326         GO TO 0320-INPUT-ERROR.
  3327
  3328     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3329         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3330     ELSE
  3331         MOVE ER-0029 TO EMI-ERROR
  3332         GO TO 0320-INPUT-ERROR.
  3333
  3334 0300-CHECK-PFKEYS.
  3335     IF EIBAID = DFHPF23
  3336         GO TO 8810-PF23.
  3337
  3338     IF EIBAID = DFHPF24
  3339         GO TO 9200-RETURN-MAIN-MENU.
  3340
  3341     IF EIBAID = DFHPF12
  3342         GO TO 9500-PF12.
  3343
  3344     IF MAINTL NOT = 0  AND
  3345        EIBAID NOT = DFHENTER
  3346          MOVE ER-0050 TO EMI-ERROR
  3347          GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL106.cbl
  3348
  3349     IF EIBAID = DFHPF1
  3350         GO TO 5000-FIND-NEXT-STATE.
  3351
  3352     IF EIBAID = DFHPF2
  3353         GO TO 5500-FIND-PREV-STATE.
  3354
  3355     IF EIBAID = DFHPF3
  3356         IF NOT MORTGAGE-SESSION
  3357             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3358                 MOVE ER-0029        TO  EMI-ERROR
  3359                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3360                 MOVE -1             TO  ENTERPFL
  3361                 MOVE AL-UNBON       TO  ENTERPFA
  3362                 GO TO 8200-SEND-DATAONLY
  3363             ELSE
  3364                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3365                 MOVE SPACES         TO  PI-WS-CLASS
  3366                                         PI-WS-DEV
  3367                                         PI-WS-TYPE
  3368                                         PI-WS-PLAN
  3369                 PERFORM 6400-CREATE-TEMP-STORAGE THRU 6400-EXIT
  3370                 MOVE XCTL-EL6565    TO  PGM-NAME
  3371                 GO TO 9300-XCTL
  3372         ELSE
  3373             MOVE ER-7536 TO EMI-ERROR
  3374             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3375             MOVE AL-UNBON TO ENTERPFA
  3376             IF ENTERPFL = 0
  3377                 MOVE -1 TO MAINTL
  3378                 GO TO 8200-SEND-DATAONLY
  3379             ELSE
  3380                 MOVE -1 TO ENTERPFL
  3381                 GO TO 8200-SEND-DATAONLY.
  3382
  3383     IF EIBAID = DFHPF4
  3384         IF NOT MORTGAGE-SESSION
  3385             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3386                 MOVE ER-0029        TO  EMI-ERROR
  3387                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3388                 MOVE -1             TO  ENTERPFL
  3389                 MOVE AL-UNBON       TO  ENTERPFA
  3390                 GO TO 8200-SEND-DATAONLY
  3391             ELSE
  3392                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3393                 MOVE SPACES         TO  PI-WS-CLASS
  3394                                         PI-WS-DEV
  3395                                         PI-WS-TYPE
  3396                                         PI-WS-PLAN
  3397                 MOVE XCTL-EL1061    TO  PGM-NAME
  3398                 GO TO 9300-XCTL
  3399         ELSE
  3400             MOVE ER-7536 TO EMI-ERROR
  3401             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3402             MOVE AL-UNBON TO ENTERPFA
  3403             IF ENTERPFL = 0
  3404                 MOVE -1 TO MAINTL
  3405                 GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  66
* EL106.cbl
  3406             ELSE
  3407                 MOVE -1 TO ENTERPFL
  3408                 GO TO 8200-SEND-DATAONLY.
  3409
  3410     IF EIBAID = DFHENTER
  3411         GO TO 0330-EDIT-DATA.
  3412
  3413     MOVE ER-0029 TO EMI-ERROR.
  3414 0320-INPUT-ERROR.
  3415     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3416     MOVE AL-UNBON TO ENTERPFA.
  3417
  3418     IF ENTERPFL = 0
  3419         MOVE -1 TO MAINTL
  3420     ELSE
  3421         MOVE -1 TO ENTERPFL.
  3422
  3423     GO TO 8200-SEND-DATAONLY.
  3424
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  67
* EL106.cbl
  3426 0330-EDIT-DATA.
  3427     IF STCDL = ZERO AND
  3428        STABRL = ZERO
  3429         MOVE ER-0144       TO EMI-ERROR
  3430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3431         MOVE -1            TO STCDL
  3432         MOVE AL-UABON      TO STCDA
  3433         GO TO 8200-SEND-DATAONLY.
  3434
  3435     IF STCDL = ZERO AND
  3436        STABRL NOT = ZERO
  3437         PERFORM 0500-GET-STATE-CD THRU 0600-EXIT.
  3438
  3439     IF MAINTI = 'S'
  3440         GO TO 1000-SHOW-STATE.
  3441
  3442     IF MODIFY-CAP
  3443        NEXT SENTENCE
  3444       ELSE
  3445        IF MAINTI = 'A' OR 'C' OR 'D'
  3446         MOVE 'UPDATE'       TO SM-READ
  3447         PERFORM 9995-SECURITY-VIOLATION
  3448         MOVE ER-0070        TO EMI-ERROR
  3449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3450         MOVE LOW-VALUES     TO EL106AO
  3451         GO TO 8100-SEND-INITIAL-MAP.
  3452
  3453     IF MAINTI = 'C'
  3454         GO TO 2000-CHANGE-STATE.
  3455
  3456     IF MAINTI = 'A'
  3457         GO TO 3000-ADD-STATE.
  3458
  3459     IF MAINTI = 'D'
  3460         GO TO 4000-DELETE-STATE.
  3461
  3462     MOVE ER-0023 TO EMI-ERROR.
  3463     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3464     MOVE -1       TO MAINTL.
  3465     MOVE AL-UABON TO MAINTA.
  3466     GO TO 8200-SEND-DATAONLY.
  3467
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  68
* EL106.cbl
  3469 0500-GET-STATE-CD.
  3470     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  3471     MOVE LOW-VALUES     TO CK-STATE-CD.
  3472     MOVE +0             TO CK-SEQ.
  3473
  3474
  3475* EXEC CICS HANDLE CONDITION
  3476*        ENDFILE(8880-NOT-FOUND)
  3477*        NOTFND (8880-NOT-FOUND)
  3478*    END-EXEC.
  3479*    MOVE '"$''I                  ! # #00003445' TO DFHEIV0
  3480     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  3481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3482     MOVE X'2320233030303033343435' TO DFHEIV0(25:11)
  3483     CALL 'kxdfhei1' USING DFHEIV0
  3484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3485
  3486
  3487
  3488* EXEC CICS STARTBR
  3489*        DATASET  (ELCNTL-ID)
  3490*        RIDFLD   (ELCNTL-KEY)
  3491*    END-EXEC.
  3492     MOVE 0
  3493       TO DFHEIV11
  3494*    MOVE '&,         G          &   #00003450' TO DFHEIV0
  3495     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3496     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3497     MOVE X'2020233030303033343530' TO DFHEIV0(25:11)
  3498     CALL 'kxdfhei1' USING DFHEIV0,
  3499           ELCNTL-ID,
  3500           ELCNTL-KEY,
  3501           DFHEIV99,
  3502           DFHEIV11,
  3503           DFHEIV99
  3504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3505
  3506
  3507 0510-GET-NEXT-CD.
  3508
  3509* EXEC CICS READNEXT
  3510*        DATASET(ELCNTL-ID)
  3511*        SET    (ADDRESS OF CONTROL-FILE)
  3512*        RIDFLD (ELCNTL-KEY)
  3513*    END-EXEC.
  3514     MOVE 0
  3515       TO DFHEIV11
  3516*    MOVE '&.S                   )   #00003456' TO DFHEIV0
  3517     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3518     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3519     MOVE X'2020233030303033343536' TO DFHEIV0(25:11)
  3520     CALL 'kxdfhei1' USING DFHEIV0,
  3521           ELCNTL-ID,
  3522           DFHEIV20,
  3523           DFHEIV99,
  3524           ELCNTL-KEY,
  3525           DFHEIV99,
  3526           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  69
* EL106.cbl
  3527           DFHEIV99,
  3528           DFHEIV99
  3529     SET ADDRESS OF CONTROL-FILE TO
  3530         DFHEIV20
  3531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3532
  3533
  3534     IF CF-COMPANY-ID NOT = PI-COMPANY-ID
  3535
  3536* EXEC CICS ENDBR
  3537*            DATASET  (ELCNTL-ID)
  3538*        END-EXEC
  3539     MOVE 0
  3540       TO DFHEIV11
  3541*    MOVE '&2                    $   #00003463' TO DFHEIV0
  3542     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3543     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3544     MOVE X'2020233030303033343633' TO DFHEIV0(25:11)
  3545     CALL 'kxdfhei1' USING DFHEIV0,
  3546           ELCNTL-ID,
  3547           DFHEIV11,
  3548           DFHEIV99
  3549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3550         GO TO 8880-NOT-FOUND.
  3551
  3552     IF CF-RECORD-TYPE NOT = '3'
  3553         GO TO 0510-GET-NEXT-CD.
  3554
  3555     IF CF-STATE-ABBREVIATION = STABRI
  3556         NEXT SENTENCE
  3557       ELSE
  3558         GO TO 0510-GET-NEXT-CD.
  3559
  3560     MOVE CF-STATE-CODE      TO STCDI.
  3561     MOVE AL-UANON           TO STCDA.
  3562     MOVE +2                 TO STCDL.
  3563
  3564
  3565* EXEC CICS ENDBR
  3566*        DATASET  (ELCNTL-ID)
  3567*    END-EXEC.
  3568     MOVE 0
  3569       TO DFHEIV11
  3570*    MOVE '&2                    $   #00003480' TO DFHEIV0
  3571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3573     MOVE X'2020233030303033343830' TO DFHEIV0(25:11)
  3574     CALL 'kxdfhei1' USING DFHEIV0,
  3575           ELCNTL-ID,
  3576           DFHEIV11,
  3577           DFHEIV99
  3578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3579
  3580
  3581 0600-EXIT.
  3582      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  70
* EL106.cbl
  3584 1000-SHOW-STATE.
  3585     IF RETURN-DISPLAY
  3586
  3587* EXEC CICS HANDLE CONDITION
  3588*            NOTFND  (8100-SEND-INITIAL-MAP)
  3589*        END-EXEC.
  3590*    MOVE '"$I                   ! $ #00003489' TO DFHEIV0
  3591     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3593     MOVE X'2420233030303033343839' TO DFHEIV0(25:11)
  3594     CALL 'kxdfhei1' USING DFHEIV0
  3595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3596
  3597
  3598     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3599     MOVE STCDI         TO CK-STATE-CD
  3600                           PI-WS-STATE.
  3601
  3602
  3603* EXEC CICS READ
  3604*        DATASET(ELCNTL-ID)
  3605*        SET    (ADDRESS OF CONTROL-FILE)
  3606*        RIDFLD (ELCNTL-KEY)
  3607*    END-EXEC.
  3608*    MOVE '&"S        E          (   #00003497' TO DFHEIV0
  3609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3611     MOVE X'2020233030303033343937' TO DFHEIV0(25:11)
  3612     CALL 'kxdfhei1' USING DFHEIV0,
  3613           ELCNTL-ID,
  3614           DFHEIV20,
  3615           DFHEIV99,
  3616           ELCNTL-KEY,
  3617           DFHEIV99,
  3618           DFHEIV99,
  3619           DFHEIV99
  3620     SET ADDRESS OF CONTROL-FILE TO
  3621         DFHEIV20
  3622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3623
  3624
  3625     GO TO 7000-BUILD-OUTPUT-MAP.
  3626
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  71
* EL106.cbl
  3628 2000-CHANGE-STATE.
  3629     IF STCDI NOT = PI-PREV-STATE
  3630         MOVE ER-0145 TO EMI-ERROR
  3631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3632         MOVE -1       TO STCDL
  3633         MOVE AL-UABON TO STCDA
  3634         GO TO 8200-SEND-DATAONLY.
  3635
  3636     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3637
  3638     IF NOT EMI-NO-ERRORS
  3639         GO TO 8200-SEND-DATAONLY.
  3640
  3641     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3642     MOVE STCDI         TO CK-STATE-CD
  3643                           PI-WS-STATE.
  3644
  3645
  3646* EXEC CICS READ
  3647*        UPDATE
  3648*        DATASET(ELCNTL-ID)
  3649*        SET    (ADDRESS OF CONTROL-FILE)
  3650*        RIDFLD (ELCNTL-KEY)
  3651*    END-EXEC.
  3652*    MOVE '&"S        EU         (   #00003523' TO DFHEIV0
  3653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3654     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3655     MOVE X'2020233030303033353233' TO DFHEIV0(25:11)
  3656     CALL 'kxdfhei1' USING DFHEIV0,
  3657           ELCNTL-ID,
  3658           DFHEIV20,
  3659           DFHEIV99,
  3660           ELCNTL-KEY,
  3661           DFHEIV99,
  3662           DFHEIV99,
  3663           DFHEIV99
  3664     SET ADDRESS OF CONTROL-FILE TO
  3665         DFHEIV20
  3666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3667
  3668
  3669     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  3670        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  3671
  3672* EXEC CICS UNLOCK
  3673*            DATASET(ELCNTL-ID)
  3674*        END-EXEC
  3675*    MOVE '&*                    #   #00003532' TO DFHEIV0
  3676     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3677     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3678     MOVE X'2020233030303033353332' TO DFHEIV0(25:11)
  3679     CALL 'kxdfhei1' USING DFHEIV0,
  3680           ELCNTL-ID,
  3681           DFHEIV99
  3682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3683         MOVE ER-0068 TO EMI-ERROR
  3684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3685         GO TO 1000-SHOW-STATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  72
* EL106.cbl
  3686
  3687     MOVE 'B'                    TO JP-RECORD-TYPE.
  3688     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3689     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3690
  3691     MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY.
  3692     MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS.
  3693     MOVE EIBDATE         TO DC-JULIAN-YYDDD.
  3694     MOVE '5'             TO DC-OPTION-CODE.
  3695     MOVE LINK-ELDATCV    TO PGM-NAME.
  3696
  3697
  3698* EXEC CICS LINK
  3699*        PROGRAM (PGM-NAME)
  3700*        COMMAREA(DATE-CONVERSION-DATA)
  3701*        LENGTH  (DC-COMM-LENGTH)
  3702*    END-EXEC.
  3703*    MOVE '."C                   ''   #00003549' TO DFHEIV0
  3704     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3706     MOVE X'2020233030303033353439' TO DFHEIV0(25:11)
  3707     CALL 'kxdfhei1' USING DFHEIV0,
  3708           PGM-NAME,
  3709           DATE-CONVERSION-DATA,
  3710           DC-COMM-LENGTH,
  3711           DFHEIV99,
  3712           DFHEIV99,
  3713           DFHEIV99
  3714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3715
  3716
  3717     IF DATE-CONVERSION-ERROR
  3718         MOVE LOW-VALUES          TO CF-LAST-MAINT-DT
  3719     ELSE
  3720         MOVE DC-BIN-DATE-1       TO CF-LAST-MAINT-DT.
  3721
  3722     IF STABRL NOT = ZEROS
  3723         MOVE STABRI              TO CF-STATE-ABBREVIATION.
  3724
  3725     IF STNAMEL NOT = ZEROS
  3726         MOVE STNAMEI             TO CF-STATE-NAME.
  3727
  3728     IF LFEXPL NOT = ZEROS
  3729         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  3730
  3731     IF AHEXPL NOT = ZEROS
  3732         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  3733
  3734     IF QUOTCALL NOT = ZEROS
  3735         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  3736
  3737     IF PREMTOLL NOT = ZEROS
  3738         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  3739
  3740     IF REFTOLL NOT = ZEROS
  3741         MOVE REFTOLI             TO CF-ST-TOL-REFUND.
  3742
  3743     IF OVSAMTL > 0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  73
* EL106.cbl
  3744         MOVE OVSAMTI TO CF-ST-OVR-SHT-AMT
  3745     END-IF.
  3746
  3747     IF PRMPCTL NOT = ZEROS
  3748         MOVE WS-ST-TOL-PREM-PCT  TO CF-ST-TOL-PREM-PCT.
  3749
  3750     IF REFPCTL NOT = ZEROS
  3751         MOVE  WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  3752
  3753     IF OVSPCTL > +0
  3754         MOVE WS-ST-OVR-SHT-PCT TO CF-ST-OVR-SHT-PCT
  3755     END-IF.
  3756
  3757     IF CLREJECL NOT = ZEROS
  3758         MOVE CLREJECI            TO CF-ST-CLAIM-REJECT-SW.
  3759
  3760     IF ISSREJL NOT = ZEROS
  3761         MOVE ISSREJI             TO CF-ST-PREM-REJECT-SW.
  3762
  3763     IF REFREJL NOT = ZEROS
  3764         MOVE REFREJI             TO CF-ST-REF-REJECT-SW.
  3765
  3766     IF REFMINL NOT = ZEROS
  3767         MOVE REFMINI             TO CF-ST-REFUND-MIN.
  3768
  3769     IF REFDAY1L NOT = ZEROS
  3770         MOVE REFDAY1I            TO CF-ST-REFUND-DAYS-FIRST.
  3771
  3772     IF REFDAYSL NOT = ZEROS
  3773         MOVE REFDAYSI            TO CF-ST-REFUND-DAYS-SUBSEQ.
  3774
  3775     IF SPLPMTL NOT = ZEROS
  3776         MOVE SPLPMTI             TO CF-ST-SPLIT-PAYMENT.
  3777
  3778     IF EXTDAYSL NOT = ZEROS
  3779         MOVE EXTDAYSI            TO CF-ST-FST-PMT-DAYS-MAX.
  3780
  3781*    IF INTDAYSL NOT = ZEROS
  3782*        MOVE INTDAYSI            TO CF-ST-NO-DAYS-ELAPSED.
  3783
  3784     IF EXTCHGL NOT = ZEROS
  3785         MOVE EXTCHGI             TO CF-ST-FST-PMT-DAYS-CHG.
  3786
  3787     IF REMTERML NOT = ZEROS
  3788        MOVE REMTERMI             TO CF-ST-RT-CALC
  3789     END-IF
  3790
  3791     IF LFREDL NOT = ZEROS
  3792        MOVE LFREDI               TO CF-ST-RF-LR-CALC
  3793     END-IF
  3794
  3795     IF LFLEVL NOT = ZEROS
  3796        MOVE LFLEVI               TO CF-ST-RF-LL-CALC
  3797     END-IF
  3798
  3799     IF LFNETL NOT = ZEROS
  3800        MOVE LFNETI               TO CF-ST-RF-LN-CALC
  3801     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  74
* EL106.cbl
  3802
  3803     IF AHAHL NOT = ZEROS
  3804        MOVE AHAHI                TO CF-ST-RF-AH-CALC
  3805     END-IF
  3806
  3807     IF AHCPL NOT = ZEROS
  3808        MOVE AHCPI                TO CF-ST-RF-CP-CALC
  3809     END-IF
  3810
  3811     IF LFTAXL > +0
  3812        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  3813     END-IF
  3814
  3815     IF AHITAXL > +0
  3816        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  3817     END-IF
  3818
  3819     IF AHGTAXL > +0
  3820        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  3821     END-IF
  3822
  3823     IF REFCLML NOT = ZEROS
  3824         MOVE REFCLMI             TO CF-ST-REF-AH-DEATH-IND
  3825     END-IF.
  3826
  3827     IF STUEL NOT = ZEROS
  3828         MOVE STUEI               TO CF-ST-CALL-UNEARNED.
  3829
  3830     IF STCNTLL NOT = ZEROS
  3831         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  3832
  3833     IF STDEVL NOT = ZEROS
  3834         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  3835
  3836     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  3837     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  3838
  3839     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  3840
  3841*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  3842
  3843     IF WS-COMSL NUMERIC AND
  3844        WS-COMSL NOT = ZEROS
  3845         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL
  3846      ELSE
  3847         MOVE ZEROS              TO CF-ST-COMM-CAP-SL.
  3848
  3849     IF WS-COMJL NUMERIC AND
  3850        WS-COMJL NOT = ZEROS
  3851         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL
  3852      ELSE
  3853         MOVE ZEROS              TO CF-ST-COMM-CAP-JL.
  3854
  3855     IF WS-COMSA NUMERIC AND
  3856        WS-COMSA NOT = ZEROS
  3857         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA
  3858      ELSE
  3859         MOVE ZEROS              TO CF-ST-COMM-CAP-SA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  75
* EL106.cbl
  3860
  3861     IF WS-COMJA NUMERIC AND
  3862        WS-COMJA NOT = ZEROS
  3863         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA
  3864      ELSE
  3865         MOVE ZEROS              TO CF-ST-COMM-CAP-JA.
  3866
  3867     IF WS-IRATE NUMERIC AND
  3868        WS-IRATE NOT = ZEROS
  3869         MOVE WS-IRATE           TO CF-ST-STAT-INTEREST
  3870      ELSE
  3871         MOVE ZEROS              TO CF-ST-STAT-INTEREST.
  3872
  3873     IF WS-IRATE1 NUMERIC AND
  3874        WS-IRATE1 NOT = ZEROS
  3875         MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1
  3876      ELSE
  3877         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1.
  3878
  3879     IF WS-IRATE2 NUMERIC AND
  3880        WS-IRATE2 NOT = ZEROS
  3881         MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2
  3882      ELSE
  3883         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2.
  3884
  3885     IF WS-IRATE3 NUMERIC AND
  3886        WS-IRATE3 NOT = ZEROS
  3887         MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3
  3888      ELSE
  3889         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3.
  3890
  3891     IF WS-RESIDENT-TAX NUMERIC AND
  3892        WS-RESIDENT-TAX NOT = ZEROS
  3893         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT
  3894      ELSE
  3895         MOVE ZEROS              TO CF-ST-RES-TAX-PCT.
  3896
  3897     IF WS-FREE-LOOK-DAYS NUMERIC
  3898             AND
  3899        WS-FREE-LOOK-DAYS NOT EQUAL ZEROS
  3900         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD
  3901      ELSE
  3902         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD.
  3903
  3904     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  3905             AND
  3906         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  3907         MOVE WS-ST-TARGET-LOSS-RATIO
  3908                                 TO CF-ST-TARGET-LOSS-RATIO
  3909     ELSE
  3910         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  3911
  3912     IF  WS-ST-CALC-INTEREST NUMERIC
  3913             AND
  3914         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  3915         MOVE WS-ST-CALC-INTEREST
  3916                                 TO CF-ST-CALC-INTEREST
  3917     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  76
* EL106.cbl
  3918         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  3919
  3920     MOVE 'C'                    TO JP-RECORD-TYPE.
  3921     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3922
  3923* EXEC CICS REWRITE
  3924*        DATASET(ELCNTL-ID)
  3925*        FROM   (CONTROL-FILE)
  3926*    END-EXEC.
  3927     MOVE LENGTH OF
  3928      CONTROL-FILE
  3929       TO DFHEIV11
  3930*    MOVE '&& L                  %   #00003760' TO DFHEIV0
  3931     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3932     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3933     MOVE X'2020233030303033373630' TO DFHEIV0(25:11)
  3934     CALL 'kxdfhei1' USING DFHEIV0,
  3935           ELCNTL-ID,
  3936           CONTROL-FILE,
  3937           DFHEIV11,
  3938           DFHEIV99
  3939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3940
  3941
  3942     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3943     MOVE ER-0000 TO EMI-ERROR.
  3944     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3945     MOVE LOW-VALUES  TO EL106AO.
  3946     MOVE -1          TO MAINTL.
  3947     MOVE SPACES      TO PI-PREV-STATE.
  3948     MOVE CK-STATE-CD TO STCDO.
  3949     MOVE AL-UANON    TO STCDA.
  3950     GO TO 1000-SHOW-STATE.
  3951
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  77
* EL106.cbl
  3953 3000-ADD-STATE.
  3954     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3955
  3956     IF NOT EMI-NO-ERRORS
  3957         GO TO 8200-SEND-DATAONLY.
  3958
  3959
  3960* EXEC CICS GETMAIN
  3961*        SET    (ADDRESS OF CONTROL-FILE)
  3962*        LENGTH (750)
  3963*        INITIMG(GETMAIN-SPACE)
  3964*    END-EXEC.
  3965     MOVE 750
  3966       TO DFHEIV11
  3967*    MOVE ',"IL                  $   #00003782' TO DFHEIV0
  3968     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3969     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3970     MOVE X'2020233030303033373832' TO DFHEIV0(25:11)
  3971     CALL 'kxdfhei1' USING DFHEIV0,
  3972           DFHEIV20,
  3973           DFHEIV11,
  3974           GETMAIN-SPACE
  3975     SET ADDRESS OF CONTROL-FILE TO
  3976         DFHEIV20
  3977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3978
  3979
  3980     MOVE 'CF'          TO CF-RECORD-ID.
  3981     MOVE PI-COMPANY-ID TO CF-COMPANY-ID.
  3982     MOVE '3'           TO CF-RECORD-TYPE.
  3983     MOVE STCDI         TO CF-ACCESS-OF-STATE.
  3984     MOVE +0            TO CF-SEQUENCE-NO.
  3985
  3986     MOVE EIBDATE       TO DC-JULIAN-YYDDD.
  3987     MOVE '5'           TO DC-OPTION-CODE.
  3988     MOVE LINK-ELDATCV  TO PGM-NAME.
  3989
  3990* EXEC CICS LINK
  3991*        PROGRAM (PGM-NAME)
  3992*        COMMAREA(DATE-CONVERSION-DATA)
  3993*        LENGTH  (DC-COMM-LENGTH)
  3994*    END-EXEC.
  3995*    MOVE '."C                   ''   #00003797' TO DFHEIV0
  3996     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3998     MOVE X'2020233030303033373937' TO DFHEIV0(25:11)
  3999     CALL 'kxdfhei1' USING DFHEIV0,
  4000           PGM-NAME,
  4001           DATE-CONVERSION-DATA,
  4002           DC-COMM-LENGTH,
  4003           DFHEIV99,
  4004           DFHEIV99,
  4005           DFHEIV99
  4006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4007
  4008
  4009     IF DATE-CONVERSION-ERROR
  4010         MOVE LOW-VALUES    TO CF-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  78
* EL106.cbl
  4011       ELSE
  4012         MOVE DC-BIN-DATE-1 TO CF-LAST-MAINT-DT.
  4013
  4014     MOVE PI-PROCESSOR-ID   TO CF-LAST-MAINT-BY.
  4015     MOVE EIBTIME           TO CF-LAST-MAINT-HHMMSS.
  4016
  4017     MOVE STNAMEI           TO CF-STATE-NAME.
  4018     MOVE STABRI            TO CF-STATE-ABBREVIATION.
  4019
  4020     IF LFEXPL = ZEROS
  4021         MOVE ZEROS               TO CF-ST-LF-EXP-PCT
  4022       ELSE
  4023         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  4024
  4025     IF AHEXPL = ZEROS
  4026         MOVE ZEROS               TO CF-ST-AH-EXP-PCT
  4027       ELSE
  4028         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  4029
  4030     IF QUOTCALL = ZEROS
  4031         MOVE ZEROS               TO CF-ST-TOL-CLAIM
  4032       ELSE
  4033         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  4034
  4035     IF PREMTOLL = ZEROS
  4036         MOVE ZEROS               TO CF-ST-TOL-PREM
  4037       ELSE
  4038         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  4039
  4040     IF OVSAMTL = ZEROS
  4041         MOVE ZEROS              TO CF-ST-OVR-SHT-AMT
  4042       ELSE
  4043         MOVE OVSAMTI            TO CF-ST-OVR-SHT-AMT.
  4044
  4045     IF REFTOLL = ZEROS
  4046         MOVE ZEROS              TO CF-ST-TOL-REFUND
  4047       ELSE
  4048         MOVE REFTOLI            TO CF-ST-TOL-REFUND.
  4049
  4050     IF PRMPCTL = ZEROS
  4051         MOVE ZEROS              TO CF-ST-TOL-PREM-PCT
  4052       ELSE
  4053         MOVE WS-ST-TOL-PREM-PCT TO CF-ST-TOL-PREM-PCT.
  4054
  4055     IF OVSPCTL = ZEROS
  4056         MOVE ZEROS              TO CF-ST-OVR-SHT-PCT
  4057       ELSE
  4058         MOVE WS-ST-OVR-SHT-PCT  TO CF-ST-OVR-SHT-PCT.
  4059
  4060     IF REFPCTL = ZEROS
  4061         MOVE ZEROS              TO CF-ST-TOL-REF-PCT
  4062       ELSE
  4063         MOVE WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  4064
  4065     IF CLREJECL = ZEROS
  4066         MOVE SPACE              TO CF-ST-CLAIM-REJECT-SW
  4067       ELSE
  4068         MOVE CLREJECI           TO CF-ST-CLAIM-REJECT-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  79
* EL106.cbl
  4069
  4070     IF ISSREJL = ZEROS
  4071         MOVE SPACE              TO CF-ST-PREM-REJECT-SW
  4072       ELSE
  4073         MOVE ISSREJI            TO CF-ST-PREM-REJECT-SW.
  4074
  4075     IF REFREJL = ZEROS
  4076         MOVE SPACE              TO CF-ST-REF-REJECT-SW
  4077       ELSE
  4078         MOVE REFREJI            TO CF-ST-REF-REJECT-SW.
  4079
  4080     IF REFMINL = ZEROS
  4081         MOVE ZEROS              TO CF-ST-REFUND-MIN
  4082       ELSE
  4083         MOVE REFMINI            TO CF-ST-REFUND-MIN.
  4084
  4085     IF REFDAY1L  = ZERO
  4086         MOVE ZEROS              TO CF-ST-REFUND-DAYS-FIRST
  4087       ELSE
  4088         MOVE REFDAY1I           TO CF-ST-REFUND-DAYS-FIRST.
  4089
  4090     IF REFDAYSL = ZERO
  4091         MOVE ZEROS              TO CF-ST-REFUND-DAYS-SUBSEQ
  4092       ELSE
  4093         MOVE REFDAYSI           TO CF-ST-REFUND-DAYS-SUBSEQ.
  4094
  4095     IF SPLPMTL = ZERO
  4096         MOVE 'N'                TO CF-ST-SPLIT-PAYMENT
  4097     ELSE
  4098         MOVE SPLPMTI            TO CF-ST-SPLIT-PAYMENT.
  4099
  4100     IF EXTDAYSL = ZERO
  4101         MOVE ZEROS              TO CF-ST-FST-PMT-DAYS-MAX
  4102       ELSE
  4103         MOVE EXTDAYSI           TO CF-ST-FST-PMT-DAYS-MAX.
  4104
  4105*    IF INTDAYSL = ZERO
  4106*        MOVE ZEROS              TO CF-ST-NO-DAYS-ELAPSED
  4107*      ELSE
  4108*        MOVE INTDAYSI           TO CF-ST-NO-DAYS-ELAPSED.
  4109
  4110     IF EXTCHGL = ZEROS
  4111         MOVE SPACES             TO CF-ST-FST-PMT-DAYS-CHG
  4112       ELSE
  4113         MOVE EXTCHGI            TO CF-ST-FST-PMT-DAYS-CHG.
  4114
  4115     IF REMTERML = ZEROS
  4116        MOVE SPACES              TO CF-ST-RT-CALC
  4117     ELSE
  4118        MOVE REMTERMI            TO CF-ST-RT-CALC
  4119     END-IF
  4120
  4121     IF LFTAXL = ZEROS
  4122        MOVE ZEROS               TO CF-ST-LF-PREM-TAX
  4123     ELSE
  4124        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  4125     END-IF
  4126
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  80
* EL106.cbl
  4127     IF AHITAXL = ZEROS
  4128        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-I
  4129     ELSE
  4130        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  4131     END-IF
  4132
  4133     IF AHGTAXL = ZEROS
  4134        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-G
  4135     ELSE
  4136        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  4137     END-IF
  4138
  4139     IF STUEL = ZEROS
  4140         MOVE SPACES             TO CF-ST-CALL-UNEARNED
  4141       ELSE
  4142         MOVE STUEI              TO CF-ST-CALL-UNEARNED.
  4143
  4144     IF STCNTLL = ZEROS
  4145         MOVE SPACES             TO CF-ST-CALL-RPT-CNTL
  4146       ELSE
  4147         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  4148
  4149     IF STDEVL = ZEROS
  4150         MOVE SPACES             TO CF-ST-CALL-RATE-DEV
  4151       ELSE
  4152         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  4153
  4154     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  4155             AND
  4156         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  4157         MOVE WS-ST-TARGET-LOSS-RATIO
  4158                                 TO CF-ST-TARGET-LOSS-RATIO
  4159     ELSE
  4160         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  4161
  4162     IF  WS-ST-CALC-INTEREST NUMERIC
  4163             AND
  4164         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  4165         MOVE WS-ST-CALC-INTEREST
  4166                                 TO CF-ST-CALC-INTEREST
  4167     ELSE
  4168         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  4169
  4170     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  4171     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  4172
  4173     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  4174
  4175*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  4176
  4177     IF COMSLL = ZEROS
  4178         MOVE ZEROS              TO CF-ST-COMM-CAP-SL
  4179       ELSE
  4180         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL.
  4181
  4182     IF COMJLL = ZEROS
  4183         MOVE ZEROS              TO CF-ST-COMM-CAP-JL
  4184       ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  81
* EL106.cbl
  4185         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL.
  4186
  4187     IF COMSAL = ZEROS
  4188         MOVE ZEROS              TO CF-ST-COMM-CAP-SA
  4189       ELSE
  4190         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA.
  4191
  4192     IF COMJAL = ZEROS
  4193         MOVE ZEROS              TO CF-ST-COMM-CAP-JA
  4194       ELSE
  4195         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA.
  4196
  4197     IF RESTAXL = ZEROS
  4198         MOVE ZEROS              TO CF-ST-RES-TAX-PCT
  4199       ELSE
  4200         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT.
  4201
  4202     IF FREELKL = ZEROS
  4203         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD
  4204       ELSE
  4205         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD.
  4206
  4207*    IF STATRL = ZEROS
  4208         MOVE ZEROS              TO CF-ST-STAT-INTEREST
  4209*      ELSE
  4210*        MOVE WS-IRATE           TO CF-ST-STAT-INTEREST.
  4211
  4212*    IF STATR1L = ZEROS
  4213         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1
  4214*      ELSE
  4215*        MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1.
  4216
  4217*    IF STATR2L = ZEROS
  4218         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2
  4219*      ELSE
  4220*        MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2.
  4221
  4222*    IF STATR3L = ZEROS
  4223         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3
  4224*      ELSE
  4225*        MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3.
  4226
  4227     PERFORM 6100-INITIALIZE-BENEFIT-CNTL THRU 6199-EXIT
  4228             VARYING SUB FROM +1 BY +1
  4229             UNTIL SUB GREATER THAN +50.
  4230
  4231     MOVE 'A'                    TO JP-RECORD-TYPE.
  4232     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4233
  4234
  4235* EXEC CICS WRITE
  4236*        FROM   (CONTROL-FILE)
  4237*        DATASET(ELCNTL-ID)
  4238*        RIDFLD (CF-CONTROL-PRIMARY)
  4239*    END-EXEC.
  4240     MOVE LENGTH OF
  4241      CONTROL-FILE
  4242       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  82
* EL106.cbl
  4243*    MOVE '&$ L                  ''   #00004028' TO DFHEIV0
  4244     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4245     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4246     MOVE X'2020233030303034303238' TO DFHEIV0(25:11)
  4247     CALL 'kxdfhei1' USING DFHEIV0,
  4248           ELCNTL-ID,
  4249           CONTROL-FILE,
  4250           DFHEIV11,
  4251           CF-CONTROL-PRIMARY,
  4252           DFHEIV99,
  4253           DFHEIV99
  4254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4255
  4256
  4257     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  4258     MOVE ER-0000 TO EMI-ERROR.
  4259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4260     MOVE LOW-VALUES  TO EL106AO.
  4261     MOVE -1          TO MAINTL.
  4262     MOVE SPACES      TO PI-PREV-STATE.
  4263     MOVE CK-STATE-CD TO STCDO.
  4264     MOVE AL-UANON    TO STCDA.
  4265     GO TO 8100-SEND-INITIAL-MAP.
  4266
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  83
* EL106.cbl
  4268 4000-DELETE-STATE.
  4269     IF STCDI NOT = PI-PREV-STATE
  4270         MOVE ER-0145  TO EMI-ERROR
  4271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4272         MOVE -1       TO STCDL
  4273         MOVE AL-UABON TO STCDA
  4274         GO TO 8200-SEND-DATAONLY.
  4275
  4276     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  4277     MOVE STCDI         TO CK-STATE-CD.
  4278
  4279* EXEC CICS READ
  4280*        UPDATE
  4281*        DATASET(ELCNTL-ID)
  4282*        SET    (ADDRESS OF CONTROL-FILE)
  4283*        RIDFLD (ELCNTL-KEY)
  4284*    END-EXEC.
  4285*    MOVE '&"S        EU         (   #00004055' TO DFHEIV0
  4286     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4287     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4288     MOVE X'2020233030303034303535' TO DFHEIV0(25:11)
  4289     CALL 'kxdfhei1' USING DFHEIV0,
  4290           ELCNTL-ID,
  4291           DFHEIV20,
  4292           DFHEIV99,
  4293           ELCNTL-KEY,
  4294           DFHEIV99,
  4295           DFHEIV99,
  4296           DFHEIV99
  4297     SET ADDRESS OF CONTROL-FILE TO
  4298         DFHEIV20
  4299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4300
  4301
  4302     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  4303        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  4304
  4305* EXEC CICS UNLOCK
  4306*            DATASET(ELCNTL-ID)
  4307*        END-EXEC
  4308*    MOVE '&*                    #   #00004064' TO DFHEIV0
  4309     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4311     MOVE X'2020233030303034303634' TO DFHEIV0(25:11)
  4312     CALL 'kxdfhei1' USING DFHEIV0,
  4313           ELCNTL-ID,
  4314           DFHEIV99
  4315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4316         MOVE ER-0068 TO EMI-ERROR
  4317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4318         GO TO 1000-SHOW-STATE.
  4319
  4320     MOVE 'D'                    TO JP-RECORD-TYPE.
  4321     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4322
  4323* EXEC CICS DELETE
  4324*        DATASET(ELCNTL-ID)
  4325*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  84
* EL106.cbl
  4326*    MOVE '&(                    &   #00004073' TO DFHEIV0
  4327     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4328     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4329     MOVE X'2020233030303034303733' TO DFHEIV0(25:11)
  4330     CALL 'kxdfhei1' USING DFHEIV0,
  4331           ELCNTL-ID,
  4332           DFHEIV99,
  4333           DFHEIV99,
  4334           DFHEIV99,
  4335           DFHEIV99
  4336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4337
  4338
  4339     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT
  4340     MOVE ER-0000 TO EMI-ERROR.
  4341     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4342     MOVE LOW-VALUES  TO EL106AO.
  4343     MOVE -1          TO MAINTL.
  4344     MOVE SPACES      TO PI-PREV-STATE
  4345     MOVE CK-STATE-CD TO STCDO.
  4346     MOVE AL-UANON    TO STCDA.
  4347     GO TO 8100-SEND-INITIAL-MAP.
  4348
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  85
* EL106.cbl
  4350 5000-FIND-NEXT-STATE.
  4351     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  4352
  4353     IF STCDL = 0
  4354         MOVE LOW-VALUES TO CK-STATE-CD
  4355         MOVE +0         TO CK-SEQ
  4356     ELSE
  4357         MOVE STCDI      TO CK-STATE-CD
  4358         MOVE +1         TO CK-SEQ.
  4359
  4360     MOVE SPACES TO PI-PREV-STATE.
  4361
  4362
  4363* EXEC CICS HANDLE CONDITION
  4364*        NOTFND (8860-ENDFILE)
  4365*    END-EXEC.
  4366*    MOVE '"$I                   ! % #00004100' TO DFHEIV0
  4367     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4369     MOVE X'2520233030303034313030' TO DFHEIV0(25:11)
  4370     CALL 'kxdfhei1' USING DFHEIV0
  4371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4372
  4373
  4374
  4375* EXEC CICS READ
  4376*        DATASET(ELCNTL-ID)
  4377*        SET    (ADDRESS OF CONTROL-FILE)
  4378*        RIDFLD (ELCNTL-KEY)
  4379*        GTEQ
  4380*    END-EXEC.
  4381*    MOVE '&"S        G          (   #00004104' TO DFHEIV0
  4382     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4384     MOVE X'2020233030303034313034' TO DFHEIV0(25:11)
  4385     CALL 'kxdfhei1' USING DFHEIV0,
  4386           ELCNTL-ID,
  4387           DFHEIV20,
  4388           DFHEIV99,
  4389           ELCNTL-KEY,
  4390           DFHEIV99,
  4391           DFHEIV99,
  4392           DFHEIV99
  4393     SET ADDRESS OF CONTROL-FILE TO
  4394         DFHEIV20
  4395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4396
  4397
  4398     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4399        CF-RECORD-TYPE NOT = '3'
  4400         GO TO 8860-ENDFILE.
  4401
  4402     IF STCDL = 0
  4403         MOVE ER-0146 TO EMI-ERROR
  4404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4405
  4406     GO TO 7000-BUILD-OUTPUT-MAP.
  4407
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  86
* EL106.cbl
  4409 5500-FIND-PREV-STATE.
  4410     MOVE PI-COMPANY-ID          TO  CK-COMP-ID.
  4411     MOVE PI-PREV-STATE          TO  CK-STATE-CD.
  4412
  4413     IF STCDL GREATER +0
  4414         MOVE STCDI              TO  CK-STATE-CD.
  4415
  4416     MOVE SPACES                 TO  PI-PREV-STATE.
  4417
  4418
  4419* EXEC CICS HANDLE CONDITION
  4420*        NOTFND(8860-ENDFILE)
  4421*    END-EXEC.
  4422*    MOVE '"$I                   ! & #00004131' TO DFHEIV0
  4423     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4425     MOVE X'2620233030303034313331' TO DFHEIV0(25:11)
  4426     CALL 'kxdfhei1' USING DFHEIV0
  4427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4428
  4429
  4430
  4431* EXEC CICS STARTBR
  4432*        DATASET  (ELCNTL-ID)
  4433*        RIDFLD   (ELCNTL-KEY)
  4434*    END-EXEC.
  4435     MOVE 0
  4436       TO DFHEIV11
  4437*    MOVE '&,         G          &   #00004135' TO DFHEIV0
  4438     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4439     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4440     MOVE X'2020233030303034313335' TO DFHEIV0(25:11)
  4441     CALL 'kxdfhei1' USING DFHEIV0,
  4442           ELCNTL-ID,
  4443           ELCNTL-KEY,
  4444           DFHEIV99,
  4445           DFHEIV11,
  4446           DFHEIV99
  4447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4448
  4449
  4450 5600-READ-PREV-STATE-RECORD.
  4451
  4452* EXEC CICS READPREV
  4453*        DATASET  (ELCNTL-ID)
  4454*        SET      (ADDRESS OF CONTROL-FILE)
  4455*        RIDFLD   (ELCNTL-KEY)
  4456*    END-EXEC.
  4457     MOVE 0
  4458       TO DFHEIV11
  4459*    MOVE '&0S                   )   #00004141' TO DFHEIV0
  4460     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4461     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4462     MOVE X'2020233030303034313431' TO DFHEIV0(25:11)
  4463     CALL 'kxdfhei1' USING DFHEIV0,
  4464           ELCNTL-ID,
  4465           DFHEIV20,
  4466           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  87
* EL106.cbl
  4467           ELCNTL-KEY,
  4468           DFHEIV99,
  4469           DFHEIV11,
  4470           DFHEIV99,
  4471           DFHEIV99
  4472     SET ADDRESS OF CONTROL-FILE TO
  4473         DFHEIV20
  4474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4475
  4476
  4477     IF FIRST-TIME
  4478         MOVE 'N'                TO  WS-FIRST-TIME-SW
  4479         GO TO 5600-READ-PREV-STATE-RECORD.
  4480
  4481     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4482        CF-RECORD-TYPE NOT = '3'
  4483         GO TO 8860-ENDFILE.
  4484
  4485     IF STCDL = 0
  4486         MOVE ER-0146 TO EMI-ERROR
  4487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4488
  4489     GO TO 7000-BUILD-OUTPUT-MAP.
  4490
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  88
* EL106.cbl
  4492 6000-EDIT-INPUT-DATA.
  4493     IF STABRL = ZEROS AND MAINTI = 'A'
  4494        MOVE -1  TO STABRL
  4495        MOVE ER-0152 TO EMI-ERROR
  4496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4497
  4498     IF STNAMEL = ZEROS AND MAINTI = 'A'
  4499        MOVE -1   TO STNAMEL
  4500        MOVE ER-0153 TO EMI-ERROR
  4501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4502
  4503     IF LFEXPL NOT = ZEROS
  4504
  4505* EXEC CICS BIF
  4506*            DEEDIT
  4507*            FIELD (LFEXPI)
  4508*            LENGTH(7)
  4509*       END-EXEC
  4510     MOVE 7
  4511       TO DFHEIV11
  4512*    MOVE '@"L                   #   #00004174' TO DFHEIV0
  4513     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4514     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4515     MOVE X'2020233030303034313734' TO DFHEIV0(25:11)
  4516     CALL 'kxdfhei1' USING DFHEIV0,
  4517           LFEXPI,
  4518           DFHEIV11
  4519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4520      IF LFEXPI NUMERIC
  4521            MOVE AL-UNNON        TO LFEXPA
  4522            MOVE LFEXPI          TO WS-ST-LF-EXP-PCT
  4523        ELSE
  4524            MOVE ER-7531         TO EMI-ERROR
  4525            MOVE -1              TO LFEXPL
  4526            MOVE AL-UNBON        TO LFEXPA
  4527            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4528
  4529     IF AHEXPL NOT = ZEROS
  4530
  4531* EXEC CICS BIF
  4532*            DEEDIT
  4533*            FIELD (AHEXPI)
  4534*            LENGTH(7)
  4535*       END-EXEC
  4536     MOVE 7
  4537       TO DFHEIV11
  4538*    MOVE '@"L                   #   #00004189' TO DFHEIV0
  4539     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4540     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4541     MOVE X'2020233030303034313839' TO DFHEIV0(25:11)
  4542     CALL 'kxdfhei1' USING DFHEIV0,
  4543           AHEXPI,
  4544           DFHEIV11
  4545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4546      IF AHEXPI NUMERIC
  4547            MOVE AL-UNNON        TO AHEXPA
  4548            MOVE AHEXPI          TO WS-ST-AH-EXP-PCT
  4549        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  89
* EL106.cbl
  4550            MOVE ER-7531         TO EMI-ERROR
  4551            MOVE -1              TO AHEXPL
  4552            MOVE AL-UNBON        TO AHEXPA
  4553            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4554
  4555     IF QUOTCALL NOT = ZEROS
  4556
  4557* EXEC CICS BIF
  4558*            DEEDIT
  4559*            FIELD (QUOTCALI)
  4560*            LENGTH(6)
  4561*       END-EXEC
  4562     MOVE 6
  4563       TO DFHEIV11
  4564*    MOVE '@"L                   #   #00004204' TO DFHEIV0
  4565     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4566     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4567     MOVE X'2020233030303034323034' TO DFHEIV0(25:11)
  4568     CALL 'kxdfhei1' USING DFHEIV0,
  4569           QUOTCALI,
  4570           DFHEIV11
  4571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4572        IF QUOTCALI NOT NUMERIC
  4573           MOVE -1               TO QUOTCALL
  4574           MOVE AL-UNBON         TO QUOTCALA
  4575           MOVE ER-2009          TO EMI-ERROR
  4576           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4577        ELSE
  4578        IF QUOTCALI GREATER THAN 9999
  4579           MOVE -1               TO QUOTCALL
  4580           MOVE AL-UNBON         TO QUOTCALA
  4581           MOVE ER-2009          TO EMI-ERROR
  4582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4583
  4584     IF OVSAMTL NOT = ZEROS
  4585
  4586* EXEC CICS BIF
  4587*            DEEDIT
  4588*            FIELD (OVSAMTI)
  4589*            LENGTH(6)
  4590*       END-EXEC
  4591     MOVE 6
  4592       TO DFHEIV11
  4593*    MOVE '@"L                   #   #00004222' TO DFHEIV0
  4594     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4595     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4596     MOVE X'2020233030303034323232' TO DFHEIV0(25:11)
  4597     CALL 'kxdfhei1' USING DFHEIV0,
  4598           OVSAMTI,
  4599           DFHEIV11
  4600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4601        IF OVSAMTI  NOT NUMERIC
  4602           MOVE -1               TO OVSAMTL
  4603           MOVE AL-UNBON         TO OVSAMTA
  4604           MOVE ER-2010          TO EMI-ERROR
  4605           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4606        ELSE
  4607        IF OVSAMTI  GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  90
* EL106.cbl
  4608           MOVE -1               TO OVSAMTL
  4609           MOVE AL-UNBON         TO OVSAMTA
  4610           MOVE ER-2010          TO EMI-ERROR
  4611           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4612
  4613     IF PREMTOLL NOT = ZEROS
  4614
  4615* EXEC CICS BIF
  4616*            DEEDIT
  4617*            FIELD (PREMTOLI)
  4618*            LENGTH(6)
  4619*       END-EXEC
  4620     MOVE 6
  4621       TO DFHEIV11
  4622*    MOVE '@"L                   #   #00004240' TO DFHEIV0
  4623     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4624     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4625     MOVE X'2020233030303034323430' TO DFHEIV0(25:11)
  4626     CALL 'kxdfhei1' USING DFHEIV0,
  4627           PREMTOLI,
  4628           DFHEIV11
  4629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4630        IF PREMTOLI NOT NUMERIC
  4631           MOVE -1               TO PREMTOLL
  4632           MOVE AL-UNBON         TO PREMTOLA
  4633           MOVE ER-2010          TO EMI-ERROR
  4634           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4635        ELSE
  4636        IF PREMTOLI GREATER THAN 9999
  4637           MOVE -1               TO PREMTOLL
  4638           MOVE AL-UNBON         TO PREMTOLA
  4639           MOVE ER-2010          TO EMI-ERROR
  4640           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4641
  4642     IF REFTOLL NOT = ZEROS
  4643
  4644* EXEC CICS BIF
  4645*            DEEDIT
  4646*            FIELD(REFTOLI)
  4647*            LENGTH(6)
  4648*       END-EXEC
  4649     MOVE 6
  4650       TO DFHEIV11
  4651*    MOVE '@"L                   #   #00004258' TO DFHEIV0
  4652     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4653     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4654     MOVE X'2020233030303034323538' TO DFHEIV0(25:11)
  4655     CALL 'kxdfhei1' USING DFHEIV0,
  4656           REFTOLI,
  4657           DFHEIV11
  4658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4659        IF REFTOLI NOT NUMERIC
  4660           MOVE -1               TO REFTOLL
  4661           MOVE AL-UNBON         TO REFTOLA
  4662           MOVE ER-2014          TO EMI-ERROR
  4663           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4664        ELSE
  4665        IF REFTOLI GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  91
* EL106.cbl
  4666           MOVE -1               TO REFTOLL
  4667           MOVE AL-UNBON         TO REFTOLA
  4668           MOVE ER-2014          TO EMI-ERROR
  4669           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4670
  4671     IF CLREJECL NOT = ZEROS
  4672        IF CLREJECI = SPACES OR '1'
  4673           NEXT SENTENCE
  4674          ELSE
  4675           MOVE -1               TO CLREJECL
  4676           MOVE AL-UABON         TO CLREJECA
  4677           MOVE ER-2024          TO EMI-ERROR
  4678           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4679
  4680     IF ISSREJL NOT = ZEROS
  4681        IF ISSREJI = SPACES OR '1'
  4682           NEXT SENTENCE
  4683          ELSE
  4684           MOVE -1               TO ISSREJL
  4685           MOVE AL-UABON         TO ISSREJA
  4686           MOVE ER-2012          TO EMI-ERROR
  4687           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4688
  4689     IF REFREJL NOT = ZEROS
  4690        IF REFREJI = SPACES OR '1'
  4691           NEXT SENTENCE
  4692          ELSE
  4693           MOVE -1               TO REFREJL
  4694           MOVE AL-UABON         TO REFREJA
  4695           MOVE ER-2028          TO EMI-ERROR
  4696           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4697
  4698     IF REFMINL NOT = ZEROS
  4699
  4700* EXEC CICS BIF
  4701*            DEEDIT
  4702*            FIELD (REFMINI)
  4703*            LENGTH(6)
  4704*       END-EXEC
  4705     MOVE 6
  4706       TO DFHEIV11
  4707*    MOVE '@"L                   #   #00004303' TO DFHEIV0
  4708     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4709     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4710     MOVE X'2020233030303034333033' TO DFHEIV0(25:11)
  4711     CALL 'kxdfhei1' USING DFHEIV0,
  4712           REFMINI,
  4713           DFHEIV11
  4714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4715        IF REFMINI NOT NUMERIC
  4716           MOVE -1               TO REFMINL
  4717           MOVE AL-UNBON         TO REFMINA
  4718           MOVE ER-3030          TO EMI-ERROR
  4719           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4720
  4721     IF REFDAY1L NOT = ZERO
  4722        IF REFDAY1I LESS '00' OR GREATER '31'
  4723            MOVE -1               TO REFDAY1L
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  92
* EL106.cbl
  4724            MOVE AL-UNBON         TO REFDAY1A
  4725            MOVE ER-3031          TO EMI-ERROR
  4726            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4727
  4728     IF REFDAYSL NOT = ZERO
  4729        IF REFDAYSI LESS '00' OR GREATER '31'
  4730            MOVE -1               TO REFDAYSL
  4731            MOVE AL-UNBON         TO REFDAYSA
  4732            MOVE ER-3031          TO EMI-ERROR
  4733            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4734
  4735     IF SPLPMTL NOT = ZERO
  4736        IF (SPLPMTI IS EQUAL TO 'Y' OR 'N' OR ' ')
  4737            NEXT SENTENCE
  4738        ELSE
  4739            MOVE -1               TO SPLPMTL
  4740            MOVE AL-UABON         TO SPLPMTA
  4741            MOVE ER-0805          TO EMI-ERROR
  4742            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4743
  4744     IF EXTDAYSL NOT = ZERO
  4745        IF EXTDAYSI NOT NUMERIC
  4746            MOVE -1               TO EXTDAYSL
  4747            MOVE AL-UNBON         TO EXTDAYSA
  4748            MOVE ER-3032          TO EMI-ERROR
  4749            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4750
  4751*    IF INTDAYSL NOT = ZERO
  4752*       IF INTDAYSI NOT NUMERIC
  4753*           MOVE -1               TO INTDAYSL
  4754*           MOVE AL-UNBON         TO INTDAYSA
  4755*           MOVE ER-0141          TO EMI-ERROR
  4756*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4757
  4758     IF EXTCHGL NOT = ZEROS
  4759        IF EXTCHGI = SPACES OR '1' OR '2' OR '3'
  4760           NEXT SENTENCE
  4761          ELSE
  4762           MOVE -1               TO EXTCHGL
  4763           MOVE AL-UABON         TO EXTCHGA
  4764           MOVE ER-3033          TO EMI-ERROR
  4765           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4766
  4767     IF REMTERML NOT = ZEROS
  4768        IF (REMTERMI = ' ') OR
  4769           (REMTERMI > '0' AND < '8')
  4770           CONTINUE
  4771        ELSE
  4772           MOVE -1               TO REMTERML
  4773           MOVE AL-UABON         TO REMTERMA
  4774           MOVE ER-2298          TO EMI-ERROR
  4775           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4776        END-IF
  4777     END-IF
  4778
  4779     IF LFREDL NOT = ZEROS
  4780        IF LFREDI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4781                 OR '6' OR '8' OR '9'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  93
* EL106.cbl
  4782           CONTINUE
  4783        ELSE
  4784           MOVE -1               TO LFREDL
  4785           MOVE AL-UABON         TO LFREDA
  4786           MOVE ER-0582          TO EMI-ERROR
  4787           PERFORM 9900-ERROR-FORMAT
  4788                                 THRU 9900-EXIT
  4789        END-IF
  4790     END-IF
  4791
  4792     IF LFLEVL NOT = ZEROS
  4793        IF LFLEVI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4794                 OR '6' OR '8' OR '9'
  4795           CONTINUE
  4796        ELSE
  4797           MOVE -1               TO LFLEVL
  4798           MOVE AL-UABON         TO LFLEVA
  4799           MOVE ER-0582          TO EMI-ERROR
  4800           PERFORM 9900-ERROR-FORMAT
  4801                                 THRU 9900-EXIT
  4802        END-IF
  4803     END-IF
  4804
  4805     IF LFNETL NOT = ZEROS
  4806        IF LFNETI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4807                 OR '6' OR '8' OR '9'
  4808           CONTINUE
  4809        ELSE
  4810           MOVE -1               TO LFNETL
  4811           MOVE AL-UABON         TO LFNETA
  4812           MOVE ER-0582          TO EMI-ERROR
  4813           PERFORM 9900-ERROR-FORMAT
  4814                                 THRU 9900-EXIT
  4815        END-IF
  4816     END-IF
  4817
  4818     IF AHAHL  NOT = ZEROS
  4819        IF AHAHI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4820                 OR '6' OR '8' OR '9'
  4821           CONTINUE
  4822        ELSE
  4823           MOVE -1               TO AHAHL
  4824           MOVE AL-UABON         TO AHAHA
  4825           MOVE ER-0582          TO EMI-ERROR
  4826           PERFORM 9900-ERROR-FORMAT
  4827                                 THRU 9900-EXIT
  4828        END-IF
  4829     END-IF
  4830
  4831     IF AHCPL  NOT = ZEROS
  4832        IF AHCPI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4833                 OR '6' OR '8' OR '9'
  4834           CONTINUE
  4835        ELSE
  4836           MOVE -1               TO AHCPL
  4837           MOVE AL-UABON         TO AHCPA
  4838           MOVE ER-0582          TO EMI-ERROR
  4839           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  94
* EL106.cbl
  4840                                 THRU 9900-EXIT
  4841        END-IF
  4842     END-IF
  4843
  4844     IF STUEL NOT = ZEROS
  4845        IF STUEI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4846           NEXT SENTENCE
  4847          ELSE
  4848           MOVE -1               TO STUEL
  4849           MOVE AL-UABON         TO STUEA
  4850           MOVE ER-3034          TO EMI-ERROR
  4851           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4852
  4853     IF STCNTLL NOT = ZEROS
  4854        IF STCNTLI = SPACES
  4855           NEXT SENTENCE
  4856        ELSE
  4857           IF STCNTLI = '1' OR '2' OR '3' OR '4' OR
  4858                        '5' OR '6' OR '7' OR '8' OR
  4859                        '9' OR 'A' OR 'B' OR 'X'
  4860              NEXT SENTENCE
  4861           ELSE
  4862              MOVE -1               TO STCNTLL
  4863              MOVE AL-UABON         TO STCNTLA
  4864              MOVE ER-3035          TO EMI-ERROR
  4865              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4866
  4867     IF  REPLAWL GREATER THAN ZEROS
  4868         IF  REPLAWI = 'Y'
  4869             MOVE REPLAWI        TO REPLAWO
  4870             MOVE AL-UANON       TO REPLAWA
  4871         ELSE
  4872             IF  REPLAWI = 'N' OR SPACES OR LOW-VALUES
  4873                 MOVE 'N'        TO REPLAWO
  4874                 MOVE AL-UANON   TO REPLAWA
  4875             ELSE
  4876                 MOVE ER-9074    TO EMI-ERROR
  4877                 MOVE -1         TO REPLAWL
  4878                 MOVE AL-UABON   TO REPLAWA
  4879                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4880
  4881     IF  REPLETRL GREATER THAN +0
  4882         IF  REPLAWI = 'Y'
  4883             IF  REPLETRI GREATER THAN SPACES
  4884                 MOVE SPACES     TO W-WORKING-TEXT-KEY
  4885                 MOVE PI-COMPANY-CD
  4886                                 TO W-TEXT-COMPANY-CD
  4887                 MOVE REPLETRI   TO W-TEXT-FORM-NO
  4888                 MOVE +1         TO W-TEXT-LINE-SEQ
  4889
  4890* EXEC CICS HANDLE CONDITION
  4891*                    NOTFND   (6010-LETR-NOT-FOUND)
  4892*                    ENDFILE  (6010-LETR-NOT-FOUND)
  4893*                    NOTOPEN  (8890-LETR-NOT-OPEN)
  4894*                END-EXEC
  4895*    MOVE '"$I''J                 ! '' #00004482' TO DFHEIV0
  4896     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  4897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  95
* EL106.cbl
  4898     MOVE X'2720233030303034343832' TO DFHEIV0(25:11)
  4899     CALL 'kxdfhei1' USING DFHEIV0
  4900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4901
  4902* EXEC CICS READ
  4903*                    SET     (ADDRESS OF TEXT-FILES)
  4904*                    DATASET (ELLETR-ID)
  4905*                    RIDFLD  (W-WORKING-TEXT-KEY)
  4906*                END-EXEC
  4907*    MOVE '&"S        E          (   #00004487' TO DFHEIV0
  4908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4910     MOVE X'2020233030303034343837' TO DFHEIV0(25:11)
  4911     CALL 'kxdfhei1' USING DFHEIV0,
  4912           ELLETR-ID,
  4913           DFHEIV20,
  4914           DFHEIV99,
  4915           W-WORKING-TEXT-KEY,
  4916           DFHEIV99,
  4917           DFHEIV99,
  4918           DFHEIV99
  4919     SET ADDRESS OF TEXT-FILES TO
  4920         DFHEIV20
  4921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4922                 MOVE AL-UANON   TO REPLETRA
  4923             ELSE
  4924                 MOVE ER-9448    TO EMI-ERROR
  4925                 MOVE -1         TO REPLETRL
  4926                 MOVE AL-UABON   TO REPLETRA
  4927                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4928         ELSE
  4929             IF  REPLETRI EQUAL SPACES OR LOW-VALUES
  4930                 MOVE LOW-VALUES TO REPLETRO
  4931                 MOVE AL-UANON   TO REPLETRA
  4932             ELSE
  4933                 MOVE ER-9478    TO EMI-ERROR
  4934                 MOVE -1         TO REPLAWL
  4935                 MOVE AL-UABON   TO REPLAWA
  4936                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4937     ELSE
  4938         IF  REPLAWI = 'Y'
  4939             MOVE ER-9448        TO EMI-ERROR
  4940             MOVE -1             TO REPLETRL
  4941             MOVE AL-UABON       TO REPLETRA
  4942             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4943
  4944     IF LIMITL GREATER ZEROS
  4945         IF LIMITI = 'A'
  4946             MOVE LIMITI         TO LIMITO
  4947             MOVE AL-UANON       TO LIMITA
  4948          ELSE
  4949             IF LIMITI = SPACES OR LOW-VALUES
  4950                 MOVE ' '        TO LIMITO
  4951                 MOVE AL-UANON   TO LIMITA
  4952         ELSE
  4953             MOVE ER-2137    TO EMI-ERROR
  4954             MOVE -1         TO LIMITL
  4955             MOVE AL-UABON   TO LIMITA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  96
* EL106.cbl
  4956             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4957
  4958*    IF STATIL GREATER ZEROS
  4959*        IF STATII = 'I' OR 'R'
  4960*            MOVE STATII         TO STATIO
  4961*            MOVE AL-UANON       TO STATIA
  4962*         ELSE
  4963*            IF STATII = SPACES OR LOW-VALUES
  4964*                MOVE ' '        TO STATIO
  4965*                MOVE AL-UANON   TO STATIA
  4966*        ELSE
  4967*            MOVE ER-7346    TO EMI-ERROR
  4968*            MOVE -1         TO STATIL
  4969*            MOVE AL-UABON   TO STATIA
  4970*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4971
  4972     IF COMSLL GREATER ZEROS
  4973
  4974* EXEC CICS BIF
  4975*            DEEDIT
  4976*            FIELD (COMSLI)
  4977*            LENGTH(6)
  4978*       END-EXEC
  4979     MOVE 6
  4980       TO DFHEIV11
  4981*    MOVE '@"L                   #   #00004543' TO DFHEIV0
  4982     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4983     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4984     MOVE X'2020233030303034353433' TO DFHEIV0(25:11)
  4985     CALL 'kxdfhei1' USING DFHEIV0,
  4986           COMSLI,
  4987           DFHEIV11
  4988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4989      IF COMSLI NUMERIC
  4990            MOVE AL-UNNON        TO COMSLA
  4991            MOVE COMSLI          TO WS-COMSL
  4992                                    COMSLO
  4993        ELSE
  4994            MOVE ER-1614         TO EMI-ERROR
  4995            MOVE -1              TO COMSLL
  4996            MOVE AL-UNBON        TO COMSLA
  4997            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4998
  4999     IF COMJLL GREATER ZEROS
  5000
  5001* EXEC CICS BIF
  5002*            DEEDIT
  5003*            FIELD (COMJLI)
  5004*            LENGTH(6)
  5005*       END-EXEC
  5006     MOVE 6
  5007       TO DFHEIV11
  5008*    MOVE '@"L                   #   #00004559' TO DFHEIV0
  5009     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5010     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5011     MOVE X'2020233030303034353539' TO DFHEIV0(25:11)
  5012     CALL 'kxdfhei1' USING DFHEIV0,
  5013           COMJLI,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  97
* EL106.cbl
  5014           DFHEIV11
  5015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5016      IF COMJLI NUMERIC
  5017            MOVE AL-UNNON        TO COMJLA
  5018            MOVE COMJLI          TO WS-COMJL
  5019                                    COMJLO
  5020        ELSE
  5021            MOVE ER-1614         TO EMI-ERROR
  5022            MOVE -1              TO COMJLL
  5023            MOVE AL-UNBON        TO COMJLA
  5024            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5025
  5026     IF COMSAL GREATER ZEROS
  5027
  5028* EXEC CICS BIF
  5029*            DEEDIT
  5030*            FIELD (COMSAI)
  5031*            LENGTH(6)
  5032*       END-EXEC
  5033     MOVE 6
  5034       TO DFHEIV11
  5035*    MOVE '@"L                   #   #00004575' TO DFHEIV0
  5036     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5037     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5038     MOVE X'2020233030303034353735' TO DFHEIV0(25:11)
  5039     CALL 'kxdfhei1' USING DFHEIV0,
  5040           COMSAI,
  5041           DFHEIV11
  5042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5043      IF COMSAI NUMERIC
  5044            MOVE AL-UNNON        TO COMSAA
  5045            MOVE COMSAI          TO WS-COMSA
  5046                                    COMSAO
  5047        ELSE
  5048            MOVE ER-1614         TO EMI-ERROR
  5049            MOVE -1              TO COMSAL
  5050            MOVE AL-UNBON        TO COMSAA
  5051            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5052
  5053     IF COMJAL GREATER ZEROS
  5054
  5055* EXEC CICS BIF
  5056*            DEEDIT
  5057*            FIELD (COMJAI)
  5058*            LENGTH(6)
  5059*       END-EXEC
  5060     MOVE 6
  5061       TO DFHEIV11
  5062*    MOVE '@"L                   #   #00004591' TO DFHEIV0
  5063     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5064     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5065     MOVE X'2020233030303034353931' TO DFHEIV0(25:11)
  5066     CALL 'kxdfhei1' USING DFHEIV0,
  5067           COMJAI,
  5068           DFHEIV11
  5069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5070      IF COMJAI NUMERIC
  5071            MOVE AL-UNNON        TO COMJAA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  98
* EL106.cbl
  5072            MOVE COMJAI          TO WS-COMJA
  5073                                    COMJAO
  5074        ELSE
  5075            MOVE ER-1614         TO EMI-ERROR
  5076            MOVE -1              TO COMJAL
  5077            MOVE AL-UNBON        TO COMJAA
  5078            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5079
  5080     IF RESTAXL GREATER ZEROS
  5081
  5082* EXEC CICS BIF
  5083*            DEEDIT
  5084*            FIELD (RESTAXI)
  5085*            LENGTH(6)
  5086*       END-EXEC
  5087     MOVE 6
  5088       TO DFHEIV11
  5089*    MOVE '@"L                   #   #00004607' TO DFHEIV0
  5090     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5091     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5092     MOVE X'2020233030303034363037' TO DFHEIV0(25:11)
  5093     CALL 'kxdfhei1' USING DFHEIV0,
  5094           RESTAXI,
  5095           DFHEIV11
  5096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5097      IF RESTAXI NUMERIC
  5098            MOVE AL-UNNON        TO RESTAXA
  5099            MOVE RESTAXI         TO WS-RESIDENT-TAX
  5100                                    RESTAXO
  5101        ELSE
  5102            MOVE ER-1614         TO EMI-ERROR
  5103            MOVE -1              TO RESTAXL
  5104            MOVE AL-UNBON        TO RESTAXA
  5105            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5106
  5107     IF FREELKI  NUMERIC
  5108            MOVE AL-UNNON        TO FREELKA
  5109            MOVE FREELKI         TO WS-FREE-LOOK-DAYS
  5110                                    FREELKO
  5111        ELSE
  5112            MOVE -1               TO FREELKL
  5113            MOVE AL-UNBON         TO FREELKA
  5114            MOVE ER-8159          TO EMI-ERROR
  5115            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5116
  5117*    IF STATRL GREATER ZEROS
  5118*       EXEC CICS BIF
  5119*            DEEDIT
  5120*            FIELD (STATRI)
  5121*            LENGTH(6)
  5122*       END-EXEC
  5123*     IF STATRI NUMERIC
  5124*           MOVE AL-UNNON        TO STATRA
  5125*           MOVE STATRI          TO WS-IRATE
  5126*                                   STATRO
  5127*       ELSE
  5128*           MOVE ER-1614         TO EMI-ERROR
  5129*           MOVE -1              TO STATRL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  99
* EL106.cbl
  5130*           MOVE AL-UNBON        TO STATRA
  5131*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5132
  5133*    IF STATR1L GREATER ZEROS
  5134*       EXEC CICS BIF
  5135*            DEEDIT
  5136*            FIELD (STATR1I)
  5137*            LENGTH(6)
  5138*       END-EXEC
  5139*     IF STATR1I NUMERIC
  5140*           MOVE AL-UNNON        TO STATR1A
  5141*           MOVE STATR1I         TO WS-IRATE1
  5142*                                   STATR1O
  5143*       ELSE
  5144*           MOVE ER-1614         TO EMI-ERROR
  5145*           MOVE -1              TO STATR1L
  5146*           MOVE AL-UNBON        TO STATR1A
  5147*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5148*
  5149*    IF STATR2L GREATER ZEROS
  5150*       EXEC CICS BIF
  5151*            DEEDIT
  5152*            FIELD (STATR2I)
  5153*            LENGTH(6)
  5154*       END-EXEC
  5155*     IF STATR2I NUMERIC
  5156*           MOVE AL-UNNON        TO STATR2A
  5157*           MOVE STATR2I         TO WS-IRATE2
  5158*                                   STATR2O
  5159*       ELSE
  5160*           MOVE ER-1614         TO EMI-ERROR
  5161*           MOVE -1              TO STATR2L
  5162*           MOVE AL-UNBON        TO STATR2A
  5163*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5164*
  5165*    IF STATR3L GREATER ZEROS
  5166*       EXEC CICS BIF
  5167*            DEEDIT
  5168*            FIELD (STATR3I)
  5169*            LENGTH(6)
  5170*       END-EXEC
  5171*     IF STATR3I NUMERIC
  5172*           MOVE AL-UNNON        TO STATR3A
  5173*           MOVE STATR3I         TO WS-IRATE3
  5174*                                   STATR3O
  5175*       ELSE
  5176*           MOVE ER-1614         TO EMI-ERROR
  5177*           MOVE -1              TO STATR3L
  5178*           MOVE AL-UNBON        TO STATR3A
  5179*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5180
  5181     GO TO 6020-CONTINUE.
  5182
  5183 6010-LETR-NOT-FOUND.
  5184     MOVE ER-9447                TO EMI-ERROR.
  5185     MOVE -1                     TO REPLETRL.
  5186     MOVE AL-UABON               TO REPLETRA.
  5187     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 100
* EL106.cbl
  5188
  5189 6020-CONTINUE.
  5190
  5191     IF  TARRATL NOT = ZEROS
  5192
  5193* EXEC CICS BIF
  5194*             DEEDIT
  5195*             FIELD (TARRATI)
  5196*             LENGTH (6)
  5197*        END-EXEC
  5198     MOVE 6
  5199       TO DFHEIV11
  5200*    MOVE '@"L                   #   #00004707' TO DFHEIV0
  5201     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5202     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5203     MOVE X'2020233030303034373037' TO DFHEIV0(25:11)
  5204     CALL 'kxdfhei1' USING DFHEIV0,
  5205           TARRATI,
  5206           DFHEIV11
  5207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5208
  5209         IF  TARRATI NUMERIC
  5210             MOVE AL-UNNON       TO TARRATA
  5211             MOVE TARRATI        TO WS-ST-TARGET-LOSS-RATIO
  5212                                    TARRATO
  5213         ELSE
  5214             MOVE ER-7717        TO EMI-ERROR
  5215             MOVE -1             TO TARRATL
  5216             MOVE AL-UNBON       TO TARRATA
  5217             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5218
  5219     IF  CALCINTL NOT = ZEROS
  5220
  5221* EXEC CICS BIF
  5222*             DEEDIT
  5223*             FIELD (CALCINTI)
  5224*             LENGTH (6)
  5225*        END-EXEC
  5226     MOVE 6
  5227       TO DFHEIV11
  5228*    MOVE '@"L                   #   #00004724' TO DFHEIV0
  5229     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5230     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5231     MOVE X'2020233030303034373234' TO DFHEIV0(25:11)
  5232     CALL 'kxdfhei1' USING DFHEIV0,
  5233           CALCINTI,
  5234           DFHEIV11
  5235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5236
  5237         IF  CALCINTI NUMERIC
  5238             MOVE AL-UNNON       TO CALCINTA
  5239             MOVE CALCINTI       TO WS-ST-CALC-INTEREST
  5240                                    CALCINTO
  5241         ELSE
  5242             MOVE ER-7735        TO EMI-ERROR
  5243             MOVE -1             TO CALCINTL
  5244             MOVE AL-UNBON       TO CALCINTA
  5245             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 101
* EL106.cbl
  5246
  5247     IF PRMPCTL NOT = ZEROS
  5248
  5249* EXEC CICS BIF
  5250*            DEEDIT
  5251*            FIELD (PRMPCTI)
  5252*            LENGTH(5)
  5253*       END-EXEC
  5254     MOVE 5
  5255       TO DFHEIV11
  5256*    MOVE '@"L                   #   #00004741' TO DFHEIV0
  5257     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5258     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5259     MOVE X'2020233030303034373431' TO DFHEIV0(25:11)
  5260     CALL 'kxdfhei1' USING DFHEIV0,
  5261           PRMPCTI,
  5262           DFHEIV11
  5263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5264      IF PRMPCTI NUMERIC
  5265            MOVE AL-UNNON        TO PRMPCTA
  5266            MOVE PRMPCTI         TO WS-ST-TOL-PREM-PCT
  5267        ELSE
  5268            MOVE ER-7532         TO EMI-ERROR
  5269            MOVE -1              TO PRMPCTL
  5270            MOVE AL-UNBON        TO PRMPCTA
  5271            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5272
  5273     IF OVSPCTL NOT = ZEROS
  5274
  5275* EXEC CICS BIF
  5276*            DEEDIT
  5277*            FIELD (OVSPCTI)
  5278*            LENGTH(5)
  5279*       END-EXEC
  5280     MOVE 5
  5281       TO DFHEIV11
  5282*    MOVE '@"L                   #   #00004756' TO DFHEIV0
  5283     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5284     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5285     MOVE X'2020233030303034373536' TO DFHEIV0(25:11)
  5286     CALL 'kxdfhei1' USING DFHEIV0,
  5287           OVSPCTI,
  5288           DFHEIV11
  5289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5290      IF OVSPCTI NUMERIC
  5291            MOVE AL-UNNON        TO OVSPCTA
  5292            MOVE OVSPCTI         TO WS-ST-OVR-SHT-PCT
  5293        ELSE
  5294            MOVE ER-7532         TO EMI-ERROR
  5295            MOVE -1              TO OVSPCTL
  5296            MOVE AL-UNBON        TO OVSPCTA
  5297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5298
  5299     IF REFPCTL NOT = ZEROS
  5300
  5301* EXEC CICS BIF
  5302*            DEEDIT
  5303*            FIELD (REFPCTI)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 102
* EL106.cbl
  5304*            LENGTH(5)
  5305*       END-EXEC
  5306     MOVE 5
  5307       TO DFHEIV11
  5308*    MOVE '@"L                   #   #00004771' TO DFHEIV0
  5309     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5311     MOVE X'2020233030303034373731' TO DFHEIV0(25:11)
  5312     CALL 'kxdfhei1' USING DFHEIV0,
  5313           REFPCTI,
  5314           DFHEIV11
  5315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5316      IF REFPCTI NUMERIC
  5317            MOVE AL-UNNON        TO REFPCTA
  5318            MOVE REFPCTI         TO WS-ST-TOL-REF-PCT
  5319        ELSE
  5320            MOVE ER-7532         TO EMI-ERROR
  5321            MOVE -1              TO REFPCTL
  5322            MOVE AL-UNBON        TO REFPCTA
  5323            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5324
  5325     IF LFTAXL NOT = ZEROS
  5326
  5327* EXEC CICS BIF
  5328*            DEEDIT
  5329*            FIELD (LFTAXI)
  5330*            LENGTH(5)
  5331*       END-EXEC
  5332     MOVE 5
  5333       TO DFHEIV11
  5334*    MOVE '@"L                   #   #00004786' TO DFHEIV0
  5335     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5336     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5337     MOVE X'2020233030303034373836' TO DFHEIV0(25:11)
  5338     CALL 'kxdfhei1' USING DFHEIV0,
  5339           LFTAXI,
  5340           DFHEIV11
  5341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5342        IF LFTAXI NUMERIC
  5343           MOVE AL-UNNON         TO LFTAXA
  5344           MOVE LFTAXI           TO WS-ST-LF-PREM-TAX
  5345        ELSE
  5346           MOVE ER-2082          TO EMI-ERROR
  5347           MOVE -1               TO LFTAXL
  5348           MOVE AL-UNBON         TO LFTAXA
  5349           PERFORM 9900-ERROR-FORMAT
  5350                                 THRU 9900-EXIT
  5351        END-IF
  5352     END-IF
  5353
  5354     IF AHITAXL NOT = ZEROS
  5355
  5356* EXEC CICS BIF
  5357*            DEEDIT
  5358*            FIELD (AHITAXI)
  5359*            LENGTH(5)
  5360*       END-EXEC
  5361     MOVE 5
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 103
* EL106.cbl
  5362       TO DFHEIV11
  5363*    MOVE '@"L                   #   #00004804' TO DFHEIV0
  5364     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5365     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5366     MOVE X'2020233030303034383034' TO DFHEIV0(25:11)
  5367     CALL 'kxdfhei1' USING DFHEIV0,
  5368           AHITAXI,
  5369           DFHEIV11
  5370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5371        IF AHITAXI NUMERIC
  5372           MOVE AL-UNNON         TO AHITAXA
  5373           MOVE AHITAXI          TO WS-ST-AH-PREM-TAX-I
  5374        ELSE
  5375           MOVE ER-2084          TO EMI-ERROR
  5376           MOVE -1               TO AHITAXL
  5377           MOVE AL-UNBON         TO AHITAXA
  5378           PERFORM 9900-ERROR-FORMAT
  5379                                 THRU 9900-EXIT
  5380        END-IF
  5381     END-IF
  5382
  5383     IF AHGTAXL NOT = ZEROS
  5384
  5385* EXEC CICS BIF
  5386*            DEEDIT
  5387*            FIELD (AHGTAXI)
  5388*            LENGTH(5)
  5389*       END-EXEC
  5390     MOVE 5
  5391       TO DFHEIV11
  5392*    MOVE '@"L                   #   #00004822' TO DFHEIV0
  5393     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5394     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5395     MOVE X'2020233030303034383232' TO DFHEIV0(25:11)
  5396     CALL 'kxdfhei1' USING DFHEIV0,
  5397           AHGTAXI,
  5398           DFHEIV11
  5399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5400        IF AHGTAXI NUMERIC
  5401           MOVE AL-UNNON         TO AHGTAXA
  5402           MOVE AHGTAXI          TO WS-ST-AH-PREM-TAX-G
  5403        ELSE
  5404           MOVE ER-2084          TO EMI-ERROR
  5405           MOVE -1               TO AHGTAXL
  5406           MOVE AL-UNBON         TO AHGTAXA
  5407           PERFORM 9900-ERROR-FORMAT
  5408                                 THRU 9900-EXIT
  5409        END-IF
  5410     END-IF
  5411
  5412     IF REFCLML NOT = ZEROS
  5413        IF REFCLMI = SPACES OR '1' OR '2' OR '3'
  5414           NEXT SENTENCE
  5415        ELSE
  5416           MOVE -1               TO REFCLML
  5417           MOVE AL-UABON         TO REFCLMA
  5418           MOVE ER-3036          TO EMI-ERROR
  5419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 104
* EL106.cbl
  5420        END-IF
  5421     END-IF.
  5422
  5423     .
  5424 6099-EXIT.
  5425     EXIT.
  5426
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 105
* EL106.cbl
  5428 6100-INITIALIZE-BENEFIT-CNTL.
  5429
  5430     MOVE SPACES   TO   CF-ST-BENEFIT-CD         (SUB)
  5431                        CF-ST-BENEFIT-KIND       (SUB)
  5432                        CF-ST-REM-TERM-CALC      (SUB)
  5433                        CF-ST-REFUND-CALC        (SUB)
  5434                        CF-ST-EARNING-CALC       (SUB)
  5435                        CF-ST-OVRD-EARNINGS-CALC (SUB).
  5436
  5437 6199-EXIT.
  5438     EXIT.
  5439
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 106
* EL106.cbl
  5441 6400-CREATE-TEMP-STORAGE.
  5442     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5443
  5444
  5445* EXEC CICS WRITEQ TS
  5446*        QUEUE   (QID)
  5447*        FROM    (EL106AO)
  5448*        LENGTH  (WS-MAP-LENGTH)
  5449*    END-EXEC.
  5450*    MOVE '*"                    ''   #00004871' TO DFHEIV0
  5451     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5452     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5453     MOVE X'2020233030303034383731' TO DFHEIV0(25:11)
  5454     CALL 'kxdfhei1' USING DFHEIV0,
  5455           QID,
  5456           EL106AO,
  5457           WS-MAP-LENGTH,
  5458           DFHEIV99,
  5459           DFHEIV99,
  5460           DFHEIV99
  5461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5462
  5463
  5464 6400-EXIT.
  5465      EXIT.
  5466
  5467 6500-RECOVER-TEMP-STORAGE.
  5468
  5469* EXEC CICS READQ TS
  5470*        QUEUE   (QID)
  5471*        INTO    (EL106AO)
  5472*        LENGTH  (WS-MAP-LENGTH)
  5473*    END-EXEC.
  5474*    MOVE '*$I    L              ''   #00004881' TO DFHEIV0
  5475     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5476     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5477     MOVE X'2020233030303034383831' TO DFHEIV0(25:11)
  5478     CALL 'kxdfhei1' USING DFHEIV0,
  5479           QID,
  5480           EL106AO,
  5481           WS-MAP-LENGTH,
  5482           DFHEIV99,
  5483           DFHEIV99,
  5484           DFHEIV99
  5485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5486
  5487
  5488     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5489
  5490 6500-EXIT.
  5491      EXIT.
  5492
  5493 6600-DELETE-TEMP-STORAGE.
  5494
  5495* EXEC CICS HANDLE CONDITION
  5496*        QIDERR  (6600-EXIT)
  5497*    END-EXEC.
  5498*    MOVE '"$N                   ! ( #00004893' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 107
* EL106.cbl
  5499     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5501     MOVE X'2820233030303034383933' TO DFHEIV0(25:11)
  5502     CALL 'kxdfhei1' USING DFHEIV0
  5503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5504
  5505
  5506
  5507* EXEC CICS DELETEQ TS
  5508*        QUEUE  (QID)
  5509*    END-EXEC.
  5510*    MOVE '*&                    #   #00004897' TO DFHEIV0
  5511     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5512     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5513     MOVE X'2020233030303034383937' TO DFHEIV0(25:11)
  5514     CALL 'kxdfhei1' USING DFHEIV0,
  5515           QID,
  5516           DFHEIV99
  5517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5518
  5519
  5520 6600-EXIT.
  5521      EXIT.
  5522
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 108
* EL106.cbl
  5524***************************************************************
  5525*                                                             *
  5526*     BUILD THE OUTPUT SCREEN TO BE DISPLAYED                 *
  5527*                                                             *
  5528***************************************************************
  5529 7000-BUILD-OUTPUT-MAP.
  5530     MOVE LOW-VALUES            TO EL106AO.
  5531     MOVE CF-STATE-CODE         TO STCDO
  5532                                   PI-WS-STATE.
  5533     MOVE CF-ST-TOL-CLAIM       TO QUOTCALO.
  5534     MOVE CF-ST-TOL-PREM        TO PREMTOLO.
  5535     MOVE CF-ST-TOL-REFUND      TO REFTOLO.
  5536     MOVE CF-ST-CLAIM-REJECT-SW TO CLREJECO.
  5537     MOVE CF-ST-PREM-REJECT-SW  TO ISSREJO.
  5538     MOVE CF-ST-REF-REJECT-SW   TO REFREJO.
  5539     MOVE CF-ST-FST-PMT-DAYS-CHG
  5540                                TO EXTCHGO.
  5541     MOVE CF-ST-RT-CALC         TO REMTERMO
  5542     MOVE CF-ST-RF-LR-CALC      TO LFREDO
  5543     MOVE CF-ST-RF-LL-CALC      TO LFLEVO
  5544     MOVE CF-ST-RF-LN-CALC      TO LFNETO
  5545     MOVE CF-ST-RF-AH-CALC      TO AHAHO
  5546     MOVE CF-ST-RF-CP-CALC      TO AHCPO
  5547     MOVE CF-ST-CALL-UNEARNED   TO STUEO.
  5548     MOVE CF-ST-CALL-RPT-CNTL   TO STCNTLO.
  5549     MOVE CF-ST-CALL-RATE-DEV   TO STDEVO.
  5550     MOVE CF-STATE-ABBREVIATION TO STABRO.
  5551     MOVE CF-STATE-NAME         TO STNAMEO.
  5552     MOVE CF-ST-REF-AH-DEATH-IND TO REFCLMO.
  5553     IF  CF-ST-CHECK-COUNTER NUMERIC
  5554        MOVE CF-ST-CHECK-COUNTER TO STCHKNOO
  5555     ELSE
  5556        MOVE ZEROS             TO STCHKNOO
  5557     END-IF.
  5558
  5559     IF CF-ST-LF-EXP-PCT      NUMERIC
  5560         IF CF-ST-LF-EXP-PCT NOT = ZEROS
  5561             MOVE CF-ST-LF-EXP-PCT  TO LFEXPO.
  5562
  5563     IF CF-ST-AH-EXP-PCT      NUMERIC
  5564         IF CF-ST-AH-EXP-PCT NOT = ZEROS
  5565             MOVE CF-ST-AH-EXP-PCT  TO AHEXPO.
  5566
  5567     IF CF-ST-TOL-PREM-PCT    NUMERIC
  5568         IF CF-ST-TOL-PREM-PCT NOT = ZEROS
  5569             MOVE CF-ST-TOL-PREM-PCT TO PRMPCTO.
  5570
  5571     IF CF-ST-OVR-SHT-AMT NUMERIC
  5572        IF CF-ST-OVR-SHT-AMT > ZEROS
  5573           MOVE CF-ST-OVR-SHT-AMT TO OVSAMTO
  5574        END-IF
  5575     END-IF.
  5576
  5577     IF CF-ST-OVR-SHT-PCT NUMERIC
  5578         IF CF-ST-OVR-SHT-PCT > ZEROS
  5579             MOVE CF-ST-OVR-SHT-PCT TO OVSPCTO
  5580         END-IF
  5581     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 109
* EL106.cbl
  5582
  5583     IF CF-ST-TOL-REF-PCT     NUMERIC
  5584         IF CF-ST-TOL-REF-PCT NOT = ZEROS
  5585             MOVE CF-ST-TOL-REF-PCT TO REFPCTO.
  5586
  5587     IF CF-ST-REFUND-MIN      NUMERIC
  5588         IF CF-ST-REFUND-MIN NOT = ZEROS
  5589             MOVE CF-ST-REFUND-MIN  TO REFMINO.
  5590
  5591     IF CF-ST-REFUND-DAYS-FIRST NUMERIC
  5592       IF CF-ST-REFUND-DAYS-FIRST NOT = ZEROS
  5593         MOVE CF-ST-REFUND-DAYS-FIRST
  5594                                TO REFDAY1O.
  5595
  5596     IF CF-ST-REFUND-DAYS-SUBSEQ NUMERIC
  5597       IF CF-ST-REFUND-DAYS-SUBSEQ NOT = ZEROS
  5598         MOVE CF-ST-REFUND-DAYS-SUBSEQ
  5599                                TO REFDAYSO.
  5600
  5601     IF CF-ST-SPLIT-PAYMENT IS EQUAL TO ' '
  5602         MOVE 'N'               TO SPLPMTO
  5603     ELSE
  5604         MOVE CF-ST-SPLIT-PAYMENT
  5605                                TO SPLPMTO.
  5606
  5607     IF CF-ST-FST-PMT-DAYS-MAX NUMERIC
  5608       IF CF-ST-FST-PMT-DAYS-MAX NOT = ZEROS
  5609         MOVE CF-ST-FST-PMT-DAYS-MAX
  5610                                TO EXTDAYSO.
  5611
  5612     IF CF-ST-LF-PREM-TAX NUMERIC
  5613        IF CF-ST-LF-PREM-TAX > ZEROS
  5614           MOVE CF-ST-LF-PREM-TAX
  5615                                 TO LFTAXO
  5616        END-IF
  5617     END-IF
  5618
  5619     IF CF-ST-AH-PREM-TAX-I NUMERIC
  5620        IF CF-ST-AH-PREM-TAX-I > ZEROS
  5621           MOVE CF-ST-AH-PREM-TAX-I
  5622                                 TO AHITAXO
  5623        END-IF
  5624     END-IF
  5625
  5626     IF CF-ST-AH-PREM-TAX-G NUMERIC
  5627        IF CF-ST-AH-PREM-TAX-G > ZEROS
  5628           MOVE CF-ST-AH-PREM-TAX-G
  5629                                 TO AHGTAXO
  5630        END-IF
  5631     END-IF
  5632
  5633*    IF PI-COMPANY-ID = 'NCL'
  5634*    IF CF-ST-NO-DAYS-ELAPSED NUMERIC
  5635*      IF CF-ST-NO-DAYS-ELAPSED NOT = ZEROS
  5636*        MOVE CF-ST-NO-DAYS-ELAPSED
  5637*                               TO INTDAYSO.
  5638
  5639     IF  CF-REPLACEMENT-LAW-SW NOT EQUAL 'Y'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 110
* EL106.cbl
  5640             AND
  5641         CF-REPLACEMENT-LAW-SW NOT EQUAL 'N'
  5642         MOVE 'N'               TO REPLAWO
  5643         MOVE LOW-VALUES        TO REPLETRO
  5644     ELSE
  5645         MOVE CF-REPLACEMENT-LAW-SW
  5646                                TO REPLAWO
  5647
  5648         IF  CF-REPLACEMENT-LETTER GREATER THAN SPACES
  5649             MOVE CF-REPLACEMENT-LETTER
  5650                                TO REPLETRO
  5651         ELSE
  5652             MOVE LOW-VALUES    TO REPLETRO.
  5653
  5654     IF  CF-ST-TARGET-LOSS-RATIO NUMERIC
  5655         IF  CF-ST-TARGET-LOSS-RATIO NOT = ZEROS
  5656             MOVE CF-ST-TARGET-LOSS-RATIO
  5657                                TO TARRATO
  5658         ELSE
  5659             MOVE ZEROS         TO TARRATO
  5660     ELSE
  5661         MOVE ZEROS             TO TARRATO.
  5662
  5663     IF  CF-ST-CALC-INTEREST NUMERIC
  5664         IF  CF-ST-CALC-INTEREST NOT = ZEROS
  5665             MOVE CF-ST-CALC-INTEREST
  5666                                TO CALCINTO
  5667         ELSE
  5668             MOVE ZEROS         TO CALCINTO
  5669     ELSE
  5670         MOVE ZEROS             TO CALCINTO.
  5671
  5672     IF  CF-ST-COMM-CAP-SL NUMERIC
  5673         IF  CF-ST-COMM-CAP-SL NOT = ZEROS
  5674             MOVE CF-ST-COMM-CAP-SL
  5675                                TO COMSLO
  5676         ELSE
  5677             MOVE ZEROS         TO COMSLO
  5678     ELSE
  5679         MOVE ZEROS             TO COMSLO.
  5680
  5681     IF  CF-ST-COMM-CAP-JL NUMERIC
  5682         IF  CF-ST-COMM-CAP-JL NOT = ZEROS
  5683             MOVE CF-ST-COMM-CAP-JL
  5684                                TO COMJLO
  5685         ELSE
  5686             MOVE ZEROS         TO COMJLO
  5687     ELSE
  5688         MOVE ZEROS             TO COMJLO.
  5689
  5690     IF  CF-ST-COMM-CAP-SA NUMERIC
  5691         IF  CF-ST-COMM-CAP-SA NOT = ZEROS
  5692             MOVE CF-ST-COMM-CAP-SA
  5693                                TO COMSAO
  5694         ELSE
  5695             MOVE ZEROS         TO COMSAO
  5696     ELSE
  5697         MOVE ZEROS             TO COMSAO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 111
* EL106.cbl
  5698
  5699     IF  CF-ST-COMM-CAP-JA NUMERIC
  5700         IF  CF-ST-COMM-CAP-JA NOT = ZEROS
  5701             MOVE CF-ST-COMM-CAP-JA
  5702                                TO COMJAO
  5703         ELSE
  5704             MOVE ZEROS         TO COMJAO
  5705     ELSE
  5706         MOVE ZEROS             TO COMJAO.
  5707
  5708     IF  CF-ST-RES-TAX-PCT NUMERIC
  5709         IF  CF-ST-RES-TAX-PCT NOT = ZEROS
  5710             MOVE CF-ST-RES-TAX-PCT
  5711                                TO RESTAXO
  5712         ELSE
  5713             MOVE ZEROS         TO RESTAXO
  5714     ELSE
  5715         MOVE ZEROS             TO RESTAXO.
  5716
  5717     IF CF-ST-FREE-LOOK-PERIOD NUMERIC
  5718        IF CF-ST-FREE-LOOK-PERIOD NOT = ZEROS
  5719             MOVE CF-ST-FREE-LOOK-PERIOD
  5720                                TO FREELKO
  5721        ELSE
  5722             MOVE ZEROS         TO FREELKO
  5723     ELSE
  5724         MOVE ZEROS             TO FREELKO.
  5725
  5726*    IF PI-COMPANY-ID = 'NCL'
  5727*    IF  CF-ST-STAT-INTEREST NUMERIC
  5728*        IF  CF-ST-STAT-INTEREST NOT = ZEROS
  5729*            MOVE CF-ST-STAT-INTEREST
  5730*                               TO STATRO
  5731*        ELSE
  5732*            MOVE ZEROS         TO STATRO
  5733*    ELSE
  5734*        MOVE ZEROS             TO STATRO.
  5735
  5736*    IF PI-COMPANY-ID = 'NCL'
  5737*    IF  CF-ST-STAT-INTEREST-1 NUMERIC
  5738*        IF  CF-ST-STAT-INTEREST-1 NOT = ZEROS
  5739*            MOVE CF-ST-STAT-INTEREST-1
  5740*                               TO STATR1O
  5741*        ELSE
  5742*            MOVE ZEROS         TO STATR1O
  5743*    ELSE
  5744*        MOVE ZEROS             TO STATR1O.
  5745
  5746*    IF PI-COMPANY-ID = 'NCL'
  5747*    IF  CF-ST-STAT-INTEREST-2 NUMERIC
  5748*        IF  CF-ST-STAT-INTEREST-2 NOT = ZEROS
  5749*            MOVE CF-ST-STAT-INTEREST-2
  5750*                               TO STATR2O
  5751*        ELSE
  5752*            MOVE ZEROS         TO STATR2O
  5753*    ELSE
  5754*        MOVE ZEROS             TO STATR2O.
  5755
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 112
* EL106.cbl
  5756*    IF PI-COMPANY-ID = 'NCL'
  5757*    IF  CF-ST-STAT-INTEREST-3 NUMERIC
  5758*        IF  CF-ST-STAT-INTEREST-3 NOT = ZEROS
  5759*            MOVE CF-ST-STAT-INTEREST-3
  5760*                               TO STATR3O
  5761*        ELSE
  5762*            MOVE ZEROS         TO STATR3O
  5763*    ELSE
  5764*        MOVE ZEROS             TO STATR3O.
  5765
  5766     MOVE CF-COMM-CAP-LIMIT-TO  TO LIMITO.
  5767*    MOVE CF-ST-STAT-DATE-FROM  TO STATIO.
  5768
  5769     MOVE CF-LAST-MAINT-BY      TO LSTUSRO.
  5770     MOVE ' '                   TO DC-OPTION-CODE.
  5771     MOVE CF-LAST-MAINT-DT      TO DC-BIN-DATE-1.
  5772     MOVE LINK-ELDATCV          TO PGM-NAME.
  5773
  5774* EXEC CICS LINK
  5775*        PROGRAM (PGM-NAME)
  5776*        COMMAREA(DATE-CONVERSION-DATA)
  5777*        LENGTH  (DC-COMM-LENGTH)
  5778*    END-EXEC.
  5779*    MOVE '."C                   ''   #00005154' TO DFHEIV0
  5780     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5781     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5782     MOVE X'2020233030303035313534' TO DFHEIV0(25:11)
  5783     CALL 'kxdfhei1' USING DFHEIV0,
  5784           PGM-NAME,
  5785           DATE-CONVERSION-DATA,
  5786           DC-COMM-LENGTH,
  5787           DFHEIV99,
  5788           DFHEIV99,
  5789           DFHEIV99
  5790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5791
  5792
  5793     IF DATE-CONVERSION-ERROR
  5794         MOVE ZEROS              TO LSTDTEO
  5795     ELSE
  5796         MOVE DC-GREG-DATE-1-EDIT
  5797                                 TO LSTDTEO.
  5798
  5799     MOVE CF-LAST-MAINT-HHMMSS   TO TIME-IN.
  5800     MOVE TIME-OUT               TO LSTTIMEO.
  5801     MOVE -1                     TO MAINTL.
  5802     MOVE CF-LAST-MAINT-BY       TO PI-UPDATE-BY.
  5803     MOVE CF-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  5804     MOVE CF-STATE-CODE          TO PI-PREV-STATE.
  5805     MOVE AL-UANOF               TO MAINTA.
  5806     MOVE AL-UANON               TO STCDA
  5807                                  STNAMEA
  5808                                  STABRA
  5809                                  CLREJECA ISSREJA REFREJA
  5810                                  EXTCHGA STUEA STCNTLA STDEVA
  5811                                  REMTERMA
  5812                                  LFREDA LFLEVA LFNETA
  5813                                  AHAHA  AHCPA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 113
* EL106.cbl
  5814                                  REPLAWA REPLETRA SPLPMTA
  5815                                  LIMITA.
  5816*    IF PI-COMPANY-ID = 'NCL'
  5817*        MOVE AL-UANON           TO STATIA.
  5818
  5819     MOVE AL-UNNON               TO LFEXPA AHEXPA
  5820                                  QUOTCALA PREMTOLA REFTOLA
  5821                                  OVSAMTA  OVSPCTA
  5822                                  LFTAXA   AHITAXA  AHGTAXA
  5823                                  PRMPCTA  REFPCTA
  5824                                  REFDAY1A REFDAYSA
  5825                                  REFMINA EXTDAYSA
  5826                                  TARRATA
  5827                                  CALCINTA
  5828                                  RESTAXA FREELKA
  5829                                  COMSLA COMJLA COMSAA COMJAA.
  5830
  5831*    IF PI-COMPANY-ID = 'NCL'
  5832*        MOVE AL-UNNON           TO STATRA STATR1A STATR2A
  5833*                                                  STATR3A
  5834*                                                  INTDAYSA.
  5835
  5836     IF RETURN-DISPLAY
  5837         GO TO 8100-SEND-INITIAL-MAP
  5838     ELSE
  5839         GO TO 8200-SEND-DATAONLY.
  5840
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 114
* EL106.cbl
  5842 8100-SEND-INITIAL-MAP.
  5843     IF  PI-COMPANY-ID = 'CID' AND PI-WS-STATE = 'AK'
  5844        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5845     ELSE
  5846        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5847     END-IF.
  5848     MOVE SAVE-DATE              TO RUNDTEO.
  5849     MOVE EIBTIME                TO TIME-IN.
  5850     MOVE TIME-OUT               TO RUNTIMEO.
  5851     MOVE -1                     TO MAINTL.
  5852     MOVE PI-LIFE-OVERRIDE-L6    TO LEXPLBLO.
  5853     MOVE PI-AH-OVERRIDE-L6      TO AEXPLBLO.
  5854     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5855     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5856
  5857*    IF PI-COMPANY-ID = 'NCL'
  5858*       MOVE AL-SANON            TO STATZA
  5859*                                   INTDAYZA
  5860*                                   STATRZA
  5861*                                   RNG1A
  5862*                                   RNG2A
  5863*                                   RNG3A
  5864*       MOVE AL-UANON            TO STATIA
  5865*                                   STATRA
  5866*                                   STATR1A
  5867*                                   STATR2A
  5868*                                   STATR3A
  5869*       MOVE AL-UNNON            TO INTDAYSA.
  5870
  5871
  5872* EXEC CICS SEND
  5873*        MAP   (MAP-NAME)
  5874*        MAPSET(MAPSET-NAME)
  5875*        FROM  (EL106AO)
  5876*        ERASE
  5877*        CURSOR
  5878*    END-EXEC.
  5879     MOVE LENGTH OF
  5880      EL106AO
  5881       TO DFHEIV12
  5882     MOVE -1
  5883       TO DFHEIV11
  5884*    MOVE '8$     CT  E    H L F ,   #00005238' TO DFHEIV0
  5885     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5886     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5887     MOVE X'2020233030303035323338' TO DFHEIV0(25:11)
  5888     CALL 'kxdfhei1' USING DFHEIV0,
  5889           MAP-NAME,
  5890           EL106AO,
  5891           DFHEIV12,
  5892           MAPSET-NAME,
  5893           DFHEIV99,
  5894           DFHEIV99,
  5895           DFHEIV99,
  5896           DFHEIV11,
  5897           DFHEIV99,
  5898           DFHEIV99,
  5899           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 115
* EL106.cbl
  5900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5901
  5902
  5903     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 116
* EL106.cbl
  5905 8200-SEND-DATAONLY.
  5906
  5907     IF  PI-COMPANY-ID = 'CID' AND PI-WS-STATE = 'AK'
  5908        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5909     ELSE
  5910        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5911     END-IF.
  5912
  5913     MOVE SAVE-DATE      TO RUNDTEO.
  5914     MOVE EIBTIME        TO TIME-IN.
  5915     MOVE TIME-OUT       TO RUNTIMEO.
  5916
  5917     IF QUOTCALL NOT = ZEROS
  5918        IF QUOTCALI NUMERIC
  5919           MOVE QUOTCALI TO QUOTCALO.
  5920
  5921     IF PREMTOLL NOT = ZEROS
  5922        IF PREMTOLI NUMERIC
  5923           MOVE PREMTOLI TO PREMTOLO.
  5924
  5925     IF OVSAMTL NOT = ZEROS
  5926        IF OVSAMTI NUMERIC
  5927           MOVE OVSAMTI TO OVSAMTO.
  5928
  5929     IF REFTOLL NOT = ZEROS
  5930        IF REFTOLI NUMERIC
  5931           MOVE REFTOLI TO REFTOLO.
  5932
  5933     IF PRMPCTL NOT = ZEROS
  5934        IF PRMPCTI NUMERIC
  5935           MOVE PRMPCTI TO PRMPCTO.
  5936
  5937     IF OVSPCTL NOT = ZEROS
  5938        IF OVSPCTI NUMERIC
  5939           MOVE OVSPCTI TO OVSPCTO.
  5940
  5941     IF LFTAXL NOT = ZEROS
  5942        IF LFTAXI NUMERIC
  5943           MOVE LFTAXI           TO LFTAXO
  5944        END-IF
  5945     END-IF
  5946
  5947     IF AHITAXL NOT = ZEROS
  5948        IF AHITAXI NUMERIC
  5949           MOVE AHITAXI          TO AHITAXO
  5950        END-IF
  5951     END-IF
  5952
  5953     IF AHGTAXL NOT = ZEROS
  5954        IF AHGTAXI NUMERIC
  5955           MOVE AHGTAXI          TO AHGTAXO
  5956        END-IF
  5957     END-IF
  5958
  5959     IF REFPCTL NOT = ZEROS
  5960        IF REFPCTI NUMERIC
  5961           MOVE REFPCTI TO REFPCTO.
  5962
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 117
* EL106.cbl
  5963     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5964     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5965
  5966
  5967* EXEC CICS SEND
  5968*        MAP   (MAP-NAME)
  5969*        MAPSET(MAPSET-NAME)
  5970*        FROM  (EL106AO)
  5971*        DATAONLY
  5972*        ERASEAUP
  5973*        CURSOR
  5974*    END-EXEC.
  5975     MOVE LENGTH OF
  5976      EL106AO
  5977       TO DFHEIV12
  5978     MOVE -1
  5979       TO DFHEIV11
  5980*    MOVE '8$D    CT  A    H L F ,   #00005309' TO DFHEIV0
  5981     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  5982     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5983     MOVE X'2020233030303035333039' TO DFHEIV0(25:11)
  5984     CALL 'kxdfhei1' USING DFHEIV0,
  5985           MAP-NAME,
  5986           EL106AO,
  5987           DFHEIV12,
  5988           MAPSET-NAME,
  5989           DFHEIV99,
  5990           DFHEIV99,
  5991           DFHEIV99,
  5992           DFHEIV11,
  5993           DFHEIV99,
  5994           DFHEIV99,
  5995           DFHEIV99
  5996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5997
  5998
  5999     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 118
* EL106.cbl
  6001 8300-SEND-TEXT.
  6002
  6003* EXEC CICS SEND TEXT
  6004*        FROM  (LOGOFF-TEXT)
  6005*        LENGTH(LOGOFF-LENGTH)
  6006*        ERASE
  6007*        FREEKB
  6008*    END-EXEC.
  6009*    MOVE '8&      T  E F  H   F -   #00005321' TO DFHEIV0
  6010     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6011     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6012     MOVE X'2020233030303035333231' TO DFHEIV0(25:11)
  6013     CALL 'kxdfhei1' USING DFHEIV0,
  6014           LOGOFF-TEXT,
  6015           LOGOFF-LENGTH,
  6016           DFHEIV99,
  6017           DFHEIV99,
  6018           DFHEIV99,
  6019           DFHEIV99,
  6020           DFHEIV99,
  6021           DFHEIV99,
  6022           DFHEIV99,
  6023           DFHEIV99,
  6024           DFHEIV99,
  6025           DFHEIV99
  6026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6027
  6028
  6029
  6030* EXEC CICS RETURN
  6031*    END-EXEC.
  6032*    MOVE '.(                    &   #00005328' TO DFHEIV0
  6033     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6034     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6035     MOVE X'2020233030303035333238' TO DFHEIV0(25:11)
  6036     CALL 'kxdfhei1' USING DFHEIV0,
  6037           DFHEIV99,
  6038           DFHEIV99,
  6039           DFHEIV99,
  6040           DFHEIV99,
  6041           DFHEIV99
  6042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6043
  6044
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 119
* EL106.cbl
  6046 8400-LOG-JOURNAL-RECORD.
  6047     IF PI-JOURNAL-FILE-ID = 0
  6048         GO TO 8400-EXIT.
  6049
  6050     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  6051     MOVE ELCNTL-ID              TO JP-FILE-ID.
  6052     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  6053*    EXEC CICS JOURNAL
  6054*         JFILEID(PI-JOURNAL-FILE-ID)
  6055*         JTYPEID('EL')
  6056*         FROM   (JOURNAL-RECORD)
  6057*         LENGTH (773)
  6058*    END-EXEC.
  6059
  6060 8400-EXIT.
  6061     EXIT.
  6062
  6063 8800-UNAUTHORIZED-ACCESS.
  6064     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  6065     GO TO 8300-SEND-TEXT.
  6066
  6067 8810-PF23.
  6068     MOVE EIBAID   TO PI-ENTRY-CD-1.
  6069     MOVE XCTL-EL005 TO PGM-NAME.
  6070     GO TO 9300-XCTL.
  6071
  6072 8850-DUPREC.
  6073     MOVE ER-0147 TO EMI-ERROR.
  6074     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6075     MOVE -1       TO STCDL.
  6076     MOVE AL-UABON TO STCDA.
  6077     GO TO 8200-SEND-DATAONLY.
  6078
  6079 8860-ENDFILE.
  6080     MOVE LOW-VALUES TO EL106AO.
  6081     MOVE ER-0148    TO EMI-ERROR.
  6082     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6083     MOVE -1 TO MAINTL.
  6084     MOVE SPACES TO PI-WS-STATE.
  6085     GO TO 8100-SEND-INITIAL-MAP.
  6086
  6087 8870-NOTOPEN.
  6088     MOVE ER-0042 TO EMI-ERROR.
  6089     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6090     MOVE -1 TO MAINTL.
  6091     GO TO 8200-SEND-DATAONLY.
  6092
  6093 8880-NOT-FOUND.
  6094     MOVE ER-0149 TO EMI-ERROR.
  6095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6096     MOVE -1       TO STCDL.
  6097     MOVE AL-UABON TO STCDA.
  6098     GO TO 8200-SEND-DATAONLY.
  6099
  6100 8890-LETR-NOT-OPEN.
  6101     MOVE ER-0013                TO EMI-ERROR.
  6102     MOVE -1                     TO REPLETRL.
  6103     MOVE AL-UABON               TO REPLETRA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 120
* EL106.cbl
  6104     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6105     GO TO 8200-SEND-DATAONLY.
  6106
  6107 9000-RETURN-CICS.
  6108
  6109* EXEC CICS RETURN
  6110*    END-EXEC.
  6111*    MOVE '.(                    &   #00005394' TO DFHEIV0
  6112     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6113     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6114     MOVE X'2020233030303035333934' TO DFHEIV0(25:11)
  6115     CALL 'kxdfhei1' USING DFHEIV0,
  6116           DFHEIV99,
  6117           DFHEIV99,
  6118           DFHEIV99,
  6119           DFHEIV99,
  6120           DFHEIV99
  6121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6122
  6123
  6124 9100-RETURN-TRAN.
  6125     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  6126     MOVE '106A'                 TO PI-CURRENT-SCREEN-NO.
  6127
  6128
  6129* EXEC CICS RETURN
  6130*        TRANSID (TRANS-ID)
  6131*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6132*        LENGTH  (WS-COMM-LENGTH)
  6133*    END-EXEC.
  6134*    MOVE '.(CT                  &   #00005401' TO DFHEIV0
  6135     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6136     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6137     MOVE X'2020233030303035343031' TO DFHEIV0(25:11)
  6138     CALL 'kxdfhei1' USING DFHEIV0,
  6139           TRANS-ID,
  6140           PROGRAM-INTERFACE-BLOCK,
  6141           WS-COMM-LENGTH,
  6142           DFHEIV99,
  6143           DFHEIV99
  6144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6145
  6146
  6147 9200-RETURN-MAIN-MENU.
  6148     IF  CREDIT-SESSION
  6149         MOVE XCTL-EL626           TO PGM-NAME
  6150     ELSE
  6151     IF  CLAIM-SESSION
  6152         MOVE XCTL-EL126           TO PGM-NAME
  6153     ELSE
  6154     IF  MORTGAGE-SESSION
  6155         MOVE XCTL-EM626           TO PGM-NAME
  6156     ELSE
  6157     IF  GENERAL-LEDGER-SESSION
  6158         MOVE XCTL-GL800           TO PGM-NAME.
  6159
  6160     GO TO 9300-XCTL.
  6161
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 121
* EL106.cbl
  6162 9300-XCTL.
  6163
  6164* EXEC CICS XCTL
  6165*        PROGRAM (PGM-NAME)
  6166*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6167*        LENGTH  (WS-COMM-LENGTH)
  6168*    END-EXEC.
  6169*    MOVE '.$C                   $   #00005423' TO DFHEIV0
  6170     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6172     MOVE X'2020233030303035343233' TO DFHEIV0(25:11)
  6173     CALL 'kxdfhei1' USING DFHEIV0,
  6174           PGM-NAME,
  6175           PROGRAM-INTERFACE-BLOCK,
  6176           WS-COMM-LENGTH
  6177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6178
  6179
  6180 9400-CLEAR.
  6181     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  6182     GO TO 9300-XCTL.
  6183
  6184 9500-PF12.
  6185     MOVE XCTL-EL010 TO PGM-NAME.
  6186     GO TO 9300-XCTL.
  6187
  6188 9600-PGMID-ERROR.
  6189
  6190* EXEC CICS HANDLE CONDITION
  6191*        PGMIDERR(8300-SEND-TEXT)
  6192*    END-EXEC.
  6193*    MOVE '"$L                   ! ) #00005438' TO DFHEIV0
  6194     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6196     MOVE X'2920233030303035343338' TO DFHEIV0(25:11)
  6197     CALL 'kxdfhei1' USING DFHEIV0
  6198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6199
  6200
  6201     MOVE PGM-NAME      TO PI-CALLING-PROGRAM.
  6202     MOVE ' '           TO PI-ENTRY-CD-1.
  6203     MOVE XCTL-EL005    TO PGM-NAME.
  6204     MOVE PGM-NAME      TO LOGOFF-PGM.
  6205     MOVE PGMIDERR-MSG  TO LOGOFF-FILL.
  6206     GO TO 9300-XCTL.
  6207
  6208 9700-LINK-DATE-CONVERT.
  6209
  6210* EXEC CICS LINK
  6211*        PROGRAM    ('ELDATCV')
  6212*        COMMAREA   (DATE-CONVERSION-DATA)
  6213*        LENGTH     (DC-COMM-LENGTH)
  6214*    END-EXEC.
  6215     MOVE 'ELDATCV' TO DFHEIV1
  6216*    MOVE '."C                   ''   #00005450' TO DFHEIV0
  6217     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6219     MOVE X'2020233030303035343530' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 122
* EL106.cbl
  6220     CALL 'kxdfhei1' USING DFHEIV0,
  6221           DFHEIV1,
  6222           DATE-CONVERSION-DATA,
  6223           DC-COMM-LENGTH,
  6224           DFHEIV99,
  6225           DFHEIV99,
  6226           DFHEIV99
  6227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6228
  6229
  6230 9700-EXIT.
  6231     EXIT.
  6232
  6233 9900-ERROR-FORMAT.
  6234     IF NOT EMI-ERRORS-COMPLETE
  6235         MOVE LINK-EL001 TO PGM-NAME
  6236
  6237* EXEC CICS LINK
  6238*            PROGRAM (PGM-NAME)
  6239*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  6240*            LENGTH  (EMI-COMM-LENGTH)
  6241*        END-EXEC.
  6242*    MOVE '."C                   ''   #00005462' TO DFHEIV0
  6243     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6244     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6245     MOVE X'2020233030303035343632' TO DFHEIV0(25:11)
  6246     CALL 'kxdfhei1' USING DFHEIV0,
  6247           PGM-NAME,
  6248           ERROR-MESSAGE-INTERFACE-BLOCK,
  6249           EMI-COMM-LENGTH,
  6250           DFHEIV99,
  6251           DFHEIV99,
  6252           DFHEIV99
  6253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6254
  6255
  6256 9900-EXIT.
  6257     EXIT.
  6258
  6259 9910-INITIALIZE-SECURITY.
  6260******************************************************************
  6261*                                                                *
  6262*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  6263*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  6264*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  6265*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  6266*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  6267*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  6268*                                                                *
  6269******************************************************************
  6270     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  6271         IF  MORTGAGE-SESSION
  6272             MOVE '125E'             TO SC-QUID-SYSTEM
  6273             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  6274
  6275* EXEC CICS READQ TS
  6276*                QUEUE  (SC-QUID-KEY)
  6277*                INTO   (SECURITY-CONTROL-E)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 123
* EL106.cbl
  6278*                LENGTH (SC-COMM-LENGTH-E)
  6279*                ITEM   (SC-ITEM)
  6280*            END-EXEC
  6281*    MOVE '*$II   L              ''   #00005486' TO DFHEIV0
  6282     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6283     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6284     MOVE X'2020233030303035343836' TO DFHEIV0(25:11)
  6285     CALL 'kxdfhei1' USING DFHEIV0,
  6286           SC-QUID-KEY,
  6287           SECURITY-CONTROL-E,
  6288           SC-COMM-LENGTH-E,
  6289           SC-ITEM,
  6290           DFHEIV99,
  6291           DFHEIV99
  6292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6293             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  6294                                     TO PI-DISPLAY-CAP
  6295             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  6296                                     TO PI-MODIFY-CAP
  6297             IF  NOT DISPLAY-CAP
  6298                 MOVE 'READ'         TO SM-READ
  6299                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6300                 MOVE ER-9097        TO EMI-ERROR
  6301                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6302                 GO TO 8100-SEND-INITIAL-MAP
  6303             ELSE
  6304                 GO TO 9910-EXIT
  6305         ELSE
  6306
  6307* EXEC CICS  READQ TS
  6308*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6309*                INTO    (SECURITY-CONTROL)
  6310*                LENGTH  (SC-COMM-LENGTH)
  6311*                ITEM    (SC-ITEM-CL-CR)
  6312*                END-EXEC
  6313*    MOVE '*$II   L              ''   #00005505' TO DFHEIV0
  6314     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6315     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6316     MOVE X'2020233030303035353035' TO DFHEIV0(25:11)
  6317     CALL 'kxdfhei1' USING DFHEIV0,
  6318           PI-SECURITY-TEMP-STORE-ID,
  6319           SECURITY-CONTROL,
  6320           SC-COMM-LENGTH,
  6321           SC-ITEM-CL-CR,
  6322           DFHEIV99,
  6323           DFHEIV99
  6324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6325             MOVE SC-CREDIT-DISPLAY (29)
  6326                                 TO PI-DISPLAY-CAP
  6327             MOVE SC-CREDIT-UPDATE  (29)
  6328                                 TO PI-MODIFY-CAP
  6329             IF  NOT DISPLAY-CAP
  6330                 MOVE 'READ'     TO SM-READ
  6331                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6332                 MOVE ER-0070    TO  EMI-ERROR
  6333                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6334                 GO TO 8100-SEND-INITIAL-MAP.
  6335 9910-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 124
* EL106.cbl
  6336     EXIT.
  6337 9990-ABEND.
  6338     MOVE LINK-EL004             TO PGM-NAME.
  6339     MOVE DFHEIBLK               TO EMI-LINE1.
  6340
  6341* EXEC CICS LINK
  6342*        PROGRAM   (PGM-NAME)
  6343*        COMMAREA  (EMI-LINE1)
  6344*        LENGTH    (72)
  6345*    END-EXEC.
  6346     MOVE 72
  6347       TO DFHEIV11
  6348*    MOVE '."C                   ''   #00005526' TO DFHEIV0
  6349     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6350     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6351     MOVE X'2020233030303035353236' TO DFHEIV0(25:11)
  6352     CALL 'kxdfhei1' USING DFHEIV0,
  6353           PGM-NAME,
  6354           EMI-LINE1,
  6355           DFHEIV11,
  6356           DFHEIV99,
  6357           DFHEIV99,
  6358           DFHEIV99
  6359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6360
  6361
  6362     GO TO 8200-SEND-DATAONLY.
  6363
  6364 9995-SECURITY-VIOLATION.
  6365*           COPY ELCSCTP.
  6366******************************************************************
  6367*                                                                *
  6368*                            ELCSCTP                             *
  6369*                            VMOD=2.001                          *
  6370*                                                                *
  6371*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6372******************************************************************
  6373
  6374
  6375     MOVE EIBDATE          TO SM-JUL-DATE.
  6376     MOVE EIBTRMID         TO SM-TERMID.
  6377     MOVE THIS-PGM         TO SM-PGM.
  6378     MOVE EIBTIME          TO TIME-IN.
  6379     MOVE TIME-OUT         TO SM-TIME.
  6380     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6381
  6382
  6383* EXEC CICS LINK
  6384*         PROGRAM  ('EL003')
  6385*         COMMAREA (SECURITY-MESSAGE)
  6386*         LENGTH   (80)
  6387*    END-EXEC.
  6388     MOVE 'EL003' TO DFHEIV1
  6389     MOVE 80
  6390       TO DFHEIV11
  6391*    MOVE '."C                   ''   #00005552' TO DFHEIV0
  6392     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6393     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 125
* EL106.cbl
  6394     MOVE X'2020233030303035353532' TO DFHEIV0(25:11)
  6395     CALL 'kxdfhei1' USING DFHEIV0,
  6396           DFHEIV1,
  6397           SECURITY-MESSAGE,
  6398           DFHEIV11,
  6399           DFHEIV99,
  6400           DFHEIV99,
  6401           DFHEIV99
  6402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6403
  6404
  6405******************************************************************
  6406
  6407
  6408 9995-EXIT.
  6409      EXIT.
  6410
  6411
  6412 9999-DFHBACK SECTION.
  6413     MOVE '9%                    "   ' TO DFHEIV0
  6414     MOVE 'EL106' TO DFHEIV1
  6415     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6416     GOBACK.
  6417 9999-DFHEXIT.
  6418     IF DFHEIGDJ EQUAL 0001
  6419         NEXT SENTENCE
  6420     ELSE IF DFHEIGDJ EQUAL 2
  6421         GO TO 8850-DUPREC,
  6422               8870-NOTOPEN,
  6423               8880-NOT-FOUND,
  6424               9600-PGMID-ERROR,
  6425               9990-ABEND
  6426         DEPENDING ON DFHEIGDI
  6427     ELSE IF DFHEIGDJ EQUAL 3
  6428         GO TO 8880-NOT-FOUND,
  6429               8880-NOT-FOUND
  6430         DEPENDING ON DFHEIGDI
  6431     ELSE IF DFHEIGDJ EQUAL 4
  6432         GO TO 8100-SEND-INITIAL-MAP
  6433         DEPENDING ON DFHEIGDI
  6434     ELSE IF DFHEIGDJ EQUAL 5
  6435         GO TO 8860-ENDFILE
  6436         DEPENDING ON DFHEIGDI
  6437     ELSE IF DFHEIGDJ EQUAL 6
  6438         GO TO 8860-ENDFILE
  6439         DEPENDING ON DFHEIGDI
  6440     ELSE IF DFHEIGDJ EQUAL 7
  6441         GO TO 6010-LETR-NOT-FOUND,
  6442               6010-LETR-NOT-FOUND,
  6443               8890-LETR-NOT-OPEN
  6444         DEPENDING ON DFHEIGDI
  6445     ELSE IF DFHEIGDJ EQUAL 8
  6446         GO TO 6600-EXIT
  6447         DEPENDING ON DFHEIGDI
  6448     ELSE IF DFHEIGDJ EQUAL 9
  6449         GO TO 8300-SEND-TEXT
  6450         DEPENDING ON DFHEIGDI.
  6451     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 126
* EL106.cbl
  6452     MOVE 'EL106' TO DFHEIV1
  6453     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6454     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5092     Code:       19557
