* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57* 050713  CR2011062300001  PEMA  REM CHG FOR EXT DYS FOR ROA REF
    58* 041514  CR2012110200003  AJRA  REMOVE PF11 FROM SCREEN,
    59*                                CANCEL QUOTE SCRIPT WILL DO PF11
    60* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    61* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
    62* 072616  CR2016020400001  PEMA  ADD PF10 CONFIRMATION
    63******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   3
* EL1278.cbl
    65 ENVIRONMENT DIVISION.
    66 DATA DIVISION.
    67 WORKING-STORAGE SECTION.
    68 01  DFH-START PIC X(04).
    69 77  FILLER  PIC  X(32) VALUE '********************************'.
    70 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    71 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    72 77  S1                          PIC S999 COMP-3 VALUE +0.
    73 77  P1                          PIC S999 COMP-3 VALUE +0.
    74 77  P2                          PIC S999 COMP-3 VALUE +0.
    75 77  C0                          PIC S999 COMP-3 VALUE +0.
    76 77  C1                          PIC S999 COMP-3 VALUE +0.
    77 77  C2                          PIC S999 COMP-3 VALUE +0.
    78 77  C3                          PIC S999 COMP-3 VALUE +0.
    79 77  WS-STOP-SW                  PIC X  VALUE ' '.
    80     88  I-SAY-TO-STOP      VALUE 'Y'.
    81 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    82     88  OPEN-LF-CLAIM              VALUE 'Y'.
    83 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    84     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    85 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    86     88  OPEN-AH-CLAIM              VALUE 'Y'.
    87 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    88     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    89 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    90     88  FOUND-A-CLAIM              VALUE 'Y'.
    91 77  WS-ST-REF-IND               PIC X.
    92 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    93 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    94 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    95 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    96 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    97 77  DD-IU-SW                    PIC X   VALUE ' '.
    98     88  DD-IU-PRESENT                 VALUE 'Y'.
    99 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   100 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   101 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   102 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   103 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   104 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   105 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   106 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   107 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   108     88  NO-CERT-RW                 VALUE 'N'.
   109     88  CERT-RW                    VALUE 'Y'.
   110 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   111     88  ERMAIL-FOUND                 VALUE 'Y'.
   112 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   113
   114*                            COPY ELCSCTM.
   115******************************************************************
   116*                                                                *
   117*                                                                *
   118*                            ELCSCTM                             *
   119*                            VMOD=2.001                          *
   120*                                                                *
   121*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   122*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   4
* EL1278.cbl
   123******************************************************************
   124 01  SECURITY-MESSAGE.
   125     12  FILLER                          PIC X(30)
   126            VALUE '** LOGIC SECURITY VIOLATION -'.
   127     12  SM-READ                         PIC X(6).
   128     12  FILLER                          PIC X(5)
   129            VALUE ' PGM='.
   130     12  SM-PGM                          PIC X(6).
   131     12  FILLER                          PIC X(5)
   132            VALUE ' OPR='.
   133     12  SM-PROCESSOR-ID                 PIC X(4).
   134     12  FILLER                          PIC X(6)
   135            VALUE ' TERM='.
   136     12  SM-TERMID                       PIC X(4).
   137     12  FILLER                          PIC XX   VALUE SPACE.
   138     12  SM-JUL-DATE                     PIC 9(5).
   139     12  FILLER                          PIC X    VALUE SPACE.
   140     12  SM-TIME                         PIC 99.99.
   141
   142
   143*                            COPY ELCSCRTY.
   144******************************************************************
   145*                                                                *
   146*                                                                *
   147*                            ELCSCRTY                            *
   148*                            VMOD=2.001                          *
   149*                                                                *
   150*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   151*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   152*        SAVED IN PI-SECURITY-ADDRESS.                           *
   153*                                                                *
   154******************************************************************
   155 01  SECURITY-CONTROL.
   156     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   157     12  FILLER                       PIC XX    VALUE 'SC'.
   158     12  SC-CREDIT-CODES.
   159         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   160             20  SC-CREDIT-DISPLAY    PIC X.
   161             20  SC-CREDIT-UPDATE     PIC X.
   162     12  SC-CLAIMS-CODES.
   163         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   164             20  SC-CLAIMS-DISPLAY    PIC X.
   165             20  SC-CLAIMS-UPDATE     PIC X.
   166
   167 01  FILLER          COMP-3.
   168     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   169     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   170     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   171     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   172     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   173     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   174     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   175     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   176     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   177
   178 01  WS-DATE-AREA.
   179     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   180     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   5
* EL1278.cbl
   181     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   182     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   183     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   184     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   185
   186 01  ERPDEF-KEY-SAVE             PIC X(18).
   187 01  ERPDEF-KEY.
   188     12  ERPDEF-COMPANY-CD       PIC X.
   189     12  ERPDEF-STATE            PIC XX.
   190     12  ERPDEF-PROD-CD          PIC XXX.
   191     12  F                       PIC X(7).
   192     12  ERPDEF-BEN-TYPE         PIC X.
   193     12  ERPDEF-BEN-CODE         PIC XX.
   194     12  ERPDEF-EXP-DT           PIC XX.
   195 01  ELMSTR-KEY.
   196     12  ELMSTR-COMP-CD          PIC X.
   197     12  ELMSTR-CERT-NO          PIC X(11).
   198 01  ELCRTT-KEY.
   199     12  ELCRTT-PRIMARY          PIC X(33).
   200     12  ELCRTT-REC-TYPE         PIC X(1).
   201
   202 01  ELCRTO-KEY.
   203     05  ELCRTO-COMPANY-CD       PIC X.
   204     05  ELCRTO-CARRIER          PIC X.
   205     05  ELCRTO-GROUPING         PIC X(6).
   206     05  ELCRTO-STATE            PIC XX.
   207     05  ELCRTO-ACCOUNT          PIC X(10).
   208     05  ELCRTO-CERT-EFF-DT      PIC XX.
   209     05  ELCRTO-CERT-NO.
   210         10  ELCRTO-CERT-PRIME   PIC X(10).
   211         10  ELCRTO-CERT-SFX     PIC X.
   212     05  ELCRTO-RECORD-TYPE      PIC X.
   213     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   214
   215 01  STANDARD-AREAS.
   216     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   217     12  SUB3                    PIC S9(04) COMP VALUE +0.
   218     12  SUB4                    PIC S9(04) COMP VALUE +0.
   219     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   220     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   221     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   222     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   223     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   224     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   225     12  PGM-NAME                PIC  X(08).
   226     12  TIME-IN                 PIC S9(07).
   227     12  TIME-OUT-R  REDEFINES  TIME-IN.
   228         16  FILLER              PIC  X(01).
   229         16  TIME-OUT            PIC  9(02)V99.
   230         16  FILLER              PIC  X(02).
   231     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   232     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   233     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   234     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   235     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   236     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   237     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   238     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   6
* EL1278.cbl
   239     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   240     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   241     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   242     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   243     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   244     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   245     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   246     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   247     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   248     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   249         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   250     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   251         88  BROWSE-STARTED                      VALUE 'Y'.
   252     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   253         88  FORM-FOUND                          VALUE 'Y'.
   254     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   255         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   256     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   257         88  WS-REDUCING                         VALUE 'R'.
   258         88  WS-LEVEL                            VALUE 'L'  'P'.
   259     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   260         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   261     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   262         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   263     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   264     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   265         'CLAIM PMTS'.
   266     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   267         'ITD REFUND'.
   268     12  WS-ACCESS.
   269         16  FILLER              PIC  X(02).
   270         16  WS-BEN-CD           PIC  X(02).
   271     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   272     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   273     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   274     12  WS-LOOKUP-TYPE          PIC  X(01).
   275     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   276     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   277     12  WS-CALC-CD              PIC  X(01).
   278     12  DEEDIT-FIELD            PIC  X(15).
   279     12  DEEDIT-FIELD-V0  REDEFINES
   280         DEEDIT-FIELD            PIC S9(15).
   281     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   282     12  RETURN-FROM             PIC  X(08).
   283     12  QID.
   284         16  QID-TERM            PIC  X(04).
   285         16  FILLER              PIC  X(04)      VALUE '127H'.
   286     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   287         88  FIRST-ENTRY                         VALUE 'Y'.
   288     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   289         88  PDEF-FOUND                          VALUE 'Y'.
   290     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   291         88  CERT-FOUND                          VALUE 'Y'.
   292         88  CERT-NOT-FOUND                      VALUE 'N'.
   293     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   294         88  CNTL-FOUND                          VALUE 'Y'.
   295         88  CNTL-NOT-FOUND                      VALUE 'N'.
   296     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   7
* EL1278.cbl
   297         88  BEN-FOUND                           VALUE 'Y'.
   298     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   299         88  STATE-FOUND                         VALUE 'Y'.
   300     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   301         88  ST-BEN-FOUND                        VALUE 'Y'.
   302     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   303         88  ACCT-FOUND                          VALUE 'Y'.
   304     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   305         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   306     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   307                                                 VALUE ZERO.
   308         88  BENEFIT-FOUND                       VALUE +1.
   309     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   310                                                 VALUE ZERO.
   311     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   312                                                 VALUE ZERO.
   313     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   314     12  WS-SUB1                 PIC S99    COMP.
   315     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   316     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   317     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   318     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   319     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   320     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   321     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   322     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   323     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   324     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   325     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   326     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   327     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   328     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   329     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   330     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   331     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   332     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   333     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   334     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   335     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   336     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   337     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   338     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   339     12  ERROR-MESSAGES.
   340         16  ER-0000             PIC  X(04)      VALUE '0000'.
   341         16  ER-0004             PIC  X(04)      VALUE '0004'.
   342         16  ER-0008             PIC  X(04)      VALUE '0008'.
   343         16  ER-0028             PIC  X(04)      VALUE '0028'.
   344         16  ER-0029             PIC  X(04)      VALUE '0029'.
   345         16  ER-0070             PIC  X(04)      VALUE '0070'.
   346         16  ER-0142             PIC  X(04)      VALUE '0142'.
   347         16  ER-0214             PIC  X(04)      VALUE '0214'.
   348         16  ER-0681             PIC  X(04)      VALUE '0681'.
   349         16  ER-0682             PIC  X(04)      VALUE '0682'.
   350         16  ER-0683             PIC  X(04)      VALUE '0683'.
   351         16  ER-0684             PIC  X(04)      VALUE '0684'.
   352         16  ER-2227             PIC  X(04)      VALUE '2227'.
   353         16  ER-2601             PIC  X(04)      VALUE '2601'.
   354         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   8
* EL1278.cbl
   355         16  ER-2617             PIC  X(04)      VALUE '2617'.
   356         16  ER-2619             PIC  X(04)      VALUE '2619'.
   357         16  ER-2740             PIC  X(04)      VALUE '2740'.
   358         16  ER-2756             PIC  X(04)      VALUE '2756'.
   359         16  ER-2768             PIC  X(04)      VALUE '2768'.
   360         16  ER-2774             PIC  X(04)      VALUE '2774'.
   361         16  ER-2775             PIC  X(04)      VALUE '2775'.
   362         16  ER-2965             PIC  X(04)      VALUE '2965'.
   363         16  ER-2966             PIC  X(04)      VALUE '2966'.
   364         16  ER-2967             PIC  X(04)      VALUE '2967'.
   365         16  ER-2968             PIC  X(04)      VALUE '2968'.
   366         16  ER-2969             PIC  X(04)      VALUE '2969'.
   367         16  ER-3037             PIC  X(04)      VALUE '3037'.
   368         16  ER-3038             PIC  X(04)      VALUE '3038'.
   369         16  ER-3039             PIC  X(04)      VALUE '3039'.
   370         16  ER-3780             PIC  X(04)      VALUE '3780'.
   371         16  ER-3781             PIC  X(04)      VALUE '3781'.
   372         16  ER-3830             PIC  X(04)      VALUE '3830'.
   373         16  er-3847             pic  x(04)      value '3847'.
   374         16  ER-8160             PIC  X(04)      VALUE '8160'.
   375         16  ER-8161             PIC  X(04)      VALUE '8161'.
   376         16  ER-9999             PIC  X(04)      VALUE '9999'.
   377     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   378     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   379     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   380     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   381
   382     12  WS-RESPONSE             PIC S9(8)       COMP.
   383         88  WS-RESP-NORMAL                      VALUE +00.
   384         88  WS-RESP-NOTFND                      VALUE +13.
   385         88  WS-RESP-DUPREC                      VALUE +14.
   386         88  WS-RESP-DUPKEY                      VALUE +15.
   387         88  WS-RESP-NOTOPEN                     VALUE +19.
   388         88  WS-RESP-ENDFILE                     VALUE +20.
   389
   390     12  WS-01-CANCEL-ERR        PIC X(25)
   391         VALUE 'CANCEL DATE ERROR'.
   392     12  WS-02-CANCEL-ERR        PIC X(25)
   393         VALUE 'CERT NOT FOUND'.
   394     12  WS-04-CANCEL-ERR        PIC X(25)
   395         VALUE 'CANCEL AMOUNT ERROR'.
   396     12  WS-05-CANCEL-ERR        PIC X(25)
   397         VALUE 'CANCEL OPTION ERROR'.
   398     12  WS-06-CANCEL-ERR        PIC X(25)
   399         VALUE 'PREVIOUSLY CANCELLED'.
   400     12  WS-07-CANCEL-ERR        PIC X(25)
   401         VALUE 'INVALID DATA'.
   402     12  WS-08-CANCEL-ERR        PIC X(25)
   403         VALUE 'NO ACCOUNT MASTER'.
   404     12  WS-09-CANCEL-ERR        PIC X(25)
   405         VALUE 'SUFFIX ALREADY EXISTS'.
   406     12  WS-99-CANCEL-ERR        PIC X(25)
   407         VALUE 'MISC CANCEL ERROR'.
   408
   409 01  WS-SAVE-ALLOWABLE-BENEFIT.
   410     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   411     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   412     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page   9
* EL1278.cbl
   413     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   414     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   415     16  FILLER                    PIC XX.
   416 01  CTBL-KEY-SAVE               PIC X(5).
   417 01  CTBL-KEY.
   418     05  CTBL-COMPANY-CD         PIC X.
   419     05  CTBL-TABLE              PIC XXX.
   420     05  CTBL-BEN-TYPE           PIC X.
   421     05  CTBL-BEN-CODE           PIC XX.
   422 01  CANCEL-GEN-PASS-AREA.
   423     05  CG-OPTION-CODE          PIC X.
   424         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   425         88  CG-FLAT-CANCEL        VALUE '1'.
   426         88  CG-CANCEL             VALUE '2'.
   427         88  CG-CANCEL-REISSUE     VALUE '3'.
   428     05  CG-ERROR-CODE           PIC 99.
   429         88  CG-SUCCESS            VALUE 00.
   430         88  CG-DATE-ERROR         VALUE 01.
   431         88  CG-CERT-NOT-FOUND     VALUE 02.
   432         88  CG-AMOUNT-ERROR       VALUE 04.
   433         88  CG-OPTION-ERROR       VALUE 05.
   434         88  CG-PREV-CAN           VALUE 06.
   435         88  CG-INVALID-DATA       VALUE 07.
   436         88  CG-NO-ACCT-MSTR       VALUE 08.
   437         88  CG-SFX-A-EXIST        VALUE 09.
   438         88  CG-MISC-ERROR         VALUE 99.
   439     05  CG-COMPANY-ID           PIC XXX.
   440     05  CG-PROC-ID              PIC XXXX.
   441     05  CG-CURRENT-DT           PIC XX.
   442     05  CG-MONTH-END-DT         PIC XX.
   443     05  CG-CERT-KEY.
   444         10  CG-CERT-COMPANY-CD  PIC X.
   445         10  CG-CERT-CARRIER     PIC X.
   446         10  CG-CERT-GROUP       PIC X(6).
   447         10  CG-CERT-STATE       PIC XX.
   448         10  CG-CERT-ACCOUNT     PIC X(10).
   449         10  CG-CERT-EFF-DT      PIC XX.
   450         10  CG-CERT-CERT-NO     PIC X(11).
   451     05  CG-LF-CAN-DATA.
   452         10  CG-LF-CAN-DT        PIC XX.
   453         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   454     05  CG-AH-CAN-DATA.
   455         10  CG-AH-CAN-DT        PIC XX.
   456         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   457     05  CG-CERT-PROFILE-DATA.
   458         10  CG-INS-LNAME        PIC X(15).
   459         10  CG-INS-FNAME        PIC X(10).
   460         10  CG-INS-MID-INIT     PIC X.
   461         10  CG-INS-AGE          PIC 99.
   462         10  CG-JNT-LNAME        PIC X(15).
   463         10  CG-JNT-FNAME        PIC X(10).
   464         10  CG-JNT-MID-INIT     PIC X.
   465         10  CG-JNT-AGE          PIC 99.
   466     05  CG-LF-ISS-DATA.
   467         10  CG-LF-BENCD         PIC XX.
   468         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   469         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   470     05  CG-AH-ISS-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  10
* EL1278.cbl
   471         10  CG-AH-BENCD         PIC XX.
   472         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   473     05  CG-BATCH-NO             PIC X(6).
   474     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   475     05  FILLER                  PIC X(306).
   476 01  WS-CAN-QUOTE-NOTE.
   477     12  WS-CN-CANCEL-DT         PIC  X(09).
   478     12  FILLER                  PIC  X(10)      VALUE
   479         'RF QUOTE: '.
   480     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   481     12  FILLER                  PIC  X(4)       VALUE
   482         ' LF '.
   483     12  WS-CN-LF-REF-METH       PIC  X.
   484     12  FILLER                  PIC  X          VALUE ','.
   485     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   486     12  FILLER                  PIC  X(5)       VALUE
   487         ' AH '.
   488     12  WS-CN-AH-REF-METH       PIC  X.
   489     12  FILLER                  PIC  XX         VALUE ','.
   490     12  FILLER                  PIC  X(6)       VALUE
   491         'TOTAL '.
   492     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   493     12  FILLER                  PIC  X(01)      VALUE ' '.
   494     12  WS-CN-DT-QUOTED         PIC  X(08).
   495     12  FILLER                  PIC  X(01)      VALUE ';'.
   496     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   497
   498 01  WS-CM-CONTROL-PRIMARY.
   499     12  WS-CM-COMPANY-CD        PIC  X(01).
   500     12  WS-CM-CARRIER           PIC  X(01).
   501     12  WS-CM-GROUPING          PIC  X(06).
   502     12  WS-CM-STATE             PIC  X(02).
   503     12  WS-CM-ACCOUNT           PIC  X(10).
   504     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   505     12  WS-CM-CERT-NO.
   506         16  WS-CM-CERT-PRIME    PIC  X(10).
   507         16  WS-CM-CERT-SFX      PIC  X(01).
   508
   509 01  WS-MA-CONTROL-PRIMARY.
   510     12  WS-MA-COMPANY-CD        PIC  X(01).
   511     12  WS-MA-CARRIER           PIC  X(01).
   512     12  WS-MA-GROUPING          PIC  X(06).
   513     12  WS-MA-STATE             PIC  X(02).
   514     12  WS-MA-ACCOUNT           PIC  X(10).
   515     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   516     12  WS-MA-CERT-NO.
   517         16  WS-MA-CERT-PRIME    PIC  X(10).
   518         16  WS-MA-CERT-SFX      PIC  X(01).
   519 01  WS-CF-CONTROL-PRIMARY.
   520     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   521     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   522*        88  COMPANY-MASTER                      VALUE '1'.
   523*        88  STATE-MASTER                        VALUE '3'.
   524*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   525*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   526     12  WS-CF-ACCESS.
   527         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   528         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  11
* EL1278.cbl
   529             20  FILLER          PIC  X(01).
   530             20  WS-CF-CARRIER   PIC  X(01).
   531     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   532
   533 01  WS-AM-CONTROL-PRIMARY.
   534     12  WS-AM-COMPANY-CD        PIC  X(01).
   535     12  WS-AM-CARRIER           PIC  X(01).
   536     12  WS-AM-GROUPING          PIC  X(06).
   537     12  WS-AM-STATE             PIC  X(02).
   538     12  WS-AM-ACCOUNT           PIC  X(10).
   539     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   540     12  WS-AM-FILLER            PIC  X(04).
   541
   542 01  WS-CN-CONTROL-PRIMARY.
   543     12  WS-CN-COMPANY-CD        PIC  X(01).
   544     12  WS-CN-CARRIER           PIC  X(01).
   545     12  WS-CN-GROUPING          PIC  X(06).
   546     12  WS-CN-STATE             PIC  X(02).
   547     12  WS-CN-ACCOUNT           PIC  X(10).
   548     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   549     12  WS-CN-CERT-NO.
   550         16  WS-CN-CERT-PRIME    PIC  X(10).
   551         16  WS-CN-CERT-SFX      PIC  X.
   552     12  WS-CN-REC-TYPE          PIC X.
   553     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   554
   555 01  WS-FO-CONTROL-PRIMARY.
   556     12  WS-FO-COMPANY-CD        PIC  X(01).
   557     12  WS-FO-STATE             PIC  X(02).
   558     12  WS-FO-FORM-ID           PIC  X(12).
   559     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  12
* EL1278.cbl
   561*                            COPY ERCCNOT.
   562******************************************************************
   563*                                                                *
   564*                            ERCCNOT                             *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.003                          *
   567*                                                                *
   568*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   569*                                                                *
   570*        FILE TYPE= VSAM,KSDS                                    *
   571*        RECORD SIZE = 150    RECFORM = FIXED                    *
   572*                                                                *
   573*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   574*                                                                *
   575*        LOG = YES                                               *
   576*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   577*                                                                *
   578******************************************************************
   579*                   C H A N G E   L O G
   580*
   581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   582*-----------------------------------------------------------------
   583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   584* EFFECTIVE    NUMBER
   585*-----------------------------------------------------------------
   586* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   587******************************************************************
   588
   589 01  CERT-NOTE-FILE.
   590     12  CZ-RECORD-ID                PIC  XX.
   591         88  VALID-CZ-ID                  VALUE 'CZ'.
   592
   593     12  CZ-CONTROL-PRIMARY.
   594         16  CZ-COMPANY-CD           PIC X.
   595         16  CZ-CARRIER              PIC X.
   596         16  CZ-GROUPING.
   597             20 CZ-GROUPING-PREFIX   PIC XXX.
   598             20 CZ-GROUPING-PRIME    PIC XXX.
   599         16  CZ-STATE                PIC XX.
   600         16  CZ-ACCOUNT.
   601             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   602             20 CZ-ACCOUNT-PRIME     PIC X(6).
   603         16  CZ-CERT-EFF-DT          PIC XX.
   604         16  CZ-CERT-NO.
   605             20  CZ-CERT-PRIME       PIC X(10).
   606             20  CZ-CERT-SFX         PIC X.
   607         16  CZ-RECORD-TYPE          PIC X.
   608             88  CERT-NOTE           VALUE '1'.
   609             88  CLAIM-CERT-NOTE     VALUE '2'.
   610         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   611
   612     12  CZ-LAST-MAINT-DT            PIC XX.
   613     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   614     12  CZ-LAST-MAINT-USER          PIC X(4).
   615
   616     12  CZ-NOTE-INFORMATION.
   617         16  CZ-NOTE                 PIC X(63).
   618         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  13
* EL1278.cbl
   619******************************************************************
   620*                            COPY ELCDATE.
   621******************************************************************
   622*                                                                *
   623*                                                                *
   624*                            ELCDATE.                            *
   625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   626*                            VMOD=2.003
   627*                                                                *
   628*                                                                *
   629*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   630*                 LENGTH = 200                                   *
   631******************************************************************
   632
   633 01  DATE-CONVERSION-DATA.
   634     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   635     12  DC-OPTION-CODE                PIC X.
   636         88  BIN-TO-GREG                VALUE ' '.
   637         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   638         88  EDIT-GREG-TO-BIN           VALUE '2'.
   639         88  YMD-GREG-TO-BIN            VALUE '3'.
   640         88  MDY-GREG-TO-BIN            VALUE '4'.
   641         88  JULIAN-TO-BIN              VALUE '5'.
   642         88  BIN-PLUS-ELAPSED           VALUE '6'.
   643         88  FIND-CENTURY               VALUE '7'.
   644         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   645         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   646         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   647         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   648         88  JULIAN-TO-BIN-3            VALUE 'C'.
   649         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   650         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   651         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   652         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   653         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   654         88  CHECK-LEAP-YEAR            VALUE 'H'.
   655         88  BIN-3-TO-GREG              VALUE 'I'.
   656         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   657         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   658         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   659         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   660         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   661         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   662         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   663         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   664         88  THREE-CHARACTER-BIN
   665                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   666         88  GREGORIAN-TO-BIN
   667                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   668         88  BIN-TO-GREGORIAN
   669                  VALUES ' ' '1' 'I' '8' 'G'.
   670         88  JULIAN-TO-BINARY
   671                  VALUES '5' 'C' 'E' 'F'.
   672     12  DC-ERROR-CODE                 PIC X.
   673         88  NO-CONVERSION-ERROR        VALUE ' '.
   674         88  DATE-CONVERSION-ERROR
   675                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   676         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  14
* EL1278.cbl
   677         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   678         88  DATE-IS-INVALID            VALUE '3'.
   679         88  DATE1-GREATER-DATE2        VALUE '4'.
   680         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   681         88  DATE-INVALID-OPTION        VALUE '9'.
   682         88  INVALID-CENTURY            VALUE 'A'.
   683         88  ONLY-CENTURY               VALUE 'B'.
   684         88  ONLY-LEAP-YEAR             VALUE 'C'.
   685         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   686     12  DC-END-OF-MONTH               PIC X.
   687         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   688     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   689         88  USE-NORMAL-PROCESS         VALUE ' '.
   690         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   691         88  ADJUST-UP-100-YRS          VALUE '2'.
   692     12  FILLER                        PIC X.
   693     12  DC-CONVERSION-DATES.
   694         16  DC-BIN-DATE-1             PIC XX.
   695         16  DC-BIN-DATE-2             PIC XX.
   696         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   697         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   698                       DC-GREG-DATE-1-EDIT.
   699             20  DC-EDIT1-MONTH        PIC 99.
   700             20  SLASH1-1              PIC X.
   701             20  DC-EDIT1-DAY          PIC 99.
   702             20  SLASH1-2              PIC X.
   703             20  DC-EDIT1-YEAR         PIC 99.
   704         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   705         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   706                     DC-GREG-DATE-2-EDIT.
   707             20  DC-EDIT2-MONTH        PIC 99.
   708             20  SLASH2-1              PIC X.
   709             20  DC-EDIT2-DAY          PIC 99.
   710             20  SLASH2-2              PIC X.
   711             20  DC-EDIT2-YEAR         PIC 99.
   712         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   713         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   714                     DC-GREG-DATE-1-YMD.
   715             20  DC-YMD-YEAR           PIC 99.
   716             20  DC-YMD-MONTH          PIC 99.
   717             20  DC-YMD-DAY            PIC 99.
   718         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   719         16  DC-GREG-DATE-1-MDY-R REDEFINES
   720                      DC-GREG-DATE-1-MDY.
   721             20  DC-MDY-MONTH          PIC 99.
   722             20  DC-MDY-DAY            PIC 99.
   723             20  DC-MDY-YEAR           PIC 99.
   724         16  DC-GREG-DATE-1-ALPHA.
   725             20  DC-ALPHA-MONTH        PIC X(10).
   726             20  DC-ALPHA-DAY          PIC 99.
   727             20  FILLER                PIC XX.
   728             20  DC-ALPHA-CENTURY.
   729                 24 DC-ALPHA-CEN-N     PIC 99.
   730             20  DC-ALPHA-YEAR         PIC 99.
   731         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   732         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   733         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   734         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  15
* EL1278.cbl
   735         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   736                                       PIC 9(05).
   737         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   738             20  DC-JULIAN-YEAR        PIC 99.
   739             20  DC-JULIAN-DAYS        PIC 999.
   740         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   741         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   742         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   743     12  DATE-CONVERSION-VARIBLES.
   744         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   745         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   746             20  FILLER                PIC 9(3).
   747             20  HOLD-CEN-1-CCYY.
   748                 24  HOLD-CEN-1-CC     PIC 99.
   749                 24  HOLD-CEN-1-YY     PIC 99.
   750             20  HOLD-CEN-1-MO         PIC 99.
   751             20  HOLD-CEN-1-DA         PIC 99.
   752         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   753             20  HOLD-CEN-1-R-MO       PIC 99.
   754             20  HOLD-CEN-1-R-DA       PIC 99.
   755             20  HOLD-CEN-1-R-CCYY.
   756                 24  HOLD-CEN-1-R-CC   PIC 99.
   757                 24  HOLD-CEN-1-R-YY   PIC 99.
   758             20  FILLER                PIC 9(3).
   759         16  HOLD-CENTURY-1-X.
   760             20  FILLER                PIC X(3)  VALUE SPACES.
   761             20  HOLD-CEN-1-X-CCYY.
   762                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   763                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   764             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   765             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   766         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   767             20  HOLD-CEN-1-R-X-MO     PIC XX.
   768             20  HOLD-CEN-1-R-X-DA     PIC XX.
   769             20  HOLD-CEN-1-R-X-CCYY.
   770                 24  HOLD-CEN-1-R-X-CC PIC XX.
   771                 24  HOLD-CEN-1-R-X-YY PIC XX.
   772             20  FILLER                PIC XXX.
   773         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   774         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   775         16  DC-JULIAN-DATE-1          PIC 9(07).
   776         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   777             20  DC-JULIAN-1-CCYY.
   778                 24  DC-JULIAN-1-CC    PIC 99.
   779                 24  DC-JULIAN-1-YR    PIC 99.
   780             20  DC-JULIAN-DA-1        PIC 999.
   781         16  DC-JULIAN-DATE-2          PIC 9(07).
   782         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   783             20  DC-JULIAN-2-CCYY.
   784                 24  DC-JULIAN-2-CC    PIC 99.
   785                 24  DC-JULIAN-2-YR    PIC 99.
   786             20  DC-JULIAN-DA-2        PIC 999.
   787         16  DC-GREG-DATE-A-EDIT.
   788             20  DC-EDITA-MONTH        PIC 99.
   789             20  SLASHA-1              PIC X VALUE '/'.
   790             20  DC-EDITA-DAY          PIC 99.
   791             20  SLASHA-2              PIC X VALUE '/'.
   792             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  16
* EL1278.cbl
   793                 24  DC-EDITA-CENT     PIC 99.
   794                 24  DC-EDITA-YEAR     PIC 99.
   795         16  DC-GREG-DATE-B-EDIT.
   796             20  DC-EDITB-MONTH        PIC 99.
   797             20  SLASHB-1              PIC X VALUE '/'.
   798             20  DC-EDITB-DAY          PIC 99.
   799             20  SLASHB-2              PIC X VALUE '/'.
   800             20  DC-EDITB-CCYY.
   801                 24  DC-EDITB-CENT     PIC 99.
   802                 24  DC-EDITB-YEAR     PIC 99.
   803         16  DC-GREG-DATE-CYMD         PIC 9(08).
   804         16  DC-GREG-DATE-CYMD-R REDEFINES
   805                              DC-GREG-DATE-CYMD.
   806             20  DC-CYMD-CEN           PIC 99.
   807             20  DC-CYMD-YEAR          PIC 99.
   808             20  DC-CYMD-MONTH         PIC 99.
   809             20  DC-CYMD-DAY           PIC 99.
   810         16  DC-GREG-DATE-MDCY         PIC 9(08).
   811         16  DC-GREG-DATE-MDCY-R REDEFINES
   812                              DC-GREG-DATE-MDCY.
   813             20  DC-MDCY-MONTH         PIC 99.
   814             20  DC-MDCY-DAY           PIC 99.
   815             20  DC-MDCY-CEN           PIC 99.
   816             20  DC-MDCY-YEAR          PIC 99.
   817    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   818        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   819    12  DC-EL310-DATE                  PIC X(21).
   820    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  17
* EL1278.cbl
   822*                            COPY ELCLOGOF.
   823******************************************************************
   824*                                                                *
   825*                                                                *
   826*                            ELCLOGOF.                           *
   827*                            VMOD=2.001                          *
   828*                                                                *
   829*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   830*                                                                *
   831******************************************************************
   832 01  CLASIC-LOGOFF.
   833     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   834     12  LOGOFF-TEXT.
   835         16  FILLER          PIC X(5)    VALUE SPACES.
   836         16  LOGOFF-MSG.
   837             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   838             20  FILLER      PIC X       VALUE SPACES.
   839             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   840         16  FILLER          PIC X(80)
   841           VALUE '* YOU ARE NOW LOGGED OFF'.
   842         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   843         16  FILLER          PIC X       VALUE QUOTE.
   844         16  LOGOFF-SYS-MSG  PIC X(17)
   845           VALUE 'S CLAS-IC SYSTEM '.
   846     12  TEXT-MESSAGES.
   847         16  UNACCESS-MSG    PIC X(29)
   848             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   849         16  PGMIDERR-MSG    PIC X(17)
   850             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  18
* EL1278.cbl
   852*                            COPY ELCATTR.
   853******************************************************************
   854*                                                                *
   855*                            ELCATTR.                            *
   856*                            VMOD=2.001                          *
   857*                                                                *
   858*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   859*                                                                *
   860*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   861*                                                                *
   862*                   POS 1   P=PROTECTED                          *
   863*                           U=UNPROTECTED                        *
   864*                           S=ASKIP                              *
   865*                   POS 2   A=ALPHA/NUMERIC                      *
   866*                           N=NUMERIC                            *
   867*                   POS 3   N=NORMAL                             *
   868*                           B=BRIGHT                             *
   869*                           D=DARK                               *
   870*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   871*                           OF=MODIFIED DATA TAG OFF             *
   872*                                                                *
   873*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   874******************************************************************
   875 01  ATTRIBUTE-LIST.
   876     12  AL-PABOF            PIC X       VALUE 'Y'.
   877     12  AL-PABON            PIC X       VALUE 'Z'.
   878     12  AL-PADOF            PIC X       VALUE '%'.
   879     12  AL-PADON            PIC X       VALUE '_'.
   880     12  AL-PANOF            PIC X       VALUE '-'.
   881     12  AL-PANON            PIC X       VALUE '/'.
   882     12  AL-SABOF            PIC X       VALUE '8'.
   883     12  AL-SABON            PIC X       VALUE '9'.
   884     12  AL-SADOF            PIC X       VALUE '@'.
   885     12  AL-SADON            PIC X       VALUE QUOTE.
   886     12  AL-SANOF            PIC X       VALUE '0'.
   887     12  AL-SANON            PIC X       VALUE '1'.
   888     12  AL-UABOF            PIC X       VALUE 'H'.
   889     12  AL-UABON            PIC X       VALUE 'I'.
   890     12  AL-UADOF            PIC X       VALUE '<'.
   891     12  AL-UADON            PIC X       VALUE '('.
   892     12  AL-UANOF            PIC X       VALUE ' '.
   893     12  AL-UANON            PIC X       VALUE 'A'.
   894     12  AL-UNBOF            PIC X       VALUE 'Q'.
   895     12  AL-UNBON            PIC X       VALUE 'R'.
   896     12  AL-UNDOF            PIC X       VALUE '*'.
   897     12  AL-UNDON            PIC X       VALUE ')'.
   898     12  AL-UNNOF            PIC X       VALUE '&'.
   899     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  19
* EL1278.cbl
   901*                            COPY ELCEMIB.
   902******************************************************************
   903*                                                                *
   904*                                                                *
   905*                            ELCEMIB.                            *
   906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   907*                            VMOD=2.005                          *
   908*                                                                *
   909*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   910*                                                                *
   911******************************************************************
   912 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   913     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   914     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   915     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   916     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   917     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   918     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   919     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   920     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   921     12  EMI-SWITCH1             PIC X        VALUE '1'.
   922         88  EMI-NO-ERRORS                    VALUE '1'.
   923         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   924         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   925     12  EMI-SWITCH2             PIC X        VALUE '1'.
   926         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   927     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   928         88  EMI-AREA1-EMPTY                  VALUE '1'.
   929         88  EMI-AREA1-FULL                   VALUE '2'.
   930     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   931         88  EMI-AREA2-EMPTY                  VALUE '1'.
   932         88  EMI-AREA2-FULL                   VALUE '2'.
   933     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   934         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   935         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   936         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   937         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   938         88  EMI-BYPASS-FATALS                VALUE 'X'.
   939     12  EMI-ERROR-LINES.
   940         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   941         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   942         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   943         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   944             20  EMI-ERR-CODES OCCURS 10 TIMES.
   945                 24  EMI-ERR-NUM         PIC X(4).
   946                 24  EMI-FILLER          PIC X.
   947                 24  EMI-SEV             PIC X.
   948                 24  FILLER              PIC X.
   949             20  FILLER                  PIC X(02).
   950     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   951         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   952             20  EMI-ERROR-NUMBER    PIC X(4).
   953             20  EMI-FILL            PIC X.
   954             20  EMI-SEVERITY        PIC X.
   955             20  FILLER              PIC X.
   956             20  EMI-ERROR-TEXT.
   957                 24  EMI-TEXT-VARIABLE   PIC X(10).
   958                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  20
* EL1278.cbl
   959     12  EMI-SEVERITY-SAVE           PIC X.
   960         88  EMI-NOTE                    VALUE 'N'.
   961         88  EMI-WARNING                 VALUE 'W'.
   962         88  EMI-FORCABLE                VALUE 'F'.
   963         88  EMI-FATAL                   VALUE 'X'.
   964     12  EMI-MESSAGE-FLAG            PIC X.
   965         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   966         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   967     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   968     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   969         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   970         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   971         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   972     12  emi-claim-no                pic x(7).
   973     12  emi-claim-type              pic x(6).
   974     12  FILLER                      PIC X(124)  VALUE SPACES.
   975     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   976     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   977     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   978     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  21
* EL1278.cbl
   980 01  WS-PASS-631.
   981     12  WS-PASS-WORK-AREA         PIC X(384).
   982     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   983     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   984*        COPY ELC631PI.
   985******************************************************************
   986*                                                                *
   987*                                                                *
   988*                            ELC631PI                            *
   989*                            VMOD=2.012                          *
   990*                                                                *
   991*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   992*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   993*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   994*                                                                *
   995*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   996*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   997*    BETWEEN PROGRAMS.                                           *
   998*                                                                *
   999*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1000*                                                                *
  1001*               EL631 - EL6311 - EL6312 - EL6313                 *
  1002*                                                                *
  1003******************************************************************
  1004*                   C H A N G E   L O G
  1005*
  1006* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1007*-----------------------------------------------------------------
  1008*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1009* EFFECTIVE    NUMBER
  1010*-----------------------------------------------------------------
  1011* 021414    2003053000001  PEMA  changes for auto chk request
  1012******************************************************************
  1013
  1014         16  PI-631-DATA.
  1015             20  PI-ERPNDB-KEY.
  1016                 24  PI-PB-COMPANY-CD     PIC X.
  1017                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1018                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1019                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1020
  1021             20  PI-ERPNDB-ALT-KEY.
  1022                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1023                 24  PI-PB-CARRIER        PIC X.
  1024                 24  PI-PB-GROUPING       PIC X(6).
  1025                 24  PI-PB-STATE          PIC XX.
  1026                 24  PI-PB-ACCOUNT        PIC X(10).
  1027                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1028                 24  PI-PB-CERT-NO.
  1029                     28  PI-PB-CERT-PRIME PIC X(10).
  1030                     28  PI-PB-CERT-SFX   PIC X.
  1031                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1032                 24  PI-PB-RECORD-TYPE    PIC X.
  1033
  1034             20  PI-ERPNDB-CSR-KEY.
  1035                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1036                 24  PI-PB-CSR-ID             PIC X(4).
  1037                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  22
* EL1278.cbl
  1038                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1039                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1040
  1041             20  PI-BROWSE-TYPE               PIC X.
  1042                 88  PI-FILE-BROWSE             VALUE ' '.
  1043                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1044                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1045                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1046                 88  PI-CSR-BROWSE              VALUE '4'.
  1047
  1048             20  PI-MAINT-FUNCTION            PIC X.
  1049                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1050                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1051                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1052                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1053                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1054                 88  PI-PF5-FUNCTION            VALUE '5'.
  1055                 88  PI-PF6-FUNCTION            VALUE '6'.
  1056
  1057             20  PI-FILE-SWITCHES.
  1058                 24  PI-ALL-ISSUES-SW         PIC X.
  1059                     88  ALL-ISSUES             VALUE 'Y'.
  1060                 24  PI-ALL-CANCELS-SW        PIC X.
  1061                     88  ALL-CANCELS            VALUE 'Y'.
  1062                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1063                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1064                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1065                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1066                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1067                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1068                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1069                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1070                 24  PI-HOLD-REC-SW           PIC X.
  1071                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1072                 24  PI-CHANGE-REC-SW         PIC X.
  1073                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1074                 24  PI-CHK-REQ-REC-SW        PIC X.
  1075                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1076                 24  PI-ISSUE-WARNING-SW      PIC X.
  1077                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1078                 24  PI-CANCEL-WARNING-SW     PIC X.
  1079                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1080             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1081                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1082             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1083                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1084
  1085             20  PI-MAP-NAME                  PIC X(8).
  1086
  1087             20  PI-CURSOR                    PIC S9(4) COMP.
  1088
  1089             20  PI-PREV-ALT-KEY              PIC X(36).
  1090             20  PI-PREV-CSR-KEY              PIC X(15).
  1091             20  PI-PREV-KEY.
  1092                 24  PI-PREV-COMPANY-CD       PIC X.
  1093                 24  PI-PREV-BATCH            PIC X(6).
  1094                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1095                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  23
* EL1278.cbl
  1096             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1097             20  PI-BROWSE-SW                 PIC X.
  1098                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1099                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1100             20  PI-SV-CARRIER                PIC X.
  1101             20  PI-SV-GROUPING               PIC X(6).
  1102             20  PI-SV-STATE                  PIC XX.
  1103             20  PI-EDIT-SW                   PIC X.
  1104             20  PI-DISPLAY-SW                PIC XX.
  1105                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1106                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1107             20  PI-CRITERIA-DATA             PIC X(350).
  1108             20  PI-BMODE                     PIC X.
  1109             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1110             20  PI-BPMTS                     PIC S999     COMP-3.
  1111             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1112             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1113             20  PI-CSR-SESSION-SW            PIC X.
  1114                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1115             20  PI-ERRORS-SW                 PIC X.
  1116                 88  FATAL-ERRORS               VALUE 'X'.
  1117*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1118             20  pi-unforced-sw               pic x.
  1119                 88  unforced-errors            value 'X'.
  1120             20  FILLER                       PIC X(4).
  1121
  1122         16  FILLER                PIC X(94).
  1123
  1124
  1125*                            COPY ELCINTF.
  1126******************************************************************
  1127*                                                                *
  1128*                                                                *
  1129*                            ELCINTF.                            *
  1130*                            VMOD=2.017                          *
  1131*                                                                *
  1132*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1133*                                                                *
  1134*       LENGTH = 1024                                            *
  1135*                                                                *
  1136******************************************************************
  1137*                   C H A N G E   L O G
  1138*
  1139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1140*-----------------------------------------------------------------
  1141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1142* EFFECTIVE    NUMBER
  1143*-----------------------------------------------------------------
  1144* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1145******************************************************************
  1146 01  PROGRAM-INTERFACE-BLOCK.
  1147     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1148     12  PI-CALLING-PROGRAM              PIC X(8).
  1149     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1150     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1151     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1152     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1153     12  PI-SAVED-PROGRAM-5              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  24
* EL1278.cbl
  1154     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1155     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1156     12  PI-COMPANY-ID                   PIC XXX.
  1157     12  PI-COMPANY-CD                   PIC X.
  1158
  1159     12  PI-COMPANY-PASSWORD             PIC X(8).
  1160
  1161     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1162
  1163     12  PI-CONTROL-IN-PROGRESS.
  1164         16  PI-CARRIER                  PIC X.
  1165         16  PI-GROUPING                 PIC X(6).
  1166         16  PI-STATE                    PIC XX.
  1167         16  PI-ACCOUNT                  PIC X(10).
  1168         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1169                                         PIC X(10).
  1170         16  PI-CLAIM-CERT-GRP.
  1171             20  PI-CLAIM-NO             PIC X(7).
  1172             20  PI-CERT-NO.
  1173                 25  PI-CERT-PRIME       PIC X(10).
  1174                 25  PI-CERT-SFX         PIC X.
  1175             20  PI-CERT-EFF-DT          PIC XX.
  1176         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1177             20  PI-PLAN-CODE            PIC X(2).
  1178             20  PI-REVISION-NUMBER      PIC X(3).
  1179             20  PI-PLAN-EFF-DT          PIC X(2).
  1180             20  PI-PLAN-EXP-DT          PIC X(2).
  1181             20  FILLER                  PIC X(11).
  1182         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1183             20  PI-OE-REFERENCE-1.
  1184                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1185                 25  PI-OE-REF-1-SUFF    PIC XX.
  1186
  1187     12  PI-SESSION-IN-PROGRESS          PIC X.
  1188         88  CLAIM-SESSION                   VALUE '1'.
  1189         88  CREDIT-SESSION                  VALUE '2'.
  1190         88  WARRANTY-SESSION                VALUE '3'.
  1191         88  MORTGAGE-SESSION                VALUE '4'.
  1192         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1193
  1194
  1195*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1196
  1197     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1198     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1199
  1200     12  PI-CREDIT-USER                  PIC X.
  1201         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1202         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1203
  1204     12  PI-CLAIM-USER                   PIC X.
  1205         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1206         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1207
  1208     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1209         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1210         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1211         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  25
* EL1278.cbl
  1212         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1213         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1214
  1215     12  PI-PROCESSOR-ID                 PIC X(4).
  1216
  1217     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1218
  1219     12  PI-MEMBER-CAPTION               PIC X(10).
  1220
  1221     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1222         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1223
  1224     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1225     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1226     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1227     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1228
  1229     12  PI-AH-OVERRIDE-L1               PIC X.
  1230     12  PI-AH-OVERRIDE-L2               PIC XX.
  1231     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1232     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1233
  1234     12  PI-NEW-SYSTEM                   PIC X(2).
  1235
  1236     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1237     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1238         88  PI-USES-PAID-TO                 VALUE '1'.
  1239     12  PI-CRDTCRD-SYSTEM.
  1240         16  PI-CRDTCRD-USER             PIC X.
  1241             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1242             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1243         16  PI-CC-MONTH-END-DT          PIC XX.
  1244     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1245
  1246     12  PI-OE-REFERENCE-2.
  1247         16  PI-OE-REF-2-PRIME           PIC X(10).
  1248         16  PI-OE-REF-2-SUFF            PIC X.
  1249
  1250     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1251
  1252     12  PI-LANGUAGE-TYPE                PIC X.
  1253             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1254             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1255             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1256
  1257     12  PI-POLICY-LINKAGE-IND           PIC X.
  1258         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1259         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1260                                                   LOW-VALUES.
  1261
  1262     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1263     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1264         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1265         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1266
  1267     12  PI-PROCESSOR-CSR-IND            PIC X.
  1268         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1269         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  26
* EL1278.cbl
  1270
  1271     12  FILLER                          PIC X(3).
  1272
  1273     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1274
  1275     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1276         PI-SYSTEM-LEVEL.
  1277
  1278         16  PI-ENTRY-CODES.
  1279             20  PI-ENTRY-CD-1           PIC X.
  1280             20  PI-ENTRY-CD-2           PIC X.
  1281
  1282         16  PI-RETURN-CODES.
  1283             20  PI-RETURN-CD-1          PIC X.
  1284             20  PI-RETURN-CD-2          PIC X.
  1285
  1286         16  PI-UPDATE-STATUS-SAVE.
  1287             20  PI-UPDATE-BY            PIC X(4).
  1288             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1289
  1290         16  PI-LOWER-CASE-LETTERS       PIC X.
  1291             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1292
  1293*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1294*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1295*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1296
  1297         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1298             88  ST-ACCNT-CNTL               VALUE ' '.
  1299             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1300             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1301             88  ACCNT-CNTL                  VALUE '3'.
  1302             88  CARR-ACCNT-CNTL             VALUE '4'.
  1303
  1304         16  PI-PROCESSOR-CAP-LIST.
  1305             20  PI-SYSTEM-CONTROLS.
  1306                24 PI-SYSTEM-DISPLAY     PIC X.
  1307                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1308                24 PI-SYSTEM-MODIFY      PIC X.
  1309                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1310             20  FILLER                  PIC XX.
  1311             20  PI-DISPLAY-CAP          PIC X.
  1312                 88  DISPLAY-CAP             VALUE 'Y'.
  1313             20  PI-MODIFY-CAP           PIC X.
  1314                 88  MODIFY-CAP              VALUE 'Y'.
  1315             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1316                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1317             20  PI-FORCE-CAP            PIC X.
  1318                 88  FORCE-CAP               VALUE 'Y'.
  1319
  1320         16  PI-PROGRAM-CONTROLS.
  1321             20  PI-PGM-PRINT-OPT        PIC X.
  1322             20  PI-PGM-FORMAT-OPT       PIC X.
  1323             20  PI-PGM-PROCESS-OPT      PIC X.
  1324             20  PI-PGM-TOTALS-OPT       PIC X.
  1325
  1326         16  PI-HELP-INTERFACE.
  1327             20  PI-LAST-ERROR-NO        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  27
* EL1278.cbl
  1328             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1329
  1330         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1331             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1332
  1333         16  PI-CR-CONTROL-IN-PROGRESS.
  1334             20  PI-CR-CARRIER           PIC X.
  1335             20  PI-CR-GROUPING          PIC X(6).
  1336             20  PI-CR-STATE             PIC XX.
  1337             20  PI-CR-ACCOUNT           PIC X(10).
  1338             20  PI-CR-FIN-RESP          PIC X(10).
  1339             20  PI-CR-TYPE              PIC X.
  1340
  1341         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1342
  1343         16  PI-CR-MONTH-END-DT          PIC XX.
  1344
  1345         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1346             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1347             88  PI-ZERO-CARRIER             VALUE '1'.
  1348             88  PI-ZERO-GROUPING            VALUE '2'.
  1349             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1350
  1351         16  PI-CARRIER-SECURITY         PIC X.
  1352             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1353
  1354         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1355             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1356             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1357
  1358         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1359             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1360                                         INDEXED BY PI-ACCESS-NDX
  1361                                         PIC X.
  1362
  1363         16  PI-GA-BILLING-CONTROL       PIC X.
  1364             88  PI-GA-BILLING               VALUE '1'.
  1365
  1366         16  PI-MAIL-PROCESSING          PIC X.
  1367             88  PI-MAIL-YES                 VALUE 'Y'.
  1368
  1369         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1370
  1371         16  PI-AR-SYSTEM.
  1372             20  PI-AR-PROCESSING-CNTL   PIC X.
  1373                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1374             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1375             20  PI-AR-MONTH-END-DT      PIC XX.
  1376
  1377         16  PI-MP-SYSTEM.
  1378             20  PI-MORTGAGE-USER            PIC X.
  1379                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1380                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1381             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1382                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1383                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1384                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1385                 88  PI-MP-PROD-CNTL                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  28
* EL1278.cbl
  1386                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1387             20  PI-MP-MONTH-END-DT          PIC XX.
  1388             20  PI-MP-REFERENCE-NO.
  1389                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1390                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1391
  1392         16  PI-LABEL-CONTROL            PIC X(01).
  1393             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1394             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1395
  1396         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1397             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1398
  1399         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1400             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1401             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1402
  1403         16  FILLER                      PIC X(14).
  1404
  1405     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1406******************************************************************
  1407     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1408         16  FILLER                PIC  X(500).
  1409         16  PI-PEND-SW            PIC  X(01).
  1410         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1411         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1412         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1413         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1414         16  PI-EARNING-METHOD-LF  PIC  X.
  1415         16  PI-EARNING-METHOD-AH  PIC  X.
  1416         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1417         16  PI-LF-REFUND-METH     PIC  X.
  1418         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1419         16  PI-AH-REFUND-METH     PIC  X.
  1420         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1421         16  PI-MODIFY-CERT-CAP    PIC  X.
  1422             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1423         16  PI-CLP-YN             PIC X.
  1424         16  PI-CANCEL-REASON      PIC X.
  1425         16  PI-PF10-OK            PIC X.
  1426         16  FILLER                PIC  X(96).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  29
* EL1278.cbl
  1428*                            COPY ELCAID.
  1429******************************************************************
  1430*                                                                *
  1431*                            ELCAID.                             *
  1432*                            VMOD=2.001                          *
  1433*                                                                *
  1434*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1435*                                                                *
  1436*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1437*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1438******************************************************************
  1439
  1440 01  DFHAID.
  1441   02  DFHNULL   PIC  X  VALUE  ' '.
  1442   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1443   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1444   02  DFHPEN    PIC  X  VALUE  '='.
  1445   02  DFHOPID   PIC  X  VALUE  'W'.
  1446   02  DFHPA1    PIC  X  VALUE  '%'.
  1447   02  DFHPA2    PIC  X  VALUE  '>'.
  1448   02  DFHPA3    PIC  X  VALUE  ','.
  1449   02  DFHPF1    PIC  X  VALUE  '1'.
  1450   02  DFHPF2    PIC  X  VALUE  '2'.
  1451   02  DFHPF3    PIC  X  VALUE  '3'.
  1452   02  DFHPF4    PIC  X  VALUE  '4'.
  1453   02  DFHPF5    PIC  X  VALUE  '5'.
  1454   02  DFHPF6    PIC  X  VALUE  '6'.
  1455   02  DFHPF7    PIC  X  VALUE  '7'.
  1456   02  DFHPF8    PIC  X  VALUE  '8'.
  1457   02  DFHPF9    PIC  X  VALUE  '9'.
  1458   02  DFHPF10   PIC  X  VALUE  ':'.
  1459   02  DFHPF11   PIC  X  VALUE  '#'.
  1460   02  DFHPF12   PIC  X  VALUE  '@'.
  1461   02  DFHPF13   PIC  X  VALUE  'A'.
  1462   02  DFHPF14   PIC  X  VALUE  'B'.
  1463   02  DFHPF15   PIC  X  VALUE  'C'.
  1464   02  DFHPF16   PIC  X  VALUE  'D'.
  1465   02  DFHPF17   PIC  X  VALUE  'E'.
  1466   02  DFHPF18   PIC  X  VALUE  'F'.
  1467   02  DFHPF19   PIC  X  VALUE  'G'.
  1468   02  DFHPF20   PIC  X  VALUE  'H'.
  1469   02  DFHPF21   PIC  X  VALUE  'I'.
  1470*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1471   02  DFHPF22   PIC  X  VALUE  '['.
  1472   02  DFHPF23   PIC  X  VALUE  '.'.
  1473   02  DFHPF24   PIC  X  VALUE  '<'.
  1474   02  DFHMSRE   PIC  X  VALUE  'X'.
  1475   02  DFHSTRF   PIC  X  VALUE  'h'.
  1476   02  DFHTRIG   PIC  X  VALUE  '"'.
  1477
  1478 01  FILLER  REDEFINES  DFHAID.
  1479     12  FILLER                  PIC  X(08).
  1480     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  30
* EL1278.cbl
  1482*                            COPY EL1278S.
  1483 01  EL127HI.
  1484     05  FILLER            PIC  X(0012).
  1485*    -------------------------------
  1486     05  HDATEL PIC S9(0004) COMP.
  1487     05  HDATEF PIC  X(0001).
  1488     05  FILLER REDEFINES HDATEF.
  1489         10  HDATEA PIC  X(0001).
  1490     05  HDATEI PIC  X(0008).
  1491*    -------------------------------
  1492     05  HTIMEL PIC S9(0004) COMP.
  1493     05  HTIMEF PIC  X(0001).
  1494     05  FILLER REDEFINES HTIMEF.
  1495         10  HTIMEA PIC  X(0001).
  1496     05  HTIMEI PIC  999V99.
  1497*    -------------------------------
  1498     05  CMPNYIDL PIC S9(0004) COMP.
  1499     05  CMPNYIDF PIC  X(0001).
  1500     05  FILLER REDEFINES CMPNYIDF.
  1501         10  CMPNYIDA PIC  X(0001).
  1502     05  CMPNYIDI PIC  X(0003).
  1503*    -------------------------------
  1504     05  USERIDL PIC S9(0004) COMP.
  1505     05  USERIDF PIC  X(0001).
  1506     05  FILLER REDEFINES USERIDF.
  1507         10  USERIDA PIC  X(0001).
  1508     05  USERIDI PIC  X(0004).
  1509*    -------------------------------
  1510     05  HCARIERL PIC S9(0004) COMP.
  1511     05  HCARIERF PIC  X(0001).
  1512     05  FILLER REDEFINES HCARIERF.
  1513         10  HCARIERA PIC  X(0001).
  1514     05  HCARIERI PIC  X(0001).
  1515*    -------------------------------
  1516     05  HGROUPL PIC S9(0004) COMP.
  1517     05  HGROUPF PIC  X(0001).
  1518     05  FILLER REDEFINES HGROUPF.
  1519         10  HGROUPA PIC  X(0001).
  1520     05  HGROUPI PIC  X(0006).
  1521*    -------------------------------
  1522     05  HSTATEL PIC S9(0004) COMP.
  1523     05  HSTATEF PIC  X(0001).
  1524     05  FILLER REDEFINES HSTATEF.
  1525         10  HSTATEA PIC  X(0001).
  1526     05  HSTATEI PIC  X(0002).
  1527*    -------------------------------
  1528     05  HACCTNOL PIC S9(0004) COMP.
  1529     05  HACCTNOF PIC  X(0001).
  1530     05  FILLER REDEFINES HACCTNOF.
  1531         10  HACCTNOA PIC  X(0001).
  1532     05  HACCTNOI PIC  X(0010).
  1533*    -------------------------------
  1534     05  HEFFDTL PIC S9(0004) COMP.
  1535     05  HEFFDTF PIC  X(0001).
  1536     05  FILLER REDEFINES HEFFDTF.
  1537         10  HEFFDTA PIC  X(0001).
  1538     05  HEFFDTI PIC  X(0008).
  1539*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  31
* EL1278.cbl
  1540     05  HCERTNOL PIC S9(0004) COMP.
  1541     05  HCERTNOF PIC  X(0001).
  1542     05  FILLER REDEFINES HCERTNOF.
  1543         10  HCERTNOA PIC  X(0001).
  1544     05  HCERTNOI PIC  X(0010).
  1545*    -------------------------------
  1546     05  HCRTSFXL PIC S9(0004) COMP.
  1547     05  HCRTSFXF PIC  X(0001).
  1548     05  FILLER REDEFINES HCRTSFXF.
  1549         10  HCRTSFXA PIC  X(0001).
  1550     05  HCRTSFXI PIC  X(0001).
  1551*    -------------------------------
  1552     05  HLNAMEL PIC S9(0004) COMP.
  1553     05  HLNAMEF PIC  X(0001).
  1554     05  FILLER REDEFINES HLNAMEF.
  1555         10  HLNAMEA PIC  X(0001).
  1556     05  HLNAMEI PIC  X(0015).
  1557*    -------------------------------
  1558     05  HFNAMEL PIC S9(0004) COMP.
  1559     05  HFNAMEF PIC  X(0001).
  1560     05  FILLER REDEFINES HFNAMEF.
  1561         10  HFNAMEA PIC  X(0001).
  1562     05  HFNAMEI PIC  X(0010).
  1563*    -------------------------------
  1564     05  HINITL PIC S9(0004) COMP.
  1565     05  HINITF PIC  X(0001).
  1566     05  FILLER REDEFINES HINITF.
  1567         10  HINITA PIC  X(0001).
  1568     05  HINITI PIC  X(0001).
  1569*    -------------------------------
  1570     05  LCLMDTHL PIC S9(0004) COMP.
  1571     05  LCLMDTHF PIC  X(0001).
  1572     05  FILLER REDEFINES LCLMDTHF.
  1573         10  LCLMDTHA PIC  X(0001).
  1574     05  LCLMDTHI PIC  X(0022).
  1575*    -------------------------------
  1576     05  LCLMDTL PIC S9(0004) COMP.
  1577     05  LCLMDTF PIC  X(0001).
  1578     05  FILLER REDEFINES LCLMDTF.
  1579         10  LCLMDTA PIC  X(0001).
  1580     05  LCLMDTI PIC  X(0008).
  1581*    -------------------------------
  1582     05  HPCYNL PIC S9(0004) COMP.
  1583     05  HPCYNF PIC  X(0001).
  1584     05  FILLER REDEFINES HPCYNF.
  1585         10  HPCYNA PIC  X(0001).
  1586     05  HPCYNI PIC  X(0001).
  1587*    -------------------------------
  1588     05  ACLMDTHL PIC S9(0004) COMP.
  1589     05  ACLMDTHF PIC  X(0001).
  1590     05  FILLER REDEFINES ACLMDTHF.
  1591         10  ACLMDTHA PIC  X(0001).
  1592     05  ACLMDTHI PIC  X(0023).
  1593*    -------------------------------
  1594     05  ACLMDTL PIC S9(0004) COMP.
  1595     05  ACLMDTF PIC  X(0001).
  1596     05  FILLER REDEFINES ACLMDTF.
  1597         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  32
* EL1278.cbl
  1598     05  ACLMDTI PIC  X(0008).
  1599*    -------------------------------
  1600     05  PMTHDL PIC S9(0004) COMP.
  1601     05  PMTHDF PIC  X(0001).
  1602     05  FILLER REDEFINES PMTHDF.
  1603         10  PMTHDA PIC  X(0001).
  1604     05  PMTHDI PIC  X(0010).
  1605*    -------------------------------
  1606     05  CNCDTHDL PIC S9(0004) COMP.
  1607     05  CNCDTHDF PIC  X(0001).
  1608     05  FILLER REDEFINES CNCDTHDF.
  1609         10  CNCDTHDA PIC  X(0001).
  1610     05  CNCDTHDI PIC  X(0007).
  1611*    -------------------------------
  1612     05  HLKINDL PIC S9(0004) COMP.
  1613     05  HLKINDF PIC  X(0001).
  1614     05  FILLER REDEFINES HLKINDF.
  1615         10  HLKINDA PIC  X(0001).
  1616     05  HLKINDI PIC  X(0002).
  1617*    -------------------------------
  1618     05  HLCDL PIC S9(0004) COMP.
  1619     05  HLCDF PIC  X(0001).
  1620     05  FILLER REDEFINES HLCDF.
  1621         10  HLCDA PIC  X(0001).
  1622     05  HLCDI PIC  X(0002).
  1623*    -------------------------------
  1624     05  HLEDESCL PIC S9(0004) COMP.
  1625     05  HLEDESCF PIC  X(0001).
  1626     05  FILLER REDEFINES HLEDESCF.
  1627         10  HLEDESCA PIC  X(0001).
  1628     05  HLEDESCI PIC  X(0003).
  1629*    -------------------------------
  1630     05  HLTERML PIC S9(0004) COMP.
  1631     05  HLTERMF PIC  X(0001).
  1632     05  FILLER REDEFINES HLTERMF.
  1633         10  HLTERMA PIC  X(0001).
  1634     05  HLTERMI PIC  9(3).
  1635*    -------------------------------
  1636     05  HLREML PIC S9(0004) COMP.
  1637     05  HLREMF PIC  X(0001).
  1638     05  FILLER REDEFINES HLREMF.
  1639         10  HLREMA PIC  X(0001).
  1640     05  HLREMI PIC  X(0003).
  1641*    -------------------------------
  1642     05  HLPREML PIC S9(0004) COMP.
  1643     05  HLPREMF PIC  X(0001).
  1644     05  FILLER REDEFINES HLPREMF.
  1645         10  HLPREMA PIC  X(0001).
  1646     05  HLPREMI PIC  X(0011).
  1647*    -------------------------------
  1648     05  HLITDRL PIC S9(0004) COMP.
  1649     05  HLITDRF PIC  X(0001).
  1650     05  FILLER REDEFINES HLITDRF.
  1651         10  HLITDRA PIC  X(0001).
  1652     05  HLITDRI PIC  X(0011).
  1653*    -------------------------------
  1654     05  HLREFNDL PIC S9(0004) COMP.
  1655     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  33
* EL1278.cbl
  1656     05  FILLER REDEFINES HLREFNDF.
  1657         10  HLREFNDA PIC  X(0001).
  1658     05  HLREFNDI PIC  X(0011).
  1659*    -------------------------------
  1660     05  HLCANCL PIC S9(0004) COMP.
  1661     05  HLCANCF PIC  X(0001).
  1662     05  FILLER REDEFINES HLCANCF.
  1663         10  HLCANCA PIC  X(0001).
  1664     05  HLCANCI PIC  X(0008).
  1665*    -------------------------------
  1666     05  HLCAL1L PIC S9(0004) COMP.
  1667     05  HLCAL1F PIC  X(0001).
  1668     05  FILLER REDEFINES HLCAL1F.
  1669         10  HLCAL1A PIC  X(0001).
  1670     05  HLCAL1I PIC  X(0001).
  1671*    -------------------------------
  1672     05  HLCALCL PIC S9(0004) COMP.
  1673     05  HLCALCF PIC  X(0001).
  1674     05  FILLER REDEFINES HLCALCF.
  1675         10  HLCALCA PIC  X(0001).
  1676     05  HLCALCI PIC  X(0012).
  1677*    -------------------------------
  1678     05  HAKINDL PIC S9(0004) COMP.
  1679     05  HAKINDF PIC  X(0001).
  1680     05  FILLER REDEFINES HAKINDF.
  1681         10  HAKINDA PIC  X(0001).
  1682     05  HAKINDI PIC  X(0002).
  1683*    -------------------------------
  1684     05  HACDL PIC S9(0004) COMP.
  1685     05  HACDF PIC  X(0001).
  1686     05  FILLER REDEFINES HACDF.
  1687         10  HACDA PIC  X(0001).
  1688     05  HACDI PIC  X(0002).
  1689*    -------------------------------
  1690     05  HAEDESCL PIC S9(0004) COMP.
  1691     05  HAEDESCF PIC  X(0001).
  1692     05  FILLER REDEFINES HAEDESCF.
  1693         10  HAEDESCA PIC  X(0001).
  1694     05  HAEDESCI PIC  X(0003).
  1695*    -------------------------------
  1696     05  HATERML PIC S9(0004) COMP.
  1697     05  HATERMF PIC  X(0001).
  1698     05  FILLER REDEFINES HATERMF.
  1699         10  HATERMA PIC  X(0001).
  1700     05  HATERMI PIC  9(3).
  1701*    -------------------------------
  1702     05  HAREML PIC S9(0004) COMP.
  1703     05  HAREMF PIC  X(0001).
  1704     05  FILLER REDEFINES HAREMF.
  1705         10  HAREMA PIC  X(0001).
  1706     05  HAREMI PIC  X(0003).
  1707*    -------------------------------
  1708     05  HAPREML PIC S9(0004) COMP.
  1709     05  HAPREMF PIC  X(0001).
  1710     05  FILLER REDEFINES HAPREMF.
  1711         10  HAPREMA PIC  X(0001).
  1712     05  HAPREMI PIC  X(0011).
  1713*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  34
* EL1278.cbl
  1714     05  HAITDRL PIC S9(0004) COMP.
  1715     05  HAITDRF PIC  X(0001).
  1716     05  FILLER REDEFINES HAITDRF.
  1717         10  HAITDRA PIC  X(0001).
  1718     05  HAITDRI PIC  X(0011).
  1719*    -------------------------------
  1720     05  HAREFNDL PIC S9(0004) COMP.
  1721     05  HAREFNDF PIC  X(0001).
  1722     05  FILLER REDEFINES HAREFNDF.
  1723         10  HAREFNDA PIC  X(0001).
  1724     05  HAREFNDI PIC  X(0011).
  1725*    -------------------------------
  1726     05  HACANCL PIC S9(0004) COMP.
  1727     05  HACANCF PIC  X(0001).
  1728     05  FILLER REDEFINES HACANCF.
  1729         10  HACANCA PIC  X(0001).
  1730     05  HACANCI PIC  X(0008).
  1731*    -------------------------------
  1732     05  HACAL1L PIC S9(0004) COMP.
  1733     05  HACAL1F PIC  X(0001).
  1734     05  FILLER REDEFINES HACAL1F.
  1735         10  HACAL1A PIC  X(0001).
  1736     05  HACAL1I PIC  X(0001).
  1737*    -------------------------------
  1738     05  HACALCL PIC S9(0004) COMP.
  1739     05  HACALCF PIC  X(0001).
  1740     05  FILLER REDEFINES HACALCF.
  1741         10  HACALCA PIC  X(0001).
  1742     05  HACALCI PIC  X(0012).
  1743*    -------------------------------
  1744     05  CANFEEHL PIC S9(0004) COMP.
  1745     05  CANFEEHF PIC  X(0001).
  1746     05  FILLER REDEFINES CANFEEHF.
  1747         10  CANFEEHA PIC  X(0001).
  1748     05  CANFEEHI PIC  X(0012).
  1749*    -------------------------------
  1750     05  CANFEEL PIC S9(0004) COMP.
  1751     05  CANFEEF PIC  X(0001).
  1752     05  FILLER REDEFINES CANFEEF.
  1753         10  CANFEEA PIC  X(0001).
  1754     05  CANFEEI PIC  X(0006).
  1755*    -------------------------------
  1756     05  TOPREML PIC S9(0004) COMP.
  1757     05  TOPREMF PIC  X(0001).
  1758     05  FILLER REDEFINES TOPREMF.
  1759         10  TOPREMA PIC  X(0001).
  1760     05  TOPREMI PIC  X(0011).
  1761*    -------------------------------
  1762     05  TOITDRL PIC S9(0004) COMP.
  1763     05  TOITDRF PIC  X(0001).
  1764     05  FILLER REDEFINES TOITDRF.
  1765         10  TOITDRA PIC  X(0001).
  1766     05  TOITDRI PIC  X(0011).
  1767*    -------------------------------
  1768     05  TORFNDL PIC S9(0004) COMP.
  1769     05  TORFNDF PIC  X(0001).
  1770     05  FILLER REDEFINES TORFNDF.
  1771         10  TORFNDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  35
* EL1278.cbl
  1772     05  TORFNDI PIC  X(0011).
  1773*    -------------------------------
  1774     05  CANREAHL PIC S9(0004) COMP.
  1775     05  CANREAHF PIC  X(0001).
  1776     05  FILLER REDEFINES CANREAHF.
  1777         10  CANREAHA PIC  X(0001).
  1778     05  CANREAHI PIC  X(0015).
  1779*    -------------------------------
  1780     05  CANREAL PIC S9(0004) COMP.
  1781     05  CANREAF PIC  X(0001).
  1782     05  FILLER REDEFINES CANREAF.
  1783         10  CANREAA PIC  X(0001).
  1784     05  CANREAI PIC  X(0001).
  1785*    -------------------------------
  1786     05  CLPYNHL PIC S9(0004) COMP.
  1787     05  CLPYNHF PIC  X(0001).
  1788     05  FILLER REDEFINES CLPYNHF.
  1789         10  CLPYNHA PIC  X(0001).
  1790     05  CLPYNHI PIC  X(0005).
  1791*    -------------------------------
  1792     05  CLPYNL PIC S9(0004) COMP.
  1793     05  CLPYNF PIC  X(0001).
  1794     05  FILLER REDEFINES CLPYNF.
  1795         10  CLPYNA PIC  X(0001).
  1796     05  CLPYNI PIC  X(0001).
  1797*    -------------------------------
  1798     05  REFDUEHL PIC S9(0004) COMP.
  1799     05  REFDUEHF PIC  X(0001).
  1800     05  FILLER REDEFINES REFDUEHF.
  1801         10  REFDUEHA PIC  X(0001).
  1802     05  REFDUEHI PIC  X(0018).
  1803*    -------------------------------
  1804     05  REFDUEL PIC S9(0004) COMP.
  1805     05  REFDUEF PIC  X(0001).
  1806     05  FILLER REDEFINES REFDUEF.
  1807         10  REFDUEA PIC  X(0001).
  1808     05  REFDUEI PIC  X(0010).
  1809*    -------------------------------
  1810     05  HLREDL PIC S9(0004) COMP.
  1811     05  HLREDF PIC  X(0001).
  1812     05  FILLER REDEFINES HLREDF.
  1813         10  HLREDA PIC  X(0001).
  1814     05  HLREDI PIC  X(0014).
  1815*    -------------------------------
  1816     05  FREMTRML PIC S9(0004) COMP.
  1817     05  FREMTRMF PIC  X(0001).
  1818     05  FILLER REDEFINES FREMTRMF.
  1819         10  FREMTRMA PIC  X(0001).
  1820     05  FREMTRMI PIC  X(0003).
  1821*    -------------------------------
  1822     05  HERMSG1L PIC S9(0004) COMP.
  1823     05  HERMSG1F PIC  X(0001).
  1824     05  FILLER REDEFINES HERMSG1F.
  1825         10  HERMSG1A PIC  X(0001).
  1826     05  HERMSG1I PIC  X(0079).
  1827*    -------------------------------
  1828     05  HERMSG2L PIC S9(0004) COMP.
  1829     05  HERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  36
* EL1278.cbl
  1830     05  FILLER REDEFINES HERMSG2F.
  1831         10  HERMSG2A PIC  X(0001).
  1832     05  HERMSG2I PIC  X(0079).
  1833*    -------------------------------
  1834     05  HPFKEYL PIC S9(0004) COMP.
  1835     05  HPFKEYF PIC  X(0001).
  1836     05  FILLER REDEFINES HPFKEYF.
  1837         10  HPFKEYA PIC  X(0001).
  1838     05  HPFKEYI PIC  99.
  1839*    -------------------------------
  1840     05  PFKEY11L PIC S9(0004) COMP.
  1841     05  PFKEY11F PIC  X(0001).
  1842     05  FILLER REDEFINES PFKEY11F.
  1843         10  PFKEY11A PIC  X(0001).
  1844     05  PFKEY11I PIC  X(0014).
  1845 01  EL127HO REDEFINES EL127HI.
  1846     05  FILLER            PIC  X(0012).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  HDATEO PIC  X(0008).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  HTIMEO PIC  99.99.
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  CMPNYIDO PIC  X(0003).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  USERIDO PIC  X(0004).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  HCARIERO PIC  X(0001).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  HGROUPO PIC  X(0006).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  HSTATEO PIC  X(0002).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  HACCTNOO PIC  X(0010).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  HEFFDTO PIC  X(0008).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  HCERTNOO PIC  X(0010).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  HCRTSFXO PIC  X(0001).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  HLNAMEO PIC  X(0015).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  HFNAMEO PIC  X(0010).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  37
* EL1278.cbl
  1888     05  HINITO PIC  X(0001).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  LCLMDTHO PIC  X(0022).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  LCLMDTO PIC  X(0008).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  HPCYNO PIC  X(0001).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  ACLMDTHO PIC  X(0023).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  ACLMDTO PIC  X(0008).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  PMTHDO PIC  X(0010).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  CNCDTHDO PIC  X(0007).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  HLKINDO PIC  X(0002).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  HLCDO PIC  X(0002).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  HLEDESCO PIC  X(0003).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  HLTERMO PIC  ZZ9.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  HLREMO PIC  ZZ9.
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  HLCANCO PIC  X(0008).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  HLCAL1O PIC  X(0001).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  HLCALCO PIC  X(0012).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  HAKINDO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  38
* EL1278.cbl
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  HACDO PIC  X(0002).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  HAEDESCO PIC  X(0003).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  HATERMO PIC  ZZ9.
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  HAREMO PIC  ZZ9.
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  HACANCO PIC  X(0008).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  HACAL1O PIC  X(0001).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  HACALCO PIC  X(0012).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  CANFEEHO PIC  X(0012).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  CANFEEO PIC  ZZ9.99.
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  CANREAHO PIC  X(0015).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  CANREAO PIC  X(0001).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  CLPYNHO PIC  X(0005).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  CLPYNO PIC  X(0001).
  2003*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  39
* EL1278.cbl
  2004     05  FILLER            PIC  X(0003).
  2005     05  REFDUEHO PIC  X(0018).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  REFDUEO PIC  ZZZ,ZZ9.99.
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  FREMTRMO PIC  ZZ9.
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  HERMSG1O PIC  X(0079).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  HERMSG2O PIC  X(0079).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  HPFKEYO PIC  99.
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  PFKEY11O PIC  X(0014).
  2027*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  40
* EL1278.cbl
  2029*                            COPY ELCCALC.
  2030******************************************************************
  2031*                                                                *
  2032*                           ELCCALC.                            *
  2033*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2034*                            VMOD=2.025                          *
  2035*                                                                *
  2036*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2037*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2038*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2039*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2040*                                                                *
  2041*  PASSED TO ELRTRM                                              *
  2042*  -----------------                                             *
  2043*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2044*  ORIGINAL TERM                                                 *
  2045*  BEGINNING DATE                                                *
  2046*  ENDING DATE                                                   *
  2047*  COMPANY I.D.                                                  *
  2048*  ACCOUNT MASTER USER FIELD                                     *
  2049*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2050*  FREE LOOK DAYS                                                *
  2051*                                                                *
  2052*  RETURNED FROM ELRTRM                                          *
  2053*  ---------------------                                         *
  2054*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2055*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2056*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2057*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2058*----------------------------------------------------------------*
  2059*  PASSED TO ELRAMT                                              *
  2060*  ----------------                                              *
  2061*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2062*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2063*  ORIGINAL AMOUNT                                               *
  2064*  ALTERNATE BENEFIT (BALLON)                                    *
  2065*  A.P.R. - NET PAY ONLY                                         *
  2066*  METHOD
  2067*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2068*  COMPANY I.D.                                                  *
  2069*  BENEFIT TYPE                                                  *
  2070*                                                                *
  2071*  RETURNED FROM ELRAMT                                          *
  2072*  --------------------                                          *
  2073*  REMAINING AMOUNT 1 - CURRENT                                  *
  2074*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2075*  REMAINING AMOUNT FACTOR
  2076*----------------------------------------------------------------*
  2077*  PASSED TO ELRESV                                              *
  2078*  -----------------                                             *
  2079*  CERTIFICATE EFFECTIVE DATE                                    *
  2080*  VALUATION DATE                                                *
  2081*  PAID THRU DATE                                                *
  2082*  BENEFIT                                                       *
  2083*  INCURRED DATE                                                 *
  2084*  REPORTED DATE                                                 *
  2085*  ISSUE AGE                                                     *
  2086*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  41
* EL1278.cbl
  2087*  CDT PERCENT                                                   *
  2088*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2089* *CLAIM TYPE (LIFE, A/H)                                        *
  2090* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2091* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2092*                                                                *
  2093*  RETURNED FROM ELRESV                                          *
  2094*  --------------------                                          *
  2095*  CDT TABLE USED                                                *
  2096*  CDT FACTOR USED                                               *
  2097*  PAY TO CURRENT RESERVE                                        *
  2098*  I.B.N.R. - A/H ONLY                                           *
  2099*  FUTURE (ACCRUED) AH ONLY                                      *
  2100*----------------------------------------------------------------*
  2101*  PASSED TO ELRATE                                              *
  2102*  ----------------                                              *
  2103*  CERT ISSUE DATE                                               *
  2104*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2105*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2106*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2107*  STATE CODE (CLIENT DEFINED)                                   *
  2108*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2109*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2110*  DEVIATION CODE                                                *
  2111*  ISSUE AGE                                                     *
  2112*  ORIGINAL BENEFIT AMOUNT                                       *
  2113*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2114*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2115*  BENEFIT KIND (LIFE OR A/H)                                    *
  2116*  A.P.R.                                                        *
  2117*  METHOD
  2118*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2119*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2120*  COMPANY I.D. (3 CHARACTER)                                    *
  2121*  BENEFIT CODE                                                  *
  2122*  BENEFIT OVERRIDE CODE                                         *
  2123*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2124*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2125*  JOINT INDICATOR (CSL ONLY)                                    *
  2126*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2127*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2128*                                                                *
  2129*  RETURNED FROM ELRATE                                          *
  2130*  --------------------                                          *
  2131*  CALCULATED PREMIUM                                            *
  2132*  PREMIUM RATE                                                  *
  2133*  MORTALITY CODE                                                *
  2134*  MAX ATTAINED AGE                                              *
  2135*  MAX AGE                                                       *
  2136*  MAX TERM                                                      *
  2137*  MAX MONTHLY BENEFIT                                           *
  2138*  MAX TOTAL BENIFIT                                             *
  2139*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2140*----------------------------------------------------------------*
  2141*  PASSED TO ELRFND                                              *
  2142*  ----------------                                              *
  2143*  CERT ISSUE DATE                                               *
  2144*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  42
* EL1278.cbl
  2145*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2146*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2147*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2148*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2149*  STATE CODE (CLIENT DEFINED)                                   *
  2150*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2151*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2152*  DEVIATION CODE                                                *
  2153*  ISSUE AGE                                                     *
  2154*  ORIGINAL BENEFIT AMOUNT                                       *
  2155*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2156*  PROCESS TYPE (CANCEL)                                         *
  2157*  BENEFIT KIND (LIFE OR A/H)                                    *
  2158*  A.P.R.                                                        *
  2159*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2160*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2161*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2162*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2163*  COMPANY I.D. (3 CHARACTER)                                    *
  2164*  BENEFIT CODE                                                  *
  2165*  BENEFIT OVERRIDE CODE                                         *
  2166*                                                                *
  2167*  RETURNED FROM ELRFND                                          *
  2168*  --------------------                                          *
  2169*  CALCULATED REFUND                                             *
  2170*----------------------------------------------------------------*
  2171*  PASSED TO ELEARN                                              *
  2172*  ----------------                                              *
  2173*  CERT ISSUE DATE                                               *
  2174*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2175*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2176*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2177*  STATE CODE (CLIENT DEFINED)                                   *
  2178*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2179*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2180*  DEVIATION CODE                                                *
  2181*  ISSUE AGE                                                     *
  2182*  ORIGINAL BENEFIT AMOUNT                                       *
  2183*  BENEFIT KIND (LIFE OR A/H)                                    *
  2184*  A.P.R.                                                        *
  2185*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2186*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2187*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2188*  COMPANY I.D. (3 CHARACTER)                                    *
  2189*  BENEFIT CODE                                                  *
  2190*  BENEFIT OVERRIDE CODE                                         *
  2191*                                                                *
  2192*  RETURNED FROM ELEARN                                          *
  2193*  --------------------                                          *
  2194*  INDICATED  EARNINGS                                           *
  2195*----------------------------------------------------------------*
  2196*                 LENGTH = 450                                   *
  2197*                                                                *
  2198******************************************************************
  2199******************************************************************
  2200*                   C H A N G E   L O G
  2201*
  2202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  43
* EL1278.cbl
  2203*-----------------------------------------------------------------
  2204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2205* EFFECTIVE    NUMBER
  2206*-----------------------------------------------------------------
  2207* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2208* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2209* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2210* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2211* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2212* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2213* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2214* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2215* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2216* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2217* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2218******************************************************************
  2219
  2220 01  CALCULATION-PASS-AREA.
  2221     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2222                                     COMP.
  2223
  2224     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2225       88  NO-CP-ERROR                             VALUE ZERO.
  2226       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2227                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2228       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2229       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2230       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2231       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2232       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2233       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2234       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2235       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2236       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2237       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2238       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2239       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2240       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2241       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2242       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2243       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2244       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2245
  2246     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2247       88  NO-CP-ERROR-2                           VALUE ZERO.
  2248***********************  INPUT AREAS ****************************
  2249
  2250     12  CP-CALCULATION-AREA.
  2251         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2252         16  CP-CERT-EFF-DT        PIC XX.
  2253         16  CP-VALUATION-DT       PIC XX.
  2254         16  CP-PAID-THRU-DT       PIC XX.
  2255         16  CP-BENEFIT-TYPE       PIC X.
  2256           88  CP-AH                               VALUE 'A' 'D'
  2257                                                   'I' 'U'.
  2258           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2259           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2260         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  44
* EL1278.cbl
  2261         16  CP-REPORTED-DT        PIC XX.
  2262         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2263         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2264         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2265                                     COMP-3.
  2266         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2267                                     COMP-3.
  2268         16  CP-CDT-METHOD         PIC X.
  2269           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2270           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2271           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2272         16  CP-CLAIM-TYPE         PIC X.
  2273           88  CP-AH-CLAIM                         VALUE 'A'.
  2274           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2275         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2276                                     COMP-3.
  2277         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2278                                     COMP-3.
  2279         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2280                                     COMP-3.
  2281         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2282                                     COMP-3.
  2283         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2284                                     COMP-3.
  2285         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2286                                     COMP-3.
  2287         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2288                                     COMP-3.
  2289         16  CP-REM-TERM-METHOD    PIC X.
  2290           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2291           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2292           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2293           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2294           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2295           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2296           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2297         16  CP-EARNING-METHOD     PIC X.
  2298           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2299           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2300           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2301           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2302           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2303           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2304           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2305           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2306           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2307           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2308           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2309           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2310           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2311           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2312         16  CP-PROCESS-TYPE       PIC X.
  2313           88  CP-CLAIM                            VALUE '1'.
  2314           88  CP-CANCEL                           VALUE '2'.
  2315           88  CP-ISSUE                            VALUE '3'.
  2316         16  CP-SPECIAL-CALC-CD    PIC X.
  2317           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2318           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  45
* EL1278.cbl
  2319           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2320           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2321           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2322           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2323           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2324           88  CP-FARM-PLAN                    VALUE 'F'.
  2325           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2326           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2327           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2328           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2329           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2330           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2331           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2332           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2333           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2334           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2335                                                     'W' 'X'.
  2336           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2337           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2338           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2339           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2340           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2341           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2342           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2343           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2344           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2345           88  CP-CSL-METH-1                   VALUE '5'.
  2346           88  CP-CSL-METH-2                   VALUE '6'.
  2347           88  CP-CSL-METH-3                   VALUE '7'.
  2348           88  CP-CSL-METH-4                   VALUE '8'.
  2349
  2350         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2351                                     COMP-3.
  2352         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2353         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2354         16  CP-STATE              PIC XX          VALUE SPACE.
  2355         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2356         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2357           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2358               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2359         16  CP-R78-OPTION         PIC X.
  2360           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2361           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2362
  2363         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2364         16  CP-IBNR-RESERVE-SW    PIC X.
  2365         16  CP-CLAIM-STATUS       PIC X.
  2366         16  CP-RATE-FILE          PIC X.
  2367         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2368                                     COMP-3.
  2369
  2370         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2371         16  CP-AH-OVERRIDE-CODE   PIC X.
  2372
  2373         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2374                                     COMP-3.
  2375         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2376                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  46
* EL1278.cbl
  2377         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2378                                     COMP-3.
  2379         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2380                                     COMP-3.
  2381         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2382                                     COMP-3.
  2383         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2384                                  PIC S9(7)V99 COMP-3.
  2385
  2386         16  CP-PAID-FROM-DATE     PIC X(02).
  2387         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2388         16  CP-EXT-DAYS-CALC      PIC X.
  2389           88  CP-EXT-NO-CHG                   VALUE ' '.
  2390           88  CP-EXT-CHG-LF                   VALUE '1'.
  2391           88  CP-EXT-CHG-AH                   VALUE '2'.
  2392           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2393         16  CP-DOMICILE-STATE     PIC XX.
  2394         16  CP-CARRIER            PIC X.
  2395         16  CP-REIN-FLAG          PIC X.
  2396         16  CP-REM-TRM-CALC-OPTION PIC X.
  2397           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2398                      '2' '3' '4' '5'.
  2399           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2400           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2401           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2402           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2403           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2404           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2405           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2406           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2407         16  CP-SIG-SWITCH         PIC X.
  2408         16  CP-RATING-METHOD      PIC X.
  2409           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2410           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2411           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2412           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2413           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2414           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2415           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2416           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2417           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2418         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2419                                     COMP-3.
  2420         16  CP-BEN-CATEGORY       PIC X.
  2421         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2422         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2423                                   PIC S99V9(5) COMP-3.
  2424         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2425         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2426                                   PIC S99V9(5) COMP-3.
  2427         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2428         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2429         16  CP-EXPIRE-DT          PIC XX.
  2430         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2431         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2432         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2433         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2434         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  47
* EL1278.cbl
  2435             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2436             88  CP-CALC-CLP              VALUE 'C'.
  2437         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2438         16  CP-CANCEL-REASON      PIC X.
  2439         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2440         16  CP-PMT-MODE           PIC X.
  2441         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2442         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2443         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2444         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2445         16  FILLER                PIC X.
  2446
  2447***************    OUTPUT FROM ELRESV   ************************
  2448
  2449         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2450
  2451         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2452                                     COMP-3.
  2453         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2454                                     COMP-3.
  2455         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2456                                     COMP-3.
  2457         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2458                                     COMP-3.
  2459         16  FILLER                PIC X(09).
  2460***************    OUTPUT FROM ELRTRM   *************************
  2461
  2462         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2463                                     COMP-3.
  2464         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2465                                     COMP-3.
  2466         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2467                                     COMP-3.
  2468         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2469                                     COMP-3.
  2470         16  FILLER                PIC X(12).
  2471
  2472***************    OUTPUT FROM ELRAMT   *************************
  2473
  2474         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2475                                     COMP-3.
  2476         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2477                                     COMP-3.
  2478         16  FILLER                PIC X(12).
  2479
  2480***************    OUTPUT FROM ELRATE   *************************
  2481
  2482         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2483                                     COMP-3.
  2484         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2485                                     COMP-3.
  2486         16  CP-MORTALITY-CODE     PIC X(4).
  2487         16  CP-RATE-EDIT-FLAG     PIC X.
  2488             88  CP-RATES-NEED-APR                  VALUE '1'.
  2489         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2490                                     COMP-3.
  2491         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2492         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  48
* EL1278.cbl
  2493         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2494                                   PIC S9(7)V99 COMP-3.
  2495         16  FILLER                PIC X(07).
  2496
  2497***************    OUTPUT FROM ELRFND   *************************
  2498
  2499         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2500                                     COMP-3.
  2501         16  CP-REFUND-TYPE-USED   PIC X.
  2502           88  CP-R-AS-R78                         VALUE '1'.
  2503           88  CP-R-AS-PRORATA                     VALUE '2'.
  2504           88  CP-R-AS-CALIF                       VALUE '3'.
  2505           88  CP-R-AS-TEXAS                       VALUE '4'.
  2506           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2507           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2508           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2509           88  CP-R-AS-MEAN                        VALUE '8'.
  2510           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2511           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2512           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2513           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2514           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2515           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2516         16  FILLER                PIC X(12).
  2517
  2518***************    OUTPUT FROM ELEARN   *************************
  2519
  2520         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2521                                     COMP-3.
  2522         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2523                                     COMP-3.
  2524         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2525                                     COMP-3.
  2526         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2527                                     COMP-3.
  2528         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2529                                     COMP-3.
  2530         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2531                                     COMP-3.
  2532         16  CP-EARNING-TYPE-USED  PIC X.
  2533           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2534           88  CP-E-AS-R78                         VALUE '1'.
  2535           88  CP-E-AS-PRORATA                     VALUE '2'.
  2536           88  CP-E-AS-TEXAS                       VALUE '4'.
  2537           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2538           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2539           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2540           88  CP-E-AS-MEAN                        VALUE '8'.
  2541           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2542         16  FILLER                PIC X(12).
  2543
  2544***************    OUTPUT FROM ELPMNT   *************************
  2545
  2546         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2547                                     COMP-3.
  2548         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2549                                     COMP-3.
  2550         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  49
* EL1278.cbl
  2551
  2552***************   MISC WORK AREAS    *****************************
  2553         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2554                                     COMP-3.
  2555         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2556                                     COMP-3.
  2557         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2558                                     COMP-3.
  2559         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2562                                     COMP-3.
  2563         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2566             88  OPEN-RATE-FILE                   VALUE 'O'.
  2567             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2568             88  IO-ERROR                         VALUE 'E'.
  2569
  2570         16  CP-FIRST-PAY-DATE     PIC XX.
  2571
  2572         16  CP-JOINT-INDICATOR    PIC X.
  2573
  2574         16  CP-RESERVE-REMAINING-TERM
  2575                                   PIC S9(4)V9    VALUE ZERO
  2576                                     COMP-3.
  2577
  2578         16  CP-INSURED-BIRTH-DT   PIC XX.
  2579
  2580         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2581                                     COMP-3.
  2582
  2583         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2584                                     COMP-3.
  2585
  2586         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2587                                     COMP-3.
  2588
  2589         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2590                                     COMP-3.
  2591
  2592         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2593                                     COMP-3.
  2594
  2595         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2596                                     COMP-3.
  2597
  2598         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2599                                     COMP-3.
  2600
  2601         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2602             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2603
  2604         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2605                                     COMP-3.
  2606         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2607                                     COMP-3.
  2608         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  50
* EL1278.cbl
  2609         16  cp-extra-periods      pic 9 value zeros.
  2610         16  cp-net-only-state     pic x value spaces.
  2611         16  FILLER                PIC X(13).
  2612******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  51
* EL1278.cbl
  2614*                            COPY ERCNOTE.
  2615******************************************************************
  2616*                                                                *
  2617*                                                                *
  2618*                            ERCNOTE                             *
  2619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2620*                            VMOD=2.003                          *
  2621*                                                                *
  2622*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2623*                                                                *
  2624*        FILE TYPE= VSAM,KSDS                                    *
  2625*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2626*                                                                *
  2627*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2628*                                                                *
  2629*        LOG = YES                                               *
  2630*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2631*                                                                *
  2632******************************************************************
  2633*                   C H A N G E   L O G
  2634*
  2635* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2636*-----------------------------------------------------------------
  2637*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2638* EFFECTIVE    NUMBER
  2639*-----------------------------------------------------------------
  2640* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2641*                                FILE WILL CONTAIN BILLING NOTES O
  2642******************************************************************
  2643
  2644 01  CERTIFICATE-NOTE.
  2645     12  CN-RECORD-ID                PIC  XX.
  2646         88  VALID-CN-ID                  VALUE 'CN'.
  2647
  2648     12  CN-CONTROL-PRIMARY.
  2649         16  CN-COMPANY-CD           PIC X.
  2650         16  CN-CARRIER              PIC X.
  2651         16  CN-GROUPING.
  2652             20 CN-GROUPING-PREFIX   PIC XXX.
  2653             20 CN-GROUPING-PRIME    PIC XXX.
  2654         16  CN-STATE                PIC XX.
  2655         16  CN-ACCOUNT.
  2656             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2657             20 CN-ACCOUNT-PRIME     PIC X(6).
  2658         16  CN-CERT-EFF-DT          PIC XX.
  2659         16  CN-CERT-NO.
  2660             20  CN-CERT-PRIME       PIC X(10).
  2661             20  CN-CERT-SFX         PIC X.
  2662
  2663     12  CN-BILLING-START-LINE-NO    PIC 99.
  2664     12  CN-BILLING-END-LINE-NO      PIC 99.
  2665
  2666     12  CN-LINES.
  2667         16  CN-LINE OCCURS 10       PIC X(77).
  2668
  2669     12  CN-LAST-MAINT-DT            PIC XX.
  2670     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2671     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  52
* EL1278.cbl
  2672     12  FILLER                      PIC X(6).
  2673******************************************************************
  2674*                            COPY ERCCTBL.
  2675******************************************************************
  2676*                                                                *
  2677*                                                                *
  2678*                            ERCCTBL                             *
  2679*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2680*                            VMOD=2.003
  2681*                                                                *
  2682*   ONLINE CREDIT SYSTEM                                         *
  2683*                                                                *
  2684*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2685*                                                                *
  2686*   FILE TYPE = VSAM,KSDS                                        *
  2687*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2688*                                                                *
  2689*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2690*       ALTERNATE PATH = NONE                                    *
  2691*                                                                *
  2692*   LOG = NO                                                     *
  2693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2694*                                                                *
  2695*                                                                *
  2696******************************************************************
  2697
  2698 01  COMM-TABLE-RECORD.
  2699     12  CT-RECORD-ID                      PIC XX.
  2700         88  VALID-CT-ID                      VALUE 'CT'.
  2701
  2702     12  CT-CONTROL-PRIMARY.
  2703         16  CT-COMPANY-CD                 PIC X.
  2704         16  CT-TABLE                      PIC XXX.
  2705         16  CT-CNTRL-2.
  2706             20  CT-BEN-TYPE               PIC X.
  2707             20  CT-BEN-CODE               PIC XX.
  2708
  2709     12  CT-MAINT-INFORMATION.
  2710         16  CT-LAST-MAINT-DT              PIC XX.
  2711         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2712         16  CT-LAST-MAINT-USER            PIC X(4).
  2713         16  FILLER                        PIC X(31).
  2714
  2715     12  CT-LIMITS.
  2716         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2717
  2718         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2719
  2720         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2721
  2722     12  CT-RATES.
  2723         16  CT-RTX          OCCURS 27 TIMES.
  2724             20  CT-RT                     PIC SV9(5)     COMP-3.
  2725             20  CT-RT-R   REDEFINES
  2726                 CT-RT                     PIC XXX.
  2727
  2728     12  FILLER                            PIC  X(42).
  2729
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  53
* EL1278.cbl
  2730******************************************************************
  2731
  2732****************************************************************
  2733*
  2734* Copyright (c) 2007 by Clerity Solutions, Inc.
  2735* All rights reserved.
  2736*
  2737****************************************************************
  2738 01  DFHEIV.
  2739   02  DFHEIV0               PIC X(35).
  2740   02  DFHEIV1               PIC X(08).
  2741   02  DFHEIV2               PIC X(08).
  2742   02  DFHEIV3               PIC X(08).
  2743   02  DFHEIV4               PIC X(06).
  2744   02  DFHEIV5               PIC X(04).
  2745   02  DFHEIV6               PIC X(04).
  2746   02  DFHEIV7               PIC X(02).
  2747   02  DFHEIV8               PIC X(02).
  2748   02  DFHEIV9               PIC X(01).
  2749   02  DFHEIV10              PIC S9(7) COMP-3.
  2750   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2751   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2752   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2753   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2754   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2755   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2756   02  DFHEIV17              PIC X(04).
  2757   02  DFHEIV18              PIC X(04).
  2758   02  DFHEIV19              PIC X(04).
  2759   02  DFHEIV20              USAGE IS POINTER.
  2760   02  DFHEIV21              USAGE IS POINTER.
  2761   02  DFHEIV22              USAGE IS POINTER.
  2762   02  DFHEIV23              USAGE IS POINTER.
  2763   02  DFHEIV24              USAGE IS POINTER.
  2764   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2765   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2766   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2767   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2768   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2769   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2770   02  FILLER                PIC X(02).
  2771   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2772   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2773   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2774   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2775   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2776 LINKAGE  SECTION.
  2777*****************************************************************
  2778*                                                               *
  2779* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2780* All rights reserved.                                          *
  2781*                                                               *
  2782*****************************************************************
  2783 01  dfheiblk.
  2784     02  eibtime          pic s9(7) comp-3.
  2785     02  eibdate          pic s9(7) comp-3.
  2786     02  eibtrnid         pic x(4).
  2787     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  54
* EL1278.cbl
  2788     02  eibtrmid         pic x(4).
  2789     02  dfheigdi         pic s9(4) comp.
  2790     02  eibcposn         pic s9(4) comp.
  2791     02  eibcalen         pic s9(4) comp.
  2792     02  eibaid           pic x(1).
  2793     02  eibfiller1       pic x(1).
  2794     02  eibfn            pic x(2).
  2795     02  eibfiller2       pic x(2).
  2796     02  eibrcode         pic x(6).
  2797     02  eibfiller3       pic x(2).
  2798     02  eibds            pic x(8).
  2799     02  eibreqid         pic x(8).
  2800     02  eibrsrce         pic x(8).
  2801     02  eibsync          pic x(1).
  2802     02  eibfree          pic x(1).
  2803     02  eibrecv          pic x(1).
  2804     02  eibsend          pic x(1).
  2805     02  eibatt           pic x(1).
  2806     02  eibeoc           pic x(1).
  2807     02  eibfmh           pic x(1).
  2808     02  eibcompl         pic x(1).
  2809     02  eibsig           pic x(1).
  2810     02  eibconf          pic x(1).
  2811     02  eiberr           pic x(1).
  2812     02  eibrldbk         pic x(1).
  2813     02  eiberrcd         pic x(4).
  2814     02  eibsynrb         pic x(1).
  2815     02  eibnodat         pic x(1).
  2816     02  eibfiller5       pic x(2).
  2817     02  eibresp          pic 9(09) comp.
  2818     02  eibresp2         pic 9(09) comp.
  2819     02  dfheigdj         pic s9(4) comp.
  2820     02  dfheigdk         pic s9(4) comp.
  2821
  2822 01  DFHCOMMAREA                 PIC  X(1024).
  2823
  2824*01 PARMLIST .
  2825*    12  FILLER                  PIC S9(08)      COMP.
  2826*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2827*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2828*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2829*                            COPY ELCCNTL.
  2830******************************************************************
  2831*                                                                *
  2832*                                                                *
  2833*                            ELCCNTL.                            *
  2834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2835*                            VMOD=2.059                          *
  2836*                                                                *
  2837*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2838*                                                                *
  2839*   FILE TYPE = VSAM,KSDS                                        *
  2840*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2841*                                                                *
  2842*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2843*       ALTERNATE INDEX = NONE                                   *
  2844*                                                                *
  2845*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  55
* EL1278.cbl
  2846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2847******************************************************************
  2848*                   C H A N G E   L O G
  2849*
  2850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2851*-----------------------------------------------------------------
  2852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2853* EFFECTIVE    NUMBER
  2854*-----------------------------------------------------------------
  2855* 082503                   PEMA  ADD BENEFIT GROUP
  2856* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2857* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2858* 092705    2005050300006  PEMA  ADD SPP LEASES
  2859* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2860* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2861* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2862* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2863* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2864* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2865* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2866* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2867* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2868* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2869******************************************************************
  2870*
  2871 01  CONTROL-FILE.
  2872     12  CF-RECORD-ID                       PIC XX.
  2873         88  VALID-CF-ID                        VALUE 'CF'.
  2874
  2875     12  CF-CONTROL-PRIMARY.
  2876         16  CF-COMPANY-ID                  PIC XXX.
  2877         16  CF-RECORD-TYPE                 PIC X.
  2878             88  CF-COMPANY-MASTER              VALUE '1'.
  2879             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2880             88  CF-STATE-MASTER                VALUE '3'.
  2881             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2882             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2883             88  CF-CARRIER-MASTER              VALUE '6'.
  2884             88  CF-MORTALITY-MASTER            VALUE '7'.
  2885             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2886             88  CF-TERMINAL-MASTER             VALUE '9'.
  2887             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2888             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2889             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2890             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2891             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2892             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2893             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2894             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2895             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2896         16  CF-ACCESS-CD-GENL              PIC X(4).
  2897         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2898             20  CF-PROCESSOR               PIC X(4).
  2899         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2900             20  CF-STATE-CODE              PIC XX.
  2901             20  FILLER                     PIC XX.
  2902         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2903             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  56
* EL1278.cbl
  2904             20  CF-HI-BEN-IN-REC           PIC XX.
  2905         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2906             20  FILLER                     PIC XXX.
  2907             20  CF-CARRIER-CNTL            PIC X.
  2908         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2909             20  FILLER                     PIC XX.
  2910             20  CF-HI-TYPE-IN-REC          PIC 99.
  2911         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2912             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2913                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2914             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2915             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2916         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2917             20  FILLER                     PIC X.
  2918             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2919         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2920             20  FILLER                     PIC XX.
  2921             20  CF-MORTGAGE-PLAN           PIC XX.
  2922         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2923
  2924     12  CF-LAST-MAINT-DT                   PIC XX.
  2925     12  CF-LAST-MAINT-BY                   PIC X(4).
  2926     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2927
  2928     12  CF-RECORD-BODY                     PIC X(728).
  2929
  2930
  2931****************************************************************
  2932*             COMPANY MASTER RECORD                            *
  2933****************************************************************
  2934
  2935     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2936         16  CF-COMPANY-ADDRESS.
  2937             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2938             20  CF-CL-IN-CARE-OF           PIC X(30).
  2939             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2940             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2941             20  CF-CL-CITY-STATE           PIC X(30).
  2942             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2943             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2944         16  CF-COMPANY-CD                  PIC X.
  2945         16  CF-COMPANY-PASSWORD            PIC X(8).
  2946         16  CF-SECURITY-OPTION             PIC X.
  2947             88  ALL-SECURITY                   VALUE '1'.
  2948             88  COMPANY-VERIFY                 VALUE '2'.
  2949             88  PROCESSOR-VERIFY               VALUE '3'.
  2950             88  NO-SECURITY                    VALUE '4'.
  2951             88  ALL-BUT-TERM                   VALUE '5'.
  2952         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2953             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2954         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2955             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2956         16  CF-INFORCE-LOCATION            PIC X.
  2957             88  CERTS-ARE-ONLINE               VALUE '1'.
  2958             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2959             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2960         16  CF-LOWER-CASE-LETTERS          PIC X.
  2961         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  57
* EL1278.cbl
  2962             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2963             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2964             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2965             88  CF-ACCNT-CNTL                  VALUE '3'.
  2966             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2967
  2968         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2969         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2970
  2971         16  CF-LGX-CREDIT-USER             PIC X.
  2972             88  CO-IS-NOT-USER                 VALUE 'N'.
  2973             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2974
  2975         16 CF-CREDIT-CALC-CODES.
  2976             20  CF-CR-REM-TERM-CALC PIC X.
  2977               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2978               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2979               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2980               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2981               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2982               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2983               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2984             20  CF-CR-R78-METHOD           PIC X.
  2985               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2986               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2987
  2988         16  CF-CLAIM-CONTROL-COUNTS.
  2989             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2990                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2991
  2992             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2993                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2994
  2995             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2996                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2997
  2998             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2999                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3000
  3001         16  CF-CURRENT-MONTH-END           PIC XX.
  3002
  3003         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3004             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3005             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3006             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3007             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3008                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3009                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3010             20  CF-CO-PREM-REJECT-SW       PIC X.
  3011                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3012                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3013             20  CF-CO-REF-REJECT-SW        PIC X.
  3014                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3015                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3016
  3017         16  CF-CO-REPORTING-DT             PIC XX.
  3018         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3019         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  58
* EL1278.cbl
  3020           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3021           88  CF-CO-MONTH-END                  VALUE '1'.
  3022
  3023         16  CF-LGX-CLAIM-USER              PIC X.
  3024             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3025             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3026
  3027         16  CF-CREDIT-EDIT-CONTROLS.
  3028             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3029             20  CF-MIN-AGE                 PIC 99.
  3030             20  CF-DEFAULT-AGE             PIC 99.
  3031             20  CF-MIN-TERM                PIC S999      COMP-3.
  3032             20  CF-MAX-TERM                PIC S999      COMP-3.
  3033             20  CF-DEFAULT-SEX             PIC X.
  3034             20  CF-JOINT-AGE-INPUT         PIC X.
  3035                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3036             20  CF-BIRTH-DATE-INPUT        PIC X.
  3037                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3038             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3039                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3040                 88  CF-ZERO-CARRIER            VALUE '1'.
  3041                 88  CF-ZERO-GROUPING           VALUE '2'.
  3042                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3043             20  CF-EDIT-SW                 PIC X.
  3044                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3045             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3046             20  CF-CR-PR-METHOD            PIC X.
  3047               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3048               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3049             20  FILLER                     PIC X.
  3050
  3051         16  CF-CREDIT-MISC-CONTROLS.
  3052             20  CF-REIN-TABLE-SW           PIC X.
  3053                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3054             20  CF-COMP-TABLE-SW           PIC X.
  3055                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3056             20  CF-EXPERIENCE-RETENTION-AGE
  3057                                            PIC S9        COMP-3.
  3058             20  CF-CONVERSION-DT           PIC XX.
  3059             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3060             20  CF-RUN-FREQUENCY-SW        PIC X.
  3061                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3062                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3063
  3064             20  CF-CR-CHECK-NO-CONTROL.
  3065                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3066                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3067                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3068                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3069                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3070                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3071
  3072                 24  CF-CR-CHECK-COUNT       REDEFINES
  3073                     CF-CR-CHECK-COUNTER      PIC X(4).
  3074
  3075                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3076                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3077
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  59
* EL1278.cbl
  3078                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3079                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3080                 24  CF-MAIL-PROCESSING       PIC X.
  3081                     88  MAIL-PROCESSING          VALUE 'Y'.
  3082
  3083         16  CF-MISC-SYSTEM-CONTROL.
  3084             20  CF-SYSTEM-C                 PIC X.
  3085                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3086             20  CF-SYSTEM-D                 PIC X.
  3087                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3088             20  CF-SOC-SEC-NO-SW            PIC X.
  3089                 88  SOC-SEC-NO-USED             VALUE '1'.
  3090             20  CF-MEMBER-NO-SW             PIC X.
  3091                 88  MEMBER-NO-USED              VALUE '1'.
  3092             20  CF-TAX-ID-NUMBER            PIC X(11).
  3093             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3094             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3095                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3096                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3097                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3098                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3099             20  CF-SYSTEM-E                 PIC X.
  3100                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3101
  3102         16  CF-LGX-LIFE-USER               PIC X.
  3103             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3104             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3105
  3106         16  CF-CR-MONTH-END-DT             PIC XX.
  3107
  3108         16  CF-FILE-MAINT-DATES.
  3109             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3110                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3111             20  CF-LAST-BATCH       REDEFINES
  3112                 CF-LAST-BATCH-NO               PIC X(4).
  3113             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3114             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3115             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3116             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3117             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3118             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3119             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3120             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3121             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3122             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3123
  3124         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3125         16  FILLER                         PIC X.
  3126
  3127         16  CF-ALT-MORT-CODE               PIC X(4).
  3128         16  CF-MEMBER-CAPTION              PIC X(10).
  3129
  3130         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3131             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3132             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3133             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3134             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3135             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  60
* EL1278.cbl
  3136
  3137         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3138
  3139         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3140         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3141         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3142         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3143
  3144         16  CF-AH-OVERRIDE-L1              PIC X.
  3145         16  CF-AH-OVERRIDE-L2              PIC XX.
  3146         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3147         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3148
  3149         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3150         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3151
  3152         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3153         16  CF-AR-LAST-EL860-DT            PIC XX.
  3154         16  CF-MP-MONTH-END-DT             PIC XX.
  3155
  3156         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3157         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3158             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3159
  3160         16  CF-AR-MONTH-END-DT             PIC XX.
  3161
  3162         16  CF-CRDTCRD-USER                PIC X.
  3163             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3164             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3165
  3166         16  CF-CC-MONTH-END-DT             PIC XX.
  3167
  3168         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3169
  3170         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3171             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3172             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3173             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3174         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3175         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3176         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3177         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3178             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3179             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3180         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3181         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3182         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3183             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3184         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3185
  3186         16  CF-CL-ZIP-CODE.
  3187             20  CF-CL-ZIP-PRIME.
  3188                 24  CF-CL-ZIP-1ST          PIC X.
  3189                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3190                 24  FILLER                 PIC X(4).
  3191             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3192         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3193             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  61
* EL1278.cbl
  3194             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3195             20  FILLER                     PIC XXX.
  3196
  3197         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3198         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3199         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3200         16  CF-CO-OPTION-START-DATE        PIC XX.
  3201         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3202           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3203                                                      '3' '4'.
  3204           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3205           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3206           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3207           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3208           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3209           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3210
  3211         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3212
  3213         16  CF-PAYMENT-APPROVAL-LEVELS.
  3214             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3215             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3216             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3217             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3218             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3219             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3220
  3221         16  CF-END-USER-REPORTING-USER     PIC X.
  3222             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3223             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3224
  3225         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3226             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3227             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3228
  3229         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3230
  3231         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3232         16  FILLER                         PIC X.
  3233
  3234         16  CF-CREDIT-ARCHIVE-CNTL.
  3235             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3236             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3237             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3238
  3239         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3240
  3241         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3242             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3243             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3244
  3245         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3246             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3247             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3248
  3249         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3250
  3251         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  62
* EL1278.cbl
  3252             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3253             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3254             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3255         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3256         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3257         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3258         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3259         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3260         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3261         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3262         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3263         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3264                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3265         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3266                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3267
  3268         16  CF-CO-OVER-SHORT.
  3269             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3270             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3271
  3272*         16  FILLER                         PIC X(102).
  3273         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3274             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3275             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3276
  3277         16  CF-AH-APPROVAL-DAYS.
  3278             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3279             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3280             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3281             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3282
  3283         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3284
  3285         16  CF-APPROV-LEV-5.
  3286             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3287             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3288             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3289
  3290         16  FILLER                         PIC X(68).
  3291****************************************************************
  3292*             PROCESSOR/USER RECORD                            *
  3293****************************************************************
  3294
  3295     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3296         16  CF-PROCESSOR-NAME              PIC X(30).
  3297         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3298         16  CF-PROCESSOR-TITLE             PIC X(26).
  3299         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3300                 88  MESSAGE-YES                VALUE 'Y'.
  3301                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3302
  3303*****************************************************
  3304****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3305****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3306****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3307****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3308*****************************************************
  3309
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  63
* EL1278.cbl
  3310         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3311             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3312             20  CF-APPLICATION-FORCE       PIC X.
  3313             20  CF-INDIVIDUAL-APP.
  3314                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3315                     28  CF-BROWSE-APP      PIC X.
  3316                     28  CF-UPDATE-APP      PIC X.
  3317
  3318         16  CF-CURRENT-TERM-ON             PIC X(4).
  3319         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3320             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3321             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3322             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3323             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3324             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3325             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3326             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3327         16  CF-PROCESSOR-CARRIER           PIC X.
  3328             88  NO-CARRIER-SECURITY            VALUE ' '.
  3329         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3330             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3331         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3332             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3333         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3334             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3335
  3336         16  CF-PROC-SYS-ACCESS-SW.
  3337             20  CF-PROC-CREDIT-CLAIMS-SW.
  3338                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3339                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3340                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3341                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3342             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3343                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3344                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3345             20  CF-PROC-LIFE-GNRLDGR-SW.
  3346                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3347                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3348                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3349                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3350             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3351                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3352                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3353         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3354             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3355             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3356         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3357
  3358         16  CF-APPROVAL-LEVEL                  PIC X.
  3359             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3360             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3361             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3362             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3363             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3364
  3365         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3366
  3367         16  CF-LANGUAGE-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  64
* EL1278.cbl
  3368             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3369             88  CF-LANG-IS-FR                      VALUE 'F'.
  3370
  3371         16  CF-CSR-IND                         PIC X.
  3372         16  FILLER                             PIC X(239).
  3373
  3374****************************************************************
  3375*             PROCESSOR/REMINDERS RECORD                       *
  3376****************************************************************
  3377
  3378     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3379         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3380             20  CF-START-REMIND-DT         PIC XX.
  3381             20  CF-END-REMIND-DT           PIC XX.
  3382             20  CF-REMINDER-TEXT           PIC X(50).
  3383         16  FILLER                         PIC X(296).
  3384
  3385
  3386****************************************************************
  3387*             STATE MASTER RECORD                              *
  3388****************************************************************
  3389
  3390     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3391         16  CF-STATE-ABBREVIATION          PIC XX.
  3392         16  CF-STATE-NAME                  PIC X(25).
  3393         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3394         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3395             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3396             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3397             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3398             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3399                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3400                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3401             20  CF-ST-PREM-REJECT-SW       PIC X.
  3402                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3403                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3404             20  CF-ST-REF-REJECT-SW        PIC X.
  3405                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3406                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3407         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3408         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3409         16  CF-ST-REFUND-RULES.
  3410             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3411             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3412             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3413         16  CF-ST-FST-PMT-EXTENSION.
  3414             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3415             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3416                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3417                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3418                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3419                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3420         16  CF-ST-STATE-CALL.
  3421             20  CF-ST-CALL-UNEARNED        PIC X.
  3422             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3423             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3424         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3425             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  65
* EL1278.cbl
  3426             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3427         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3428         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3429         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3430         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3431         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3432         16  FILLER                         PIC X.
  3433         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3434             20  CF-ST-BENEFIT-CD           PIC XX.
  3435             20  CF-ST-BENEFIT-KIND         PIC X.
  3436                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3437                 88  CF-ST-AH-KIND              VALUE 'A'.
  3438             20  CF-ST-REM-TERM-CALC        PIC X.
  3439                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3440                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3441                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3442                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3443                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3444                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3445                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3446                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3447
  3448             20  CF-ST-REFUND-CALC          PIC X.
  3449                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3450                 88  ST-REFD-BY-R78             VALUE '1'.
  3451                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3452                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3453                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3454                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3455                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3456                 88  ST-REFD-UTAH               VALUE '7'.
  3457                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3458                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3459                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3460
  3461             20  CF-ST-EARNING-CALC         PIC X.
  3462                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3463                 88  ST-EARN-BY-R78             VALUE '1'.
  3464                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3465                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3466                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3467                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3468                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3469                 88  ST-EARN-MEAN               VALUE '8'.
  3470                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3471
  3472             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3473                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3474                 88  ST-OVRD-BY-R78             VALUE '1'.
  3475                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3476                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3477                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3478                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3479                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3480                 88  ST-OVRD-MEAN               VALUE '8'.
  3481                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3482             20  cf-st-extra-periods        pic 9.
  3483*            20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  66
* EL1278.cbl
  3484
  3485         16  CF-ST-COMMISSION-CAPS.
  3486             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3487             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3488             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3489             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3490         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3491                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3492
  3493         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3494
  3495         16  CF-ST-STATUTORY-INTEREST.
  3496             20  CF-ST-STAT-DATE-FROM       PIC X.
  3497                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3498                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3499             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3500             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3501             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3502             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3503             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3504
  3505         16  CF-ST-OVER-SHORT.
  3506             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3507             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3508
  3509         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3510
  3511         16  CF-ST-RT-CALC                  PIC X.
  3512
  3513         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3514         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3515         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3516         16  CF-ST-RF-LR-CALC               PIC X.
  3517         16  CF-ST-RF-LL-CALC               PIC X.
  3518         16  CF-ST-RF-LN-CALC               PIC X.
  3519         16  CF-ST-RF-AH-CALC               PIC X.
  3520         16  CF-ST-RF-CP-CALC               PIC X.
  3521*        16  FILLER                         PIC X(206).
  3522*CIDMOD         16  FILLER                         PIC X(192).
  3523         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3524             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3525         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3526         16  CF-ST-VFY-2ND-BENE             PIC X.
  3527         16  CF-ST-CAUSAL-STATE             PIC X.
  3528         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3529         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3530         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3531             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3532         16  CF-ST-NET-ONLY-STATE           PIC X.
  3533             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3534         16  FILLER                         PIC X(181).
  3535
  3536****************************************************************
  3537*             BENEFIT MASTER RECORD                            *
  3538****************************************************************
  3539
  3540     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3541         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  67
* EL1278.cbl
  3542             20  CF-BENEFIT-CODE            PIC XX.
  3543             20  CF-BENEFIT-NUMERIC  REDEFINES
  3544                 CF-BENEFIT-CODE            PIC XX.
  3545             20  CF-BENEFIT-ALPHA           PIC XXX.
  3546             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3547             20  CF-BENEFIT-COMMENT         PIC X(10).
  3548
  3549             20  CF-LF-COVERAGE-TYPE        PIC X.
  3550                 88  CF-REDUCING                VALUE 'R'.
  3551                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3552
  3553             20  CF-SPECIAL-CALC-CD         PIC X.
  3554                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3555                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3556                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3557                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3558                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3559                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3560                 88  CF-FARM-PLAN               VALUE 'F'.
  3561                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3562                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3563                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3564                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3565                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3566                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3567                 88  CF-PRUDENTIAL              VALUE 'P'.
  3568                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3569                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3570                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3571                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3572                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3573                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3574
  3575             20  CF-JOINT-INDICATOR         PIC X.
  3576                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3577
  3578*            20  FILLER                     PIC X(12).
  3579             20  cf-maximum-benefits        pic s999 comp-3.
  3580             20  FILLER                     PIC X(09).
  3581             20  CF-BENEFIT-CATEGORY        PIC X.
  3582             20  CF-LOAN-TYPE               PIC X(8).
  3583
  3584             20  CF-CO-REM-TERM-CALC        PIC X.
  3585                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3586                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3587                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3588                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3589                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3590
  3591             20  CF-CO-EARNINGS-CALC        PIC X.
  3592                 88  CO-EARN-BY-R78             VALUE '1'.
  3593                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3594                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3595                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3596                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3597                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3598                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3599                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  68
* EL1278.cbl
  3600
  3601             20  CF-CO-REFUND-CALC          PIC X.
  3602                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3603                 88  CO-REFD-BY-R78             VALUE '1'.
  3604                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3605                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3606                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3607                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3608                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3609                 88  CO-REFD-MEAN               VALUE '8'.
  3610                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3611                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3612                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3613
  3614             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3615                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3616                 88  CO-OVRD-BY-R78             VALUE '1'.
  3617                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3618                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3619                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3620                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3621                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3622                 88  CO-OVRD-MEAN               VALUE '8'.
  3623                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3624
  3625             20  CF-CO-BEN-I-G-CD           PIC X.
  3626                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3627                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3628                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3629
  3630         16  FILLER                         PIC X(304).
  3631
  3632
  3633****************************************************************
  3634*             CARRIER MASTER RECORD                            *
  3635****************************************************************
  3636
  3637     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3638         16  CF-ADDRESS-DATA.
  3639             20  CF-MAIL-TO-NAME            PIC X(30).
  3640             20  CF-IN-CARE-OF              PIC X(30).
  3641             20  CF-ADDRESS-LINE-1          PIC X(30).
  3642             20  CF-ADDRESS-LINE-2          PIC X(30).
  3643             20  CF-CITY-STATE              PIC X(30).
  3644             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3645             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3646
  3647         16  CF-CLAIM-NO-CONTROL.
  3648             20  CF-CLAIM-NO-METHOD         PIC X.
  3649                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3650                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3651                 88  CLAIM-NO-SEQ               VALUE '3'.
  3652                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3653             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3654                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3655                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3656                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3657
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  69
* EL1278.cbl
  3658         16  CF-CHECK-NO-CONTROL.
  3659             20  CF-CHECK-NO-METHOD         PIC X.
  3660                 88  CHECK-NO-MANUAL            VALUE '1'.
  3661                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3662                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3663                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3664             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3665                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3666
  3667         16  CF-DOMICILE-STATE              PIC XX.
  3668
  3669         16  CF-EXPENSE-CONTROLS.
  3670             20  CF-EXPENSE-METHOD          PIC X.
  3671                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3672                 88  DOLLARS-PER-PMT            VALUE '2'.
  3673                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3674                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3675             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3676             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3677
  3678         16  CF-CORRESPONDENCE-CONTROL.
  3679             20  CF-LETTER-RESEND-OPT       PIC X.
  3680                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3681                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3682             20  FILLER                     PIC X(4).
  3683
  3684         16  CF-RESERVE-CONTROLS.
  3685             20  CF-MANUAL-SW               PIC X.
  3686                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3687             20  CF-FUTURE-SW               PIC X.
  3688                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3689             20  CF-PTC-SW                  PIC X.
  3690                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3691             20  CF-IBNR-SW                 PIC X.
  3692                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3693             20  CF-PTC-LF-SW               PIC X.
  3694                 88  CF-LF-PTC-USED             VALUE '1'.
  3695             20  CF-CDT-ACCESS-METHOD       PIC X.
  3696                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3697                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3698                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3699             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3700
  3701         16  CF-CLAIM-CALC-METHOD           PIC X.
  3702             88  360-PLUS-MONTHS                VALUE '1'.
  3703             88  365-PLUS-MONTHS                VALUE '2'.
  3704             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3705             88  360-DAILY                      VALUE '4'.
  3706             88  365-DAILY                      VALUE '5'.
  3707
  3708         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3709         16  FILLER                         PIC X(11).
  3710
  3711         16  CF-LIMIT-AMOUNTS.
  3712             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3713             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3714             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3715             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  70
* EL1278.cbl
  3716             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3717             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3718             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3719             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3720             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3721             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3722
  3723         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3724         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3725         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3726
  3727         16  CF-ZIP-CODE.
  3728             20  CF-ZIP-PRIME.
  3729                 24  CF-ZIP-1ST             PIC X.
  3730                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3731                 24  FILLER                 PIC X(4).
  3732             20  CF-ZIP-PLUS4               PIC X(4).
  3733         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3734             20  CF-CAN-POSTAL-1            PIC XXX.
  3735             20  CF-CAN-POSTAL-2            PIC XXX.
  3736             20  FILLER                     PIC XXX.
  3737
  3738         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3739         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3740         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3741
  3742         16  CF-RATING-SWITCH               PIC X.
  3743             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3744             88  CF-NO-RATING                   VALUE 'N'.
  3745
  3746         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3747
  3748         16  CF-CARRIER-OVER-SHORT.
  3749             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3750             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3751
  3752         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3753         16  CF-SECPAY-SWITCH               PIC X.
  3754             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3755             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3756         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3757         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3758         16  FILLER                         PIC X(444).
  3759*        16  FILLER                         PIC X(452).
  3760
  3761
  3762****************************************************************
  3763*             MORTALITY MASTER RECORD                          *
  3764****************************************************************
  3765
  3766     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3767         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3768                                INDEXED BY CF-MORT-NDX.
  3769             20  CF-MORT-TABLE              PIC X(5).
  3770             20  CF-MORT-TABLE-TYPE         PIC X.
  3771                 88  CF-MORT-JOINT              VALUE 'J'.
  3772                 88  CF-MORT-SINGLE             VALUE 'S'.
  3773                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  71
* EL1278.cbl
  3774                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3775                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3776             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3777             20  CF-MORT-AGE-METHOD         PIC XX.
  3778                 88  CF-AGE-LAST                VALUE 'AL'.
  3779                 88  CF-AGE-NEAR                VALUE 'AN'.
  3780             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3781             20  CF-MORT-ADJUSTMENT-DIRECTION
  3782                                            PIC X.
  3783                 88  CF-MINUS                   VALUE '-'.
  3784                 88  CF-PLUS                    VALUE '+'.
  3785             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3786             20  CF-MORT-JOINT-CODE         PIC X.
  3787                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3788             20  CF-MORT-PC-Q               PIC X.
  3789                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3790             20  CF-MORT-TABLE-CODE         PIC X(4).
  3791             20  CF-MORT-COMMENTS           PIC X(15).
  3792             20  FILLER                     PIC X(14).
  3793
  3794         16  FILLER                         PIC X(251).
  3795
  3796
  3797****************************************************************
  3798*             BUSSINESS TYPE MASTER RECORD                     *
  3799****************************************************************
  3800
  3801     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3802* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3803* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3804* AND RECORD 05 IS TYPES 81-99
  3805         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3806             20  CF-BUSINESS-TITLE          PIC  X(19).
  3807             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3808                                            PIC S9V9(4) COMP-3.
  3809             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3810             20  FILLER                     PIC  X.
  3811         16  FILLER                         PIC  X(248).
  3812
  3813
  3814****************************************************************
  3815*             TERMINAL MASTER RECORD                           *
  3816****************************************************************
  3817
  3818     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3819
  3820         16  CF-COMPANY-TERMINALS.
  3821             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3822                                  PIC X(4).
  3823         16  FILLER               PIC X(248).
  3824
  3825
  3826****************************************************************
  3827*             LIFE EDIT MASTER RECORD                          *
  3828****************************************************************
  3829
  3830     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3831         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  72
* EL1278.cbl
  3832             20  CF-LIFE-CODE-IN            PIC XX.
  3833             20  CF-LIFE-CODE-OUT           PIC XX.
  3834         16  FILLER                         PIC X(248).
  3835
  3836
  3837****************************************************************
  3838*             AH EDIT MASTER RECORD                            *
  3839****************************************************************
  3840
  3841     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3842         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3843             20  CF-AH-CODE-IN              PIC XXX.
  3844             20  CF-AH-CODE-OUT             PIC XX.
  3845         16  FILLER                         PIC X(248).
  3846
  3847
  3848****************************************************************
  3849*             CREDIBILITY TABLES                               *
  3850****************************************************************
  3851
  3852     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3853         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3854                             INDEXED BY CF-CRDB-NDX.
  3855             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3856             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3857             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3858         16  FILLER                         PIC  X(332).
  3859
  3860
  3861****************************************************************
  3862*             REPORT CUSTOMIZATION RECORD                      *
  3863****************************************************************
  3864
  3865     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3866         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3867             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3868             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3869             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3870**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3871****       A T-TRANSFER.                                   ****
  3872             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3873
  3874         16  FILLER                         PIC XX.
  3875
  3876         16  CF-CARRIER-CNTL-OPT.
  3877             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3878                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3879                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3880             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3881                                            PIC X.
  3882         16  CF-GROUP-CNTL-OPT.
  3883             20  CF-GROUP-OPT-SEQ           PIC 9.
  3884                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3885                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3886             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3887                                            PIC X(6).
  3888         16  CF-STATE-CNTL-OPT.
  3889             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  73
* EL1278.cbl
  3890                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3891                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3892             20  CF-STATE-SELECT OCCURS 3 TIMES
  3893                                            PIC XX.
  3894         16  CF-ACCOUNT-CNTL-OPT.
  3895             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3896                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3897                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3898             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3899                                            PIC X(10).
  3900         16  CF-BUS-TYP-CNTL-OPT.
  3901             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3902                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3903                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3904             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3905                                            PIC XX.
  3906         16  CF-LF-TYP-CNTL-OPT.
  3907             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3908                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3909                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3910             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3911                                            PIC XX.
  3912         16  CF-AH-TYP-CNTL-OPT.
  3913             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3914                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3915                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3916             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3917                                            PIC XX.
  3918         16  CF-REPTCD1-CNTL-OPT.
  3919             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3920                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3921                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3922             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3923                                            PIC X(10).
  3924         16  CF-REPTCD2-CNTL-OPT.
  3925             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3926                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3927                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3928             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3929                                            PIC X(10).
  3930         16  CF-USER1-CNTL-OPT.
  3931             20  CF-USER1-OPT-SEQ           PIC 9.
  3932                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3933                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3934             20  CF-USER1-SELECT OCCURS 3 TIMES
  3935                                            PIC X(10).
  3936         16  CF-USER2-CNTL-OPT.
  3937             20  CF-USER2-OPT-SEQ           PIC 9.
  3938                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3939                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3940             20  CF-USER2-SELECT OCCURS 3 TIMES
  3941                                            PIC X(10).
  3942         16  CF-USER3-CNTL-OPT.
  3943             20  CF-USER3-OPT-SEQ           PIC 9.
  3944                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3945                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3946             20  CF-USER3-SELECT OCCURS 3 TIMES
  3947                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  74
* EL1278.cbl
  3948         16  CF-USER4-CNTL-OPT.
  3949             20  CF-USER4-OPT-SEQ           PIC 9.
  3950                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3951                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3952             20  CF-USER4-SELECT OCCURS 3 TIMES
  3953                                            PIC X(10).
  3954         16  CF-USER5-CNTL-OPT.
  3955             20  CF-USER5-OPT-SEQ           PIC 9.
  3956                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3957                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3958             20  CF-USER5-SELECT OCCURS 3 TIMES
  3959                                            PIC X(10).
  3960         16  CF-REINS-CNTL-OPT.
  3961             20  CF-REINS-OPT-SEQ           PIC 9.
  3962                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3963                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3964             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3965                 24  CF-REINS-PRIME         PIC XXX.
  3966                 24  CF-REINS-SUB           PIC XXX.
  3967
  3968         16  CF-AGENT-CNTL-OPT.
  3969             20  CF-AGENT-OPT-SEQ           PIC 9.
  3970                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3971                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3972             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3973                                            PIC X(10).
  3974
  3975         16  FILLER                         PIC X(43).
  3976
  3977         16  CF-LOSS-RATIO-SELECT.
  3978             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3979             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3980         16  CF-ENTRY-DATE-SELECT.
  3981             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3982             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3983         16  CF-EFFECTIVE-DATE-SELECT.
  3984             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3985             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3986
  3987         16  CF-EXCEPTION-LIST-IND          PIC X.
  3988             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3989
  3990         16  FILLER                         PIC X(318).
  3991
  3992****************************************************************
  3993*                  EXCEPTION REPORTING RECORD                  *
  3994****************************************************************
  3995
  3996     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3997         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3998             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3999
  4000         16  CF-COMBINED-LIFE-AH-OPT.
  4001             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4002             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4003             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4004             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4005
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  75
* EL1278.cbl
  4006         16  CF-LIFE-OPT.
  4007             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4008             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4009             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4010             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4011             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4012             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4013             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4014             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4015             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4016             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4017
  4018         16  CF-AH-OPT.
  4019             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4020             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4021             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4022             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4023             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4024             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4025             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4026             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4027             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4028             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4029
  4030         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4031             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4032             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4033             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4034
  4035         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4036
  4037         16  FILLER                         PIC X(673).
  4038
  4039
  4040****************************************************************
  4041*             MORTGAGE SYSTEM PLAN RECORD                      *
  4042****************************************************************
  4043
  4044     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4045         16  CF-PLAN-TYPE                   PIC X.
  4046             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4047             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4048             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4049         16  CF-PLAN-ABBREV                 PIC XXX.
  4050         16  CF-PLAN-DESCRIPT               PIC X(10).
  4051         16  CF-PLAN-NOTES                  PIC X(20).
  4052         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4053         16  CF-PLAN-UNDERWRITING.
  4054             20  CF-PLAN-TERM-DATA.
  4055                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4056                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4057             20  CF-PLAN-AGE-DATA.
  4058                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4059                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4060                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4061             20  CF-PLAN-BENEFIT-DATA.
  4062                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4063                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  76
* EL1278.cbl
  4064                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4065                                            PIC S9(7)V99  COMP-3.
  4066         16  CF-PLAN-POLICY-FORMS.
  4067             20  CF-POLICY-FORM             PIC X(12).
  4068             20  CF-MASTER-APPLICATION      PIC X(12).
  4069             20  CF-MASTER-POLICY           PIC X(12).
  4070         16  CF-PLAN-RATING.
  4071             20  CF-RATE-CODE               PIC X(5).
  4072             20  CF-SEX-RATING              PIC X.
  4073                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4074                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4075             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4076             20  CF-SUB-STD-TYPE            PIC X.
  4077                 88  CF-PCT-OF-PREM            VALUE '1'.
  4078                 88  CF-PCT-OF-BENE            VALUE '2'.
  4079         16  CF-PLAN-PREM-TOLERANCES.
  4080             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4081             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4082         16  CF-PLAN-PYMT-TOLERANCES.
  4083             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4084             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4085         16  CF-PLAN-MISC-DATA.
  4086             20  FILLER                     PIC X.
  4087             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4088             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4089         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4090         16  CF-PLAN-IND-GRP                PIC X.
  4091             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4092                                                     '1'.
  4093             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4094                                                     '2'.
  4095         16  CF-MIB-SEARCH-SW               PIC X.
  4096             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4097             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4098             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4099             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4100         16  CF-ALPHA-SEARCH-SW             PIC X.
  4101             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4102             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4103             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4104             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4105             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4106             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4107             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4108             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4109             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4110             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4111                                                     'A' 'B' 'C'
  4112                                                     'X' 'Y' 'Z'.
  4113         16  CF-EFF-DT-RULE-SW              PIC X.
  4114             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4115             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4116             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4117             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4118             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4119         16  FILLER                         PIC X(4).
  4120         16  CF-HEALTH-QUESTIONS            PIC X.
  4121             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  77
* EL1278.cbl
  4122         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4123         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4124         16  CF-PLAN-SNGL-JNT               PIC X.
  4125             88  CF-COMBINED-PLAN              VALUE 'C'.
  4126             88  CF-JNT-PLAN                   VALUE 'J'.
  4127             88  CF-SNGL-PLAN                  VALUE 'S'.
  4128         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4129         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4130         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4131         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4132         16  CF-RERATE-CNTL                 PIC  X.
  4133             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4134             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4135             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4136             88  CF-AUTO-RECALC                 VALUE '4'.
  4137         16  CF-BENEFIT-TYPE                PIC  X.
  4138             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4139             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4140         16  CF-POLICY-FEE                  PIC S999V99
  4141                                                    COMP-3.
  4142         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4143         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4144         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4145         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4146         16  FILLER                         PIC  X(32).
  4147         16  CF-TERMINATION-FORM            PIC  X(04).
  4148         16  FILLER                         PIC  X(08).
  4149         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4150                                                       COMP-3.
  4151         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4152         16  CF-ISSUE-LETTER                PIC  X(4).
  4153         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4154         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4155             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4156             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4157         16  CF-MP-REFUND-CALC              PIC X.
  4158             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4159             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4160             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4161             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4162             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4163             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4164             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4165             88  CF-MP-REFD-MEAN                VALUE '8'.
  4166         16  CF-ALT-RATE-CODE               PIC  X(5).
  4167
  4168
  4169         16  FILLER                         PIC X(498).
  4170****************************************************************
  4171*             MORTGAGE COMPANY MASTER RECORD                   *
  4172****************************************************************
  4173
  4174     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4175         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4176         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4177             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4178             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4179             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  78
* EL1278.cbl
  4180             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4181             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4182
  4183         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4184         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4185         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4186         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4187         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4188
  4189         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4190             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4191         16  CF-MP-RECON-USE-IND            PIC X(1).
  4192             88  CF-MP-USE-RECON             VALUE 'Y'.
  4193         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4194             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4195         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4196             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4197             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4198         16  FILLER                         PIC X(1).
  4199         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4200             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4201         16  CF-MORTG-MIB-VERSION           PIC X.
  4202             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4203             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4204             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4205         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4206             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4207                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4208             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4209                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4210             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4211                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4212             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4213                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4214             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4215                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4216             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4217                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4218         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4219         16  FILLER                         PIC X(7).
  4220         16  CF-MORTG-DESTINATION-SYMBOL.
  4221             20  CF-MORTG-MIB-COMM          PIC X(5).
  4222             20  CF-MORTG-MIB-TERM          PIC X(5).
  4223         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4224             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4225         16  FILLER                         PIC X(03).
  4226         16  CF-MP-CHECK-NO-CONTROL.
  4227             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4228                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4229                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4230                                                ' ' LOW-VALUES.
  4231                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4232                                               VALUE '3'.
  4233         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4234         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4235         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4236             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4237                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  79
* EL1278.cbl
  4238             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4239                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4240             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4241                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4242             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4243                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4244             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4245                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4246             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4247                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4248         16  CF-MORTG-BILLING-AREA.
  4249             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4250                                            PIC X.
  4251         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4252         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4253         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4254         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4255             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4256             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4257         16  FILLER                         PIC X.
  4258         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4259             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4260             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4261         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4262         16  FILLER                         PIC X(8).
  4263         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4264         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4265         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4266         16  CF-ACH-COMPANY-ID.
  4267             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4268                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4269                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4270                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4271             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4272         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4273             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4274         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4275             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4276             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4277         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4278         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4279         16  FILLER                         PIC X(536).
  4280
  4281****************************************************************
  4282*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4283****************************************************************
  4284
  4285     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4286         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4287             20  CF-FEMALE-HEIGHT.
  4288                 24  CF-FEMALE-FT           PIC 99.
  4289                 24  CF-FEMALE-IN           PIC 99.
  4290             20  CF-FEMALE-MIN-WT           PIC 999.
  4291             20  CF-FEMALE-MAX-WT           PIC 999.
  4292         16  FILLER                         PIC X(428).
  4293
  4294     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4295         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  80
* EL1278.cbl
  4296             20  CF-MALE-HEIGHT.
  4297                 24  CF-MALE-FT             PIC 99.
  4298                 24  CF-MALE-IN             PIC 99.
  4299             20  CF-MALE-MIN-WT             PIC 999.
  4300             20  CF-MALE-MAX-WT             PIC 999.
  4301         16  FILLER                         PIC X(428).
  4302******************************************************************
  4303*             AUTOMATIC ACTIVITY RECORD                          *
  4304******************************************************************
  4305     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4306         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4307             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4308             20  CF-SYS-LETTER-ID           PIC X(04).
  4309             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4310             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4311             20  CF-SYS-RESET-SW            PIC X(01).
  4312             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4313             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4314
  4315         16  FILLER                         PIC X(50).
  4316
  4317         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4318             20  CF-USER-ACTIVE-SW          PIC X(01).
  4319             20  CF-USER-LETTER-ID          PIC X(04).
  4320             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4321             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4322             20  CF-USER-RESET-SW           PIC X(01).
  4323             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4324             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4325             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4326
  4327         16  FILLER                         PIC X(246).
  4328*                            COPY ERCACCT.
  4329******************************************************************
  4330*                                                                *
  4331*                                                                *
  4332*                            ERCACCT                             *
  4333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4334*                            VMOD=2.031                          *
  4335*                                                                *
  4336*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4337*                                                                *
  4338*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4339*   VSAM ACCOUNT MASTER FILES.                                   *
  4340*                                                                *
  4341*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4342*                                                                *
  4343*   FILE TYPE = VSAM,KSDS                                        *
  4344*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4345*                                                                *
  4346*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4347*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4348*                                                                *
  4349*   LOG = NO                                                     *
  4350*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4351*                                                                *
  4352*                                                                *
  4353******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  81
* EL1278.cbl
  4354*                   C H A N G E   L O G
  4355*
  4356* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4357*-----------------------------------------------------------------
  4358*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4359* EFFECTIVE    NUMBER
  4360*-----------------------------------------------------------------
  4361* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4362* 092705    2005050300006  PEMA  ADD SPP LEASES
  4363* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4364* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4365* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4366* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4367* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4368* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  4369******************************************************************
  4370
  4371 01  ACCOUNT-MASTER.
  4372     12  AM-RECORD-ID                      PIC XX.
  4373         88  VALID-AM-ID                      VALUE 'AM'.
  4374
  4375     12  AM-CONTROL-PRIMARY.
  4376         16  AM-COMPANY-CD                 PIC X.
  4377         16  AM-MSTR-CNTRL.
  4378             20  AM-CONTROL-A.
  4379                 24  AM-CARRIER            PIC X.
  4380                 24  AM-GROUPING.
  4381                     28 AM-GROUPING-PREFIX PIC XXX.
  4382                     28 AM-GROUPING-PRIME  PIC XXX.
  4383                 24  AM-STATE              PIC XX.
  4384                 24  AM-ACCOUNT.
  4385                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4386                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4387             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4388                                           PIC X(19).
  4389             20  AM-CNTRL-B.
  4390                 24  AM-EXPIRATION-DT      PIC XX.
  4391                 24  FILLER                PIC X(4).
  4392             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4393                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4394
  4395     12  AM-CONTROL-BY-VAR-GRP.
  4396         16  AM-COMPANY-CD-A1              PIC X.
  4397         16  AM-VG-CARRIER                 PIC X.
  4398         16  AM-VG-GROUPING                PIC X(6).
  4399         16  AM-VG-STATE                   PIC XX.
  4400         16  AM-VG-ACCOUNT                 PIC X(10).
  4401         16  AM-VG-DATE.
  4402             20  AM-VG-EXPIRATION-DT       PIC XX.
  4403             20  FILLER                    PIC X(4).
  4404         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4405                                           PIC 9(11)      COMP-3.
  4406     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4407         16  FILLER                        PIC X(10).
  4408         16  AM-VG-KEY3.
  4409             20  AM-VG3-ACCOUNT            PIC X(10).
  4410             20  AM-VG3-EXP-DT             PIC XX.
  4411         16  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  82
* EL1278.cbl
  4412     12  AM-MAINT-INFORMATION.
  4413         16  AM-LAST-MAINT-DT              PIC XX.
  4414         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4415         16  AM-LAST-MAINT-USER            PIC X(4).
  4416         16  FILLER                        PIC XX.
  4417
  4418     12  AM-EFFECTIVE-DT                   PIC XX.
  4419     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4420
  4421     12  AM-PREV-DATES  COMP-3.
  4422         16  AM-PREV-EXP-DT                PIC 9(11).
  4423         16  AM-PREV-EFF-DT                PIC 9(11).
  4424
  4425     12  AM-REPORT-CODE-1                  PIC X(10).
  4426     12  AM-REPORT-CODE-2                  PIC X(10).
  4427
  4428     12  AM-CITY-CODE                      PIC X(4).
  4429     12  AM-COUNTY-PARISH                  PIC X(6).
  4430
  4431     12  AM-NAME                           PIC X(30).
  4432     12  AM-PERSON                         PIC X(30).
  4433     12  AM-ADDRS                          PIC X(30).
  4434     12  AM-CITY.
  4435         16  AM-ADDR-CITY                  PIC X(28).
  4436         16  AM-ADDR-STATE                 PIC XX.
  4437     12  AM-ZIP.
  4438         16  AM-ZIP-PRIME.
  4439             20  AM-ZIP-PRI-1ST            PIC X.
  4440                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4441             20  FILLER                    PIC X(4).
  4442         16  AM-ZIP-PLUS4                  PIC X(4).
  4443     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4444         16  AM-CAN-POSTAL-1               PIC XXX.
  4445         16  AM-CAN-POSTAL-2               PIC XXX.
  4446         16  FILLER                        PIC XXX.
  4447     12  AM-TEL-NO.
  4448         16  AM-AREA-CODE                  PIC 999.
  4449         16  AM-TEL-PRE                    PIC 999.
  4450         16  AM-TEL-NBR                    PIC 9(4).
  4451     12  AM-TEL-LOC                        PIC X.
  4452         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4453         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4454
  4455     12  AM-COMM-STRUCTURE.
  4456         16  AM-DEFN-1.
  4457             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4458                 24  AM-AGT.
  4459                     28  AM-AGT-PREFIX     PIC X(4).
  4460                     28  AM-AGT-PRIME      PIC X(6).
  4461                 24  AM-COM-TYP            PIC X.
  4462                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4463                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4464                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4465                 24  AM-RECALC-LV-INDIC    PIC X.
  4466                 24  AM-RETRO-LV-INDIC     PIC X.
  4467                 24  AM-GL-CODES           PIC X.
  4468                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4469                 24  FILLER                PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  83
* EL1278.cbl
  4470         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4471             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4472                 24  FILLER                PIC X(11).
  4473                 24  AM-L-COMA             PIC XXX.
  4474                 24  AM-J-COMA             PIC XXX.
  4475                 24  AM-A-COMA             PIC XXX.
  4476                 24  FILLER                PIC X(6).
  4477
  4478     12  AM-COMM-CHANGE-STATUS             PIC X.
  4479         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4480
  4481     12  AM-CSR-CODE                       PIC X(4).
  4482
  4483     12  AM-BILLING-STATUS                 PIC X.
  4484         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4485         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4486     12  AM-AUTO-REFUND-SW                 PIC X.
  4487         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4488         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4489     12  AM-GPCD                           PIC 99.
  4490     12  AM-IG                             PIC X.
  4491         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4492         88  AM-HAS-GROUP                     VALUE '2'.
  4493     12  AM-STATUS                         PIC X.
  4494         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4495         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4496         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4497         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4498         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4499         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4500         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  4501         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  4502         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  4503         88  AM-ACCOUNT-PENDING               VALUE '9'.
  4504     12  AM-REMIT-TO                       PIC 99.
  4505     12  AM-ID-NO                          PIC X(11).
  4506
  4507     12  AM-CAL-TABLE                      PIC XX.
  4508     12  AM-LF-DEVIATION                   PIC XXX.
  4509     12  AM-AH-DEVIATION                   PIC XXX.
  4510     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4511     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4512     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4513     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4514     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4515     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4516
  4517     12  AM-USER-FIELDS.
  4518         16  AM-FLD-1                      PIC XX.
  4519         16  AM-FLD-2                      PIC XX.
  4520         16  AM-FLD-3                      PIC XX.
  4521         16  AM-FLD-4                      PIC XX.
  4522         16  AM-FLD-5                      PIC XX.
  4523
  4524     12  AM-1ST-PROD-DATE.
  4525         16  AM-1ST-PROD-YR                PIC XX.
  4526         16  AM-1ST-PROD-MO                PIC XX.
  4527         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  84
* EL1278.cbl
  4528     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4529     12  AM-CERTS-PURGED-DATE.
  4530         16  AM-PUR-YR                     PIC XX.
  4531         16  AM-PUR-MO                     PIC XX.
  4532         16  AM-PUR-DA                     PIC XX.
  4533     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4534     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4535     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4536     12  AM-INACTIVE-DATE.
  4537         16  AM-INA-MO                     PIC 99.
  4538         16  AM-INA-DA                     PIC 99.
  4539         16  AM-INA-YR                     PIC 99.
  4540     12  AM-AR-HI-CERT-DATE                PIC XX.
  4541
  4542     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4543     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4544
  4545     12  AM-OB-PAYMENT-MODE                PIC X.
  4546         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4547         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4548         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4549         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4550
  4551     12  AM-AH-ONLY-INDICATOR              PIC X.
  4552         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4553         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4554
  4555     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4556
  4557     12  AM-OVER-SHORT.
  4558         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4559         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4560
  4561     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4562     12  AM-DCC-CLP-STATE                  PIC XX.
  4563
  4564     12  AM-RECALC-COMM                    PIC X.
  4565     12  AM-RECALC-REIN                    PIC X.
  4566
  4567     12  AM-REI-TABLE                      PIC XXX.
  4568     12  AM-REI-ET-LF                      PIC X.
  4569     12  AM-REI-ET-AH                      PIC X.
  4570     12  AM-REI-PE-LF                      PIC X.
  4571     12  AM-REI-PE-AH                      PIC X.
  4572     12  AM-REI-PRT-ST                     PIC X.
  4573     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4574     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4575     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4576     12  AM-REI-GROUP-A                    PIC X(6).
  4577     12  AM-REI-MORT                       PIC X(4).
  4578     12  AM-REI-PRT-OW                     PIC X.
  4579     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4580     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4581     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4582     12  AM-REI-GROUP-B                    PIC X(6).
  4583
  4584     12  AM-TRUST-TYPE                     PIC X(2).
  4585
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  85
* EL1278.cbl
  4586     12  AM-EMPLOYER-STMT-USED             PIC X.
  4587     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4588
  4589     12  AM-STD-AH-TYPE                    PIC XX.
  4590     12  AM-EARN-METHODS.
  4591         16  AM-EARN-METHOD-R              PIC X.
  4592             88 AM-REF-RL-R78                 VALUE 'R'.
  4593             88 AM-REF-RL-PR                  VALUE 'P'.
  4594             88 AM-REF-RL-MEAN                VALUE 'M'.
  4595             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4596         16  AM-EARN-METHOD-L              PIC X.
  4597             88 AM-REF-LL-R78                 VALUE 'R'.
  4598             88 AM-REF-LL-PR                  VALUE 'P'.
  4599             88 AM-REF-LL-MEAN                VALUE 'M'.
  4600             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4601         16  AM-EARN-METHOD-A              PIC X.
  4602             88 AM-REF-AH-R78                 VALUE 'R'.
  4603             88 AM-REF-AH-PR                  VALUE 'P'.
  4604             88 AM-REF-AH-MEAN                VALUE 'M'.
  4605             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4606             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4607             88 AM-REF-AH-NET                 VALUE 'N'.
  4608
  4609     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4610     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4611     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4612
  4613     12  AM-RET-Y-N                        PIC X.
  4614     12  AM-RET-P-E                        PIC X.
  4615     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4616     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4617     12  AM-RET-GRP                        PIC X(6).
  4618     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4619         16  AM-POOL-PRIME                 PIC XXX.
  4620         16  AM-POOL-SUB                   PIC XXX.
  4621     12  AM-RETRO-EARNINGS.
  4622         16  AM-RET-EARN-R                 PIC X.
  4623         16  AM-RET-EARN-L                 PIC X.
  4624         16  AM-RET-EARN-A                 PIC X.
  4625     12  AM-RET-ST-TAX-USE                 PIC X.
  4626         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4627         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4628     12  AM-RETRO-BEG-EARNINGS.
  4629         16  AM-RET-BEG-EARN-R             PIC X.
  4630         16  AM-RET-BEG-EARN-L             PIC X.
  4631         16  AM-RET-BEG-EARN-A             PIC X.
  4632     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4633     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4634
  4635     12  AM-USER-SELECT-OPTIONS.
  4636         16  AM-USER-SELECT-1              PIC X(10).
  4637         16  AM-USER-SELECT-2              PIC X(10).
  4638         16  AM-USER-SELECT-3              PIC X(10).
  4639         16  AM-USER-SELECT-4              PIC X(10).
  4640         16  AM-USER-SELECT-5              PIC X(10).
  4641
  4642     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4643
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  86
* EL1278.cbl
  4644     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4645
  4646     12  AM-RPT045A-SWITCH                 PIC X.
  4647         88  RPT045A-OFF                   VALUE 'N'.
  4648
  4649     12  AM-INSURANCE-LIMITS.
  4650         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4651         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4652
  4653     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4654         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4655
  4656     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4657         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4658         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4659
  4660     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4661
  4662     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4663     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4664     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4665     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4666     12  AM-DCC-UEF-STATE                  PIC XX.
  4667     12  FILLER                            PIC XXX.
  4668     12  AM-REPORT-CODE-3                  PIC X(10).
  4669*    12  FILLER                            PIC X(22).
  4670
  4671     12  AM-RESERVE-DATE.
  4672         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4673         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4674         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4675
  4676     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4677     12  AM-NOTIFICATION-TYPES.
  4678         16  AM-NOTIF-OF-LETTERS           PIC X.
  4679         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4680         16  AM-NOTIF-OF-REPORTS           PIC X.
  4681         16  AM-NOTIF-OF-STATUS            PIC X.
  4682
  4683     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4684         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4685         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4686         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4687         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4688
  4689     12  AM-BENEFIT-CONTROLS.
  4690         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4691             20  AM-BENEFIT-CODE           PIC XX.
  4692             20  AM-BENEFIT-TYPE           PIC X.
  4693             20  AM-BENEFIT-REVISION       PIC XXX.
  4694             20  AM-BENEFIT-REM-TERM       PIC X.
  4695             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4696             20  FILLER                    PIC XX.
  4697         16  FILLER                        PIC X(80).
  4698
  4699     12  AM-TRANSFER-DATA.
  4700         16  AM-TRANSFERRED-FROM.
  4701             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  87
* EL1278.cbl
  4702             20  AM-TRNFROM-GROUPING.
  4703                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4704                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4705             20  AM-TRNFROM-STATE          PIC XX.
  4706             20  AM-TRNFROM-ACCOUNT.
  4707                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4708                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4709             20  AM-TRNFROM-DTE            PIC XX.
  4710         16  AM-TRANSFERRED-TO.
  4711             20  AM-TRNTO-CARRIER          PIC X.
  4712             20  AM-TRNTO-GROUPING.
  4713                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4714                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4715             20  AM-TRNTO-STATE            PIC XX.
  4716             20  AM-TRNTO-ACCOUNT.
  4717                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4718                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4719             20  AM-TRNTO-DTE              PIC XX.
  4720         16  FILLER                        PIC X(10).
  4721
  4722     12  AM-SAVED-REMIT-TO                 PIC 99.
  4723
  4724     12  AM-COMM-STRUCTURE-SAVED.
  4725         16  AM-DEFN-1-SAVED.
  4726             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4727                 24  AM-AGT-SV             PIC X(10).
  4728                 24  AM-COM-TYP-SV         PIC X.
  4729                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4730                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4731                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4732                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4733                 24  FILLER                PIC X.
  4734                 24  AM-GL-CODES-SV        PIC X.
  4735                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4736                 24  FILLER                PIC X.
  4737         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4738             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4739                 24  FILLER                PIC X(11).
  4740                 24  AM-L-COMA-SV          PIC XXX.
  4741                 24  AM-J-COMA-SV          PIC XXX.
  4742                 24  AM-A-COMA-SV          PIC XXX.
  4743                 24  FILLER                PIC X(6).
  4744
  4745     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4746         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4747            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4748            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4749            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4750
  4751     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4752     12  FILLER                            PIC X(120).
  4753
  4754     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4755         16  AM-CONTROL-NAME               PIC X(30).
  4756         16  AM-EXECUTIVE-ONE.
  4757             20  AM-EXEC1-NAME             PIC X(15).
  4758             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4759                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  88
* EL1278.cbl
  4760             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4761                                                          COMP-3.
  4762         16  AM-EXECUTIVE-TWO.
  4763             20  AM-EXEC2-NAME             PIC X(15).
  4764             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4765                                                          COMP-3.
  4766             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4767                                                          COMP-3.
  4768
  4769     12  AM-RETRO-ADDITIONAL-DATA.
  4770         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4771         16  AM-RETRO-PREM-P-E             PIC X.
  4772         16  AM-RETRO-CLMS-P-I             PIC X.
  4773         16  AM-RETRO-RET-BRACKET-LF.
  4774             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4775                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4776                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4777             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4778                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4779                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4780             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4781                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4782                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4783         16  AM-RETRO-RET-BRACKET-AH.
  4784             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4785                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4786                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4787                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4788             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4789                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4790                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4791             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4792                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4793                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4794
  4795     12  AM-COMMENTS.
  4796         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4797
  4798     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4799         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4800         16  AM-FLI-BILLING-CODE           PIC X.
  4801         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4802         16  AM-FLI-UNITED-IDENT           PIC X.
  4803         16  AM-FLI-INTEREST-LOST-DATA.
  4804             20  AM-FLI-BANK-NO            PIC X(5).
  4805             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4806             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4807             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4808         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4809             20  AM-FLI-AGT                PIC X(9).
  4810             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4811             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4812         16  FILLER                        PIC X(102).
  4813
  4814     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4815         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4816             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4817             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  89
* EL1278.cbl
  4818             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4819             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4820             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4821         16  FILLER                          PIC X(10).
  4822******************************************************************
  4823*                            COPY ELCCERT.
  4824******************************************************************
  4825*                                                                *
  4826*                            ELCCERT.                            *
  4827*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4828*                            VMOD=2.013                          *
  4829*                                                                *
  4830*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4831*                                                                *
  4832*   FILE TYPE = VSAM,KSDS                                        *
  4833*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4834*                                                                *
  4835*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4836*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4837*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4838*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4839*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4840*                                                                *
  4841*   LOG = YES                                                    *
  4842*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4843******************************************************************
  4844*                   C H A N G E   L O G
  4845*
  4846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4847*-----------------------------------------------------------------
  4848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4849* EFFECTIVE    NUMBER
  4850*-----------------------------------------------------------------
  4851* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4852* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4853* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4854* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4855* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4856* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4857* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4858* 032612  CR2011110200001  PEMA  AHL CHANGES
  4859* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4860* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4861******************************************************************
  4862
  4863 01  CERTIFICATE-MASTER.
  4864     12  CM-RECORD-ID                      PIC XX.
  4865         88  VALID-CM-ID                      VALUE 'CM'.
  4866
  4867     12  CM-CONTROL-PRIMARY.
  4868         16  CM-COMPANY-CD                 PIC X.
  4869         16  CM-CARRIER                    PIC X.
  4870         16  CM-GROUPING.
  4871             20  CM-GROUPING-PREFIX        PIC X(3).
  4872             20  CM-GROUPING-PRIME         PIC X(3).
  4873         16  CM-STATE                      PIC XX.
  4874         16  CM-ACCOUNT.
  4875             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  90
* EL1278.cbl
  4876             20  CM-ACCOUNT-PRIME          PIC X(6).
  4877         16  CM-CERT-EFF-DT                PIC XX.
  4878         16  CM-CERT-NO.
  4879             20  CM-CERT-PRIME             PIC X(10).
  4880             20  CM-CERT-SFX               PIC X.
  4881
  4882     12  CM-CONTROL-BY-NAME.
  4883         16  CM-COMPANY-CD-A1              PIC X.
  4884         16  CM-INSURED-LAST-NAME          PIC X(15).
  4885         16  CM-INSURED-INITIALS.
  4886             20  CM-INSURED-INITIAL1       PIC X.
  4887             20  CM-INSURED-INITIAL2       PIC X.
  4888
  4889     12  CM-CONTROL-BY-SSN.
  4890         16  CM-COMPANY-CD-A2              PIC X.
  4891         16  CM-SOC-SEC-NO.
  4892             20  CM-SSN-STATE              PIC XX.
  4893             20  CM-SSN-ACCOUNT            PIC X(6).
  4894             20  CM-SSN-LN3.
  4895                 25  CM-INSURED-INITIALS-A2.
  4896                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4897                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4898                 25 CM-PART-LAST-NAME-A2         PIC X.
  4899
  4900     12  CM-CONTROL-BY-CERT-NO.
  4901         16  CM-COMPANY-CD-A4              PIC X.
  4902         16  CM-CERT-NO-A4                 PIC X(11).
  4903
  4904     12  CM-CONTROL-BY-MEMB.
  4905         16  CM-COMPANY-CD-A5              PIC X.
  4906         16  CM-MEMBER-NO.
  4907             20  CM-MEMB-STATE             PIC XX.
  4908             20  CM-MEMB-ACCOUNT           PIC X(6).
  4909             20  CM-MEMB-LN4.
  4910                 25  CM-INSURED-INITIALS-A5.
  4911                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4912                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4913                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4914
  4915     12  CM-INSURED-PROFILE-DATA.
  4916         16  CM-INSURED-FIRST-NAME.
  4917             20  CM-INSURED-1ST-INIT       PIC X.
  4918             20  FILLER                    PIC X(9).
  4919         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4920         16  CM-INSURED-SEX                PIC X.
  4921             88  CM-SEX-MALE                  VALUE 'M'.
  4922             88  CM-SEX-FEMAL                 VALUE 'F'.
  4923         16  CM-INSURED-JOINT-AGE          PIC 99.
  4924         16  CM-JOINT-INSURED-NAME.
  4925             20  CM-JT-LAST-NAME           PIC X(15).
  4926             20  CM-JT-FIRST-NAME.
  4927                 24  CM-JT-1ST-INIT        PIC X.
  4928                 24  FILLER                PIC X(9).
  4929             20  CM-JT-INITIAL             PIC X.
  4930
  4931     12  CM-LIFE-DATA.
  4932         16  CM-LF-BENEFIT-CD              PIC XX.
  4933         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  91
* EL1278.cbl
  4934         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4935         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4936         16  CM-LF-DEV-CODE                PIC XXX.
  4937         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4938         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4939         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4940         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4941         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4942         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4943         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4944         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4945         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4946         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4947         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4948         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4949         16  cm-temp-epiq                  pic xx.
  4950             88  EPIQ-CLASS                  value 'EQ'.
  4951*        16  FILLER                        PIC XX.
  4952
  4953     12  CM-AH-DATA.
  4954         16  CM-AH-BENEFIT-CD              PIC XX.
  4955         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4956         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4957         16  CM-AH-DEV-CODE                PIC XXX.
  4958         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4959         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4960         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4961         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4962         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4963         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4964         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4965         16  CM-AH-PAID-THRU-DT            PIC XX.
  4966             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4967         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4968         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4969         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4970         16  FILLER                        PIC X.
  4971
  4972     12  CM-LOAN-INFORMATION.
  4973         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4974         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4975                                           PIC S9(5)V99  COMP-3.
  4976         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4977         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4978         16  CM-PAY-FREQUENCY              PIC S99.
  4979         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4980         16  CM-RATE-CLASS                 PIC XX.
  4981         16  CM-BENEFICIARY                PIC X(25).
  4982         16  CM-POLICY-FORM-NO             PIC X(12).
  4983         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4984         16  CM-LAST-ADD-ON-DT             PIC XX.
  4985         16  CM-DEDUCTIBLE-AMOUNTS.
  4986             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4987             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4988         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4989             20  CM-RESIDENT-STATE         PIC XX.
  4990             20  CM-RATE-CODE              PIC X(4).
  4991             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  92
* EL1278.cbl
  4992         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4993             20  CM-LOAN-OFFICER           PIC X(5).
  4994             20  FILLER                    PIC XXX.
  4995         16  CM-CSR-CODE                   PIC XXX.
  4996         16  CM-UNDERWRITING-CODE          PIC X.
  4997             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4998         16  CM-POST-CARD-IND              PIC X.
  4999         16  CM-NH-INTERFACE-SW            PIC X.
  5000         16  CM-PREMIUM-TYPE               PIC X.
  5001             88  CM-SING-PRM                  VALUE '1'.
  5002             88  CM-O-B-COVERAGE              VALUE '2'.
  5003             88  CM-OPEN-END                  VALUE '3'.
  5004         16  CM-IND-GRP-TYPE               PIC X.
  5005             88  CM-INDIVIDUAL                VALUE 'I'.
  5006             88  CM-GROUP                     VALUE 'G'.
  5007         16  CM-SKIP-CODE                  PIC X.
  5008             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5009             88  SKIP-JULY                    VALUE '1'.
  5010             88  SKIP-AUGUST                  VALUE '2'.
  5011             88  SKIP-SEPTEMBER               VALUE '3'.
  5012             88  SKIP-JULY-AUG                VALUE '4'.
  5013             88  SKIP-AUG-SEPT                VALUE '5'.
  5014             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5015             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5016             88  SKIP-JUNE                    VALUE '8'.
  5017             88  SKIP-JUNE-JULY               VALUE '9'.
  5018             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5019             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5020         16  CM-PAYMENT-MODE               PIC X.
  5021             88  PAY-MONTHLY                  VALUE SPACE.
  5022             88  PAY-WEEKLY                   VALUE '1'.
  5023             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5024             88  PAY-BI-WEEKLY                VALUE '3'.
  5025             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5026         16  CM-LOAN-NUMBER                PIC X(8).
  5027         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5028         16  CM-OLD-LOF                    PIC XXX.
  5029*        16  CM-LOAN-OFFICER               PIC XXX.
  5030         16  CM-REIN-TABLE                 PIC XXX.
  5031         16  CM-SPECIAL-REIN-CODE          PIC X.
  5032         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5033         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5034         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5035
  5036     12  CM-STATUS-DATA.
  5037         16  CM-ENTRY-STATUS               PIC X.
  5038         16  CM-ENTRY-DT                   PIC XX.
  5039
  5040         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5041         16  CM-LF-CANCEL-DT               PIC XX.
  5042         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5043
  5044         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5045         16  CM-LF-DEATH-DT                PIC XX.
  5046         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5047
  5048         16  CM-LF-CURRENT-STATUS          PIC X.
  5049             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  93
* EL1278.cbl
  5050                                                'M' '4' '5' '9'.
  5051             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5052             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5053             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5054             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5055             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5056             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5057             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5058             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5059             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5060             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5061             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5062             88  CM-LF-DECLINED               VALUE 'D'.
  5063             88  CM-LF-VOIDED                 VALUE 'V'.
  5064
  5065         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5066         16  CM-AH-CANCEL-DT               PIC XX.
  5067         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5068
  5069         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5070         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5071         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5072
  5073         16  CM-AH-CURRENT-STATUS          PIC X.
  5074             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5075                                                'M' '4' '5' '9'.
  5076             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5077             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5078             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5079             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5080             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5081             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5082             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5083             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5084             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5085             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5086             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5087             88  CM-AH-DECLINED               VALUE 'D'.
  5088             88  CM-AH-VOIDED                 VALUE 'V'.
  5089
  5090         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5091             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5092             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5093             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5094         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5095
  5096         16  CM-ENTRY-BATCH                PIC X(6).
  5097         16  CM-LF-EXIT-BATCH              PIC X(6).
  5098         16  CM-AH-EXIT-BATCH              PIC X(6).
  5099         16  CM-LAST-MONTH-END             PIC XX.
  5100
  5101     12  CM-NOTE-SW                        PIC X.
  5102         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5103         88  CERT-NOTES-PRESENT               VALUE '1'.
  5104         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5105         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5106         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5107         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  94
* EL1278.cbl
  5108         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5109         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5110     12  CM-COMP-EXCP-SW                   PIC X.
  5111         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5112         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5113     12  CM-INSURED-ADDRESS-SW             PIC X.
  5114         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5115         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5116
  5117*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5118     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5119     12  FILLER                            PIC X.
  5120
  5121*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5122     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5123     12  FILLER                            PIC X.
  5124*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5125     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5126
  5127     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5128         88  CERT-ADDED-BATCH                 VALUE ' '.
  5129         88  CERT-ADDED-ONLINE                VALUE '1'.
  5130         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5131         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5132         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5133     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5134         88  CERT-AS-LOADED                   VALUE ' '.
  5135         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5136         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5137         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5138         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5139         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5140         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5141         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5142
  5143     12  CM-ACCOUNT-COMM-PCTS.
  5144         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5145         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5146
  5147     12  CM-USER-FIELD                     PIC X.
  5148     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5149     12  CM-CLP-STATE                      PIC XX.
  5150     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5151     12  CM-USER-RESERVED                  PIC XXX.
  5152     12  FILLER REDEFINES CM-USER-RESERVED.
  5153         16  CM-AH-CLASS-CD                PIC XX.
  5154         16  F                             PIC X.
  5155******************************************************************
  5156*                            COPY ERCMAIL.
  5157******************************************************************
  5158*                                                                *
  5159*                                                                *
  5160*                            ERCMAIL                             *
  5161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5162*                            VMOD=2.003                          *
  5163*                                                                *
  5164*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5165*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  95
* EL1278.cbl
  5166*   FILE TYPE = VSAM,KSDS                                        *
  5167*   RECORD SIZE = 374   RECFORM = FIX                            *
  5168*                                                                *
  5169*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5170*   ALTERNATE PATH    = NOT USED                                 *
  5171*                                                                *
  5172*   LOG = YES                                                    *
  5173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5174******************************************************************
  5175*                   C H A N G E   L O G
  5176*
  5177* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5178*-----------------------------------------------------------------
  5179*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5180* EFFECTIVE    NUMBER
  5181*-----------------------------------------------------------------
  5182* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5183* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5184* 111108                   PEMA  ADD CRED BENE ADDR2
  5185******************************************************************
  5186
  5187 01  MAILING-DATA.
  5188     12  MA-RECORD-ID                      PIC XX.
  5189         88  VALID-MA-ID                       VALUE 'MA'.
  5190
  5191     12  MA-CONTROL-PRIMARY.
  5192         16  MA-COMPANY-CD                 PIC X.
  5193         16  MA-CARRIER                    PIC X.
  5194         16  MA-GROUPING.
  5195             20  MA-GROUPING-PREFIX        PIC XXX.
  5196             20  MA-GROUPING-PRIME         PIC XXX.
  5197         16  MA-STATE                      PIC XX.
  5198         16  MA-ACCOUNT.
  5199             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5200             20  MA-ACCOUNT-PRIME          PIC X(6).
  5201         16  MA-CERT-EFF-DT                PIC XX.
  5202         16  MA-CERT-NO.
  5203             20  MA-CERT-PRIME             PIC X(10).
  5204             20  MA-CERT-SFX               PIC X.
  5205
  5206     12  FILLER                            PIC XX.
  5207
  5208     12  MA-ACCESS-CONTROL.
  5209         16  MA-SOURCE-SYSTEM              PIC XX.
  5210             88  MA-FROM-CREDIT                VALUE 'CR'.
  5211             88  MA-FROM-VSI                   VALUE 'VS'.
  5212             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5213             88  MA-FROM-OTHER                 VALUE 'OT'.
  5214         16  MA-RECORD-ADD-DT              PIC XX.
  5215         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5216         16  MA-LAST-MAINT-DT              PIC XX.
  5217         16  MA-LAST-MAINT-BY              PIC XXXX.
  5218         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5219
  5220     12  MA-PROFILE-INFO.
  5221         16  MA-QUALIFY-CODE-1             PIC XX.
  5222         16  MA-QUALIFY-CODE-2             PIC XX.
  5223         16  MA-QUALIFY-CODE-3             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  96
* EL1278.cbl
  5224         16  MA-QUALIFY-CODE-4             PIC XX.
  5225         16  MA-QUALIFY-CODE-5             PIC XX.
  5226
  5227         16  MA-INSURED-LAST-NAME          PIC X(15).
  5228         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5229         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5230         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5231         16  MA-INSURED-BIRTH-DT           PIC XX.
  5232         16  MA-INSURED-SEX                PIC X.
  5233             88  MA-SEX-MALE                   VALUE 'M'.
  5234             88  MA-SEX-FEMALE                 VALUE 'F'.
  5235         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5236
  5237         16  MA-ADDRESS-CORRECTED          PIC X.
  5238         16  MA-JOINT-BIRTH-DT             PIC XX.
  5239*        16  FILLER                        PIC X(12).
  5240
  5241         16  MA-ADDRESS-LINE-1             PIC X(30).
  5242         16  MA-ADDRESS-LINE-2             PIC X(30).
  5243         16  MA-CITY-STATE.
  5244             20  MA-CITY                   PIC X(28).
  5245             20  MA-ADDR-STATE             PIC XX.
  5246         16  MA-ZIP.
  5247             20  MA-ZIP-CODE.
  5248                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5249                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5250                 24  FILLER                PIC X(4).
  5251             20  MA-ZIP-PLUS4              PIC X(4).
  5252         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5253             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5254             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5255             20  FILLER                    PIC X(3).
  5256
  5257         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5258
  5259         16  FILLER                        PIC XXX.
  5260*        16  FILLER                        PIC X(10).
  5261
  5262     12  MA-CRED-BENE-INFO.
  5263         16  MA-CRED-BENE-NAME                 PIC X(25).
  5264         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5265         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5266         16  MA-CRED-BENE-CTYST.
  5267             20  MA-CRED-BENE-CITY             PIC X(28).
  5268             20  MA-CRED-BENE-STATE            PIC XX.
  5269         16  MA-CRED-BENE-ZIP.
  5270             20  MA-CB-ZIP-CODE.
  5271                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5272                     88  MA-CB-CANADIAN-POST-CODE
  5273                                           VALUE 'A' THRU 'Z'.
  5274                 24  FILLER                    PIC X(4).
  5275             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5276         16  MA-CB-CANADIAN-POSTAL-CODE
  5277                            REDEFINES MA-CRED-BENE-ZIP.
  5278             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5279             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5280             20  FILLER                        PIC X(3).
  5281     12  MA-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  97
* EL1278.cbl
  5282         16  MA-MAIL-DATA OCCURS 7.
  5283             20  MA-MAIL-TYPE              PIC X.
  5284                 88  MA-12MO-MAILING           VALUE '1'.
  5285                 88  MA-EXP-MAILING            VALUE '2'.
  5286             20  MA-MAIL-STATUS            PIC X.
  5287                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5288                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5289                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5290             20  MA-MAIL-DATE              PIC XX.
  5291     12  FILLER                            PIC XX.
  5292     12  FILLER                            PIC XX.
  5293*    12  FILLER                            PIC X(30).
  5294******************************************************************
  5295*                            COPY ELCCRTO.
  5296******************************************************************
  5297*                                                                *
  5298*                            ELCCRTO.                            *
  5299*                                                                *
  5300*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5301*                                                                *
  5302*   FILE TYPE = VSAM,KSDS                                        *
  5303*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5304*                                                                *
  5305*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5306*                                                                *
  5307*   LOG = YES                                                    *
  5308*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5309******************************************************************
  5310*                   C H A N G E   L O G
  5311*
  5312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5313*-----------------------------------------------------------------
  5314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5315* EFFECTIVE    NUMBER
  5316*-----------------------------------------------------------------
  5317* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5318* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5319* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5320* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5321* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5322******************************************************************
  5323 01  ORIGINAL-CERTIFICATE.
  5324     12  OC-RECORD-ID                      PIC XX.
  5325         88  VALID-OC-ID                      VALUE 'OC'.
  5326     12  OC-CONTROL-PRIMARY.
  5327         16  OC-COMPANY-CD                 PIC X.
  5328         16  OC-CARRIER                    PIC X.
  5329         16  OC-GROUPING                   PIC X(6).
  5330         16  OC-STATE                      PIC XX.
  5331         16  OC-ACCOUNT                    PIC X(10).
  5332         16  OC-CERT-EFF-DT                PIC XX.
  5333         16  OC-CERT-NO.
  5334             20  OC-CERT-PRIME             PIC X(10).
  5335             20  OC-CERT-SFX               PIC X.
  5336         16  OC-RECORD-TYPE                PIC X.
  5337         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5338     12  OC-LAST-MAINT-DT                  PIC XX.
  5339     12  OC-LAST-MAINT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  98
* EL1278.cbl
  5340     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5341     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5342     12  FILLER                            PIC X(49).
  5343     12  OC-ORIG-REC.
  5344         16  OC-INS-LAST-NAME              PIC X(15).
  5345         16  OC-INS-FIRST-NAME             PIC X(10).
  5346         16  OC-INS-MIDDLE-INIT            PIC X.
  5347         16  OC-INS-AGE                    PIC S999     COMP-3.
  5348         16  OC-JNT-LAST-NAME              PIC X(15).
  5349         16  OC-JNT-FIRST-NAME             PIC X(10).
  5350         16  OC-JNT-MIDDLE-INIT            PIC X.
  5351         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5352         16  OC-LF-BENCD                   PIC XX.
  5353         16  OC-LF-TERM                    PIC S999      COMP-3.
  5354         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5355         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5356         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5357         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5358         16  OC-LF-EXP-DT                  PIC XX.
  5359         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5360         16  OC-LF-CANCEL-DT               PIC XX.
  5361         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5362         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5363         16  OC-AH-BENCD                   PIC XX.
  5364         16  OC-AH-TERM                    PIC S999      COMP-3.
  5365         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5366         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5367         16  OC-AH-EXP-DT                  PIC XX.
  5368         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5369         16  OC-AH-CP                      PIC 99.
  5370         16  OC-AH-CANCEL-DT               PIC XX.
  5371         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5372         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5373         16  OC-CRED-BENE-NAME             PIC X(25).
  5374         16  OC-1ST-PMT-DT                 PIC XX.
  5375         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5376         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5377         16  OC-ISSUE-TRAN-IND             PIC X.
  5378         16  OC-CANCEL-TRAN-IND            PIC X.
  5379         16  FILLER                        PIC X(211).
  5380
  5381     12  FILLER                            PIC X(50).
  5382******************************************************************
  5383*                            COPY ERCFORM.
  5384******************************************************************
  5385*                                                                *
  5386*                                                                *
  5387*                            ERCFORM.                            *
  5388*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5389*                            VMOD=2.003                          *
  5390*                                                                *
  5391*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5392*                                                                *
  5393*    FILE TYPE = VSAM,KSDS                                       *
  5394*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5395*                                                                *
  5396*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5397*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page  99
* EL1278.cbl
  5398*    LOG = YES                                                   *
  5399*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5400******************************************************************
  5401 01  FORM-MASTER.
  5402    12  FO-RECORD-ID                 PIC X(02).
  5403        88  VALID-FO-ID                  VALUE 'FO'.
  5404
  5405    12  FO-CONTROL-PRIMARY.
  5406        16  FO-COMPANY-CD            PIC X(01).
  5407        16  FO-STATE                 PIC X(02).
  5408        16  FO-FORM-ID               PIC X(12).
  5409        16  FO-FORM-EXP-DT           PIC X(02).
  5410
  5411    12  FO-POLICY-FORM-DATA.
  5412        16  FO-IND-GRP-CD            PIC X(01).
  5413        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5414        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5415        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5416        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5417        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5418        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5419        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5420        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5421        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5422        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5423        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5424        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5425        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5426        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5427        16  FO-APP-CERT-USE-CD       PIC X(01).
  5428
  5429    12  FILLER                       PIC X(29).
  5430
  5431    12  FO-FORM-PLAN-TABLE.
  5432        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5433            20  FO-PLAN-TYPE         PIC X(01).
  5434            20  FO-PLAN-ID           PIC X(02).
  5435            20  FO-PLAN-TERM         PIC 9(03).
  5436            20  FO-PLAN-REFUND-METHOD
  5437                                     PIC X.
  5438
  5439    12  FILLER                       PIC X(30).
  5440
  5441    12  FO-COMMENTS-AREA.
  5442        16  FO-COMMENT-LINE-1        PIC X(78).
  5443
  5444    12  FILLER                       PIC X(20).
  5445
  5446    12  FO-MAINT-INFORMATION.
  5447        16  FO-LAST-MAINT-DT         PIC X(02).
  5448        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5449        16  FO-LAST-MAINT-BY         PIC X(04).
  5450*                            COPY ELCMSTR.
  5451******************************************************************
  5452*                                                                *
  5453*                            ELCMSTR.                            *
  5454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5455*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 100
* EL1278.cbl
  5456*                                                                *
  5457*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5458*                                                                *
  5459*   FILE TYPE = VSAM,KSDS                                        *
  5460*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5461*                                                                *
  5462*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5463*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5464*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5465*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5466*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5467*                                                 RKP=75,LEN=21  *
  5468*                                                                *
  5469*   **** NOTE ****                                               *
  5470*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5471*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5472*                                                                *
  5473*   LOG = YES                                                    *
  5474*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5475******************************************************************
  5476*                   C H A N G E   L O G
  5477*
  5478* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5479*-----------------------------------------------------------------
  5480*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5481* EFFECTIVE    NUMBER
  5482*-----------------------------------------------------------------
  5483* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5484* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5485* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  5486* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5487* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5488******************************************************************
  5489 01  CLAIM-MASTER.
  5490     12  CL-RECORD-ID                PIC XX.
  5491         88  VALID-CL-ID         VALUE 'CL'.
  5492
  5493     12  CL-CONTROL-PRIMARY.
  5494         16  CL-COMPANY-CD           PIC X.
  5495         16  CL-CARRIER              PIC X.
  5496         16  CL-CLAIM-NO             PIC X(7).
  5497         16  CL-CERT-NO.
  5498             20  CL-CERT-PRIME       PIC X(10).
  5499             20  CL-CERT-SFX         PIC X.
  5500
  5501     12  CL-CONTROL-BY-NAME.
  5502         16  CL-COMPANY-CD-A1        PIC X.
  5503         16  CL-INSURED-LAST-NAME    PIC X(15).
  5504         16  CL-INSURED-NAME.
  5505             20  CL-INSURED-1ST-NAME PIC X(12).
  5506             20  CL-INSURED-MID-INIT PIC X.
  5507
  5508     12  CL-CONTROL-BY-SSN.
  5509         16  CL-COMPANY-CD-A2        PIC X.
  5510         16  CL-SOC-SEC-NO.
  5511             20  CL-SSN-STATE        PIC XX.
  5512             20  CL-SSN-ACCOUNT      PIC X(6).
  5513             20  CL-SSN-LN3          PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 101
* EL1278.cbl
  5514
  5515     12  CL-CONTROL-BY-CERT-NO.
  5516         16  CL-COMPANY-CD-A4        PIC X.
  5517         16  CL-CERT-NO-A4.
  5518             20  CL-CERT-A4-PRIME    PIC X(10).
  5519             20  CL-CERT-A4-SFX      PIC X.
  5520
  5521     12  CL-CONTROL-BY-CCN.
  5522         16  CL-COMPANY-CD-A5        PIC X.
  5523         16  CL-CCN-A5.
  5524             20  CL-CCN.
  5525                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5526                 24  CL-CCN-PRIME-A5 PIC X(12).
  5527             20  CL-CCN-FILLER-A5    PIC X(4).
  5528
  5529     12  CL-INSURED-PROFILE-DATA.
  5530         16  CL-INSURED-BIRTH-DT     PIC XX.
  5531         16  CL-INSURED-SEX-CD       PIC X.
  5532             88  INSURED-IS-MALE        VALUE 'M'.
  5533             88  INSURED-IS-FEMALE      VALUE 'F'.
  5534             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5535         16  CL-INSURED-OCC-CD       PIC X(6).
  5536         16  FILLER                  PIC X(5).
  5537
  5538     12  CL-PROCESSING-INFO.
  5539         16  CL-PROCESSOR-ID         PIC X(4).
  5540         16  CL-CLAIM-STATUS         PIC X.
  5541             88  CLAIM-IS-OPEN          VALUE 'O'.
  5542             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5543         16  CL-CLAIM-TYPE           PIC X.
  5544*            88  AH-CLAIM               VALUE 'A'.
  5545*            88  LIFE-CLAIM             VALUE 'L'.
  5546*            88  PROPERTY-CLAIM         VALUE 'P'.
  5547*            88  IUI-CLAIM              VALUE 'I'.
  5548*            88  GAP-CLAIM              VALUE 'G'.
  5549*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  5550         16  CL-CLAIM-PREM-TYPE      PIC X.
  5551             88  SINGLE-PREMIUM         VALUE '1'.
  5552             88  O-B-COVERAGE           VALUE '2'.
  5553             88  OPEN-END-COVERAGE      VALUE '3'.
  5554         16  CL-INCURRED-DT          PIC XX.
  5555         16  CL-REPORTED-DT          PIC XX.
  5556         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5557         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5558         16  CL-LAST-PMT-DT          PIC XX.
  5559         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5560         16  CL-PAID-THRU-DT         PIC XX.
  5561         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5562         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5563         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5564         16  CL-PMT-CALC-METHOD      PIC X.
  5565             88  CL-360-DAY-YR          VALUE '1'.
  5566             88  CL-365-DAY-YR          VALUE '2'.
  5567             88  CL-FULL-MONTHS         VALUE '3'.
  5568         16  CL-CAUSE-CD             PIC X(6).
  5569
  5570         16  CL-PRIME-CERT-NO.
  5571             20  CL-PRIME-CERT-PRIME PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 102
* EL1278.cbl
  5572             20  CL-PRIME-CERT-SFX   PIC X.
  5573
  5574         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5575             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5576             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5577
  5578         16  CL-MICROFILM-NO         PIC X(10).
  5579         16  FILLER REDEFINES CL-MICROFILM-NO.
  5580             20  CL-BENEFIT-PERIOD   PIC 99.
  5581             20  FILLER              PIC X(8).
  5582         16  CL-PROG-FORM-TYPE       PIC X.
  5583         16  CL-LAST-ADD-ON-DT       PIC XX.
  5584
  5585         16  CL-LAST-REOPEN-DT       PIC XX.
  5586         16  CL-LAST-CLOSE-DT        PIC XX.
  5587         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5588             88  FINAL-PAID             VALUE '1'.
  5589             88  CLAIM-DENIED           VALUE '2'.
  5590             88  AUTO-CLOSE             VALUE '3'.
  5591             88  MANUAL-CLOSE           VALUE '4'.
  5592             88  BENEFITS-CHANGED       VALUE 'C'.
  5593             88  SETUP-ERRORS           VALUE 'E'.
  5594         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5595         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5596         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5597             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5598         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5599         16  FILLER                  PIC X.
  5600
  5601     12  CL-CERTIFICATE-DATA.
  5602         16  CL-CERT-ORIGIN          PIC X.
  5603             88  CERT-WAS-ONLINE        VALUE '1'.
  5604             88  CERT-WAS-CREATED       VALUE '2'.
  5605             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5606         16  CL-CERT-KEY-DATA.
  5607             20  CL-CERT-CARRIER     PIC X.
  5608             20  CL-CERT-GROUPING    PIC X(6).
  5609             20  CL-CERT-STATE       PIC XX.
  5610             20  CL-CERT-ACCOUNT.
  5611                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5612                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5613             20  CL-CERT-EFF-DT      PIC XX.
  5614
  5615     12  CL-STATUS-CONTROLS.
  5616         16  CL-PRIORITY-CD          PIC X.
  5617             88  CONFIDENTIAL-DATA      VALUE '8'.
  5618             88  HIGHEST-PRIORITY       VALUE '9'.
  5619         16  CL-SUPV-ATTN-CD         PIC X.
  5620             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5621             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5622         16  CL-PURGED-DT            PIC XX.
  5623         16  CL-RESTORED-DT          PIC XX.
  5624         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5625         16  CL-NEXT-RESEND-DT       PIC XX.
  5626         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5627         16  CL-CRITICAL-PERIOD      PIC 99.
  5628*        16  FILLER                  PIC XX.
  5629         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 103
* EL1278.cbl
  5630         16  CL-LAST-MAINT-USER      PIC X(4).
  5631         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5632         16  CL-LAST-MAINT-TYPE      PIC X.
  5633             88  CLAIM-SET-UP           VALUE ' '.
  5634             88  PAYMENT-MADE           VALUE '1'.
  5635             88  LETTER-SENT            VALUE '2'.
  5636             88  MASTER-WAS-ALTERED     VALUE '3'.
  5637             88  MASTER-WAS-RESTORED    VALUE '4'.
  5638             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5639             88  FILE-CONVERTED         VALUE '6'.
  5640             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5641             88  ERROR-CORRECTION       VALUE 'E'.
  5642         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5643         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5644         16  CL-BENEFICIARY          PIC X(10).
  5645         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5646         16  CL-DENIAL-TYPE          PIC X.
  5647             88  CL-TYPE-DENIAL          VALUE '1'.
  5648             88  CL-TYPE-RESCISSION      VALUE '2'.
  5649             88  CL-TYPE-REFORMATION     VALUE '3'.
  5650             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5651             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5652         16  filler                  pic x(5).
  5653*        16  CL-CRIT-PER-RECURRENT   PIC X.
  5654*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  5655*        16  CL-RTW-DT               PIC XX.
  5656
  5657     12  CL-TRAILER-CONTROLS.
  5658         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5659             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5660             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5661             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5662         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5663         16  FILLER                  PIC XX.
  5664         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5665         16  CL-ADDRESS-TRAILER-CNT.
  5666             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5667                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5668             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5669                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5670             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5671                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5672             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5673                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5674             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5675                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5676             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5677                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5678             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5679                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5680
  5681     12  CL-CV-REFERENCE-NO.
  5682         16  CL-CV-REFNO-PRIME       PIC X(18).
  5683         16  CL-CV-REFNO-SFX         PIC XX.
  5684
  5685     12  CL-FILE-LOCATION            PIC X(4).
  5686
  5687     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 104
* EL1278.cbl
  5688         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5689             88  NO-FATAL-ERRORS        VALUE ZERO.
  5690         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5691             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5692
  5693     12  CL-PRODUCT-CD               PIC X.
  5694
  5695     12  CL-CURRENT-KEY-DATA.
  5696         16  CL-CURRENT-CARRIER      PIC X.
  5697         16  CL-CURRENT-GROUPING     PIC X(6).
  5698         16  CL-CURRENT-STATE        PIC XX.
  5699         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5700
  5701     12  CL-ASSOCIATES               PIC X.
  5702         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5703         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5704         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5705         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5706
  5707     12  CL-ACTIVITY-CODE            PIC 99.
  5708     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5709     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5710
  5711     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5712     12  CL-LAG-REPORT-CODE          PIC 9.
  5713     12  CL-LOAN-TYPE                PIC XX.
  5714     12  CL-LEGAL-STATE              PIC XX.
  5715
  5716     12  CL-YESNOSW                  PIC X.
  5717     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  5718         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  5719         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  5720         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  5721     12  cl-insured-type             pic x.
  5722         88  cl-claim-on-primary         value 'P'.
  5723         88  cl-claim-on-co-borrower     value 'C'.
  5724     12  cl-benefit-expiration-dt    PIC XX.
  5725*                            COPY ERCPDEF.
  5726******************************************************************
  5727*                                                                *
  5728*                                                                *
  5729*                            ERCPDEF.                            *
  5730*                                                                *
  5731*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5732*                                                                *
  5733*    FILE TYPE = VSAM,KSDS                                       *
  5734*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5735*                                                                *
  5736*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5737*                                                                *
  5738*    LOG = YES                                                   *
  5739*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5740******************************************************************
  5741*                   C H A N G E   L O G
  5742*
  5743* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5744*-----------------------------------------------------------------
  5745*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 105
* EL1278.cbl
  5746* EFFECTIVE    NUMBER
  5747*-----------------------------------------------------------------
  5748* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5749* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5750* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  5751******************************************************************
  5752 01  PRODUCT-MASTER.
  5753    12  PD-RECORD-ID                 PIC X(02).
  5754        88  VALID-PD-ID                  VALUE 'PD'.
  5755    12  PD-CONTROL-PRIMARY.
  5756        16  PD-COMPANY-CD            PIC X.
  5757        16  PD-STATE                 PIC XX.
  5758        16  PD-PRODUCT-CD            PIC XXX.
  5759        16  PD-FILLER                PIC X(7).
  5760        16  PD-BEN-TYPE              PIC X.
  5761        16  PD-BEN-CODE              PIC XX.
  5762        16  PD-PROD-EXP-DT           PIC XX.
  5763    12  FILLER                       PIC X(50).
  5764    12  PD-PRODUCT-DATA OCCURS 8.
  5765        16  PD-PROD-CODE             PIC X.
  5766            88  PD-PROD-LIFE           VALUE 'L'.
  5767            88  PD-PROD-PROP           VALUE 'P'.
  5768            88  PD-PROD-AH             VALUE 'A'.
  5769            88  PD-PROD-IU             VALUE 'I'.
  5770            88  PD-PROD-GAP            VALUE 'G'.
  5771            88  PD-PROD-FAML           VALUE 'F'.
  5772        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5773        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5774        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5775        16  PD-MAX-TERM              PIC S999        COMP-3.
  5776        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5777        16  FILLER                   PIC X.
  5778        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5779        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5780        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5781        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5782        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5783        16  PD-REC-CRIT-PERIOD       PIC 99.
  5784        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5785            20  PD-RECURRING-YN      PIC X.
  5786            20  FILLER               PIC X.
  5787        16  PD-RTW-MOS               PIC 99.
  5788        16  PD-MAX-EXTENSION         PIC 99.
  5789        16  pd-ben-pct               pic sv999 comp-3.
  5790*       16  FILLER                   PIC XX.
  5791    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5792    12  PD-TERM-LIMITS OCCURS 15.
  5793        16  PD-LOW-TERM              PIC S999        COMP-3.
  5794        16  PD-HI-TERM               PIC S999        COMP-3.
  5795*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5796    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5797        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5798        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5799    12  PD-EARN-FACTORS.
  5800        16  FILLER OCCURS 15.
  5801            20  FILLER OCCURS 15.
  5802                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5803    12  PD-PRODUCT-DESC              PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 106
* EL1278.cbl
  5804    12  PD-TRUNCATED                 PIC X.
  5805    12  FILLER                       PIC X(59).
  5806    12  PD-MAINT-INFORMATION.
  5807        16  PD-LAST-MAINT-DT         PIC X(02).
  5808        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5809        16  PD-LAST-MAINT-BY         PIC X(04).
  5810*                            COPY ELCCRTT.
  5811******************************************************************
  5812*                                                                *
  5813*                            ELCCRTT.                            *
  5814*                                                                *
  5815*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5816*                                                                *
  5817*   FILE TYPE = VSAM,KSDS                                        *
  5818*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5819*                                                                *
  5820*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5821*                                                                *
  5822*   LOG = YES                                                    *
  5823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5824******************************************************************
  5825*                   C H A N G E   L O G
  5826*
  5827* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5828*-----------------------------------------------------------------
  5829*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5830* EFFECTIVE    NUMBER
  5831*-----------------------------------------------------------------
  5832* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5833* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5834* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5835* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5836* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5837* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5838* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5839* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5840* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5841******************************************************************
  5842
  5843 01  CERTIFICATE-TRAILERS.
  5844     12  CS-RECORD-ID                      PIC XX.
  5845         88  VALID-CS-ID                      VALUE 'CS'.
  5846
  5847     12  CS-CONTROL-PRIMARY.
  5848         16  CS-COMPANY-CD                 PIC X.
  5849         16  CS-CARRIER                    PIC X.
  5850         16  CS-GROUPING                   PIC X(6).
  5851         16  CS-STATE                      PIC XX.
  5852         16  CS-ACCOUNT                    PIC X(10).
  5853         16  CS-CERT-EFF-DT                PIC XX.
  5854         16  CS-CERT-NO.
  5855             20  CS-CERT-PRIME             PIC X(10).
  5856             20  CS-CERT-SFX               PIC X.
  5857         16  CS-TRAILER-TYPE               PIC X.
  5858             88  COMM-TRLR           VALUE 'A'.
  5859             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5860             88  CERT-DATA-TRLR      VALUE 'C'.
  5861
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 107
* EL1278.cbl
  5862     12  CS-DATA-AREA                      PIC X(516).
  5863
  5864     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5865         16  CS-BANK-COMMISSION-AREA.
  5866             20  CS-BANK-COMMS       OCCURS 10.
  5867                 24  CS-AGT                PIC X(10).
  5868                 24  CS-COM-TYP            PIC X.
  5869                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5870                 24  CS-RECALC-LV-INDIC    PIC X.
  5871                 24  FILLER                PIC X(10).
  5872         16  FILLER                        PIC X(256).
  5873
  5874     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5875****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5876         16  CS-MB-CLAIM-DATA OCCURS 24.
  5877             20  CS-CLAIM-NO               PIC X(7).
  5878             20  CS-CLAIM-TYPE             PIC X.
  5879                 88  CS-AH-CLM               VALUE 'A'.
  5880                 88  CS-IU-CLM               VALUE 'I'.
  5881                 88  CS-GP-CLM               VALUE 'G'.
  5882                 88  CS-LF-CLM               VALUE 'L'.
  5883                 88  CS-PR-CLM               VALUE 'P'.
  5884                 88  CS-FL-CLM               VALUE 'F'.
  5885             20  CS-INSURED-TYPE           PIC X.
  5886                 88  CS-PRIM-INSURED          VALUE 'P'.
  5887                 88  CS-CO-BORROWER           VALUE 'C'.
  5888             20  CS-BENEFIT-PERIOD         PIC 99.
  5889             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5890             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5891             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5892         16  FILLER                        PIC X(12).
  5893     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5894         16  CS-VIN-NUMBER                 PIC X(17).
  5895         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5896         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5897         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5898         16  cs-agent-name.
  5899             20  cs-agent-fname            pic x(20).
  5900             20  cs-agent-mi               pic x.
  5901             20  cs-agent-lname            pic x(25).
  5902         16  cs-license-no                 pic x(15).
  5903         16  cs-npn-number                 pic x(10).
  5904         16  cs-agent-edit-status          pic x.
  5905             88  cs-ae-refer-to-manager      value 'M'.
  5906             88  cs-ae-cover-sheet           value 'C'.
  5907             88  cs-ae-sig-form              value 'S'.
  5908             88  cs-ae-verified              value 'V'.
  5909             88  cs-unidentified-signature   value 'U'.
  5910             88  cs-cert-returned            value 'R'.
  5911             88  cs-accept-no-commission     value 'N'.
  5912         16  cs-year                       pic 9999.
  5913         16  cs-make                       pic x(20).
  5914         16  cs-model                      pic x(20).
  5915         16  cs-future                     pic x(20).
  5916         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5917         16  FILLER                        PIC X(356). *> was 420
  5918*        16  FILLER                        PIC X(496).
  5919 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 108
* EL1278.cbl
  5920                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5921                          MAILING-DATA ORIGINAL-CERTIFICATE
  5922                          FORM-MASTER CLAIM-MASTER
  5923                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5924 0000-DFHEXIT SECTION.
  5925     MOVE '9#                    $   ' TO DFHEIV0.
  5926     MOVE 'EL1278' TO DFHEIV1.
  5927     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5928*    SERVICE RELOAD PARMLIST.
  5929
  5930     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5931     MOVE '5'                    TO  DC-OPTION-CODE.
  5932
  5933     PERFORM 9600-DATE-LINK.
  5934
  5935     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5936     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5937     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5938     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5939     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5940     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5941     MOVE EIBTRMID               TO  QID-TERM.
  5942
  5943     IF EIBCALEN  IS EQUAL TO  ZERO
  5944         GO TO 8700-UNAUTHORIZED-ACCESS.
  5945
  5946     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5947         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5948             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5949             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5950             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5951             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5952             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5953             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5954             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5955             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5956         ELSE
  5957             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5958             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5959             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5960             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5961             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5962             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5963             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5964             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5965             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5966
  5967     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5968         GO TO 9300-CLEAR.
  5969
  5970     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5971         NEXT SENTENCE
  5972     ELSE
  5973
  5974* EXEC CICS READQ TS
  5975*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5976*            INTO    (SECURITY-CONTROL)
  5977*            LENGTH  (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 109
* EL1278.cbl
  5978*            ITEM    (SC-ITEM)
  5979*        END-EXEC
  5980*    MOVE '*$II   L              ''   #00005969' TO DFHEIV0
  5981     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5983     MOVE X'2020233030303035393639' TO DFHEIV0(25:11)
  5984     CALL 'kxdfhei1' USING DFHEIV0,
  5985           PI-SECURITY-TEMP-STORE-ID,
  5986           SECURITY-CONTROL,
  5987           SC-COMM-LENGTH,
  5988           SC-ITEM,
  5989           DFHEIV99,
  5990           DFHEIV99
  5991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5992         MOVE SC-CREDIT-DISPLAY (33)
  5993                                 TO  PI-DISPLAY-CAP
  5994         MOVE SC-CREDIT-UPDATE  (33)
  5995                                 TO  PI-MODIFY-CAP
  5996         MOVE SC-CREDIT-UPDATE  (32)
  5997                                 TO  PI-MODIFY-CERT-CAP
  5998         IF NOT  DISPLAY-CAP
  5999             MOVE 'READ'         TO  SM-READ
  6000             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6001             MOVE ER-0070        TO  EMI-ERROR
  6002             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6003             GO TO 8100-SEND-INITIAL-MAP.
  6004
  6005     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  6006         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  6007         MOVE LOW-VALUES         TO  EL127HI
  6008         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  6009                                     PI-LF-CANCEL-DATE
  6010                                     WS-AH-CANCEL-DATE
  6011                                     PI-AH-CANCEL-DATE
  6012         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  6013                                     PI-LF-CANCEL-DATE-ED
  6014                                     WS-AH-CANCEL-DATE-ED
  6015                                     PI-AH-CANCEL-DATE-ED
  6016         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  6017                                     PI-EARNING-METHOD-AH
  6018         PERFORM 0500-FORMAT-SCREEN
  6019         GO TO 8100-SEND-INITIAL-MAP.
  6020
  6021     IF NOT  MODIFY-CAP
  6022         MOVE 'UPDATE'           TO  SM-READ
  6023         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6024         MOVE ER-0070            TO  EMI-ERROR
  6025         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6026         GO TO 8100-SEND-INITIAL-MAP.
  6027
  6028
  6029* EXEC CICS HANDLE CONDITION
  6030*        PGMIDERR  (9500-PGMID-ERROR)
  6031*        ERROR     (9900-ABEND)
  6032*    END-EXEC.
  6033*    MOVE '"$L.                  ! " #00006011' TO DFHEIV0
  6034     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  6035     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 110
* EL1278.cbl
  6036     MOVE X'2220233030303036303131' TO DFHEIV0(25:11)
  6037     CALL 'kxdfhei1' USING DFHEIV0
  6038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6039
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 111
* EL1278.cbl
  6041 0200-RECEIVE.
  6042     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  6043         MOVE ER-0008            TO  EMI-ERROR
  6044         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6045         MOVE -1                 TO  HLCANCL
  6046         GO TO 8200-SEND-DATAONLY.
  6047
  6048
  6049* EXEC CICS RECEIVE
  6050*        MAP     (MAP-NAME)
  6051*        MAPSET  (MAPSET-NAME)
  6052*        INTO    (EL127HI)
  6053*    END-EXEC.
  6054     MOVE LENGTH OF
  6055      EL127HI
  6056       TO DFHEIV11
  6057*    MOVE '8"T I  L              ''   #00006023' TO DFHEIV0
  6058     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6060     MOVE X'2020233030303036303233' TO DFHEIV0(25:11)
  6061     CALL 'kxdfhei1' USING DFHEIV0,
  6062           MAP-NAME,
  6063           EL127HI,
  6064           DFHEIV11,
  6065           MAPSET-NAME,
  6066           DFHEIV99,
  6067           DFHEIV99
  6068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6069
  6070
  6071     IF HPFKEYL  IS EQUAL TO  ZERO
  6072         GO TO 0300-CHECK-PFKEYS.
  6073
  6074     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  6075         MOVE ER-0004            TO  EMI-ERROR
  6076         GO TO 0320-INPUT-ERROR.
  6077
  6078     IF HPFKEYI NUMERIC
  6079         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  6080             MOVE PF-VALUES (HPFKEYI)
  6081                                 TO  EIBAID
  6082         ELSE
  6083             MOVE ER-0029        TO  EMI-ERROR
  6084             GO TO 0320-INPUT-ERROR.
  6085
  6086 0300-CHECK-PFKEYS.
  6087     IF EIBAID  IS EQUAL TO  DFHPF23
  6088         GO TO 8800-PF23.
  6089
  6090     IF EIBAID  IS EQUAL TO  DFHPF24
  6091         GO TO 9100-RETURN-MAIN-MENU.
  6092     if eibaid not = dfhpf10
  6093        move 'N'                 to pi-pf10-ok
  6094     end-if
  6095     IF EIBAID = DFHPF11
  6096        GO TO 1700-WRITE-CERT-NOTE
  6097     END-IF
  6098
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 112
* EL1278.cbl
  6099     IF EIBAID  IS EQUAL TO  DFHPF12
  6100         GO TO 9400-PF12.
  6101
  6102     IF EIBAID = DFHENTER OR DFHPF10
  6103        GO TO 0400-EDIT-INPUT-DATA
  6104     END-IF
  6105
  6106     MOVE ER-0029                TO  EMI-ERROR.
  6107
  6108 0320-INPUT-ERROR.
  6109     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6110
  6111     MOVE AL-UNBON               TO  HPFKEYA.
  6112
  6113     IF HPFKEYL  IS EQUAL TO  ZERO
  6114         MOVE -1                 TO  HLCANCL
  6115     ELSE
  6116         MOVE -1                 TO  HPFKEYL.
  6117
  6118     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 113
* EL1278.cbl
  6120 0400-EDIT-INPUT-DATA.
  6121     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  6122                                     WS-NEW-LF-CANCEL-SW.
  6123
  6124     IF (HPCYNL > 0)
  6125        AND (HPCYNI = 'Y' OR 'N')
  6126        PERFORM 1800-READ-ELCERT-UPDATE
  6127                                 THRU 1800-EXIT
  6128        IF WS-RESP-NORMAL
  6129           MOVE HPCYNI           TO CM-POST-CARD-IND
  6130           PERFORM 1810-REWRITE-ELCERT
  6131                                 THRU 1810-EXIT
  6132        END-IF
  6133     END-IF
  6134     IF HLCAL1L GREATER ZERO
  6135         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  6136     IF CLPYNI = 'Y'
  6137        MOVE 'Y'                   TO PI-CLP-YN
  6138        MOVE AL-UANON              TO CLPYNA
  6139     ELSE
  6140        MOVE ' '                   TO PI-CLP-YN
  6141        MOVE AL-UANON              TO CLPYNA
  6142     END-IF
  6143     IF CANREAI = 'R'
  6144        MOVE 'R'                 TO PI-CANCEL-REASON
  6145        MOVE AL-UANON            TO CANREAA
  6146     ELSE
  6147        MOVE ' '                 TO PI-CANCEL-REASON
  6148        MOVE AL-UANON            TO CANREAA
  6149     END-IF
  6150
  6151     IF HLCANCL  IS EQUAL TO  ZERO
  6152       AND HACANCL  IS EQUAL TO  ZERO
  6153         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6154         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6155         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6156         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6157         GO TO 0420-CHECK-ERRORS.
  6158
  6159     IF HLCANCL  IS EQUAL TO  ZERO
  6160         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6161         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6162         GO TO 0410-CHECK-AH-DATE.
  6163
  6164     IF HLCANCI = SPACES
  6165        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  6166                                      WS-LF-CANCEL-DATE
  6167        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  6168                                      WS-LF-CANCEL-DATE-ED
  6169                                      PI-LF-REFUND-METH
  6170        MOVE +0                    TO PI-LF-REFUND-AMT
  6171        GO TO 0410-CHECK-AH-DATE
  6172     END-IF
  6173
  6174     MOVE AL-UNNON               TO  HLCANCA.
  6175     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6176     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6177
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 114
* EL1278.cbl
  6178     PERFORM 8600-DEEDIT.
  6179
  6180     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6181     MOVE '4'                    TO  DC-OPTION-CODE.
  6182
  6183     PERFORM 9600-DATE-LINK.
  6184
  6185     IF DATE-CONVERSION-ERROR
  6186         MOVE -1                 TO  HLCANCL
  6187         MOVE AL-UABON           TO  HLCANCA
  6188         MOVE ER-2227            TO  EMI-ERROR
  6189         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6190     ELSE
  6191        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6192           MOVE -1               TO  HACANCL
  6193           MOVE AL-UABON         TO  HACANCA
  6194           MOVE ER-2774          TO  EMI-ERROR
  6195           PERFORM 9700-ERROR-FORMAT
  6196                                 THRU  9799-EXIT
  6197        ELSE
  6198           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6199                                    PI-LF-CANCEL-DATE
  6200           MOVE DC-GREG-DATE-1-EDIT
  6201                                 TO HLCANCO
  6202                                    WS-LF-CANCEL-DATE-ED
  6203                                    PI-LF-CANCEL-DATE-ED
  6204        END-IF
  6205     END-IF
  6206     .
  6207 0410-CHECK-AH-DATE.
  6208     IF HACAL1L GREATER ZERO
  6209         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6210
  6211     IF HACANCL  IS EQUAL TO  ZERO
  6212         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6213         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6214         GO TO 0420-CHECK-ERRORS.
  6215     IF HACANCI = SPACES
  6216        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6217                                      WS-AH-CANCEL-DATE
  6218        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6219                                      WS-AH-CANCEL-DATE-ED
  6220                                      PI-AH-REFUND-METH
  6221        MOVE +0                    TO PI-AH-REFUND-AMT
  6222        GO TO 0420-CHECK-ERRORS
  6223     END-IF
  6224
  6225     MOVE AL-UNNON               TO  HACANCA.
  6226     MOVE HACANCI                TO  DEEDIT-FIELD.
  6227     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6228
  6229     PERFORM 8600-DEEDIT.
  6230
  6231     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6232     MOVE '4'                    TO  DC-OPTION-CODE.
  6233
  6234     PERFORM 9600-DATE-LINK.
  6235
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 115
* EL1278.cbl
  6236     IF DATE-CONVERSION-ERROR
  6237         MOVE -1                 TO  HACANCL
  6238         MOVE AL-UABON           TO  HACANCA
  6239         MOVE ER-2227            TO  EMI-ERROR
  6240         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6241     ELSE
  6242        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6243           MOVE -1               TO  HACANCL
  6244           MOVE AL-UABON         TO  HACANCA
  6245           MOVE ER-2775          TO  EMI-ERROR
  6246           PERFORM 9700-ERROR-FORMAT
  6247                                 THRU  9799-EXIT
  6248        ELSE
  6249           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6250                                    PI-AH-CANCEL-DATE
  6251           MOVE DC-GREG-DATE-1-EDIT
  6252                                 TO HACANCO
  6253                                    WS-AH-CANCEL-DATE-ED
  6254                                    PI-AH-CANCEL-DATE-ED
  6255        END-IF
  6256     END-IF
  6257     .
  6258 0420-CHECK-ERRORS.
  6259     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6260         NEXT SENTENCE
  6261     ELSE
  6262         GO TO 8200-SEND-DATAONLY.
  6263
  6264     PERFORM 0500-FORMAT-SCREEN.
  6265     if eibaid = dfhpf10
  6266        if pi-pf10-ok not = 'Y'
  6267           move 'Y'              to pi-pf10-ok
  6268           move er-3847          to emi-error
  6269           move -1               to hlcancl
  6270           perform 9700-error-format
  6271                                 thru 9799-exit
  6272           go to 8200-send-dataonly
  6273        end-if
  6274     end-if
  6275     IF EIBAID = DFHPF10
  6276        perform 4000-GEN-CANCEL-TRANS
  6277                                 thru 4000-exit
  6278        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6279        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6280        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6281        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6282        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6283        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6284                               PI-ALL-CANCELS-SW
  6285        IF PI-PROCESSOR-IS-CSR
  6286            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6287        ELSE
  6288            MOVE ' '        TO PI-CSR-SESSION-SW
  6289        END-IF
  6290        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6291                               PI-CANCELS-IN-ERROR-SW
  6292                               PI-ONLY-BATCH-HEADERS-SW
  6293                               PI-ALL-OUT-OF-BAL-SW
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 116
* EL1278.cbl
  6294                               PI-HOLD-REC-SW
  6295                               PI-CHANGE-REC-SW
  6296                               PI-CHK-REQ-REC-SW
  6297                               PI-ISSUE-WARNING-SW
  6298                               PI-CANCEL-WARNING-SW
  6299        MOVE '1'            TO PI-BROWSE-TYPE
  6300        MOVE DFHENTER       TO  EIBAID
  6301
  6302
  6303* EXEC CICS XCTL
  6304*           PROGRAM    ('EL6311')
  6305*           COMMAREA   (WS-PASS-631)
  6306*           LENGTH     (1300)
  6307*       END-EXEC
  6308     MOVE 'EL6311' TO DFHEIV1
  6309     MOVE 1300
  6310       TO DFHEIV11
  6311*    MOVE '.$C                   %   #00006260' TO DFHEIV0
  6312     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6313     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6314     MOVE X'2020233030303036323630' TO DFHEIV0(25:11)
  6315     CALL 'kxdfhei1' USING DFHEIV0,
  6316           DFHEIV1,
  6317           WS-PASS-631,
  6318           DFHEIV11,
  6319           DFHEIV99
  6320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6321
  6322*        PERFORM 0500-FORMAT-SCREEN
  6323     END-IF
  6324     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 117
* EL1278.cbl
  6326 0500-FORMAT-SCREEN  SECTION.
  6327     MOVE LOW-VALUES             TO  EL127HO.
  6328     MOVE PI-CARRIER             TO  HCARIERO.
  6329     MOVE PI-GROUPING            TO  HGROUPO.
  6330     MOVE PI-STATE               TO  HSTATEO.
  6331     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6332     MOVE ' '                    TO  DC-OPTION-CODE.
  6333     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6334
  6335     PERFORM 9600-DATE-LINK.
  6336
  6337     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6338     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6339     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6340     MOVE PI-CLP-YN              TO  CLPYNO
  6341     MOVE PI-CANCEL-REASON       TO  CANREAO
  6342     .
  6343 0510-GET-CERT.
  6344     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6345     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6346     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6347     MOVE PI-STATE               TO  WS-CM-STATE.
  6348     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6349     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6350     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6351     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6352
  6353     PERFORM 0900-READ-CERT-FILE.
  6354
  6355     IF CERT-NOT-FOUND
  6356         MOVE -1                 TO  HLCANCL
  6357         MOVE AL-SANON           TO  HLCANCA
  6358         MOVE ER-0214            TO  EMI-ERROR
  6359         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6360         GO TO 8100-SEND-INITIAL-MAP.
  6361
  6362     IF CM-CLAIM-ATTACHED-COUNT = +0
  6363        GO TO 0510-SKIP-CLAIM-CHECK
  6364     END-IF
  6365*    DISPLAY ' STARTING CLAIM TEST '
  6366     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6367     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6368
  6369* EXEC CICS STARTBR
  6370*       DATASET     ('ELMSTR5')
  6371*       RIDFLD      (ELMSTR-KEY)
  6372*       RESP        (WS-RESPONSE)
  6373*    END-EXEC
  6374     MOVE 'ELMSTR5' TO DFHEIV1
  6375     MOVE 0
  6376       TO DFHEIV11
  6377*    MOVE '&,         G          &  N#00006312' TO DFHEIV0
  6378     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6379     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6380     MOVE X'204E233030303036333132' TO DFHEIV0(25:11)
  6381     CALL 'kxdfhei1' USING DFHEIV0,
  6382           DFHEIV1,
  6383           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 118
* EL1278.cbl
  6384           DFHEIV99,
  6385           DFHEIV11,
  6386           DFHEIV99
  6387     MOVE EIBRESP  TO WS-RESPONSE
  6388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6389     IF WS-RESP-NORMAL
  6390     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6391
  6392* EXEC CICS READNEXT
  6393*          DATASET   ('ELMSTR5')
  6394*          RIDFLD    (ELMSTR-KEY)
  6395*          SET       (ADDRESS OF CLAIM-MASTER)
  6396*          RESP      (WS-RESPONSE)
  6397*       END-EXEC
  6398     MOVE 'ELMSTR5' TO DFHEIV1
  6399     MOVE 0
  6400       TO DFHEIV11
  6401*    MOVE '&.S                   )  N#00006319' TO DFHEIV0
  6402     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6403     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6404     MOVE X'204E233030303036333139' TO DFHEIV0(25:11)
  6405     CALL 'kxdfhei1' USING DFHEIV0,
  6406           DFHEIV1,
  6407           DFHEIV20,
  6408           DFHEIV99,
  6409           ELMSTR-KEY,
  6410           DFHEIV99,
  6411           DFHEIV11,
  6412           DFHEIV99,
  6413           DFHEIV99
  6414     SET ADDRESS OF CLAIM-MASTER TO
  6415         DFHEIV20
  6416     MOVE EIBRESP  TO WS-RESPONSE
  6417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6418        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6419           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6420           AND (CM-CERT-NO = CL-CERT-NO)
  6421           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6422              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6423              SET FOUND-A-CLAIM  TO TRUE
  6424              IF CL-CLAIM-TYPE = 'L'
  6425                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6426                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6427                 END-IF
  6428                 IF CLAIM-IS-OPEN
  6429                    SET OPEN-LF-CLAIM TO TRUE
  6430                 ELSE
  6431                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6432                       MOVE CL-LAST-CLOSE-DT
  6433                                 TO WS-LF-LAST-CLOSE-DT
  6434                    END-IF
  6435                    SET CLOSED-LF-CLAIM TO TRUE
  6436                 END-IF
  6437              ELSE
  6438                 IF CLAIM-IS-OPEN
  6439                    MOVE CL-PAID-THRU-DT
  6440                                 TO WS-AH-PAID-THRU-DT
  6441                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 119
* EL1278.cbl
  6442                 ELSE
  6443                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6444                       MOVE CL-PAID-THRU-DT
  6445                                 TO WS-AH-PAID-THRU-DT
  6446                    END-IF
  6447                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6448                       MOVE CL-LAST-CLOSE-DT
  6449                                 TO WS-AH-LAST-CLOSE-DT
  6450                    END-IF
  6451                    SET CLOSED-AH-CLAIM TO TRUE
  6452                 END-IF
  6453              END-IF
  6454           END-IF
  6455        ELSE
  6456           SET I-SAY-TO-STOP TO TRUE
  6457        END-IF
  6458     END-PERFORM
  6459     END-IF
  6460     IF FOUND-A-CLAIM
  6461        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6462           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6463           MOVE ' '              TO DC-OPTION-CODE
  6464           PERFORM 9600-DATE-LINK
  6465           IF NO-CONVERSION-ERROR
  6466              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6467              MOVE AL-SANOF      TO LCLMDTHA
  6468           END-IF
  6469        END-IF
  6470        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6471           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6472           MOVE ' '              TO DC-OPTION-CODE
  6473           PERFORM 9600-DATE-LINK
  6474           IF NO-CONVERSION-ERROR
  6475              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6476              MOVE AL-SANOF      TO ACLMDTHA
  6477           END-IF
  6478        END-IF
  6479        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6480        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6481        MOVE CM-STATE            TO WS-CF-ACCESS
  6482        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6483
  6484* EXEC CICS READ
  6485*          DATASET  (ELCNTL-ID)
  6486*          SET      (ADDRESS OF CONTROL-FILE)
  6487*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6488*          RESP     (WS-RESPONSE)
  6489*       END-EXEC
  6490*    MOVE '&"S        E          (  N#00006390' TO DFHEIV0
  6491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6493     MOVE X'204E233030303036333930' TO DFHEIV0(25:11)
  6494     CALL 'kxdfhei1' USING DFHEIV0,
  6495           ELCNTL-ID,
  6496           DFHEIV20,
  6497           DFHEIV99,
  6498           WS-CF-CONTROL-PRIMARY,
  6499           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 120
* EL1278.cbl
  6500           DFHEIV99,
  6501           DFHEIV99
  6502     SET ADDRESS OF CONTROL-FILE TO
  6503         DFHEIV20
  6504     MOVE EIBRESP  TO WS-RESPONSE
  6505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6506        IF WS-RESP-NORMAL
  6507           MOVE CF-ST-REF-AH-DEATH-IND
  6508                                 TO WS-ST-REF-IND
  6509        END-IF
  6510     END-IF
  6511     .
  6512 0510-SKIP-CLAIM-CHECK.
  6513     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6514     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6515     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6516     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6517
  6518* EXEC CICS READ
  6519*        DATASET  (ERMAIL-ID)
  6520*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6521*        SET      (ADDRESS OF MAILING-DATA)
  6522*        RESP     (WS-RESPONSE)
  6523*    END-EXEC.
  6524*    MOVE '&"S        E          (  N#00006407' TO DFHEIV0
  6525     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6527     MOVE X'204E233030303036343037' TO DFHEIV0(25:11)
  6528     CALL 'kxdfhei1' USING DFHEIV0,
  6529           ERMAIL-ID,
  6530           DFHEIV20,
  6531           DFHEIV99,
  6532           WS-MA-CONTROL-PRIMARY,
  6533           DFHEIV99,
  6534           DFHEIV99,
  6535           DFHEIV99
  6536     SET ADDRESS OF MAILING-DATA TO
  6537         DFHEIV20
  6538     MOVE EIBRESP  TO WS-RESPONSE
  6539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6540
  6541     IF WS-RESP-NORMAL
  6542        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6543           (S1 > +7)
  6544           OR (MA-MAIL-STATUS (S1) = '1')
  6545        END-PERFORM
  6546        IF S1 > +7
  6547           MOVE AL-SANOF         TO HPCYNA
  6548        END-IF
  6549     END-IF
  6550     IF CM-POST-CARD-IND = 'Y'
  6551        MOVE 'Y'                 TO HPCYNO
  6552     ELSE
  6553        MOVE 'N'                 TO HPCYNO
  6554     END-IF
  6555     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6556        OR (NOT CERT-AS-LOADED)
  6557        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 121
* EL1278.cbl
  6558     END-IF
  6559*    IF (CERT-ADDED-BATCH)
  6560*       CONTINUE
  6561*    ELSE
  6562*       MOVE AL-SANOF            TO HPCYNA
  6563*    END-IF
  6564     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6565     MOVE '5'                    TO  DC-OPTION-CODE.
  6566
  6567     PERFORM 9600-DATE-LINK.
  6568
  6569     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6570     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6571     MOVE '1'                    TO  DC-OPTION-CODE.
  6572
  6573     PERFORM 9600-DATE-LINK.
  6574
  6575     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6576
  6577     MOVE ZEROS TO WS-TOT-ITDR.
  6578     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6579
  6580 0510-CHECK-LF-STATUS.
  6581
  6582     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6583         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6584                                    PI-LF-CANCEL-DATE
  6585         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6586                                    PI-LF-CANCEL-DATE-ED
  6587                                    PI-LF-REFUND-METH
  6588         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6589         GO TO 0510-CHECK-AH-STATUS.
  6590
  6591     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6592        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6593          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6594          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6595          IF FIRST-ENTRY
  6596              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6597              MOVE SPACES               TO DC-OPTION-CODE
  6598              PERFORM 9600-DATE-LINK
  6599              IF NOT DATE-CONVERSION-ERROR
  6600                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6601                                            PI-LF-CANCEL-DATE-ED
  6602                                            WS-LF-CANCEL-DATE-ED
  6603                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6604                                            WS-LF-CANCEL-DATE.
  6605
  6606     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6607        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6608          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6609          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6610          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6611        IF FIRST-ENTRY
  6612            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6613            MOVE SPACES               TO DC-OPTION-CODE
  6614            PERFORM 9600-DATE-LINK
  6615            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 122
* EL1278.cbl
  6616                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6617                                          PI-LF-CANCEL-DATE-ED
  6618                                          WS-LF-CANCEL-DATE-ED
  6619                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6620                                          WS-LF-CANCEL-DATE.
  6621
  6622 0510-CHECK-AH-STATUS.
  6623
  6624     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6625         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6626                                    PI-AH-CANCEL-DATE
  6627         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6628                                    PI-AH-CANCEL-DATE-ED
  6629                                    PI-AH-REFUND-METH
  6630         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6631         GO TO 0510-CONT.
  6632
  6633     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6634        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6635          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6636          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6637        IF FIRST-ENTRY
  6638            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6639            MOVE SPACES               TO DC-OPTION-CODE
  6640            PERFORM 9600-DATE-LINK
  6641            IF NOT DATE-CONVERSION-ERROR
  6642                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6643                                            PI-AH-CANCEL-DATE-ED
  6644                                            WS-AH-CANCEL-DATE-ED
  6645                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6646                                            WS-AH-CANCEL-DATE.
  6647
  6648     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6649        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6650          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6651          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6652          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6653         IF FIRST-ENTRY
  6654             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6655             MOVE SPACES               TO DC-OPTION-CODE
  6656             PERFORM 9600-DATE-LINK
  6657             IF NOT DATE-CONVERSION-ERROR
  6658                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6659                                            PI-AH-CANCEL-DATE-ED
  6660                                            WS-AH-CANCEL-DATE-ED
  6661                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6662                                            WS-AH-CANCEL-DATE.
  6663
  6664     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6665         MOVE 'CANC DT'              TO  CNCDTHDO
  6666         GO TO 0510-CONT.
  6667
  6668     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6669         MOVE 'DTH DT '              TO  CNCDTHDO
  6670         IF FIRST-ENTRY
  6671             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6672             MOVE ' '                TO  DC-OPTION-CODE
  6673             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 123
* EL1278.cbl
  6674             IF NOT DATE-CONVERSION-ERROR
  6675                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6676                                             PI-AH-CANCEL-DATE-ED
  6677                                             WS-AH-CANCEL-DATE-ED
  6678                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6679                                             WS-AH-CANCEL-DATE.
  6680
  6681 0510-CONT.
  6682
  6683     IF WS-TOT-ITDR GREATER THAN ZEROS
  6684         MOVE WS-TOT-ITDR TO TOITDRO.
  6685
  6686 0520-GET-COMPANY-RECORD.
  6687     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6688     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6689     MOVE SPACES                 TO  WS-CF-ACCESS.
  6690     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6691
  6692     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6693
  6694     IF CNTL-NOT-FOUND
  6695         MOVE -1                 TO  HLCANCL
  6696         MOVE AL-SANON           TO  HLCANCA
  6697         MOVE ER-2616            TO  EMI-ERROR
  6698         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6699         GO TO 8100-SEND-INITIAL-MAP.
  6700
  6701     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6702       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6703         MOVE CF-LIFE-OVERRIDE-L1
  6704                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6705         MOVE CF-LIFE-OVERRIDE-L2
  6706                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6707         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6708         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6709         MOVE CF-CR-REM-TERM-CALC
  6710                                 TO  WS-CF-CR-REM-TERM-CALC
  6711         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6712         IF CF-DEFAULT-APR NUMERIC
  6713             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6714             GO TO 0525-GET-LF-BENEFIT
  6715         ELSE
  6716             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6717             GO TO 0525-GET-LF-BENEFIT.
  6718
  6719     MOVE -1                     TO  HLCANCL.
  6720     MOVE AL-SANON               TO  HLCANCA.
  6721     MOVE ER-2616                TO  EMI-ERROR.
  6722
  6723     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6724
  6725     GO TO 8100-SEND-INITIAL-MAP.
  6726
  6727 0525-GET-LF-BENEFIT.
  6728
  6729     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6730        GO TO 0527-GET-AH-BENEFIT
  6731     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 124
* EL1278.cbl
  6732
  6733     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6734     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6735                                     HLCDO.
  6736     MOVE WS-CF-LIFE-OVERRIDE-L2
  6737                                 TO  HLKINDO.
  6738
  6739     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6740
  6741     IF BENEFIT-FOUND
  6742         NEXT SENTENCE
  6743     ELSE
  6744         MOVE -1                 TO  HLCDL
  6745         MOVE AL-SANON           TO  HLCDA
  6746         MOVE ER-0028            TO  EMI-ERROR
  6747         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6748         GO TO 8100-SEND-INITIAL-MAP.
  6749
  6750     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6751         MOVE AL-UNNOF           TO  HLTERMA.
  6752
  6753*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6754     MOVE WS-KIND                TO WS-LF-KIND
  6755     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6756                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6757
  6758     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6759         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6760                                 TO  WS-LF-CO-REM-TERM-CALC.
  6761
  6762     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6763         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6764                                 TO  WS-LF-CO-EARNINGS-CALC
  6765                                     WS-LF-CO-REFUND-CALC.
  6766
  6767     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6768         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6769                                 TO  WS-LF-SPECIAL-CALC-CD.
  6770
  6771     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6772         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6773                                 TO  WS-LF-CO-REFUND-CALC.
  6774
  6775 0527-GET-AH-BENEFIT.
  6776
  6777     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6778        GO TO 0530-GET-STATE-RECORD
  6779     END-IF
  6780
  6781     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6782     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6783                                     HACDO.
  6784     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6785
  6786     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6787
  6788     IF BENEFIT-FOUND
  6789         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 125
* EL1278.cbl
  6790     ELSE
  6791         MOVE -1                 TO  HACDL
  6792         MOVE AL-SANON           TO  HACDA
  6793         MOVE ER-0028            TO  EMI-ERROR
  6794         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6795         GO TO 8100-SEND-INITIAL-MAP.
  6796
  6797     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6798         MOVE AL-UNNOF           TO  HATERMA.
  6799
  6800*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6801     MOVE WS-KIND                TO  WS-AH-KIND
  6802
  6803     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6804         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6805                                 TO  WS-AH-CO-REM-TERM-CALC.
  6806
  6807     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6808         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6809                                 TO  WS-AH-CO-EARNINGS-CALC
  6810                                     WS-AH-CO-REFUND-CALC.
  6811
  6812     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6813         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6814                                 TO  WS-AH-SPECIAL-CALC-CD.
  6815
  6816     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6817         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6818                                 TO  WS-AH-CO-REFUND-CALC.
  6819     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6820        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6821                                 TO WS-AH-BEN-CATEGORY
  6822     END-IF
  6823     .
  6824 0530-GET-STATE-RECORD.
  6825     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6826     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6827     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6828     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6829
  6830     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6831
  6832     IF CNTL-NOT-FOUND
  6833         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6834                                     WS-LF-ST-REM-TERM-CALC
  6835         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6836         GO TO 0560-FIND-ACCOUNT.
  6837
  6838     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6839       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6840       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6841         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6842     ELSE
  6843         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6844                                     WS-LF-ST-REM-TERM-CALC
  6845         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6846         GO TO 0560-FIND-ACCOUNT.
  6847
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 126
* EL1278.cbl
  6848     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6849     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6850
  6851     IF CM-LF-BENEFIT-CD  = '00'
  6852         GO TO 0550-GET-AH-BEN-IN-STATE.
  6853
  6854 0540-GET-LF-BEN-IN-STATE.
  6855     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6856     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6857
  6858     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6859     IF CF-ST-RT-CALC NOT = SPACES
  6860        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6861     END-IF
  6862
  6863     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6864        IF CF-ST-RF-LR-CALC > '0'
  6865           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6866        END-IF
  6867        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6868           IF CF-ST-RF-LN-CALC > '0'
  6869              MOVE CF-ST-RF-LN-CALC
  6870                                 TO WS-LF-ST-REFUND-CALC
  6871           END-IF
  6872        END-IF
  6873     ELSE
  6874        IF CF-ST-RF-LL-CALC > '0'
  6875           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6876        END-IF
  6877     END-IF
  6878
  6879     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6880
  6881     IF NO-BENEFIT-FOUND
  6882*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6883         GO TO 0550-GET-AH-BEN-IN-STATE.
  6884
  6885     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6886         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6887                                 TO  WS-LF-ST-REM-TERM-CALC.
  6888
  6889     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6890         MOVE CF-ST-REFUND-CALC (SUB3)
  6891                                 TO  WS-LF-ST-REFUND-CALC.
  6892
  6893 0550-GET-AH-BEN-IN-STATE.
  6894     IF CM-AH-BENEFIT-CD  = '00'
  6895         GO TO 0560-FIND-ACCOUNT.
  6896
  6897     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6898     IF CF-ST-RT-CALC NOT = SPACES
  6899        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6900     END-IF
  6901
  6902     IF CF-ST-RF-AH-CALC > '0'
  6903        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6904     END-IF
  6905     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 127
* EL1278.cbl
  6906        IF CF-ST-RF-CP-CALC > '0'
  6907           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6908        END-IF
  6909     END-IF
  6910
  6911     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6912     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6913
  6914     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6915
  6916     IF NO-BENEFIT-FOUND
  6917*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6918         GO TO 0560-FIND-ACCOUNT.
  6919
  6920     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6921         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6922                                 TO  WS-AH-ST-REM-TERM-CALC.
  6923
  6924     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6925         MOVE CF-ST-REFUND-CALC (SUB3)
  6926                                 TO  WS-AH-ST-REFUND-CALC.
  6927
  6928 0560-FIND-ACCOUNT.
  6929     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6930     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6931     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6932     MOVE CM-STATE               TO  WS-AM-STATE.
  6933     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6934     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6935     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6936
  6937     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6938
  6939     IF ACCT-FOUND
  6940         NEXT SENTENCE
  6941     ELSE
  6942         GO TO 0585-NO-ACCT.
  6943
  6944 0570-READ-NEXT-RANGE.
  6945     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6946
  6947     IF ACCT-FOUND
  6948         NEXT SENTENCE
  6949     ELSE
  6950         GO TO 0580-ACCT-NOT-FOUND.
  6951
  6952     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6953       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6954       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6955       AND CM-STATE  IS EQUAL TO  AM-STATE
  6956       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6957         NEXT SENTENCE
  6958     ELSE
  6959         GO TO 0580-ACCT-NOT-FOUND.
  6960
  6961     MOVE 'X'                    TO  DATE-RANGE-SW.
  6962
  6963     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 128
* EL1278.cbl
  6964         MOVE 'X'                TO  DATE-RANGE-SW
  6965         GO TO 0580-ACCT-NOT-FOUND.
  6966
  6967     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6968         GO TO 0570-READ-NEXT-RANGE.
  6969
  6970     IF WS-BROWSE-STARTED-SW = 'Y'
  6971
  6972* EXEC CICS ENDBR
  6973*          DATASET    ('ERACCT')
  6974*       END-EXEC
  6975     MOVE 'ERACCT' TO DFHEIV1
  6976     MOVE 0
  6977       TO DFHEIV11
  6978*    MOVE '&2                    $   #00006843' TO DFHEIV0
  6979     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6980     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6981     MOVE X'2020233030303036383433' TO DFHEIV0(25:11)
  6982     CALL 'kxdfhei1' USING DFHEIV0,
  6983           DFHEIV1,
  6984           DFHEIV11,
  6985           DFHEIV99
  6986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6987        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6988     END-IF
  6989     MOVE ' '                    TO  DATE-RANGE-SW.
  6990     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6991
  6992     GO TO 0590-SET-ACCOUNT.
  6993
  6994 0580-ACCT-NOT-FOUND.
  6995     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6996         MOVE ER-2601            TO  EMI-ERROR
  6997     ELSE
  6998         MOVE ER-2619            TO  EMI-ERROR.
  6999
  7000     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  7001
  7002     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7003
  7004 0585-NO-ACCT.
  7005     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  7006     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  7007                                     WS-AM-EARN-METHOD-R
  7008                                     WS-AM-EARN-METHOD-A
  7009                                     WS-LF-AM-REM-TERM-CALC
  7010                                     WS-AH-AM-REM-TERM-CALC.
  7011
  7012     GO TO 0600-CHECK-FOR-LIFE.
  7013
  7014 0590-SET-ACCOUNT.
  7015******************************************************************
  7016******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  7017******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  7018******* METHODS.
  7019******************************************************************
  7020     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  7021     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 129
* EL1278.cbl
  7022     IF PI-COMPANY-ID EQUAL TO 'NCL'
  7023          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  7024                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  7025                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  7026                  IF FORM-FOUND
  7027                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  7028******************************************************************
  7029
  7030     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  7031     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  7032                                     WS-AM-EARN-METHOD-R
  7033                                     WS-AM-EARN-METHOD-A.
  7034
  7035*    EVALUATE AM-EARN-METHOD-R
  7036*       WHEN 'R'
  7037*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  7038*       WHEN 'P'
  7039*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  7040*       WHEN 'C'
  7041*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  7042*       WHEN 'A'
  7043*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  7044*       WHEN 'M'
  7045*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  7046*       WHEN 'S'
  7047*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  7048*    END-EVALUATE.
  7049
  7050*    EVALUATE AM-EARN-METHOD-L
  7051*       WHEN 'R'
  7052*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  7053*       WHEN 'P'
  7054*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  7055*       WHEN 'C'
  7056*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  7057*       WHEN 'A'
  7058*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  7059*       WHEN 'M'
  7060*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  7061*       WHEN 'S'
  7062*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  7063*    END-EVALUATE.
  7064
  7065*    EVALUATE AM-EARN-METHOD-A
  7066*       WHEN 'R'
  7067*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  7068*       WHEN 'P'
  7069*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  7070*       WHEN 'C'
  7071*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  7072*       WHEN 'A'
  7073*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  7074*       WHEN 'M'
  7075*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  7076*       WHEN 'N'
  7077*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  7078*       WHEN 'S'
  7079*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 130
* EL1278.cbl
  7080*    END-EVALUATE.
  7081
  7082     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  7083                                     WS-TOT-LF-PREM
  7084                                     WS-TOT-AH-RFND
  7085                                     WS-TOT-LF-RFND.
  7086
  7087 0600-CHECK-FOR-LIFE.
  7088     IF CM-LF-BENEFIT-CD  = '00'
  7089         GO TO 0640-AH-BENEFIT.
  7090
  7091 0610-GET-LIFE-BENEFIT.
  7092
  7093     IF ACCT-FOUND
  7094         MOVE +1                 TO SUB3
  7095         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  7096     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7097     MOVE WS-LF-KIND             TO  HLEDESCO.
  7098     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7099     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7100        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7101                             + CM-LF-ALT-PREMIUM-AMT
  7102     ELSE
  7103        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7104     END-IF
  7105
  7106     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7107     EVALUATE TRUE
  7108        WHEN ((OPEN-LF-CLAIM)
  7109           OR (CLOSED-LF-CLAIM))
  7110           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7111           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  7112                                    WS-TOT-LF-RFND
  7113                                    PI-LF-REFUND-AMT
  7114           IF CM-AH-BENEFIT-CD NOT = '00'
  7115              MOVE ZEROS         TO HAREFNDO
  7116                                    WS-TOT-AH-RFND
  7117                                    PI-AH-REFUND-AMT
  7118              MOVE SPACES        TO PI-AH-REFUND-METH
  7119           END-IF
  7120           MOVE ER-2965          TO EMI-ERROR
  7121           PERFORM 9700-ERROR-FORMAT
  7122                                 THRU  9799-EXIT
  7123           GO TO 0640-AH-BENEFIT
  7124        WHEN OPEN-LF-CLAIM
  7125           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7126           AND WS-ST-REF-IND = '4'
  7127           MOVE ER-2966          TO EMI-ERROR
  7128           PERFORM 9700-ERROR-FORMAT
  7129                                 THRU  9799-EXIT
  7130        WHEN OPEN-LF-CLAIM
  7131           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7132           AND WS-ST-REF-IND NOT = '4'
  7133           MOVE ER-2967          TO EMI-ERROR
  7134           PERFORM 9700-ERROR-FORMAT
  7135                                 THRU  9799-EXIT
  7136           GO TO 0640-AH-BENEFIT
  7137        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 131
* EL1278.cbl
  7138           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7139           AND WS-ST-REF-IND = '4'
  7140           MOVE ER-2968          TO EMI-ERROR
  7141           PERFORM 9700-ERROR-FORMAT
  7142                                 THRU  9799-EXIT
  7143        WHEN CLOSED-LF-CLAIM
  7144           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7145           AND WS-ST-REF-IND NOT = '4'
  7146           MOVE ER-2969          TO EMI-ERROR
  7147           PERFORM 9700-ERROR-FORMAT
  7148                                 THRU  9799-EXIT
  7149           GO TO 0640-AH-BENEFIT
  7150        WHEN OTHER
  7151           CONTINUE
  7152     END-EVALUATE
  7153     .
  7154 0620-GET-REM-TERM.
  7155     MOVE WS-CF-LIFE-OVERRIDE-L1
  7156                                 TO  CP-LIFE-OVERRIDE-CODE.
  7157     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7158     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7159     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  7160     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7161     MOVE CM-STATE               TO  CP-STATE.
  7162     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7163     MOVE WS-CF-LF-COVERAGE-TYPE
  7164                                 TO  CP-BENEFIT-TYPE.
  7165     MOVE WS-LF-KIND             TO  HLEDESCO.
  7166     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7167     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7168     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7169     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7170     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7171     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7172     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7173     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7174     MOVE WS-CF-CR-REM-TERM-CALC
  7175                                 TO  CP-REM-TERM-METHOD.
  7176
  7177     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7178         MOVE WS-LF-CO-REM-TERM-CALC
  7179                                 TO  CP-REM-TERM-METHOD.
  7180
  7181     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7182         MOVE WS-LF-ST-REM-TERM-CALC
  7183                                 TO  CP-REM-TERM-METHOD.
  7184
  7185     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7186         MOVE WS-LF-AM-REM-TERM-CALC
  7187                                 TO  CP-REM-TERM-METHOD.
  7188
  7189     IF (PI-COMPANY-ID = 'CID')
  7190        AND (CP-STATE-STD-ABBRV = 'WI')
  7191        MOVE '7'                 TO CP-REM-TERM-METHOD
  7192        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7193     END-IF
  7194     IF (PI-COMPANY-ID = 'CID')
  7195        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 132
* EL1278.cbl
  7196        AND (CM-CERT-EFF-DT >= X'9B41')
  7197        AND (CM-CERT-EFF-DT <= X'A2FB')
  7198        MOVE '7'                 TO CP-REM-TERM-METHOD
  7199        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7200     END-IF
  7201     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7202                                     CP-ORIGINAL-TERM
  7203                                     CP-LOAN-TERM.
  7204
  7205     IF CP-TRUNCATED-LIFE
  7206         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7207
  7208     IF CP-TERM-IS-DAYS
  7209         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7210             MOVE CM-LF-TERM-IN-DAYS
  7211                                 TO  CP-TERM-OR-EXT-DAYS
  7212         ELSE
  7213             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7214     ELSE
  7215         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7216             MOVE CM-PMT-EXTENSION-DAYS
  7217                                 TO  CP-TERM-OR-EXT-DAYS
  7218         ELSE
  7219             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7220
  7221*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7222     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7223     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7224     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7225     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7226
  7227
  7228* EXEC CICS READ
  7229*        DATASET  (ELCNTL-ID)
  7230*        SET      (ADDRESS OF CONTROL-FILE)
  7231*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7232*        RESP     (WS-RESPONSE)
  7233*    END-EXEC.
  7234*    MOVE '&"S        E          (  N#00007086' TO DFHEIV0
  7235     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7237     MOVE X'204E233030303037303836' TO DFHEIV0(25:11)
  7238     CALL 'kxdfhei1' USING DFHEIV0,
  7239           ELCNTL-ID,
  7240           DFHEIV20,
  7241           DFHEIV99,
  7242           WS-CF-CONTROL-PRIMARY,
  7243           DFHEIV99,
  7244           DFHEIV99,
  7245           DFHEIV99
  7246     SET ADDRESS OF CONTROL-FILE TO
  7247         DFHEIV20
  7248     MOVE EIBRESP  TO WS-RESPONSE
  7249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7250
  7251
  7252     IF WS-RESP-NOTOPEN
  7253         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 133
* EL1278.cbl
  7254         GO TO 0320-INPUT-ERROR.
  7255
  7256     IF WS-RESP-NOTFND
  7257         MOVE ZERO               TO  CP-FREE-LOOK
  7258     ELSE
  7259         MOVE CF-ST-FREE-LOOK-PERIOD
  7260                                 TO CP-FREE-LOOK.
  7261
  7262     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7263        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7264        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7265     END-IF
  7266
  7267     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7268
  7269     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7270        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7271        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7272        COMPUTE CP-REMAINING-TERM-1 =
  7273                CP-REMAINING-TERM-1 - +1
  7274        COMPUTE CP-REMAINING-TERM-2 =
  7275                CP-REMAINING-TERM-2 - +1
  7276     END-IF
  7277
  7278     IF CP-REMAINING-TERM-1 NEGATIVE
  7279        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7280     END-IF
  7281     IF CP-REMAINING-TERM-2 NEGATIVE
  7282        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7283     END-IF
  7284     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7285
  7286     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7287         GO TO 0640-AH-BENEFIT.
  7288*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7289*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7290
  7291     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7292         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7293             MOVE ER-0681        TO  EMI-ERROR
  7294             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7295
  7296     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7297         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7298             MOVE ER-0682        TO  EMI-ERROR
  7299             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7300
  7301 0630-CONTINUE-LIFE.
  7302
  7303     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7304        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7305        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7306                                    FREMTRMO
  7307     ELSE
  7308        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7309                                     FREMTRMO
  7310     END-IF
  7311     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 134
* EL1278.cbl
  7312     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7313     if pi-company-id = 'AHL'
  7314        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7315        if cp-class-code = spaces
  7316           move zeros            to cp-class-code
  7317        end-if
  7318     ELSE
  7319        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7320     END-IF
  7321     IF (PI-COMPANY-ID = 'DCC')
  7322        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7323        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7324        PERFORM 0730-GET-DDF-FACTORS
  7325                                 THRU 0730-EXIT
  7326        IF PDEF-FOUND
  7327           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7328              (P1 > +8)
  7329              OR (PD-PROD-CODE (P1) = 'L')
  7330           END-PERFORM
  7331           IF P1 < +9
  7332              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7333           END-IF
  7334        END-IF
  7335     END-IF
  7336     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7337
  7338     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7339
  7340     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7341        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7342                             + CM-LF-ALT-PREMIUM-AMT
  7343     ELSE
  7344        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7345     END-IF
  7346
  7347     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7348                                     WS-TOT-LF-PREM.
  7349
  7350     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7351        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7352        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7353     ELSE
  7354        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7355     END-IF
  7356
  7357     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7358     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7359
  7360     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7361         MOVE WS-LF-ST-REFUND-CALC
  7362                                 TO  CP-EARNING-METHOD.
  7363
  7364     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7365         MOVE WS-LF-FO-REFUND-CALC
  7366                                 TO  CP-EARNING-METHOD.
  7367
  7368     if (pi-company-id = 'CID')
  7369        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 135
* EL1278.cbl
  7370        continue
  7371     else
  7372        IF CP-RATING-METHOD = '4'
  7373           MOVE '4'              TO CP-EARNING-METHOD
  7374        END-IF
  7375     end-if
  7376*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7377*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7378*            MOVE WS-AM-EARN-METHOD-R
  7379*                                TO  CP-EARNING-METHOD
  7380*        END-IF
  7381*    ELSE
  7382*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7383*            MOVE WS-AM-EARN-METHOD-L
  7384*                                TO  CP-EARNING-METHOD.
  7385
  7386     if pi-company-id = 'AHL'
  7387        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7388        if cp-class-code = spaces
  7389           move zeros            to cp-class-code
  7390        end-if
  7391     ELSE
  7392        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7393     END-IF
  7394     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7395     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7396                                     CP-RATING-BENEFIT-AMT.
  7397     IF CP-STATE-STD-ABBRV = 'OR'
  7398         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7399                                         CM-LF-ALT-BENEFIT-AMT.
  7400****   N O T E   ****
  7401*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7402*      THE OH HARD CODING IN ELCRFNDP
  7403
  7404     IF PI-COMPANY-ID = 'CID'
  7405        IF CP-STATE-STD-ABBRV = 'OH'
  7406           MOVE WS-LF-CO-EARNINGS-CALC
  7407                                 TO CP-EARNING-METHOD
  7408        END-IF
  7409     END-IF
  7410
  7411****   N O T E   ****
  7412
  7413****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7414****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7415****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7416****     THE APPROPRIATE OPTIONS HERE
  7417*    IF PI-COMPANY-ID = 'CID'
  7418*       IF (CP-STATE-STD-ABBRV = 'MN')
  7419*          AND (CM-CERT-EFF-DT > X'A4FF')
  7420*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7421*          MOVE '5'              TO CP-EARNING-METHOD
  7422*       END-IF
  7423*    END-IF
  7424     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7425     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7426     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7427     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 136
* EL1278.cbl
  7428     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7429     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7430
  7431*    IF CP-EARN-AS-NET-PAY
  7432*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7433*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7434*               MOVE WS-CF-DEFAULT-APR
  7435*                                TO  CP-LOAN-APR
  7436*               MOVE ER-3780     TO  EMI-ERROR
  7437*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7438*           ELSE
  7439*               MOVE ER-3781     TO  EMI-ERROR
  7440*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7441
  7442*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7443*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7444*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7445*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7446*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7447*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7448*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7449*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7450*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7451*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7452*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7453*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7454*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7455*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7456*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7457*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7458*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7459*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7460     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7461
  7462     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7463
  7464     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7465
  7466     IF CP-ERROR-RATE-IS-ZERO
  7467       OR CP-ERROR-RATE-NOT-FOUND
  7468         MOVE ER-2740            TO  EMI-ERROR
  7469         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7470
  7471     IF CP-ERROR-RATE-FILE-NOTOPEN
  7472         MOVE ER-2617            TO  EMI-ERROR
  7473         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7474
  7475     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7476     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7477                                     WS-TOT-LF-RFND
  7478                                     PI-LF-REFUND-AMT.
  7479     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7480
  7481     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7482
  7483     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7484         GO TO 0640-AH-BENEFIT.
  7485
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 137
* EL1278.cbl
  7486*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7487*        ADD +1                  TO  CP-REMAINING-TERM
  7488*                                    CP-ORIGINAL-TERM.
  7489
  7490     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7491     MOVE '2'                    TO  CP-EARNING-METHOD
  7492                                     CP-RATING-METHOD.
  7493     IF PI-COMPANY-ID = 'CID'
  7494        IF (CP-STATE-STD-ABBRV = 'MN')
  7495           AND (CM-CERT-EFF-DT > X'A4FF')
  7496           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7497           MOVE '5'              TO CP-EARNING-METHOD
  7498           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7499        END-IF
  7500     END-IF
  7501     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7502                                     CP-REMAINING-BENEFIT
  7503                                     CP-RATING-BENEFIT-AMT.
  7504     IF CP-STATE-STD-ABBRV = 'OR'
  7505         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7506                                         CM-LF-ALT-BENEFIT-AMT.
  7507     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7508     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7509
  7510     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7511
  7512     IF CP-ERROR-RATE-IS-ZERO
  7513       OR CP-ERROR-RATE-NOT-FOUND
  7514         MOVE ER-2740            TO  EMI-ERROR
  7515         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7516
  7517     IF CP-ERROR-RATE-FILE-NOTOPEN
  7518         MOVE ER-2617            TO  EMI-ERROR
  7519         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7520
  7521     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7522
  7523     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7524                                     WS-TOT-LF-RFND
  7525                                     PI-LF-REFUND-AMT.
  7526
  7527     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7528
  7529 0640-AH-BENEFIT.
  7530     IF CM-AH-BENEFIT-CD = '00'
  7531         GO TO 0680-CONTINUE.
  7532
  7533 0650-GET-AH-BENEFIT.
  7534     IF ACCT-FOUND
  7535         MOVE +1                 TO SUB3
  7536         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7537     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7538     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7539     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7540     MOVE WS-AH-KIND             TO  HAEDESCO.
  7541     EVALUATE TRUE
  7542        WHEN ((OPEN-LF-CLAIM)
  7543           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 138
* EL1278.cbl
  7544           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7545           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7546                                    WS-TOT-AH-RFND
  7547                                    PI-AH-REFUND-AMT
  7548           MOVE SPACES           TO PI-AH-REFUND-METH
  7549           MOVE ER-2965          TO EMI-ERROR
  7550           PERFORM 9700-ERROR-FORMAT
  7551                                 THRU  9799-EXIT
  7552           GO TO 0680-CONTINUE
  7553        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7554           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7555           AND (EMI-ERROR = ER-2965)
  7556           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7557           MOVE ZEROS            TO HAREFNDO
  7558                                    WS-TOT-AH-RFND
  7559                                    PI-AH-REFUND-AMT
  7560           MOVE SPACES           TO PI-AH-REFUND-METH
  7561           GO TO 0680-CONTINUE
  7562        WHEN (OPEN-AH-CLAIM)
  7563           AND (WS-ST-REF-IND = '1')
  7564           MOVE ZEROS            TO HAREFNDO
  7565                                    WS-TOT-AH-RFND
  7566                                    PI-AH-REFUND-AMT
  7567           MOVE ER-3039          TO EMI-ERROR
  7568           PERFORM 9700-ERROR-FORMAT
  7569                                 THRU  9799-EXIT
  7570           GO TO 0680-CONTINUE
  7571        WHEN (OPEN-AH-CLAIM)
  7572           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7573           MOVE ER-3037          TO EMI-ERROR
  7574           PERFORM 9700-ERROR-FORMAT
  7575                                 THRU  9799-EXIT
  7576*          CONTINUE
  7577        WHEN (OPEN-AH-CLAIM)
  7578           AND (WS-ST-REF-IND = '5')
  7579           MOVE ER-3038          TO EMI-ERROR
  7580           PERFORM 9700-ERROR-FORMAT
  7581                                 THRU  9799-EXIT
  7582*          CONTINUE
  7583        WHEN (OPEN-AH-CLAIM)
  7584           AND (WS-ST-REF-IND = ' ')
  7585           MOVE ER-2768          TO EMI-ERROR
  7586           PERFORM 9700-ERROR-FORMAT
  7587                                 THRU  9799-EXIT
  7588        WHEN (CLOSED-AH-CLAIM)
  7589           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7590           MOVE ZEROS            TO HAREFNDO
  7591                                    WS-TOT-AH-RFND
  7592                                    PI-AH-REFUND-AMT
  7593           MOVE ER-2756          TO EMI-ERROR
  7594           PERFORM 9700-ERROR-FORMAT
  7595                                 THRU  9799-EXIT
  7596           IF WS-TOT-LF-RFND > 0
  7597              MOVE ZEROS         TO HLREFNDO
  7598                                    WS-TOT-LF-RFND
  7599                                    PI-LF-REFUND-AMT
  7600              MOVE SPACES        TO PI-LF-REFUND-METH
  7601           END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 139
* EL1278.cbl
  7602           GO TO 0680-CONTINUE
  7603*       WHEN OTHER
  7604*          CONTINUE
  7605     END-EVALUATE
  7606     .
  7607 0660-GET-REM-TERM.
  7608     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7609     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7610     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7611     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7612     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7613*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7614     MOVE WS-AH-KIND             TO  HAEDESCO.
  7615     MOVE CM-STATE               TO  CP-STATE.
  7616     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7617     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7618     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7619     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7620     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7621     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7622     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7623     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7624     MOVE WS-CF-CR-REM-TERM-CALC
  7625                                 TO  CP-REM-TERM-METHOD.
  7626
  7627     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7628         MOVE WS-AH-CO-REM-TERM-CALC
  7629                                 TO  CP-REM-TERM-METHOD.
  7630
  7631     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7632         MOVE WS-AH-ST-REM-TERM-CALC
  7633                                 TO  CP-REM-TERM-METHOD.
  7634
  7635     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7636         MOVE WS-AH-AM-REM-TERM-CALC
  7637                                 TO  CP-REM-TERM-METHOD.
  7638     IF (PI-COMPANY-ID = 'CID')
  7639        AND (CP-STATE-STD-ABBRV = 'WI')
  7640        MOVE '7'                 TO CP-REM-TERM-METHOD
  7641        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7642     END-IF
  7643     IF (PI-COMPANY-ID = 'CID')
  7644        AND (CP-STATE-STD-ABBRV = 'MO')
  7645        AND (CM-CERT-EFF-DT >= X'9B41')
  7646        AND (CM-CERT-EFF-DT <= X'A2FB')
  7647        MOVE '7'                 TO CP-REM-TERM-METHOD
  7648        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7649     END-IF
  7650
  7651     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7652                                     CP-ORIGINAL-TERM
  7653                                     CP-LOAN-TERM.
  7654
  7655     IF  NOT  CP-TERM-IS-DAYS
  7656         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7657             MOVE CM-PMT-EXTENSION-DAYS
  7658                                 TO  CP-TERM-OR-EXT-DAYS
  7659         ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 140
* EL1278.cbl
  7660             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7661
  7662*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7663     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7664     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7665     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7666     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7667
  7668
  7669* EXEC CICS READ
  7670*        DATASET  (ELCNTL-ID)
  7671*        SET      (ADDRESS OF CONTROL-FILE)
  7672*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7673*        RESP     (WS-RESPONSE)
  7674*    END-EXEC.
  7675*    MOVE '&"S        E          (  N#00007509' TO DFHEIV0
  7676     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7677     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7678     MOVE X'204E233030303037353039' TO DFHEIV0(25:11)
  7679     CALL 'kxdfhei1' USING DFHEIV0,
  7680           ELCNTL-ID,
  7681           DFHEIV20,
  7682           DFHEIV99,
  7683           WS-CF-CONTROL-PRIMARY,
  7684           DFHEIV99,
  7685           DFHEIV99,
  7686           DFHEIV99
  7687     SET ADDRESS OF CONTROL-FILE TO
  7688         DFHEIV20
  7689     MOVE EIBRESP  TO WS-RESPONSE
  7690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7691
  7692
  7693     IF WS-RESP-NOTOPEN
  7694         MOVE ER-2617            TO  EMI-ERROR
  7695         GO TO 0320-INPUT-ERROR.
  7696
  7697     IF WS-RESP-NOTFND
  7698         MOVE ZERO               TO CP-FREE-LOOK
  7699     ELSE
  7700         MOVE CF-ST-FREE-LOOK-PERIOD
  7701                                 TO CP-FREE-LOOK.
  7702
  7703     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7704
  7705     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7706
  7707     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7708         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7709             MOVE ER-0683        TO  EMI-ERROR
  7710             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7711
  7712     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7713         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7714             MOVE ER-0684        TO  EMI-ERROR
  7715             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7716
  7717 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 141
* EL1278.cbl
  7718     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7719                                     WS-TOT-AH-PREM
  7720     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7721
  7722     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7723         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7724
  7725     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7726        GO TO 0680-CONTINUE.
  7727     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7728     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7729     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7730
  7731     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7732         MOVE WS-AH-ST-REFUND-CALC
  7733                                 TO  CP-EARNING-METHOD.
  7734
  7735     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7736         MOVE WS-AH-FO-REFUND-CALC
  7737                                 TO  CP-EARNING-METHOD.
  7738
  7739*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7740*        MOVE WS-AM-EARN-METHOD-A
  7741*                                TO  CP-EARNING-METHOD.
  7742
  7743     if pi-company-id = 'AHL'
  7744        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7745        if cp-class-code = spaces
  7746           move zeros            to cp-class-code
  7747        end-if
  7748     ELSE
  7749        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7750     END-IF
  7751     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7752     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7753                                     CP-RATING-BENEFIT-AMT.
  7754     IF CP-STATE-STD-ABBRV = 'OR'
  7755         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7756                                         CM-AH-ORIG-TERM.
  7757     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7758     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7759     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7760     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7761     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7762     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7763
  7764     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7765     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7766     MOVE ' '                    TO  DC-OPTION-CODE.
  7767
  7768     PERFORM 9600-DATE-LINK.
  7769
  7770     IF CP-STATE-STD-ABBRV = 'OH'
  7771        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7772         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7773           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7774           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7775             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 142
* EL1278.cbl
  7776         END-IF
  7777        END-IF
  7778        IF PI-COMPANY-ID = 'CID'
  7779           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7780                           LOW-VALUES)
  7781              IF CP-CRITICAL-PERIOD
  7782                 MOVE '2'       TO CP-EARNING-METHOD
  7783              ELSE
  7784                 MOVE '6'       TO CP-EARNING-METHOD
  7785              END-IF
  7786           ELSE
  7787              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7788                 MOVE '2'       TO CP-EARNING-METHOD
  7789              ELSE
  7790                 IF ((CM-LF-ORIG-TERM > 60) AND
  7791                    (CM-RATE-CLASS NOT = 'L '))
  7792                               OR
  7793                    (WS-LF-CO-EARNINGS-CALC = '5')
  7794                    IF CP-CRITICAL-PERIOD
  7795                       MOVE '2'  TO CP-EARNING-METHOD
  7796                    ELSE
  7797                       MOVE '6'  TO CP-EARNING-METHOD
  7798                    END-IF
  7799                 ELSE
  7800                    MOVE '1'     TO CP-EARNING-METHOD
  7801                 END-IF
  7802              END-IF
  7803           END-IF
  7804        END-IF
  7805     END-IF
  7806
  7807     IF CP-STATE-STD-ABBRV = 'VA'
  7808       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7809         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7810            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7811                MOVE '6'            TO  CP-EARNING-METHOD
  7812            ELSE
  7813                MOVE '1'            TO  CP-EARNING-METHOD.
  7814
  7815     IF CP-EARN-AS-NET-PAY
  7816         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7817            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7818                MOVE WS-CF-DEFAULT-APR
  7819                                 TO  CP-LOAN-APR
  7820                MOVE ER-3780     TO  EMI-ERROR
  7821                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7822            ELSE
  7823                MOVE ER-3781     TO  EMI-ERROR
  7824                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7825     IF PI-COMPANY-ID = 'DCC'
  7826        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7827           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7828           MOVE 'S'              TO CP-EARNING-METHOD
  7829        END-IF
  7830     END-IF
  7831     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7832     IF (PI-COMPANY-ID = 'DCC')
  7833        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 143
* EL1278.cbl
  7834        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7835                                    WS-DDF-CSO-ADMIN-FEE
  7836                                    WS-DDF-1ST-YR-TOT-EXP
  7837                                    WS-DDF-COMM-AND-MFEE
  7838        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7839           S1 > +10
  7840           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7841              IF (AM-A-COM (S1) NUMERIC)
  7842                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7843                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7844              ELSE
  7845                 MOVE +0         TO WS-COMM-PCT C0
  7846                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7847                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7848              END-IF
  7849              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7850                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7851                    + WS-COMM-PCT
  7852              END-IF
  7853              IF AM-COM-TYP (S1) = 'N'
  7854                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7855                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7856              END-IF
  7857              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7858                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7859                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7860              END-IF
  7861              IF AM-COM-TYP (S1) = 'I'
  7862                 COMPUTE WS-DDF-COMM-AND-MFEE
  7863                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7864              END-IF
  7865           END-IF
  7866        END-PERFORM
  7867        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7868        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7869        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7870           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7871     END-IF
  7872     IF (PI-COMPANY-ID = 'DCC')
  7873        AND (CP-EARNING-METHOD = 'D')
  7874        AND (PI-CANCEL-REASON NOT = 'R')
  7875        PERFORM 0730-GET-DDF-FACTORS
  7876                                 THRU 0730-EXIT
  7877        IF NOT PDEF-FOUND
  7878           MOVE ER-9999          TO EMI-ERROR
  7879           PERFORM 9700-ERROR-FORMAT
  7880                                 THRU 9799-EXIT
  7881           GO TO 8200-SEND-DATAONLY
  7882        END-IF
  7883        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7884                                 TO CP-DDF-LO-FACT
  7885        MOVE PD-UEP-FACTOR (P1 P2)
  7886                                 TO CP-DDF-HI-FACT
  7887        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7888        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7889        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7890        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7891           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 144
* EL1278.cbl
  7892        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7893        IF PI-CLP-YN = 'Y'
  7894           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7895           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7896                                    CP-DDF-CLP
  7897           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7898        END-IF
  7899        IF DD-IU-PRESENT
  7900           MOVE 'I'              TO CP-EARNING-METHOD
  7901        END-IF
  7902        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7903                                    CP-CLP-RATE-UP
  7904        IF (CP-CALC-GROSS-FEE)
  7905           AND (CP-IU-RATE-UP NOT = ZEROS)
  7906           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7907              / CP-ORIGINAL-PREMIUM)
  7908           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7909              / (1 - TEX-FACT-8)
  7910        END-IF
  7911     END-IF
  7912     if pi-company-id = 'VPP'
  7913        IF PI-CLP-YN = 'Y'
  7914           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7915                                    hapremo
  7916                                    CP-DDF-CLP
  7917        END-IF
  7918     end-if
  7919     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7920
  7921     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7922
  7923     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7924
  7925     IF CP-ERROR-RATE-IS-ZERO
  7926       OR CP-ERROR-RATE-NOT-FOUND
  7927         MOVE ER-2740            TO  EMI-ERROR
  7928         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7929
  7930     IF CP-ERROR-RATE-FILE-NOTOPEN
  7931         MOVE ER-2617            TO  EMI-ERROR
  7932         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7933
  7934     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7935     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7936                                     WS-TOT-AH-RFND
  7937                                     PI-AH-REFUND-AMT.
  7938     if pi-company-id = 'VPP'
  7939        if cp-calc-refund < cm-cancel-fee
  7940           move cp-calc-refund   to cm-cancel-fee
  7941        end-if
  7942        if cp-calc-refund = cm-ah-premium-amt
  7943           move zeros            to cm-cancel-fee
  7944        end-if
  7945        move cm-cancel-fee       to canfeeo
  7946        compute refdueo =
  7947           cp-calc-refund - cm-cancel-fee
  7948     end-if
  7949
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 145
* EL1278.cbl
  7950     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7951
  7952     MOVE AL-UANON               TO  HACANCA.
  7953
  7954 0680-CONTINUE.
  7955     IF BROWSE-STARTED
  7956         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7957         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7958
  7959     IF CM-LF-BENEFIT-CD = '00'
  7960         MOVE -1                 TO  HACANCL
  7961     ELSE
  7962         MOVE -1                 TO  HLCANCL.
  7963
  7964     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7965                           WS-TOT-PREM.
  7966     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7967                           WS-TOT-RFND.
  7968
  7969     MOVE WS-TOT-PREM            TO  TOPREMO.
  7970     MOVE WS-TOT-RFND            TO  TORFNDO.
  7971
  7972 0680-EXIT.
  7973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 146
* EL1278.cbl
  7975 0700-LINK-REM-TERM SECTION.
  7976
  7977* EXEC CICS LINK
  7978*        PROGRAM   (ELRTRM-ID)
  7979*        COMMAREA  (CALCULATION-PASS-AREA)
  7980*        LENGTH    (CP-COMM-LENGTH)
  7981*    END-EXEC.
  7982*    MOVE '."C                   (   #00007799' TO DFHEIV0
  7983     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7985     MOVE X'2020233030303037373939' TO DFHEIV0(25:11)
  7986     CALL 'kxdfhei1' USING DFHEIV0,
  7987           ELRTRM-ID,
  7988           CALCULATION-PASS-AREA,
  7989           CP-COMM-LENGTH,
  7990           DFHEIV99,
  7991           DFHEIV99,
  7992           DFHEIV99,
  7993           DFHEIV99
  7994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7995
  7996
  7997 0700-EXIT.
  7998     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 147
* EL1278.cbl
  8000 0710-LINK-REM-AMOUNT SECTION.
  8001
  8002* EXEC CICS LINK
  8003*        PROGRAM   (ELRAMT-ID)
  8004*        COMMAREA  (CALCULATION-PASS-AREA)
  8005*        LENGTH    (CP-COMM-LENGTH)
  8006*    END-EXEC.
  8007*    MOVE '."C                   (   #00007809' TO DFHEIV0
  8008     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8010     MOVE X'2020233030303037383039' TO DFHEIV0(25:11)
  8011     CALL 'kxdfhei1' USING DFHEIV0,
  8012           ELRAMT-ID,
  8013           CALCULATION-PASS-AREA,
  8014           CP-COMM-LENGTH,
  8015           DFHEIV99,
  8016           DFHEIV99,
  8017           DFHEIV99,
  8018           DFHEIV99
  8019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8020
  8021
  8022 0710-EXIT.
  8023     EXIT.
  8024 0730-GET-DDF-FACTORS.
  8025     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8026     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8027     MOVE CM-STATE               TO ERPDEF-STATE
  8028     if cm-clp-state <> cm-state and spaces
  8029                  and low-values and zeros
  8030        move cm-clp-state        to erpdef-state
  8031     end-if
  8032     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8033     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8034     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8035     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8036     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8037
  8038* EXEC CICS STARTBR
  8039*        DATASET  ('ERPDEF')
  8040*        RIDFLD   (ERPDEF-KEY)
  8041*        GTEQ
  8042*        RESP     (WS-RESPONSE)
  8043*    END-EXEC
  8044     MOVE 'ERPDEF' TO DFHEIV1
  8045     MOVE 0
  8046       TO DFHEIV11
  8047*    MOVE '&,         G          &  N#00007830' TO DFHEIV0
  8048     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8049     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8050     MOVE X'204E233030303037383330' TO DFHEIV0(25:11)
  8051     CALL 'kxdfhei1' USING DFHEIV0,
  8052           DFHEIV1,
  8053           ERPDEF-KEY,
  8054           DFHEIV99,
  8055           DFHEIV11,
  8056           DFHEIV99
  8057     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 148
* EL1278.cbl
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8059     IF NOT WS-RESP-NORMAL
  8060        GO TO 0730-EXIT
  8061     END-IF
  8062     .
  8063 0730-READNEXT.
  8064
  8065* EXEC CICS READNEXT
  8066*       DATASET  ('ERPDEF')
  8067*       SET      (ADDRESS OF PRODUCT-MASTER)
  8068*       RIDFLD   (ERPDEF-KEY)
  8069*       RESP     (WS-RESPONSE)
  8070*    END-EXEC
  8071     MOVE 'ERPDEF' TO DFHEIV1
  8072     MOVE 0
  8073       TO DFHEIV11
  8074*    MOVE '&.S                   )  N#00007841' TO DFHEIV0
  8075     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8076     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8077     MOVE X'204E233030303037383431' TO DFHEIV0(25:11)
  8078     CALL 'kxdfhei1' USING DFHEIV0,
  8079           DFHEIV1,
  8080           DFHEIV20,
  8081           DFHEIV99,
  8082           ERPDEF-KEY,
  8083           DFHEIV99,
  8084           DFHEIV11,
  8085           DFHEIV99,
  8086           DFHEIV99
  8087     SET ADDRESS OF PRODUCT-MASTER TO
  8088         DFHEIV20
  8089     MOVE EIBRESP  TO WS-RESPONSE
  8090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8091     IF NOT WS-RESP-NORMAL
  8092        GO TO 0730-ENDBR
  8093     END-IF
  8094     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8095        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8096           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8097        ELSE
  8098           GO TO 0730-READNEXT
  8099        END-IF
  8100     ELSE
  8101        GO TO 0730-ENDBR
  8102     END-IF
  8103     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8104        (P1 > +8)
  8105        OR (PD-PROD-CODE (P1) = 'I')
  8106     END-PERFORM
  8107     IF P1 < +9
  8108        SET DD-IU-PRESENT        TO TRUE
  8109     END-IF
  8110     IF CM-LOAN-TERM = ZEROS
  8111        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  8112     END-IF
  8113     IF PD-TRUNCATED = 'Y'
  8114        MOVE CM-LOAN-TERM        TO WS-TERM
  8115     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 149
* EL1278.cbl
  8116        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  8117     END-IF
  8118     EVALUATE TRUE
  8119        WHEN WS-TERM > +168
  8120           MOVE 15               TO P1
  8121        WHEN WS-TERM > +156
  8122           MOVE 14               TO P1
  8123        WHEN WS-TERM > +144
  8124           MOVE 13               TO P1
  8125        WHEN WS-TERM > +132
  8126           MOVE 12               TO P1
  8127        WHEN WS-TERM > +120
  8128           MOVE 11               TO P1
  8129        WHEN WS-TERM > +108
  8130           MOVE 10               TO P1
  8131        WHEN WS-TERM > +96
  8132           MOVE 9                TO P1
  8133        WHEN WS-TERM > +84
  8134           MOVE 8                TO P1
  8135        WHEN WS-TERM > +72
  8136           MOVE 7                TO P1
  8137        WHEN WS-TERM > +60
  8138           MOVE 6                TO P1
  8139        WHEN WS-TERM > +48
  8140           MOVE 5                TO P1
  8141        WHEN WS-TERM > +36
  8142           MOVE 4                TO P1
  8143        WHEN WS-TERM > +24
  8144           MOVE 3                TO P1
  8145        WHEN WS-TERM > +12
  8146           MOVE 2                TO P1
  8147        WHEN OTHER
  8148           MOVE 1                TO P1
  8149     END-EVALUATE
  8150     EVALUATE TRUE
  8151*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  8152*          AND (DD-IU-PRESENT)
  8153*          MOVE 2                TO P2
  8154*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  8155*          MOVE 1                TO P2
  8156        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  8157           MOVE 2                TO P2
  8158        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  8159           MOVE 3                TO P2
  8160        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  8161           MOVE 4                TO P2
  8162        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  8163           MOVE 5                TO P2
  8164        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  8165           MOVE 6                TO P2
  8166        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  8167           MOVE 7                TO P2
  8168        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  8169           MOVE 8                TO P2
  8170        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  8171           MOVE 9                TO P2
  8172        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  8173           MOVE 10               TO P2
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 150
* EL1278.cbl
  8174        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  8175           MOVE 11               TO P2
  8176        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  8177           MOVE 12               TO P2
  8178        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  8179           MOVE 13               TO P2
  8180        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  8181           MOVE 14               TO P2
  8182        WHEN OTHER
  8183           MOVE 15               TO P2
  8184     END-EVALUATE
  8185     .
  8186 0730-ENDBR.
  8187
  8188* EXEC CICS ENDBR
  8189*       DATASET  ('ERPDEF')
  8190*    END-EXEC
  8191     MOVE 'ERPDEF' TO DFHEIV1
  8192     MOVE 0
  8193       TO DFHEIV11
  8194*    MOVE '&2                    $   #00007943' TO DFHEIV0
  8195     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8196     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8197     MOVE X'2020233030303037393433' TO DFHEIV0(25:11)
  8198     CALL 'kxdfhei1' USING DFHEIV0,
  8199           DFHEIV1,
  8200           DFHEIV11,
  8201           DFHEIV99
  8202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8203     .
  8204 0730-EXIT.
  8205     EXIT.
  8206 0740-GET-ERCTBL.
  8207     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8208     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8209     MOVE 'A'                    TO CTBL-BEN-TYPE
  8210     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8211     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8212     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8213     IF WS-RESP-NORMAL
  8214        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8215     ELSE
  8216        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8217        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8218        MOVE 'A'                    TO CTBL-BEN-TYPE
  8219        MOVE 'AA'                   TO CTBL-BEN-CODE
  8220        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8221        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8222        IF WS-RESP-NORMAL
  8223           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8224        END-IF
  8225     END-IF
  8226     .
  8227 0740-EXIT.
  8228     EXIT.
  8229 0750-READ-ERCTBL.
  8230
  8231* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 151
* EL1278.cbl
  8232*         INTO    (COMM-TABLE-RECORD)
  8233*         DATASET ('ERCTBL')
  8234*         RIDFLD  (CTBL-KEY)
  8235*         RESP    (WS-RESPONSE)
  8236*    END-EXEC
  8237     MOVE LENGTH OF
  8238      COMM-TABLE-RECORD
  8239       TO DFHEIV11
  8240     MOVE 'ERCTBL' TO DFHEIV1
  8241*    MOVE '&"IL       E          (  N#00007973' TO DFHEIV0
  8242     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8244     MOVE X'204E233030303037393733' TO DFHEIV0(25:11)
  8245     CALL 'kxdfhei1' USING DFHEIV0,
  8246           DFHEIV1,
  8247           COMM-TABLE-RECORD,
  8248           DFHEIV11,
  8249           CTBL-KEY,
  8250           DFHEIV99,
  8251           DFHEIV99,
  8252           DFHEIV99
  8253     MOVE EIBRESP  TO WS-RESPONSE
  8254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8255     .
  8256 0750-EXIT.
  8257     EXIT.
  8258 0760-FIND-COMM.
  8259     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8260        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8261        OR (C1 > +3)
  8262     END-PERFORM
  8263     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8264        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8265        OR (C2 > +3)
  8266     END-PERFORM
  8267     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8268        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8269        OR (C3 > +3)
  8270     END-PERFORM
  8271     IF C1 > +3
  8272        MOVE +1                  TO C1
  8273     END-IF
  8274     IF C2 > +3
  8275        MOVE +1                  TO C2
  8276     END-IF
  8277     IF C3 > +3
  8278        MOVE +1                  TO C3
  8279     END-IF
  8280     IF C1 = +3
  8281        MOVE +18                 TO C0
  8282     ELSE
  8283        IF C1 = +2
  8284           MOVE +9               TO C0
  8285        END-IF
  8286     END-IF
  8287     IF C2 = +3
  8288        ADD +6                   TO C0
  8289     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 152
* EL1278.cbl
  8290        IF C2 = +2
  8291           ADD +3                TO C0
  8292        END-IF
  8293     END-IF
  8294     ADD C3                      TO C0
  8295     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8296     .
  8297 0760-EXIT.
  8298     EXIT.
  8299 0800-LINK-REFUND SECTION.
  8300     IF CP-AH
  8301       IF PI-EARNING-METHOD-AH NOT = SPACES
  8302         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8303        ELSE
  8304         NEXT SENTENCE
  8305      ELSE
  8306       IF PI-EARNING-METHOD-LF NOT = SPACES
  8307         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8308
  8309
  8310* EXEC CICS LINK
  8311*        PROGRAM   (ELRFND-ID)
  8312*        COMMAREA  (CALCULATION-PASS-AREA)
  8313*        LENGTH    (CP-COMM-LENGTH)
  8314*    END-EXEC.
  8315*    MOVE '."C                   (   #00008033' TO DFHEIV0
  8316     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8318     MOVE X'2020233030303038303333' TO DFHEIV0(25:11)
  8319     CALL 'kxdfhei1' USING DFHEIV0,
  8320           ELRFND-ID,
  8321           CALCULATION-PASS-AREA,
  8322           CP-COMM-LENGTH,
  8323           DFHEIV99,
  8324           DFHEIV99,
  8325           DFHEIV99,
  8326           DFHEIV99
  8327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8328
  8329
  8330 0899-EXIT.
  8331     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 153
* EL1278.cbl
  8333 0900-READ-CERT-FILE  SECTION.
  8334
  8335* EXEC CICS HANDLE CONDITION
  8336*        NOTFND  (0910-NOT-FOUND)
  8337*    END-EXEC.
  8338*    MOVE '"$I                   ! # #00008043' TO DFHEIV0
  8339     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8340     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8341     MOVE X'2320233030303038303433' TO DFHEIV0(25:11)
  8342     CALL 'kxdfhei1' USING DFHEIV0
  8343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8344
  8345
  8346
  8347* EXEC CICS READ
  8348*        DATASET  (ELCERT-ID)
  8349*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8350*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8351*    END-EXEC.
  8352*    MOVE '&"S        E          (   #00008047' TO DFHEIV0
  8353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8355     MOVE X'2020233030303038303437' TO DFHEIV0(25:11)
  8356     CALL 'kxdfhei1' USING DFHEIV0,
  8357           ELCERT-ID,
  8358           DFHEIV20,
  8359           DFHEIV99,
  8360           WS-CM-CONTROL-PRIMARY,
  8361           DFHEIV99,
  8362           DFHEIV99,
  8363           DFHEIV99
  8364     SET ADDRESS OF CERTIFICATE-MASTER TO
  8365         DFHEIV20
  8366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8367
  8368
  8369*    SERVICE RELOAD CERTIFICATE-MASTER.
  8370
  8371     GO TO 0999-EXIT.
  8372
  8373 0910-NOT-FOUND.
  8374     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8375
  8376 0999-EXIT.
  8377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 154
* EL1278.cbl
  8379 1000-READ-CONTROL  SECTION.
  8380
  8381* EXEC CICS HANDLE CONDITION
  8382*        NOTFND   (1010-NOTFND)
  8383*        NOTOPEN  (1020-NOTOPEN)
  8384*    END-EXEC.
  8385*    MOVE '"$IJ                  ! $ #00008064' TO DFHEIV0
  8386     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8388     MOVE X'2420233030303038303634' TO DFHEIV0(25:11)
  8389     CALL 'kxdfhei1' USING DFHEIV0
  8390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8391
  8392
  8393
  8394* EXEC CICS READ
  8395*        DATASET  (ELCNTL-ID)
  8396*        SET      (ADDRESS OF CONTROL-FILE)
  8397*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8398*        GTEQ
  8399*    END-EXEC.
  8400*    MOVE '&"S        G          (   #00008069' TO DFHEIV0
  8401     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8403     MOVE X'2020233030303038303639' TO DFHEIV0(25:11)
  8404     CALL 'kxdfhei1' USING DFHEIV0,
  8405           ELCNTL-ID,
  8406           DFHEIV20,
  8407           DFHEIV99,
  8408           WS-CF-CONTROL-PRIMARY,
  8409           DFHEIV99,
  8410           DFHEIV99,
  8411           DFHEIV99
  8412     SET ADDRESS OF CONTROL-FILE TO
  8413         DFHEIV20
  8414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8415
  8416
  8417*    SERVICE RELOAD CONTROL-FILE.
  8418
  8419     GO TO 1099-EXIT.
  8420
  8421 1010-NOTFND.
  8422     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8423
  8424     GO TO 1099-EXIT.
  8425
  8426 1020-NOTOPEN.
  8427     MOVE ER-2617                TO  EMI-ERROR.
  8428
  8429     GO TO 0320-INPUT-ERROR.
  8430
  8431 1099-EXIT.
  8432     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 155
* EL1278.cbl
  8434 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8435     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8436
  8437     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8438         VARYING  SUB3  FROM  1  BY  1
  8439             UNTIL  ((SUB3  IS GREATER THAN  50)
  8440               OR ((CF-ST-BENEFIT-CD (SUB3)
  8441                      IS EQUAL TO  WS-BEN-CD)
  8442               AND (WS-LOOKUP-TYPE
  8443                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8444
  8445     IF SUB3  IS NOT EQUAL TO  51
  8446         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8447
  8448     GO TO 1199-EXIT.
  8449
  8450 1110-BENEFIT-DUMMY.
  8451
  8452 1119-EXIT.
  8453     EXIT.
  8454
  8455 1199-EXIT.
  8456     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 156
* EL1278.cbl
  8458 1200-START-ACCOUNT-MASTER  SECTION.
  8459
  8460* EXEC CICS HANDLE CONDITION
  8461*        NOTFND   (1290-ACCT-NOT-FOUND)
  8462*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8463*    END-EXEC.
  8464*    MOVE '"$I''                  ! % #00008118' TO DFHEIV0
  8465     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8467     MOVE X'2520233030303038313138' TO DFHEIV0(25:11)
  8468     CALL 'kxdfhei1' USING DFHEIV0
  8469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8470
  8471
  8472     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8473
  8474
  8475* EXEC CICS STARTBR
  8476*        DATASET  (ERACCT-ID)
  8477*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8478*        GTEQ
  8479*    END-EXEC.
  8480     MOVE 0
  8481       TO DFHEIV11
  8482*    MOVE '&,         G          &   #00008125' TO DFHEIV0
  8483     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8484     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8485     MOVE X'2020233030303038313235' TO DFHEIV0(25:11)
  8486     CALL 'kxdfhei1' USING DFHEIV0,
  8487           ERACCT-ID,
  8488           WS-AM-CONTROL-PRIMARY,
  8489           DFHEIV99,
  8490           DFHEIV11,
  8491           DFHEIV99
  8492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8493
  8494
  8495     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8496     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8497
  8498     GO TO 1299-EXIT.
  8499
  8500 1290-ACCT-NOT-FOUND.
  8501     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8502
  8503 1299-EXIT.
  8504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 157
* EL1278.cbl
  8506 1300-READ-ACCOUNT-MASTER  SECTION.
  8507
  8508* EXEC CICS HANDLE CONDITION
  8509*        NOTFND   (0580-ACCT-NOT-FOUND)
  8510*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8511*    END-EXEC.
  8512*    MOVE '"$I''                  ! & #00008143' TO DFHEIV0
  8513     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8515     MOVE X'2620233030303038313433' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0
  8517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8518
  8519
  8520
  8521* EXEC CICS READNEXT
  8522*        DATASET  (ERACCT-ID)
  8523*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8524*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8525*    END-EXEC.
  8526     MOVE 0
  8527       TO DFHEIV11
  8528*    MOVE '&.S                   )   #00008148' TO DFHEIV0
  8529     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8530     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8531     MOVE X'2020233030303038313438' TO DFHEIV0(25:11)
  8532     CALL 'kxdfhei1' USING DFHEIV0,
  8533           ERACCT-ID,
  8534           DFHEIV20,
  8535           DFHEIV99,
  8536           WS-AM-CONTROL-PRIMARY,
  8537           DFHEIV99,
  8538           DFHEIV11,
  8539           DFHEIV99,
  8540           DFHEIV99
  8541     SET ADDRESS OF ACCOUNT-MASTER TO
  8542         DFHEIV20
  8543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8544
  8545
  8546*    SERVICE RELOAD ACCOUNT-MASTER.
  8547
  8548 1399-EXIT.
  8549     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 158
* EL1278.cbl
  8551 1400-GET-REFUND-TYPE  SECTION.
  8552     IF LIFE-REFUND-SEARCH
  8553         NEXT SENTENCE
  8554     ELSE
  8555         GO TO 1410-AH-REFUND-TYPE.
  8556
  8557     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8558         MOVE SPACES             TO  HLCALCO
  8559                                     HLCAL1O
  8560         GO TO 1499-EXIT.
  8561
  8562     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8563
  8564     EVALUATE TRUE
  8565        WHEN CP-R-AS-REPOSSESSION
  8566           MOVE 'REPOSSESSION'     TO  HLCALCO
  8567        WHEN CP-R-AS-R78
  8568           MOVE 'RULE 78'          TO  HLCALCO
  8569        WHEN  CP-R-AS-PRORATA
  8570           MOVE 'PRO RATA'         TO  HLCALCO
  8571        WHEN CP-R-AS-CALIF
  8572           MOVE 'CALIF'            TO  HLCALCO
  8573        WHEN CP-R-AS-TEXAS
  8574           MOVE 'IRREG'            TO  HLCALCO
  8575        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8576           MOVE 'UTAH'             TO  HLCALCO
  8577        WHEN CP-R-AS-FARM-PLAN
  8578           MOVE 'FARM PLAN'        TO  HLCALCO
  8579        WHEN CP-R-AS-NET-PAY
  8580           MOVE 'NET PAY'          TO  HLCALCO
  8581        WHEN CP-R-AS-ANTICIPATION
  8582           MOVE 'ANTICIPATION'     TO  HLCALCO
  8583        WHEN CP-R-AS-MEAN
  8584           MOVE 'MEAN'             TO  HLCALCO
  8585        WHEN CP-R-AS-SUM-OF-DIGITS
  8586           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8587        WHEN OTHER
  8588           MOVE 'UNDEFINED'        TO  HLCALCO
  8589     END-EVALUATE.
  8590
  8591     GO TO 1499-EXIT.
  8592
  8593 1410-AH-REFUND-TYPE.
  8594     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8595         MOVE SPACES             TO  HACALCO
  8596                                     HACAL1O
  8597         GO TO 1499-EXIT.
  8598
  8599     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8600
  8601     EVALUATE TRUE
  8602        WHEN CP-R-AS-REPOSSESSION
  8603           MOVE 'REPOSSESSION'     TO HACALCO
  8604        WHEN CP-R-AS-R78
  8605           MOVE 'RULE 78'          TO HACALCO
  8606        WHEN CP-R-AS-PRORATA
  8607           MOVE 'PRO RATA'         TO HACALCO
  8608        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 159
* EL1278.cbl
  8609           MOVE 'CALIF'            TO HACALCO
  8610        WHEN CP-R-AS-TEXAS
  8611           MOVE 'IRREG'            TO HACALCO
  8612        WHEN CP-R-AS-FARM-PLAN
  8613           MOVE 'FARM PLAN'        TO HACALCO
  8614        WHEN CP-R-AS-NET-PAY
  8615           MOVE 'NET PAY'          TO HACALCO
  8616        WHEN CP-R-AS-ANTICIPATION
  8617           MOVE 'ANTICIPATION'     TO HACALCO
  8618        WHEN CP-R-AS-MEAN
  8619           MOVE 'MEAN'             TO HACALCO
  8620        WHEN CP-R-AS-SUM-OF-DIGITS
  8621           MOVE 'SUM OF DIGIT'     TO HACALCO
  8622        WHEN CP-GAP-ACTUARIAL
  8623           MOVE 'SP ACTUARIAL'     TO HACALCO
  8624        WHEN CP-R-AS-SPP-DDF
  8625           MOVE 'SPEC DDF'         TO HACALCO
  8626        WHEN CP-R-AS-SPP-DDF-IU
  8627           MOVE 'SPEC DDF IU'      TO HACALCO
  8628        WHEN OTHER
  8629           MOVE 'UNKNOWN'          TO HLCALCO
  8630     END-EVALUATE
  8631     .
  8632 1499-EXIT.
  8633     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 160
* EL1278.cbl
  8635 1500-END-BROWSE  SECTION.
  8636     IF BROWSE-STARTED
  8637
  8638* EXEC CICS ENDBR
  8639*            DATASET  (ERACCT-ID)
  8640*        END-EXEC.
  8641     MOVE 0
  8642       TO DFHEIV11
  8643*    MOVE '&2                    $   #00008245' TO DFHEIV0
  8644     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8646     MOVE X'2020233030303038323435' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0,
  8648           ERACCT-ID,
  8649           DFHEIV11,
  8650           DFHEIV99
  8651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8652
  8653
  8654 1599-EXIT.
  8655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 161
* EL1278.cbl
  8657 1600-LOCATE-BENEFIT  SECTION.
  8658
  8659* EXEC CICS HANDLE CONDITION
  8660*        NOTFND  (1699-EXIT)
  8661*    END-EXEC.
  8662*    MOVE '"$I                   ! '' #00008253' TO DFHEIV0
  8663     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8665     MOVE X'2720233030303038323533' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670     MOVE SPACES                 TO  WS-KIND.
  8671     MOVE ZERO                   TO  WS-NOT-FOUND.
  8672     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8673     MOVE SPACES                 TO  WS-CF-STATE.
  8674     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8675
  8676
  8677* EXEC CICS READ
  8678*        DATASET  (ELCNTL-ID)
  8679*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8680*        SET      (ADDRESS OF CONTROL-FILE)
  8681*        GTEQ
  8682*    END-EXEC.
  8683*    MOVE '&"S        G          (   #00008263' TO DFHEIV0
  8684     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8685     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8686     MOVE X'2020233030303038323633' TO DFHEIV0(25:11)
  8687     CALL 'kxdfhei1' USING DFHEIV0,
  8688           ELCNTL-ID,
  8689           DFHEIV20,
  8690           DFHEIV99,
  8691           WS-CF-CONTROL-PRIMARY,
  8692           DFHEIV99,
  8693           DFHEIV99,
  8694           DFHEIV99
  8695     SET ADDRESS OF CONTROL-FILE TO
  8696         DFHEIV20
  8697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8698
  8699
  8700*    SERVICE RELOAD CONTROL-FILE.
  8701
  8702     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8703       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8704         GO TO 1699-EXIT.
  8705
  8706     MOVE +1                     TO  WS-INDEX.
  8707
  8708 1610-LOOKUP-BENEFIT.
  8709     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8710         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8711                                 TO  WS-KIND
  8712         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8713                                 TO  WS-CALC-CD
  8714         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 162
* EL1278.cbl
  8715                                 TO  WS-BENEFIT-DESCRIP
  8716         MOVE +1                 TO  WS-NOT-FOUND
  8717         GO TO 1699-EXIT.
  8718
  8719     IF CF-BENEFIT-CODE (WS-INDEX)
  8720             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8721         GO TO 1699-EXIT.
  8722
  8723     IF WS-INDEX  IS LESS THAN  +8
  8724         ADD +1                  TO  WS-INDEX
  8725         GO TO 1610-LOOKUP-BENEFIT.
  8726
  8727 1699-EXIT.
  8728     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 163
* EL1278.cbl
  8730 1700-WRITE-CERT-NOTE      SECTION.
  8731     IF NOT MODIFY-CERT-CAP
  8732         MOVE 'UPDATE'           TO  SM-READ
  8733         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8734         MOVE ER-0070            TO  EMI-ERROR
  8735         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8736         GO TO 8200-SEND-DATAONLY.
  8737
  8738**MOVE CANCEL QUOTE NOTE INFO
  8739     IF PI-LF-REFUND-AMT NUMERIC
  8740        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8741        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8742     ELSE
  8743        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8744                                    PI-LF-REFUND-AMT
  8745        MOVE SPACE               TO WS-CN-LF-REF-METH
  8746                                    PI-LF-REFUND-METH.
  8747
  8748     IF PI-AH-REFUND-AMT NUMERIC
  8749        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8750        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8751     ELSE
  8752        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8753                                    PI-AH-REFUND-AMT
  8754        MOVE SPACE               TO WS-CN-AH-REF-METH
  8755                                    PI-AH-REFUND-METH.
  8756
  8757     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8758                                   PI-AH-REFUND-AMT.
  8759
  8760     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8761
  8762     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8763     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8764     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8765        MOVE PI-LF-CANCEL-DATE-ED
  8766                                 TO WS-CN-CANCEL-DT
  8767     ELSE
  8768        MOVE PI-AH-CANCEL-DATE-ED
  8769                                 TO WS-CN-CANCEL-DT
  8770     END-IF
  8771     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8772     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8773     MOVE PI-CARRIER             TO CZ-CARRIER
  8774     MOVE PI-GROUPING            TO CZ-GROUPING
  8775     MOVE PI-STATE               TO CZ-STATE
  8776     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8777     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8778     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8779     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8780     MOVE '1'                    TO CZ-RECORD-TYPE
  8781     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8782     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8783     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8784     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8785     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8786     MOVE ' '                    TO WS-STOP-SW
  8787     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 164
* EL1278.cbl
  8788
  8789* EXEC CICS WRITE
  8790*           FROM      (CERT-NOTE-FILE)
  8791*           DATASET   (ERNOTE-ID)
  8792*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8793*           RESP      (WS-RESPONSE)
  8794*       END-EXEC
  8795     MOVE LENGTH OF
  8796      CERT-NOTE-FILE
  8797       TO DFHEIV11
  8798*    MOVE '&$ L                  ''  N#00008358' TO DFHEIV0
  8799     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8800     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8801     MOVE X'204E233030303038333538' TO DFHEIV0(25:11)
  8802     CALL 'kxdfhei1' USING DFHEIV0,
  8803           ERNOTE-ID,
  8804           CERT-NOTE-FILE,
  8805           DFHEIV11,
  8806           CZ-CONTROL-PRIMARY,
  8807           DFHEIV99,
  8808           DFHEIV99
  8809     MOVE EIBRESP  TO WS-RESPONSE
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8811        IF WS-RESP-DUPREC
  8812           ADD +1                TO CZ-NOTE-SEQUENCE
  8813        ELSE
  8814           SET I-SAY-TO-STOP     TO TRUE
  8815        END-IF
  8816     END-PERFORM
  8817     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8818     IF WS-RESP-NORMAL
  8819        EVALUATE CM-NOTE-SW
  8820           WHEN '1'
  8821           WHEN '3'
  8822           WHEN '5'
  8823           WHEN '7'
  8824              SET NO-CERT-RW     TO TRUE
  8825           WHEN ' '
  8826              MOVE '1'           TO CM-NOTE-SW
  8827           WHEN '2'
  8828              MOVE '3'           TO CM-NOTE-SW
  8829           WHEN '4'
  8830              MOVE '5'           TO CM-NOTE-SW
  8831           WHEN '6'
  8832              MOVE '7'           TO CM-NOTE-SW
  8833        END-EVALUATE
  8834     END-IF
  8835     IF NOT NO-CERT-RW
  8836        PERFORM 1810-REWRITE-ELCERT
  8837                                 THRU 1810-EXIT
  8838     ELSE
  8839
  8840* EXEC CICS UNLOCK
  8841*          DATASET    (ELCERT-ID)
  8842*       END-EXEC
  8843*    MOVE '&*                    #   #00008392' TO DFHEIV0
  8844     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8845     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 165
* EL1278.cbl
  8846     MOVE X'2020233030303038333932' TO DFHEIV0(25:11)
  8847     CALL 'kxdfhei1' USING DFHEIV0,
  8848           ELCERT-ID,
  8849           DFHEIV99
  8850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8851     END-IF
  8852     MOVE ER-8160                TO EMI-ERROR.
  8853     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8854     GO TO 8200-SEND-DATAONLY.
  8855
  8856 1799-EXIT.
  8857     EXIT.
  8858 1800-READ-ELCERT-UPDATE.
  8859     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8860     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8861     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8862     MOVE PI-STATE               TO  WS-CM-STATE.
  8863     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8864     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8865     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8866     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8867
  8868* EXEC CICS READ
  8869*        UPDATE
  8870*        DATASET  (ELCERT-ID)
  8871*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8872*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8873*        RESP     (WS-RESPONSE)
  8874*    END-EXEC
  8875*    MOVE '&"S        EU         (  N#00008411' TO DFHEIV0
  8876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8877     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8878     MOVE X'204E233030303038343131' TO DFHEIV0(25:11)
  8879     CALL 'kxdfhei1' USING DFHEIV0,
  8880           ELCERT-ID,
  8881           DFHEIV20,
  8882           DFHEIV99,
  8883           WS-CM-CONTROL-PRIMARY,
  8884           DFHEIV99,
  8885           DFHEIV99,
  8886           DFHEIV99
  8887     SET ADDRESS OF CERTIFICATE-MASTER TO
  8888         DFHEIV20
  8889     MOVE EIBRESP  TO WS-RESPONSE
  8890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8891     .
  8892 1800-EXIT.
  8893     EXIT.
  8894 1810-REWRITE-ELCERT.
  8895
  8896* EXEC CICS REWRITE
  8897*        FROM      (CERTIFICATE-MASTER)
  8898*        DATASET   (ELCERT-ID)
  8899*        RESP     (WS-RESPONSE)
  8900*    END-EXEC.
  8901     MOVE LENGTH OF
  8902      CERTIFICATE-MASTER
  8903       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 166
* EL1278.cbl
  8904*    MOVE '&& L                  %  N#00008422' TO DFHEIV0
  8905     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8906     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8907     MOVE X'204E233030303038343232' TO DFHEIV0(25:11)
  8908     CALL 'kxdfhei1' USING DFHEIV0,
  8909           ELCERT-ID,
  8910           CERTIFICATE-MASTER,
  8911           DFHEIV11,
  8912           DFHEIV99
  8913     MOVE EIBRESP  TO WS-RESPONSE
  8914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8915
  8916     .
  8917 1810-EXIT.
  8918     EXIT.
  8919 4000-GEN-CANCEL-TRANS.
  8920     IF PI-LF-REFUND-AMT NOT NUMERIC
  8921         MOVE +0 TO PI-LF-REFUND-AMT
  8922     END-IF
  8923     IF PI-AH-REFUND-AMT NOT NUMERIC
  8924         MOVE +0 TO PI-AH-REFUND-AMT
  8925     END-IF
  8926
  8927     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8928
  8929     MOVE '2'                    TO CG-OPTION-CODE
  8930     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8931     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8932     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8933     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8934     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8935     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8936     MOVE PI-STATE               TO CG-CERT-STATE
  8937     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8938     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8939     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8940     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8941     MOVE ZEROS                  TO CG-LF-BENCD
  8942                                    CG-AH-BENCD
  8943                                    CG-LF-CAN-AMT
  8944                                    CG-AH-CAN-AMT
  8945     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8946                                    CG-AH-CAN-DT
  8947     MOVE SPACES                 TO CG-BATCH-NO
  8948     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8949       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8950        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8951           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8952           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8953           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8954        END-IF
  8955     END-IF
  8956     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8957       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8958        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8959           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8960           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8961           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 167
* EL1278.cbl
  8962        END-IF
  8963     END-IF
  8964
  8965* EXEC CICS LINK
  8966*        PROGRAM  ('ELCANC')
  8967*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8968*    END-EXEC
  8969     MOVE LENGTH OF
  8970      CANCEL-GEN-PASS-AREA
  8971       TO DFHEIV11
  8972     MOVE 'ELCANC' TO DFHEIV1
  8973*    MOVE '."C                   (   #00008475' TO DFHEIV0
  8974     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8976     MOVE X'2020233030303038343735' TO DFHEIV0(25:11)
  8977     CALL 'kxdfhei1' USING DFHEIV0,
  8978           DFHEIV1,
  8979           CANCEL-GEN-PASS-AREA,
  8980           DFHEIV11,
  8981           DFHEIV99,
  8982           DFHEIV99,
  8983           DFHEIV99,
  8984           DFHEIV99
  8985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8986     IF CG-SUCCESS
  8987        CONTINUE
  8988     ELSE
  8989        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8990        move '3'                 to emi-switch1
  8991        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8992        EVALUATE TRUE
  8993           WHEN CG-DATE-ERROR
  8994             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8995           WHEN CG-CERT-NOT-FOUND
  8996             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8997           WHEN CG-AMOUNT-ERROR
  8998             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8999           WHEN CG-OPTION-ERROR
  9000             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9001           WHEN CG-PREV-CAN
  9002             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9003           WHEN CG-INVALID-DATA
  9004             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9005           WHEN CG-NO-ACCT-MSTR
  9006             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9007           WHEN CG-SFX-A-EXIST
  9008             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9009           WHEN CG-MISC-ERROR
  9010             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  9011           WHEN OTHER
  9012             move ' error - elcanc - return '
  9013                                 to emi-error-text (1) (12:25)
  9014        END-EVALUATE
  9015        go to 8200-send-dataonly
  9016     end-if
  9017     .
  9018 4000-exit.
  9019     exit.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 168
* EL1278.cbl
  9020
  9021 4400-ADD-ORIG-REC.
  9022
  9023     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  9024     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  9025     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  9026     MOVE PI-STATE               TO  WS-CM-STATE.
  9027     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  9028     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  9029     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  9030     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  9031
  9032
  9033* EXEC CICS READ
  9034*        DATASET  (ELCERT-ID)
  9035*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  9036*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9037*        RESP     (WS-RESPONSE)
  9038*    END-EXEC
  9039*    MOVE '&"S        E          (  N#00008525' TO DFHEIV0
  9040     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9042     MOVE X'204E233030303038353235' TO DFHEIV0(25:11)
  9043     CALL 'kxdfhei1' USING DFHEIV0,
  9044           ELCERT-ID,
  9045           DFHEIV20,
  9046           DFHEIV99,
  9047           WS-CM-CONTROL-PRIMARY,
  9048           DFHEIV99,
  9049           DFHEIV99,
  9050           DFHEIV99
  9051     SET ADDRESS OF CERTIFICATE-MASTER TO
  9052         DFHEIV20
  9053     MOVE EIBRESP  TO WS-RESPONSE
  9054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9055     IF WS-RESP-NORMAL
  9056         CONTINUE
  9057     ELSE
  9058        MOVE ER-0142                TO EMI-ERROR
  9059        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  9060        GO TO 8100-SEND-INITIAL-MAP
  9061     END-IF
  9062
  9063******************************************************************
  9064*            A D D   O R I G   C E R T   I N F O                 *
  9065******************************************************************
  9066
  9067     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  9068
  9069     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  9070     MOVE ' '                    TO WS-ERMAIL-SW
  9071
  9072
  9073* EXEC CICS READ
  9074*       DATASET   ('ERMAIL')
  9075*       SET       (ADDRESS OF MAILING-DATA)
  9076*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9077*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 169
* EL1278.cbl
  9078*    END-EXEC
  9079     MOVE 'ERMAIL' TO DFHEIV1
  9080*    MOVE '&"S        E          (  N#00008548' TO DFHEIV0
  9081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9083     MOVE X'204E233030303038353438' TO DFHEIV0(25:11)
  9084     CALL 'kxdfhei1' USING DFHEIV0,
  9085           DFHEIV1,
  9086           DFHEIV20,
  9087           DFHEIV99,
  9088           WS-MA-CONTROL-PRIMARY,
  9089           DFHEIV99,
  9090           DFHEIV99,
  9091           DFHEIV99
  9092     SET ADDRESS OF MAILING-DATA TO
  9093         DFHEIV20
  9094     MOVE EIBRESP  TO WS-RESPONSE
  9095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9096
  9097     IF WS-RESP-NORMAL
  9098        SET ERMAIL-FOUND TO TRUE
  9099     END-IF
  9100
  9101     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  9102     MOVE 'C'                   TO ELCRTT-REC-TYPE
  9103     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  9104
  9105
  9106* EXEC CICS READ
  9107*         DATASET  (ELCRTT-ID)
  9108*         RIDFLD   (ELCRTT-KEY)
  9109*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  9110*         RESP     (WS-RESPONSE)
  9111*    END-EXEC
  9112*    MOVE '&"S        E          (  N#00008563' TO DFHEIV0
  9113     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9114     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9115     MOVE X'204E233030303038353633' TO DFHEIV0(25:11)
  9116     CALL 'kxdfhei1' USING DFHEIV0,
  9117           ELCRTT-ID,
  9118           DFHEIV20,
  9119           DFHEIV99,
  9120           ELCRTT-KEY,
  9121           DFHEIV99,
  9122           DFHEIV99,
  9123           DFHEIV99
  9124     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  9125         DFHEIV20
  9126     MOVE EIBRESP  TO WS-RESPONSE
  9127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9128
  9129     IF NOT WS-RESP-NORMAL
  9130        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  9131     END-IF
  9132
  9133     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  9134     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  9135     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 170
* EL1278.cbl
  9136
  9137
  9138* EXEC CICS READ
  9139*       DATASET   ('ELCRTO')
  9140*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9141*       RIDFLD    (ELCRTO-KEY)
  9142*       GTEQ
  9143*       RESP      (WS-RESPONSE)
  9144*    END-EXEC
  9145     MOVE 'ELCRTO' TO DFHEIV1
  9146*    MOVE '&"S        G          (  N#00008578' TO DFHEIV0
  9147     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9149     MOVE X'204E233030303038353738' TO DFHEIV0(25:11)
  9150     CALL 'kxdfhei1' USING DFHEIV0,
  9151           DFHEIV1,
  9152           DFHEIV20,
  9153           DFHEIV99,
  9154           ELCRTO-KEY,
  9155           DFHEIV99,
  9156           DFHEIV99,
  9157           DFHEIV99
  9158     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9159         DFHEIV20
  9160     MOVE EIBRESP  TO WS-RESPONSE
  9161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9162
  9163     IF WS-RESP-NORMAL
  9164        AND (OC-CONTROL-PRIMARY (1:33) =
  9165                 WS-CM-CONTROL-PRIMARY)
  9166        AND (OC-RECORD-TYPE = 'I')
  9167        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  9168
  9169* EXEC CICS READ
  9170*             DATASET   ('ELCRTO')
  9171*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9172*             RIDFLD    (OC-CONTROL-PRIMARY)
  9173*             UPDATE
  9174*             RESP      (WS-RESPONSE)
  9175*          END-EXEC
  9176     MOVE 'ELCRTO' TO DFHEIV1
  9177*    MOVE '&"S        EU         (  N#00008591' TO DFHEIV0
  9178     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9179     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9180     MOVE X'204E233030303038353931' TO DFHEIV0(25:11)
  9181     CALL 'kxdfhei1' USING DFHEIV0,
  9182           DFHEIV1,
  9183           DFHEIV20,
  9184           DFHEIV99,
  9185           OC-CONTROL-PRIMARY,
  9186           DFHEIV99,
  9187           DFHEIV99,
  9188           DFHEIV99
  9189     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9190         DFHEIV20
  9191     MOVE EIBRESP  TO WS-RESPONSE
  9192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9193           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 171
* EL1278.cbl
  9194           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9195           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9196           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9197           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9198           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9199           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9200           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9201           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9202            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9203               MOVE SPACES             TO OC-LF-BENCD
  9204               MOVE ZEROS              TO OC-LF-TERM
  9205                                          OC-LF-BEN-AMT
  9206                                          OC-LF-PRM-AMT
  9207                                          OC-LF-ALT-BEN-AMT
  9208                                          OC-LF-ALT-PRM-AMT
  9209                                          OC-LF-COMM-PCT
  9210                                          OC-LF-CANCEL-AMT
  9211               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9212               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9213           ELSE
  9214               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9215               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9216               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9217               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9218               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9219               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9220               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9221               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9222               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9223               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9224           END-IF
  9225           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9226           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9227            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9228               MOVE SPACES             TO OC-AH-BENCD
  9229               MOVE ZEROS              TO OC-AH-TERM
  9230                                          OC-AH-BEN-AMT
  9231                                          OC-AH-PRM-AMT
  9232                                          OC-AH-COMM-PCT
  9233                                          OC-AH-CANCEL-AMT
  9234                                          OC-AH-CP
  9235               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9236               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9237           ELSE
  9238               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9239               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9240               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9241               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9242               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9243               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9244               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9245               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9246               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9247           END-IF
  9248           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9249           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9250           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9251           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 172
* EL1278.cbl
  9252           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9253           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9254           MOVE '5'                    TO DC-OPTION-CODE
  9255           PERFORM 9600-DATE-LINK
  9256           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9257           IF ERMAIL-FOUND
  9258               MOVE MA-CRED-BENE-NAME
  9259                           TO OC-CRED-BENE-NAME
  9260           END-IF
  9261           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9262               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9263                                  OC-INS-AGE-DEFAULT-FLAG
  9264               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9265                                  OC-JNT-AGE-DEFAULT-FLAG
  9266           END-IF
  9267
  9268
  9269* EXEC CICS REWRITE
  9270*             DATASET   ('ELCRTO')
  9271*             FROM      (ORIGINAL-CERTIFICATE)
  9272*             RESP      (WS-RESPONSE)
  9273*          END-EXEC
  9274     MOVE LENGTH OF
  9275      ORIGINAL-CERTIFICATE
  9276       TO DFHEIV11
  9277     MOVE 'ELCRTO' TO DFHEIV1
  9278*    MOVE '&& L                  %  N#00008673' TO DFHEIV0
  9279     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9280     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9281     MOVE X'204E233030303038363733' TO DFHEIV0(25:11)
  9282     CALL 'kxdfhei1' USING DFHEIV0,
  9283           DFHEIV1,
  9284           ORIGINAL-CERTIFICATE,
  9285           DFHEIV11,
  9286           DFHEIV99
  9287     MOVE EIBRESP  TO WS-RESPONSE
  9288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9289           IF NOT WS-RESP-NORMAL
  9290              MOVE ER-3830          TO EMI-ERROR
  9291              PERFORM 9700-ERROR-FORMAT
  9292                                 THRU 9799-EXIT
  9293              GO TO 8200-SEND-DATAONLY
  9294           END-IF
  9295
  9296           GO TO 4400-EXIT
  9297
  9298        ELSE
  9299           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9300        END-IF
  9301     ELSE
  9302        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9303        MOVE 'OC'                TO OC-RECORD-ID
  9304        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9305        MOVE 'I'                 TO OC-RECORD-TYPE
  9306        MOVE +4096               TO OC-KEY-SEQ-NO
  9307     END-IF
  9308
  9309     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 173
* EL1278.cbl
  9310     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9311     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9312     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9313     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9314     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9315     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9316     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9317     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9318      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9319         MOVE SPACES             TO OC-LF-BENCD
  9320         MOVE ZEROS              TO OC-LF-TERM
  9321                                    OC-LF-BEN-AMT
  9322                                    OC-LF-PRM-AMT
  9323                                    OC-LF-ALT-BEN-AMT
  9324                                    OC-LF-ALT-PRM-AMT
  9325                                    OC-LF-COMM-PCT
  9326                                    OC-LF-CANCEL-AMT
  9327         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9328         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9329     ELSE
  9330         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9331         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9332         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9333         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9334         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9335         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9336         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9337         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9338         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9339         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9340     END-IF
  9341     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9342     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9343      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9344         MOVE SPACES             TO OC-AH-BENCD
  9345         MOVE ZEROS              TO OC-AH-TERM
  9346                                    OC-AH-BEN-AMT
  9347                                    OC-AH-PRM-AMT
  9348                                    OC-AH-COMM-PCT
  9349                                    OC-AH-CANCEL-AMT
  9350                                    OC-AH-CP
  9351         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9352         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9353     ELSE
  9354         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9355         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9356         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9357         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9358         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9359         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9360         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9361         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9362         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9363         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9364     END-IF
  9365     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9366     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9367     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 174
* EL1278.cbl
  9368     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9369     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9370     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9371     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9372     MOVE '5'                    TO DC-OPTION-CODE
  9373     PERFORM 9600-DATE-LINK
  9374     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9375     IF ERMAIL-FOUND
  9376         MOVE MA-CRED-BENE-NAME
  9377                     TO OC-CRED-BENE-NAME
  9378     END-IF
  9379     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9380         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9381                            OC-INS-AGE-DEFAULT-FLAG
  9382         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9383                            OC-JNT-AGE-DEFAULT-FLAG
  9384     END-IF
  9385
  9386     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9387     .
  9388 4400-WRITE-ELCRTO.
  9389
  9390
  9391* EXEC CICS WRITE
  9392*       DATASET   ('ELCRTO')
  9393*       FROM      (ORIGINAL-CERTIFICATE)
  9394*       RIDFLD    (OC-CONTROL-PRIMARY)
  9395*       RESP      (WS-RESPONSE)
  9396*    END-EXEC
  9397     MOVE LENGTH OF
  9398      ORIGINAL-CERTIFICATE
  9399       TO DFHEIV11
  9400     MOVE 'ELCRTO' TO DFHEIV1
  9401*    MOVE '&$ L                  ''  N#00008779' TO DFHEIV0
  9402     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9404     MOVE X'204E233030303038373739' TO DFHEIV0(25:11)
  9405     CALL 'kxdfhei1' USING DFHEIV0,
  9406           DFHEIV1,
  9407           ORIGINAL-CERTIFICATE,
  9408           DFHEIV11,
  9409           OC-CONTROL-PRIMARY,
  9410           DFHEIV99,
  9411           DFHEIV99
  9412     MOVE EIBRESP  TO WS-RESPONSE
  9413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9414
  9415    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9416        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9417        GO TO 4400-WRITE-ELCRTO
  9418    ELSE
  9419        IF NOT WS-RESP-NORMAL
  9420           MOVE ER-3830          TO EMI-ERROR
  9421           PERFORM 9700-ERROR-FORMAT
  9422                                 THRU 9799-EXIT
  9423           GO TO 8200-SEND-DATAONLY
  9424        END-IF
  9425    END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 175
* EL1278.cbl
  9426
  9427     .
  9428 4400-EXIT.
  9429    EXIT.
  9430
  9431
  9432 5000-GET-LF-AM-REM-TERM.
  9433     MOVE +1                     TO SUB3.
  9434
  9435 5100-GET-LF-AM-REM-TERM.
  9436     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9437        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9438           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9439                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9440           GO TO 5300-MOVE-LF-REM-TERM.
  9441
  9442     IF SUB3 LESS THAN +20
  9443        ADD +1                   TO SUB3
  9444        GO TO 5100-GET-LF-AM-REM-TERM.
  9445
  9446     MOVE +1                     TO SUB3.
  9447
  9448     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9449         GO TO 5200-EDIT-FOR-NINETY-LF.
  9450
  9451 5100-GET-LF-DMD-AM-REM-TERM.
  9452
  9453     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9454        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9455           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9456                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9457           GO TO 5300-MOVE-LF-REM-TERM.
  9458
  9459     IF SUB3 LESS THAN +30
  9460        ADD +1                   TO SUB3
  9461        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9462
  9463     MOVE +1                     TO SUB3.
  9464
  9465 5200-EDIT-FOR-NINETY-LF.
  9466
  9467***************************************************************
  9468*                                                             *
  9469*    NINETY BENEFIT PLAN TYPES:                               *
  9470*                                                             *
  9471*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9472*      92 = ALL GROUP REDUCING BENEFITS                       *
  9473*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9474*      94 = ALL GROUP LEVEL BENEFITS                          *
  9475*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9476*           BENEFIT CONTROLS.                                 *
  9477*      99 = ALL BENEFITS                                      *
  9478*                                                             *
  9479***************************************************************
  9480
  9481     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9482                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9483
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 176
* EL1278.cbl
  9484     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9485       AND
  9486        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9487           GO TO 5300-MOVE-LF-REM-TERM.
  9488
  9489     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9490       AND
  9491        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9492        IF CF-REDUCING (WS-INDEX)
  9493           IF CM-INDIVIDUAL
  9494               GO TO 5300-MOVE-LF-REM-TERM.
  9495
  9496     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9497       AND
  9498        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9499        IF CF-REDUCING (WS-INDEX)
  9500           IF CM-GROUP
  9501               GO TO 5300-MOVE-LF-REM-TERM.
  9502
  9503     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9504       AND
  9505        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9506        IF CF-LEVEL (WS-INDEX)
  9507           IF CM-INDIVIDUAL
  9508               GO TO 5300-MOVE-LF-REM-TERM.
  9509
  9510     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9511       AND
  9512        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9513        IF CF-LEVEL (WS-INDEX)
  9514           IF CM-GROUP
  9515               GO TO 5300-MOVE-LF-REM-TERM.
  9516
  9517     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9518       AND
  9519        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9520            GO TO 5300-MOVE-LF-REM-TERM.
  9521
  9522     IF SUB3 LESS THAN +20
  9523        ADD +1           TO SUB3
  9524          GO TO 5200-EDIT-FOR-NINETY-LF.
  9525
  9526     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9527
  9528     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9529         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9530         GO TO 5900-EXIT.
  9531
  9532     MOVE 1                       TO SUB3.
  9533
  9534 5200-EDIT-FOR-DMD-NINETY-LF.
  9535
  9536     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9537                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9538
  9539     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9540       AND
  9541        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 177
* EL1278.cbl
  9542           GO TO 5300-MOVE-LF-REM-TERM.
  9543
  9544     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9545       AND
  9546        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9547        IF CF-REDUCING (WS-INDEX)
  9548           IF CM-INDIVIDUAL
  9549               GO TO 5300-MOVE-LF-REM-TERM.
  9550
  9551     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9552       AND
  9553        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9554        IF CF-REDUCING (WS-INDEX)
  9555           IF CM-GROUP
  9556               GO TO 5300-MOVE-LF-REM-TERM.
  9557
  9558     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9559       AND
  9560        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9561        IF CF-LEVEL (WS-INDEX)
  9562           IF CM-INDIVIDUAL
  9563               GO TO 5300-MOVE-LF-REM-TERM.
  9564
  9565     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9566       AND
  9567        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9568        IF CF-LEVEL (WS-INDEX)
  9569           IF CM-GROUP
  9570               GO TO 5300-MOVE-LF-REM-TERM.
  9571
  9572     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9573       AND
  9574        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9575            GO TO 5300-MOVE-LF-REM-TERM.
  9576
  9577     IF SUB3 LESS THAN +30
  9578        ADD +1                   TO SUB3
  9579          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9580
  9581     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9582
  9583     GO TO 5900-EXIT.
  9584
  9585 5300-MOVE-LF-REM-TERM.
  9586     MOVE WS-SAVE-BENEFIT-REM-TERM
  9587                                 TO WS-LF-AM-REM-TERM-CALC.
  9588
  9589 5900-EXIT.
  9590      EXIT.
  9591
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 178
* EL1278.cbl
  9593
  9594 6000-GET-AH-AM-REM-TERM.
  9595     MOVE +1                     TO SUB3.
  9596
  9597 6100-GET-AH-AM-REM-TERM.
  9598
  9599     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9600        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9601           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9602                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9603           GO TO 6300-MOVE-AH-REM-TERM.
  9604
  9605     IF SUB3 LESS THAN +20
  9606        ADD +1                   TO SUB3
  9607        GO TO 6100-GET-AH-AM-REM-TERM.
  9608
  9609     MOVE +1                     TO SUB3.
  9610
  9611     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9612         GO TO 6200-EDIT-FOR-NINETY-AH.
  9613
  9614 6100-GET-AH-AM-DMD-REM-TERM.
  9615     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9616        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9617           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9618                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9619           GO TO 6300-MOVE-AH-REM-TERM.
  9620
  9621     IF SUB3 LESS THAN +30
  9622        ADD +1                   TO SUB3
  9623        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9624
  9625     MOVE +1                     TO SUB3.
  9626
  9627 6200-EDIT-FOR-NINETY-AH.
  9628
  9629***************************************************************
  9630*                                                             *
  9631*    NINETY BENEFIT PLAN TYPES:                               *
  9632*                                                             *
  9633*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9634*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9635*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9636*           BENEFIT CONTROLS.                                 *
  9637*      99 = ALL BENEFITS.                                     *
  9638*                                                             *
  9639***************************************************************
  9640
  9641     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9642                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9643
  9644     IF AM-BENEFIT-CODE (SUB3) = '99'
  9645       AND
  9646        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9647           GO TO 6300-MOVE-AH-REM-TERM.
  9648
  9649     IF AM-BENEFIT-CODE (SUB3) = '91'
  9650       AND
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 179
* EL1278.cbl
  9651        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9652           IF CM-INDIVIDUAL
  9653               GO TO 6300-MOVE-AH-REM-TERM.
  9654
  9655     IF AM-BENEFIT-CODE (SUB3) = '92'
  9656       AND
  9657        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9658           IF CM-GROUP
  9659               GO TO 6300-MOVE-AH-REM-TERM.
  9660
  9661     IF AM-BENEFIT-CODE (SUB3) = '98'
  9662       AND
  9663        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9664           GO TO 6300-MOVE-AH-REM-TERM.
  9665
  9666     IF SUB3 LESS THAN +20
  9667        ADD +1                    TO SUB3
  9668        GO TO 6200-EDIT-FOR-NINETY-AH.
  9669
  9670     MOVE +1                      TO SUB3.
  9671
  9672     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9673         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9674         GO TO 6900-EXIT.
  9675
  9676 6200-EDIT-FOR-DMD-NINETY-AH.
  9677
  9678     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9679                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9680
  9681     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9682       AND
  9683        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9684           GO TO 6300-MOVE-AH-REM-TERM.
  9685
  9686     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9687       AND
  9688        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9689           IF CM-INDIVIDUAL
  9690               GO TO 6300-MOVE-AH-REM-TERM.
  9691
  9692     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9693       AND
  9694        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9695           IF CM-GROUP
  9696               GO TO 6300-MOVE-AH-REM-TERM.
  9697
  9698     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9699       AND
  9700        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9701           GO TO 6300-MOVE-AH-REM-TERM.
  9702
  9703     IF SUB3 LESS THAN +30
  9704        ADD +1                   TO SUB3
  9705        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9706
  9707     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9708
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 180
* EL1278.cbl
  9709     GO TO 6900-EXIT.
  9710
  9711 6300-MOVE-AH-REM-TERM.
  9712
  9713     MOVE WS-SAVE-BENEFIT-REM-TERM
  9714                                 TO WS-AH-AM-REM-TERM-CALC.
  9715
  9716 6900-EXIT.
  9717      EXIT.
  9718
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 181
* EL1278.cbl
  9720 7000-GET-ERFORM     SECTION.
  9721
  9722* EXEC CICS HANDLE CONDITION
  9723*        NOTFND  (7000-EXIT)
  9724*    END-EXEC.
  9725*    MOVE '"$I                   ! ( #00009092' TO DFHEIV0
  9726     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9728     MOVE X'2820233030303039303932' TO DFHEIV0(25:11)
  9729     CALL 'kxdfhei1' USING DFHEIV0
  9730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9731
  9732
  9733     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9734     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9735     MOVE PI-STATE               TO  WS-FO-STATE.
  9736     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9737     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9738
  9739
  9740* EXEC CICS READ
  9741*        DATASET  (ERFORM-ID)
  9742*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9743*        SET      (ADDRESS OF FORM-MASTER)
  9744*        GTEQ
  9745*    END-EXEC.
  9746*    MOVE '&"S        G          (   #00009102' TO DFHEIV0
  9747     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9749     MOVE X'2020233030303039313032' TO DFHEIV0(25:11)
  9750     CALL 'kxdfhei1' USING DFHEIV0,
  9751           ERFORM-ID,
  9752           DFHEIV20,
  9753           DFHEIV99,
  9754           WS-FO-CONTROL-PRIMARY,
  9755           DFHEIV99,
  9756           DFHEIV99,
  9757           DFHEIV99
  9758     SET ADDRESS OF FORM-MASTER TO
  9759         DFHEIV20
  9760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9761
  9762
  9763     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9764        PI-STATE          EQUAL FO-STATE      AND
  9765        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9766         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9767         GO TO 7000-EXIT.
  9768 7000-EXIT.
  9769     EXIT.
  9770 7100-BENEFIT-SEARCH SECTION.
  9771
  9772     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9773        MOVE +1                  TO  SUB4
  9774        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9775
  9776     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9777        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 182
* EL1278.cbl
  9778        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9779 7100-EXIT.
  9780     EXIT.
  9781 7150-BENEFIT-LIFE-SEARCH.
  9782     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9783       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9784         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9785          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9786            IF FO-PLAN-REFUND-METHOD (SUB4)
  9787                    IS GREATER THAN SPACES
  9788               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9789                                    WS-LF-FO-REFUND-CALC
  9790               GO TO 7150-EXIT.
  9791
  9792     IF SUB4 LESS THAN +40
  9793         ADD +1              TO SUB4
  9794         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9795
  9796 7150-EXIT.
  9797     EXIT.
  9798 7250-BENEFIT-AH-SEARCH.
  9799     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9800       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9801         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9802          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9803            IF FO-PLAN-REFUND-METHOD (SUB4)
  9804                    IS GREATER THAN SPACES
  9805               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9806                                    WS-AH-FO-REFUND-CALC
  9807               GO TO 7250-EXIT.
  9808
  9809     IF SUB4 LESS THAN +40
  9810         ADD +1              TO SUB4
  9811         GO TO 7250-BENEFIT-AH-SEARCH.
  9812
  9813 7250-EXIT.
  9814     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 183
* EL1278.cbl
  9816
  9817 8100-SEND-INITIAL-MAP  SECTION.
  9818     MOVE SAVE-DATE              TO  HDATEO.
  9819     MOVE EIBTIME                TO  TIME-IN.
  9820     MOVE TIME-OUT               TO  HTIMEO.
  9821     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9822     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9823     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9824     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9825
  9826     IF CM-LF-BENEFIT-CD = '00'
  9827         MOVE -1                 TO  HACANCL
  9828     ELSE
  9829         MOVE -1                 TO  HLCANCL.
  9830
  9831     if pi-company-id = 'VPP'
  9832        move al-sanof            to refdueha
  9833                                    canfeeha
  9834        move al-uanof            to refduea
  9835                                    canfeea
  9836     end-if
  9837     IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9838        MOVE AL-SADOF            TO CANREAHA
  9839                                    CLPYNHA
  9840                                    CANREAA
  9841                                    CLPYNA
  9842     END-IF
  9843
  9844
  9845* EXEC CICS SEND
  9846*        FROM    (EL127HO)
  9847*        MAPSET  (MAPSET-NAME)
  9848*        MAP     (MAP-NAME)
  9849*        CURSOR
  9850*        ERASE
  9851*    END-EXEC.
  9852     MOVE LENGTH OF
  9853      EL127HO
  9854       TO DFHEIV12
  9855     MOVE -1
  9856       TO DFHEIV11
  9857*    MOVE '8$     CT  E    H L F ,   #00009190' TO DFHEIV0
  9858     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9859     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9860     MOVE X'2020233030303039313930' TO DFHEIV0(25:11)
  9861     CALL 'kxdfhei1' USING DFHEIV0,
  9862           MAP-NAME,
  9863           EL127HO,
  9864           DFHEIV12,
  9865           MAPSET-NAME,
  9866           DFHEIV99,
  9867           DFHEIV99,
  9868           DFHEIV99,
  9869           DFHEIV11,
  9870           DFHEIV99,
  9871           DFHEIV99,
  9872           DFHEIV99
  9873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 184
* EL1278.cbl
  9874
  9875
  9876     GO TO 9000-RETURN-TRAN.
  9877
  9878 8200-SEND-DATAONLY  SECTION.
  9879     IF FIRST-ENTRY
  9880         GO TO 8100-SEND-INITIAL-MAP.
  9881
  9882     MOVE SAVE-DATE              TO  HDATEO.
  9883     MOVE EIBTIME                TO  TIME-IN.
  9884     MOVE TIME-OUT               TO  HTIMEO.
  9885     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9886     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9887     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9888     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9889     MOVE -1                     TO  HLCANCL.
  9890
  9891
  9892* EXEC CICS SEND DATAONLY
  9893*        FROM    (EL127HO)
  9894*        MAPSET  (MAPSET-NAME)
  9895*        MAP     (MAP-NAME)
  9896*        CURSOR
  9897*    END-EXEC.
  9898     MOVE LENGTH OF
  9899      EL127HO
  9900       TO DFHEIV12
  9901     MOVE -1
  9902       TO DFHEIV11
  9903*    MOVE '8$D    CT       H L F ,   #00009213' TO DFHEIV0
  9904     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9905     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9906     MOVE X'2020233030303039323133' TO DFHEIV0(25:11)
  9907     CALL 'kxdfhei1' USING DFHEIV0,
  9908           MAP-NAME,
  9909           EL127HO,
  9910           DFHEIV12,
  9911           MAPSET-NAME,
  9912           DFHEIV99,
  9913           DFHEIV99,
  9914           DFHEIV99,
  9915           DFHEIV11,
  9916           DFHEIV99,
  9917           DFHEIV99,
  9918           DFHEIV99
  9919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9920
  9921
  9922     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 185
* EL1278.cbl
  9924 8300-SEND-TEXT  SECTION.
  9925
  9926* EXEC CICS SEND TEXT
  9927*        FROM    (LOGOFF-TEXT)
  9928*        LENGTH  (LOGOFF-LENGTH)
  9929*        ERASE
  9930*        FREEKB
  9931*    END-EXEC.
  9932*    MOVE '8&      T  E F  H   F -   #00009223' TO DFHEIV0
  9933     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9934     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9935     MOVE X'2020233030303039323233' TO DFHEIV0(25:11)
  9936     CALL 'kxdfhei1' USING DFHEIV0,
  9937           LOGOFF-TEXT,
  9938           LOGOFF-LENGTH,
  9939           DFHEIV99,
  9940           DFHEIV99,
  9941           DFHEIV99,
  9942           DFHEIV99,
  9943           DFHEIV99,
  9944           DFHEIV99,
  9945           DFHEIV99,
  9946           DFHEIV99,
  9947           DFHEIV99,
  9948           DFHEIV99
  9949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9950
  9951
  9952
  9953* EXEC CICS RETURN
  9954*    END-EXEC.
  9955*    MOVE '.(                    ''   #00009230' TO DFHEIV0
  9956     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9957     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9958     MOVE X'2020233030303039323330' TO DFHEIV0(25:11)
  9959     CALL 'kxdfhei1' USING DFHEIV0,
  9960           DFHEIV99,
  9961           DFHEIV99,
  9962           DFHEIV99,
  9963           DFHEIV99,
  9964           DFHEIV99,
  9965           DFHEIV99
  9966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9967
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 186
* EL1278.cbl
  9969 8600-DEEDIT  SECTION.
  9970
  9971* EXEC CICS BIF DEEDIT
  9972*        FIELD   (DEEDIT-FIELD)
  9973*        LENGTH  (15)
  9974*    END-EXEC.
  9975     MOVE 15
  9976       TO DFHEIV11
  9977*    MOVE '@"L                   #   #00009234' TO DFHEIV0
  9978     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9979     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9980     MOVE X'2020233030303039323334' TO DFHEIV0(25:11)
  9981     CALL 'kxdfhei1' USING DFHEIV0,
  9982           DEEDIT-FIELD,
  9983           DFHEIV11
  9984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9985
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 187
* EL1278.cbl
  9987 8700-UNAUTHORIZED-ACCESS  SECTION.
  9988     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9989
  9990     GO TO 8300-SEND-TEXT.
  9991
  9992 8800-PF23  SECTION.
  9993     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9994     MOVE XCTL-005               TO  PGM-NAME.
  9995
  9996     GO TO 9200-XCTL.
  9997
  9998 8900-RETURN-CICS  SECTION.
  9999
 10000* EXEC CICS RETURN
 10001*    END-EXEC.
 10002*    MOVE '.(                    ''   #00009251' TO DFHEIV0
 10003     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10004     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10005     MOVE X'2020233030303039323531' TO DFHEIV0(25:11)
 10006     CALL 'kxdfhei1' USING DFHEIV0,
 10007           DFHEIV99,
 10008           DFHEIV99,
 10009           DFHEIV99,
 10010           DFHEIV99,
 10011           DFHEIV99,
 10012           DFHEIV99
 10013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10014
 10015
 10016 9000-RETURN-TRAN  SECTION.
 10017     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10018     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10019
 10020
 10021* EXEC CICS RETURN
 10022*        TRANSID   (TRANS-ID)
 10023*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10024*        LENGTH    (PI-COMM-LENGTH)
 10025*    END-EXEC.
 10026*    MOVE '.(CT                  ''   #00009258' TO DFHEIV0
 10027     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10028     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10029     MOVE X'2020233030303039323538' TO DFHEIV0(25:11)
 10030     CALL 'kxdfhei1' USING DFHEIV0,
 10031           TRANS-ID,
 10032           PROGRAM-INTERFACE-BLOCK,
 10033           PI-COMM-LENGTH,
 10034           DFHEIV99,
 10035           DFHEIV99,
 10036           DFHEIV99
 10037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10038
 10039
 10040 9100-RETURN-MAIN-MENU  SECTION.
 10041     MOVE XCTL-126               TO  PGM-NAME.
 10042
 10043     GO TO 9200-XCTL.
 10044
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 188
* EL1278.cbl
 10045 9200-XCTL  SECTION.
 10046
 10047* EXEC CICS XCTL
 10048*        PROGRAM   (PGM-NAME)
 10049*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10050*        LENGTH    (PI-COMM-LENGTH)
 10051*    END-EXEC.
 10052*    MOVE '.$C                   %   #00009270' TO DFHEIV0
 10053     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10054     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10055     MOVE X'2020233030303039323730' TO DFHEIV0(25:11)
 10056     CALL 'kxdfhei1' USING DFHEIV0,
 10057           PGM-NAME,
 10058           PROGRAM-INTERFACE-BLOCK,
 10059           PI-COMM-LENGTH,
 10060           DFHEIV99
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063
 10064 9300-CLEAR  SECTION.
 10065     MOVE ' '                    TO  PI-PEND-SW.
 10066     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10067
 10068     GO TO 9200-XCTL.
 10069
 10070 9400-PF12  SECTION.
 10071     MOVE XCTL-010               TO  PGM-NAME.
 10072
 10073     GO TO 9200-XCTL.
 10074
 10075 9500-PGMID-ERROR  SECTION.
 10076
 10077* EXEC CICS HANDLE CONDITION
 10078*        PGMIDERR  (8300-SEND-TEXT)
 10079*    END-EXEC.
 10080*    MOVE '"$L                   ! ) #00009288' TO DFHEIV0
 10081     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10083     MOVE X'2920233030303039323838' TO DFHEIV0(25:11)
 10084     CALL 'kxdfhei1' USING DFHEIV0
 10085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10086
 10087
 10088     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10089     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10090     MOVE XCTL-005               TO  PGM-NAME.
 10091     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10092     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10093
 10094     GO TO 9200-XCTL.
 10095
 10096 9600-DATE-LINK  SECTION.
 10097     MOVE LINK-ELDATCV           TO  PGM-NAME
 10098
 10099
 10100* EXEC CICS LINK
 10101*        PROGRAM   (PGM-NAME)
 10102*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 189
* EL1278.cbl
 10103*        LENGTH    (DC-COMM-LENGTH)
 10104*    END-EXEC.
 10105*    MOVE '."C                   (   #00009303' TO DFHEIV0
 10106     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10108     MOVE X'2020233030303039333033' TO DFHEIV0(25:11)
 10109     CALL 'kxdfhei1' USING DFHEIV0,
 10110           PGM-NAME,
 10111           DATE-CONVERSION-DATA,
 10112           DC-COMM-LENGTH,
 10113           DFHEIV99,
 10114           DFHEIV99,
 10115           DFHEIV99,
 10116           DFHEIV99
 10117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10118
 10119
 10120
 10121 9700-ERROR-FORMAT  SECTION.
 10122     IF NOT EMI-ERRORS-COMPLETE
 10123         MOVE LINK-001               TO  PGM-NAME
 10124
 10125* EXEC CICS LINK
 10126*            PROGRAM   (PGM-NAME)
 10127*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10128*            LENGTH    (EMI-COMM-LENGTH)
 10129*        END-EXEC.
 10130*    MOVE '."C                   (   #00009313' TO DFHEIV0
 10131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10133     MOVE X'2020233030303039333133' TO DFHEIV0(25:11)
 10134     CALL 'kxdfhei1' USING DFHEIV0,
 10135           PGM-NAME,
 10136           ERROR-MESSAGE-INTERFACE-BLOCK,
 10137           EMI-COMM-LENGTH,
 10138           DFHEIV99,
 10139           DFHEIV99,
 10140           DFHEIV99,
 10141           DFHEIV99
 10142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10143
 10144
 10145 9799-EXIT.
 10146     EXIT.
 10147
 10148 9800-SECURITY-VIOLATION  SECTION.
 10149*                            COPY ELCSCTP.
 10150******************************************************************
 10151*                                                                *
 10152*                            ELCSCTP                             *
 10153*                            VMOD=2.001                          *
 10154*                                                                *
 10155*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10156******************************************************************
 10157
 10158
 10159     MOVE EIBDATE          TO SM-JUL-DATE.
 10160     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 190
* EL1278.cbl
 10161     MOVE THIS-PGM         TO SM-PGM.
 10162     MOVE EIBTIME          TO TIME-IN.
 10163     MOVE TIME-OUT         TO SM-TIME.
 10164     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10165
 10166
 10167* EXEC CICS LINK
 10168*         PROGRAM  ('EL003')
 10169*         COMMAREA (SECURITY-MESSAGE)
 10170*         LENGTH   (80)
 10171*    END-EXEC.
 10172     MOVE 'EL003' TO DFHEIV1
 10173     MOVE 80
 10174       TO DFHEIV11
 10175*    MOVE '."C                   (   #00009340' TO DFHEIV0
 10176     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10178     MOVE X'2020233030303039333430' TO DFHEIV0(25:11)
 10179     CALL 'kxdfhei1' USING DFHEIV0,
 10180           DFHEIV1,
 10181           SECURITY-MESSAGE,
 10182           DFHEIV11,
 10183           DFHEIV99,
 10184           DFHEIV99,
 10185           DFHEIV99,
 10186           DFHEIV99
 10187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10188
 10189
 10190******************************************************************
 10191
 10192
 10193 9899-EXIT.
 10194     EXIT.
 10195
 10196 9900-ABEND  SECTION.
 10197     MOVE LINK-004               TO  PGM-NAME.
 10198     MOVE DFHEIBLK               TO  EMI-LINE1.
 10199
 10200
 10201* EXEC CICS LINK
 10202*        PROGRAM   (PGM-NAME)
 10203*        COMMAREA  (EMI-LINE1)
 10204*        LENGTH    (72)
 10205*    END-EXEC.
 10206     MOVE 72
 10207       TO DFHEIV11
 10208*    MOVE '."C                   (   #00009356' TO DFHEIV0
 10209     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10211     MOVE X'2020233030303039333536' TO DFHEIV0(25:11)
 10212     CALL 'kxdfhei1' USING DFHEIV0,
 10213           PGM-NAME,
 10214           EMI-LINE1,
 10215           DFHEIV11,
 10216           DFHEIV99,
 10217           DFHEIV99,
 10218           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 191
* EL1278.cbl
 10219           DFHEIV99
 10220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10221
 10222
 10223     MOVE -1                     TO  HLCANCL.
 10224
 10225     GO TO 8200-SEND-DATAONLY.
 10226
 10227 9999-LAST-PARAGRAPH.
 10228
 10229* GOBACK.
 10230     MOVE '9%                    "   ' TO DFHEIV0
 10231     MOVE 'EL1278' TO DFHEIV1
 10232     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10233     GOBACK.
 10234
 10235 9999-DFHBACK SECTION.
 10236     MOVE '9%                    "   ' TO DFHEIV0
 10237     MOVE 'EL1278' TO DFHEIV1
 10238     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10239     GOBACK.
 10240 9999-DFHEXIT.
 10241     IF DFHEIGDJ EQUAL 0001
 10242         NEXT SENTENCE
 10243     ELSE IF DFHEIGDJ EQUAL 2
 10244         GO TO 9500-PGMID-ERROR,
 10245               9900-ABEND
 10246         DEPENDING ON DFHEIGDI
 10247     ELSE IF DFHEIGDJ EQUAL 3
 10248         GO TO 0910-NOT-FOUND
 10249         DEPENDING ON DFHEIGDI
 10250     ELSE IF DFHEIGDJ EQUAL 4
 10251         GO TO 1010-NOTFND,
 10252               1020-NOTOPEN
 10253         DEPENDING ON DFHEIGDI
 10254     ELSE IF DFHEIGDJ EQUAL 5
 10255         GO TO 1290-ACCT-NOT-FOUND,
 10256               1290-ACCT-NOT-FOUND
 10257         DEPENDING ON DFHEIGDI
 10258     ELSE IF DFHEIGDJ EQUAL 6
 10259         GO TO 0580-ACCT-NOT-FOUND,
 10260               0580-ACCT-NOT-FOUND
 10261         DEPENDING ON DFHEIGDI
 10262     ELSE IF DFHEIGDJ EQUAL 7
 10263         GO TO 1699-EXIT
 10264         DEPENDING ON DFHEIGDI
 10265     ELSE IF DFHEIGDJ EQUAL 8
 10266         GO TO 7000-EXIT
 10267         DEPENDING ON DFHEIGDI
 10268     ELSE IF DFHEIGDJ EQUAL 9
 10269         GO TO 8300-SEND-TEXT
 10270         DEPENDING ON DFHEIGDI.
 10271     MOVE '9%                    "   ' TO DFHEIV0
 10272     MOVE 'EL1278' TO DFHEIV1
 10273     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10274     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 10-Aug-16 10:10 Page 192
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8656     Code:       26609
