* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62******************************************************************
    63
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   3
* EL156.cbl
    65 ENVIRONMENT DIVISION.
    66
    67 DATA DIVISION.
    68
    69 WORKING-STORAGE SECTION.
    70 01  DFH-START PIC X(04).
    71
    72 77  FILLER  PIC X(32)  VALUE '********************************'.
    73 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    74 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    75 77  WS-SSN  PIC X(9) VALUE ZEROS.
    76 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    77 77  C0                          PIC S999 COMP-3 VALUE +0.
    78 77  C1                          PIC S999 COMP-3 VALUE +0.
    79 77  C2                          PIC S999 COMP-3 VALUE +0.
    80 77  C3                          PIC S999 COMP-3 VALUE +0.
    81 77  s1                          PIC S999 COMP-3 VALUE +0.
    82 77  s2                          pic s999 comp-3 value +0.
    83 77  P1                          PIC S999 COMP-3 VALUE +0.
    84 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    85 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    86 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    87 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    88 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    89 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    90 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    91 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    92 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    93 77  ws-max-bens                 pic s999 comp-3 value +0.
    94 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    95 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    96 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    97 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    98 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    99 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   100
   101*    COPY ELCSCTM.
   102******************************************************************
   103*                                                                *
   104*                                                                *
   105*                            ELCSCTM                             *
   106*                            VMOD=2.001                          *
   107*                                                                *
   108*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   109*                                                                *
   110******************************************************************
   111 01  SECURITY-MESSAGE.
   112     12  FILLER                          PIC X(30)
   113            VALUE '** LOGIC SECURITY VIOLATION -'.
   114     12  SM-READ                         PIC X(6).
   115     12  FILLER                          PIC X(5)
   116            VALUE ' PGM='.
   117     12  SM-PGM                          PIC X(6).
   118     12  FILLER                          PIC X(5)
   119            VALUE ' OPR='.
   120     12  SM-PROCESSOR-ID                 PIC X(4).
   121     12  FILLER                          PIC X(6)
   122            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   4
* EL156.cbl
   123     12  SM-TERMID                       PIC X(4).
   124     12  FILLER                          PIC XX   VALUE SPACE.
   125     12  SM-JUL-DATE                     PIC 9(5).
   126     12  FILLER                          PIC X    VALUE SPACE.
   127     12  SM-TIME                         PIC 99.99.
   128
   129
   130*    COPY ELCSCRTY.
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCSCRTY                            *
   135*                            VMOD=2.001                          *
   136*                                                                *
   137*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   138*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   139*        SAVED IN PI-SECURITY-ADDRESS.                           *
   140*                                                                *
   141******************************************************************
   142 01  SECURITY-CONTROL.
   143     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   144     12  FILLER                       PIC XX    VALUE 'SC'.
   145     12  SC-CREDIT-CODES.
   146         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   147             20  SC-CREDIT-DISPLAY    PIC X.
   148             20  SC-CREDIT-UPDATE     PIC X.
   149     12  SC-CLAIMS-CODES.
   150         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   151             20  SC-CLAIMS-DISPLAY    PIC X.
   152             20  SC-CLAIMS-UPDATE     PIC X.
   153
   154 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   155 01  WS-DATE-AREA.
   156     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   157     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   158     12  SAVE-DATE-CCYYMMDD.
   159         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   160         16  SAVE-DATE-YMD.
   161             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   162             20  FILLER              PIC X(04)   VALUE SPACES.
   163
   164 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   165 01  STANDARD-AREAS.
   166     12  WS-RESPONSE         PIC S9(8)   COMP.
   167         88  WS-RESP-NORMAL              VALUE +00.
   168         88  WS-RESP-ERROR               VALUE +01.
   169         88  WS-RESP-NOTFND              VALUE +13.
   170         88  WS-RESP-DUPREC              VALUE +14.
   171         88  WS-RESP-ENDFILE             VALUE +20.
   172     12  PMT-HEAD-A.
   173         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   174         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   175         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   176-        '     RESERVES  TYPE    AMOUNT'.
   177     12  PMT-HEAD-B.
   178         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   179         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   180         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   5
* EL156.cbl
   181     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   182     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   183     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   184     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   185     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   186     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   187     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   188     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   189     12  PGM-NAME            PIC X(8).
   190     12  TIME-IN             PIC S9(7).
   191     12  TIME-OUT-R  REDEFINES TIME-IN.
   192         16  FILLER          PIC X.
   193         16  TIME-OUT        PIC 99V99.
   194         16  FILLER          PIC XX.
   195     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   196     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   197     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   198     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   199     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   200     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   201     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   202     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   203     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   204     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   205     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   206     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   207     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   208     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   209     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   210     12  WS-BLANK            PIC X       VALUE ' '.
   211
   212 01  MISC-WORK-AREAS.
   213     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   214     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   215     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   216     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   217     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   218     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   219     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   220     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   221     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   222     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   223     12  W-CALLED-NAME           PIC X(08).
   224     12  W-EOB-CODES.
   225         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   226             20  W-EOB-CODE      PIC XXX.
   227             20  W-EOB-FILLER    PIC X.
   228     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   229     12  W-NAME-LAST             PIC X(15).
   230     12  W-NAME-FIRST            PIC X(15).
   231     12  W-NAME-MIDDLE.
   232         16  FILLER              PIC X.
   233         16  W-NAME-MIDDLE-2     PIC X.
   234         16  FILLER              PIC X(13).
   235     12  W-DMD-CHECK-NO.
   236         16  W-DMD-CHECK-NO-1    PIC X(4).
   237         16  W-DMD-CHECK-NO-2    PIC X.
   238         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   6
* EL156.cbl
   239
   240     12  WS-COMPUTE-FROM-DT  PIC XX.
   241     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   242     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   243     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   244     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   245     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   246     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   247         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   248         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   249     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   250         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   251     12  WS-UPDATE-SW        PIC X VALUE ' '.
   252     12  WS-GROUPING.
   253         16  WS-GROUP-1      PIC X VALUE SPACES.
   254         16  FILLER          PIC X(05) VALUE SPACES.
   255     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   256     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   257     12  WS-WORK-STATE-ACCT.
   258         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   259         16  FILLER          PIC X       VALUE '/'.
   260         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   261     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   262     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   263     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   264     12  QID.
   265         16  QID-TERM        PIC X(4)    VALUE SPACES.
   266         16  FILLER          PIC X(4)    VALUE '156A'.
   267     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   268     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   269     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   270     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   271     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   272     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   273     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   274     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   275     12  WS-STATUS           PIC X       VALUE SPACES.
   276     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   277     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   278     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   279     12  ws-extended-exp-dt  pic xx      value low-values.
   280     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   281     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   282     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   283     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   284     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   285     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   286     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   287     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   288     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   289     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   290     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   291     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   292     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   293     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   294     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   295     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   296     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   7
* EL156.cbl
   297     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   298     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   299     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   300     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   301     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   302     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   303     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   304     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   305     12  WORK-DATE-FROM.
   306         16  WDF-MONTH       PIC 99        VALUE ZERO.
   307         16  WDF-DAY         PIC 99        VALUE ZERO.
   308         16  WDF-YEAR        PIC 99        VALUE ZERO.
   309     12  WORK-DATE-THRU.
   310         16  WDT-MONTH       PIC 99        VALUE ZERO.
   311         16  WDT-DAY         PIC 99        VALUE ZERO.
   312         16  WDT-YEAR        PIC 99        VALUE ZERO.
   313     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   314     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   315     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   316     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   317     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   318     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   319     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   320     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   321     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   322     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   323     12  WS-PY-WK REDEFINES WS-PY-WORK.
   324         16  WS-PY-NUM       PIC S9(7)V99.
   325         16  WS-PY-SIGN      PIC X.
   326     12  WS-DY-WORK          PIC S9(5).
   327     12  WS-DY-WK REDEFINES WS-DY-WORK.
   328         16  WS-DY-NUM       PIC S9(4).
   329         16  WS-DY-SIGN      PIC X.
   330     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   331         88  COMP-REC-FOUND              VALUE 'Y'.
   332     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   333         88  BENEFIT-FOUND       VALUE 'Y'.
   334         88  NO-BENEFIT-FOUND    VALUE 'N'.
   335     12  WS-TERMS.
   336         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   337         16  FILLER          PIC X       VALUE '/'.
   338         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   339         16  WST-REM-DAYS-GRP.
   340             20  WST-SLASH   PIC X       VALUE '/'.
   341             20  WST-REM-DAYS
   342                             PIC --9.
   343     12  WS-ACCESS.
   344         16  FILLER          PIC XX      VALUE SPACES.
   345         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   346     12  WS-STATE-ACCESS.
   347         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   348         16  FILLER          PIC XX      VALUE SPACES.
   349     12  WS-CARR-ACCESS.
   350         16  FILLER          PIC X(3)    VALUE SPACES.
   351         16  WS-CARR         PIC X       VALUE SPACES.
   352     12  DATE-WORK.
   353         16  FILLER          PIC XX      VALUE SPACES.
   354         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   8
* EL156.cbl
   355     12  WS-SAVE-INPUT.
   356         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   357         16  WS-PAYEE        PIC XX      VALUE SPACE.
   358         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   359         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   360         16  WS-OFFLINE      PIC X       VALUE SPACE.
   361         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   362         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   363         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   364         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   365         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   366         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   367         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   368         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   369         16  WS-ETYPE        PIC X       VALUE SPACE.
   370         16  WS-CASH         PIC X       VALUE SPACE.
   371         16  WS-GROUPED      PIC X       VALUE SPACE.
   372         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   373         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   374         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   375         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   376         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   377         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   378         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   379         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   380         16  ws-int-to-rem-borr pic x value spaces.
   381     12  LAST-ERROR-LINE.
   382         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   383         16  FILLER              PIC X(30)
   384             VALUE ' FATAL ERRORS ENCOUNTERED'.
   385         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   386         16  FILLER              PIC X(28)
   387             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   388     12  WS-CHECK-AREA.
   389         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   390         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   391     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   392     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   393         16  FILLER              PIC XX.
   394         16  WS-A-CHECK-NUM-5    PIC 9(5).
   395     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   396         16  FILLER              PIC X.
   397         16  WS-A-CHECK-NUM-6    PIC 9(6).
   398     12  OPTION-1-SAVE-AREA.
   399         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   400         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   401     12  WS-WORK-ZIP.
   402         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   403         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   404     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   405                                 PIC 9(9).
   406     12  WS-FLI-PMTNOTE.
   407         16  WS-PMTOPTION        PIC XX.
   408         16  WS-DOCNAME          PIC X(28).
   409         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   410             20  WS-AMOUNT       PIC X(8).
   411             20  FILLER          PIC X(20).
   412         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page   9
* EL156.cbl
   413             20  WS-NUM-AMT      PIC 9(6)V99.
   414             20  FILLER          PIC X(20).
   415
   416     12  WS-HAN-PMTNOTE.
   417         16  WS-HAN-PMT-CODE     PIC X.
   418         16  WS-HAN-PMT-NOTE     PIC X(39).
   419
   420     12  WS-NCL-PMT-OPTION       PIC XX.
   421         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   422
   423     12  WS-CLAIM-SEQUENCE.
   424         16  FILLER              PIC X VALUE '('.
   425         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   426         16  FILLER              PIC X(04) VALUE ' OF '.
   427         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   428         16  FILLER              PIC X VALUE ')'.
   429
   430     12  WS-REFUND-AMT           PIC Z(7).99.
   431     12  WS-CALC-INT             PIC S9(7)V99.
   432     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   433
   434     12  SUB                     PIC 99 VALUE ZEROS.
   435
   436     12  WS-BOANOTE1.
   437         16  WS-BOANOTE1-DESC    PIC X(11).
   438         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   439         16  FILLER              PIC X(17).
   440     12  WS-BOANOTE2.
   441         16  WS-BOANOTE2-DESC    PIC X(11).
   442         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   443         16  FILLER              PIC X(17).
   444
   445     12  WS-NCLNOTE1.
   446         16  WS-NCLNOTE1-DESC    PIC X(11).
   447         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   448         16  FILLER              PIC X(17).
   449     12  WS-NCLNOTE2.
   450         16  WS-NCLNOTE2-DESC    PIC X(11).
   451         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   452         16  FILLER              PIC X(17).
   453
   454     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   455     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   456     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   457     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   458     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   459     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   460     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   461     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   462     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   463     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   464
   465     12  WS-AIG-WORK-AREAS.
   466         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   467             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   468         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   469             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   470         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  10
* EL156.cbl
   471             20  WS-FROM-MO      PIC 99.
   472             20  WS-FROM-DA      PIC 99.
   473             20  WS-FROM-YR      PIC 99.
   474         16  WS-TEMP-DATE-MDY.
   475             20  WS-TEMP-MO      PIC 99.
   476             20  WS-TEMP-DA      PIC 99.
   477             20  WS-TEMP-YR      PIC 99.
   478         16  WS-BIN-FROM-DT      PIC XX.
   479         16  WS-TEMP-INC-MDY.
   480             20  WS-TEMP-INC-MO  PIC 99.
   481             20  WS-TEMP-INC-DA  PIC 99.
   482             20  WS-TEMP-INC-YR  PIC 99.
   483         16  WS-PMT-DUE-MDY.
   484             20  WS-PMT-DUE-MO   PIC 99.
   485             20  WS-PMT-DUE-DA   PIC 99.
   486             20  WS-PMT-DUE-YR   PIC 99.
   487         16  WS-PMT-DUE-DT       PIC XX.
   488         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   489         16  WS-RETRO-ELIM-DT    PIC XX.
   490         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   491             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   492         16  WS-SAVE-DUE-DA      PIC 99.
   493         16  WS-CDAYS            PIC S9(05).
   494         16  WS-DAYS-OFF         PIC S9(05).
   495         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   496             88  ELIM-SATISFIED            VALUE 'Y'.
   497         16  WS-AIG-CHECKNO.
   498             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   499             20  WS-A-CHECKNO-3-7.
   500                 24  FILLER              PIC X(3)    VALUE SPACES.
   501                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   502                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   503         16  WS-AIG-GROUPING.
   504             20  WS-A-BENE               PIC XXX.
   505             20  FILLER                  PIC XXX.
   506         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   507             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   508             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   509         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   510                 VALUE 'UNEMPLOYMENT PAYMENT'.
   511         16  WS-CHK-THRU-DT              PIC XX.
   512         16  WS-HOLD-BIN-DATE-1          PIC XX.
   513
   514 01  MISC-CSO-AREA.
   515     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   516     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   517     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   518         88  APPROVAL-NEEDED                        VALUE 'Y'.
   519     12  WS-APPROV-NOTE                  PIC X(43)
   520         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   521     12  WS-3550-APPROV-NOTE             PIC X(43)
   522         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   523     12  WS-REAUDIT-NOTE                 PIC X(43)
   524         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   525     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   526     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   527     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   528     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  11
* EL156.cbl
   529     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   530     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   531     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   532         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   533     12  WS-PAYEE-CITY-STATE     PIC X(30).
   534     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   535         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   536     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   537     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   538     12  WS-WORK-NAME            PIC X(30).
   539     12  FILLER  REDEFINES WS-WORK-NAME.
   540         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   541     12  WS-INSURED-NAME         PIC X(30).
   542     12  FILLER  REDEFINES WS-INSURED-NAME.
   543         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   544     12  WS-PAYEE-NAME           PIC X(30).
   545     12  FILLER  REDEFINES WS-PAYEE-NAME.
   546         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   547
   548 01  ERROR-MESSAGES.
   549     12  ER-0000                 PIC X(4)  VALUE '0000'.
   550     12  ER-0004                 PIC X(4)  VALUE '0004'.
   551     12  ER-0008                 PIC X(4)  VALUE '0008'.
   552     12  ER-0019                 PIC X(4)  VALUE '0019'.
   553     12  ER-0029                 PIC X(4)  VALUE '0029'.
   554     12  ER-0042                 PIC X(4)  VALUE '0042'.
   555     12  ER-0070                 PIC X(4)  VALUE '0070'.
   556     12  ER-0130                 PIC X(4)  VALUE '0130'.
   557     12  ER-0149                 PIC X(4)  VALUE '0149'.
   558     12  ER-0154                 PIC X(4)  VALUE '0154'.
   559     12  ER-0168                 PIC X(4)  VALUE '0168'.
   560     12  ER-0169                 PIC X(4)  VALUE '0169'.
   561     12  ER-0172                 PIC X(4)  VALUE '0174'.
   562     12  ER-0198                 PIC X(4)  VALUE '0198'.
   563     12  ER-0204                 PIC X(4)  VALUE '0204'.
   564     12  ER-0206                 PIC X(4)  VALUE '0206'.
   565     12  ER-0252                 PIC X(4)  VALUE '0252'.
   566     12  ER-0254                 PIC X(4)  VALUE '0254'.
   567     12  ER-0282                 PIC X(4)  VALUE '0282'.
   568     12  ER-0283                 PIC X(4)  VALUE '0283'.
   569     12  ER-0294                 PIC X(4)  VALUE '0294'.
   570     12  ER-0338                 PIC X(4)  VALUE '0338'.
   571     12  ER-0419                 PIC X(4)  VALUE '0419'.
   572     12  ER-0420                 PIC X(4)  VALUE '0420'.
   573     12  ER-0421                 PIC X(4)  VALUE '0421'.
   574     12  ER-0422                 PIC X(4)  VALUE '0422'.
   575     12  ER-0433                 PIC X(4)  VALUE '0433'.
   576     12  ER-0436                 PIC X(4)  VALUE '0436'.
   577     12  ER-0437                 PIC X(4)  VALUE '0437'.
   578     12  ER-0438                 PIC X(4)  VALUE '0438'.
   579     12  ER-0439                 PIC X(4)  VALUE '0439'.
   580     12  ER-0440                 PIC X(4)  VALUE '0440'.
   581     12  ER-0441                 PIC X(4)  VALUE '0441'.
   582     12  ER-0442                 PIC X(4)  VALUE '0442'.
   583     12  ER-0443                 PIC X(4)  VALUE '0443'.
   584     12  ER-0444                 PIC X(4)  VALUE '0444'.
   585     12  ER-0445                 PIC X(4)  VALUE '0445'.
   586     12  ER-0446                 PIC X(4)  VALUE '0446'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  12
* EL156.cbl
   587     12  ER-0447                 PIC X(4)  VALUE '0447'.
   588     12  ER-0448                 PIC X(4)  VALUE '0448'.
   589     12  ER-0449                 PIC X(4)  VALUE '0449'.
   590     12  ER-0452                 PIC X(4)  VALUE '0452'.
   591     12  ER-0458                 PIC X(4)  VALUE '0458'.
   592     12  ER-0459                 PIC X(4)  VALUE '0459'.
   593     12  ER-0460                 PIC X(4)  VALUE '0460'.
   594     12  ER-0461                 PIC X(4)  VALUE '0461'.
   595     12  ER-0462                 PIC X(4)  VALUE '0462'.
   596     12  ER-0463                 PIC X(4)  VALUE '0463'.
   597     12  ER-0464                 PIC X(4)  VALUE '0464'.
   598     12  ER-0465                 PIC X(4)  VALUE '0465'.
   599     12  ER-0466                 PIC X(4)  VALUE '0466'.
   600     12  ER-0467                 PIC X(4)  VALUE '0467'.
   601     12  ER-0468                 PIC X(4)  VALUE '0468'.
   602     12  ER-0469                 PIC X(4)  VALUE '0469'.
   603     12  ER-0473                 PIC X(4)  VALUE '0473'.
   604     12  ER-0474                 PIC X(4)  VALUE '0474'.
   605     12  ER-0475                 PIC X(4)  VALUE '0475'.
   606     12  ER-0476                 PIC X(4)  VALUE '0476'.
   607     12  ER-0477                 PIC X(4)  VALUE '0477'.
   608     12  ER-0478                 PIC X(4)  VALUE '0478'.
   609     12  ER-0479                 PIC X(4)  VALUE '0479'.
   610     12  ER-0481                 PIC X(4)  VALUE '0481'.
   611     12  ER-0491                 PIC X(4)  VALUE '0491'.
   612     12  ER-0492                 PIC X(4)  VALUE '0492'.
   613     12  ER-0493                 PIC X(4)  VALUE '0493'.
   614     12  ER-0494                 PIC X(4)  VALUE '0494'.
   615     12  ER-0495                 PIC X(4)  VALUE '0495'.
   616     12  ER-0499                 PIC X(4)  VALUE '0499'.
   617     12  ER-0500                 PIC X(4)  VALUE '0500'.
   618     12  ER-0501                 PIC X(4)  VALUE '0501'.
   619     12  ER-0502                 PIC X(4)  VALUE '0502'.
   620     12  ER-0508                 PIC X(4)  VALUE '0508'.
   621     12  ER-0513                 PIC X(4)  VALUE '0513'.
   622     12  ER-0518                 PIC X(4)  VALUE '0518'.
   623     12  ER-0524                 PIC X(4)  VALUE '0524'.
   624     12  ER-0525                 PIC X(4)  VALUE '0525'.
   625     12  ER-0526                 PIC X(4)  VALUE '0526'.
   626     12  ER-0530                 PIC X(4)  VALUE '0530'.
   627     12  ER-0540                 PIC X(4)  VALUE '0540'.
   628     12  ER-0541                 PIC X(4)  VALUE '0541'.
   629     12  ER-0542                 PIC X(4)  VALUE '0542'.
   630     12  ER-0543                 PIC X(4)  VALUE '0543'.
   631     12  ER-0545                 PIC X(4)  VALUE '0545'.
   632     12  ER-0552                 PIC X(4)  VALUE '0552'.
   633     12  ER-0555                 PIC X(4)  VALUE '0555'.
   634     12  ER-0556                 PIC X(4)  VALUE '0556'.
   635     12  ER-0557                 PIC X(4)  VALUE '0557'.
   636     12  ER-0572                 PIC X(4)  VALUE '0572'.
   637     12  ER-0573                 PIC X(4)  VALUE '0573'.
   638     12  ER-0594                 PIC X(4)  VALUE '0594'.
   639     12  ER-0616                 PIC X(4)  VALUE '0616'.
   640     12  ER-0617                 PIC X(4)  VALUE '0617'.
   641     12  ER-0618                 PIC X(4)  VALUE '0618'.
   642     12  ER-0657                 PIC X(4)  VALUE '0657'.
   643     12  ER-0658                 PIC X(4)  VALUE '0658'.
   644     12  ER-0699                 PIC X(4)  VALUE '0699'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  13
* EL156.cbl
   645     12  ER-0730                 PIC X(4)  VALUE '0730'.
   646     12  ER-0737                 PIC X(4)  VALUE '0737'.
   647     12  ER-0760                 PIC X(4)  VALUE '0760'.
   648     12  ER-0768                 PIC X(4)  VALUE '0768'.
   649     12  ER-0769                 PIC X(4)  VALUE '0769'.
   650     12  ER-0770                 PIC X(4)  VALUE '0770'.
   651     12  ER-0802                 PIC X(4)  VALUE '0802'.
   652     12  ER-0803                 PIC X(4)  VALUE '0803'.
   653     12  ER-0819                 PIC X(4)  VALUE '0819'.
   654     12  ER-0834                 PIC X(4)  VALUE '0834'.
   655     12  ER-0836                 PIC X(4)  VALUE '0836'.
   656     12  ER-0844                 PIC X(4)  VALUE '0844'.
   657     12  ER-0845                 PIC X(4)  VALUE '0845'.
   658     12  ER-0846                 PIC X(4)  VALUE '0846'.
   659     12  ER-0849                 PIC X(4)  VALUE '0849'.
   660     12  ER-0851                 PIC X(4)  VALUE '0851'.
   661     12  ER-0872                 PIC X(4)  VALUE '0872'.
   662     12  ER-0873                 PIC X(4)  VALUE '0873'.
   663     12  ER-0874                 PIC X(4)  VALUE '0874'.
   664     12  ER-0879                 PIC X(4)  VALUE '0879'.
   665     12  ER-0919                 PIC X(4)  VALUE '0919'.
   666     12  ER-0921                 PIC X(4)  VALUE '0921'.
   667     12  ER-0923                 PIC X(4)  VALUE '0923'.
   668     12  ER-0925                 PIC X(4)  VALUE '0925'.
   669     12  ER-0944                 PIC X(4)  VALUE '0944'.
   670     12  ER-0945                 PIC X(4)  VALUE '0945'.
   671     12  ER-0946                 PIC X(4)  VALUE '0946'.
   672     12  ER-0947                 PIC X(4)  VALUE '0947'.
   673     12  ER-0948                 PIC X(4)  VALUE '0948'.
   674     12  ER-0949                 PIC X(4)  VALUE '0949'.
   675     12  ER-0950                 PIC X(4)  VALUE '0950'.
   676     12  ER-0951                 PIC X(4)  VALUE '0951'.
   677     12  ER-0954                 PIC X(4)  VALUE '0954'.
   678     12  ER-0956                 PIC X(4)  VALUE '0956'.
   679     12  ER-0967                 PIC X(4)  VALUE '0967'.
   680     12  ER-0968                 PIC X(4)  VALUE '0968'.
   681     12  ER-0974                 PIC X(4)  VALUE '0974'.
   682     12  ER-0975                 PIC X(4)  VALUE '0975'.
   683     12  ER-1561                 PIC X(4)  VALUE '1561'.
   684     12  ER-1566                 PIC X(4)  VALUE '1566'.
   685     12  ER-1567                 PIC X(4)  VALUE '1567'.
   686     12  ER-1569                 PIC X(4)  VALUE '1569'.
   687     12  er-1582                 pic x(4)  value '1582'.
   688     12  er-1657                 pic x(4)  value '1657'.
   689     12  er-1658                 pic x(4)  value '1658'.
   690     12  er-1667                 pic x(4)  value '1667'.
   691     12  er-1670                 pic x(4)  value '1670'.
   692     12  er-1671                 pic x(4)  value '1671'.
   693     12  er-1672                 pic x(4)  value '1672'.
   694     12  er-1673                 pic x(4)  value '1673'.
   695     12  er-1674                 pic x(4)  value '1674'.
   696     12  er-1677                 pic x(4)  value '1677'.
   697     12  ER-1775                 PIC X(4)  VALUE '1775'.
   698     12  ER-1880                 PIC X(4)  VALUE '1880'.
   699     12  ER-2044                 PIC X(4)  VALUE '2044'.
   700     12  ER-3140                 PIC X(4)  VALUE '3140'.
   701     12  ER-3141                 PIC X(4)  VALUE '3141'.
   702     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  14
* EL156.cbl
   703     12  ER-3516                 PIC X(4)  VALUE '3516'.
   704     12  ER-3527                 PIC X(4)  VALUE '3527'.
   705     12  ER-3528                 PIC X(4)  VALUE '3528'.
   706     12  ER-3529                 PIC X(4)  VALUE '3529'.
   707     12  ER-3530                 PIC X(4)  VALUE '3530'.
   708     12  ER-3531                 PIC X(4)  VALUE '3531'.
   709     12  ER-3532                 PIC X(4)  VALUE '3532'.
   710     12  ER-3533                 PIC X(4)  VALUE '3533'.
   711     12  ER-3534                 PIC X(4)  VALUE '3534'.
   712     12  ER-3535                 PIC X(4)  VALUE '3535'.
   713     12  ER-3536                 PIC X(4)  VALUE '3536'.
   714     12  ER-3537                 PIC X(4)  VALUE '3537'.
   715     12  ER-3538                 PIC X(4)  VALUE '3538'.
   716     12  ER-3539                 PIC X(4)  VALUE '3539'.
   717     12  ER-3540                 PIC X(4)  VALUE '3540'.
   718     12  ER-3541                 PIC X(4)  VALUE '3541'.
   719     12  ER-3542                 PIC X(4)  VALUE '3542'.
   720     12  ER-3543                 PIC X(4)  VALUE '3543'.
   721     12  ER-3546                 PIC X(4)  VALUE '3546'.
   722     12  ER-3549                 PIC X(4)  VALUE '3549'.
   723     12  ER-3818                 PIC X(4)  VALUE '3818'.
   724     12  ER-7540                 PIC X(4)  VALUE '7540'.
   725     12  ER-7576                 PIC X(4)  VALUE '7576'.
   726     12  ER-7579                 PIC X(4)  VALUE '7579'.
   727     12  ER-7580                 PIC X(4)  VALUE '7580'.
   728     12  ER-7583                 PIC X(4)  VALUE '7583'.
   729     12  ER-7830                 PIC X(4)  VALUE '7830'.
   730     12  ER-7831                 PIC X(4)  VALUE '7831'.
   731     12  ER-7832                 PIC X(4)  VALUE '7832'.
   732     12  ER-7833                 PIC X(4)  VALUE '7833'.
   733     12  ER-7834                 PIC X(4)  VALUE '7834'.
   734     12  ER-7835                 PIC X(4)  VALUE '7835'.
   735     12  ER-7836                 PIC X(4)  VALUE '7836'.
   736     12  ER-7837                 PIC X(4)  VALUE '7837'.
   737     12  ER-7838                 PIC X(4)  VALUE '7838'.
   738     12  ER-7841                 PIC X(4)  VALUE '7841'.
   739     12  ER-7844                 PIC X(4)  VALUE '7844'.
   740     12  ER-7845                 PIC X(4)  VALUE '7845'.
   741     12  ER-8000                 PIC X(4)  VALUE '8000'.
   742     12  ER-8051                 PIC X(4)  VALUE '8051'.
   743     12  ER-8052                 PIC X(4)  VALUE '8052'.
   744     12  ER-8053                 PIC X(4)  VALUE '8053'.
   745     12  ER-8054                 PIC X(4)  VALUE '8054'.
   746     12  ER-8055                 PIC X(4)  VALUE '8055'.
   747     12  ER-8056                 PIC X(4)  VALUE '8056'.
   748     12  ER-8057                 PIC X(4)  VALUE '8057'.
   749     12  ER-8058                 PIC X(4)  VALUE '8058'.
   750     12  ER-8059                 PIC X(4)  VALUE '8059'.
   751     12  ER-8060                 PIC X(4)  VALUE '8060'.
   752     12  ER-8061                 PIC X(4)  VALUE '8061'.
   753     12  ER-8062                 PIC X(4)  VALUE '8062'.
   754     12  ER-8063                 PIC X(4)  VALUE '8063'.
   755     12  ER-8064                 PIC X(4)  VALUE '8064'.
   756     12  ER-8065                 PIC X(4)  VALUE '8065'.
   757     12  ER-8066                 PIC X(4)  VALUE '8066'.
   758     12  ER-8146                 PIC X(4)  VALUE '8146'.
   759     12  ER-8147                 PIC X(4)  VALUE '8147'.
   760     12  ER-8152                 PIC X(4)  VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  15
* EL156.cbl
   761     12  ER-8153                 PIC X(4)  VALUE '8153'.
   762     12  ER-8154                 PIC X(4)  VALUE '8154'.
   763     12  ER-8155                 PIC X(4)  VALUE '8155'.
   764     12  ER-8310                 PIC X(4)  VALUE '8310'.
   765     12  ER-8311                 PIC X(4)  VALUE '8311'.
   766     12  ER-8312                 PIC X(4)  VALUE '8312'.
   767     12  ER-8313                 PIC X(4)  VALUE '8313'.
   768     12  ER-8314                 PIC X(4)  VALUE '8314'.
   769     12  ER-8315                 PIC X(4)  VALUE '8315'.
   770     12  ER-8316                 PIC X(4)  VALUE '8316'.
   771     12  ER-8317                 PIC X(4)  VALUE '8317'.
   772
   773 01  CSO-WORK-FIELDS.
   774     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   775       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   776
   777     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   778     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   779         88  CERT-NOTE-ADDED           VALUE 'Y'.
   780     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   781         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   782     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   783
   784     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   785
   786 01  SC-NP6-CERT-NOTE.
   787     12  FILLER                  PIC X(12)
   788               VALUE 'REM BENEFIT '.
   789     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   790     12  SC-NP6-COMM             PIC X(8)
   791               VALUE ' + 6 MO '.
   792     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   793     12  FILLER                  PIC X(12)
   794               VALUE ' = AMT PAID '.
   795     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   796
   797 01  SC-NP6-ORIG-NOTE.
   798     12  FILLER                  PIC X(63)  VALUE
   799         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   800 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   801     88  PDEF-FOUND                   VALUE 'Y'.
   802 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   803     88  ACCT-FOUND                   VALUE 'Y'.
   804 01  CTBL-KEY-SAVE               PIC X(5).
   805 01  CTBL-KEY.
   806     05  CTBL-COMPANY-CD         PIC X.
   807     05  CTBL-TABLE              PIC XXX.
   808     05  CTBL-BEN-TYPE           PIC X.
   809     05  CTBL-BEN-CODE           PIC XX.
   810 01  ERPDEF-KEY-SAVE             PIC X(18).
   811 01  ERPDEF-KEY.
   812     12  ERPDEF-COMPANY-CD       PIC X.
   813     12  ERPDEF-STATE            PIC XX.
   814     12  ERPDEF-PROD-CD          PIC XXX.
   815     12  F                       PIC X(7).
   816     12  ERPDEF-BEN-TYPE         PIC X.
   817     12  ERPDEF-BEN-CODE         PIC XX.
   818     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  16
* EL156.cbl
   819 01  ELCRTT-KEY.
   820     05  CTRLR-COMP-CD       PIC X.
   821     05  CTRLR-CARRIER       PIC X.
   822     05  CTRLR-GROUPING      PIC X(6).
   823     05  CTRLR-STATE         PIC X(2).
   824     05  CTRLR-ACCOUNT       PIC X(10).
   825     05  CTRLR-EFF-DT        PIC XX.
   826     05  CTRLR-CERT-NO       PIC X(11).
   827     05  CTRLR-REC-TYPE      PIC X.
   828 01  ACCESS-KEYS.
   829     12  ELARCH-KEY.
   830         16  ARCH-CO             PIC X.
   831         16  ARCH-NUMBER         PIC S9(08) COMP.
   832         16  ARCH-REC-TYPE       PIC X.
   833         16  ARCH-SEQ            PIC S9(04) COMP.
   834     12  ELMSTR-KEY.
   835         16  MSTR-COMP-CD        PIC X.
   836         16  MSTR-CARRIER        PIC X.
   837         16  MSTR-CLAIM-NO       PIC X(7).
   838         16  MSTR-CERT-NO        PIC X(11).
   839     12  ELCNTL-KEY.
   840         16  CNTL-COMP-ID        PIC X(3).
   841         16  CNTL-REC-TYPE       PIC X.
   842         16  CNTL-ACCESS         PIC X(4).
   843         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   844     12  ELCERT-KEY.
   845         16  CERT-COMP-CD        PIC X.
   846         16  CERT-CARRIER        PIC X.
   847         16  CERT-GROUPING       PIC X(6).
   848         16  CERT-STATE          PIC XX.
   849         16  CERT-ACCOUNT        PIC X(10).
   850         16  CERT-EFF-DT         PIC XX.
   851         16  CERT-CERT-NO        PIC X(11).
   852     12  ELTRLR-KEY.
   853         16  TRLR-COMP-CD        PIC X.
   854         16  TRLR-CARRIER        PIC X.
   855         16  TRLR-CLAIM-NO       PIC X(7).
   856         16  TRLR-CERT-NO        PIC X(11).
   857         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   858     12  ELACTQ-KEY.
   859         16  ACTQ-COMP-CD        PIC X.
   860         16  ACTQ-CARRIER        PIC X.
   861         16  ACTQ-CLAIM-NO       PIC X(7).
   862         16  ACTQ-CERT-NO        PIC X(11).
   863     12  W-NOTE-KEY.
   864         16  W-NOTE-COMP-CD      PIC X.
   865         16  W-NOTE-CERT-KEY.
   866             20  W-NOTE-CARRIER  PIC X.
   867             20  W-NOTE-GROUPING PIC X(6).
   868             20  W-NOTE-STATE    PIC XX.
   869             20  W-NOTE-ACCOUNT  PIC X(10).
   870             20  W-NOTE-EFF-DT   PIC XX.
   871             20  W-NOTE-CERT-NO  PIC X(11).
   872     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   873     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   874     12  ERACCT-KEY.
   875         16  ERACCT-PARTIAL-KEY.
   876             20  ACCT-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  17
* EL156.cbl
   877             20  ACCT-CARRIER    PIC X.
   878             20  ACCT-GROUPING   PIC X(6).
   879             20  ACCT-STATE      PIC XX.
   880             20  ACCT-ACCOUNT    PIC X(10).
   881         16  ACCT-EXP-DT         PIC XX.
   882         16  FILLER              PIC X(4) VALUE SPACES.
   883     12  ELCHKQ-KEY.
   884         16  CHKQ-COMP-CD        PIC X.
   885         16  CHKQ-CONTROL        PIC S9(8) COMP.
   886         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   887     12  ELBENE-KEY.
   888         16  BENE-COMP-CD         PIC X.
   889         16  BENE-RECORD-TYPE     PIC X.
   890         16  BENE-NUMBER          PIC X(10).
   891     12  ERCOMP-KEY.
   892         16  COMP-COMP-CD        PIC X.
   893         16  COMP-CARRIER        PIC X.
   894         16  COMP-GROUP          PIC X(06).
   895         16  COMP-FIN-RESP       PIC X(10).
   896         16  COMP-ACCOUNT        PIC X(10).
   897         16  COMP-TYPE           PIC X.
   898
   899     12  DLO035-KEY.
   900         16  DL35-PROCESS-TYPE   PIC X.
   901         16  DL35-CREDIT-CARD    PIC X(20).
   902         16  DL35-BEN-TYPE       PIC XX.
   903         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   904         16  DL35-RETURN-CODE    PIC XX.
   905
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  18
* EL156.cbl
   907*    COPY ELCDATE.
   908******************************************************************
   909*                                                                *
   910*                                                                *
   911*                            ELCDATE.                            *
   912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   913*                            VMOD=2.003
   914*                                                                *
   915*                                                                *
   916*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   917*                 LENGTH = 200                                   *
   918******************************************************************
   919
   920 01  DATE-CONVERSION-DATA.
   921     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   922     12  DC-OPTION-CODE                PIC X.
   923         88  BIN-TO-GREG                VALUE ' '.
   924         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   925         88  EDIT-GREG-TO-BIN           VALUE '2'.
   926         88  YMD-GREG-TO-BIN            VALUE '3'.
   927         88  MDY-GREG-TO-BIN            VALUE '4'.
   928         88  JULIAN-TO-BIN              VALUE '5'.
   929         88  BIN-PLUS-ELAPSED           VALUE '6'.
   930         88  FIND-CENTURY               VALUE '7'.
   931         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   932         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   933         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   934         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   935         88  JULIAN-TO-BIN-3            VALUE 'C'.
   936         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   937         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   938         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   939         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   940         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   941         88  CHECK-LEAP-YEAR            VALUE 'H'.
   942         88  BIN-3-TO-GREG              VALUE 'I'.
   943         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   944         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   945         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   946         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   947         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   948         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   949         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   950         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   951         88  THREE-CHARACTER-BIN
   952                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   953         88  GREGORIAN-TO-BIN
   954                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   955         88  BIN-TO-GREGORIAN
   956                  VALUES ' ' '1' 'I' '8' 'G'.
   957         88  JULIAN-TO-BINARY
   958                  VALUES '5' 'C' 'E' 'F'.
   959     12  DC-ERROR-CODE                 PIC X.
   960         88  NO-CONVERSION-ERROR        VALUE ' '.
   961         88  DATE-CONVERSION-ERROR
   962                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   963         88  DATE-IS-ZERO               VALUE '1'.
   964         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  19
* EL156.cbl
   965         88  DATE-IS-INVALID            VALUE '3'.
   966         88  DATE1-GREATER-DATE2        VALUE '4'.
   967         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   968         88  DATE-INVALID-OPTION        VALUE '9'.
   969         88  INVALID-CENTURY            VALUE 'A'.
   970         88  ONLY-CENTURY               VALUE 'B'.
   971         88  ONLY-LEAP-YEAR             VALUE 'C'.
   972         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   973     12  DC-END-OF-MONTH               PIC X.
   974         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   975     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   976         88  USE-NORMAL-PROCESS         VALUE ' '.
   977         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   978         88  ADJUST-UP-100-YRS          VALUE '2'.
   979     12  FILLER                        PIC X.
   980     12  DC-CONVERSION-DATES.
   981         16  DC-BIN-DATE-1             PIC XX.
   982         16  DC-BIN-DATE-2             PIC XX.
   983         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   984         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   985                       DC-GREG-DATE-1-EDIT.
   986             20  DC-EDIT1-MONTH        PIC 99.
   987             20  SLASH1-1              PIC X.
   988             20  DC-EDIT1-DAY          PIC 99.
   989             20  SLASH1-2              PIC X.
   990             20  DC-EDIT1-YEAR         PIC 99.
   991         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   992         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   993                     DC-GREG-DATE-2-EDIT.
   994             20  DC-EDIT2-MONTH        PIC 99.
   995             20  SLASH2-1              PIC X.
   996             20  DC-EDIT2-DAY          PIC 99.
   997             20  SLASH2-2              PIC X.
   998             20  DC-EDIT2-YEAR         PIC 99.
   999         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1000         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1001                     DC-GREG-DATE-1-YMD.
  1002             20  DC-YMD-YEAR           PIC 99.
  1003             20  DC-YMD-MONTH          PIC 99.
  1004             20  DC-YMD-DAY            PIC 99.
  1005         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1006         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1007                      DC-GREG-DATE-1-MDY.
  1008             20  DC-MDY-MONTH          PIC 99.
  1009             20  DC-MDY-DAY            PIC 99.
  1010             20  DC-MDY-YEAR           PIC 99.
  1011         16  DC-GREG-DATE-1-ALPHA.
  1012             20  DC-ALPHA-MONTH        PIC X(10).
  1013             20  DC-ALPHA-DAY          PIC 99.
  1014             20  FILLER                PIC XX.
  1015             20  DC-ALPHA-CENTURY.
  1016                 24 DC-ALPHA-CEN-N     PIC 99.
  1017             20  DC-ALPHA-YEAR         PIC 99.
  1018         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1019         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1020         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1021         16  DC-JULIAN-DATE            PIC 9(05).
  1022         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  20
* EL156.cbl
  1023                                       PIC 9(05).
  1024         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1025             20  DC-JULIAN-YEAR        PIC 99.
  1026             20  DC-JULIAN-DAYS        PIC 999.
  1027         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1028         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1029         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1030     12  DATE-CONVERSION-VARIBLES.
  1031         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1032         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1033             20  FILLER                PIC 9(3).
  1034             20  HOLD-CEN-1-CCYY.
  1035                 24  HOLD-CEN-1-CC     PIC 99.
  1036                 24  HOLD-CEN-1-YY     PIC 99.
  1037             20  HOLD-CEN-1-MO         PIC 99.
  1038             20  HOLD-CEN-1-DA         PIC 99.
  1039         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1040             20  HOLD-CEN-1-R-MO       PIC 99.
  1041             20  HOLD-CEN-1-R-DA       PIC 99.
  1042             20  HOLD-CEN-1-R-CCYY.
  1043                 24  HOLD-CEN-1-R-CC   PIC 99.
  1044                 24  HOLD-CEN-1-R-YY   PIC 99.
  1045             20  FILLER                PIC 9(3).
  1046         16  HOLD-CENTURY-1-X.
  1047             20  FILLER                PIC X(3)  VALUE SPACES.
  1048             20  HOLD-CEN-1-X-CCYY.
  1049                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1050                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1051             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1052             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1053         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1054             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1055             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1056             20  HOLD-CEN-1-R-X-CCYY.
  1057                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1058                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1059             20  FILLER                PIC XXX.
  1060         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1061         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1062         16  DC-JULIAN-DATE-1          PIC 9(07).
  1063         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1064             20  DC-JULIAN-1-CCYY.
  1065                 24  DC-JULIAN-1-CC    PIC 99.
  1066                 24  DC-JULIAN-1-YR    PIC 99.
  1067             20  DC-JULIAN-DA-1        PIC 999.
  1068         16  DC-JULIAN-DATE-2          PIC 9(07).
  1069         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1070             20  DC-JULIAN-2-CCYY.
  1071                 24  DC-JULIAN-2-CC    PIC 99.
  1072                 24  DC-JULIAN-2-YR    PIC 99.
  1073             20  DC-JULIAN-DA-2        PIC 999.
  1074         16  DC-GREG-DATE-A-EDIT.
  1075             20  DC-EDITA-MONTH        PIC 99.
  1076             20  SLASHA-1              PIC X VALUE '/'.
  1077             20  DC-EDITA-DAY          PIC 99.
  1078             20  SLASHA-2              PIC X VALUE '/'.
  1079             20  DC-EDITA-CCYY.
  1080                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  21
* EL156.cbl
  1081                 24  DC-EDITA-YEAR     PIC 99.
  1082         16  DC-GREG-DATE-B-EDIT.
  1083             20  DC-EDITB-MONTH        PIC 99.
  1084             20  SLASHB-1              PIC X VALUE '/'.
  1085             20  DC-EDITB-DAY          PIC 99.
  1086             20  SLASHB-2              PIC X VALUE '/'.
  1087             20  DC-EDITB-CCYY.
  1088                 24  DC-EDITB-CENT     PIC 99.
  1089                 24  DC-EDITB-YEAR     PIC 99.
  1090         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1091         16  DC-GREG-DATE-CYMD-R REDEFINES
  1092                              DC-GREG-DATE-CYMD.
  1093             20  DC-CYMD-CEN           PIC 99.
  1094             20  DC-CYMD-YEAR          PIC 99.
  1095             20  DC-CYMD-MONTH         PIC 99.
  1096             20  DC-CYMD-DAY           PIC 99.
  1097         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1098         16  DC-GREG-DATE-MDCY-R REDEFINES
  1099                              DC-GREG-DATE-MDCY.
  1100             20  DC-MDCY-MONTH         PIC 99.
  1101             20  DC-MDCY-DAY           PIC 99.
  1102             20  DC-MDCY-CEN           PIC 99.
  1103             20  DC-MDCY-YEAR          PIC 99.
  1104    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1105        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1106    12  DC-EL310-DATE                  PIC X(21).
  1107    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  22
* EL156.cbl
  1109*    COPY ELCLOGOF.
  1110******************************************************************
  1111*                                                                *
  1112*                                                                *
  1113*                            ELCLOGOF.                           *
  1114*                            VMOD=2.001                          *
  1115*                                                                *
  1116*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1117*                                                                *
  1118******************************************************************
  1119 01  CLASIC-LOGOFF.
  1120     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1121     12  LOGOFF-TEXT.
  1122         16  FILLER          PIC X(5)    VALUE SPACES.
  1123         16  LOGOFF-MSG.
  1124             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1125             20  FILLER      PIC X       VALUE SPACES.
  1126             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1127         16  FILLER          PIC X(80)
  1128           VALUE '* YOU ARE NOW LOGGED OFF'.
  1129         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1130         16  FILLER          PIC X       VALUE QUOTE.
  1131         16  LOGOFF-SYS-MSG  PIC X(17)
  1132           VALUE 'S CLAS-IC SYSTEM '.
  1133     12  TEXT-MESSAGES.
  1134         16  UNACCESS-MSG    PIC X(29)
  1135             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1136         16  PGMIDERR-MSG    PIC X(17)
  1137             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  23
* EL156.cbl
  1139*    COPY ELCCALC.
  1140******************************************************************
  1141*                                                                *
  1142*                           ELCCALC.                            *
  1143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1144*                            VMOD=2.025                          *
  1145*                                                                *
  1146*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1147*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1148*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1149*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1150*                                                                *
  1151*  PASSED TO ELRTRM                                              *
  1152*  -----------------                                             *
  1153*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1154*  ORIGINAL TERM                                                 *
  1155*  BEGINNING DATE                                                *
  1156*  ENDING DATE                                                   *
  1157*  COMPANY I.D.                                                  *
  1158*  ACCOUNT MASTER USER FIELD                                     *
  1159*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1160*  FREE LOOK DAYS                                                *
  1161*                                                                *
  1162*  RETURNED FROM ELRTRM                                          *
  1163*  ---------------------                                         *
  1164*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1165*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1166*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1167*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1168*----------------------------------------------------------------*
  1169*  PASSED TO ELRAMT                                              *
  1170*  ----------------                                              *
  1171*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1172*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1173*  ORIGINAL AMOUNT                                               *
  1174*  ALTERNATE BENEFIT (BALLON)                                    *
  1175*  A.P.R. - NET PAY ONLY                                         *
  1176*  METHOD
  1177*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1178*  COMPANY I.D.                                                  *
  1179*  BENEFIT TYPE                                                  *
  1180*                                                                *
  1181*  RETURNED FROM ELRAMT                                          *
  1182*  --------------------                                          *
  1183*  REMAINING AMOUNT 1 - CURRENT                                  *
  1184*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1185*  REMAINING AMOUNT FACTOR
  1186*----------------------------------------------------------------*
  1187*  PASSED TO ELRESV                                              *
  1188*  -----------------                                             *
  1189*  CERTIFICATE EFFECTIVE DATE                                    *
  1190*  VALUATION DATE                                                *
  1191*  PAID THRU DATE                                                *
  1192*  BENEFIT                                                       *
  1193*  INCURRED DATE                                                 *
  1194*  REPORTED DATE                                                 *
  1195*  ISSUE AGE                                                     *
  1196*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  24
* EL156.cbl
  1197*  CDT PERCENT                                                   *
  1198*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1199* *CLAIM TYPE (LIFE, A/H)                                        *
  1200* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1201* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1202*                                                                *
  1203*  RETURNED FROM ELRESV                                          *
  1204*  --------------------                                          *
  1205*  CDT TABLE USED                                                *
  1206*  CDT FACTOR USED                                               *
  1207*  PAY TO CURRENT RESERVE                                        *
  1208*  I.B.N.R. - A/H ONLY                                           *
  1209*  FUTURE (ACCRUED) AH ONLY                                      *
  1210*----------------------------------------------------------------*
  1211*  PASSED TO ELRATE                                              *
  1212*  ----------------                                              *
  1213*  CERT ISSUE DATE                                               *
  1214*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1215*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1216*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1217*  STATE CODE (CLIENT DEFINED)                                   *
  1218*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1219*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1220*  DEVIATION CODE                                                *
  1221*  ISSUE AGE                                                     *
  1222*  ORIGINAL BENEFIT AMOUNT                                       *
  1223*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1224*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1225*  BENEFIT KIND (LIFE OR A/H)                                    *
  1226*  A.P.R.                                                        *
  1227*  METHOD
  1228*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1229*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1230*  COMPANY I.D. (3 CHARACTER)                                    *
  1231*  BENEFIT CODE                                                  *
  1232*  BENEFIT OVERRIDE CODE                                         *
  1233*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1234*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1235*  JOINT INDICATOR (CSL ONLY)                                    *
  1236*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1237*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1238*                                                                *
  1239*  RETURNED FROM ELRATE                                          *
  1240*  --------------------                                          *
  1241*  CALCULATED PREMIUM                                            *
  1242*  PREMIUM RATE                                                  *
  1243*  MORTALITY CODE                                                *
  1244*  MAX ATTAINED AGE                                              *
  1245*  MAX AGE                                                       *
  1246*  MAX TERM                                                      *
  1247*  MAX MONTHLY BENEFIT                                           *
  1248*  MAX TOTAL BENIFIT                                             *
  1249*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1250*----------------------------------------------------------------*
  1251*  PASSED TO ELRFND                                              *
  1252*  ----------------                                              *
  1253*  CERT ISSUE DATE                                               *
  1254*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  25
* EL156.cbl
  1255*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1256*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1257*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1258*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1259*  STATE CODE (CLIENT DEFINED)                                   *
  1260*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1261*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1262*  DEVIATION CODE                                                *
  1263*  ISSUE AGE                                                     *
  1264*  ORIGINAL BENEFIT AMOUNT                                       *
  1265*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1266*  PROCESS TYPE (CANCEL)                                         *
  1267*  BENEFIT KIND (LIFE OR A/H)                                    *
  1268*  A.P.R.                                                        *
  1269*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1270*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1271*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1272*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1273*  COMPANY I.D. (3 CHARACTER)                                    *
  1274*  BENEFIT CODE                                                  *
  1275*  BENEFIT OVERRIDE CODE                                         *
  1276*                                                                *
  1277*  RETURNED FROM ELRFND                                          *
  1278*  --------------------                                          *
  1279*  CALCULATED REFUND                                             *
  1280*----------------------------------------------------------------*
  1281*  PASSED TO ELEARN                                              *
  1282*  ----------------                                              *
  1283*  CERT ISSUE DATE                                               *
  1284*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1285*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1286*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1287*  STATE CODE (CLIENT DEFINED)                                   *
  1288*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1289*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1290*  DEVIATION CODE                                                *
  1291*  ISSUE AGE                                                     *
  1292*  ORIGINAL BENEFIT AMOUNT                                       *
  1293*  BENEFIT KIND (LIFE OR A/H)                                    *
  1294*  A.P.R.                                                        *
  1295*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1296*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1297*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1298*  COMPANY I.D. (3 CHARACTER)                                    *
  1299*  BENEFIT CODE                                                  *
  1300*  BENEFIT OVERRIDE CODE                                         *
  1301*                                                                *
  1302*  RETURNED FROM ELEARN                                          *
  1303*  --------------------                                          *
  1304*  INDICATED  EARNINGS                                           *
  1305*----------------------------------------------------------------*
  1306*                 LENGTH = 450                                   *
  1307*                                                                *
  1308******************************************************************
  1309******************************************************************
  1310*                   C H A N G E   L O G
  1311*
  1312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  26
* EL156.cbl
  1313*-----------------------------------------------------------------
  1314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1315* EFFECTIVE    NUMBER
  1316*-----------------------------------------------------------------
  1317* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1318* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1319* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1320* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1321* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1322* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1323* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1324* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1325* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1326* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1327******************************************************************
  1328
  1329 01  CALCULATION-PASS-AREA.
  1330     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1331                                     COMP.
  1332
  1333     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1334       88  NO-CP-ERROR                             VALUE ZERO.
  1335       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1336                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1337       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1338       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1339       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1340       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1341       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1342       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1343       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1344       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1345       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1346       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1347       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1348       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1349       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1350       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1351       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1352       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1353       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1354
  1355     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1356       88  NO-CP-ERROR-2                           VALUE ZERO.
  1357***********************  INPUT AREAS ****************************
  1358
  1359     12  CP-CALCULATION-AREA.
  1360         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1361         16  CP-CERT-EFF-DT        PIC XX.
  1362         16  CP-VALUATION-DT       PIC XX.
  1363         16  CP-PAID-THRU-DT       PIC XX.
  1364         16  CP-BENEFIT-TYPE       PIC X.
  1365           88  CP-AH                               VALUE 'A' 'D'
  1366                                                   'I' 'U'.
  1367           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1368           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1369         16  CP-INCURRED-DT        PIC XX.
  1370         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  27
* EL156.cbl
  1371         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1372         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1373         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1374                                     COMP-3.
  1375         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1376                                     COMP-3.
  1377         16  CP-CDT-METHOD         PIC X.
  1378           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1379           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1380           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1381         16  CP-CLAIM-TYPE         PIC X.
  1382           88  CP-AH-CLAIM                         VALUE 'A'.
  1383           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1384         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1391                                     COMP-3.
  1392         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1393                                     COMP-3.
  1394         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1395                                     COMP-3.
  1396         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1397                                     COMP-3.
  1398         16  CP-REM-TERM-METHOD    PIC X.
  1399           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1400           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1401           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1402           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1403           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1404           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1405           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1406         16  CP-EARNING-METHOD     PIC X.
  1407           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1408           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1409           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1410           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1411           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1412           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1413           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1414           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1415           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1416           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1417           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1418           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1419           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1420           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1421         16  CP-PROCESS-TYPE       PIC X.
  1422           88  CP-CLAIM                            VALUE '1'.
  1423           88  CP-CANCEL                           VALUE '2'.
  1424           88  CP-ISSUE                            VALUE '3'.
  1425         16  CP-SPECIAL-CALC-CD    PIC X.
  1426           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1427           88  CP-1-MTH-INTEREST               VALUE ' '.
  1428           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  28
* EL156.cbl
  1429           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1430           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1431           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1432           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1433           88  CP-FARM-PLAN                    VALUE 'F'.
  1434           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1435           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1436           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1437           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1438           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1439           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1440           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1441           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1442           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1443           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1444                                                     'W' 'X'.
  1445           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1446           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1447           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1448           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1449           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1450           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1451           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1452           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1453           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1454           88  CP-CSL-METH-1                   VALUE '5'.
  1455           88  CP-CSL-METH-2                   VALUE '6'.
  1456           88  CP-CSL-METH-3                   VALUE '7'.
  1457           88  CP-CSL-METH-4                   VALUE '8'.
  1458
  1459         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1460                                     COMP-3.
  1461         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1462         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1463         16  CP-STATE              PIC XX          VALUE SPACE.
  1464         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1465         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1466           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1467               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1468         16  CP-R78-OPTION         PIC X.
  1469           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1470           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1471
  1472         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1473         16  CP-IBNR-RESERVE-SW    PIC X.
  1474         16  CP-CLAIM-STATUS       PIC X.
  1475         16  CP-RATE-FILE          PIC X.
  1476         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1477                                     COMP-3.
  1478
  1479         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1480         16  CP-AH-OVERRIDE-CODE   PIC X.
  1481
  1482         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1483                                     COMP-3.
  1484         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1485                                   PIC S9(5)V99 COMP-3.
  1486         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  29
* EL156.cbl
  1487                                     COMP-3.
  1488         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1489                                     COMP-3.
  1490         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1491                                     COMP-3.
  1492         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1493                                  PIC S9(7)V99 COMP-3.
  1494
  1495         16  CP-PAID-FROM-DATE     PIC X(02).
  1496         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1497         16  CP-EXT-DAYS-CALC      PIC X.
  1498           88  CP-EXT-NO-CHG                   VALUE ' '.
  1499           88  CP-EXT-CHG-LF                   VALUE '1'.
  1500           88  CP-EXT-CHG-AH                   VALUE '2'.
  1501           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1502         16  CP-DOMICILE-STATE     PIC XX.
  1503         16  CP-CARRIER            PIC X.
  1504         16  CP-REIN-FLAG          PIC X.
  1505         16  CP-REM-TRM-CALC-OPTION PIC X.
  1506           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1507                      '2' '3' '4' '5'.
  1508           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1509           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1510           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1511           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1512           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1513           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1514           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1515           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1516         16  CP-SIG-SWITCH         PIC X.
  1517         16  CP-RATING-METHOD      PIC X.
  1518           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1519           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1520           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1521           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1522           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1523           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1524           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1525           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1526           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1527         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1528                                     COMP-3.
  1529         16  CP-BEN-CATEGORY       PIC X.
  1530         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1531         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1532                                   PIC S99V9(5) COMP-3.
  1533         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1534         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1535                                   PIC S99V9(5) COMP-3.
  1536         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1537         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1538         16  CP-EXPIRE-DT          PIC XX.
  1539         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1540         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1541         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1542         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1543         16  CP-DDF-SPEC-CALC      PIC X.
  1544             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  30
* EL156.cbl
  1545             88  CP-CALC-CLP              VALUE 'C'.
  1546         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1547         16  CP-CANCEL-REASON      PIC X.
  1548         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1549         16  CP-PMT-MODE           PIC X.
  1550         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1551         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1552         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1553         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1554         16  FILLER                PIC X.
  1555
  1556***************    OUTPUT FROM ELRESV   ************************
  1557
  1558         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1559
  1560         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1561                                     COMP-3.
  1562         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1563                                     COMP-3.
  1564         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1565                                     COMP-3.
  1566         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1567                                     COMP-3.
  1568         16  FILLER                PIC X(09).
  1569***************    OUTPUT FROM ELRTRM   *************************
  1570
  1571         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1572                                     COMP-3.
  1573         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1576                                     COMP-3.
  1577         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1578                                     COMP-3.
  1579         16  FILLER                PIC X(12).
  1580
  1581***************    OUTPUT FROM ELRAMT   *************************
  1582
  1583         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1584                                     COMP-3.
  1585         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1586                                     COMP-3.
  1587         16  FILLER                PIC X(12).
  1588
  1589***************    OUTPUT FROM ELRATE   *************************
  1590
  1591         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1592                                     COMP-3.
  1593         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1594                                     COMP-3.
  1595         16  CP-MORTALITY-CODE     PIC X(4).
  1596         16  CP-RATE-EDIT-FLAG     PIC X.
  1597             88  CP-RATES-NEED-APR                  VALUE '1'.
  1598         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1599                                     COMP-3.
  1600         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1601         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1602         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  31
* EL156.cbl
  1603                                   PIC S9(7)V99 COMP-3.
  1604         16  FILLER                PIC X(07).
  1605
  1606***************    OUTPUT FROM ELRFND   *************************
  1607
  1608         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1609                                     COMP-3.
  1610         16  CP-REFUND-TYPE-USED   PIC X.
  1611           88  CP-R-AS-R78                         VALUE '1'.
  1612           88  CP-R-AS-PRORATA                     VALUE '2'.
  1613           88  CP-R-AS-CALIF                       VALUE '3'.
  1614           88  CP-R-AS-TEXAS                       VALUE '4'.
  1615           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1616           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1617           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1618           88  CP-R-AS-MEAN                        VALUE '8'.
  1619           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1620           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1621           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1622           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1623           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1624           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1625         16  FILLER                PIC X(12).
  1626
  1627***************    OUTPUT FROM ELEARN   *************************
  1628
  1629         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1636                                     COMP-3.
  1637         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1638                                     COMP-3.
  1639         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1640                                     COMP-3.
  1641         16  CP-EARNING-TYPE-USED  PIC X.
  1642           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1643           88  CP-E-AS-R78                         VALUE '1'.
  1644           88  CP-E-AS-PRORATA                     VALUE '2'.
  1645           88  CP-E-AS-TEXAS                       VALUE '4'.
  1646           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1647           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1648           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1649           88  CP-E-AS-MEAN                        VALUE '8'.
  1650           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1651         16  FILLER                PIC X(12).
  1652
  1653***************    OUTPUT FROM ELPMNT   *************************
  1654
  1655         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1656                                     COMP-3.
  1657         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1658                                     COMP-3.
  1659         16  FILLER                PIC X(12).
  1660
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  32
* EL156.cbl
  1661***************   MISC WORK AREAS    *****************************
  1662         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1663                                     COMP-3.
  1664         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1671                                     COMP-3.
  1672         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1673                                     COMP-3.
  1674         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1675             88  OPEN-RATE-FILE                   VALUE 'O'.
  1676             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1677             88  IO-ERROR                         VALUE 'E'.
  1678
  1679         16  CP-FIRST-PAY-DATE     PIC XX.
  1680
  1681         16  CP-JOINT-INDICATOR    PIC X.
  1682
  1683         16  CP-RESERVE-REMAINING-TERM
  1684                                   PIC S9(4)V9    VALUE ZERO
  1685                                     COMP-3.
  1686
  1687         16  CP-INSURED-BIRTH-DT   PIC XX.
  1688
  1689         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1690                                     COMP-3.
  1691
  1692         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1693                                     COMP-3.
  1694
  1695         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1696                                     COMP-3.
  1697
  1698         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1699                                     COMP-3.
  1700
  1701         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1702                                     COMP-3.
  1703
  1704         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1705                                     COMP-3.
  1706
  1707         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1708                                     COMP-3.
  1709
  1710         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1711             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1712
  1713         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1714                                     COMP-3.
  1715         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1716                                     COMP-3.
  1717         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1718         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  33
* EL156.cbl
  1719         16  cp-net-only-state     pic x value spaces.
  1720         16  FILLER                PIC X(13).
  1721******************************************************************
  1722*    COPY ELCICALC.
  1723******************************************************************
  1724*                                                                *
  1725*                           ELCCICALC.                           *
  1726*                            VMOD=2.001                          *
  1727*                                                                *
  1728*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1729*                 CALCULATION MODULE                             *
  1730*                                                                *
  1731*  PASSED TO ELCLMI                                              *
  1732*  -----------------                                             *
  1733*  STATE                                                         *
  1734*  PRODUCT                                                       *
  1735*  COVERAGE                                                      *
  1736*  EFFECTIVE DATE                                                *
  1737*  INCURRED DATE                                                 *
  1738*  ESTABLISHED DATE                                              *
  1739*  LAST PAID DATE                                                *
  1740*  REPORTED DATE                                                 *
  1741*  CLAIM PAYMENT AMOUNT                                          *
  1742*                                                                *
  1743*  RETURNED FROM ELRTRM                                          *
  1744*  ---------------------                                         *
  1745*  RETURN CODE                                                   *
  1746*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1747*  CLAIM INTEREST AMOUNT                                         *
  1748*----------------------------------------------------------------*
  1749*----------------------------------------------------------------*
  1750*                 LENGTH = 100                                   *
  1751*                                                                *
  1752******************************************************************
  1753******************************************************************
  1754*                   C H A N G E   L O G
  1755*
  1756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1757*-----------------------------------------------------------------
  1758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1759* EFFECTIVE    NUMBER
  1760*-----------------------------------------------------------------
  1761* 120905    2004040700004  PEMA  NEW COPYBOOK
  1762* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1763******************************************************************
  1764
  1765 01  CLAIM-INT-PASS-AREA.
  1766     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1767                                     COMP.
  1768
  1769     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1770       88  NO-CI-ERROR                             VALUE ZERO.
  1771       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1772       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1773       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1774       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1775       88  CP-AMT-LT-5000                          VALUE '4'.
  1776       88  CP-ERROR-IN-DATES                       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  34
* EL156.cbl
  1777       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1778       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1779       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1780***********************  INPUT AREAS ****************************
  1781
  1782     12  CP-CALCULATION-AREA.
  1783         16  CP-COMPANY-CD         PIC X.
  1784         16  CP-STATE              PIC XX.
  1785         16  CP-PRODUCT            PIC XX.
  1786         16  CP-COVERAGE           PIC XX.
  1787         16  CP-INC-DT             PIC XX.
  1788         16  CP-EST-DT             PIC XX.
  1789         16  CP-LSTPD-DT           PIC XX.
  1790         16  CP-RPT-DT             PIC XX.
  1791         16  CP-PRF-DT             PIC XX.
  1792         16  CP-EFF-DT             PIC XX.
  1793         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1794         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1795         16  FILLER                PIC X(37).
  1796
  1797***************    OUTPUT FROM ELCLMI   ************************
  1798
  1799         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1800
  1801         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1802         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1803         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1804         16  FILLER                PIC X(19).
  1805******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  35
* EL156.cbl
  1807*    COPY ELCATTR.
  1808******************************************************************
  1809*                                                                *
  1810*                            ELCATTR.                            *
  1811*                            VMOD=2.001                          *
  1812*                                                                *
  1813*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1814*                                                                *
  1815*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1816*                                                                *
  1817*                   POS 1   P=PROTECTED                          *
  1818*                           U=UNPROTECTED                        *
  1819*                           S=ASKIP                              *
  1820*                   POS 2   A=ALPHA/NUMERIC                      *
  1821*                           N=NUMERIC                            *
  1822*                   POS 3   N=NORMAL                             *
  1823*                           B=BRIGHT                             *
  1824*                           D=DARK                               *
  1825*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1826*                           OF=MODIFIED DATA TAG OFF             *
  1827*                                                                *
  1828*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1829******************************************************************
  1830 01  ATTRIBUTE-LIST.
  1831     12  AL-PABOF            PIC X       VALUE 'Y'.
  1832     12  AL-PABON            PIC X       VALUE 'Z'.
  1833     12  AL-PADOF            PIC X       VALUE '%'.
  1834     12  AL-PADON            PIC X       VALUE '_'.
  1835     12  AL-PANOF            PIC X       VALUE '-'.
  1836     12  AL-PANON            PIC X       VALUE '/'.
  1837     12  AL-SABOF            PIC X       VALUE '8'.
  1838     12  AL-SABON            PIC X       VALUE '9'.
  1839     12  AL-SADOF            PIC X       VALUE '@'.
  1840     12  AL-SADON            PIC X       VALUE QUOTE.
  1841     12  AL-SANOF            PIC X       VALUE '0'.
  1842     12  AL-SANON            PIC X       VALUE '1'.
  1843     12  AL-UABOF            PIC X       VALUE 'H'.
  1844     12  AL-UABON            PIC X       VALUE 'I'.
  1845     12  AL-UADOF            PIC X       VALUE '<'.
  1846     12  AL-UADON            PIC X       VALUE '('.
  1847     12  AL-UANOF            PIC X       VALUE ' '.
  1848     12  AL-UANON            PIC X       VALUE 'A'.
  1849     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1850     12  AL-UNBON            PIC X       VALUE 'R'.
  1851     12  AL-UNDOF            PIC X       VALUE '*'.
  1852     12  AL-UNDON            PIC X       VALUE ')'.
  1853     12  AL-UNNOF            PIC X       VALUE '&'.
  1854     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  36
* EL156.cbl
  1856*    COPY ELCEMIB.
  1857******************************************************************
  1858*                                                                *
  1859*                                                                *
  1860*                            ELCEMIB.                            *
  1861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1862*                            VMOD=2.005                          *
  1863*                                                                *
  1864*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1865*                                                                *
  1866******************************************************************
  1867 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1868     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1869     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1870     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1871     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1872     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1873     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1874     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1875     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1876     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1877         88  EMI-NO-ERRORS                    VALUE '1'.
  1878         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1879         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1880     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1881         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1882     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1883         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1884         88  EMI-AREA1-FULL                   VALUE '2'.
  1885     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1886         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1887         88  EMI-AREA2-FULL                   VALUE '2'.
  1888     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1889         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1890         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1891         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1892         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1893         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1894     12  EMI-ERROR-LINES.
  1895         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1896         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1897         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1898         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1899             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1900                 24  EMI-ERR-NUM         PIC X(4).
  1901                 24  EMI-FILLER          PIC X.
  1902                 24  EMI-SEV             PIC X.
  1903                 24  FILLER              PIC X.
  1904             20  FILLER                  PIC X(02).
  1905     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1906         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1907             20  EMI-ERROR-NUMBER    PIC X(4).
  1908             20  EMI-FILL            PIC X.
  1909             20  EMI-SEVERITY        PIC X.
  1910             20  FILLER              PIC X.
  1911             20  EMI-ERROR-TEXT.
  1912                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1913                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  37
* EL156.cbl
  1914     12  EMI-SEVERITY-SAVE           PIC X.
  1915         88  EMI-NOTE                    VALUE 'N'.
  1916         88  EMI-WARNING                 VALUE 'W'.
  1917         88  EMI-FORCABLE                VALUE 'F'.
  1918         88  EMI-FATAL                   VALUE 'X'.
  1919     12  EMI-MESSAGE-FLAG            PIC X.
  1920         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1921         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1922     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1923     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1924         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1925         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1926         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1927     12  emi-claim-no                pic x(7).
  1928     12  emi-claim-type              pic x(6).
  1929     12  FILLER                      PIC X(124)  VALUE SPACES.
  1930     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1931     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1932     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1933     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  38
* EL156.cbl
  1935*    COPY ELCLNKLT.
  1936******************************************************************
  1937*                                                                *
  1938*                                                                *
  1939*                           ELCLNKLT                             *
  1940*                            VMOD=2.003                          *
  1941*                                                                *
  1942*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1943*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1944*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1945*                                                                *
  1946*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1947*   COMPLETING THE REQUIRED FIELDS.                              *
  1948*                                                                *
  1949*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1950*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1951*                              9999 INDICATES AN UNKNOWN ABEND   *
  1952*                                   WAS DETECTED.                *
  1953*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1954*                              CODES FOUND IN THE ERROR FILE.    *
  1955******************************************************************
  1956 01  W-1523-LINKDATA.
  1957     12  W-1523-COMMON-PI-DATA.
  1958         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1959         16  FILLER              PIC  X(67).
  1960         16  W-1523-COMPANY-CD   PIC  X(01).
  1961         16  FILLER              PIC  X(10).
  1962         16  W-1523-CONTROL-IN-PROGRESS.
  1963             20  W-1523-CARRIER  PIC  X(01).
  1964             20  W-1523-GROUPING PIC  X(06).
  1965             20  W-1523-STATE    PIC  X(02).
  1966             20  W-1523-ACCOUNT  PIC  X(10).
  1967             20  W-1523-CLAIM-CERT-GRP.
  1968                 24  W-1523-CLAIM-NO
  1969                                 PIC  X(07).
  1970                 24  W-1523-CERT-NO.
  1971                     28  W-1523-CERT-PRIME
  1972                                 PIC  X(10).
  1973                     28  W-1523-CERT-SFX
  1974                                 PIC  X(01).
  1975                 24  W-1523-CERT-EFF-DT
  1976                                 PIC  X(02).
  1977         16  FILLER              PIC X(265).
  1978
  1979     12  W-1523-WORK-AREA.
  1980         16  W-1523-FORM-NUMBER  PIC  X(04).
  1981         16  W-1523-NUMBER-COPIES
  1982                                 PIC  9(01).
  1983         16  W-1523-ADDR-TYPE    PIC  X(02).
  1984         16  W-1523-FOLLOW-UP-DATE
  1985                                 PIC  X(02).
  1986         16  W-1523-RESEND-DATE  PIC  X(02).
  1987         16  W-1523-ERROR-CODE   PIC  9(04).
  1988             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1989             88  W-1523-FATAL-ERROR
  1990                                    VALUES  0006 0013 0042
  1991                                            0154 0168 0169
  1992                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  39
* EL156.cbl
  1993                                            0179 0186 0281
  1994                                            0332 2055 3697
  1995                                            3698 3699 3770
  1996                                            3771 3772 7675
  1997                                            9106 9808 9883
  1998                                            9887.
  1999             88  W-1523-STOP-ERRORS
  2000                                    VALUES  0013 0042 0154
  2001                                            0168 0169 0172
  2002                                            0281 0332 2055
  2003                                            3698 3699 7675
  2004                                            9106 9808 9883
  2005                                            9999.
  2006         16  W-1523-REASON       PIC  X(70).
  2007         16  W-1523-ARCHIVE-NUMBER
  2008                                 PIC  9(08).
  2009     12  W-1523-POINTER-AREA.
  2010         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2011         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2012         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2013         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2014         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  40
* EL156.cbl
  2016*    COPY ELCNWA.
  2017*****************************************************************
  2018*                                                               *
  2019*                                                               *
  2020*                            ELCNWA.                            *
  2021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2022*                            VMOD=2.003                         *
  2023*                                                               *
  2024*            M O V E   N A M E   W O R K   A R E A.             *
  2025*                                                               *
  2026*****************************************************************.
  2027
  2028 01  WS-NAME-WORK-AREA.
  2029     05  WS-INSURED-LAST-NAME        PIC X(15).
  2030     05  WS-INSURED-1ST-NAME         PIC X(12).
  2031     05  WS-INSURED-MID-INIT         PIC X.
  2032
  2033     05  WS-NAME-WORK.
  2034         10  WS-NW                   PIC X
  2035             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2036
  2037     05  WS-NAME-WORK2.
  2038         10  WS-NW2                  PIC X
  2039             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2040                                        NWA-INDEX0.
  2041
  2042     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2043                                     COMP-3.
  2044
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  41
* EL156.cbl
  2046*    COPY ELCDMO.
  2047******************************************************************
  2048*                                                                *
  2049*                                                                *
  2050*                            ELCDMO.                             *
  2051*                            VMOD=2.004                          *
  2052*                                                                *
  2053*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2054*        COMMUNICATION AREA                                      *
  2055*   FILE TYPE = NA                                               *
  2056*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2057*                                                                *
  2058******************************************************************
  2059 01  DMO-COMMUNICATION-AREA.
  2060     12  DM-RECORD-TYPE                  PIC  X(02).
  2061             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2062             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2063             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2064     12  DM-DIST-CODE                    PIC  X(04).
  2065     12  DM-MAIL-CODE                    PIC  X(05).
  2066     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2067     12  DM-INSURED-NAME                 PIC  X(30).
  2068     12  DM-CLAIM-NO                     PIC  X(07).
  2069     12  DM-CLAIM-TYPE                   PIC  X.
  2070
  2071     12  DM-STATUS-DATA-AREA.
  2072         16  DM-CLAIM-STATUS             PIC  X.
  2073             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2074             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2075             88  DM-CLOSED                        VALUE '3'.
  2076             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2077             88  DM-DEFAULT                       VALUE '9'.
  2078         16  DM-STATUS-DATE              PIC  X(08).
  2079******YYYYMMDD
  2080         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2081             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2082             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2083             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2084             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2085             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2086             88  DM-RE-OPENED                     VALUE 'R'.
  2087             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2088             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2089             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2090         16  DM-STAT-CARRIER             PIC X.
  2091
  2092     12  DM-DRAFT-DATA-AREA.
  2093         16  DM-PAYMENT-TYPE             PIC  X.
  2094             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2095         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2096         16  DM-PAYMENT-DATE             PIC  X(08).
  2097******YYYYMMDD
  2098         16  DM-CERT-NO                  PIC  X(11).
  2099         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2100         16  DM-CARRIER                  PIC  X.
  2101
  2102     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  42
* EL156.cbl
  2104*    COPY ELCDMDCD.
  2105******************************************************************
  2106*                                                                *
  2107*                                                                *
  2108*                            ELCDMDCD.                           *
  2109*                            VMOD=2.001                          *
  2110*                                                                *
  2111*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2112*       COMMUNICATIONS AREA                                      *
  2113*                                                                *
  2114******************************************************************
  2115 01  CD-COMMUNICATION-AREA.
  2116     12  CD-SYSTEM-ID            PIC  X(02).
  2117         88 CD-CLAIMS                      VALUE 'CL'.
  2118         88 CD-CREDIT                      VALUE 'CR'.
  2119     12  CD-RECORD-TYPE          PIC  X(02).
  2120         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2121         88 CD-EOB-CODE                    VALUE 'EO'.
  2122         88 CD-ICD9-CODE                   VALUE 'I9'.
  2123         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2124         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2125         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2126         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2127         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2128     12  CD-RECORD-KEY           PIC  X(06).
  2129         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2130     12  CD-RETURN-CODE          PIC  X(02).
  2131     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2132     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2133     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2134     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  43
* EL156.cbl
  2136*    COPY ELCDCTB.
  2137******************************************************************
  2138*                                                                *
  2139*                                                                *
  2140*                            ELCDCTB.                            *
  2141*                            VMOD=2.002                          *
  2142*                                                                *
  2143*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2144*       COMMUNICATIONS AREA                                      *
  2145*                                                                *
  2146******************************************************************
  2147 01  DCT-COMMUNICATION-AREA.
  2148     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2149     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2150     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2151     12  DCT-PRODUCT-CODE         PIC  X(02).
  2152     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2153     12  DCT-RETURN-CODE          PIC  X(02).
  2154     12  DCT-MAIL-CODE            PIC  X(05).
  2155     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2156     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  44
* EL156.cbl
  2158 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2159 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2160 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2161 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  45
* EL156.cbl
  2163*    COPY ELCINTF.
  2164******************************************************************
  2165*                                                                *
  2166*                                                                *
  2167*                            ELCINTF.                            *
  2168*                            VMOD=2.017                          *
  2169*                                                                *
  2170*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2171*                                                                *
  2172*       LENGTH = 1024                                            *
  2173*                                                                *
  2174******************************************************************
  2175*                   C H A N G E   L O G
  2176*
  2177* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2178*-----------------------------------------------------------------
  2179*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2180* EFFECTIVE    NUMBER
  2181*-----------------------------------------------------------------
  2182* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2183******************************************************************
  2184 01  PROGRAM-INTERFACE-BLOCK.
  2185     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2186     12  PI-CALLING-PROGRAM              PIC X(8).
  2187     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2188     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2189     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2190     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2191     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2192     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2193     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2194     12  PI-COMPANY-ID                   PIC XXX.
  2195     12  PI-COMPANY-CD                   PIC X.
  2196
  2197     12  PI-COMPANY-PASSWORD             PIC X(8).
  2198
  2199     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2200
  2201     12  PI-CONTROL-IN-PROGRESS.
  2202         16  PI-CARRIER                  PIC X.
  2203         16  PI-GROUPING                 PIC X(6).
  2204         16  PI-STATE                    PIC XX.
  2205         16  PI-ACCOUNT                  PIC X(10).
  2206         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2207                                         PIC X(10).
  2208         16  PI-CLAIM-CERT-GRP.
  2209             20  PI-CLAIM-NO             PIC X(7).
  2210             20  PI-CERT-NO.
  2211                 25  PI-CERT-PRIME       PIC X(10).
  2212                 25  PI-CERT-SFX         PIC X.
  2213             20  PI-CERT-EFF-DT          PIC XX.
  2214         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2215             20  PI-PLAN-CODE            PIC X(2).
  2216             20  PI-REVISION-NUMBER      PIC X(3).
  2217             20  PI-PLAN-EFF-DT          PIC X(2).
  2218             20  PI-PLAN-EXP-DT          PIC X(2).
  2219             20  FILLER                  PIC X(11).
  2220         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  46
* EL156.cbl
  2221             20  PI-OE-REFERENCE-1.
  2222                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2223                 25  PI-OE-REF-1-SUFF    PIC XX.
  2224
  2225     12  PI-SESSION-IN-PROGRESS          PIC X.
  2226         88  CLAIM-SESSION                   VALUE '1'.
  2227         88  CREDIT-SESSION                  VALUE '2'.
  2228         88  WARRANTY-SESSION                VALUE '3'.
  2229         88  MORTGAGE-SESSION                VALUE '4'.
  2230         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2231
  2232
  2233*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2234
  2235     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2236     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2237
  2238     12  PI-CREDIT-USER                  PIC X.
  2239         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2240         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2241
  2242     12  PI-CLAIM-USER                   PIC X.
  2243         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2244         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2245
  2246     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2247         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2248         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2249         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2250         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2251         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2252
  2253     12  PI-PROCESSOR-ID                 PIC X(4).
  2254
  2255     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2256
  2257     12  PI-MEMBER-CAPTION               PIC X(10).
  2258
  2259     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2260         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2261
  2262     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2263     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2264     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2265     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2266
  2267     12  PI-AH-OVERRIDE-L1               PIC X.
  2268     12  PI-AH-OVERRIDE-L2               PIC XX.
  2269     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2270     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2271
  2272     12  PI-NEW-SYSTEM                   PIC X(2).
  2273
  2274     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2275     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2276         88  PI-USES-PAID-TO                 VALUE '1'.
  2277     12  PI-CRDTCRD-SYSTEM.
  2278         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  47
* EL156.cbl
  2279             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2280             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2281         16  PI-CC-MONTH-END-DT          PIC XX.
  2282     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2283
  2284     12  PI-OE-REFERENCE-2.
  2285         16  PI-OE-REF-2-PRIME           PIC X(10).
  2286         16  PI-OE-REF-2-SUFF            PIC X.
  2287
  2288     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2289
  2290     12  PI-LANGUAGE-TYPE                PIC X.
  2291             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2292             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2293             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2294
  2295     12  PI-POLICY-LINKAGE-IND           PIC X.
  2296         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2297         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2298                                                   LOW-VALUES.
  2299
  2300     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2301     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2302         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2303         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2304
  2305     12  PI-PROCESSOR-CSR-IND            PIC X.
  2306         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2307         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2308
  2309     12  FILLER                          PIC X(3).
  2310
  2311     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2312
  2313     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2314         PI-SYSTEM-LEVEL.
  2315
  2316         16  PI-ENTRY-CODES.
  2317             20  PI-ENTRY-CD-1           PIC X.
  2318             20  PI-ENTRY-CD-2           PIC X.
  2319
  2320         16  PI-RETURN-CODES.
  2321             20  PI-RETURN-CD-1          PIC X.
  2322             20  PI-RETURN-CD-2          PIC X.
  2323
  2324         16  PI-UPDATE-STATUS-SAVE.
  2325             20  PI-UPDATE-BY            PIC X(4).
  2326             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2327
  2328         16  PI-LOWER-CASE-LETTERS       PIC X.
  2329             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2330
  2331*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2332*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2333*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2334
  2335         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2336             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  48
* EL156.cbl
  2337             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2338             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2339             88  ACCNT-CNTL                  VALUE '3'.
  2340             88  CARR-ACCNT-CNTL             VALUE '4'.
  2341
  2342         16  PI-PROCESSOR-CAP-LIST.
  2343             20  PI-SYSTEM-CONTROLS.
  2344                24 PI-SYSTEM-DISPLAY     PIC X.
  2345                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2346                24 PI-SYSTEM-MODIFY      PIC X.
  2347                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2348             20  FILLER                  PIC XX.
  2349             20  PI-DISPLAY-CAP          PIC X.
  2350                 88  DISPLAY-CAP             VALUE 'Y'.
  2351             20  PI-MODIFY-CAP           PIC X.
  2352                 88  MODIFY-CAP              VALUE 'Y'.
  2353             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2354                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2355             20  PI-FORCE-CAP            PIC X.
  2356                 88  FORCE-CAP               VALUE 'Y'.
  2357
  2358         16  PI-PROGRAM-CONTROLS.
  2359             20  PI-PGM-PRINT-OPT        PIC X.
  2360             20  PI-PGM-FORMAT-OPT       PIC X.
  2361             20  PI-PGM-PROCESS-OPT      PIC X.
  2362             20  PI-PGM-TOTALS-OPT       PIC X.
  2363
  2364         16  PI-HELP-INTERFACE.
  2365             20  PI-LAST-ERROR-NO        PIC X(4).
  2366             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2367
  2368         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2369             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2370
  2371         16  PI-CR-CONTROL-IN-PROGRESS.
  2372             20  PI-CR-CARRIER           PIC X.
  2373             20  PI-CR-GROUPING          PIC X(6).
  2374             20  PI-CR-STATE             PIC XX.
  2375             20  PI-CR-ACCOUNT           PIC X(10).
  2376             20  PI-CR-FIN-RESP          PIC X(10).
  2377             20  PI-CR-TYPE              PIC X.
  2378
  2379         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2380
  2381         16  PI-CR-MONTH-END-DT          PIC XX.
  2382
  2383         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2384             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2385             88  PI-ZERO-CARRIER             VALUE '1'.
  2386             88  PI-ZERO-GROUPING            VALUE '2'.
  2387             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2388
  2389         16  PI-CARRIER-SECURITY         PIC X.
  2390             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2391
  2392         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2393             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2394             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  49
* EL156.cbl
  2395
  2396         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2397             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2398                                         INDEXED BY PI-ACCESS-NDX
  2399                                         PIC X.
  2400
  2401         16  PI-GA-BILLING-CONTROL       PIC X.
  2402             88  PI-GA-BILLING               VALUE '1'.
  2403
  2404         16  PI-MAIL-PROCESSING          PIC X.
  2405             88  PI-MAIL-YES                 VALUE 'Y'.
  2406
  2407         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2408
  2409         16  PI-AR-SYSTEM.
  2410             20  PI-AR-PROCESSING-CNTL   PIC X.
  2411                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2412             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2413             20  PI-AR-MONTH-END-DT      PIC XX.
  2414
  2415         16  PI-MP-SYSTEM.
  2416             20  PI-MORTGAGE-USER            PIC X.
  2417                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2418                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2419             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2420                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2421                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2422                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2423                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2424                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2425             20  PI-MP-MONTH-END-DT          PIC XX.
  2426             20  PI-MP-REFERENCE-NO.
  2427                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2428                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2429
  2430         16  PI-LABEL-CONTROL            PIC X(01).
  2431             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2432             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2433
  2434         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2435             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2436
  2437         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2438             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2439             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2440
  2441         16  FILLER                      PIC X(14).
  2442
  2443     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2444******************************************************************
  2445     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2446         16  PI-SAVE-FORM        PIC X(12).
  2447         16  PI-ACCT-KEY         PIC X(26).
  2448         16  PI-PAYEE-NAME       PIC X(30).
  2449         16  PI-DAILY-RATE       PIC S9(3)V99.
  2450         16  PI-MONTH-END-SAVE   PIC XX.
  2451         16  PI-BENEFIT-SAVE.
  2452             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  50
* EL156.cbl
  2453             20  PI-BEN-TYPE     PIC X.
  2454         16  PI-MANUAL-SW        PIC 9.
  2455         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2456         16  PI-PASS-SW          PIC X.
  2457         16  PI-PFKEY-USED       PIC X.
  2458         16  PI-CK-ASSIGN        PIC X.
  2459         16  PI-FATAL-COUNT      PIC 99.
  2460         16  PI-FORCE-COUNT      PIC 99.
  2461         16  PI-SAVE-INPUT.
  2462             20  PI-PMTTYPE      PIC X.
  2463             20  PI-PAYEE.
  2464                 24  PI-PAYEE-TYPE PIC X.
  2465                 24  PI-PAYEE-SEQ  PIC X.
  2466                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2467                   PI-PAYEE-SEQ    PIC S9.
  2468             20  PI-PMTNOTE1     PIC X(60).
  2469             20  PI-PMTNOTE2     PIC X(60).
  2470             20  PI-OFFLINE      PIC X.
  2471             20  PI-ECHECKNO     PIC X(7).
  2472             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2473                 28  PI-ECHECKNO-N     PIC X.
  2474                 28  PI-ECHECKNO-6     PIC X(6).
  2475             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2476                 24  PI-ECHECKNO-CR    PIC XX.
  2477                 24  PI-ECHECKNO-5     PIC X(5).
  2478             20  PI-HOLDTIL      PIC 9(6).
  2479             20  PI-EPYFROM      PIC 9(6).
  2480             20  PI-EPYTHRU      PIC 9(6).
  2481             20  PI-EDAYS        PIC S9(5).
  2482             20  PI-EPYAMT       PIC S9(7)V99.
  2483             20  PI-ERESV        PIC S9(7)V99.
  2484             20  PI-EEXPENS      PIC 9(6)V99.
  2485             20  PI-ETYPE        PIC X.
  2486             20  PI-CASH         PIC X.
  2487             20  PI-GROUPED      PIC X.
  2488             20  PI-INT-RATE     PIC S99V9(5).
  2489             20  PI-AIGFROM      PIC 9(6).
  2490             20  PI-LOAN-NO      PIC X(20).
  2491             20  PI-PROOF-DATE   PIC 9(6).
  2492             20  PI-PRINT-EOB-YN PIC X.
  2493             20  PI-PRINT-CLM-FRM-YN PIC X.
  2494             20  PI-PRINT-SURVEY-YN PIC X.
  2495             20  PI-SPECIAL-RELEASE-YN PIC X.
  2496             20  pi-int-to-rem-borr pic x.
  2497         16  PI-SAVE-COMPUTED.
  2498             20  PI-CCHECKNO     PIC X(7).
  2499             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2500                 28  PI-CCHECKNO-N     PIC X.
  2501                 28  PI-CCHECKNO-6     PIC X(6).
  2502             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2503                 24  PI-CCHECKNO-CR    PIC XX.
  2504                 24  PI-CCHECKNO-5     PIC X(5).
  2505             20  PI-CPYFROM      PIC XX.
  2506             20  PI-CPYTHRU      PIC XX.
  2507             20  PI-CDAYS        PIC S9(5).
  2508             20  PI-CPYAMT       PIC S9(7)V99.
  2509             20  PI-CRESV        PIC 9(6)V99.
  2510             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  51
* EL156.cbl
  2511             20  PI-PMT-APPR-SW  PIC X.
  2512                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2513                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2514                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2515         16  PI-PREV-CLMNO       PIC X(7).
  2516         16  PI-LF-COVERAGE-TYPE PIC X.
  2517         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2518         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2519         16  PI-PROVISIONAL-IND  PIC X.
  2520             88 PI-PROV-PMT      VALUE 'P'.
  2521         16  PI-PREV-TRLR-KEY    PIC X(22).
  2522         16  PI-SPLIT-PMT-SW     PIC X.
  2523         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2524         16  PI-ACTIVITY-CODE    PIC 99.
  2525         16  PI-RESET-SW         PIC X.
  2526         16  PI-SPECIAL-BEN-SW   PIC X.
  2527             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2528         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2529         16  PI-EXP-DT           PIC XX.
  2530         16  PI-LOAN-DUE-DAY     PIC 99.
  2531         16  PI-3RD-PARTY-SW     PIC X.
  2532         16  PI-LOAN-UPDATE-SW   PIC X.
  2533
  2534         16  PI-DMD-DATA.
  2535             20  PI-SV-CERT-KEY       PIC X(21).
  2536             20  PI-SV-CERT-NO        PIC X(11).
  2537             20  PI-SV-BEN            PIC X(10).
  2538             20  PI-SV-CCN            PIC X(16).
  2539             20  PI-INTEREST-PAID-IND PIC X.
  2540                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2541             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2542             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2543             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2544             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2545         16  PI-AT-EOB-CODES.
  2546             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2547         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2548         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2549         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2550         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2551         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2552         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2553         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2554         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2555         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2556         16  PI-LF-BENEFIT-CD         PIC X(2).
  2557         16  PI-EOB-CODES-EXIST PIC X.
  2558         16  PI-SET-NOTE2-MDT   PIC X.
  2559         16  PI-VFY-2ND-BENE          PIC X.
  2560         16  PI-CLM-TYPE              PIC X.
  2561         16  PI-APPROVAL-LEVEL        PIC X.
  2562         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2563         16  PI-REAUDIT-NEEDED        PIC X.
  2564         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2565         16  PI-AH-BENEFIT-CD         PIC XX.
  2566         16  pi-ah-term               pic s999 comp-3.
  2567         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2568         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  52
* EL156.cbl
  2569         16  pi-max-ext-used          pic x.
  2570         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2571         16  PI-JOINT-COV-IND         PIC X.
  2572             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2573             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2574         16  PI-JOINT-INSURED-IND     PIC X.
  2575             88  PI-JOINT-INSURED        VALUE 'Y'.
  2576             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2577         16  pi-int-payees-name       pic x(30).
  2578         16  PI-RB-JOINT-COV-IND      PIC X.
  2579             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2580             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2581*00781          16  FILLER                   PIC X(176).
  2582*052506         16  FILLER                   PIC X(161).
  2583*031808         16  FILLER                   PIC X(154).
  2584*091808         16  FILLER                   PIC X(152).
  2585*041710         16  FILLER                   PIC X(94).
  2586         16  FILLER                   PIC X(35).
  2587
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  53
* EL156.cbl
  2589*    COPY ELCJPFX.
  2590******************************************************************
  2591*                                                                *
  2592*                                                                *
  2593*                            ELCJPFX.                            *
  2594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2595*                            VMOD=2.002                          *
  2596*                                                                *
  2597*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2598*                                                                *
  2599*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2600*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2601*        ELCNTL - CONTROL FILE                                   *
  2602*        ELMSTR - CLAIM MASTERS                                  *
  2603*        ELTRLR - ACTIVITY TRAILERS                              *
  2604*        ELCHKQ - CHECK QUE                                      *
  2605******************************************************************
  2606 01  JOURNAL-RECORD.
  2607     12  jp-date                     pic s9(5) comp-3.
  2608     12  jp-time                     pic s9(7) comp-3.
  2609     12  JP-USER-ID                  PIC X(4).
  2610     12  JP-FILE-ID                  PIC X(8).
  2611     12  JP-PROGRAM-ID               PIC X(8).
  2612     12  JP-RECORD-TYPE              PIC X.
  2613         88 JP-ADD              VALUE 'A'.
  2614         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2615         88 JP-AFTER-CHANGE     VALUE 'C'.
  2616         88 JP-DELETE           VALUE 'D'.
  2617         88 JP-GENERIC-DELETE   VALUE 'G'.
  2618         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2619         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2620     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2621     12  JP-RECORD-AREA
  2622
  2623
  2624                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  54
* EL156.cbl
  2626*    COPY ELCAID.
  2627******************************************************************
  2628*                                                                *
  2629*                            ELCAID.                             *
  2630*                            VMOD=2.001                          *
  2631*                                                                *
  2632*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2633*                                                                *
  2634*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2635*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2636******************************************************************
  2637
  2638 01  DFHAID.
  2639   02  DFHNULL   PIC  X  VALUE  ' '.
  2640   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2641   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2642   02  DFHPEN    PIC  X  VALUE  '='.
  2643   02  DFHOPID   PIC  X  VALUE  'W'.
  2644   02  DFHPA1    PIC  X  VALUE  '%'.
  2645   02  DFHPA2    PIC  X  VALUE  '>'.
  2646   02  DFHPA3    PIC  X  VALUE  ','.
  2647   02  DFHPF1    PIC  X  VALUE  '1'.
  2648   02  DFHPF2    PIC  X  VALUE  '2'.
  2649   02  DFHPF3    PIC  X  VALUE  '3'.
  2650   02  DFHPF4    PIC  X  VALUE  '4'.
  2651   02  DFHPF5    PIC  X  VALUE  '5'.
  2652   02  DFHPF6    PIC  X  VALUE  '6'.
  2653   02  DFHPF7    PIC  X  VALUE  '7'.
  2654   02  DFHPF8    PIC  X  VALUE  '8'.
  2655   02  DFHPF9    PIC  X  VALUE  '9'.
  2656   02  DFHPF10   PIC  X  VALUE  ':'.
  2657   02  DFHPF11   PIC  X  VALUE  '#'.
  2658   02  DFHPF12   PIC  X  VALUE  '@'.
  2659   02  DFHPF13   PIC  X  VALUE  'A'.
  2660   02  DFHPF14   PIC  X  VALUE  'B'.
  2661   02  DFHPF15   PIC  X  VALUE  'C'.
  2662   02  DFHPF16   PIC  X  VALUE  'D'.
  2663   02  DFHPF17   PIC  X  VALUE  'E'.
  2664   02  DFHPF18   PIC  X  VALUE  'F'.
  2665   02  DFHPF19   PIC  X  VALUE  'G'.
  2666   02  DFHPF20   PIC  X  VALUE  'H'.
  2667   02  DFHPF21   PIC  X  VALUE  'I'.
  2668*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2669   02  DFHPF22   PIC  X  VALUE  '['.
  2670   02  DFHPF23   PIC  X  VALUE  '.'.
  2671   02  DFHPF24   PIC  X  VALUE  '<'.
  2672   02  DFHMSRE   PIC  X  VALUE  'X'.
  2673   02  DFHSTRF   PIC  X  VALUE  'h'.
  2674   02  DFHTRIG   PIC  X  VALUE  '"'.
  2675 01  FILLER    REDEFINES DFHAID.
  2676     12  FILLER              PIC X(8).
  2677     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  55
* EL156.cbl
  2679*    COPY EL156S.
  2680 01  EL156AI.
  2681     05  FILLER            PIC  X(0012).
  2682*    -------------------------------
  2683     05  RUNDTEAL PIC S9(0004) COMP.
  2684     05  RUNDTEAF PIC  X(0001).
  2685     05  FILLER REDEFINES RUNDTEAF.
  2686         10  RUNDTEAA PIC  X(0001).
  2687     05  RUNDTEAI PIC  X(0008).
  2688*    -------------------------------
  2689     05  RUNTIMAL PIC S9(0004) COMP.
  2690     05  RUNTIMAF PIC  X(0001).
  2691     05  FILLER REDEFINES RUNTIMAF.
  2692         10  RUNTIMAA PIC  X(0001).
  2693     05  RUNTIMAI PIC  X(0005).
  2694*    -------------------------------
  2695     05  SEQUL PIC S9(0004) COMP.
  2696     05  SEQUF PIC  X(0001).
  2697     05  FILLER REDEFINES SEQUF.
  2698         10  SEQUA PIC  X(0001).
  2699     05  SEQUI PIC  X(0010).
  2700*    -------------------------------
  2701     05  CLMNOL PIC S9(0004) COMP.
  2702     05  CLMNOF PIC  X(0001).
  2703     05  FILLER REDEFINES CLMNOF.
  2704         10  CLMNOA PIC  X(0001).
  2705     05  CLMNOI PIC  X(0007).
  2706*    -------------------------------
  2707     05  CARRL PIC S9(0004) COMP.
  2708     05  CARRF PIC  X(0001).
  2709     05  FILLER REDEFINES CARRF.
  2710         10  CARRA PIC  X(0001).
  2711     05  CARRI PIC  X(0001).
  2712*    -------------------------------
  2713     05  CERTNOL PIC S9(0004) COMP.
  2714     05  CERTNOF PIC  X(0001).
  2715     05  FILLER REDEFINES CERTNOF.
  2716         10  CERTNOA PIC  X(0001).
  2717     05  CERTNOI PIC  X(0010).
  2718*    -------------------------------
  2719     05  SUFXL PIC S9(0004) COMP.
  2720     05  SUFXF PIC  X(0001).
  2721     05  FILLER REDEFINES SUFXF.
  2722         10  SUFXA PIC  X(0001).
  2723     05  SUFXI PIC  X(0001).
  2724*    -------------------------------
  2725     05  CLMTYPL PIC S9(0004) COMP.
  2726     05  CLMTYPF PIC  X(0001).
  2727     05  FILLER REDEFINES CLMTYPF.
  2728         10  CLMTYPA PIC  X(0001).
  2729     05  CLMTYPI PIC  X(0006).
  2730*    -------------------------------
  2731     05  CLMSTATL PIC S9(0004) COMP.
  2732     05  CLMSTATF PIC  X(0001).
  2733     05  FILLER REDEFINES CLMSTATF.
  2734         10  CLMSTATA PIC  X(0001).
  2735     05  CLMSTATI PIC  X(0006).
  2736*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  56
* EL156.cbl
  2737     05  LSTNMEL PIC S9(0004) COMP.
  2738     05  LSTNMEF PIC  X(0001).
  2739     05  FILLER REDEFINES LSTNMEF.
  2740         10  LSTNMEA PIC  X(0001).
  2741     05  LSTNMEI PIC  X(0015).
  2742*    -------------------------------
  2743     05  FSTNMEL PIC S9(0004) COMP.
  2744     05  FSTNMEF PIC  X(0001).
  2745     05  FILLER REDEFINES FSTNMEF.
  2746         10  FSTNMEA PIC  X(0001).
  2747     05  FSTNMEI PIC  X(0012).
  2748*    -------------------------------
  2749     05  MINITL PIC S9(0004) COMP.
  2750     05  MINITF PIC  X(0001).
  2751     05  FILLER REDEFINES MINITF.
  2752         10  MINITA PIC  X(0001).
  2753     05  MINITI PIC  X(0001).
  2754*    -------------------------------
  2755     05  PRIMHDGL PIC S9(0004) COMP.
  2756     05  PRIMHDGF PIC  X(0001).
  2757     05  FILLER REDEFINES PRIMHDGF.
  2758         10  PRIMHDGA PIC  X(0001).
  2759     05  PRIMHDGI PIC  X(0012).
  2760*    -------------------------------
  2761     05  PCERTNOL PIC S9(0004) COMP.
  2762     05  PCERTNOF PIC  X(0001).
  2763     05  FILLER REDEFINES PCERTNOF.
  2764         10  PCERTNOA PIC  X(0001).
  2765     05  PCERTNOI PIC  X(0010).
  2766*    -------------------------------
  2767     05  PSUFXL PIC S9(0004) COMP.
  2768     05  PSUFXF PIC  X(0001).
  2769     05  FILLER REDEFINES PSUFXF.
  2770         10  PSUFXA PIC  X(0001).
  2771     05  PSUFXI PIC  X(0001).
  2772*    -------------------------------
  2773     05  STATUSL PIC S9(0004) COMP.
  2774     05  STATUSF PIC  X(0001).
  2775     05  FILLER REDEFINES STATUSF.
  2776         10  STATUSA PIC  X(0001).
  2777     05  STATUSI PIC  X(0010).
  2778*    -------------------------------
  2779     05  LOANHL PIC S9(0004) COMP.
  2780     05  LOANHF PIC  X(0001).
  2781     05  FILLER REDEFINES LOANHF.
  2782         10  LOANHA PIC  X(0001).
  2783     05  LOANHI PIC  X(0014).
  2784*    -------------------------------
  2785     05  LOANNOL PIC S9(0004) COMP.
  2786     05  LOANNOF PIC  X(0001).
  2787     05  FILLER REDEFINES LOANNOF.
  2788         10  LOANNOA PIC  X(0001).
  2789     05  LOANNOI PIC  X(0025).
  2790*    -------------------------------
  2791     05  DUEDAYHL PIC S9(0004) COMP.
  2792     05  DUEDAYHF PIC  X(0001).
  2793     05  FILLER REDEFINES DUEDAYHF.
  2794         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  57
* EL156.cbl
  2795     05  DUEDAYHI PIC  X(0008).
  2796*    -------------------------------
  2797     05  DUEDAYL PIC S9(0004) COMP.
  2798     05  DUEDAYF PIC  X(0001).
  2799     05  FILLER REDEFINES DUEDAYF.
  2800         10  DUEDAYA PIC  X(0001).
  2801     05  DUEDAYI PIC  X(0002).
  2802*    -------------------------------
  2803     05  ZINTHL PIC S9(0004) COMP.
  2804     05  ZINTHF PIC  X(0001).
  2805     05  FILLER REDEFINES ZINTHF.
  2806         10  ZINTHA PIC  X(0001).
  2807     05  ZINTHI PIC  X(0009).
  2808*    -------------------------------
  2809     05  ZINTL PIC S9(0004) COMP.
  2810     05  ZINTF PIC  X(0001).
  2811     05  FILLER REDEFINES ZINTF.
  2812         10  ZINTA PIC  X(0001).
  2813     05  ZINTI PIC  99V99999.
  2814*    -------------------------------
  2815     05  PTHRHDGL PIC S9(0004) COMP.
  2816     05  PTHRHDGF PIC  X(0001).
  2817     05  FILLER REDEFINES PTHRHDGF.
  2818         10  PTHRHDGA PIC  X(0001).
  2819     05  PTHRHDGI PIC  X(0014).
  2820*    -------------------------------
  2821     05  PDTHRUL PIC S9(0004) COMP.
  2822     05  PDTHRUF PIC  X(0001).
  2823     05  FILLER REDEFINES PDTHRUF.
  2824         10  PDTHRUA PIC  X(0001).
  2825     05  PDTHRUI PIC  X(0008).
  2826*    -------------------------------
  2827     05  TOTPAIDL PIC S9(0004) COMP.
  2828     05  TOTPAIDF PIC  X(0001).
  2829     05  FILLER REDEFINES TOTPAIDF.
  2830         10  TOTPAIDA PIC  X(0001).
  2831     05  TOTPAIDI PIC  X(0010).
  2832*    -------------------------------
  2833     05  COVERL PIC S9(0004) COMP.
  2834     05  COVERF PIC  X(0001).
  2835     05  FILLER REDEFINES COVERF.
  2836         10  COVERA PIC  X(0001).
  2837     05  COVERI PIC  X(0010).
  2838*    -------------------------------
  2839     05  INCURL PIC S9(0004) COMP.
  2840     05  INCURF PIC  X(0001).
  2841     05  FILLER REDEFINES INCURF.
  2842         10  INCURA PIC  X(0001).
  2843     05  INCURI PIC  X(0008).
  2844*    -------------------------------
  2845     05  LSTDTEL PIC S9(0004) COMP.
  2846     05  LSTDTEF PIC  X(0001).
  2847     05  FILLER REDEFINES LSTDTEF.
  2848         10  LSTDTEA PIC  X(0001).
  2849     05  LSTDTEI PIC  X(0008).
  2850*    -------------------------------
  2851     05  CRTSTATL PIC S9(0004) COMP.
  2852     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  58
* EL156.cbl
  2853     05  FILLER REDEFINES CRTSTATF.
  2854         10  CRTSTATA PIC  X(0001).
  2855     05  CRTSTATI PIC  X(0010).
  2856*    -------------------------------
  2857     05  EFFECTL PIC S9(0004) COMP.
  2858     05  EFFECTF PIC  X(0001).
  2859     05  FILLER REDEFINES EFFECTF.
  2860         10  EFFECTA PIC  X(0001).
  2861     05  EFFECTI PIC  X(0008).
  2862*    -------------------------------
  2863     05  TERMSL PIC S9(0004) COMP.
  2864     05  TERMSF PIC  X(0001).
  2865     05  FILLER REDEFINES TERMSF.
  2866         10  TERMSA PIC  X(0001).
  2867     05  TERMSI PIC  X(0011).
  2868*    -------------------------------
  2869     05  STACCTL PIC S9(0004) COMP.
  2870     05  STACCTF PIC  X(0001).
  2871     05  FILLER REDEFINES STACCTF.
  2872         10  STACCTA PIC  X(0001).
  2873     05  STACCTI PIC  X(0013).
  2874*    -------------------------------
  2875     05  EXPDTEHL PIC S9(0004) COMP.
  2876     05  EXPDTEHF PIC  X(0001).
  2877     05  FILLER REDEFINES EXPDTEHF.
  2878         10  EXPDTEHA PIC  X(0001).
  2879     05  EXPDTEHI PIC  X(0014).
  2880*    -------------------------------
  2881     05  EXPDTEL PIC S9(0004) COMP.
  2882     05  EXPDTEF PIC  X(0001).
  2883     05  FILLER REDEFINES EXPDTEF.
  2884         10  EXPDTEA PIC  X(0001).
  2885     05  EXPDTEI PIC  X(0008).
  2886*    -------------------------------
  2887     05  BENECAPL PIC S9(0004) COMP.
  2888     05  BENECAPF PIC  X(0001).
  2889     05  FILLER REDEFINES BENECAPF.
  2890         10  BENECAPA PIC  X(0001).
  2891     05  BENECAPI PIC  X(0013).
  2892*    -------------------------------
  2893     05  BENEL PIC S9(0004) COMP.
  2894     05  BENEF PIC  X(0001).
  2895     05  FILLER REDEFINES BENEF.
  2896         10  BENEA PIC  X(0001).
  2897     05  BENEI PIC  X(0009).
  2898*    -------------------------------
  2899     05  FORMTYPL PIC S9(0004) COMP.
  2900     05  FORMTYPF PIC  X(0001).
  2901     05  FILLER REDEFINES FORMTYPF.
  2902         10  FORMTYPA PIC  X(0001).
  2903     05  FORMTYPI PIC  X(0001).
  2904*    -------------------------------
  2905     05  PMTTYPEL PIC S9(0004) COMP.
  2906     05  PMTTYPEF PIC  X(0001).
  2907     05  FILLER REDEFINES PMTTYPEF.
  2908         10  PMTTYPEA PIC  X(0001).
  2909     05  PMTTYPEI PIC  X(0001).
  2910*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  59
* EL156.cbl
  2911     05  PAYEEL PIC S9(0004) COMP.
  2912     05  PAYEEF PIC  X(0001).
  2913     05  FILLER REDEFINES PAYEEF.
  2914         10  PAYEEA PIC  X(0001).
  2915     05  PAYEEI PIC  X(0002).
  2916*    -------------------------------
  2917     05  CHECKNOL PIC S9(0004) COMP.
  2918     05  CHECKNOF PIC  X(0001).
  2919     05  FILLER REDEFINES CHECKNOF.
  2920         10  CHECKNOA PIC  X(0001).
  2921     05  CHECKNOI PIC  X(0007).
  2922*    -------------------------------
  2923     05  OFFLINEL PIC S9(0004) COMP.
  2924     05  OFFLINEF PIC  X(0001).
  2925     05  FILLER REDEFINES OFFLINEF.
  2926         10  OFFLINEA PIC  X(0001).
  2927     05  OFFLINEI PIC  X(0001).
  2928*    -------------------------------
  2929     05  HOLDTILL PIC S9(0004) COMP.
  2930     05  HOLDTILF PIC  X(0001).
  2931     05  FILLER REDEFINES HOLDTILF.
  2932         10  HOLDTILA PIC  X(0001).
  2933     05  HOLDTILI PIC  X(0008).
  2934*    -------------------------------
  2935     05  NOTE1L PIC S9(0004) COMP.
  2936     05  NOTE1F PIC  X(0001).
  2937     05  FILLER REDEFINES NOTE1F.
  2938         10  NOTE1A PIC  X(0001).
  2939     05  NOTE1I PIC  X(0060).
  2940*    -------------------------------
  2941     05  ITRB1L PIC S9(0004) COMP.
  2942     05  ITRB1F PIC  X(0001).
  2943     05  FILLER REDEFINES ITRB1F.
  2944         10  ITRB1A PIC  X(0001).
  2945     05  ITRB1I PIC  X(0008).
  2946*    -------------------------------
  2947     05  NOTE2L PIC S9(0004) COMP.
  2948     05  NOTE2F PIC  X(0001).
  2949     05  FILLER REDEFINES NOTE2F.
  2950         10  NOTE2A PIC  X(0001).
  2951     05  NOTE2I PIC  X(0060).
  2952*    -------------------------------
  2953     05  ITRB2L PIC S9(0004) COMP.
  2954     05  ITRB2F PIC  X(0001).
  2955     05  FILLER REDEFINES ITRB2F.
  2956         10  ITRB2A PIC  X(0001).
  2957     05  ITRB2I PIC  X(0010).
  2958*    -------------------------------
  2959     05  EOBYNL PIC S9(0004) COMP.
  2960     05  EOBYNF PIC  X(0001).
  2961     05  FILLER REDEFINES EOBYNF.
  2962         10  EOBYNA PIC  X(0001).
  2963     05  EOBYNI PIC  X(0001).
  2964*    -------------------------------
  2965     05  CLMFMYNL PIC S9(0004) COMP.
  2966     05  CLMFMYNF PIC  X(0001).
  2967     05  FILLER REDEFINES CLMFMYNF.
  2968         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  60
* EL156.cbl
  2969     05  CLMFMYNI PIC  X(0001).
  2970*    -------------------------------
  2971     05  SURVYYNL PIC S9(0004) COMP.
  2972     05  SURVYYNF PIC  X(0001).
  2973     05  FILLER REDEFINES SURVYYNF.
  2974         10  SURVYYNA PIC  X(0001).
  2975     05  SURVYYNI PIC  X(0001).
  2976*    -------------------------------
  2977     05  SPRELYNL PIC S9(0004) COMP.
  2978     05  SPRELYNF PIC  X(0001).
  2979     05  FILLER REDEFINES SPRELYNF.
  2980         10  SPRELYNA PIC  X(0001).
  2981     05  SPRELYNI PIC  X(0001).
  2982*    -------------------------------
  2983     05  PINTHL PIC S9(0004) COMP.
  2984     05  PINTHF PIC  X(0001).
  2985     05  FILLER REDEFINES PINTHF.
  2986         10  PINTHA PIC  X(0001).
  2987     05  PINTHI PIC  X(0004).
  2988*    -------------------------------
  2989     05  PINTL PIC S9(0004) COMP.
  2990     05  PINTF PIC  X(0001).
  2991     05  FILLER REDEFINES PINTF.
  2992         10  PINTA PIC  X(0001).
  2993     05  PINTI PIC  X(0008).
  2994*    -------------------------------
  2995     05  ITRBYNL PIC S9(0004) COMP.
  2996     05  ITRBYNF PIC  X(0001).
  2997     05  FILLER REDEFINES ITRBYNF.
  2998         10  ITRBYNA PIC  X(0001).
  2999     05  ITRBYNI PIC  X(0001).
  3000*    -------------------------------
  3001     05  PROOFDTL PIC S9(0004) COMP.
  3002     05  PROOFDTF PIC  X(0001).
  3003     05  FILLER REDEFINES PROOFDTF.
  3004         10  PROOFDTA PIC  X(0001).
  3005     05  PROOFDTI PIC  X(0008).
  3006*    -------------------------------
  3007     05  AIGFRMHL PIC S9(0004) COMP.
  3008     05  AIGFRMHF PIC  X(0001).
  3009     05  FILLER REDEFINES AIGFRMHF.
  3010         10  AIGFRMHA PIC  X(0001).
  3011     05  AIGFRMHI PIC  X(0012).
  3012*    -------------------------------
  3013     05  AIGFROML PIC S9(0004) COMP.
  3014     05  AIGFROMF PIC  X(0001).
  3015     05  FILLER REDEFINES AIGFROMF.
  3016         10  AIGFROMA PIC  X(0001).
  3017     05  AIGFROMI PIC  X(0008).
  3018*    -------------------------------
  3019     05  PMTHDGAL PIC S9(0004) COMP.
  3020     05  PMTHDGAF PIC  X(0001).
  3021     05  FILLER REDEFINES PMTHDGAF.
  3022         10  PMTHDGAA PIC  X(0001).
  3023     05  PMTHDGAI PIC  X(0066).
  3024*    -------------------------------
  3025     05  EPYFROML PIC S9(0004) COMP.
  3026     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  61
* EL156.cbl
  3027     05  FILLER REDEFINES EPYFROMF.
  3028         10  EPYFROMA PIC  X(0001).
  3029     05  EPYFROMI PIC  X(0008).
  3030*    -------------------------------
  3031     05  EPYTHRUL PIC S9(0004) COMP.
  3032     05  EPYTHRUF PIC  X(0001).
  3033     05  FILLER REDEFINES EPYTHRUF.
  3034         10  EPYTHRUA PIC  X(0001).
  3035     05  EPYTHRUI PIC  X(0008).
  3036*    -------------------------------
  3037     05  EDAYSL PIC S9(0004) COMP.
  3038     05  EDAYSF PIC  X(0001).
  3039     05  FILLER REDEFINES EDAYSF.
  3040         10  EDAYSA PIC  X(0001).
  3041     05  EDAYSI PIC  S9(6).
  3042*    -------------------------------
  3043     05  EPYAMTL PIC S9(0004) COMP.
  3044     05  EPYAMTF PIC  X(0001).
  3045     05  FILLER REDEFINES EPYAMTF.
  3046         10  EPYAMTA PIC  X(0001).
  3047     05  EPYAMTI PIC  S9(8)V99.
  3048*    -------------------------------
  3049     05  ERESVL PIC S9(0004) COMP.
  3050     05  ERESVF PIC  X(0001).
  3051     05  FILLER REDEFINES ERESVF.
  3052         10  ERESVA PIC  X(0001).
  3053     05  ERESVI PIC  S9(7)V99.
  3054*    -------------------------------
  3055     05  ETYPEL PIC S9(0004) COMP.
  3056     05  ETYPEF PIC  X(0001).
  3057     05  FILLER REDEFINES ETYPEF.
  3058         10  ETYPEA PIC  X(0001).
  3059     05  ETYPEI PIC  X(0001).
  3060*    -------------------------------
  3061     05  EEXPENSL PIC S9(0004) COMP.
  3062     05  EEXPENSF PIC  X(0001).
  3063     05  FILLER REDEFINES EEXPENSF.
  3064         10  EEXPENSA PIC  X(0001).
  3065     05  EEXPENSI PIC  9(6)V99.
  3066*    -------------------------------
  3067     05  CPYFROML PIC S9(0004) COMP.
  3068     05  CPYFROMF PIC  X(0001).
  3069     05  FILLER REDEFINES CPYFROMF.
  3070         10  CPYFROMA PIC  X(0001).
  3071     05  CPYFROMI PIC  X(0008).
  3072*    -------------------------------
  3073     05  CPYTHRUL PIC S9(0004) COMP.
  3074     05  CPYTHRUF PIC  X(0001).
  3075     05  FILLER REDEFINES CPYTHRUF.
  3076         10  CPYTHRUA PIC  X(0001).
  3077     05  CPYTHRUI PIC  X(0008).
  3078*    -------------------------------
  3079     05  CDAYSL PIC S9(0004) COMP.
  3080     05  CDAYSF PIC  X(0001).
  3081     05  FILLER REDEFINES CDAYSF.
  3082         10  CDAYSA PIC  X(0001).
  3083     05  CDAYSI PIC  9(6).
  3084*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  62
* EL156.cbl
  3085     05  CPYAMTL PIC S9(0004) COMP.
  3086     05  CPYAMTF PIC  X(0001).
  3087     05  FILLER REDEFINES CPYAMTF.
  3088         10  CPYAMTA PIC  X(0001).
  3089     05  CPYAMTI PIC  S9(8)V99.
  3090*    -------------------------------
  3091     05  CRESVL PIC S9(0004) COMP.
  3092     05  CRESVF PIC  X(0001).
  3093     05  FILLER REDEFINES CRESVF.
  3094         10  CRESVA PIC  X(0001).
  3095     05  CRESVI PIC  9(6)V99.
  3096*    -------------------------------
  3097     05  CEXPENSL PIC S9(0004) COMP.
  3098     05  CEXPENSF PIC  X(0001).
  3099     05  FILLER REDEFINES CEXPENSF.
  3100         10  CEXPENSA PIC  X(0001).
  3101     05  CEXPENSI PIC  9(6)V99.
  3102*    -------------------------------
  3103     05  ERRMSG0L PIC S9(0004) COMP.
  3104     05  ERRMSG0F PIC  X(0001).
  3105     05  FILLER REDEFINES ERRMSG0F.
  3106         10  ERRMSG0A PIC  X(0001).
  3107     05  ERRMSG0I PIC  X(0072).
  3108*    -------------------------------
  3109     05  ERRMSG1L PIC S9(0004) COMP.
  3110     05  ERRMSG1F PIC  X(0001).
  3111     05  FILLER REDEFINES ERRMSG1F.
  3112         10  ERRMSG1A PIC  X(0001).
  3113     05  ERRMSG1I PIC  X(0072).
  3114*    -------------------------------
  3115     05  ERRMSG2L PIC S9(0004) COMP.
  3116     05  ERRMSG2F PIC  X(0001).
  3117     05  FILLER REDEFINES ERRMSG2F.
  3118         10  ERRMSG2A PIC  X(0001).
  3119     05  ERRMSG2I PIC  X(0072).
  3120*    -------------------------------
  3121     05  ENTERPFL PIC S9(0004) COMP.
  3122     05  ENTERPFF PIC  X(0001).
  3123     05  FILLER REDEFINES ENTERPFF.
  3124         10  ENTERPFA PIC  X(0001).
  3125     05  ENTERPFI PIC  99.
  3126*    -------------------------------
  3127     05  PF6TITL PIC S9(0004) COMP.
  3128     05  PF6TITF PIC  X(0001).
  3129     05  FILLER REDEFINES PF6TITF.
  3130         10  PF6TITA PIC  X(0001).
  3131     05  PF6TITI PIC  X(0016).
  3132 01  EL156AO REDEFINES EL156AI.
  3133     05  FILLER            PIC  X(0012).
  3134*    -------------------------------
  3135     05  FILLER            PIC  X(0003).
  3136     05  RUNDTEAO PIC  X(0008).
  3137*    -------------------------------
  3138     05  FILLER            PIC  X(0003).
  3139     05  RUNTIMAO PIC  99.99.
  3140*    -------------------------------
  3141     05  FILLER            PIC  X(0003).
  3142     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  63
* EL156.cbl
  3143*    -------------------------------
  3144     05  FILLER            PIC  X(0003).
  3145     05  CLMNOO PIC  X(0007).
  3146*    -------------------------------
  3147     05  FILLER            PIC  X(0003).
  3148     05  CARRO PIC  X(0001).
  3149*    -------------------------------
  3150     05  FILLER            PIC  X(0003).
  3151     05  CERTNOO PIC  X(0010).
  3152*    -------------------------------
  3153     05  FILLER            PIC  X(0003).
  3154     05  SUFXO PIC  X(0001).
  3155*    -------------------------------
  3156     05  FILLER            PIC  X(0003).
  3157     05  CLMTYPO PIC  X(0006).
  3158*    -------------------------------
  3159     05  FILLER            PIC  X(0003).
  3160     05  CLMSTATO PIC  X(0006).
  3161*    -------------------------------
  3162     05  FILLER            PIC  X(0003).
  3163     05  LSTNMEO PIC  X(0015).
  3164*    -------------------------------
  3165     05  FILLER            PIC  X(0003).
  3166     05  FSTNMEO PIC  X(0012).
  3167*    -------------------------------
  3168     05  FILLER            PIC  X(0003).
  3169     05  MINITO PIC  X(0001).
  3170*    -------------------------------
  3171     05  FILLER            PIC  X(0003).
  3172     05  PRIMHDGO PIC  X(0012).
  3173*    -------------------------------
  3174     05  FILLER            PIC  X(0003).
  3175     05  PCERTNOO PIC  X(0010).
  3176*    -------------------------------
  3177     05  FILLER            PIC  X(0003).
  3178     05  PSUFXO PIC  X(0001).
  3179*    -------------------------------
  3180     05  FILLER            PIC  X(0003).
  3181     05  STATUSO PIC  X(0010).
  3182*    -------------------------------
  3183     05  FILLER            PIC  X(0003).
  3184     05  LOANHO PIC  X(0014).
  3185*    -------------------------------
  3186     05  FILLER            PIC  X(0003).
  3187     05  LOANNOO PIC  X(0025).
  3188*    -------------------------------
  3189     05  FILLER            PIC  X(0003).
  3190     05  DUEDAYHO PIC  X(0008).
  3191*    -------------------------------
  3192     05  FILLER            PIC  X(0003).
  3193     05  DUEDAYO PIC  X(0002).
  3194*    -------------------------------
  3195     05  FILLER            PIC  X(0003).
  3196     05  ZINTHO PIC  X(0009).
  3197*    -------------------------------
  3198     05  FILLER            PIC  X(0003).
  3199     05  ZINTO PIC  9.99999.
  3200*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  64
* EL156.cbl
  3201     05  FILLER            PIC  X(0003).
  3202     05  PTHRHDGO PIC  X(0014).
  3203*    -------------------------------
  3204     05  FILLER            PIC  X(0003).
  3205     05  PDTHRUO PIC  X(0008).
  3206*    -------------------------------
  3207     05  FILLER            PIC  X(0003).
  3208     05  TOTPAIDO PIC  Z(6).99-.
  3209*    -------------------------------
  3210     05  FILLER            PIC  X(0003).
  3211     05  COVERO PIC  X(0010).
  3212*    -------------------------------
  3213     05  FILLER            PIC  X(0003).
  3214     05  INCURO PIC  X(0008).
  3215*    -------------------------------
  3216     05  FILLER            PIC  X(0003).
  3217     05  LSTDTEO PIC  X(0008).
  3218*    -------------------------------
  3219     05  FILLER            PIC  X(0003).
  3220     05  CRTSTATO PIC  X(0010).
  3221*    -------------------------------
  3222     05  FILLER            PIC  X(0003).
  3223     05  EFFECTO PIC  X(0008).
  3224*    -------------------------------
  3225     05  FILLER            PIC  X(0003).
  3226     05  TERMSO PIC  X(0011).
  3227*    -------------------------------
  3228     05  FILLER            PIC  X(0003).
  3229     05  STACCTO PIC  X(0013).
  3230*    -------------------------------
  3231     05  FILLER            PIC  X(0003).
  3232     05  EXPDTEHO PIC  X(0014).
  3233*    -------------------------------
  3234     05  FILLER            PIC  X(0003).
  3235     05  EXPDTEO PIC  X(0008).
  3236*    -------------------------------
  3237     05  FILLER            PIC  X(0003).
  3238     05  BENECAPO PIC  X(0013).
  3239*    -------------------------------
  3240     05  FILLER            PIC  X(0003).
  3241     05  BENEO PIC  Z(6).99.
  3242*    -------------------------------
  3243     05  FILLER            PIC  X(0003).
  3244     05  FORMTYPO PIC  X(0001).
  3245*    -------------------------------
  3246     05  FILLER            PIC  X(0003).
  3247     05  PMTTYPEO PIC  X(0001).
  3248*    -------------------------------
  3249     05  FILLER            PIC  X(0003).
  3250     05  PAYEEO PIC  X(0002).
  3251*    -------------------------------
  3252     05  FILLER            PIC  X(0003).
  3253     05  CHECKNOO PIC  X(0007).
  3254*    -------------------------------
  3255     05  FILLER            PIC  X(0003).
  3256     05  OFFLINEO PIC  X(0001).
  3257*    -------------------------------
  3258     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  65
* EL156.cbl
  3259     05  HOLDTILO PIC  99B99B99.
  3260*    -------------------------------
  3261     05  FILLER            PIC  X(0003).
  3262     05  NOTE1O PIC  X(0060).
  3263*    -------------------------------
  3264     05  FILLER            PIC  X(0003).
  3265     05  ITRB1O PIC  X(0008).
  3266*    -------------------------------
  3267     05  FILLER            PIC  X(0003).
  3268     05  NOTE2O PIC  X(0060).
  3269*    -------------------------------
  3270     05  FILLER            PIC  X(0003).
  3271     05  ITRB2O PIC  X(0010).
  3272*    -------------------------------
  3273     05  FILLER            PIC  X(0003).
  3274     05  EOBYNO PIC  X(0001).
  3275*    -------------------------------
  3276     05  FILLER            PIC  X(0003).
  3277     05  CLMFMYNO PIC  X(0001).
  3278*    -------------------------------
  3279     05  FILLER            PIC  X(0003).
  3280     05  SURVYYNO PIC  X(0001).
  3281*    -------------------------------
  3282     05  FILLER            PIC  X(0003).
  3283     05  SPRELYNO PIC  X(0001).
  3284*    -------------------------------
  3285     05  FILLER            PIC  X(0003).
  3286     05  PINTHO PIC  X(0004).
  3287*    -------------------------------
  3288     05  FILLER            PIC  X(0003).
  3289     05  PINTO PIC  Z,ZZ9.99.
  3290*    -------------------------------
  3291     05  FILLER            PIC  X(0003).
  3292     05  ITRBYNO PIC  X(0001).
  3293*    -------------------------------
  3294     05  FILLER            PIC  X(0003).
  3295     05  PROOFDTO PIC  99B99B99.
  3296*    -------------------------------
  3297     05  FILLER            PIC  X(0003).
  3298     05  AIGFRMHO PIC  X(0012).
  3299*    -------------------------------
  3300     05  FILLER            PIC  X(0003).
  3301     05  AIGFROMO PIC  99B99B99.
  3302*    -------------------------------
  3303     05  FILLER            PIC  X(0003).
  3304     05  PMTHDGAO PIC  X(0066).
  3305*    -------------------------------
  3306     05  FILLER            PIC  X(0003).
  3307     05  EPYFROMO PIC  99B99B99.
  3308*    -------------------------------
  3309     05  FILLER            PIC  X(0003).
  3310     05  EPYTHRUO PIC  99B99B99.
  3311*    -------------------------------
  3312     05  FILLER            PIC  X(0003).
  3313     05  EDAYSO PIC  Z(4)9-.
  3314*    -------------------------------
  3315     05  FILLER            PIC  X(0003).
  3316     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  66
* EL156.cbl
  3317*    -------------------------------
  3318     05  FILLER            PIC  X(0003).
  3319     05  ERESVO PIC  Z(5).99-.
  3320*    -------------------------------
  3321     05  FILLER            PIC  X(0003).
  3322     05  ETYPEO PIC  X(0001).
  3323*    -------------------------------
  3324     05  FILLER            PIC  X(0003).
  3325     05  EEXPENSO PIC  Z(5).99.
  3326*    -------------------------------
  3327     05  FILLER            PIC  X(0003).
  3328     05  CPYFROMO PIC  99B99B99.
  3329*    -------------------------------
  3330     05  FILLER            PIC  X(0003).
  3331     05  CPYTHRUO PIC  99B99B99.
  3332*    -------------------------------
  3333     05  FILLER            PIC  X(0003).
  3334     05  CDAYSO PIC  Z(4)9-.
  3335*    -------------------------------
  3336     05  FILLER            PIC  X(0003).
  3337     05  CPYAMTO PIC  Z(6).99-.
  3338*    -------------------------------
  3339     05  FILLER            PIC  X(0003).
  3340     05  CRESVO PIC  Z(5).99.
  3341*    -------------------------------
  3342     05  FILLER            PIC  X(0003).
  3343     05  CEXPENSO PIC  Z(5).99.
  3344*    -------------------------------
  3345     05  FILLER            PIC  X(0003).
  3346     05  ERRMSG0O PIC  X(0072).
  3347*    -------------------------------
  3348     05  FILLER            PIC  X(0003).
  3349     05  ERRMSG1O PIC  X(0072).
  3350*    -------------------------------
  3351     05  FILLER            PIC  X(0003).
  3352     05  ERRMSG2O PIC  X(0072).
  3353*    -------------------------------
  3354     05  FILLER            PIC  X(0003).
  3355     05  ENTERPFO PIC  X(0002).
  3356*    -------------------------------
  3357     05  FILLER            PIC  X(0003).
  3358     05  PF6TITO PIC  X(0016).
  3359*    -------------------------------
  3360 01  EL156BI REDEFINES EL156AI.
  3361     05  FILLER            PIC  X(0012).
  3362*    -------------------------------
  3363     05  RUNDTEBL PIC S9(0004) COMP.
  3364     05  RUNDTEBF PIC  X(0001).
  3365     05  FILLER REDEFINES RUNDTEBF.
  3366         10  RUNDTEBA PIC  X(0001).
  3367     05  RUNDTEBI PIC  X(0008).
  3368*    -------------------------------
  3369     05  RUNTIMBL PIC S9(0004) COMP.
  3370     05  RUNTIMBF PIC  X(0001).
  3371     05  FILLER REDEFINES RUNTIMBF.
  3372         10  RUNTIMBA PIC  X(0001).
  3373     05  RUNTIMBI PIC  X(0005).
  3374*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  67
* EL156.cbl
  3375     05  PAYDTBL PIC S9(0004) COMP.
  3376     05  PAYDTBF PIC  X(0001).
  3377     05  FILLER REDEFINES PAYDTBF.
  3378         10  PAYDTBA PIC  X(0001).
  3379     05  PAYDTBI PIC  X(0008).
  3380*    -------------------------------
  3381     05  PAYTYPBL PIC S9(0004) COMP.
  3382     05  PAYTYPBF PIC  X(0001).
  3383     05  FILLER REDEFINES PAYTYPBF.
  3384         10  PAYTYPBA PIC  X(0001).
  3385     05  PAYTYPBI PIC  X(0015).
  3386*    -------------------------------
  3387     05  PAYAMTBL PIC S9(0004) COMP.
  3388     05  PAYAMTBF PIC  X(0001).
  3389     05  FILLER REDEFINES PAYAMTBF.
  3390         10  PAYAMTBA PIC  X(0001).
  3391     05  PAYAMTBI PIC  X(0011).
  3392*    -------------------------------
  3393     05  LOANHBL PIC S9(0004) COMP.
  3394     05  LOANHBF PIC  X(0001).
  3395     05  FILLER REDEFINES LOANHBF.
  3396         10  LOANHBA PIC  X(0001).
  3397     05  LOANHBI PIC  X(0012).
  3398*    -------------------------------
  3399     05  LOANNBL PIC S9(0004) COMP.
  3400     05  LOANNBF PIC  X(0001).
  3401     05  FILLER REDEFINES LOANNBF.
  3402         10  LOANNBA PIC  X(0001).
  3403     05  LOANNBI PIC  X(0025).
  3404*    -------------------------------
  3405     05  CKNUMHDL PIC S9(0004) COMP.
  3406     05  CKNUMHDF PIC  X(0001).
  3407     05  FILLER REDEFINES CKNUMHDF.
  3408         10  CKNUMHDA PIC  X(0001).
  3409     05  CKNUMHDI PIC  X(0012).
  3410*    -------------------------------
  3411     05  CKNUMBL PIC S9(0004) COMP.
  3412     05  CKNUMBF PIC  X(0001).
  3413     05  FILLER REDEFINES CKNUMBF.
  3414         10  CKNUMBA PIC  X(0001).
  3415     05  CKNUMBI PIC  X(0007).
  3416*    -------------------------------
  3417     05  AGTHDGL PIC S9(0004) COMP.
  3418     05  AGTHDGF PIC  X(0001).
  3419     05  FILLER REDEFINES AGTHDGF.
  3420         10  AGTHDGA PIC  X(0001).
  3421     05  AGTHDGI PIC  X(0016).
  3422*    -------------------------------
  3423     05  NAMEBL PIC S9(0004) COMP.
  3424     05  NAMEBF PIC  X(0001).
  3425     05  FILLER REDEFINES NAMEBF.
  3426         10  NAMEBA PIC  X(0001).
  3427     05  NAMEBI PIC  X(0030).
  3428*    -------------------------------
  3429     05  NAMEB2L PIC S9(0004) COMP.
  3430     05  NAMEB2F PIC  X(0001).
  3431     05  FILLER REDEFINES NAMEB2F.
  3432         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  68
* EL156.cbl
  3433     05  NAMEB2I PIC  X(0030).
  3434*    -------------------------------
  3435     05  ADDR1BL PIC S9(0004) COMP.
  3436     05  ADDR1BF PIC  X(0001).
  3437     05  FILLER REDEFINES ADDR1BF.
  3438         10  ADDR1BA PIC  X(0001).
  3439     05  ADDR1BI PIC  X(0030).
  3440*    -------------------------------
  3441     05  ADDR1B2L PIC S9(0004) COMP.
  3442     05  ADDR1B2F PIC  X(0001).
  3443     05  FILLER REDEFINES ADDR1B2F.
  3444         10  ADDR1B2A PIC  X(0001).
  3445     05  ADDR1B2I PIC  X(0030).
  3446*    -------------------------------
  3447     05  ADDR2BL PIC S9(0004) COMP.
  3448     05  ADDR2BF PIC  X(0001).
  3449     05  FILLER REDEFINES ADDR2BF.
  3450         10  ADDR2BA PIC  X(0001).
  3451     05  ADDR2BI PIC  X(0030).
  3452*    -------------------------------
  3453     05  ADDR2B2L PIC S9(0004) COMP.
  3454     05  ADDR2B2F PIC  X(0001).
  3455     05  FILLER REDEFINES ADDR2B2F.
  3456         10  ADDR2B2A PIC  X(0001).
  3457     05  ADDR2B2I PIC  X(0030).
  3458*    -------------------------------
  3459     05  CITYSTBL PIC S9(0004) COMP.
  3460     05  CITYSTBF PIC  X(0001).
  3461     05  FILLER REDEFINES CITYSTBF.
  3462         10  CITYSTBA PIC  X(0001).
  3463     05  CITYSTBI PIC  X(0030).
  3464*    -------------------------------
  3465     05  CITYST2L PIC S9(0004) COMP.
  3466     05  CITYST2F PIC  X(0001).
  3467     05  FILLER REDEFINES CITYST2F.
  3468         10  CITYST2A PIC  X(0001).
  3469     05  CITYST2I PIC  X(0030).
  3470*    -------------------------------
  3471     05  ZIPBL PIC S9(0004) COMP.
  3472     05  ZIPBF PIC  X(0001).
  3473     05  FILLER REDEFINES ZIPBF.
  3474         10  ZIPBA PIC  X(0001).
  3475     05  ZIPBI PIC  X(0009).
  3476*    -------------------------------
  3477     05  ZIPB2L PIC S9(0004) COMP.
  3478     05  ZIPB2F PIC  X(0001).
  3479     05  FILLER REDEFINES ZIPB2F.
  3480         10  ZIPB2A PIC  X(0001).
  3481     05  ZIPB2I PIC  X(0009).
  3482*    -------------------------------
  3483     05  INTHDBL PIC S9(0004) COMP.
  3484     05  INTHDBF PIC  X(0001).
  3485     05  FILLER REDEFINES INTHDBF.
  3486         10  INTHDBA PIC  X(0001).
  3487     05  INTHDBI PIC  X(0012).
  3488*    -------------------------------
  3489     05  INTAMTBL PIC S9(0004) COMP.
  3490     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  69
* EL156.cbl
  3491     05  FILLER REDEFINES INTAMTBF.
  3492         10  INTAMTBA PIC  X(0001).
  3493     05  INTAMTBI PIC  X(0011).
  3494*    -------------------------------
  3495     05  PMTHDGBL PIC S9(0004) COMP.
  3496     05  PMTHDGBF PIC  X(0001).
  3497     05  FILLER REDEFINES PMTHDGBF.
  3498         10  PMTHDGBA PIC  X(0001).
  3499     05  PMTHDGBI PIC  X(0034).
  3500*    -------------------------------
  3501     05  CLMNOBL PIC S9(0004) COMP.
  3502     05  CLMNOBF PIC  X(0001).
  3503     05  FILLER REDEFINES CLMNOBF.
  3504         10  CLMNOBA PIC  X(0001).
  3505     05  CLMNOBI PIC  X(0007).
  3506*    -------------------------------
  3507     05  CARRBL PIC S9(0004) COMP.
  3508     05  CARRBF PIC  X(0001).
  3509     05  FILLER REDEFINES CARRBF.
  3510         10  CARRBA PIC  X(0001).
  3511     05  CARRBI PIC  X(0001).
  3512*    -------------------------------
  3513     05  CERTNOBL PIC S9(0004) COMP.
  3514     05  CERTNOBF PIC  X(0001).
  3515     05  FILLER REDEFINES CERTNOBF.
  3516         10  CERTNOBA PIC  X(0001).
  3517     05  CERTNOBI PIC  X(0010).
  3518*    -------------------------------
  3519     05  SUFXBL PIC S9(0004) COMP.
  3520     05  SUFXBF PIC  X(0001).
  3521     05  FILLER REDEFINES SUFXBF.
  3522         10  SUFXBA PIC  X(0001).
  3523     05  SUFXBI PIC  X(0001).
  3524*    -------------------------------
  3525     05  CLMTYPBL PIC S9(0004) COMP.
  3526     05  CLMTYPBF PIC  X(0001).
  3527     05  FILLER REDEFINES CLMTYPBF.
  3528         10  CLMTYPBA PIC  X(0001).
  3529     05  CLMTYPBI PIC  X(0006).
  3530*    -------------------------------
  3531     05  INCURBL PIC S9(0004) COMP.
  3532     05  INCURBF PIC  X(0001).
  3533     05  FILLER REDEFINES INCURBF.
  3534         10  INCURBA PIC  X(0001).
  3535     05  INCURBI PIC  X(0008).
  3536*    -------------------------------
  3537     05  PYFROMBL PIC S9(0004) COMP.
  3538     05  PYFROMBF PIC  X(0001).
  3539     05  FILLER REDEFINES PYFROMBF.
  3540         10  PYFROMBA PIC  X(0001).
  3541     05  PYFROMBI PIC  X(0008).
  3542*    -------------------------------
  3543     05  PYTHRUBL PIC S9(0004) COMP.
  3544     05  PYTHRUBF PIC  X(0001).
  3545     05  FILLER REDEFINES PYTHRUBF.
  3546         10  PYTHRUBA PIC  X(0001).
  3547     05  PYTHRUBI PIC  X(0008).
  3548*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  70
* EL156.cbl
  3549     05  DAYSBL PIC S9(0004) COMP.
  3550     05  DAYSBF PIC  X(0001).
  3551     05  FILLER REDEFINES DAYSBF.
  3552         10  DAYSBA PIC  X(0001).
  3553     05  DAYSBI PIC  X(0005).
  3554*    -------------------------------
  3555     05  BYBL PIC S9(0004) COMP.
  3556     05  BYBF PIC  X(0001).
  3557     05  FILLER REDEFINES BYBF.
  3558         10  BYBA PIC  X(0001).
  3559     05  BYBI PIC  X(0004).
  3560*    -------------------------------
  3561     05  PROOFDBL PIC S9(0004) COMP.
  3562     05  PROOFDBF PIC  X(0001).
  3563     05  FILLER REDEFINES PROOFDBF.
  3564         10  PROOFDBA PIC  X(0001).
  3565     05  PROOFDBI PIC  X(0008).
  3566*    -------------------------------
  3567     05  ACCTBL PIC S9(0004) COMP.
  3568     05  ACCTBF PIC  X(0001).
  3569     05  FILLER REDEFINES ACCTBF.
  3570         10  ACCTBA PIC  X(0001).
  3571     05  ACCTBI PIC  X(0010).
  3572*    -------------------------------
  3573     05  STATEBL PIC S9(0004) COMP.
  3574     05  STATEBF PIC  X(0001).
  3575     05  FILLER REDEFINES STATEBF.
  3576         10  STATEBA PIC  X(0001).
  3577     05  STATEBI PIC  X(0002).
  3578*    -------------------------------
  3579     05  GROUPBL PIC S9(0004) COMP.
  3580     05  GROUPBF PIC  X(0001).
  3581     05  FILLER REDEFINES GROUPBF.
  3582         10  GROUPBA PIC  X(0001).
  3583     05  GROUPBI PIC  X(0006).
  3584*    -------------------------------
  3585     05  ACARRBL PIC S9(0004) COMP.
  3586     05  ACARRBF PIC  X(0001).
  3587     05  FILLER REDEFINES ACARRBF.
  3588         10  ACARRBA PIC  X(0001).
  3589     05  ACARRBI PIC  X(0001).
  3590*    -------------------------------
  3591     05  ACCTNMBL PIC S9(0004) COMP.
  3592     05  ACCTNMBF PIC  X(0001).
  3593     05  FILLER REDEFINES ACCTNMBF.
  3594         10  ACCTNMBA PIC  X(0001).
  3595     05  ACCTNMBI PIC  X(0030).
  3596*    -------------------------------
  3597     05  UNDISBL PIC S9(0004) COMP.
  3598     05  UNDISBF PIC  X(0001).
  3599     05  FILLER REDEFINES UNDISBF.
  3600         10  UNDISBA PIC  X(0001).
  3601     05  UNDISBI PIC  X(0010).
  3602*    -------------------------------
  3603     05  RATEBL PIC S9(0004) COMP.
  3604     05  RATEBF PIC  X(0001).
  3605     05  FILLER REDEFINES RATEBF.
  3606         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  71
* EL156.cbl
  3607     05  RATEBI PIC  X(0006).
  3608*    -------------------------------
  3609     05  ERMSG1BL PIC S9(0004) COMP.
  3610     05  ERMSG1BF PIC  X(0001).
  3611     05  FILLER REDEFINES ERMSG1BF.
  3612         10  ERMSG1BA PIC  X(0001).
  3613     05  ERMSG1BI PIC  X(0072).
  3614*    -------------------------------
  3615     05  ENTPFBL PIC S9(0004) COMP.
  3616     05  ENTPFBF PIC  X(0001).
  3617     05  FILLER REDEFINES ENTPFBF.
  3618         10  ENTPFBA PIC  X(0001).
  3619     05  ENTPFBI PIC  99.
  3620 01  EL156BO REDEFINES EL156AI.
  3621     05  FILLER            PIC  X(0012).
  3622*    -------------------------------
  3623     05  FILLER            PIC  X(0003).
  3624     05  RUNDTEBO PIC  X(0008).
  3625*    -------------------------------
  3626     05  FILLER            PIC  X(0003).
  3627     05  RUNTIMBO PIC  99.99.
  3628*    -------------------------------
  3629     05  FILLER            PIC  X(0003).
  3630     05  PAYDTBO PIC  99B99B99.
  3631*    -------------------------------
  3632     05  FILLER            PIC  X(0003).
  3633     05  PAYTYPBO PIC  X(0015).
  3634*    -------------------------------
  3635     05  FILLER            PIC  X(0003).
  3636     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3637*    -------------------------------
  3638     05  FILLER            PIC  X(0003).
  3639     05  LOANHBO PIC  X(0012).
  3640*    -------------------------------
  3641     05  FILLER            PIC  X(0003).
  3642     05  LOANNBO PIC  X(0025).
  3643*    -------------------------------
  3644     05  FILLER            PIC  X(0003).
  3645     05  CKNUMHDO PIC  X(0012).
  3646*    -------------------------------
  3647     05  FILLER            PIC  X(0003).
  3648     05  CKNUMBO PIC  X(0007).
  3649*    -------------------------------
  3650     05  FILLER            PIC  X(0003).
  3651     05  AGTHDGO PIC  X(0016).
  3652*    -------------------------------
  3653     05  FILLER            PIC  X(0003).
  3654     05  NAMEBO PIC  X(0030).
  3655*    -------------------------------
  3656     05  FILLER            PIC  X(0003).
  3657     05  NAMEB2O PIC  X(0030).
  3658*    -------------------------------
  3659     05  FILLER            PIC  X(0003).
  3660     05  ADDR1BO PIC  X(0030).
  3661*    -------------------------------
  3662     05  FILLER            PIC  X(0003).
  3663     05  ADDR1B2O PIC  X(0030).
  3664*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  72
* EL156.cbl
  3665     05  FILLER            PIC  X(0003).
  3666     05  ADDR2BO PIC  X(0030).
  3667*    -------------------------------
  3668     05  FILLER            PIC  X(0003).
  3669     05  ADDR2B2O PIC  X(0030).
  3670*    -------------------------------
  3671     05  FILLER            PIC  X(0003).
  3672     05  CITYSTBO PIC  X(0030).
  3673*    -------------------------------
  3674     05  FILLER            PIC  X(0003).
  3675     05  CITYST2O PIC  X(0030).
  3676*    -------------------------------
  3677     05  FILLER            PIC  X(0003).
  3678     05  ZIPBO PIC  ZZZZ99999.
  3679*    -------------------------------
  3680     05  FILLER            PIC  X(0003).
  3681     05  ZIPB2O PIC  ZZZZZZZZZ.
  3682*    -------------------------------
  3683     05  FILLER            PIC  X(0003).
  3684     05  INTHDBO PIC  X(0012).
  3685*    -------------------------------
  3686     05  FILLER            PIC  X(0003).
  3687     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3688*    -------------------------------
  3689     05  FILLER            PIC  X(0003).
  3690     05  PMTHDGBO PIC  X(0034).
  3691*    -------------------------------
  3692     05  FILLER            PIC  X(0003).
  3693     05  CLMNOBO PIC  X(0007).
  3694*    -------------------------------
  3695     05  FILLER            PIC  X(0003).
  3696     05  CARRBO PIC  X(0001).
  3697*    -------------------------------
  3698     05  FILLER            PIC  X(0003).
  3699     05  CERTNOBO PIC  X(0010).
  3700*    -------------------------------
  3701     05  FILLER            PIC  X(0003).
  3702     05  SUFXBO PIC  X(0001).
  3703*    -------------------------------
  3704     05  FILLER            PIC  X(0003).
  3705     05  CLMTYPBO PIC  X(0006).
  3706*    -------------------------------
  3707     05  FILLER            PIC  X(0003).
  3708     05  INCURBO PIC  X(0008).
  3709*    -------------------------------
  3710     05  FILLER            PIC  X(0003).
  3711     05  PYFROMBO PIC  99B99B99.
  3712*    -------------------------------
  3713     05  FILLER            PIC  X(0003).
  3714     05  PYTHRUBO PIC  99B99B99.
  3715*    -------------------------------
  3716     05  FILLER            PIC  X(0003).
  3717     05  DAYSBO PIC  X(0005).
  3718*    -------------------------------
  3719     05  FILLER            PIC  X(0003).
  3720     05  BYBO PIC  X(0004).
  3721*    -------------------------------
  3722     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  73
* EL156.cbl
  3723     05  PROOFDBO PIC  99B99B99.
  3724*    -------------------------------
  3725     05  FILLER            PIC  X(0003).
  3726     05  ACCTBO PIC  X(0010).
  3727*    -------------------------------
  3728     05  FILLER            PIC  X(0003).
  3729     05  STATEBO PIC  X(0002).
  3730*    -------------------------------
  3731     05  FILLER            PIC  X(0003).
  3732     05  GROUPBO PIC  X(0006).
  3733*    -------------------------------
  3734     05  FILLER            PIC  X(0003).
  3735     05  ACARRBO PIC  X(0001).
  3736*    -------------------------------
  3737     05  FILLER            PIC  X(0003).
  3738     05  ACCTNMBO PIC  X(0030).
  3739*    -------------------------------
  3740     05  FILLER            PIC  X(0003).
  3741     05  UNDISBO PIC  ZZZ,Z99.99.
  3742*    -------------------------------
  3743     05  FILLER            PIC  X(0003).
  3744     05  RATEBO PIC  ZZZ.99.
  3745*    -------------------------------
  3746     05  FILLER            PIC  X(0003).
  3747     05  ERMSG1BO PIC  X(0072).
  3748*    -------------------------------
  3749     05  FILLER            PIC  X(0003).
  3750     05  ENTPFBO PIC  X(0002).
  3751*    -------------------------------
  3752****************************************************************
  3753*
  3754* Copyright (c) 2007 by Clerity Solutions, Inc.
  3755* All rights reserved.
  3756*
  3757****************************************************************
  3758 01  DFHEIV.
  3759   02  DFHEIV0               PIC X(35).
  3760   02  DFHEIV1               PIC X(08).
  3761   02  DFHEIV2               PIC X(08).
  3762   02  DFHEIV3               PIC X(08).
  3763   02  DFHEIV4               PIC X(06).
  3764   02  DFHEIV5               PIC X(04).
  3765   02  DFHEIV6               PIC X(04).
  3766   02  DFHEIV7               PIC X(02).
  3767   02  DFHEIV8               PIC X(02).
  3768   02  DFHEIV9               PIC X(01).
  3769   02  DFHEIV10              PIC S9(7) COMP-3.
  3770   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3771   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3772   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3773   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3774   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3775   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3776   02  DFHEIV17              PIC X(04).
  3777   02  DFHEIV18              PIC X(04).
  3778   02  DFHEIV19              PIC X(04).
  3779   02  DFHEIV20              USAGE IS POINTER.
  3780   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  74
* EL156.cbl
  3781   02  DFHEIV22              USAGE IS POINTER.
  3782   02  DFHEIV23              USAGE IS POINTER.
  3783   02  DFHEIV24              USAGE IS POINTER.
  3784   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3785   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3786   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3787   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3788   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3789   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3790   02  FILLER                PIC X(02).
  3791   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3792   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3793   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3794   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3795   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3796 LINKAGE  SECTION.
  3797*****************************************************************
  3798*                                                               *
  3799* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3800* All rights reserved.                                          *
  3801*                                                               *
  3802*****************************************************************
  3803 01  dfheiblk.
  3804     02  eibtime          pic s9(7) comp-3.
  3805     02  eibdate          pic s9(7) comp-3.
  3806     02  eibtrnid         pic x(4).
  3807     02  eibtaskn         pic s9(7) comp-3.
  3808     02  eibtrmid         pic x(4).
  3809     02  dfheigdi         pic s9(4) comp.
  3810     02  eibcposn         pic s9(4) comp.
  3811     02  eibcalen         pic s9(4) comp.
  3812     02  eibaid           pic x(1).
  3813     02  eibfiller1       pic x(1).
  3814     02  eibfn            pic x(2).
  3815     02  eibfiller2       pic x(2).
  3816     02  eibrcode         pic x(6).
  3817     02  eibfiller3       pic x(2).
  3818     02  eibds            pic x(8).
  3819     02  eibreqid         pic x(8).
  3820     02  eibrsrce         pic x(8).
  3821     02  eibsync          pic x(1).
  3822     02  eibfree          pic x(1).
  3823     02  eibrecv          pic x(1).
  3824     02  eibsend          pic x(1).
  3825     02  eibatt           pic x(1).
  3826     02  eibeoc           pic x(1).
  3827     02  eibfmh           pic x(1).
  3828     02  eibcompl         pic x(1).
  3829     02  eibsig           pic x(1).
  3830     02  eibconf          pic x(1).
  3831     02  eiberr           pic x(1).
  3832     02  eibrldbk         pic x(1).
  3833     02  eiberrcd         pic x(4).
  3834     02  eibsynrb         pic x(1).
  3835     02  eibnodat         pic x(1).
  3836     02  eibfiller5       pic x(2).
  3837     02  eibresp          pic 9(09) comp.
  3838     02  eibresp2         pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  75
* EL156.cbl
  3839     02  dfheigdj         pic s9(4) comp.
  3840     02  dfheigdk         pic s9(4) comp.
  3841 01  DFHCOMMAREA             PIC X(1024).
  3842
  3843*    COPY ELCMSTR.
  3844******************************************************************
  3845*                                                                *
  3846*                            ELCMSTR.                            *
  3847*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3848*                            VMOD=2.012                          *
  3849*                                                                *
  3850*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3851*                                                                *
  3852*   FILE TYPE = VSAM,KSDS                                        *
  3853*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3854*                                                                *
  3855*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3856*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3857*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3858*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3859*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3860*                                                 RKP=75,LEN=21  *
  3861*                                                                *
  3862*   **** NOTE ****                                               *
  3863*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3864*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3865*                                                                *
  3866*   LOG = YES                                                    *
  3867*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3868******************************************************************
  3869*                   C H A N G E   L O G
  3870*
  3871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3872*-----------------------------------------------------------------
  3873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3874* EFFECTIVE    NUMBER
  3875*-----------------------------------------------------------------
  3876* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3877* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3878* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3879* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3880* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3881******************************************************************
  3882 01  CLAIM-MASTER.
  3883     12  CL-RECORD-ID                PIC XX.
  3884         88  VALID-CL-ID         VALUE 'CL'.
  3885
  3886     12  CL-CONTROL-PRIMARY.
  3887         16  CL-COMPANY-CD           PIC X.
  3888         16  CL-CARRIER              PIC X.
  3889         16  CL-CLAIM-NO             PIC X(7).
  3890         16  CL-CERT-NO.
  3891             20  CL-CERT-PRIME       PIC X(10).
  3892             20  CL-CERT-SFX         PIC X.
  3893
  3894     12  CL-CONTROL-BY-NAME.
  3895         16  CL-COMPANY-CD-A1        PIC X.
  3896         16  CL-INSURED-LAST-NAME    PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  76
* EL156.cbl
  3897         16  CL-INSURED-NAME.
  3898             20  CL-INSURED-1ST-NAME PIC X(12).
  3899             20  CL-INSURED-MID-INIT PIC X.
  3900
  3901     12  CL-CONTROL-BY-SSN.
  3902         16  CL-COMPANY-CD-A2        PIC X.
  3903         16  CL-SOC-SEC-NO.
  3904             20  CL-SSN-STATE        PIC XX.
  3905             20  CL-SSN-ACCOUNT      PIC X(6).
  3906             20  CL-SSN-LN3          PIC X(3).
  3907
  3908     12  CL-CONTROL-BY-CERT-NO.
  3909         16  CL-COMPANY-CD-A4        PIC X.
  3910         16  CL-CERT-NO-A4.
  3911             20  CL-CERT-A4-PRIME    PIC X(10).
  3912             20  CL-CERT-A4-SFX      PIC X.
  3913
  3914     12  CL-CONTROL-BY-CCN.
  3915         16  CL-COMPANY-CD-A5        PIC X.
  3916         16  CL-CCN-A5.
  3917             20  CL-CCN.
  3918                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3919                 24  CL-CCN-PRIME-A5 PIC X(12).
  3920             20  CL-CCN-FILLER-A5    PIC X(4).
  3921
  3922     12  CL-INSURED-PROFILE-DATA.
  3923         16  CL-INSURED-BIRTH-DT     PIC XX.
  3924         16  CL-INSURED-SEX-CD       PIC X.
  3925             88  INSURED-IS-MALE        VALUE 'M'.
  3926             88  INSURED-IS-FEMALE      VALUE 'F'.
  3927             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3928         16  CL-INSURED-OCC-CD       PIC X(6).
  3929         16  FILLER                  PIC X(5).
  3930
  3931     12  CL-PROCESSING-INFO.
  3932         16  CL-PROCESSOR-ID         PIC X(4).
  3933         16  CL-CLAIM-STATUS         PIC X.
  3934             88  CLAIM-IS-OPEN          VALUE 'O'.
  3935             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3936         16  CL-CLAIM-TYPE           PIC X.
  3937*            88  AH-CLAIM               VALUE 'A'.
  3938*            88  LIFE-CLAIM             VALUE 'L'.
  3939*            88  PROPERTY-CLAIM         VALUE 'P'.
  3940*            88  IUI-CLAIM              VALUE 'I'.
  3941*            88  GAP-CLAIM              VALUE 'G'.
  3942*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3943         16  CL-CLAIM-PREM-TYPE      PIC X.
  3944             88  SINGLE-PREMIUM         VALUE '1'.
  3945             88  O-B-COVERAGE           VALUE '2'.
  3946             88  OPEN-END-COVERAGE      VALUE '3'.
  3947         16  CL-INCURRED-DT          PIC XX.
  3948         16  CL-REPORTED-DT          PIC XX.
  3949         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3950         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3951         16  CL-LAST-PMT-DT          PIC XX.
  3952         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3953         16  CL-PAID-THRU-DT         PIC XX.
  3954         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  77
* EL156.cbl
  3955         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3956         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3957         16  CL-PMT-CALC-METHOD      PIC X.
  3958             88  CL-360-DAY-YR          VALUE '1'.
  3959             88  CL-365-DAY-YR          VALUE '2'.
  3960             88  CL-FULL-MONTHS         VALUE '3'.
  3961         16  CL-CAUSE-CD             PIC X(6).
  3962
  3963         16  CL-PRIME-CERT-NO.
  3964             20  CL-PRIME-CERT-PRIME PIC X(10).
  3965             20  CL-PRIME-CERT-SFX   PIC X.
  3966
  3967         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3968             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3969             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3970
  3971         16  CL-MICROFILM-NO         PIC X(10).
  3972         16  FILLER REDEFINES CL-MICROFILM-NO.
  3973             20  CL-BENEFIT-PERIOD   PIC 99.
  3974             20  FILLER              PIC X(8).
  3975         16  CL-PROG-FORM-TYPE       PIC X.
  3976         16  CL-LAST-ADD-ON-DT       PIC XX.
  3977
  3978         16  CL-LAST-REOPEN-DT       PIC XX.
  3979         16  CL-LAST-CLOSE-DT        PIC XX.
  3980         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3981             88  FINAL-PAID             VALUE '1'.
  3982             88  CLAIM-DENIED           VALUE '2'.
  3983             88  AUTO-CLOSE             VALUE '3'.
  3984             88  MANUAL-CLOSE           VALUE '4'.
  3985             88  BENEFITS-CHANGED       VALUE 'C'.
  3986             88  SETUP-ERRORS           VALUE 'E'.
  3987         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3988         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3989         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3990             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3991         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3992         16  FILLER                  PIC X.
  3993
  3994     12  CL-CERTIFICATE-DATA.
  3995         16  CL-CERT-ORIGIN          PIC X.
  3996             88  CERT-WAS-ONLINE        VALUE '1'.
  3997             88  CERT-WAS-CREATED       VALUE '2'.
  3998             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3999         16  CL-CERT-KEY-DATA.
  4000             20  CL-CERT-CARRIER     PIC X.
  4001             20  CL-CERT-GROUPING    PIC X(6).
  4002             20  CL-CERT-STATE       PIC XX.
  4003             20  CL-CERT-ACCOUNT.
  4004                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4005                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4006             20  CL-CERT-EFF-DT      PIC XX.
  4007
  4008     12  CL-STATUS-CONTROLS.
  4009         16  CL-PRIORITY-CD          PIC X.
  4010             88  CONFIDENTIAL-DATA      VALUE '8'.
  4011             88  HIGHEST-PRIORITY       VALUE '9'.
  4012         16  CL-SUPV-ATTN-CD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  78
* EL156.cbl
  4013             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4014             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4015         16  CL-PURGED-DT            PIC XX.
  4016         16  CL-RESTORED-DT          PIC XX.
  4017         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4018         16  CL-NEXT-RESEND-DT       PIC XX.
  4019         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4020         16  CL-CRITICAL-PERIOD      PIC 99.
  4021*        16  FILLER                  PIC XX.
  4022         16  CL-LAST-MAINT-DT        PIC XX.
  4023         16  CL-LAST-MAINT-USER      PIC X(4).
  4024         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4025         16  CL-LAST-MAINT-TYPE      PIC X.
  4026             88  CLAIM-SET-UP           VALUE ' '.
  4027             88  PAYMENT-MADE           VALUE '1'.
  4028             88  LETTER-SENT            VALUE '2'.
  4029             88  MASTER-WAS-ALTERED     VALUE '3'.
  4030             88  MASTER-WAS-RESTORED    VALUE '4'.
  4031             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4032             88  FILE-CONVERTED         VALUE '6'.
  4033             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4034             88  ERROR-CORRECTION       VALUE 'E'.
  4035         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4036         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4037         16  CL-BENEFICIARY          PIC X(10).
  4038         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4039         16  CL-DENIAL-TYPE          PIC X.
  4040             88  CL-TYPE-DENIAL          VALUE '1'.
  4041             88  CL-TYPE-RESCISSION      VALUE '2'.
  4042             88  CL-TYPE-REFORMATION     VALUE '3'.
  4043             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4044             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4045         16  filler                  pic x(5).
  4046*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4047*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4048*        16  CL-RTW-DT               PIC XX.
  4049
  4050     12  CL-TRAILER-CONTROLS.
  4051         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4052             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4053             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4054             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4055         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4056         16  FILLER                  PIC XX.
  4057         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4058         16  CL-ADDRESS-TRAILER-CNT.
  4059             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4060                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4061             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4062                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4063             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4064                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4065             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4066                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4067             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4068                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4069             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4070                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  79
* EL156.cbl
  4071             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4072                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4073
  4074     12  CL-CV-REFERENCE-NO.
  4075         16  CL-CV-REFNO-PRIME       PIC X(18).
  4076         16  CL-CV-REFNO-SFX         PIC XX.
  4077
  4078     12  CL-FILE-LOCATION            PIC X(4).
  4079
  4080     12  CL-PROCESS-ERRORS.
  4081         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4082             88  NO-FATAL-ERRORS        VALUE ZERO.
  4083         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4084             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4085
  4086     12  CL-PRODUCT-CD               PIC X.
  4087
  4088     12  CL-CURRENT-KEY-DATA.
  4089         16  CL-CURRENT-CARRIER      PIC X.
  4090         16  CL-CURRENT-GROUPING     PIC X(6).
  4091         16  CL-CURRENT-STATE        PIC XX.
  4092         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4093
  4094     12  CL-ASSOCIATES               PIC X.
  4095         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4096         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4097         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4098         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4099
  4100     12  CL-ACTIVITY-CODE            PIC 99.
  4101     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4102     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4103
  4104     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4105     12  CL-LAG-REPORT-CODE          PIC 9.
  4106     12  CL-LOAN-TYPE                PIC XX.
  4107     12  CL-LEGAL-STATE              PIC XX.
  4108
  4109     12  CL-YESNOSW                  PIC X.
  4110     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4111         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4112         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4113         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4114     12  cl-insured-type             pic x.
  4115         88  cl-claim-on-primary         value 'P'.
  4116         88  cl-claim-on-co-borrower     value 'C'.
  4117     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  80
* EL156.cbl
  4119*    COPY ELCCNTL.
  4120******************************************************************
  4121*                                                                *
  4122*                                                                *
  4123*                            ELCCNTL.                            *
  4124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4125*                            VMOD=2.059                          *
  4126*                                                                *
  4127*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4128*                                                                *
  4129*   FILE TYPE = VSAM,KSDS                                        *
  4130*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4131*                                                                *
  4132*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4133*       ALTERNATE INDEX = NONE                                   *
  4134*                                                                *
  4135*   LOG = YES                                                    *
  4136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4137******************************************************************
  4138*                   C H A N G E   L O G
  4139*
  4140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4141*-----------------------------------------------------------------
  4142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4143* EFFECTIVE    NUMBER
  4144*-----------------------------------------------------------------
  4145* 082503                   PEMA  ADD BENEFIT GROUP
  4146* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4147* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4148* 092705    2005050300006  PEMA  ADD SPP LEASES
  4149* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4150* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4151* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4152* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4153* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4154* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4155* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4156* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4157* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4158* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4159******************************************************************
  4160*
  4161 01  CONTROL-FILE.
  4162     12  CF-RECORD-ID                       PIC XX.
  4163         88  VALID-CF-ID                        VALUE 'CF'.
  4164
  4165     12  CF-CONTROL-PRIMARY.
  4166         16  CF-COMPANY-ID                  PIC XXX.
  4167         16  CF-RECORD-TYPE                 PIC X.
  4168             88  CF-COMPANY-MASTER              VALUE '1'.
  4169             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4170             88  CF-STATE-MASTER                VALUE '3'.
  4171             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4172             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4173             88  CF-CARRIER-MASTER              VALUE '6'.
  4174             88  CF-MORTALITY-MASTER            VALUE '7'.
  4175             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4176             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  81
* EL156.cbl
  4177             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4178             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4179             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4180             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4181             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4182             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4183             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4184             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4185             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4186         16  CF-ACCESS-CD-GENL              PIC X(4).
  4187         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4188             20  CF-PROCESSOR               PIC X(4).
  4189         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4190             20  CF-STATE-CODE              PIC XX.
  4191             20  FILLER                     PIC XX.
  4192         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4193             20  FILLER                     PIC XX.
  4194             20  CF-HI-BEN-IN-REC           PIC XX.
  4195         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4196             20  FILLER                     PIC XXX.
  4197             20  CF-CARRIER-CNTL            PIC X.
  4198         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4199             20  FILLER                     PIC XX.
  4200             20  CF-HI-TYPE-IN-REC          PIC 99.
  4201         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4202             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4203                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4204             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4205             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4206         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4207             20  FILLER                     PIC X.
  4208             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4209         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4210             20  FILLER                     PIC XX.
  4211             20  CF-MORTGAGE-PLAN           PIC XX.
  4212         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4213
  4214     12  CF-LAST-MAINT-DT                   PIC XX.
  4215     12  CF-LAST-MAINT-BY                   PIC X(4).
  4216     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4217
  4218     12  CF-RECORD-BODY                     PIC X(728).
  4219
  4220
  4221****************************************************************
  4222*             COMPANY MASTER RECORD                            *
  4223****************************************************************
  4224
  4225     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4226         16  CF-COMPANY-ADDRESS.
  4227             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4228             20  CF-CL-IN-CARE-OF           PIC X(30).
  4229             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4230             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4231             20  CF-CL-CITY-STATE           PIC X(30).
  4232             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4233             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4234         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  82
* EL156.cbl
  4235         16  CF-COMPANY-PASSWORD            PIC X(8).
  4236         16  CF-SECURITY-OPTION             PIC X.
  4237             88  ALL-SECURITY                   VALUE '1'.
  4238             88  COMPANY-VERIFY                 VALUE '2'.
  4239             88  PROCESSOR-VERIFY               VALUE '3'.
  4240             88  NO-SECURITY                    VALUE '4'.
  4241             88  ALL-BUT-TERM                   VALUE '5'.
  4242         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4243             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4244         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4245             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4246         16  CF-INFORCE-LOCATION            PIC X.
  4247             88  CERTS-ARE-ONLINE               VALUE '1'.
  4248             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4249             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4250         16  CF-LOWER-CASE-LETTERS          PIC X.
  4251         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4252             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4253             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4254             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4255             88  CF-ACCNT-CNTL                  VALUE '3'.
  4256             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4257
  4258         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4259         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4260
  4261         16  CF-LGX-CREDIT-USER             PIC X.
  4262             88  CO-IS-NOT-USER                 VALUE 'N'.
  4263             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4264
  4265         16 CF-CREDIT-CALC-CODES.
  4266             20  CF-CR-REM-TERM-CALC PIC X.
  4267               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4268               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4269               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4270               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4271               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4272               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4273               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4274             20  CF-CR-R78-METHOD           PIC X.
  4275               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4276               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4277
  4278         16  CF-CLAIM-CONTROL-COUNTS.
  4279             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4280                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4281
  4282             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4283                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4284
  4285             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4286                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4287
  4288             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4289                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4290
  4291         16  CF-CURRENT-MONTH-END           PIC XX.
  4292
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  83
* EL156.cbl
  4293         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4294             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4295             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4296             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4297             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4298                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4299                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4300             20  CF-CO-PREM-REJECT-SW       PIC X.
  4301                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4302                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4303             20  CF-CO-REF-REJECT-SW        PIC X.
  4304                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4305                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4306
  4307         16  CF-CO-REPORTING-DT             PIC XX.
  4308         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4309         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4310           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4311           88  CF-CO-MONTH-END                  VALUE '1'.
  4312
  4313         16  CF-LGX-CLAIM-USER              PIC X.
  4314             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4315             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4316
  4317         16  CF-CREDIT-EDIT-CONTROLS.
  4318             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4319             20  CF-MIN-AGE                 PIC 99.
  4320             20  CF-DEFAULT-AGE             PIC 99.
  4321             20  CF-MIN-TERM                PIC S999      COMP-3.
  4322             20  CF-MAX-TERM                PIC S999      COMP-3.
  4323             20  CF-DEFAULT-SEX             PIC X.
  4324             20  CF-JOINT-AGE-INPUT         PIC X.
  4325                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4326             20  CF-BIRTH-DATE-INPUT        PIC X.
  4327                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4328             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4329                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4330                 88  CF-ZERO-CARRIER            VALUE '1'.
  4331                 88  CF-ZERO-GROUPING           VALUE '2'.
  4332                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4333             20  CF-EDIT-SW                 PIC X.
  4334                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4335             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4336             20  CF-CR-PR-METHOD            PIC X.
  4337               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4338               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4339             20  FILLER                     PIC X.
  4340
  4341         16  CF-CREDIT-MISC-CONTROLS.
  4342             20  CF-REIN-TABLE-SW           PIC X.
  4343                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4344             20  CF-COMP-TABLE-SW           PIC X.
  4345                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4346             20  CF-EXPERIENCE-RETENTION-AGE
  4347                                            PIC S9        COMP-3.
  4348             20  CF-CONVERSION-DT           PIC XX.
  4349             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4350             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  84
* EL156.cbl
  4351                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4352                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4353
  4354             20  CF-CR-CHECK-NO-CONTROL.
  4355                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4356                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4357                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4358                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4359                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4360                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4361
  4362                 24  CF-CR-CHECK-COUNT       REDEFINES
  4363                     CF-CR-CHECK-COUNTER      PIC X(4).
  4364
  4365                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4366                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4367
  4368                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4369                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4370                 24  CF-MAIL-PROCESSING       PIC X.
  4371                     88  MAIL-PROCESSING          VALUE 'Y'.
  4372
  4373         16  CF-MISC-SYSTEM-CONTROL.
  4374             20  CF-SYSTEM-C                 PIC X.
  4375                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4376             20  CF-SYSTEM-D                 PIC X.
  4377                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4378             20  CF-SOC-SEC-NO-SW            PIC X.
  4379                 88  SOC-SEC-NO-USED             VALUE '1'.
  4380             20  CF-MEMBER-NO-SW             PIC X.
  4381                 88  MEMBER-NO-USED              VALUE '1'.
  4382             20  CF-TAX-ID-NUMBER            PIC X(11).
  4383             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4384             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4385                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4386                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4387                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4388                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4389             20  CF-SYSTEM-E                 PIC X.
  4390                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4391
  4392         16  CF-LGX-LIFE-USER               PIC X.
  4393             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4394             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4395
  4396         16  CF-CR-MONTH-END-DT             PIC XX.
  4397
  4398         16  CF-FILE-MAINT-DATES.
  4399             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4400                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4401             20  CF-LAST-BATCH       REDEFINES
  4402                 CF-LAST-BATCH-NO               PIC X(4).
  4403             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4404             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4405             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4406             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4407             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4408             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  85
* EL156.cbl
  4409             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4410             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4411             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4412             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4413
  4414         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4415         16  FILLER                         PIC X.
  4416
  4417         16  CF-ALT-MORT-CODE               PIC X(4).
  4418         16  CF-MEMBER-CAPTION              PIC X(10).
  4419
  4420         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4421             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4422             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4423             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4424             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4425             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4426
  4427         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4428
  4429         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4430         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4431         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4432         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4433
  4434         16  CF-AH-OVERRIDE-L1              PIC X.
  4435         16  CF-AH-OVERRIDE-L2              PIC XX.
  4436         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4437         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4438
  4439         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4440         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4441
  4442         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4443         16  CF-AR-LAST-EL860-DT            PIC XX.
  4444         16  CF-MP-MONTH-END-DT             PIC XX.
  4445
  4446         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4447         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4448             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4449
  4450         16  CF-AR-MONTH-END-DT             PIC XX.
  4451
  4452         16  CF-CRDTCRD-USER                PIC X.
  4453             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4454             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4455
  4456         16  CF-CC-MONTH-END-DT             PIC XX.
  4457
  4458         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4459
  4460         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4461             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4462             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4463             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4464         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4465         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4466         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  86
* EL156.cbl
  4467         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4468             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4469             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4470         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4471         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4472         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4473             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4474         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4475
  4476         16  CF-CL-ZIP-CODE.
  4477             20  CF-CL-ZIP-PRIME.
  4478                 24  CF-CL-ZIP-1ST          PIC X.
  4479                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4480                 24  FILLER                 PIC X(4).
  4481             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4482         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4483             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4484             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4485             20  FILLER                     PIC XXX.
  4486
  4487         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4488         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4489         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4490         16  CF-CO-OPTION-START-DATE        PIC XX.
  4491         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4492           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4493                                                      '3' '4'.
  4494           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4495           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4496           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4497           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4498           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4499           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4500
  4501         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4502
  4503         16  CF-PAYMENT-APPROVAL-LEVELS.
  4504             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4505             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4506             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4507             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4508             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4509             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4510
  4511         16  CF-END-USER-REPORTING-USER     PIC X.
  4512             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4513             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4514
  4515         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4516             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4517             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4518
  4519         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4520
  4521         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4522         16  FILLER                         PIC X.
  4523
  4524         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  87
* EL156.cbl
  4525             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4526             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4527             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4528
  4529         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4530
  4531         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4532             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4533             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4534
  4535         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4536             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4537             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4538
  4539         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4540
  4541         16  CF-CO-ACH-ID-CODE              PIC  X.
  4542             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4543             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4544             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4545         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4546         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4547         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4548         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4549         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4550         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4551         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4552         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4553         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4554                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4555         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4556                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4557
  4558         16  CF-CO-OVER-SHORT.
  4559             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4560             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4561
  4562*         16  FILLER                         PIC X(102).
  4563         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4564             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4565             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4566
  4567         16  CF-AH-APPROVAL-DAYS.
  4568             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4569             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4570             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4571             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4572
  4573         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4574
  4575         16  CF-APPROV-LEV-5.
  4576             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4577             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4578             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4579
  4580         16  FILLER                         PIC X(68).
  4581****************************************************************
  4582*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  88
* EL156.cbl
  4583****************************************************************
  4584
  4585     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4586         16  CF-PROCESSOR-NAME              PIC X(30).
  4587         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4588         16  CF-PROCESSOR-TITLE             PIC X(26).
  4589         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4590                 88  MESSAGE-YES                VALUE 'Y'.
  4591                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4592
  4593*****************************************************
  4594****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4595****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4596****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4597****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4598*****************************************************
  4599
  4600         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4601             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4602             20  CF-APPLICATION-FORCE       PIC X.
  4603             20  CF-INDIVIDUAL-APP.
  4604                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4605                     28  CF-BROWSE-APP      PIC X.
  4606                     28  CF-UPDATE-APP      PIC X.
  4607
  4608         16  CF-CURRENT-TERM-ON             PIC X(4).
  4609         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4610             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4611             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4612             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4613             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4614             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4615             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4616             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4617         16  CF-PROCESSOR-CARRIER           PIC X.
  4618             88  NO-CARRIER-SECURITY            VALUE ' '.
  4619         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4620             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4621         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4622             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4623         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4624             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4625
  4626         16  CF-PROC-SYS-ACCESS-SW.
  4627             20  CF-PROC-CREDIT-CLAIMS-SW.
  4628                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4629                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4630                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4631                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4632             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4633                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4634                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4635             20  CF-PROC-LIFE-GNRLDGR-SW.
  4636                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4637                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4638                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4639                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4640             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  89
* EL156.cbl
  4641                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4642                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4643         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4644             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4645             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4646         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4647
  4648         16  CF-APPROVAL-LEVEL                  PIC X.
  4649             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4650             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4651             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4652             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4653             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4654
  4655         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4656
  4657         16  CF-LANGUAGE-TYPE                   PIC X.
  4658             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4659             88  CF-LANG-IS-FR                      VALUE 'F'.
  4660
  4661         16  CF-CSR-IND                         PIC X.
  4662         16  FILLER                             PIC X(239).
  4663
  4664****************************************************************
  4665*             PROCESSOR/REMINDERS RECORD                       *
  4666****************************************************************
  4667
  4668     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4669         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4670             20  CF-START-REMIND-DT         PIC XX.
  4671             20  CF-END-REMIND-DT           PIC XX.
  4672             20  CF-REMINDER-TEXT           PIC X(50).
  4673         16  FILLER                         PIC X(296).
  4674
  4675
  4676****************************************************************
  4677*             STATE MASTER RECORD                              *
  4678****************************************************************
  4679
  4680     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4681         16  CF-STATE-ABBREVIATION          PIC XX.
  4682         16  CF-STATE-NAME                  PIC X(25).
  4683         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4684         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4685             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4686             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4687             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4688             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4689                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4690                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4691             20  CF-ST-PREM-REJECT-SW       PIC X.
  4692                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4693                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4694             20  CF-ST-REF-REJECT-SW        PIC X.
  4695                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4696                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4697         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4698         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  90
* EL156.cbl
  4699         16  CF-ST-REFUND-RULES.
  4700             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4701             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4702             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4703         16  CF-ST-FST-PMT-EXTENSION.
  4704             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4705             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4706                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4707                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4708                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4709                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4710         16  CF-ST-STATE-CALL.
  4711             20  CF-ST-CALL-UNEARNED        PIC X.
  4712             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4713             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4714         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4715             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4716             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4717         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4718         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4719         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4720         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4721         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4722         16  FILLER                         PIC X.
  4723         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4724             20  CF-ST-BENEFIT-CD           PIC XX.
  4725             20  CF-ST-BENEFIT-KIND         PIC X.
  4726                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4727                 88  CF-ST-AH-KIND              VALUE 'A'.
  4728             20  CF-ST-REM-TERM-CALC        PIC X.
  4729                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4730                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4731                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4732                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4733                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4734                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4735                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4736                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4737
  4738             20  CF-ST-REFUND-CALC          PIC X.
  4739                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4740                 88  ST-REFD-BY-R78             VALUE '1'.
  4741                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4742                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4743                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4744                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4745                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4746                 88  ST-REFD-UTAH               VALUE '7'.
  4747                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4748                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4749                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4750
  4751             20  CF-ST-EARNING-CALC         PIC X.
  4752                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4753                 88  ST-EARN-BY-R78             VALUE '1'.
  4754                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4755                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4756                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  91
* EL156.cbl
  4757                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4758                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4759                 88  ST-EARN-MEAN               VALUE '8'.
  4760                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4761
  4762             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4763                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4764                 88  ST-OVRD-BY-R78             VALUE '1'.
  4765                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4766                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4767                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4768                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4769                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4770                 88  ST-OVRD-MEAN               VALUE '8'.
  4771                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4772             20  cf-st-extra-periods        pic 9.
  4773*            20  FILLER                     PIC X.
  4774
  4775         16  CF-ST-COMMISSION-CAPS.
  4776             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4777             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4778             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4779             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4780         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4781                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4782
  4783         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4784
  4785         16  CF-ST-STATUTORY-INTEREST.
  4786             20  CF-ST-STAT-DATE-FROM       PIC X.
  4787                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4788                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4789             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4790             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4791             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4792             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4793             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4794
  4795         16  CF-ST-OVER-SHORT.
  4796             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4797             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4798
  4799         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4800
  4801         16  CF-ST-RT-CALC                  PIC X.
  4802
  4803         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4804         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4805         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4806         16  CF-ST-RF-LR-CALC               PIC X.
  4807         16  CF-ST-RF-LL-CALC               PIC X.
  4808         16  CF-ST-RF-LN-CALC               PIC X.
  4809         16  CF-ST-RF-AH-CALC               PIC X.
  4810         16  CF-ST-RF-CP-CALC               PIC X.
  4811*        16  FILLER                         PIC X(206).
  4812*CIDMOD         16  FILLER                         PIC X(192).
  4813         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4814             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  92
* EL156.cbl
  4815         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4816         16  CF-ST-VFY-2ND-BENE             PIC X.
  4817         16  CF-ST-CAUSAL-STATE             PIC X.
  4818         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4819         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4820         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4821             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4822         16  CF-ST-NET-ONLY-STATE           PIC X.
  4823             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4824         16  FILLER                         PIC X(181).
  4825
  4826****************************************************************
  4827*             BENEFIT MASTER RECORD                            *
  4828****************************************************************
  4829
  4830     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4831         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4832             20  CF-BENEFIT-CODE            PIC XX.
  4833             20  CF-BENEFIT-NUMERIC  REDEFINES
  4834                 CF-BENEFIT-CODE            PIC XX.
  4835             20  CF-BENEFIT-ALPHA           PIC XXX.
  4836             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4837             20  CF-BENEFIT-COMMENT         PIC X(10).
  4838
  4839             20  CF-LF-COVERAGE-TYPE        PIC X.
  4840                 88  CF-REDUCING                VALUE 'R'.
  4841                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4842
  4843             20  CF-SPECIAL-CALC-CD         PIC X.
  4844                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4845                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4846                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4847                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4848                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4849                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4850                 88  CF-FARM-PLAN               VALUE 'F'.
  4851                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4852                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4853                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4854                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4855                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4856                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4857                 88  CF-PRUDENTIAL              VALUE 'P'.
  4858                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4859                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4860                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4861                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4862                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4863                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4864
  4865             20  CF-JOINT-INDICATOR         PIC X.
  4866                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4867
  4868*            20  FILLER                     PIC X(12).
  4869             20  cf-maximum-benefits        pic s999 comp-3.
  4870             20  FILLER                     PIC X(09).
  4871             20  CF-BENEFIT-CATEGORY        PIC X.
  4872             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  93
* EL156.cbl
  4873
  4874             20  CF-CO-REM-TERM-CALC        PIC X.
  4875                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4876                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4877                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4878                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4879                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4880
  4881             20  CF-CO-EARNINGS-CALC        PIC X.
  4882                 88  CO-EARN-BY-R78             VALUE '1'.
  4883                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4884                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4885                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4886                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4887                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4888                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4889                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4890
  4891             20  CF-CO-REFUND-CALC          PIC X.
  4892                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4893                 88  CO-REFD-BY-R78             VALUE '1'.
  4894                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4895                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4896                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4897                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4898                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4899                 88  CO-REFD-MEAN               VALUE '8'.
  4900                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4901                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4902                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4903
  4904             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4905                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4906                 88  CO-OVRD-BY-R78             VALUE '1'.
  4907                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4908                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4909                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4910                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4911                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4912                 88  CO-OVRD-MEAN               VALUE '8'.
  4913                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4914
  4915             20  CF-CO-BEN-I-G-CD           PIC X.
  4916                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4917                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4918                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4919
  4920         16  FILLER                         PIC X(304).
  4921
  4922
  4923****************************************************************
  4924*             CARRIER MASTER RECORD                            *
  4925****************************************************************
  4926
  4927     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4928         16  CF-ADDRESS-DATA.
  4929             20  CF-MAIL-TO-NAME            PIC X(30).
  4930             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  94
* EL156.cbl
  4931             20  CF-ADDRESS-LINE-1          PIC X(30).
  4932             20  CF-ADDRESS-LINE-2          PIC X(30).
  4933             20  CF-CITY-STATE              PIC X(30).
  4934             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4935             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4936
  4937         16  CF-CLAIM-NO-CONTROL.
  4938             20  CF-CLAIM-NO-METHOD         PIC X.
  4939                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4940                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4941                 88  CLAIM-NO-SEQ               VALUE '3'.
  4942                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4943             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4944                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4945                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4946                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4947
  4948         16  CF-CHECK-NO-CONTROL.
  4949             20  CF-CHECK-NO-METHOD         PIC X.
  4950                 88  CHECK-NO-MANUAL            VALUE '1'.
  4951                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4952                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4953                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4954             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4955                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4956
  4957         16  CF-DOMICILE-STATE              PIC XX.
  4958
  4959         16  CF-EXPENSE-CONTROLS.
  4960             20  CF-EXPENSE-METHOD          PIC X.
  4961                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4962                 88  DOLLARS-PER-PMT            VALUE '2'.
  4963                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4964                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4965             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4966             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4967
  4968         16  CF-CORRESPONDENCE-CONTROL.
  4969             20  CF-LETTER-RESEND-OPT       PIC X.
  4970                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4971                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4972             20  FILLER                     PIC X(4).
  4973
  4974         16  CF-RESERVE-CONTROLS.
  4975             20  CF-MANUAL-SW               PIC X.
  4976                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4977             20  CF-FUTURE-SW               PIC X.
  4978                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4979             20  CF-PTC-SW                  PIC X.
  4980                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4981             20  CF-IBNR-SW                 PIC X.
  4982                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4983             20  CF-PTC-LF-SW               PIC X.
  4984                 88  CF-LF-PTC-USED             VALUE '1'.
  4985             20  CF-CDT-ACCESS-METHOD       PIC X.
  4986                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4987                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4988                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  95
* EL156.cbl
  4989             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4990
  4991         16  CF-CLAIM-CALC-METHOD           PIC X.
  4992             88  360-PLUS-MONTHS                VALUE '1'.
  4993             88  365-PLUS-MONTHS                VALUE '2'.
  4994             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4995             88  360-DAILY                      VALUE '4'.
  4996             88  365-DAILY                      VALUE '5'.
  4997
  4998         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4999         16  FILLER                         PIC X(11).
  5000
  5001         16  CF-LIMIT-AMOUNTS.
  5002             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5003             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5004             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5005             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5006             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5007             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5008             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5009             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5010             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5011             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5012
  5013         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5014         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5015         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5016
  5017         16  CF-ZIP-CODE.
  5018             20  CF-ZIP-PRIME.
  5019                 24  CF-ZIP-1ST             PIC X.
  5020                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5021                 24  FILLER                 PIC X(4).
  5022             20  CF-ZIP-PLUS4               PIC X(4).
  5023         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5024             20  CF-CAN-POSTAL-1            PIC XXX.
  5025             20  CF-CAN-POSTAL-2            PIC XXX.
  5026             20  FILLER                     PIC XXX.
  5027
  5028         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5029         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5030         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5031
  5032         16  CF-RATING-SWITCH               PIC X.
  5033             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5034             88  CF-NO-RATING                   VALUE 'N'.
  5035
  5036         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5037
  5038         16  CF-CARRIER-OVER-SHORT.
  5039             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5040             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5041
  5042         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5043         16  CF-SECPAY-SWITCH               PIC X.
  5044             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5045             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5046         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  96
* EL156.cbl
  5047         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5048         16  FILLER                         PIC X(444).
  5049*        16  FILLER                         PIC X(452).
  5050
  5051
  5052****************************************************************
  5053*             MORTALITY MASTER RECORD                          *
  5054****************************************************************
  5055
  5056     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5057         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5058                                INDEXED BY CF-MORT-NDX.
  5059             20  CF-MORT-TABLE              PIC X(5).
  5060             20  CF-MORT-TABLE-TYPE         PIC X.
  5061                 88  CF-MORT-JOINT              VALUE 'J'.
  5062                 88  CF-MORT-SINGLE             VALUE 'S'.
  5063                 88  CF-MORT-COMBINED           VALUE 'C'.
  5064                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5065                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5066             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5067             20  CF-MORT-AGE-METHOD         PIC XX.
  5068                 88  CF-AGE-LAST                VALUE 'AL'.
  5069                 88  CF-AGE-NEAR                VALUE 'AN'.
  5070             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5071             20  CF-MORT-ADJUSTMENT-DIRECTION
  5072                                            PIC X.
  5073                 88  CF-MINUS                   VALUE '-'.
  5074                 88  CF-PLUS                    VALUE '+'.
  5075             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5076             20  CF-MORT-JOINT-CODE         PIC X.
  5077                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5078             20  CF-MORT-PC-Q               PIC X.
  5079                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5080             20  CF-MORT-TABLE-CODE         PIC X(4).
  5081             20  CF-MORT-COMMENTS           PIC X(15).
  5082             20  FILLER                     PIC X(14).
  5083
  5084         16  FILLER                         PIC X(251).
  5085
  5086
  5087****************************************************************
  5088*             BUSSINESS TYPE MASTER RECORD                     *
  5089****************************************************************
  5090
  5091     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5092* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5093* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5094* AND RECORD 05 IS TYPES 81-99
  5095         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5096             20  CF-BUSINESS-TITLE          PIC  X(19).
  5097             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5098                                            PIC S9V9(4) COMP-3.
  5099             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5100             20  FILLER                     PIC  X.
  5101         16  FILLER                         PIC  X(248).
  5102
  5103
  5104****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  97
* EL156.cbl
  5105*             TERMINAL MASTER RECORD                           *
  5106****************************************************************
  5107
  5108     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5109
  5110         16  CF-COMPANY-TERMINALS.
  5111             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5112                                  PIC X(4).
  5113         16  FILLER               PIC X(248).
  5114
  5115
  5116****************************************************************
  5117*             LIFE EDIT MASTER RECORD                          *
  5118****************************************************************
  5119
  5120     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5121         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5122             20  CF-LIFE-CODE-IN            PIC XX.
  5123             20  CF-LIFE-CODE-OUT           PIC XX.
  5124         16  FILLER                         PIC X(248).
  5125
  5126
  5127****************************************************************
  5128*             AH EDIT MASTER RECORD                            *
  5129****************************************************************
  5130
  5131     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5132         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5133             20  CF-AH-CODE-IN              PIC XXX.
  5134             20  CF-AH-CODE-OUT             PIC XX.
  5135         16  FILLER                         PIC X(248).
  5136
  5137
  5138****************************************************************
  5139*             CREDIBILITY TABLES                               *
  5140****************************************************************
  5141
  5142     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5143         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5144                             INDEXED BY CF-CRDB-NDX.
  5145             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5146             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5147             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5148         16  FILLER                         PIC  X(332).
  5149
  5150
  5151****************************************************************
  5152*             REPORT CUSTOMIZATION RECORD                      *
  5153****************************************************************
  5154
  5155     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5156         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5157             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5158             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5159             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5160**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5161****       A T-TRANSFER.                                   ****
  5162             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  98
* EL156.cbl
  5163
  5164         16  FILLER                         PIC XX.
  5165
  5166         16  CF-CARRIER-CNTL-OPT.
  5167             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5168                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5169                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5170             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5171                                            PIC X.
  5172         16  CF-GROUP-CNTL-OPT.
  5173             20  CF-GROUP-OPT-SEQ           PIC 9.
  5174                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5175                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5176             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5177                                            PIC X(6).
  5178         16  CF-STATE-CNTL-OPT.
  5179             20  CF-STATE-OPT-SEQ           PIC 9.
  5180                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5181                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5182             20  CF-STATE-SELECT OCCURS 3 TIMES
  5183                                            PIC XX.
  5184         16  CF-ACCOUNT-CNTL-OPT.
  5185             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5186                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5187                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5188             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5189                                            PIC X(10).
  5190         16  CF-BUS-TYP-CNTL-OPT.
  5191             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5192                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5193                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5194             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5195                                            PIC XX.
  5196         16  CF-LF-TYP-CNTL-OPT.
  5197             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5198                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5199                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5200             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5201                                            PIC XX.
  5202         16  CF-AH-TYP-CNTL-OPT.
  5203             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5204                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5205                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5206             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5207                                            PIC XX.
  5208         16  CF-REPTCD1-CNTL-OPT.
  5209             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5210                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5211                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5212             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5213                                            PIC X(10).
  5214         16  CF-REPTCD2-CNTL-OPT.
  5215             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5216                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5217                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5218             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5219                                            PIC X(10).
  5220         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page  99
* EL156.cbl
  5221             20  CF-USER1-OPT-SEQ           PIC 9.
  5222                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5223                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5224             20  CF-USER1-SELECT OCCURS 3 TIMES
  5225                                            PIC X(10).
  5226         16  CF-USER2-CNTL-OPT.
  5227             20  CF-USER2-OPT-SEQ           PIC 9.
  5228                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5229                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5230             20  CF-USER2-SELECT OCCURS 3 TIMES
  5231                                            PIC X(10).
  5232         16  CF-USER3-CNTL-OPT.
  5233             20  CF-USER3-OPT-SEQ           PIC 9.
  5234                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5235                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5236             20  CF-USER3-SELECT OCCURS 3 TIMES
  5237                                            PIC X(10).
  5238         16  CF-USER4-CNTL-OPT.
  5239             20  CF-USER4-OPT-SEQ           PIC 9.
  5240                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5241                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5242             20  CF-USER4-SELECT OCCURS 3 TIMES
  5243                                            PIC X(10).
  5244         16  CF-USER5-CNTL-OPT.
  5245             20  CF-USER5-OPT-SEQ           PIC 9.
  5246                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5247                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5248             20  CF-USER5-SELECT OCCURS 3 TIMES
  5249                                            PIC X(10).
  5250         16  CF-REINS-CNTL-OPT.
  5251             20  CF-REINS-OPT-SEQ           PIC 9.
  5252                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5253                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5254             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5255                 24  CF-REINS-PRIME         PIC XXX.
  5256                 24  CF-REINS-SUB           PIC XXX.
  5257
  5258         16  CF-AGENT-CNTL-OPT.
  5259             20  CF-AGENT-OPT-SEQ           PIC 9.
  5260                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5261                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5262             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5263                                            PIC X(10).
  5264
  5265         16  FILLER                         PIC X(43).
  5266
  5267         16  CF-LOSS-RATIO-SELECT.
  5268             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5269             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5270         16  CF-ENTRY-DATE-SELECT.
  5271             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5272             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5273         16  CF-EFFECTIVE-DATE-SELECT.
  5274             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5275             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5276
  5277         16  CF-EXCEPTION-LIST-IND          PIC X.
  5278             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 100
* EL156.cbl
  5279
  5280         16  FILLER                         PIC X(318).
  5281
  5282****************************************************************
  5283*                  EXCEPTION REPORTING RECORD                  *
  5284****************************************************************
  5285
  5286     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5287         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5288             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5289
  5290         16  CF-COMBINED-LIFE-AH-OPT.
  5291             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5292             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5293             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5294             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5295
  5296         16  CF-LIFE-OPT.
  5297             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5298             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5299             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5300             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5301             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5302             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5303             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5304             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5305             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5306             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5307
  5308         16  CF-AH-OPT.
  5309             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5310             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5311             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5312             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5313             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5314             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5315             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5316             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5317             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5318             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5319
  5320         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5321             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5322             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5323             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5324
  5325         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5326
  5327         16  FILLER                         PIC X(673).
  5328
  5329
  5330****************************************************************
  5331*             MORTGAGE SYSTEM PLAN RECORD                      *
  5332****************************************************************
  5333
  5334     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5335         16  CF-PLAN-TYPE                   PIC X.
  5336             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 101
* EL156.cbl
  5337             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5338             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5339         16  CF-PLAN-ABBREV                 PIC XXX.
  5340         16  CF-PLAN-DESCRIPT               PIC X(10).
  5341         16  CF-PLAN-NOTES                  PIC X(20).
  5342         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5343         16  CF-PLAN-UNDERWRITING.
  5344             20  CF-PLAN-TERM-DATA.
  5345                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5346                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5347             20  CF-PLAN-AGE-DATA.
  5348                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5349                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5350                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5351             20  CF-PLAN-BENEFIT-DATA.
  5352                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5353                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5354                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5355                                            PIC S9(7)V99  COMP-3.
  5356         16  CF-PLAN-POLICY-FORMS.
  5357             20  CF-POLICY-FORM             PIC X(12).
  5358             20  CF-MASTER-APPLICATION      PIC X(12).
  5359             20  CF-MASTER-POLICY           PIC X(12).
  5360         16  CF-PLAN-RATING.
  5361             20  CF-RATE-CODE               PIC X(5).
  5362             20  CF-SEX-RATING              PIC X.
  5363                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5364                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5365             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5366             20  CF-SUB-STD-TYPE            PIC X.
  5367                 88  CF-PCT-OF-PREM            VALUE '1'.
  5368                 88  CF-PCT-OF-BENE            VALUE '2'.
  5369         16  CF-PLAN-PREM-TOLERANCES.
  5370             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5371             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5372         16  CF-PLAN-PYMT-TOLERANCES.
  5373             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5374             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5375         16  CF-PLAN-MISC-DATA.
  5376             20  FILLER                     PIC X.
  5377             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5378             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5379         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5380         16  CF-PLAN-IND-GRP                PIC X.
  5381             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5382                                                     '1'.
  5383             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5384                                                     '2'.
  5385         16  CF-MIB-SEARCH-SW               PIC X.
  5386             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5387             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5388             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5389             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5390         16  CF-ALPHA-SEARCH-SW             PIC X.
  5391             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5392             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5393             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5394             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 102
* EL156.cbl
  5395             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5396             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5397             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5398             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5399             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5400             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5401                                                     'A' 'B' 'C'
  5402                                                     'X' 'Y' 'Z'.
  5403         16  CF-EFF-DT-RULE-SW              PIC X.
  5404             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5405             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5406             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5407             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5408             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5409         16  FILLER                         PIC X(4).
  5410         16  CF-HEALTH-QUESTIONS            PIC X.
  5411             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5412         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5413         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5414         16  CF-PLAN-SNGL-JNT               PIC X.
  5415             88  CF-COMBINED-PLAN              VALUE 'C'.
  5416             88  CF-JNT-PLAN                   VALUE 'J'.
  5417             88  CF-SNGL-PLAN                  VALUE 'S'.
  5418         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5419         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5420         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5421         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5422         16  CF-RERATE-CNTL                 PIC  X.
  5423             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5424             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5425             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5426             88  CF-AUTO-RECALC                 VALUE '4'.
  5427         16  CF-BENEFIT-TYPE                PIC  X.
  5428             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5429             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5430         16  CF-POLICY-FEE                  PIC S999V99
  5431                                                    COMP-3.
  5432         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5433         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5434         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5435         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5436         16  FILLER                         PIC  X(32).
  5437         16  CF-TERMINATION-FORM            PIC  X(04).
  5438         16  FILLER                         PIC  X(08).
  5439         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5440                                                       COMP-3.
  5441         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5442         16  CF-ISSUE-LETTER                PIC  X(4).
  5443         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5444         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5445             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5446             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5447         16  CF-MP-REFUND-CALC              PIC X.
  5448             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5449             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5450             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5451             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5452             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 103
* EL156.cbl
  5453             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5454             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5455             88  CF-MP-REFD-MEAN                VALUE '8'.
  5456         16  CF-ALT-RATE-CODE               PIC  X(5).
  5457
  5458
  5459         16  FILLER                         PIC X(498).
  5460****************************************************************
  5461*             MORTGAGE COMPANY MASTER RECORD                   *
  5462****************************************************************
  5463
  5464     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5465         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5466         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5467             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5468             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5469             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5470             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5471             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5472
  5473         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5474         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5475         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5476         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5477         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5478
  5479         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5480             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5481         16  CF-MP-RECON-USE-IND            PIC X(1).
  5482             88  CF-MP-USE-RECON             VALUE 'Y'.
  5483         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5484             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5485         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5486             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5487             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5488         16  FILLER                         PIC X(1).
  5489         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5490             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5491         16  CF-MORTG-MIB-VERSION           PIC X.
  5492             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5493             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5494             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5495         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5496             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5497                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5498             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5499                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5500             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5501                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5502             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5503                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5504             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5505                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5506             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5507                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5508         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5509         16  FILLER                         PIC X(7).
  5510         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 104
* EL156.cbl
  5511             20  CF-MORTG-MIB-COMM          PIC X(5).
  5512             20  CF-MORTG-MIB-TERM          PIC X(5).
  5513         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5514             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5515         16  FILLER                         PIC X(03).
  5516         16  CF-MP-CHECK-NO-CONTROL.
  5517             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5518                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5519                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5520                                                ' ' LOW-VALUES.
  5521                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5522                                               VALUE '3'.
  5523         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5524         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5525         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5526             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5527                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5528             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5529                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5530             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5531                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5532             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5533                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5534             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5535                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5536             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5537                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5538         16  CF-MORTG-BILLING-AREA.
  5539             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5540                                            PIC X.
  5541         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5542         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5543         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5544         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5545             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5546             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5547         16  FILLER                         PIC X.
  5548         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5549             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5550             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5551         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5552         16  FILLER                         PIC X(8).
  5553         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5554         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5555         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5556         16  CF-ACH-COMPANY-ID.
  5557             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5558                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5559                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5560                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5561             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5562         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5563             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5564         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5565             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5566             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5567         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5568         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 105
* EL156.cbl
  5569         16  FILLER                         PIC X(536).
  5570
  5571****************************************************************
  5572*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5573****************************************************************
  5574
  5575     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5576         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5577             20  CF-FEMALE-HEIGHT.
  5578                 24  CF-FEMALE-FT           PIC 99.
  5579                 24  CF-FEMALE-IN           PIC 99.
  5580             20  CF-FEMALE-MIN-WT           PIC 999.
  5581             20  CF-FEMALE-MAX-WT           PIC 999.
  5582         16  FILLER                         PIC X(428).
  5583
  5584     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5585         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5586             20  CF-MALE-HEIGHT.
  5587                 24  CF-MALE-FT             PIC 99.
  5588                 24  CF-MALE-IN             PIC 99.
  5589             20  CF-MALE-MIN-WT             PIC 999.
  5590             20  CF-MALE-MAX-WT             PIC 999.
  5591         16  FILLER                         PIC X(428).
  5592******************************************************************
  5593*             AUTOMATIC ACTIVITY RECORD                          *
  5594******************************************************************
  5595     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5596         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5597             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5598             20  CF-SYS-LETTER-ID           PIC X(04).
  5599             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5600             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5601             20  CF-SYS-RESET-SW            PIC X(01).
  5602             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5603             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5604
  5605         16  FILLER                         PIC X(50).
  5606
  5607         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5608             20  CF-USER-ACTIVE-SW          PIC X(01).
  5609             20  CF-USER-LETTER-ID          PIC X(04).
  5610             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5611             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5612             20  CF-USER-RESET-SW           PIC X(01).
  5613             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5614             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5615             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5616
  5617         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 106
* EL156.cbl
  5619*    COPY ELCCERT.
  5620******************************************************************
  5621*                                                                *
  5622*                            ELCCERT.                            *
  5623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5624*                            VMOD=2.013                          *
  5625*                                                                *
  5626*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5627*                                                                *
  5628*   FILE TYPE = VSAM,KSDS                                        *
  5629*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5630*                                                                *
  5631*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5632*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5633*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5634*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5635*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5636*                                                                *
  5637*   LOG = YES                                                    *
  5638*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5639******************************************************************
  5640*                   C H A N G E   L O G
  5641*
  5642* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5643*-----------------------------------------------------------------
  5644*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5645* EFFECTIVE    NUMBER
  5646*-----------------------------------------------------------------
  5647* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5648* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5649* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5650* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5651* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5652* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5653* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5654* 032612  CR2011110200001  PEMA  AHL CHANGES
  5655* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5656******************************************************************
  5657
  5658 01  CERTIFICATE-MASTER.
  5659     12  CM-RECORD-ID                      PIC XX.
  5660         88  VALID-CM-ID                      VALUE 'CM'.
  5661
  5662     12  CM-CONTROL-PRIMARY.
  5663         16  CM-COMPANY-CD                 PIC X.
  5664         16  CM-CARRIER                    PIC X.
  5665         16  CM-GROUPING.
  5666             20  CM-GROUPING-PREFIX        PIC X(3).
  5667             20  CM-GROUPING-PRIME         PIC X(3).
  5668         16  CM-STATE                      PIC XX.
  5669         16  CM-ACCOUNT.
  5670             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5671             20  CM-ACCOUNT-PRIME          PIC X(6).
  5672         16  CM-CERT-EFF-DT                PIC XX.
  5673         16  CM-CERT-NO.
  5674             20  CM-CERT-PRIME             PIC X(10).
  5675             20  CM-CERT-SFX               PIC X.
  5676
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 107
* EL156.cbl
  5677     12  CM-CONTROL-BY-NAME.
  5678         16  CM-COMPANY-CD-A1              PIC X.
  5679         16  CM-INSURED-LAST-NAME          PIC X(15).
  5680         16  CM-INSURED-INITIALS.
  5681             20  CM-INSURED-INITIAL1       PIC X.
  5682             20  CM-INSURED-INITIAL2       PIC X.
  5683
  5684     12  CM-CONTROL-BY-SSN.
  5685         16  CM-COMPANY-CD-A2              PIC X.
  5686         16  CM-SOC-SEC-NO.
  5687             20  CM-SSN-STATE              PIC XX.
  5688             20  CM-SSN-ACCOUNT            PIC X(6).
  5689             20  CM-SSN-LN3.
  5690                 25  CM-INSURED-INITIALS-A2.
  5691                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5692                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5693                 25 CM-PART-LAST-NAME-A2         PIC X.
  5694
  5695     12  CM-CONTROL-BY-CERT-NO.
  5696         16  CM-COMPANY-CD-A4              PIC X.
  5697         16  CM-CERT-NO-A4                 PIC X(11).
  5698
  5699     12  CM-CONTROL-BY-MEMB.
  5700         16  CM-COMPANY-CD-A5              PIC X.
  5701         16  CM-MEMBER-NO.
  5702             20  CM-MEMB-STATE             PIC XX.
  5703             20  CM-MEMB-ACCOUNT           PIC X(6).
  5704             20  CM-MEMB-LN4.
  5705                 25  CM-INSURED-INITIALS-A5.
  5706                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5707                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5708                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5709
  5710     12  CM-INSURED-PROFILE-DATA.
  5711         16  CM-INSURED-FIRST-NAME.
  5712             20  CM-INSURED-1ST-INIT       PIC X.
  5713             20  FILLER                    PIC X(9).
  5714         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5715         16  CM-INSURED-SEX                PIC X.
  5716             88  CM-SEX-MALE                  VALUE 'M'.
  5717             88  CM-SEX-FEMAL                 VALUE 'F'.
  5718         16  CM-INSURED-JOINT-AGE          PIC 99.
  5719         16  CM-JOINT-INSURED-NAME.
  5720             20  CM-JT-LAST-NAME           PIC X(15).
  5721             20  CM-JT-FIRST-NAME.
  5722                 24  CM-JT-1ST-INIT        PIC X.
  5723                 24  FILLER                PIC X(9).
  5724             20  CM-JT-INITIAL             PIC X.
  5725
  5726     12  CM-LIFE-DATA.
  5727         16  CM-LF-BENEFIT-CD              PIC XX.
  5728         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5729         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5730         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5731         16  CM-LF-DEV-CODE                PIC XXX.
  5732         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5733         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5734         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 108
* EL156.cbl
  5735         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5736         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5737         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5738         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5739         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5740         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5741         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5742         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5743         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5744         16  cm-temp-epiq                  pic xx.
  5745             88  EPIQ-CLASS                  value 'EQ'.
  5746*        16  FILLER                        PIC XX.
  5747
  5748     12  CM-AH-DATA.
  5749         16  CM-AH-BENEFIT-CD              PIC XX.
  5750         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5751         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5752         16  CM-AH-DEV-CODE                PIC XXX.
  5753         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5754         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5755         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5756         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5757         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5758         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5759         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5760         16  CM-AH-PAID-THRU-DT            PIC XX.
  5761             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5762         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5763         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5764         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5765         16  FILLER                        PIC X.
  5766
  5767     12  CM-LOAN-INFORMATION.
  5768         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5769         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5770                                           PIC S9(5)V99  COMP-3.
  5771         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5772         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5773         16  CM-PAY-FREQUENCY              PIC S99.
  5774         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5775         16  CM-RATE-CLASS                 PIC XX.
  5776         16  CM-BENEFICIARY                PIC X(25).
  5777         16  CM-POLICY-FORM-NO             PIC X(12).
  5778         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5779         16  CM-LAST-ADD-ON-DT             PIC XX.
  5780         16  CM-DEDUCTIBLE-AMOUNTS.
  5781             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5782             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5783         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5784             20  CM-RESIDENT-STATE         PIC XX.
  5785             20  CM-RATE-CODE              PIC X(4).
  5786             20  FILLER                    PIC XX.
  5787         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5788             20  CM-LOAN-OFFICER           PIC X(5).
  5789             20  FILLER                    PIC XXX.
  5790         16  CM-CSR-CODE                   PIC XXX.
  5791         16  CM-UNDERWRITING-CODE          PIC X.
  5792             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 109
* EL156.cbl
  5793         16  CM-POST-CARD-IND              PIC X.
  5794         16  CM-NH-INTERFACE-SW            PIC X.
  5795         16  CM-PREMIUM-TYPE               PIC X.
  5796             88  CM-SING-PRM                  VALUE '1'.
  5797             88  CM-O-B-COVERAGE              VALUE '2'.
  5798             88  CM-OPEN-END                  VALUE '3'.
  5799         16  CM-IND-GRP-TYPE               PIC X.
  5800             88  CM-INDIVIDUAL                VALUE 'I'.
  5801             88  CM-GROUP                     VALUE 'G'.
  5802         16  CM-SKIP-CODE                  PIC X.
  5803             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5804             88  SKIP-JULY                    VALUE '1'.
  5805             88  SKIP-AUGUST                  VALUE '2'.
  5806             88  SKIP-SEPTEMBER               VALUE '3'.
  5807             88  SKIP-JULY-AUG                VALUE '4'.
  5808             88  SKIP-AUG-SEPT                VALUE '5'.
  5809             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5810             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5811             88  SKIP-JUNE                    VALUE '8'.
  5812             88  SKIP-JUNE-JULY               VALUE '9'.
  5813             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5814             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5815         16  CM-PAYMENT-MODE               PIC X.
  5816             88  PAY-MONTHLY                  VALUE SPACE.
  5817             88  PAY-WEEKLY                   VALUE '1'.
  5818             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5819             88  PAY-BI-WEEKLY                VALUE '3'.
  5820             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5821         16  CM-LOAN-NUMBER                PIC X(8).
  5822         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5823         16  CM-OLD-LOF                    PIC XXX.
  5824*        16  CM-LOAN-OFFICER               PIC XXX.
  5825         16  CM-REIN-TABLE                 PIC XXX.
  5826         16  CM-SPECIAL-REIN-CODE          PIC X.
  5827         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5828         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5829         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5830
  5831     12  CM-STATUS-DATA.
  5832         16  CM-ENTRY-STATUS               PIC X.
  5833         16  CM-ENTRY-DT                   PIC XX.
  5834
  5835         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5836         16  CM-LF-CANCEL-DT               PIC XX.
  5837         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5838
  5839         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5840         16  CM-LF-DEATH-DT                PIC XX.
  5841         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5842
  5843         16  CM-LF-CURRENT-STATUS          PIC X.
  5844             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5845                                                'M' '4' '5' '9'.
  5846             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5847             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5848             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5849             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5850             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 110
* EL156.cbl
  5851             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5852             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5853             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5854             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5855             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5856             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5857             88  CM-LF-DECLINED               VALUE 'D'.
  5858             88  CM-LF-VOIDED                 VALUE 'V'.
  5859
  5860         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5861         16  CM-AH-CANCEL-DT               PIC XX.
  5862         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5863
  5864         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5865         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5866         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5867
  5868         16  CM-AH-CURRENT-STATUS          PIC X.
  5869             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5870                                                'M' '4' '5' '9'.
  5871             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5872             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5873             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5874             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5875             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5876             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5877             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5878             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5879             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5880             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5881             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5882             88  CM-AH-DECLINED               VALUE 'D'.
  5883             88  CM-AH-VOIDED                 VALUE 'V'.
  5884
  5885         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5886             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5887             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5888             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5889         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5890
  5891         16  CM-ENTRY-BATCH                PIC X(6).
  5892         16  CM-LF-EXIT-BATCH              PIC X(6).
  5893         16  CM-AH-EXIT-BATCH              PIC X(6).
  5894         16  CM-LAST-MONTH-END             PIC XX.
  5895
  5896     12  CM-NOTE-SW                        PIC X.
  5897         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5898         88  CERT-NOTES-PRESENT               VALUE '1'.
  5899         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5900         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5901         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5902         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5903         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5904         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5905     12  CM-COMP-EXCP-SW                   PIC X.
  5906         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5907         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5908     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 111
* EL156.cbl
  5909         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5910         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5911
  5912*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5913     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5914     12  FILLER                            PIC X.
  5915
  5916*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5917     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5918     12  FILLER                            PIC X.
  5919*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5920     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5921
  5922     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5923         88  CERT-ADDED-BATCH                 VALUE ' '.
  5924         88  CERT-ADDED-ONLINE                VALUE '1'.
  5925         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5926         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5927         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5928     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5929         88  CERT-AS-LOADED                   VALUE ' '.
  5930         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5931         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5932         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5933         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5934         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5935         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5936         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5937
  5938     12  CM-ACCOUNT-COMM-PCTS.
  5939         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5940         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5941
  5942     12  CM-USER-FIELD                     PIC X.
  5943     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5944     12  CM-CLP-STATE                      PIC XX.
  5945     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5946     12  CM-USER-RESERVED                  PIC XXX.
  5947     12  FILLER REDEFINES CM-USER-RESERVED.
  5948         16  CM-AH-CLASS-CD                PIC XX.
  5949         16  F                             PIC X.
  5950******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 112
* EL156.cbl
  5952*    COPY ELCTRLR.
  5953******************************************************************
  5954*                                                                *
  5955*                            ELCTRLR.                            *
  5956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5957*                            VMOD=2.014                          *
  5958*                                                                *
  5959*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5960*                                                                *
  5961*   FILE TYPE = VSAM,KSDS                                        *
  5962*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5963*                                                                *
  5964*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5965*       ALTERNATE INDEX = NONE                                   *
  5966*                                                                *
  5967*   LOG = YES                                                    *
  5968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5969******************************************************************
  5970*                   C H A N G E   L O G
  5971*
  5972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5973*-----------------------------------------------------------------
  5974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5975* EFFECTIVE    NUMBER
  5976*-----------------------------------------------------------------
  5977* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5978* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5979* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5980* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5981* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5982* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5983* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5984* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5985* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5986* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5987* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5988* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5989* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5990* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5991* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5992* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5993* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5994* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5995* 040814    2014030500002  AJRA  ADD ICD CODES
  5996* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5997******************************************************************
  5998 01  ACTIVITY-TRAILERS.
  5999     12  AT-RECORD-ID                    PIC XX.
  6000         88  VALID-AT-ID                       VALUE 'AT'.
  6001
  6002     12  AT-CONTROL-PRIMARY.
  6003         16  AT-COMPANY-CD               PIC X.
  6004         16  AT-CARRIER                  PIC X.
  6005         16  AT-CLAIM-NO                 PIC X(7).
  6006         16  AT-CERT-NO.
  6007             20  AT-CERT-PRIME           PIC X(10).
  6008             20  AT-CERT-SFX             PIC X.
  6009         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 113
* EL156.cbl
  6010             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6011             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6012             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6013             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6014             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6015             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6016             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6017             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6018             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6019             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6020             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6021             88  AT-BENEFICIARY-TRL           VALUE +91.
  6022             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6023             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6024             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6025             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6026
  6027     12  AT-TRAILER-TYPE                 PIC X.
  6028         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6029         88  PAYMENT-TR                       VALUE '2'.
  6030         88  AUTO-PAY-TR                      VALUE '3'.
  6031         88  CORRESPONDENCE-TR                VALUE '4'.
  6032         88  ADDRESS-TR                       VALUE '5'.
  6033         88  GENERAL-INFO-TR                  VALUE '6'.
  6034         88  AUTO-PROMPT-TR                   VALUE '7'.
  6035         88  DENIAL-TR                        VALUE '8'.
  6036         88  INCURRED-CHG-TR                  VALUE '9'.
  6037         88  FORM-CONTROL-TR                  VALUE 'A'.
  6038
  6039     12  AT-RECORDED-DT                  PIC XX.
  6040     12  AT-RECORDED-BY                  PIC X(4).
  6041     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6042
  6043     12  AT-TRAILER-BODY                 PIC X(165).
  6044
  6045     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6046         16  AT-RESERVE-CONTROLS.
  6047             20  AT-MANUAL-SW            PIC X.
  6048                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6049             20  AT-FUTURE-SW            PIC X.
  6050                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6051             20  AT-PTC-SW               PIC X.
  6052                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6053             20  AT-IBNR-SW              PIC X.
  6054                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6055             20  AT-PTC-LF-SW            PIC X.
  6056                 88  AT-LF-PTC-USED          VALUE '1'.
  6057             20  AT-CDT-ACCESS-METHOD    PIC X.
  6058                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6059                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6060                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6061             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6062         16  AT-LAST-COMPUTED-DT         PIC XX.
  6063         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6064         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6065         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6066         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6067         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 114
* EL156.cbl
  6068         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6069         16  AT-EXPENSE-CONTROLS.
  6070             20  AT-EXPENSE-METHOD       PIC X.
  6071                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6072                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6073                 88  PERCENT-OF-PMT           VALUE '3'.
  6074                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6075             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6076             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6077         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6078         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6079
  6080         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6081         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6082
  6083*        16  FILLER                      PIC X(53).
  6084         16  FILLER                      PIC X(47).
  6085
  6086         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6087         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6088
  6089         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6090             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6091             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6092*                    C = CLOSED
  6093*                    O = OPEN
  6094             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6095*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6096
  6097     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6098         16  AT-PAYMENT-TYPE             PIC X.
  6099             88  PARTIAL-PAYMENT                VALUE '1'.
  6100             88  FINAL-PAYMENT                  VALUE '2'.
  6101             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6102             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6103             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6104             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6105             88  VOIDED-PAYMENT                 VALUE '9'.
  6106             88  TRANSFER                       VALUE 'T'.
  6107             88  LIFE-INTEREST                  VALUE 'I'.
  6108
  6109         16  AT-CLAIM-TYPE               PIC X.
  6110             88  PAID-FOR-AH                    VALUE 'A'.
  6111             88  PAID-FOR-LIFE                  VALUE 'L'.
  6112             88  PAID-FOR-IUI                   VALUE 'I'.
  6113             88  PAID-FOR-GAP                   VALUE 'G'.
  6114             88  PAID-FOR-FAM                   VALUE 'F'.
  6115         16  AT-CLAIM-PREM-TYPE          PIC X.
  6116             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6117             88  AT-O-B-COVERAGE                VALUE '2'.
  6118             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6119         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6120         16  AT-CHECK-NO                 PIC X(7).
  6121         16  AT-PAID-FROM-DT             PIC XX.
  6122         16  AT-PAID-THRU-DT             PIC XX.
  6123         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6124         16  FILLER                      PIC X.
  6125         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 115
* EL156.cbl
  6126         16  AT-PAYMENT-ORIGIN           PIC X.
  6127             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6128             88  ONLINE-AUTO-PMT                VALUE '2'.
  6129             88  OFFLINE-PMT                    VALUE '3'.
  6130         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6131         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6132         16  AT-VOID-DATA.
  6133             20  AT-VOID-DT              PIC XX.
  6134*00144       20  AT-VOID-REASON          PIC X(30).
  6135             20  AT-VOID-REASON          PIC X(26).
  6136         16  AT-PMT-APPROVED-BY          PIC X(04).
  6137         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6138         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6139         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6140                                         PIC S99V9(5)  COMP-3.
  6141         16  AT-CREDIT-INTERFACE.
  6142             20  AT-PMT-SELECT-DT        PIC XX.
  6143                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6144             20  AT-PMT-ACCEPT-DT        PIC XX.
  6145                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6146             20  AT-VOID-SELECT-DT       PIC XX.
  6147                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6148             20  AT-VOID-ACCEPT-DT       PIC XX.
  6149                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6150
  6151         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6152                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6153                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6154         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6155
  6156         16  AT-FORCE-CONTROL            PIC X.
  6157             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6158         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6159         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6160         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6161         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6162         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6163         16  AT-BENEFIT-TYPE             PIC X.
  6164
  6165         16  AT-EXPENSE-TYPE             PIC X.
  6166         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6167
  6168         16  AT-PAYEE-TYPE-CD.
  6169             20  AT-PAYEE-TYPE           PIC X.
  6170                 88  INSURED-PAID           VALUE 'I'.
  6171                 88  BENEFICIARY-PAID       VALUE 'B'.
  6172                 88  ACCOUNT-PAID           VALUE 'A'.
  6173                 88  OTHER-1-PAID           VALUE 'O'.
  6174                 88  OTHER-2-PAID           VALUE 'Q'.
  6175                 88  DOCTOR-PAID            VALUE 'P'.
  6176                 88  EMPLOYER-PAID          VALUE 'E'.
  6177             20  AT-PAYEE-SEQ            PIC X.
  6178
  6179         16  AT-CASH-PAYMENT             PIC X.
  6180         16  AT-GROUPED-PAYMENT          PIC X.
  6181         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6182         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6183         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 116
* EL156.cbl
  6184         16  AT-VOID-TYPE                PIC X.
  6185             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6186             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6187         16  AT-AIG-UNEMP-IND            PIC X.
  6188             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6189         16  AT-ASSOCIATES               PIC X.
  6190             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6191             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6192
  6193         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6194         16  AT-CV-PMT-CODE              PIC X.
  6195             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6196             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6197             88  FULL-ADD-PAYMENT           VALUE '3'.
  6198             88  HALF-ADD-PAYMENT           VALUE '4'.
  6199             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6200             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6201             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6202             88  ADDL-PAYMENT               VALUE '8'.
  6203
  6204         16  AT-EOB-CODE1                PIC XXX.
  6205         16  AT-EOB-CODE2                PIC XXX.
  6206         16  AT-EOB-CODE3                PIC XXX.
  6207         16  FILLER REDEFINES AT-EOB-CODE3.
  6208             20  AT-PRINT-CLM-FORM       PIC X.
  6209             20  AT-PRINT-SURVEY         PIC X.
  6210             20  AT-SPECIAL-RELEASE      PIC X.
  6211         16  AT-EOB-CODE4                PIC XXX.
  6212         16  FILLER REDEFINES AT-EOB-CODE4.
  6213             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6214             20  FILLER                  PIC X.
  6215         16  AT-EOB-CODE5                PIC XXX.
  6216         16  FILLER REDEFINES AT-EOB-CODE5.
  6217             20  AT-PMT-PROOF-DT         PIC XX.
  6218             20  FILLER                  PIC X.
  6219
  6220         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6221             88  AT-PRINT-EOB            VALUE 'Y'.
  6222
  6223         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6224         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6225
  6226     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6227         16  AT-SCHEDULE-START-DT        PIC XX.
  6228         16  AT-SCHEDULE-END-DT          PIC XX.
  6229         16  AT-TERMINATED-DT            PIC XX.
  6230         16  AT-LAST-PMT-TYPE            PIC X.
  6231             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6232             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6233         16  AT-FIRST-PMT-DATA.
  6234             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6235             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6236             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6237         16  AT-REGULAR-PMT-DATA.
  6238             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6239             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6240             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6241         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 117
* EL156.cbl
  6242             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6243                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6244                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6245                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6246                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6247                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6248             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6249         16  AT-AUTO-PAY-DAY             PIC 99.
  6250         16  AT-AUTO-CASH                PIC X.
  6251             88  AT-CASH                      VALUE 'Y'.
  6252             88  AT-NON-CASH                  VALUE 'N'.
  6253*        16  FILLER                      PIC X(129).
  6254         16  AT-AUTO-END-LETTER          PIC X(4).
  6255         16  FILLER                      PIC X(125).
  6256
  6257         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6258         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6259
  6260     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6261         16  AT-LETTER-SENT-DT           PIC XX.
  6262         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6263         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6264         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6265         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6266         16  AT-LETTER-ORIGIN            PIC X.
  6267             88  ONLINE-CREATION              VALUE '1' '3'.
  6268             88  OFFLINE-CREATION             VALUE '2' '4'.
  6269             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6270             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6271         16  AT-STD-LETTER-FORM          PIC X(4).
  6272         16  AT-REASON-TEXT              PIC X(70).
  6273         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6274         16  AT-ADDRESEE-TYPE            PIC X.
  6275              88  INSURED-ADDRESEE            VALUE 'I'.
  6276              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6277              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6278              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6279              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6280              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6281              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6282         16  AT-ADDRESSEE-NAME           PIC X(30).
  6283         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6284         16  AT-RESEND-PRINT-DATE        PIC XX.
  6285         16  AT-CORR-SOL-UNSOL           PIC X.
  6286         16  AT-LETTER-PURGED-DT         PIC XX.
  6287*
  6288*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6289*
  6290         16  AT-CSO-REDEFINITION.
  6291             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6292             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6293             20  AT-LETTER-TO-BENE       PIC X(1).
  6294             20  AT-STOP-LETTER-DT       PIC X(2).
  6295             20  FILLER                  PIC X(19).
  6296*             20  FILLER                  PIC X(27).
  6297             20  AT-CSO-LETTER-STATUS    PIC X.
  6298                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6299                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 118
* EL156.cbl
  6300                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6301             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6302             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6303*
  6304*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6305*
  6306*        16  FILLER                      PIC X(26).
  6307*
  6308*        16  AT-DMD-BSR-CODE             PIC X.
  6309*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6310*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6311*
  6312*        16  AT-DMD-LETTER-STATUS        PIC X.
  6313*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6314*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6315*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6316*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6317*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6318
  6319         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6320         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6321
  6322     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6323         16  AT-ADDRESS-TYPE             PIC X.
  6324             88  INSURED-ADDRESS               VALUE 'I'.
  6325             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6326             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6327             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6328             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6329             88  OTHER-ADDRESS-1               VALUE 'O'.
  6330             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6331         16  AT-MAIL-TO-NAME             PIC X(30).
  6332         16  AT-ADDRESS-LINE-1           PIC X(30).
  6333         16  AT-ADDRESS-LINE-2           PIC X(30).
  6334         16  AT-CITY-STATE.
  6335             20  AT-CITY                 PIC X(28).
  6336             20  AT-STATE                PIC XX.
  6337         16  AT-ZIP.
  6338             20  AT-ZIP-CODE.
  6339                 24  AT-ZIP-1ST          PIC X.
  6340                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6341                 24  FILLER              PIC X(4).
  6342             20  AT-ZIP-PLUS4            PIC X(4).
  6343         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6344             20  AT-CAN-POSTAL-1         PIC XXX.
  6345             20  AT-CAN-POSTAL-2         PIC XXX.
  6346             20  FILLER                  PIC XXX.
  6347         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6348*         16  FILLER                      PIC X(23).
  6349         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6350         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6351         16  FILLER                      PIC X(13).
  6352         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6353         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6354
  6355     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6356         16  AT-INFO-LINE-1              PIC X(60).
  6357         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 119
* EL156.cbl
  6358             20  AT-NOTE-ERROR-NO OCCURS 15
  6359                                         PIC X(4).
  6360         16  AT-INFO-LINE-2              PIC X(60).
  6361         16  FILLER REDEFINES AT-INFO-LINE-2.
  6362             20  AT-ICD-CODE-1           PIC X(8).
  6363             20  AT-ICD-CODE-2           PIC X(8).
  6364             20  FILLER                  PIC X(44).
  6365         16  AT-INFO-TRAILER-TYPE        PIC X.
  6366             88  AT-ERRORS-NOTE          VALUE 'E'.
  6367             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6368             88  AT-CALL-NOTE            VALUE 'C'.
  6369             88  AT-MAINT-NOTE           VALUE 'M'.
  6370             88  AT-CERT-CHANGE          VALUE 'X'.
  6371             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6372             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6373             88  AT-CERT-CANCELLED       VALUE 'T'.
  6374         16  AT-CALL-TYPE                PIC X.
  6375             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6376             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6377         16  AT-NOTE-CONTINUATION        PIC X.
  6378             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6379         16  AT-EOB-CODES-EXIST          PIC X.
  6380             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6381         16  FILLER                      PIC X(35).
  6382         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6383         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6384
  6385     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6386         16  AT-PROMPT-LINE-1            PIC X(60).
  6387         16  AT-PROMPT-LINE-2            PIC X(60).
  6388         16  AT-PROMPT-START-DT          PIC XX.
  6389         16  AT-PROMPT-END-DT            PIC XX.
  6390         16  FILLER                      PIC X(35).
  6391         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6392         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6393
  6394     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6395         16  AT-DENIAL-INFO-1            PIC X(60).
  6396         16  AT-DENIAL-INFO-2            PIC X(60).
  6397         16  AT-DENIAL-DT                PIC XX.
  6398         16  AT-RETRACTION-DT            PIC XX.
  6399         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6400*         16  FILLER                      PIC X(31).
  6401         16  AT-DENIAL-PROOF-DT          PIC XX.
  6402         16  FILLER                      PIC X(29).
  6403         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6404         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6405
  6406     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6407         16  AT-OLD-INCURRED-DT          PIC XX.
  6408         16  AT-OLD-REPORTED-DT          PIC XX.
  6409         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6410         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6411         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6412         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6413         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6414         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6415         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 120
* EL156.cbl
  6416         16  AT-OLD-DIAG-CODE            PIC X(6).
  6417         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6418         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6419         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6420         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6421         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6422         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6423         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6424         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6425         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6426         16  FILLER                      PIC X(9).
  6427         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6428
  6429     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6430         16  AT-FORM-SEND-ON-DT          PIC XX.
  6431         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6432         16  AT-FORM-RE-SEND-DT          PIC XX.
  6433         16  AT-FORM-ANSWERED-DT         PIC XX.
  6434         16  AT-FORM-PRINTED-DT          PIC XX.
  6435         16  AT-FORM-REPRINT-DT          PIC XX.
  6436         16  AT-FORM-TYPE                PIC X.
  6437             88  INITIAL-FORM                  VALUE '1'.
  6438             88  PROGRESS-FORM                 VALUE '2'.
  6439         16  AT-INSTRUCT-LN-1            PIC X(28).
  6440         16  AT-INSTRUCT-LN-2            PIC X(28).
  6441         16  AT-INSTRUCT-LN-3            PIC X(28).
  6442         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6443         16  AT-FORM-ADDRESS             PIC X.
  6444             88  FORM-TO-INSURED              VALUE 'I'.
  6445             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6446             88  FORM-TO-OTHER-1              VALUE 'O'.
  6447             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6448         16  AT-RELATED-1.
  6449             20 AT-REL-CARR-1            PIC X.
  6450             20 AT-REL-CLAIM-1           PIC X(7).
  6451             20 AT-REL-CERT-1            PIC X(11).
  6452         16  AT-RELATED-2.
  6453             20 AT-REL-CARR-2            PIC X.
  6454             20 AT-REL-CLAIM-2           PIC X(7).
  6455             20 AT-REL-CERT-2            PIC X(11).
  6456         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6457         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6458         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6459         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6460         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6461         16  AT-STOP-FORM-DT             PIC X(2).
  6462
  6463         16  FILLER                      PIC X(09).
  6464         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6465         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6466******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 121
* EL156.cbl
  6468*    COPY ELCACTQ.
  6469******************************************************************
  6470*                                                                *
  6471*                            ELCACTQ.                            *
  6472*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6473*                            VMOD=2.004                          *
  6474*                                                                *
  6475*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6476*                                                                *
  6477*   FILE TYPE = VSAM,KSDS                                        *
  6478*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6479*                                                                *
  6480*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6481*       ALTERNATE INDEX = NONE                                   *
  6482*                                                                *
  6483*   LOG = YES                                                    *
  6484*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6485*                                                                *
  6486*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6487******************************************************************
  6488
  6489 01  ACTIVITY-QUE.
  6490     12  AQ-RECORD-ID                PIC XX.
  6491         88  VALID-AQ-ID                VALUE 'AQ'.
  6492
  6493     12  AQ-CONTROL-PRIMARY.
  6494         16  AQ-COMPANY-CD           PIC X.
  6495         16  AQ-CARRIER              PIC X.
  6496         16  AQ-CLAIM-NO             PIC X(7).
  6497         16  AQ-CERT-NO.
  6498             20  AQ-CERT-PRIME       PIC X(10).
  6499             20  AQ-CERT-SFX         PIC X.
  6500
  6501     12  AQ-PENDING-ACTIVITY-FLAGS.
  6502         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6503         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6504             88  PENDING-PAYMENTS       VALUE '1'.
  6505         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6506             88  PENDING-FULL-PRINT     VALUE '1'.
  6507             88  PENDING-PART-PRINT     VALUE '2'.
  6508         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6509             88  PENDING-LETTERS        VALUE '1'.
  6510         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6511             88  PENDING-RESTORE        VALUE 'C'.
  6512             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6513
  6514     12  FILLER                      PIC X(20).
  6515
  6516     12  AQ-RESEND-DATE              PIC XX.
  6517     12  AQ-FOLLOWUP-DATE            PIC XX.
  6518     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6519     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6520     12  AQ-AUTO-LETTER              PIC X(4).
  6521     12  FILLER                      PIC XX.
  6522     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6523*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 122
* EL156.cbl
  6525*    COPY ERCACCT.
  6526******************************************************************
  6527*                                                                *
  6528*                                                                *
  6529*                            ERCACCT                             *
  6530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6531*                            VMOD=2.031                          *
  6532*                                                                *
  6533*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6534*                                                                *
  6535*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6536*   VSAM ACCOUNT MASTER FILES.                                   *
  6537*                                                                *
  6538*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6539*                                                                *
  6540*   FILE TYPE = VSAM,KSDS                                        *
  6541*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6542*                                                                *
  6543*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6544*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6545*                                                                *
  6546*   LOG = NO                                                     *
  6547*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6548*                                                                *
  6549*                                                                *
  6550******************************************************************
  6551*                   C H A N G E   L O G
  6552*
  6553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6554*-----------------------------------------------------------------
  6555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6556* EFFECTIVE    NUMBER
  6557*-----------------------------------------------------------------
  6558* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6559* 092705    2005050300006  PEMA  ADD SPP LEASES
  6560* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6561* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6562* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6563* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6564* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6565******************************************************************
  6566
  6567 01  ACCOUNT-MASTER.
  6568     12  AM-RECORD-ID                      PIC XX.
  6569         88  VALID-AM-ID                      VALUE 'AM'.
  6570
  6571     12  AM-CONTROL-PRIMARY.
  6572         16  AM-COMPANY-CD                 PIC X.
  6573         16  AM-MSTR-CNTRL.
  6574             20  AM-CONTROL-A.
  6575                 24  AM-CARRIER            PIC X.
  6576                 24  AM-GROUPING.
  6577                     28 AM-GROUPING-PREFIX PIC XXX.
  6578                     28 AM-GROUPING-PRIME  PIC XXX.
  6579                 24  AM-STATE              PIC XX.
  6580                 24  AM-ACCOUNT.
  6581                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6582                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 123
* EL156.cbl
  6583             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6584                                           PIC X(19).
  6585             20  AM-CNTRL-B.
  6586                 24  AM-EXPIRATION-DT      PIC XX.
  6587                 24  FILLER                PIC X(4).
  6588             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6589                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6590
  6591     12  AM-CONTROL-BY-VAR-GRP.
  6592         16  AM-COMPANY-CD-A1              PIC X.
  6593         16  AM-VG-CARRIER                 PIC X.
  6594         16  AM-VG-GROUPING                PIC X(6).
  6595         16  AM-VG-STATE                   PIC XX.
  6596         16  AM-VG-ACCOUNT                 PIC X(10).
  6597         16  AM-VG-DATE.
  6598             20  AM-VG-EXPIRATION-DT       PIC XX.
  6599             20  FILLER                    PIC X(4).
  6600         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6601                                           PIC 9(11)      COMP-3.
  6602     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6603         16  FILLER                        PIC X(10).
  6604         16  AM-VG-KEY3.
  6605             20  AM-VG3-ACCOUNT            PIC X(10).
  6606             20  AM-VG3-EXP-DT             PIC XX.
  6607         16  FILLER                        PIC X(4).
  6608     12  AM-MAINT-INFORMATION.
  6609         16  AM-LAST-MAINT-DT              PIC XX.
  6610         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6611         16  AM-LAST-MAINT-USER            PIC X(4).
  6612         16  FILLER                        PIC XX.
  6613
  6614     12  AM-EFFECTIVE-DT                   PIC XX.
  6615     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6616
  6617     12  AM-PREV-DATES  COMP-3.
  6618         16  AM-PREV-EXP-DT                PIC 9(11).
  6619         16  AM-PREV-EFF-DT                PIC 9(11).
  6620
  6621     12  AM-REPORT-CODE-1                  PIC X(10).
  6622     12  AM-REPORT-CODE-2                  PIC X(10).
  6623
  6624     12  AM-CITY-CODE                      PIC X(4).
  6625     12  AM-COUNTY-PARISH                  PIC X(6).
  6626
  6627     12  AM-NAME                           PIC X(30).
  6628     12  AM-PERSON                         PIC X(30).
  6629     12  AM-ADDRS                          PIC X(30).
  6630     12  AM-CITY.
  6631         16  AM-ADDR-CITY                  PIC X(28).
  6632         16  AM-ADDR-STATE                 PIC XX.
  6633     12  AM-ZIP.
  6634         16  AM-ZIP-PRIME.
  6635             20  AM-ZIP-PRI-1ST            PIC X.
  6636                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6637             20  FILLER                    PIC X(4).
  6638         16  AM-ZIP-PLUS4                  PIC X(4).
  6639     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6640         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 124
* EL156.cbl
  6641         16  AM-CAN-POSTAL-2               PIC XXX.
  6642         16  FILLER                        PIC XXX.
  6643     12  AM-TEL-NO.
  6644         16  AM-AREA-CODE                  PIC 999.
  6645         16  AM-TEL-PRE                    PIC 999.
  6646         16  AM-TEL-NBR                    PIC 9(4).
  6647     12  AM-TEL-LOC                        PIC X.
  6648         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6649         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6650
  6651     12  AM-COMM-STRUCTURE.
  6652         16  AM-DEFN-1.
  6653             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6654                 24  AM-AGT.
  6655                     28  AM-AGT-PREFIX     PIC X(4).
  6656                     28  AM-AGT-PRIME      PIC X(6).
  6657                 24  AM-COM-TYP            PIC X.
  6658                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6659                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6660                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6661                 24  AM-RECALC-LV-INDIC    PIC X.
  6662                 24  AM-RETRO-LV-INDIC     PIC X.
  6663                 24  AM-GL-CODES           PIC X.
  6664                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6665                 24  FILLER                PIC X(01).
  6666         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6667             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6668                 24  FILLER                PIC X(11).
  6669                 24  AM-L-COMA             PIC XXX.
  6670                 24  AM-J-COMA             PIC XXX.
  6671                 24  AM-A-COMA             PIC XXX.
  6672                 24  FILLER                PIC X(6).
  6673
  6674     12  AM-COMM-CHANGE-STATUS             PIC X.
  6675         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6676
  6677     12  AM-CSR-CODE                       PIC X(4).
  6678
  6679     12  AM-BILLING-STATUS                 PIC X.
  6680         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6681         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6682     12  AM-AUTO-REFUND-SW                 PIC X.
  6683         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6684         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6685     12  AM-GPCD                           PIC 99.
  6686     12  AM-IG                             PIC X.
  6687         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6688         88  AM-HAS-GROUP                     VALUE '2'.
  6689     12  AM-STATUS                         PIC X.
  6690         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6691         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6692         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6693         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6694         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6695         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6696     12  AM-REMIT-TO                       PIC 99.
  6697     12  AM-ID-NO                          PIC X(11).
  6698
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 125
* EL156.cbl
  6699     12  AM-CAL-TABLE                      PIC XX.
  6700     12  AM-LF-DEVIATION                   PIC XXX.
  6701     12  AM-AH-DEVIATION                   PIC XXX.
  6702     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6703     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6704     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6705     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6706     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6707     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6708
  6709     12  AM-USER-FIELDS.
  6710         16  AM-FLD-1                      PIC XX.
  6711         16  AM-FLD-2                      PIC XX.
  6712         16  AM-FLD-3                      PIC XX.
  6713         16  AM-FLD-4                      PIC XX.
  6714         16  AM-FLD-5                      PIC XX.
  6715
  6716     12  AM-1ST-PROD-DATE.
  6717         16  AM-1ST-PROD-YR                PIC XX.
  6718         16  AM-1ST-PROD-MO                PIC XX.
  6719         16  AM-1ST-PROD-DA                PIC XX.
  6720     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6721     12  AM-CERTS-PURGED-DATE.
  6722         16  AM-PUR-YR                     PIC XX.
  6723         16  AM-PUR-MO                     PIC XX.
  6724         16  AM-PUR-DA                     PIC XX.
  6725     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6726     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6727     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6728     12  AM-INACTIVE-DATE.
  6729         16  AM-INA-MO                     PIC 99.
  6730         16  AM-INA-DA                     PIC 99.
  6731         16  AM-INA-YR                     PIC 99.
  6732     12  AM-AR-HI-CERT-DATE                PIC XX.
  6733
  6734     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6735     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6736
  6737     12  AM-OB-PAYMENT-MODE                PIC X.
  6738         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6739         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6740         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6741         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6742
  6743     12  AM-AH-ONLY-INDICATOR              PIC X.
  6744         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6745         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6746
  6747     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6748
  6749     12  AM-OVER-SHORT.
  6750         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6751         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6752
  6753     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6754     12  AM-DCC-CLP-STATE                  PIC XX.
  6755
  6756     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 126
* EL156.cbl
  6757     12  AM-RECALC-REIN                    PIC X.
  6758
  6759     12  AM-REI-TABLE                      PIC XXX.
  6760     12  AM-REI-ET-LF                      PIC X.
  6761     12  AM-REI-ET-AH                      PIC X.
  6762     12  AM-REI-PE-LF                      PIC X.
  6763     12  AM-REI-PE-AH                      PIC X.
  6764     12  AM-REI-PRT-ST                     PIC X.
  6765     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6766     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6767     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6768     12  AM-REI-GROUP-A                    PIC X(6).
  6769     12  AM-REI-MORT                       PIC X(4).
  6770     12  AM-REI-PRT-OW                     PIC X.
  6771     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6772     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6773     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6774     12  AM-REI-GROUP-B                    PIC X(6).
  6775
  6776     12  AM-TRUST-TYPE                     PIC X(2).
  6777
  6778     12  AM-EMPLOYER-STMT-USED             PIC X.
  6779     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6780
  6781     12  AM-STD-AH-TYPE                    PIC XX.
  6782     12  AM-EARN-METHODS.
  6783         16  AM-EARN-METHOD-R              PIC X.
  6784             88 AM-REF-RL-R78                 VALUE 'R'.
  6785             88 AM-REF-RL-PR                  VALUE 'P'.
  6786             88 AM-REF-RL-MEAN                VALUE 'M'.
  6787             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6788         16  AM-EARN-METHOD-L              PIC X.
  6789             88 AM-REF-LL-R78                 VALUE 'R'.
  6790             88 AM-REF-LL-PR                  VALUE 'P'.
  6791             88 AM-REF-LL-MEAN                VALUE 'M'.
  6792             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6793         16  AM-EARN-METHOD-A              PIC X.
  6794             88 AM-REF-AH-R78                 VALUE 'R'.
  6795             88 AM-REF-AH-PR                  VALUE 'P'.
  6796             88 AM-REF-AH-MEAN                VALUE 'M'.
  6797             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6798             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6799             88 AM-REF-AH-NET                 VALUE 'N'.
  6800
  6801     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6802     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6803     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6804
  6805     12  AM-RET-Y-N                        PIC X.
  6806     12  AM-RET-P-E                        PIC X.
  6807     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6808     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6809     12  AM-RET-GRP                        PIC X(6).
  6810     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6811         16  AM-POOL-PRIME                 PIC XXX.
  6812         16  AM-POOL-SUB                   PIC XXX.
  6813     12  AM-RETRO-EARNINGS.
  6814         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 127
* EL156.cbl
  6815         16  AM-RET-EARN-L                 PIC X.
  6816         16  AM-RET-EARN-A                 PIC X.
  6817     12  AM-RET-ST-TAX-USE                 PIC X.
  6818         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6819         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6820     12  AM-RETRO-BEG-EARNINGS.
  6821         16  AM-RET-BEG-EARN-R             PIC X.
  6822         16  AM-RET-BEG-EARN-L             PIC X.
  6823         16  AM-RET-BEG-EARN-A             PIC X.
  6824     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6825     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6826
  6827     12  AM-USER-SELECT-OPTIONS.
  6828         16  AM-USER-SELECT-1              PIC X(10).
  6829         16  AM-USER-SELECT-2              PIC X(10).
  6830         16  AM-USER-SELECT-3              PIC X(10).
  6831         16  AM-USER-SELECT-4              PIC X(10).
  6832         16  AM-USER-SELECT-5              PIC X(10).
  6833
  6834     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6835
  6836     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6837
  6838     12  AM-RPT045A-SWITCH                 PIC X.
  6839         88  RPT045A-OFF                   VALUE 'N'.
  6840
  6841     12  AM-INSURANCE-LIMITS.
  6842         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6843         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6844
  6845     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6846         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6847
  6848     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6849         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6850         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6851
  6852     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6853
  6854     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6855     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6856     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6857     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6858     12  AM-DCC-UEF-STATE                  PIC XX.
  6859     12  FILLER                            PIC XXX.
  6860     12  AM-REPORT-CODE-3                  PIC X(10).
  6861*    12  FILLER                            PIC X(22).
  6862
  6863     12  AM-RESERVE-DATE.
  6864         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6865         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6866         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6867
  6868     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6869     12  AM-NOTIFICATION-TYPES.
  6870         16  AM-NOTIF-OF-LETTERS           PIC X.
  6871         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6872         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 128
* EL156.cbl
  6873         16  AM-NOTIF-OF-STATUS            PIC X.
  6874
  6875     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6876         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6877         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6878         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6879         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6880
  6881     12  AM-BENEFIT-CONTROLS.
  6882         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6883             20  AM-BENEFIT-CODE           PIC XX.
  6884             20  AM-BENEFIT-TYPE           PIC X.
  6885             20  AM-BENEFIT-REVISION       PIC XXX.
  6886             20  AM-BENEFIT-REM-TERM       PIC X.
  6887             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6888             20  FILLER                    PIC XX.
  6889         16  FILLER                        PIC X(80).
  6890
  6891     12  AM-TRANSFER-DATA.
  6892         16  AM-TRANSFERRED-FROM.
  6893             20  AM-TRNFROM-CARRIER        PIC X.
  6894             20  AM-TRNFROM-GROUPING.
  6895                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6896                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6897             20  AM-TRNFROM-STATE          PIC XX.
  6898             20  AM-TRNFROM-ACCOUNT.
  6899                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6900                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6901             20  AM-TRNFROM-DTE            PIC XX.
  6902         16  AM-TRANSFERRED-TO.
  6903             20  AM-TRNTO-CARRIER          PIC X.
  6904             20  AM-TRNTO-GROUPING.
  6905                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6906                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6907             20  AM-TRNTO-STATE            PIC XX.
  6908             20  AM-TRNTO-ACCOUNT.
  6909                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6910                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6911             20  AM-TRNTO-DTE              PIC XX.
  6912         16  FILLER                        PIC X(10).
  6913
  6914     12  AM-SAVED-REMIT-TO                 PIC 99.
  6915
  6916     12  AM-COMM-STRUCTURE-SAVED.
  6917         16  AM-DEFN-1-SAVED.
  6918             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6919                 24  AM-AGT-SV             PIC X(10).
  6920                 24  AM-COM-TYP-SV         PIC X.
  6921                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6922                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6923                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6924                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6925                 24  FILLER                PIC X.
  6926                 24  AM-GL-CODES-SV        PIC X.
  6927                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6928                 24  FILLER                PIC X.
  6929         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6930             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 129
* EL156.cbl
  6931                 24  FILLER                PIC X(11).
  6932                 24  AM-L-COMA-SV          PIC XXX.
  6933                 24  AM-J-COMA-SV          PIC XXX.
  6934                 24  AM-A-COMA-SV          PIC XXX.
  6935                 24  FILLER                PIC X(6).
  6936
  6937     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6938         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6939            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6940            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6941            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6942
  6943     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6944     12  FILLER                            PIC X(120).
  6945
  6946     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6947         16  AM-CONTROL-NAME               PIC X(30).
  6948         16  AM-EXECUTIVE-ONE.
  6949             20  AM-EXEC1-NAME             PIC X(15).
  6950             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6951                                                          COMP-3.
  6952             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6953                                                          COMP-3.
  6954         16  AM-EXECUTIVE-TWO.
  6955             20  AM-EXEC2-NAME             PIC X(15).
  6956             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6957                                                          COMP-3.
  6958             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6959                                                          COMP-3.
  6960
  6961     12  AM-RETRO-ADDITIONAL-DATA.
  6962         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6963         16  AM-RETRO-PREM-P-E             PIC X.
  6964         16  AM-RETRO-CLMS-P-I             PIC X.
  6965         16  AM-RETRO-RET-BRACKET-LF.
  6966             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6967                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6968                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6969             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6970                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6971                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6972             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6973                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6974                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6975         16  AM-RETRO-RET-BRACKET-AH.
  6976             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6977                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6978                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6979                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6980             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6981                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6982                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6983             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6984                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6985                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6986
  6987     12  AM-COMMENTS.
  6988         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 130
* EL156.cbl
  6989
  6990     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6991         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6992         16  AM-FLI-BILLING-CODE           PIC X.
  6993         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6994         16  AM-FLI-UNITED-IDENT           PIC X.
  6995         16  AM-FLI-INTEREST-LOST-DATA.
  6996             20  AM-FLI-BANK-NO            PIC X(5).
  6997             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6998             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6999             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7000         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7001             20  AM-FLI-AGT                PIC X(9).
  7002             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7003             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7004         16  FILLER                        PIC X(102).
  7005
  7006     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7007         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7008             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7009             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7010             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7011             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7012             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7013         16  FILLER                          PIC X(10).
  7014******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 131
* EL156.cbl
  7016*    COPY ELCCHKQ.
  7017******************************************************************
  7018*                                                                *
  7019*                                                                *
  7020*                            ELCCHKQ.                            *
  7021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7022*                            VMOD=2.007                          *
  7023*                                                                *
  7024*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7025*                                                                *
  7026*   FILE TYPE = VSAM,KSDS                                        *
  7027*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7028*                                                                *
  7029*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7030*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7031*                                                                *
  7032*   LOG = YES                                                    *
  7033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7034******************************************************************
  7035 01  CHECK-QUE.
  7036     12  CQ-RECORD-ID                PIC XX.
  7037         88  VALID-CQ-ID         VALUE 'CQ'.
  7038
  7039     12  CQ-CONTROL-PRIMARY.
  7040         16  CQ-COMPANY-CD           PIC X.
  7041         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7042         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7043
  7044     12  CQ-CONTROL-BY-PAYEE.
  7045         16  CQ-CONTROL-BY-NUMBER.
  7046             20  CQ-COMPANY-CD-A1     PIC X.
  7047             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7048         16  CQ-PAYEE-CARRIER        PIC X.
  7049         16  CQ-PAYEE-GROUPING       PIC X(6).
  7050         16  CQ-PAYEE-STATE          PIC XX.
  7051         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7052         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7053
  7054     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7055         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7056         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7057         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7058         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7059         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7060         16  FILLER                  PIC X(3).
  7061
  7062     12  CQ-ENTRY-TYPE               PIC X.
  7063             88  CHECK-ON-QUE           VALUE 'Q'.
  7064             88  ALIGNMENT-CHECK        VALUE 'A'.
  7065             88  SPOILED-CHECK          VALUE 'S'.
  7066             88  PAYMENT-ABORTED        VALUE 'X'.
  7067
  7068     12  CQ-CLAIM-MAST-CNTL.
  7069         16  CQ-CARRIER              PIC X.
  7070         16  CQ-CLAIM-NO             PIC X(7).
  7071         16  CQ-CERT-NO.
  7072             20  CQ-CERT-PRIME       PIC X(10).
  7073             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 132
* EL156.cbl
  7074         16  CQ-CLAIM-TYPE           PIC X.
  7075             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7076             88  CQ-AH-CLAIM            VALUE 'A'.
  7077         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7078             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7079             88  CQ-O-B-COVERAGE        VALUE '2'.
  7080             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7081
  7082     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7083     12  CQ-CHECK-NUMBER             PIC X(7).
  7084     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7085     12  CQ-PAYMENT-TYPE             PIC X.
  7086             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7087             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7088             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7089             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7090             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7091             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7092             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7093             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7094     12  CQ-VOID-INDICATOR           PIC X.
  7095             88  CHECK-IS-STOPPED          VALUE 'S'.
  7096             88  CHECK-IS-VOID             VALUE 'V'.
  7097     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7098     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7099     12  CQ-CHECK-BY-USER            PIC X(4).
  7100     12  CQ-PRE-NUMBERING-SW         PIC X.
  7101       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7102       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7103
  7104     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7105     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7106     12  CQ-LEDGER-FLAG              PIC X(01).
  7107     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7108     12  CQ-LAST-UPDATED-DT          PIC XX.
  7109     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7110     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7111
  7112     12  FILLER                      PIC X(04).
  7113
  7114******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 133
* EL156.cbl
  7116*    COPY ELCBENE.
  7117******************************************************************
  7118*                                                                *
  7119*                            ELCBENE.                            *
  7120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7121*                            VMOD=2.006                          *
  7122*                                                                *
  7123*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7124*                                                                *
  7125*   FILE TYPE = VSAM,KSDS                                        *
  7126*   RECORD SIZE = 500   RECFORM = FIX                            *
  7127*                                                                *
  7128*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7129*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7130*                                                                *
  7131*   LOG = YES                                                    *
  7132*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7133*                                                                *
  7134*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7135******************************************************************
  7136
  7137 01  BENEFICIARY-MASTER.
  7138     12  BE-RECORD-ID                PIC XX.
  7139         88  VALID-BE-ID                VALUE 'BE'.
  7140
  7141     12  BE-CONTROL-PRIMARY.
  7142         16  BE-COMPANY-CD           PIC X.
  7143         16  BE-RECORD-TYPE          PIC X.
  7144             88  BENEFICIARY-RECORD  VALUE 'B'.
  7145             88  ADJUSTOR-RECORD     VALUE 'A'.
  7146         16  BE-BENEFICIARY          PIC X(10).
  7147     12  BE-CONTROL-BY-NAME.
  7148         16  BE-COMPANY-CD-A1        PIC X.
  7149         16  BE-RECORD-TYPE-A1       PIC X.
  7150         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7151         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7152
  7153     12  BE-LAST-MAINT-DT            PIC XX.
  7154     12  BE-LAST-MAINT-BY            PIC X(4).
  7155     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7156
  7157     12  BE-ADDRESS-DATA.
  7158         16  BE-MAIL-TO-NAME         PIC X(30).
  7159         16  BE-ADDRESS-LINE-1       PIC X(30).
  7160         16  BE-ADDRESS-LINE-2       PIC X(30).
  7161         16  BE-ADDRESS-LINE-3       PIC X(30).
  7162         16  BE-CITY-STATE.
  7163             20  BE-CITY             PIC X(28).
  7164             20  BE-STATE            PIC XX.
  7165         16  BE-ZIP-CODE.
  7166             20  BE-ZIP-PRIME.
  7167                 24  BE-ZIP-1ST      PIC X.
  7168                     88  BE-CANADIAN-POST-CODE
  7169                                         VALUE 'A' THRU 'Z'.
  7170                 24  FILLER          PIC X(4).
  7171             20  BE-ZIP-PLUS4        PIC X(4).
  7172         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7173             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 134
* EL156.cbl
  7174             20  BE-CAN-POSTAL-2     PIC XXX.
  7175             20  FILLER              PIC XXX.
  7176         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7177         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7178
  7179******************************************************************
  7180*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7181*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7182******************************************************************
  7183     12  BE-CARRIER                  PIC X.
  7184
  7185     12  BE-ADDRESS-DATA2.
  7186         16  BE-MAIL-TO-NAME2        PIC X(30).
  7187         16  BE-ADDRESS-LINE-12      PIC X(30).
  7188         16  BE-ADDRESS-LINE-22      PIC X(30).
  7189         16  BE-ADDRESS-LINE-32      PIC X(30).
  7190         16  BE-CITY-STATE2.
  7191             20  BE-CITY2            PIC X(28).
  7192             20  BE-STATE2           PIC XX.
  7193         16  BE-ZIP-CODE2.
  7194             20  BE-ZIP-PRIME2.
  7195                 24  BE-ZIP-1ST2     PIC X.
  7196                     88  BE-CANADIAN-POST-CODE2
  7197                                         VALUE 'A' THRU 'Z'.
  7198                 24  FILLER          PIC X(4).
  7199             20  BE-ZIP-PLUS42       PIC X(4).
  7200         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7201             20  BE-CAN-POSTAL-12    PIC XXX.
  7202             20  BE-CAN-POSTAL-22    PIC XXX.
  7203             20  FILLER              PIC XXX.
  7204         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7205         16  BE-BILLING-STMT-DATA.
  7206             20  BE-BSR              PIC X.
  7207                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7208                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7209             20  BE-BSR-FROM         PIC X(30).
  7210             20  BE-BSR-DEPT         PIC X(30).
  7211             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7212             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7213             20  BE-OUTPUT-TYPE      PIC X.
  7214                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7215                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7216
  7217     12  FILLER                      PIC X(28).
  7218******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 135
* EL156.cbl
  7220*    COPY ELCARCH.
  7221******************************************************************
  7222*                                                                *
  7223*                            ELCARCH.                            *
  7224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7225*                            VMOD=2.007                          *
  7226*                                                                *
  7227*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7228*                                                                *
  7229*   FILE TYPE = VSAM,KSDS                                        *
  7230*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7231*                                                                *
  7232*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7233*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7234*                                                                *
  7235*   LOG = NO                                                     *
  7236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7237*                                                                *
  7238*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7239******************************************************************
  7240 01  LETTER-ARCHIVE.
  7241     12  LA-RECORD-ID                PIC XX.
  7242         88  VALID-LA-ID                VALUE 'LA'.
  7243
  7244     12  LA-CONTROL-PRIMARY.
  7245         16  LA-COMPANY-CD           PIC X.
  7246         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7247         16  LA-RECORD-TYPE          PIC X.
  7248             88  LA-HEADER-DATA         VALUE '1'.
  7249             88  LA-ADDRESS-DATA        VALUE '2'.
  7250             88  LA-TEXT-DATA           VALUE '3'.
  7251             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7252         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7253
  7254     12  LA-CONTROL-BY-TYPE.
  7255         16  LA-COMPANY-CD-A1        PIC X.
  7256         16  LA-RECORD-TYPE-A1       PIC X.
  7257         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7258         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7259
  7260     12  LA-TEXT-RECORD.
  7261         16  LA-SKIP-CONTROL         PIC XX.
  7262             88  NO-LINES-SKIPPED       VALUE SPACES.
  7263             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7264         16  LA-TEXT-LINE            PIC X(70).
  7265
  7266     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7267         16  FILLER                  PIC XX.
  7268         16  LA-ADDRESS-LINE         PIC X(30).
  7269         16  FILLER                  PIC X(40).
  7270
  7271     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7272         16  FILLER                  PIC XX.
  7273         16  LA-CARRIER              PIC X.
  7274         16  LA-CLAIM-NO             PIC X(7).
  7275         16  LA-CERT-NO.
  7276             20  LA-CERT-PRIME       PIC X(10).
  7277             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 136
* EL156.cbl
  7278         16  LA-NO-OF-COPIES         PIC S9.
  7279         16  LA-RESEND-DATE          PIC XX.
  7280         16  LA-PROCESSOR-CD         PIC X(4).
  7281         16  LA-CREATION-DT          PIC XX.
  7282         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7283         16  LA-RESEND-PRINT-DATE    PIC XX.
  7284         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7285         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7286*
  7287* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7288*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7289*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7290*   I        20  LA-DMD-RES-ST           PIC XX.
  7291*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7292*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7293*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7294*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7295*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7296*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7297*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7298*   I        20  LA-DMD-UND-CODE         PIC XX.
  7299*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7300*   V    16  FILLER                  PIC X(15).
  7301* -----
  7302*
  7303* REINSERTED  CSO  MODS
  7304*
  7305         16  FILLER.
  7306             20  FILLER                  PIC X(29).
  7307             20  LA-CSO-LETTER-STATUS    PIC X.
  7308                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7309                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7310                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7311             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7312             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7313*
  7314
  7315     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7316         16  FILLER                  PIC XX.
  7317         16  LA4-CARRIER             PIC X.
  7318         16  LA4-CLAIM-NO            PIC X(7).
  7319         16  LA4-CERT-NO.
  7320             20  LA4-CERT-PRIME      PIC X(10).
  7321             20  LA4-CERT-SFX        PIC X.
  7322         16  LA4-NO-OF-COPIES        PIC S9.
  7323         16  LA4-RESEND-DATE         PIC XX.
  7324         16  LA4-PROCESSOR-CD        PIC X(4).
  7325         16  LA4-CREATION-DT         PIC XX.
  7326         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7327         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7328         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7329         16  LA4-FORM-TYPE           PIC X.
  7330             88  LA4-INITIAL-FORM    VALUE '1'.
  7331             88  LA4-PROGRESS-FORM   VALUE '2'.
  7332         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7333         16  LA4-STATE               PIC X(02).
  7334         16  FILLER                  PIC X(31).
  7335******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 137
* EL156.cbl
  7337*    COPY ELCDAR.
  7338******************************************************************
  7339*                                                                *
  7340*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7341*   FILE TYPE = VSAM,KSDS                                        *
  7342*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7343*   BASE CLUSTER = DLYACTV                                       *
  7344*   LOG = YES                                                    *
  7345*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7346*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7347*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7348*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7349*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7350*               BY PROGRAM "LGINFCE".                            *
  7351*                                                                *
  7352******************************************************************
  7353 01  DAILY-ACTIVITY-RECORD.
  7354     05  DA-KEY.
  7355         10  DA-COMP-CD          PIC X.
  7356         10  DA-CARRIER          PIC X.
  7357         10  DA-CLAIM-NO         PIC X(7).
  7358         10  DA-CERT-NO.
  7359             15  DA-CERT-PRIME   PIC X(10).
  7360             15  DA-CERT-SFX     PIC X.
  7361     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7362     05  DA-RECORD-TYPE          PIC X.
  7363     05  FILLER                  PIC X(2).
  7364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 138
* EL156.cbl
  7366*    COPY ERCCOMP.
  7367******************************************************************
  7368*                                                                *
  7369*                                                                *
  7370*                            ERCCOMP                             *
  7371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7372*                            VMOD=2.019                          *
  7373*                                                                *
  7374*   ONLINE CREDIT SYSTEM                                         *
  7375*                                                                *
  7376*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7377*                                                                *
  7378*   FILE TYPE = VSAM,KSDS                                        *
  7379*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7380*                                                                *
  7381*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7382*       ALTERNATE PATH = NONE                                    *
  7383*                                                                *
  7384*   LOG = NO                                                     *
  7385*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7386*                                                                *
  7387******************************************************************
  7388*                   C H A N G E   L O G
  7389*
  7390* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7391*-----------------------------------------------------------------
  7392*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7393* EFFECTIVE    NUMBER
  7394*-----------------------------------------------------------------
  7395* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7396* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7397* 092205    2005050300006  PEMA  ADD LEASE FEE
  7398* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7399* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7400* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7401* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7402* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7403* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7404******************************************************************
  7405
  7406 01  COMPENSATION-MASTER.
  7407     12  CO-RECORD-ID                          PIC XX.
  7408         88  VALID-CO-ID                          VALUE 'CO'.
  7409
  7410     12  CO-CONTROL-PRIMARY.
  7411         16  CO-COMPANY-CD                     PIC X.
  7412         16  CO-CONTROL.
  7413             20  CO-CTL-1.
  7414                 24  CO-CARR-GROUP.
  7415                     28  CO-CARRIER            PIC X.
  7416                     28  CO-GROUPING.
  7417                         32  CO-GROUP-PREFIX   PIC XXX.
  7418                         32  CO-GROUP-PRIME    PIC XXX.
  7419                 24  CO-RESP-NO.
  7420                     28  CO-RESP-PREFIX        PIC X(4).
  7421                     28  CO-RESP-PRIME         PIC X(6).
  7422             20  CO-CTL-2.
  7423                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 139
* EL156.cbl
  7424                     28  CO-ACCT-PREFIX        PIC X(4).
  7425                     28  CO-ACCT-PRIME         PIC X(6).
  7426         16  CO-TYPE                           PIC X.
  7427             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7428             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7429             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7430
  7431     12  CO-MAINT-INFORMATION.
  7432         16  CO-LAST-MAINT-DT                  PIC XX.
  7433         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7434         16  CO-LAST-MAINT-USER                PIC X(4).
  7435     12  FILLER                                PIC XX.
  7436     12  CO-STMT-TYPE                          PIC XXX.
  7437     12  CO-COMP-TYPE                          PIC X.
  7438         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7439     12  CO-STMT-OWNER                         PIC X(4).
  7440     12  CO-BALANCE-CONTROL                    PIC X.
  7441         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7442         88  CO-NO-BALANCE                        VALUE 'N'.
  7443
  7444     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7445         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7446         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7447         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7448
  7449     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7450         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7451         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7452
  7453     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7454     12  CO-GA-DIRECT-DEP                      PIC X.
  7455     12  CO-FUTURE-SPACE                       PIC X.
  7456         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7457
  7458     12  CO-ACCT-NAME                          PIC X(30).
  7459     12  CO-MAIL-NAME                          PIC X(30).
  7460     12  CO-ADDR-1                             PIC X(30).
  7461     12  CO-ADDR-2                             PIC X(30).
  7462     12  CO-ADDR-3.
  7463         16  CO-ADDR-CITY                      PIC X(27).
  7464         16  CO-ADDR-STATE                     PIC XX.
  7465     12  CO-CSO-1099                           PIC X.
  7466     12  CO-ZIP.
  7467         16  CO-ZIP-PRIME.
  7468             20  CO-ZIP-PRI-1ST                PIC X.
  7469                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7470             20  FILLER                        PIC X(4).
  7471         16  CO-ZIP-PLUS4                      PIC X(4).
  7472     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7473         16  CO-CAN-POSTAL-1                   PIC XXX.
  7474         16  CO-CAN-POSTAL-2                   PIC XXX.
  7475         16  FILLER                            PIC XXX.
  7476     12  CO-SOC-SEC                            PIC X(13).
  7477     12  CO-TELEPHONE.
  7478         16  CO-AREA-CODE                      PIC XXX.
  7479         16  CO-PREFIX                         PIC XXX.
  7480         16  CO-PHONE                          PIC X(4).
  7481
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 140
* EL156.cbl
  7482     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7483
  7484     12  CO-AR-BAL-LEVEL                       PIC X.
  7485         88  CO-AR-REF-LVL                        VALUE '1'.
  7486         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7487         88  CO-AR-BILL-LVL                       VALUE '2'.
  7488         88  CO-AR-AGT-LVL                        VALUE '3'.
  7489         88  CO-AR-FR-LVL                         VALUE '4'.
  7490
  7491     12  CO-AR-NORMAL-PRINT                    PIC X.
  7492         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7493         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7494
  7495     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7496
  7497     12  CO-AR-REPORTING                       PIC X.
  7498         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7499         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7500
  7501     12  CO-AR-PULL-CHECK                      PIC X.
  7502         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7503         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7504
  7505     12  CO-AR-BALANCE-PRINT                   PIC X.
  7506         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7507
  7508     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7509         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7510         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7511         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7512
  7513     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7514
  7515     12  CO-USER-CODE                          PIC X.
  7516     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7517
  7518******************************************************************
  7519*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7520*    THE LAST MONTH END RUN.
  7521******************************************************************
  7522
  7523     12  CO-LAST-ACTIVITY-DATE.
  7524         16  CO-ACT-YEAR                       PIC 99.
  7525         16  CO-ACT-MONTH                      PIC 99.
  7526         16  CO-ACT-DAY                        PIC 99.
  7527
  7528     12  CO-LAST-STMT-DT.
  7529         16  CO-LAST-STMT-YEAR                 PIC 99.
  7530         16  CO-LAST-STMT-MONTH                PIC 99.
  7531         16  CO-LAST-STMT-DAY                  PIC 99.
  7532
  7533     12  CO-MO-END-TOTALS.
  7534         16  CO-MONTHLY-TOTALS.
  7535             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7536             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7537             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7538             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7539             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 141
* EL156.cbl
  7540
  7541         16  CO-AGING-TOTALS.
  7542             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7543             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7544             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7545             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7546
  7547         16  CO-YTD-TOTALS.
  7548             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7549             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7550
  7551         16  CO-OVER-UNDER-TOTALS.
  7552             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7553             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7554
  7555     12  CO-MISCELLANEOUS-TOTALS.
  7556         16  CO-FICA-TOTALS.
  7557             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7558             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7559
  7560         16  CO-CLAIM-TOTALS.
  7561             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7562             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7563
  7564******************************************************************
  7565*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7566*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7567******************************************************************
  7568
  7569     12  CO-CURRENT-TOTALS.
  7570         16  CO-CURRENT-LAST-STMT-DT.
  7571             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7572             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7573             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7574
  7575         16  CO-CURRENT-MONTHLY-TOTALS.
  7576             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7577             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7578             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7579             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7580             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7581
  7582         16  CO-CURRENT-AGING-TOTALS.
  7583             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7584             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7585             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7586             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7587
  7588         16  CO-CURRENT-YTD-TOTALS.
  7589             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7590             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7591
  7592     12  CO-PAID-COMM-TOTALS.
  7593         16  CO-YTD-PAID-COMMS.
  7594             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7595             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7596
  7597     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 142
* EL156.cbl
  7598         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7599         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7600
  7601     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7602         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7603         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7604         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7605         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7606         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7607         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7608         88  CO-FINAL-LETTER                  VALUE 'F'.
  7609         88  CO-RECONCILING                   VALUE 'R'.
  7610         88  CO-PHONE-CALL                    VALUE 'P'.
  7611         88  CO-LEGAL                         VALUE 'L'.
  7612         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7613         88  CO-WRITE-OFF                     VALUE 'W'.
  7614         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7615
  7616     12  CO-CSR-CODE                       PIC X(4).
  7617
  7618     12  CO-GA-STATUS-INFO.
  7619         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7620         16  CO-GA-TERMINATION-DT          PIC XX.
  7621         16  CO-GA-STATUS-CODE             PIC X.
  7622             88  CO-GA-ACTIVE                 VALUE 'A'.
  7623             88  CO-GA-INACTIVE               VALUE 'I'.
  7624             88  CO-GA-PENDING                VALUE 'P'.
  7625         16  CO-GA-COMMENTS.
  7626             20  CO-GA-COMMENT-1           PIC X(40).
  7627             20  CO-GA-COMMENT-2           PIC X(40).
  7628             20  CO-GA-COMMENT-3           PIC X(40).
  7629             20  CO-GA-COMMENT-4           PIC X(40).
  7630
  7631     12  CO-RPTCD2                         PIC X(10).
  7632     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7633         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7634         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7635
  7636     12  CO-TYPE-AGENT                     PIC X(01).
  7637         88  CO-CORPORATION                   VALUE 'C'.
  7638         88  CO-PARTNERSHIP                   VALUE 'P'.
  7639         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7640         88  CO-TRUST                         VALUE 'T'.
  7641         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7642
  7643     12  CO-FAXNO.
  7644         16  CO-FAX-AREA-CODE                  PIC XXX.
  7645         16  CO-FAX-PREFIX                     PIC XXX.
  7646         16  CO-FAX-PHONE                      PIC X(4).
  7647
  7648     12  CO-BANK-INFORMATION.
  7649         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7650         16  CO-BANK-TRANSIT-NON REDEFINES
  7651             CO-BANK-TRANSIT-NO                PIC 9(8).
  7652
  7653         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7654     12  CO-MISC-DEDUCT-INFO REDEFINES
  7655                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 143
* EL156.cbl
  7656         16  CO-MD-GL-ACCT                     PIC X(10).
  7657         16  CO-MD-DIV                         PIC XX.
  7658         16  CO-MD-CENTER                      PIC X(4).
  7659         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7660         16  CO-CREATE-AP-CHECK                PIC X.
  7661         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7662         16  FILLER                            PIC XXX.
  7663     12  CO-ACH-STATUS                         PIC X.
  7664         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7665         88  CO-ACH-PENDING                        VALUE 'P'.
  7666
  7667     12  CO-BILL-SW                            PIC X.
  7668     12  CO-CONTROL-NAME                       PIC X(30).
  7669     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7670     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7671     12  CO-CLP-STATE                          PIC XX.
  7672     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7673     12  CO-SPP-REFUND-EDIT                    PIC X.
  7674
  7675******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 144
* EL156.cbl
  7677*    COPY ERCDMDNT.
  7678******************************************************************
  7679*                                                                *
  7680*                            ERCDMDNT                            *
  7681*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7682*                            VMOD=2.005                          *
  7683*                                                                *
  7684*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7685*                                                                *
  7686*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7687*                                                                *
  7688*        FILE TYPE= VSAM,KSDS                                    *
  7689*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7690*                                                                *
  7691*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7692*                                                                *
  7693*        LOG = YES                                               *
  7694*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7695*                                                                *
  7696******************************************************************
  7697
  7698 01  CERTIFICATE-NOTE.
  7699     12  CN-RECORD-ID                     PIC  XX.
  7700         88  VALID-CN-ID                      VALUE 'CN'.
  7701
  7702     12  CN-CONTROL-PRIMARY.
  7703         16  CN-COMPANY-CD                PIC X.
  7704         16  CN-CERT-KEY.
  7705             20  CN-CARRIER               PIC X.
  7706             20  CN-GROUPING.
  7707                 24  CN-GROUPING-PREFIX   PIC XXX.
  7708                 24  CN-GROUPING-PRIME    PIC XXX.
  7709             20  CN-STATE                 PIC XX.
  7710             20  CN-ACCOUNT.
  7711                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7712                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7713             20  CN-CERT-EFF-DT           PIC XX.
  7714             20  CN-CERT-NO.
  7715                 24  CN-CERT-PRIME        PIC X(10).
  7716                 24  CN-CERT-SFX          PIC X.
  7717
  7718     12  CN-BILLING-START-LINE-NO         PIC 99.
  7719     12  CN-BILLING-END-LINE-NO           PIC 99.
  7720
  7721     12  CN-LINES.
  7722         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7723
  7724     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7725         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7726         16  CN-CSI-GENERAL-DATA-AREA.
  7727             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7728
  7729         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7730             CN-CSI-GENERAL-DATA-AREA.
  7731             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7732             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7733             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7734             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 145
* EL156.cbl
  7735             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7736             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7737             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7738             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7739             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7740             20  FILLER                       PIC XX.
  7741             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7742             20  FILLER                       PIC X(38).
  7743
  7744         16  CN-CSI-PRODUCT-DATA-AREA.
  7745             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7746
  7747         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7748             CN-CSI-PRODUCT-DATA-AREA.
  7749             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7750             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7751             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7752             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7753             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7754             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7755             20  FILLER                   PIC XX.
  7756             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7757             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7758             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7759             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7760             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7761             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7762             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7763             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7764             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7765             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7766             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7767             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7768             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7769             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7770             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7771             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7772             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7773             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7774             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7775             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7776             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7777             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7778             20  FILLER                   PIC X(25).
  7779
  7780         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7781             CN-CSI-CREDIT-CARD-DATA.
  7782             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7783             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7784             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7785             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7786             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7787             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7788             20  FILLER                   PIC XX.
  7789             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7790             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7791             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7792             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 146
* EL156.cbl
  7793             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7794             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7795             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7796             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7797             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7798             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7799             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7800             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7801             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7802             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7803             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7804             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7805             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7806             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7807             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7808             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7809             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7810             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7811             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7812             20  FILLER                   PIC X(17).
  7813
  7814         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7815             CN-CSI-FAMILY-LEAVE-DATA.
  7816             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7817             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7818             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7819             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7820             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7821             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7822             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7823             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7824             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7825             20  CN-CSI-SL-INT-ON-PROCEEDS
  7826                                          PIC S9(5)V99  COMP-3.
  7827             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7828             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7829             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7830             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7831             20  CN-CSI-SL-POLICY-BENEFITS
  7832                                          PIC S9(5)V99  COMP-3.
  7833             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7834             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7835             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7836             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7837             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7838             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7839             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7840             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7841             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7842             20  CN-CSI-SL-STATE-NOT      PIC X.
  7843             20  FILLER                   PIC XX.
  7844
  7845         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7846             CN-CSI-SENIOR-LIFE-DATA.
  7847             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7848             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7849             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7850                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 147
* EL156.cbl
  7851             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7852             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7853             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7854             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7855             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7856             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7857             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7858             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7859             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7860             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7861             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7862             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7863             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7864             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7865             20  CN-CSI-PP-REPAIR         PIC X.
  7866             20  CN-CSI-PP-REPLACE        PIC X.
  7867             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7868             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7869             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7870             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7871             20  FILLER                   PIC X(5).
  7872
  7873         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7874             CN-CSI-PURCH-PROP-DATA.
  7875             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7876             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7877             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7878             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7879             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7880             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7881             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7882             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7883             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7884             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7885             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7886             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7887             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7888             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7889             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7890             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7891             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7892             20  CN-CSI-EW-REPLACE        PIC X.
  7893             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7894             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7895             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7896             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7897             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7898             20  FILLER                   PIC X(4).
  7899
  7900     12  CN-LAST-MAINT-DT                 PIC XX.
  7901     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7902     12  CN-LAST-MAINT-USER               PIC X(4).
  7903     12  FILLER                           PIC X(6).
  7904
  7905******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 148
* EL156.cbl
  7907*    COPY ERCCNOT.
  7908******************************************************************
  7909*                                                                *
  7910*                            ERCCNOT                             *
  7911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7912*                            VMOD=2.003                          *
  7913*                                                                *
  7914*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7915*                                                                *
  7916*        FILE TYPE= VSAM,KSDS                                    *
  7917*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7918*                                                                *
  7919*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7920*                                                                *
  7921*        LOG = YES                                               *
  7922*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7923*                                                                *
  7924******************************************************************
  7925*                   C H A N G E   L O G
  7926*
  7927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7928*-----------------------------------------------------------------
  7929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7930* EFFECTIVE    NUMBER
  7931*-----------------------------------------------------------------
  7932* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7933******************************************************************
  7934
  7935 01  CERT-NOTE-FILE.
  7936     12  CZ-RECORD-ID                PIC  XX.
  7937         88  VALID-CZ-ID                  VALUE 'CZ'.
  7938
  7939     12  CZ-CONTROL-PRIMARY.
  7940         16  CZ-COMPANY-CD           PIC X.
  7941         16  CZ-CARRIER              PIC X.
  7942         16  CZ-GROUPING.
  7943             20 CZ-GROUPING-PREFIX   PIC XXX.
  7944             20 CZ-GROUPING-PRIME    PIC XXX.
  7945         16  CZ-STATE                PIC XX.
  7946         16  CZ-ACCOUNT.
  7947             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7948             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7949         16  CZ-CERT-EFF-DT          PIC XX.
  7950         16  CZ-CERT-NO.
  7951             20  CZ-CERT-PRIME       PIC X(10).
  7952             20  CZ-CERT-SFX         PIC X.
  7953         16  CZ-RECORD-TYPE          PIC X.
  7954             88  CERT-NOTE           VALUE '1'.
  7955             88  CLAIM-CERT-NOTE     VALUE '2'.
  7956         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7957
  7958     12  CZ-LAST-MAINT-DT            PIC XX.
  7959     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7960     12  CZ-LAST-MAINT-USER          PIC X(4).
  7961
  7962     12  CZ-NOTE-INFORMATION.
  7963         16  CZ-NOTE                 PIC X(63).
  7964         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 149
* EL156.cbl
  7965******************************************************************
  7966*                            COPY ERCPDEF.
  7967******************************************************************
  7968*                                                                *
  7969*                                                                *
  7970*                            ERCPDEF.                            *
  7971*                                                                *
  7972*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7973*                                                                *
  7974*    FILE TYPE = VSAM,KSDS                                       *
  7975*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7976*                                                                *
  7977*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7978*                                                                *
  7979*    LOG = YES                                                   *
  7980*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7981******************************************************************
  7982*                   C H A N G E   L O G
  7983*
  7984* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7985*-----------------------------------------------------------------
  7986*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7987* EFFECTIVE    NUMBER
  7988*-----------------------------------------------------------------
  7989* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7990* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7991* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  7992******************************************************************
  7993 01  PRODUCT-MASTER.
  7994    12  PD-RECORD-ID                 PIC X(02).
  7995        88  VALID-PD-ID                  VALUE 'PD'.
  7996    12  PD-CONTROL-PRIMARY.
  7997        16  PD-COMPANY-CD            PIC X.
  7998        16  PD-STATE                 PIC XX.
  7999        16  PD-PRODUCT-CD            PIC XXX.
  8000        16  PD-FILLER                PIC X(7).
  8001        16  PD-BEN-TYPE              PIC X.
  8002        16  PD-BEN-CODE              PIC XX.
  8003        16  PD-PROD-EXP-DT           PIC XX.
  8004    12  FILLER                       PIC X(50).
  8005    12  PD-PRODUCT-DATA OCCURS 8.
  8006        16  PD-PROD-CODE             PIC X.
  8007            88  PD-PROD-LIFE           VALUE 'L'.
  8008            88  PD-PROD-PROP           VALUE 'P'.
  8009            88  PD-PROD-AH             VALUE 'A'.
  8010            88  PD-PROD-IU             VALUE 'I'.
  8011            88  PD-PROD-GAP            VALUE 'G'.
  8012            88  PD-PROD-FAML           VALUE 'F'.
  8013        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8014        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8015        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8016        16  PD-MAX-TERM              PIC S999        COMP-3.
  8017        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8018        16  FILLER                   PIC X.
  8019        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8020        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8021        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8022        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 150
* EL156.cbl
  8023        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8024        16  PD-REC-CRIT-PERIOD       PIC 99.
  8025        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8026            20  PD-RECURRING-YN      PIC X.
  8027            20  FILLER               PIC X.
  8028        16  PD-RTW-MOS               PIC 99.
  8029        16  PD-MAX-EXTENSION         PIC 99.
  8030        16  pd-ben-pct               pic sv999 comp-3.
  8031*       16  FILLER                   PIC XX.
  8032    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8033    12  PD-TERM-LIMITS OCCURS 15.
  8034        16  PD-LOW-TERM              PIC S999        COMP-3.
  8035        16  PD-HI-TERM               PIC S999        COMP-3.
  8036*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8037    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8038        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8039        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8040    12  PD-EARN-FACTORS.
  8041        16  FILLER OCCURS 15.
  8042            20  FILLER OCCURS 15.
  8043                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8044    12  PD-PRODUCT-DESC              PIC X(80).
  8045    12  PD-TRUNCATED                 PIC X.
  8046    12  FILLER                       PIC X(59).
  8047    12  PD-MAINT-INFORMATION.
  8048        16  PD-LAST-MAINT-DT         PIC X(02).
  8049        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8050        16  PD-LAST-MAINT-BY         PIC X(04).
  8051*                            COPY ELCCRTT.
  8052******************************************************************
  8053*                                                                *
  8054*                            ELCCRTT.                            *
  8055*                                                                *
  8056*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8057*                                                                *
  8058*   FILE TYPE = VSAM,KSDS                                        *
  8059*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8060*                                                                *
  8061*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8062*                                                                *
  8063*   LOG = YES                                                    *
  8064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8065******************************************************************
  8066*                   C H A N G E   L O G
  8067*
  8068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8069*-----------------------------------------------------------------
  8070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8071* EFFECTIVE    NUMBER
  8072*-----------------------------------------------------------------
  8073* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8074* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8075* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8076* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8077* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8078* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8079* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8080* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 151
* EL156.cbl
  8081******************************************************************
  8082
  8083 01  CERTIFICATE-TRAILERS.
  8084     12  CS-RECORD-ID                      PIC XX.
  8085         88  VALID-CS-ID                      VALUE 'CS'.
  8086
  8087     12  CS-CONTROL-PRIMARY.
  8088         16  CS-COMPANY-CD                 PIC X.
  8089         16  CS-CARRIER                    PIC X.
  8090         16  CS-GROUPING                   PIC X(6).
  8091         16  CS-STATE                      PIC XX.
  8092         16  CS-ACCOUNT                    PIC X(10).
  8093         16  CS-CERT-EFF-DT                PIC XX.
  8094         16  CS-CERT-NO.
  8095             20  CS-CERT-PRIME             PIC X(10).
  8096             20  CS-CERT-SFX               PIC X.
  8097         16  CS-TRAILER-TYPE               PIC X.
  8098             88  COMM-TRLR           VALUE 'A'.
  8099             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8100             88  CERT-DATA-TRLR      VALUE 'C'.
  8101
  8102     12  CS-DATA-AREA                      PIC X(516).
  8103
  8104     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8105         16  CS-BANK-COMMISSION-AREA.
  8106             20  CS-BANK-COMMS       OCCURS 10.
  8107                 24  CS-AGT                PIC X(10).
  8108                 24  CS-COM-TYP            PIC X.
  8109                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8110                 24  CS-RECALC-LV-INDIC    PIC X.
  8111                 24  FILLER                PIC X(10).
  8112         16  FILLER                        PIC X(256).
  8113
  8114     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8115****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8116         16  CS-MB-CLAIM-DATA OCCURS 24.
  8117             20  CS-CLAIM-NO               PIC X(7).
  8118             20  CS-CLAIM-TYPE             PIC X.
  8119                 88  CS-AH-CLM               VALUE 'A'.
  8120                 88  CS-IU-CLM               VALUE 'I'.
  8121                 88  CS-GP-CLM               VALUE 'G'.
  8122                 88  CS-LF-CLM               VALUE 'L'.
  8123                 88  CS-PR-CLM               VALUE 'P'.
  8124                 88  CS-FL-CLM               VALUE 'F'.
  8125             20  CS-INSURED-TYPE           PIC X.
  8126                 88  CS-PRIM-INSURED          VALUE 'P'.
  8127                 88  CS-CO-BORROWER           VALUE 'C'.
  8128             20  CS-BENEFIT-PERIOD         PIC 99.
  8129             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8130             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8131             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8132         16  FILLER                        PIC X(12).
  8133     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8134         16  CS-VIN-NUMBER                 PIC X(17).
  8135         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8136         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8137         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8138         16  cs-agent-name.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 152
* EL156.cbl
  8139             20  cs-agent-fname            pic x(20).
  8140             20  cs-agent-mi               pic x.
  8141             20  cs-agent-lname            pic x(25).
  8142         16  cs-license-no                 pic x(15).
  8143         16  cs-npn-number                 pic x(10).
  8144         16  cs-agent-edit-status          pic x.
  8145             88  cs-ae-refer-to-manager      value 'M'.
  8146             88  cs-ae-cover-sheet           value 'C'.
  8147             88  cs-ae-sig-form              value 'S'.
  8148             88  cs-ae-verified              value 'V'.
  8149             88  cs-unidentified-signature   value 'U'.
  8150             88  cs-cert-returned            value 'R'.
  8151             88  cs-accept-no-commission     value 'N'.
  8152         16  FILLER                        PIC X(424).
  8153*        16  FILLER                        PIC X(496).
  8154 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8155                          CONTROL-FILE CERTIFICATE-MASTER
  8156                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8157                          ACCOUNT-MASTER CHECK-QUE
  8158                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8159                          DAILY-ACTIVITY-RECORD
  8160                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8161                          CERT-NOTE-FILE PRODUCT-MASTER
  8162                          CERTIFICATE-TRAILERS.
  8163 0000-DFHEXIT SECTION.
  8164     MOVE '9#                    $   ' TO DFHEIV0.
  8165     MOVE 'EL156' TO DFHEIV1.
  8166     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8167
  8168     IF EIBCALEN = 0
  8169         GO TO 8800-UNAUTHORIZED-ACCESS.
  8170
  8171     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8172     MOVE EIBTRMID               TO QID-TERM.
  8173     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8174     MOVE '2'                    TO EMI-SWITCH2.
  8175     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8176     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8177
  8178     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8179     MOVE '5'                    TO DC-OPTION-CODE.
  8180     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8181     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8182                                    SAVE-BIN-DATE.
  8183     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8184     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8185
  8186     IF SAVE-DATE-YY > 70
  8187         MOVE 19                 TO SAVE-DATE-CC
  8188     ELSE
  8189         MOVE 20                 TO SAVE-DATE-CC.
  8190
  8191     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8192         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8193     END-IF.
  8194
  8195     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8196        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 153
* EL156.cbl
  8197     ELSE
  8198        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8199     END-IF
  8200
  8201     IF PI-PRINT-CLM-FRM-YN = 'N'
  8202         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8203     ELSE
  8204         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8205     END-IF
  8206
  8207     IF PI-PRINT-SURVEY-YN = 'N'
  8208         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8209     ELSE
  8210         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8211     END-IF
  8212
  8213     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8214         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8215     ELSE
  8216         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8217     END-IF
  8218
  8219* EXEC CICS HANDLE CONDITION
  8220*        NOTOPEN   (9990-ABEND)
  8221*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8222*        MAPFAIL   (0400-FIRST-TIME)
  8223*        DUPREC    (6180-DUPREC)
  8224*        ERROR     (9990-ABEND)
  8225*    END-EXEC.
  8226*    MOVE '"$JL?%.               ! " #00008214' TO DFHEIV0
  8227     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8229     MOVE X'2220233030303038323134' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0
  8231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8232
  8233
  8234     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8235         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8236
  8237     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8238         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8239             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8240             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8241             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8242             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8243             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8244             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8245             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8246             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8247             MOVE LOW-VALUES           TO EL156AI
  8248             MOVE 'Y'                  TO FIRST-ENTRY
  8249         ELSE
  8250             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8251             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8252             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8253             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8254             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 154
* EL156.cbl
  8255             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8256             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8257             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8258
  8259     IF RETURNED-FROM NOT = SPACES
  8260        IF (RETURNED-FROM = 'EL614')
  8261           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8262           IF WS-SAVED-EOB-CODES NOT = SPACES
  8263              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8264           ELSE
  8265              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8266           END-IF
  8267        END-IF
  8268         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8269            MOVE 'Y'             TO FIRST-ENTRY
  8270            IF RETURNED-FROM = 'EL614'
  8271               AND (PI-PASS-SW NOT = 'C')
  8272               IF WS-SAVED-EOB-CODES NOT = SPACES
  8273                  MOVE WS-SAVED-EOB-CODES
  8274                                 TO PI-PMTNOTE2
  8275                                    WS-PMTNOTE2
  8276                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8277               ELSE
  8278                  MOVE SPACES    TO PI-PMTNOTE2
  8279                                    WS-PMTNOTE2
  8280                                    PI-EOB-CODES-EXIST
  8281               END-IF
  8282            END-IF
  8283            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8284            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8285            IF RETURNED-FROM = 'EL614'
  8286               GO TO 1000-EDIT-DATA
  8287            END-IF
  8288            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8289               (PAYEEI   = LOW-VALUES OR SPACES)
  8290               GO TO 8100-SEND-INITIAL-MAP
  8291            ELSE
  8292               GO TO 1000-EDIT-DATA.
  8293
  8294     IF EIBTRNID NOT = TRANS-ID
  8295         GO TO 0400-FIRST-TIME.
  8296
  8297     IF EIBAID = DFHCLEAR
  8298        IF PI-PASS-SW = 'C'
  8299           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8300           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8301           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8302           MOVE 'Y'            TO RETURNED-FROM-B
  8303           GO TO 1000-EDIT-DATA
  8304        ELSE
  8305           GO TO 9400-CLEAR.
  8306
  8307     IF PI-PASS-SW = 'C'
  8308         MOVE MAP-NAMEB          TO MAP-NAME
  8309         IF EIBAID = DFHPF1 OR DFHPF13
  8310             GO TO 5000-UPDATE
  8311           ELSE
  8312             IF EIBAID NOT = DFHENTER
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 155
* EL156.cbl
  8313                 MOVE LOW-VALUES TO EL156BI
  8314                 MOVE MAP-NAMEB  TO MAP-NAME
  8315                 MOVE ER-0029    TO EMI-ERROR
  8316                 MOVE -1         TO  ENTPFBL
  8317                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8318                 GO TO 8200-SEND-DATAONLY.
  8319
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 156
* EL156.cbl
  8321 0200-RECEIVE.
  8322     MOVE LOW-VALUES             TO EL156AI.
  8323     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8324         MOVE ER-0008            TO EMI-ERROR
  8325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8326         IF PI-PASS-SW = 'C'
  8327             MOVE -1             TO ENTPFBL
  8328             GO TO 8200-SEND-DATAONLY
  8329         ELSE
  8330             MOVE -1             TO PMTTYPEL
  8331             GO TO 8200-SEND-DATAONLY.
  8332
  8333     IF PI-COMPANY-ID = 'DMD'
  8334         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8335
  8336     IF PI-PASS-SW = 'C'
  8337         MOVE MAP-NAMEB          TO MAP-NAME.
  8338
  8339
  8340* EXEC CICS RECEIVE
  8341*        MAP   (MAP-NAME)
  8342*        MAPSET(MAPSET-NAME)
  8343*        ASIS
  8344*        INTO  (EL156AI)
  8345*    END-EXEC.
  8346     MOVE LENGTH OF
  8347      EL156AI
  8348       TO DFHEIV11
  8349*    MOVE '8"TAI  L              ''   #00008327' TO DFHEIV0
  8350     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8351     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8352     MOVE X'2020233030303038333237' TO DFHEIV0(25:11)
  8353     CALL 'kxdfhei1' USING DFHEIV0,
  8354           MAP-NAME,
  8355           EL156AI,
  8356           DFHEIV11,
  8357           MAPSET-NAME,
  8358           DFHEIV99,
  8359           DFHEIV99
  8360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8361
  8362
  8363     IF PI-PASS-SW NOT = 'C'
  8364         GO TO 0250-MAPA.
  8365
  8366     IF ENTPFBL NOT > ZERO
  8367         MOVE MAP-NAMEB          TO MAP-NAME
  8368         MOVE ER-0029            TO EMI-ERROR
  8369         MOVE -1                 TO  ENTPFBL
  8370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8371         GO TO 8200-SEND-DATAONLY.
  8372
  8373     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8374         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8375       ELSE
  8376         MOVE MAP-NAMEB           TO MAP-NAME
  8377         MOVE ER-0029             TO EMI-ERROR
  8378         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 157
* EL156.cbl
  8379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8380         GO TO 8200-SEND-DATAONLY.
  8381
  8382     IF EIBAID = DFHPF1 OR DFHPF13
  8383         IF MODIFY-CAP
  8384            GO TO 5000-UPDATE
  8385          ELSE
  8386            MOVE 'UPDATE'           TO SM-READ
  8387            PERFORM 9995-SECURITY-VIOLATION
  8388            MOVE MAP-NAMEB          TO MAP-NAME
  8389            MOVE ER-0070            TO EMI-ERROR
  8390            MOVE -1                 TO  ENTPFBL
  8391            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8392            GO TO 8200-SEND-DATAONLY.
  8393
  8394 0250-MAPA.
  8395     IF ENTERPFL = 0
  8396         GO TO 0300-CHECK-PFKEYS.
  8397
  8398     IF EIBAID NOT = DFHENTER
  8399         MOVE ER-0004            TO EMI-ERROR
  8400         GO TO 0320-INPUT-ERROR.
  8401
  8402     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8403         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8404     ELSE
  8405         MOVE ER-0029            TO EMI-ERROR
  8406         GO TO 0320-INPUT-ERROR.
  8407
  8408 0300-CHECK-PFKEYS.
  8409     IF EIBAID = DFHPF7 OR DFHPF8
  8410         GO TO 8820-PF7-8.
  8411
  8412     IF EIBAID = DFHPF23
  8413         GO TO 8810-PF23.
  8414
  8415     IF EIBAID = DFHPF24
  8416         GO TO 9200-RETURN-MAIN-MENU.
  8417
  8418     IF EIBAID = DFHPF12
  8419         GO TO 9500-PF12.
  8420
  8421     IF EIBAID = DFHPF1
  8422        IF PI-PASS-SW = 'A' OR 'B'
  8423          GO TO 0330-BROWSE-FORWARD.
  8424
  8425     IF EIBAID = DFHPF2
  8426        IF PI-PASS-SW = 'A' OR 'B'
  8427          GO TO 0350-BROWSE-BACKWARD.
  8428
  8429     IF EIBAID = DFHPF6
  8430        IF PI-EOB-CODES-EXIST = 'Y'
  8431           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8432        ELSE
  8433           MOVE SPACES              TO WS-PMTNOTE2
  8434        END-IF
  8435         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8436         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 158
* EL156.cbl
  8437            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8438         END-IF
  8439         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8440         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  8441             MOVE 'EL614'        TO PGM-NAME
  8442             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8443             GO TO 9300-XCTL
  8444         ELSE
  8445             MOVE XCTL-157       TO PGM-NAME
  8446             GO TO 9300-XCTL.
  8447
  8448     IF EIBAID = DFHPF9
  8449        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8450        MOVE XCTL-141            TO PGM-NAME
  8451        GO TO 9300-XCTL.
  8452
  8453     IF EIBAID = DFHPF10
  8454        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8455        MOVE XCTL-155            TO PGM-NAME
  8456        GO TO 9300-XCTL.
  8457
  8458     MOVE SPACES                 TO ERRMSG0O
  8459                                    ERRMSG1O
  8460                                    ERRMSG2O.
  8461
  8462     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8463         IF PI-PASS-SW NOT = 'B'
  8464             MOVE ER-0422        TO EMI-ERROR
  8465             GO TO 0320-INPUT-ERROR
  8466           ELSE
  8467             GO TO 0700-TEST-FOR-CHANGES.
  8468
  8469     IF EIBAID = DFHPF11
  8470        IF PI-PASS-SW = 'C'
  8471           MOVE ER-0029          TO EMI-ERROR
  8472           GO TO 0320-INPUT-ERROR.
  8473
  8474     IF EIBAID = DFHENTER OR DFHPF11
  8475        NEXT SENTENCE
  8476     ELSE
  8477        MOVE ER-0029             TO EMI-ERROR
  8478        GO TO 0320-INPUT-ERROR.
  8479
  8480     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8481
  8482     if pi-epyfrom not = zeros
  8483        if pi-epyfrom not = ws-epyfrom
  8484           move zeros        to ws-edays
  8485        end-if
  8486     end-if
  8487
  8488     if pi-epythru not = zeros
  8489        if pi-epythru not = ws-epythru
  8490           move zeros        to ws-edays
  8491        end-if
  8492     end-if
  8493
  8494     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 159
* EL156.cbl
  8495         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8496         GO TO 1000-EDIT-DATA
  8497     ELSE
  8498         IF PI-FATAL-COUNT NOT = 0 OR
  8499            PI-FORCE-COUNT NOT = 0
  8500             GO TO 1000-EDIT-DATA
  8501         ELSE
  8502             GO TO 2000-EDIT-DONE.
  8503
  8504 0320-INPUT-ERROR.
  8505     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8506
  8507     IF ENTERPFL = 0
  8508         MOVE -1                 TO PMTTYPEL
  8509     ELSE
  8510         MOVE AL-UNBON           TO ENTERPFA
  8511         MOVE -1                 TO ENTERPFL.
  8512
  8513     GO TO 8200-SEND-DATAONLY.
  8514
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 160
* EL156.cbl
  8516 0330-BROWSE-FORWARD.
  8517
  8518     MOVE CLMNOI            TO PI-CLAIM-NO.
  8519     MOVE CARRI             TO PI-CARRIER.
  8520     MOVE CERTNOI           TO PI-CERT-PRIME.
  8521     MOVE SUFXI             TO PI-CERT-SFX.
  8522
  8523     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8524     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8525     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8526     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8527
  8528     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8529
  8530
  8531* EXEC CICS HANDLE CONDITION
  8532*         NOTFND   (0380-CLAIM-END-FILE)
  8533*         ENDFILE  (0380-CLAIM-END-FILE)
  8534*    END-EXEC.
  8535*    MOVE '"$I''                  ! # #00008501' TO DFHEIV0
  8536     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8538     MOVE X'2320233030303038353031' TO DFHEIV0(25:11)
  8539     CALL 'kxdfhei1' USING DFHEIV0
  8540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8541
  8542
  8543
  8544* EXEC CICS STARTBR
  8545*         DATASET    ('ELMSTR')
  8546*         RIDFLD     (ELMSTR-KEY)
  8547*         GTEQ
  8548*    END-EXEC.
  8549     MOVE 'ELMSTR' TO DFHEIV1
  8550     MOVE 0
  8551       TO DFHEIV11
  8552*    MOVE '&,         G          &   #00008506' TO DFHEIV0
  8553     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303038353036' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           DFHEIV1,
  8558           ELMSTR-KEY,
  8559           DFHEIV99,
  8560           DFHEIV11,
  8561           DFHEIV99
  8562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8563
  8564
  8565     MOVE 'Y' TO WS-BROWSE-START-SW.
  8566
  8567 0335-READNEXT.
  8568
  8569
  8570* EXEC CICS READNEXT
  8571*         DATASET    ('ELMSTR')
  8572*         RIDFLD     (ELMSTR-KEY)
  8573*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 161
* EL156.cbl
  8574*    END-EXEC.
  8575     MOVE 'ELMSTR' TO DFHEIV1
  8576     MOVE 0
  8577       TO DFHEIV11
  8578*    MOVE '&.S                   )   #00008516' TO DFHEIV0
  8579     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8581     MOVE X'2020233030303038353136' TO DFHEIV0(25:11)
  8582     CALL 'kxdfhei1' USING DFHEIV0,
  8583           DFHEIV1,
  8584           DFHEIV20,
  8585           DFHEIV99,
  8586           ELMSTR-KEY,
  8587           DFHEIV99,
  8588           DFHEIV11,
  8589           DFHEIV99,
  8590           DFHEIV99
  8591     SET ADDRESS OF CLAIM-MASTER TO
  8592         DFHEIV20
  8593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8594
  8595
  8596     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8597        GO TO 0380-CLAIM-END-FILE.
  8598
  8599     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8600        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8601        GO TO 0335-READNEXT.
  8602
  8603     IF PI-COMPANY-ID = 'CRI'
  8604         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8605            GO TO 0380-CLAIM-END-FILE.
  8606
  8607     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8608         GO TO 0335-READNEXT.
  8609
  8610     IF PI-CARRIER-SECURITY > SPACES
  8611         IF CL-CARRIER = PI-CARRIER-SECURITY
  8612             NEXT SENTENCE
  8613         ELSE
  8614             GO TO 0335-READNEXT.
  8615
  8616     IF PI-ACCOUNT-SECURITY > SPACES
  8617         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8618             NEXT SENTENCE
  8619         ELSE
  8620             GO TO 0335-READNEXT.
  8621
  8622     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8623     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8624     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8625
  8626     GO TO 0400-FIRST-TIME.
  8627
  8628 0350-BROWSE-BACKWARD.
  8629
  8630     MOVE CLMNOI            TO PI-CLAIM-NO
  8631                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 162
* EL156.cbl
  8632     MOVE CARRI             TO PI-CARRIER.
  8633     MOVE CERTNOI           TO PI-CERT-PRIME.
  8634     MOVE SUFXI             TO PI-CERT-SFX.
  8635
  8636     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8637
  8638     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8639     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8640     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8641
  8642
  8643* EXEC CICS HANDLE CONDITION
  8644*         NOTFND   (0380-CLAIM-END-FILE)
  8645*         ENDFILE  (0380-CLAIM-END-FILE)
  8646*    END-EXEC.
  8647*    MOVE '"$I''                  ! $ #00008568' TO DFHEIV0
  8648     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8650     MOVE X'2420233030303038353638' TO DFHEIV0(25:11)
  8651     CALL 'kxdfhei1' USING DFHEIV0
  8652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8653
  8654
  8655
  8656* EXEC CICS STARTBR
  8657*         DATASET    ('ELMSTR')
  8658*         RIDFLD     (ELMSTR-KEY)
  8659*         GTEQ
  8660*    END-EXEC.
  8661     MOVE 'ELMSTR' TO DFHEIV1
  8662     MOVE 0
  8663       TO DFHEIV11
  8664*    MOVE '&,         G          &   #00008573' TO DFHEIV0
  8665     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8666     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8667     MOVE X'2020233030303038353733' TO DFHEIV0(25:11)
  8668     CALL 'kxdfhei1' USING DFHEIV0,
  8669           DFHEIV1,
  8670           ELMSTR-KEY,
  8671           DFHEIV99,
  8672           DFHEIV11,
  8673           DFHEIV99
  8674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8675
  8676
  8677     MOVE 'Y' TO WS-BROWSE-START-SW.
  8678
  8679
  8680* EXEC CICS READNEXT
  8681*         DATASET    ('ELMSTR')
  8682*         RIDFLD     (ELMSTR-KEY)
  8683*         SET        (ADDRESS OF CLAIM-MASTER)
  8684*    END-EXEC.
  8685     MOVE 'ELMSTR' TO DFHEIV1
  8686     MOVE 0
  8687       TO DFHEIV11
  8688*    MOVE '&.S                   )   #00008581' TO DFHEIV0
  8689     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 163
* EL156.cbl
  8690     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8691     MOVE X'2020233030303038353831' TO DFHEIV0(25:11)
  8692     CALL 'kxdfhei1' USING DFHEIV0,
  8693           DFHEIV1,
  8694           DFHEIV20,
  8695           DFHEIV99,
  8696           ELMSTR-KEY,
  8697           DFHEIV99,
  8698           DFHEIV11,
  8699           DFHEIV99,
  8700           DFHEIV99
  8701     SET ADDRESS OF CLAIM-MASTER TO
  8702         DFHEIV20
  8703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8704
  8705
  8706
  8707* EXEC CICS READPREV
  8708*         DATASET    ('ELMSTR')
  8709*         RIDFLD     (ELMSTR-KEY)
  8710*         SET        (ADDRESS OF CLAIM-MASTER)
  8711*    END-EXEC.
  8712     MOVE 'ELMSTR' TO DFHEIV1
  8713     MOVE 0
  8714       TO DFHEIV11
  8715*    MOVE '&0S                   )   #00008587' TO DFHEIV0
  8716     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8717     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8718     MOVE X'2020233030303038353837' TO DFHEIV0(25:11)
  8719     CALL 'kxdfhei1' USING DFHEIV0,
  8720           DFHEIV1,
  8721           DFHEIV20,
  8722           DFHEIV99,
  8723           ELMSTR-KEY,
  8724           DFHEIV99,
  8725           DFHEIV11,
  8726           DFHEIV99,
  8727           DFHEIV99
  8728     SET ADDRESS OF CLAIM-MASTER TO
  8729         DFHEIV20
  8730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8731
  8732
  8733 0360-BROWSE-BACKWARD.
  8734
  8735
  8736* EXEC CICS READPREV
  8737*         DATASET    ('ELMSTR')
  8738*         RIDFLD     (ELMSTR-KEY)
  8739*         SET        (ADDRESS OF CLAIM-MASTER)
  8740*    END-EXEC.
  8741     MOVE 'ELMSTR' TO DFHEIV1
  8742     MOVE 0
  8743       TO DFHEIV11
  8744*    MOVE '&0S                   )   #00008595' TO DFHEIV0
  8745     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8746     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8747     MOVE X'2020233030303038353935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 164
* EL156.cbl
  8748     CALL 'kxdfhei1' USING DFHEIV0,
  8749           DFHEIV1,
  8750           DFHEIV20,
  8751           DFHEIV99,
  8752           ELMSTR-KEY,
  8753           DFHEIV99,
  8754           DFHEIV11,
  8755           DFHEIV99,
  8756           DFHEIV99
  8757     SET ADDRESS OF CLAIM-MASTER TO
  8758         DFHEIV20
  8759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8760
  8761
  8762     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8763        GO TO 0380-CLAIM-END-FILE.
  8764
  8765     IF PI-COMPANY-ID = 'CRI'
  8766         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8767            GO TO 0380-CLAIM-END-FILE.
  8768
  8769     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8770         GO TO 0360-BROWSE-BACKWARD.
  8771
  8772     IF PI-CARRIER-SECURITY > SPACES
  8773         IF CL-CARRIER = PI-CARRIER-SECURITY
  8774             NEXT SENTENCE
  8775         ELSE
  8776             GO TO 0360-BROWSE-BACKWARD.
  8777
  8778     IF PI-ACCOUNT-SECURITY > SPACES
  8779         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8780             NEXT SENTENCE
  8781         ELSE
  8782             GO TO 0360-BROWSE-BACKWARD.
  8783
  8784     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8785     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8786     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8787
  8788     GO TO 0400-FIRST-TIME.
  8789
  8790 0380-CLAIM-END-FILE.
  8791
  8792     MOVE ER-0130     TO EMI-ERROR.
  8793     MOVE -1          TO CLMNOL.
  8794     MOVE AL-UABON    TO CARRA
  8795                         CLMNOA
  8796                         CERTNOA
  8797                         SUFXA.
  8798
  8799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8800
  8801     GO TO 8200-SEND-DATAONLY.
  8802
  8803 0400-FIRST-TIME.
  8804
  8805     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 165
* EL156.cbl
  8806        MOVE 'N'         TO WS-BROWSE-START-SW
  8807
  8808* EXEC CICS ENDBR
  8809*            DATASET    ('ELMSTR')
  8810*       END-EXEC.
  8811     MOVE 'ELMSTR' TO DFHEIV1
  8812     MOVE 0
  8813       TO DFHEIV11
  8814*    MOVE '&2                    $   #00008646' TO DFHEIV0
  8815     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8816     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8817     MOVE X'2020233030303038363436' TO DFHEIV0(25:11)
  8818     CALL 'kxdfhei1' USING DFHEIV0,
  8819           DFHEIV1,
  8820           DFHEIV11,
  8821           DFHEIV99
  8822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8823
  8824
  8825     IF PI-PROCESSOR-ID = 'LGXX'
  8826         NEXT SENTENCE
  8827     ELSE
  8828
  8829* EXEC CICS READQ TS
  8830*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8831*            INTO    (SECURITY-CONTROL)
  8832*            LENGTH  (SC-COMM-LENGTH)
  8833*            ITEM    (SC-ITEM)
  8834*        END-EXEC
  8835*    MOVE '*$II   L              ''   #00008653' TO DFHEIV0
  8836     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8837     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8838     MOVE X'2020233030303038363533' TO DFHEIV0(25:11)
  8839     CALL 'kxdfhei1' USING DFHEIV0,
  8840           PI-SECURITY-TEMP-STORE-ID,
  8841           SECURITY-CONTROL,
  8842           SC-COMM-LENGTH,
  8843           SC-ITEM,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8847         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8848         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8849
  8850     MOVE LOW-VALUES             TO EL156AI.
  8851     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8852     MOVE 'Y'                    TO FIRST-ENTRY.
  8853     GO TO 7000-SHOW-CLAIM.
  8854
  8855 0500-CREATE-TEMP-STORAGE.
  8856     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8857
  8858
  8859* EXEC CICS WRITEQ TS
  8860*        QUEUE (QID)
  8861*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8862*        LENGTH(PI-COMM-LENGTH)
  8863*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 166
* EL156.cbl
  8864*    MOVE '*"                    ''   #00008670' TO DFHEIV0
  8865     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8866     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8867     MOVE X'2020233030303038363730' TO DFHEIV0(25:11)
  8868     CALL 'kxdfhei1' USING DFHEIV0,
  8869           QID,
  8870           PROGRAM-INTERFACE-BLOCK,
  8871           PI-COMM-LENGTH,
  8872           DFHEIV99,
  8873           DFHEIV99,
  8874           DFHEIV99
  8875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8876
  8877
  8878
  8879* EXEC CICS WRITEQ TS
  8880*        QUEUE (QID)
  8881*        FROM  (EL156AI)
  8882*        LENGTH(MAP-LENGTH)
  8883*    END-EXEC.
  8884*    MOVE '*"                    ''   #00008676' TO DFHEIV0
  8885     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8887     MOVE X'2020233030303038363736' TO DFHEIV0(25:11)
  8888     CALL 'kxdfhei1' USING DFHEIV0,
  8889           QID,
  8890           EL156AI,
  8891           MAP-LENGTH,
  8892           DFHEIV99,
  8893           DFHEIV99,
  8894           DFHEIV99
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8896
  8897
  8898 0599-EXIT.
  8899      EXIT.
  8900
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 167
* EL156.cbl
  8902 0600-RECOVER-TEMP-STORAGE.
  8903
  8904* EXEC CICS READQ TS
  8905*        QUEUE (QID)
  8906*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8907*        LENGTH(PI-COMM-LENGTH)
  8908*    END-EXEC.
  8909*    MOVE '*$I    L              ''   #00008687' TO DFHEIV0
  8910     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8912     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0,
  8914           QID,
  8915           PROGRAM-INTERFACE-BLOCK,
  8916           PI-COMM-LENGTH,
  8917           DFHEIV99,
  8918           DFHEIV99,
  8919           DFHEIV99
  8920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8921
  8922
  8923
  8924* EXEC CICS READQ TS
  8925*        QUEUE (QID)
  8926*        INTO  (EL156AI)
  8927*        LENGTH(MAP-LENGTH)
  8928*    END-EXEC.
  8929*    MOVE '*$I    L              ''   #00008693' TO DFHEIV0
  8930     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8932     MOVE X'2020233030303038363933' TO DFHEIV0(25:11)
  8933     CALL 'kxdfhei1' USING DFHEIV0,
  8934           QID,
  8935           EL156AI,
  8936           MAP-LENGTH,
  8937           DFHEIV99,
  8938           DFHEIV99,
  8939           DFHEIV99
  8940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8941
  8942
  8943     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8944
  8945     IF PMTTYPEI NOT = LOW-VALUES
  8946         MOVE AL-UANON           TO PMTTYPEA.
  8947
  8948     IF PAYEEI NOT = LOW-VALUES
  8949         MOVE AL-UANON           TO PAYEEA.
  8950
  8951     IF NOTE1I NOT = LOW-VALUES
  8952         MOVE AL-UANON           TO NOTE1A.
  8953
  8954     IF (RETURNED-FROM = 'EL614')
  8955        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8956     END-IF
  8957*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8958*       AND (PI-EOB-CODES-EXIST = 'Y')
  8959*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 168
* EL156.cbl
  8960*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8961     IF PI-SET-NOTE2-MDT = 'Y'
  8962         MOVE AL-SANON           TO NOTE2A
  8963     END-IF
  8964
  8965     IF OFFLINEI NOT = LOW-VALUES
  8966         MOVE AL-UANON           TO OFFLINEA.
  8967
  8968*    IF GROUPEDI NOT = LOW-VALUES
  8969*        MOVE AL-UANON           TO GROUPEDA.
  8970
  8971*    IF CASHI NOT = LOW-VALUES
  8972*        MOVE AL-UANON           TO CASHA.
  8973
  8974     IF CHECKNOI NOT = LOW-VALUES
  8975         MOVE AL-UANON           TO CHECKNOA.
  8976
  8977     IF HOLDTILI NOT = LOW-VALUES
  8978         MOVE AL-UANON           TO HOLDTILA.
  8979
  8980     IF EPYFROMI NOT = LOW-VALUES
  8981         MOVE AL-UANON           TO EPYFROMA.
  8982
  8983     IF AIGFROMI NOT = LOW-VALUES
  8984         MOVE AL-UANON           TO AIGFROMA.
  8985
  8986     IF EPYTHRUI NOT = LOW-VALUES
  8987         MOVE AL-UANON           TO EPYTHRUA.
  8988
  8989     IF EDAYSI NOT = LOW-VALUES
  8990         MOVE AL-UNNON           TO EDAYSA.
  8991
  8992     IF EPYAMTL NOT = +0
  8993         MOVE AL-UNNON           TO EPYAMTA.
  8994
  8995     IF ERESVL NOT = +0
  8996         MOVE AL-UNNON           TO ERESVA.
  8997
  8998     IF EEXPENSL NOT = +0
  8999         MOVE AL-UNNON           TO EEXPENSA.
  9000
  9001     IF ETYPEI NOT = LOW-VALUES
  9002         MOVE AL-UNNON           TO ETYPEA.
  9003
  9004     IF PROOFDTI NOT = 0
  9005         MOVE AL-UNNON           TO PROOFDTA.
  9006
  9007     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9008        MOVE AL-UANON            TO EOBYNA
  9009     END-IF
  9010     IF CLMFMYNI = 'Y' OR 'N'
  9011        MOVE AL-UANON            TO CLMFMYNA
  9012     END-IF
  9013
  9014     IF SURVYYNI = 'Y' OR 'N'
  9015        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9016           MOVE AL-UANON         TO SURVYYNA
  9017        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 169
* EL156.cbl
  9018     END-IF
  9019
  9020     IF SPRELYNI = 'Y' OR 'N'
  9021        MOVE AL-UANON            TO SPRELYNA
  9022     END-IF
  9023
  9024     .
  9025 0699-EXIT.
  9026      EXIT.
  9027
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 170
* EL156.cbl
  9029 0700-TEST-FOR-CHANGES.
  9030     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9031         MOVE ER-0433            TO EMI-ERROR
  9032         GO TO 0750-FUNCTION-ERROR.
  9033
  9034     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9035
  9036     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9037         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9038         MOVE 'A'                TO PI-PASS-SW
  9039         GO TO 1000-EDIT-DATA.
  9040
  9041     IF PI-FATAL-COUNT NOT = 0
  9042         MOVE ER-0499            TO EMI-ERROR
  9043         GO TO 0750-FUNCTION-ERROR.
  9044
  9045     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9046         MOVE ER-0500            TO EMI-ERROR
  9047         GO TO 0750-FUNCTION-ERROR.
  9048
  9049     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9050        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9051           MOVE ER-0542          TO EMI-ERROR
  9052           MOVE -1               TO EPYAMTL
  9053           GO TO 0750-FUNCTION-ERROR.
  9054
  9055     IF PI-OFFLINE = 'Y'  OR
  9056        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9057        MOVE EIBAID              TO PI-PFKEY-USED
  9058        GO TO 5000-UPDATE.
  9059
  9060     GO TO 6000-BUILD-SCREEN-B.
  9061
  9062 0750-FUNCTION-ERROR.
  9063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9064
  9065     IF ENTERPFL > 0
  9066         MOVE -1                 TO ENTERPFL
  9067         MOVE AL-UNBON           TO ENTERPFA
  9068         GO TO 8200-SEND-DATAONLY
  9069     ELSE
  9070         MOVE -1                 TO ENTERPFL
  9071         MOVE AL-UNNOF           TO ENTERPFA
  9072         GO TO 8200-SEND-DATAONLY.
  9073
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 171
* EL156.cbl
  9075 0800-DELETE-TS.
  9076
  9077* EXEC CICS HANDLE CONDITION
  9078*        QIDERR(0800-EXIT)
  9079*    END-EXEC.
  9080*    MOVE '"$N                   ! % #00008832' TO DFHEIV0
  9081     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9083     MOVE X'2520233030303038383332' TO DFHEIV0(25:11)
  9084     CALL 'kxdfhei1' USING DFHEIV0
  9085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9086
  9087
  9088
  9089* EXEC CICS DELETEQ TS
  9090*        QUEUE(QID)
  9091*    END-EXEC.
  9092*    MOVE '*&                    #   #00008836' TO DFHEIV0
  9093     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9094     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9095     MOVE X'2020233030303038383336' TO DFHEIV0(25:11)
  9096     CALL 'kxdfhei1' USING DFHEIV0,
  9097           QID,
  9098           DFHEIV99
  9099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9100
  9101
  9102 0800-EXIT.
  9103      EXIT.
  9104 0900-GET-DDF-LIMITS.
  9105
  9106     if cm-clp-state = zeros or spaces or low-values
  9107        move cm-state            to cm-clp-state
  9108     end-if
  9109     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9110     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9111     MOVE cm-clp-state           TO ERPDEF-STATE
  9112     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9113     evaluate true
  9114        when (cl-claim-type = 'L' or 'P')
  9115           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9116             and 'CU')
  9117           move 'L'              to erpdef-ben-type
  9118           move pi-lf-benefit-cd to erpdef-ben-code
  9119        when (cl-claim-type not = 'L' and 'P')
  9120           and (pi-ah-benefit-cd not = '00' and '  ')
  9121           move 'A'              to erpdef-ben-type
  9122           move pi-ah-benefit-cd to erpdef-ben-code
  9123        when (cl-claim-type not = 'L' and 'P')
  9124           and (pi-ah-benefit-cd = '00' or '  ')
  9125           move 'L'              to erpdef-ben-type
  9126           move pi-lf-benefit-cd to erpdef-ben-code
  9127        when (cl-claim-type = 'L' or 'P')
  9128           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9129           move 'A'              to erpdef-ben-type
  9130           move pi-ah-benefit-cd to erpdef-ben-code
  9131        when other
  9132           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 172
* EL156.cbl
  9133           move pi-ah-benefit-cd to erpdef-ben-code
  9134     end-evaluate
  9135*    if (cl-claim-type = 'L' or 'P')
  9136*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9137*          and 'CU')
  9138*       move 'L'                 to erpdef-ben-type
  9139*       move pi-lf-benefit-cd    to erpdef-ben-code
  9140*    else
  9141*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9142*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9143*    end-if
  9144     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9145
  9146     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9147
  9148
  9149* EXEC CICS STARTBR
  9150*        DATASET  ('ERPDEF')
  9151*        RIDFLD   (ERPDEF-KEY)
  9152*        GTEQ
  9153*        RESP     (WS-RESPONSE)
  9154*    END-EXEC
  9155     MOVE 'ERPDEF' TO DFHEIV1
  9156     MOVE 0
  9157       TO DFHEIV11
  9158*    MOVE '&,         G          &  N#00008886' TO DFHEIV0
  9159     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9161     MOVE X'204E233030303038383836' TO DFHEIV0(25:11)
  9162     CALL 'kxdfhei1' USING DFHEIV0,
  9163           DFHEIV1,
  9164           ERPDEF-KEY,
  9165           DFHEIV99,
  9166           DFHEIV11,
  9167           DFHEIV99
  9168     MOVE EIBRESP  TO WS-RESPONSE
  9169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9170
  9171     IF NOT WS-RESP-NORMAL
  9172        GO TO 0900-EXIT
  9173     END-IF
  9174
  9175     .
  9176 0900-READNEXT.
  9177
  9178
  9179* EXEC CICS READNEXT
  9180*       DATASET  ('ERPDEF')
  9181*       SET      (ADDRESS OF PRODUCT-MASTER)
  9182*       RIDFLD   (ERPDEF-KEY)
  9183*       RESP     (WS-RESPONSE)
  9184*    END-EXEC
  9185     MOVE 'ERPDEF' TO DFHEIV1
  9186     MOVE 0
  9187       TO DFHEIV11
  9188*    MOVE '&.S                   )  N#00008900' TO DFHEIV0
  9189     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9190     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 173
* EL156.cbl
  9191     MOVE X'204E233030303038393030' TO DFHEIV0(25:11)
  9192     CALL 'kxdfhei1' USING DFHEIV0,
  9193           DFHEIV1,
  9194           DFHEIV20,
  9195           DFHEIV99,
  9196           ERPDEF-KEY,
  9197           DFHEIV99,
  9198           DFHEIV11,
  9199           DFHEIV99,
  9200           DFHEIV99
  9201     SET ADDRESS OF PRODUCT-MASTER TO
  9202         DFHEIV20
  9203     MOVE EIBRESP  TO WS-RESPONSE
  9204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9205
  9206     IF NOT WS-RESP-NORMAL
  9207        GO TO 0900-ENDBR
  9208     END-IF
  9209
  9210     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9211        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9212           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9213        ELSE
  9214           GO TO 0900-READNEXT
  9215        END-IF
  9216     ELSE
  9217        GO TO 0900-ENDBR
  9218     END-IF
  9219
  9220     IF CM-LOAN-TERM = ZEROS
  9221        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9222     END-IF
  9223
  9224     .
  9225 0900-ENDBR.
  9226
  9227
  9228* EXEC CICS ENDBR
  9229*       DATASET  ('ERPDEF')
  9230*    END-EXEC
  9231     MOVE 'ERPDEF' TO DFHEIV1
  9232     MOVE 0
  9233       TO DFHEIV11
  9234*    MOVE '&2                    $   #00008928' TO DFHEIV0
  9235     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9236     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9237     MOVE X'2020233030303038393238' TO DFHEIV0(25:11)
  9238     CALL 'kxdfhei1' USING DFHEIV0,
  9239           DFHEIV1,
  9240           DFHEIV11,
  9241           DFHEIV99
  9242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9243
  9244     .
  9245 0900-EXIT.
  9246     EXIT.
  9247 1000-EDIT-DATA.
  9248
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 174
* EL156.cbl
  9249     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9250         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9251         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9252
  9253     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9254
  9255     IF NOT MODIFY-CAP
  9256         MOVE ER-0070            TO EMI-ERROR
  9257         MOVE -1                 TO PMTTYPEL
  9258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9259         GO TO 2000-EDIT-DONE.
  9260
  9261     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9262                         '5' AND '6'
  9263         MOVE ER-0420            TO EMI-ERROR
  9264         MOVE -1                 TO PMTTYPEL
  9265         MOVE AL-UABON           TO PMTTYPEA
  9266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9267     ELSE
  9268         MOVE AL-UANON           TO PMTTYPEA.
  9269
  9270*    IF PI-OFFLINE = 'Y'
  9271*       IF PI-GROUPED = 'Y'
  9272*          MOVE ER-1880         TO EMI-ERROR
  9273*          MOVE -1              TO GROUPEDL
  9274*          MOVE AL-UABON        TO GROUPEDA
  9275*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9276*
  9277*    IF GROUPEDL > +0
  9278*       IF PI-GROUPED = 'Y' OR 'N'
  9279*          MOVE AL-UANON TO GROUPEDA
  9280*       ELSE
  9281*          MOVE ER-3140            TO EMI-ERROR
  9282*          MOVE -1                 TO GROUPEDL
  9283*          MOVE AL-UABON           TO GROUPEDA
  9284*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9285*
  9286*    IF CASHL > +0
  9287*       IF PI-CASH = 'Y' OR 'N'
  9288*          MOVE AL-UANON           TO CASHA
  9289*       ELSE
  9290*          MOVE ER-3141            TO EMI-ERROR
  9291*          MOVE -1                 TO CASHL
  9292*          MOVE AL-UABON           TO CASHA
  9293*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9294
  9295     IF LOANNOL > +0
  9296         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9297
  9298 1000-EDIT-PAYEE.
  9299
  9300     IF PI-PAYEE-SEQ NOT NUMERIC
  9301         MOVE ER-0294            TO  EMI-ERROR
  9302         MOVE -1                 TO  PAYEEL
  9303         MOVE AL-UABON           TO  PAYEEA
  9304         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9305         GO TO 1000-CONT-EDIT.
  9306
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 175
* EL156.cbl
  9307     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9308                         'E' OR 'O' OR 'Q'
  9309         NEXT SENTENCE
  9310     ELSE
  9311         MOVE ER-0294            TO  EMI-ERROR
  9312         MOVE -1                 TO  PAYEEL
  9313         MOVE AL-UABON           TO  PAYEEA
  9314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9315         GO TO 1000-CONT-EDIT.
  9316
  9317     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9318        (PI-PAYEE-SEQ NOT < '1' AND
  9319         PI-PAYEE-SEQ NOT > '9'))
  9320      OR
  9321        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9322         (PI-PAYEE-SEQ NOT > '9'))
  9323         MOVE AL-UANON            TO PAYEEA
  9324     ELSE
  9325         MOVE ER-0294            TO EMI-ERROR
  9326         MOVE -1                 TO PAYEEL
  9327         MOVE AL-UABON           TO PAYEEA
  9328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9329
  9330     IF PI-COMPANY-ID = 'DMD'
  9331         IF PI-PAYEE-TYPE = 'B' AND
  9332            PI-PAYEE-SEQ NOT = '0'
  9333               MOVE ER-7841            TO EMI-ERROR
  9334               MOVE -1                 TO PAYEEL
  9335               MOVE AL-UABON           TO PAYEEA
  9336               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9337
  9338     IF PI-COMPANY-ID = 'JHL'
  9339         IF PI-PAYEE = 'B0'
  9340             NEXT SENTENCE
  9341           ELSE
  9342
  9343* EXEC CICS HANDLE CONDITION
  9344*            ENDFILE(1950-NOT-FOUND)
  9345*            NOTFND (1950-NOT-FOUND)
  9346*        END-EXEC
  9347*    MOVE '"$''I                  ! & #00009030' TO DFHEIV0
  9348     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9350     MOVE X'2620233030303039303330' TO DFHEIV0(25:11)
  9351     CALL 'kxdfhei1' USING DFHEIV0
  9352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9353         MOVE 'N'                    TO FOUND-TOL-SW
  9354         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9355         MOVE '2'                    TO CNTL-REC-TYPE
  9356         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9357         MOVE +0                     TO CNTL-SEQ-NO
  9358         MOVE 'PROC'                 TO FILE-SWITCH
  9359         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9360         IF PI-PAYEE = 'I1' AND
  9361            APPROVAL-LEVEL-2
  9362             NEXT SENTENCE
  9363           ELSE
  9364         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 176
* EL156.cbl
  9365             MOVE ER-3546        TO EMI-ERROR
  9366             MOVE -1             TO PAYEEL
  9367             MOVE AL-UABON       TO PAYEEA
  9368             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9369
  9370     IF PI-PAYEE-TYPE = 'E'
  9371        IF PI-PMTTYPE = '5' OR '6'
  9372            NEXT SENTENCE
  9373        ELSE
  9374            MOVE ER-3539            TO EMI-ERROR
  9375            MOVE -1                 TO PAYEEL
  9376            MOVE AL-UABON           TO PAYEEA
  9377            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9378
  9379 1000-CONT-EDIT.
  9380
  9381     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9382        IF PI-EPYAMT NOT NEGATIVE
  9383            MOVE ER-0421         TO EMI-ERROR
  9384            MOVE -1              TO OFFLINEL
  9385            MOVE AL-UABON        TO OFFLINEA
  9386            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9387        ELSE
  9388            MOVE AL-UANON        TO OFFLINEA.
  9389
  9390     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  9391        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9392           CONTINUE
  9393        ELSE
  9394           IF PI-PRINT-EOB-YN = 'S' AND
  9395              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9396                CONTINUE
  9397           ELSE
  9398              MOVE ER-1561       TO EMI-ERROR
  9399              MOVE -1            TO EOBYNL
  9400              MOVE AL-UABON      TO EOBYNA
  9401              PERFORM 9900-ERROR-FORMAT
  9402                                 THRU 9900-EXIT
  9403           END-IF
  9404        END-IF
  9405
  9406        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9407            MOVE ER-1566        TO EMI-ERROR
  9408            MOVE -1             TO CLMFMYNL
  9409            MOVE AL-UABON       TO CLMFMYNA
  9410            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9411        END-IF
  9412
  9413        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9414            MOVE ER-1567        TO EMI-ERROR
  9415            MOVE -1             TO SURVYYNL
  9416            MOVE AL-UABON       TO SURVYYNA
  9417            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9418        END-IF
  9419
  9420        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9421            MOVE ER-1569        TO EMI-ERROR
  9422            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 177
* EL156.cbl
  9423            MOVE AL-UABON       TO SPRELYNA
  9424            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425        END-IF
  9426
  9427     END-IF
  9428     IF PI-EPYAMT IS NEGATIVE
  9429         IF PI-OFFLINE NOT = 'Y'
  9430             MOVE ER-0836        TO  EMI-ERROR
  9431             MOVE -1             TO  OFFLINEL
  9432             MOVE AL-UABON       TO  OFFLINEA
  9433             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9434
  9435     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9436        MOVE ER-0872             TO EMI-ERROR
  9437        MOVE -1                  TO PROOFDTL
  9438        MOVE AL-UABON            TO PROOFDTA
  9439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9440     ELSE
  9441        MOVE '4'                TO DC-OPTION-CODE
  9442        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9443        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9444        IF DATE-CONVERSION-ERROR
  9445            MOVE ER-0873        TO EMI-ERROR
  9446            MOVE -1                  TO PROOFDTL
  9447            MOVE AL-UABON            TO PROOFDTA
  9448            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9449        ELSE
  9450            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9451            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9452                MOVE ER-0873    TO EMI-ERROR
  9453                MOVE -1                  TO PROOFDTL
  9454                MOVE AL-UABON            TO PROOFDTA
  9455                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9456            END-IF
  9457        END-IF
  9458     END-IF.
  9459
  9460     IF PI-COMPANY-ID = 'DMD'
  9461        IF NOTE1L NOT = ZEROS
  9462            MOVE ER-7844        TO  EMI-ERROR
  9463            MOVE -1             TO  NOTE1L
  9464            MOVE AL-UABON       TO  NOTE1A
  9465            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9466
  9467     IF PI-COMPANY-ID = 'DMD'
  9468        IF NOTE2L NOT = ZEROS
  9469          GO TO 1004-DMD-EOB-CHECKS.
  9470
  9471     IF NOTE1L NOT > +0
  9472         GO TO 1005-CHECK-ERRORS.
  9473
  9474     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9475         GO TO 1005-CHECK-ERRORS.
  9476
  9477     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9478         GO TO 1003-HAN-PMT-NOTES.
  9479
  9480     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 178
* EL156.cbl
  9481
  9482     IF WS-PMTOPTION NUMERIC
  9483        IF WS-PMTOPTION > '00' AND < '17'
  9484           NEXT SENTENCE
  9485        ELSE
  9486           MOVE ER-0618          TO EMI-ERROR
  9487           MOVE -1               TO NOTE1L
  9488           MOVE AL-UABON         TO NOTE1A
  9489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9490     ELSE
  9491        GO TO 1005-CHECK-ERRORS.
  9492
  9493     IF WS-PMTOPTION = '05' AND
  9494        WS-DOCNAME = SPACES
  9495          MOVE ER-0616             TO EMI-ERROR
  9496          MOVE -1                  TO NOTE1L
  9497          MOVE AL-UABON            TO NOTE1A
  9498          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9499
  9500     IF WS-PMTOPTION = '15' OR '16'
  9501
  9502* EXEC CICS BIF DEEDIT
  9503*            FIELD (WS-AMOUNT)
  9504*            LENGTH(08)
  9505*        END-EXEC
  9506     MOVE 08
  9507       TO DFHEIV11
  9508*    MOVE '@"L                   #   #00009182' TO DFHEIV0
  9509     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9510     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9511     MOVE X'2020233030303039313832' TO DFHEIV0(25:11)
  9512     CALL 'kxdfhei1' USING DFHEIV0,
  9513           WS-AMOUNT,
  9514           DFHEIV11
  9515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9516        IF (WS-NUM-AMT = ZEROS) OR
  9517           (WS-AMOUNT NOT NUMERIC)
  9518           MOVE ER-0617          TO EMI-ERROR
  9519           MOVE -1               TO NOTE1L
  9520           MOVE AL-UABON         TO NOTE1A
  9521           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9522
  9523     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9524
  9525     GO TO 1005-CHECK-ERRORS.
  9526
  9527 1003-HAN-PMT-NOTES.
  9528
  9529     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9530
  9531     IF WS-HAN-PMT-CODE = SPACE
  9532         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9533     ELSE
  9534     IF WS-HAN-PMT-CODE = 'A'
  9535         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9536                                 TO WS-HAN-PMT-NOTE
  9537     ELSE
  9538     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 179
* EL156.cbl
  9539         MOVE ':FINAL PAYMENT / DECEASED'
  9540                                 TO WS-HAN-PMT-NOTE
  9541     ELSE
  9542     IF WS-HAN-PMT-CODE = 'C'
  9543         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9544                                 TO WS-HAN-PMT-NOTE
  9545     ELSE
  9546     IF WS-HAN-PMT-CODE = 'D'
  9547         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9548                                 TO WS-HAN-PMT-NOTE
  9549     ELSE
  9550     IF WS-HAN-PMT-CODE = 'E'
  9551         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9552                                 TO WS-HAN-PMT-NOTE
  9553     ELSE
  9554     IF WS-HAN-PMT-CODE = 'F'
  9555         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9556                                 TO WS-HAN-PMT-NOTE
  9557     ELSE
  9558     IF WS-HAN-PMT-CODE = 'P'
  9559         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9560
  9561     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9562     GO TO 1005-CHECK-ERRORS.
  9563
  9564 1004-DMD-EOB-CHECKS.
  9565
  9566     INITIALIZE PI-AT-EOB-CODES.
  9567
  9568     IF NOTE2I (20:21) > SPACES
  9569         MOVE ER-7845          TO EMI-ERROR
  9570         MOVE -1               TO NOTE2L
  9571         MOVE AL-UABON         TO NOTE2A
  9572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9573         GO TO 1005-CHECK-ERRORS
  9574      ELSE
  9575         MOVE NOTE2I             TO W-EOB-CODES.
  9576
  9577     MOVE +1                     TO W-EOB-NDX.
  9578
  9579 1004-CHECK-EACH-EOB.
  9580
  9581     IF W-EOB-NDX > +5
  9582             OR
  9583        W-EOB-CODE (W-EOB-NDX) = SPACES
  9584         GO TO 1004-CHECK-DUP-EOB.
  9585
  9586     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9587         MOVE ER-0956            TO EMI-ERROR
  9588         MOVE -1                 TO NOTE2L
  9589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9590         GO TO 1005-CHECK-ERRORS.
  9591
  9592     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9593     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9594     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9595     MOVE 'DLO023'               TO PGM-NAME.
  9596
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 180
* EL156.cbl
  9597
  9598* EXEC CICS LINK
  9599*        PROGRAM    (PGM-NAME)
  9600*        COMMAREA   (CD-COMMUNICATION-AREA)
  9601*        LENGTH     (CD-RCRD-LENGTH)
  9602*    END-EXEC.
  9603*    MOVE '."C                   (   #00009267' TO DFHEIV0
  9604     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9606     MOVE X'2020233030303039323637' TO DFHEIV0(25:11)
  9607     CALL 'kxdfhei1' USING DFHEIV0,
  9608           PGM-NAME,
  9609           CD-COMMUNICATION-AREA,
  9610           CD-RCRD-LENGTH,
  9611           DFHEIV99,
  9612           DFHEIV99,
  9613           DFHEIV99,
  9614           DFHEIV99
  9615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9616
  9617
  9618     IF CD-RETURN-CODE = 'OK'
  9619         GO TO 1004-CONT.
  9620
  9621     MOVE -1                     TO NOTE2L.
  9622
  9623     IF CD-RETURN-CODE = '01'
  9624         MOVE ER-8310            TO EMI-ERROR
  9625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9626         GO TO 1005-CHECK-ERRORS.
  9627
  9628     IF CD-RETURN-CODE = '02'
  9629         MOVE ER-8311            TO EMI-ERROR
  9630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9631         GO TO 1005-CHECK-ERRORS.
  9632
  9633     IF CD-RETURN-CODE = '03'
  9634         MOVE ER-8312            TO EMI-ERROR
  9635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9636         GO TO 1005-CHECK-ERRORS.
  9637
  9638     IF CD-RETURN-CODE = '04'
  9639         MOVE ER-8313            TO EMI-ERROR
  9640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9641         GO TO 1005-CHECK-ERRORS.
  9642
  9643     IF CD-RETURN-CODE = '05'
  9644         MOVE ER-8314            TO EMI-ERROR
  9645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9646         GO TO 1005-CHECK-ERRORS.
  9647
  9648     IF CD-RETURN-CODE = '06'
  9649         MOVE ER-8315            TO EMI-ERROR
  9650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9651         GO TO 1005-CHECK-ERRORS.
  9652
  9653     IF CD-RETURN-CODE = 'E1'
  9654         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 181
* EL156.cbl
  9655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9656         GO TO 1005-CHECK-ERRORS.
  9657
  9658     IF CD-RETURN-CODE = 'N1'
  9659         MOVE ER-8317            TO EMI-ERROR
  9660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9661         GO TO 1005-CHECK-ERRORS.
  9662
  9663 1004-CONT.
  9664     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9665
  9666     ADD +1 TO W-EOB-NDX.
  9667     GO TO 1004-CHECK-EACH-EOB.
  9668
  9669 1004-CHECK-DUP-EOB.
  9670     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9671         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9672                               PI-AT-EOB-CODE (3) OR
  9673                               PI-AT-EOB-CODE (4) OR
  9674                               PI-AT-EOB-CODE (5)))
  9675                  OR
  9676        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9677         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9678                               PI-AT-EOB-CODE (4) OR
  9679                               PI-AT-EOB-CODE (5)))
  9680                  OR
  9681        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9682         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9683                               PI-AT-EOB-CODE (5)))
  9684                  OR
  9685        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9686         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9687            MOVE ER-8000            TO EMI-ERROR
  9688            MOVE AL-UABON           TO NOTE2A
  9689            MOVE -1                 TO NOTE2L
  9690            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9691            GO TO 1005-CHECK-ERRORS.
  9692
  9693 1005-CHECK-ERRORS.
  9694*    IF PI-COMPANY-ID NOT = 'DMD'
  9695        GO TO 1006-CHECK-ERRORS.
  9696
  9697*********  DMD CODE START ******************
  9698*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9699*       GO TO 1006-CHECK-ERRORS.
  9700*
  9701*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9702*
  9703*    COMPUTE W-PAYMENT-TOTAL
  9704*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9705*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9706*               AND
  9707*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9708*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9709*          MOVE ER-0967    TO EMI-ERROR
  9710*          MOVE -1         TO PMTTYPEL
  9711*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9712*
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 182
* EL156.cbl
  9713*    GO TO 1006-CHECK-ERRORS.
  9714*********  DMD CODE END ******************
  9715
  9716 1006-CHECK-ERRORS.
  9717     if emi-forcable-ctr = zeros
  9718        and emi-fatal-ctr = zeros
  9719        continue
  9720     else
  9721        IF NOT EMI-NO-ERRORS
  9722           GO TO 2000-EDIT-DONE
  9723        end-if
  9724     end-if
  9725
  9726* EXEC CICS HANDLE CONDITION
  9727*        NOTFND(1950-NOT-FOUND)
  9728*    END-EXEC.
  9729*    MOVE '"$I                   ! '' #00009380' TO DFHEIV0
  9730     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9732     MOVE X'2720233030303039333830' TO DFHEIV0(25:11)
  9733     CALL 'kxdfhei1' USING DFHEIV0
  9734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9735
  9736
  9737     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9738     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9739     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9740     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9741     MOVE 'MSTR'                 TO FILE-SWITCH.
  9742
  9743     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9744
  9745     IF PI-COMPANY-ID = 'DMD'
  9746         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9747
  9748     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9749        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9750           MOVE ER-0873    TO EMI-ERROR
  9751           MOVE -1                  TO PROOFDTL
  9752           MOVE AL-UABON            TO PROOFDTA
  9753           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9754        END-IF
  9755     END-IF
  9756     if cl-benefit-period = zeros
  9757        move er-1667             to emi-error
  9758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9759     end-if
  9760     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9761     MOVE +95                    TO TRLR-SEQ-NO
  9762
  9763* EXEC CICS READ
  9764*       DATASET  ('ELTRLR')
  9765*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9766*       RIDFLD   (ELTRLR-KEY)
  9767*       RESP     (WS-RESPONSE)
  9768*    END-EXEC
  9769     MOVE 'ELTRLR' TO DFHEIV1
  9770*    MOVE '&"S        E          (  N#00009409' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 183
* EL156.cbl
  9771     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9773     MOVE X'204E233030303039343039' TO DFHEIV0(25:11)
  9774     CALL 'kxdfhei1' USING DFHEIV0,
  9775           DFHEIV1,
  9776           DFHEIV20,
  9777           DFHEIV99,
  9778           ELTRLR-KEY,
  9779           DFHEIV99,
  9780           DFHEIV99,
  9781           DFHEIV99
  9782     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9783         DFHEIV20
  9784     MOVE EIBRESP  TO WS-RESPONSE
  9785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9786
  9787     if ws-resp-normal
  9788        perform varying s1 from +1 by +1 until
  9789           at-note-error-no (s1) = spaces
  9790           if at-note-error-no (s1) = '1662'
  9791              continue
  9792           else
  9793              move at-note-error-no (s1)
  9794                                 to emi-error
  9795              if at-note-error-no (s1) = '1653'
  9796                 evaluate true
  9797                    when cl-claim-type = 'L'
  9798                       move '  LF  '
  9799                                 to emi-claim-type
  9800                    when cl-claim-type = 'I'
  9801                       move '  IU  '
  9802                                 to emi-claim-type
  9803                    when cl-claim-type = 'A'
  9804                       move '  AH  '
  9805                                 to emi-claim-type
  9806                    when other
  9807                       move ' FMLA '
  9808                                 to emi-claim-type
  9809                 end-evaluate
  9810              end-if
  9811              PERFORM 9900-ERROR-FORMAT
  9812                                 THRU 9900-EXIT
  9813           end-if
  9814        end-perform
  9815     end-if
  9816     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9817         IF PI-PMTTYPE = '5' OR '6'
  9818             NEXT SENTENCE
  9819         ELSE
  9820             MOVE ER-0555             TO EMI-ERROR
  9821             MOVE -1                  TO PMTTYPEL
  9822             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9823
  9824     IF CL-LAST-CLOSE-REASON = '2'
  9825         IF CL-CLAIM-STATUS = 'C'
  9826             MOVE ER-0760        TO  EMI-ERROR
  9827             MOVE -1             TO  PMTTYPEL
  9828             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 184
* EL156.cbl
  9829
  9830     IF PI-ACTIVITY-CODE = 9
  9831         MOVE ER-3538            TO  EMI-ERROR
  9832         MOVE -1                 TO  PMTTYPEL
  9833         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9834
  9835     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9836         GO TO 1008-READ-CERT.
  9837**********************AIG LOGIC STARTS *********************
  9838     IF CL-CERT-PRIME = 'INCOMPLETE'
  9839         MOVE ER-3540            TO  EMI-ERROR
  9840         MOVE -1                 TO  PMTTYPEL
  9841         MOVE AL-UABON           TO  PMTTYPEA
  9842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9843         GO TO 2000-EDIT-DONE.
  9844
  9845     IF PI-PMTTYPE = '4'
  9846         IF PI-EPYAMT IS NEGATIVE
  9847             IF PI-ECHECKNO-CR = 'CR'
  9848                 NEXT SENTENCE
  9849             ELSE
  9850                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9851
  9852     IF PI-PMTTYPE = '4'
  9853         IF PI-ECHECKNO-CR = 'CR'
  9854             IF PI-EPYAMT IS NEGATIVE
  9855                 NEXT SENTENCE
  9856             ELSE
  9857                 MOVE ER-0834    TO  EMI-ERROR
  9858                 MOVE -1         TO  EPYAMTL
  9859                 MOVE AL-UNBON   TO  EPYAMTA
  9860                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9861
  9862     IF PI-PMTTYPE = '4'
  9863         IF PI-EPYAMT IS NEGATIVE
  9864             IF PI-OFFLINE = 'Y'
  9865                 NEXT SENTENCE
  9866             ELSE
  9867                 MOVE 'Y'        TO  PI-OFFLINE
  9868                                     WS-OFFLINE
  9869                                     OFFLINEO
  9870                 MOVE AL-UANON   TO  OFFLINEA.
  9871
  9872*    IF PI-PMTTYPE = '4'
  9873*        IF PI-EPYAMT IS NEGATIVE
  9874*            IF PI-CASH = 'Y'
  9875*                NEXT SENTENCE
  9876*            ELSE
  9877*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9878*                MOVE AL-UANON   TO  CASHA
  9879*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9880*
  9881*    IF PI-CASH NOT = 'Y' AND 'N'
  9882*         IF PI-OFFLINE = 'Y'  AND
  9883*            PI-ECHECKNO-CR = 'CR'
  9884*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9885*              MOVE AL-UANON     TO  CASHA
  9886*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 185
* EL156.cbl
  9887*
  9888*    IF PI-CASH NOT = 'Y' AND 'N'
  9889*        IF PI-PMTTYPE = '5' OR '6'
  9890*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9891*            MOVE AL-UANON       TO  CASHA
  9892*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9893*
  9894*    IF PI-CASH NOT = 'Y' AND 'N'
  9895*       IF CL-ASSOCIATES = 'N' OR 'A'
  9896*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9897*           MOVE AL-UANON        TO  CASHA
  9898*       ELSE
  9899*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9900*           MOVE AL-UANON        TO  CASHA.
  9901*
  9902*    IF PI-PMTTYPE = '5' OR '6'
  9903*        IF PI-CASH = 'N'
  9904*            MOVE ER-0819        TO  EMI-ERROR
  9905*            MOVE AL-UANON       TO  CASHA
  9906*            MOVE -1             TO  CASHL
  9907*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9908*
  9909*    IF CL-ASSOCIATES = 'N' OR 'A'
  9910*       IF CASHI = 'N'
  9911*        MOVE ER-3537            TO  EMI-ERROR
  9912*        MOVE AL-UANON           TO  CASHA
  9913*        MOVE -1                 TO  CASHL
  9914*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9915
  9916 1007-DEFAULT-AIG-CHECKNO.
  9917
  9918     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9919         MOVE ER-3532            TO  EMI-ERROR
  9920         MOVE -1                 TO  PMTTYPEL
  9921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9922**********************AIG LOGIC ENDS ***********************
  9923
  9924 1008-READ-CERT.
  9925
  9926     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9927     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9928     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9929     MOVE CL-CERT-STATE          TO CERT-STATE.
  9930     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9931     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9932     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9933     MOVE 'CERT'                 TO FILE-SWITCH.
  9934
  9935     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9936
  9937     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9938        MOVE CM-LF-LOAN-EXPIRE-DT
  9939                                 TO WS-EXP-DT PI-EXP-DT
  9940                                    ws-extended-exp-dt
  9941     ELSE
  9942        MOVE CM-AH-LOAN-EXPIRE-DT
  9943                                 TO WS-EXP-DT PI-EXP-DT
  9944                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 186
* EL156.cbl
  9945     end-if
  9946     if pi-dcc-product-code not = spaces
  9947        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9948        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9949        PERFORM 0900-GET-DDF-limits
  9950                                 THRU 0900-EXIT
  9951        IF PDEF-FOUND
  9952           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9953              (P1 > +8)
  9954              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9955           END-PERFORM
  9956           IF P1 < +9
  9957              MOVE '6'           TO DC-OPTION-CODE
  9958              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9959              MOVE PD-MAX-EXTENSION (P1)
  9960                                 TO DC-ELAPSED-MONTHS
  9961              PERFORM 9700-LINK-DATE-CONVERT
  9962                                 THRU 9700-EXIT
  9963              if no-conversion-error
  9964                 move dc-bin-date-2 to ws-extended-exp-dt
  9965              end-if
  9966           else
  9967              move er-1674       to emi-error
  9968              PERFORM 9900-ERROR-FORMAT
  9969                                 THRU 9900-EXIT
  9970           end-if
  9971        end-if
  9972     end-if
  9973*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9974*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9975
  9976     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9977         MOVE ER-0458            TO EMI-ERROR
  9978         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9979
  9980     IF (CL-INCURRED-DT > WS-EXP-DT)
  9981        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9982        MOVE ER-1677             TO EMI-ERROR
  9983        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9984     END-IF
  9985     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9986     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9987         MOVE ER-0459            TO EMI-ERROR
  9988         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9989
  9990     IF CL-REPORTED-DT = LOW-VALUES
  9991        MOVE ER-0530             TO EMI-ERROR
  9992        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9993
  9994     IF PI-COMPANY-ID = 'NCL'
  9995        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9996            MOVE ER-0770            TO EMI-ERROR
  9997            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9998
  9999     IF PI-COMPANY-ID = 'NCL'
 10000        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10001            MOVE ER-0737            TO EMI-ERROR
 10002            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 187
* EL156.cbl
 10003
 10004     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10005         MOVE ER-0768            TO  EMI-ERROR
 10006         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10007
 10008     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10009         MOVE ER-0769            TO  EMI-ERROR
 10010         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10011
 10012     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10013         GO TO 1020-DO-LIFE-EDITS
 10014     ELSE
 10015         GO TO 1030-DO-AH-EDITS.
 10016
 10017 1010-GENERAL-ERROR.
 10018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10019
 10020     IF EMI-MESSAGE-FORMATTED
 10021         MOVE -1                 TO PMTTYPEL.
 10022
 10023 1010-EXIT.
 10024     EXIT.
 10025
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 188
* EL156.cbl
 10027 1020-DO-LIFE-EDITS.
 10028     IF CM-LF-BENEFIT-CD = '00'
 10029         IF PI-PMTTYPE = '5' OR '6'
 10030             MOVE ER-0658        TO EMI-ERROR
 10031             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10032         ELSE
 10033            if (pi-company-id = 'DCC' or 'CAP')
 10034               and (pi-dcc-product-code not = spaces)
 10035               continue
 10036            else
 10037               MOVE ER-1775      TO EMI-ERROR
 10038               PERFORM 1040-PMTTYPE-ERROR
 10039                                 THRU 1040-EXIT
 10040            end-if
 10041         end-if
 10042     end-if
 10043
 10044     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10045     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10046         MOVE ER-0460            TO EMI-ERROR
 10047         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10048
 10049     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10050     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10051     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10052     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10053     MOVE '4'                    TO  CNTL-REC-TYPE.
 10054     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10055     MOVE 'BENE'                 TO  FILE-SWITCH.
 10056     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10057     IF NO-BENEFIT-FOUND
 10058         GO TO 1950-NOT-FOUND.
 10059
 10060     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10061
 10062     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10063         IF PI-PMTTYPE = '4'
 10064             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10065                PI-LF-COVERAGE-TYPE = 'P'
 10066                 NEXT SENTENCE
 10067             ELSE
 10068                 MOVE ER-0461        TO EMI-ERROR
 10069                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10070         ELSE
 10071            NEXT SENTENCE
 10072     ELSE
 10073         IF PI-PMTTYPE = '2'
 10074            IF NOT CM-O-B-COVERAGE
 10075              AND CM-LF-CURRENT-STATUS = '7'
 10076                MOVE ER-0462     TO EMI-ERROR
 10077                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10078
 10079     IF PI-PMTTYPE = '2'
 10080         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10081            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10082             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10083             MOVE ER-0730            TO  EMI-ERROR
 10084             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 189
* EL156.cbl
 10085             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10086
 10087     IF PI-PMTTYPE = '2'
 10088         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10089            PI-LF-COVERAGE-TYPE = 'P'
 10090             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10091                 MOVE ER-0462    TO  EMI-ERROR
 10092                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10093
 10094     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10095       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10096         MOVE ER-0466            TO EMI-ERROR
 10097         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10098
 10099     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10100         IF PI-PMTTYPE = '3'
 10101             MOVE 0436           TO EMI-ERROR
 10102             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10103             GO TO 1045-EDIT-PAYEE-ADDR
 10104         ELSE
 10105             GO TO 1045-EDIT-PAYEE-ADDR.
 10106
 10107     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10108        PI-LF-COVERAGE-TYPE = 'P'
 10109         IF PI-PMTTYPE = '3'
 10110             MOVE ER-0436          TO  EMI-ERROR
 10111             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10112         ELSE
 10113             NEXT SENTENCE
 10114     ELSE
 10115         IF PI-PMTTYPE = '1' OR '3'
 10116             MOVE ER-0436            TO EMI-ERROR
 10117             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10118*
 10119     IF PI-COMPANY-ID = 'CID' AND
 10120        CL-CERT-STATE = 'SC'  AND
 10121        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10122           MOVE ER-0879    TO  EMI-ERROR
 10123           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10124           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10125     END-IF.
 10126     IF PI-COMPANY-ID = 'AHL'
 10127        evaluate true
 10128           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10129              MOVE ER-0879       TO  EMI-ERROR
 10130              PERFORM 1040-PMTTYPE-ERROR
 10131                                 THRU 1040-EXIT
 10132              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10133           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10134                 '6D' OR '6H' OR '6R'
 10135              MOVE ER-0879       TO  EMI-ERROR
 10136              PERFORM 1040-PMTTYPE-ERROR
 10137                                 THRU 1040-EXIT
 10138              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10139           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10140              MOVE ER-0879       TO  EMI-ERROR
 10141              PERFORM 1040-PMTTYPE-ERROR
 10142                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 190
* EL156.cbl
 10143              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10144        end-evaluate
 10145     END-IF
 10146     GO TO 1045-EDIT-PAYEE-ADDR.
 10147
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 191
* EL156.cbl
 10149 1030-DO-AH-EDITS.
 10150     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10151     IF CM-AH-BENEFIT-CD = '00'
 10152         IF PI-PMTTYPE = '5' OR '6'
 10153             MOVE ER-0658        TO EMI-ERROR
 10154             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10155         ELSE
 10156             MOVE ER-1775        TO EMI-ERROR
 10157             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10158
 10159     IF CL-TOTAL-PAID-AMT = ZEROS
 10160         IF PI-PMTTYPE = '4'
 10161             MOVE ER-0438        TO EMI-ERROR
 10162             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10163
 10164     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10165         IF PI-PMTTYPE = '3'
 10166             MOVE ER-0463        TO EMI-ERROR
 10167             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10168         ELSE
 10169             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10170              AND CM-LF-CURRENT-STATUS = '7'
 10171                 MOVE ER-0465    TO EMI-ERROR
 10172                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10173
 10174     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10175         IF PI-PMTTYPE = '3'
 10176             MOVE ER-0464        TO EMI-ERROR
 10177             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10178         ELSE
 10179             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10180                 MOVE ER-0469    TO EMI-ERROR
 10181                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10182
 10183     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10184         IF PI-PMTTYPE = '3'
 10185             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10186                 MOVE ER-0467    TO EMI-ERROR
 10187                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10188             ELSE
 10189                 NEXT SENTENCE
 10190         ELSE
 10191             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10192                 MOVE ER-0468    TO EMI-ERROR
 10193                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10194
 10195     GO TO 1045-EDIT-PAYEE-ADDR.
 10196
 10197 1040-PMTTYPE-ERROR.
 10198     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10199
 10200     IF EMI-MESSAGE-FORMATTED
 10201         MOVE -1                 TO PMTTYPEL
 10202         MOVE AL-UABON           TO PMTTYPEA.
 10203
 10204 1040-EXIT.
 10205     EXIT.
 10206
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 192
* EL156.cbl
 10208 1045-EDIT-PAYEE-ADDR.
 10209
 10210     IF PI-OFFLINE = 'N' AND
 10211        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10212           < PI-PAYEE-SEQ-NUM)
 10213        OR
 10214         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10215         (PI-PAYEE-TYPE = 'B')                 AND
 10216         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10217        OR
 10218         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10219           < PI-PAYEE-SEQ-NUM)
 10220        OR
 10221         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10222           < PI-PAYEE-SEQ-NUM)
 10223        OR
 10224         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10225           < PI-PAYEE-SEQ-NUM)
 10226        OR
 10227         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10228           < PI-PAYEE-SEQ-NUM)
 10229        OR
 10230         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10231           < PI-PAYEE-SEQ-NUM))
 10232             MOVE ER-0437        TO EMI-ERROR
 10233             MOVE -1             TO PAYEEL
 10234             MOVE AL-UABON       TO PAYEEA
 10235             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10236
 10237     IF PI-OFFLINE    = 'N' AND
 10238        PI-PAYEE-TYPE = 'B' AND
 10239        PI-PAYEE-SEQ  = '0'
 10240         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10241         IF BENE-FOUND-SW = 'N'
 10242             MOVE ER-0437        TO EMI-ERROR
 10243             MOVE -1             TO PAYEEL
 10244             MOVE AL-UABON       TO PAYEEA
 10245             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10246
 10247     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10248        IF PI-OFFLINE    = 'N'  AND
 10249           PI-PAYEE-TYPE = 'B'  AND
 10250           PI-PAYEE-SEQ  = '9'
 10251             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10252             IF BENE-FOUND-SW = 'N'
 10253                MOVE ER-0437        TO EMI-ERROR
 10254                MOVE -1             TO PAYEEL
 10255                MOVE AL-UABON       TO PAYEEA
 10256                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10257
 10258*    IF PI-COMPANY-ID = 'CRI'
 10259*        IF CL-CLAIM-TYPE = 'L'
 10260*            MOVE 'N'                TO  WS-GROUPED
 10261*                                        PI-GROUPED
 10262*                                        GROUPEDI
 10263*            MOVE AL-UANON           TO  GROUPEDA
 10264*            GO TO 1050-EDIT-CHECK-NO
 10265*        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 193
* EL156.cbl
 10266*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10267*            IF WS-GROUP-1 = 'C'
 10268*                NEXT SENTENCE
 10269*            ELSE
 10270*                MOVE 'N'            TO  WS-GROUPED
 10271*                                        PI-GROUPED
 10272*                                        GROUPEDI
 10273*                MOVE AL-UANON       TO  GROUPEDA
 10274*                GO TO 1050-EDIT-CHECK-NO.
 10275
 10276*     IF PI-GROUPED = 'Y'
 10277*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10278*           NEXT SENTENCE
 10279*        ELSE
 10280*           MOVE ER-0437        TO EMI-ERROR
 10281*           MOVE -1             TO PAYEEL
 10282**02180            MOVE AL-UABON       TO PAYEEA
 10283*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10284*
 10285*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10286*        (PI-GROUPED    = ' ')
 10287*        NEXT SENTENCE
 10288*     ELSE
 10289*
 10290     GO TO 1050-EDIT-CHECK-NO.
 10291*     IF PI-COMPANY-ID = 'CRI'
 10292*        MOVE 'N'           TO GROUPEDI
 10293*                              PI-GROUPED
 10294*                              WS-GROUPED
 10295*        MOVE AL-UANON      TO GROUPEDA.
 10296*
 10297*     IF PI-COMPANY-ID = 'CRI'
 10298*        IF PI-PAYEE-TYPE = 'B'
 10299*           IF BENE-FOUND-SW = 'Y'
 10300*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10301*                 MOVE 'Y'           TO GROUPEDI
 10302*                                       PI-GROUPED
 10303*                                       WS-GROUPED
 10304*                 MOVE AL-UANON      TO GROUPEDA
 10305*              ELSE
 10306*                 NEXT SENTENCE
 10307*           ELSE
 10308*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10309*              IF BENE-FOUND-SW = 'Y'
 10310*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10311*                    MOVE 'Y'      TO GROUPEDI
 10312*                                     PI-GROUPED
 10313*                                     WS-GROUPED
 10314*                    MOVE AL-UANON TO GROUPEDA.
 10315*
 10316
 10317     IF PI-COMPANY-ID NOT = 'CRI'
 10318        GO TO 1050-EDIT-CHECK-NO.
 10319
 10320*************** CRI CODE START ******************
 10321     IF PI-PAYEE-TYPE NOT = 'A'
 10322        GO TO 1050-EDIT-CHECK-NO.
 10323
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 194
* EL156.cbl
 10324     MOVE LOW-VALUES             TO ERACCT-KEY.
 10325     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10326     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10327     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10328     MOVE PI-STATE               TO ACCT-STATE.
 10329     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10330     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10331     MOVE 'ACCT'                 TO FILE-SWITCH.
 10332
 10333     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10334     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10335
 10336
 10337* EXEC CICS HANDLE CONDITION
 10338*         NOTFND   (1950-NOT-FOUND)
 10339*         ENDFILE  (1950-NOT-FOUND)
 10340*    END-EXEC.
 10341*    MOVE '"$I''                  ! ( #00009965' TO DFHEIV0
 10342     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10344     MOVE X'2820233030303039393635' TO DFHEIV0(25:11)
 10345     CALL 'kxdfhei1' USING DFHEIV0
 10346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10347
 10348
 10349
 10350* EXEC CICS STARTBR
 10351*         DATASET   ('ERACCT')
 10352*         RIDFLD    (ERACCT-KEY)
 10353*         GTEQ
 10354*    END-EXEC.
 10355     MOVE 'ERACCT' TO DFHEIV1
 10356     MOVE 0
 10357       TO DFHEIV11
 10358*    MOVE '&,         G          &   #00009970' TO DFHEIV0
 10359     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10361     MOVE X'2020233030303039393730' TO DFHEIV0(25:11)
 10362     CALL 'kxdfhei1' USING DFHEIV0,
 10363           DFHEIV1,
 10364           ERACCT-KEY,
 10365           DFHEIV99,
 10366           DFHEIV11,
 10367           DFHEIV99
 10368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10369
 10370
 10371 1046-READNEXT-ERACCT.
 10372
 10373
 10374* EXEC CICS READNEXT
 10375*         DATASET   ('ERACCT')
 10376*         RIDFLD    (ERACCT-KEY)
 10377*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10378*    END-EXEC.
 10379     MOVE 'ERACCT' TO DFHEIV1
 10380     MOVE 0
 10381       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 195
* EL156.cbl
 10382*    MOVE '&.S                   )   #00009978' TO DFHEIV0
 10383     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10384     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10385     MOVE X'2020233030303039393738' TO DFHEIV0(25:11)
 10386     CALL 'kxdfhei1' USING DFHEIV0,
 10387           DFHEIV1,
 10388           DFHEIV20,
 10389           DFHEIV99,
 10390           ERACCT-KEY,
 10391           DFHEIV99,
 10392           DFHEIV11,
 10393           DFHEIV99,
 10394           DFHEIV99
 10395     SET ADDRESS OF ACCOUNT-MASTER TO
 10396         DFHEIV20
 10397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10398
 10399
 10400     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10401        IF WS-ERACCT-HOLD-RECORD = SPACES
 10402           GO TO 1950-NOT-FOUND
 10403        ELSE
 10404           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10405           GO TO 1048-CONTINUE.
 10406
 10407     IF ACCT-EXP-DT = HIGH-VALUES
 10408        NEXT SENTENCE
 10409     ELSE
 10410        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10411        GO TO 1046-READNEXT-ERACCT.
 10412
 10413 1048-CONTINUE.
 10414
 10415*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10416*       MOVE 'Y'                 TO GROUPEDI
 10417*                                   PI-GROUPED
 10418*                                   WS-GROUPED
 10419*       MOVE AL-UANON            TO GROUPEDA.
 10420*************** CRI CODE END ******************
 10421
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 196
* EL156.cbl
 10423 1050-EDIT-CHECK-NO.
 10424
 10425     IF PI-OFFLINE = 'Y'
 10426         IF PI-ECHECKNO = SPACES
 10427              MOVE ER-0439        TO EMI-ERROR
 10428              GO TO 1090-CHECK-NO-ERROR
 10429           ELSE
 10430*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10431*           IF PI-ECHECKNO-N = 'N' AND
 10432*              PI-CASH       = 'Y'
 10433*                MOVE ER-3535        TO EMI-ERROR
 10434*                GO TO 1090-CHECK-NO-ERROR
 10435*             ELSE
 10436*                MOVE AL-UANON    TO CHECKNOA
 10437*                GO TO 1100-EDIT-HOLDTIL
 10438*         ELSE
 10439            MOVE AL-UANON    TO CHECKNOA
 10440            GO TO 1100-EDIT-HOLDTIL.
 10441
 10442     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10443     MOVE '6'                    TO CNTL-REC-TYPE.
 10444
 10445     IF CONTROL-IS-ACTUAL-CARRIER
 10446         MOVE PI-CARRIER         TO WS-CARR
 10447     ELSE
 10448         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10449
 10450     IF PI-COMPANY-ID = 'FIA'
 10451         MOVE PI-CARRIER         TO WS-CARR.
 10452
 10453     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10454     MOVE 0                      TO CNTL-SEQ-NO.
 10455     MOVE 'CARR'                 TO FILE-SWITCH.
 10456
 10457     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10458
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 197
* EL156.cbl
 10460     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10461         GO TO 1051-EDIT-CHECKNO-CONT.
 10462
 10463**********************AIG LOGIC STARTS**********************
 10464     IF PI-ECHECKNO = SPACES
 10465         IF CHECK-NO-MANUAL
 10466             MOVE ER-0441        TO EMI-ERROR
 10467             GO TO 1090-CHECK-NO-ERROR
 10468         ELSE
 10469             MOVE AL-UANOF       TO CHECKNOA
 10470             GO TO 1100-EDIT-HOLDTIL.
 10471
 10472     IF PI-ECHECKNO NOT = SPACES
 10473         IF CHECK-NO-MANUAL
 10474             MOVE AL-UANON       TO CHECKNOA
 10475             GO TO 1100-EDIT-HOLDTIL.
 10476
 10477     IF PI-ECHECKNO-CR = 'CR'
 10478        IF PI-OFFLINE = 'Y'
 10479            MOVE AL-UANON       TO CHECKNOA
 10480            GO TO 1100-EDIT-HOLDTIL
 10481        ELSE
 10482            MOVE ER-3534        TO EMI-ERROR
 10483            GO TO 1090-CHECK-NO-ERROR.
 10484
 10485     IF PI-ECHECKNO-N = 'N'
 10486        IF PI-CASH = 'N'
 10487            MOVE AL-UANON       TO CHECKNOA
 10488            GO TO 1100-EDIT-HOLDTIL
 10489        ELSE
 10490            MOVE ER-3535          TO EMI-ERROR
 10491            GO TO 1090-CHECK-NO-ERROR.
 10492
 10493     MOVE ER-0442        TO EMI-ERROR
 10494     GO TO 1090-CHECK-NO-ERROR.
 10495**********************AIG LOGIC ENDS************************
 10496
 10497 1051-EDIT-CHECKNO-CONT.
 10498
 10499     IF PI-COMPANY-ID = 'DMD'
 10500        IF PI-ECHECKNO NOT = SPACES
 10501           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10502              MOVE ER-0442        TO EMI-ERROR
 10503              GO TO 1090-CHECK-NO-ERROR
 10504            ELSE
 10505              GO TO 1100-EDIT-HOLDTIL
 10506          ELSE
 10507           GO TO 1100-EDIT-HOLDTIL.
 10508
 10509     IF PI-ECHECKNO = SPACES
 10510         IF CHECK-NO-MANUAL
 10511             MOVE ER-0441        TO EMI-ERROR
 10512             GO TO 1090-CHECK-NO-ERROR
 10513         ELSE
 10514             MOVE AL-UANOF       TO CHECKNOA
 10515             GO TO 1100-EDIT-HOLDTIL
 10516     ELSE
 10517         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 198
* EL156.cbl
 10518             MOVE AL-UANON       TO CHECKNOA
 10519             GO TO 1100-EDIT-HOLDTIL
 10520         ELSE
 10521             MOVE ER-0442        TO EMI-ERROR
 10522             GO TO 1090-CHECK-NO-ERROR.
 10523
 10524 1090-CHECK-NO-ERROR.
 10525     MOVE -1                     TO CHECKNOL.
 10526     MOVE AL-UABON               TO CHECKNOA.
 10527     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10528
 10529     GO TO 2000-EDIT-DONE.
 10530
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 199
* EL156.cbl
 10532 1100-EDIT-HOLDTIL.
 10533     MOVE AL-UANON               TO HOLDTILA.
 10534
 10535     IF PI-HOLDTIL = ZEROS
 10536        IF PI-OFFLINE = 'Y'
 10537           MOVE ER-0572          TO EMI-ERROR
 10538           GO TO 1105-HOLDTIL-ERROR
 10539        ELSE
 10540           GO TO 1110-EDIT-PAID-FROM.
 10541
 10542     MOVE '4'                    TO DC-OPTION-CODE.
 10543     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10544     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10545
 10546     IF DATE-CONVERSION-ERROR
 10547         MOVE ER-0446            TO EMI-ERROR
 10548         GO TO 1105-HOLDTIL-ERROR
 10549     END-IF
 10550     IF PI-OFFLINE = 'Y'
 10551        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10552           MOVE ER-0446            TO EMI-ERROR
 10553           GO TO 1105-HOLDTIL-ERROR
 10554        END-IF
 10555     END-IF
 10556
 10557     IF PI-OFFLINE = 'Y'
 10558        GO TO 1110-EDIT-PAID-FROM.
 10559
 10560     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10561     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10562     MOVE '1'                    TO DC-OPTION-CODE.
 10563     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10564
 10565     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10566         MOVE ER-0447            TO EMI-ERROR
 10567         GO TO 1105-HOLDTIL-ERROR.
 10568
 10569     GO TO 1110-EDIT-PAID-FROM.
 10570
 10571 1105-HOLDTIL-ERROR.
 10572     MOVE -1                     TO HOLDTILL.
 10573     MOVE AL-UNBON               TO HOLDTILA.
 10574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10575
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 200
* EL156.cbl
 10577 1110-EDIT-PAID-FROM.
 10578     MOVE AL-UANON               TO EPYFROMA.
 10579
 10580     IF PI-EPYFROM = ZEROS
 10581         GO TO 1120-CALCULATE-PAID-FROM.
 10582
 10583     IF PI-PMTTYPE = '5' OR '6'
 10584         MOVE ER-0448            TO EMI-ERROR
 10585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10586         MOVE AL-UNBON           TO EPYFROMA
 10587         MOVE -1                 TO EPYFROML
 10588         GO TO 1150-EDIT-PAID-THRU.
 10589
 10590     MOVE '4'                    TO DC-OPTION-CODE.
 10591     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10592     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10593
 10594     IF DATE-CONVERSION-ERROR
 10595         MOVE ER-0449            TO EMI-ERROR
 10596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10597         MOVE AL-UNBON           TO EPYFROMA
 10598         MOVE -1                 TO EPYFROML
 10599     ELSE
 10600         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10601
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 201
* EL156.cbl
 10603 1120-CALCULATE-PAID-FROM.
 10604     IF PI-PMTTYPE = '5' OR '6'
 10605         GO TO 1150-EDIT-PAID-THRU.
 10606
 10607*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10608*       IF PI-PMTTYPE = '4'
 10609*         GO TO 1150-EDIT-PAID-THRU.
 10610
 10611     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10612         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10613         MOVE ' '                TO DC-OPTION-CODE
 10614         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10615         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10616         GO TO 1145-TEST-PAID-FROM.
 10617
 10618     IF PI-PMTTYPE = '4'
 10619        GO TO 1150-EDIT-PAID-THRU.
 10620
 10621     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10622     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10623     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10624     MOVE '5'                    TO CNTL-REC-TYPE.
 10625     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10626     MOVE 'BENE'                 TO FILE-SWITCH.
 10627
 10628     IF WS-BEN-CD = ZEROS
 10629         GO TO 1950-NOT-FOUND.
 10630
 10631     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10632
 10633     IF NO-BENEFIT-FOUND
 10634         GO TO 1950-NOT-FOUND.
 10635
 10636     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10637     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10638
 10639     IF PI-BEN-DAYS NOT NUMERIC
 10640        MOVE ZEROS               TO PI-BEN-DAYS.
 10641
 10642     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10643
 10644     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10645        (CL-TOTAL-PAID-AMT > ZEROS)
 10646         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10647         MOVE '6'                 TO DC-OPTION-CODE
 10648         MOVE +0                  TO DC-ELAPSED-MONTHS
 10649         MOVE +1                  TO DC-ELAPSED-DAYS
 10650         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10651         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10652         GO TO 1145-TEST-PAID-FROM.
 10653
 10654******************************************************************
 10655****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10656****** SPECIAL ENTERED DATE.
 10657******************************************************************
 10658
 10659     IF PI-AIGFROM = ZEROS
 10660         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 202
* EL156.cbl
 10661
 10662     MOVE AL-UANON TO AIGFROMA.
 10663
 10664     MOVE '4'                    TO DC-OPTION-CODE.
 10665     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10666     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10667
 10668     IF DATE-CONVERSION-ERROR
 10669         MOVE ER-0449            TO EMI-ERROR
 10670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10671         MOVE AL-UNBON           TO AIGFROMA
 10672         MOVE -1                 TO AIGFROML
 10673         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10674     ELSE
 10675         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10676         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10677
 10678     GO TO 1140-CONTINUE-PAID-FROM.
 10679
 10680 1130-CONTINUE-PAID-FROM.
 10681
 10682     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10683        (CL-TOTAL-PAID-AMT = ZEROS)
 10684           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10685
 10686 1140-CONTINUE-PAID-FROM.
 10687
 10688     IF PI-BEN-TYPE = 'R'
 10689         IF PI-BEN-DAYS = ZEROS
 10690             NEXT SENTENCE
 10691         ELSE
 10692         IF PI-COMPANY-ID NOT = 'DMD'
 10693             SUBTRACT 1 FROM PI-BEN-DAYS.
 10694
 10695     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10696
 10697     IF PI-COMPANY-ID = 'DMD'
 10698         MOVE -1                 TO DC-ELAPSED-DAYS
 10699         MOVE +0                 TO DC-ELAPSED-MONTHS
 10700         MOVE '6'                TO DC-OPTION-CODE
 10701         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10702         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10703         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10704                               REMAINDER DC-ELAPSED-DAYS
 10705      ELSE
 10706         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10707         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10708
 10709     MOVE '6'                    TO DC-OPTION-CODE.
 10710     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10711     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10712
 10713     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10714
 10715     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10716         MOVE ER-0541            TO EMI-ERROR
 10717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10718         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 203
* EL156.cbl
 10719         MOVE AL-UNBON           TO EPYFROMA.
 10720
 10721     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10722        (PI-BENEFIT-SAVE = '60E')
 10723        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10724           (CL-TOTAL-PAID-AMT = ZEROS)
 10725             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10726             MOVE 30                  TO DC-ELAPSED-DAYS
 10727             MOVE +0                  TO DC-ELAPSED-MONTHS
 10728             MOVE '6'                 TO DC-OPTION-CODE
 10729             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10730
 10731     IF PI-BEN-TYPE = 'R'
 10732         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10733     ELSE
 10734         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10735         IF WS-SV-EPYFROM = LOW-VALUES
 10736            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10737
 10738     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10739         IF WS-USE-AIG-PAYFROM   OR
 10740            WS-AIG-RECALC-PAYFROM
 10741              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10742                                      DC-BIN-DATE-1
 10743              MOVE ' '            TO  DC-OPTION-CODE
 10744              MOVE +0             TO  DC-ELAPSED-MONTHS
 10745                                      DC-ELAPSED-DAYS
 10746              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10747              IF NO-CONVERSION-ERROR
 10748                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10749
 10750     IF PI-CPYFROM < CL-INCURRED-DT
 10751        MOVE -1                  TO EPYFROML
 10752        MOVE ER-3542             TO EMI-ERROR
 10753        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10754
 10755     IF CM-ENTRY-DT < CL-INCURRED-DT
 10756        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10757        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10758        MOVE +0                     TO DC-ELAPSED-DAYS
 10759        MOVE +0                     TO DC-ELAPSED-MONTHS
 10760        MOVE '1'                    TO DC-OPTION-CODE
 10761        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10762        ELSE
 10763        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10764
 10765     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10766         NEXT SENTENCE
 10767     ELSE
 10768         IF DC-ELAPSED-MONTHS < 2
 10769             MOVE ER-3255        TO EMI-ERROR
 10770             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10771
 10772 1145-TEST-PAID-FROM.
 10773     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10774         GO TO 1150-EDIT-PAID-THRU.
 10775
 10776     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 204
* EL156.cbl
 10777         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10778         MOVE ' '                TO DC-OPTION-CODE
 10779         MOVE +0                 TO DC-ELAPSED-MONTHS
 10780                                    DC-ELAPSED-DAYS
 10781         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10782         IF NO-CONVERSION-ERROR
 10783             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10784         ELSE
 10785             MOVE SPACES             TO EMI-DATE-FIELD.
 10786
 10787     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10788         IF CL-TOTAL-PAID-AMT = ZEROS
 10789             MOVE ER-3543            TO EMI-ERROR
 10790             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10791             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10792             IF EMI-MESSAGE-FORMATTED
 10793                MOVE -1             TO EPYFROML
 10794                MOVE AL-UNBON       TO EPYFROMA
 10795             ELSE
 10796                NEXT SENTENCE
 10797         ELSE
 10798             MOVE ER-0452            TO EMI-ERROR
 10799             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10800             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10801             IF EMI-MESSAGE-FORMATTED
 10802                MOVE -1             TO EPYFROML
 10803                MOVE AL-UNBON       TO EPYFROMA.
 10804
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 205
* EL156.cbl
 10806 1150-EDIT-PAID-THRU.
 10807
 10808     MOVE AL-UANON               TO EPYTHRUA.
 10809
 10810     IF PI-EPYTHRU = ZEROS
 10811         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10812             GO TO 1200-EDIT-FIND-TOLERANCES
 10813         ELSE
 10814            IF (PI-PMTTYPE = '3') OR
 10815               (PI-PMTTYPE = '2' AND
 10816                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10817               GO TO 1152-CHECK-TYPE
 10818            ELSE
 10819               MOVE ER-0473      TO EMI-ERROR
 10820               GO TO 1170-PAID-THRU-FATAL-ERROR
 10821     ELSE
 10822         IF PI-PMTTYPE = '5' OR '6'
 10823             MOVE ER-0474        TO EMI-ERROR
 10824             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10825
 10826     MOVE '4'                    TO DC-OPTION-CODE.
 10827     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10828     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10829
 10830     IF DATE-CONVERSION-ERROR
 10831         MOVE ER-0475            TO EMI-ERROR
 10832         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10833
 10834     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10835
 10836     IF PI-COMPANY-ID = 'DMD'
 10837         IF PI-PMTTYPE NOT = '2'
 10838                 AND
 10839            WS-EXP-DT > WS-SV-EPYTHRU
 10840             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10841             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10842             MOVE '1'              TO DC-OPTION-CODE
 10843             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10844             IF DATE-CONVERSION-ERROR
 10845                 MOVE ER-0944      TO EMI-ERROR
 10846                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10847             ELSE
 10848                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10849                    DC-ELAPSED-DAYS   = 1
 10850                     MOVE ER-0945  TO EMI-ERROR
 10851                     MOVE -1       TO EPYTHRUL
 10852                     MOVE AL-UABON TO EPYTHRUA
 10853                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10854
 10855     IF PI-PMTTYPE = '4'
 10856         NEXT SENTENCE
 10857     ELSE
 10858         IF WS-SV-EPYTHRU = WS-EXP-DT
 10859             IF PI-PMTTYPE NOT = '2' AND '3'
 10860                 MOVE ER-3541    TO EMI-ERROR
 10861                 MOVE -1         TO PMTTYPEL
 10862                 MOVE AL-UABON   TO PMTTYPEA
 10863                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 206
* EL156.cbl
 10864
 10865     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10866         MOVE ER-0501            TO EMI-ERROR
 10867         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10868
 10869     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10870        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10871*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10872*              MOVE ER-0540         TO EMI-ERROR
 10873*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10874*              MOVE -1              TO EPYTHRUL
 10875*              MOVE AL-UNBON        TO EPYTHRUA
 10876*          ELSE
 10877*          IF PI-COMPANY-ID = 'DMD'
 10878*              MOVE ER-7540         TO EMI-ERROR
 10879*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10880*              MOVE -1              TO EPYTHRUL
 10881*              MOVE AL-UNBON        TO EPYTHRUA
 10882*          ELSE
 10883               IF PI-PMTTYPE NOT = '2' AND '3'
 10884                  IF PI-COMPANY-ID = '???'
 10885                      MOVE ER-7540  TO EMI-ERROR
 10886                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10887                      MOVE -1       TO EPYTHRUL
 10888                      MOVE AL-UNBON TO EPYTHRUA
 10889                  ELSE
 10890                      MOVE ER-0540  TO EMI-ERROR
 10891                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10892                      MOVE -1       TO EPYTHRUL
 10893                      MOVE AL-UNBON TO EPYTHRUA.
 10894
 10895     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10896            OR
 10897        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10898         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10899            OR
 10900        (PI-CPYFROM NOT = LOW-VALUES AND
 10901         PI-CPYFROM < CL-PAID-THRU-DT)
 10902        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10903
 10904 1152-CHECK-TYPE.
 10905     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10906        OR (PI-PMTTYPE = '5' OR '6')
 10907         GO TO 1160-EDIT-PAID-THRU-AH.
 10908
 10909 1155-EDIT-PAID-THRU-LIFE.
 10910     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10911     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10912     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10913     MOVE '4'                    TO CNTL-REC-TYPE.
 10914     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10915     MOVE 'BENE'                 TO FILE-SWITCH.
 10916
 10917     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10918
 10919     IF NO-BENEFIT-FOUND
 10920         GO TO 1950-NOT-FOUND.
 10921
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 207
* EL156.cbl
 10922     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10923
 10924     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10925
 10926     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10927        PI-LF-COVERAGE-TYPE = 'P'
 10928         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10929         GO TO 1200-EDIT-FIND-TOLERANCES.
 10930
 10931     IF PI-EPYTHRU = ZEROS
 10932        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10933
 10934     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10935         MOVE ER-0476            TO EMI-ERROR
 10936         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10937
 10938     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10939*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10940     move cl-critical-period    to dc-elapsed-months
 10941     MOVE +0                    TO DC-ELAPSED-DAYS.
 10942     MOVE '6'                   TO DC-OPTION-CODE.
 10943     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10944
 10945     IF (NO-CONVERSION-ERROR AND
 10946         WS-SPECIAL-CALC-CD = 'C')
 10947        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10948            MOVE ER-0657 TO EMI-ERROR
 10949            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10950
 10951     IF PI-COMPANY-ID = 'NCL'
 10952         IF WS-SPECIAL-CALC-CD = 'C' AND
 10953            cl-critical-period = zeros
 10954*           CM-LF-CRITICAL-PERIOD = +0
 10955             MOVE ER-0844       TO EMI-ERROR
 10956             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10957
 10958     GO TO 1200-EDIT-FIND-TOLERANCES.
 10959
 10960 1160-EDIT-PAID-THRU-AH.
 10961     IF PI-EPYTHRU = ZEROS
 10962        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10963                                    WS-SV-EPYTHRU
 10964     ELSE
 10965        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10966
 10967     IF WS-SV-EPYTHRU < PI-CPYFROM
 10968         MOVE ER-0508            TO EMI-ERROR
 10969         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10970
 10971     perform 7975-read-acct      thru 7975-exit
 10972     move zeros                  to pi-max-ext
 10973     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10974        PERFORM 0900-GET-DDF-LIMITS
 10975                                 THRU 0900-EXIT
 10976        IF PDEF-FOUND
 10977           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10978              (P1 > +8)
 10979              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 208
* EL156.cbl
 10980           END-PERFORM
 10981           IF P1 < +9
 10982              MOVE PD-MAX-extension (P1)
 10983                                 TO pi-max-ext
 10984           else
 10985              move er-1674       to emi-error
 10986              PERFORM 9900-ERROR-FORMAT
 10987                                 THRU 9900-EXIT
 10988           END-IF
 10989        else
 10990           move er-1672          to emi-error
 10991           PERFORM 9900-ERROR-FORMAT
 10992                                 THRU 9900-EXIT
 10993        END-IF
 10994     end-if
 10995     move spaces                 to pi-max-ext-used
 10996     IF PI-PMTTYPE = '3'
 10997        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10998        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10999           MOVE ER-0477          TO EMI-ERROR
 11000           PERFORM 1165-PAID-THRU-ERROR
 11001                                 THRU 1165-EXIT
 11002        ELSE
 11003           continue
 11004        end-if
 11005     ELSE
 11006        IF WS-SV-EPYTHRU > WS-EXP-DT
 11007           move ws-exp-dt        to dc-bin-date-1
 11008           move ws-sv-epythru    to dc-bin-date-2
 11009           MOVE '1'              TO DC-OPTION-CODE
 11010           MOVE +0               TO DC-ELAPSED-DAYS
 11011                                    DC-ELAPSED-MONTHS
 11012           PERFORM 9700-LINK-DATE-CONVERT
 11013                                 THRU 9700-EXIT
 11014           if no-conversion-error
 11015              if dc-elapsed-days > zeros
 11016                 add +1 to dc-elapsed-months
 11017              end-if
 11018              if dc-elapsed-months > pi-max-ext
 11019                 MOVE ER-0557    TO EMI-ERROR
 11020                 PERFORM 1165-PAID-THRU-ERROR
 11021                                 THRU 1165-EXIT
 11022              else
 11023                 move 'Y'        to pi-max-ext-used
 11024                 move er-1670    to emi-error
 11025                 perform 9900-error-format
 11026                                 thru 9900-exit
 11027              end-if
 11028           end-if
 11029        end-if
 11030     end-if
 11031
 11032     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11033         PI-PMTTYPE NOT = '3'
 11034         MOVE ER-0541        TO EMI-ERROR
 11035         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11036
 11037     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 209
* EL156.cbl
 11038        (PI-PMTTYPE NOT = '3')
 11039         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11040             MOVE ER-0478        TO EMI-ERROR
 11041             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11042
 11043     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11044        (PI-PMTTYPE NOT = '4')
 11045         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11046             MOVE ER-0479        TO EMI-ERROR
 11047             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11048
 11049     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11050         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11051             MOVE ER-0545        TO EMI-ERROR
 11052             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11053
 11054     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11055         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11056             MOVE ER-0481        TO EMI-ERROR
 11057             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11058
 11059*    IF PI-COMPANY-ID = 'NCL'
 11060*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11061*           CM-AH-CRITICAL-PERIOD = +0
 11062*            MOVE ER-0844        TO  EMI-ERROR
 11063*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11064
 11065*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11066     if (cl-critical-period = zeros)
 11067        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11068          GO TO 1200-EDIT-FIND-TOLERANCES.
 11069
 11070     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11071     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11072     MOVE '1'        TO DC-OPTION-CODE.
 11073     MOVE +0         TO DC-ELAPSED-DAYS
 11074                        DC-ELAPSED-MONTHS.
 11075     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11076
 11077*    IF NO-CONVERSION-ERROR
 11078*       COMPUTE ws-benefits-paid =
 11079*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11080*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11081*           MOVE ER-0657 TO EMI-ERROR
 11082*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11083
 11084     GO TO 1200-EDIT-FIND-TOLERANCES.
 11085
 11086 1165-PAID-THRU-ERROR.
 11087     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11088
 11089     IF EMI-MESSAGE-FORMATTED
 11090         MOVE -1                 TO EPYTHRUL
 11091         MOVE AL-UNBON           TO EPYTHRUA.
 11092
 11093 1165-EXIT.
 11094     EXIT.
 11095
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 210
* EL156.cbl
 11096 1166-CHECK-ALL-TRLRS.
 11097
 11098     IF PI-PMTTYPE = '4'
 11099        GO TO 1166-TRLR-EXIT.
 11100
 11101     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11102
 11103     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11104        WS-SV-EPYFROM = LOW-VALUES
 11105          GO TO 1166-END-CHECK.
 11106
 11107
 11108* EXEC CICS HANDLE CONDITION
 11109*        ENDFILE   (1166-END-CHECK)
 11110*        NOTFND    (1166-END-CHECK)
 11111*    END-EXEC.
 11112*    MOVE '"$''I                  ! ) #00010691' TO DFHEIV0
 11113     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11115     MOVE X'2920233030303130363931' TO DFHEIV0(25:11)
 11116     CALL 'kxdfhei1' USING DFHEIV0
 11117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11118
 11119
 11120     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11121     MOVE +100                   TO TRLR-SEQ-NO.
 11122
 11123
 11124* EXEC CICS STARTBR
 11125*         DATASET    ('ELTRLR')
 11126*         RIDFLD     (ELTRLR-KEY)
 11127*         GTEQ
 11128*    END-EXEC.
 11129     MOVE 'ELTRLR' TO DFHEIV1
 11130     MOVE 0
 11131       TO DFHEIV11
 11132*    MOVE '&,         G          &   #00010699' TO DFHEIV0
 11133     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11134     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11135     MOVE X'2020233030303130363939' TO DFHEIV0(25:11)
 11136     CALL 'kxdfhei1' USING DFHEIV0,
 11137           DFHEIV1,
 11138           ELTRLR-KEY,
 11139           DFHEIV99,
 11140           DFHEIV11,
 11141           DFHEIV99
 11142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11143
 11144
 11145     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11146
 11147 1166-READ-TRLR-NEXT.
 11148
 11149
 11150* EXEC CICS READNEXT
 11151*         DATASET    ('ELTRLR')
 11152*         RIDFLD     (ELTRLR-KEY)
 11153*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 211
* EL156.cbl
 11154*    END-EXEC.
 11155     MOVE 'ELTRLR' TO DFHEIV1
 11156     MOVE 0
 11157       TO DFHEIV11
 11158*    MOVE '&.S                   )   #00010709' TO DFHEIV0
 11159     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11160     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11161     MOVE X'2020233030303130373039' TO DFHEIV0(25:11)
 11162     CALL 'kxdfhei1' USING DFHEIV0,
 11163           DFHEIV1,
 11164           DFHEIV20,
 11165           DFHEIV99,
 11166           ELTRLR-KEY,
 11167           DFHEIV99,
 11168           DFHEIV11,
 11169           DFHEIV99,
 11170           DFHEIV99
 11171     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11172         DFHEIV20
 11173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11174
 11175
 11176     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11177        TRLR-CARRIER  = MSTR-CARRIER  AND
 11178        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11179        TRLR-CERT-NO  = MSTR-CERT-NO
 11180          NEXT SENTENCE
 11181      ELSE
 11182          GO TO 1166-END-CHECK.
 11183
 11184* **  BYPASS ALL NON-PAYMENT TRAILERS
 11185
 11186     IF AT-TRAILER-TYPE = '2'
 11187        NEXT SENTENCE
 11188     ELSE
 11189        GO TO 1166-READ-TRLR-NEXT.
 11190
 11191* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11192
 11193     IF AT-PAYMENT-TYPE = '1' OR '2'
 11194        NEXT SENTENCE
 11195     ELSE
 11196        GO TO 1166-READ-TRLR-NEXT.
 11197
 11198* **  BYPASS ALL VOID PAYMENTS
 11199
 11200     IF AT-VOID-DT NOT = LOW-VALUES
 11201        GO TO 1166-READ-TRLR-NEXT.
 11202
 11203     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11204        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11205          GO TO 1166-READ-TRLR-NEXT.
 11206
 11207     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11208         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11209            OR
 11210        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11211         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 212
* EL156.cbl
 11212        NEXT SENTENCE
 11213     ELSE
 11214         IF CL-TOTAL-PAID-AMT > ZEROS
 11215             MOVE ER-0502            TO EMI-ERROR
 11216             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11217             MOVE -1                 TO EPYTHRUL
 11218             MOVE AL-UNBON           TO EPYTHRUA.
 11219
 11220     GO TO 1166-READ-TRLR-NEXT.
 11221
 11222 1166-END-CHECK.
 11223
 11224     IF WS-BROWSE-TRLR-SW = 'Y'
 11225
 11226* EXEC CICS ENDBR
 11227*            DATASET   ('ELTRLR')
 11228*       END-EXEC.
 11229     MOVE 'ELTRLR' TO DFHEIV1
 11230     MOVE 0
 11231       TO DFHEIV11
 11232*    MOVE '&2                    $   #00010764' TO DFHEIV0
 11233     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11234     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11235     MOVE X'2020233030303130373634' TO DFHEIV0(25:11)
 11236     CALL 'kxdfhei1' USING DFHEIV0,
 11237           DFHEIV1,
 11238           DFHEIV11,
 11239           DFHEIV99
 11240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11241
 11242
 11243     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11244
 11245 1166-TRLR-EXIT.
 11246     EXIT.
 11247
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 213
* EL156.cbl
 11249 1170-PAID-THRU-FATAL-ERROR.
 11250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11251
 11252     MOVE -1                     TO EPYTHRUL.
 11253     MOVE AL-UNBON               TO EPYTHRUA.
 11254
 11255 1200-EDIT-FIND-TOLERANCES.
 11256
 11257* EXEC CICS HANDLE CONDITION
 11258*        ENDFILE(1950-NOT-FOUND)
 11259*        NOTFND (1950-NOT-FOUND)
 11260*    END-EXEC.
 11261*    MOVE '"$''I                  ! * #00010781' TO DFHEIV0
 11262     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11264     MOVE X'2A20233030303130373831' TO DFHEIV0(25:11)
 11265     CALL 'kxdfhei1' USING DFHEIV0
 11266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11267
 11268
 11269     IF PI-PROCESSOR-ID = 'LGXX'
 11270        GO TO 1240-FIND-ACCT-TOLERANCES.
 11271
 11272     MOVE 'N'                    TO FOUND-TOL-SW.
 11273     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11274     MOVE '2'                    TO CNTL-REC-TYPE.
 11275     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11276     MOVE +0                     TO CNTL-SEQ-NO.
 11277     MOVE 'PROC'                 TO FILE-SWITCH.
 11278
 11279     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11280
 11281     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11282     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11283                                    PI-MAX-PMT-TOL.
 11284     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11285
 11286     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11287         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11288
 11289     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11290     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11291                                    PI-MAX-LF-PMT-TOL.
 11292
 11293     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11294         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11295
 11296     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11297                                    PI-MAX-EXP-PMT.
 11298
 11299 1240-FIND-ACCT-TOLERANCES.
 11300
 11301     IF WS-PMT-TOL NOT = +0
 11302         MOVE 'Y'                TO FOUND-TOL-SW.
 11303
 11304     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11305         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11306         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 214
* EL156.cbl
 11307         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11308         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11309         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11310         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11311     ELSE
 11312         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11313         MOVE PI-CARRIER             TO ACCT-CARRIER
 11314         MOVE PI-GROUPING            TO ACCT-GROUPING
 11315         MOVE PI-STATE               TO ACCT-STATE
 11316         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11317         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11318
 11319     MOVE 'ACCT'                 TO FILE-SWITCH.
 11320
 11321     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11322     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11323
 11324
 11325* EXEC CICS HANDLE CONDITION
 11326*         NOTFND   (1950-NOT-FOUND)
 11327*         ENDFILE  (1950-NOT-FOUND)
 11328*    END-EXEC.
 11329*    MOVE '"$I''                  ! + #00010841' TO DFHEIV0
 11330     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11332     MOVE X'2B20233030303130383431' TO DFHEIV0(25:11)
 11333     CALL 'kxdfhei1' USING DFHEIV0
 11334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11335
 11336
 11337
 11338* EXEC CICS STARTBR
 11339*        DATASET('ERACCT')
 11340*        RIDFLD (ERACCT-KEY)
 11341*        GTEQ
 11342*    END-EXEC.
 11343     MOVE 'ERACCT' TO DFHEIV1
 11344     MOVE 0
 11345       TO DFHEIV11
 11346*    MOVE '&,         G          &   #00010846' TO DFHEIV0
 11347     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11348     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11349     MOVE X'2020233030303130383436' TO DFHEIV0(25:11)
 11350     CALL 'kxdfhei1' USING DFHEIV0,
 11351           DFHEIV1,
 11352           ERACCT-KEY,
 11353           DFHEIV99,
 11354           DFHEIV11,
 11355           DFHEIV99
 11356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11357
 11358
 11359 1245-FIND-ACCT-TOLERANCES-LOOP.
 11360
 11361
 11362* EXEC CICS READNEXT
 11363*        DATASET('ERACCT')
 11364*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 215
* EL156.cbl
 11365*        RIDFLD (ERACCT-KEY)
 11366*    END-EXEC.
 11367     MOVE 'ERACCT' TO DFHEIV1
 11368     MOVE 0
 11369       TO DFHEIV11
 11370*    MOVE '&.S                   )   #00010854' TO DFHEIV0
 11371     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11372     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11373     MOVE X'2020233030303130383534' TO DFHEIV0(25:11)
 11374     CALL 'kxdfhei1' USING DFHEIV0,
 11375           DFHEIV1,
 11376           DFHEIV20,
 11377           DFHEIV99,
 11378           ERACCT-KEY,
 11379           DFHEIV99,
 11380           DFHEIV11,
 11381           DFHEIV99,
 11382           DFHEIV99
 11383     SET ADDRESS OF ACCOUNT-MASTER TO
 11384         DFHEIV20
 11385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11386
 11387
 11388     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11389        IF WS-ERACCT-HOLD-RECORD = SPACES
 11390           GO TO 1950-NOT-FOUND
 11391        ELSE
 11392           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11393           GO TO 1250-CONTINUE.
 11394
 11395     IF ACCT-EXP-DT = HIGH-VALUES
 11396        NEXT SENTENCE
 11397     ELSE
 11398        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11399        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11400
 11401 1250-CONTINUE.
 11402
 11403     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11404
 11405     IF FOUND-TOL-SW = 'N'
 11406         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11407
 11408********* 1260-FIND-STATE-TOLERANCES.
 11409
 11410     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11411     MOVE PI-STATE               TO WS-ST-ACCESS.
 11412     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11413     MOVE '3'                    TO CNTL-REC-TYPE.
 11414     MOVE +0                     TO CNTL-SEQ-NO.
 11415     MOVE 'STAT'                 TO FILE-SWITCH.
 11416
 11417     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11418
 11419     IF WS-PMT-TOL = +0
 11420         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11421
 11422     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 216
* EL156.cbl
 11423     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11424     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11425     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11426     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11427
 11428****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11429****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11430     IF PI-PAYEE-TYPE <> 'B'
 11431           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11432     END-IF.
 11433
 11434     IF PI-PMTTYPE      = '2'  AND
 11435        PI-SPLIT-PMT-SW = 'Y'  AND
 11436        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11437          MOVE ER-3530                TO EMI-ERROR
 11438          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11439
 11440********* 1280-FIND-BENEFIT-TOLERANCES.
 11441
 11442     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11443        OR (PI-PMTTYPE = '5' OR '6')
 11444         GO TO 1300-FIND-CARR-TOLERANCES.
 11445
 11446     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11447     MOVE '4'                    TO CNTL-REC-TYPE.
 11448     MOVE +0                     TO CNTL-SEQ-NO.
 11449     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11450     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11451     MOVE 'BENE'                 TO FILE-SWITCH.
 11452
 11453     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11454
 11455     IF NO-BENEFIT-FOUND
 11456         GO TO 1950-NOT-FOUND.
 11457
 11458     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11459     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11460     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11461
 11462
 11463* EXEC CICS HANDLE CONDITION
 11464*        NOTFND(1950-NOT-FOUND)
 11465*    END-EXEC.
 11466*    MOVE '"$I                   ! , #00010934' TO DFHEIV0
 11467     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11469     MOVE X'2C20233030303130393334' TO DFHEIV0(25:11)
 11470     CALL 'kxdfhei1' USING DFHEIV0
 11471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11472
 11473
 11474 1300-FIND-CARR-TOLERANCES.
 11475     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11476     MOVE '6'                    TO CNTL-REC-TYPE.
 11477
 11478     IF CONTROL-IS-ACTUAL-CARRIER
 11479         MOVE PI-CARRIER               TO WS-CARR
 11480     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 217
* EL156.cbl
 11481         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11482
 11483     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11484     MOVE +0                     TO CNTL-SEQ-NO.
 11485     MOVE 'CARR'                 TO FILE-SWITCH.
 11486
 11487     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11488
 11489     IF WS-DAYS-TOL = +0
 11490         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11491
 11492     IF WS-PMT-TOL = +0
 11493         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11494
 11495     IF WS-MAX-DAYS-TOL = +0
 11496         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11497
 11498     IF WS-MAX-PMT-TOL = +0
 11499         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11500                                    PI-MAX-PMT-TOL.
 11501
 11502     IF WS-MAX-LF-PMT-TOL = +0
 11503        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11504                                    PI-MAX-LF-PMT-TOL.
 11505
 11506     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11507
 11508********* 1320-FIND-COMP-TOLERANCES.
 11509
 11510     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11511     MOVE '1'                    TO CNTL-REC-TYPE.
 11512     MOVE SPACES                 TO CNTL-ACCESS.
 11513     MOVE +0                     TO CNTL-SEQ-NO.
 11514     MOVE 'COMP'                 TO FILE-SWITCH.
 11515
 11516     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11517
 11518     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11519     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11520
 11521     IF WS-PMT-TOL NOT = +0
 11522        IF WS-TOL-SEVERITY NOT = ' '
 11523         GO TO 1360-EDIT-DAYS.
 11524
 11525     IF WS-PMT-TOL = +0
 11526         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11527
 11528     IF WS-TOL-SEVERITY = ' '
 11529         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11530
 11531 1360-EDIT-DAYS.
 11532     IF PI-PMTTYPE NOT = '4'
 11533        IF PI-EDAYS NEGATIVE OR
 11534           PI-EPYAMT NEGATIVE
 11535          MOVE ER-0513             TO EMI-ERROR
 11536          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537          MOVE -1                  TO PMTTYPEL.
 11538
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 218
* EL156.cbl
 11539     IF PI-PMTTYPE = '5' OR '6'
 11540        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11541
 11542     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11543        IF PI-PMTTYPE = '4'
 11544          MOVE PI-EDAYS          TO PI-CDAYS.
 11545
 11546     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11547         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11548
 11549     IF PI-PMTTYPE = '4'
 11550        MOVE PI-EDAYS            TO PI-CDAYS
 11551        GO TO 1400-EDIT-PAYMENT.
 11552
 11553     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11554        GO TO 1500-EDIT-EXPENSES.
 11555
 11556*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11557*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11558*          CM-AH-BENEFIT-CD = '23'              AND
 11559*          CL-CERT-STATE    = '04'              AND
 11560*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11561*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11562*            GO TO 1362-CHECK-MAX-DAYS.
 11563
 11564     IF PI-EDAYS = ZEROS
 11565*        IF PI-COMPANY-ID = 'DMD'
 11566*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11567*            MOVE -1             TO DC-ELAPSED-DAYS
 11568*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11569*            MOVE '6'            TO DC-OPTION-CODE
 11570*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11571*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11572*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11573*            MOVE '1'            TO DC-OPTION-CODE
 11574*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11575*            IF NO-CONVERSION-ERROR
 11576*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11577*                                 + DC-ODD-DAYS-OVER
 11578*               MOVE 6           TO EDAYSL
 11579*               MOVE AL-UNNON    TO EDAYSA
 11580*            ELSE
 11581*                NEXT SENTENCE
 11582*       ELSE
 11583            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11584            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11585            MOVE '1'             TO DC-OPTION-CODE
 11586            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11587            IF NO-CONVERSION-ERROR
 11588                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11589                ADD 1                 TO PI-EDAYS
 11590                MOVE AL-UNNON         TO EDAYSA.
 11591
 11592*    IF PI-COMPANY-ID = 'DMD'
 11593*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11594*        MOVE -1                 TO DC-ELAPSED-DAYS
 11595*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11596*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 219
* EL156.cbl
 11597*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11598*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11599*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11600*        MOVE '1'                TO DC-OPTION-CODE
 11601*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11602*    ELSE
 11603         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11604         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11605         MOVE '1'                TO DC-OPTION-CODE.
 11606         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11607
 11608     IF NO-CONVERSION-ERROR
 11609        IF PI-COMPANY-ID = 'DMD'
 11610            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11611                             + DC-ODD-DAYS-OVER
 11612        ELSE
 11613            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11614            ADD 1                TO PI-CDAYS.
 11615
 11616     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11617        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11618        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11619
 11620     IF PI-EDAYS NOT NUMERIC
 11621         MOVE ER-0491            TO EMI-ERROR
 11622         GO TO 1370-DAYS-ERROR.
 11623
 11624     IF CL-NO-OF-PMTS-MADE = 0
 11625        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11626        AND CL-CERT-STATE = 'MI'
 11627        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11628            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11629     END-IF.
 11630
 11631 1362-CHECK-MAX-DAYS.
 11632
 11633     IF WS-MAX-DAYS-TOL = +999
 11634         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11635
 11636     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11637         IF PI-EDAYS = ZEROS
 11638             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11639         ELSE
 11640             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11641
 11642     IF WS-MAX-DAYS-TOL NOT = ZERO
 11643        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11644           PI-CDAYS > WS-MAX-DAYS-TOL
 11645             MOVE ER-0492          TO EMI-ERROR
 11646             GO TO 1370-DAYS-ERROR.
 11647
 11648 1365-SKIP-MAX-DAYS-EDIT.
 11649     IF PI-EDAYS = ZEROS
 11650        GO TO 1400-EDIT-PAYMENT.
 11651
 11652     IF WS-DAYS-TOL NOT = ZERO
 11653        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11654           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 220
* EL156.cbl
 11655                MOVE ER-0493     TO EMI-ERROR
 11656                GO TO 1370-DAYS-ERROR.
 11657
 11658     GO TO 1400-EDIT-PAYMENT.
 11659
 11660 1370-DAYS-ERROR.
 11661     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11662
 11663     IF EMI-MESSAGE-FORMATTED
 11664         MOVE -1                 TO EDAYSL
 11665         MOVE AL-UABON           TO EDAYSA.
 11666
 11667     GO TO 1400-EDIT-PAYMENT.
 11668
 11669 1380-EDIT-EXPENSE-PMT-AMT.
 11670     IF PI-PMTTYPE = '5' OR '6'
 11671         NEXT SENTENCE
 11672     ELSE
 11673         GO TO 1400-EDIT-PAYMENT.
 11674
 11675     IF WS-MAX-EXP-PMT NOT = ZEROS
 11676        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11677            MOVE ER-3529            TO EMI-ERROR
 11678            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11679
 11680     GO TO 1500-EDIT-EXPENSES.
 11681
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 221
* EL156.cbl
 11683
 11684 1390-CHECK-PAYMENT-DAYS.
 11685
 11686     IF PI-EDAYS = 0
 11687         MOVE PI-CDAYS TO WS-PD-DAYS
 11688     ELSE
 11689         MOVE PI-EDAYS TO WS-PD-DAYS
 11690     END-IF.
 11691
 11692     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11693         IF WS-PD-DAYS = 14
 11694            GO TO 1390-EXIT
 11695         END-IF
 11696     END-IF.
 11697
 11698     IF PI-COMPANY-ID = 'AHL'  AND
 11699        CM-AH-BENEFIT-CD = '1K'
 11700         IF WS-PD-DAYS = 14
 11701            GO TO 1390-EXIT
 11702         END-IF
 11703     END-IF.
 11704
 11705     IF WS-PD-DAYS < 30
 11706         MOVE ER-3549              TO EMI-ERROR
 11707         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11708     END-IF.
 11709
 11710 1390-EXIT.
 11711      EXIT.
 11712
 11713 1400-EDIT-PAYMENT.
 11714*    IF PI-COMPANY-ID = 'DMD'
 11715*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11716*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11717
 11718     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 11719        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11720        MOVE PI-CARRIER          TO ACCT-CARRIER
 11721        MOVE PI-GROUPING         TO ACCT-GROUPING
 11722        MOVE PI-STATE            TO ACCT-STATE
 11723        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11724        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11725        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11726        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11727
 11728
 11729* EXEC CICS READ
 11730*          DATASET ('ERACCT')
 11731*          RIDFLD  (ERACCT-KEY)
 11732*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11733*          GTEQ
 11734*          resp    (WS-RESPONSE)
 11735*       END-EXEC
 11736     MOVE 'ERACCT' TO DFHEIV1
 11737*    MOVE '&"S        G          (  N#00011192' TO DFHEIV0
 11738     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11740     MOVE X'204E233030303131313932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 222
* EL156.cbl
 11741     CALL 'kxdfhei1' USING DFHEIV0,
 11742           DFHEIV1,
 11743           DFHEIV20,
 11744           DFHEIV99,
 11745           ERACCT-KEY,
 11746           DFHEIV99,
 11747           DFHEIV99,
 11748           DFHEIV99
 11749     SET ADDRESS OF ACCOUNT-MASTER TO
 11750         DFHEIV20
 11751     MOVE EIBRESP  TO WS-RESPONSE
 11752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11753        IF WS-RESP-NORMAL
 11754           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11755           and pi-cert-eff-dt < am-expiration-dt
 11756           and pi-cert-eff-dt >= am-effective-dt
 11757           move am-dcc-product-code to pi-dcc-product-code
 11758        else
 11759           move spaces           to pi-dcc-product-code
 11760        end-if
 11761        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11762           PERFORM 0900-GET-DDF-LIMITS
 11763                                 THRU 0900-EXIT
 11764           IF PDEF-FOUND
 11765              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11766                 (P1 > +8)
 11767                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11768              END-PERFORM
 11769              IF P1 < +9
 11770                 if pd-ben-pct (p1) not numeric
 11771                    move zeros   to pd-ben-pct (p1)
 11772                 end-if
 11773                 if pd-ben-pct (p1) = zeros
 11774                    move +1      to ws-work-ben-pct
 11775                 else
 11776                    move pd-ben-pct (p1)
 11777                                 to ws-work-ben-pct
 11778                 end-if
 11779                 compute cm-ah-benefit-amt =
 11780                    cm-ah-benefit-amt * ws-work-ben-pct
 11781                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11782                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11783                 end-if
 11784              else
 11785                 move er-1674    to emi-error
 11786                 PERFORM 9900-ERROR-FORMAT
 11787                                 THRU 9900-EXIT
 11788              END-IF
 11789           else
 11790              move er-1672       to emi-error
 11791              PERFORM 9900-ERROR-FORMAT
 11792                                 THRU 9900-EXIT
 11793           END-IF
 11794        end-if
 11795     END-IF
 11796     IF PI-PMTTYPE NOT = '4'
 11797        GO TO 1405-CALC-PAYMENT.
 11798     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 223
* EL156.cbl
 11799         MOVE PI-EPYAMT           TO PI-CPYAMT
 11800         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11801         GO TO 1430-CHECK-AH-TOLERANCE.
 11802
 11803*    IF PI-COMPANY-ID = 'FIA'
 11804*       IF CERT-ACCOUNT = '0000011043'
 11805*        COMPUTE PI-DAILY-RATE ROUNDED =
 11806*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11807*        COMPUTE PI-CPYAMT ROUNDED =
 11808*                          PI-DAILY-RATE * PI-EDAYS
 11809*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11810*        GO TO 1430-CHECK-AH-TOLERANCE.
 11811
 11812     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11813         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11814         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11815         GO TO 1420-CHECK-AIG-BENEFIT.
 11816
 11817     IF WS-CALC-METHOD = '2' OR  '5'
 11818         COMPUTE PI-DAILY-RATE ROUNDED =
 11819                        (CM-AH-BENEFIT-AMT * 12) / 365
 11820         COMPUTE PI-CPYAMT ROUNDED =
 11821                           PI-DAILY-RATE * PI-EDAYS
 11822        GO TO 1420-CHECK-AIG-BENEFIT.
 11823
 11824     IF WS-CALC-METHOD = '3'
 11825         COMPUTE PI-DAILY-RATE =
 11826                         (CM-AH-BENEFIT-AMT * 12) / 365
 11827         COMPUTE PI-CPYAMT ROUNDED =
 11828                           PI-DAILY-RATE * PI-EDAYS
 11829        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 224
* EL156.cbl
 11831*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11832
 11833****************************************************************
 11834****************************************************************
 11835*                  CALCULATED FROM      PAYMENT      PAYMENT
 11836*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11837* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11838*1-01-83  1-15-83    0    15     15        15           15
 11839*1-01-83  1-30-83    0    30     30        30           30
 11840*1-01-83  1-31-83    1     0     31        30           30
 11841*1-01-83  2-01-83    1     1     32        31           31
 11842*1-01-83  2-15-83    1    15     46        45           45
 11843*1-01-83  2-28-83    2     0     59        60           60
 11844*1-01-83  3-01-83    2     1     60        61           61
 11845*1-01-83  3-31-83    3     0     90        90           90
 11846*1-15-83  1-31-83    0    17     17        17           16
 11847*1-15-83  2-01-83    0    18     18        18           17
 11848*1-15-83  2-28-83    1    14     45        44           46
 11849*1-21-83  3-09-83    1    20     48        50           49
 11850*2-05-83  3-06-83    1     2     30        32           32
 11851*2-05-83  3-23-83    1    19     47        49           49
 11852*2-15-83  2-28-83    0    14     14        14           16
 11853*2-15-83  3-01-83    0    15     15        15           17
 11854*2-21-83  3-19-83    0    27     27        27           29
 11855*2-21-83  3-20-83    1     0     28        30           30
 11856*2-21-83  4-10-83    1    18     49        30           50
 11857*2-21-83  5-19-83    2    27     88        87           89
 11858*2-21-83  5-22-83    3     2     91        92           92
 11859*3-21-83  5-19-83    1    30     60        60           59
 11860****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 225
* EL156.cbl
 11862 1405-CALC-PAYMENT.
 11863     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11864     MOVE ' '                    TO DC-OPTION-CODE.
 11865     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11866     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11867     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11868
 11869     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11870     MOVE ' '                    TO DC-OPTION-CODE.
 11871     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11872     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11873     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11874
 11875     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11876     MOVE -1                     TO DC-ELAPSED-DAYS.
 11877     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11878     MOVE '6'                    TO DC-OPTION-CODE.
 11879     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11880     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11881
 11882     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11883     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11884     MOVE '1'                    TO DC-OPTION-CODE.
 11885     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11886
 11887     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11888     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11889     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11890
 11891******************************************************************
 11892*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11893*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11894*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11895******************************************************************
 11896
 11897     IF WS-CALC-METHOD = '1'           AND
 11898        DC-ELAPSED-MONTHS > ZERO AND
 11899        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11900        WDF-DAY > WDT-DAY
 11901          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11902          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11903          MOVE -1                  TO DC-ELAPSED-MONTHS
 11904          MOVE '6'                 TO DC-OPTION-CODE
 11905          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11906          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11907          COMPUTE WS-SAVE-ODD-DAYS =
 11908          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11909          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11910
 11911     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11912     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11913     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11914
 11915     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11916     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11917
 11918*    IF PI-COMPANY-ID = 'FIA'
 11919*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 226
* EL156.cbl
 11920*        COMPUTE PI-DAILY-RATE ROUNDED =
 11921*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11922*        COMPUTE PI-CPYAMT ROUNDED =
 11923*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11924*        GO TO 1420-CHECK-AIG-BENEFIT.
 11925
 11926*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11927*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11928*          CM-AH-BENEFIT-CD = '23'               AND
 11929*          CL-CERT-STATE    = '04'               AND
 11930*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11931*            COMPUTE WS-DAILY-RATE ROUNDED =
 11932*                               CM-AH-BENEFIT-AMT / 30
 11933*            COMPUTE PI-CPYAMT ROUNDED =
 11934*                               (WS-DAILY-RATE * PI-CDAYS)
 11935*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11936*            GO TO 1420-CHECK-AIG-BENEFIT.
 11937
 11938     IF WS-CALC-METHOD = '1'
 11939         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11940         COMPUTE PI-CPYAMT ROUNDED =
 11941             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11942             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11943         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11944         GO TO 1420-CHECK-AIG-BENEFIT.
 11945
 11946     IF WS-CALC-METHOD = '2'
 11947         COMPUTE PI-DAILY-RATE ROUNDED =
 11948                          (CM-AH-BENEFIT-AMT * 12) / 365
 11949         COMPUTE PI-CPYAMT ROUNDED =
 11950             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11951             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11952         GO TO 1420-CHECK-AIG-BENEFIT.
 11953
 11954     IF WS-CALC-METHOD = '4'
 11955         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11956         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11957         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11958         COMPUTE PI-CPYAMT ROUNDED =
 11959                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11960         GO TO 1420-CHECK-AIG-BENEFIT.
 11961
 11962     IF WS-CALC-METHOD = '5'
 11963         COMPUTE PI-DAILY-RATE ROUNDED =
 11964                            (CM-AH-BENEFIT-AMT * 12) / 365
 11965         COMPUTE PI-CPYAMT ROUNDED =
 11966                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11967         GO TO 1420-CHECK-AIG-BENEFIT.
 11968
 11969     IF WS-CALC-METHOD NOT = '3'
 11970        GO TO 1410-CHECK-PAYMENT.
 11971
 11972******   CALCULATION METHOD  3  ROUTINE
 11973     COMPUTE PI-DAILY-RATE =
 11974                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11975
 11976******CHECK TO SEE IF WITHIN SAME MONTH
 11977     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 227
* EL156.cbl
 11978        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11979                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11980         GO TO 1420-CHECK-AIG-BENEFIT.
 11981
 11982******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11983     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11984             SAVE-ODD-DAYS-OVER = ZEROS
 11985      COMPUTE PI-CPYAMT  ROUNDED =
 11986                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11987      GO TO 1420-CHECK-AIG-BENEFIT.
 11988
 11989******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11990******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11991     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11992        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11993        IF WDF-MONTH > 12
 11994           ADD 1                 TO WDF-YEAR
 11995           SUBTRACT 12         FROM WDF-MONTH.
 11996
 11997******CONVERT THE NEW FROM MONTH TO BINARY
 11998     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11999        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12000        MOVE '4'              TO DC-OPTION-CODE
 12001        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12002        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12003
 12004     IF WDF-MONTH = WDT-MONTH AND
 12005        WDF-YEAR  = WDT-YEAR
 12006          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12007                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12008                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12009        ELSE
 12010          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12011          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12012          COMPUTE PI-CPYAMT ROUNDED =
 12013       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12014       +
 12015       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12016       +
 12017       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12018
 12019     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 228
* EL156.cbl
 12021 1410-CHECK-PAYMENT.
 12022******PAYMENT OPTION 6
 12023******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12024     IF SAVE-ELAPSED-MONTHS > ZERO
 12025        IF SAVE-ODD-DAYS-OVER = ZEROS
 12026           GO TO 1412-CHECK-TO-DAY
 12027        ELSE
 12028           IF WDF-DAY > WDT-DAY
 12029              IF WDF-MONTH = 02
 12030                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12031                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12032                  GO TO 1412-CHECK-TO-DAY
 12033              ELSE
 12034                  IF FROM-DAYS-IN-MONTH = 31
 12035                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12036                     GO TO 1412-CHECK-TO-DAY
 12037                  ELSE
 12038                     GO TO 1412-CHECK-TO-DAY
 12039           ELSE
 12040               GO TO 1412-CHECK-TO-DAY.
 12041
 12042     IF WDF-MONTH NOT = WDT-MONTH
 12043        IF WDF-MONTH = 02
 12044           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12045           IF WDF-DAY = 29
 12046              ADD 1              TO SAVE-ODD-DAYS-OVER
 12047           ELSE
 12048              ADD 2              TO SAVE-ODD-DAYS-OVER
 12049        ELSE
 12050           IF FROM-DAYS-IN-MONTH = 31
 12051              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12052
 12053 1412-CHECK-TO-DAY.
 12054        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12055           IF WDT-DAY = 28
 12056              ADD 2              TO SAVE-ODD-DAYS-OVER
 12057           ELSE
 12058              IF WDT-DAY = 29
 12059                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12060              ELSE
 12061                 NEXT SENTENCE
 12062        ELSE
 12063           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12064              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12065
 12066     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12067     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12068     COMPUTE PI-CPYAMT ROUNDED =
 12069         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12070         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12071
 12072     GO TO 1420-CHECK-AIG-BENEFIT.
 12073
 12074 1415-CHECK-LEAP-YEAR.
 12075     IF FROM-DAYS-IN-MONTH = 29
 12076        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12077
 12078 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 229
* EL156.cbl
 12079     EXIT.
 12080
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 230
* EL156.cbl
 12082 1420-CHECK-AIG-BENEFIT.
 12083
 12084     IF WS-SPECIAL-CALC-CD = 'Q'
 12085         GO TO 1425-CHECK-WHOLE-MONTH.
 12086
 12087*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12088*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12089*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12090*       (PI-PMTTYPE = '1' OR '2')
 12091*        NEXT SENTENCE
 12092*    ELSE
 12093         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12094         GO TO 1430-CHECK-AH-TOLERANCE.
 12095
 12096******************AIG LOGIC STARTS**********************
 12097*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12098*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12099*    MOVE ER-3533      TO EMI-ERROR.
 12100*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12101*    GO TO 1430-CHECK-AH-TOLERANCE.
 12102******************AIG LOGIC ENDS************************
 12103
 12104 1425-CHECK-WHOLE-MONTH.
 12105******************************************************************
 12106****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12107****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12108****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12109****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12110****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12111****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12112****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12113****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12114****          PAID * MONTHLY BENEFIT.                         ****
 12115******************************************************************
 12116
 12117     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12118
 12119     IF CL-NO-OF-PMTS-MADE > +0
 12120         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12121
 12122     IF PI-CDAYS < WS-BEN-DAYS
 12123         GO TO 1430-CHECK-AH-TOLERANCE.
 12124
 12125     IF PI-CDAYS = WS-BEN-DAYS
 12126         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12127         GO TO 1430-CHECK-AH-TOLERANCE.
 12128
 12129*    IF PI-COMPANY-ID = 'ACM'
 12130*       NEXT SENTENCE
 12131*    ELSE
 12132        GO TO 1425-NOT-ACM-W15C.
 12133
 12134*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12135*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12136*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12137*    MOVE '6'                    TO  DC-OPTION-CODE.
 12138*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12139*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 231
* EL156.cbl
 12140*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12141*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12142*       MOVE '1'                 TO  DC-OPTION-CODE
 12143*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12144*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12145*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12146*       IF NO-CONVERSION-ERROR
 12147*          IF (DC-ELAPSED-MONTHS > +0) OR
 12148*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12149*             NEXT SENTENCE
 12150*          ELSE
 12151*             MOVE +0            TO  PI-CPYAMT
 12152*             MOVE ER-0846       TO  EMI-ERROR
 12153*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12154*             GO TO 1430-CHECK-AH-TOLERANCE
 12155*       ELSE
 12156*           MOVE ER-0846         TO  EMI-ERROR
 12157*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12158*           GO TO 1430-CHECK-AH-TOLERANCE.
 12159*
 12160*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12161*       ADD +1 TO DC-ELAPSED-MONTHS.
 12162*
 12163*    COMPUTE PI-CPYAMT ROUNDED =
 12164*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12165*
 12166*    GO TO 1430-CHECK-AH-TOLERANCE.
 12167
 12168 1425-NOT-ACM-W15C.
 12169
 12170     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12171     MOVE '6'                        TO  DC-OPTION-CODE.
 12172     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12173     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12174
 12175     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12176     IF NO-CONVERSION-ERROR
 12177         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12178     ELSE
 12179         MOVE ER-0846                TO  EMI-ERROR
 12180         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12181         GO TO 1430-CHECK-AH-TOLERANCE.
 12182
 12183     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12184     MOVE '1'                        TO  DC-OPTION-CODE.
 12185     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12186     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12187     IF NO-CONVERSION-ERROR
 12188         IF DC-ODD-DAYS-OVER = +0
 12189             NEXT SENTENCE
 12190         ELSE
 12191             MOVE ER-0846            TO  EMI-ERROR
 12192             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12193             GO TO 1430-CHECK-AH-TOLERANCE
 12194     ELSE
 12195         MOVE ER-0846                TO  EMI-ERROR
 12196         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12197         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 232
* EL156.cbl
 12198
 12199     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12200         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12201
 12202     GO TO 1430-CHECK-AH-TOLERANCE.
 12203
 12204 1425-CONT-WHOLE-MONTH-PMTS.
 12205******************************************************************
 12206****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12207****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12208****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12209******************************************************************
 12210
 12211     IF PI-COMPANY-ID = 'ACM'
 12212        NEXT SENTENCE
 12213     ELSE
 12214        IF DC-ODD-DAYS-OVER = +0
 12215            NEXT SENTENCE
 12216        ELSE
 12217            MOVE ER-0845            TO  EMI-ERROR
 12218            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12219            GO TO 1430-CHECK-AH-TOLERANCE.
 12220
 12221     COMPUTE PI-CPYAMT ROUNDED =
 12222                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12223
 12224 1430-CHECK-AH-TOLERANCE.
 12225     IF PI-PMT-APPR-SW = 'G'
 12226         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12227
 12228*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12229*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12230*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12231*
 12232*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12233*      IF WDF-MONTH = 02
 12234*        IF SAVE-ELAPSED-MONTHS = 0
 12235*          NEXT SENTENCE
 12236*        ELSE
 12237*          IF SAVE-ODD-DAYS-OVER > 0
 12238*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12239*            COMPUTE WS-PMT-MOS ROUNDED =
 12240*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12241*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12242*                                     WS-PMT-MOS
 12243*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12244*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12245*          ELSE
 12246*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12247*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12248*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12249*                                     WS-PMT-MOS.
 12250
 12251     IF WS-MAX-PMT-TOL NOT = ZERO
 12252        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12253           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12254            MOVE ER-0494         TO  EMI-ERROR
 12255            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 233
* EL156.cbl
 12256            GO TO 1500-EDIT-EXPENSES.
 12257
 12258 1430-CONT-CHECK-AH-TOLERANCE.
 12259
 12260     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12261        GO TO 1500-EDIT-EXPENSES.
 12262
 12263     IF CM-O-B-COVERAGE
 12264        GO TO 1500-EDIT-EXPENSES.
 12265
 12266     IF PI-COMPANY-ID = 'NCL'
 12267       IF FOUND-TOL-SW = 'Y'
 12268         IF WS-PMT-TOL NOT = ZERO
 12269           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12270              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12271                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12272                  IF WS-NCL-PMT-OPTION = SPACES
 12273                      MOVE ER-0699 TO EMI-ERROR
 12274                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12275                  ELSE
 12276                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12277                      NEXT SENTENCE
 12278                  ELSE
 12279                  IF NOT WS-VALID-NCL-OPTION
 12280                      MOVE ER-0699 TO EMI-ERROR
 12281                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12282
 12283     IF WS-PMT-TOL NOT = ZERO
 12284        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12285           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12286           MOVE ER-0495          TO EMI-ERROR
 12287           PERFORM 1490-PAYMENT-ERROR
 12288                                 THRU 1490-EXIT
 12289        end-if
 12290     end-if
 12291
 12292     GO TO 1500-EDIT-EXPENSES.
 12293
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 234
* EL156.cbl
 12295 1440-COMPUTE-LIFE-REMAINING.
 12296
 12297     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12298        IF PI-PMTTYPE = '4'
 12299          MOVE PI-EPYAMT TO PI-CPYAMT
 12300          GO TO 1460-TEST-TYPE.
 12301
 12302     IF WS-LF-COVERAGE-TYPE = 'L'
 12303        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12304                          - CL-TOTAL-PAID-AMT
 12305        GO TO 1450-CHECK-MAX.
 12306
 12307     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12308        PI-LF-COVERAGE-TYPE = 'P'
 12309          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12310                              CM-LF-ITD-DEATH-AMT
 12311          GO TO 1450-CHECK-MAX.
 12312
 12313     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12314     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12315     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12316     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12317     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12318     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12319     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12320     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12321     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12322
 12323     PERFORM 9800-LINK-REM-TERM.
 12324
 12325     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12326     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12327     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12328     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12329     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12330     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12331     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12332     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12333     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12334     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12335     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12336     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12337     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12338     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12339     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12340     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12341     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 12342        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12343        MOVE PI-CARRIER          TO ACCT-CARRIER
 12344        MOVE PI-GROUPING         TO ACCT-GROUPING
 12345        MOVE PI-STATE            TO ACCT-STATE
 12346        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12347        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12348        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12349        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12350
 12351
 12352* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 235
* EL156.cbl
 12353*          DATASET ('ERACCT')
 12354*          RIDFLD  (ERACCT-KEY)
 12355*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12356*          GTEQ
 12357*          resp    (WS-RESPONSE)
 12358*       END-EXEC
 12359     MOVE 'ERACCT' TO DFHEIV1
 12360*    MOVE '&"S        G          (  N#00011797' TO DFHEIV0
 12361     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12362     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12363     MOVE X'204E233030303131373937' TO DFHEIV0(25:11)
 12364     CALL 'kxdfhei1' USING DFHEIV0,
 12365           DFHEIV1,
 12366           DFHEIV20,
 12367           DFHEIV99,
 12368           ERACCT-KEY,
 12369           DFHEIV99,
 12370           DFHEIV99,
 12371           DFHEIV99
 12372     SET ADDRESS OF ACCOUNT-MASTER TO
 12373         DFHEIV20
 12374     MOVE EIBRESP  TO WS-RESPONSE
 12375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12376        IF WS-RESP-NORMAL
 12377           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12378           and (pi-cert-eff-dt < am-expiration-dt)
 12379           and (pi-cert-eff-dt >= am-effective-dt)
 12380           move am-dcc-product-code to pi-dcc-product-code
 12381        else
 12382           move spaces           to pi-dcc-product-code
 12383        end-if
 12384        if pi-dcc-product-code not = spaces
 12385           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12386           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12387           PERFORM 0900-GET-DDF-limits
 12388                                 THRU 0900-EXIT
 12389           IF PDEF-FOUND
 12390              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12391                 (P1 > +8)
 12392                 OR (PD-PROD-CODE (P1) = 'L')
 12393              END-PERFORM
 12394              IF P1 < +9
 12395                 MOVE PD-MAX-AMT (P1)
 12396                                 TO CP-R-MAX-TOT-BEN
 12397              else
 12398                 move er-1674    to emi-error
 12399                 PERFORM 9900-ERROR-FORMAT
 12400                                 THRU 9900-EXIT
 12401              END-IF
 12402           else
 12403              move er-1672       to emi-error
 12404              PERFORM 9900-ERROR-FORMAT
 12405                                 THRU 9900-EXIT
 12406           END-IF
 12407        end-if
 12408     END-IF
 12409
 12410* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 236
* EL156.cbl
 12411*       PROGRAM  (LINK-REMAMT)
 12412*       COMMAREA (CALCULATION-PASS-AREA)
 12413*       LENGTH   (CP-COMM-LENGTH)
 12414*    END-EXEC.
 12415*    MOVE '."C                   (   #00011837' TO DFHEIV0
 12416     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12417     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12418     MOVE X'2020233030303131383337' TO DFHEIV0(25:11)
 12419     CALL 'kxdfhei1' USING DFHEIV0,
 12420           LINK-REMAMT,
 12421           CALCULATION-PASS-AREA,
 12422           CP-COMM-LENGTH,
 12423           DFHEIV99,
 12424           DFHEIV99,
 12425           DFHEIV99,
 12426           DFHEIV99
 12427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12428
 12429
 12430     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12431
 12432     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12433     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12434
 12435     IF PI-COMPANY-ID = 'BOA' AND
 12436        PI-PMTTYPE    = '2'   AND
 12437        PI-OFFLINE    = 'N'
 12438           GO TO 1441-COMPUTE-BOA-INTEREST.
 12439
 12440     IF PI-COMPANY-ID = 'NCL' AND
 12441        PI-PMTTYPE    = '2'   AND
 12442        PI-OFFLINE    = 'N'
 12443          GO TO 1442-COMPUTE-NCL-INTEREST
 12444       ELSE
 12445          GO TO 1445-CONTINUE.
 12446
 12447 1441-COMPUTE-BOA-INTEREST.
 12448     MOVE +0             TO WS-CALC-INT.
 12449
 12450     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12451     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12452     MOVE +0             TO DC-ELAPSED-MONTHS
 12453                            DC-ELAPSED-DAYS.
 12454     MOVE '1'            TO DC-OPTION-CODE.
 12455     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12456     IF NO-CONVERSION-ERROR
 12457         NEXT SENTENCE
 12458     ELSE
 12459         GO TO 1445-CONTINUE.
 12460
 12461     IF (PI-INT-RATE NOT > ZEROS)  AND
 12462        (DC-ELAPSED-DAYS > +30)
 12463         MOVE ER-3531            TO EMI-ERROR
 12464         MOVE -1                 TO PINTL
 12465         MOVE AL-UNBON           TO PINTA
 12466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12467
 12468     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 237
* EL156.cbl
 12469         GO TO 1445-CONTINUE.
 12470
 12471     IF (PI-INT-RATE NOT > ZEROS)  OR
 12472        (DC-ELAPSED-DAYS NOT > +30)
 12473         MOVE PI-EPYAMT TO PI-CPYAMT
 12474         GO TO 1441-FORMAT-NOTE.
 12475
 12476     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12477                                 *  PI-INT-RATE
 12478                                 *  DC-ELAPSED-DAYS
 12479                                 /  365
 12480                                 /  100.
 12481
 12482     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12483
 12484 1441-FORMAT-NOTE.
 12485
 12486     MOVE SPACES        TO WS-BOANOTE1.
 12487     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12488     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12489     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12490     MOVE AL-UANON      TO NOTE1A.
 12491
 12492     IF WS-CALC-INT > ZEROS
 12493         MOVE SPACES        TO WS-BOANOTE2
 12494         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12495         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12496         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12497         MOVE AL-UANON      TO NOTE2A.
 12498
 12499     GO TO 1445-CONTINUE.
 12500
 12501 1442-COMPUTE-NCL-INTEREST.
 12502     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12503     MOVE PI-STATE               TO WS-ST-ACCESS.
 12504     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12505     MOVE '3'                    TO CNTL-REC-TYPE.
 12506     MOVE +0                     TO CNTL-SEQ-NO.
 12507     MOVE 'STAT'                 TO FILE-SWITCH.
 12508
 12509     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12510
 12511     MOVE +0                 TO WS-CALC-INT.
 12512
 12513     IF ST-STAT-FROM-INCURRED
 12514         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12515       ELSE
 12516     IF ST-STAT-FROM-REPORTED
 12517         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12518       ELSE
 12519         GO TO 1445-CONTINUE.
 12520
 12521     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12522     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12523     MOVE +0                 TO DC-ELAPSED-MONTHS
 12524                                DC-ELAPSED-DAYS.
 12525     MOVE '1'                TO DC-OPTION-CODE.
 12526     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 238
* EL156.cbl
 12527     IF NO-CONVERSION-ERROR
 12528         NEXT SENTENCE
 12529     ELSE
 12530         GO TO 1445-CONTINUE.
 12531
 12532     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12533        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12534         GO TO 1445-CONTINUE.
 12535
 12536     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12537                                 *  CF-ST-STAT-INTEREST.
 12538
 12539     MOVE SPACES              TO WS-NCLNOTE1.
 12540     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12541     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12542     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12543                                 PI-PMTNOTE1
 12544                                 NOTE1I.
 12545     MOVE AL-UANON            TO NOTE1A.
 12546
 12547     IF WS-CALC-INT > ZEROS
 12548         MOVE SPACES          TO WS-NCLNOTE2
 12549         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12550         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12551         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12552                                 PI-PMTNOTE2
 12553                                 NOTE2I
 12554         MOVE AL-UANON        TO NOTE2A.
 12555
 12556     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12557
 12558 1445-CONTINUE.
 12559
 12560     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12561        GO TO 1460-TEST-TYPE.
 12562
 12563     IF CM-O-B-COVERAGE
 12564        GO TO 1460-TEST-TYPE.
 12565
 12566     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12567         GO TO 1450-CHECK-MAX.
 12568
 12569     if (pi-company-id = 'DCC' or 'CAP')
 12570        and (pdef-found)
 12571        if pi-epyamt > pd-max-amt (p1)
 12572           move er-1657          to emi-error
 12573           perform 1490-payment-error
 12574                                 thru 1490-exit
 12575           go to 1460-test-type
 12576        end-if
 12577     else
 12578        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12579           > PI-EPYAMT)
 12580                         OR
 12581           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12582           < PI-EPYAMT)
 12583           MOVE ER-0594          TO EMI-ERROR
 12584           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 239
* EL156.cbl
 12585                                 THRU 1490-EXIT
 12586           GO TO 1460-TEST-TYPE
 12587        end-if
 12588     end-if
 12589     .
 12590 1450-CHECK-MAX.
 12591
 12592     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12593        PI-LF-COVERAGE-TYPE = 'P'
 12594         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12595                                   CM-LF-ITD-DEATH-AMT
 12596     ELSE
 12597         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12598                                   CL-TOTAL-PAID-AMT.
 12599
 12600     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12601          MOVE ER-0543           TO EMI-ERROR
 12602          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12603
 12604 1460-TEST-TYPE.
 12605
 12606     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12607        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12608           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12609                                   CM-LF-ALT-BENEFIT-AMT -
 12610                                   CL-TOTAL-PAID-AMT
 12611           IF PI-EPYAMT > WS-LF-BEN-AMT
 12612               MOVE ER-0543      TO EMI-ERROR
 12613               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12614           END-IF
 12615        END-IF
 12616     END-IF
 12617
 12618     IF PI-PMT-APPR-SW = 'G'
 12619       NEXT SENTENCE
 12620     ELSE
 12621       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12622         IF PI-EPYAMT = ZERO
 12623             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12624                 MOVE ER-0494    TO  EMI-ERROR
 12625                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12626                 GO TO 1500-EDIT-EXPENSES
 12627             ELSE
 12628                 NEXT SENTENCE
 12629         ELSE
 12630             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12631                 MOVE ER-0494    TO  EMI-ERROR
 12632                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12633                 GO TO 1500-EDIT-EXPENSES.
 12634
 12635     IF PI-PMTTYPE NOT = '2' OR
 12636        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12637         GO TO 1500-EDIT-EXPENSES.
 12638
 12639     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12640     MOVE ER-0526                TO EMI-ERROR.
 12641     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12642
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 240
* EL156.cbl
 12643     IF EMI-ERROR-NUMBER (1) = '0526'
 12644        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12645
 12646     IF EMI-ERROR-NUMBER (2) = '0526'
 12647        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12648
 12649     GO TO 1500-EDIT-EXPENSES.
 12650
 12651 1490-PAYMENT-ERROR.
 12652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12653
 12654     IF EMI-MESSAGE-FORMATTED
 12655         MOVE -1                 TO EPYAMTL
 12656         MOVE AL-UNBON           TO EPYAMTA.
 12657
 12658 1490-EXIT.
 12659      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 241
* EL156.cbl
 12661 1500-EDIT-EXPENSES.
 12662     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12663         GO TO 1500-SKIP-ERROR-0556.
 12664
 12665 1500-CONTINUE-ON.
 12666
 12667     IF CM-O-B-COVERAGE
 12668        MOVE ER-0556             TO EMI-ERROR
 12669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12670
 12671 1500-SKIP-ERROR-0556.
 12672     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12673        IF PI-EEXPENS NOT = ZEROS
 12674           MOVE ER-0524          TO EMI-ERROR
 12675           GO TO 1590-EXPENSE-ERROR
 12676        ELSE
 12677           GO TO 1600-EDIT-RESERVES.
 12678
 12679     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12680     MOVE '6'                    TO CNTL-REC-TYPE.
 12681
 12682     IF CONTROL-IS-ACTUAL-CARRIER
 12683         MOVE PI-CARRIER         TO WS-CARR
 12684     ELSE
 12685         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12686
 12687     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12688     MOVE +0                     TO CNTL-SEQ-NO.
 12689     MOVE 'CARR'                 TO FILE-SWITCH.
 12690
 12691     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12692
 12693     IF EXPENSE-CALC-MANUAL
 12694        GO TO 1600-EDIT-RESERVES.
 12695
 12696     IF DOLLARS-PER-PMT
 12697        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12698        GO TO 1600-EDIT-RESERVES.
 12699
 12700     IF DOLLARS-PER-MONTH AND
 12701        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12702       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12703       GO TO 1600-EDIT-RESERVES.
 12704
 12705     IF PERCENT-OF-PAYMENT
 12706        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12707
 12708     GO TO 1600-EDIT-RESERVES.
 12709
 12710 1590-EXPENSE-ERROR.
 12711     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12712
 12713     IF EMI-MESSAGE-FORMATTED
 12714        MOVE -1                  TO EEXPENSL
 12715        MOVE AL-UNBON            TO EEXPENSA.
 12716
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 242
* EL156.cbl
 12718 1600-EDIT-RESERVES.
 12719     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12720        IF PI-ERESV = ZEROS
 12721           GO TO 1700-EDIT-EXPENSE-TYPE
 12722        ELSE
 12723           MOVE ER-0525          TO EMI-ERROR
 12724           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12725           GO TO 1700-EDIT-EXPENSE-TYPE.
 12726
 12727     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12728     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12729     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12730
 12731     IF NOT AT-MANUAL-RESERVES-USED
 12732        IF PI-ERESV NOT = ZEROS
 12733           MOVE ER-0518          TO EMI-ERROR
 12734           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12735
 12736     IF AT-MANUAL-RESERVES-USED
 12737        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12738        GO TO 1700-EDIT-EXPENSE-TYPE.
 12739
 12740     IF AT-FUTURE-RESERVES-USED
 12741        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12742
 12743     IF AT-FUTURE-RESERVES-USED
 12744        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12745
 12746     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12747        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12748
 12749     IF AT-IBNR-RESERVES-USED
 12750        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12751
 12752     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12753     GO TO 1700-EDIT-EXPENSE-TYPE.
 12754
 12755 1690-RESERVE-ERROR.
 12756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12757
 12758     IF EMI-MESSAGE-FORMATTED
 12759        MOVE AL-UNBON            TO ERESVA
 12760        MOVE -1                  TO ERESVL.
 12761
 12762 1690-EXIT.
 12763      EXIT.
 12764
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 243
* EL156.cbl
 12766 1700-EDIT-EXPENSE-TYPE.
 12767     IF PI-PMTTYPE NOT = '5' AND '6'
 12768        GO TO 2000-EDIT-DONE.
 12769
 12770     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12771                   '6' OR '7' OR '8' OR '9'
 12772        GO TO 2000-EDIT-DONE.
 12773
 12774 1705-EXPENSE-ERROR.
 12775     MOVE ER-0573                TO EMI-ERROR.
 12776     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12777
 12778     IF EMI-MESSAGE-FORMATTED
 12779        MOVE AL-UABON            TO ETYPEA
 12780        MOVE -1                  TO ETYPEL.
 12781
 12782     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 244
* EL156.cbl
 12784 1950-NOT-FOUND.
 12785     IF FILE-SWITCH = 'MSTR'
 12786        MOVE ER-0204             TO EMI-ERROR.
 12787
 12788     IF FILE-SWITCH = 'CARR'
 12789        MOVE ER-0252             TO EMI-ERROR.
 12790
 12791     IF FILE-SWITCH = 'COMP'
 12792        MOVE ER-0254             TO EMI-ERROR.
 12793
 12794     IF FILE-SWITCH = 'STAT'
 12795        MOVE ER-0149             TO EMI-ERROR.
 12796
 12797     IF FILE-SWITCH = 'PROC'
 12798        MOVE ER-0019             TO EMI-ERROR.
 12799
 12800     IF FILE-SWITCH = 'ACCT'
 12801        MOVE ER-0198             TO EMI-ERROR.
 12802
 12803     IF FILE-SWITCH = 'BENE'
 12804        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12805           MOVE ER-0282          TO EMI-ERROR
 12806        ELSE
 12807           MOVE ER-0283          TO EMI-ERROR.
 12808
 12809     MOVE -1                     TO PMTTYPEL.
 12810     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12811
 12812     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12813                                     WS-FORCE-CTR.
 12814
 12815     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12816                                     WS-FATAL-CTR.
 12817
 12818     GO TO 8200-SEND-DATAONLY.
 12819
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 245
* EL156.cbl
 12821 2000-EDIT-DONE.
 12822     perform 2210-dcc-max-benes thru 2210-exit
 12823     if pi-company-id not = 'DCC' and 'CAP'
 12824        IF (WS-SPECIAL-CALC-CD = 'C')
 12825           and (cl-critical-period > 0)
 12826           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12827              IF PI-EPYAMT > ZEROS
 12828                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12829                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12830              ELSE
 12831                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12832                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12833              END-IF
 12834              if ws-benefits-paid > cl-critical-period
 12835                 MOVE ER-0657          TO EMI-ERROR
 12836                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12837              END-IF
 12838           END-IF
 12839        END-IF
 12840     end-if
 12841     IF PI-HOLDTIL NOT = ZEROS
 12842        MOVE PI-HOLDTIL          TO HOLDTILO
 12843        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12844
 12845     IF PI-EPYFROM NOT = ZEROS
 12846        MOVE PI-EPYFROM          TO EPYFROMO
 12847        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12848
 12849     IF PI-EPYTHRU NOT = ZEROS
 12850        MOVE PI-EPYTHRU            TO EPYTHRUO
 12851        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12852        IF PI-USES-PAID-TO
 12853           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12854           MOVE '4'                TO DC-OPTION-CODE
 12855           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12856           IF NO-CONVERSION-ERROR
 12857              MOVE +1              TO DC-ELAPSED-DAYS
 12858              MOVE +0              TO DC-ELAPSED-MONTHS
 12859              MOVE '6'             TO DC-OPTION-CODE
 12860              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12861              IF NO-CONVERSION-ERROR
 12862                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12863
 12864     MOVE PI-EDAYS               TO EDAYSO.
 12865
 12866     IF PI-AIGFROM NOT = ZEROS
 12867        MOVE PI-AIGFROM          TO AIGFROMO
 12868        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12869
 12870     MOVE PI-EPYAMT              TO EPYAMTO.
 12871     MOVE PI-ERESV               TO ERESVO.
 12872     MOVE PI-EEXPENS             TO EEXPENSO.
 12873
 12874     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12875     MOVE SPACES                 TO DC-OPTION-CODE.
 12876     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12877
 12878     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 246
* EL156.cbl
 12879        MOVE SPACES              TO CPYFROMI
 12880     ELSE
 12881        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12882        IF PI-EPYFROM = ZEROS
 12883           MOVE AL-UANON             TO EPYFROMA
 12884           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12885           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12886
 12887     IF PI-USES-PAID-TO
 12888        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12889        MOVE +1                            TO DC-ELAPSED-DAYS
 12890        MOVE +0                            TO DC-ELAPSED-MONTHS
 12891        MOVE '6'                           TO DC-OPTION-CODE
 12892        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12893        IF NO-CONVERSION-ERROR
 12894           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12895           IF PI-EPYTHRU = ZEROS
 12896              MOVE AL-UANON                TO EPYTHRUA
 12897              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12898              MOVE ' '                     TO DC-OPTION-CODE
 12899              MOVE +0                      TO DC-ELAPSED-DAYS
 12900                                              DC-ELAPSED-MONTHS
 12901              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12902              IF NO-CONVERSION-ERROR
 12903                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12904                  GO TO 2001-CONTINUE
 12905              ELSE
 12906                  GO TO 2001-CONTINUE
 12907           ELSE
 12908              GO TO 2001-CONTINUE.
 12909
 12910     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12911     MOVE SPACES                 TO DC-OPTION-CODE.
 12912     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12913
 12914     IF DATE-CONVERSION-ERROR
 12915        MOVE SPACES              TO CPYTHRUI
 12916     ELSE
 12917        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12918        IF PI-EPYTHRU = ZEROS
 12919           MOVE AL-UANON TO EPYTHRUA
 12920           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12921           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12922
 12923 2001-CONTINUE.
 12924
 12925     MOVE PI-CDAYS               TO CDAYSO.
 12926
 12927     IF PI-EDAYS = ZEROS
 12928        MOVE AL-UNNON TO EDAYSA
 12929        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12930
 12931     MOVE PI-CPYAMT              TO CPYAMTO.
 12932
 12933     IF PI-EPYAMT = ZEROS
 12934        MOVE AL-UNNON            TO EPYAMTA
 12935        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12936
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 247
* EL156.cbl
 12937     MOVE PI-CRESV               TO CRESVO.
 12938     MOVE PI-CEXPENS             TO CEXPENSO.
 12939
 12940     IF PI-EEXPENS = ZEROS
 12941        MOVE AL-UNNON TO EEXPENSA
 12942        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12943
 12944     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12945        AND (CL-CLAIM-TYPE = 'L')
 12946        AND (PI-OFFLINE NOT EQUAL 'Y')
 12947        IF PI-PMTTYPE = '2' OR '4'
 12948           PERFORM 2200-CALC-INTEREST
 12949                                 THRU 2200-EXIT
 12950        END-IF
 12951     END-IF
 12952     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12953     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12954     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12955
 12956     IF EMI-FATAL-CTR = ZEROS
 12957        MOVE 'B'                 TO PI-PASS-SW.
 12958
 12959     IF NOT EMI-MESSAGE-FORMATTED
 12960         MOVE -1                 TO EPYFROML
 12961     ELSE
 12962         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12963            EMI-ERROR-NUMBER (2) = SPACES
 12964             MOVE -1             TO EPYFROML.
 12965
 12966     GO TO 8200-SEND-DATAONLY.
 12967
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 248
* EL156.cbl
 12969 2200-CALC-INTEREST.
 12970     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12971        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12972        MOVE '4'                 TO DC-OPTION-CODE
 12973        PERFORM 9700-LINK-DATE-CONVERT
 12974        IF DATE-CONVERSION-ERROR
 12975            MOVE LOW-VALUES      TO CP-PRF-DT
 12976        ELSE
 12977           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12978        END-IF
 12979     END-IF
 12980     if (pi-int-to-rem-borr <> 'Y' and 'N')
 12981        if pi-rb-joint-coverage
 12982           move 'Y'              to pi-int-to-rem-borr
 12983        end-if
 12984     end-if
 12985     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12986        IN CLAIM-INT-PASS-AREA
 12987     MOVE CL-CERT-STATE          TO CP-STATE
 12988        IN CLAIM-INT-PASS-AREA
 12989     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12990     MOVE 'LF'                   TO CP-COVERAGE
 12991     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12992     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12993     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12994     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12995     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12996     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12997
 12998* EXEC CICS LINK
 12999*       PROGRAM   ('ELCLMI')
 13000*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13001*       LENGTH    (CP-CLAIM-LENGTH)
 13002*    END-EXEC
 13003     MOVE 'ELCLMI' TO DFHEIV1
 13004*    MOVE '."C                   (   #00012410' TO DFHEIV0
 13005     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13006     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13007     MOVE X'2020233030303132343130' TO DFHEIV0(25:11)
 13008     CALL 'kxdfhei1' USING DFHEIV0,
 13009           DFHEIV1,
 13010           CLAIM-INT-PASS-AREA,
 13011           CP-CLAIM-LENGTH,
 13012           DFHEIV99,
 13013           DFHEIV99,
 13014           DFHEIV99,
 13015           DFHEIV99
 13016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13017     MOVE AL-PANOF               TO PINTHA
 13018                                    PINTA
 13019     if cp-clm-int-amt = zeros
 13020        move ' ' to pi-int-to-rem-borr
 13021     end-if
 13022     IF NO-CI-ERROR
 13023        MOVE CP-CLM-INT-AMT      TO PINTO
 13024                                    PI-INT-AMT
 13025        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13026        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 249
* EL156.cbl
 13027        MOVE AL-PANOF            TO PINTHA
 13028                                    PINTA
 13029        if pi-rb-joint-coverage
 13030           and pi-int-amt > zeros
 13031           move '  INT TO'       to itrb1o
 13032           move ' REM BORR?'     to itrb2o
 13033           move pi-int-to-rem-borr
 13034                                 to itrbyno
 13035           move al-uanon         to itrbyna
 13036           move +1               to itrbynl
 13037        else
 13038           move ' '              to pi-int-to-rem-borr
 13039        end-if
 13040     ELSE
 13041        IF CI-RETURN-CODE = '8'
 13042           MOVE ER-3818          TO EMI-ERROR
 13043           MOVE -1               TO ZINTL
 13044           PERFORM 9900-ERROR-FORMAT
 13045                                 THRU 9900-EXIT
 13046           GO TO 2200-EXIT
 13047        ELSE
 13048           MOVE ZEROS            TO PINTO
 13049                                    PI-INT-AMT
 13050                                    PI-INT-DAYS
 13051                                    PI-INT-RATE-USED
 13052        END-IF
 13053     END-IF
 13054     IF PI-INT-AMT NOT = ZEROS
 13055        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13056           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13057           CONTINUE
 13058        ELSE
 13059           MOVE CL-SOC-SEC-NO (1:3)
 13060                                 TO WS-SSN (1:3)
 13061           MOVE CL-SOC-SEC-NO (5:2)
 13062                                 TO WS-SSN (4:2)
 13063           MOVE CL-SOC-SEC-NO (8:4)
 13064                                 TO WS-SSN (6:4)
 13065           IF (WS-SSN NUMERIC)
 13066              AND (WS-SSN NOT = ZEROS)
 13067              CONTINUE
 13068           ELSE
 13069              MOVE ER-2044       TO EMI-ERROR
 13070              PERFORM 9900-ERROR-FORMAT
 13071                                 THRU 9900-EXIT
 13072           END-IF
 13073        END-IF
 13074        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13075        if pi-int-to-rem-borr = 'Y'
 13076           move +61              to trlr-seq-no
 13077        else
 13078           MOVE +51              TO TRLR-SEQ-NO
 13079        end-if
 13080
 13081* EXEC CICS READ
 13082*          DATASET  ('ELTRLR')
 13083*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13084*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 250
* EL156.cbl
 13085*          RESP     (WS-RESPONSE)
 13086*       END-EXEC
 13087     MOVE 'ELTRLR' TO DFHEIV1
 13088*    MOVE '&"S        E          (  N#00012478' TO DFHEIV0
 13089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13091     MOVE X'204E233030303132343738' TO DFHEIV0(25:11)
 13092     CALL 'kxdfhei1' USING DFHEIV0,
 13093           DFHEIV1,
 13094           DFHEIV20,
 13095           DFHEIV99,
 13096           ELTRLR-KEY,
 13097           DFHEIV99,
 13098           DFHEIV99,
 13099           DFHEIV99
 13100     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13101         DFHEIV20
 13102     MOVE EIBRESP  TO WS-RESPONSE
 13103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13104        IF (NOT WS-RESP-NORMAL)
 13105                    OR
 13106           ((WS-RESP-NORMAL)
 13107           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13108           OR (AT-CITY-STATE = SPACES)))
 13109           MOVE ER-0874          TO EMI-ERROR
 13110           if pi-rb-joint-coverage
 13111              move -1            to itrbynl
 13112           end-if
 13113           PERFORM 9900-ERROR-FORMAT
 13114                                 THRU 9900-EXIT
 13115        else
 13116           move at-mail-to-name  to pi-int-payees-name
 13117        END-IF
 13118     END-IF
 13119     .
 13120 2200-EXIT.
 13121     EXIT.
 13122 2210-dcc-max-benes.
 13123
 13124     move pi-ah-term             to ws-max-bens
 13125     if cl-critical-period not = zeros and spaces
 13126        move cl-critical-period  to ws-max-bens
 13127     end-if
 13128     move cm-ah-benefit-amt      to ws-monthly-benefit
 13129     if pdef-found
 13130        and (pd-max-amt (p1) not = zeros)
 13131        if pd-ben-pct (p1) not numeric
 13132           move zeros            to pd-ben-pct (p1)
 13133        end-if
 13134        if pd-ben-pct (p1) = zeros
 13135           move +1               to ws-work-ben-pct
 13136        else
 13137           move pd-ben-pct (p1)  to ws-work-ben-pct
 13138        end-if
 13139*       compute ws-monthly-benefit =
 13140*          ws-monthly-benefit * ws-work-ben-pct
 13141*       if ws-monthly-benefit > pd-max-amt (p1)
 13142*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 251
* EL156.cbl
 13143*       end-if
 13144     end-if
 13145
 13146     move cl-cert-key-data       to elcrtt-key (2:21)
 13147     move cl-company-cd          to ctrlr-comp-cd
 13148     move cl-cert-no             to ctrlr-cert-no
 13149     move 'B'                    to ctrlr-rec-type
 13150
 13151
 13152* EXEC CICS READ
 13153*       DATASET  ('ELCRTT')
 13154*       set      (address of CERTIFICATE-TRAILERS)
 13155*       RIDFLD   (ELCRTT-KEY)
 13156*       RESP     (WS-RESPONSE)
 13157*    END-EXEC
 13158     MOVE 'ELCRTT' TO DFHEIV1
 13159*    MOVE '&"S        E          (  N#00012531' TO DFHEIV0
 13160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13162     MOVE X'204E233030303132353331' TO DFHEIV0(25:11)
 13163     CALL 'kxdfhei1' USING DFHEIV0,
 13164           DFHEIV1,
 13165           DFHEIV20,
 13166           DFHEIV99,
 13167           ELCRTT-KEY,
 13168           DFHEIV99,
 13169           DFHEIV99,
 13170           DFHEIV99
 13171     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13172         DFHEIV20
 13173     MOVE EIBRESP  TO WS-RESPONSE
 13174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13175     IF not WS-RESP-NORMAL
 13176        go to 2210-exit
 13177     end-if
 13178
 13179*    if instypei = 'P'
 13180*       move +1 to s1
 13181*    else
 13182*       MOVE +2 to s1
 13183*    end-if
 13184
 13185*    move +1 to s1
 13186*    evaluate cl-claim-type
 13187*       when 'A'
 13188*          move +1 to s2
 13189*       when 'I'
 13190*          move +2 to s2
 13191*       when 'G'
 13192*          move +3 to s2
 13193*       when 'L'
 13194*          move +4 to s2
 13195*       when 'P'
 13196*          move +5 to s2
 13197*    end-evaluate
 13198
 13199     move zeros                  to ws-prev-days-paid
 13200                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 252
* EL156.cbl
 13201                                    ws-prev-amt-paid
 13202     perform varying s1 from +1 by +1 until
 13203        (s1 > +24)
 13204        or (cs-claim-type (s1) = spaces)
 13205        if pi-company-id not = 'DCC' and 'CAP'
 13206           if cs-claim-type (s1) = cl-claim-type
 13207              compute ws-prev-days-paid =
 13208                 ws-prev-days-paid + cs-days-paid (s1)
 13209              compute ws-prev-amt-paid =
 13210                 ws-prev-amt-paid + cs-total-paid (s1)
 13211           end-if
 13212        else
 13213           if (cs-claim-type (s1) = cl-claim-type)
 13214              and (cs-benefit-period (s1) = cl-benefit-period)
 13215              and (cs-insured-type (s1) = cl-insured-type)
 13216              compute ws-prev-days-paid =
 13217                 ws-prev-days-paid + cs-days-paid (s1)
 13218              compute ws-prev-amt-paid =
 13219                 ws-prev-amt-paid + cs-total-paid (s1)
 13220           end-if
 13221        end-if
 13222     end-perform
 13223     if pi-epyamt > zeros
 13224        compute ws-benefits-paid =
 13225           (ws-prev-amt-paid + pi-epyamt)
 13226           / ws-monthly-benefit
 13227     else
 13228        compute ws-benefits-paid =
 13229           (ws-prev-amt-paid + pi-cpyamt)
 13230           / ws-monthly-benefit
 13231     end-if
 13232*    if pi-company-id = 'DCC'
 13233     if cl-claim-type not = 'L' and 'P'
 13234        if ws-benefits-paid > ws-max-bens
 13235           move er-1658          to emi-error
 13236           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13237        end-if
 13238     end-if
 13239*    end-if
 13240*     if s1 < +25
 13241*        if pi-epyamt > zeros
 13242*           compute ws-benefits-paid =
 13243*              (cs-total-paid (s1) + PI-EPYAMT)
 13244*              / ws-monthly-benefit
 13245*        else
 13246*           compute ws-benefits-paid =
 13247*              (cs-total-paid (s1) + PI-CPYAMT)
 13248*              / ws-monthly-benefit
 13249*        end-if
 13250
 13251*       if ws-benefits-paid > pd-crit-period (p1)
 13252*        if ws-benefits-paid > ws-max-bens
 13253*           move er-1658          to emi-error
 13254*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13255*        end-if
 13256*     end-if
 13257     .
 13258 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 253
* EL156.cbl
 13259     exit.
 13260
 13261 2220-update-elcrtt.
 13262
 13263
 13264* EXEC CICS GETMAIN
 13265*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13266*       LENGTH   (ELCRTT-LENGTH)
 13267*       INITIMG  (GETMAIN-SPACE)
 13268*    END-EXEC
 13269*    MOVE ',"IL                  $   #00012625' TO DFHEIV0
 13270     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13272     MOVE X'2020233030303132363235' TO DFHEIV0(25:11)
 13273     CALL 'kxdfhei1' USING DFHEIV0,
 13274           DFHEIV20,
 13275           ELCRTT-LENGTH,
 13276           GETMAIN-SPACE
 13277     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13278         DFHEIV20
 13279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13280
 13281     move cl-cert-key-data       to elcrtt-key (2:21)
 13282     move cl-company-cd          to ctrlr-comp-cd
 13283     move cl-cert-no             to ctrlr-cert-no
 13284     move 'B'                    to ctrlr-rec-type
 13285
 13286
 13287* EXEC CICS READ
 13288*       UPDATE
 13289*       DATASET  (ELCRTT-DSID)
 13290*       into     (CERTIFICATE-TRAILERS)
 13291*       RIDFLD   (ELCRTT-KEY)
 13292*       RESP     (WS-RESPONSE)
 13293*    END-EXEC
 13294     MOVE LENGTH OF
 13295      CERTIFICATE-TRAILERS
 13296       TO DFHEIV11
 13297*    MOVE '&"IL       EU         (  N#00012636' TO DFHEIV0
 13298     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13299     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13300     MOVE X'204E233030303132363336' TO DFHEIV0(25:11)
 13301     CALL 'kxdfhei1' USING DFHEIV0,
 13302           ELCRTT-DSID,
 13303           CERTIFICATE-TRAILERS,
 13304           DFHEIV11,
 13305           ELCRTT-KEY,
 13306           DFHEIV99,
 13307           DFHEIV99,
 13308           DFHEIV99
 13309     MOVE EIBRESP  TO WS-RESPONSE
 13310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13311
 13312     IF WS-RESP-NORMAL
 13313        perform 2225-upd-crt-trlr thru 2225-exit
 13314
 13315* EXEC CICS REWRITE
 13316*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 254
* EL156.cbl
 13317*          from     (CERTIFICATE-TRAILERS)
 13318*          RESP     (WS-RESPONSE)
 13319*       END-EXEC
 13320     MOVE LENGTH OF
 13321      CERTIFICATE-TRAILERS
 13322       TO DFHEIV11
 13323*    MOVE '&& L                  %  N#00012646' TO DFHEIV0
 13324     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13325     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13326     MOVE X'204E233030303132363436' TO DFHEIV0(25:11)
 13327     CALL 'kxdfhei1' USING DFHEIV0,
 13328           ELCRTT-DSID,
 13329           CERTIFICATE-TRAILERS,
 13330           DFHEIV11,
 13331           DFHEIV99
 13332     MOVE EIBRESP  TO WS-RESPONSE
 13333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13334     else
 13335        if ws-resp-notfnd
 13336           move 'CS'             to certificate-trailers
 13337           move cl-company-cd    to cs-company-cd
 13338           move cl-cert-key-data to cs-control-primary (2:21)
 13339           move cl-cert-no       to cs-cert-no
 13340           move 'B'              to cs-trailer-type
 13341           perform varying s1 from +1 by +1 until s1 > +24
 13342              move zeros         to cs-benefit-period (s1)
 13343                                    cs-days-paid (s1)
 13344                                    cs-total-paid (s1)
 13345                                    cs-remaining-bens (s1)
 13346           end-perform
 13347           perform 2225-upd-crt-trlr
 13348                                 thru 2225-exit
 13349
 13350* EXEC CICS WRITE
 13351*             DATASET  (ELCRTT-DSID)
 13352*             from     (CERTIFICATE-TRAILERS)
 13353*             RIDFLD   (cs-control-primary)
 13354*             RESP     (WS-RESPONSE)
 13355*          END-EXEC
 13356     MOVE LENGTH OF
 13357      CERTIFICATE-TRAILERS
 13358       TO DFHEIV11
 13359*    MOVE '&$ L                  ''  N#00012666' TO DFHEIV0
 13360     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13362     MOVE X'204E233030303132363636' TO DFHEIV0(25:11)
 13363     CALL 'kxdfhei1' USING DFHEIV0,
 13364           ELCRTT-DSID,
 13365           CERTIFICATE-TRAILERS,
 13366           DFHEIV11,
 13367           cs-control-primary,
 13368           DFHEIV99,
 13369           DFHEIV99
 13370     MOVE EIBRESP  TO WS-RESPONSE
 13371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13372        end-if
 13373     END-IF
 13374
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 255
* EL156.cbl
 13375     .
 13376 2220-exit.
 13377     exit.
 13378
 13379 2225-upd-crt-trlr.
 13380
 13381*    if instypei = 'P'
 13382*       move +1 to s1
 13383*    else
 13384*       MOVE +2 to s1
 13385*    end-if
 13386
 13387*    move +1 to s1
 13388*    evaluate cl-claim-type
 13389*       when 'A'
 13390*          move +1 to s2
 13391*       when 'I'
 13392*          move +2 to s2
 13393*       when 'G'
 13394*          move +3 to s2
 13395*       when 'L'
 13396*          move +4 to s2
 13397*       when 'P'
 13398*          move +5 to s2
 13399*    end-evaluate
 13400     perform varying s1 from +1 by +1 until
 13401        (s1 > +24)
 13402        or (cl-claim-no = cs-claim-no (s1))
 13403     end-perform
 13404     if s1 < +25
 13405        compute cs-total-paid (s1) =
 13406           cs-total-paid (s1) + at-amount-paid
 13407        compute cs-days-paid (s1) =
 13408           cs-days-paid (s1) +  at-days-in-period
 13409*       compute cs-remaining-bens (s1) =
 13410*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13411        perform 2230-accum-bens-paid thru 2230-exit
 13412     end-if
 13413
 13414     .
 13415 2225-exit.
 13416     exit.
 13417 2230-accum-bens-paid.
 13418     if cl-claim-type not = 'L' and 'P'
 13419        move pi-ah-term          to ws-max-bens
 13420        if cl-critical-period not = zeros and spaces
 13421           move cl-critical-period
 13422                                 to ws-max-bens
 13423        end-if
 13424     else
 13425        move 01                  to ws-max-bens
 13426     end-if
 13427     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13428     perform varying s2 from +1 by +1 until
 13429        (s2 > +24)
 13430        or (cs-claim-no (s2) = spaces)
 13431        if pi-company-id not = 'DCC' and 'CAP'
 13432           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 256
* EL156.cbl
 13433              compute ws-tot-days-paid =
 13434                 ws-tot-days-paid + cs-days-paid (s2)
 13435              compute ws-tot-amt-paid =
 13436                 ws-tot-amt-paid + cs-total-paid (s2)
 13437           end-if
 13438        else
 13439           if (cs-benefit-period (s2) = cl-benefit-period)
 13440              and (cs-claim-type (s2) = cl-claim-type)
 13441              and (cs-insured-type (s2) = cl-insured-type)
 13442              compute ws-tot-days-paid =
 13443                 ws-tot-days-paid + cs-days-paid (s2)
 13444              compute ws-tot-amt-paid =
 13445                 ws-tot-amt-paid + cs-total-paid (s2)
 13446           end-if
 13447        end-if
 13448     end-perform
 13449     if cl-claim-type = 'L' and 'P'
 13450        if ws-tot-amt-paid > zeros
 13451           move zeros            to cs-remaining-bens (s1)
 13452        else
 13453           move 01               to cs-remaining-bens (s1)
 13454        end-if
 13455     else
 13456        compute ws-pd-bens rounded =
 13457           ws-tot-amt-paid / pi-ah-benefit-amt
 13458        compute cs-remaining-bens (s1) =
 13459           ws-max-bens - ws-pd-bens
 13460        if cs-remaining-bens (s1) < zeros
 13461           move zeros            to cs-remaining-bens (s1)
 13462        end-if
 13463     end-if
 13464     .
 13465 2230-exit.
 13466     exit.
 13467 3000-MOVE-INPUT-TO-SAVE-AREA.
 13468     IF PMTTYPEL > 0
 13469         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13470
 13471     if ws-pmttype = '4'
 13472        if pi-rb-joint-coverage
 13473           if payeel = +0
 13474              move +2            to payeel
 13475              move al-uanon      to payeea
 13476              move 'Q1'          to payeeo
 13477           else
 13478              if payeei not = 'Q1' and 'q1'
 13479                 move er-1582    to emi-error
 13480                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13481              end-if
 13482           end-if
 13483        end-if
 13484     end-if
 13485     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13486
 13487     IF WS-PMTTYPE = '9'
 13488         MOVE 'P'                TO PI-PROVISIONAL-IND
 13489         MOVE '1'                TO WS-PMTTYPE.
 13490
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 257
* EL156.cbl
 13491     IF PAYEEL > 0
 13492         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13493         MOVE PAYEEI             TO WS-PAYEE.
 13494
 13495     IF NOTE1L > +0
 13496         MOVE NOTE1I             TO WS-PMTNOTE1
 13497                                    WS-FLI-PMTNOTE
 13498                                    WS-HAN-PMTNOTE.
 13499
 13500     IF NOTE2L > +0
 13501         MOVE NOTE2I             TO WS-PMTNOTE2.
 13502
 13503     IF OFFLINEL > 0
 13504         MOVE OFFLINEI           TO WS-OFFLINE.
 13505
 13506     IF PROOFDTL > 0
 13507         MOVE PROOFDTI            TO DATE-WORK
 13508         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13509         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13510         MOVE '4'                 TO DC-OPTION-CODE
 13511         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13512         IF NO-CONVERSION-ERROR
 13513            MOVE NUM-WORK         TO PROOFDTO
 13514            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13515            MOVE NUM-WORK         TO WS-PROOF-DATE
 13516         ELSE
 13517            MOVE ZEROS            TO WS-PROOF-DATE
 13518         END-IF
 13519     END-IF.
 13520
 13521     IF EOBYNL > +0
 13522         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13523         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13524     END-IF
 13525
 13526     IF CLMFMYNL > +0
 13527         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13528         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13529     END-IF
 13530
 13531     IF SURVYYNL > +0
 13532         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13533         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13534     END-IF
 13535
 13536     IF SPRELYNL > +0
 13537         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13538         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13539     END-IF
 13540     if itrbynl <> +0
 13541        move function upper-case(itrbyni) to itrbyni
 13542        move itrbyni             to ws-int-to-rem-borr
 13543     end-if
 13544*    IF GROUPEDL > +0
 13545*        MOVE GROUPEDI           TO WS-GROUPED.
 13546*
 13547*    IF CASHL > +0
 13548*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 258
* EL156.cbl
 13549     IF LOANNOL > +0
 13550         MOVE LOANNOI            TO WS-LOAN-NO.
 13551
 13552     IF CHECKNOL > 0
 13553         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13554
 13555     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13556         IF WS-AIG-CREDIT-ENTERED
 13557             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13558             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13559             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13560             MOVE AL-UANON         TO CHECKNOA.
 13561
 13562     IF HOLDTILL > 0
 13563         MOVE HOLDTILI           TO DATE-WORK
 13564         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13565         MOVE NUM-WORK           TO WS-HOLDTIL.
 13566
 13567     IF ZINTL > +0
 13568
 13569* EXEC CICS BIF DEEDIT
 13570*           FIELD   (ZINTI)
 13571*           LENGTH  (07)
 13572*       END-EXEC
 13573     MOVE 07
 13574       TO DFHEIV11
 13575*    MOVE '@"L                   #   #00012868' TO DFHEIV0
 13576     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13577     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13578     MOVE X'2020233030303132383638' TO DFHEIV0(25:11)
 13579     CALL 'kxdfhei1' USING DFHEIV0,
 13580           ZINTI,
 13581           DFHEIV11
 13582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13583        IF ZINTI NOT NUMERIC
 13584           MOVE ER-0419          TO EMI-ERROR
 13585           PERFORM 9900-ERROR-FORMAT
 13586           MOVE AL-UABON         TO ZINTA
 13587           MOVE -1               TO ZINTL
 13588        ELSE
 13589           MOVE ZINTI            TO CP-INT-RATE
 13590                                    WS-INT-RATE
 13591           MOVE CP-INT-RATE      TO ZINTO
 13592           MOVE AL-UNNON         TO ZINTA
 13593        END-IF
 13594     ELSE
 13595        MOVE ZEROS               TO CP-INT-RATE
 13596     END-IF
 13597     IF EPYFROML > 0
 13598         MOVE EPYFROMI           TO DATE-WORK
 13599         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13600         MOVE NUM-WORK           TO WS-EPYFROM.
 13601
 13602     IF AIGFROML > 0
 13603         MOVE AIGFROMI           TO DATE-WORK
 13604         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13605         MOVE NUM-WORK           TO WS-AIGFROM
 13606     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 259
* EL156.cbl
 13607         IF (AIGFROMI = LOW-VALUES) AND
 13608            (PI-AIGFROM NOT = ZEROS)
 13609              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13610
 13611     IF EPYTHRUL > +0
 13612        MOVE EPYTHRUI           TO DATE-WORK
 13613        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13614        MOVE NUM-WORK           TO WS-EPYTHRU
 13615        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13616        MOVE '4'                TO DC-OPTION-CODE
 13617        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13618        IF NO-CONVERSION-ERROR
 13619           IF PI-USES-PAID-TO
 13620              MOVE '6'                TO DC-OPTION-CODE
 13621              MOVE -1                 TO DC-ELAPSED-DAYS
 13622              MOVE +0                 TO DC-ELAPSED-MONTHS
 13623              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13624              IF NO-CONVERSION-ERROR
 13625                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13626                 MOVE ' '             TO DC-OPTION-CODE
 13627                 MOVE +0              TO DC-ELAPSED-DAYS
 13628                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13629              IF NO-CONVERSION-ERROR
 13630                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13631
 13632*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13633*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13634     IF EDAYSL > 0
 13635
 13636* EXEC CICS BIF DEEDIT
 13637*            FIELD(EDAYSI)
 13638*            LENGTH(6)
 13639*        END-EXEC
 13640     MOVE 6
 13641       TO DFHEIV11
 13642*    MOVE '@"L                   #   #00012924' TO DFHEIV0
 13643     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13644     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13645     MOVE X'2020233030303132393234' TO DFHEIV0(25:11)
 13646     CALL 'kxdfhei1' USING DFHEIV0,
 13647           EDAYSI,
 13648           DFHEIV11
 13649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13650         MOVE EDAYSI             TO WS-DY-WORK
 13651         IF WS-DY-SIGN = SPACES
 13652            MOVE WS-DY-NUM       TO WS-EDAYS
 13653            ADD 0                TO WS-EDAYS
 13654         ELSE
 13655            MOVE EDAYSI          TO WS-EDAYS
 13656            ADD 0                TO WS-EDAYS.
 13657
 13658*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13659*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13660     IF EPYAMTL > 0
 13661
 13662* EXEC CICS BIF DEEDIT
 13663*            FIELD(EPYAMTI)
 13664*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 260
* EL156.cbl
 13665*        END-EXEC
 13666     MOVE 10
 13667       TO DFHEIV11
 13668*    MOVE '@"L                   #   #00012939' TO DFHEIV0
 13669     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13670     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13671     MOVE X'2020233030303132393339' TO DFHEIV0(25:11)
 13672     CALL 'kxdfhei1' USING DFHEIV0,
 13673           EPYAMTI,
 13674           DFHEIV11
 13675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13676         MOVE EPYAMTI            TO WS-PY-WORK
 13677         IF WS-PY-SIGN = SPACES
 13678            MOVE WS-PY-NUM       TO WS-EPYAMT
 13679            ADD 0                TO WS-EPYAMT
 13680         ELSE
 13681            MOVE EPYAMTI         TO WS-EPYAMT
 13682            ADD 0                TO WS-EPYAMT.
 13683
 13684     IF ERESVL > 0
 13685
 13686* EXEC CICS BIF DEEDIT
 13687*            FIELD(ERESVI)
 13688*            LENGTH(9)
 13689*        END-EXEC
 13690     MOVE 9
 13691       TO DFHEIV11
 13692*    MOVE '@"L                   #   #00012952' TO DFHEIV0
 13693     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13694     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13695     MOVE X'2020233030303132393532' TO DFHEIV0(25:11)
 13696     CALL 'kxdfhei1' USING DFHEIV0,
 13697           ERESVI,
 13698           DFHEIV11
 13699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13700         MOVE ERESVI TO WS-ERESV.
 13701
 13702     IF EEXPENSL > 0
 13703
 13704* EXEC CICS BIF DEEDIT
 13705*            FIELD(EEXPENSI)
 13706*            LENGTH(8)
 13707*        END-EXEC
 13708     MOVE 8
 13709       TO DFHEIV11
 13710*    MOVE '@"L                   #   #00012959' TO DFHEIV0
 13711     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13712     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13713     MOVE X'2020233030303132393539' TO DFHEIV0(25:11)
 13714     CALL 'kxdfhei1' USING DFHEIV0,
 13715           EEXPENSI,
 13716           DFHEIV11
 13717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13718         MOVE EEXPENSI           TO WS-EEXPENS.
 13719
 13720     IF ETYPEL > ZEROS
 13721         MOVE ETYPEI             TO WS-ETYPE.
 13722
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 261
* EL156.cbl
 13723     IF PI-COMPANY-ID = 'BOA'
 13724        IF PINTL > ZEROS
 13725
 13726* EXEC CICS BIF DEEDIT
 13727*            FIELD (PINTI)
 13728*            LENGTH(05)
 13729*          END-EXEC
 13730     MOVE 05
 13731       TO DFHEIV11
 13732*    MOVE '@"L                   #   #00012970' TO DFHEIV0
 13733     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13734     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13735     MOVE X'2020233030303132393730' TO DFHEIV0(25:11)
 13736     CALL 'kxdfhei1' USING DFHEIV0,
 13737           PINTI,
 13738           DFHEIV11
 13739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13740           IF PINTI NUMERIC
 13741               MOVE AL-UNNON     TO PINTA
 13742               MOVE PINTI        TO WS-INT-RATE
 13743               MOVE WS-INT-RATE  TO PINTO.
 13744
 13745 3000-EXIT.
 13746     EXIT.
 13747
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 262
* EL156.cbl
 13749 3050-REBUILD-ENTERED.
 13750
 13751     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13752
 13753     IF PI-PROV-PMT
 13754         MOVE '9'           TO PMTTYPEO
 13755     ELSE
 13756         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13757
 13758     MOVE PI-PAYEE          TO PAYEEO.
 13759     MOVE PI-PMTNOTE1       TO NOTE1O.
 13760     MOVE PI-PMTNOTE2       TO NOTE2O.
 13761     MOVE PI-OFFLINE        TO OFFLINEO.
 13762     IF PI-PROOF-DATE NOT = ZEROS
 13763         MOVE PI-PROOF-DATE TO PROOFDTO
 13764         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13765     END-IF.
 13766*    MOVE PI-GROUPED        TO GROUPEDO.
 13767
 13768*    MOVE PI-CASH           TO CASHO.
 13769
 13770     IF PI-INT-RATE > ZEROS
 13771        MOVE PI-INT-RATE         TO PINTO
 13772     end-if
 13773     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13774        IF PI-INT-AMT > ZEROS
 13775           MOVE PI-INT-AMT       TO PINTO
 13776           MOVE AL-PANOF         TO PINTA
 13777                                    PINTHA
 13778           if pi-rb-joint-coverage
 13779              move '  INT TO'    to itrb1o
 13780              move ' REM BORR?'  to itrb2o
 13781              move 'Y'           to itrbyno
 13782              move al-uanon      to itrbyna
 13783              move +1            to itrbynl
 13784           end-if
 13785        END-IF
 13786     END-IF
 13787     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13788     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13789     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13790     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13791     IF PI-HOLDTIL NOT = ZEROS
 13792        MOVE PI-HOLDTIL          TO HOLDTILO
 13793        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13794
 13795     IF PI-EPYFROM NOT = ZEROS
 13796        MOVE PI-EPYFROM          TO EPYFROMO
 13797        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13798
 13799     IF PI-AIGFROM NOT = ZEROS
 13800        MOVE PI-AIGFROM          TO AIGFROMO
 13801        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13802
 13803     IF PI-EPYTHRU NOT = ZEROS
 13804        MOVE PI-EPYTHRU          TO EPYTHRUO
 13805        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13806        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 263
* EL156.cbl
 13807           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13808           MOVE '4'                TO DC-OPTION-CODE
 13809           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13810           IF NO-CONVERSION-ERROR
 13811              MOVE +1 TO DC-ELAPSED-DAYS
 13812              MOVE +0 TO DC-ELAPSED-MONTHS
 13813              MOVE '6' TO DC-OPTION-CODE
 13814              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13815              IF NO-CONVERSION-ERROR
 13816                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13817
 13818     IF PI-EDAYS NOT = ZEROS
 13819        MOVE PI-EDAYS TO EDAYSO.
 13820
 13821     IF PI-EPYAMT NOT = ZEROS
 13822        MOVE PI-EPYAMT TO EPYAMTO.
 13823
 13824     IF PI-ERESV NOT = ZEROS
 13825        MOVE PI-ERESV TO ERESVO.
 13826
 13827     IF PI-EEXPENS NOT = ZEROS
 13828        MOVE PI-EEXPENS TO EEXPENSO.
 13829
 13830     MOVE PI-ETYPE TO ETYPEO.
 13831
 13832     IF PI-ECHECKNO NOT = SPACES
 13833        MOVE PI-ECHECKNO         TO CHECKNOO
 13834     ELSE
 13835        MOVE PI-CCHECKNO         TO CHECKNOO.
 13836
 13837     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13838     MOVE SPACES                 TO DC-OPTION-CODE.
 13839     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13840
 13841     IF DATE-CONVERSION-ERROR
 13842        MOVE SPACES              TO CPYFROMI
 13843     ELSE
 13844        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13845
 13846     IF PI-USES-PAID-TO
 13847        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13848        MOVE +1                  TO DC-ELAPSED-DAYS
 13849        MOVE +0                  TO DC-ELAPSED-MONTHS
 13850        MOVE '6'                 TO DC-OPTION-CODE
 13851        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13852        IF NO-CONVERSION-ERROR
 13853           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13854           GO TO 3051-CONTINUE.
 13855
 13856     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13857     MOVE SPACES                 TO DC-OPTION-CODE.
 13858     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13859
 13860     IF DATE-CONVERSION-ERROR
 13861        MOVE SPACES              TO CPYTHRUI
 13862     ELSE
 13863        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13864
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 264
* EL156.cbl
 13865 3051-CONTINUE.
 13866
 13867     IF PI-CDAYS NOT = ZEROS
 13868        MOVE PI-CDAYS TO CDAYSO.
 13869
 13870     IF PI-CPYAMT NOT = ZEROS
 13871        MOVE PI-CPYAMT TO CPYAMTO.
 13872
 13873     IF PI-CRESV NOT = ZEROS
 13874        MOVE PI-CRESV TO CRESVO.
 13875
 13876     IF PI-CEXPENS NOT = ZEROS
 13877        MOVE PI-CEXPENS TO CEXPENSO.
 13878
 13879 3059-EXIT.
 13880     EXIT.
 13881
 13882 3100-DEEDIT-DATE.
 13883
 13884* EXEC CICS BIF DEEDIT
 13885*        FIELD(DATE-WORK)
 13886*        LENGTH(8)
 13887*    END-EXEC.
 13888     MOVE 8
 13889       TO DFHEIV11
 13890*    MOVE '@"L                   #   #00013117' TO DFHEIV0
 13891     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13892     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13893     MOVE X'2020233030303133313137' TO DFHEIV0(25:11)
 13894     CALL 'kxdfhei1' USING DFHEIV0,
 13895           DATE-WORK,
 13896           DFHEIV11
 13897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13898
 13899
 13900 3100-EXIT.
 13901     EXIT.
 13902
 13903 3200-CALC-AIG-DAYS.
 13904
 13905     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13906
 13907     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13908     MOVE ' '                    TO DC-OPTION-CODE.
 13909     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13910     IF NO-CONVERSION-ERROR
 13911         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13912     ELSE
 13913         GO TO 3290-ERROR.
 13914
 13915     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13916         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13917                                WS-BIN-FROM-DT
 13918     ELSE
 13919         IF CL-TOTAL-PAID-AMT > ZEROS
 13920             IF WS-SV-EPYFROM = LOW-VALUES
 13921                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13922                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 265
* EL156.cbl
 13923             ELSE
 13924                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13925                                        WS-BIN-FROM-DT
 13926         ELSE
 13927             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13928                                        WS-BIN-FROM-DT.
 13929
 13930 3210-CONTINUE.
 13931
 13932     MOVE ' '                    TO DC-OPTION-CODE.
 13933     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13934     IF DATE-CONVERSION-ERROR
 13935         GO TO 3290-ERROR.
 13936
 13937     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13938
 13939     IF PI-LOAN-DUE-DAY = 31
 13940         MOVE 30              TO WS-PMT-DUE-DA
 13941                                 WS-SAVE-DUE-DA
 13942     ELSE
 13943         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13944                                 WS-SAVE-DUE-DA.
 13945
 13946     IF (PI-LOAN-DUE-DAY > 28) AND
 13947        (WS-PMT-DUE-MO = 2)
 13948         MOVE 'Y'                TO WS-DUE-DAY-SW
 13949         MOVE 28                 TO WS-PMT-DUE-DA.
 13950
 13951     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13952     MOVE '4'                    TO DC-OPTION-CODE.
 13953     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13954     IF NO-CONVERSION-ERROR
 13955         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13956     ELSE
 13957         GO TO 3290-ERROR.
 13958
 13959*--------------------------------------------------------------*
 13960*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13961*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13962*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13963*                                                              *
 13964*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13965*             INCURRED DATE      - 04/15/91                    *
 13966*             PMT DUE DATE       - 04/03/91                    *
 13967*             PMT DUE DATE       - 05/03/91                    *
 13968*--------------------------------------------------------------*
 13969
 13970     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13971        (WS-SV-AIGFROM = LOW-VALUES)
 13972         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13973            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13974             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13975             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13976             IF NO-CONVERSION-ERROR
 13977                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13978                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13979             ELSE
 13980                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 266
* EL156.cbl
 13981
 13982     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13983        (WS-SV-AIGFROM = LOW-VALUES)
 13984         GO TO 3205-CONT-CALC-PMT.
 13985
 13986     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13987     MOVE ' '                    TO DC-OPTION-CODE.
 13988     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13989     IF NO-CONVERSION-ERROR
 13990         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13991     ELSE
 13992         GO TO 3290-ERROR.
 13993
 13994     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13995        (WS-PMT-DUE-DA < WS-FROM-DA)
 13996          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13997          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13998          IF NO-CONVERSION-ERROR
 13999              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14000              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14001          ELSE
 14002              GO TO 3290-ERROR.
 14003
 14004 3205-CONT-CALC-PMT.
 14005
 14006*--------------------------------------------------------------*
 14007*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14008*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14009*--------------------------------------------------------------*
 14010
 14011     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14012        PI-PMTTYPE = '2'
 14013          NEXT SENTENCE
 14014     ELSE
 14015        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14016           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14017             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14018             MOVE ER-3527            TO EMI-ERROR
 14019             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14020             MOVE -1                 TO EPYTHRUL
 14021             MOVE AL-UNBON           TO EPYTHRUA
 14022                                        EPYFROMA
 14023             GO TO 3299-EXIT.
 14024
 14025*--------------------------------------------------------------*
 14026*    CALCULATE RETRO ELIMINATION DATE                          *
 14027*--------------------------------------------------------------*
 14028
 14029     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14030         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14031     ELSE
 14032         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14033
 14034     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14035     MOVE +0             TO DC-ELAPSED-MONTHS.
 14036     MOVE '6'            TO DC-OPTION-CODE.
 14037     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14038     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 267
* EL156.cbl
 14039         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14040     ELSE
 14041         GO TO 3290-ERROR.
 14042
 14043 3210-CHECK-PMT-DATE.
 14044
 14045*--------------------------------------------------------------*
 14046*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14047*    THE ENTERED PAY FROM DATE                                 *
 14048*--------------------------------------------------------------*
 14049
 14050     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14051         NEXT SENTENCE
 14052     ELSE
 14053         GO TO 3220-COMPUTE-DAYS.
 14054
 14055     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14056     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14057     IF NO-CONVERSION-ERROR
 14058         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14059         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14060         GO TO 3210-CHECK-PMT-DATE
 14061     ELSE
 14062         GO TO 3290-ERROR.
 14063
 14064 3220-COMPUTE-DAYS.
 14065
 14066     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14067     MOVE ZEROS         TO WS-CDAYS.
 14068     MOVE 'N'           TO WS-ELIMINATION-SW.
 14069
 14070*--------------------------------------------------------------*
 14071*    COMPUTE CALIFORNIA DUE DAYS                               *
 14072*--------------------------------------------------------------*
 14073
 14074     IF CL-TOTAL-PAID-AMT > ZEROS
 14075         MOVE 'Y' TO WS-ELIMINATION-SW
 14076         GO TO 3240-FIRST-PMT-DUE
 14077     ELSE
 14078        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14079            NEXT SENTENCE
 14080        ELSE
 14081            GO TO 3240-FIRST-PMT-DUE.
 14082
 14083 3230-NEXT-PMT-DUE.
 14084
 14085     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14086     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14087     IF NO-CONVERSION-ERROR
 14088         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14089         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14090     ELSE
 14091         GO TO 3290-ERROR.
 14092
 14093 3240-FIRST-PMT-DUE.
 14094
 14095     IF CL-TOTAL-PAID-AMT > ZEROS
 14096         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 268
* EL156.cbl
 14097     ELSE
 14098        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14099            GO TO 3230-NEXT-PMT-DUE.
 14100
 14101     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14102         GO TO 3250-VERIFY-ELIMINATION.
 14103
 14104     ADD +30 TO WS-CDAYS.
 14105     MOVE 'Y' TO WS-ELIMINATION-SW.
 14106     GO TO 3230-NEXT-PMT-DUE.
 14107
 14108 3250-VERIFY-ELIMINATION.
 14109
 14110     IF ELIM-SATISFIED
 14111         GO TO 3260-END-CALC.
 14112
 14113     IF PI-PMTTYPE = '1'
 14114         MOVE ZEROS TO WS-CDAYS
 14115         GO TO 3260-END-CALC.
 14116
 14117     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14118         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14119     ELSE
 14120         IF CL-TOTAL-PAID-AMT > ZEROS
 14121             IF WS-SV-EPYFROM = LOW-VALUES
 14122                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14123             ELSE
 14124                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14125         ELSE
 14126             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14127
 14128     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14129     MOVE '1'                    TO DC-OPTION-CODE.
 14130     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14131     IF NO-CONVERSION-ERROR
 14132         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14133     ELSE
 14134         GO TO 3290-ERROR.
 14135
 14136     IF CL-TOTAL-PAID-AMT > ZEROS
 14137         MOVE WS-DAYS-OFF TO WS-CDAYS
 14138     ELSE
 14139         IF PI-BEN-DAYS > WS-DAYS-OFF
 14140             MOVE ZEROS TO WS-CDAYS
 14141         ELSE
 14142             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14143
 14144 3260-END-CALC.
 14145
 14146     MOVE WS-CDAYS TO PI-CDAYS.
 14147
 14148     IF PI-EDAYS = ZEROS
 14149         MOVE PI-CDAYS TO PI-EDAYS
 14150         MOVE AL-UNNON TO EDAYSA.
 14151
 14152     GO TO 3299-EXIT.
 14153
 14154 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 269
* EL156.cbl
 14155
 14156     MOVE ER-3528            TO EMI-ERROR.
 14157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14158     MOVE -1                 TO CDAYSL.
 14159     MOVE AL-UNBON           TO CDAYSA.
 14160
 14161 3299-EXIT.
 14162     EXIT.
 14163
 14164 3300-BUMP-DATE.
 14165
 14166     IF WS-RESTORE-DUE-DAY
 14167         MOVE 'N'              TO WS-DUE-DAY-SW
 14168         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14169         ADD 1                 TO WS-PMT-DUE-MO
 14170         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14171         MOVE '4'              TO DC-OPTION-CODE
 14172         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14173         IF NO-CONVERSION-ERROR
 14174             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14175             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14176             GO TO 3399-EXIT
 14177         ELSE
 14178             MOVE '9'          TO DC-ERROR-CODE
 14179             GO TO 3399-EXIT.
 14180
 14181     IF (WS-PMT-DUE-MO = 1) AND
 14182        (WS-SAVE-DUE-DA > 28)
 14183           MOVE 'Y' TO WS-DUE-DAY-SW.
 14184
 14185     MOVE +0                 TO DC-ELAPSED-DAYS.
 14186     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14187     MOVE '6'                TO DC-OPTION-CODE.
 14188     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14189
 14190 3399-EXIT.
 14191     EXIT.
 14192
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 270
* EL156.cbl
 14194 3400-COMPUTE-EXPIRY.
 14195
 14196     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14197     MOVE +0                    TO DC-ELAPSED-DAYS
 14198                                   DC-ODD-DAYS-OVER.
 14199     MOVE '1'                   TO DC-END-OF-MONTH.
 14200     MOVE '6'                   TO DC-OPTION-CODE.
 14201
 14202     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14203         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14204     ELSE
 14205         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14206
 14207     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14208     IF NO-CONVERSION-ERROR
 14209         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14210     ELSE
 14211         GO TO 3390-CONTINUE.
 14212
 14213     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14214         GO TO 3390-CONTINUE.
 14215
 14216     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14217     MOVE '4'                    TO CNTL-REC-TYPE.
 14218     MOVE +0                     TO CNTL-SEQ-NO.
 14219     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14220     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14221     MOVE 'BENE'                 TO FILE-SWITCH.
 14222
 14223     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14224
 14225     IF NO-BENEFIT-FOUND
 14226         GO TO 3390-CONTINUE.
 14227
 14228     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 14229        IF (PI-OFFLINE = 'Y') OR
 14230           (PI-PMTTYPE = '7')
 14231           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14232                                     THRU 9870-EXIT
 14233           IF ERROR-ON-OUTPUT
 14234             MOVE -1                 TO ENTERPFL
 14235             MOVE AL-UANON           TO ENTERPFA
 14236             MOVE MAP-NAMEA          TO MAP-NAME
 14237             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14238             GO TO 8200-SEND-DATAONLY.
 14239
 14240     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14241        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14242        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14243          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14244          MOVE +0        TO DC-ELAPSED-DAYS
 14245          MOVE +1        TO DC-ELAPSED-MONTHS
 14246          MOVE 6         TO DC-OPTION-CODE
 14247          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14248          IF NO-CONVERSION-ERROR
 14249              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14250
 14251 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 271
* EL156.cbl
 14252
 14253      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14254         MOVE CM-AH-LOAN-EXPIRE-DT
 14255                                 TO DC-BIN-DATE-1
 14256      ELSE
 14257         MOVE CM-LF-LOAN-EXPIRE-DT
 14258                                 TO DC-BIN-DATE-1
 14259      END-IF
 14260
 14261      MOVE ' '                    TO DC-OPTION-CODE.
 14262      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14263      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14264      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14265
 14266 3499-EXIT.
 14267     EXIT.
 14268
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 272
* EL156.cbl
 14270
 14271 3600-CHECK-VERIFICATION.
 14272
 14273     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14274
 14275     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14276
 14277     IF PI-PAYEE-TYPE = 'I'
 14278        GO TO 3600-READ-TRAILER.
 14279
 14280     IF PI-PAYEE-TYPE = 'B'
 14281        ADD +10                  TO TRLR-SEQ-NO
 14282        GO TO 3600-READ-TRAILER.
 14283
 14284     IF PI-PAYEE-TYPE = 'A'
 14285        ADD +20                  TO TRLR-SEQ-NO
 14286        GO TO 3600-READ-TRAILER.
 14287
 14288     IF PI-PAYEE-TYPE = 'O'
 14289        ADD +50                  TO TRLR-SEQ-NO
 14290        GO TO 3600-READ-TRAILER.
 14291
 14292     IF PI-PAYEE-TYPE = 'Q'
 14293        ADD +60                  TO TRLR-SEQ-NO
 14294        GO TO 3600-READ-TRAILER.
 14295
 14296     IF PI-PAYEE-TYPE = 'P'
 14297        ADD +30                  TO TRLR-SEQ-NO
 14298        GO TO 3600-READ-TRAILER.
 14299
 14300     IF PI-PAYEE-TYPE = 'E'
 14301        ADD +40                  TO TRLR-SEQ-NO.
 14302
 14303 3600-READ-TRAILER.
 14304
 14305
 14306* EXEC CICS HANDLE CONDITION
 14307*         NOTFND(3600-CONTINUE)
 14308*    END-EXEC.
 14309*    MOVE '"$I                   ! - #00013527' TO DFHEIV0
 14310     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14312     MOVE X'2D20233030303133353237' TO DFHEIV0(25:11)
 14313     CALL 'kxdfhei1' USING DFHEIV0
 14314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14315
 14316
 14317     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14318
 14319 3600-CONTINUE.
 14320
 14321     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14322         GO TO 3600-AH-VERIFY
 14323     END-IF.
 14324
 14325     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14326       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14327         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 273
* EL156.cbl
 14328           MOVE ER-7576            TO EMI-ERROR
 14329           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14330           MOVE -1                 TO PAYEEL
 14331           MOVE AL-UABON           TO PAYEEA
 14332           GO TO 3600-EXIT
 14333         END-IF
 14334       END-IF
 14335     END-IF.
 14336
 14337     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14338     MOVE 1 TO WS-SUB2
 14339     MOVE SPACES TO WS-PAYEE-NAME
 14340     PERFORM VARYING WS-SUB FROM 1 BY 1
 14341             UNTIL WS-SUB > 30
 14342         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14343            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14344                 WS-PAYEE-NAME-X (WS-SUB2)
 14345            ADD +1 TO WS-SUB2
 14346         END-IF
 14347     END-PERFORM.
 14348
 14349     STRING CL-INSURED-1ST-NAME
 14350            CL-INSURED-MID-INIT
 14351            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14352     MOVE 1 TO WS-SUB2
 14353     MOVE SPACES TO WS-INSURED-NAME
 14354     PERFORM VARYING WS-SUB FROM 1 BY 1
 14355             UNTIL WS-SUB > 30
 14356         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14357            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14358                 WS-INSURED-NAME-X (WS-SUB2)
 14359            ADD +1 TO WS-SUB2
 14360         END-IF
 14361     END-PERFORM.
 14362
 14363     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14364        MOVE ER-7579            TO EMI-ERROR
 14365        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14366        MOVE -1                 TO PAYEEL
 14367        MOVE AL-UABON           TO PAYEEA
 14368     END-IF.
 14369
 14370     IF PI-PMTTYPE = '4'  AND
 14371        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14372        PI-PAYEE-TYPE <> 'I'
 14373          MOVE ER-7580          TO EMI-ERROR
 14374          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14375          MOVE -1               TO PAYEEL
 14376          MOVE AL-UABON         TO PAYEEA
 14377     END-IF.
 14378
 14379     GO TO 3600-EXIT.
 14380
 14381 3600-AH-VERIFY.
 14382
 14383     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14384        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14385           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 274
* EL156.cbl
 14386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14387           MOVE -1                 TO PAYEEL
 14388           MOVE AL-UABON           TO PAYEEA
 14389        END-IF
 14390     END-IF.
 14391
 14392
 14393 3600-EXIT.
 14394     EXIT.
 14395
 14396 5000-UPDATE.
 14397
 14398     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14399
 14400     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14401
 14402     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14403        PI-OFFLINE = 'Y'
 14404        NEXT SENTENCE
 14405     ELSE
 14406        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14407
 14408*    IF PI-COMPANY-ID = 'CRI'
 14409*       IF PI-PMTTYPE = '1' OR  '2'
 14410*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14411*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14412*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14413
 14414*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14415*       IF PI-PMTTYPE = '1'
 14416*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14417*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14418
 14419     IF PI-PMTTYPE      = '2' AND
 14420        PI-SPLIT-PMT-SW = 'Y' AND
 14421        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14422          MOVE ER-3530                TO EMI-ERROR
 14423          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14424
 14425     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14426        AND (CL-CLAIM-TYPE = 'L')
 14427        IF PI-PMTTYPE = '2' OR '4'
 14428           IF PI-INT-AMT NOT = ZEROS
 14429              PERFORM 7110-BUILD-PMT-TRLR
 14430                                 THRU 7130-EXIT
 14431           ELSE
 14432              IF PI-PMTTYPE = '2'
 14433                 PERFORM 7140-BUILD-NOTE-TRLR
 14434                                 THRU 7170-EXIT
 14435              END-IF
 14436           END-IF
 14437        END-IF
 14438     END-IF
 14439*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14440*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14441*            MOVE 'N'                 TO  WS-LETTER-SW.
 14442
 14443*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 275
* EL156.cbl
 14444*        IF CL-NO-OF-PMTS-MADE = +1
 14445*                OR
 14446*           PI-PMTTYPE = '2'
 14447*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14448
 14449     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14450
 14451*    IF PI-COMPANY-ID = 'DMD'
 14452*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14453*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14454
 14455
 14456* EXEC CICS REWRITE
 14457*         DATASET('ELMSTR')
 14458*         FROM(CLAIM-MASTER)
 14459*     END-EXEC.
 14460     MOVE LENGTH OF
 14461      CLAIM-MASTER
 14462       TO DFHEIV11
 14463     MOVE 'ELMSTR' TO DFHEIV1
 14464*    MOVE '&& L                  %   #00013669' TO DFHEIV0
 14465     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14466     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14467     MOVE X'2020233030303133363639' TO DFHEIV0(25:11)
 14468     CALL 'kxdfhei1' USING DFHEIV0,
 14469           DFHEIV1,
 14470           CLAIM-MASTER,
 14471           DFHEIV11,
 14472           DFHEIV99
 14473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14474
 14475
 14476     IF WS-LETTER-SW = 'N'
 14477         GO TO 5000-END-UPDATE.
 14478
 14479 5000-GENERATE-AUTO-LETTER.
 14480
 14481
 14482* EXEC CICS LINK
 14483*        PROGRAM    (LINK-1523)
 14484*        COMMAREA   (W-1523-LINKDATA)
 14485*        LENGTH     (W-1523-COMM-LENGTH)
 14486*    END-EXEC.
 14487*    MOVE '."C                   (   #00013679' TO DFHEIV0
 14488     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14490     MOVE X'2020233030303133363739' TO DFHEIV0(25:11)
 14491     CALL 'kxdfhei1' USING DFHEIV0,
 14492           LINK-1523,
 14493           W-1523-LINKDATA,
 14494           W-1523-COMM-LENGTH,
 14495           DFHEIV99,
 14496           DFHEIV99,
 14497           DFHEIV99,
 14498           DFHEIV99
 14499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14500
 14501
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 276
* EL156.cbl
 14502     IF W-1523-FATAL-ERROR
 14503         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14505         MOVE ER-0802                TO  EMI-ERROR
 14506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14507
 14508     IF W-1523-ERROR-CODE = 0191
 14509         MOVE ER-0803                TO  EMI-ERROR
 14510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14511
 14512     IF PI-COMPANY-ID      = 'HAN' AND
 14513        PI-PMTTYPE         = '1'   AND
 14514        PI-3RD-PARTY-SW    = 'Y'   AND
 14515        W-1523-FORM-NUMBER = 'EOB1'
 14516           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14517           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14518           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14519           GO TO 5000-GENERATE-AUTO-LETTER.
 14520
 14521 5000-END-UPDATE.
 14522
 14523     MOVE ER-0000                TO EMI-ERROR.
 14524     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14525     GO TO 7000-SHOW-CLAIM.
 14526
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 277
* EL156.cbl
 14528 5000-MOVE-NAME.
 14529     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14530     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14531     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14532
 14533 5000-EXIT.
 14534     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 278
* EL156.cbl
 14536 5300-CREATE-DMO.
 14537
 14538     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14539     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14540     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14541
 14542
 14543* EXEC CICS HANDLE CONDITION
 14544*         NOTFND   (5300-NOTE-NOT-FOUND)
 14545*    END-EXEC.
 14546*    MOVE '"$I                   ! . #00013725' TO DFHEIV0
 14547     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14549     MOVE X'2E20233030303133373235' TO DFHEIV0(25:11)
 14550     CALL 'kxdfhei1' USING DFHEIV0
 14551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14552
 14553
 14554
 14555* EXEC CICS READ
 14556*         DATASET('ERNOTE')
 14557*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14558*         RIDFLD (W-NOTE-KEY)
 14559*    END-EXEC.
 14560     MOVE 'ERNOTE' TO DFHEIV1
 14561*    MOVE '&"S        E          (   #00013729' TO DFHEIV0
 14562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14564     MOVE X'2020233030303133373239' TO DFHEIV0(25:11)
 14565     CALL 'kxdfhei1' USING DFHEIV0,
 14566           DFHEIV1,
 14567           DFHEIV20,
 14568           DFHEIV99,
 14569           W-NOTE-KEY,
 14570           DFHEIV99,
 14571           DFHEIV99,
 14572           DFHEIV99
 14573     SET ADDRESS OF CERTIFICATE-NOTE TO
 14574         DFHEIV20
 14575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14576
 14577
 14578     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14579     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14580     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14581
 14582     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14583         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14584     ELSE
 14585         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14586
 14587     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14588     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14589     MOVE 'DLO006'               TO PGM-NAME.
 14590
 14591
 14592* EXEC CICS LINK
 14593*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 279
* EL156.cbl
 14594*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14595*        LENGTH     (DCT-RCRD-LENGTH)
 14596*    END-EXEC.
 14597*    MOVE '."C                   (   #00013748' TO DFHEIV0
 14598     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14600     MOVE X'2020233030303133373438' TO DFHEIV0(25:11)
 14601     CALL 'kxdfhei1' USING DFHEIV0,
 14602           PGM-NAME,
 14603           DCT-COMMUNICATION-AREA,
 14604           DCT-RCRD-LENGTH,
 14605           DFHEIV99,
 14606           DFHEIV99,
 14607           DFHEIV99,
 14608           DFHEIV99
 14609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14610
 14611
 14612     IF DCT-RETURN-CODE = 'OK'
 14613         GO TO 5300-CONT.
 14614
 14615     IF DCT-RETURN-CODE = '01' OR '02'
 14616         GO TO 5300-EXIT.
 14617
 14618     IF DCT-RETURN-CODE = '03'
 14619         MOVE ER-0951            TO EMI-ERROR
 14620         GO TO 5300-BAD-EXIT.
 14621
 14622     IF DCT-RETURN-CODE = '04'
 14623         MOVE ER-0946            TO EMI-ERROR
 14624         GO TO 5300-BAD-EXIT.
 14625
 14626     IF DCT-RETURN-CODE = '05'
 14627         MOVE ER-0947            TO EMI-ERROR
 14628         GO TO 5300-BAD-EXIT.
 14629
 14630     IF DCT-RETURN-CODE = '06'
 14631         MOVE ER-0921            TO EMI-ERROR
 14632         GO TO 5300-BAD-EXIT.
 14633
 14634     IF DCT-RETURN-CODE = '07'
 14635         MOVE ER-0849            TO EMI-ERROR
 14636         GO TO 5300-BAD-EXIT.
 14637
 14638     IF DCT-RETURN-CODE = '08'
 14639         MOVE ER-0948            TO EMI-ERROR
 14640         GO TO 5300-BAD-EXIT.
 14641
 14642     IF DCT-RETURN-CODE = 'N1'
 14643         MOVE ER-0950            TO EMI-ERROR
 14644         GO TO 5300-BAD-EXIT.
 14645
 14646     IF DCT-RETURN-CODE = 'E1'
 14647         MOVE ER-0974            TO EMI-ERROR
 14648         GO TO 5300-BAD-EXIT.
 14649
 14650     IF DCT-RETURN-CODE = 'E2'
 14651         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 280
* EL156.cbl
 14652         GO TO 5300-BAD-EXIT.
 14653
 14654     IF DCT-RETURN-CODE NOT = 'OK'
 14655         MOVE ER-0949            TO EMI-ERROR
 14656         GO TO 5300-BAD-EXIT.
 14657
 14658 5300-CONT.
 14659
 14660     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14661     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14662     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14663     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14664     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14665     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14666     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14667     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14668
 14669     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14670     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14671     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14672     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14673     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14674
 14675     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14676
 14677     IF PI-PMTTYPE = '2'
 14678         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14679         MOVE '4'                TO DM-CLAIM-STATUS
 14680     ELSE
 14681         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14682         MOVE '2'                TO DM-CLAIM-STATUS.
 14683
 14684     MOVE 'DLO025'               TO PGM-NAME.
 14685
 14686
 14687* EXEC CICS LINK
 14688*        PROGRAM    (PGM-NAME)
 14689*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14690*        LENGTH     (DM-DMO-LENGTH)
 14691*    END-EXEC.
 14692*    MOVE '."C                   (   #00013828' TO DFHEIV0
 14693     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14695     MOVE X'2020233030303133383238' TO DFHEIV0(25:11)
 14696     CALL 'kxdfhei1' USING DFHEIV0,
 14697           PGM-NAME,
 14698           DMO-COMMUNICATION-AREA,
 14699           DM-DMO-LENGTH,
 14700           DFHEIV99,
 14701           DFHEIV99,
 14702           DFHEIV99,
 14703           DFHEIV99
 14704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14705
 14706
 14707     IF DM-RETURN-CODE = 'OK'
 14708         GO TO 5300-EXIT.
 14709
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 281
* EL156.cbl
 14710     IF DM-RETURN-CODE = '01'
 14711         MOVE ER-8051            TO EMI-ERROR
 14712         GO TO 5300-BAD-EXIT.
 14713
 14714     IF DM-RETURN-CODE = '02'
 14715         MOVE ER-8052            TO EMI-ERROR
 14716         GO TO 5300-BAD-EXIT.
 14717
 14718     IF DM-RETURN-CODE = '03'
 14719         MOVE ER-8053            TO EMI-ERROR
 14720         GO TO 5300-BAD-EXIT.
 14721
 14722     IF DM-RETURN-CODE = '04'
 14723         MOVE ER-8054            TO EMI-ERROR
 14724         GO TO 5300-BAD-EXIT.
 14725
 14726     IF DM-RETURN-CODE = '05'
 14727         MOVE ER-8055            TO EMI-ERROR
 14728         GO TO 5300-BAD-EXIT.
 14729
 14730     IF DM-RETURN-CODE = '06'
 14731         MOVE ER-8056            TO EMI-ERROR
 14732         GO TO 5300-BAD-EXIT.
 14733
 14734     IF DM-RETURN-CODE = '07'
 14735         MOVE ER-8057            TO EMI-ERROR
 14736         GO TO 5300-BAD-EXIT.
 14737
 14738     IF DM-RETURN-CODE = '08'
 14739         MOVE ER-8058            TO EMI-ERROR
 14740         GO TO 5300-BAD-EXIT.
 14741
 14742     IF DM-RETURN-CODE = '09'
 14743         MOVE ER-8059            TO EMI-ERROR
 14744         GO TO 5300-BAD-EXIT.
 14745
 14746     IF DM-RETURN-CODE = '10'
 14747         MOVE ER-8060            TO EMI-ERROR
 14748         GO TO 5300-BAD-EXIT.
 14749
 14750     IF DM-RETURN-CODE = '11'
 14751         MOVE ER-8061            TO EMI-ERROR
 14752         GO TO 5300-BAD-EXIT.
 14753
 14754     IF DM-RETURN-CODE = '12'
 14755         MOVE ER-8062            TO EMI-ERROR
 14756         GO TO 5300-BAD-EXIT.
 14757
 14758     IF DM-RETURN-CODE = '13'
 14759         MOVE ER-8063            TO EMI-ERROR
 14760         GO TO 5300-BAD-EXIT.
 14761
 14762     IF DM-RETURN-CODE = '14'
 14763         MOVE ER-8064            TO EMI-ERROR
 14764         GO TO 5300-BAD-EXIT.
 14765
 14766     IF DM-RETURN-CODE = '15'
 14767         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 282
* EL156.cbl
 14768         GO TO 5300-BAD-EXIT.
 14769
 14770     IF DM-RETURN-CODE = '16'
 14771         MOVE ER-8154            TO EMI-ERROR
 14772         GO TO 5300-BAD-EXIT.
 14773
 14774     IF DM-RETURN-CODE = '17'
 14775         MOVE ER-8155            TO EMI-ERROR
 14776         GO TO 5300-BAD-EXIT.
 14777
 14778     IF DM-RETURN-CODE = 'N1'
 14779         MOVE ER-8152            TO EMI-ERROR
 14780         GO TO 5300-BAD-EXIT.
 14781
 14782     IF DM-RETURN-CODE = 'E1'
 14783         MOVE ER-8153            TO EMI-ERROR
 14784         GO TO 5300-BAD-EXIT.
 14785
 14786     MOVE ER-8066            TO EMI-ERROR.
 14787     GO TO 5300-BAD-EXIT.
 14788
 14789 5300-NOTE-NOT-FOUND.
 14790
 14791     MOVE ER-0954                TO EMI-ERROR.
 14792     GO TO 5300-BAD-EXIT.
 14793
 14794 5300-BAD-EXIT.
 14795
 14796* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14797*    MOVE '6"R                   !   #00013922' TO DFHEIV0
 14798     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14800     MOVE X'2020233030303133393232' TO DFHEIV0(25:11)
 14801     CALL 'kxdfhei1' USING DFHEIV0
 14802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14803
 14804     IF MAP-NAME = 'EL156A'
 14805         MOVE -1             TO ENTERPFL
 14806       ELSE
 14807         MOVE LOW-VALUES     TO EL156BI
 14808         MOVE -1             TO ENTPFBL.
 14809
 14810     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14811     GO TO 8200-SEND-DATAONLY.
 14812
 14813 5300-EXIT.
 14814     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 283
* EL156.cbl
 14816 5350-FORMAT-LAST-NAME-1ST.
 14817*****************************************************************
 14818*             M O V E   N A M E   R O U T I N E                 *
 14819*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14820*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14821*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14822*                  FIELD                   VALUE                *
 14823*           W-NAME-LAST    (CL15)      SMITH                    *
 14824*           W-NAME-FIRST   (CL15)      JOHN                     *
 14825*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14826*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14827*     CONTAIN                                                   *
 14828*                SMITH, JOHN ALLEN                              *
 14829*     OR                                                        *
 14830*                SMITH, JOHN A.                                 *
 14831*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14832*     COPYBOOK, ELCNWA.                                         *
 14833*****************************************************************.
 14834
 14835     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14836     MOVE ZERO                   TO  WS-NAME-SW.
 14837     SET NWA-INDEX               TO +1.
 14838
 14839     IF W-NAME-LAST   = SPACES AND
 14840        W-NAME-MIDDLE = SPACES
 14841         MOVE +1                 TO WS-NAME-SW.
 14842
 14843     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14844     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14845
 14846     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14847     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14848
 14849     SET NWA-INDEX UP BY +1.
 14850
 14851     IF W-NAME-MIDDLE NOT = SPACES
 14852         IF W-NAME-MIDDLE-2 = SPACES
 14853             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14854             SET NWA-INDEX UP BY +1
 14855             MOVE '.'            TO WS-NW (NWA-INDEX)
 14856             SET NWA-INDEX UP BY +2
 14857         ELSE
 14858             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14859             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14860
 14861 5350-EXIT.
 14862     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 284
* EL156.cbl
 14864 5360-MOVE-NAME.
 14865
 14866     IF WS-NAME-SW > +1
 14867         GO TO 5360-EXIT.
 14868
 14869     IF WS-NAME-WORK2 = SPACES
 14870         GO TO 5360-EXIT.
 14871
 14872     SET NWA-INDEX2            TO +1.
 14873     SET NWA-INDEX3            TO +2.
 14874
 14875 5360-MOVE-NAME-CYCLE.
 14876
 14877     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14878
 14879     IF NWA-INDEX < +30
 14880         SET NWA-INDEX UP BY +1
 14881     ELSE
 14882         ADD +2                TO  WS-NAME-SW
 14883         GO TO 5360-EXIT.
 14884
 14885     IF NWA-INDEX2 < +20
 14886         SET NWA-INDEX3 UP BY +1
 14887         SET NWA-INDEX2 UP BY +1.
 14888
 14889     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14890        WS-NW2 (NWA-INDEX3) = SPACES
 14891         IF WS-NAME-SW = ZERO
 14892             MOVE ','            TO  WS-NW (NWA-INDEX)
 14893             SET NWA-INDEX UP BY +2
 14894             MOVE +1             TO  WS-NAME-SW
 14895             GO TO 5360-EXIT
 14896         ELSE
 14897             GO TO 5360-EXIT.
 14898
 14899     GO TO 5360-MOVE-NAME-CYCLE.
 14900
 14901 5360-EXIT.
 14902     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 285
* EL156.cbl
 14904 6000-BUILD-SCREEN-B.
 14905     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14906     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14907     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14908     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14909
 14910     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14911
 14912 6050-BUILD-SCREEN.
 14913     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14914     MOVE LOW-VALUES             TO EL156BI.
 14915     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14916
 14917     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14918
 14919     IF PI-PAYEE-TYPE = 'I'
 14920        GO TO 6060-READ-TRAILER.
 14921
 14922     IF PI-PAYEE-TYPE = 'B'
 14923        ADD +10                  TO TRLR-SEQ-NO
 14924        GO TO 6060-READ-TRAILER.
 14925
 14926     IF PI-PAYEE-TYPE = 'A'
 14927        ADD +20                  TO TRLR-SEQ-NO
 14928        GO TO 6060-READ-TRAILER.
 14929
 14930     IF PI-PAYEE-TYPE = 'O'
 14931        ADD +50                  TO TRLR-SEQ-NO
 14932        GO TO 6060-READ-TRAILER.
 14933
 14934     IF PI-PAYEE-TYPE = 'Q'
 14935        ADD +60                  TO TRLR-SEQ-NO
 14936        GO TO 6060-READ-TRAILER.
 14937
 14938     IF PI-PAYEE-TYPE = 'P'
 14939        ADD +30                  TO TRLR-SEQ-NO
 14940        GO TO 6060-READ-TRAILER.
 14941
 14942     IF PI-PAYEE-TYPE = 'E'
 14943        ADD +40                  TO TRLR-SEQ-NO.
 14944
 14945 6060-READ-TRAILER.
 14946
 14947     IF PI-PAYEE-TYPE    = 'A' AND
 14948        PI-PAYEE-SEQ-NUM = 0
 14949          GO TO 6061-READ-ACCOUNT.
 14950
 14951     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14952        (PI-PAYEE-TYPE    = 'B')             AND
 14953        (PI-PAYEE-SEQ-NUM = 9)
 14954          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14955          IF BENE-FOUND-SW = 'N'
 14956            GO TO 6065-NOT-FOUND
 14957          ELSE
 14958            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14959            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14960            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14961*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 286
* EL156.cbl
 14962            STRING BE-CITY ' ' BE-STATE
 14963               DELIMITED BY '  ' INTO CITYSTBO
 14964            END-STRING
 14965            MOVE BE-ZIP-CODE       TO ZIPBO
 14966            GO TO 6061-READ-ACCOUNT.
 14967
 14968     IF PI-PAYEE-TYPE    = 'B' AND
 14969        PI-PAYEE-SEQ-NUM = 0
 14970          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14971          IF BENE-FOUND-SW = 'N'
 14972            GO TO 6065-NOT-FOUND
 14973          ELSE
 14974            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14975            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14976            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14977*           MOVE BE-CITY-STATE     TO CITYSTBO
 14978            STRING BE-CITY ' ' BE-STATE
 14979               DELIMITED BY '  ' INTO CITYSTBO
 14980            END-STRING
 14981            MOVE BE-ZIP-CODE       TO ZIPBO
 14982            GO TO 6061-READ-ACCOUNT.
 14983
 14984
 14985* EXEC CICS HANDLE CONDITION
 14986*         NOTFND(6065-NOT-FOUND)
 14987*     END-EXEC.
 14988*    MOVE '"$I                   ! / #00014103' TO DFHEIV0
 14989     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14991     MOVE X'2F20233030303134313033' TO DFHEIV0(25:11)
 14992     CALL 'kxdfhei1' USING DFHEIV0
 14993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14994
 14995
 14996     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14997
 14998     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14999     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15000     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15001     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15002*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15003     STRING AT-CITY ' ' AT-STATE
 15004        DELIMITED BY '  ' INTO CITYSTBO
 15005     END-STRING
 15006     MOVE AT-ZIP-CODE            TO ZIPBO.
 15007
 15008 6061-READ-ACCOUNT.
 15009
 15010* EXEC CICS HANDLE CONDITION
 15011*         NOTFND(6068-ACCT-NOT-FND)
 15012*     END-EXEC.
 15013*    MOVE '"$I                   ! 0 #00014120' TO DFHEIV0
 15014     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15015     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15016     MOVE X'3020233030303134313230' TO DFHEIV0(25:11)
 15017     CALL 'kxdfhei1' USING DFHEIV0
 15018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15019
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 287
* EL156.cbl
 15020
 15021
 15022* EXEC CICS READ
 15023*         DATASET('ERACCT')
 15024*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15025*         RIDFLD (PI-ACCT-KEY)
 15026*     END-EXEC.
 15027     MOVE 'ERACCT' TO DFHEIV1
 15028*    MOVE '&"S        E          (   #00014124' TO DFHEIV0
 15029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15031     MOVE X'2020233030303134313234' TO DFHEIV0(25:11)
 15032     CALL 'kxdfhei1' USING DFHEIV0,
 15033           DFHEIV1,
 15034           DFHEIV20,
 15035           DFHEIV99,
 15036           PI-ACCT-KEY,
 15037           DFHEIV99,
 15038           DFHEIV99,
 15039           DFHEIV99
 15040     SET ADDRESS OF ACCOUNT-MASTER TO
 15041         DFHEIV20
 15042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15043
 15044
 15045     MOVE AM-CARRIER             TO ACARRBO.
 15046     MOVE AM-GROUPING            TO GROUPBO.
 15047     MOVE AM-STATE               TO STATEBO.
 15048     MOVE AM-ACCOUNT             TO ACCTBO.
 15049     MOVE AM-NAME                TO ACCTNMBO.
 15050
 15051     IF PI-PAYEE-TYPE = 'A' AND
 15052        PI-PAYEE-SEQ-NUM = 0
 15053          MOVE AM-NAME             TO NAMEBO
 15054                                      PI-PAYEE-NAME
 15055          MOVE AM-ADDRS            TO ADDR1BO
 15056          MOVE SPACES              TO ADDR2BO
 15057*         MOVE AM-CITY             TO CITYSTBO
 15058          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15059             DELIMITED BY '  ' INTO CITYSTBO
 15060          END-STRING
 15061          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15062          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15063          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15064          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15065
 15066***  We don't really need the code below because we don't do the
 15067***  AK thing anymore.  However, we may have a state special
 15068***  of some sort in the future so why not just leave it??
 15069     IF CITYSTBO EQUAL SPACES
 15070         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15071         GO TO 6070-FORMAT-DATA
 15072     END-IF.
 15073
 15074     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15075     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15076     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15077     PERFORM VARYING WS-SUB FROM 30 BY -1
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 288
* EL156.cbl
 15078          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15079        IF WS-END-SUB = 0  AND
 15080           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15081              OR LOW-VALUES  OR '.')
 15082            CONTINUE
 15083        ELSE
 15084            IF WS-END-SUB = 0
 15085                MOVE WS-SUB TO WS-END-SUB
 15086            ELSE
 15087                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15088                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15089                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15090                END-IF
 15091            END-IF
 15092        END-IF
 15093        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15094            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15095            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15096        END-IF
 15097     END-PERFORM.
 15098
 15099     IF WS-BEG-SUB > 0
 15100         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15101         IF WS-STATE-LENGTH = 2
 15102             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15103                  TO PI-CHECK-STATE-FOR-AK
 15104         ELSE
 15105             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15106                'ALASKA'
 15107                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15108             ELSE
 15109                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15110             END-IF
 15111         END-IF
 15112     ELSE
 15113         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15114     END-IF.
 15115
 15116     GO TO 6070-FORMAT-DATA.
 15117
 15118 6065-NOT-FOUND.
 15119     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15120     GO TO 6061-READ-ACCOUNT.
 15121
 15122 6068-ACCT-NOT-FND.
 15123     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15124
 15125 6070-FORMAT-DATA.
 15126     IF PI-HOLDTIL = ZEROS
 15127        MOVE SAVE-DATE           TO PAYDTBI
 15128       ELSE
 15129        MOVE PI-HOLDTIL          TO PAYDTBO
 15130        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 15131
 15132     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15133     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15134
 15135     IF EIBAID = DFHPF3 OR DFHPF4
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 289
* EL156.cbl
 15136        NEXT SENTENCE
 15137     ELSE
 15138       GO TO 6071-CONTINUE.
 15139
 15140     MOVE PI-EPYFROM          TO PYFROMBO.
 15141     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15142
 15143     IF NOT PI-USES-PAID-TO
 15144        MOVE PI-EPYTHRU          TO PYTHRUBO
 15145        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15146     ELSE
 15147        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15148        MOVE '4'              TO DC-OPTION-CODE
 15149        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15150        IF NO-CONVERSION-ERROR
 15151           MOVE +1            TO DC-ELAPSED-DAYS
 15152           MOVE +0            TO DC-ELAPSED-MONTHS
 15153           MOVE '6'           TO DC-OPTION-CODE
 15154           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15155           IF NO-CONVERSION-ERROR
 15156              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15157
 15158     MOVE PI-EDAYS            TO DAYSBO.
 15159     MOVE PI-EPYAMT           TO PAYAMTBO.
 15160     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15161        IF PI-INT-AMT > ZEROS
 15162           MOVE PI-INT-AMT       TO INTAMTBO
 15163        END-IF
 15164     END-IF
 15165     GO TO 6072-SET-TYPE.
 15166
 15167 6071-CONTINUE.
 15168
 15169     IF PI-CPYFROM NOT = LOW-VALUES
 15170        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15171        MOVE SPACES              TO DC-OPTION-CODE
 15172        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15173        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15174
 15175     IF PI-CPYTHRU NOT = LOW-VALUES
 15176        IF NOT PI-USES-PAID-TO
 15177           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15178           MOVE SPACES             TO DC-OPTION-CODE
 15179           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15180           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15181        ELSE
 15182           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15183           MOVE '6'                TO DC-OPTION-CODE
 15184           MOVE +1                 TO DC-ELAPSED-DAYS
 15185           MOVE +0                 TO DC-ELAPSED-MONTHS
 15186           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15187           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15188
 15189     MOVE PI-CDAYS               TO DAYSBO.
 15190     MOVE PI-CPYAMT              TO PAYAMTBO.
 15191     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15192        IF PI-INT-AMT > ZEROS
 15193           MOVE PI-INT-AMT       TO INTAMTBO
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 290
* EL156.cbl
 15194        END-IF
 15195     END-IF
 15196     .
 15197 6072-SET-TYPE.
 15198     IF PI-PMTTYPE = '1'
 15199        MOVE 'PARTIAL'           TO PAYTYPBO.
 15200
 15201     IF PI-PMTTYPE = '2'
 15202        MOVE 'FINAL'             TO PAYTYPBO.
 15203
 15204     IF PI-PMTTYPE = '3'
 15205        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15206
 15207     IF PI-PMTTYPE = '4'
 15208        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15209
 15210     IF PI-PMTTYPE = '5'
 15211        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15212
 15213     IF PI-PMTTYPE = '6'
 15214        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15215
 15216     IF PI-PROV-PMT
 15217        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15218
 15219     IF PI-ECHECKNO NOT = SPACES
 15220        MOVE PI-ECHECKNO         TO CKNUMBO
 15221     ELSE
 15222        MOVE PI-CCHECKNO         TO CKNUMBO.
 15223
 15224     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 15225        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15226        MOVE +91                 TO  TRLR-SEQ-NO
 15227
 15228* EXEC CICS READ
 15229*           DATASET  ('ELTRLR')
 15230*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15231*           RIDFLD   (ELTRLR-KEY)
 15232*           RESP     (WS-RESPONSE)
 15233*       END-EXEC
 15234     MOVE 'ELTRLR' TO DFHEIV1
 15235*    MOVE '&"S        E          (  N#00014312' TO DFHEIV0
 15236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15238     MOVE X'204E233030303134333132' TO DFHEIV0(25:11)
 15239     CALL 'kxdfhei1' USING DFHEIV0,
 15240           DFHEIV1,
 15241           DFHEIV20,
 15242           DFHEIV99,
 15243           ELTRLR-KEY,
 15244           DFHEIV99,
 15245           DFHEIV99,
 15246           DFHEIV99
 15247     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15248         DFHEIV20
 15249     MOVE EIBRESP  TO WS-RESPONSE
 15250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15251
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 291
* EL156.cbl
 15252        IF WS-RESP-NORMAL
 15253           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15254        ELSE
 15255           MOVE SPACES           TO  LOANNBO
 15256        END-IF
 15257     END-IF
 15258
 15259*       MOVE PI-LOAN-NO          TO LOANNBO
 15260
 15261     IF CKNUMBO = SPACES
 15262         MOVE SPACES             TO CKNUMHDO.
 15263
 15264     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15265     MOVE CL-CARRIER             TO CARRBO.
 15266     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15267     MOVE CL-CERT-SFX            TO SUFXBO.
 15268
 15269     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15270        EVALUATE CL-CLAIM-TYPE
 15271           WHEN 'I'
 15272              MOVE '  IU  '      TO CLMTYPBO
 15273           WHEN 'G'
 15274              MOVE ' GAP  '      TO CLMTYPBO
 15275           WHEN 'F'
 15276              MOVE ' FMLA '      TO CLMTYPBO
 15277           WHEN OTHER
 15278              MOVE PI-AH-OVERRIDE-L6
 15279                                 TO CLMTYPBO
 15280        END-EVALUATE
 15281        MOVE ZEROS               TO UNDISBO
 15282*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15283        IF PI-PMTTYPE = '5' OR '6'
 15284           GO TO 6073-GET-NOTIFY-DATA
 15285        ELSE
 15286           MOVE PI-DAILY-RATE    TO RATEBO
 15287           GO TO 6073-GET-NOTIFY-DATA.
 15288
 15289     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15290
 15291     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15292        MOVE ZEROS               TO UNDISBO
 15293     ELSE
 15294        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15295
 15296 6073-GET-NOTIFY-DATA.
 15297
 15298     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15299
 15300     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15301         MOVE SPACES             TO  NAMEB2O
 15302                                     ADDR1B2O
 15303                                     ADDR2B2O
 15304                                     CITYST2O
 15305                                     AGTHDGO
 15306         MOVE ZEROS              TO  ZIPB2O
 15307         GO TO 6080-SET-INCURRED.
 15308
 15309     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 292
* EL156.cbl
 15310     MOVE +29                    TO  TRLR-SEQ-NO.
 15311
 15312
 15313* EXEC CICS HANDLE CONDITION
 15314*        NOTFND   (6074-GET-COMP-DATA)
 15315*    END-EXEC.
 15316*    MOVE '"$I                   ! 1 #00014379' TO DFHEIV0
 15317     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15319     MOVE X'3120233030303134333739' TO DFHEIV0(25:11)
 15320     CALL 'kxdfhei1' USING DFHEIV0
 15321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15322
 15323
 15324     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15325
 15326     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15327     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15328     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15329*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15330     STRING AT-CITY ' ' AT-STATE
 15331        DELIMITED BY '  ' INTO CITYST2O
 15332     END-STRING
 15333     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15334     GO TO 6080-SET-INCURRED.
 15335
 15336 6074-GET-COMP-DATA.
 15337
 15338     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15339         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15340
 15341     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15342         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15343                                         ADDR1B2O
 15344                                         ADDR2B2O
 15345                                         CITYST2O
 15346         MOVE ZEROS                  TO  ZIPB2O
 15347         GO TO 6080-SET-INCURRED.
 15348
 15349     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15350     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15351     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15352     MOVE AM-GROUPING            TO  COMP-GROUP.
 15353     MOVE 'A'                    TO  COMP-TYPE.
 15354     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15355                                 TO  COMP-FIN-RESP.
 15356
 15357     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15358         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15359                                       'G' OR 'B' or 'S'
 15360             MOVE 'G'            TO  COMP-TYPE
 15361             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15362         ELSE
 15363             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15364                                 TO  COMP-ACCOUNT
 15365     ELSE
 15366         MOVE 'G'                TO  COMP-TYPE
 15367         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 293
* EL156.cbl
 15368
 15369     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15370
 15371     IF COMP-REC-FOUND
 15372         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15373         MOVE CO-ADDR-1          TO  ADDR1B2O
 15374         MOVE CO-ADDR-2          TO  ADDR2B2O
 15375*        MOVE CO-ADDR-3          TO  CITYST2O
 15376         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15377            DELIMITED BY '  ' INTO CITYST2O
 15378         END-STRING
 15379         MOVE CO-ZIP             TO  ZIPB2O
 15380     ELSE
 15381         MOVE 'NO COMP ADDRESS AVAILABLE'
 15382                                 TO  NAMEB2O
 15383                                     ADDR1B2O
 15384                                     ADDR2B2O
 15385                                     CITYST2O
 15386         MOVE ZEROS               TO ZIPB2O.
 15387
 15388 6080-SET-INCURRED.
 15389     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15390     MOVE SPACES                 TO DC-OPTION-CODE.
 15391     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15392     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15393     MOVE PI-PROCESSOR-ID        TO BYBO.
 15394     MOVE MAP-NAMEB              TO MAP-NAME.
 15395     MOVE 'C'                    TO PI-PASS-SW.
 15396     MOVE EIBAID                 TO PI-PFKEY-USED.
 15397     MOVE -1                     TO ENTPFBL.
 15398     GO TO 8100-SEND-INITIAL-MAP.
 15399
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 294
* EL156.cbl
 15401 6100-BUILD-PAYMENT-TRAILER.
 15402
 15403     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15404     MOVE '6'                    TO CNTL-REC-TYPE.
 15405
 15406     IF CONTROL-IS-ACTUAL-CARRIER
 15407         MOVE PI-CARRIER         TO WS-CARR
 15408     ELSE
 15409         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15410
 15411     IF PI-COMPANY-ID = 'FIA'
 15412         MOVE PI-CARRIER         TO  WS-CARR.
 15413
 15414     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15415     MOVE 0                      TO CNTL-SEQ-NO.
 15416     MOVE 'CARR'                 TO FILE-SWITCH.
 15417
 15418     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15419
 15420     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15421         IF PI-OFFLINE     = 'Y' AND
 15422            PI-ECHECKNO-CR = 'CR'
 15423              GO TO 6110-READ-CONTROL
 15424         ELSE
 15425            IF PI-CASH = 'N'
 15426                GO TO 6110-READ-CONTROL.
 15427
 15428     IF CHECK-NO-MANUAL    OR
 15429        CHECK-NO-AT-PRINT  OR
 15430        PI-OFFLINE = 'Y'
 15431          GO TO 6130-BUILD-TRAILER.
 15432
 15433     IF PI-COMPANY-ID = 'FIA'
 15434         NEXT SENTENCE
 15435     ELSE
 15436         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15437             GO TO 6110-READ-CONTROL.
 15438
 15439     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15440
 15441     IF CHECK-CNT-RESET-VALUE
 15442        MOVE +1                  TO CF-CHECK-COUNTER
 15443     ELSE
 15444        ADD +1                   TO CF-CHECK-COUNTER.
 15445
 15446     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15447
 15448     IF CHECK-NO-CARR-SEQ
 15449        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15450
 15451     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15452
 15453     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15454     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15455        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15456         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15457         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15458            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 295
* EL156.cbl
 15459         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15460                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15461     END-IF.
 15462
 15463     GO TO 6120-REWRITE.
 15464
 15465 6105-STATE-CHECK-NUMBER.
 15466     IF CHECK-NO-MANUAL    OR
 15467        CHECK-NO-AT-PRINT  OR
 15468        PI-OFFLINE = 'Y'
 15469           GO TO 6130-BUILD-TRAILER
 15470     END-IF.
 15471
 15472     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15473     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15474     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15475     MOVE '3'                TO CNTL-REC-TYPE.
 15476     MOVE +0                 TO CNTL-SEQ-NO.
 15477     MOVE 'STAT'             TO FILE-SWITCH.
 15478     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15479
 15480     IF CF-ST-CHECK-CNT-RESET
 15481         MOVE +1             TO CF-ST-CHECK-COUNTER
 15482     ELSE
 15483         ADD +1              TO CF-ST-CHECK-COUNTER
 15484     END-IF.
 15485
 15486     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15487     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15488     GO TO 6120-REWRITE.
 15489
 15490 6110-READ-CONTROL.
 15491     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15492     MOVE '1'                    TO CNTL-REC-TYPE.
 15493     MOVE SPACES                 TO CNTL-ACCESS.
 15494     MOVE 0                      TO CNTL-SEQ-NO.
 15495
 15496     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15497
 15498     IF CO-CHECK-COUNT-RESET
 15499        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15500     ELSE
 15501        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15502
 15503     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15504
 15505     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15506         IF PI-OFFLINE     = 'Y'  AND
 15507            PI-ECHECKNO-CR = 'CR'
 15508              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15509              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15510              MOVE AL-UANON           TO CHECKNOA
 15511              GO TO 6120-REWRITE
 15512         ELSE
 15513         IF PI-CASH = 'N'
 15514             MOVE 'N'                TO PI-ECHECKNO-N
 15515             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15516             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 296
* EL156.cbl
 15517             MOVE AL-UANON           TO CHECKNOA
 15518             GO TO 6120-REWRITE.
 15519
 15520     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15521
 15522 6120-REWRITE.
 15523
 15524* EXEC CICS REWRITE
 15525*         DATASET('ELCNTL')
 15526*         FROM(CONTROL-FILE)
 15527*     END-EXEC.
 15528     MOVE LENGTH OF
 15529      CONTROL-FILE
 15530       TO DFHEIV11
 15531     MOVE 'ELCNTL' TO DFHEIV1
 15532*    MOVE '&& L                  %   #00014582' TO DFHEIV0
 15533     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15534     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15535     MOVE X'2020233030303134353832' TO DFHEIV0(25:11)
 15536     CALL 'kxdfhei1' USING DFHEIV0,
 15537           DFHEIV1,
 15538           CONTROL-FILE,
 15539           DFHEIV11,
 15540           DFHEIV99
 15541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15542
 15543
 15544     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15545
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 297
* EL156.cbl
 15547 6130-BUILD-TRAILER.
 15548
 15549
 15550* EXEC CICS GETMAIN
 15551*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15552*         LENGTH    (200)
 15553*         INITIMG   (GETMAIN-SPACE)
 15554*     END-EXEC.
 15555     MOVE 200
 15556       TO DFHEIV11
 15557*    MOVE ',"IL                  $   #00014592' TO DFHEIV0
 15558     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15560     MOVE X'2020233030303134353932' TO DFHEIV0(25:11)
 15561     CALL 'kxdfhei1' USING DFHEIV0,
 15562           DFHEIV20,
 15563           DFHEIV11,
 15564           GETMAIN-SPACE
 15565     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15566         DFHEIV20
 15567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15568
 15569
 15570     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15571                                    AT-PREV-PAID-THRU-DT.
 15572     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15573     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15574     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15575     MOVE 'AT'                   TO AT-RECORD-ID.
 15576     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15577
 15578     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15579        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15580           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15581     ELSE
 15582           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15583           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15584
 15585     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15586         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15587             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15588             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15589           ELSE
 15590             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15591             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15592
 15593     MOVE '2'                    TO AT-TRAILER-TYPE.
 15594     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15595                                    AT-PAYMENT-LAST-MAINT-DT.
 15596     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15597                                    AT-PAYMENT-LAST-UPDATED-BY.
 15598     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15599     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15600     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15601     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15602
 15603     IF PI-PMT-APPROVED
 15604        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 298
* EL156.cbl
 15605           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15606
 15607     IF PI-PFKEY-USED = DFHPF5
 15608        GO TO 6140-PF5-ENTERED.
 15609
 15610     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15611     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15612
 15613     IF PI-AIG-SPECIAL-BENEFIT
 15614         IF WS-1ST-SPECIAL-PMT
 15615             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15616             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15617                                        AT-AMOUNT-PAID
 15618         ELSE
 15619             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15620
 15621     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15622
 15623     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15624     MOVE '4'                    TO DC-OPTION-CODE.
 15625     PERFORM 9700-LINK-DATE-CONVERT.
 15626
 15627     IF DATE-CONVERSION-ERROR
 15628        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15629     ELSE
 15630        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15631
 15632     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15633     MOVE '4'                    TO DC-OPTION-CODE.
 15634     PERFORM 9700-LINK-DATE-CONVERT.
 15635
 15636     IF DATE-CONVERSION-ERROR
 15637        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15638     ELSE
 15639        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15640
 15641     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15642     GO TO 6150-FINISH-MOVE.
 15643
 15644 6140-PF5-ENTERED.
 15645     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15646     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15647
 15648     IF PI-AIG-SPECIAL-BENEFIT
 15649         IF WS-1ST-SPECIAL-PMT
 15650             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15651             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15652                                        AT-AMOUNT-PAID
 15653         ELSE
 15654             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15655
 15656     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15657     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15658     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15659
 15660 6150-FINISH-MOVE.
 15661
 15662     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 299
* EL156.cbl
 15663         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15664     ELSE
 15665         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15666
 15667     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15668     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15669
 15670*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15671*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15672
 15673     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15674         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15675
 15676     IF PI-OFFLINE = 'N'
 15677        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15678        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15679     ELSE
 15680        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15681        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15682
 15683     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15684
 15685     IF WS-2ND-SPECIAL-PMT
 15686         MOVE 'Y'                TO AT-CASH-PAYMENT
 15687         MOVE SPACES             TO AT-CHECK-NO
 15688         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15689         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15690         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15691         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15692
 15693     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15694                                    AT-TO-BE-WRITTEN-DT.
 15695
 15696     IF PI-HOLDTIL NOT = ZEROS
 15697        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15698        MOVE '4'                 TO DC-OPTION-CODE
 15699        PERFORM 9700-LINK-DATE-CONVERT
 15700        IF PI-OFFLINE = 'N'
 15701           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15702        ELSE
 15703           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15704
 15705     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15706     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15707                                    AT-CHECK-QUE-SEQUENCE.
 15708
 15709     IF PI-PFKEY-USED = DFHPF4
 15710        MOVE '1'                 TO AT-FORCE-CONTROL.
 15711
 15712     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15713        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15714        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15715        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15716
 15717     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15718                                    AT-VOID-SELECT-DT
 15719                                    AT-VOID-ACCEPT-DT
 15720                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 300
* EL156.cbl
 15721     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15722        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15723        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15724        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15725        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15726     ELSE
 15727        MOVE ZEROS               TO AT-DAILY-RATE
 15728                                    AT-ELIMINATION-DAYS
 15729        MOVE SPACES              TO AT-BENEFIT-TYPE
 15730     END-IF
 15731     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15732     MOVE '4'                    TO DC-OPTION-CODE.
 15733     PERFORM 9700-LINK-DATE-CONVERT.
 15734     IF DATE-CONVERSION-ERROR
 15735         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15736     ELSE
 15737         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15738     END-IF.
 15739     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15740     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15741     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15742     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15743     IF (PI-REAUDIT-NEEDED = 'Y')
 15744        or (pi-max-ext-used = 'Y')
 15745        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15746         PERFORM 6155-READ-CONTROL
 15747         PERFORM 6157-SET-APP-LEVEL
 15748         IF AT-APPROVAL-LEVEL-REQD < '4'
 15749            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15750         END-IF
 15751         MOVE 'Y' TO WS-NEED-APPROVAL
 15752         GO TO 6170-WRITE
 15753     END-IF.
 15754*******************************************************
 15755     IF NOT PI-PMT-GRADUATED
 15756         GO TO 6170-WRITE.
 15757     PERFORM 6155-READ-CONTROL.
 15758
 15759     IF PAID-FOR-LIFE
 15760         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15761             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15762                                     WS-PMT-APPROVAL-SW
 15763             GO TO 6170-WRITE.
 15764
 15765*05999      IF PAID-FOR-AH
 15766     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15767         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15768             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15769                                     WS-PMT-APPROVAL-SW
 15770             GO TO 6170-WRITE.
 15771
 15772     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15773
 15774     PERFORM 6157-SET-APP-LEVEL.
 15775
 15776     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15777
 15778     IF NOT PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 301
* EL156.cbl
 15779         GO TO 6170-WRITE.
 15780
 15781
 15782* EXEC CICS HANDLE CONDITION
 15783*        NOTFND   (6170-WRITE)
 15784*    END-EXEC.
 15785*    MOVE '"$I                   ! 2 #00014809' TO DFHEIV0
 15786     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15788     MOVE X'3220233030303134383039' TO DFHEIV0(25:11)
 15789     CALL 'kxdfhei1' USING DFHEIV0
 15790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15791
 15792
 15793     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15794     MOVE '2'                    TO CNTL-REC-TYPE.
 15795     MOVE +0                     TO CNTL-SEQ-NO.
 15796     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15797
 15798
 15799* EXEC CICS READ
 15800*         DATASET  ('ELCNTL')
 15801*         SET      (ADDRESS OF CONTROL-FILE)
 15802*         RIDFLD   (ELCNTL-KEY)
 15803*    END-EXEC.
 15804     MOVE 'ELCNTL' TO DFHEIV1
 15805*    MOVE '&"S        E          (   #00014818' TO DFHEIV0
 15806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15808     MOVE X'2020233030303134383138' TO DFHEIV0(25:11)
 15809     CALL 'kxdfhei1' USING DFHEIV0,
 15810           DFHEIV1,
 15811           DFHEIV20,
 15812           DFHEIV99,
 15813           ELCNTL-KEY,
 15814           DFHEIV99,
 15815           DFHEIV99,
 15816           DFHEIV99
 15817     SET ADDRESS OF CONTROL-FILE TO
 15818         DFHEIV20
 15819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15820
 15821
 15822     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15823
 15824     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15825                         OR '4' OR '5'
 15826         NEXT SENTENCE
 15827     ELSE
 15828         MOVE 'Y' TO WS-NEED-APPROVAL
 15829         GO TO 6170-WRITE.
 15830
 15831     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15832         MOVE 'Y' TO WS-NEED-APPROVAL
 15833         IF WS-APPROVAL-LEVEL = '1'
 15834             MOVE '2'        TO  AT-APPROVED-LEVEL
 15835                            WS-SAVE-APPROVED-LEVEL
 15836             GO TO 6170-WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 302
* EL156.cbl
 15837         ELSE
 15838             IF WS-APPROVAL-LEVEL = '2'
 15839                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15840                                WS-SAVE-APPROVED-LEVEL
 15841                 GO TO 6170-WRITE
 15842             ELSE IF WS-APPROVAL-LEVEL = '3'
 15843                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15844                                WS-SAVE-APPROVED-LEVEL
 15845                 GO TO 6170-WRITE
 15846             ELSE IF WS-APPROVAL-LEVEL = '4'
 15847                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15848                                WS-SAVE-APPROVED-LEVEL
 15849                 GO TO 6170-WRITE.
 15850
 15851     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15852                             WS-PMT-APPROVAL-SW.
 15853     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15854                             AT-APPROVAL-LEVEL-REQD.
 15855
 15856*******************************************************
 15857 6155-READ-CONTROL.
 15858     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15859     MOVE '1'                    TO CNTL-REC-TYPE.
 15860     MOVE SPACES                 TO CNTL-ACCESS.
 15861     MOVE +0                     TO CNTL-SEQ-NO.
 15862     MOVE 'COMP'                 TO FILE-SWITCH.
 15863
 15864     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15865 6157-SET-APP-LEVEL.
 15866******A&H Limits are set as a monthly payment.  Calculate the mont
 15867******equivalent of the amount paid today
 15868     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15869        PI-SAVE-ODD-DAYS-OVER > 0
 15870           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15871                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15872           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15873                                  WS-CALC-PMT-MONTHS
 15874     ELSE
 15875           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15876     END-IF.
 15877*06007      IF ((PAID-FOR-AH) AND
 15878     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15879*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15880        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15881              OR
 15882        ((PAID-FOR-LIFE) AND
 15883        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15884            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15885       ELSE
 15886*06014      IF ((PAID-FOR-AH)  AND
 15887         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15888*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15889           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15890              OR
 15891        ((PAID-FOR-LIFE) AND
 15892        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15893            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15894         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 303
* EL156.cbl
 15895*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15896           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15897               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15898              OR
 15899          ((PAID-FOR-LIFE) AND
 15900          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15901            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15902       ELSE
 15903           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15904               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15905              OR
 15906          ((PAID-FOR-LIFE) AND
 15907          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15908            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15909       ELSE
 15910            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15911
 15912     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15913        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15914        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15915            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15916        END-IF
 15917     ELSE
 15918     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15919        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15920        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15921            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15922        END-IF
 15923     ELSE
 15924     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15925        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15926        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15927            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15928        END-IF
 15929     ELSE
 15930     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15931        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15932        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15933            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15934        END-IF
 15935     ELSE
 15936     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15937            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15938
 15939 6170-WRITE.
 15940
 15941     if pi-company-id = 'DCC' or 'CAP'
 15942        PERFORM 0900-GET-DDF-limits
 15943                                 THRU 0900-EXIT
 15944     end-if
 15945     perform 2220-update-elcrtt  thru 2220-exit
 15946     IF PI-COMPANY-ID = 'DMD'
 15947        IF PI-AT-EOB-CODES NOT = SPACES
 15948           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15949           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15950           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15951           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15952           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 304
* EL156.cbl
 15953
 15954
 15955* EXEC CICS HANDLE CONDITION
 15956*        DUPREC    (6180-DUPREC)
 15957*    END-EXEC.
 15958*    MOVE '"$%                   ! 3 #00014956' TO DFHEIV0
 15959     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15961     MOVE X'3320233030303134393536' TO DFHEIV0(25:11)
 15962     CALL 'kxdfhei1' USING DFHEIV0
 15963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15964
 15965
 15966
 15967* EXEC CICS WRITE
 15968*         DATASET       ('ELTRLR')
 15969*         FROM          (ACTIVITY-TRAILERS)
 15970*         RIDFLD        (AT-CONTROL-PRIMARY)
 15971*     END-EXEC.
 15972     MOVE LENGTH OF
 15973      ACTIVITY-TRAILERS
 15974       TO DFHEIV11
 15975     MOVE 'ELTRLR' TO DFHEIV1
 15976*    MOVE '&$ L                  ''   #00014960' TO DFHEIV0
 15977     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15978     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15979     MOVE X'2020233030303134393630' TO DFHEIV0(25:11)
 15980     CALL 'kxdfhei1' USING DFHEIV0,
 15981           DFHEIV1,
 15982           ACTIVITY-TRAILERS,
 15983           DFHEIV11,
 15984           AT-CONTROL-PRIMARY,
 15985           DFHEIV99,
 15986           DFHEIV99
 15987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15988
 15989
 15990     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15991        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15992*06088           GO TO 6199-EXIT.
 15993           GO TO 6176-APPROVAL-NOTE.
 15994
 15995
 15996* EXEC CICS GETMAIN
 15997*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15998*         LENGTH    (200)
 15999*         INITIMG   (GETMAIN-SPACE)
 16000*     END-EXEC.
 16001     MOVE 200
 16002       TO DFHEIV11
 16003*    MOVE ',"IL                  $   #00014971' TO DFHEIV0
 16004     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16005     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16006     MOVE X'2020233030303134393731' TO DFHEIV0(25:11)
 16007     CALL 'kxdfhei1' USING DFHEIV0,
 16008           DFHEIV20,
 16009           DFHEIV11,
 16010           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 305
* EL156.cbl
 16011     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16012         DFHEIV20
 16013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16014
 16015
 16016     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16017
 16018     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16019     MOVE 'AT'                   TO AT-RECORD-ID.
 16020     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16021     MOVE '6'                    TO AT-TRAILER-TYPE.
 16022     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16023                                    AT-GEN-INFO-LAST-MAINT-DT
 16024     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16025                                    AT-GEN-INFO-LAST-UPDATED-BY
 16026     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16027
 16028     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16029     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16030     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16031
 16032     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16033
 16034 6175-WRITE.
 16035
 16036
 16037* EXEC CICS HANDLE CONDITION
 16038*        DUPREC    (6190-DUPREC)
 16039*    END-EXEC.
 16040*    MOVE '"$%                   ! 4 #00014997' TO DFHEIV0
 16041     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16043     MOVE X'3420233030303134393937' TO DFHEIV0(25:11)
 16044     CALL 'kxdfhei1' USING DFHEIV0
 16045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16046
 16047
 16048
 16049* EXEC CICS WRITE
 16050*         DATASET     ('ELTRLR')
 16051*         FROM        (ACTIVITY-TRAILERS)
 16052*         RIDFLD      (AT-CONTROL-PRIMARY)
 16053*     END-EXEC.
 16054     MOVE LENGTH OF
 16055      ACTIVITY-TRAILERS
 16056       TO DFHEIV11
 16057     MOVE 'ELTRLR' TO DFHEIV1
 16058*    MOVE '&$ L                  ''   #00015001' TO DFHEIV0
 16059     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16061     MOVE X'2020233030303135303031' TO DFHEIV0(25:11)
 16062     CALL 'kxdfhei1' USING DFHEIV0,
 16063           DFHEIV1,
 16064           ACTIVITY-TRAILERS,
 16065           DFHEIV11,
 16066           AT-CONTROL-PRIMARY,
 16067           DFHEIV99,
 16068           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 306
* EL156.cbl
 16069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16070
 16071
 16072 6176-APPROVAL-NOTE.
 16073
 16074     IF NOT APPROVAL-NEEDED
 16075         GO TO 6199-EXIT.
 16076
 16077
 16078* EXEC CICS GETMAIN
 16079*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16080*        LENGTH    (200)
 16081*        INITIMG   (GETMAIN-SPACE)
 16082*    END-EXEC.
 16083     MOVE 200
 16084       TO DFHEIV11
 16085*    MOVE ',"IL                  $   #00015012' TO DFHEIV0
 16086     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16087     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16088     MOVE X'2020233030303135303132' TO DFHEIV0(25:11)
 16089     CALL 'kxdfhei1' USING DFHEIV0,
 16090           DFHEIV20,
 16091           DFHEIV11,
 16092           GETMAIN-SPACE
 16093     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16094         DFHEIV20
 16095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16096
 16097
 16098     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16099
 16100     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16101     MOVE 'AT'               TO AT-RECORD-ID
 16102     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16103     MOVE '6'                TO AT-TRAILER-TYPE
 16104     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16105                                AT-GEN-INFO-LAST-MAINT-DT
 16106     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16107                                AT-GEN-INFO-LAST-UPDATED-BY
 16108     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16109
 16110     IF PI-REAUDIT-NEEDED = 'Y'
 16111         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16112     ELSE
 16113         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16114     END-IF
 16115     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16116         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16117     END-IF
 16118     MOVE SPACES             TO AT-INFO-LINE-2
 16119
 16120     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16121 6177-WRITE.
 16122
 16123
 16124* EXEC CICS HANDLE CONDITION
 16125*        DUPREC    (6185-DUPREC)
 16126*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 307
* EL156.cbl
 16127*    MOVE '"$%                   ! 5 #00015043' TO DFHEIV0
 16128     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16130     MOVE X'3520233030303135303433' TO DFHEIV0(25:11)
 16131     CALL 'kxdfhei1' USING DFHEIV0
 16132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16133
 16134
 16135
 16136* EXEC CICS WRITE
 16137*         DATASET     ('ELTRLR')
 16138*         FROM        (ACTIVITY-TRAILERS)
 16139*         RIDFLD      (AT-CONTROL-PRIMARY)
 16140*     END-EXEC.
 16141     MOVE LENGTH OF
 16142      ACTIVITY-TRAILERS
 16143       TO DFHEIV11
 16144     MOVE 'ELTRLR' TO DFHEIV1
 16145*    MOVE '&$ L                  ''   #00015047' TO DFHEIV0
 16146     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16147     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16148     MOVE X'2020233030303135303437' TO DFHEIV0(25:11)
 16149     CALL 'kxdfhei1' USING DFHEIV0,
 16150           DFHEIV1,
 16151           ACTIVITY-TRAILERS,
 16152           DFHEIV11,
 16153           AT-CONTROL-PRIMARY,
 16154           DFHEIV99,
 16155           DFHEIV99
 16156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16157
 16158
 16159
 16160     GO TO 6199-EXIT.
 16161
 16162 6180-DUPREC.
 16163
 16164     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16165     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16166     GO TO 6170-WRITE.
 16167
 16168 6185-DUPREC.
 16169     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16170     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16171     GO TO 6177-WRITE.
 16172
 16173 6190-DUPREC.
 16174     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16175     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16176     GO TO 6175-WRITE.
 16177
 16178 6199-EXIT.
 16179      EXIT.
 16180
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 308
* EL156.cbl
 16182 6200-UPDATE-CLAIM-MSTR.
 16183     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16184     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16185     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16186     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16187
 16188     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16189
 16190     MOVE ZEROS                  TO W-INTEREST.
 16191
 16192     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 16193        IF (PI-OFFLINE = 'Y') OR
 16194           (PI-PMTTYPE = '7')
 16195           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16196                                 THRU 9870-EXIT
 16197        END-IF
 16198     END-IF
 16199     IF NOT ERROR-ON-OUTPUT
 16200        CONTINUE
 16201     ELSE
 16202
 16203* EXEC CICS REWRITE
 16204*          DATASET('ELMSTR')
 16205*          FROM(CLAIM-MASTER)
 16206*       END-EXEC
 16207     MOVE LENGTH OF
 16208      CLAIM-MASTER
 16209       TO DFHEIV11
 16210     MOVE 'ELMSTR' TO DFHEIV1
 16211*    MOVE '&& L                  %   #00015096' TO DFHEIV0
 16212     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16213     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16214     MOVE X'2020233030303135303936' TO DFHEIV0(25:11)
 16215     CALL 'kxdfhei1' USING DFHEIV0,
 16216           DFHEIV1,
 16217           CLAIM-MASTER,
 16218           DFHEIV11,
 16219           DFHEIV99
 16220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16221
 16222        MOVE -1                  TO ENTPFBL
 16223        MOVE AL-UANON            TO ENTPFBA
 16224        MOVE MAP-NAMEB           TO MAP-NAME
 16225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16226        GO TO 8200-SEND-DATAONLY
 16227     END-IF
 16228
 16229     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16230
 16231     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16232
 16233     IF PI-AIG-SPECIAL-BENEFIT
 16234         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16235
 16236     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16237
 16238     IF PI-SPECIAL-BEN-SW = 'Y'
 16239         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 309
* EL156.cbl
 16240         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16241
 16242     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16243         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16244     ELSE
 16245         IF PI-PMTTYPE NOT = '4'
 16246            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16247
 16248     IF PI-PMTTYPE = '5' OR '6'
 16249        GO TO  6250-SET-MAINT.
 16250
 16251     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16252                                         CL-LAG-REPORT-CODE.
 16253
 16254     IF CL-ACTIVITY-CODE = 09
 16255         GO TO 6200-CONT-UPDATE.
 16256
 16257     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16258         IF CL-ACTIVITY-CODE = 11
 16259             GO TO 6200-CONT-UPDATE.
 16260
 16261     IF WS-ACT-REC-FOUND-SW = 'N'
 16262         GO TO 6200-CONT-UPDATE.
 16263
 16264     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16265         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16266         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16267         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16268
 16269     IF WS-UPDATE-SW = 'Y'
 16270         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16271                                         CL-NEXT-FOLLOWUP-DT.
 16272
 16273 6200-CONT-UPDATE.
 16274
 16275     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16276       IF CLAIM-IS-CLOSED
 16277         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16278           IF WS-OPEN-CLOSE-SW = '2'
 16279             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16280                                        CL-LAST-CLOSE-DT.
 16281
 16282     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16283        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16284        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16285
 16286     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16287        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16288        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16289        MOVE 'C'                 TO CL-CLAIM-STATUS
 16290        IF PI-PMTTYPE = '2'
 16291           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16292              or 'F')
 16293           CONTINUE
 16294        ELSE
 16295           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16296        END-IF
 16297     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 310
* EL156.cbl
 16298        IF PI-PMTTYPE = '2' OR '3'
 16299           IF PI-PMTTYPE = '2' AND
 16300              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16301                 or 'F')
 16302              CONTINUE
 16303           ELSE
 16304              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16305           END-IF
 16306        END-IF
 16307     END-IF
 16308
 16309     IF PI-PMTTYPE = '4'
 16310        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16311
 16312     IF PI-COMPANY-ID = 'CVL'
 16313         IF PI-LOAN-UPDATE-SW = 'Y'
 16314             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16315             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16316             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16317             MOVE CL-CERT-STATE      TO  CERT-STATE
 16318             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16319             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16320             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16321             MOVE 'CERT'             TO  FILE-SWITCH
 16322             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16323             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16324             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16325
 16326     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16327        GO TO 6220-USE-COMPUTED.
 16328
 16329     IF (PI-PMTTYPE = '4')  AND
 16330        (PI-EPYAMT < ZEROS)
 16331          COMPUTE CL-NO-OF-DAYS-PAID =
 16332                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16333          IF CL-NO-OF-DAYS-PAID < +0
 16334              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16335          ELSE
 16336              NEXT SENTENCE
 16337     ELSE
 16338          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16339
 16340     IF PI-PROCESSOR-ID = 'FIX '
 16341        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16342           NEXT SENTENCE
 16343        ELSE
 16344           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16345     ELSE
 16346        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16347
 16348     IF PI-PMTTYPE = '4'
 16349        GO TO 6250-SET-MAINT.
 16350
 16351     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16352
 16353     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16354     MOVE '4'                    TO DC-OPTION-CODE.
 16355     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 311
* EL156.cbl
 16356     IF DATE-CONVERSION-ERROR
 16357        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16358     ELSE
 16359        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16360           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16361           IF PI-AIG-SPECIAL-BENEFIT
 16362               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16363           ELSE
 16364               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16365
 16366     GO TO 6250-SET-MAINT.
 16367
 16368 6220-USE-COMPUTED.
 16369
 16370     IF (PI-PMTTYPE = '4')  AND
 16371        (PI-CPYAMT < ZEROS)
 16372          COMPUTE CL-NO-OF-DAYS-PAID =
 16373                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16374          IF CL-NO-OF-DAYS-PAID < +0
 16375              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16376          ELSE
 16377              NEXT SENTENCE
 16378     ELSE
 16379          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16380
 16381     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16382
 16383     IF PI-PMTTYPE = '4'
 16384        GO TO 6250-SET-MAINT.
 16385
 16386     IF PI-AIG-SPECIAL-BENEFIT
 16387         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16388     ELSE
 16389         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16390
 16391     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16392
 16393     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16394        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16395
 16396 6250-SET-MAINT.
 16397     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16398
 16399     IF PI-PROCESSOR-ID = 'FIX '
 16400        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16401           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16402        ELSE
 16403           NEXT SENTENCE
 16404     ELSE
 16405        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16406
 16407     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16408     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16409     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16410
 16411 6299-EXIT.
 16412      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 312
* EL156.cbl
 16414 6300-UPDATE-CERT.
 16415
 16416*  ADD CERTNOTE FOR SC NP+6
 16417     IF PI-COMPANY-ID = 'CID' AND
 16418       (PI-PMTTYPE = '2' OR '3') AND
 16419        CL-CERT-STATE = 'SC'  AND
 16420        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16421           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16422     END-IF.
 16423
 16424     IF PI-COMPANY-ID = 'AHL' AND
 16425       (PI-PMTTYPE = '2' OR '3') AND
 16426        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16427           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16428           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16429     END-IF.
 16430
 16431     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16432     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16433     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16434     MOVE CL-CERT-STATE    TO CERT-STATE.
 16435     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16436     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16437     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16438     MOVE 'CERT'           TO FILE-SWITCH.
 16439
 16440     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16441
 16442     IF CERT-NOTE-ADDED
 16443        IF CM-NOTE-SW = ' '
 16444           MOVE '4'             TO CM-NOTE-SW
 16445        ELSE
 16446           IF CM-NOTE-SW = '1'
 16447               MOVE '5'           TO CM-NOTE-SW
 16448           ELSE
 16449              IF CM-NOTE-SW = '2'
 16450                 MOVE '6'         TO CM-NOTE-SW
 16451              ELSE
 16452                 IF CM-NOTE-SW = '3'
 16453                    MOVE '7'      TO CM-NOTE-SW
 16454                 END-IF
 16455              END-IF
 16456           END-IF
 16457        END-IF
 16458     END-IF.
 16459
 16460     IF PI-COMPANY-ID = 'CVL'
 16461         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16462         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16463
 16464     IF PI-PMTTYPE NOT = '4'
 16465        GO TO 6340-UPDATE-CERT.
 16466
 16467     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16468        IF PI-PFKEY-USED = DFHPF5
 16469           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16470        ELSE
 16471           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 313
* EL156.cbl
 16472
 16473*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16474*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16475*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16476*               PI-LF-COVERAGE-TYPE = 'P'
 16477*                GO TO 6350-REWRITE-CERT.
 16478
 16479     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16480       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16481          PI-LF-COVERAGE-TYPE = 'P'
 16482           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16483                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16484                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16485                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16486                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16487                GO TO 6350-REWRITE-CERT
 16488            ELSE
 16489                GO TO 6350-REWRITE-CERT.
 16490
 16491     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16492         GO TO 6350-REWRITE-CERT.
 16493
 16494     IF NOT CM-AH-LUMP-SUM-DISAB
 16495        GO TO 6380-UNLOCK-CERT.
 16496
 16497     IF PI-PFKEY-USED = DFHPF5
 16498        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16499                                    CM-AH-ITD-AH-PMT
 16500        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16501        GO TO 6350-REWRITE-CERT
 16502     ELSE
 16503        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16504                                    CM-AH-ITD-AH-PMT
 16505        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16506        GO TO 6350-REWRITE-CERT.
 16507
 16508 6340-UPDATE-CERT.
 16509
 16510     IF CL-CLAIM-TYPE = 'L'
 16511         IF PI-PFKEY-USED = DFHPF5
 16512             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16513         ELSE
 16514             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16515
 16516     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16517         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16518             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16519                PI-LF-COVERAGE-TYPE = 'P'
 16520                 GO TO 6350-REWRITE-CERT.
 16521
 16522     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16523       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16524          PI-LF-COVERAGE-TYPE = 'P'
 16525           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16526                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16527                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16528                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16529                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 314
* EL156.cbl
 16530                GO TO 6350-REWRITE-CERT.
 16531
 16532     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16533         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16534            PI-LF-COVERAGE-TYPE NOT = 'P'
 16535             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16536             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16537             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16538             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16539             GO TO 6350-REWRITE-CERT.
 16540
 16541     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16542         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16543         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16544         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16545         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16546         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16547         IF PI-PFKEY-USED = DFHPF5
 16548             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16549                                        CM-AH-ITD-AH-PMT
 16550             GO TO 6350-REWRITE-CERT
 16551         ELSE
 16552             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16553                                        CM-AH-ITD-AH-PMT
 16554             GO TO 6350-REWRITE-CERT.
 16555
 16556 6350-REWRITE-CERT.
 16557
 16558
 16559* EXEC CICS REWRITE
 16560*         DATASET  ('ELCERT')
 16561*         FROM(CERTIFICATE-MASTER)
 16562*     END-EXEC.
 16563     MOVE LENGTH OF
 16564      CERTIFICATE-MASTER
 16565       TO DFHEIV11
 16566     MOVE 'ELCERT' TO DFHEIV1
 16567*    MOVE '&& L                  %   #00015437' TO DFHEIV0
 16568     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16569     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16570     MOVE X'2020233030303135343337' TO DFHEIV0(25:11)
 16571     CALL 'kxdfhei1' USING DFHEIV0,
 16572           DFHEIV1,
 16573           CERTIFICATE-MASTER,
 16574           DFHEIV11,
 16575           DFHEIV99
 16576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16577
 16578
 16579     GO TO 6399-EXIT.
 16580
 16581 6380-UNLOCK-CERT.
 16582
 16583* EXEC CICS UNLOCK
 16584*         DATASET  ('ELCERT')
 16585*     END-EXEC.
 16586     MOVE 'ELCERT' TO DFHEIV1
 16587*    MOVE '&*                    #   #00015445' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 315
* EL156.cbl
 16588     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16589     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16590     MOVE X'2020233030303135343435' TO DFHEIV0(25:11)
 16591     CALL 'kxdfhei1' USING DFHEIV0,
 16592           DFHEIV1,
 16593           DFHEIV99
 16594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16595
 16596
 16597 6399-EXIT.
 16598      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 316
* EL156.cbl
 16600 6400-UPDATE-ZERO-TRAILER.
 16601     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16602     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16603
 16604     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16605
 16606     IF PI-EPYAMT NOT = ZEROS
 16607         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16608     ELSE
 16609         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16610
 16611     IF PI-ERESV NOT = ZEROS
 16612        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16613
 16614     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16615        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16616
 16617     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16618        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16619     ELSE
 16620        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16621
 16622     IF PI-PMTTYPE = '5'
 16623        IF PI-EPYAMT = ZEROS
 16624           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16625        ELSE
 16626           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16627
 16628     IF PI-PMTTYPE = '6'
 16629        IF PI-EPYAMT = ZEROS
 16630           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16631        ELSE
 16632           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16633
 16634 6420-CHECK-OPEN-CLOSE.
 16635     IF PI-PMTTYPE = '5' OR '6'
 16636        GO TO 6450-REWRITE.
 16637
 16638     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16639         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16640             IF CLAIM-IS-CLOSED
 16641                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16642                 MOVE 1          TO  SUB-1
 16643                 GO TO 6440-AIG-LOOP.
 16644
 16645     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16646        GO TO 6450-REWRITE.
 16647
 16648     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16649        GO TO 6450-REWRITE.
 16650
 16651     MOVE 1                      TO SUB-1.
 16652
 16653 6430-LOOP.
 16654     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16655        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16656        IF PI-PMTTYPE = '1' OR '4'
 16657           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 317
* EL156.cbl
 16658           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16659           GO TO 6450-REWRITE
 16660        ELSE
 16661           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16662           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16663           GO TO 6450-REWRITE.
 16664
 16665     IF SUB-1 = 6
 16666      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16667      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16668      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16669      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16670      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16671      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16672      GO TO 6430-LOOP.
 16673
 16674     ADD 1                       TO SUB-1.
 16675     GO TO 6430-LOOP.
 16676
 16677
 16678 6440-AIG-LOOP.
 16679
 16680     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16681       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16682       IF WS-OPEN-CLOSE-SW = '1'
 16683         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16684         IF PI-PMTTYPE = '2'
 16685           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16686           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16687         ELSE
 16688           IF PI-PMTTYPE = '3'
 16689             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16690             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16691           ELSE
 16692             IF PI-PMTTYPE = '4'
 16693               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16694               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16695             ELSE
 16696               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16697               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16698       ELSE
 16699         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16700         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16701         GO TO 6450-REWRITE.
 16702
 16703     IF SUB-1 = 6
 16704      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16705      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16706      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16707      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16708      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16709      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16710      GO TO 6440-AIG-LOOP.
 16711
 16712     ADD 1                       TO SUB-1.
 16713     GO TO 6440-AIG-LOOP.
 16714
 16715 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 318
* EL156.cbl
 16716     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16717     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16718     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16719
 16720     IF PI-COMPANY-ID = 'DMD'
 16721         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16722         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16723         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16724         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16725         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16726
 16727
 16728* EXEC CICS REWRITE
 16729*         DATASET  ('ELTRLR')
 16730*         FROM     (ACTIVITY-TRAILERS)
 16731*     END-EXEC.
 16732     MOVE LENGTH OF
 16733      ACTIVITY-TRAILERS
 16734       TO DFHEIV11
 16735     MOVE 'ELTRLR' TO DFHEIV1
 16736*    MOVE '&& L                  %   #00015579' TO DFHEIV0
 16737     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16738     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16739     MOVE X'2020233030303135353739' TO DFHEIV0(25:11)
 16740     CALL 'kxdfhei1' USING DFHEIV0,
 16741           DFHEIV1,
 16742           ACTIVITY-TRAILERS,
 16743           DFHEIV11,
 16744           DFHEIV99
 16745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16746
 16747
 16748 6499-EXIT.
 16749      EXIT.
 16750
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 319
* EL156.cbl
 16752 6500-READ-DLO035.
 16753     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16754     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16755     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16756     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16757
 16758
 16759* EXEC CICS LINK
 16760*        PROGRAM    ('DLO035')
 16761*        COMMAREA   (DLO035-KEY)
 16762*        LENGTH     (DL35-LENGTH)
 16763*    END-EXEC.
 16764     MOVE 'DLO035' TO DFHEIV1
 16765*    MOVE '."C                   (   #00015594' TO DFHEIV0
 16766     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16768     MOVE X'2020233030303135353934' TO DFHEIV0(25:11)
 16769     CALL 'kxdfhei1' USING DFHEIV0,
 16770           DFHEIV1,
 16771           DLO035-KEY,
 16772           DL35-LENGTH,
 16773           DFHEIV99,
 16774           DFHEIV99,
 16775           DFHEIV99,
 16776           DFHEIV99
 16777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16778
 16779
 16780     IF DL35-RETURN-CODE = 'OK'
 16781         GO TO 6500-EXIT.
 16782
 16783     IF DL35-RETURN-CODE = '01'
 16784         MOVE ER-7830            TO EMI-ERROR
 16785         GO TO 6500-BAD-EXIT.
 16786
 16787     IF DL35-RETURN-CODE = '02'
 16788         MOVE ER-7831            TO EMI-ERROR
 16789         GO TO 6500-BAD-EXIT.
 16790
 16791     IF DL35-RETURN-CODE = '03'
 16792         MOVE ER-7832            TO EMI-ERROR
 16793         GO TO 6500-BAD-EXIT.
 16794
 16795     IF DL35-RETURN-CODE = '04'
 16796         MOVE ER-7833            TO EMI-ERROR
 16797         GO TO 6500-BAD-EXIT.
 16798
 16799     IF DL35-RETURN-CODE = '05'
 16800         MOVE ER-7834            TO EMI-ERROR
 16801         GO TO 6500-BAD-EXIT.
 16802
 16803     IF DL35-RETURN-CODE = '06'
 16804         MOVE ER-7835            TO EMI-ERROR
 16805         GO TO 6500-BAD-EXIT.
 16806
 16807     IF DL35-RETURN-CODE = '07'
 16808         MOVE ER-7836            TO EMI-ERROR
 16809         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 320
* EL156.cbl
 16810
 16811     IF DL35-RETURN-CODE = 'E1'
 16812         MOVE ER-7837            TO EMI-ERROR
 16813         GO TO 6500-BAD-EXIT.
 16814
 16815     IF DL35-RETURN-CODE NOT = 'OK'
 16816         MOVE ER-7838            TO EMI-ERROR
 16817         GO TO 6500-BAD-EXIT.
 16818
 16819 6500-EXIT.
 16820      EXIT.
 16821
 16822 6500-BAD-EXIT.
 16823
 16824* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16825*    MOVE '6"R                   !   #00015643' TO DFHEIV0
 16826     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16828     MOVE X'2020233030303135363433' TO DFHEIV0(25:11)
 16829     CALL 'kxdfhei1' USING DFHEIV0
 16830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16831
 16832     MOVE -1                 TO PMTTYPEL.
 16833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16834     GO TO 8200-SEND-DATAONLY.
 16835
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 321
* EL156.cbl
 16837 6600-UPDATE-DLO035.
 16838     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16839     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16840     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16841     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16842
 16843
 16844* EXEC CICS LINK
 16845*        PROGRAM    ('DLO035')
 16846*        COMMAREA   (DLO035-KEY)
 16847*        LENGTH     (DL35-LENGTH)
 16848*    END-EXEC.
 16849     MOVE 'DLO035' TO DFHEIV1
 16850*    MOVE '."C                   (   #00015655' TO DFHEIV0
 16851     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16852     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16853     MOVE X'2020233030303135363535' TO DFHEIV0(25:11)
 16854     CALL 'kxdfhei1' USING DFHEIV0,
 16855           DFHEIV1,
 16856           DLO035-KEY,
 16857           DL35-LENGTH,
 16858           DFHEIV99,
 16859           DFHEIV99,
 16860           DFHEIV99,
 16861           DFHEIV99
 16862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16863
 16864
 16865     IF DL35-RETURN-CODE = 'OK'
 16866         GO TO 6600-EXIT.
 16867
 16868     IF DL35-RETURN-CODE = '01'
 16869         MOVE ER-7830            TO EMI-ERROR
 16870         GO TO 6500-BAD-EXIT.
 16871
 16872     IF DL35-RETURN-CODE = '02'
 16873         MOVE ER-7831            TO EMI-ERROR
 16874         GO TO 6500-BAD-EXIT.
 16875
 16876     IF DL35-RETURN-CODE = '03'
 16877         MOVE ER-7832            TO EMI-ERROR
 16878         GO TO 6500-BAD-EXIT.
 16879
 16880     IF DL35-RETURN-CODE = '04'
 16881         MOVE ER-7833            TO EMI-ERROR
 16882         GO TO 6500-BAD-EXIT.
 16883
 16884     IF DL35-RETURN-CODE = '05'
 16885         MOVE ER-7834            TO EMI-ERROR
 16886         GO TO 6500-BAD-EXIT.
 16887
 16888     IF DL35-RETURN-CODE = '06'
 16889         MOVE ER-7835            TO EMI-ERROR
 16890         GO TO 6500-BAD-EXIT.
 16891
 16892     IF DL35-RETURN-CODE = '07'
 16893         MOVE ER-7836            TO EMI-ERROR
 16894         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 322
* EL156.cbl
 16895
 16896     IF DL35-RETURN-CODE = 'E1'
 16897         MOVE ER-7837            TO EMI-ERROR
 16898         GO TO 6500-BAD-EXIT.
 16899
 16900     IF DL35-RETURN-CODE NOT = 'OK'
 16901         MOVE ER-7838            TO EMI-ERROR
 16902         GO TO 6500-BAD-EXIT.
 16903
 16904 6600-EXIT.
 16905      EXIT.
 16906
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 323
* EL156.cbl
 16908 6700-UPDATE-ACTQ.
 16909***************************************************************
 16910*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16911*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16912*    ONE ALREADY THERE.                                       *
 16913***************************************************************
 16914
 16915
 16916* EXEC CICS HANDLE CONDITION
 16917*         NOTFND(6720-BUILD-NEW-RECORD)
 16918*     END-EXEC.
 16919*    MOVE '"$I                   ! 6 #00015711' TO DFHEIV0
 16920     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16922     MOVE X'3620233030303135373131' TO DFHEIV0(25:11)
 16923     CALL 'kxdfhei1' USING DFHEIV0
 16924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16925
 16926
 16927
 16928* EXEC CICS READ
 16929*         DATASET('ELACTQ')
 16930*         RIDFLD (ELMSTR-KEY)
 16931*         SET    (ADDRESS OF ACTIVITY-QUE)
 16932*         UPDATE
 16933*     END-EXEC.
 16934     MOVE 'ELACTQ' TO DFHEIV1
 16935*    MOVE '&"S        EU         (   #00015715' TO DFHEIV0
 16936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16938     MOVE X'2020233030303135373135' TO DFHEIV0(25:11)
 16939     CALL 'kxdfhei1' USING DFHEIV0,
 16940           DFHEIV1,
 16941           DFHEIV20,
 16942           DFHEIV99,
 16943           ELMSTR-KEY,
 16944           DFHEIV99,
 16945           DFHEIV99,
 16946           DFHEIV99
 16947     SET ADDRESS OF ACTIVITY-QUE TO
 16948         DFHEIV20
 16949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16950
 16951
 16952     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16953
 16954     IF PI-AIG-SPECIAL-BENEFIT AND
 16955        PI-CASH = 'Y'
 16956         ADD 2                   TO AQ-PAYMENT-COUNTER
 16957     ELSE
 16958         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16959
 16960     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16961         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16962
 16963     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16964
 16965     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 324
* EL156.cbl
 16966         IF WS-PMT-APPROVAL-SW = 'A'
 16967             NEXT SENTENCE
 16968         ELSE
 16969            IF PI-AIG-SPECIAL-BENEFIT AND
 16970               PI-CASH = 'Y'
 16971                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16972                                     WS-PMT-UNAPPROVED-CNT
 16973            ELSE
 16974                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16975                                     WS-PMT-UNAPPROVED-CNT
 16976     ELSE
 16977         IF PI-PMT-APPR-SW = 'Y'
 16978            IF PI-AIG-SPECIAL-BENEFIT AND
 16979               PI-CASH = 'Y'
 16980                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16981                                     WS-PMT-UNAPPROVED-CNT
 16982            ELSE
 16983                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16984                                     WS-PMT-UNAPPROVED-CNT.
 16985
 16986     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16987         MOVE ER-3536 TO EMI-ERROR
 16988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16989
 16990     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16991
 16992
 16993* EXEC CICS REWRITE
 16994*         DATASET('ELACTQ')
 16995*         FROM   (ACTIVITY-QUE)
 16996*     END-EXEC.
 16997     MOVE LENGTH OF
 16998      ACTIVITY-QUE
 16999       TO DFHEIV11
 17000     MOVE 'ELACTQ' TO DFHEIV1
 17001*    MOVE '&& L                  %   #00015762' TO DFHEIV0
 17002     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17003     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17004     MOVE X'2020233030303135373632' TO DFHEIV0(25:11)
 17005     CALL 'kxdfhei1' USING DFHEIV0,
 17006           DFHEIV1,
 17007           ACTIVITY-QUE,
 17008           DFHEIV11,
 17009           DFHEIV99
 17010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17011
 17012
 17013     GO TO 6799-EXIT.
 17014
 17015 6720-BUILD-NEW-RECORD.
 17016
 17017* EXEC CICS GETMAIN
 17018*         SET    (ADDRESS OF ACTIVITY-QUE)
 17019*         LENGTH (60)
 17020*         INITIMG(GETMAIN-SPACE)
 17021*     END-EXEC.
 17022     MOVE 60
 17023       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 325
* EL156.cbl
 17024*    MOVE ',"IL                  $   #00015770' TO DFHEIV0
 17025     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17027     MOVE X'2020233030303135373730' TO DFHEIV0(25:11)
 17028     CALL 'kxdfhei1' USING DFHEIV0,
 17029           DFHEIV20,
 17030           DFHEIV11,
 17031           GETMAIN-SPACE
 17032     SET ADDRESS OF ACTIVITY-QUE TO
 17033         DFHEIV20
 17034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17035
 17036
 17037     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17038
 17039     IF PI-AIG-SPECIAL-BENEFIT AND
 17040        PI-CASH = 'Y'
 17041         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17042     ELSE
 17043         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17044
 17045     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17046     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17047     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17048     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17049                                    AQ-FOLLOWUP-DATE.
 17050     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17051     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17052
 17053     IF PI-PMT-GRADUATED
 17054         IF WS-PMT-APPROVAL-SW = 'A'
 17055             NEXT SENTENCE
 17056         ELSE
 17057            IF PI-AIG-SPECIAL-BENEFIT AND
 17058               PI-CASH = 'Y'
 17059                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17060            ELSE
 17061                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17062     ELSE
 17063         IF PI-PMT-APPR-SW = 'Y'
 17064            IF PI-AIG-SPECIAL-BENEFIT AND
 17065               PI-CASH = 'Y'
 17066                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17067            ELSE
 17068                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17069
 17070     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17071         MOVE ER-3536 TO EMI-ERROR
 17072         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17073
 17074
 17075* EXEC CICS WRITE
 17076*         DATASET('ELACTQ')
 17077*         RIDFLD (ELMSTR-KEY)
 17078*         FROM   (ACTIVITY-QUE)
 17079*     END-EXEC.
 17080     MOVE LENGTH OF
 17081      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 326
* EL156.cbl
 17082       TO DFHEIV11
 17083     MOVE 'ELACTQ' TO DFHEIV1
 17084*    MOVE '&$ L                  ''   #00015813' TO DFHEIV0
 17085     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17086     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17087     MOVE X'2020233030303135383133' TO DFHEIV0(25:11)
 17088     CALL 'kxdfhei1' USING DFHEIV0,
 17089           DFHEIV1,
 17090           ACTIVITY-QUE,
 17091           DFHEIV11,
 17092           ELMSTR-KEY,
 17093           DFHEIV99,
 17094           DFHEIV99
 17095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17096
 17097
 17098 6799-EXIT.
 17099      EXIT.
 17100
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 327
* EL156.cbl
 17102 6800-BUILD-FORM-TRAILER.
 17103
 17104
 17105* EXEC CICS GETMAIN
 17106*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17107*         LENGTH   (200)
 17108*         INITIMG  (GETMAIN-SPACE)
 17109*    END-EXEC.
 17110     MOVE 200
 17111       TO DFHEIV11
 17112*    MOVE ',"IL                  $   #00015825' TO DFHEIV0
 17113     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17114     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17115     MOVE X'2020233030303135383235' TO DFHEIV0(25:11)
 17116     CALL 'kxdfhei1' USING DFHEIV0,
 17117           DFHEIV20,
 17118           DFHEIV11,
 17119           GETMAIN-SPACE
 17120     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17121         DFHEIV20
 17122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17123
 17124
 17125     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17126
 17127     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17128     MOVE 'AT'                   TO AT-RECORD-ID.
 17129     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17130
 17131     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17132     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17133                                    AT-FORM-LAST-MAINT-DT
 17134                                    AT-FORM-SEND-ON-DT.
 17135     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17136                                    AT-FORM-LAST-UPDATED-BY.
 17137     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17138     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17139     MOVE '6'                    TO DC-OPTION-CODE.
 17140     MOVE +29                    TO DC-ELAPSED-DAYS.
 17141     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17142     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17143     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17144
 17145     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17146         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17147
 17148     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17149                                    AT-FORM-RE-SEND-DT
 17150                                    AT-EMP-FORM-ANSWERED-DT
 17151                                    AT-PHY-FORM-ANSWERED-DT
 17152                                    AT-EMP-FORM-SEND-ON-DT
 17153                                    AT-PHY-FORM-SEND-ON-DT
 17154                                    AT-FORM-PRINTED-DT
 17155                                    AT-FORM-REPRINT-DT.
 17156     MOVE '2'                    TO AT-FORM-TYPE.
 17157
 17158     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17159     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 328
* EL156.cbl
 17160
 17161     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17162         NEXT SENTENCE
 17163     ELSE
 17164         IF CL-PROG-FORM-TYPE NOT = 'S'
 17165            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17166
 17167
 17168* EXEC CICS WRITE
 17169*         DATASET  ('ELTRLR')
 17170*         FROM     (ACTIVITY-TRAILERS)
 17171*         RIDFLD   (AT-CONTROL-PRIMARY)
 17172*     END-EXEC.
 17173     MOVE LENGTH OF
 17174      ACTIVITY-TRAILERS
 17175       TO DFHEIV11
 17176     MOVE 'ELTRLR' TO DFHEIV1
 17177*    MOVE '&$ L                  ''   #00015873' TO DFHEIV0
 17178     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17179     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17180     MOVE X'2020233030303135383733' TO DFHEIV0(25:11)
 17181     CALL 'kxdfhei1' USING DFHEIV0,
 17182           DFHEIV1,
 17183           ACTIVITY-TRAILERS,
 17184           DFHEIV11,
 17185           AT-CONTROL-PRIMARY,
 17186           DFHEIV99,
 17187           DFHEIV99
 17188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17189
 17190
 17191 6899-EXIT.
 17192      EXIT.
 17193
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 329
* EL156.cbl
 17195 6900-BUILD-ARCHIVE-HEADER.
 17196
 17197     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17198     MOVE '1'                    TO CNTL-REC-TYPE.
 17199     MOVE +0                     TO CNTL-SEQ-NO.
 17200     MOVE SPACES                 TO CNTL-ACCESS.
 17201
 17202
 17203* EXEC CICS READ
 17204*         DATASET  ('ELCNTL')
 17205*         SET      (ADDRESS OF CONTROL-FILE)
 17206*         RIDFLD   (ELCNTL-KEY)
 17207*         UPDATE
 17208*    END-EXEC.
 17209     MOVE 'ELCNTL' TO DFHEIV1
 17210*    MOVE '&"S        EU         (   #00015890' TO DFHEIV0
 17211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17212     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17213     MOVE X'2020233030303135383930' TO DFHEIV0(25:11)
 17214     CALL 'kxdfhei1' USING DFHEIV0,
 17215           DFHEIV1,
 17216           DFHEIV20,
 17217           DFHEIV99,
 17218           ELCNTL-KEY,
 17219           DFHEIV99,
 17220           DFHEIV99,
 17221           DFHEIV99
 17222     SET ADDRESS OF CONTROL-FILE TO
 17223         DFHEIV20
 17224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17225
 17226
 17227     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17228     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17229
 17230
 17231* EXEC CICS REWRITE
 17232*         FROM     (CONTROL-FILE)
 17233*         DATASET  ('ELCNTL')
 17234*    END-EXEC.
 17235     MOVE LENGTH OF
 17236      CONTROL-FILE
 17237       TO DFHEIV11
 17238     MOVE 'ELCNTL' TO DFHEIV1
 17239*    MOVE '&& L                  %   #00015900' TO DFHEIV0
 17240     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17241     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17242     MOVE X'2020233030303135393030' TO DFHEIV0(25:11)
 17243     CALL 'kxdfhei1' USING DFHEIV0,
 17244           DFHEIV1,
 17245           CONTROL-FILE,
 17246           DFHEIV11,
 17247           DFHEIV99
 17248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17249
 17250
 17251
 17252* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 330
* EL156.cbl
 17253*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17254*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17255*    END-EXEC.
 17256*    MOVE '"$$%                  ! 7 #00015905' TO DFHEIV0
 17257     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17258     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17259     MOVE X'3720233030303135393035' TO DFHEIV0(25:11)
 17260     CALL 'kxdfhei1' USING DFHEIV0
 17261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17262
 17263
 17264
 17265* EXEC CICS GETMAIN
 17266*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17267*         LENGTH  (ELARCH-LENGTH)
 17268*         INITIMG (GETMAIN-SPACE)
 17269*    END-EXEC.
 17270*    MOVE ',"IL                  $   #00015910' TO DFHEIV0
 17271     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17273     MOVE X'2020233030303135393130' TO DFHEIV0(25:11)
 17274     CALL 'kxdfhei1' USING DFHEIV0,
 17275           DFHEIV20,
 17276           ELARCH-LENGTH,
 17277           GETMAIN-SPACE
 17278     SET ADDRESS OF LETTER-ARCHIVE TO
 17279         DFHEIV20
 17280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17281
 17282
 17283     MOVE 'LA'                   TO LA-RECORD-ID.
 17284     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17285                                    LA-ARCHIVE-NO-A1.
 17286     MOVE '4'                    TO LA-RECORD-TYPE
 17287                                    LA-RECORD-TYPE-A1.
 17288     MOVE +0                     TO LA-LINE-SEQ-NO
 17289                                    LA-LINE-SEQ-NO-A1.
 17290     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17291                                    LA-COMPANY-CD-A1.
 17292     MOVE CL-CARRIER             TO LA4-CARRIER.
 17293     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17294     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17295     MOVE CL-CERT-STATE          TO LA4-STATE.
 17296     MOVE +0                     TO LA4-NO-OF-COPIES.
 17297     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17298     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17299     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17300                                    LA4-INITIAL-PRINT-DATE
 17301                                    LA4-RESEND-PRINT-DATE
 17302                                    LA4-FORM-REM-PRINT-DT.
 17303     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17304     MOVE '2'                    TO LA4-FORM-TYPE.
 17305
 17306
 17307* EXEC CICS WRITE
 17308*         DATASET  ('ELARCH')
 17309*         FROM     (LETTER-ARCHIVE)
 17310*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 331
* EL156.cbl
 17311*    END-EXEC.
 17312     MOVE LENGTH OF
 17313      LETTER-ARCHIVE
 17314       TO DFHEIV11
 17315     MOVE 'ELARCH' TO DFHEIV1
 17316*    MOVE '&$ L                  ''   #00015939' TO DFHEIV0
 17317     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17318     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17319     MOVE X'2020233030303135393339' TO DFHEIV0(25:11)
 17320     CALL 'kxdfhei1' USING DFHEIV0,
 17321           DFHEIV1,
 17322           LETTER-ARCHIVE,
 17323           DFHEIV11,
 17324           LA-CONTROL-PRIMARY,
 17325           DFHEIV99,
 17326           DFHEIV99
 17327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17328
 17329
 17330 6999-EXIT.
 17331      EXIT.
 17332
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 332
* EL156.cbl
 17334 7000-SHOW-CLAIM.
 17335     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17336     MOVE 'A'                    TO PI-PASS-SW.
 17337     MOVE LOW-VALUES             TO PI-CPYFROM
 17338                                    PI-MONTH-END-SAVE
 17339                                    PI-CPYTHRU.
 17340
 17341     MOVE ZEROS                  TO PI-FATAL-COUNT
 17342                                    PI-DAILY-RATE
 17343                                    PI-BEN-DAYS
 17344                                    PI-MANUAL-SW
 17345                                    PI-SAVE-CURSOR
 17346                                    PI-FORCE-COUNT
 17347                                    PI-HOLDTIL
 17348                                    PI-EPYFROM
 17349                                    PI-EPYTHRU
 17350                                    PI-EDAYS
 17351                                    PI-EPYAMT
 17352                                    PI-ERESV
 17353                                    PI-EEXPENS
 17354                                    PI-CDAYS
 17355                                    PI-CPYAMT
 17356                                    PI-CRESV
 17357                                    PI-CEXPENS
 17358                                    PI-INT-RATE
 17359                                    PI-AIGFROM.
 17360     MOVE ZEROS                  TO PI-PROOF-DATE.
 17361     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17362                                    PI-REM-BEN-AMT
 17363                                    PI-MO-BEN-AMT
 17364                                    pi-ah-term.
 17365
 17366     MOVE LOW-VALUES             TO EL156AI.
 17367     MOVE MAP-NAMEA              TO MAP-NAME.
 17368
 17369* EXEC CICS HANDLE CONDITION
 17370*        NOTFND   (7010-BUILD-MAP)
 17371*    END-EXEC.
 17372*    MOVE '"$I                   ! 8 #00015983' TO DFHEIV0
 17373     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17375     MOVE X'3820233030303135393833' TO DFHEIV0(25:11)
 17376     CALL 'kxdfhei1' USING DFHEIV0
 17377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17378
 17379
 17380     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17381     MOVE '2'                    TO CNTL-REC-TYPE.
 17382     MOVE +0                     TO CNTL-SEQ-NO.
 17383     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17384
 17385
 17386* EXEC CICS READ
 17387*         DATASET  ('ELCNTL')
 17388*         SET      (ADDRESS OF CONTROL-FILE)
 17389*         RIDFLD   (ELCNTL-KEY)
 17390*    END-EXEC.
 17391     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 333
* EL156.cbl
 17392*    MOVE '&"S        E          (   #00015992' TO DFHEIV0
 17393     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17395     MOVE X'2020233030303135393932' TO DFHEIV0(25:11)
 17396     CALL 'kxdfhei1' USING DFHEIV0,
 17397           DFHEIV1,
 17398           DFHEIV20,
 17399           DFHEIV99,
 17400           ELCNTL-KEY,
 17401           DFHEIV99,
 17402           DFHEIV99,
 17403           DFHEIV99
 17404     SET ADDRESS OF CONTROL-FILE TO
 17405         DFHEIV20
 17406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17407
 17408
 17409     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17410
 17411     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17412         MOVE AL-UANON      TO SURVYYNA
 17413     END-IF.
 17414
 17415
 17416     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17417     MOVE '1'                    TO CNTL-REC-TYPE.
 17418     MOVE SPACES                 TO CNTL-ACCESS.
 17419     MOVE +0                     TO CNTL-SEQ-NO.
 17420
 17421
 17422* EXEC CICS READ
 17423*         DATASET  ('ELCNTL')
 17424*         SET      (ADDRESS OF CONTROL-FILE)
 17425*         RIDFLD   (ELCNTL-KEY)
 17426*    END-EXEC.
 17427     MOVE 'ELCNTL' TO DFHEIV1
 17428*    MOVE '&"S        E          (   #00016010' TO DFHEIV0
 17429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17431     MOVE X'2020233030303136303130' TO DFHEIV0(25:11)
 17432     CALL 'kxdfhei1' USING DFHEIV0,
 17433           DFHEIV1,
 17434           DFHEIV20,
 17435           DFHEIV99,
 17436           ELCNTL-KEY,
 17437           DFHEIV99,
 17438           DFHEIV99,
 17439           DFHEIV99
 17440     SET ADDRESS OF CONTROL-FILE TO
 17441         DFHEIV20
 17442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17443
 17444
 17445     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17446
 17447 7010-BUILD-MAP.
 17448
 17449
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 334
* EL156.cbl
 17450* EXEC CICS HANDLE CONDITION
 17451*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17452*    END-EXEC.
 17453*    MOVE '"$I                   ! 9 #00016020' TO DFHEIV0
 17454     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17456     MOVE X'3920233030303136303230' TO DFHEIV0(25:11)
 17457     CALL 'kxdfhei1' USING DFHEIV0
 17458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17459
 17460
 17461     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17462     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17463     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17464     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17465     MOVE 'MSTR'                 TO FILE-SWITCH.
 17466
 17467     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17468
 17469     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17470     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17471     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17472     MOVE CL-CCN                 TO PI-SV-CCN.
 17473
 17474     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17475     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17476     MOVE CL-CLAIM-NO            TO CLMNOO.
 17477     MOVE CL-CARRIER             TO CARRO.
 17478     MOVE CL-CERT-PRIME          TO CERTNOO.
 17479     MOVE CL-CERT-SFX            TO SUFXO.
 17480
 17481     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17482        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17483        CONTINUE
 17484     ELSE
 17485        MOVE AL-SADOF            TO ZINTHA
 17486                                    ZINTA
 17487                                    PINTHA
 17488                                    PINTA
 17489     END-IF
 17490     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17491     EVALUATE TRUE
 17492     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17493         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17494     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17495         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17496
 17497     WHEN CL-CLAIM-TYPE = 'I'
 17498         MOVE '  IU  '           TO CLMTYPO
 17499     WHEN CL-CLAIM-TYPE = 'G'
 17500         MOVE ' GAP  '           TO CLMTYPO
 17501     WHEN CL-CLAIM-TYPE = 'F'
 17502         MOVE ' FMLA '           TO CLMTYPO
 17503     END-EVALUATE.
 17504     IF CLAIM-IS-OPEN
 17505         MOVE ' OPEN'            TO CLMSTATO
 17506     ELSE
 17507         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 335
* EL156.cbl
 17508
 17509     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17510
 17511     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17512         MOVE SPACES             TO  PCERTNOO
 17513                                     PSUFXO
 17514                                     PRIMHDGO
 17515                                     SEQUO
 17516         MOVE AL-SADOF           TO  PCERTNOA
 17517                                     PSUFXA
 17518                                     PRIMHDGA
 17519                                     SEQUA
 17520     ELSE
 17521         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17522         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17523         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17524         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17525         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17526         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17527         MOVE AL-SANON               TO  PCERTNOA
 17528                                         PSUFXA
 17529                                         PRIMHDGA
 17530         MOVE AL-SABON               TO  SEQUA.
 17531
 17532     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17533
 17534     IF CL-NO-OF-PMTS-MADE = 0 AND
 17535        CL-TOTAL-PAID-AMT = 0
 17536         NEXT SENTENCE
 17537     ELSE
 17538         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17539             IF NOT PI-USES-PAID-TO
 17540                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17541                 MOVE ' '                 TO DC-OPTION-CODE
 17542                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17543                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17544             ELSE
 17545                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17546                 MOVE '6'                 TO DC-OPTION-CODE
 17547                 MOVE +1                  TO DC-ELAPSED-DAYS
 17548                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17549                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17550                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17551
 17552     IF MAP-NAME = 'EL156A'
 17553        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17554           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17555             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17556           end-if
 17557        end-if
 17558     end-if
 17559     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17560         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17561         MOVE ' '                TO DC-OPTION-CODE
 17562         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17563         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17564
 17565     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 336
* EL156.cbl
 17566         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17567         MOVE ' '                TO DC-OPTION-CODE
 17568         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17569         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17570
 17571     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17572
 17573     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17574         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17575         MOVE ' '                TO DC-OPTION-CODE
 17576         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17577         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17578
 17579     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17580         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17581         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17582     ELSE
 17583         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17584         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17585
 17586     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17587     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17588     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17589     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17590                                    PI-GROUPING.
 17591     MOVE CL-CERT-STATE          TO CERT-STATE
 17592                                    PI-STATE.
 17593     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17594                                    PI-ACCOUNT.
 17595     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17596     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17597     MOVE 'CERT'                 TO FILE-SWITCH.
 17598
 17599     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17600     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17601        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17602        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17603            MOVE 'N' TO PI-JOINT-INSURED-IND
 17604     ELSE
 17605            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17606     END-IF.
 17607
 17608     perform 7975-read-acct      thru 7975-exit
 17609     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17610     MOVE PI-STATE               TO WS-ST-ACCESS.
 17611     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17612     MOVE '3'                    TO CNTL-REC-TYPE.
 17613     MOVE +0                     TO CNTL-SEQ-NO.
 17614     MOVE 'STAT'                 TO FILE-SWITCH.
 17615
 17616     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17617
 17618     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17619     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17620
 17621     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17622        GO TO 7020-BYPASS-BENEFIT.
 17623
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 337
* EL156.cbl
 17624     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17625     MOVE '4'                    TO CNTL-REC-TYPE.
 17626     MOVE +0                     TO CNTL-SEQ-NO.
 17627     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17628     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17629     MOVE 'BENE'                 TO FILE-SWITCH.
 17630
 17631     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17632
 17633     IF NO-BENEFIT-FOUND
 17634        GO TO 7020-BYPASS-BENEFIT.
 17635
 17636     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17637     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17638     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17639
 17640 7020-BYPASS-BENEFIT.
 17641
 17642*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17643*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17644*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17645
 17646     move zeros                  to PI-MAX-BENEFIT-AMT
 17647     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17648     move cm-ah-orig-term        to pi-ah-term
 17649     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17650     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17651          'G' and 'F'
 17652         GO TO 7021-GO-TO-LIFE.
 17653
 17654     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17655        and (acct-found)
 17656        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17657        PERFORM 0900-GET-DDF-limits
 17658                                 THRU 0900-EXIT
 17659        IF PDEF-FOUND
 17660           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17661              (P1 > +8)
 17662              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17663           END-PERFORM
 17664           IF P1 < +9
 17665              if pd-ben-pct (p1) not numeric
 17666                 move zeros      to pd-ben-pct (p1)
 17667              end-if
 17668              if pd-ben-pct (p1) = zeros
 17669                 move +1         to ws-work-ben-pct
 17670              else
 17671                 move pd-ben-pct (p1)
 17672                                 to ws-work-ben-pct
 17673              end-if
 17674              compute cm-ah-benefit-amt =
 17675                 cm-ah-benefit-amt * ws-work-ben-pct
 17676              move pd-max-amt (p1) to pi-max-benefit-amt
 17677           END-IF
 17678        END-IF
 17679     end-if
 17680     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17681     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 338
* EL156.cbl
 17682     if (pi-max-benefit-amt not = zeros)
 17683        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17684        move pi-max-benefit-amt  to beneo
 17685     else
 17686        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17687     end-if
 17688     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17689     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17690                                    CP-ORIGINAL-TERM.
 17691     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17692
 17693*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17694*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17695*    ELSE
 17696         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17697
 17698     MOVE ' '                    TO DC-OPTION-CODE.
 17699     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17700     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17701
 17702     IF PI-COMPANY-ID = 'DMD'
 17703         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17704         GO TO 7023-BYPASS-REMAINING-TERM.
 17705
 17706     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17707     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17708     GO TO 7022-AROUND-LIFE.
 17709
 17710 7021-GO-TO-LIFE.
 17711
 17712     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17713     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17714     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17715                                    CP-ORIGINAL-TERM.
 17716     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17717     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17718     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17719     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17720
 17721     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17722         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17723     ELSE
 17724         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17725
 17726     MOVE ' '                    TO DC-OPTION-CODE.
 17727     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17728     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17729
 17730 7022-AROUND-LIFE.
 17731
 17732     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17733     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17734     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17735     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17736     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17737     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17738     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17739
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 339
* EL156.cbl
 17740     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17741
 17742     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17743        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17744           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17745
 17746     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17747        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17748           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17749
 17750 7023-BYPASS-REMAINING-TERM.
 17751     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17752       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17753          MOVE ZEROS                  TO BENEO
 17754       ELSE
 17755          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17756          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17757          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17758          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17759          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17760          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17761          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17762          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17763          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17764          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17765          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17766          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17767          IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17768             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17769             PERFORM 0900-GET-DDF-limits
 17770                                 THRU 0900-EXIT
 17771             IF PDEF-FOUND
 17772                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17773                   (P1 > +8)
 17774                   OR (PD-PROD-CODE (P1) = 'L')
 17775                END-PERFORM
 17776                IF P1 < +9
 17777                   MOVE PD-MAX-AMT (P1)
 17778                                 TO CP-R-MAX-TOT-BEN
 17779                END-IF
 17780             END-IF
 17781          END-IF
 17782
 17783* EXEC CICS LINK
 17784*            PROGRAM  (LINK-REMAMT)
 17785*            COMMAREA (CALCULATION-PASS-AREA)
 17786*            LENGTH   (CP-COMM-LENGTH)
 17787*         END-EXEC
 17788*    MOVE '."C                   (   #00016345' TO DFHEIV0
 17789     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17791     MOVE X'2020233030303136333435' TO DFHEIV0(25:11)
 17792     CALL 'kxdfhei1' USING DFHEIV0,
 17793           LINK-REMAMT,
 17794           CALCULATION-PASS-AREA,
 17795           CP-COMM-LENGTH,
 17796           DFHEIV99,
 17797           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 340
* EL156.cbl
 17798           DFHEIV99,
 17799           DFHEIV99
 17800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17801          MOVE CP-REMAINING-AMT       TO BENEO
 17802       end-if
 17803     end-if
 17804     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17805     MOVE +95                    TO TRLR-SEQ-NO
 17806
 17807* EXEC CICS READ
 17808*       DATASET  ('ELTRLR')
 17809*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17810*       RIDFLD   (ELTRLR-KEY)
 17811*       RESP     (WS-RESPONSE)
 17812*    END-EXEC
 17813     MOVE 'ELTRLR' TO DFHEIV1
 17814*    MOVE '&"S        E          (  N#00016355' TO DFHEIV0
 17815     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17817     MOVE X'204E233030303136333535' TO DFHEIV0(25:11)
 17818     CALL 'kxdfhei1' USING DFHEIV0,
 17819           DFHEIV1,
 17820           DFHEIV20,
 17821           DFHEIV99,
 17822           ELTRLR-KEY,
 17823           DFHEIV99,
 17824           DFHEIV99,
 17825           DFHEIV99
 17826     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17827         DFHEIV20
 17828     MOVE EIBRESP  TO WS-RESPONSE
 17829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17830
 17831     if ws-resp-normal
 17832        perform varying s1 from +1 by +1 until
 17833           at-note-error-no (s1) = spaces
 17834           move at-note-error-no (s1)
 17835                                 to emi-error
 17836           if at-note-error-no (s1) = '1653'
 17837              evaluate true
 17838                 when cl-claim-type = 'L'
 17839                    move '  LF  '
 17840                                 to emi-claim-type
 17841                 when cl-claim-type = 'I'
 17842                    move '  IU  '
 17843                                 to emi-claim-type
 17844                 when cl-claim-type = 'F'
 17845                    move ' FMLA '
 17846                                 to emi-claim-type
 17847                 when other
 17848                    move '  AH  '
 17849                                 to emi-claim-type
 17850              end-evaluate
 17851           end-if
 17852           PERFORM 9900-ERROR-FORMAT
 17853                                 THRU 9900-EXIT
 17854        end-perform
 17855     end-if
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 341
* EL156.cbl
 17856     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17857         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17858            WS-LF-COVERAGE-TYPE = 'P'
 17859             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17860                                        CM-LF-ITD-DEATH-AMT
 17861             MOVE WS-REMAINING-AMT  TO  BENEO.
 17862
 17863     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17864     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17865     MOVE WS-TERMS               TO TERMSO.
 17866
 17867     IF WS-STATUS = '6' OR '7' OR '8'
 17868         MOVE AL-SABOF           TO CRTSTATA.
 17869
 17870     IF WS-STATUS = '1' OR '4'
 17871        IF CP-REMAINING-TERM-3 = ZEROS
 17872           MOVE 'EXPIRED'        TO CRTSTATO
 17873        ELSE
 17874           MOVE 'ACTIVE  '       TO CRTSTATO.
 17875
 17876     IF WS-STATUS = '2'
 17877         MOVE 'PEND    '         TO CRTSTATO.
 17878
 17879     IF WS-STATUS = '3'
 17880         MOVE 'RESTORE '         TO CRTSTATO.
 17881
 17882     IF WS-STATUS = '5'
 17883         MOVE 'REISSUE '         TO CRTSTATO.
 17884
 17885     IF WS-STATUS = '6'
 17886         MOVE 'LMP DIS'          TO CRTSTATO.
 17887
 17888     IF WS-STATUS = '7'
 17889         MOVE 'DEATH'            TO CRTSTATO.
 17890
 17891     IF WS-STATUS = '8'
 17892         MOVE 'CANCEL'           TO CRTSTATO.
 17893
 17894     IF WS-STATUS = '9'
 17895         MOVE 'RE-ONLY '         TO CRTSTATO.
 17896
 17897     IF WS-STATUS = 'V'
 17898         MOVE 'VOID  '           TO CRTSTATO.
 17899
 17900     IF WS-STATUS = 'D'
 17901         MOVE 'DECLINE '         TO CRTSTATO.
 17902
 17903     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17904         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17905         MOVE '5'                TO CNTL-REC-TYPE
 17906     ELSE
 17907         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17908         MOVE '4'                TO CNTL-REC-TYPE.
 17909
 17910     MOVE '** NONE **'           TO COVERO.
 17911     MOVE AL-SABON               TO COVERA.
 17912
 17913     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 342
* EL156.cbl
 17914         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17915             MOVE CM-BENEFICIARY TO LOANNOO
 17916             MOVE AL-UANON       TO LOANNOA.
 17917
 17918     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 17919        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17920        MOVE +91                 TO  TRLR-SEQ-NO
 17921
 17922* EXEC CICS READ
 17923*           DATASET  ('ELTRLR')
 17924*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17925*           RIDFLD   (ELTRLR-KEY)
 17926*           RESP     (WS-RESPONSE)
 17927*       END-EXEC
 17928     MOVE 'ELTRLR' TO DFHEIV1
 17929*    MOVE '&"S        E          (  N#00016452' TO DFHEIV0
 17930     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17931     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17932     MOVE X'204E233030303136343532' TO DFHEIV0(25:11)
 17933     CALL 'kxdfhei1' USING DFHEIV0,
 17934           DFHEIV1,
 17935           DFHEIV20,
 17936           DFHEIV99,
 17937           ELTRLR-KEY,
 17938           DFHEIV99,
 17939           DFHEIV99,
 17940           DFHEIV99
 17941     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17942         DFHEIV20
 17943     MOVE EIBRESP  TO WS-RESPONSE
 17944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17945
 17946        IF WS-RESP-NORMAL
 17947           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17948        ELSE
 17949           MOVE SPACES           TO  LOANNOO
 17950        END-IF
 17951*052506
 17952*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17953*052506
 17954     END-IF
 17955
 17956     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17957        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17958
 17959     IF WS-BEN-CD = ZEROS
 17960         GO TO 7050-SHOW-CONTINUE.
 17961
 17962     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17963     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17964     MOVE +0                     TO CNTL-SEQ-NO.
 17965     MOVE 'BENE'                 TO FILE-SWITCH.
 17966
 17967     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17968     IF BENEFIT-FOUND
 17969        MOVE CF-JOINT-INDICATOR (SUB-1)
 17970                                 TO PI-JOINT-COV-IND
 17971                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 343
* EL156.cbl
 17972        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 17973                                 TO COVERO
 17974        MOVE AL-SANON            TO COVERA
 17975     END-IF
 17976     if (cntl-rec-type = '4')   *> Life claim
 17977        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 17978        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 17979        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 17980        MOVE '5'              TO CNTL-REC-TYPE
 17981        MOVE WS-ACCESS        TO CNTL-ACCESS
 17982        MOVE +0               TO CNTL-SEQ-NO
 17983        MOVE 'BENE'           TO FILE-SWITCH
 17984        PERFORM 7200-FIND-BENEFIT
 17985                              THRU 7200-EXIT
 17986        IF (BENEFIT-FOUND)
 17987           and (pi-rb-joint-cov-ind) not = 'J'
 17988           MOVE CF-JOINT-INDICATOR (SUB-1)
 17989                              TO PI-rb-JOINT-COV-IND
 17990        end-if
 17991     end-if
 17992     .
 17993 7050-SHOW-CONTINUE.
 17994
 17995     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17996        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17997            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17998     END-IF
 17999
 18000     IF PI-COMPANY-ID = 'DMD'
 18001         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18002
 18003     MOVE -1                     TO PMTTYPEL.
 18004     GO TO 8100-SEND-INITIAL-MAP.
 18005
 18006 7100-SHOW-RECORD-NOT-FOUND.
 18007     IF FILE-SWITCH = 'MSTR'
 18008         MOVE ER-0204            TO EMI-ERROR.
 18009
 18010     IF FILE-SWITCH = 'CERT'
 18011         MOVE ER-0206            TO EMI-ERROR.
 18012
 18013     IF FILE-SWITCH = 'STAT'
 18014         MOVE ER-0149            TO EMI-ERROR.
 18015
 18016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18017
 18018     MOVE -1                     TO PMTTYPEL.
 18019     GO TO 8100-SEND-INITIAL-MAP
 18020
 18021     .
 18022 7110-BUILD-PMT-TRLR.
 18023     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18024     MOVE +51                    TO TRLR-SEQ-NO
 18025
 18026* EXEC CICS READ
 18027*        DATASET  ('ELTRLR')
 18028*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18029*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 344
* EL156.cbl
 18030*        RESP     (WS-RESPONSE)
 18031*    END-EXEC
 18032     MOVE 'ELTRLR' TO DFHEIV1
 18033*    MOVE '&"S        E          (  N#00016538' TO DFHEIV0
 18034     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18036     MOVE X'204E233030303136353338' TO DFHEIV0(25:11)
 18037     CALL 'kxdfhei1' USING DFHEIV0,
 18038           DFHEIV1,
 18039           DFHEIV20,
 18040           DFHEIV99,
 18041           ELTRLR-KEY,
 18042           DFHEIV99,
 18043           DFHEIV99,
 18044           DFHEIV99
 18045     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18046         DFHEIV20
 18047     MOVE EIBRESP  TO WS-RESPONSE
 18048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18049     IF WS-RESP-NORMAL
 18050        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18051     END-IF
 18052     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18053
 18054* EXEC CICS GETMAIN
 18055*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18056*         LENGTH    (200)
 18057*         INITIMG   (GETMAIN-SPACE)
 18058*     END-EXEC
 18059     MOVE 200
 18060       TO DFHEIV11
 18061*    MOVE ',"IL                  $   #00016548' TO DFHEIV0
 18062     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18063     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18064     MOVE X'2020233030303136353438' TO DFHEIV0(25:11)
 18065     CALL 'kxdfhei1' USING DFHEIV0,
 18066           DFHEIV20,
 18067           DFHEIV11,
 18068           GETMAIN-SPACE
 18069     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18070         DFHEIV20
 18071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18072     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18073                                    AT-PREV-PAID-THRU-DT
 18074     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18075     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18076     MOVE 'AT'                   TO AT-RECORD-ID
 18077     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18078     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18079     MOVE '2'                    TO AT-TRAILER-TYPE
 18080     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18081                                    AT-PAYMENT-LAST-MAINT-DT
 18082     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18083                                    AT-PAYMENT-LAST-UPDATED-BY
 18084     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18085     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18086     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18087     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 345
* EL156.cbl
 18088     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18089     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18090     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18091     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18092     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18093     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18094     if pi-int-to-rem-borr = 'Y'
 18095        move 'Q1'                to at-payee-type-cd
 18096     else
 18097        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18098     end-if
 18099     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18100     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18101     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18102     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18103     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18104                                    AT-TO-BE-WRITTEN-DT
 18105     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18106                                    AT-CHECK-QUE-SEQUENCE
 18107                                    AT-ADDL-RESERVE
 18108     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18109                                    AT-VOID-SELECT-DT
 18110                                    AT-VOID-ACCEPT-DT
 18111                                    AT-VOID-DT
 18112                                    AT-PMT-PROOF-DT
 18113                                    AT-INT-PMT-SELECT-DT
 18114     MOVE ZEROS                  TO AT-DAILY-RATE
 18115                                    AT-ELIMINATION-DAYS
 18116     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18117*    EXEC CICS HANDLE CONDITION
 18118*        DUPREC    (7120-DUPREC)
 18119*    END-EXEC
 18120     .
 18121 7115-WRITE-INT-TRLR.
 18122
 18123* EXEC CICS WRITE
 18124*         DATASET       ('ELTRLR')
 18125*         FROM          (ACTIVITY-TRAILERS)
 18126*         RIDFLD        (AT-CONTROL-PRIMARY)
 18127*         RESP          (WS-RESPONSE)
 18128*     END-EXEC
 18129     MOVE LENGTH OF
 18130      ACTIVITY-TRAILERS
 18131       TO DFHEIV11
 18132     MOVE 'ELTRLR' TO DFHEIV1
 18133*    MOVE '&$ L                  ''  N#00016603' TO DFHEIV0
 18134     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18135     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18136     MOVE X'204E233030303136363033' TO DFHEIV0(25:11)
 18137     CALL 'kxdfhei1' USING DFHEIV0,
 18138           DFHEIV1,
 18139           ACTIVITY-TRAILERS,
 18140           DFHEIV11,
 18141           AT-CONTROL-PRIMARY,
 18142           DFHEIV99,
 18143           DFHEIV99
 18144     MOVE EIBRESP  TO WS-RESPONSE
 18145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 346
* EL156.cbl
 18146      IF WS-RESP-DUPREC
 18147         GO TO 7120-DUPREC
 18148      END-IF
 18149     GO TO 7130-EXIT
 18150     .
 18151 7120-DUPREC.
 18152     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18153     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18154     GO TO 7115-WRITE-INT-TRLR
 18155     .
 18156 7130-EXIT.
 18157      EXIT.
 18158 7140-BUILD-NOTE-TRLR.
 18159
 18160
 18161* EXEC CICS GETMAIN
 18162*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18163*         LENGTH    (200)
 18164*         INITIMG   (GETMAIN-SPACE)
 18165*     END-EXEC
 18166     MOVE 200
 18167       TO DFHEIV11
 18168*    MOVE ',"IL                  $   #00016623' TO DFHEIV0
 18169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18171     MOVE X'2020233030303136363233' TO DFHEIV0(25:11)
 18172     CALL 'kxdfhei1' USING DFHEIV0,
 18173           DFHEIV20,
 18174           DFHEIV11,
 18175           GETMAIN-SPACE
 18176     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18177         DFHEIV20
 18178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18179     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18180     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18181     MOVE 'AT'                   TO AT-RECORD-ID
 18182     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18183     MOVE '6'                    TO AT-TRAILER-TYPE
 18184     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18185                                    AT-GEN-INFO-LAST-MAINT-DT
 18186     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18187                                    AT-GEN-INFO-LAST-UPDATED-BY
 18188     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18189     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18190     .
 18191 7150-WRITE.
 18192
 18193* EXEC CICS HANDLE CONDITION
 18194*        DUPREC    (7160-DUPREC)
 18195*    END-EXEC
 18196*    MOVE '"$%                   ! : #00016641' TO DFHEIV0
 18197     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18199     MOVE X'3A20233030303136363431' TO DFHEIV0(25:11)
 18200     CALL 'kxdfhei1' USING DFHEIV0
 18201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18202
 18203* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 347
* EL156.cbl
 18204*         DATASET     ('ELTRLR')
 18205*         FROM        (ACTIVITY-TRAILERS)
 18206*         RIDFLD      (AT-CONTROL-PRIMARY)
 18207*         RESP        (WS-RESPONSE)
 18208*     END-EXEC
 18209     MOVE LENGTH OF
 18210      ACTIVITY-TRAILERS
 18211       TO DFHEIV11
 18212     MOVE 'ELTRLR' TO DFHEIV1
 18213*    MOVE '&$ L                  ''  N#00016644' TO DFHEIV0
 18214     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18215     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18216     MOVE X'204E233030303136363434' TO DFHEIV0(25:11)
 18217     CALL 'kxdfhei1' USING DFHEIV0,
 18218           DFHEIV1,
 18219           ACTIVITY-TRAILERS,
 18220           DFHEIV11,
 18221           AT-CONTROL-PRIMARY,
 18222           DFHEIV99,
 18223           DFHEIV99
 18224     MOVE EIBRESP  TO WS-RESPONSE
 18225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18226      IF WS-RESP-DUPREC
 18227         GO TO 7160-DUPREC
 18228      END-IF
 18229     GO TO 7170-EXIT
 18230     .
 18231 7160-DUPREC.
 18232     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18233     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18234     GO TO 7150-WRITE
 18235     .
 18236 7170-EXIT.
 18237      EXIT.
 18238
 18239 7180-ADD-CERT-NOTE.
 18240*ADD CERT NOTE FOR SC NP+6
 18241
 18242
 18243* EXEC CICS GETMAIN
 18244*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18245*         LENGTH    (150)
 18246*         INITIMG   (GETMAIN-SPACE)
 18247*     END-EXEC.
 18248     MOVE 150
 18249       TO DFHEIV11
 18250*    MOVE ',"IL                  $   #00016666' TO DFHEIV0
 18251     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18252     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18253     MOVE X'2020233030303136363636' TO DFHEIV0(25:11)
 18254     CALL 'kxdfhei1' USING DFHEIV0,
 18255           DFHEIV20,
 18256           DFHEIV11,
 18257           GETMAIN-SPACE
 18258     SET ADDRESS OF CERT-NOTE-FILE TO
 18259         DFHEIV20
 18260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18261
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 348
* EL156.cbl
 18262
 18263     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18264     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18265     MOVE +1                     TO WRK-NOTE-SEQ.
 18266     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18267     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18268     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18269     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18270     MOVE CL-CERT-STATE          TO CZ-STATE.
 18271     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18272     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18273     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18274     MOVE '2'                    TO CZ-RECORD-TYPE.
 18275     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18276     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18277     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18278     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18279     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18280     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18281     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18282     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18283     IF PI-COMPANY-ID = 'AHL'
 18284        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18285           CONTINUE
 18286        ELSE
 18287           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18288              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18289           ELSE
 18290              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18291           END-IF
 18292        END-IF
 18293     END-IF
 18294     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18295     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18296
 18297 7181-WRITE.
 18298
 18299
 18300* EXEC CICS WRITE
 18301*         DATASET     ('ERCNOT')
 18302*         FROM        (CERT-NOTE-FILE)
 18303*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18304*         RESP        (WS-RESPONSE)
 18305*    END-EXEC.
 18306     MOVE LENGTH OF
 18307      CERT-NOTE-FILE
 18308       TO DFHEIV11
 18309     MOVE 'ERCNOT' TO DFHEIV1
 18310*    MOVE '&$ L                  ''  N#00016708' TO DFHEIV0
 18311     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18312     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18313     MOVE X'204E233030303136373038' TO DFHEIV0(25:11)
 18314     CALL 'kxdfhei1' USING DFHEIV0,
 18315           DFHEIV1,
 18316           CERT-NOTE-FILE,
 18317           DFHEIV11,
 18318           CZ-CONTROL-PRIMARY,
 18319           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 349
* EL156.cbl
 18320           DFHEIV99
 18321     MOVE EIBRESP  TO WS-RESPONSE
 18322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18323
 18324
 18325     IF WS-RESP-DUPREC
 18326         GO TO 7182-DUPREC
 18327     END-IF.
 18328
 18329     SET CERT-NOTE-ADDED TO TRUE.
 18330
 18331     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18332         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18333     END-IF.
 18334
 18335     GO TO 7189-EXIT.
 18336
 18337 7182-DUPREC.
 18338
 18339     ADD +1                      TO  WRK-NOTE-SEQ.
 18340     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18341     GO TO 7181-WRITE.
 18342
 18343 7189-EXIT.
 18344      EXIT.
 18345
 18346 7190-ADD-ORIG-NOTE.
 18347
 18348
 18349* EXEC CICS GETMAIN
 18350*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18351*         LENGTH    (150)
 18352*         INITIMG   (GETMAIN-SPACE)
 18353*     END-EXEC.
 18354     MOVE 150
 18355       TO DFHEIV11
 18356*    MOVE ',"IL                  $   #00016738' TO DFHEIV0
 18357     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18358     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18359     MOVE X'2020233030303136373338' TO DFHEIV0(25:11)
 18360     CALL 'kxdfhei1' USING DFHEIV0,
 18361           DFHEIV20,
 18362           DFHEIV11,
 18363           GETMAIN-SPACE
 18364     SET ADDRESS OF CERT-NOTE-FILE TO
 18365         DFHEIV20
 18366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18367
 18368
 18369     ADD +1                      TO WRK-NOTE-SEQ.
 18370     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18371     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18372     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18373     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18374     MOVE CL-CERT-STATE          TO CZ-STATE.
 18375     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18376     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18377     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 350
* EL156.cbl
 18378     MOVE '2'                    TO CZ-RECORD-TYPE.
 18379     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18380     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18381     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18382     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18383     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18384     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18385
 18386 7191-WRITE.
 18387
 18388
 18389* EXEC CICS WRITE
 18390*         DATASET     ('ERCNOT')
 18391*         FROM        (CERT-NOTE-FILE)
 18392*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18393*         RESP        (WS-RESPONSE)
 18394*    END-EXEC.
 18395     MOVE LENGTH OF
 18396      CERT-NOTE-FILE
 18397       TO DFHEIV11
 18398     MOVE 'ERCNOT' TO DFHEIV1
 18399*    MOVE '&$ L                  ''  N#00016763' TO DFHEIV0
 18400     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18402     MOVE X'204E233030303136373633' TO DFHEIV0(25:11)
 18403     CALL 'kxdfhei1' USING DFHEIV0,
 18404           DFHEIV1,
 18405           CERT-NOTE-FILE,
 18406           DFHEIV11,
 18407           CZ-CONTROL-PRIMARY,
 18408           DFHEIV99,
 18409           DFHEIV99
 18410     MOVE EIBRESP  TO WS-RESPONSE
 18411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18412
 18413
 18414     IF WS-RESP-DUPREC
 18415         GO TO 7192-DUPREC
 18416     END-IF.
 18417
 18418     GO TO 7199-EXIT.
 18419
 18420 7192-DUPREC.
 18421
 18422     ADD +1                      TO  WRK-NOTE-SEQ.
 18423     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18424     GO TO 7191-WRITE.
 18425
 18426 7199-EXIT.
 18427      EXIT.
 18428 7200-FIND-BENEFIT.
 18429     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18430
 18431
 18432* EXEC CICS HANDLE CONDITION
 18433*        ENDFILE(7200-EXIT)
 18434*        NOTFND(7200-EXIT)
 18435*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 351
* EL156.cbl
 18436*    MOVE '"$''I                  ! ; #00016787' TO DFHEIV0
 18437     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18439     MOVE X'3B20233030303136373837' TO DFHEIV0(25:11)
 18440     CALL 'kxdfhei1' USING DFHEIV0
 18441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18442
 18443
 18444
 18445* EXEC CICS READ
 18446*        DATASET('ELCNTL')
 18447*        SET(ADDRESS OF CONTROL-FILE)
 18448*        RIDFLD(ELCNTL-KEY)
 18449*        GTEQ
 18450*    END-EXEC.
 18451     MOVE 'ELCNTL' TO DFHEIV1
 18452*    MOVE '&"S        G          (   #00016792' TO DFHEIV0
 18453     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18455     MOVE X'2020233030303136373932' TO DFHEIV0(25:11)
 18456     CALL 'kxdfhei1' USING DFHEIV0,
 18457           DFHEIV1,
 18458           DFHEIV20,
 18459           DFHEIV99,
 18460           ELCNTL-KEY,
 18461           DFHEIV99,
 18462           DFHEIV99,
 18463           DFHEIV99
 18464     SET ADDRESS OF CONTROL-FILE TO
 18465         DFHEIV20
 18466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18467
 18468
 18469     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18470        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18471           GO TO 7200-EXIT.
 18472
 18473     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18474         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18475            ((SUB-1 > 8) OR
 18476            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18477
 18478     IF SUB-1 NOT = 9
 18479         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18480
 18481     GO TO 7200-EXIT.
 18482
 18483 7200-BENEFIT-DUMMY.
 18484
 18485 7200-DUMMY-EXIT.
 18486     EXIT.
 18487
 18488 7200-EXIT.
 18489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 352
* EL156.cbl
 18491*052506
 18492*052506 7250-FIND-LETTER-TRLR.
 18493*052506     EXEC CICS HANDLE CONDITION
 18494*052506         ENDFILE  (7250-END)
 18495*052506         NOTFND   (7250-END)
 18496*052506     END-EXEC.
 18497*052506
 18498*052506     EXEC CICS STARTBR
 18499*052506         DATASET   ('ELTRLR')
 18500*052506         RIDFLD    (ELTRLR-KEY)
 18501*052506         GTEQ
 18502*052506     END-EXEC.
 18503*052506
 18504*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18505*052506
 18506*052506 7250-FIND-LOOP.
 18507*052506     EXEC CICS READNEXT
 18508*052506         DATASET   ('ELTRLR')
 18509*052506         RIDFLD    (ELTRLR-KEY)
 18510*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18511*052506     END-EXEC.
 18512*052506
 18513*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18514*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18515*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18516*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18517*052506        GO TO 7250-END
 18518*052506     END-IF.
 18519*052506
 18520*052506     IF AT-TRAILER-TYPE NOT = '4'
 18521*052506         GO TO 7250-FIND-LOOP
 18522*052506     END-IF.
 18523*052506
 18524*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18525*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18526*052506     END-IF.
 18527*052506
 18528*052506     GO TO 7250-FIND-LOOP.
 18529*052506
 18530*052506 7250-END.
 18531*052506
 18532*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18533*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18534*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18535*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18536*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18537*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18538*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18539*052506     END-IF.
 18540*052506
 18541*052506     EXEC CICS ENDBR
 18542*052506          DATASET    ('ELTRLR')
 18543*052506     END-EXEC.
 18544*052506
 18545*052506 7250-EXIT.
 18546*052506     EXIT.
 18547*052506     EJECT
 18548*052506
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 353
* EL156.cbl
 18549 7300-CHECK-AUTO-ACTIVITY.
 18550
 18551     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18552         NEXT SENTENCE
 18553     ELSE
 18554         GO TO 7399-EXIT.
 18555
 18556     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18557
 18558     IF WS-ACT-REC-FOUND-SW = 'N'
 18559         GO TO 7399-EXIT.
 18560
 18561     IF PI-ACTIVITY-CODE = 09
 18562         GO TO 7300-CONT-AUTO-ACTIVITY.
 18563
 18564     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18565        (PI-ACTIVITY-CODE = 11)
 18566         GO TO 7300-CONT-AUTO-ACTIVITY.
 18567
 18568     IF PI-PROVISIONAL-IND = 'P'
 18569         IF PI-PMTTYPE = '1'
 18570             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18571                 MOVE 'N'    TO  PI-RESET-SW
 18572                 GO TO 7399-EXIT.
 18573
 18574     IF PI-PMTTYPE = '1'
 18575         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18576             MOVE 'N'        TO  PI-RESET-SW
 18577             GO TO 7399-EXIT.
 18578
 18579     IF PI-PMTTYPE = '2' OR '3'
 18580         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18581             MOVE 'N'        TO  PI-RESET-SW
 18582             GO TO 7399-EXIT.
 18583
 18584     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18585         IF PI-PROVISIONAL-IND = 'P'
 18586             NEXT SENTENCE
 18587         ELSE
 18588             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18589
 18590 7300-CONT-AUTO-ACTIVITY.
 18591
 18592     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18593         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18594         MOVE '4'            TO DC-OPTION-CODE
 18595         MOVE +0             TO DC-ELAPSED-DAYS
 18596                                DC-ELAPSED-MONTHS
 18597         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18598         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18599         IF PI-USES-PAID-TO
 18600             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18601             IF NO-CONVERSION-ERROR
 18602                 MOVE +1     TO DC-ELAPSED-DAYS
 18603                 MOVE +0     TO DC-ELAPSED-MONTHS
 18604                 MOVE '6'    TO DC-OPTION-CODE
 18605                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18606                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 354
* EL156.cbl
 18607                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18608
 18609     IF PI-PFKEY-USED = DFHPF5
 18610         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18611         IF PI-USES-PAID-TO
 18612             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18613             MOVE +1                  TO DC-ELAPSED-DAYS
 18614             MOVE +0                  TO DC-ELAPSED-MONTHS
 18615             MOVE '6'                 TO DC-OPTION-CODE
 18616             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18617             IF NO-CONVERSION-ERROR
 18618                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18619
 18620     IF WS-CHK-THRU-DT < PI-EXP-DT
 18621         NEXT SENTENCE
 18622     ELSE
 18623         MOVE 03                     TO  WS-ACTIVITY-CODE
 18624         GO TO 7390-PROCESS-ACTIVITY.
 18625
 18626     IF PI-PROV-PMT
 18627         MOVE 09                     TO  WS-ACTIVITY-CODE
 18628     ELSE
 18629        IF PI-PMTTYPE = '1'
 18630            MOVE 02                  TO  WS-ACTIVITY-CODE
 18631        ELSE
 18632        IF PI-PMTTYPE = '2' OR '3'
 18633            MOVE 07                  TO  WS-ACTIVITY-CODE
 18634        ELSE
 18635        IF PI-PMTTYPE = '4'
 18636            MOVE 00                  TO  WS-ACTIVITY-CODE
 18637        ELSE
 18638            MOVE 'N'                 TO  PI-RESET-SW
 18639            GO TO 7399-EXIT.
 18640
 18641 7390-PROCESS-ACTIVITY.
 18642
 18643     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18644
 18645 7399-EXIT.
 18646     EXIT.
 18647
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 355
* EL156.cbl
 18649 7400-CHECK-AUTO-ACTIVITY.
 18650
 18651
 18652* EXEC CICS HANDLE CONDITION
 18653*        NOTFND   (7400-NOT-FOUND)
 18654*    END-EXEC.
 18655*    MOVE '"$I                   ! < #00016981' TO DFHEIV0
 18656     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18658     MOVE X'3C20233030303136393831' TO DFHEIV0(25:11)
 18659     CALL 'kxdfhei1' USING DFHEIV0
 18660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18661
 18662
 18663     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18664     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18665     MOVE SPACES                 TO  CNTL-ACCESS.
 18666     MOVE +0                     TO  CNTL-SEQ-NO.
 18667
 18668
 18669* EXEC CICS READ
 18670*        DATASET   ('ELCNTL')
 18671*        RIDFLD    (ELCNTL-KEY)
 18672*        SET       (ADDRESS OF CONTROL-FILE)
 18673*    END-EXEC.
 18674     MOVE 'ELCNTL' TO DFHEIV1
 18675*    MOVE '&"S        E          (   #00016990' TO DFHEIV0
 18676     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18677     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18678     MOVE X'2020233030303136393930' TO DFHEIV0(25:11)
 18679     CALL 'kxdfhei1' USING DFHEIV0,
 18680           DFHEIV1,
 18681           DFHEIV20,
 18682           DFHEIV99,
 18683           ELCNTL-KEY,
 18684           DFHEIV99,
 18685           DFHEIV99,
 18686           DFHEIV99
 18687     SET ADDRESS OF CONTROL-FILE TO
 18688         DFHEIV20
 18689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18690
 18691
 18692     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18693     GO TO 7400-EXIT.
 18694
 18695 7400-NOT-FOUND.
 18696     MOVE 'N'                        TO  PI-RESET-SW
 18697                                         WS-LETTER-SW
 18698                                         WS-ACT-REC-FOUND-SW.
 18699
 18700     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18701
 18702 7400-EXIT.
 18703     EXIT.
 18704
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 356
* EL156.cbl
 18706 7450-FORMAT-AUTO-LETTER.
 18707
 18708     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18709         MOVE 'Y'                    TO PI-RESET-SW
 18710         GO TO 7450-CONTINUE-PROCESS.
 18711
 18712     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18713
 18714     IF SUB > 9
 18715         SUBTRACT 9 FROM SUB
 18716         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18717     ELSE
 18718         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18719
 18720 7450-CONTINUE-PROCESS.
 18721
 18722     IF WS-ACTIVITY-CODE = ZEROS
 18723         MOVE 'N'                    TO  WS-LETTER-SW
 18724         GO TO 7450-EXIT.
 18725
 18726     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18727
 18728     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18729         MOVE 'N'                    TO  PI-RESET-SW
 18730                                         WS-LETTER-SW
 18731         GO TO 7450-EXIT.
 18732
 18733     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18734         MOVE 'N'                    TO  WS-LETTER-SW
 18735         GO TO 7450-EXIT.
 18736
 18737     MOVE 'Y'                        TO  WS-LETTER-SW.
 18738     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18739     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18740
 18741     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18742
 18743     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18744         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18745         MOVE '6'                    TO  DC-OPTION-CODE
 18746         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18747         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18748         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18749         IF NO-CONVERSION-ERROR
 18750             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18751         ELSE
 18752              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18753
 18754     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18755         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18756         MOVE '6'                    TO  DC-OPTION-CODE
 18757         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18758         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18759         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18760         IF NO-CONVERSION-ERROR
 18761             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18762         ELSE
 18763             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 357
* EL156.cbl
 18764
 18765 7450-EXIT.
 18766     EXIT.
 18767
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 358
* EL156.cbl
 18769 7500-RESET-AUTO-ACTIVITY.
 18770
 18771     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18772     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18773     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18774     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18775     MOVE +100                   TO  TRLR-SEQ-NO.
 18776
 18777 7500-STARTBR-TRLR.
 18778
 18779
 18780* EXEC CICS HANDLE CONDITION
 18781*        ENDFILE  (7590-END)
 18782*        NOTFND   (7590-END)
 18783*    END-EXEC.
 18784*    MOVE '"$''I                  ! = #00017083' TO DFHEIV0
 18785     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18787     MOVE X'3D20233030303137303833' TO DFHEIV0(25:11)
 18788     CALL 'kxdfhei1' USING DFHEIV0
 18789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18790
 18791
 18792
 18793* EXEC CICS STARTBR
 18794*        DATASET   ('ELTRLR')
 18795*        RIDFLD    (ELTRLR-KEY)
 18796*        GTEQ
 18797*    END-EXEC.
 18798     MOVE 'ELTRLR' TO DFHEIV1
 18799     MOVE 0
 18800       TO DFHEIV11
 18801*    MOVE '&,         G          &   #00017088' TO DFHEIV0
 18802     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18803     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18804     MOVE X'2020233030303137303838' TO DFHEIV0(25:11)
 18805     CALL 'kxdfhei1' USING DFHEIV0,
 18806           DFHEIV1,
 18807           ELTRLR-KEY,
 18808           DFHEIV99,
 18809           DFHEIV11,
 18810           DFHEIV99
 18811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18812
 18813
 18814     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18815
 18816 7500-READ-NEXT.
 18817
 18818
 18819* EXEC CICS READNEXT
 18820*        DATASET   ('ELTRLR')
 18821*        RIDFLD    (ELTRLR-KEY)
 18822*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18823*    END-EXEC.
 18824     MOVE 'ELTRLR' TO DFHEIV1
 18825     MOVE 0
 18826       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 359
* EL156.cbl
 18827*    MOVE '&.S                   )   #00017098' TO DFHEIV0
 18828     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18829     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18830     MOVE X'2020233030303137303938' TO DFHEIV0(25:11)
 18831     CALL 'kxdfhei1' USING DFHEIV0,
 18832           DFHEIV1,
 18833           DFHEIV20,
 18834           DFHEIV99,
 18835           ELTRLR-KEY,
 18836           DFHEIV99,
 18837           DFHEIV11,
 18838           DFHEIV99,
 18839           DFHEIV99
 18840     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18841         DFHEIV20
 18842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18843
 18844
 18845     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18846        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18847        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18848        PI-CERT-NO    NOT = TRLR-CERT-NO
 18849         GO TO 7590-END.
 18850
 18851     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18852         GO TO 7500-READ-NEXT.
 18853
 18854     IF AT-TRAILER-TYPE NOT = '4'
 18855         GO TO 7500-READ-NEXT.
 18856
 18857     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18858         GO TO 7500-READ-NEXT.
 18859
 18860     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18861        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18862         GO TO 7500-READ-NEXT.
 18863
 18864     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18865        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18866        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18867         GO TO 7500-READ-NEXT.
 18868
 18869     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18870                         AND
 18871        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18872                         AND
 18873        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18874            GO TO 7500-READ-NEXT.
 18875
 18876     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18877
 18878
 18879* EXEC CICS ENDBR
 18880*        DATASET   ('ELTRLR')
 18881*    END-EXEC.
 18882     MOVE 'ELTRLR' TO DFHEIV1
 18883     MOVE 0
 18884       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 360
* EL156.cbl
 18885*    MOVE '&2                    $   #00017137' TO DFHEIV0
 18886     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18887     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18888     MOVE X'2020233030303137313337' TO DFHEIV0(25:11)
 18889     CALL 'kxdfhei1' USING DFHEIV0,
 18890           DFHEIV1,
 18891           DFHEIV11,
 18892           DFHEIV99
 18893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18894
 18895
 18896     MOVE 'N'                        TO  WS-BROWSE-SW.
 18897
 18898
 18899* EXEC CICS READ
 18900*        DATASET   ('ELTRLR')
 18901*        RIDFLD    (ELTRLR-KEY)
 18902*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18903*        UPDATE
 18904*    END-EXEC.
 18905     MOVE 'ELTRLR' TO DFHEIV1
 18906*    MOVE '&"S        EU         (   #00017143' TO DFHEIV0
 18907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18908     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18909     MOVE X'2020233030303137313433' TO DFHEIV0(25:11)
 18910     CALL 'kxdfhei1' USING DFHEIV0,
 18911           DFHEIV1,
 18912           DFHEIV20,
 18913           DFHEIV99,
 18914           ELTRLR-KEY,
 18915           DFHEIV99,
 18916           DFHEIV99,
 18917           DFHEIV99
 18918     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18919         DFHEIV20
 18920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18921
 18922
 18923     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18924
 18925     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18926         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18927     ELSE
 18928         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18929             NEXT SENTENCE
 18930         ELSE
 18931             GO TO 7500-REWRITE-TRLR.
 18932
 18933     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18934
 18935     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18936     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18937     MOVE '1'                        TO  ARCH-REC-TYPE.
 18938     MOVE +0                         TO  ARCH-SEQ.
 18939
 18940     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18941
 18942 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 361
* EL156.cbl
 18943
 18944
 18945* EXEC CICS REWRITE
 18946*        DATASET   ('ELTRLR')
 18947*        FROM      (ACTIVITY-TRAILERS)
 18948*    END-EXEC.
 18949     MOVE LENGTH OF
 18950      ACTIVITY-TRAILERS
 18951       TO DFHEIV11
 18952     MOVE 'ELTRLR' TO DFHEIV1
 18953*    MOVE '&& L                  %   #00017171' TO DFHEIV0
 18954     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18955     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18956     MOVE X'2020233030303137313731' TO DFHEIV0(25:11)
 18957     CALL 'kxdfhei1' USING DFHEIV0,
 18958           DFHEIV1,
 18959           ACTIVITY-TRAILERS,
 18960           DFHEIV11,
 18961           DFHEIV99
 18962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18963
 18964
 18965     GO TO 7500-STARTBR-TRLR.
 18966
 18967 7590-END.
 18968
 18969     IF WS-BROWSE-SW = 'Y'
 18970         MOVE 'N'                    TO  WS-BROWSE-SW
 18971
 18972* EXEC CICS ENDBR
 18973*            DATASET   ('ELTRLR')
 18974*        END-EXEC.
 18975     MOVE 'ELTRLR' TO DFHEIV1
 18976     MOVE 0
 18977       TO DFHEIV11
 18978*    MOVE '&2                    $   #00017182' TO DFHEIV0
 18979     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18980     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18981     MOVE X'2020233030303137313832' TO DFHEIV0(25:11)
 18982     CALL 'kxdfhei1' USING DFHEIV0,
 18983           DFHEIV1,
 18984           DFHEIV11,
 18985           DFHEIV99
 18986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18987
 18988
 18989 7599-EXIT.
 18990     EXIT.
 18991
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 362
* EL156.cbl
 18993 7600-READ-ARCH-UPDATE.
 18994
 18995
 18996* EXEC CICS HANDLE CONDITION
 18997*        NOTFND   (7699-EXIT)
 18998*    END-EXEC.
 18999*    MOVE '"$I                   ! > #00017192' TO DFHEIV0
 19000     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19002     MOVE X'3E20233030303137313932' TO DFHEIV0(25:11)
 19003     CALL 'kxdfhei1' USING DFHEIV0
 19004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19005
 19006
 19007
 19008* EXEC CICS READ
 19009*        DATASET   ('ELARCH')
 19010*        RIDFLD    (ELARCH-KEY)
 19011*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19012*        UPDATE
 19013*    END-EXEC.
 19014     MOVE 'ELARCH' TO DFHEIV1
 19015*    MOVE '&"S        EU         (   #00017196' TO DFHEIV0
 19016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19017     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19018     MOVE X'2020233030303137313936' TO DFHEIV0(25:11)
 19019     CALL 'kxdfhei1' USING DFHEIV0,
 19020           DFHEIV1,
 19021           DFHEIV20,
 19022           DFHEIV99,
 19023           ELARCH-KEY,
 19024           DFHEIV99,
 19025           DFHEIV99,
 19026           DFHEIV99
 19027     SET ADDRESS OF LETTER-ARCHIVE TO
 19028         DFHEIV20
 19029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19030
 19031
 19032     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19033
 19034
 19035* EXEC CICS REWRITE
 19036*        DATASET   ('ELARCH')
 19037*        FROM      (LETTER-ARCHIVE)
 19038*    END-EXEC.
 19039     MOVE LENGTH OF
 19040      LETTER-ARCHIVE
 19041       TO DFHEIV11
 19042     MOVE 'ELARCH' TO DFHEIV1
 19043*    MOVE '&& L                  %   #00017205' TO DFHEIV0
 19044     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19045     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19046     MOVE X'2020233030303137323035' TO DFHEIV0(25:11)
 19047     CALL 'kxdfhei1' USING DFHEIV0,
 19048           DFHEIV1,
 19049           LETTER-ARCHIVE,
 19050           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 363
* EL156.cbl
 19051           DFHEIV99
 19052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19053
 19054
 19055 7699-EXIT.
 19056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 364
* EL156.cbl
 19058 7700-GET-DCT.
 19059
 19060     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19061     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19062     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19063     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19064                                    PI-MAX-BENEFIT-AMT
 19065                                    PI-MAX-BENEFIT-PYMT
 19066                                    PI-MIN-PAYMENT-AMT
 19067                                    PI-TIME-OF-LOSS-BAL.
 19068
 19069
 19070* EXEC CICS HANDLE CONDITION
 19071*         NOTFND (5300-NOTE-NOT-FOUND)
 19072*     END-EXEC.
 19073*    MOVE '"$I                   ! ? #00017224' TO DFHEIV0
 19074     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19076     MOVE X'3F20233030303137323234' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0
 19078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19079
 19080
 19081
 19082* EXEC CICS READ
 19083*         DATASET('ERNOTE')
 19084*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19085*         RIDFLD (W-NOTE-KEY)
 19086*     END-EXEC.
 19087     MOVE 'ERNOTE' TO DFHEIV1
 19088*    MOVE '&"S        E          (   #00017228' TO DFHEIV0
 19089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19091     MOVE X'2020233030303137323238' TO DFHEIV0(25:11)
 19092     CALL 'kxdfhei1' USING DFHEIV0,
 19093           DFHEIV1,
 19094           DFHEIV20,
 19095           DFHEIV99,
 19096           W-NOTE-KEY,
 19097           DFHEIV99,
 19098           DFHEIV99,
 19099           DFHEIV99
 19100     SET ADDRESS OF CERTIFICATE-NOTE TO
 19101         DFHEIV20
 19102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19103
 19104
 19105     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19106     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19107     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19108     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19109     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19110
 19111     IF PI-PAYEE-TYPE NOT = 'B'
 19112         GO TO 7700-EXIT.
 19113
 19114     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19115     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 365
* EL156.cbl
 19116     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19117
 19118     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19119         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19120     ELSE
 19121         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19122
 19123     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19124     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19125     MOVE 'DLO006'               TO PGM-NAME.
 19126
 19127
 19128* EXEC CICS LINK
 19129*        PROGRAM    (PGM-NAME)
 19130*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19131*        LENGTH     (DCT-RCRD-LENGTH)
 19132*    END-EXEC.
 19133*    MOVE '."C                   (   #00017256' TO DFHEIV0
 19134     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19136     MOVE X'2020233030303137323536' TO DFHEIV0(25:11)
 19137     CALL 'kxdfhei1' USING DFHEIV0,
 19138           PGM-NAME,
 19139           DCT-COMMUNICATION-AREA,
 19140           DCT-RCRD-LENGTH,
 19141           DFHEIV99,
 19142           DFHEIV99,
 19143           DFHEIV99,
 19144           DFHEIV99
 19145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19146
 19147
 19148     IF DCT-RETURN-CODE = 'OK'
 19149         GO TO 7700-CONT.
 19150
 19151     IF DCT-RETURN-CODE = '01' OR '02'
 19152         GO TO 7700-SET-TO-YES.
 19153
 19154     IF DCT-RETURN-CODE = '03'
 19155
 19156* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19157*    MOVE '6"R                   !   #00017269' TO DFHEIV0
 19158     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19160     MOVE X'2020233030303137323639' TO DFHEIV0(25:11)
 19161     CALL 'kxdfhei1' USING DFHEIV0
 19162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19163         MOVE ER-0951            TO EMI-ERROR
 19164         MOVE -1                 TO PMTTYPEL
 19165         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19166         GO TO 8200-SEND-DATAONLY.
 19167
 19168     IF DCT-RETURN-CODE = '04'
 19169
 19170* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19171*    MOVE '6"R                   !   #00017276' TO DFHEIV0
 19172     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 366
* EL156.cbl
 19174     MOVE X'2020233030303137323736' TO DFHEIV0(25:11)
 19175     CALL 'kxdfhei1' USING DFHEIV0
 19176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19177         MOVE ER-0946            TO EMI-ERROR
 19178         MOVE -1                 TO PMTTYPEL
 19179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19180         GO TO 8200-SEND-DATAONLY.
 19181
 19182     IF DCT-RETURN-CODE = '05'
 19183
 19184* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19185*    MOVE '6"R                   !   #00017283' TO DFHEIV0
 19186     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19188     MOVE X'2020233030303137323833' TO DFHEIV0(25:11)
 19189     CALL 'kxdfhei1' USING DFHEIV0
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19191         MOVE ER-0947            TO EMI-ERROR
 19192         MOVE -1                 TO PMTTYPEL
 19193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19194         GO TO 8200-SEND-DATAONLY.
 19195
 19196     IF DCT-RETURN-CODE = '06'
 19197
 19198* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19199*    MOVE '6"R                   !   #00017290' TO DFHEIV0
 19200     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19202     MOVE X'2020233030303137323930' TO DFHEIV0(25:11)
 19203     CALL 'kxdfhei1' USING DFHEIV0
 19204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19205         MOVE ER-0921            TO EMI-ERROR
 19206         MOVE -1                 TO PMTTYPEL
 19207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19208         GO TO 8200-SEND-DATAONLY.
 19209
 19210     IF DCT-RETURN-CODE = '07'
 19211
 19212* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19213*    MOVE '6"R                   !   #00017297' TO DFHEIV0
 19214     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19216     MOVE X'2020233030303137323937' TO DFHEIV0(25:11)
 19217     CALL 'kxdfhei1' USING DFHEIV0
 19218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19219         MOVE ER-0919            TO EMI-ERROR
 19220         MOVE -1                 TO PMTTYPEL
 19221         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19222         GO TO 8200-SEND-DATAONLY.
 19223
 19224     IF DCT-RETURN-CODE = '08'
 19225
 19226* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19227*    MOVE '6"R                   !   #00017304' TO DFHEIV0
 19228     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303137333034' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 367
* EL156.cbl
 19232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19233         MOVE ER-0948            TO EMI-ERROR
 19234         MOVE -1                 TO PMTTYPEL
 19235         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19236         GO TO 8200-SEND-DATAONLY.
 19237
 19238     IF DCT-RETURN-CODE = 'N1'
 19239
 19240* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19241*    MOVE '6"R                   !   #00017311' TO DFHEIV0
 19242     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19244     MOVE X'2020233030303137333131' TO DFHEIV0(25:11)
 19245     CALL 'kxdfhei1' USING DFHEIV0
 19246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19247         MOVE ER-0950            TO EMI-ERROR
 19248         MOVE -1                 TO PMTTYPEL
 19249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19250         GO TO 8200-SEND-DATAONLY.
 19251
 19252     IF DCT-RETURN-CODE = 'E1'
 19253
 19254* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19255*    MOVE '6"R                   !   #00017318' TO DFHEIV0
 19256     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19258     MOVE X'2020233030303137333138' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0
 19260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19261         MOVE ER-0974            TO EMI-ERROR
 19262         MOVE -1                 TO PMTTYPEL
 19263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19264         GO TO 8200-SEND-DATAONLY.
 19265
 19266     IF DCT-RETURN-CODE = 'E2'
 19267
 19268* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19269*    MOVE '6"R                   !   #00017325' TO DFHEIV0
 19270     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19272     MOVE X'2020233030303137333235' TO DFHEIV0(25:11)
 19273     CALL 'kxdfhei1' USING DFHEIV0
 19274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19275         MOVE ER-0975            TO EMI-ERROR
 19276         MOVE -1                 TO PMTTYPEL
 19277         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19278         GO TO 8200-SEND-DATAONLY.
 19279
 19280     IF DCT-RETURN-CODE NOT = 'OK'
 19281
 19282* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19283*    MOVE '6"R                   !   #00017332' TO DFHEIV0
 19284     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19286     MOVE X'2020233030303137333332' TO DFHEIV0(25:11)
 19287     CALL 'kxdfhei1' USING DFHEIV0
 19288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19289         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 368
* EL156.cbl
 19290         MOVE -1                 TO PMTTYPEL
 19291         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19292         GO TO 8200-SEND-DATAONLY.
 19293
 19294 7700-CONT.
 19295
 19296*    MOVE 'N'                    TO CASHO.
 19297*    MOVE +1                     TO CASHL.
 19298*    MOVE AL-UANON               TO CASHA.
 19299
 19300     IF PI-OFFLINE = 'Y'
 19301         GO TO 7700-EXIT.
 19302
 19303     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19304     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19305     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19306     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19307     MOVE +7                     TO CHECKNOL.
 19308     MOVE AL-UANON               TO CHECKNOA.
 19309     GO TO 7700-EXIT.
 19310
 19311 7700-SET-TO-YES.
 19312
 19313*    MOVE 'Y'                    TO CASHO.
 19314*    MOVE +1                     TO CASHL.
 19315*    MOVE AL-UANON               TO CASHA.
 19316
 19317 7700-EXIT.
 19318     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 369
* EL156.cbl
 19320 7800-READ-COMP-MSTR.
 19321
 19322
 19323* EXEC CICS HANDLE CONDITION
 19324*        NOTFND   (7800-COMP-NOTFND)
 19325*    END-EXEC.
 19326*    MOVE '"$I                   ! @ #00017366' TO DFHEIV0
 19327     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19329     MOVE X'4020233030303137333636' TO DFHEIV0(25:11)
 19330     CALL 'kxdfhei1' USING DFHEIV0
 19331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19332
 19333
 19334
 19335* EXEC CICS READ
 19336*        DATASET   ('ERCOMP')
 19337*        RIDFLD    (ERCOMP-KEY)
 19338*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19339*    END-EXEC.
 19340     MOVE 'ERCOMP' TO DFHEIV1
 19341*    MOVE '&"S        E          (   #00017370' TO DFHEIV0
 19342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19344     MOVE X'2020233030303137333730' TO DFHEIV0(25:11)
 19345     CALL 'kxdfhei1' USING DFHEIV0,
 19346           DFHEIV1,
 19347           DFHEIV20,
 19348           DFHEIV99,
 19349           ERCOMP-KEY,
 19350           DFHEIV99,
 19351           DFHEIV99,
 19352           DFHEIV99
 19353     SET ADDRESS OF COMPENSATION-MASTER TO
 19354         DFHEIV20
 19355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19356
 19357
 19358     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19359     GO TO 7800-COMP-EXIT.
 19360
 19361 7800-COMP-NOTFND.
 19362     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19363
 19364 7800-COMP-EXIT.
 19365     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 370
* EL156.cbl
 19367 7900-READ-CLAIM.
 19368
 19369* EXEC CICS READ
 19370*        DATASET  ('ELMSTR')
 19371*        SET      (ADDRESS OF CLAIM-MASTER)
 19372*        RIDFLD   (ELMSTR-KEY)
 19373*    END-EXEC.
 19374     MOVE 'ELMSTR' TO DFHEIV1
 19375*    MOVE '&"S        E          (   #00017386' TO DFHEIV0
 19376     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19378     MOVE X'2020233030303137333836' TO DFHEIV0(25:11)
 19379     CALL 'kxdfhei1' USING DFHEIV0,
 19380           DFHEIV1,
 19381           DFHEIV20,
 19382           DFHEIV99,
 19383           ELMSTR-KEY,
 19384           DFHEIV99,
 19385           DFHEIV99,
 19386           DFHEIV99
 19387     SET ADDRESS OF CLAIM-MASTER TO
 19388         DFHEIV20
 19389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19390
 19391
 19392 7900-EXIT.
 19393      EXIT.
 19394
 19395 7910-READ-CLAIM-UPDATE.
 19396
 19397* EXEC CICS READ
 19398*        DATASET  ('ELMSTR')
 19399*        SET      (ADDRESS OF CLAIM-MASTER)
 19400*        RIDFLD   (ELMSTR-KEY)
 19401*        UPDATE
 19402*    END-EXEC.
 19403     MOVE 'ELMSTR' TO DFHEIV1
 19404*    MOVE '&"S        EU         (   #00017396' TO DFHEIV0
 19405     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19406     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19407     MOVE X'2020233030303137333936' TO DFHEIV0(25:11)
 19408     CALL 'kxdfhei1' USING DFHEIV0,
 19409           DFHEIV1,
 19410           DFHEIV20,
 19411           DFHEIV99,
 19412           ELMSTR-KEY,
 19413           DFHEIV99,
 19414           DFHEIV99,
 19415           DFHEIV99
 19416     SET ADDRESS OF CLAIM-MASTER TO
 19417         DFHEIV20
 19418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19419
 19420
 19421 7910-EXIT.
 19422      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 371
* EL156.cbl
 19424 7920-READ-BENE.
 19425     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19426     MOVE 'B'                TO BENE-RECORD-TYPE.
 19427     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19428
 19429     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19430        IF PI-PAYEE-TYPE    = 'B' AND
 19431           PI-PAYEE-SEQ-NUM = 9
 19432             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19433             MOVE WS-A-BENE           TO BENE-NUMBER.
 19434
 19435
 19436* EXEC CICS HANDLE CONDITION
 19437*        NOTFND   (7920-NOT-FOUND)
 19438*    END-EXEC.
 19439*    MOVE '"$I                   ! A #00017417' TO DFHEIV0
 19440     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19442     MOVE X'4120233030303137343137' TO DFHEIV0(25:11)
 19443     CALL 'kxdfhei1' USING DFHEIV0
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447
 19448* EXEC CICS READ
 19449*        DATASET  ('ELBENE')
 19450*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19451*        RIDFLD   (ELBENE-KEY)
 19452*    END-EXEC.
 19453     MOVE 'ELBENE' TO DFHEIV1
 19454*    MOVE '&"S        E          (   #00017421' TO DFHEIV0
 19455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19457     MOVE X'2020233030303137343231' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0,
 19459           DFHEIV1,
 19460           DFHEIV20,
 19461           DFHEIV99,
 19462           ELBENE-KEY,
 19463           DFHEIV99,
 19464           DFHEIV99,
 19465           DFHEIV99
 19466     SET ADDRESS OF BENEFICIARY-MASTER TO
 19467         DFHEIV20
 19468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19469
 19470
 19471     MOVE 'Y' TO BENE-FOUND-SW.
 19472     GO TO 7920-EXIT.
 19473
 19474 7920-NOT-FOUND.
 19475     MOVE 'N'                    TO BENE-FOUND-SW.
 19476
 19477 7920-EXIT.
 19478      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 372
* EL156.cbl
 19480 7930-READ-CONTROL.
 19481
 19482* EXEC CICS READ
 19483*        DATASET  ('ELCNTL')
 19484*        SET      (ADDRESS OF CONTROL-FILE)
 19485*        RIDFLD   (ELCNTL-KEY)
 19486*    END-EXEC.
 19487     MOVE 'ELCNTL' TO DFHEIV1
 19488*    MOVE '&"S        E          (   #00017437' TO DFHEIV0
 19489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19491     MOVE X'2020233030303137343337' TO DFHEIV0(25:11)
 19492     CALL 'kxdfhei1' USING DFHEIV0,
 19493           DFHEIV1,
 19494           DFHEIV20,
 19495           DFHEIV99,
 19496           ELCNTL-KEY,
 19497           DFHEIV99,
 19498           DFHEIV99,
 19499           DFHEIV99
 19500     SET ADDRESS OF CONTROL-FILE TO
 19501         DFHEIV20
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19503
 19504
 19505 7930-EXIT.
 19506      EXIT.
 19507
 19508 7940-READ-CONTROL-UPDATE.
 19509
 19510* EXEC CICS READ
 19511*        DATASET  ('ELCNTL')
 19512*        SET      (ADDRESS OF CONTROL-FILE)
 19513*        RIDFLD   (ELCNTL-KEY)
 19514*        UPDATE
 19515*    END-EXEC.
 19516     MOVE 'ELCNTL' TO DFHEIV1
 19517*    MOVE '&"S        EU         (   #00017447' TO DFHEIV0
 19518     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19519     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19520     MOVE X'2020233030303137343437' TO DFHEIV0(25:11)
 19521     CALL 'kxdfhei1' USING DFHEIV0,
 19522           DFHEIV1,
 19523           DFHEIV20,
 19524           DFHEIV99,
 19525           ELCNTL-KEY,
 19526           DFHEIV99,
 19527           DFHEIV99,
 19528           DFHEIV99
 19529     SET ADDRESS OF CONTROL-FILE TO
 19530         DFHEIV20
 19531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19532
 19533
 19534 7940-EXIT.
 19535      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 373
* EL156.cbl
 19537 7950-READ-TRAILER.
 19538
 19539* EXEC CICS READ
 19540*        DATASET  ('ELTRLR')
 19541*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19542*        RIDFLD   (ELTRLR-KEY)
 19543*    END-EXEC.
 19544     MOVE 'ELTRLR' TO DFHEIV1
 19545*    MOVE '&"S        E          (   #00017458' TO DFHEIV0
 19546     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19548     MOVE X'2020233030303137343538' TO DFHEIV0(25:11)
 19549     CALL 'kxdfhei1' USING DFHEIV0,
 19550           DFHEIV1,
 19551           DFHEIV20,
 19552           DFHEIV99,
 19553           ELTRLR-KEY,
 19554           DFHEIV99,
 19555           DFHEIV99,
 19556           DFHEIV99
 19557     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19558         DFHEIV20
 19559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19560
 19561
 19562 7950-EXIT.
 19563      EXIT.
 19564
 19565 7960-READ-TRAILER-UPDATE.
 19566
 19567* EXEC CICS READ
 19568*        DATASET  ('ELTRLR')
 19569*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19570*        RIDFLD   (ELTRLR-KEY)
 19571*        UPDATE
 19572*    END-EXEC.
 19573     MOVE 'ELTRLR' TO DFHEIV1
 19574*    MOVE '&"S        EU         (   #00017468' TO DFHEIV0
 19575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19576     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19577     MOVE X'2020233030303137343638' TO DFHEIV0(25:11)
 19578     CALL 'kxdfhei1' USING DFHEIV0,
 19579           DFHEIV1,
 19580           DFHEIV20,
 19581           DFHEIV99,
 19582           ELTRLR-KEY,
 19583           DFHEIV99,
 19584           DFHEIV99,
 19585           DFHEIV99
 19586     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19587         DFHEIV20
 19588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19589
 19590
 19591 7960-EXIT.
 19592      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 374
* EL156.cbl
 19594 7970-READ-CERT.
 19595
 19596* EXEC CICS READ
 19597*        DATASET  ('ELCERT')
 19598*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19599*        RIDFLD   (ELCERT-KEY)
 19600*    END-EXEC.
 19601     MOVE 'ELCERT' TO DFHEIV1
 19602*    MOVE '&"S        E          (   #00017479' TO DFHEIV0
 19603     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19605     MOVE X'2020233030303137343739' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0,
 19607           DFHEIV1,
 19608           DFHEIV20,
 19609           DFHEIV99,
 19610           ELCERT-KEY,
 19611           DFHEIV99,
 19612           DFHEIV99,
 19613           DFHEIV99
 19614     SET ADDRESS OF CERTIFICATE-MASTER TO
 19615         DFHEIV20
 19616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19617
 19618
 19619 7970-EXIT.
 19620      EXIT.
 19621 7975-read-acct.
 19622
 19623     move spaces              to WS-ACCT-RECORD-SW
 19624                                 pi-dcc-product-code
 19625
 19626     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19627     MOVE PI-CARRIER          TO ACCT-CARRIER
 19628     MOVE PI-GROUPING         TO ACCT-GROUPING
 19629     MOVE PI-STATE            TO ACCT-STATE
 19630     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19631     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19632     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19633     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19634
 19635
 19636* EXEC CICS READ
 19637*       DATASET ('ERACCT')
 19638*       RIDFLD  (ERACCT-KEY)
 19639*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19640*       GTEQ
 19641*       resp    (WS-RESPONSE)
 19642*    END-EXEC
 19643     MOVE 'ERACCT' TO DFHEIV1
 19644*    MOVE '&"S        G          (  N#00017501' TO DFHEIV0
 19645     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19647     MOVE X'204E233030303137353031' TO DFHEIV0(25:11)
 19648     CALL 'kxdfhei1' USING DFHEIV0,
 19649           DFHEIV1,
 19650           DFHEIV20,
 19651           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 375
* EL156.cbl
 19652           ERACCT-KEY,
 19653           DFHEIV99,
 19654           DFHEIV99,
 19655           DFHEIV99
 19656     SET ADDRESS OF ACCOUNT-MASTER TO
 19657         DFHEIV20
 19658     MOVE EIBRESP  TO WS-RESPONSE
 19659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19660     IF WS-RESP-NORMAL
 19661        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19662        and pi-cert-eff-dt < am-expiration-dt
 19663        and pi-cert-eff-dt >= am-effective-dt
 19664        move am-dcc-product-code to pi-dcc-product-code
 19665        set acct-found to true
 19666     end-if
 19667
 19668     .
 19669 7975-exit.
 19670     exit.
 19671 7980-READ-CERT-UPDATE.
 19672
 19673* EXEC CICS READ
 19674*        DATASET  ('ELCERT')
 19675*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19676*        RIDFLD   (ELCERT-KEY)
 19677*        UPDATE
 19678*    END-EXEC.
 19679     MOVE 'ELCERT' TO DFHEIV1
 19680*    MOVE '&"S        EU         (   #00017520' TO DFHEIV0
 19681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19682     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19683     MOVE X'2020233030303137353230' TO DFHEIV0(25:11)
 19684     CALL 'kxdfhei1' USING DFHEIV0,
 19685           DFHEIV1,
 19686           DFHEIV20,
 19687           DFHEIV99,
 19688           ELCERT-KEY,
 19689           DFHEIV99,
 19690           DFHEIV99,
 19691           DFHEIV99
 19692     SET ADDRESS OF CERTIFICATE-MASTER TO
 19693         DFHEIV20
 19694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19695
 19696
 19697 7980-EXIT.
 19698      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 376
* EL156.cbl
 19700 8000-LOAD-ERROR-MESSAGES.
 19701     IF PI-PASS-SW = 'C'
 19702        MOVE EMI-LINE1           TO ERMSG1BO
 19703     ELSE
 19704        MOVE EMI-LINE1           TO ERRMSG1O
 19705        MOVE EMI-LINE2           TO ERRMSG2O.
 19706
 19707 8000-EXIT.
 19708     EXIT.
 19709
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 377
* EL156.cbl
 19711
 19712 8010-DMD-ERROR-CHECKS.
 19713     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19714
 19715     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19716         GO TO 8051-ISSUE-ERROR.
 19717
 19718     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19719     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19720     MOVE '3'                    TO DC-OPTION-CODE.
 19721     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19722     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19723         GO TO 8051-ISSUE-ERROR.
 19724
 19725     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19726       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19727                           OR
 19728          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19729           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19730             MOVE ER-0851         TO EMI-ERROR
 19731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19732       END-IF
 19733       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19734             MOVE ER-8147         TO EMI-ERROR
 19735             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19736
 19737     GO TO 8090-EXIT.
 19738
 19739 8051-ISSUE-ERROR.
 19740     MOVE ER-8146            TO EMI-ERROR.
 19741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19742     GO TO 8090-EXIT.
 19743
 19744 8090-EXIT.
 19745      EXIT.
 19746
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 378
* EL156.cbl
 19748 8100-SEND-INITIAL-MAP.
 19749
 19750     MOVE SAVE-DATE              TO RUNDTEAO.
 19751     MOVE EIBTIME                TO TIME-IN.
 19752     MOVE TIME-OUT               TO RUNTIMAO.
 19753     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19754
 19755     IF MAP-NAME = 'EL156A'
 19756        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19757           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19758        END-IF
 19759        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 19760           MOVE 'N'     TO SURVYYNO
 19761        END-IF
 19762     END-IF
 19763*    IF MAP-NAME = 'EL156A'
 19764*       IF PI-COMPANY-ID = 'CRI'
 19765*          NEXT SENTENCE
 19766*       ELSE
 19767*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19768
 19769     IF MAP-NAME = 'EL156A'
 19770        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19771           NEXT SENTENCE
 19772        ELSE
 19773           MOVE AL-SADOF TO  PINTA    PINTHA.
 19774
 19775     IF MAP-NAME = 'EL156A'
 19776        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19777            NEXT SENTENCE
 19778        ELSE
 19779           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19780
 19781*    IF MAP-NAME = 'EL156A'
 19782*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19783*          NEXT SENTENCE
 19784*       ELSE
 19785*          MOVE AL-SADOF TO CASHHA CASHA.
 19786
 19787     IF MAP-NAME = 'EL156A'
 19788        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19789                        or 'CAP'
 19790           NEXT SENTENCE
 19791        ELSE
 19792           MOVE AL-SADOF        TO  LOANHA
 19793                                    LOANNOA.
 19794
 19795     IF MAP-NAME = 'EL156A'
 19796        MOVE -1                 TO  ENTERPFL
 19797        IF PI-USES-PAID-TO
 19798           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19799           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19800           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19801        ELSE
 19802           NEXT SENTENCE
 19803     ELSE
 19804        IF MAP-NAME = 'EL156B'
 19805           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 379
* EL156.cbl
 19806              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19807              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19808
 19809
 19810* EXEC CICS SEND
 19811*        MAP   (MAP-NAME)
 19812*        MAPSET(MAPSET-NAME)
 19813*        FROM  (EL156AI)
 19814*        ERASE
 19815*        CURSOR
 19816*    END-EXEC.
 19817     MOVE LENGTH OF
 19818      EL156AI
 19819       TO DFHEIV12
 19820     MOVE -1
 19821       TO DFHEIV11
 19822*    MOVE '8$     CT  E    H L F ,   #00017639' TO DFHEIV0
 19823     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19824     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19825     MOVE X'2020233030303137363339' TO DFHEIV0(25:11)
 19826     CALL 'kxdfhei1' USING DFHEIV0,
 19827           MAP-NAME,
 19828           EL156AI,
 19829           DFHEIV12,
 19830           MAPSET-NAME,
 19831           DFHEIV99,
 19832           DFHEIV99,
 19833           DFHEIV99,
 19834           DFHEIV11,
 19835           DFHEIV99,
 19836           DFHEIV99,
 19837           DFHEIV99
 19838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19839
 19840
 19841     GO TO 9100-RETURN-TRAN.
 19842
 19843 8200-SEND-DATAONLY.
 19844
 19845     IF FIRST-ENTRY = 'Y'
 19846         GO TO 8100-SEND-INITIAL-MAP.
 19847
 19848     IF RETURNED-FROM-B = 'Y'
 19849         GO TO 8100-SEND-INITIAL-MAP.
 19850
 19851     MOVE SAVE-DATE              TO RUNDTEAO.
 19852     MOVE EIBTIME                TO TIME-IN.
 19853     MOVE TIME-OUT               TO RUNTIMAO.
 19854
 19855     IF EIBAID = DFHPF11
 19856        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19858        MOVE 'EL001   '          TO RETURNED-FROM
 19859        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19860        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19861        GO TO 8100-SEND-INITIAL-MAP.
 19862
 19863     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 380
* EL156.cbl
 19864
 19865     IF MAP-NAME =  'EL156A'
 19866        MOVE -1                 TO  ENTERPFL
 19867        IF PI-USES-PAID-TO
 19868           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19869           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19870           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19871        ELSE
 19872           NEXT SENTENCE
 19873     ELSE
 19874        IF MAP-NAME = 'EL156B'
 19875           IF PI-USES-PAID-TO
 19876              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19877              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19878
 19879     IF MAP-NAME =  'EL156A'
 19880        IF PI-COMPANY-ID = 'BOA'
 19881            IF PI-INT-RATE NUMERIC
 19882                MOVE PI-INT-RATE TO PINTO.
 19883     IF MAP-NAME = 'EL156A'
 19884        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19885           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19886*          MOVE 'Y'              TO EOBYNO
 19887        END-IF
 19888     END-IF
 19889
 19890
 19891* EXEC CICS SEND
 19892*        MAP   (MAP-NAME)
 19893*        MAPSET(MAPSET-NAME)
 19894*        FROM  (EL156AI)
 19895*        DATAONLY
 19896*        CURSOR
 19897*    END-EXEC.
 19898     MOVE LENGTH OF
 19899      EL156AI
 19900       TO DFHEIV12
 19901     MOVE -1
 19902       TO DFHEIV11
 19903*    MOVE '8$D    CT       H L F ,   #00017696' TO DFHEIV0
 19904     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19905     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19906     MOVE X'2020233030303137363936' TO DFHEIV0(25:11)
 19907     CALL 'kxdfhei1' USING DFHEIV0,
 19908           MAP-NAME,
 19909           EL156AI,
 19910           DFHEIV12,
 19911           MAPSET-NAME,
 19912           DFHEIV99,
 19913           DFHEIV99,
 19914           DFHEIV99,
 19915           DFHEIV11,
 19916           DFHEIV99,
 19917           DFHEIV99,
 19918           DFHEIV99
 19919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19920
 19921
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 381
* EL156.cbl
 19922     GO TO 9100-RETURN-TRAN.
 19923
 19924 8300-SEND-TEXT.
 19925
 19926* EXEC CICS SEND TEXT
 19927*        FROM(LOGOFF-TEXT)
 19928*        LENGTH(LOGOFF-LENGTH)
 19929*        ERASE
 19930*        FREEKB
 19931*    END-EXEC.
 19932*    MOVE '8&      T  E F  H   F -   #00017707' TO DFHEIV0
 19933     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19934     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19935     MOVE X'2020233030303137373037' TO DFHEIV0(25:11)
 19936     CALL 'kxdfhei1' USING DFHEIV0,
 19937           LOGOFF-TEXT,
 19938           LOGOFF-LENGTH,
 19939           DFHEIV99,
 19940           DFHEIV99,
 19941           DFHEIV99,
 19942           DFHEIV99,
 19943           DFHEIV99,
 19944           DFHEIV99,
 19945           DFHEIV99,
 19946           DFHEIV99,
 19947           DFHEIV99,
 19948           DFHEIV99
 19949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19950
 19951
 19952
 19953* EXEC CICS RETURN
 19954*    END-EXEC.
 19955*    MOVE '.(                    ''   #00017714' TO DFHEIV0
 19956     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19957     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19958     MOVE X'2020233030303137373134' TO DFHEIV0(25:11)
 19959     CALL 'kxdfhei1' USING DFHEIV0,
 19960           DFHEIV99,
 19961           DFHEIV99,
 19962           DFHEIV99,
 19963           DFHEIV99,
 19964           DFHEIV99,
 19965           DFHEIV99
 19966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19967
 19968
 19969 8500-FILE-NOTOPEN.
 19970     IF FILE-SWITCH = 'MSTR'
 19971         MOVE ER-0154            TO EMI-ERROR.
 19972     IF FILE-SWITCH = 'TRLR'
 19973         MOVE ER-0172            TO EMI-ERROR.
 19974     IF FILE-SWITCH = 'CERT'
 19975         MOVE ER-0169            TO EMI-ERROR.
 19976     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19977                      'PROC' OR 'STAT'
 19978         MOVE ER-0042            TO EMI-ERROR.
 19979     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 382
* EL156.cbl
 19980         MOVE ER-0338            TO EMI-ERROR.
 19981     IF FILE-SWITCH = 'ACCT'
 19982         MOVE ER-0168            TO EMI-ERROR.
 19983
 19984     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19985     MOVE -1                     TO PMTTYPEL.
 19986
 19987     IF FIRST-ENTRY = 'Y'
 19988         GO TO 8100-SEND-INITIAL-MAP.
 19989
 19990     GO TO 8200-SEND-DATAONLY.
 19991
 19992 8600-PGRM-NOT-FOUND.
 19993
 19994     MOVE ER-0923                TO EMI-ERROR.
 19995     MOVE -1                     TO ENTPFBL.
 19996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19997
 19998     IF FIRST-ENTRY = 'Y'
 19999         GO TO 8100-SEND-INITIAL-MAP
 20000     ELSE
 20001         GO TO 8200-SEND-DATAONLY.
 20002
 20003 8800-UNAUTHORIZED-ACCESS.
 20004     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20005     GO TO 8300-SEND-TEXT.
 20006
 20007 8810-PF23.
 20008     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20009     MOVE XCTL-005               TO PGM-NAME.
 20010     GO TO 9300-XCTL.
 20011
 20012 8820-PF7-8.
 20013     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20014     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20015                                    PI-SAVED-PROGRAM-2
 20016                                    PI-SAVED-PROGRAM-3
 20017                                    PI-SAVED-PROGRAM-4
 20018                                    PI-SAVED-PROGRAM-5
 20019                                    PI-SAVED-PROGRAM-6
 20020                                    PI-RETURN-TO-PROGRAM.
 20021     IF EIBAID = DFHPF8
 20022        MOVE XCTL-132            TO PGM-NAME
 20023     ELSE
 20024        MOVE XCTL-130            TO PGM-NAME.
 20025
 20026     GO TO 9300-XCTL.
 20027
 20028 9100-RETURN-TRAN.
 20029     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20030     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20031
 20032
 20033* EXEC CICS RETURN
 20034*        TRANSID(TRANS-ID)
 20035*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20036*        LENGTH(PI-COMM-LENGTH)
 20037*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 383
* EL156.cbl
 20038*    MOVE '.(CT                  ''   #00017780' TO DFHEIV0
 20039     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20041     MOVE X'2020233030303137373830' TO DFHEIV0(25:11)
 20042     CALL 'kxdfhei1' USING DFHEIV0,
 20043           TRANS-ID,
 20044           PROGRAM-INTERFACE-BLOCK,
 20045           PI-COMM-LENGTH,
 20046           DFHEIV99,
 20047           DFHEIV99,
 20048           DFHEIV99
 20049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20050
 20051
 20052 9200-RETURN-MAIN-MENU.
 20053     MOVE XCTL-126               TO PGM-NAME.
 20054     GO TO 9300-XCTL.
 20055
 20056 9300-XCTL.
 20057
 20058* EXEC CICS XCTL
 20059*        PROGRAM(PGM-NAME)
 20060*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20061*        LENGTH(PI-COMM-LENGTH)
 20062*    END-EXEC.
 20063*    MOVE '.$C                   %   #00017791' TO DFHEIV0
 20064     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20065     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20066     MOVE X'2020233030303137373931' TO DFHEIV0(25:11)
 20067     CALL 'kxdfhei1' USING DFHEIV0,
 20068           PGM-NAME,
 20069           PROGRAM-INTERFACE-BLOCK,
 20070           PI-COMM-LENGTH,
 20071           DFHEIV99
 20072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20073
 20074
 20075 9400-CLEAR.
 20076     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20077     GO TO 9300-XCTL.
 20078
 20079 9500-PF12.
 20080     MOVE XCTL-010               TO PGM-NAME.
 20081     GO TO 9300-XCTL.
 20082
 20083 9700-LINK-DATE-CONVERT.
 20084     MOVE LINK-ELDATCV           TO PGM-NAME.
 20085
 20086* EXEC CICS LINK
 20087*        PROGRAM   (PGM-NAME)
 20088*        COMMAREA  (DATE-CONVERSION-DATA)
 20089*        LENGTH    (DC-COMM-LENGTH)
 20090*    END-EXEC.
 20091*    MOVE '."C                   (   #00017807' TO DFHEIV0
 20092     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20093     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20094     MOVE X'2020233030303137383037' TO DFHEIV0(25:11)
 20095     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 384
* EL156.cbl
 20096           PGM-NAME,
 20097           DATE-CONVERSION-DATA,
 20098           DC-COMM-LENGTH,
 20099           DFHEIV99,
 20100           DFHEIV99,
 20101           DFHEIV99,
 20102           DFHEIV99
 20103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20104
 20105
 20106 9700-EXIT.
 20107     EXIT.
 20108
 20109 9800-LINK-REM-TERM.
 20110     MOVE LINK-REMTERM TO PGM-NAME.
 20111
 20112
 20113* EXEC CICS LINK
 20114*        PROGRAM   (PGM-NAME)
 20115*        COMMAREA  (CALCULATION-PASS-AREA)
 20116*        LENGTH    (CP-COMM-LENGTH)
 20117*    END-EXEC.
 20118*    MOVE '."C                   (   #00017819' TO DFHEIV0
 20119     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303137383139' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           PGM-NAME,
 20124           CALCULATION-PASS-AREA,
 20125           CP-COMM-LENGTH,
 20126           DFHEIV99,
 20127           DFHEIV99,
 20128           DFHEIV99,
 20129           DFHEIV99
 20130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20131
 20132
 20133 9800-EXIT.
 20134     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 385
* EL156.cbl
 20136 9830-DMD-REMAINING-TERM.
 20137
 20138     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20139         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20140
 20141     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20142                              CM-PMT-EXTENSION-DAYS.
 20143
 20144     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20145                                  CL-NO-OF-DAYS-PAID.
 20146
 20147     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20148         GIVING W-REM REMAINDER W-REM-DAYS.
 20149
 20150     MOVE W-REM                  TO WST-REM.
 20151
 20152     IF W-REM-DAYS > ZEROS
 20153         MOVE '/'                TO WST-SLASH
 20154         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20155     ELSE
 20156         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20157
 20158 9830-EXIT.
 20159     EXIT.
 20160
 20161 9870-OUTPUT-ACTIVITY-RECORD.
 20162
 20163
 20164* EXEC CICS GETMAIN
 20165*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20166*         LENGTH(25)
 20167*         INITIMG(WS-BLANK)
 20168*    END-EXEC.
 20169     MOVE 25
 20170       TO DFHEIV11
 20171*    MOVE ',"IL                  $   #00017855' TO DFHEIV0
 20172     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20173     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20174     MOVE X'2020233030303137383535' TO DFHEIV0(25:11)
 20175     CALL 'kxdfhei1' USING DFHEIV0,
 20176           DFHEIV20,
 20177           DFHEIV11,
 20178           WS-BLANK
 20179     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20180         DFHEIV20
 20181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20182
 20183
 20184     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20185     MOVE ELMSTR-KEY             TO DA-KEY.
 20186     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20187
 20188     IF PI-PMTTYPE EQUAL '7'
 20189         MOVE 'V'                TO DA-RECORD-TYPE
 20190     ELSE
 20191         MOVE 'P'                TO DA-RECORD-TYPE.
 20192
 20193
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 386
* EL156.cbl
 20194* EXEC CICS HANDLE CONDITION
 20195*         NOTOPEN(9870-NOTOPEN)
 20196*         DUPREC(9870-EXIT)
 20197*    END-EXEC.
 20198*    MOVE '"$J%                  ! B #00017870' TO DFHEIV0
 20199     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20201     MOVE X'4220233030303137383730' TO DFHEIV0(25:11)
 20202     CALL 'kxdfhei1' USING DFHEIV0
 20203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20204
 20205
 20206
 20207* EXEC CICS WRITE
 20208*         DATASET('DLYACTV')
 20209*         RIDFLD(DA-KEY)
 20210*         FROM(DAILY-ACTIVITY-RECORD)
 20211*         LENGTH(25)
 20212*    END-EXEC.
 20213     MOVE 'DLYACTV' TO DFHEIV1
 20214     MOVE 25
 20215       TO DFHEIV11
 20216*    MOVE '&$ L                  ''   #00017875' TO DFHEIV0
 20217     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20219     MOVE X'2020233030303137383735' TO DFHEIV0(25:11)
 20220     CALL 'kxdfhei1' USING DFHEIV0,
 20221           DFHEIV1,
 20222           DAILY-ACTIVITY-RECORD,
 20223           DFHEIV11,
 20224           DA-KEY,
 20225           DFHEIV99,
 20226           DFHEIV99
 20227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20228
 20229     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20230     GO TO 9870-EXIT.
 20231
 20232 9870-NOTOPEN.
 20233
 20234     MOVE '2955'                 TO EMI-ERROR.
 20235     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20236
 20237 9870-EXIT.
 20238     EXIT.
 20239
 20240 9900-ERROR-FORMAT.
 20241
 20242     IF EMI-ERROR = ER-0923
 20243         MOVE PGM-NAME           TO W-CALLED-NAME.
 20244
 20245     MOVE LINK-001      TO PGM-NAME.
 20246     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20247
 20248
 20249* EXEC CICS LINK
 20250*        PROGRAM (PGM-NAME)
 20251*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 387
* EL156.cbl
 20252*        LENGTH  (EMI-COMM-LENGTH)
 20253*    END-EXEC.
 20254*    MOVE '."C                   (   #00017900' TO DFHEIV0
 20255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20257     MOVE X'2020233030303137393030' TO DFHEIV0(25:11)
 20258     CALL 'kxdfhei1' USING DFHEIV0,
 20259           PGM-NAME,
 20260           ERROR-MESSAGE-INTERFACE-BLOCK,
 20261           EMI-COMM-LENGTH,
 20262           DFHEIV99,
 20263           DFHEIV99,
 20264           DFHEIV99,
 20265           DFHEIV99
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269     IF EMI-ERROR = ER-0923
 20270         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20271
 20272 9900-EXIT.
 20273     EXIT.
 20274
 20275 9990-ABEND.
 20276     MOVE LINK-004               TO PGM-NAME.
 20277     MOVE DFHEIBLK               TO EMI-LINE1.
 20278
 20279* EXEC CICS LINK
 20280*        PROGRAM   (PGM-NAME)
 20281*        COMMAREA  (EMI-LINE1)
 20282*        LENGTH    (64)
 20283*    END-EXEC.
 20284     MOVE 64
 20285       TO DFHEIV11
 20286*    MOVE '."C                   (   #00017915' TO DFHEIV0
 20287     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20289     MOVE X'2020233030303137393135' TO DFHEIV0(25:11)
 20290     CALL 'kxdfhei1' USING DFHEIV0,
 20291           PGM-NAME,
 20292           EMI-LINE1,
 20293           DFHEIV11,
 20294           DFHEIV99,
 20295           DFHEIV99,
 20296           DFHEIV99,
 20297           DFHEIV99
 20298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20299
 20300
 20301     MOVE 'EL156A'               TO  MAP-NAME.
 20302     MOVE LOW-VALUES             TO  EL156AO.
 20303     GO TO 8100-SEND-INITIAL-MAP.
 20304
 20305 9995-SECURITY-VIOLATION.
 20306*    COPY ELCSCTP.
 20307******************************************************************
 20308*                                                                *
 20309*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 388
* EL156.cbl
 20310*                            VMOD=2.001                          *
 20311*                                                                *
 20312*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20313******************************************************************
 20314
 20315
 20316     MOVE EIBDATE          TO SM-JUL-DATE.
 20317     MOVE EIBTRMID         TO SM-TERMID.
 20318     MOVE THIS-PGM         TO SM-PGM.
 20319     MOVE EIBTIME          TO TIME-IN.
 20320     MOVE TIME-OUT         TO SM-TIME.
 20321     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20322
 20323
 20324* EXEC CICS LINK
 20325*         PROGRAM  ('EL003')
 20326*         COMMAREA (SECURITY-MESSAGE)
 20327*         LENGTH   (80)
 20328*    END-EXEC.
 20329     MOVE 'EL003' TO DFHEIV1
 20330     MOVE 80
 20331       TO DFHEIV11
 20332*    MOVE '."C                   (   #00017943' TO DFHEIV0
 20333     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20335     MOVE X'2020233030303137393433' TO DFHEIV0(25:11)
 20336     CALL 'kxdfhei1' USING DFHEIV0,
 20337           DFHEIV1,
 20338           SECURITY-MESSAGE,
 20339           DFHEIV11,
 20340           DFHEIV99,
 20341           DFHEIV99,
 20342           DFHEIV99,
 20343           DFHEIV99
 20344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20345
 20346
 20347******************************************************************
 20348
 20349
 20350
 20351 9999-DFHBACK SECTION.
 20352     MOVE '9%                    "   ' TO DFHEIV0
 20353     MOVE 'EL156' TO DFHEIV1
 20354     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20355     GOBACK.
 20356 9999-DFHEXIT.
 20357     IF DFHEIGDJ EQUAL 0001
 20358         NEXT SENTENCE
 20359     ELSE IF DFHEIGDJ EQUAL 2
 20360         GO TO 9990-ABEND,
 20361               8600-PGRM-NOT-FOUND,
 20362               0400-FIRST-TIME,
 20363               6180-DUPREC,
 20364               9990-ABEND
 20365         DEPENDING ON DFHEIGDI
 20366     ELSE IF DFHEIGDJ EQUAL 3
 20367         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 389
* EL156.cbl
 20368               0380-CLAIM-END-FILE
 20369         DEPENDING ON DFHEIGDI
 20370     ELSE IF DFHEIGDJ EQUAL 4
 20371         GO TO 0380-CLAIM-END-FILE,
 20372               0380-CLAIM-END-FILE
 20373         DEPENDING ON DFHEIGDI
 20374     ELSE IF DFHEIGDJ EQUAL 5
 20375         GO TO 0800-EXIT
 20376         DEPENDING ON DFHEIGDI
 20377     ELSE IF DFHEIGDJ EQUAL 6
 20378         GO TO 1950-NOT-FOUND,
 20379               1950-NOT-FOUND
 20380         DEPENDING ON DFHEIGDI
 20381     ELSE IF DFHEIGDJ EQUAL 7
 20382         GO TO 1950-NOT-FOUND
 20383         DEPENDING ON DFHEIGDI
 20384     ELSE IF DFHEIGDJ EQUAL 8
 20385         GO TO 1950-NOT-FOUND,
 20386               1950-NOT-FOUND
 20387         DEPENDING ON DFHEIGDI
 20388     ELSE IF DFHEIGDJ EQUAL 9
 20389         GO TO 1166-END-CHECK,
 20390               1166-END-CHECK
 20391         DEPENDING ON DFHEIGDI
 20392     ELSE IF DFHEIGDJ EQUAL 10
 20393         GO TO 1950-NOT-FOUND,
 20394               1950-NOT-FOUND
 20395         DEPENDING ON DFHEIGDI
 20396     ELSE IF DFHEIGDJ EQUAL 11
 20397         GO TO 1950-NOT-FOUND,
 20398               1950-NOT-FOUND
 20399         DEPENDING ON DFHEIGDI
 20400     ELSE IF DFHEIGDJ EQUAL 12
 20401         GO TO 1950-NOT-FOUND
 20402         DEPENDING ON DFHEIGDI
 20403     ELSE IF DFHEIGDJ EQUAL 13
 20404         GO TO 3600-CONTINUE
 20405         DEPENDING ON DFHEIGDI
 20406     ELSE IF DFHEIGDJ EQUAL 14
 20407         GO TO 5300-NOTE-NOT-FOUND
 20408         DEPENDING ON DFHEIGDI
 20409     ELSE IF DFHEIGDJ EQUAL 15
 20410         GO TO 6065-NOT-FOUND
 20411         DEPENDING ON DFHEIGDI
 20412     ELSE IF DFHEIGDJ EQUAL 16
 20413         GO TO 6068-ACCT-NOT-FND
 20414         DEPENDING ON DFHEIGDI
 20415     ELSE IF DFHEIGDJ EQUAL 17
 20416         GO TO 6074-GET-COMP-DATA
 20417         DEPENDING ON DFHEIGDI
 20418     ELSE IF DFHEIGDJ EQUAL 18
 20419         GO TO 6170-WRITE
 20420         DEPENDING ON DFHEIGDI
 20421     ELSE IF DFHEIGDJ EQUAL 19
 20422         GO TO 6180-DUPREC
 20423         DEPENDING ON DFHEIGDI
 20424     ELSE IF DFHEIGDJ EQUAL 20
 20425         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 21-Jan-16 11:26 Page 390
* EL156.cbl
 20426         DEPENDING ON DFHEIGDI
 20427     ELSE IF DFHEIGDJ EQUAL 21
 20428         GO TO 6185-DUPREC
 20429         DEPENDING ON DFHEIGDI
 20430     ELSE IF DFHEIGDJ EQUAL 22
 20431         GO TO 6720-BUILD-NEW-RECORD
 20432         DEPENDING ON DFHEIGDI
 20433     ELSE IF DFHEIGDJ EQUAL 23
 20434         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20435               6900-BUILD-ARCHIVE-HEADER
 20436         DEPENDING ON DFHEIGDI
 20437     ELSE IF DFHEIGDJ EQUAL 24
 20438         GO TO 7010-BUILD-MAP
 20439         DEPENDING ON DFHEIGDI
 20440     ELSE IF DFHEIGDJ EQUAL 25
 20441         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20442         DEPENDING ON DFHEIGDI
 20443     ELSE IF DFHEIGDJ EQUAL 26
 20444         GO TO 7160-DUPREC
 20445         DEPENDING ON DFHEIGDI
 20446     ELSE IF DFHEIGDJ EQUAL 27
 20447         GO TO 7200-EXIT,
 20448               7200-EXIT
 20449         DEPENDING ON DFHEIGDI
 20450     ELSE IF DFHEIGDJ EQUAL 28
 20451         GO TO 7400-NOT-FOUND
 20452         DEPENDING ON DFHEIGDI
 20453     ELSE IF DFHEIGDJ EQUAL 29
 20454         GO TO 7590-END,
 20455               7590-END
 20456         DEPENDING ON DFHEIGDI
 20457     ELSE IF DFHEIGDJ EQUAL 30
 20458         GO TO 7699-EXIT
 20459         DEPENDING ON DFHEIGDI
 20460     ELSE IF DFHEIGDJ EQUAL 31
 20461         GO TO 5300-NOTE-NOT-FOUND
 20462         DEPENDING ON DFHEIGDI
 20463     ELSE IF DFHEIGDJ EQUAL 32
 20464         GO TO 7800-COMP-NOTFND
 20465         DEPENDING ON DFHEIGDI
 20466     ELSE IF DFHEIGDJ EQUAL 33
 20467         GO TO 7920-NOT-FOUND
 20468         DEPENDING ON DFHEIGDI
 20469     ELSE IF DFHEIGDJ EQUAL 34
 20470         GO TO 9870-NOTOPEN,
 20471               9870-EXIT
 20472         DEPENDING ON DFHEIGDI.
 20473     MOVE '9%                    "   ' TO DFHEIV0
 20474     MOVE 'EL156' TO DFHEIV1
 20475     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20476     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12228     Code:       76213
