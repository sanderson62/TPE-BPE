* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    35*-----------------------------------------------------------------
    36*REMARKS.
    37*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   3
* EL6316.cbl
    39 ENVIRONMENT DIVISION.
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    45 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    46 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    47 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    48 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    49 77  w-prtsw                     pic x  value spaces.
    50 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    51 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    52     88  ACCT-FOUND                 VALUE 'Y'.
    53 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    54 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    55 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    56 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    57 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    58 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    59 77  s1                          pic s999 comp-3 value +0.
    60 77  s2                          pic s999 comp-3 value +0.
    61 77  WS-REASON-SW                PIC X  VALUE ' '.
    62     88  REASONS-FOUND                  VALUE 'Y'.
    63     88  REASONS-NOT-FOUND              VALUE 'N'.
    64 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    65     88  NO-CERT-RW                 VALUE 'N'.
    66     88  CERT-RW                    VALUE 'Y'.
    67 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    68 01  P pointer.
    69 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    70 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    71 01  var-ptr pointer.
    72 01  env-var-len                 pic 9(4)  binary.
    73 01  rc                          pic 9(9)  binary.
    74 01  WS-KIXHOST                  PIC X(10).
    75 01  WS-KIXSYS.
    76     05  WS-KIX-FIL1             PIC X(10).
    77     05  WS-KIX-APPS             PIC X(10).
    78     05  WS-KIX-ENV              PIC X(10).
    79     05  WS-KIX-MYENV            PIC X(10).
    80     05  WS-KIX-SYS              PIC X(10).
    81*    COPY ELCSCTM.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCTM                             *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    89*                                                                *
    90******************************************************************
    91 01  SECURITY-MESSAGE.
    92     12  FILLER                          PIC X(30)
    93            VALUE '** LOGIC SECURITY VIOLATION -'.
    94     12  SM-READ                         PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   4
* EL6316.cbl
    97     12  SM-PGM                          PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' OPR='.
   100     12  SM-PROCESSOR-ID                 PIC X(4).
   101     12  FILLER                          PIC X(6)
   102            VALUE ' TERM='.
   103     12  SM-TERMID                       PIC X(4).
   104     12  FILLER                          PIC XX   VALUE SPACE.
   105     12  SM-JUL-DATE                     PIC 9(5).
   106     12  FILLER                          PIC X    VALUE SPACE.
   107     12  SM-TIME                         PIC 99.99.
   108
   109*    COPY ELCSCRTY.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCRTY                            *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   117*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   118*        SAVED IN PI-SECURITY-ADDRESS.                           *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-CONTROL.
   122     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   123     12  FILLER                       PIC XX    VALUE 'SC'.
   124     12  SC-CREDIT-CODES.
   125         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   126             20  SC-CREDIT-DISPLAY    PIC X.
   127             20  SC-CREDIT-UPDATE     PIC X.
   128     12  SC-CLAIMS-CODES.
   129         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   130             20  SC-CLAIMS-DISPLAY    PIC X.
   131             20  SC-CLAIMS-UPDATE     PIC X.
   132 01 srch-commarea.
   133*                                copy ELCADLTRSPI.
   134******************************************************************
   135*                   C H A N G E   L O G
   136*
   137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   138*-----------------------------------------------------------------
   139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   140* EFFECTIVE    NUMBER
   141*-----------------------------------------------------------------
   142* 060611    2011022800001  PEMA  NEW COPYBOOK
   143* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   144* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   145******************************************************************
   146****************************************
   147*  commarea for NaperSoft On Demand Admin services letters
   148*  (business logic input & output)
   149****************************************
   150     03  BL-INPUT.
   151         05  BL-DATA-SRCE        PIC X.
   152         05  BL-LETTER-ID        PIC XXXX.
   153         05  BL-CARRIER          PIC X.
   154         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   5
* EL6316.cbl
   155         05  BL-STATE            PIC XX.
   156         05  BL-ACCOUNT          PIC X(10).
   157         05  BL-EFF-DT           PIC X(10).
   158         05  BL-CERT-NO          PIC X(11).
   159         05  BL-BATCH-NO         PIC X(6).
   160         05  BL-BATCH-SEQ        PIC 9(8).
   161         05  BL-RESP-NO          PIC X(10).
   162         05  BL-NO-OF-COPIES     PIC 99.
   163         05  BL-PROC-ID          PIC XXXX.
   164         05  BL-COMP-ID          PIC XXX.
   165         05  BL-PRINT-NOW-SW     PIC X.
   166         05  BL-ENC-CD           PIC XXX.
   167         05  BL-RESEND-DT        PIC X(10).
   168         05  BL-FOLLOW-UP-DT     PIC X(10).
   169         05  BL-ARCHIVE-NO       PIC 9(8).
   170         05  BL-FUNC             PIC X(8).
   171         05  BL-COMMENTS         PIC X(100).
   172         05  FILLER REDEFINES BL-COMMENTS.
   173             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   174             10  BL-LETTER-TO-ACCT PIC X.
   175             10  BL-LETTER-TO-BENE PIC X.
   176             10  BL-WRITE-ERARCH   PIC X.
   177                 88  ERARCH-QWS      VALUE 'Q'.
   178                 88  ERARCH-BATCH    VALUE 'B'.
   179                 88  ERARCH-TEMP     VALUE 'T'.
   180             10  BL-PROCESS-TYPE PIC X(07).
   181             10  BL-CERT-FORM-ID PIC X(05).
   182             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   183             10  BL-SOURCE-SCREEN PIC X(8).
   184             10  FILLER          PIC X(25).
   185     03  BL-OUTPUT.
   186         05  BL-STATUS                   PIC X.
   187             88  BL-OK                      VALUE "P".
   188             88  BL-FAIL                  VALUE "F".
   189         05  BL-MESSAGE          PIC X(50).
   190     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   191     03  FILLER                  PIC X(31).
   192
   193*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   194*                                COPY ELCZREC.
   195******************************************************************
   196*                                                                *
   197*                                                                *
   198*                            ELCZREC.                            *
   199*                                                                *
   200*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   201*                                                                *
   202******************************************************************
   203*-----------------------------------------------------------------
   204*                   C H A N G E   L O G
   205*
   206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   207*-----------------------------------------------------------------
   208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   209* EFFECTIVE    NUMBER
   210*-----------------------------------------------------------------
   211* 122011    2011022800001  AJRA  NEW FILE
   212* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   6
* EL6316.cbl
   213*-----------------------------------------------------------------
   214 01  W-Z-CONTROL-DATA.
   215     05  W-NUMBER-OF-COPIES      PIC  9.
   216     05  FILLER                  PIC  X.
   217     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   218     05  FILLER                  PIC  X.
   219     05  W-DAYS-TO-RESEND        PIC  999.
   220     05  FILLER                  PIC  X.
   221     05  W-FORM-TO-RESEND        PIC  X(4).
   222     05  FILLER                  PIC  X.
   223     05  W-PROMPT-LETTER         PIC  X.
   224     05  FILLER                  PIC  X.
   225     05  W-ENCLOSURE-CD          PIC  XXX.
   226     05  FILLER                  PIC  X.
   227     05  W-AUTO-CLOSE-IND        PIC  X.
   228     05  FILLER                  PIC  X.
   229     05  W-LETTER-TO-BENE        PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-LETTER-TO-ACCT        PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-LETTER-TYPE           PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-PRINT-CERTIFICATE     PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-REFUND-REQUIRED       PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-ONBASE-CODE           PIC  XX.
   240     05  FILLER                  PIC  X.
   241     05  W-ACCT-SUMM             PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-CSO-SUMM              PIC  X.
   244     05  FILLER                  PIC  X(31).
   245 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   246 01  STANDARD-AREAS.
   247     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   248     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   249                                 PIC  X(08).
   250     12  QID.
   251         16  QID-TERM        PIC X(4)    VALUE SPACES.
   252         16  FILLER          PIC X(4)    VALUE '631I'.
   253     12  TIME-MT                 PIC S9(7).
   254     12  TIME-MT-R  REDEFINES TIME-MT.
   255         16  FILLER              PIC X.
   256         16  TIME-LMT            PIC 99V99.
   257         16  FILLER              PIC X(2).
   258     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   259     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   260     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   261     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   262     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   263     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   264     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   265     12  WS-ELCERT-KEY.
   266         16  W-CERT-COMPANY-CD   PIC X.
   267         16  W-CERT-CARRIER      PIC X.
   268         16  W-CERT-GROUPING     PIC X(6).
   269         16  W-CERT-STATE        PIC XX.
   270         16  W-CERT-ACCOUNT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   7
* EL6316.cbl
   271         16  W-CERT-CERT-EFF-DT  PIC XX.
   272         16  W-CERT-CERT-PRIME   PIC X(10).
   273         16  W-CERT-CERT-SFX     PIC X.
   274     12  WS-ELEOBC-KEY.
   275         16  WS-EOBC-COMPANY-CD  PIC X.
   276         16  WS-EOBC-REC-TYPE    PIC X.
   277         16  WS-EOBC-CODE        PIC X(4).
   278         16  FILLER              PIC X(9).
   279     12  WS-ERNOTE-KEY.
   280         16  W-NOTE-COMPANY-CD   PIC X.
   281         16  W-NOTE-CARRIER      PIC X.
   282         16  W-NOTE-GROUPING     PIC X(6).
   283         16  W-NOTE-STATE        PIC XX.
   284         16  W-NOTE-ACCOUNT      PIC X(10).
   285         16  W-NOTE-CERT-EFF-DT  PIC XX.
   286         16  W-NOTE-CERT-PRIME   PIC X(10).
   287         16  W-NOTE-CERT-SFX     PIC X.
   288     12  ELLETR-KEY.
   289         16  LETR-PART-KEY.
   290             20  LETR-COMPANY-CD PIC X.
   291             20  LETR-LETTER-ID  PIC X(4).
   292         16  LETR-FILLER         PIC X(8).
   293         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   294     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   295     12  ERPNDB2-KEY.
   296         16  PNDB2-COMPANY-CD    PIC X.
   297         16  PNDB2-CARRIER       PIC X.
   298         16  PNDB2-GROUPING      PIC X(6).
   299         16  PNDB2-STATE         PIC XX.
   300         16  PNDB2-ACCOUNT       PIC X(10).
   301         16  PNDB2-CERT-EFF-DT   PIC XX.
   302         16  PNDB2-CERT-PRIME    PIC X(10).
   303         16  PNDB2-CERT-SFX      PIC X.
   304         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   305         16  PNDB2-RECORD-TYPE   PIC X.
   306     12  ERENDT-KEY.
   307         16  ENDT-COMPANY-CD       PIC X.
   308         16  ENDT-CARRIER          PIC X.
   309         16  ENDT-GROUPING         PIC X(6).
   310         16  ENDT-STATE            PIC XX.
   311         16  ENDT-ACCOUNT          PIC X(10).
   312         16  ENDT-CERT-EFF-DT      PIC XX.
   313         16  ENDT-CERT-PRIME       PIC X(10).
   314         16  ENDT-CERT-SFX         PIC X.
   315         16  ENDT-RECORD-TYPE      PIC X.
   316         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   317     12  ELCRTO-KEY.
   318         16  CRTO-COMPANY-CD     PIC X.
   319         16  CRTO-CARRIER        PIC X.
   320         16  CRTO-GROUPING       PIC X(6).
   321         16  CRTO-STATE          PIC XX.
   322         16  CRTO-ACCOUNT        PIC X(10).
   323         16  CRTO-CERT-EFF-DT    PIC XX.
   324         16  CRTO-CERT-PRIME     PIC X(10).
   325         16  CRTO-CERT-SFX       PIC X.
   326         16  CRTO-RECORD-TYPE    PIC X.
   327         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   328     12  WS-ERMAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   8
* EL6316.cbl
   329         16  MAIL-COMPANY-CD     PIC X.
   330         16  MAIL-CARRIER        PIC X.
   331         16  MAIL-GROUPING       PIC X(6).
   332         16  MAIL-STATE          PIC XX.
   333         16  MAIL-ACCOUNT        PIC X(10).
   334         16  MAIL-CERT-EFF-DT    PIC XX.
   335         16  MAIL-CERT-PRIME     PIC X(10).
   336         16  MAIL-CERT-SFX       PIC X.
   337     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   338     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   339     12  WS-CURRENT-DT.
   340         16  FILLER              PIC X(6)    VALUE SPACES.
   341         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   342     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   343     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   344         88  CANCEL-REC            VALUE 'C'.
   345         88  ISSUE-REC             VALUE 'I'.
   346     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   347     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   348     12  ELCNTL-KEY.
   349         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   350         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   351         16  CNTL-ACCESS.
   352             20  CNTL-STATE      PIC XX    VALUE SPACES.
   353             20  FILLER          PIC X     VALUE SPACES.
   354             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   355         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   356     12  WS-ERACCT-KEY.
   357         16  ACCT-COMPANY-CD     PIC X.
   358         16  ACCT-CARRIER        PIC X.
   359         16  ACCT-GROUPING       PIC X(6).
   360         16  ACCT-STATE          PIC XX.
   361         16  ACCT-ACCOUNT        PIC X(10).
   362         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   363         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   364     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   365     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   366     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   367     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   368     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   369     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   370     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   371     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   372     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   373     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   374     12  WS-RESPONSE             PIC S9(8)   COMP.
   375         88  RESP-NORMAL                  VALUE +00.
   376         88  RESP-NOTFND                  VALUE +13.
   377         88  RESP-DUPREC                  VALUE +14.
   378         88  RESP-DUPKEY                  VALUE +15.
   379         88  RESP-NOTOPEN                 VALUE +19.
   380         88  RESP-ENDFILE                 VALUE +20.
   381     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   382     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   383     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
   384     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   385     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   386     12  PGM-NAME            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   9
* EL6316.cbl
   387     12  TIME-IN             PIC S9(7).
   388     12  TIME-OUT-R  REDEFINES TIME-IN.
   389         16  FILLER          PIC X.
   390         16  TIME-OUT        PIC 99V99.
   391         16  FILLER          PIC X(2).
   392     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   393     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   394     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   395     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   396     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   397     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   398     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   399     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   400     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   401     12  WS-PHONE.
   402         16  WS-PH1              PIC XXX.
   403         16  WS-PH2              PIC XXX.
   404         16  WS-PH3              PIC XXXX.
   405     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   406     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   407
   408     12  WS-BILLING-NOTE.
   409         16  WS-BN-NOTE          PIC X(25).
   410         16  WS-BN-LTRID         PIC X(4).
   411         16  FILLER              PIC X(3).
   412         16  WS-BN-DATE          PIC X(8).
   413         16  FILLER              PIC X(3).
   414         16  WS-BN-USERID        PIC X(4).
   415         16  FILLER              PIC X(30).
   416     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   417         16  WS-MAN-BN-NOTE      PIC X(63).
   418         16  FILLER              PIC X(14).
   419     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   420     12  NEW-ORIG-REC.
   421         16  NEW-INS-LAST-NAME             PIC X(15).
   422         16  NEW-INS-FIRST-NAME            PIC X(10).
   423         16  NEW-INS-MIDDLE-INIT           PIC X.
   424         16  NEW-INS-AGE                   PIC S999     COMP-3.
   425         16  NEW-JNT-LAST-NAME             PIC X(15).
   426         16  NEW-JNT-FIRST-NAME            PIC X(10).
   427         16  NEW-JNT-MIDDLE-INIT           PIC X.
   428         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   429         16  NEW-LF-BENCD                  PIC XX.
   430         16  NEW-LF-TERM                   PIC S999      COMP-3.
   431         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   432         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   433         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   434         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   435         16  NEW-LF-EXP-DT                 PIC XX.
   436         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   437         16  NEW-LF-CANCEL-DT              PIC XX.
   438         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   439         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   440         16  NEW-AH-BENCD                  PIC XX.
   441         16  NEW-AH-TERM                   PIC S999      COMP-3.
   442         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   443         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   444         16  NEW-AH-EXP-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  10
* EL6316.cbl
   445         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   446         16  NEW-AH-CP                     PIC 99.
   447         16  NEW-AH-CANCEL-DT              PIC XX.
   448         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   449         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   450         16  NEW-CRED-BENE-NAME            PIC X(25).
   451         16  NEW-1ST-PMT-DT                PIC XX.
   452         16  FILLER                        PIC X(239).
   453
   454 01  CERT-NOTE-ENTRIES.
   455     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   456         16  CERT-NT-TEXT                PIC X(63).
   457         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   458         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   459         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   460
   461 01  ERCNOT-AREA.
   462     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   463     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   464     12  ERCNOT-KEY.
   465         16  ERCNOT-PARTIAL-KEY.
   466             20 ERCNOT-COMPANY-CD    PIC X.
   467             20 ERCNOT-CARRIER       PIC X.
   468             20 ERCNOT-GROUPING      PIC X(06).
   469             20 ERCNOT-STATE         PIC XX.
   470             20 ERCNOT-ACCOUNT       PIC X(10).
   471             20 ERCNOT-EFF-DT        PIC XX.
   472             20 ERCNOT-CERT-NO.
   473                25 ERCNOT-CERT-PRIME PIC X(10).
   474                25 ERCNOT-CERT-SFX   PIC X.
   475             20 ERCNOT-REC-TYP       PIC X.
   476         16 ERCNOT-SEQ           PIC S9(4) COMP.
   477     12  SV-PARTIAL-KEY.
   478         20 SV-COMPANY-CD            PIC X.
   479         20 SV-CARRIER               PIC X.
   480         20 SV-GROUPING              PIC X(06).
   481         20 SV-STATE                 PIC XX.
   482         20 SV-ACCOUNT               PIC X(10).
   483         20 SV-EFF-DT                PIC XX.
   484         20 SV-CERT-NO.
   485            25 SV-CERT-PRIME         PIC X(10).
   486            25 SV-CERT-SFX           PIC X(1).
   487         20 SV-REC-TYP               PIC X.
   488 01  ERROR-MESSAGES.
   489     12  ER-0000                 PIC X(4)  VALUE '0000'.
   490     12  ER-0004                 PIC X(4)  VALUE '0004'.
   491     12  ER-0008                 PIC X(4)  VALUE '0008'.
   492     12  ER-0023                 PIC X(4)  VALUE '0023'.
   493     12  ER-0029                 PIC X(4)  VALUE '0029'.
   494     12  ER-0068                 PIC X(4)  VALUE '0068'.
   495     12  ER-0132                 PIC X(4)  VALUE '0132'.
   496     12  ER-0142                 PIC X(4)  VALUE '0142'.
   497     12  ER-0148                 PIC X(4)  VALUE '0148'.
   498     12  ER-0215                 PIC X(4)  VALUE '0215'.
   499     12  ER-0280                 PIC X(4)  VALUE '0280'.
   500     12  ER-0348                 PIC X(4)  VALUE '0348'.
   501     12  ER-0419                 PIC X(4)  VALUE '0419'.
   502     12  ER-0894                 PIC X(4)  VALUE '0894'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  11
* EL6316.cbl
   503     12  ER-1101                 PIC X(4)  VALUE '1101'.
   504     12  ER-1236                 PIC X(4)  VALUE '1236'.
   505     12  ER-1818                 PIC X(4)  VALUE '1818'.
   506     12  ER-1820                 PIC X(4)  VALUE '1820'.
   507     12  ER-2056                 PIC X(4)  VALUE '2056'.
   508     12  ER-2079                 PIC X(4)  VALUE '2079'.
   509     12  ER-2208                 PIC X(4)  VALUE '2208'.
   510     12  ER-2209                 PIC X(4)  VALUE '2209'.
   511     12  ER-2237                 PIC X(4)  VALUE '2237'.
   512     12  ER-2238                 PIC X(4)  VALUE '2238'.
   513     12  ER-2253                 PIC X(4)  VALUE '2253'.
   514     12  ER-2619                 PIC X(4)  VALUE '2619'.
   515     12  ER-2651                 PIC X(4)  VALUE '2651'.
   516     12  ER-2784                 PIC X(4)  VALUE '2784'.
   517     12  ER-2785                 PIC X(4)  VALUE '2785'.
   518     12  ER-2786                 PIC X(4)  VALUE '2786'.
   519     12  ER-2791                 PIC X(4)  VALUE '2791'.
   520     12  ER-2845                 PIC X(4)  VALUE '2845'.
   521     12  ER-2848                 PIC X(4)  VALUE '2848'.
   522     12  ER-2851                 PIC X(4)  VALUE '2851'.
   523     12  ER-3829                 PIC X(4)  VALUE '3829'.
   524     12  ER-3830                 PIC X(4)  VALUE '3830'.
   525     12  ER-3833                 PIC X(4)  VALUE '3833'.
   526     12  ER-7638                 PIC X(4)  VALUE '7638'.
   527     12  ER-8888                 PIC X(4)  VALUE '8888'.
   528     12  ER-9999                 PIC X(4)  VALUE '9999'.
   529*    COPY ELCDATE.
   530******************************************************************
   531*                                                                *
   532*                                                                *
   533*                            ELCDATE.                            *
   534*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   535*                            VMOD=2.003
   536*                                                                *
   537*                                                                *
   538*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   539*                 LENGTH = 200                                   *
   540******************************************************************
   541
   542 01  DATE-CONVERSION-DATA.
   543     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   544     12  DC-OPTION-CODE                PIC X.
   545         88  BIN-TO-GREG                VALUE ' '.
   546         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   547         88  EDIT-GREG-TO-BIN           VALUE '2'.
   548         88  YMD-GREG-TO-BIN            VALUE '3'.
   549         88  MDY-GREG-TO-BIN            VALUE '4'.
   550         88  JULIAN-TO-BIN              VALUE '5'.
   551         88  BIN-PLUS-ELAPSED           VALUE '6'.
   552         88  FIND-CENTURY               VALUE '7'.
   553         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   554         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   555         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   556         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   557         88  JULIAN-TO-BIN-3            VALUE 'C'.
   558         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   559         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   560         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  12
* EL6316.cbl
   561         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   562         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   563         88  CHECK-LEAP-YEAR            VALUE 'H'.
   564         88  BIN-3-TO-GREG              VALUE 'I'.
   565         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   566         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   567         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   568         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   569         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   570         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   571         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   572         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   573         88  THREE-CHARACTER-BIN
   574                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   575         88  GREGORIAN-TO-BIN
   576                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   577         88  BIN-TO-GREGORIAN
   578                  VALUES ' ' '1' 'I' '8' 'G'.
   579         88  JULIAN-TO-BINARY
   580                  VALUES '5' 'C' 'E' 'F'.
   581     12  DC-ERROR-CODE                 PIC X.
   582         88  NO-CONVERSION-ERROR        VALUE ' '.
   583         88  DATE-CONVERSION-ERROR
   584                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   585         88  DATE-IS-ZERO               VALUE '1'.
   586         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   587         88  DATE-IS-INVALID            VALUE '3'.
   588         88  DATE1-GREATER-DATE2        VALUE '4'.
   589         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   590         88  DATE-INVALID-OPTION        VALUE '9'.
   591         88  INVALID-CENTURY            VALUE 'A'.
   592         88  ONLY-CENTURY               VALUE 'B'.
   593         88  ONLY-LEAP-YEAR             VALUE 'C'.
   594         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   595     12  DC-END-OF-MONTH               PIC X.
   596         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   597     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   598         88  USE-NORMAL-PROCESS         VALUE ' '.
   599         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   600         88  ADJUST-UP-100-YRS          VALUE '2'.
   601     12  FILLER                        PIC X.
   602     12  DC-CONVERSION-DATES.
   603         16  DC-BIN-DATE-1             PIC XX.
   604         16  DC-BIN-DATE-2             PIC XX.
   605         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   606         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   607                       DC-GREG-DATE-1-EDIT.
   608             20  DC-EDIT1-MONTH        PIC 99.
   609             20  SLASH1-1              PIC X.
   610             20  DC-EDIT1-DAY          PIC 99.
   611             20  SLASH1-2              PIC X.
   612             20  DC-EDIT1-YEAR         PIC 99.
   613         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   614         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   615                     DC-GREG-DATE-2-EDIT.
   616             20  DC-EDIT2-MONTH        PIC 99.
   617             20  SLASH2-1              PIC X.
   618             20  DC-EDIT2-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  13
* EL6316.cbl
   619             20  SLASH2-2              PIC X.
   620             20  DC-EDIT2-YEAR         PIC 99.
   621         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   622         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   623                     DC-GREG-DATE-1-YMD.
   624             20  DC-YMD-YEAR           PIC 99.
   625             20  DC-YMD-MONTH          PIC 99.
   626             20  DC-YMD-DAY            PIC 99.
   627         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   628         16  DC-GREG-DATE-1-MDY-R REDEFINES
   629                      DC-GREG-DATE-1-MDY.
   630             20  DC-MDY-MONTH          PIC 99.
   631             20  DC-MDY-DAY            PIC 99.
   632             20  DC-MDY-YEAR           PIC 99.
   633         16  DC-GREG-DATE-1-ALPHA.
   634             20  DC-ALPHA-MONTH        PIC X(10).
   635             20  DC-ALPHA-DAY          PIC 99.
   636             20  FILLER                PIC XX.
   637             20  DC-ALPHA-CENTURY.
   638                 24 DC-ALPHA-CEN-N     PIC 99.
   639             20  DC-ALPHA-YEAR         PIC 99.
   640         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   641         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   642         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   643         16  DC-JULIAN-DATE            PIC 9(05).
   644         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   645                                       PIC 9(05).
   646         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   647             20  DC-JULIAN-YEAR        PIC 99.
   648             20  DC-JULIAN-DAYS        PIC 999.
   649         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   650         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   651         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   652     12  DATE-CONVERSION-VARIBLES.
   653         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   654         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   655             20  FILLER                PIC 9(3).
   656             20  HOLD-CEN-1-CCYY.
   657                 24  HOLD-CEN-1-CC     PIC 99.
   658                 24  HOLD-CEN-1-YY     PIC 99.
   659             20  HOLD-CEN-1-MO         PIC 99.
   660             20  HOLD-CEN-1-DA         PIC 99.
   661         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   662             20  HOLD-CEN-1-R-MO       PIC 99.
   663             20  HOLD-CEN-1-R-DA       PIC 99.
   664             20  HOLD-CEN-1-R-CCYY.
   665                 24  HOLD-CEN-1-R-CC   PIC 99.
   666                 24  HOLD-CEN-1-R-YY   PIC 99.
   667             20  FILLER                PIC 9(3).
   668         16  HOLD-CENTURY-1-X.
   669             20  FILLER                PIC X(3)  VALUE SPACES.
   670             20  HOLD-CEN-1-X-CCYY.
   671                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   672                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   673             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   674             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   675         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   676             20  HOLD-CEN-1-R-X-MO     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  14
* EL6316.cbl
   677             20  HOLD-CEN-1-R-X-DA     PIC XX.
   678             20  HOLD-CEN-1-R-X-CCYY.
   679                 24  HOLD-CEN-1-R-X-CC PIC XX.
   680                 24  HOLD-CEN-1-R-X-YY PIC XX.
   681             20  FILLER                PIC XXX.
   682         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   683         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   684         16  DC-JULIAN-DATE-1          PIC 9(07).
   685         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   686             20  DC-JULIAN-1-CCYY.
   687                 24  DC-JULIAN-1-CC    PIC 99.
   688                 24  DC-JULIAN-1-YR    PIC 99.
   689             20  DC-JULIAN-DA-1        PIC 999.
   690         16  DC-JULIAN-DATE-2          PIC 9(07).
   691         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   692             20  DC-JULIAN-2-CCYY.
   693                 24  DC-JULIAN-2-CC    PIC 99.
   694                 24  DC-JULIAN-2-YR    PIC 99.
   695             20  DC-JULIAN-DA-2        PIC 999.
   696         16  DC-GREG-DATE-A-EDIT.
   697             20  DC-EDITA-MONTH        PIC 99.
   698             20  SLASHA-1              PIC X VALUE '/'.
   699             20  DC-EDITA-DAY          PIC 99.
   700             20  SLASHA-2              PIC X VALUE '/'.
   701             20  DC-EDITA-CCYY.
   702                 24  DC-EDITA-CENT     PIC 99.
   703                 24  DC-EDITA-YEAR     PIC 99.
   704         16  DC-GREG-DATE-B-EDIT.
   705             20  DC-EDITB-MONTH        PIC 99.
   706             20  SLASHB-1              PIC X VALUE '/'.
   707             20  DC-EDITB-DAY          PIC 99.
   708             20  SLASHB-2              PIC X VALUE '/'.
   709             20  DC-EDITB-CCYY.
   710                 24  DC-EDITB-CENT     PIC 99.
   711                 24  DC-EDITB-YEAR     PIC 99.
   712         16  DC-GREG-DATE-CYMD         PIC 9(08).
   713         16  DC-GREG-DATE-CYMD-R REDEFINES
   714                              DC-GREG-DATE-CYMD.
   715             20  DC-CYMD-CEN           PIC 99.
   716             20  DC-CYMD-YEAR          PIC 99.
   717             20  DC-CYMD-MONTH         PIC 99.
   718             20  DC-CYMD-DAY           PIC 99.
   719         16  DC-GREG-DATE-MDCY         PIC 9(08).
   720         16  DC-GREG-DATE-MDCY-R REDEFINES
   721                              DC-GREG-DATE-MDCY.
   722             20  DC-MDCY-MONTH         PIC 99.
   723             20  DC-MDCY-DAY           PIC 99.
   724             20  DC-MDCY-CEN           PIC 99.
   725             20  DC-MDCY-YEAR          PIC 99.
   726    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   727        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   728    12  DC-EL310-DATE                  PIC X(21).
   729    12  FILLER                         PIC X(28).
   730*    COPY ELCLOGOF.
   731******************************************************************
   732*                                                                *
   733*                                                                *
   734*                            ELCLOGOF.                           *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  15
* EL6316.cbl
   735*                            VMOD=2.001                          *
   736*                                                                *
   737*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   738*                                                                *
   739******************************************************************
   740 01  CLASIC-LOGOFF.
   741     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   742     12  LOGOFF-TEXT.
   743         16  FILLER          PIC X(5)    VALUE SPACES.
   744         16  LOGOFF-MSG.
   745             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   746             20  FILLER      PIC X       VALUE SPACES.
   747             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   748         16  FILLER          PIC X(80)
   749           VALUE '* YOU ARE NOW LOGGED OFF'.
   750         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   751         16  FILLER          PIC X       VALUE QUOTE.
   752         16  LOGOFF-SYS-MSG  PIC X(17)
   753           VALUE 'S CLAS-IC SYSTEM '.
   754     12  TEXT-MESSAGES.
   755         16  UNACCESS-MSG    PIC X(29)
   756             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   757         16  PGMIDERR-MSG    PIC X(17)
   758             VALUE 'PROGRAM NOT FOUND'.
   759*    COPY ELCATTR.
   760******************************************************************
   761*                                                                *
   762*                            ELCATTR.                            *
   763*                            VMOD=2.001                          *
   764*                                                                *
   765*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   766*                                                                *
   767*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   768*                                                                *
   769*                   POS 1   P=PROTECTED                          *
   770*                           U=UNPROTECTED                        *
   771*                           S=ASKIP                              *
   772*                   POS 2   A=ALPHA/NUMERIC                      *
   773*                           N=NUMERIC                            *
   774*                   POS 3   N=NORMAL                             *
   775*                           B=BRIGHT                             *
   776*                           D=DARK                               *
   777*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   778*                           OF=MODIFIED DATA TAG OFF             *
   779*                                                                *
   780*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   781******************************************************************
   782 01  ATTRIBUTE-LIST.
   783     12  AL-PABOF            PIC X       VALUE 'Y'.
   784     12  AL-PABON            PIC X       VALUE 'Z'.
   785     12  AL-PADOF            PIC X       VALUE '%'.
   786     12  AL-PADON            PIC X       VALUE '_'.
   787     12  AL-PANOF            PIC X       VALUE '-'.
   788     12  AL-PANON            PIC X       VALUE '/'.
   789     12  AL-SABOF            PIC X       VALUE '8'.
   790     12  AL-SABON            PIC X       VALUE '9'.
   791     12  AL-SADOF            PIC X       VALUE '@'.
   792     12  AL-SADON            PIC X       VALUE QUOTE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  16
* EL6316.cbl
   793     12  AL-SANOF            PIC X       VALUE '0'.
   794     12  AL-SANON            PIC X       VALUE '1'.
   795     12  AL-UABOF            PIC X       VALUE 'H'.
   796     12  AL-UABON            PIC X       VALUE 'I'.
   797     12  AL-UADOF            PIC X       VALUE '<'.
   798     12  AL-UADON            PIC X       VALUE '('.
   799     12  AL-UANOF            PIC X       VALUE ' '.
   800     12  AL-UANON            PIC X       VALUE 'A'.
   801     12  AL-UNBOF            PIC X       VALUE 'Q'.
   802     12  AL-UNBON            PIC X       VALUE 'R'.
   803     12  AL-UNDOF            PIC X       VALUE '*'.
   804     12  AL-UNDON            PIC X       VALUE ')'.
   805     12  AL-UNNOF            PIC X       VALUE '&'.
   806     12  AL-UNNON            PIC X       VALUE 'J'.
   807*    COPY ELCEMIB.
   808******************************************************************
   809*                                                                *
   810*                                                                *
   811*                            ELCEMIB.                            *
   812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   813*                            VMOD=2.005                          *
   814*                                                                *
   815*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   816*                                                                *
   817******************************************************************
   818 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   819     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   820     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   821     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   822     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   823     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   824     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   825     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   826     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   827     12  EMI-SWITCH1             PIC X        VALUE '1'.
   828         88  EMI-NO-ERRORS                    VALUE '1'.
   829         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   830         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   831     12  EMI-SWITCH2             PIC X        VALUE '1'.
   832         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   833     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   834         88  EMI-AREA1-EMPTY                  VALUE '1'.
   835         88  EMI-AREA1-FULL                   VALUE '2'.
   836     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   837         88  EMI-AREA2-EMPTY                  VALUE '1'.
   838         88  EMI-AREA2-FULL                   VALUE '2'.
   839     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   840         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   841         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   842         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   843         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   844         88  EMI-BYPASS-FATALS                VALUE 'X'.
   845     12  EMI-ERROR-LINES.
   846         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   847         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   848         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   849         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   850             20  EMI-ERR-CODES OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  17
* EL6316.cbl
   851                 24  EMI-ERR-NUM         PIC X(4).
   852                 24  EMI-FILLER          PIC X.
   853                 24  EMI-SEV             PIC X.
   854                 24  FILLER              PIC X.
   855             20  FILLER                  PIC X(02).
   856     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   857         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   858             20  EMI-ERROR-NUMBER    PIC X(4).
   859             20  EMI-FILL            PIC X.
   860             20  EMI-SEVERITY        PIC X.
   861             20  FILLER              PIC X.
   862             20  EMI-ERROR-TEXT.
   863                 24  EMI-TEXT-VARIABLE   PIC X(10).
   864                 24  FILLER          PIC X(55).
   865     12  EMI-SEVERITY-SAVE           PIC X.
   866         88  EMI-NOTE                    VALUE 'N'.
   867         88  EMI-WARNING                 VALUE 'W'.
   868         88  EMI-FORCABLE                VALUE 'F'.
   869         88  EMI-FATAL                   VALUE 'X'.
   870     12  EMI-MESSAGE-FLAG            PIC X.
   871         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   872         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   873     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   874     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   875         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   876         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   877         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   878     12  FILLER                      PIC X(137)  VALUE SPACES.
   879     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   880     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   881     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   882     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   883*    COPY ELCTEXT.
   884******************************************************************
   885*                                                                *
   886*                                                                *
   887*                            ELCTEXT.                            *
   888*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   889*                            VMOD=2.008                          *
   890*                                                                *
   891*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   892*                                     FORM LETTERS,              *
   893*                                     CERT FORM DISPLAY.
   894*                                                                *
   895*   FILE TYPE = VSAM,KSDS                                        *
   896*   RECORD SIZE = 100   RECFORM = FIXED                          *
   897*                                                                *
   898*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   899*       ALTERNATE INDEX = NONE                                   *
   900*                                                                *
   901*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   902*       ALTERNATE INDEX = NONE                                   *
   903*                                                                *
   904*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   905*       ALTERNATE INDEX = NONE                                   *
   906*                                                                *
   907*   LOG = NO                                                     *
   908*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  18
* EL6316.cbl
   909******************************************************************
   910 01  TEXT-FILES.
   911     12  TEXT-FILE-ID                PIC XX.
   912         88  FORMS-FILE-TEXT            VALUE 'TF'.
   913         88  LETTER-FILE-TEXT           VALUE 'TL'.
   914         88  HELP-FILE-TEXT             VALUE 'TH'.
   915
   916     12  TX-CONTROL-PRIMARY.
   917         16  TX-COMPANY-CD           PIC X.
   918             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   919         16  TX-ACCESS-CD-GENL       PIC X(12).
   920
   921         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   922             20  TX-LETTER-NO        PIC X(4).
   923             20  FILLER              PIC X(8).
   924
   925         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   926             20  TX-FORM-NO          PIC X(12).
   927
   928         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   929             20  TX-HELP-TYPE        PIC X.
   930                 88  HELP-FOR-GENERAL   VALUE ' '.
   931                 88  HELP-BY-SCREEN     VALUE 'S'.
   932                 88  HELP-BY-ERROR      VALUE 'E'.
   933             20  TX-SCREEN-OR-ERROR  PIC X(4).
   934                 88  GENERAL-INFO-HELP  VALUE '0000'.
   935             20  TX-HELP-FOR-COMPANY  PIC XXX.
   936                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   937             20  FILLER              PIC X(4).
   938
   939         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   940
   941     12  TX-PROCESS-CONTROL          PIC XX.
   942         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   943
   944     12  TX-TEXT-LINE                PIC X(70).
   945
   946     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   947         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   948         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   949         88  TX-VALID-FORM-SQUEEZE-VALUE
   950                                        VALUE 'Y' ' '.
   951
   952     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   953         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   954         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   955         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   956         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   957         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   958         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   959         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   960                                              'K' 'N' ' '
   961                                              'Z'.
   962
   963     12  TX-ARCHIVE-SW               PIC X.
   964         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   965         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   966         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  19
* EL6316.cbl
   967
   968     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   969     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   970
   971     12  TX-BSR-CODE                 PIC X.
   972         88  TX-BSR-LETTER              VALUE 'B'.
   973         88  TX-NON-BSR-LETTER          VALUE ' '.
   974
   975     12  FILLER                      PIC X.
   976*****************************************************************
   977*    COPY ELCINTF.
   978******************************************************************
   979*                                                                *
   980*                                                                *
   981*                            ELCINTF.                            *
   982*                            VMOD=2.017                          *
   983*                                                                *
   984*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   985*                                                                *
   986*       LENGTH = 1024                                            *
   987*                                                                *
   988******************************************************************
   989*                   C H A N G E   L O G
   990*
   991* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   992*-----------------------------------------------------------------
   993*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   994* EFFECTIVE    NUMBER
   995*-----------------------------------------------------------------
   996* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   997******************************************************************
   998 01  PROGRAM-INTERFACE-BLOCK.
   999     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1000     12  PI-CALLING-PROGRAM              PIC X(8).
  1001     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1002     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1003     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1004     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1005     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1006     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1007     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1008     12  PI-COMPANY-ID                   PIC XXX.
  1009     12  PI-COMPANY-CD                   PIC X.
  1010
  1011     12  PI-COMPANY-PASSWORD             PIC X(8).
  1012
  1013     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1014
  1015     12  PI-CONTROL-IN-PROGRESS.
  1016         16  PI-CARRIER                  PIC X.
  1017         16  PI-GROUPING                 PIC X(6).
  1018         16  PI-STATE                    PIC XX.
  1019         16  PI-ACCOUNT                  PIC X(10).
  1020         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1021                                         PIC X(10).
  1022         16  PI-CLAIM-CERT-GRP.
  1023             20  PI-CLAIM-NO             PIC X(7).
  1024             20  PI-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  20
* EL6316.cbl
  1025                 25  PI-CERT-PRIME       PIC X(10).
  1026                 25  PI-CERT-SFX         PIC X.
  1027             20  PI-CERT-EFF-DT          PIC XX.
  1028         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1029             20  PI-PLAN-CODE            PIC X(2).
  1030             20  PI-REVISION-NUMBER      PIC X(3).
  1031             20  PI-PLAN-EFF-DT          PIC X(2).
  1032             20  PI-PLAN-EXP-DT          PIC X(2).
  1033             20  FILLER                  PIC X(11).
  1034         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1035             20  PI-OE-REFERENCE-1.
  1036                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1037                 25  PI-OE-REF-1-SUFF    PIC XX.
  1038
  1039     12  PI-SESSION-IN-PROGRESS          PIC X.
  1040         88  CLAIM-SESSION                   VALUE '1'.
  1041         88  CREDIT-SESSION                  VALUE '2'.
  1042         88  WARRANTY-SESSION                VALUE '3'.
  1043         88  MORTGAGE-SESSION                VALUE '4'.
  1044         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1045
  1046
  1047*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1048
  1049     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1050     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1051
  1052     12  PI-CREDIT-USER                  PIC X.
  1053         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1054         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1055
  1056     12  PI-CLAIM-USER                   PIC X.
  1057         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1058         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1059
  1060     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1061         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1062         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1063         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1064         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1065         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1066
  1067     12  PI-PROCESSOR-ID                 PIC X(4).
  1068
  1069     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1070
  1071     12  PI-MEMBER-CAPTION               PIC X(10).
  1072
  1073     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1074         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1075
  1076     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1077     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1078     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1079     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1080
  1081     12  PI-AH-OVERRIDE-L1               PIC X.
  1082     12  PI-AH-OVERRIDE-L2               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  21
* EL6316.cbl
  1083     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1084     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1085
  1086     12  PI-NEW-SYSTEM                   PIC X(2).
  1087
  1088     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1089     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1090         88  PI-USES-PAID-TO                 VALUE '1'.
  1091     12  PI-CRDTCRD-SYSTEM.
  1092         16  PI-CRDTCRD-USER             PIC X.
  1093             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1094             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1095         16  PI-CC-MONTH-END-DT          PIC XX.
  1096     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1097
  1098     12  PI-OE-REFERENCE-2.
  1099         16  PI-OE-REF-2-PRIME           PIC X(10).
  1100         16  PI-OE-REF-2-SUFF            PIC X.
  1101
  1102     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1103
  1104     12  PI-LANGUAGE-TYPE                PIC X.
  1105             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1106             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1107             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1108
  1109     12  PI-POLICY-LINKAGE-IND           PIC X.
  1110         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1111         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1112                                                   LOW-VALUES.
  1113
  1114     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1115     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1116         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1117         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1118
  1119     12  PI-PROCESSOR-CSR-IND            PIC X.
  1120         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1121         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1122
  1123     12  FILLER                          PIC X(3).
  1124
  1125     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1126
  1127     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1128         PI-SYSTEM-LEVEL.
  1129
  1130         16  PI-ENTRY-CODES.
  1131             20  PI-ENTRY-CD-1           PIC X.
  1132             20  PI-ENTRY-CD-2           PIC X.
  1133
  1134         16  PI-RETURN-CODES.
  1135             20  PI-RETURN-CD-1          PIC X.
  1136             20  PI-RETURN-CD-2          PIC X.
  1137
  1138         16  PI-UPDATE-STATUS-SAVE.
  1139             20  PI-UPDATE-BY            PIC X(4).
  1140             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  22
* EL6316.cbl
  1141
  1142         16  PI-LOWER-CASE-LETTERS       PIC X.
  1143             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1144
  1145*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1146*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1147*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1148
  1149         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1150             88  ST-ACCNT-CNTL               VALUE ' '.
  1151             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1152             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1153             88  ACCNT-CNTL                  VALUE '3'.
  1154             88  CARR-ACCNT-CNTL             VALUE '4'.
  1155
  1156         16  PI-PROCESSOR-CAP-LIST.
  1157             20  PI-SYSTEM-CONTROLS.
  1158                24 PI-SYSTEM-DISPLAY     PIC X.
  1159                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1160                24 PI-SYSTEM-MODIFY      PIC X.
  1161                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1162             20  FILLER                  PIC XX.
  1163             20  PI-DISPLAY-CAP          PIC X.
  1164                 88  DISPLAY-CAP             VALUE 'Y'.
  1165             20  PI-MODIFY-CAP           PIC X.
  1166                 88  MODIFY-CAP              VALUE 'Y'.
  1167             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1168                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1169             20  PI-FORCE-CAP            PIC X.
  1170                 88  FORCE-CAP               VALUE 'Y'.
  1171
  1172         16  PI-PROGRAM-CONTROLS.
  1173             20  PI-PGM-PRINT-OPT        PIC X.
  1174             20  PI-PGM-FORMAT-OPT       PIC X.
  1175             20  PI-PGM-PROCESS-OPT      PIC X.
  1176             20  PI-PGM-TOTALS-OPT       PIC X.
  1177
  1178         16  PI-HELP-INTERFACE.
  1179             20  PI-LAST-ERROR-NO        PIC X(4).
  1180             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1181
  1182         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1183             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1184
  1185         16  PI-CR-CONTROL-IN-PROGRESS.
  1186             20  PI-CR-CARRIER           PIC X.
  1187             20  PI-CR-GROUPING          PIC X(6).
  1188             20  PI-CR-STATE             PIC XX.
  1189             20  PI-CR-ACCOUNT           PIC X(10).
  1190             20  PI-CR-FIN-RESP          PIC X(10).
  1191             20  PI-CR-TYPE              PIC X.
  1192
  1193         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1194
  1195         16  PI-CR-MONTH-END-DT          PIC XX.
  1196
  1197         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1198             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  23
* EL6316.cbl
  1199             88  PI-ZERO-CARRIER             VALUE '1'.
  1200             88  PI-ZERO-GROUPING            VALUE '2'.
  1201             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1202
  1203         16  PI-CARRIER-SECURITY         PIC X.
  1204             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1205
  1206         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1207             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1208             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1209
  1210         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1211             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1212                                         INDEXED BY PI-ACCESS-NDX
  1213                                         PIC X.
  1214
  1215         16  PI-GA-BILLING-CONTROL       PIC X.
  1216             88  PI-GA-BILLING               VALUE '1'.
  1217
  1218         16  PI-MAIL-PROCESSING          PIC X.
  1219             88  PI-MAIL-YES                 VALUE 'Y'.
  1220
  1221         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1222
  1223         16  PI-AR-SYSTEM.
  1224             20  PI-AR-PROCESSING-CNTL   PIC X.
  1225                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1226             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1227             20  PI-AR-MONTH-END-DT      PIC XX.
  1228
  1229         16  PI-MP-SYSTEM.
  1230             20  PI-MORTGAGE-USER            PIC X.
  1231                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1232                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1233             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1234                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1235                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1236                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1237                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1238                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1239             20  PI-MP-MONTH-END-DT          PIC XX.
  1240             20  PI-MP-REFERENCE-NO.
  1241                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1242                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1243
  1244         16  PI-LABEL-CONTROL            PIC X(01).
  1245             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1246             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1247
  1248         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1249             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1250
  1251         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1252             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1253             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1254
  1255         16  FILLER                      PIC X(14).
  1256
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  24
* EL6316.cbl
  1257     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1258******************************************************************
  1259     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1260        16  PI-ISS-CAN-SW           PIC X.
  1261        16  PI-ERENDT-KEY.
  1262            20  PI-ENDT-COMPANY-CD  PIC X.
  1263            20  PI-ENDT-CARRIER     PIC X.
  1264            20  PI-ENDT-GROUPING    PIC X(6).
  1265            20  PI-ENDT-STATE       PIC XX.
  1266            20  PI-ENDT-ACCOUNT     PIC X(10).
  1267            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1268            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1269            20  PI-ENDT-CERT-SFX    PIC X.
  1270            20  PI-ENDT-RECORD-TYPE PIC X.
  1271            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1272        16  PI-ELCRTO-KEY.
  1273            20  PI-CRTO-COMPANY-CD  PIC X.
  1274            20  PI-CRTO-CARRIER     PIC X.
  1275            20  PI-CRTO-GROUPING    PIC X(6).
  1276            20  PI-CRTO-STATE       PIC XX.
  1277            20  PI-CRTO-ACCOUNT     PIC X(10).
  1278            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1279            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1280            20  PI-CRTO-CERT-SFX    PIC X.
  1281            20  PI-CRTO-RECORD-TYPE PIC X.
  1282            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1283        16  PI-ERPNDB-KEY           PIC X(11).
  1284        16  PI-DOCUMENT-PROCESSED   PIC X.
  1285            88  PI-VERI-PROCESSED      VALUE 'V'.
  1286            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1287        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1288        16  PI-RES-REF-CLM-TYPE     PIC X.
  1289        16  PI-CLM-RESC-IND         PIC X.
  1290            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1291        16  PI-CLEAR-ERROR-SW       PIC X.
  1292            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1293        16  PI-PRTSW-ENTERED        PIC X.
  1294        16  PI-LTRID-ENTERED        PIC X(4).
  1295        16  PI-REASONS-ENTERED      PIC X(84).
  1296        16  PI-CERTNT1-ENTERED      PIC X(63).
  1297        16  PI-CERTNT2-ENTERED      PIC X(63).
  1298        16  FILLER                  PIC X(20).
  1299        16  PI-FINALIZED-IND        PIC X.
  1300        16  PI-BILLNT1-ENTERED      PIC X(63).
  1301        16  FILLER                  PIC X(217).
  1302    12  FILLER                      PIC X(276).
  1303*    COPY ELCAID.
  1304******************************************************************
  1305*                                                                *
  1306*                            ELCAID.                             *
  1307*                            VMOD=2.001                          *
  1308*                                                                *
  1309*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1310*                                                                *
  1311*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1312*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1313******************************************************************
  1314
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  25
* EL6316.cbl
  1315 01  DFHAID.
  1316   02  DFHNULL   PIC  X  VALUE  ' '.
  1317   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1318   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1319   02  DFHPEN    PIC  X  VALUE  '='.
  1320   02  DFHOPID   PIC  X  VALUE  'W'.
  1321   02  DFHPA1    PIC  X  VALUE  '%'.
  1322   02  DFHPA2    PIC  X  VALUE  '>'.
  1323   02  DFHPA3    PIC  X  VALUE  ','.
  1324   02  DFHPF1    PIC  X  VALUE  '1'.
  1325   02  DFHPF2    PIC  X  VALUE  '2'.
  1326   02  DFHPF3    PIC  X  VALUE  '3'.
  1327   02  DFHPF4    PIC  X  VALUE  '4'.
  1328   02  DFHPF5    PIC  X  VALUE  '5'.
  1329   02  DFHPF6    PIC  X  VALUE  '6'.
  1330   02  DFHPF7    PIC  X  VALUE  '7'.
  1331   02  DFHPF8    PIC  X  VALUE  '8'.
  1332   02  DFHPF9    PIC  X  VALUE  '9'.
  1333   02  DFHPF10   PIC  X  VALUE  ':'.
  1334   02  DFHPF11   PIC  X  VALUE  '#'.
  1335   02  DFHPF12   PIC  X  VALUE  '@'.
  1336   02  DFHPF13   PIC  X  VALUE  'A'.
  1337   02  DFHPF14   PIC  X  VALUE  'B'.
  1338   02  DFHPF15   PIC  X  VALUE  'C'.
  1339   02  DFHPF16   PIC  X  VALUE  'D'.
  1340   02  DFHPF17   PIC  X  VALUE  'E'.
  1341   02  DFHPF18   PIC  X  VALUE  'F'.
  1342   02  DFHPF19   PIC  X  VALUE  'G'.
  1343   02  DFHPF20   PIC  X  VALUE  'H'.
  1344   02  DFHPF21   PIC  X  VALUE  'I'.
  1345*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1346   02  DFHPF22   PIC  X  VALUE  '['.
  1347   02  DFHPF23   PIC  X  VALUE  '.'.
  1348   02  DFHPF24   PIC  X  VALUE  '<'.
  1349   02  DFHMSRE   PIC  X  VALUE  'X'.
  1350   02  DFHSTRF   PIC  X  VALUE  'h'.
  1351   02  DFHTRIG   PIC  X  VALUE  '"'.
  1352 01  FILLER    REDEFINES DFHAID.
  1353     12  FILLER              PIC X(8).
  1354     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1355*   COPY EL6316S.
  1356 01  EL631II.
  1357     05  FILLER            PIC  X(0012).
  1358*    -------------------------------
  1359     05  DATEL PIC S9(0004) COMP.
  1360     05  DATEF PIC  X(0001).
  1361     05  FILLER REDEFINES DATEF.
  1362         10  DATEA PIC  X(0001).
  1363     05  DATEI PIC  X(0008).
  1364*    -------------------------------
  1365     05  TIMEL PIC S9(0004) COMP.
  1366     05  TIMEF PIC  X(0001).
  1367     05  FILLER REDEFINES TIMEF.
  1368         10  TIMEA PIC  X(0001).
  1369     05  TIMEI PIC  X(0005).
  1370*    -------------------------------
  1371     05  PROCIDL PIC S9(0004) COMP.
  1372     05  PROCIDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  26
* EL6316.cbl
  1373     05  FILLER REDEFINES PROCIDF.
  1374         10  PROCIDA PIC  X(0001).
  1375     05  PROCIDI PIC  X(0004).
  1376*    -------------------------------
  1377     05  HOSTL PIC S9(0004) COMP.
  1378     05  HOSTF PIC  X(0001).
  1379     05  FILLER REDEFINES HOSTF.
  1380         10  HOSTA PIC  X(0001).
  1381     05  HOSTI PIC  X(0009).
  1382*    -------------------------------
  1383     05  SYSL PIC S9(0004) COMP.
  1384     05  SYSF PIC  X(0001).
  1385     05  FILLER REDEFINES SYSF.
  1386         10  SYSA PIC  X(0001).
  1387     05  SYSI PIC  X(0005).
  1388*    -------------------------------
  1389     05  COMPANYL PIC S9(0004) COMP.
  1390     05  COMPANYF PIC  X(0001).
  1391     05  FILLER REDEFINES COMPANYF.
  1392         10  COMPANYA PIC  X(0001).
  1393     05  COMPANYI PIC  X(0003).
  1394*    -------------------------------
  1395     05  DATASORL PIC S9(0004) COMP.
  1396     05  DATASORF PIC  X(0001).
  1397     05  FILLER REDEFINES DATASORF.
  1398         10  DATASORA PIC  X(0001).
  1399     05  DATASORI PIC  X(0001).
  1400*    -------------------------------
  1401     05  BATCHNOL PIC S9(0004) COMP.
  1402     05  BATCHNOF PIC  X(0001).
  1403     05  FILLER REDEFINES BATCHNOF.
  1404         10  BATCHNOA PIC  X(0001).
  1405     05  BATCHNOI PIC  X(0006).
  1406*    -------------------------------
  1407     05  BSEQNOL PIC S9(0004) COMP.
  1408     05  BSEQNOF PIC  X(0001).
  1409     05  FILLER REDEFINES BSEQNOF.
  1410         10  BSEQNOA PIC  X(0001).
  1411     05  BSEQNOI PIC  X(0008).
  1412*    -------------------------------
  1413     05  ARCHNOL PIC S9(0004) COMP.
  1414     05  ARCHNOF PIC  X(0001).
  1415     05  FILLER REDEFINES ARCHNOF.
  1416         10  ARCHNOA PIC  X(0001).
  1417     05  ARCHNOI PIC  X(0008).
  1418*    -------------------------------
  1419     05  PRTSWL PIC S9(0004) COMP.
  1420     05  PRTSWF PIC  X(0001).
  1421     05  FILLER REDEFINES PRTSWF.
  1422         10  PRTSWA PIC  X(0001).
  1423     05  PRTSWI PIC  X(0001).
  1424*    -------------------------------
  1425     05  CARRL PIC S9(0004) COMP.
  1426     05  CARRF PIC  X(0001).
  1427     05  FILLER REDEFINES CARRF.
  1428         10  CARRA PIC  X(0001).
  1429     05  CARRI PIC  X(0001).
  1430*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  27
* EL6316.cbl
  1431     05  GROUPL PIC S9(0004) COMP.
  1432     05  GROUPF PIC  X(0001).
  1433     05  FILLER REDEFINES GROUPF.
  1434         10  GROUPA PIC  X(0001).
  1435     05  GROUPI PIC  X(0006).
  1436*    -------------------------------
  1437     05  STATEL PIC S9(0004) COMP.
  1438     05  STATEF PIC  X(0001).
  1439     05  FILLER REDEFINES STATEF.
  1440         10  STATEA PIC  X(0001).
  1441     05  STATEI PIC  X(0002).
  1442*    -------------------------------
  1443     05  ACCTL PIC S9(0004) COMP.
  1444     05  ACCTF PIC  X(0001).
  1445     05  FILLER REDEFINES ACCTF.
  1446         10  ACCTA PIC  X(0001).
  1447     05  ACCTI PIC  X(0010).
  1448*    -------------------------------
  1449     05  EFFDTL PIC S9(0004) COMP.
  1450     05  EFFDTF PIC  X(0001).
  1451     05  FILLER REDEFINES EFFDTF.
  1452         10  EFFDTA PIC  X(0001).
  1453     05  EFFDTI PIC  X(0008).
  1454*    -------------------------------
  1455     05  CERTNOL PIC S9(0004) COMP.
  1456     05  CERTNOF PIC  X(0001).
  1457     05  FILLER REDEFINES CERTNOF.
  1458         10  CERTNOA PIC  X(0001).
  1459     05  CERTNOI PIC  X(0010).
  1460*    -------------------------------
  1461     05  CRTSFXL PIC S9(0004) COMP.
  1462     05  CRTSFXF PIC  X(0001).
  1463     05  FILLER REDEFINES CRTSFXF.
  1464         10  CRTSFXA PIC  X(0001).
  1465     05  CRTSFXI PIC  X(0001).
  1466*    -------------------------------
  1467     05  LTRIDL PIC S9(0004) COMP.
  1468     05  LTRIDF PIC  X(0001).
  1469     05  FILLER REDEFINES LTRIDF.
  1470         10  LTRIDA PIC  X(0001).
  1471     05  LTRIDI PIC  X(0004).
  1472*    -------------------------------
  1473     05  SEQNOL PIC S9(0004) COMP.
  1474     05  SEQNOF PIC  X(0001).
  1475     05  FILLER REDEFINES SEQNOF.
  1476         10  SEQNOA PIC  X(0001).
  1477     05  SEQNOI PIC  X(0006).
  1478*    -------------------------------
  1479     05  FNAMEL PIC S9(0004) COMP.
  1480     05  FNAMEF PIC  X(0001).
  1481     05  FILLER REDEFINES FNAMEF.
  1482         10  FNAMEA PIC  X(0001).
  1483     05  FNAMEI PIC  X(0010).
  1484*    -------------------------------
  1485     05  MINITL PIC S9(0004) COMP.
  1486     05  MINITF PIC  X(0001).
  1487     05  FILLER REDEFINES MINITF.
  1488         10  MINITA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  28
* EL6316.cbl
  1489     05  MINITI PIC  X(0001).
  1490*    -------------------------------
  1491     05  LNAMEL PIC S9(0004) COMP.
  1492     05  LNAMEF PIC  X(0001).
  1493     05  FILLER REDEFINES LNAMEF.
  1494         10  LNAMEA PIC  X(0001).
  1495     05  LNAMEI PIC  X(0015).
  1496*    -------------------------------
  1497     05  OLFDTL PIC S9(0004) COMP.
  1498     05  OLFDTF PIC  X(0001).
  1499     05  FILLER REDEFINES OLFDTF.
  1500         10  OLFDTA PIC  X(0001).
  1501     05  OLFDTI PIC  X(0008).
  1502*    -------------------------------
  1503     05  OLFAMTL PIC S9(0004) COMP.
  1504     05  OLFAMTF PIC  X(0001).
  1505     05  FILLER REDEFINES OLFAMTF.
  1506         10  OLFAMTA PIC  X(0001).
  1507     05  OLFAMTI PIC  X(0012).
  1508*    -------------------------------
  1509     05  OAHDTL PIC S9(0004) COMP.
  1510     05  OAHDTF PIC  X(0001).
  1511     05  FILLER REDEFINES OAHDTF.
  1512         10  OAHDTA PIC  X(0001).
  1513     05  OAHDTI PIC  X(0008).
  1514*    -------------------------------
  1515     05  OAHAMTL PIC S9(0004) COMP.
  1516     05  OAHAMTF PIC  X(0001).
  1517     05  FILLER REDEFINES OAHAMTF.
  1518         10  OAHAMTA PIC  X(0001).
  1519     05  OAHAMTI PIC  X(0012).
  1520*    -------------------------------
  1521     05  NLFDTL PIC S9(0004) COMP.
  1522     05  NLFDTF PIC  X(0001).
  1523     05  FILLER REDEFINES NLFDTF.
  1524         10  NLFDTA PIC  X(0001).
  1525     05  NLFDTI PIC  X(0008).
  1526*    -------------------------------
  1527     05  NLFAMTL PIC S9(0004) COMP.
  1528     05  NLFAMTF PIC  X(0001).
  1529     05  FILLER REDEFINES NLFAMTF.
  1530         10  NLFAMTA PIC  X(0001).
  1531     05  NLFAMTI PIC  X(0012).
  1532*    -------------------------------
  1533     05  NAHDTL PIC S9(0004) COMP.
  1534     05  NAHDTF PIC  X(0001).
  1535     05  FILLER REDEFINES NAHDTF.
  1536         10  NAHDTA PIC  X(0001).
  1537     05  NAHDTI PIC  X(0008).
  1538*    -------------------------------
  1539     05  NAHAMTL PIC S9(0004) COMP.
  1540     05  NAHAMTF PIC  X(0001).
  1541     05  FILLER REDEFINES NAHAMTF.
  1542         10  NAHAMTA PIC  X(0001).
  1543     05  NAHAMTI PIC  X(0012).
  1544*    -------------------------------
  1545     05  INPDTL PIC S9(0004) COMP.
  1546     05  INPDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  29
* EL6316.cbl
  1547     05  FILLER REDEFINES INPDTF.
  1548         10  INPDTA PIC  X(0001).
  1549     05  INPDTI PIC  X(0008).
  1550*    -------------------------------
  1551     05  PROCDTL PIC S9(0004) COMP.
  1552     05  PROCDTF PIC  X(0001).
  1553     05  FILLER REDEFINES PROCDTF.
  1554         10  PROCDTA PIC  X(0001).
  1555     05  PROCDTI PIC  X(0008).
  1556*    -------------------------------
  1557     05  LFCOMML PIC S9(0004) COMP.
  1558     05  LFCOMMF PIC  X(0001).
  1559     05  FILLER REDEFINES LFCOMMF.
  1560         10  LFCOMMA PIC  X(0001).
  1561     05  LFCOMMI PIC  X(0006).
  1562*    -------------------------------
  1563     05  AHCOMML PIC S9(0004) COMP.
  1564     05  AHCOMMF PIC  X(0001).
  1565     05  FILLER REDEFINES AHCOMMF.
  1566         10  AHCOMMA PIC  X(0001).
  1567     05  AHCOMMI PIC  X(0006).
  1568*    -------------------------------
  1569     05  RCD01L PIC S9(0004) COMP.
  1570     05  RCD01F PIC  X(0001).
  1571     05  FILLER REDEFINES RCD01F.
  1572         10  RCD01A PIC  X(0001).
  1573     05  RCD01I PIC  X(0004).
  1574*    -------------------------------
  1575     05  RCD02L PIC S9(0004) COMP.
  1576     05  RCD02F PIC  X(0001).
  1577     05  FILLER REDEFINES RCD02F.
  1578         10  RCD02A PIC  X(0001).
  1579     05  RCD02I PIC  X(0004).
  1580*    -------------------------------
  1581     05  RCD03L PIC S9(0004) COMP.
  1582     05  RCD03F PIC  X(0001).
  1583     05  FILLER REDEFINES RCD03F.
  1584         10  RCD03A PIC  X(0001).
  1585     05  RCD03I PIC  X(0004).
  1586*    -------------------------------
  1587     05  RCD04L PIC S9(0004) COMP.
  1588     05  RCD04F PIC  X(0001).
  1589     05  FILLER REDEFINES RCD04F.
  1590         10  RCD04A PIC  X(0001).
  1591     05  RCD04I PIC  X(0004).
  1592*    -------------------------------
  1593     05  RCD05L PIC S9(0004) COMP.
  1594     05  RCD05F PIC  X(0001).
  1595     05  FILLER REDEFINES RCD05F.
  1596         10  RCD05A PIC  X(0001).
  1597     05  RCD05I PIC  X(0004).
  1598*    -------------------------------
  1599     05  RCD06L PIC S9(0004) COMP.
  1600     05  RCD06F PIC  X(0001).
  1601     05  FILLER REDEFINES RCD06F.
  1602         10  RCD06A PIC  X(0001).
  1603     05  RCD06I PIC  X(0004).
  1604*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  30
* EL6316.cbl
  1605     05  RCD07L PIC S9(0004) COMP.
  1606     05  RCD07F PIC  X(0001).
  1607     05  FILLER REDEFINES RCD07F.
  1608         10  RCD07A PIC  X(0001).
  1609     05  RCD07I PIC  X(0004).
  1610*    -------------------------------
  1611     05  RCD08L PIC S9(0004) COMP.
  1612     05  RCD08F PIC  X(0001).
  1613     05  FILLER REDEFINES RCD08F.
  1614         10  RCD08A PIC  X(0001).
  1615     05  RCD08I PIC  X(0004).
  1616*    -------------------------------
  1617     05  RCD09L PIC S9(0004) COMP.
  1618     05  RCD09F PIC  X(0001).
  1619     05  FILLER REDEFINES RCD09F.
  1620         10  RCD09A PIC  X(0001).
  1621     05  RCD09I PIC  X(0004).
  1622*    -------------------------------
  1623     05  RCD10L PIC S9(0004) COMP.
  1624     05  RCD10F PIC  X(0001).
  1625     05  FILLER REDEFINES RCD10F.
  1626         10  RCD10A PIC  X(0001).
  1627     05  RCD10I PIC  X(0004).
  1628*    -------------------------------
  1629     05  RCD11L PIC S9(0004) COMP.
  1630     05  RCD11F PIC  X(0001).
  1631     05  FILLER REDEFINES RCD11F.
  1632         10  RCD11A PIC  X(0001).
  1633     05  RCD11I PIC  X(0004).
  1634*    -------------------------------
  1635     05  RCD12L PIC S9(0004) COMP.
  1636     05  RCD12F PIC  X(0001).
  1637     05  FILLER REDEFINES RCD12F.
  1638         10  RCD12A PIC  X(0001).
  1639     05  RCD12I PIC  X(0004).
  1640*    -------------------------------
  1641     05  CRTNT1L PIC S9(0004) COMP.
  1642     05  CRTNT1F PIC  X(0001).
  1643     05  FILLER REDEFINES CRTNT1F.
  1644         10  CRTNT1A PIC  X(0001).
  1645     05  CRTNT1I PIC  X(0063).
  1646*    -------------------------------
  1647     05  CRTNT2L PIC S9(0004) COMP.
  1648     05  CRTNT2F PIC  X(0001).
  1649     05  FILLER REDEFINES CRTNT2F.
  1650         10  CRTNT2A PIC  X(0001).
  1651     05  CRTNT2I PIC  X(0063).
  1652*    -------------------------------
  1653     05  BILNT1L PIC S9(0004) COMP.
  1654     05  BILNT1F PIC  X(0001).
  1655     05  FILLER REDEFINES BILNT1F.
  1656         10  BILNT1A PIC  X(0001).
  1657     05  BILNT1I PIC  X(0063).
  1658*    -------------------------------
  1659     05  ERRMSGL PIC S9(0004) COMP.
  1660     05  ERRMSGF PIC  X(0001).
  1661     05  FILLER REDEFINES ERRMSGF.
  1662         10  ERRMSGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  31
* EL6316.cbl
  1663     05  ERRMSGI PIC  X(0075).
  1664*    -------------------------------
  1665     05  PFENTRL PIC S9(0004) COMP.
  1666     05  PFENTRF PIC  X(0001).
  1667     05  FILLER REDEFINES PFENTRF.
  1668         10  PFENTRA PIC  X(0001).
  1669     05  PFENTRI PIC  9(2).
  1670 01  EL631IO REDEFINES EL631II.
  1671     05  FILLER            PIC  X(0012).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  DATEO PIC  X(0008).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  TIMEO PIC  99.99.
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  PROCIDO PIC  X(0004).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  HOSTO PIC  X(0009).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  SYSO PIC  X(0005).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  COMPANYO PIC  X(0003).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  DATASORO PIC  X(0001).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  BATCHNOO PIC  X(0006).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  BSEQNOO PIC  X(0008).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  ARCHNOO PIC  X(0008).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  PRTSWO PIC  X(0001).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  CARRO PIC  X(0001).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  GROUPO PIC  X(0006).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  STATEO PIC  X(0002).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  ACCTO PIC  X(0010).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  EFFDTO PIC  X(0008).
  1720*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  32
* EL6316.cbl
  1721     05  FILLER            PIC  X(0003).
  1722     05  CERTNOO PIC  X(0010).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  CRTSFXO PIC  X(0001).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  LTRIDO PIC  X(0004).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  SEQNOO PIC  999999.
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  FNAMEO PIC  X(0010).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  MINITO PIC  X(0001).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  LNAMEO PIC  X(0015).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  OLFDTO PIC  X(0008).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  OLFAMTO PIC  Z,ZZZ,999.99.
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  OAHDTO PIC  X(0008).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  OAHAMTO PIC  Z,ZZZ,999.99.
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  NLFDTO PIC  X(0008).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  NLFAMTO PIC  Z,ZZZ,999.99.
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  NAHDTO PIC  X(0008).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  NAHAMTO PIC  Z,ZZZ,999.99.
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  INPDTO PIC  X(0008).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  PROCDTO PIC  X(0008).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  LFCOMMO PIC  .99999.
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  AHCOMMO PIC  .99999.
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  33
* EL6316.cbl
  1779     05  RCD01O PIC  X(0004).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  RCD02O PIC  X(0004).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  RCD03O PIC  X(0004).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  RCD04O PIC  X(0004).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  RCD05O PIC  X(0004).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  RCD06O PIC  X(0004).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RCD07O PIC  X(0004).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RCD08O PIC  X(0004).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  RCD09O PIC  X(0004).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  RCD10O PIC  X(0004).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  RCD11O PIC  X(0004).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  RCD12O PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  CRTNT1O PIC  X(0063).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  CRTNT2O PIC  X(0063).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  BILNT1O PIC  X(0063).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  ERRMSGO PIC  X(0075).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  PFENTRO PIC  X(0002).
  1828*    -------------------------------
  1829 01  FILLER REDEFINES EL631II.
  1830     12  FILLER                   PIC X(357).
  1831     12  REASONCDS.
  1832         16  FILLER OCCURS 12.
  1833             20  REACDL       PIC S9(4) COMP.
  1834             20  REACDA       PIC X.
  1835             20  REACD-IN     PIC X(4).
  1836     12  FILLER               PIC X(215).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  34
* EL6316.cbl
  1837****************************************************************
  1838*
  1839* Copyright (c) 2007 by Clerity Solutions, Inc.
  1840* All rights reserved.
  1841*
  1842****************************************************************
  1843 01  DFHEIV.
  1844   02  DFHEIV0               PIC X(35).
  1845   02  DFHEIV1               PIC X(08).
  1846   02  DFHEIV2               PIC X(08).
  1847   02  DFHEIV3               PIC X(08).
  1848   02  DFHEIV4               PIC X(06).
  1849   02  DFHEIV5               PIC X(04).
  1850   02  DFHEIV6               PIC X(04).
  1851   02  DFHEIV7               PIC X(02).
  1852   02  DFHEIV8               PIC X(02).
  1853   02  DFHEIV9               PIC X(01).
  1854   02  DFHEIV10              PIC S9(7) COMP-3.
  1855   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1856   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1857   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1858   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1859   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1860   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1861   02  DFHEIV17              PIC X(04).
  1862   02  DFHEIV18              PIC X(04).
  1863   02  DFHEIV19              PIC X(04).
  1864   02  DFHEIV20              USAGE IS POINTER.
  1865   02  DFHEIV21              USAGE IS POINTER.
  1866   02  DFHEIV22              USAGE IS POINTER.
  1867   02  DFHEIV23              USAGE IS POINTER.
  1868   02  DFHEIV24              USAGE IS POINTER.
  1869   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1870   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1871   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1872   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1873   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1874   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1875   02  FILLER                PIC X(02).
  1876   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1877   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1878   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1879   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1880   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1881 LINKAGE  SECTION.
  1882*****************************************************************
  1883*                                                               *
  1884* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1885* All rights reserved.                                          *
  1886*                                                               *
  1887*****************************************************************
  1888 01  dfheiblk.
  1889     02  eibtime          pic s9(7) comp-3.
  1890     02  eibdate          pic s9(7) comp-3.
  1891     02  eibtrnid         pic x(4).
  1892     02  eibtaskn         pic s9(7) comp-3.
  1893     02  eibtrmid         pic x(4).
  1894     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  35
* EL6316.cbl
  1895     02  eibcposn         pic s9(4) comp.
  1896     02  eibcalen         pic s9(4) comp.
  1897     02  eibaid           pic x(1).
  1898     02  eibfiller1       pic x(1).
  1899     02  eibfn            pic x(2).
  1900     02  eibfiller2       pic x(2).
  1901     02  eibrcode         pic x(6).
  1902     02  eibfiller3       pic x(2).
  1903     02  eibds            pic x(8).
  1904     02  eibreqid         pic x(8).
  1905     02  eibrsrce         pic x(8).
  1906     02  eibsync          pic x(1).
  1907     02  eibfree          pic x(1).
  1908     02  eibrecv          pic x(1).
  1909     02  eibsend          pic x(1).
  1910     02  eibatt           pic x(1).
  1911     02  eibeoc           pic x(1).
  1912     02  eibfmh           pic x(1).
  1913     02  eibcompl         pic x(1).
  1914     02  eibsig           pic x(1).
  1915     02  eibconf          pic x(1).
  1916     02  eiberr           pic x(1).
  1917     02  eibrldbk         pic x(1).
  1918     02  eiberrcd         pic x(4).
  1919     02  eibsynrb         pic x(1).
  1920     02  eibnodat         pic x(1).
  1921     02  eibfiller5       pic x(2).
  1922     02  eibresp          pic 9(09) comp.
  1923     02  eibresp2         pic 9(09) comp.
  1924     02  dfheigdj         pic s9(4) comp.
  1925     02  dfheigdk         pic s9(4) comp.
  1926 01  DFHCOMMAREA                 PIC X(1300).
  1927 01  var  pic x(30).
  1928*                                COPY ERCACCT.
  1929******************************************************************
  1930*                                                                *
  1931*                                                                *
  1932*                            ERCACCT                             *
  1933*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1934*                            VMOD=2.031                          *
  1935*                                                                *
  1936*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1937*                                                                *
  1938*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1939*   VSAM ACCOUNT MASTER FILES.                                   *
  1940*                                                                *
  1941*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1942*                                                                *
  1943*   FILE TYPE = VSAM,KSDS                                        *
  1944*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1945*                                                                *
  1946*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1947*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1948*                                                                *
  1949*   LOG = NO                                                     *
  1950*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1951*                                                                *
  1952*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  36
* EL6316.cbl
  1953******************************************************************
  1954*                   C H A N G E   L O G
  1955*
  1956* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1957*-----------------------------------------------------------------
  1958*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1959* EFFECTIVE    NUMBER
  1960*-----------------------------------------------------------------
  1961* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1962* 092705    2005050300006  PEMA  ADD SPP LEASES
  1963* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1964* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1965* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1966* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1967* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1968******************************************************************
  1969
  1970 01  ACCOUNT-MASTER.
  1971     12  AM-RECORD-ID                      PIC XX.
  1972         88  VALID-AM-ID                      VALUE 'AM'.
  1973
  1974     12  AM-CONTROL-PRIMARY.
  1975         16  AM-COMPANY-CD                 PIC X.
  1976         16  AM-MSTR-CNTRL.
  1977             20  AM-CONTROL-A.
  1978                 24  AM-CARRIER            PIC X.
  1979                 24  AM-GROUPING.
  1980                     28 AM-GROUPING-PREFIX PIC XXX.
  1981                     28 AM-GROUPING-PRIME  PIC XXX.
  1982                 24  AM-STATE              PIC XX.
  1983                 24  AM-ACCOUNT.
  1984                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1985                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1986             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1987                                           PIC X(19).
  1988             20  AM-CNTRL-B.
  1989                 24  AM-EXPIRATION-DT      PIC XX.
  1990                 24  FILLER                PIC X(4).
  1991             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1992                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1993
  1994     12  AM-CONTROL-BY-VAR-GRP.
  1995         16  AM-COMPANY-CD-A1              PIC X.
  1996         16  AM-VG-CARRIER                 PIC X.
  1997         16  AM-VG-GROUPING                PIC X(6).
  1998         16  AM-VG-STATE                   PIC XX.
  1999         16  AM-VG-ACCOUNT                 PIC X(10).
  2000         16  AM-VG-DATE.
  2001             20  AM-VG-EXPIRATION-DT       PIC XX.
  2002             20  FILLER                    PIC X(4).
  2003         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2004                                           PIC 9(11)      COMP-3.
  2005     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2006         16  FILLER                        PIC X(10).
  2007         16  AM-VG-KEY3.
  2008             20  AM-VG3-ACCOUNT            PIC X(10).
  2009             20  AM-VG3-EXP-DT             PIC XX.
  2010         16  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  37
* EL6316.cbl
  2011     12  AM-MAINT-INFORMATION.
  2012         16  AM-LAST-MAINT-DT              PIC XX.
  2013         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2014         16  AM-LAST-MAINT-USER            PIC X(4).
  2015         16  FILLER                        PIC XX.
  2016
  2017     12  AM-EFFECTIVE-DT                   PIC XX.
  2018     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2019
  2020     12  AM-PREV-DATES  COMP-3.
  2021         16  AM-PREV-EXP-DT                PIC 9(11).
  2022         16  AM-PREV-EFF-DT                PIC 9(11).
  2023
  2024     12  AM-REPORT-CODE-1                  PIC X(10).
  2025     12  AM-REPORT-CODE-2                  PIC X(10).
  2026
  2027     12  AM-CITY-CODE                      PIC X(4).
  2028     12  AM-COUNTY-PARISH                  PIC X(6).
  2029
  2030     12  AM-NAME                           PIC X(30).
  2031     12  AM-PERSON                         PIC X(30).
  2032     12  AM-ADDRS                          PIC X(30).
  2033     12  AM-CITY.
  2034         16  AM-ADDR-CITY                  PIC X(28).
  2035         16  AM-ADDR-STATE                 PIC XX.
  2036     12  AM-ZIP.
  2037         16  AM-ZIP-PRIME.
  2038             20  AM-ZIP-PRI-1ST            PIC X.
  2039                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2040             20  FILLER                    PIC X(4).
  2041         16  AM-ZIP-PLUS4                  PIC X(4).
  2042     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2043         16  AM-CAN-POSTAL-1               PIC XXX.
  2044         16  AM-CAN-POSTAL-2               PIC XXX.
  2045         16  FILLER                        PIC XXX.
  2046     12  AM-TEL-NO.
  2047         16  AM-AREA-CODE                  PIC 999.
  2048         16  AM-TEL-PRE                    PIC 999.
  2049         16  AM-TEL-NBR                    PIC 9(4).
  2050     12  AM-TEL-LOC                        PIC X.
  2051         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2052         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2053
  2054     12  AM-COMM-STRUCTURE.
  2055         16  AM-DEFN-1.
  2056             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2057                 24  AM-AGT.
  2058                     28  AM-AGT-PREFIX     PIC X(4).
  2059                     28  AM-AGT-PRIME      PIC X(6).
  2060                 24  AM-COM-TYP            PIC X.
  2061                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2062                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2063                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2064                 24  AM-RECALC-LV-INDIC    PIC X.
  2065                 24  AM-RETRO-LV-INDIC     PIC X.
  2066                 24  AM-GL-CODES           PIC X.
  2067                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2068                 24  FILLER                PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  38
* EL6316.cbl
  2069         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2070             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2071                 24  FILLER                PIC X(11).
  2072                 24  AM-L-COMA             PIC XXX.
  2073                 24  AM-J-COMA             PIC XXX.
  2074                 24  AM-A-COMA             PIC XXX.
  2075                 24  FILLER                PIC X(6).
  2076
  2077     12  AM-COMM-CHANGE-STATUS             PIC X.
  2078         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2079
  2080     12  AM-CSR-CODE                       PIC X(4).
  2081
  2082     12  AM-BILLING-STATUS                 PIC X.
  2083         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2084         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2085     12  AM-AUTO-REFUND-SW                 PIC X.
  2086         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2087         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2088     12  AM-GPCD                           PIC 99.
  2089     12  AM-IG                             PIC X.
  2090         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2091         88  AM-HAS-GROUP                     VALUE '2'.
  2092     12  AM-STATUS                         PIC X.
  2093         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2094         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2095         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2096         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2097         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2098         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2099     12  AM-REMIT-TO                       PIC 99.
  2100     12  AM-ID-NO                          PIC X(11).
  2101
  2102     12  AM-CAL-TABLE                      PIC XX.
  2103     12  AM-LF-DEVIATION                   PIC XXX.
  2104     12  AM-AH-DEVIATION                   PIC XXX.
  2105     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2106     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2107     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2108     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2109     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2110     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2111
  2112     12  AM-USER-FIELDS.
  2113         16  AM-FLD-1                      PIC XX.
  2114         16  AM-FLD-2                      PIC XX.
  2115         16  AM-FLD-3                      PIC XX.
  2116         16  AM-FLD-4                      PIC XX.
  2117         16  AM-FLD-5                      PIC XX.
  2118
  2119     12  AM-1ST-PROD-DATE.
  2120         16  AM-1ST-PROD-YR                PIC XX.
  2121         16  AM-1ST-PROD-MO                PIC XX.
  2122         16  AM-1ST-PROD-DA                PIC XX.
  2123     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2124     12  AM-CERTS-PURGED-DATE.
  2125         16  AM-PUR-YR                     PIC XX.
  2126         16  AM-PUR-MO                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  39
* EL6316.cbl
  2127         16  AM-PUR-DA                     PIC XX.
  2128     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2129     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2130     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2131     12  AM-INACTIVE-DATE.
  2132         16  AM-INA-MO                     PIC 99.
  2133         16  AM-INA-DA                     PIC 99.
  2134         16  AM-INA-YR                     PIC 99.
  2135     12  AM-AR-HI-CERT-DATE                PIC XX.
  2136
  2137     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2138     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2139
  2140     12  AM-OB-PAYMENT-MODE                PIC X.
  2141         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2142         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2143         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2144         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2145
  2146     12  AM-AH-ONLY-INDICATOR              PIC X.
  2147         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2148         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2149
  2150     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2151
  2152     12  AM-OVER-SHORT.
  2153         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2154         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2155
  2156     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2157     12  AM-DCC-CLP-STATE                  PIC XX.
  2158
  2159     12  AM-RECALC-COMM                    PIC X.
  2160     12  AM-RECALC-REIN                    PIC X.
  2161
  2162     12  AM-REI-TABLE                      PIC XXX.
  2163     12  AM-REI-ET-LF                      PIC X.
  2164     12  AM-REI-ET-AH                      PIC X.
  2165     12  AM-REI-PE-LF                      PIC X.
  2166     12  AM-REI-PE-AH                      PIC X.
  2167     12  AM-REI-PRT-ST                     PIC X.
  2168     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2169     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2170     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2171     12  AM-REI-GROUP-A                    PIC X(6).
  2172     12  AM-REI-MORT                       PIC X(4).
  2173     12  AM-REI-PRT-OW                     PIC X.
  2174     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2175     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2176     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2177     12  AM-REI-GROUP-B                    PIC X(6).
  2178
  2179     12  AM-TRUST-TYPE                     PIC X(2).
  2180
  2181     12  AM-EMPLOYER-STMT-USED             PIC X.
  2182     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2183
  2184     12  AM-STD-AH-TYPE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  40
* EL6316.cbl
  2185     12  AM-EARN-METHODS.
  2186         16  AM-EARN-METHOD-R              PIC X.
  2187             88 AM-REF-RL-R78                 VALUE 'R'.
  2188             88 AM-REF-RL-PR                  VALUE 'P'.
  2189             88 AM-REF-RL-MEAN                VALUE 'M'.
  2190             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2191         16  AM-EARN-METHOD-L              PIC X.
  2192             88 AM-REF-LL-R78                 VALUE 'R'.
  2193             88 AM-REF-LL-PR                  VALUE 'P'.
  2194             88 AM-REF-LL-MEAN                VALUE 'M'.
  2195             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2196         16  AM-EARN-METHOD-A              PIC X.
  2197             88 AM-REF-AH-R78                 VALUE 'R'.
  2198             88 AM-REF-AH-PR                  VALUE 'P'.
  2199             88 AM-REF-AH-MEAN                VALUE 'M'.
  2200             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2201             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2202             88 AM-REF-AH-NET                 VALUE 'N'.
  2203
  2204     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2205     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2206     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2207
  2208     12  AM-RET-Y-N                        PIC X.
  2209     12  AM-RET-P-E                        PIC X.
  2210     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2211     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2212     12  AM-RET-GRP                        PIC X(6).
  2213     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2214         16  AM-POOL-PRIME                 PIC XXX.
  2215         16  AM-POOL-SUB                   PIC XXX.
  2216     12  AM-RETRO-EARNINGS.
  2217         16  AM-RET-EARN-R                 PIC X.
  2218         16  AM-RET-EARN-L                 PIC X.
  2219         16  AM-RET-EARN-A                 PIC X.
  2220     12  AM-RET-ST-TAX-USE                 PIC X.
  2221         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2222         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2223     12  AM-RETRO-BEG-EARNINGS.
  2224         16  AM-RET-BEG-EARN-R             PIC X.
  2225         16  AM-RET-BEG-EARN-L             PIC X.
  2226         16  AM-RET-BEG-EARN-A             PIC X.
  2227     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2228     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2229
  2230     12  AM-USER-SELECT-OPTIONS.
  2231         16  AM-USER-SELECT-1              PIC X(10).
  2232         16  AM-USER-SELECT-2              PIC X(10).
  2233         16  AM-USER-SELECT-3              PIC X(10).
  2234         16  AM-USER-SELECT-4              PIC X(10).
  2235         16  AM-USER-SELECT-5              PIC X(10).
  2236
  2237     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2238
  2239     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2240
  2241     12  AM-RPT045A-SWITCH                 PIC X.
  2242         88  RPT045A-OFF                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  41
* EL6316.cbl
  2243
  2244     12  AM-INSURANCE-LIMITS.
  2245         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2246         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2247
  2248     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2249         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2250
  2251     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2252         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2253         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2254
  2255     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2256
  2257     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2258     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2259     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2260     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2261     12  AM-DCC-UEF-STATE                  PIC XX.
  2262     12  FILLER                            PIC XXX.
  2263     12  AM-REPORT-CODE-3                  PIC X(10).
  2264*    12  FILLER                            PIC X(22).
  2265
  2266     12  AM-RESERVE-DATE.
  2267         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2268         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2269         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2270
  2271     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2272     12  AM-NOTIFICATION-TYPES.
  2273         16  AM-NOTIF-OF-LETTERS           PIC X.
  2274         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2275         16  AM-NOTIF-OF-REPORTS           PIC X.
  2276         16  AM-NOTIF-OF-STATUS            PIC X.
  2277
  2278     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2279         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2280         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2281         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2282         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2283
  2284     12  AM-BENEFIT-CONTROLS.
  2285         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2286             20  AM-BENEFIT-CODE           PIC XX.
  2287             20  AM-BENEFIT-TYPE           PIC X.
  2288             20  AM-BENEFIT-REVISION       PIC XXX.
  2289             20  AM-BENEFIT-REM-TERM       PIC X.
  2290             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2291             20  FILLER                    PIC XX.
  2292         16  FILLER                        PIC X(80).
  2293
  2294     12  AM-TRANSFER-DATA.
  2295         16  AM-TRANSFERRED-FROM.
  2296             20  AM-TRNFROM-CARRIER        PIC X.
  2297             20  AM-TRNFROM-GROUPING.
  2298                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2299                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2300             20  AM-TRNFROM-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  42
* EL6316.cbl
  2301             20  AM-TRNFROM-ACCOUNT.
  2302                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2303                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2304             20  AM-TRNFROM-DTE            PIC XX.
  2305         16  AM-TRANSFERRED-TO.
  2306             20  AM-TRNTO-CARRIER          PIC X.
  2307             20  AM-TRNTO-GROUPING.
  2308                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2309                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2310             20  AM-TRNTO-STATE            PIC XX.
  2311             20  AM-TRNTO-ACCOUNT.
  2312                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2313                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2314             20  AM-TRNTO-DTE              PIC XX.
  2315         16  FILLER                        PIC X(10).
  2316
  2317     12  AM-SAVED-REMIT-TO                 PIC 99.
  2318
  2319     12  AM-COMM-STRUCTURE-SAVED.
  2320         16  AM-DEFN-1-SAVED.
  2321             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2322                 24  AM-AGT-SV             PIC X(10).
  2323                 24  AM-COM-TYP-SV         PIC X.
  2324                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2325                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2326                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2327                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2328                 24  FILLER                PIC X.
  2329                 24  AM-GL-CODES-SV        PIC X.
  2330                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2331                 24  FILLER                PIC X.
  2332         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2333             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2334                 24  FILLER                PIC X(11).
  2335                 24  AM-L-COMA-SV          PIC XXX.
  2336                 24  AM-J-COMA-SV          PIC XXX.
  2337                 24  AM-A-COMA-SV          PIC XXX.
  2338                 24  FILLER                PIC X(6).
  2339
  2340     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2341         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2342            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2343            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2344            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2345
  2346     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2347     12  FILLER                            PIC X(120).
  2348
  2349     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2350         16  AM-CONTROL-NAME               PIC X(30).
  2351         16  AM-EXECUTIVE-ONE.
  2352             20  AM-EXEC1-NAME             PIC X(15).
  2353             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2354                                                          COMP-3.
  2355             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2356                                                          COMP-3.
  2357         16  AM-EXECUTIVE-TWO.
  2358             20  AM-EXEC2-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  43
* EL6316.cbl
  2359             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2360                                                          COMP-3.
  2361             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2362                                                          COMP-3.
  2363
  2364     12  AM-RETRO-ADDITIONAL-DATA.
  2365         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2366         16  AM-RETRO-PREM-P-E             PIC X.
  2367         16  AM-RETRO-CLMS-P-I             PIC X.
  2368         16  AM-RETRO-RET-BRACKET-LF.
  2369             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2370                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2371                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2372             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2373                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2374                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2375             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2376                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2377                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2378         16  AM-RETRO-RET-BRACKET-AH.
  2379             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2380                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2381                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2382                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2383             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2384                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2385                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2386             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2387                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2388                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2389
  2390     12  AM-COMMENTS.
  2391         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2392
  2393     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2394         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2395         16  AM-FLI-BILLING-CODE           PIC X.
  2396         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2397         16  AM-FLI-UNITED-IDENT           PIC X.
  2398         16  AM-FLI-INTEREST-LOST-DATA.
  2399             20  AM-FLI-BANK-NO            PIC X(5).
  2400             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2401             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2402             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2403         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2404             20  AM-FLI-AGT                PIC X(9).
  2405             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2406             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2407         16  FILLER                        PIC X(102).
  2408
  2409     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2410         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2411             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2412             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2413             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2414             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2415             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2416         16  FILLER                          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  44
* EL6316.cbl
  2417******************************************************************
  2418*                                COPY ELCCNTL.
  2419******************************************************************
  2420*                                                                *
  2421*                                                                *
  2422*                            ELCCNTL.                            *
  2423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2424*                            VMOD=2.059                          *
  2425*                                                                *
  2426*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2427*                                                                *
  2428*   FILE TYPE = VSAM,KSDS                                        *
  2429*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2430*                                                                *
  2431*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2432*       ALTERNATE INDEX = NONE                                   *
  2433*                                                                *
  2434*   LOG = YES                                                    *
  2435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2436******************************************************************
  2437*                   C H A N G E   L O G
  2438*
  2439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2440*-----------------------------------------------------------------
  2441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2442* EFFECTIVE    NUMBER
  2443*-----------------------------------------------------------------
  2444* 082503                   PEMA  ADD BENEFIT GROUP
  2445* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2446* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2447* 092705    2005050300006  PEMA  ADD SPP LEASES
  2448* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2449* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2450* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2451* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2452* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2453* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2454******************************************************************
  2455*
  2456 01  CONTROL-FILE.
  2457     12  CF-RECORD-ID                       PIC XX.
  2458         88  VALID-CF-ID                        VALUE 'CF'.
  2459
  2460     12  CF-CONTROL-PRIMARY.
  2461         16  CF-COMPANY-ID                  PIC XXX.
  2462         16  CF-RECORD-TYPE                 PIC X.
  2463             88  CF-COMPANY-MASTER              VALUE '1'.
  2464             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2465             88  CF-STATE-MASTER                VALUE '3'.
  2466             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2467             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2468             88  CF-CARRIER-MASTER              VALUE '6'.
  2469             88  CF-MORTALITY-MASTER            VALUE '7'.
  2470             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2471             88  CF-TERMINAL-MASTER             VALUE '9'.
  2472             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2473             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2474             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  45
* EL6316.cbl
  2475             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2476             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2477             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2478             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2479             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2480             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2481         16  CF-ACCESS-CD-GENL              PIC X(4).
  2482         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2483             20  CF-PROCESSOR               PIC X(4).
  2484         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2485             20  CF-STATE-CODE              PIC XX.
  2486             20  FILLER                     PIC XX.
  2487         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2488             20  FILLER                     PIC XX.
  2489             20  CF-HI-BEN-IN-REC           PIC XX.
  2490         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2491             20  FILLER                     PIC XXX.
  2492             20  CF-CARRIER-CNTL            PIC X.
  2493         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2494             20  FILLER                     PIC XX.
  2495             20  CF-HI-TYPE-IN-REC          PIC 99.
  2496         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2497             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2498                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2499             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2500             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2501         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2502             20  FILLER                     PIC X.
  2503             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2504         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2505             20  FILLER                     PIC XX.
  2506             20  CF-MORTGAGE-PLAN           PIC XX.
  2507         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2508
  2509     12  CF-LAST-MAINT-DT                   PIC XX.
  2510     12  CF-LAST-MAINT-BY                   PIC X(4).
  2511     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2512
  2513     12  CF-RECORD-BODY                     PIC X(728).
  2514
  2515
  2516****************************************************************
  2517*             COMPANY MASTER RECORD                            *
  2518****************************************************************
  2519
  2520     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2521         16  CF-COMPANY-ADDRESS.
  2522             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2523             20  CF-CL-IN-CARE-OF           PIC X(30).
  2524             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2525             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2526             20  CF-CL-CITY-STATE           PIC X(30).
  2527             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2528             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2529         16  CF-COMPANY-CD                  PIC X.
  2530         16  CF-COMPANY-PASSWORD            PIC X(8).
  2531         16  CF-SECURITY-OPTION             PIC X.
  2532             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  46
* EL6316.cbl
  2533             88  COMPANY-VERIFY                 VALUE '2'.
  2534             88  PROCESSOR-VERIFY               VALUE '3'.
  2535             88  NO-SECURITY                    VALUE '4'.
  2536             88  ALL-BUT-TERM                   VALUE '5'.
  2537         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2538             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2539         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2540             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2541         16  CF-INFORCE-LOCATION            PIC X.
  2542             88  CERTS-ARE-ONLINE               VALUE '1'.
  2543             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2544             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2545         16  CF-LOWER-CASE-LETTERS          PIC X.
  2546         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2547             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2548             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2549             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2550             88  CF-ACCNT-CNTL                  VALUE '3'.
  2551             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2552
  2553         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2554         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2555
  2556         16  CF-LGX-CREDIT-USER             PIC X.
  2557             88  CO-IS-NOT-USER                 VALUE 'N'.
  2558             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2559
  2560         16 CF-CREDIT-CALC-CODES.
  2561             20  CF-CR-REM-TERM-CALC PIC X.
  2562               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2563               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2564               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2565               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2566               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2567               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2568               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2569             20  CF-CR-R78-METHOD           PIC X.
  2570               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2571               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2572
  2573         16  CF-CLAIM-CONTROL-COUNTS.
  2574             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2575                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2576
  2577             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2578                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2579
  2580             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2581                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2582
  2583             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2584                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2585
  2586         16  CF-CURRENT-MONTH-END           PIC XX.
  2587
  2588         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2589             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2590             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  47
* EL6316.cbl
  2591             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2592             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2593                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2594                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2595             20  CF-CO-PREM-REJECT-SW       PIC X.
  2596                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2597                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2598             20  CF-CO-REF-REJECT-SW        PIC X.
  2599                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2600                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2601
  2602         16  CF-CO-REPORTING-DT             PIC XX.
  2603         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2604         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2605           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2606           88  CF-CO-MONTH-END                  VALUE '1'.
  2607
  2608         16  CF-LGX-CLAIM-USER              PIC X.
  2609             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2610             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2611
  2612         16  CF-CREDIT-EDIT-CONTROLS.
  2613             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2614             20  CF-MIN-AGE                 PIC 99.
  2615             20  CF-DEFAULT-AGE             PIC 99.
  2616             20  CF-MIN-TERM                PIC S999      COMP-3.
  2617             20  CF-MAX-TERM                PIC S999      COMP-3.
  2618             20  CF-DEFAULT-SEX             PIC X.
  2619             20  CF-JOINT-AGE-INPUT         PIC X.
  2620                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2621             20  CF-BIRTH-DATE-INPUT        PIC X.
  2622                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2623             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2624                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2625                 88  CF-ZERO-CARRIER            VALUE '1'.
  2626                 88  CF-ZERO-GROUPING           VALUE '2'.
  2627                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2628             20  CF-EDIT-SW                 PIC X.
  2629                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2630             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2631             20  CF-CR-PR-METHOD            PIC X.
  2632               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2633               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2634             20  FILLER                     PIC X.
  2635
  2636         16  CF-CREDIT-MISC-CONTROLS.
  2637             20  CF-REIN-TABLE-SW           PIC X.
  2638                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2639             20  CF-COMP-TABLE-SW           PIC X.
  2640                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2641             20  CF-EXPERIENCE-RETENTION-AGE
  2642                                            PIC S9        COMP-3.
  2643             20  CF-CONVERSION-DT           PIC XX.
  2644             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2645             20  CF-RUN-FREQUENCY-SW        PIC X.
  2646                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2647                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2648
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  48
* EL6316.cbl
  2649             20  CF-CR-CHECK-NO-CONTROL.
  2650                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2651                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2652                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2653                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2654                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2655                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2656
  2657                 24  CF-CR-CHECK-COUNT       REDEFINES
  2658                     CF-CR-CHECK-COUNTER      PIC X(4).
  2659
  2660                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2661                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2662
  2663                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2664                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2665                 24  CF-MAIL-PROCESSING       PIC X.
  2666                     88  MAIL-PROCESSING          VALUE 'Y'.
  2667
  2668         16  CF-MISC-SYSTEM-CONTROL.
  2669             20  CF-SYSTEM-C                 PIC X.
  2670                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2671             20  CF-SYSTEM-D                 PIC X.
  2672                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2673             20  CF-SOC-SEC-NO-SW            PIC X.
  2674                 88  SOC-SEC-NO-USED             VALUE '1'.
  2675             20  CF-MEMBER-NO-SW             PIC X.
  2676                 88  MEMBER-NO-USED              VALUE '1'.
  2677             20  CF-TAX-ID-NUMBER            PIC X(11).
  2678             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2679             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2680                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2681                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2682                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2683                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2684             20  CF-SYSTEM-E                 PIC X.
  2685                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2686
  2687         16  CF-LGX-LIFE-USER               PIC X.
  2688             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2689             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2690
  2691         16  CF-CR-MONTH-END-DT             PIC XX.
  2692
  2693         16  CF-FILE-MAINT-DATES.
  2694             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2695                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2696             20  CF-LAST-BATCH       REDEFINES
  2697                 CF-LAST-BATCH-NO               PIC X(4).
  2698             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2699             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2700             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2701             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2702             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2703             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2704             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2705             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2706             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  49
* EL6316.cbl
  2707             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2708
  2709         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2710         16  FILLER                         PIC X.
  2711
  2712         16  CF-ALT-MORT-CODE               PIC X(4).
  2713         16  CF-MEMBER-CAPTION              PIC X(10).
  2714
  2715         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2716             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2717             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2718             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2719             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2720             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2721
  2722         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2723
  2724         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2725         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2726         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2727         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2728
  2729         16  CF-AH-OVERRIDE-L1              PIC X.
  2730         16  CF-AH-OVERRIDE-L2              PIC XX.
  2731         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2732         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2733
  2734         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2735         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2736
  2737         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2738         16  CF-AR-LAST-EL860-DT            PIC XX.
  2739         16  CF-MP-MONTH-END-DT             PIC XX.
  2740
  2741         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2742         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2743             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2744
  2745         16  CF-AR-MONTH-END-DT             PIC XX.
  2746
  2747         16  CF-CRDTCRD-USER                PIC X.
  2748             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2749             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2750
  2751         16  CF-CC-MONTH-END-DT             PIC XX.
  2752
  2753         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2754
  2755         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2756             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2757             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2758             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2759         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2760         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2761         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2762         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2763             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2764             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  50
* EL6316.cbl
  2765         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2766         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2767         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2768             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2769         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2770
  2771         16  CF-CL-ZIP-CODE.
  2772             20  CF-CL-ZIP-PRIME.
  2773                 24  CF-CL-ZIP-1ST          PIC X.
  2774                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2775                 24  FILLER                 PIC X(4).
  2776             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2777         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2778             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2779             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2780             20  FILLER                     PIC XXX.
  2781
  2782         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2783         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2784         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2785         16  CF-CO-OPTION-START-DATE        PIC XX.
  2786         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2787           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2788                                                      '3' '4'.
  2789           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2790           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2791           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2792           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2793           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2794           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2795
  2796         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2797
  2798         16  CF-PAYMENT-APPROVAL-LEVELS.
  2799             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2800             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2801             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2802             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2803             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2804             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2805
  2806         16  CF-END-USER-REPORTING-USER     PIC X.
  2807             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2808             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2809
  2810         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2811             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2812             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2813
  2814         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2815
  2816         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2817         16  FILLER                         PIC X.
  2818
  2819         16  CF-CREDIT-ARCHIVE-CNTL.
  2820             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2821             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2822             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  51
* EL6316.cbl
  2823
  2824         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2825
  2826         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2827             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2828             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2829
  2830         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2831             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2832             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2833
  2834         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2835
  2836         16  CF-CO-ACH-ID-CODE              PIC  X.
  2837             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2838             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2839             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2840         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2841         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2842         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2843         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2844         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2845         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2846         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2847         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2848         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2849                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2850         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2851                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2852
  2853         16  CF-CO-OVER-SHORT.
  2854             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2855             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2856
  2857*         16  FILLER                         PIC X(102).
  2858         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2859             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2860             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2861
  2862         16  CF-AH-APPROVAL-DAYS.
  2863             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2864             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2865             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2866             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2867
  2868         16  FILLER                         PIC X(82).
  2869****************************************************************
  2870*             PROCESSOR/USER RECORD                            *
  2871****************************************************************
  2872
  2873     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2874         16  CF-PROCESSOR-NAME              PIC X(30).
  2875         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2876         16  CF-PROCESSOR-TITLE             PIC X(26).
  2877         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2878                 88  MESSAGE-YES                VALUE 'Y'.
  2879                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2880
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  52
* EL6316.cbl
  2881*****************************************************
  2882****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2883****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2884****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2885****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2886*****************************************************
  2887
  2888         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2889             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2890             20  CF-APPLICATION-FORCE       PIC X.
  2891             20  CF-INDIVIDUAL-APP.
  2892                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2893                     28  CF-BROWSE-APP      PIC X.
  2894                     28  CF-UPDATE-APP      PIC X.
  2895
  2896         16  CF-CURRENT-TERM-ON             PIC X(4).
  2897         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2898             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2899             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2900             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2901             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2902             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2903             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2904             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2905         16  CF-PROCESSOR-CARRIER           PIC X.
  2906             88  NO-CARRIER-SECURITY            VALUE ' '.
  2907         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2908             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2909         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2910             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2911         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2912             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2913
  2914         16  CF-PROC-SYS-ACCESS-SW.
  2915             20  CF-PROC-CREDIT-CLAIMS-SW.
  2916                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2917                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2918                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2919                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2920             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2921                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2922                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2923             20  CF-PROC-LIFE-GNRLDGR-SW.
  2924                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2925                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2926                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2927                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2928             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2929                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2930                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2931         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2932             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2933             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2934         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2935
  2936         16  CF-APPROVAL-LEVEL                  PIC X.
  2937             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2938             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  53
* EL6316.cbl
  2939             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2940             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2941
  2942         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2943
  2944         16  CF-LANGUAGE-TYPE                   PIC X.
  2945             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2946             88  CF-LANG-IS-FR                      VALUE 'F'.
  2947
  2948         16  CF-CSR-IND                         PIC X.
  2949         16  FILLER                             PIC X(239).
  2950
  2951****************************************************************
  2952*             PROCESSOR/REMINDERS RECORD                       *
  2953****************************************************************
  2954
  2955     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2956         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2957             20  CF-START-REMIND-DT         PIC XX.
  2958             20  CF-END-REMIND-DT           PIC XX.
  2959             20  CF-REMINDER-TEXT           PIC X(50).
  2960         16  FILLER                         PIC X(296).
  2961
  2962
  2963****************************************************************
  2964*             STATE MASTER RECORD                              *
  2965****************************************************************
  2966
  2967     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2968         16  CF-STATE-ABBREVIATION          PIC XX.
  2969         16  CF-STATE-NAME                  PIC X(25).
  2970         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2971         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2972             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2973             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2974             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2975             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2976                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2977                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2978             20  CF-ST-PREM-REJECT-SW       PIC X.
  2979                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2980                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2981             20  CF-ST-REF-REJECT-SW        PIC X.
  2982                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2983                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2984         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2985         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2986         16  CF-ST-REFUND-RULES.
  2987             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2988             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2989             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2990         16  CF-ST-FST-PMT-EXTENSION.
  2991             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2992             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2993                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2994                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2995                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2996                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  54
* EL6316.cbl
  2997         16  CF-ST-STATE-CALL.
  2998             20  CF-ST-CALL-UNEARNED        PIC X.
  2999             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3000             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3001         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3002             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3003             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3004         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3005         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3006         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3007         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3008         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3009         16  FILLER                         PIC X.
  3010         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3011             20  CF-ST-BENEFIT-CD           PIC XX.
  3012             20  CF-ST-BENEFIT-KIND         PIC X.
  3013                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3014                 88  CF-ST-AH-KIND              VALUE 'A'.
  3015             20  CF-ST-REM-TERM-CALC        PIC X.
  3016                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3017                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3018                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3019                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3020                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3021                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3022                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3023                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3024
  3025             20  CF-ST-REFUND-CALC          PIC X.
  3026                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3027                 88  ST-REFD-BY-R78             VALUE '1'.
  3028                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3029                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3030                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3031                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3032                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3033                 88  ST-REFD-UTAH               VALUE '7'.
  3034                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3035                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3036                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3037
  3038             20  CF-ST-EARNING-CALC         PIC X.
  3039                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3040                 88  ST-EARN-BY-R78             VALUE '1'.
  3041                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3042                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3043                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3044                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3045                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3046                 88  ST-EARN-MEAN               VALUE '8'.
  3047                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3048
  3049             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3050                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3051                 88  ST-OVRD-BY-R78             VALUE '1'.
  3052                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3053                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3054                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  55
* EL6316.cbl
  3055                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3056                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3057                 88  ST-OVRD-MEAN               VALUE '8'.
  3058                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3059             20  FILLER                     PIC X.
  3060
  3061         16  CF-ST-COMMISSION-CAPS.
  3062             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3063             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3064             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3065             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3066         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3067                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3068
  3069         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3070
  3071         16  CF-ST-STATUTORY-INTEREST.
  3072             20  CF-ST-STAT-DATE-FROM       PIC X.
  3073                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3074                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3075             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3076             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3077             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3078             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3079             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3080
  3081         16  CF-ST-OVER-SHORT.
  3082             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3083             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3084
  3085         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3086
  3087         16  CF-ST-RT-CALC                  PIC X.
  3088
  3089         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3090         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3091         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3092         16  CF-ST-RF-LR-CALC               PIC X.
  3093         16  CF-ST-RF-LL-CALC               PIC X.
  3094         16  CF-ST-RF-LN-CALC               PIC X.
  3095         16  CF-ST-RF-AH-CALC               PIC X.
  3096         16  CF-ST-RF-CP-CALC               PIC X.
  3097*        16  FILLER                         PIC X(206).
  3098*CIDMOD         16  FILLER                         PIC X(192).
  3099         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3100             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3101         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3102         16  CF-ST-VFY-2ND-BENE             PIC X.
  3103         16  FILLER                         PIC X(186).
  3104
  3105****************************************************************
  3106*             BENEFIT MASTER RECORD                            *
  3107****************************************************************
  3108
  3109     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3110         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3111             20  CF-BENEFIT-CODE            PIC XX.
  3112             20  CF-BENEFIT-NUMERIC  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  56
* EL6316.cbl
  3113                 CF-BENEFIT-CODE            PIC XX.
  3114             20  CF-BENEFIT-ALPHA           PIC XXX.
  3115             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3116             20  CF-BENEFIT-COMMENT         PIC X(10).
  3117
  3118             20  CF-LF-COVERAGE-TYPE        PIC X.
  3119                 88  CF-REDUCING                VALUE 'R'.
  3120                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3121
  3122             20  CF-SPECIAL-CALC-CD         PIC X.
  3123                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3124                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3125                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3126                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3127                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3128                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3129                 88  CF-FARM-PLAN               VALUE 'F'.
  3130                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3131                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3132                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3133                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3134                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3135                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3136                 88  CF-PRUDENTIAL              VALUE 'P'.
  3137                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3138                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3139                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3140                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3141                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3142                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3143
  3144             20  CF-JOINT-INDICATOR         PIC X.
  3145                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3146
  3147*            20  FILLER                     PIC X(12).
  3148             20  FILLER                     PIC X(11).
  3149             20  CF-BENEFIT-CATEGORY        PIC X.
  3150             20  CF-LOAN-TYPE               PIC X(8).
  3151
  3152             20  CF-CO-REM-TERM-CALC        PIC X.
  3153                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3154                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3155                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3156                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3157                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3158
  3159             20  CF-CO-EARNINGS-CALC        PIC X.
  3160                 88  CO-EARN-BY-R78             VALUE '1'.
  3161                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3162                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3163                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3164                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3165                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3166                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3167                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3168
  3169             20  CF-CO-REFUND-CALC          PIC X.
  3170                 88  CO-REFUND-NOT-USED         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  57
* EL6316.cbl
  3171                 88  CO-REFD-BY-R78             VALUE '1'.
  3172                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3173                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3174                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3175                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3176                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3177                 88  CO-REFD-MEAN               VALUE '8'.
  3178                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3179                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3180                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3181
  3182             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3183                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3184                 88  CO-OVRD-BY-R78             VALUE '1'.
  3185                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3186                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3187                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3188                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3189                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3190                 88  CO-OVRD-MEAN               VALUE '8'.
  3191                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3192
  3193             20  CF-CO-BEN-I-G-CD           PIC X.
  3194                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3195                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3196                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3197
  3198         16  FILLER                         PIC X(304).
  3199
  3200
  3201****************************************************************
  3202*             CARRIER MASTER RECORD                            *
  3203****************************************************************
  3204
  3205     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3206         16  CF-ADDRESS-DATA.
  3207             20  CF-MAIL-TO-NAME            PIC X(30).
  3208             20  CF-IN-CARE-OF              PIC X(30).
  3209             20  CF-ADDRESS-LINE-1          PIC X(30).
  3210             20  CF-ADDRESS-LINE-2          PIC X(30).
  3211             20  CF-CITY-STATE              PIC X(30).
  3212             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3213             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3214
  3215         16  CF-CLAIM-NO-CONTROL.
  3216             20  CF-CLAIM-NO-METHOD         PIC X.
  3217                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3218                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3219                 88  CLAIM-NO-SEQ               VALUE '3'.
  3220                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3221             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3222                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3223                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3224                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3225
  3226         16  CF-CHECK-NO-CONTROL.
  3227             20  CF-CHECK-NO-METHOD         PIC X.
  3228                 88  CHECK-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  58
* EL6316.cbl
  3229                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3230                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3231                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3232             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3233                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3234
  3235         16  CF-DOMICILE-STATE              PIC XX.
  3236
  3237         16  CF-EXPENSE-CONTROLS.
  3238             20  CF-EXPENSE-METHOD          PIC X.
  3239                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3240                 88  DOLLARS-PER-PMT            VALUE '2'.
  3241                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3242                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3243             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3244             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3245
  3246         16  CF-CORRESPONDENCE-CONTROL.
  3247             20  CF-LETTER-RESEND-OPT       PIC X.
  3248                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3249                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3250             20  FILLER                     PIC X(4).
  3251
  3252         16  CF-RESERVE-CONTROLS.
  3253             20  CF-MANUAL-SW               PIC X.
  3254                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3255             20  CF-FUTURE-SW               PIC X.
  3256                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3257             20  CF-PTC-SW                  PIC X.
  3258                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3259             20  CF-IBNR-SW                 PIC X.
  3260                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3261             20  CF-PTC-LF-SW               PIC X.
  3262                 88  CF-LF-PTC-USED             VALUE '1'.
  3263             20  CF-CDT-ACCESS-METHOD       PIC X.
  3264                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3265                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3266                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3267             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3268
  3269         16  CF-CLAIM-CALC-METHOD           PIC X.
  3270             88  360-PLUS-MONTHS                VALUE '1'.
  3271             88  365-PLUS-MONTHS                VALUE '2'.
  3272             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3273             88  360-DAILY                      VALUE '4'.
  3274             88  365-DAILY                      VALUE '5'.
  3275
  3276         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3277         16  FILLER                         PIC X(11).
  3278
  3279         16  CF-LIMIT-AMOUNTS.
  3280             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3281             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3282             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3283             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3284             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3285             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3286             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  59
* EL6316.cbl
  3287             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3288             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3289             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3290
  3291         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3292         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3293         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3294
  3295         16  CF-ZIP-CODE.
  3296             20  CF-ZIP-PRIME.
  3297                 24  CF-ZIP-1ST             PIC X.
  3298                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3299                 24  FILLER                 PIC X(4).
  3300             20  CF-ZIP-PLUS4               PIC X(4).
  3301         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3302             20  CF-CAN-POSTAL-1            PIC XXX.
  3303             20  CF-CAN-POSTAL-2            PIC XXX.
  3304             20  FILLER                     PIC XXX.
  3305
  3306         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3307         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3308         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3309
  3310         16  CF-RATING-SWITCH               PIC X.
  3311             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3312             88  CF-NO-RATING                   VALUE 'N'.
  3313
  3314         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3315
  3316         16  CF-CARRIER-OVER-SHORT.
  3317             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3318             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3319
  3320         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3321         16  CF-SECPAY-SWITCH               PIC X.
  3322             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3323             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3324         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3325         16  FILLER                         PIC X(448).
  3326*        16  FILLER                         PIC X(452).
  3327
  3328
  3329****************************************************************
  3330*             MORTALITY MASTER RECORD                          *
  3331****************************************************************
  3332
  3333     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3334         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3335                                INDEXED BY CF-MORT-NDX.
  3336             20  CF-MORT-TABLE              PIC X(5).
  3337             20  CF-MORT-TABLE-TYPE         PIC X.
  3338                 88  CF-MORT-JOINT              VALUE 'J'.
  3339                 88  CF-MORT-SINGLE             VALUE 'S'.
  3340                 88  CF-MORT-COMBINED           VALUE 'C'.
  3341                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3342                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3343             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3344             20  CF-MORT-AGE-METHOD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  60
* EL6316.cbl
  3345                 88  CF-AGE-LAST                VALUE 'AL'.
  3346                 88  CF-AGE-NEAR                VALUE 'AN'.
  3347             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3348             20  CF-MORT-ADJUSTMENT-DIRECTION
  3349                                            PIC X.
  3350                 88  CF-MINUS                   VALUE '-'.
  3351                 88  CF-PLUS                    VALUE '+'.
  3352             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3353             20  CF-MORT-JOINT-CODE         PIC X.
  3354                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3355             20  CF-MORT-PC-Q               PIC X.
  3356                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3357             20  CF-MORT-TABLE-CODE         PIC X(4).
  3358             20  CF-MORT-COMMENTS           PIC X(15).
  3359             20  FILLER                     PIC X(14).
  3360
  3361         16  FILLER                         PIC X(251).
  3362
  3363
  3364****************************************************************
  3365*             BUSSINESS TYPE MASTER RECORD                     *
  3366****************************************************************
  3367
  3368     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3369* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3370* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3371* AND RECORD 05 IS TYPES 81-99
  3372         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3373             20  CF-BUSINESS-TITLE          PIC  X(19).
  3374             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3375                                            PIC S9V9(4) COMP-3.
  3376             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3377             20  FILLER                     PIC  X.
  3378         16  FILLER                         PIC  X(248).
  3379
  3380
  3381****************************************************************
  3382*             TERMINAL MASTER RECORD                           *
  3383****************************************************************
  3384
  3385     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3386
  3387         16  CF-COMPANY-TERMINALS.
  3388             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3389                                  PIC X(4).
  3390         16  FILLER               PIC X(248).
  3391
  3392
  3393****************************************************************
  3394*             LIFE EDIT MASTER RECORD                          *
  3395****************************************************************
  3396
  3397     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3398         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3399             20  CF-LIFE-CODE-IN            PIC XX.
  3400             20  CF-LIFE-CODE-OUT           PIC XX.
  3401         16  FILLER                         PIC X(248).
  3402
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  61
* EL6316.cbl
  3403
  3404****************************************************************
  3405*             AH EDIT MASTER RECORD                            *
  3406****************************************************************
  3407
  3408     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3409         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3410             20  CF-AH-CODE-IN              PIC XXX.
  3411             20  CF-AH-CODE-OUT             PIC XX.
  3412         16  FILLER                         PIC X(248).
  3413
  3414
  3415****************************************************************
  3416*             CREDIBILITY TABLES                               *
  3417****************************************************************
  3418
  3419     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3420         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3421                             INDEXED BY CF-CRDB-NDX.
  3422             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3423             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3424             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3425         16  FILLER                         PIC  X(332).
  3426
  3427
  3428****************************************************************
  3429*             REPORT CUSTOMIZATION RECORD                      *
  3430****************************************************************
  3431
  3432     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3433         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3434             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3435             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3436             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3437**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3438****       A T-TRANSFER.                                   ****
  3439             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3440
  3441         16  FILLER                         PIC XX.
  3442
  3443         16  CF-CARRIER-CNTL-OPT.
  3444             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3445                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3446                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3447             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3448                                            PIC X.
  3449         16  CF-GROUP-CNTL-OPT.
  3450             20  CF-GROUP-OPT-SEQ           PIC 9.
  3451                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3452                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3453             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3454                                            PIC X(6).
  3455         16  CF-STATE-CNTL-OPT.
  3456             20  CF-STATE-OPT-SEQ           PIC 9.
  3457                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3458                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3459             20  CF-STATE-SELECT OCCURS 3 TIMES
  3460                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  62
* EL6316.cbl
  3461         16  CF-ACCOUNT-CNTL-OPT.
  3462             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3463                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3464                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3465             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3466                                            PIC X(10).
  3467         16  CF-BUS-TYP-CNTL-OPT.
  3468             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3469                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3470                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3471             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3472                                            PIC XX.
  3473         16  CF-LF-TYP-CNTL-OPT.
  3474             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3475                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3476                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3477             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3478                                            PIC XX.
  3479         16  CF-AH-TYP-CNTL-OPT.
  3480             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3481                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3482                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3483             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3484                                            PIC XX.
  3485         16  CF-REPTCD1-CNTL-OPT.
  3486             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3487                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3488                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3489             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3490                                            PIC X(10).
  3491         16  CF-REPTCD2-CNTL-OPT.
  3492             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3493                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3494                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3495             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3496                                            PIC X(10).
  3497         16  CF-USER1-CNTL-OPT.
  3498             20  CF-USER1-OPT-SEQ           PIC 9.
  3499                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3500                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3501             20  CF-USER1-SELECT OCCURS 3 TIMES
  3502                                            PIC X(10).
  3503         16  CF-USER2-CNTL-OPT.
  3504             20  CF-USER2-OPT-SEQ           PIC 9.
  3505                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3506                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3507             20  CF-USER2-SELECT OCCURS 3 TIMES
  3508                                            PIC X(10).
  3509         16  CF-USER3-CNTL-OPT.
  3510             20  CF-USER3-OPT-SEQ           PIC 9.
  3511                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3512                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3513             20  CF-USER3-SELECT OCCURS 3 TIMES
  3514                                            PIC X(10).
  3515         16  CF-USER4-CNTL-OPT.
  3516             20  CF-USER4-OPT-SEQ           PIC 9.
  3517                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3518                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  63
* EL6316.cbl
  3519             20  CF-USER4-SELECT OCCURS 3 TIMES
  3520                                            PIC X(10).
  3521         16  CF-USER5-CNTL-OPT.
  3522             20  CF-USER5-OPT-SEQ           PIC 9.
  3523                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3524                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3525             20  CF-USER5-SELECT OCCURS 3 TIMES
  3526                                            PIC X(10).
  3527         16  CF-REINS-CNTL-OPT.
  3528             20  CF-REINS-OPT-SEQ           PIC 9.
  3529                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3530                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3531             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3532                 24  CF-REINS-PRIME         PIC XXX.
  3533                 24  CF-REINS-SUB           PIC XXX.
  3534
  3535         16  CF-AGENT-CNTL-OPT.
  3536             20  CF-AGENT-OPT-SEQ           PIC 9.
  3537                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3538                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3539             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3540                                            PIC X(10).
  3541
  3542         16  FILLER                         PIC X(43).
  3543
  3544         16  CF-LOSS-RATIO-SELECT.
  3545             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3546             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3547         16  CF-ENTRY-DATE-SELECT.
  3548             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3549             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3550         16  CF-EFFECTIVE-DATE-SELECT.
  3551             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3552             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3553
  3554         16  CF-EXCEPTION-LIST-IND          PIC X.
  3555             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3556
  3557         16  FILLER                         PIC X(318).
  3558
  3559****************************************************************
  3560*                  EXCEPTION REPORTING RECORD                  *
  3561****************************************************************
  3562
  3563     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3564         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3565             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3566
  3567         16  CF-COMBINED-LIFE-AH-OPT.
  3568             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3569             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3570             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3571             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3572
  3573         16  CF-LIFE-OPT.
  3574             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3575             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3576             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  64
* EL6316.cbl
  3577             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3578             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3579             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3580             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3581             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3582             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3583             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3584
  3585         16  CF-AH-OPT.
  3586             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3587             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3588             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3589             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3590             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3591             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3592             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3593             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3594             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3595             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3596
  3597         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3598             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3599             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3600             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3601
  3602         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3603
  3604         16  FILLER                         PIC X(673).
  3605
  3606
  3607****************************************************************
  3608*             MORTGAGE SYSTEM PLAN RECORD                      *
  3609****************************************************************
  3610
  3611     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3612         16  CF-PLAN-TYPE                   PIC X.
  3613             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3614             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3615             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3616         16  CF-PLAN-ABBREV                 PIC XXX.
  3617         16  CF-PLAN-DESCRIPT               PIC X(10).
  3618         16  CF-PLAN-NOTES                  PIC X(20).
  3619         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3620         16  CF-PLAN-UNDERWRITING.
  3621             20  CF-PLAN-TERM-DATA.
  3622                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3623                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3624             20  CF-PLAN-AGE-DATA.
  3625                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3626                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3627                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3628             20  CF-PLAN-BENEFIT-DATA.
  3629                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3630                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3631                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3632                                            PIC S9(7)V99  COMP-3.
  3633         16  CF-PLAN-POLICY-FORMS.
  3634             20  CF-POLICY-FORM             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  65
* EL6316.cbl
  3635             20  CF-MASTER-APPLICATION      PIC X(12).
  3636             20  CF-MASTER-POLICY           PIC X(12).
  3637         16  CF-PLAN-RATING.
  3638             20  CF-RATE-CODE               PIC X(5).
  3639             20  CF-SEX-RATING              PIC X.
  3640                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3641                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3642             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3643             20  CF-SUB-STD-TYPE            PIC X.
  3644                 88  CF-PCT-OF-PREM            VALUE '1'.
  3645                 88  CF-PCT-OF-BENE            VALUE '2'.
  3646         16  CF-PLAN-PREM-TOLERANCES.
  3647             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3648             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3649         16  CF-PLAN-PYMT-TOLERANCES.
  3650             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3651             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3652         16  CF-PLAN-MISC-DATA.
  3653             20  FILLER                     PIC X.
  3654             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3655             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3656         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3657         16  CF-PLAN-IND-GRP                PIC X.
  3658             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3659                                                     '1'.
  3660             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3661                                                     '2'.
  3662         16  CF-MIB-SEARCH-SW               PIC X.
  3663             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3664             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3665             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3666             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3667         16  CF-ALPHA-SEARCH-SW             PIC X.
  3668             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3669             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3670             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3671             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3672             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3673             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3674             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3675             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3676             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3677             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3678                                                     'A' 'B' 'C'
  3679                                                     'X' 'Y' 'Z'.
  3680         16  CF-EFF-DT-RULE-SW              PIC X.
  3681             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3682             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3683             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3684             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3685             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3686         16  FILLER                         PIC X(4).
  3687         16  CF-HEALTH-QUESTIONS            PIC X.
  3688             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3689         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3690         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3691         16  CF-PLAN-SNGL-JNT               PIC X.
  3692             88  CF-COMBINED-PLAN              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  66
* EL6316.cbl
  3693             88  CF-JNT-PLAN                   VALUE 'J'.
  3694             88  CF-SNGL-PLAN                  VALUE 'S'.
  3695         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3696         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3697         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3698         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3699         16  CF-RERATE-CNTL                 PIC  X.
  3700             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3701             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3702             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3703             88  CF-AUTO-RECALC                 VALUE '4'.
  3704         16  CF-BENEFIT-TYPE                PIC  X.
  3705             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3706             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3707         16  CF-POLICY-FEE                  PIC S999V99
  3708                                                    COMP-3.
  3709         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3710         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3711         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3712         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3713         16  FILLER                         PIC  X(32).
  3714         16  CF-TERMINATION-FORM            PIC  X(04).
  3715         16  FILLER                         PIC  X(08).
  3716         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3717                                                       COMP-3.
  3718         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3719         16  CF-ISSUE-LETTER                PIC  X(4).
  3720         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3721         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3722             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3723             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3724         16  CF-MP-REFUND-CALC              PIC X.
  3725             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3726             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3727             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3728             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3729             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3730             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3731             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3732             88  CF-MP-REFD-MEAN                VALUE '8'.
  3733         16  CF-ALT-RATE-CODE               PIC  X(5).
  3734
  3735
  3736         16  FILLER                         PIC X(498).
  3737****************************************************************
  3738*             MORTGAGE COMPANY MASTER RECORD                   *
  3739****************************************************************
  3740
  3741     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3742         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3743         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3744             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3745             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3746             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3747             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3748             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3749
  3750         16  CF-MORTG-CONVERSION-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  67
* EL6316.cbl
  3751         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3752         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3753         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3754         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3755
  3756         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3757             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3758         16  CF-MP-RECON-USE-IND            PIC X(1).
  3759             88  CF-MP-USE-RECON             VALUE 'Y'.
  3760         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3761             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3762         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3763             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3764             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3765         16  FILLER                         PIC X(1).
  3766         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3767             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3768         16  CF-MORTG-MIB-VERSION           PIC X.
  3769             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3770             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3771             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3772         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3773             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3774                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3775             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3776                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3777             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3778                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3779             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3780                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3781             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3782                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3783             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3784                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3785         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3786         16  FILLER                         PIC X(7).
  3787         16  CF-MORTG-DESTINATION-SYMBOL.
  3788             20  CF-MORTG-MIB-COMM          PIC X(5).
  3789             20  CF-MORTG-MIB-TERM          PIC X(5).
  3790         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3791             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3792         16  FILLER                         PIC X(03).
  3793         16  CF-MP-CHECK-NO-CONTROL.
  3794             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3795                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3796                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3797                                                ' ' LOW-VALUES.
  3798                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3799                                               VALUE '3'.
  3800         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3801         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3802         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3803             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3804                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3805             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3806                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3807             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3808                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  68
* EL6316.cbl
  3809             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3810                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3811             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3812                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3813             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3814                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3815         16  CF-MORTG-BILLING-AREA.
  3816             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3817                                            PIC X.
  3818         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3819         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3820         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3821         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3822             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3823             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3824         16  FILLER                         PIC X.
  3825         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3826             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3827             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3828         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3829         16  FILLER                         PIC X(8).
  3830         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3831         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3832         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3833         16  CF-ACH-COMPANY-ID.
  3834             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3835                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3836                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3837                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3838             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3839         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3840             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3841         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3842             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3843             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3844         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3845         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3846         16  FILLER                         PIC X(536).
  3847
  3848****************************************************************
  3849*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3850****************************************************************
  3851
  3852     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3853         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3854             20  CF-FEMALE-HEIGHT.
  3855                 24  CF-FEMALE-FT           PIC 99.
  3856                 24  CF-FEMALE-IN           PIC 99.
  3857             20  CF-FEMALE-MIN-WT           PIC 999.
  3858             20  CF-FEMALE-MAX-WT           PIC 999.
  3859         16  FILLER                         PIC X(428).
  3860
  3861     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3862         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3863             20  CF-MALE-HEIGHT.
  3864                 24  CF-MALE-FT             PIC 99.
  3865                 24  CF-MALE-IN             PIC 99.
  3866             20  CF-MALE-MIN-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  69
* EL6316.cbl
  3867             20  CF-MALE-MAX-WT             PIC 999.
  3868         16  FILLER                         PIC X(428).
  3869******************************************************************
  3870*             AUTOMATIC ACTIVITY RECORD                          *
  3871******************************************************************
  3872     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3873         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3874             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3875             20  CF-SYS-LETTER-ID           PIC X(04).
  3876             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3877             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3878             20  CF-SYS-RESET-SW            PIC X(01).
  3879             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3880             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3881
  3882         16  FILLER                         PIC X(50).
  3883
  3884         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3885             20  CF-USER-ACTIVE-SW          PIC X(01).
  3886             20  CF-USER-LETTER-ID          PIC X(04).
  3887             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3888             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3889             20  CF-USER-RESET-SW           PIC X(01).
  3890             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3891             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3892             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3893
  3894         16  FILLER                         PIC X(246).
  3895*                                COPY ERCPNDB.
  3896******************************************************************
  3897*                                                                *
  3898*                                                                *
  3899*                            ERCPNDB.                            *
  3900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3901*                            VMOD=2.025                          *
  3902*                                                                *
  3903*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3904*                                                                *
  3905******************************************************************
  3906*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3907*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3908******************************************************************
  3909*                                                                *
  3910*                                                                *
  3911*   FILE TYPE = VSAM,KSDS                                        *
  3912*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3913*                                                                *
  3914*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3915*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3916*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3917*                                                 RKP=13,LEN=36  *
  3918*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3919*                                      AND CHG-SEQ.)             *
  3920*                                                RKP=49,LEN=11   *
  3921*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3922*                                      AND CHG-SEQ.)             *
  3923*                                                RKP=60,LEN=15   *
  3924*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  70
* EL6316.cbl
  3925*   LOG = NO                                                     *
  3926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3927******************************************************************
  3928******************************************************************
  3929*                   C H A N G E   L O G
  3930*
  3931* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3932*-----------------------------------------------------------------
  3933*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3934* EFFECTIVE    NUMBER
  3935*-----------------------------------------------------------------
  3936* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3937* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3938* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3939* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3940* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3941* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3942* 032306                   PEMA  ADD BOW LOAN NUMBER
  3943* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3944* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3945* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3946* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3947* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3948* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3949* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3950* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3951******************************************************************
  3952
  3953 01  PENDING-BUSINESS.
  3954     12  PB-RECORD-ID                     PIC XX.
  3955         88  VALID-PB-ID                        VALUE 'PB'.
  3956
  3957     12  PB-CONTROL-PRIMARY.
  3958         16  PB-COMPANY-CD                PIC X.
  3959         16  PB-ENTRY-BATCH               PIC X(6).
  3960         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3961         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3962
  3963     12  PB-CONTROL-BY-ACCOUNT.
  3964         16  PB-COMPANY-CD-A1             PIC X.
  3965         16  PB-CARRIER                   PIC X.
  3966         16  PB-GROUPING.
  3967             20  PB-GROUPING-PREFIX       PIC XXX.
  3968             20  PB-GROUPING-PRIME        PIC XXX.
  3969         16  PB-STATE                     PIC XX.
  3970         16  PB-ACCOUNT.
  3971             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3972             20  PB-ACCOUNT-PRIME         PIC X(6).
  3973         16  PB-CERT-EFF-DT               PIC XX.
  3974         16  PB-CERT-NO.
  3975             20  PB-CERT-PRIME            PIC X(10).
  3976             20  PB-CERT-SFX              PIC X.
  3977         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3978
  3979         16  PB-RECORD-TYPE               PIC X.
  3980             88  PB-MAILING-DATA                VALUE '0'.
  3981             88  PB-ISSUE                       VALUE '1'.
  3982             88  PB-CANCELLATION                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  71
* EL6316.cbl
  3983             88  PB-BATCH-TRAILER               VALUE '9'.
  3984
  3985     12  PB-CONTROL-BY-ORIG-BATCH.
  3986         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3987         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3988         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3989         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3990
  3991     12  PB-CONTROL-BY-CSR.
  3992         16  PB-CSR-COMPANY-CD            PIC X.
  3993         16  PB-CSR-ID                    PIC X(4).
  3994         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3995         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3996         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3997******************************************************************
  3998*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3999******************************************************************
  4000
  4001     12  PB-LAST-MAINT-DT                 PIC XX.
  4002     12  PB-LAST-MAINT-BY                 PIC X(4).
  4003     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4004
  4005     12  PB-RECORD-BODY                   PIC X(375).
  4006
  4007     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4008         16  PB-CERT-ORIGIN               PIC X.
  4009             88  CLASIC-CREATED-CERT         VALUE '1'.
  4010         16  PB-I-NAME.
  4011             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4012             20  PB-I-INSURED-FIRST-NAME.
  4013                 24  PB-I-INSURED-1ST-INIT PIC X.
  4014                 24  FILLER                PIC X(9).
  4015             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4016         16  PB-I-AGE                     PIC S99   COMP-3.
  4017         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4018         16  PB-I-BIRTHDAY                PIC XX.
  4019         16  PB-I-INSURED-SEX             PIC X.
  4020             88  PB-SEX-MALE     VALUE 'M'.
  4021             88  PB-SEX-FEMALE   VALUE 'F'.
  4022
  4023         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4024         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4025         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4026         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4027         16  PB-I-SKIP-CODE               PIC X.
  4028             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4029             88  PB-SKIP-JULY              VALUE '1'.
  4030             88  PB-SKIP-AUGUST            VALUE '2'.
  4031             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4032             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4033             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4034             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4035             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4036             88  PB-SKIP-JUNE              VALUE '8'.
  4037             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4038             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4039             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4040         16  PB-I-TERM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  72
* EL6316.cbl
  4041             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4042             88  PB-PAID-WEEKLY            VALUE 'W'.
  4043             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4044             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4045             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4046         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4047         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4048         16  PB-I-DATA-ENTRY-SW           PIC X.
  4049             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4050             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4051             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4052             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4053         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4054         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4055*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4056         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4057         16  FILLER                       PIC X.
  4058
  4059         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4060             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4061             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4062                                                   '90' THRU '99'.
  4063         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4064                                          PIC XX.
  4065         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4066         16  PB-I-AMOUNT-FINANCED REDEFINES
  4067                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4068         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4069         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4070                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4071         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4072         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4073         16  PB-I-CLP-AMOUNT REDEFINES
  4074                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4075         16  PB-I-LF-CALC-FLAG            PIC X.
  4076             88 PB-COMP-LF-PREM               VALUE '?'.
  4077         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4078         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4079         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4080         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4081         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4082         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4083         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4084         16  PB-I-LF-ABBR                 PIC XXX.
  4085         16  PB-I-LF-INPUT-CD             PIC XX.
  4086
  4087         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4088             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4089             88  PB-INVALID-AH               VALUE '  ' '00'
  4090                                                   '90' THRU '99'.
  4091         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4092         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4093         16  PB-I-AH-CALC-FLAG            PIC X.
  4094             88 PB-COMP-AH-PREM                  VALUE '?'.
  4095         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4096         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4097         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4098         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  73
* EL6316.cbl
  4099         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4100         16  PB-I-AH-ABBR                 PIC XXX.
  4101         16  PB-I-AH-INPUT-CD             PIC XXX.
  4102
  4103         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4104         16  PB-I-REIN-TABLE              PIC XXX.
  4105         16  PB-I-BUSINESS-TYPE           PIC 99.
  4106         16  PB-I-INDV-GRP-CD             PIC X.
  4107         16  PB-I-MORT-CODE.
  4108             20  PB-I-TABLE               PIC X.
  4109             20  PB-I-INTEREST            PIC XX.
  4110             20  PB-I-MORT-TYP            PIC X.
  4111         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4112         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4113         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4114         16  PB-I-INDV-GRP-OVRD           PIC X.
  4115         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4116         16  PB-I-SIG-SW                  PIC X.
  4117             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4118         16  PB-I-RATE-CLASS              PIC XX.
  4119         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4120         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4121         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4122         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4123         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4124         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4125         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4126         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4127         16  PB-I-OB-FLAG                 PIC X.
  4128             88  PB-I-OB                      VALUE 'B'.
  4129             88  PB-I-SUMMARY                 VALUE 'Z'.
  4130         16  PB-I-ENTRY-STATUS            PIC X.
  4131             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4132                                              'M' '5' '9' '2'.
  4133             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4134             88  PB-I-POLICY-PENDING          VALUE '2'.
  4135             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4136             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4137             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4138             88  PB-I-REIN-ONLY               VALUE '9'.
  4139             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4140             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4141             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4142             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4143         16  PB-I-INT-CODE                PIC X.
  4144             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4145             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4146         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4147         16  PB-I-SOC-SEC-NO              PIC X(11).
  4148         16  PB-I-MEMBER-NO               PIC X(12).
  4149         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4150*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4151         16  PB-I-OLD-LOF                 PIC XXX.
  4152         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4153         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4154         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4155         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4156         16  PB-I-LIFE-INDICATOR          PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  74
* EL6316.cbl
  4157             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4158         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4159         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4160                                          PIC S9(5)V99    COMP-3.
  4161         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4162             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4163             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4164         16  PB-I-1ST-PMT-DT              PIC XX.
  4165         16  PB-I-JOINT-INSURED.
  4166             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4167             20 PB-I-JOINT-FIRST-NAME.
  4168                24  PB-I-JOINT-FIRST-INIT PIC X.
  4169                24  FILLER                PIC X(9).
  4170             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4171*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4172         16  PB-I-BENEFICIARY-NAME.
  4173             20  PB-I-BANK-NUMBER         PIC X(10).
  4174             20  FILLER                   PIC X(15).
  4175         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4176         16  PB-I-REFERENCE               PIC X(12).
  4177         16  FILLER REDEFINES PB-I-REFERENCE.
  4178             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4179             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4180             20  PB-I-CLP-STATE           PIC XX.
  4181         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4182             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4183             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4184             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4185         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4186         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4187         16  PB-I-RESIDENT-STATE          PIC XX.
  4188         16  PB-I-RATE-CODE               PIC X(4).
  4189         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4190         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4191         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4192         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4193         16  PB-I-BANK-NOCHRGB            PIC 99.
  4194         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4195         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4196
  4197     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4198         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4199             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4200         16  PB-C-CANCEL-ORIGIN           PIC X.
  4201             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4202         16  PB-C-LF-CANCEL-DT            PIC XX.
  4203         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4204         16  PB-C-LF-CALC-REQ             PIC X.
  4205             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4206         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4207         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4208         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4209             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4210         16  PB-C-AH-CANCEL-DT            PIC XX.
  4211         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4212         16  PB-C-AH-CALC-REQ             PIC X.
  4213             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4214         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  75
* EL6316.cbl
  4215         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4216         16  PB-C-LAST-NAME               PIC X(15).
  4217         16  PB-C-REFUND-SW               PIC X.
  4218             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4219             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4220         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4221         16  PB-C-PAYEE-CODE              PIC X(6).
  4222         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4223         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4224         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4225         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4226         16  PB-C-REFERENCE               PIC X(12).
  4227         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4228         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4229         16  PB-C-POST-CARD-IND           PIC X.
  4230         16  PB-C-CANCEL-REASON           PIC X.
  4231         16  PB-C-REF-INTERFACE-SW        PIC X.
  4232         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4233         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4234         16  FILLER                       PIC X(01).
  4235*        16  FILLER                       PIC X(18).
  4236         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4237*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4238         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4239         16  PB-CANCELED-CERT-DATA.
  4240             20  PB-CI-INSURED-NAME.
  4241                 24  PB-CI-LAST-NAME      PIC X(15).
  4242                 24  PB-CI-INITIALS       PIC XX.
  4243             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4244             20  PB-CI-INSURED-SEX        PIC X.
  4245             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4246             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4247             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4248             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4249             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4250             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4251             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4252             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4253             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4254             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4255             20  PB-CI-RATE-CLASS         PIC XX.
  4256             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4257             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4258             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4259             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4260             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4261             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4262             20  PB-CI-LF-ABBR            PIC X(3).
  4263             20  PB-CI-AH-ABBR            PIC X(3).
  4264             20  PB-CI-OB-FLAG            PIC X.
  4265                 88  PB-CI-OB                VALUE 'B'.
  4266             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4267                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4268                                           'M' '4' '5' '9' '2'.
  4269                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4270                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4271                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4272                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  76
* EL6316.cbl
  4273                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4274                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4275                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4276                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4277                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4278                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4279                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4280                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4281             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4282                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4283                                           'M' '4' '5' '9' '2'.
  4284                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4285                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4286                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4287                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4288                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4289                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4290                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4291                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4292                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4293                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4294                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4295                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4296             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4297             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4298             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4299             20  PB-CI-MEMBER-NO          PIC X(12).
  4300             20  PB-CI-INT-CODE           PIC X.
  4301                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4302                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4303             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4304             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4305             20  PB-CI-COMP-EXCP-SW       PIC X.
  4306                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4307                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4308             20  PB-CI-ENTRY-STATUS       PIC X.
  4309             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4310             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4311             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4312             20  PB-CI-DEATH-DT           PIC XX.
  4313             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4314             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4315             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4316             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4317             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4318             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4319             20  PB-CI-ENTRY-DT              PIC XX.
  4320             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4321             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4322             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4323             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4324             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4325             20  PB-CI-OLD-LOF               PIC XXX.
  4326*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4327             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4328             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4329             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4330             20  PB-CI-INDV-GRP-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  77
* EL6316.cbl
  4331             20  PB-CI-BENEFICIARY-NAME.
  4332                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4333                 24  FILLER                  PIC X(15).
  4334             20  PB-CI-NOTE-SW               PIC X.
  4335             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4336             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4337             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4338             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4339             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4340             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4341             20  PB-CI-FIRST-NAME            PIC X(10).
  4342             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4343
  4344         16  FILLER                       PIC X(13).
  4345*032306  16  FILLER                       PIC X(27).
  4346*        16  FILLER                       PIC X(46).
  4347
  4348     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4349         16  FILLER                       PIC X(10).
  4350         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4351         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4352         16  PB-M-INSURED-MID-INIT        PIC X.
  4353         16  PB-M-INSURED-AGE             PIC 99.
  4354         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4355         16  PB-M-INSURED-SEX             PIC X.
  4356         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4357         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4358         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4359         16  PB-M-INSURED-CITY-STATE.
  4360             20  PB-M-INSURED-CITY        PIC X(28).
  4361             20  PB-M-INSURED-STATE       PIC XX.
  4362         16  PB-M-INSURED-ZIP-CODE.
  4363             20  PB-M-INSURED-ZIP-PRIME.
  4364                 24  PB-M-INSURED-ZIP-1   PIC X.
  4365                     88  PB-M-CANADIAN-POST-CODE
  4366                                             VALUE 'A' THRU 'Z'.
  4367                 24  FILLER               PIC X(4).
  4368             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4369         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4370                                        PB-M-INSURED-ZIP-CODE.
  4371             20  PM-M-INS-CAN-POST1       PIC XXX.
  4372             20  PM-M-INS-CAN-POST2       PIC XXX.
  4373             20  FILLER                   PIC XXX.
  4374         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4375         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4376         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4377         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4378         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4379         16  PB-M-CRED-BENE-CITYST.
  4380             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4381             20  PB-M-CRED-BENE-STATE     PIC XX.
  4382         16  FILLER                       PIC X(92).
  4383
  4384     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4385         16  FILLER                       PIC X(10).
  4386         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4387         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4388         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  78
* EL6316.cbl
  4389         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4390         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4391         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4392         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4393         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4394         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4395         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4396         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4397         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4398         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4399         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4400         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4401         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4402         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4403         16  PB-ACCOUNT-NAME              PIC X(30).
  4404         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4405         16  PB-REFERENCE                 PIC X(12).
  4406         16  PB-B-RECEIVED-DT             PIC XX.
  4407         16  FILLER                       PIC X(234).
  4408
  4409     12  PB-RECORD-STATUS.
  4410         16  PB-CREDIT-SELECT-DT          PIC XX.
  4411         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4412         16  PB-BILLED-DT                 PIC XX.
  4413         16  PB-BILLING-STATUS            PIC X.
  4414             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4415             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4416             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4417         16  PB-RECORD-BILL               PIC X.
  4418             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4419             88  PB-RECORD-RETURNED           VALUE 'R'.
  4420             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4421             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4422             88  PB-OVERRIDE-AH               VALUE 'A'.
  4423             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4424         16  PB-BATCH-ENTRY               PIC X.
  4425             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4426             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4427             88  PB-REISSUED-CERT             VALUE 'E'.
  4428             88  PB-MONTHLY-CERT              VALUE 'M'.
  4429             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4430             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4431             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4432         16  PB-FORCE-CODE                PIC X.
  4433             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4434             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4435             88  PB-CANCEL-FORCE              VALUE '8'.
  4436             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4437             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4438             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4439             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4440             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4441             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4442             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4443         16  PB-FATAL-FLAG                PIC X.
  4444             88  PB-FATAL-ERRORS              VALUE 'X'.
  4445         16  PB-FORCE-ER-CD               PIC X.
  4446             88  PB-FORCE-ERRORS              VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  79
* EL6316.cbl
  4447             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4448         16  PB-WARN-ER-CD                PIC X.
  4449             88  PB-WARNING-ERRORS            VALUE 'W'.
  4450         16  FILLER                       PIC X.
  4451         16  PB-OUT-BAL-CD                PIC X.
  4452             88  PB-OUT-OF-BAL                VALUE 'O'.
  4453         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4454         16  PB-AH-OVERRIDE-L1            PIC X.
  4455         16  PB-INPUT-DT                  PIC XX.
  4456         16  PB-INPUT-BY                  PIC X(4).
  4457         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4458         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4459         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4460         16  PB-LF-EARNING-METHOD         PIC X.
  4461         16  PB-AH-EARNING-METHOD         PIC X.
  4462         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4463         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4464         16  PB-REIN-CD                   PIC XXX.
  4465         16  PB-LF-REFUND-TYPE            PIC X.
  4466         16  PB-AH-REFUND-TYPE            PIC X.
  4467         16  PB-ACCT-EFF-DT               PIC XX.
  4468         16  PB-ACCT-EXP-DT               PIC XX.
  4469         16  PB-COMPANY-ID                PIC X(3).
  4470         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4471         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4472         16  PB-SV-CARRIER                PIC X.
  4473         16  PB-SV-GROUPING               PIC X(6).
  4474         16  PB-SV-STATE                  PIC XX.
  4475         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4476         16  PB-GA-BILLING-INFO.
  4477             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4478                                          PIC XX.
  4479         16  PB-SV-REMIT-TO  REDEFINES
  4480             PB-GA-BILLING-INFO           PIC X(10).
  4481         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4482         16  PB-I-LOAN-OFFICER            PIC X(5).
  4483         16  PB-I-VIN                     PIC X(17).
  4484
  4485         16  FILLER                       PIC X(04).
  4486         16  IMNET-BYPASS-SW              PIC X.
  4487
  4488******************************************************************
  4489*                COMMON EDIT ERRORS                              *
  4490******************************************************************
  4491
  4492     12  PB-COMMON-ERRORS.
  4493         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4494                                           PIC S9(4)     COMP.
  4495
  4496******************************************************************
  4497*                                COPY ELCCERT.
  4498******************************************************************
  4499*                                                                *
  4500*                            ELCCERT.                            *
  4501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4502*                            VMOD=2.013                          *
  4503*                                                                *
  4504*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  80
* EL6316.cbl
  4505*                                                                *
  4506*   FILE TYPE = VSAM,KSDS                                        *
  4507*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4508*                                                                *
  4509*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4510*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4511*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4512*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4513*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4514*                                                                *
  4515*   LOG = YES                                                    *
  4516*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4517******************************************************************
  4518*                   C H A N G E   L O G
  4519*
  4520* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4521*-----------------------------------------------------------------
  4522*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4523* EFFECTIVE    NUMBER
  4524*-----------------------------------------------------------------
  4525* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4526* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4527* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4528* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4529* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4530* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4531* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4532* 032612  CR2011110200001  PEMA  AHL CHANGES
  4533******************************************************************
  4534
  4535 01  CERTIFICATE-MASTER.
  4536     12  CM-RECORD-ID                      PIC XX.
  4537         88  VALID-CM-ID                      VALUE 'CM'.
  4538
  4539     12  CM-CONTROL-PRIMARY.
  4540         16  CM-COMPANY-CD                 PIC X.
  4541         16  CM-CARRIER                    PIC X.
  4542         16  CM-GROUPING.
  4543             20  CM-GROUPING-PREFIX        PIC X(3).
  4544             20  CM-GROUPING-PRIME         PIC X(3).
  4545         16  CM-STATE                      PIC XX.
  4546         16  CM-ACCOUNT.
  4547             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4548             20  CM-ACCOUNT-PRIME          PIC X(6).
  4549         16  CM-CERT-EFF-DT                PIC XX.
  4550         16  CM-CERT-NO.
  4551             20  CM-CERT-PRIME             PIC X(10).
  4552             20  CM-CERT-SFX               PIC X.
  4553
  4554     12  CM-CONTROL-BY-NAME.
  4555         16  CM-COMPANY-CD-A1              PIC X.
  4556         16  CM-INSURED-LAST-NAME          PIC X(15).
  4557         16  CM-INSURED-INITIALS.
  4558             20  CM-INSURED-INITIAL1       PIC X.
  4559             20  CM-INSURED-INITIAL2       PIC X.
  4560
  4561     12  CM-CONTROL-BY-SSN.
  4562         16  CM-COMPANY-CD-A2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  81
* EL6316.cbl
  4563         16  CM-SOC-SEC-NO.
  4564             20  CM-SSN-STATE              PIC XX.
  4565             20  CM-SSN-ACCOUNT            PIC X(6).
  4566             20  CM-SSN-LN3.
  4567                 25  CM-INSURED-INITIALS-A2.
  4568                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4569                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4570                 25 CM-PART-LAST-NAME-A2         PIC X.
  4571
  4572     12  CM-CONTROL-BY-CERT-NO.
  4573         16  CM-COMPANY-CD-A4              PIC X.
  4574         16  CM-CERT-NO-A4                 PIC X(11).
  4575
  4576     12  CM-CONTROL-BY-MEMB.
  4577         16  CM-COMPANY-CD-A5              PIC X.
  4578         16  CM-MEMBER-NO.
  4579             20  CM-MEMB-STATE             PIC XX.
  4580             20  CM-MEMB-ACCOUNT           PIC X(6).
  4581             20  CM-MEMB-LN4.
  4582                 25  CM-INSURED-INITIALS-A5.
  4583                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4584                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4585                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4586
  4587     12  CM-INSURED-PROFILE-DATA.
  4588         16  CM-INSURED-FIRST-NAME.
  4589             20  CM-INSURED-1ST-INIT       PIC X.
  4590             20  FILLER                    PIC X(9).
  4591         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4592         16  CM-INSURED-SEX                PIC X.
  4593             88  CM-SEX-MALE                  VALUE 'M'.
  4594             88  CM-SEX-FEMAL                 VALUE 'F'.
  4595         16  CM-INSURED-JOINT-AGE          PIC 99.
  4596         16  CM-JOINT-INSURED-NAME.
  4597             20  CM-JT-LAST-NAME           PIC X(15).
  4598             20  CM-JT-FIRST-NAME.
  4599                 24  CM-JT-1ST-INIT        PIC X.
  4600                 24  FILLER                PIC X(9).
  4601             20  CM-JT-INITIAL             PIC X.
  4602
  4603     12  CM-LIFE-DATA.
  4604         16  CM-LF-BENEFIT-CD              PIC XX.
  4605         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4606         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4607         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4608         16  CM-LF-DEV-CODE                PIC XXX.
  4609         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4610         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4611         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4612         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4613         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4614         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4615         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4616         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4617         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4618         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4619         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4620         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  82
* EL6316.cbl
  4621         16  FILLER                        PIC XX.
  4622
  4623     12  CM-AH-DATA.
  4624         16  CM-AH-BENEFIT-CD              PIC XX.
  4625         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4626         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4627         16  CM-AH-DEV-CODE                PIC XXX.
  4628         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4629         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4630         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4631         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4632         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4633         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4634         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4635         16  CM-AH-PAID-THRU-DT            PIC XX.
  4636             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4637         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4638         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4639         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4640         16  FILLER                        PIC X.
  4641
  4642     12  CM-LOAN-INFORMATION.
  4643         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4644         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4645                                           PIC S9(5)V99  COMP-3.
  4646         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4647         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4648         16  CM-PAY-FREQUENCY              PIC S99.
  4649         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4650         16  CM-RATE-CLASS                 PIC XX.
  4651         16  CM-BENEFICIARY                PIC X(25).
  4652         16  CM-POLICY-FORM-NO             PIC X(12).
  4653         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4654         16  CM-LAST-ADD-ON-DT             PIC XX.
  4655         16  CM-DEDUCTIBLE-AMOUNTS.
  4656             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4657             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4658         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4659             20  CM-RESIDENT-STATE         PIC XX.
  4660             20  CM-RATE-CODE              PIC X(4).
  4661             20  FILLER                    PIC XX.
  4662         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4663             20  CM-LOAN-OFFICER           PIC X(5).
  4664             20  FILLER                    PIC XXX.
  4665         16  CM-CSR-CODE                   PIC XXX.
  4666         16  CM-UNDERWRITING-CODE          PIC X.
  4667             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4668         16  CM-POST-CARD-IND              PIC X.
  4669         16  CM-NH-INTERFACE-SW            PIC X.
  4670         16  CM-PREMIUM-TYPE               PIC X.
  4671             88  CM-SING-PRM                  VALUE '1'.
  4672             88  CM-O-B-COVERAGE              VALUE '2'.
  4673             88  CM-OPEN-END                  VALUE '3'.
  4674         16  CM-IND-GRP-TYPE               PIC X.
  4675             88  CM-INDIVIDUAL                VALUE 'I'.
  4676             88  CM-GROUP                     VALUE 'G'.
  4677         16  CM-SKIP-CODE                  PIC X.
  4678             88  NO-MONTHS-SKIPPED            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  83
* EL6316.cbl
  4679             88  SKIP-JULY                    VALUE '1'.
  4680             88  SKIP-AUGUST                  VALUE '2'.
  4681             88  SKIP-SEPTEMBER               VALUE '3'.
  4682             88  SKIP-JULY-AUG                VALUE '4'.
  4683             88  SKIP-AUG-SEPT                VALUE '5'.
  4684             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4685             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4686             88  SKIP-JUNE                    VALUE '8'.
  4687             88  SKIP-JUNE-JULY               VALUE '9'.
  4688             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4689             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4690         16  CM-PAYMENT-MODE               PIC X.
  4691             88  PAY-MONTHLY                  VALUE SPACE.
  4692             88  PAY-WEEKLY                   VALUE '1'.
  4693             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4694             88  PAY-BI-WEEKLY                VALUE '3'.
  4695             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4696         16  CM-LOAN-NUMBER                PIC X(8).
  4697         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4698         16  CM-OLD-LOF                    PIC XXX.
  4699*        16  CM-LOAN-OFFICER               PIC XXX.
  4700         16  CM-REIN-TABLE                 PIC XXX.
  4701         16  CM-SPECIAL-REIN-CODE          PIC X.
  4702         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4703         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4704         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4705
  4706     12  CM-STATUS-DATA.
  4707         16  CM-ENTRY-STATUS               PIC X.
  4708         16  CM-ENTRY-DT                   PIC XX.
  4709
  4710         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4711         16  CM-LF-CANCEL-DT               PIC XX.
  4712         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4713
  4714         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4715         16  CM-LF-DEATH-DT                PIC XX.
  4716         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4717
  4718         16  CM-LF-CURRENT-STATUS          PIC X.
  4719             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4720                                                'M' '4' '5' '9'.
  4721             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4722             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4723             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4724             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4725             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4726             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4727             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4728             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4729             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4730             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4731             88  CM-LF-DECLINED               VALUE 'D'.
  4732             88  CM-LF-VOIDED                 VALUE 'V'.
  4733
  4734         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4735         16  CM-AH-CANCEL-DT               PIC XX.
  4736         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  84
* EL6316.cbl
  4737
  4738         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4739         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4740         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4741
  4742         16  CM-AH-CURRENT-STATUS          PIC X.
  4743             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4744                                                'M' '4' '5' '9'.
  4745             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4746             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4747             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4748             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4749             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4750             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4751             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4752             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4753             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4754             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4755             88  CM-AH-DECLINED               VALUE 'D'.
  4756             88  CM-AH-VOIDED                 VALUE 'V'.
  4757
  4758         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4759             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4760             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4761             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4762         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4763
  4764         16  CM-ENTRY-BATCH                PIC X(6).
  4765         16  CM-LF-EXIT-BATCH              PIC X(6).
  4766         16  CM-AH-EXIT-BATCH              PIC X(6).
  4767         16  CM-LAST-MONTH-END             PIC XX.
  4768
  4769     12  CM-NOTE-SW                        PIC X.
  4770         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4771         88  CERT-NOTES-PRESENT               VALUE '1'.
  4772         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4773         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4774         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4775         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4776         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4777         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4778     12  CM-COMP-EXCP-SW                   PIC X.
  4779         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4780         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4781     12  CM-INSURED-ADDRESS-SW             PIC X.
  4782         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4783         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4784
  4785*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4786     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4787     12  FILLER                            PIC X.
  4788
  4789*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4790     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4791     12  FILLER                            PIC X.
  4792*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4793     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4794
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  85
* EL6316.cbl
  4795     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4796         88  CERT-ADDED-BATCH                 VALUE ' '.
  4797         88  CERT-ADDED-ONLINE                VALUE '1'.
  4798         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4799         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4800         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4801     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4802         88  CERT-AS-LOADED                   VALUE ' '.
  4803         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4804         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4805         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4806         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4807         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4808         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4809         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4810
  4811     12  CM-ACCOUNT-COMM-PCTS.
  4812         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4813         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4814
  4815     12  CM-USER-FIELD                     PIC X.
  4816     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4817     12  CM-CLP-STATE                      PIC XX.
  4818     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4819     12  CM-USER-RESERVED                  PIC XXX.
  4820     12  FILLER REDEFINES CM-USER-RESERVED.
  4821         16  CM-AH-CLASS-CD                PIC XX.
  4822         16  F                             PIC X.
  4823******************************************************************
  4824*                                COPY ELCCRTO.
  4825******************************************************************
  4826*                                                                *
  4827*                            ELCCRTO.                            *
  4828*                                                                *
  4829*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4830*                                                                *
  4831*   FILE TYPE = VSAM,KSDS                                        *
  4832*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4833*                                                                *
  4834*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4835*                                                                *
  4836*   LOG = YES                                                    *
  4837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4838******************************************************************
  4839*                   C H A N G E   L O G
  4840*
  4841* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4842*-----------------------------------------------------------------
  4843*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4844* EFFECTIVE    NUMBER
  4845*-----------------------------------------------------------------
  4846* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4847* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4848* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4849******************************************************************
  4850 01  ORIGINAL-CERTIFICATE.
  4851     12  OC-RECORD-ID                      PIC XX.
  4852         88  VALID-OC-ID                      VALUE 'OC'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  86
* EL6316.cbl
  4853     12  OC-CONTROL-PRIMARY.
  4854         16  OC-COMPANY-CD                 PIC X.
  4855         16  OC-CARRIER                    PIC X.
  4856         16  OC-GROUPING                   PIC X(6).
  4857         16  OC-STATE                      PIC XX.
  4858         16  OC-ACCOUNT                    PIC X(10).
  4859         16  OC-CERT-EFF-DT                PIC XX.
  4860         16  OC-CERT-NO.
  4861             20  OC-CERT-PRIME             PIC X(10).
  4862             20  OC-CERT-SFX               PIC X.
  4863         16  OC-RECORD-TYPE                PIC X.
  4864         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4865     12  OC-LAST-MAINT-DT                  PIC XX.
  4866     12  OC-LAST-MAINT-BY                  PIC X(4).
  4867     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4868     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4869     12  FILLER                            PIC X(49).
  4870     12  OC-ORIG-REC.
  4871         16  OC-INS-LAST-NAME              PIC X(15).
  4872         16  OC-INS-FIRST-NAME             PIC X(10).
  4873         16  OC-INS-MIDDLE-INIT            PIC X.
  4874         16  OC-INS-AGE                    PIC S999     COMP-3.
  4875         16  OC-JNT-LAST-NAME              PIC X(15).
  4876         16  OC-JNT-FIRST-NAME             PIC X(10).
  4877         16  OC-JNT-MIDDLE-INIT            PIC X.
  4878         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4879         16  OC-LF-BENCD                   PIC XX.
  4880         16  OC-LF-TERM                    PIC S999      COMP-3.
  4881         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4882         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4883         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4884         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4885         16  OC-LF-EXP-DT                  PIC XX.
  4886         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4887         16  OC-LF-CANCEL-DT               PIC XX.
  4888         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4889         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4890         16  OC-AH-BENCD                   PIC XX.
  4891         16  OC-AH-TERM                    PIC S999      COMP-3.
  4892         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4893         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4894         16  OC-AH-EXP-DT                  PIC XX.
  4895         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4896         16  OC-AH-CP                      PIC 99.
  4897         16  OC-AH-CANCEL-DT               PIC XX.
  4898         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4899         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4900         16  OC-CRED-BENE-NAME             PIC X(25).
  4901         16  OC-1ST-PMT-DT                 PIC XX.
  4902         16  FILLER                        PIC X(215).
  4903
  4904     12  FILLER                            PIC X(50).
  4905******************************************************************
  4906*                                COPY ERCENDT.
  4907******************************************************************
  4908*                                                                *
  4909*                                                                *
  4910*                            ERCENDT.                            *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  87
* EL6316.cbl
  4911*                            VMOD=2.001                          *
  4912*                                                                *
  4913*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4914*                                                                *
  4915*   FILE TYPE = VSAM,KSDS                                        *
  4916*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4917*                                                                *
  4918*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4919*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4920*                                                                *
  4921*   LOG = NO                                                     *
  4922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4923******************************************************************
  4924*-----------------------------------------------------------------
  4925*                   C H A N G E   L O G
  4926*
  4927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4928*-----------------------------------------------------------------
  4929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4930* EFFECTIVE    NUMBER
  4931*-----------------------------------------------------------------
  4932* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4933*                                WITH OPEN CLAIMS
  4934* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4935* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4936*-----------------------------------------------------------------
  4937 01  ENDORSEMENT-RECORD.
  4938     12  EN-RECORD-ID                PIC XX.
  4939         88  VALID-EN-ID                VALUE 'EN'.
  4940     12  EN-CONTROL-PRIMARY.
  4941         16  EN-COMPANY-CD           PIC X.
  4942         16  EN-CARRIER              PIC X.
  4943         16  EN-GROUPING             PIC X(6).
  4944         16  EN-STATE                PIC XX.
  4945         16  EN-ACCOUNT              PIC X(10).
  4946         16  EN-CERT-EFF-DT          PIC XX.
  4947         16  EN-CERT-NO.
  4948             20  EN-CERT-PRIME       PIC X(10).
  4949             20  EN-CERT-SFX         PIC X.
  4950         16  EN-REC-TYPE             PIC X.
  4951             88  EN-ISSUE               VALUE 'I'.
  4952             88  EN-CANCELLATION        VALUE 'C'.
  4953         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4954     12  EN-CONTROL-BY-ARCH-NO.
  4955         16  EN-COMPANY-CD-A1              PIC X.
  4956         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4957     12  EN-LAST-MAINT-DT            PIC XX.
  4958     12  EN-LAST-MAINT-BY            PIC X(4).
  4959     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4960     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4961     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4962         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4963         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4964         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4965         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4966         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4967         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4968         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  88
* EL6316.cbl
  4969         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4970         16  EN-LF-ORIG-BENCD        PIC XX.
  4971         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4972         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4973         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4974         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4975         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4976         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4977*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4978         16  EN-ORIG-CRED-BENE       PIC X(25).
  4979         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4980         16  FILLER                  PIC X.
  4981         16  EN-AH-ORIG-BENCD        PIC XX.
  4982         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4983         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4984         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4985         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4986*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4987*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4988         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4989         16  F                       PIC X(09).
  4990         16  EN-AH-ORIG-CP           PIC 99.
  4991         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4992         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4993         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4994         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4995         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4996         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4997         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4998         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4999         16  EN-LF-NEW-BENCD         PIC XX.
  5000         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5001         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5002         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5003         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5004         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5005         16  EN-LF-NEW-EXP-DT        PIC XX.
  5006         16  EN-NEW-CRED-BENE        PIC X(25).
  5007         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5008         16  FILLER                  PIC X.
  5009         16  EN-AH-NEW-BENCD         PIC XX.
  5010         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5011         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5012         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5013         16  EN-AH-NEW-EXP-DT        PIC XX.
  5014*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5015*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5016*        16  F                       PIC X(12).
  5017         16  EN-AH-NEW-CP            PIC 99.
  5018         16  EN-SIG-SW               PIC X.
  5019         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5020         16  FILLER                  PIC X(37).
  5021     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5022         16  EN-LF-ORIG-REF-DT       PIC XX.
  5023         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5024         16  EN-AH-ORIG-REF-DT       PIC XX.
  5025         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5026         16  EN-LF-NEW-REF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  89
* EL6316.cbl
  5027         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5028         16  EN-AH-NEW-REF-DT        PIC XX.
  5029         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5030         16  EN-FLAG-CERT            PIC X.
  5031         16  EN-INS-LAST-NAME        PIC X(15).
  5032         16  EN-INS-FIRST-NAME       PIC X(10).
  5033         16  EN-INS-MIDDLE-INIT      PIC X.
  5034         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5035         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5036         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5037         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5038         16  FILLER                  PIC X(262).
  5039     12  EN-MONEY-SW             PIC X.
  5040     12  EN-HEALTH-APP           PIC X.
  5041     12  EN-VOUCHER-SW           PIC X.
  5042     12  EN-PAYEE                PIC X(14).
  5043     12  EN-INPUT-DT             PIC XX.
  5044     12  EN-PROCESS-DT           PIC XX.
  5045     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5046     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5047     12  EN-REASON-CODES.
  5048         16  F OCCURS 12.
  5049             20  EN-REASON-CODE  PIC X(4).
  5050     12  EN-TEMPLATE-USED        PIC X(8).
  5051     12  EN-DOCU-TYPE            PIC X.
  5052         88  EN-VERI-DOCU          VALUE 'V'.
  5053         88  EN-GCE-DOCU           VALUE 'G'.
  5054         88  EN-CANC-DOCU          VALUE 'C'.
  5055     12  EN-COMMENTS1            PIC X(13).
  5056     12  EN-COMMENTS2            PIC X(70).
  5057     12  EN-COMM-CHGBK           PIC X.
  5058         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5059         88  EN-CHG-ACCT           VALUE 'Y'.
  5060     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5061     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5062     12  EN-BATCH-NUMBER         PIC X(6).
  5063     12  EN-ACCT-SUMM            PIC X.
  5064     12  EN-CSO-SUMM             PIC X.
  5065     12  FILLER                  PIC X(13).
  5066******************************************************************
  5067*                                COPY ERCNOTE.
  5068******************************************************************
  5069*                                                                *
  5070*                                                                *
  5071*                            ERCNOTE                             *
  5072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5073*                            VMOD=2.003                          *
  5074*                                                                *
  5075*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5076*                                                                *
  5077*        FILE TYPE= VSAM,KSDS                                    *
  5078*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5079*                                                                *
  5080*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5081*                                                                *
  5082*        LOG = YES                                               *
  5083*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5084*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  90
* EL6316.cbl
  5085******************************************************************
  5086*                   C H A N G E   L O G
  5087*
  5088* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5089*-----------------------------------------------------------------
  5090*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5091* EFFECTIVE    NUMBER
  5092*-----------------------------------------------------------------
  5093* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5094*                                FILE WILL CONTAIN BILLING NOTES O
  5095******************************************************************
  5096
  5097 01  CERTIFICATE-NOTE.
  5098     12  CN-RECORD-ID                PIC  XX.
  5099         88  VALID-CN-ID                  VALUE 'CN'.
  5100
  5101     12  CN-CONTROL-PRIMARY.
  5102         16  CN-COMPANY-CD           PIC X.
  5103         16  CN-CARRIER              PIC X.
  5104         16  CN-GROUPING.
  5105             20 CN-GROUPING-PREFIX   PIC XXX.
  5106             20 CN-GROUPING-PRIME    PIC XXX.
  5107         16  CN-STATE                PIC XX.
  5108         16  CN-ACCOUNT.
  5109             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5110             20 CN-ACCOUNT-PRIME     PIC X(6).
  5111         16  CN-CERT-EFF-DT          PIC XX.
  5112         16  CN-CERT-NO.
  5113             20  CN-CERT-PRIME       PIC X(10).
  5114             20  CN-CERT-SFX         PIC X.
  5115
  5116     12  CN-BILLING-START-LINE-NO    PIC 99.
  5117     12  CN-BILLING-END-LINE-NO      PIC 99.
  5118
  5119     12  CN-LINES.
  5120         16  CN-LINE OCCURS 10       PIC X(77).
  5121
  5122     12  CN-LAST-MAINT-DT            PIC XX.
  5123     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5124     12  CN-LAST-MAINT-USER          PIC X(4).
  5125     12  FILLER                      PIC X(6).
  5126******************************************************************
  5127*                                COPY ERCMAIL.
  5128******************************************************************
  5129*                                                                *
  5130*                                                                *
  5131*                            ERCMAIL                             *
  5132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5133*                            VMOD=2.003                          *
  5134*                                                                *
  5135*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5136*                                                                *
  5137*   FILE TYPE = VSAM,KSDS                                        *
  5138*   RECORD SIZE = 374   RECFORM = FIX                            *
  5139*                                                                *
  5140*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5141*   ALTERNATE PATH    = NOT USED                                 *
  5142*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  91
* EL6316.cbl
  5143*   LOG = YES                                                    *
  5144*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5145******************************************************************
  5146*                   C H A N G E   L O G
  5147*
  5148* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5149*-----------------------------------------------------------------
  5150*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5151* EFFECTIVE    NUMBER
  5152*-----------------------------------------------------------------
  5153* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5154* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5155* 111108                   PEMA  ADD CRED BENE ADDR2
  5156******************************************************************
  5157
  5158 01  MAILING-DATA.
  5159     12  MA-RECORD-ID                      PIC XX.
  5160         88  VALID-MA-ID                       VALUE 'MA'.
  5161
  5162     12  MA-CONTROL-PRIMARY.
  5163         16  MA-COMPANY-CD                 PIC X.
  5164         16  MA-CARRIER                    PIC X.
  5165         16  MA-GROUPING.
  5166             20  MA-GROUPING-PREFIX        PIC XXX.
  5167             20  MA-GROUPING-PRIME         PIC XXX.
  5168         16  MA-STATE                      PIC XX.
  5169         16  MA-ACCOUNT.
  5170             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5171             20  MA-ACCOUNT-PRIME          PIC X(6).
  5172         16  MA-CERT-EFF-DT                PIC XX.
  5173         16  MA-CERT-NO.
  5174             20  MA-CERT-PRIME             PIC X(10).
  5175             20  MA-CERT-SFX               PIC X.
  5176
  5177     12  FILLER                            PIC XX.
  5178
  5179     12  MA-ACCESS-CONTROL.
  5180         16  MA-SOURCE-SYSTEM              PIC XX.
  5181             88  MA-FROM-CREDIT                VALUE 'CR'.
  5182             88  MA-FROM-VSI                   VALUE 'VS'.
  5183             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5184             88  MA-FROM-OTHER                 VALUE 'OT'.
  5185         16  MA-RECORD-ADD-DT              PIC XX.
  5186         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5187         16  MA-LAST-MAINT-DT              PIC XX.
  5188         16  MA-LAST-MAINT-BY              PIC XXXX.
  5189         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5190
  5191     12  MA-PROFILE-INFO.
  5192         16  MA-QUALIFY-CODE-1             PIC XX.
  5193         16  MA-QUALIFY-CODE-2             PIC XX.
  5194         16  MA-QUALIFY-CODE-3             PIC XX.
  5195         16  MA-QUALIFY-CODE-4             PIC XX.
  5196         16  MA-QUALIFY-CODE-5             PIC XX.
  5197
  5198         16  MA-INSURED-LAST-NAME          PIC X(15).
  5199         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5200         16  MA-INSURED-MIDDLE-INIT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  92
* EL6316.cbl
  5201         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5202         16  MA-INSURED-BIRTH-DT           PIC XX.
  5203         16  MA-INSURED-SEX                PIC X.
  5204             88  MA-SEX-MALE                   VALUE 'M'.
  5205             88  MA-SEX-FEMALE                 VALUE 'F'.
  5206         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5207
  5208         16  MA-ADDRESS-CORRECTED          PIC X.
  5209         16  MA-JOINT-BIRTH-DT             PIC XX.
  5210*        16  FILLER                        PIC X(12).
  5211
  5212         16  MA-ADDRESS-LINE-1             PIC X(30).
  5213         16  MA-ADDRESS-LINE-2             PIC X(30).
  5214         16  MA-CITY-STATE.
  5215             20  MA-CITY                   PIC X(28).
  5216             20  MA-ADDR-STATE             PIC XX.
  5217         16  MA-ZIP.
  5218             20  MA-ZIP-CODE.
  5219                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5220                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5221                 24  FILLER                PIC X(4).
  5222             20  MA-ZIP-PLUS4              PIC X(4).
  5223         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5224             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5225             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5226             20  FILLER                    PIC X(3).
  5227
  5228         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5229
  5230         16  FILLER                        PIC XXX.
  5231*        16  FILLER                        PIC X(10).
  5232
  5233     12  MA-CRED-BENE-INFO.
  5234         16  MA-CRED-BENE-NAME                 PIC X(25).
  5235         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5236         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5237         16  MA-CRED-BENE-CTYST.
  5238             20  MA-CRED-BENE-CITY             PIC X(28).
  5239             20  MA-CRED-BENE-STATE            PIC XX.
  5240         16  MA-CRED-BENE-ZIP.
  5241             20  MA-CB-ZIP-CODE.
  5242                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5243                     88  MA-CB-CANADIAN-POST-CODE
  5244                                           VALUE 'A' THRU 'Z'.
  5245                 24  FILLER                    PIC X(4).
  5246             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5247         16  MA-CB-CANADIAN-POSTAL-CODE
  5248                            REDEFINES MA-CRED-BENE-ZIP.
  5249             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5250             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5251             20  FILLER                        PIC X(3).
  5252     12  MA-POST-CARD-MAIL-DATA.
  5253         16  MA-MAIL-DATA OCCURS 7.
  5254             20  MA-MAIL-TYPE              PIC X.
  5255                 88  MA-12MO-MAILING           VALUE '1'.
  5256                 88  MA-EXP-MAILING            VALUE '2'.
  5257             20  MA-MAIL-STATUS            PIC X.
  5258                 88  MA-MAIL-ST-MAILED         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  93
* EL6316.cbl
  5259                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5260                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5261             20  MA-MAIL-DATE              PIC XX.
  5262     12  FILLER                            PIC XX.
  5263     12  FILLER                            PIC XX.
  5264*    12  FILLER                            PIC X(30).
  5265******************************************************************
  5266*                                COPY ERCCNOT.
  5267******************************************************************
  5268*                                                                *
  5269*                            ERCCNOT                             *
  5270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5271*                            VMOD=2.003                          *
  5272*                                                                *
  5273*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5274*                                                                *
  5275*        FILE TYPE= VSAM,KSDS                                    *
  5276*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5277*                                                                *
  5278*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5279*                                                                *
  5280*        LOG = YES                                               *
  5281*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5282*                                                                *
  5283******************************************************************
  5284*                   C H A N G E   L O G
  5285*
  5286* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5287*-----------------------------------------------------------------
  5288*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5289* EFFECTIVE    NUMBER
  5290*-----------------------------------------------------------------
  5291* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5292******************************************************************
  5293
  5294 01  CERT-NOTE-FILE.
  5295     12  CZ-RECORD-ID                PIC  XX.
  5296         88  VALID-CZ-ID                  VALUE 'CZ'.
  5297
  5298     12  CZ-CONTROL-PRIMARY.
  5299         16  CZ-COMPANY-CD           PIC X.
  5300         16  CZ-CARRIER              PIC X.
  5301         16  CZ-GROUPING.
  5302             20 CZ-GROUPING-PREFIX   PIC XXX.
  5303             20 CZ-GROUPING-PRIME    PIC XXX.
  5304         16  CZ-STATE                PIC XX.
  5305         16  CZ-ACCOUNT.
  5306             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5307             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5308         16  CZ-CERT-EFF-DT          PIC XX.
  5309         16  CZ-CERT-NO.
  5310             20  CZ-CERT-PRIME       PIC X(10).
  5311             20  CZ-CERT-SFX         PIC X.
  5312         16  CZ-RECORD-TYPE          PIC X.
  5313             88  CERT-NOTE           VALUE '1'.
  5314             88  CLAIM-CERT-NOTE     VALUE '2'.
  5315         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5316
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  94
* EL6316.cbl
  5317     12  CZ-LAST-MAINT-DT            PIC XX.
  5318     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5319     12  CZ-LAST-MAINT-USER          PIC X(4).
  5320
  5321     12  CZ-NOTE-INFORMATION.
  5322         16  CZ-NOTE                 PIC X(63).
  5323         16  FILLER                  PIC X(39).
  5324******************************************************************
  5325*                                COPY ELCEOBC.
  5326******************************************************************
  5327*                                                                *
  5328*                                                                *
  5329*                            ELCEOBC                             *
  5330*                            VMOD=2.001                          *
  5331*                                                                *
  5332*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5333*                                                                *
  5334*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5335*   VSAM EOB CODE TABLE                                          *
  5336*                                                                *
  5337*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5338*                                                                *
  5339*   FILE TYPE = VSAM,KSDS                                        *
  5340*   RECORD SIZE = 350   RECFORM = FIX                            *
  5341*                                                                *
  5342*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5343*                                                                *
  5344*   LOG = NO                                                     *
  5345*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5346*                                                                *
  5347*                                                                *
  5348******************************************************************
  5349*                   C H A N G E   L O G
  5350*
  5351* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5352*-----------------------------------------------------------------
  5353*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5354* EFFECTIVE    NUMBER
  5355*-----------------------------------------------------------------
  5356* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5357* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5358******************************************************************
  5359 01  EOB-CODES.
  5360     12  EO-RECORD-ID                      PIC XX.
  5361         88  VALID-DN-ID                      VALUE 'EO'.
  5362     12  EO-CONTROL-PRIMARY.
  5363         16  EO-COMPANY-CD                 PIC X.
  5364         16  EO-RECORD-TYPE                PIC X.
  5365             88  EO-EOB-RECS                  VALUE '1'.
  5366             88  EO-VERIF-RECS                VALUE '2'.
  5367             88  EO-GCE-RECS                  VALUE '3'.
  5368         16  EO-EOB-CODE                   PIC X(4).
  5369         16  FILLER                        PIC X(9).
  5370     12  EO-MAINT-INFORMATION.
  5371         16  EO-LAST-MAINT-DT              PIC XX.
  5372         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5373         16  EO-LAST-MAINT-USER            PIC X(4).
  5374         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  95
* EL6316.cbl
  5375     12  EO-DESCRIPTION                    PIC X(275).
  5376     12  FILLER                            PIC X(46).
  5377******************************************************************
  5378 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5379                          ACCOUNT-MASTER CONTROL-FILE
  5380                          PENDING-BUSINESS CERTIFICATE-MASTER
  5381                          ORIGINAL-CERTIFICATE
  5382                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5383                          MAILING-DATA CERT-NOTE-FILE EOB-CODES.
  5384 0000-DFHEXIT SECTION.
  5385     MOVE '9#                    $   ' TO DFHEIV0.
  5386     MOVE 'EL6316' TO DFHEIV1.
  5387     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5388     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5389     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5390     MOVE '5'                    TO DC-OPTION-CODE
  5391     PERFORM 9700-DATE-LINK
  5392     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5393     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5394     MOVE EIBTRMID               TO QID-TERM
  5395     IF EIBCALEN = 0
  5396        GO TO 8800-UNAUTHORIZED-ACCESS
  5397     END-IF
  5398     DISPLAY ' ENDORSE LENGTH  '
  5399                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5400     move function length(EL631II) TO MAP-LENGTH
  5401     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5402     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5403        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5404           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5405           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5406           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5407           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5408           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5409           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5410           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5411           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5412           MOVE LOW-VALUES             TO EL631II
  5413           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5414           GO TO 0350-DISPLAY-COMMON-DATA
  5415        END-IF
  5416     END-IF
  5417     IF PI-CALLING-PROGRAM = 'EL614'
  5418        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5419                                 TO WS-PASSED-REASON-CODES
  5420        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5421        IF WS-PASSED-REASON-CODES NOT = SPACES
  5422           MOVE 'Y'                TO WS-SET-CODES-MDT
  5423        ELSE
  5424           MOVE 'N'                TO WS-SET-CODES-MDT
  5425        END-IF
  5426        PERFORM 0610-RECOVER-TEMP-STORAGE
  5427                                 THRU 0610-EXIT
  5428        GO TO 0350-DISPLAY-COMMON-DATA
  5429     END-IF
  5430     IF EIBAID = DFHCLEAR
  5431        IF PI-CLEAR-ERROR
  5432           MOVE SPACES            TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  96
* EL6316.cbl
  5433           MOVE ER-3833           TO EMI-ERROR
  5434           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5435           GO TO 0350-DISPLAY-COMMON-DATA
  5436        ELSE
  5437           GO TO 9400-CLEAR
  5438        END-IF
  5439     END-IF
  5440     .
  5441 0200-RECEIVE.
  5442     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5443        MOVE ER-0008             TO EMI-ERROR
  5444        PERFORM 9900-ERROR-FORMAT
  5445                                 THRU 9900-EXIT
  5446        MOVE -1                  TO PFENTRL
  5447        GO TO 8100-SEND-INITIAL-MAP
  5448     END-IF
  5449
  5450* EXEC CICS RECEIVE
  5451*        MAP      (MAP-NAME)
  5452*        MAPSET   (MAPSET-NAME)
  5453*        INTO     (EL631II)
  5454*    END-EXEC
  5455     MOVE LENGTH OF
  5456      EL631II
  5457       TO DFHEIV11
  5458*    MOVE '8"T I  L              ''   #00005445' TO DFHEIV0
  5459     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5461     MOVE X'2020233030303035343435' TO DFHEIV0(25:11)
  5462     CALL 'kxdfhei1' USING DFHEIV0,
  5463           MAP-NAME,
  5464           EL631II,
  5465           DFHEIV11,
  5466           MAPSET-NAME,
  5467           DFHEIV99,
  5468           DFHEIV99
  5469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5470     IF PFENTRL = 0
  5471         GO TO 0300-CHECK-PFKEYS
  5472     END-IF
  5473     IF EIBAID NOT = DFHENTER
  5474         MOVE ER-0004            TO EMI-ERROR
  5475         GO TO 0320-INPUT-ERROR
  5476     END-IF
  5477     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5478        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5479     ELSE
  5480        MOVE ER-0029            TO EMI-ERROR
  5481        GO TO 0320-INPUT-ERROR
  5482     END-IF
  5483     .
  5484 0300-CHECK-PFKEYS.
  5485     IF EIBAID = DFHPF1
  5486        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5487        PERFORM 0520-ERENDT-STARTBR
  5488                                 THRU 0520-EXIT
  5489        PERFORM 0510-ERENDT-READNEXT
  5490                                 THRU 0510-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  97
* EL6316.cbl
  5491        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
  5492            PERFORM 0510-ERENDT-READNEXT
  5493                                 THRU 0510-EXIT
  5494        END-IF
  5495        IF (RESP-NORMAL) AND
  5496         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5497           PERFORM 0390-BUILD-FROM-ERENDT
  5498                                 THRU 0390-EXIT
  5499           MOVE ER-0000          TO EMI-ERROR
  5500           PERFORM 9900-ERROR-FORMAT
  5501                                 THRU 9900-EXIT
  5502           GO TO 8100-SEND-INITIAL-MAP
  5503        ELSE
  5504           MOVE ER-2237          TO EMI-ERROR
  5505           MOVE -1               TO CARRL
  5506           PERFORM 9900-ERROR-FORMAT
  5507                                 THRU 9900-EXIT
  5508           GO TO 8200-SEND-DATAONLY
  5509        END-IF
  5510     END-IF
  5511     IF EIBAID = DFHPF2
  5512        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5513        PERFORM 0520-ERENDT-STARTBR
  5514                                 THRU 0520-EXIT
  5515        PERFORM 0510-ERENDT-READNEXT
  5516                                 THRU 0510-EXIT
  5517        PERFORM 0530-ERENDT-READPREV
  5518                                 THRU 0530-EXIT
  5519        PERFORM 0530-ERENDT-READPREV
  5520                                 THRU 0530-EXIT
  5521        IF (RESP-NORMAL) AND
  5522         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5523           PERFORM 0390-BUILD-FROM-ERENDT
  5524                                 THRU 0390-EXIT
  5525           MOVE ER-0000          TO EMI-ERROR
  5526           PERFORM 9900-ERROR-FORMAT
  5527                                 THRU 9900-EXIT
  5528           GO TO 8100-SEND-INITIAL-MAP
  5529        ELSE
  5530           GO TO 0350-DISPLAY-COMMON-DATA
  5531           MOVE ER-2238          TO EMI-ERROR
  5532           PERFORM 9900-ERROR-FORMAT
  5533                                 THRU 9900-EXIT
  5534           MOVE -1               TO CARRL
  5535           GO TO 8200-SEND-DATAONLY
  5536        END-IF
  5537     END-IF
  5538     IF EIBAID = DFHPF3
  5539        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5540        PERFORM 0600-CREATE-TEMP-STORAGE
  5541                                 THRU 0600-EXIT
  5542        MOVE 'EL614'             TO PGM-NAME
  5543        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5544        MOVE +1                  TO S2
  5545        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5546           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5547              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5548              ADD +5 TO S2
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  98
* EL6316.cbl
  5549           END-IF
  5550        END-PERFORM
  5551        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5552        GO TO 9300-XCTL
  5553     END-IF
  5554     IF EIBAID = DFHPF4 OR DFHPF8
  5555        GO TO 1000-FINALIZE
  5556     END-IF
  5557     IF EIBAID = DFHPF23
  5558        IF PI-CLEAR-ERROR
  5559           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5560           MOVE ER-3833           TO EMI-ERROR
  5561           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5562           GO TO 0350-DISPLAY-COMMON-DATA
  5563        ELSE
  5564           GO TO 8810-PF23
  5565        END-IF
  5566     END-IF
  5567     IF EIBAID = DFHPF24
  5568        IF PI-CLEAR-ERROR
  5569           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5570           MOVE ER-3833           TO EMI-ERROR
  5571           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5572           GO TO 0350-DISPLAY-COMMON-DATA
  5573        ELSE
  5574           GO TO 9200-RETURN-MAIN-MENU
  5575        END-IF
  5576     END-IF
  5577     IF EIBAID = DFHPF12
  5578        GO TO 9500-PF12
  5579     END-IF
  5580     IF EIBAID = DFHENTER
  5581        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5582        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5583        IF EMI-NO-ERRORS
  5584           GO TO 0350-DISPLAY-COMMON-DATA
  5585        ELSE
  5586           GO TO 8200-SEND-DATAONLY
  5587        END-IF
  5588     END-IF
  5589     MOVE ER-0029                TO EMI-ERROR
  5590     .
  5591 0320-INPUT-ERROR.
  5592     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5593     MOVE AL-UNBON               TO PFENTRA
  5594     MOVE -1                     TO PFENTRL
  5595     GO TO 8200-SEND-DATAONLY
  5596     .
  5597 0325-EDIT-SCREEN.
  5598     IF PRTSWL > ZEROS
  5599        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5600*          move prtswi to w-prtsw
  5601*          MOVE AL-UANON         TO PRTSWA
  5602*          IF PRTSWI = ' '
  5603              MOVE 'P'         TO PRTSWI
  5604*          END-IF
  5605*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5606        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  99
* EL6316.cbl
  5607     END-IF
  5608     IF LTRIDL > ZEROS
  5609        AND LTRIDI > SPACES
  5610        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5611        MOVE LTRIDI              TO LETR-LETTER-ID
  5612                                    PI-LTRID-ENTERED
  5613        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5614        MOVE SPACES              TO LETR-FILLER
  5615        MOVE 0                   TO LETR-SEQ-NO
  5616        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5617     ELSE
  5618        MOVE ER-1236          TO EMI-ERROR
  5619        MOVE -1               TO LTRIDL
  5620        MOVE AL-UABON         TO LTRIDA
  5621        PERFORM 9900-ERROR-FORMAT
  5622                                 THRU 9900-EXIT
  5623     END-IF
  5624
  5625     IF W-PROMPT-LETTER EQUAL 'Y'
  5626         MOVE ER-0894            TO EMI-ERROR
  5627         MOVE -1                 TO LTRIDL
  5628         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5629     END-IF
  5630     SET REASONS-NOT-FOUND TO TRUE
  5631     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5632        IF REACDL (S1) = +4 OR
  5633          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5634              MOVE AL-SANON     TO REACDA (S1)
  5635              SET REASONS-FOUND TO TRUE
  5636        END-IF
  5637     END-PERFORM
  5638
  5639     IF REASONS-NOT-FOUND
  5640        MOVE ER-1820             TO EMI-ERROR
  5641        MOVE -1                  TO PFENTRL
  5642        PERFORM 9900-ERROR-FORMAT
  5643                                 THRU 9900-EXIT
  5644     ELSE
  5645        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5646     END-IF
  5647
  5648     IF CRTNT1L > ZEROS
  5649        IF CRTNT1I > SPACES
  5650           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5651        END-IF
  5652     END-IF
  5653
  5654     IF CRTNT2L > ZEROS
  5655        IF CRTNT2I > SPACES
  5656           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5657        END-IF
  5658     END-IF
  5659
  5660     IF BILNT1L > ZEROS
  5661        IF BILNT1I > SPACES
  5662           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5663        END-IF
  5664     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 100
* EL6316.cbl
  5665
  5666     .
  5667 0325-EXIT.
  5668     EXIT.
  5669
  5670 0326-GET-Z-RECORD.
  5671
  5672     MOVE SPACES  TO W-Z-CONTROL-DATA
  5673
  5674
  5675* EXEC CICS STARTBR
  5676*         DATASET    ('ELLETR')
  5677*         RIDFLD     (ELLETR-KEY)
  5678*         GTEQ
  5679*         RESP      (WS-RESPONSE)
  5680*    END-EXEC.
  5681     MOVE 'ELLETR' TO DFHEIV1
  5682     MOVE 0
  5683       TO DFHEIV11
  5684*    MOVE '&,         G          &  N#00005654' TO DFHEIV0
  5685     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5686     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5687     MOVE X'204E233030303035363534' TO DFHEIV0(25:11)
  5688     CALL 'kxdfhei1' USING DFHEIV0,
  5689           DFHEIV1,
  5690           ELLETR-KEY,
  5691           DFHEIV99,
  5692           DFHEIV11,
  5693           DFHEIV99
  5694     MOVE EIBRESP  TO WS-RESPONSE
  5695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5696
  5697     IF NOT RESP-NORMAL
  5698         MOVE ER-1236          TO EMI-ERROR
  5699         MOVE -1               TO LTRIDL
  5700         MOVE AL-UABON         TO LTRIDA
  5701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5702         GO TO 0326-ENDBR
  5703     END-IF.
  5704
  5705 0326-READNEXT.
  5706
  5707
  5708* EXEC CICS READNEXT
  5709*        DATASET   ('ELLETR')
  5710*        INTO      (TEXT-FILES)
  5711*        RIDFLD    (ELLETR-KEY)
  5712*        RESP      (WS-RESPONSE)
  5713*    END-EXEC
  5714     MOVE LENGTH OF
  5715      TEXT-FILES
  5716       TO DFHEIV12
  5717     MOVE 'ELLETR' TO DFHEIV1
  5718     MOVE 0
  5719       TO DFHEIV11
  5720*    MOVE '&.IL                  )  N#00005670' TO DFHEIV0
  5721     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5722     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 101
* EL6316.cbl
  5723     MOVE X'204E233030303035363730' TO DFHEIV0(25:11)
  5724     CALL 'kxdfhei1' USING DFHEIV0,
  5725           DFHEIV1,
  5726           TEXT-FILES,
  5727           DFHEIV12,
  5728           ELLETR-KEY,
  5729           DFHEIV99,
  5730           DFHEIV11,
  5731           DFHEIV99,
  5732           DFHEIV99
  5733     MOVE EIBRESP  TO WS-RESPONSE
  5734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5735     IF RESP-NORMAL
  5736        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5737           MOVE ER-1236          TO EMI-ERROR
  5738           MOVE -1               TO LTRIDL
  5739           MOVE AL-UABON         TO LTRIDA
  5740           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5741           GO TO 0326-ENDBR
  5742        END-IF
  5743
  5744        MOVE AL-UANON         TO LTRIDA
  5745        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5746           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5747        ELSE
  5748           GO TO 0326-READNEXT
  5749        END-IF
  5750     ELSE
  5751        MOVE ER-1236          TO EMI-ERROR
  5752        MOVE -1               TO LTRIDL
  5753        MOVE AL-UABON         TO LTRIDA
  5754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5755        GO TO 0326-ENDBR
  5756     END-IF.
  5757
  5758 0326-ENDBR.
  5759
  5760
  5761* EXEC CICS ENDBR
  5762*        DATASET     ('ELLETR')
  5763*    END-EXEC.
  5764     MOVE 'ELLETR' TO DFHEIV1
  5765     MOVE 0
  5766       TO DFHEIV11
  5767*    MOVE '&2                    $   #00005701' TO DFHEIV0
  5768     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5769     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5770     MOVE X'2020233030303035373031' TO DFHEIV0(25:11)
  5771     CALL 'kxdfhei1' USING DFHEIV0,
  5772           DFHEIV1,
  5773           DFHEIV11,
  5774           DFHEIV99
  5775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5776
  5777
  5778 0326-EXIT.
  5779      EXIT.
  5780 0350-DISPLAY-COMMON-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 102
* EL6316.cbl
  5781     display ' made it to 0350 '
  5782     PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  5783     IF PI-LTRID-ENTERED > SPACES
  5784        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5785        MOVE AL-UANON            TO LTRIDA
  5786        MOVE +4                  TO LTRIDL
  5787     ELSE
  5788        IF PI-CLM-RESCISSION
  5789            MOVE 'CLRC'          TO LTRIDI
  5790                                    PI-LTRID-ENTERED
  5791            MOVE +4              TO LTRIDL
  5792            MOVE AL-UANON        TO LTRIDA
  5793        END-IF
  5794     END-IF
  5795
  5796     SET REASONS-NOT-FOUND TO TRUE
  5797     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5798     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5799        IF REACDL (S1) = +4 OR
  5800          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5801              MOVE AL-SANON      TO REACDA (S1)
  5802              MOVE +4            TO REACDL (S1)
  5803              SET REASONS-FOUND  TO TRUE
  5804        END-IF
  5805     END-PERFORM
  5806
  5807     IF REASONS-NOT-FOUND
  5808         IF PI-CLM-RESCISSION
  5809            MOVE 'CRNA'          TO REACD-IN (1)
  5810            MOVE AL-SANON        TO REACDA (1)
  5811            MOVE +4              TO REACDL (1)
  5812            SET REASONS-FOUND    TO TRUE
  5813        END-IF
  5814     END-IF
  5815
  5816     IF PI-CERTNT1-ENTERED > SPACES
  5817        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5818        MOVE AL-UANON            TO CRTNT1A
  5819        MOVE +63                 TO CRTNT1L
  5820     END-IF
  5821
  5822     IF PI-CERTNT2-ENTERED > SPACES
  5823        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5824        MOVE AL-UANON            TO CRTNT2A
  5825        MOVE +63                 TO CRTNT2L
  5826     END-IF
  5827
  5828     IF PI-BILLNT1-ENTERED > SPACES
  5829        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  5830        MOVE AL-UANON            TO BILNT1A
  5831        MOVE +63                 TO BILNT1L
  5832     END-IF
  5833     GO TO 8100-SEND-INITIAL-MAP
  5834     .
  5835 0350-EXIT.
  5836     EXIT.
  5837 0360-CHECK-PENDING.
  5838     display ' made it to 0360 '
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 103
* EL6316.cbl
  5839     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5840     MOVE PI-CARRIER             TO CRTO-CARRIER
  5841     MOVE PI-GROUPING            TO CRTO-GROUPING
  5842     MOVE PI-STATE               TO CRTO-STATE
  5843     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5844     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5845     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5846     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5847     MOVE 'I'                    TO CRTO-RECORD-TYPE
  5848     MOVE ZEROS                  TO CRTO-SEQ-NO
  5849     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5850     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  5851     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  5852     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  5853     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  5854     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5855      display 'response ' ws-response
  5856      display 'pi-elcrto-key ' pi-elcrto-key
  5857      display 'oc key ' oc-control-primary
  5858     IF RESP-NORMAL
  5859       IF (PI-ELCRTO-KEY (1:33) =
  5860              OC-CONTROL-PRIMARY (1:33))
  5861          DISPLAY 'CRTO RESP NORMAL '
  5862          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  5863          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  5864          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  5865          IF RESP-NORMAL
  5866             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  5867             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  5868          END-IF
  5869       ELSE
  5870          MOVE ER-3829           TO EMI-ERROR
  5871          PERFORM 9900-ERROR-FORMAT
  5872                                 THRU 9900-EXIT
  5873          MOVE -1                TO CARRL
  5874          GO TO 8100-SEND-INITIAL-MAP
  5875       END-IF
  5876     ELSE
  5877        MOVE ER-3829             TO EMI-ERROR
  5878        PERFORM 9900-ERROR-FORMAT
  5879                                 THRU 9900-EXIT
  5880        MOVE -1                  TO CARRL
  5881        GO TO 8100-SEND-INITIAL-MAP
  5882     END-IF
  5883     .
  5884 0360-EXIT.
  5885     EXIT.
  5886 0361-MOVE-CRTO-TO-SCREEN.
  5887     display ' made it to 0361 '
  5888     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  5889     MOVE ' '                      TO DC-OPTION-CODE
  5890     PERFORM 9700-DATE-LINK
  5891     IF NO-CONVERSION-ERROR
  5892        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  5893     END-IF
  5894     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  5895     MOVE ' '                      TO DC-OPTION-CODE
  5896     PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 104
* EL6316.cbl
  5897     IF NO-CONVERSION-ERROR
  5898        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  5899     END-IF
  5900     MOVE OC-LF-CANCEL-AMT         TO OLFAMTO
  5901     MOVE OC-AH-CANCEL-AMT         TO OAHAMTO
  5902     .
  5903 0361-EXIT.
  5904     EXIT.
  5905 0362-READ-ELCRTO.
  5906     display ' made it to 0362 '
  5907
  5908* EXEC CICS READ
  5909*        DATASET   (WS-ELCRTO-FILE-ID)
  5910*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5911*        RIDFLD    (ELCRTO-KEY)
  5912*        GTEQ
  5913*        RESP      (WS-RESPONSE)
  5914*    END-EXEC
  5915*    MOVE '&"S        G          (  N#00005834' TO DFHEIV0
  5916     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5917     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5918     MOVE X'204E233030303035383334' TO DFHEIV0(25:11)
  5919     CALL 'kxdfhei1' USING DFHEIV0,
  5920           WS-ELCRTO-FILE-ID,
  5921           DFHEIV20,
  5922           DFHEIV99,
  5923           ELCRTO-KEY,
  5924           DFHEIV99,
  5925           DFHEIV99,
  5926           DFHEIV99
  5927     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5928         DFHEIV20
  5929     MOVE EIBRESP  TO WS-RESPONSE
  5930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5931     .
  5932 0362-EXIT.
  5933     EXIT.
  5934 0363-READ-ELCRTO-UPD.
  5935     display ' made it to 0363 '
  5936
  5937* EXEC CICS READ
  5938*        DATASET   (WS-ELCRTO-FILE-ID)
  5939*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5940*        RIDFLD    (ELCRTO-KEY)
  5941*        UPDATE
  5942*        RESP      (WS-RESPONSE)
  5943*    END-EXEC
  5944*    MOVE '&"S        EU         (  N#00005846' TO DFHEIV0
  5945     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5946     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5947     MOVE X'204E233030303035383436' TO DFHEIV0(25:11)
  5948     CALL 'kxdfhei1' USING DFHEIV0,
  5949           WS-ELCRTO-FILE-ID,
  5950           DFHEIV20,
  5951           DFHEIV99,
  5952           ELCRTO-KEY,
  5953           DFHEIV99,
  5954           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 105
* EL6316.cbl
  5955           DFHEIV99
  5956     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5957         DFHEIV20
  5958     MOVE EIBRESP  TO WS-RESPONSE
  5959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5960     .
  5961 0363-EXIT.
  5962     EXIT.
  5963
  5964 0364-MOVE-ZERO-TO-SCREEN.
  5965
  5966     MOVE ZEROS    TO OLFDTO
  5967                      OAHDTO
  5968                      OLFAMTO
  5969                      OAHAMTO.
  5970
  5971 0364-EXIT.
  5972     EXIT.
  5973
  5974 0365-READ-ERENDT.
  5975
  5976* EXEC CICS READ
  5977*        DATASET   (WS-ERENDT-FILE-ID)
  5978*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  5979*        RIDFLD    (ERENDT-KEY)
  5980*        RESP      (WS-RESPONSE)
  5981*    END-EXEC
  5982*    MOVE '&"S        E          (  N#00005868' TO DFHEIV0
  5983     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5985     MOVE X'204E233030303035383638' TO DFHEIV0(25:11)
  5986     CALL 'kxdfhei1' USING DFHEIV0,
  5987           WS-ERENDT-FILE-ID,
  5988           DFHEIV20,
  5989           DFHEIV99,
  5990           ERENDT-KEY,
  5991           DFHEIV99,
  5992           DFHEIV99,
  5993           DFHEIV99
  5994     SET ADDRESS OF ENDORSEMENT-RECORD TO
  5995         DFHEIV20
  5996     MOVE EIBRESP  TO WS-RESPONSE
  5997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5998     .
  5999 0365-EXIT.
  6000     EXIT.
  6001 0370-READ-ERPNDB.
  6002     display ' made it to 0370 '
  6003     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  6004     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  6005     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  6006     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  6007     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
  6008     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  6009     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  6010     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  6011     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  6012     MOVE '2'                    TO PNDB2-RECORD-TYPE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 106
* EL6316.cbl
  6013
  6014* EXEC CICS READ
  6015*        DATASET   (WS-ERPNDB2-FILE-ID)
  6016*        SET       (ADDRESS OF PENDING-BUSINESS)
  6017*        RIDFLD    (ERPNDB2-KEY)
  6018*        RESP      (WS-RESPONSE)
  6019*    END-EXEC
  6020*    MOVE '&"S        E          (  N#00005889' TO DFHEIV0
  6021     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6023     MOVE X'204E233030303035383839' TO DFHEIV0(25:11)
  6024     CALL 'kxdfhei1' USING DFHEIV0,
  6025           WS-ERPNDB2-FILE-ID,
  6026           DFHEIV20,
  6027           DFHEIV99,
  6028           ERPNDB2-KEY,
  6029           DFHEIV99,
  6030           DFHEIV99,
  6031           DFHEIV99
  6032     SET ADDRESS OF PENDING-BUSINESS TO
  6033         DFHEIV20
  6034     MOVE EIBRESP  TO WS-RESPONSE
  6035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6036     .
  6037 0370-EXIT.
  6038     EXIT.
  6039 0380-BUILD-FROM-ERPNDB.
  6040     display ' made it to 0380 '
  6041     MOVE PB-CARRIER             TO CARRO
  6042     MOVE PB-GROUPING            TO GROUPO
  6043     MOVE PB-STATE               TO STATEO
  6044     MOVE PB-ACCOUNT             TO ACCTO
  6045     MOVE PB-CERT-PRIME          TO CERTNOO
  6046     MOVE PB-CERT-SFX            TO CRTSFXO
  6047     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  6048     MOVE ' '                    TO DC-OPTION-CODE
  6049     PERFORM 9700-DATE-LINK
  6050     IF NO-CONVERSION-ERROR
  6051        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6052     END-IF
  6053     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6054     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6055     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6056     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6057     MOVE ' '                      TO DC-OPTION-CODE
  6058     PERFORM 9700-DATE-LINK
  6059     IF NO-CONVERSION-ERROR
  6060        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6061     END-IF
  6062     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6063     MOVE ' '                      TO DC-OPTION-CODE
  6064     PERFORM 9700-DATE-LINK
  6065     IF NO-CONVERSION-ERROR
  6066        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6067     END-IF
  6068     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  6069     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  6070     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 107
* EL6316.cbl
  6071        MOVE PB-CI-LIFE-COMMISSION
  6072                              TO LFCOMMO
  6073*       MOVE AL-UNNON         TO LFCOMMA
  6074     END-IF
  6075     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6076        MOVE PB-CI-AH-COMMISSION
  6077                              TO AHCOMMO
  6078*       MOVE AL-UNNON         TO AHCOMMA
  6079     END-IF
  6080     MOVE ER-2785                TO EMI-ERROR
  6081     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  6082     .
  6083 0380-EXIT.
  6084     EXIT.
  6085 0390-BUILD-FROM-ERENDT.
  6086     MOVE LOW-VALUES             TO EL631II
  6087*    move PI-PRTSW-ENTERED       to prtswo
  6088     IF PI-CERTNT1-ENTERED > SPACES
  6089        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6090        MOVE AL-UANON            TO CRTNT1A
  6091        MOVE +63                 TO CRTNT1L
  6092     END-IF
  6093
  6094     IF PI-CERTNT2-ENTERED > SPACES
  6095        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6096        MOVE AL-UANON            TO CRTNT2A
  6097        MOVE +63                 TO CRTNT2L
  6098     END-IF
  6099
  6100     IF PI-BILLNT1-ENTERED > SPACES
  6101        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6102        MOVE AL-UANON            TO BILNT1A
  6103        MOVE +63                 TO BILNT1L
  6104     END-IF
  6105
  6106     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  6107     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  6108     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  6109     MOVE EN-STATE               TO PI-ENDT-STATE
  6110     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
  6111     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
  6112     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  6113     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  6114     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  6115     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
  6116     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6117     MOVE EN-CARRIER             TO CARRO
  6118     MOVE EN-GROUPING            TO GROUPO
  6119     MOVE EN-STATE               TO STATEO
  6120     MOVE EN-ACCOUNT             TO ACCTO
  6121     MOVE EN-CERT-PRIME          TO CERTNOO
  6122     MOVE EN-CERT-SFX            TO CRTSFXO
  6123     MOVE EN-SEQ-NO              TO SEQNOO
  6124     MOVE EN-TEMPLATE-USED       TO LTRIDO
  6125     PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6126     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6127     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6128     MOVE PB-CI-INITIALS (2:1)   TO MINITO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 108
* EL6316.cbl
  6129     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6130        MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  6131     END-IF
  6132     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6133        MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  6134     END-IF
  6135     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6136        IF EN-REASON-CODE (S1) NOT = SPACES
  6137           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  6138           MOVE AL-SANON         TO REACDA (S1)
  6139           MOVE +4               TO REACDL (S1)
  6140        END-IF
  6141     END-PERFORM
  6142     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  6143     MOVE ' '                    TO DC-OPTION-CODE
  6144     PERFORM 9700-DATE-LINK
  6145     IF NO-CONVERSION-ERROR
  6146        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6147     END-IF
  6148     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  6149        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  6150        MOVE ' '                 TO DC-OPTION-CODE
  6151        PERFORM 9700-DATE-LINK
  6152        IF NO-CONVERSION-ERROR
  6153           MOVE DC-GREG-DATE-1-EDIT
  6154                                 TO PROCDTO
  6155        END-IF
  6156     END-IF
  6157     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  6158        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  6159        MOVE ' '                 TO DC-OPTION-CODE
  6160        PERFORM 9700-DATE-LINK
  6161        IF NO-CONVERSION-ERROR
  6162           MOVE DC-GREG-DATE-1-EDIT
  6163                                 TO INPDTO
  6164        END-IF
  6165     END-IF
  6166     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6167     MOVE ' '                      TO DC-OPTION-CODE
  6168     PERFORM 9700-DATE-LINK
  6169     IF NO-CONVERSION-ERROR
  6170        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6171     END-IF
  6172     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6173     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
  6174     MOVE ' '                      TO DC-OPTION-CODE
  6175     PERFORM 9700-DATE-LINK
  6176     IF NO-CONVERSION-ERROR
  6177        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6178     END-IF
  6179     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6180     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6181     MOVE ' '                      TO DC-OPTION-CODE
  6182     PERFORM 9700-DATE-LINK
  6183     IF NO-CONVERSION-ERROR
  6184        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6185     END-IF
  6186     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 109
* EL6316.cbl
  6187     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6188     MOVE ' '                      TO DC-OPTION-CODE
  6189     PERFORM 9700-DATE-LINK
  6190     IF NO-CONVERSION-ERROR
  6191        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6192     END-IF
  6193     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6194     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6195     .
  6196 0390-EXIT.
  6197     EXIT.
  6198 0400-ADD-ERENDT.
  6199     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6200
  6201* EXEC CICS GETMAIN
  6202*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6203*         LENGTH   (ERENDT-LENGTH)
  6204*         INITIMG  (GETMAIN-SPACE)
  6205*    END-EXEC
  6206*    MOVE ',"IL                  $   #00006059' TO DFHEIV0
  6207     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6208     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6209     MOVE X'2020233030303036303539' TO DFHEIV0(25:11)
  6210     CALL 'kxdfhei1' USING DFHEIV0,
  6211           DFHEIV20,
  6212           ERENDT-LENGTH,
  6213           GETMAIN-SPACE
  6214     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6215         DFHEIV20
  6216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6217     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6218     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6219     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6220     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6221                                    EN-INPUT-DT
  6222     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6223     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6224     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6225     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6226
  6227     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
  6228     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6229
  6230     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6231     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
  6232     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6233
  6234     MOVE OC-LF-COMM-PCT         TO EN-LF-ORIG-REF-COMM-PCT
  6235     MOVE OC-AH-COMM-PCT         TO EN-AH-ORIG-REF-COMM-PCT
  6236
  6237* EXEC CICS READ
  6238*        DATASET   (WS-ERPNDB-FILE-ID)
  6239*        SET       (ADDRESS OF PENDING-BUSINESS)
  6240*        RIDFLD    (PI-ERPNDB-KEY)
  6241*        RESP      (WS-RESPONSE)
  6242*    END-EXEC
  6243*    MOVE '&"S        E          (  N#00006083' TO DFHEIV0
  6244     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 110
* EL6316.cbl
  6245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6246     MOVE X'204E233030303036303833' TO DFHEIV0(25:11)
  6247     CALL 'kxdfhei1' USING DFHEIV0,
  6248           WS-ERPNDB-FILE-ID,
  6249           DFHEIV20,
  6250           DFHEIV99,
  6251           PI-ERPNDB-KEY,
  6252           DFHEIV99,
  6253           DFHEIV99,
  6254           DFHEIV99
  6255     SET ADDRESS OF PENDING-BUSINESS TO
  6256         DFHEIV20
  6257     MOVE EIBRESP  TO WS-RESPONSE
  6258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6259     IF NOT RESP-NORMAL
  6260        GO TO 0400-EXIT
  6261     END-IF
  6262     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6263                                    NEW-LF-CANCEL-DT
  6264     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6265                                    NEW-AH-CANCEL-DT
  6266     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6267                                    NEW-LF-CANCEL-AMT
  6268     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6269                                    NEW-AH-CANCEL-AMT
  6270     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6271                                    EN-LF-NEW-REF-COMM-PCT
  6272                                    NEW-LF-COMM-PCT
  6273     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
  6274                                    EN-AH-NEW-REF-COMM-PCT
  6275                                    NEW-AH-COMM-PCT
  6276     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6277     MOVE 'C'                    TO EN-DOCU-TYPE
  6278     MOVE 'Y'                    TO EN-MONEY-SW
  6279     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER
  6280     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6281     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6282     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6283        IF REACD-IN (S1) NOT = LOW-VALUES
  6284           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6285        END-IF
  6286     END-PERFORM
  6287     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6288
  6289     IF ACCT-FOUND
  6290        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6291        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6292        IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  6293           MOVE PB-C-LF-CANCEL-DT
  6294                                 TO DC-BIN-DATE-2
  6295        END-IF
  6296        MOVE '1'                 TO DC-OPTION-CODE
  6297        PERFORM 9700-DATE-LINK
  6298        IF NO-CONVERSION-ERROR
  6299           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6300           IF DC-ODD-DAYS-OVER > +1
  6301              ADD +1          TO WS-DIFF
  6302           END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 111
* EL6316.cbl
  6303        ELSE
  6304            MOVE +0           TO WS-DIFF
  6305        END-IF
  6306     ELSE
  6307        MOVE +0           TO WS-DIFF
  6308     END-IF
  6309
  6310     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6311         + EN-AH-NEW-REF-AMT)
  6312
  6313     IF (WS-CHGBACK = 99)
  6314         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6315          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6316          MOVE ZEROS           TO EN-ACCT-PORTION
  6317          MOVE 'N'             TO EN-COMM-CHGBK
  6318     ELSE
  6319         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6320                 * EN-LF-COMMISSION) +
  6321                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
  6322         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6323                 - EN-ACCT-PORTION
  6324         MOVE 'Y'                TO EN-COMM-CHGBK
  6325     END-IF
  6326     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6327     .
  6328 0400-EXIT.
  6329     EXIT.
  6330 0410-INIT-ERENDT.
  6331     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6332     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6333     MOVE ZEROS                  TO ENDT-SEQ-NO
  6334
  6335* EXEC CICS READ
  6336*        DATASET    (WS-ERENDT-FILE-ID)
  6337*        RIDFLD     (ERENDT-KEY)
  6338*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6339*        RESP       (WS-RESPONSE)
  6340*        GTEQ
  6341*    END-EXEC
  6342*    MOVE '&"S        G          (  N#00006164' TO DFHEIV0
  6343     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6345     MOVE X'204E233030303036313634' TO DFHEIV0(25:11)
  6346     CALL 'kxdfhei1' USING DFHEIV0,
  6347           WS-ERENDT-FILE-ID,
  6348           DFHEIV20,
  6349           DFHEIV99,
  6350           ERENDT-KEY,
  6351           DFHEIV99,
  6352           DFHEIV99,
  6353           DFHEIV99
  6354     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6355         DFHEIV20
  6356     MOVE EIBRESP  TO WS-RESPONSE
  6357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6358     IF RESP-NORMAL
  6359        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6360        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 112
* EL6316.cbl
  6361     ELSE
  6362        MOVE +4096               TO WS-SEQ-NO
  6363     END-IF
  6364     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6365     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6366     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6367     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6368     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6369     MOVE 'C'                    TO EN-REC-TYPE
  6370     INITIALIZE EN-CANCEL-RECORD
  6371     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6372     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6373                                    EN-AH-ORIG-REF-DT
  6374                                    EN-LF-NEW-REF-DT
  6375                                    EN-AH-NEW-REF-DT
  6376     .
  6377 0410-EXIT.
  6378     EXIT.
  6379 0420-UPDATE-ELCRTO.
  6380     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6381     IF RESP-NORMAL
  6382        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6383                                    OC-LAST-MAINT-DT
  6384        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6385        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6386
  6387* EXEC CICS REWRITE
  6388*          FROM     (ORIGINAL-CERTIFICATE)
  6389*          DATASET  ('ELCRTO')
  6390*       END-EXEC
  6391     MOVE LENGTH OF
  6392      ORIGINAL-CERTIFICATE
  6393       TO DFHEIV11
  6394     MOVE 'ELCRTO' TO DFHEIV1
  6395*    MOVE '&& L                  %   #00006199' TO DFHEIV0
  6396     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6397     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6398     MOVE X'2020233030303036313939' TO DFHEIV0(25:11)
  6399     CALL 'kxdfhei1' USING DFHEIV0,
  6400           DFHEIV1,
  6401           ORIGINAL-CERTIFICATE,
  6402           DFHEIV11,
  6403           DFHEIV99
  6404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6405     END-IF
  6406     .
  6407 0420-EXIT.
  6408     EXIT.
  6409
  6410 0425-ADD-NEW-ELCRTO.
  6411     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6412     MOVE 'OC'                   TO OC-RECORD-ID
  6413     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6414     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6415     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6416     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6417     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6418     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 113
* EL6316.cbl
  6419     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6420     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6421     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6422     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6423     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6424     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6425     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6426     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6427     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6428     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6429     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6430     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6431     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6432     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6433     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6434     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6435     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
  6436     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6437     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6438     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6439     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6440     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6441     MOVE NEW-AH-CP              TO OC-AH-CP
  6442     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
  6443     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6444     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6445     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6446     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6447     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6448     .
  6449 0425-WRITE-ELCRTO.
  6450
  6451
  6452* EXEC CICS WRITE
  6453*       DATASET   ('ELCRTO')
  6454*       FROM      (ORIGINAL-CERTIFICATE)
  6455*       RIDFLD    (OC-CONTROL-PRIMARY)
  6456*       RESP      (WS-RESPONSE)
  6457*    END-EXEC
  6458     MOVE LENGTH OF
  6459      ORIGINAL-CERTIFICATE
  6460       TO DFHEIV11
  6461     MOVE 'ELCRTO' TO DFHEIV1
  6462*    MOVE '&$ L                  ''  N#00006249' TO DFHEIV0
  6463     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6464     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6465     MOVE X'204E233030303036323439' TO DFHEIV0(25:11)
  6466     CALL 'kxdfhei1' USING DFHEIV0,
  6467           DFHEIV1,
  6468           ORIGINAL-CERTIFICATE,
  6469           DFHEIV11,
  6470           OC-CONTROL-PRIMARY,
  6471           DFHEIV99,
  6472           DFHEIV99
  6473     MOVE EIBRESP  TO WS-RESPONSE
  6474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6475
  6476     display ' just wrote new crto ' ws-response
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 114
* EL6316.cbl
  6477     IF RESP-DUPKEY
  6478        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6479        GO TO 0425-WRITE-ELCRTO
  6480     ELSE
  6481        IF NOT RESP-NORMAL
  6482           MOVE -1               TO LTRIDL
  6483           MOVE ER-3830          TO EMI-ERROR
  6484           PERFORM 9900-ERROR-FORMAT
  6485                                 THRU 9900-EXIT
  6486        ELSE
  6487           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6488        END-IF
  6489     END-IF
  6490
  6491     .
  6492 0425-EXIT.
  6493     EXIT.
  6494
  6495 0426-ADD-CERT-NOTES.
  6496
  6497     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6498     SET TB-INDX TO 1
  6499
  6500     IF PI-CERTNT1-ENTERED > SPACES
  6501         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6502         MOVE PI-PROCESSOR-ID    TO
  6503                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6504         MOVE EIBTIME            TO
  6505                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6506         MOVE WS-CURRENT-BIN-DT  TO
  6507                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6508         SET TB-INDX UP BY +1
  6509     END-IF
  6510
  6511     IF PI-CERTNT2-ENTERED > SPACES
  6512         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6513         MOVE PI-PROCESSOR-ID    TO
  6514                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6515         MOVE EIBTIME            TO
  6516                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6517         MOVE WS-CURRENT-BIN-DT  TO
  6518                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6519         SET TB-INDX UP BY +1
  6520     END-IF
  6521
  6522     IF CERT-NOTE-ENTRIES > SPACES
  6523         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6524         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6525     END-IF
  6526
  6527     IF PI-BILLNT1-ENTERED > SPACES
  6528         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6529         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6530         MOVE +63 TO WS-LEN
  6531         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6532     END-IF
  6533
  6534     .
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 115
* EL6316.cbl
  6535 0426-EXIT.
  6536     EXIT.
  6537
  6538 0427-LOAD-CURRENT-CERT-NOTES.
  6539
  6540     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6541     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6542     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6543     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6544     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6545     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6546     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6547     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6548     MOVE '1'                 TO ERCNOT-REC-TYP
  6549     MOVE +0                  TO ERCNOT-SEQ
  6550     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6551
  6552
  6553* EXEC CICS STARTBR
  6554*         DATASET(WS-ERCNOT-FILE-ID)
  6555*         RIDFLD(ERCNOT-KEY)
  6556*         KEYLENGTH(ERCNOT-START-LENGTH)
  6557*         RESP      (WS-RESPONSE)
  6558*         GENERIC
  6559*         GTEQ
  6560*    END-EXEC.
  6561     MOVE 0
  6562       TO DFHEIV11
  6563*    MOVE '&,   KG    G          &  N#00006332' TO DFHEIV0
  6564     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6565     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6566     MOVE X'204E233030303036333332' TO DFHEIV0(25:11)
  6567     CALL 'kxdfhei1' USING DFHEIV0,
  6568           WS-ERCNOT-FILE-ID,
  6569           ERCNOT-KEY,
  6570           ERCNOT-START-LENGTH,
  6571           DFHEIV11,
  6572           DFHEIV99
  6573     MOVE EIBRESP  TO WS-RESPONSE
  6574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6575
  6576
  6577     IF NOT RESP-NORMAL
  6578        GO TO 0427-ENDBR
  6579     END-IF.
  6580
  6581 0427-LOOP.
  6582
  6583* EXEC CICS READNEXT
  6584*         SET(ADDRESS OF CERT-NOTE-FILE)
  6585*         DATASET(WS-ERCNOT-FILE-ID)
  6586*         RIDFLD(ERCNOT-KEY)
  6587*    END-EXEC.
  6588     MOVE 0
  6589       TO DFHEIV11
  6590*    MOVE '&.S                   )   #00006346' TO DFHEIV0
  6591     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6592     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 116
* EL6316.cbl
  6593     MOVE X'2020233030303036333436' TO DFHEIV0(25:11)
  6594     CALL 'kxdfhei1' USING DFHEIV0,
  6595           WS-ERCNOT-FILE-ID,
  6596           DFHEIV20,
  6597           DFHEIV99,
  6598           ERCNOT-KEY,
  6599           DFHEIV99,
  6600           DFHEIV11,
  6601           DFHEIV99,
  6602           DFHEIV99
  6603     SET ADDRESS OF CERT-NOTE-FILE TO
  6604         DFHEIV20
  6605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6606
  6607
  6608     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6609         GO TO 0427-ENDBR
  6610     END-IF.
  6611
  6612     IF (CZ-CARRIER = SV-CARRIER)
  6613        AND (CZ-GROUPING = SV-GROUPING)
  6614        AND (CZ-STATE = SV-STATE)
  6615        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6616        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6617        AND (CZ-CERT-NO = SV-CERT-NO)
  6618        AND (CZ-RECORD-TYPE = '1')
  6619          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6620          MOVE CZ-LAST-MAINT-USER TO
  6621                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6622          MOVE CZ-LAST-MAINT-DT TO
  6623                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6624          MOVE CZ-LAST-MAINT-HHMMSS TO
  6625                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6626          SET TB-INDX UP BY 1
  6627          GO TO 0427-LOOP
  6628     END-IF.
  6629
  6630 0427-ENDBR.
  6631
  6632
  6633* EXEC CICS ENDBR
  6634*         DATASET(WS-ERCNOT-FILE-ID)
  6635*    END-EXEC.
  6636     MOVE 0
  6637       TO DFHEIV11
  6638*    MOVE '&2                    $   #00006376' TO DFHEIV0
  6639     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6641     MOVE X'2020233030303036333736' TO DFHEIV0(25:11)
  6642     CALL 'kxdfhei1' USING DFHEIV0,
  6643           WS-ERCNOT-FILE-ID,
  6644           DFHEIV11,
  6645           DFHEIV99
  6646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6647
  6648
  6649     .
  6650 0427-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 117
* EL6316.cbl
  6651     EXIT.
  6652
  6653 0430-WRITE-ERENDT.
  6654     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6655     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6656     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6657
  6658* EXEC CICS WRITE
  6659*         DATASET   (WS-ERENDT-FILE-ID)
  6660*         FROM      (ENDORSEMENT-RECORD)
  6661*         RIDFLD    (EN-CONTROL-PRIMARY)
  6662*         RESP      (WS-RESPONSE)
  6663*    END-EXEC
  6664     MOVE LENGTH OF
  6665      ENDORSEMENT-RECORD
  6666       TO DFHEIV11
  6667*    MOVE '&$ L                  ''  N#00006388' TO DFHEIV0
  6668     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6669     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6670     MOVE X'204E233030303036333838' TO DFHEIV0(25:11)
  6671     CALL 'kxdfhei1' USING DFHEIV0,
  6672           WS-ERENDT-FILE-ID,
  6673           ENDORSEMENT-RECORD,
  6674           DFHEIV11,
  6675           EN-CONTROL-PRIMARY,
  6676           DFHEIV99,
  6677           DFHEIV99
  6678     MOVE EIBRESP  TO WS-RESPONSE
  6679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6680     IF RESP-NORMAL
  6681        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
  6682        display ' good write erendt '
  6683        IF EIBAID = DFHPF4
  6684           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6685           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6686           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6687           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6688        END-IF
  6689     ELSE
  6690        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6691        MOVE -1                  TO LTRIDL
  6692        MOVE ER-0132             TO EMI-ERROR
  6693        MOVE AL-UABON            TO LTRIDA
  6694        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6695     END-IF
  6696     .
  6697 0430-EXIT.
  6698     EXIT.
  6699 0440-ADD-BILLING-NOTE.
  6700
  6701* EXEC CICS GETMAIN
  6702*         SET      (ADDRESS OF EOB-CODES)
  6703*         LENGTH   (ELEOBC-LENGTH)
  6704*         INITIMG  (GETMAIN-SPACE)
  6705*    END-EXEC
  6706*    MOVE ',"IL                  $   #00006414' TO DFHEIV0
  6707     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6708     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 118
* EL6316.cbl
  6709     MOVE X'2020233030303036343134' TO DFHEIV0(25:11)
  6710     CALL 'kxdfhei1' USING DFHEIV0,
  6711           DFHEIV20,
  6712           ELEOBC-LENGTH,
  6713           GETMAIN-SPACE
  6714     SET ADDRESS OF EOB-CODES TO
  6715         DFHEIV20
  6716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6717
  6718     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6719     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6720     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6721
  6722
  6723* EXEC CICS STARTBR
  6724*        DATASET   ('ELEOBC')
  6725*        RIDFLD    (WS-ELEOBC-KEY)
  6726*        GTEQ
  6727*        RESP      (WS-RESPONSE)
  6728*    END-EXEC
  6729     MOVE 'ELEOBC' TO DFHEIV1
  6730     MOVE 0
  6731       TO DFHEIV11
  6732*    MOVE '&,         G          &  N#00006424' TO DFHEIV0
  6733     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6734     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6735     MOVE X'204E233030303036343234' TO DFHEIV0(25:11)
  6736     CALL 'kxdfhei1' USING DFHEIV0,
  6737           DFHEIV1,
  6738           WS-ELEOBC-KEY,
  6739           DFHEIV99,
  6740           DFHEIV11,
  6741           DFHEIV99
  6742     MOVE EIBRESP  TO WS-RESPONSE
  6743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6744
  6745     IF NOT RESP-NORMAL
  6746        GO TO 0440-EXIT
  6747     END-IF
  6748      .
  6749 0440-READNEXT-ELEOBC.
  6750
  6751
  6752* EXEC CICS READNEXT
  6753*       INTO    (EOB-CODES)
  6754*       DATASET ('ELEOBC')
  6755*       RIDFLD  (WS-ELEOBC-KEY)
  6756*       RESP    (WS-RESPONSE)
  6757*    END-EXEC
  6758     MOVE LENGTH OF
  6759      EOB-CODES
  6760       TO DFHEIV12
  6761     MOVE 'ELEOBC' TO DFHEIV1
  6762     MOVE 0
  6763       TO DFHEIV11
  6764*    MOVE '&.IL                  )  N#00006437' TO DFHEIV0
  6765     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6766     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 119
* EL6316.cbl
  6767     MOVE X'204E233030303036343337' TO DFHEIV0(25:11)
  6768     CALL 'kxdfhei1' USING DFHEIV0,
  6769           DFHEIV1,
  6770           EOB-CODES,
  6771           DFHEIV12,
  6772           WS-ELEOBC-KEY,
  6773           DFHEIV99,
  6774           DFHEIV11,
  6775           DFHEIV99,
  6776           DFHEIV99
  6777     MOVE EIBRESP  TO WS-RESPONSE
  6778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6779
  6780     IF RESP-NORMAL
  6781         IF EO-RECORD-TYPE NOT = '5'
  6782             GO TO 0440-EXIT
  6783         END-IF
  6784     ELSE
  6785         GO TO 0440-EXIT
  6786     END-IF
  6787
  6788     IF EO-RECORD-TYPE = '5' AND
  6789        EO-EOB-CODE = PI-LTRID-ENTERED
  6790           CONTINUE
  6791     ELSE
  6792         GO TO 0440-READNEXT-ELEOBC
  6793     END-IF
  6794
  6795     MOVE SPACES TO WS-BILLING-NOTE
  6796     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6797     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6798     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6799     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6800     MOVE +25 TO WS-LEN
  6801
  6802     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6803     .
  6804 0440-EXIT.
  6805     EXIT.
  6806
  6807 0441-UPDATE-BILLING-NOTE.
  6808
  6809* EXEC CICS GETMAIN
  6810*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6811*         LENGTH   (ERNOTE-LENGTH)
  6812*         INITIMG  (GETMAIN-SPACE)
  6813*    END-EXEC
  6814*    MOVE ',"IL                  $   #00006472' TO DFHEIV0
  6815     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6816     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6817     MOVE X'2020233030303036343732' TO DFHEIV0(25:11)
  6818     CALL 'kxdfhei1' USING DFHEIV0,
  6819           DFHEIV20,
  6820           ERNOTE-LENGTH,
  6821           GETMAIN-SPACE
  6822     SET ADDRESS OF CERTIFICATE-NOTE TO
  6823         DFHEIV20
  6824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 120
* EL6316.cbl
  6825
  6826     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6827
  6828
  6829* EXEC CICS READ
  6830*       DATASET    (WS-ERNOTE-FILE-ID)
  6831*       RIDFLD     (WS-ERNOTE-KEY)
  6832*       INTO       (CERTIFICATE-NOTE)
  6833*       RESP       (WS-RESPONSE)
  6834*       UPDATE
  6835*    END-EXEC
  6836     MOVE LENGTH OF
  6837      CERTIFICATE-NOTE
  6838       TO DFHEIV11
  6839*    MOVE '&"IL       EU         (  N#00006480' TO DFHEIV0
  6840     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6841     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6842     MOVE X'204E233030303036343830' TO DFHEIV0(25:11)
  6843     CALL 'kxdfhei1' USING DFHEIV0,
  6844           WS-ERNOTE-FILE-ID,
  6845           CERTIFICATE-NOTE,
  6846           DFHEIV11,
  6847           WS-ERNOTE-KEY,
  6848           DFHEIV99,
  6849           DFHEIV99,
  6850           DFHEIV99
  6851     MOVE EIBRESP  TO WS-RESPONSE
  6852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6853
  6854     IF RESP-NORMAL
  6855       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  6856          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6857       END-IF
  6858       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6859          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6860       END-IF
  6861       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6862           (NOTE-SUB > +10) OR
  6863           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6864                             WS-BILLING-NOTE (1:WS-LEN))
  6865       END-PERFORM
  6866       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6867                              WS-BILLING-NOTE (1:WS-LEN)
  6868
  6869* EXEC CICS UNLOCK
  6870*           DATASET    (WS-ERNOTE-FILE-ID)
  6871*        END-EXEC
  6872*    MOVE '&*                    #   #00006502' TO DFHEIV0
  6873     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6875     MOVE X'2020233030303036353032' TO DFHEIV0(25:11)
  6876     CALL 'kxdfhei1' USING DFHEIV0,
  6877           WS-ERNOTE-FILE-ID,
  6878           DFHEIV99
  6879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6880       ELSE
  6881         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6882           (NOTE-SUB > +10) OR
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 121
* EL6316.cbl
  6883           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6884         END-PERFORM
  6885         IF (NOTE-SUB < +11)
  6886           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6887              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6888                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6889           ELSE
  6890             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6891              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  6892                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6893                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6894             ELSE
  6895               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6896                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6897                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6898                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6899               ELSE
  6900                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6901                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6902                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6903                                       CN-BILLING-START-LINE-NO
  6904                 ELSE
  6905                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6906                 END-IF
  6907               END-IF
  6908             END-IF
  6909           END-IF
  6910           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6911           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6912           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6913
  6914* EXEC CICS REWRITE
  6915*             DATASET    (WS-ERNOTE-FILE-ID)
  6916*             FROM       (CERTIFICATE-NOTE)
  6917*             RESP       (WS-RESPONSE)
  6918*          END-EXEC
  6919     MOVE LENGTH OF
  6920      CERTIFICATE-NOTE
  6921       TO DFHEIV11
  6922*    MOVE '&& L                  %  N#00006538' TO DFHEIV0
  6923     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6924     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6925     MOVE X'204E233030303036353338' TO DFHEIV0(25:11)
  6926     CALL 'kxdfhei1' USING DFHEIV0,
  6927           WS-ERNOTE-FILE-ID,
  6928           CERTIFICATE-NOTE,
  6929           DFHEIV11,
  6930           DFHEIV99
  6931     MOVE EIBRESP  TO WS-RESPONSE
  6932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6933           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6934         END-IF
  6935       END-IF
  6936     ELSE
  6937        MOVE SPACES              TO CERTIFICATE-NOTE
  6938        MOVE 'CN'                TO CN-RECORD-ID
  6939        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6940                                     WS-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 122
* EL6316.cbl
  6941        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6942                                    CN-BILLING-END-LINE-NO
  6943        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  6944        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6945        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6946        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6947
  6948* EXEC CICS WRITE
  6949*          DATASET    (WS-ERNOTE-FILE-ID)
  6950*          FROM       (CERTIFICATE-NOTE)
  6951*          RIDFLD     (WS-ERNOTE-KEY)
  6952*          RESP       (WS-RESPONSE)
  6953*       END-EXEC
  6954     MOVE LENGTH OF
  6955      CERTIFICATE-NOTE
  6956       TO DFHEIV11
  6957*    MOVE '&$ L                  ''  N#00006557' TO DFHEIV0
  6958     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6960     MOVE X'204E233030303036353537' TO DFHEIV0(25:11)
  6961     CALL 'kxdfhei1' USING DFHEIV0,
  6962           WS-ERNOTE-FILE-ID,
  6963           CERTIFICATE-NOTE,
  6964           DFHEIV11,
  6965           WS-ERNOTE-KEY,
  6966           DFHEIV99,
  6967           DFHEIV99
  6968     MOVE EIBRESP  TO WS-RESPONSE
  6969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6970
  6971        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6972     END-IF
  6973
  6974     .
  6975 0441-EXIT.
  6976     EXIT.
  6977
  6978
  6979 0442-SQUEEZE-IT-IN.
  6980
  6981     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  6982        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  6983           NOTE-SUB = +10
  6984           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  6985           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  6986             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  6987             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  6988             MOVE +9 TO NOTE-SUB
  6989           END-IF
  6990        END-PERFORM
  6991     ELSE
  6992        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  6993           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  6994             UNTIL NOTE-SUB = +1
  6995             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  6996             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  6997                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  6998                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 123
* EL6316.cbl
  6999                MOVE +2          TO NOTE-SUB
  7000             END-IF
  7001           END-PERFORM
  7002        END-IF
  7003     END-IF
  7004
  7005     .
  7006 0442-EXIT.
  7007     EXIT.
  7008
  7009 0445-CERTIFICATE-UPDATE.
  7010    display 'billing note written, updating cert'
  7011     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7012     IF RESP-NORMAL
  7013        EVALUATE CM-NOTE-SW
  7014           WHEN '2'
  7015           WHEN '3'
  7016           WHEN '6'
  7017           WHEN '7'
  7018              SET NO-CERT-RW     TO TRUE
  7019           WHEN ' '
  7020              MOVE '2'           TO CM-NOTE-SW
  7021           WHEN '1'
  7022              MOVE '3'           TO CM-NOTE-SW
  7023           WHEN '4'
  7024              MOVE '6'           TO CM-NOTE-SW
  7025           WHEN '5'
  7026              MOVE '7'           TO CM-NOTE-SW
  7027        END-EVALUATE
  7028     END-IF
  7029     IF NOT NO-CERT-RW
  7030        PERFORM 1810-REWRITE-ELCERT
  7031                                 THRU 1810-EXIT
  7032     ELSE
  7033
  7034* EXEC CICS UNLOCK
  7035*          DATASET    (WS-ELCERT-FILE-ID)
  7036*       END-EXEC
  7037*    MOVE '&*                    #   #00006626' TO DFHEIV0
  7038     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7039     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7040     MOVE X'2020233030303036363236' TO DFHEIV0(25:11)
  7041     CALL 'kxdfhei1' USING DFHEIV0,
  7042           WS-ELCERT-FILE-ID,
  7043           DFHEIV99
  7044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7045     END-IF
  7046
  7047     .
  7048 0445-EXIT.
  7049     EXIT.
  7050
  7051 0450-GET-ERACCT.
  7052     DISPLAY ' MADE IT TO 0450 '
  7053     MOVE ' '                    TO WS-ERACCT-SW
  7054     MOVE ZEROS                  TO WS-CHGBACK
  7055                                    WS-CSO-PORTION
  7056                                    WS-ACCT-PORTION
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 124
* EL6316.cbl
  7057                                    WS-DIFF
  7058     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7059     IF RESP-NORMAL
  7060        DISPLAY ' GOOD STARTBR '
  7061        PERFORM 0470-READNEXT-ERACCT
  7062                                 THRU 0470-EXIT
  7063     END-IF
  7064     IF RESP-NORMAL
  7065        DISPLAY ' GOOD READNEXT '
  7066        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7067           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7068              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7069              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7070              SET ACCT-FOUND TO TRUE
  7071           ELSE
  7072              PERFORM 0470-READNEXT-ERACCT
  7073                                 THRU 0470-EXIT
  7074              IF RESP-NORMAL
  7075                 IF AM-CONTROL-PRIMARY (1:20)
  7076                    = EN-CONTROL-PRIMARY (1:20)
  7077                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7078                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7079                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7080                       SET ACCT-FOUND TO TRUE
  7081                    END-IF
  7082                 END-IF
  7083              END-IF
  7084           END-IF
  7085        END-IF
  7086     END-IF
  7087     IF ACCT-FOUND
  7088        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7089           (AM-COM-TYP (S1) = 'C' OR 'D')
  7090           OR (S1 > +10)
  7091        END-PERFORM
  7092        IF S1 < +11
  7093           MOVE AM-COMM-CHARGEBACK (S1)
  7094                                 TO WS-CHGBACK
  7095        END-IF
  7096     END-IF
  7097
  7098* EXEC CICS ENDBR
  7099*        DATASET     ('ERACCT')
  7100*    END-EXEC.
  7101     MOVE 'ERACCT' TO DFHEIV1
  7102     MOVE 0
  7103       TO DFHEIV11
  7104*    MOVE '&2                    $   #00006681' TO DFHEIV0
  7105     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7106     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7107     MOVE X'2020233030303036363831' TO DFHEIV0(25:11)
  7108     CALL 'kxdfhei1' USING DFHEIV0,
  7109           DFHEIV1,
  7110           DFHEIV11,
  7111           DFHEIV99
  7112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7113
  7114    .
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 125
* EL6316.cbl
  7115 0450-EXIT.
  7116     EXIT.
  7117 0460-STARTBR-ERACCT.
  7118     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7119     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7120     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7121
  7122* EXEC CICS STARTBR
  7123*        DATASET   ('ERACCT')
  7124*        RIDFLD    (WS-ERACCT-KEY)
  7125*        GTEQ
  7126*        RESP      (WS-RESPONSE)
  7127*    END-EXEC
  7128     MOVE 'ERACCT' TO DFHEIV1
  7129     MOVE 0
  7130       TO DFHEIV11
  7131*    MOVE '&,         G          &  N#00006691' TO DFHEIV0
  7132     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7133     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7134     MOVE X'204E233030303036363931' TO DFHEIV0(25:11)
  7135     CALL 'kxdfhei1' USING DFHEIV0,
  7136           DFHEIV1,
  7137           WS-ERACCT-KEY,
  7138           DFHEIV99,
  7139           DFHEIV11,
  7140           DFHEIV99
  7141     MOVE EIBRESP  TO WS-RESPONSE
  7142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7143     .
  7144 0460-EXIT.
  7145     EXIT.
  7146 0470-READNEXT-ERACCT.
  7147
  7148* EXEC CICS READNEXT
  7149*       SET      (ADDRESS OF ACCOUNT-MASTER)
  7150*       DATASET ('ERACCT')
  7151*       RIDFLD  (WS-ERACCT-KEY)
  7152*       RESP    (WS-RESPONSE)
  7153*    END-EXEC
  7154     MOVE 'ERACCT' TO DFHEIV1
  7155     MOVE 0
  7156       TO DFHEIV11
  7157*    MOVE '&.S                   )  N#00006701' TO DFHEIV0
  7158     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7159     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7160     MOVE X'204E233030303036373031' TO DFHEIV0(25:11)
  7161     CALL 'kxdfhei1' USING DFHEIV0,
  7162           DFHEIV1,
  7163           DFHEIV20,
  7164           DFHEIV99,
  7165           WS-ERACCT-KEY,
  7166           DFHEIV99,
  7167           DFHEIV11,
  7168           DFHEIV99,
  7169           DFHEIV99
  7170     SET ADDRESS OF ACCOUNT-MASTER TO
  7171         DFHEIV20
  7172     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 126
* EL6316.cbl
  7173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7174     .
  7175 0470-EXIT.
  7176     EXIT.
  7177 0491-ERNOTE-READ-UPDATE.
  7178
  7179* EXEC CICS READ
  7180*       UPDATE
  7181*       DATASET    (WS-ERNOTE-FILE-ID)
  7182*       RIDFLD     (WS-ERNOTE-KEY)
  7183*       SET        (ADDRESS OF CERTIFICATE-NOTE)
  7184*       RESP       (WS-RESPONSE)
  7185*    END-EXEC
  7186*    MOVE '&"S        EU         (  N#00006711' TO DFHEIV0
  7187     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7188     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7189     MOVE X'204E233030303036373131' TO DFHEIV0(25:11)
  7190     CALL 'kxdfhei1' USING DFHEIV0,
  7191           WS-ERNOTE-FILE-ID,
  7192           DFHEIV20,
  7193           DFHEIV99,
  7194           WS-ERNOTE-KEY,
  7195           DFHEIV99,
  7196           DFHEIV99,
  7197           DFHEIV99
  7198     SET ADDRESS OF CERTIFICATE-NOTE TO
  7199         DFHEIV20
  7200     MOVE EIBRESP  TO WS-RESPONSE
  7201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7202     .
  7203 0491-EXIT.
  7204     EXIT.
  7205 0492-REWRITE-ERNOTE.
  7206     MOVE 'E631'              TO CN-LAST-MAINT-USER
  7207     MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7208     MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7209
  7210* EXEC CICS REWRITE
  7211*       DATASET    (WS-ERNOTE-FILE-ID)
  7212*       FROM       (CERTIFICATE-NOTE)
  7213*       RESP       (WS-RESPONSE)
  7214*    END-EXEC
  7215     MOVE LENGTH OF
  7216      CERTIFICATE-NOTE
  7217       TO DFHEIV11
  7218*    MOVE '&& L                  %  N#00006725' TO DFHEIV0
  7219     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7220     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7221     MOVE X'204E233030303036373235' TO DFHEIV0(25:11)
  7222     CALL 'kxdfhei1' USING DFHEIV0,
  7223           WS-ERNOTE-FILE-ID,
  7224           CERTIFICATE-NOTE,
  7225           DFHEIV11,
  7226           DFHEIV99
  7227     MOVE EIBRESP  TO WS-RESPONSE
  7228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7229     .
  7230 0492-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 127
* EL6316.cbl
  7231     EXIT.
  7232 0493-SQUEEZE-ERNOTE.
  7233     IF CN-BILLING-START-LINE-NO > 0
  7234         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  7235     ELSE
  7236         MOVE +1                 TO NOTE-SUB
  7237     END-IF.
  7238
  7239     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7240        (NOTE-SUB > +9)
  7241        IF CN-LINE (NOTE-SUB) = SPACES
  7242           MOVE CN-LINE (NOTE-SUB + +1)
  7243                                 TO CN-LINE (NOTE-SUB)
  7244           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  7245        END-IF
  7246     END-PERFORM
  7247     .
  7248 0493-EXIT.
  7249     EXIT.
  7250 0500-ERENDT-READ-GTEQ.
  7251
  7252* EXEC CICS READ
  7253*        DATASET    (WS-ERENDT-FILE-ID)
  7254*        RIDFLD     (ERENDT-KEY)
  7255*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7256*        RESP       (WS-RESPONSE)
  7257*        GTEQ
  7258*    END-EXEC
  7259*    MOVE '&"S        G          (  N#00006752' TO DFHEIV0
  7260     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7261     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7262     MOVE X'204E233030303036373532' TO DFHEIV0(25:11)
  7263     CALL 'kxdfhei1' USING DFHEIV0,
  7264           WS-ERENDT-FILE-ID,
  7265           DFHEIV20,
  7266           DFHEIV99,
  7267           ERENDT-KEY,
  7268           DFHEIV99,
  7269           DFHEIV99,
  7270           DFHEIV99
  7271     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7272         DFHEIV20
  7273     MOVE EIBRESP  TO WS-RESPONSE
  7274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7275     IF NOT RESP-NORMAL
  7276        MOVE ER-2237             TO EMI-ERROR
  7277        PERFORM 9900-ERROR-FORMAT
  7278                                 THRU 9900-EXIT
  7279        MOVE -1                  TO CARRL
  7280        GO TO 8200-SEND-DATAONLY
  7281     END-IF
  7282     .
  7283 0500-EXIT.
  7284     EXIT.
  7285 0510-ERENDT-READNEXT.
  7286
  7287* EXEC CICS READNEXT
  7288*       DATASET    (WS-ERENDT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 128
* EL6316.cbl
  7289*       RIDFLD     (ERENDT-KEY)
  7290*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7291*       RESP       (WS-RESPONSE)
  7292*    END-EXEC
  7293     MOVE 0
  7294       TO DFHEIV11
  7295*    MOVE '&.S                   )  N#00006770' TO DFHEIV0
  7296     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7297     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7298     MOVE X'204E233030303036373730' TO DFHEIV0(25:11)
  7299     CALL 'kxdfhei1' USING DFHEIV0,
  7300           WS-ERENDT-FILE-ID,
  7301           DFHEIV20,
  7302           DFHEIV99,
  7303           ERENDT-KEY,
  7304           DFHEIV99,
  7305           DFHEIV11,
  7306           DFHEIV99,
  7307           DFHEIV99
  7308     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7309         DFHEIV20
  7310     MOVE EIBRESP  TO WS-RESPONSE
  7311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7312     IF NOT RESP-NORMAL
  7313        MOVE ER-2237             TO EMI-ERROR
  7314        PERFORM 9900-ERROR-FORMAT
  7315                                 THRU 9900-EXIT
  7316        MOVE -1                  TO CARRL
  7317        GO TO 8200-SEND-DATAONLY
  7318     END-IF
  7319     .
  7320 0510-EXIT.
  7321     EXIT.
  7322 0520-ERENDT-STARTBR.
  7323
  7324* EXEC CICS STARTBR
  7325*       DATASET    (WS-ERENDT-FILE-ID)
  7326*       RIDFLD     (ERENDT-KEY)
  7327*       RESP       (WS-RESPONSE)
  7328*    END-EXEC
  7329     MOVE 0
  7330       TO DFHEIV11
  7331*    MOVE '&,         G          &  N#00006787' TO DFHEIV0
  7332     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7333     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7334     MOVE X'204E233030303036373837' TO DFHEIV0(25:11)
  7335     CALL 'kxdfhei1' USING DFHEIV0,
  7336           WS-ERENDT-FILE-ID,
  7337           ERENDT-KEY,
  7338           DFHEIV99,
  7339           DFHEIV11,
  7340           DFHEIV99
  7341     MOVE EIBRESP  TO WS-RESPONSE
  7342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7343     IF NOT RESP-NORMAL
  7344        MOVE ER-2237             TO EMI-ERROR
  7345        PERFORM 9900-ERROR-FORMAT
  7346                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 129
* EL6316.cbl
  7347        MOVE -1                  TO CARRL
  7348        GO TO 8200-SEND-DATAONLY
  7349     END-IF
  7350     .
  7351 0520-EXIT.
  7352     EXIT.
  7353 0530-ERENDT-READPREV.
  7354
  7355* EXEC CICS READPREV
  7356*       DATASET    (WS-ERENDT-FILE-ID)
  7357*       RIDFLD     (ERENDT-KEY)
  7358*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7359*       RESP       (WS-RESPONSE)
  7360*    END-EXEC
  7361     MOVE 0
  7362       TO DFHEIV11
  7363*    MOVE '&0S                   )  N#00006803' TO DFHEIV0
  7364     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7365     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7366     MOVE X'204E233030303036383033' TO DFHEIV0(25:11)
  7367     CALL 'kxdfhei1' USING DFHEIV0,
  7368           WS-ERENDT-FILE-ID,
  7369           DFHEIV20,
  7370           DFHEIV99,
  7371           ERENDT-KEY,
  7372           DFHEIV99,
  7373           DFHEIV11,
  7374           DFHEIV99,
  7375           DFHEIV99
  7376     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7377         DFHEIV20
  7378     MOVE EIBRESP  TO WS-RESPONSE
  7379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7380     IF NOT RESP-NORMAL
  7381        MOVE ER-2238             TO EMI-ERROR
  7382        PERFORM 9900-ERROR-FORMAT
  7383                                 THRU 9900-EXIT
  7384        MOVE -1                  TO CARRL
  7385        GO TO 8200-SEND-DATAONLY
  7386     END-IF
  7387     .
  7388 0530-EXIT.
  7389     EXIT.
  7390 0600-CREATE-TEMP-STORAGE.
  7391
  7392* EXEC CICS WRITEQ TS
  7393*        QUEUE (QID)
  7394*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7395*        LENGTH(PI-COMM-LENGTH)
  7396*    END-EXEC
  7397*    MOVE '*"                    ''   #00006820' TO DFHEIV0
  7398     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7400     MOVE X'2020233030303036383230' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0,
  7402           QID,
  7403           PROGRAM-INTERFACE-BLOCK,
  7404           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 130
* EL6316.cbl
  7405           DFHEIV99,
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7409     display ' about to write map ' el631ii
  7410
  7411* EXEC CICS WRITEQ TS
  7412*        QUEUE (QID)
  7413*        FROM  (EL631II)
  7414*        LENGTH(MAP-LENGTH)
  7415*    END-EXEC.
  7416*    MOVE '*"                    ''   #00006826' TO DFHEIV0
  7417     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7418     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7419     MOVE X'2020233030303036383236' TO DFHEIV0(25:11)
  7420     CALL 'kxdfhei1' USING DFHEIV0,
  7421           QID,
  7422           EL631II,
  7423           MAP-LENGTH,
  7424           DFHEIV99,
  7425           DFHEIV99,
  7426           DFHEIV99
  7427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7428
  7429 0600-EXIT.
  7430      EXIT.
  7431 0610-RECOVER-TEMP-STORAGE.
  7432
  7433* EXEC CICS READQ TS
  7434*        QUEUE (QID)
  7435*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7436*        LENGTH(PI-COMM-LENGTH)
  7437*    END-EXEC
  7438*    MOVE '*$I    L              ''   #00006834' TO DFHEIV0
  7439     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7440     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7441     MOVE X'2020233030303036383334' TO DFHEIV0(25:11)
  7442     CALL 'kxdfhei1' USING DFHEIV0,
  7443           QID,
  7444           PROGRAM-INTERFACE-BLOCK,
  7445           PI-COMM-LENGTH,
  7446           DFHEIV99,
  7447           DFHEIV99,
  7448           DFHEIV99
  7449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7450
  7451* EXEC CICS READQ TS
  7452*        QUEUE (QID)
  7453*        INTO  (EL631II)
  7454*        LENGTH(MAP-LENGTH)
  7455*    END-EXEC
  7456*    MOVE '*$I    L              ''   #00006839' TO DFHEIV0
  7457     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7458     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7459     MOVE X'2020233030303036383339' TO DFHEIV0(25:11)
  7460     CALL 'kxdfhei1' USING DFHEIV0,
  7461           QID,
  7462           EL631II,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 131
* EL6316.cbl
  7463           MAP-LENGTH,
  7464           DFHEIV99,
  7465           DFHEIV99,
  7466           DFHEIV99
  7467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7468     display ' map ' EL631II
  7469     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7470     MOVE AL-UANON            TO LTRIDA
  7471     IF WS-SET-CODES-MDT = 'Y'
  7472        move +1                  to s2
  7473        perform varying s1 from +1 by +5 until s1 > +60
  7474           MOVE WS-PASSED-REASON-CODES (s1:4)
  7475                                 TO reacd-in (s2)
  7476           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7477               MOVE AL-SANON     TO REACDA (S2)
  7478               MOVE +4           TO REACDL (S2)
  7479           END-IF
  7480           add +1                to s2
  7481        end-perform
  7482        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7483     END-IF
  7484
  7485     IF CRTNT1I > SPACES
  7486         MOVE AL-UANON       TO CRTNT1A
  7487     END-IF
  7488
  7489     IF CRTNT2I > SPACES
  7490         MOVE AL-UANON       TO CRTNT2A
  7491     END-IF
  7492
  7493     IF BILNT1I > SPACES
  7494         MOVE AL-UANON       TO BILNT1A
  7495     END-IF
  7496     .
  7497 0610-EXIT.
  7498      EXIT.
  7499 0620-DELETE-TS.
  7500
  7501* EXEC CICS DELETEQ TS
  7502*        QUEUE(QID)
  7503*    END-EXEC
  7504*    MOVE '*&                    #   #00006876' TO DFHEIV0
  7505     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7506     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7507     MOVE X'2020233030303036383736' TO DFHEIV0(25:11)
  7508     CALL 'kxdfhei1' USING DFHEIV0,
  7509           QID,
  7510           DFHEIV99
  7511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7512     .
  7513 0620-EXIT.
  7514      EXIT.
  7515 1000-FINALIZE.
  7516     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  7517     IF NOT EMI-NO-ERRORS
  7518      AND EIBAID = DFHPF4
  7519        GO TO 8200-SEND-DATAONLY
  7520     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 132
* EL6316.cbl
  7521     display ' made it to 1000 '
  7522     set P to address of KIXSYS
  7523     CALL "getenv" using by value P returning var-ptr
  7524     if var-ptr = null then
  7525        display ' kixsys not set '
  7526     else
  7527        set address of var to var-ptr
  7528        move 0 to env-var-len
  7529        inspect var tallying env-var-len
  7530          for characters before X'00'
  7531*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  7532        unstring var (1:env-var-len) delimited by '/'
  7533           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  7534              WS-KIX-SYS
  7535        end-unstring
  7536*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  7537*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  7538     end-if
  7539     set P to address of KIXHOST
  7540     CALL "getenv" using by value P returning var-ptr
  7541     if var-ptr = null then
  7542        display ' kixhost not set '
  7543     else
  7544        set address of var to var-ptr
  7545        move 0 to env-var-len
  7546        inspect var tallying env-var-len
  7547          for characters before X'00'
  7548*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  7549        MOVE var(1:env-var-len)  to ws-kixhost
  7550        DISPLAY ' WS KIX HOST ' WS-KIXhost
  7551     end-if
  7552     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  7553     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  7554     IF RESP-NORMAL
  7555        AND (PI-ELCRTO-KEY (1:33) =
  7556              OC-CONTROL-PRIMARY (1:33))
  7557           DISPLAY ' RESP NORMAL AND = '
  7558           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  7559           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  7560           PERFORM 1100-CALL-NS-BUS-LOGIC
  7561                                    THRU 1100-EXIT
  7562           IF BL-OK
  7563              CONTINUE
  7564           ELSE
  7565              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  7566              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  7567              MOVE -1               TO CARRL
  7568           END-IF
  7569     ELSE
  7570        MOVE ER-3829             TO EMI-ERROR
  7571        PERFORM 9900-ERROR-FORMAT
  7572                                 THRU 9900-EXIT
  7573        MOVE -1                  TO CARRL
  7574        GO TO 8100-SEND-INITIAL-MAP
  7575     END-IF
  7576     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  7577     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  7578                                 TO SYSO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 133
* EL6316.cbl
  7579     MOVE WS-KIXHOST             TO HOSTO
  7580     MOVE PI-COMPANY-ID          TO COMPANYO
  7581     MOVE PI-PROCESSOR-ID        TO PROCIDO
  7582     MOVE '4'                    TO DATASORO
  7583     MOVE BL-BATCH-NO            TO BATCHNOO
  7584     MOVE BL-BATCH-SEQ           TO BSEQNOO
  7585     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  7586*    MOVE -1                     TO PRTSWL
  7587*    MOVE AL-UANON               TO PRTSWA
  7588     IF EIBAID = DFHPF4
  7589        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  7590        MOVE ER-0280             TO EMI-ERROR
  7591        PERFORM 9900-ERROR-FORMAT
  7592                                 THRU 9900-EXIT
  7593        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  7594        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7595        MOVE 'Y'                 TO PI-FINALIZED-IND
  7596        GO TO 9400-CLEAR
  7597     ELSE
  7598        MOVE ER-1818             TO EMI-ERROR
  7599        PERFORM 9900-ERROR-FORMAT
  7600                                 THRU 9900-EXIT
  7601     END-IF
  7602     GO TO 8100-SEND-INITIAL-MAP
  7603     .
  7604 1000-EXIT.
  7605     EXIT.
  7606 1100-CALL-NS-BUS-LOGIC.
  7607     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  7608     MOVE SPACES                 TO BL-INPUT
  7609     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7610     MOVE '4'                    TO BL-DATA-SRCE
  7611     MOVE PB-CARRIER             TO BL-CARRIER
  7612     MOVE PB-GROUPING            TO BL-GROUP
  7613     MOVE PB-STATE               TO BL-STATE
  7614     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7615     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7616        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7617        MOVE ' '                 TO DC-OPTION-CODE
  7618        PERFORM 9700-date-link
  7619        IF NO-CONVERSION-ERROR
  7620           MOVE DC-GREG-DATE-B-EDIT
  7621                                 TO BL-EFF-DT
  7622        END-IF
  7623     END-IF
  7624     MOVE PB-CERT-NO             TO BL-CERT-NO
  7625     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7626     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7627     MOVE SPACES                 TO BL-RESP-NO
  7628     MOVE LTRIDI                 TO BL-LETTER-ID
  7629     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7630     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7631*    MOVE 'ALWA'                 TO BL-PROC-ID
  7632     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7633     IF EIBAID = DFHPF4
  7634        MOVE 'B'                 TO BL-WRITE-ERARCH
  7635     ELSE
  7636        MOVE 'T'                 TO BL-WRITE-ERARCH
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 134
* EL6316.cbl
  7637     END-IF
  7638     MOVE SPACES                 TO BL-CERT-FORM-ID
  7639     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7640     MOVE 'CAN ENDT'             TO BL-SOURCE-SCREEN
  7641     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7642        IF REACD-IN (S1) NOT = LOW-VALUES
  7643           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7644        END-IF
  7645     END-PERFORM
  7646    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7647     DISPLAY ' BL INPUT ' BL-INPUT
  7648*****************************************
  7649* Invoke the LETTER business logic
  7650*****************************************
  7651     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  7652     display ' srch commarea ' srch-commarea
  7653     display ' length ' ws-comm-length
  7654
  7655* exec cics link
  7656*       program('NSRASBL')
  7657*       commarea(srch-commarea)
  7658*       LENGTH  (WS-COMM-LENGTH)
  7659*    end-exec.
  7660     MOVE 'NSRASBL' TO DFHEIV1
  7661*    MOVE '."C                   (   #00007021' TO DFHEIV0
  7662     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7663     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7664     MOVE X'2020233030303037303231' TO DFHEIV0(25:11)
  7665     CALL 'kxdfhei1' USING DFHEIV0,
  7666           DFHEIV1,
  7667           srch-commarea,
  7668           WS-COMM-LENGTH,
  7669           DFHEIV99,
  7670           DFHEIV99,
  7671           DFHEIV99,
  7672           DFHEIV99
  7673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7674
  7675     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7676        BL-MESSAGE
  7677     .
  7678 1100-EXIT.
  7679     EXIT.
  7680 1500-GET-ARCH-NO.
  7681     display ' made it to 1500 '
  7682     MOVE SPACES                 TO ELCNTL-KEY
  7683     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7684     MOVE '1'                    TO CNTL-REC-TYPE
  7685     MOVE ZEROS                  TO CNTL-SEQ
  7686
  7687* EXEC CICS READ
  7688*         DATASET    (WS-ELCNTL-FILE-ID)
  7689*         SET        (ADDRESS OF CONTROL-FILE)
  7690*         RIDFLD     (ELCNTL-KEY)
  7691*         UPDATE
  7692*         RESP       (WS-RESPONSE)
  7693*    END-EXEC
  7694*    MOVE '&"S        EU         (  N#00007037' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 135
* EL6316.cbl
  7695     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7696     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7697     MOVE X'204E233030303037303337' TO DFHEIV0(25:11)
  7698     CALL 'kxdfhei1' USING DFHEIV0,
  7699           WS-ELCNTL-FILE-ID,
  7700           DFHEIV20,
  7701           DFHEIV99,
  7702           ELCNTL-KEY,
  7703           DFHEIV99,
  7704           DFHEIV99,
  7705           DFHEIV99
  7706     SET ADDRESS OF CONTROL-FILE TO
  7707         DFHEIV20
  7708     MOVE EIBRESP  TO WS-RESPONSE
  7709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7710     IF RESP-NORMAL
  7711        display ' good read elcntl '
  7712        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7713           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7714        END-IF
  7715        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7716        MOVE CF-CREDIT-LAST-ARCH-NUM
  7717                                 TO W-ARCH-NUMBER
  7718        display ' new arch number ' w-arch-number
  7719
  7720* EXEC CICS REWRITE
  7721*          FROM      (CONTROL-FILE)
  7722*          DATASET   (WS-ELCNTL-FILE-ID)
  7723*       END-EXEC
  7724     MOVE LENGTH OF
  7725      CONTROL-FILE
  7726       TO DFHEIV11
  7727*    MOVE '&& L                  %   #00007053' TO DFHEIV0
  7728     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7729     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7730     MOVE X'2020233030303037303533' TO DFHEIV0(25:11)
  7731     CALL 'kxdfhei1' USING DFHEIV0,
  7732           WS-ELCNTL-FILE-ID,
  7733           CONTROL-FILE,
  7734           DFHEIV11,
  7735           DFHEIV99
  7736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7737     END-IF
  7738     .
  7739 1500-EXIT.
  7740     EXIT.
  7741
  7742
  7743 1700-WRITE-CERT-NOTE      SECTION.
  7744
  7745     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7746     MOVE ZERO           TO ERCNOT-SEQ.
  7747     SET TB-INDX         DOWN BY 1.
  7748     SET TB-INDX1        TO TB-INDX.
  7749
  7750****DELETE CURRENT CERT NOTES
  7751 1700-LOOP.
  7752
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 136
* EL6316.cbl
  7753* EXEC CICS READ
  7754*        DATASET (WS-ERCNOT-FILE-ID)
  7755*        RIDFLD  (ERCNOT-KEY)
  7756*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7757*        RESP    (WS-RESPONSE)
  7758*        GTEQ
  7759*    END-EXEC.
  7760*    MOVE '&"S        G          (  N#00007072' TO DFHEIV0
  7761     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7763     MOVE X'204E233030303037303732' TO DFHEIV0(25:11)
  7764     CALL 'kxdfhei1' USING DFHEIV0,
  7765           WS-ERCNOT-FILE-ID,
  7766           DFHEIV20,
  7767           DFHEIV99,
  7768           ERCNOT-KEY,
  7769           DFHEIV99,
  7770           DFHEIV99,
  7771           DFHEIV99
  7772     SET ADDRESS OF CERT-NOTE-FILE TO
  7773         DFHEIV20
  7774     MOVE EIBRESP  TO WS-RESPONSE
  7775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7776
  7777
  7778     IF NOT RESP-NORMAL
  7779        GO TO 1700-ENDDEL
  7780     END-IF
  7781
  7782     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7783
  7784     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7785         GO TO 1700-ENDDEL
  7786     END-IF.
  7787
  7788
  7789* EXEC CICS DELETE
  7790*        DATASET (WS-ERCNOT-FILE-ID)
  7791*        RIDFLD  (ERCNOT-KEY)
  7792*    END-EXEC.
  7793*    MOVE '&(  R                 &   #00007090' TO DFHEIV0
  7794     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7795     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7796     MOVE X'2020233030303037303930' TO DFHEIV0(25:11)
  7797     CALL 'kxdfhei1' USING DFHEIV0,
  7798           WS-ERCNOT-FILE-ID,
  7799           ERCNOT-KEY,
  7800           DFHEIV99,
  7801           DFHEIV99,
  7802           DFHEIV99
  7803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7804
  7805
  7806     GO TO 1700-LOOP.
  7807
  7808 1700-ENDDEL.
  7809
  7810
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 137
* EL6316.cbl
  7811* EXEC CICS GETMAIN
  7812*         LENGTH(ERCNOT-LENGTH)
  7813*         SET(ADDRESS OF CERT-NOTE-FILE)
  7814*         INITIMG(GETMAIN-SPACE)
  7815*    END-EXEC.
  7816*    MOVE ',"IL                  $   #00007099' TO DFHEIV0
  7817     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7818     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7819     MOVE X'2020233030303037303939' TO DFHEIV0(25:11)
  7820     CALL 'kxdfhei1' USING DFHEIV0,
  7821           DFHEIV20,
  7822           ERCNOT-LENGTH,
  7823           GETMAIN-SPACE
  7824     SET ADDRESS OF CERT-NOTE-FILE TO
  7825         DFHEIV20
  7826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7827
  7828
  7829     SET TB-INDX TO 1.
  7830     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7831     MOVE +0             TO ERCNOT-SEQ
  7832
  7833     PERFORM VARYING TB-INDX FROM 1 BY 1
  7834             UNTIL TB-INDX > TB-INDX1
  7835        MOVE SPACES                 TO  CERT-NOTE-FILE
  7836        ADD 1                       TO  ERCNOT-SEQ
  7837        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7838        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7839        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7840        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7841                                    TO  CZ-LAST-MAINT-USER
  7842        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7843                                    TO  CZ-LAST-MAINT-HHMMSS
  7844        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7845                                    TO  CZ-LAST-MAINT-DT
  7846
  7847
  7848* EXEC CICS WRITE
  7849*            DATASET(WS-ERCNOT-FILE-ID)
  7850*            FROM(CERT-NOTE-FILE)
  7851*            RIDFLD(ERCNOT-KEY)
  7852*       END-EXEC
  7853     MOVE LENGTH OF
  7854      CERT-NOTE-FILE
  7855       TO DFHEIV11
  7856*    MOVE '&$ L                  ''   #00007123' TO DFHEIV0
  7857     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7859     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7860     CALL 'kxdfhei1' USING DFHEIV0,
  7861           WS-ERCNOT-FILE-ID,
  7862           CERT-NOTE-FILE,
  7863           DFHEIV11,
  7864           ERCNOT-KEY,
  7865           DFHEIV99,
  7866           DFHEIV99
  7867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7868     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 138
* EL6316.cbl
  7869
  7870     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7871     IF RESP-NORMAL
  7872        EVALUATE CM-NOTE-SW
  7873           WHEN '1'
  7874           WHEN '3'
  7875           WHEN '5'
  7876           WHEN '7'
  7877              SET NO-CERT-RW     TO TRUE
  7878           WHEN ' '
  7879              MOVE '1'           TO CM-NOTE-SW
  7880           WHEN '2'
  7881              MOVE '3'           TO CM-NOTE-SW
  7882           WHEN '4'
  7883              MOVE '5'           TO CM-NOTE-SW
  7884           WHEN '6'
  7885              MOVE '7'           TO CM-NOTE-SW
  7886        END-EVALUATE
  7887     END-IF
  7888     IF NOT NO-CERT-RW
  7889        PERFORM 1810-REWRITE-ELCERT
  7890                                 THRU 1810-EXIT
  7891     ELSE
  7892
  7893* EXEC CICS UNLOCK
  7894*          DATASET    (WS-ELCERT-FILE-ID)
  7895*       END-EXEC
  7896*    MOVE '&*                    #   #00007152' TO DFHEIV0
  7897     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7898     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7899     MOVE X'2020233030303037313532' TO DFHEIV0(25:11)
  7900     CALL 'kxdfhei1' USING DFHEIV0,
  7901           WS-ELCERT-FILE-ID,
  7902           DFHEIV99
  7903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7904     END-IF
  7905
  7906     .
  7907 1799-EXIT.
  7908     EXIT.
  7909
  7910 1800-READ-ELCERT-UPDATE.
  7911
  7912     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7913     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7914     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7915     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7916     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7917     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7918     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7919     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7920
  7921
  7922* EXEC CICS READ
  7923*        UPDATE
  7924*        DATASET  (WS-ELCERT-FILE-ID)
  7925*        RIDFLD   (WS-ELCERT-KEY)
  7926*        SET      (ADDRESS OF CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 139
* EL6316.cbl
  7927*        RESP     (WS-RESPONSE)
  7928*    END-EXEC
  7929*    MOVE '&"S        EU         (  N#00007172' TO DFHEIV0
  7930     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7931     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7932     MOVE X'204E233030303037313732' TO DFHEIV0(25:11)
  7933     CALL 'kxdfhei1' USING DFHEIV0,
  7934           WS-ELCERT-FILE-ID,
  7935           DFHEIV20,
  7936           DFHEIV99,
  7937           WS-ELCERT-KEY,
  7938           DFHEIV99,
  7939           DFHEIV99,
  7940           DFHEIV99
  7941     SET ADDRESS OF CERTIFICATE-MASTER TO
  7942         DFHEIV20
  7943     MOVE EIBRESP  TO WS-RESPONSE
  7944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7945
  7946     .
  7947 1800-EXIT.
  7948     EXIT.
  7949
  7950 1810-REWRITE-ELCERT.
  7951
  7952
  7953* EXEC CICS REWRITE
  7954*        FROM     (CERTIFICATE-MASTER)
  7955*        DATASET  (WS-ELCERT-FILE-ID)
  7956*        RESP     (WS-RESPONSE)
  7957*    END-EXEC.
  7958     MOVE LENGTH OF
  7959      CERTIFICATE-MASTER
  7960       TO DFHEIV11
  7961*    MOVE '&& L                  %  N#00007186' TO DFHEIV0
  7962     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7963     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7964     MOVE X'204E233030303037313836' TO DFHEIV0(25:11)
  7965     CALL 'kxdfhei1' USING DFHEIV0,
  7966           WS-ELCERT-FILE-ID,
  7967           CERTIFICATE-MASTER,
  7968           DFHEIV11,
  7969           DFHEIV99
  7970     MOVE EIBRESP  TO WS-RESPONSE
  7971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7972
  7973
  7974     .
  7975 1810-EXIT.
  7976     EXIT.
  7977
  7978 8100-SEND-INITIAL-MAP.
  7979     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7980     MOVE '5'                    TO DC-OPTION-CODE.
  7981     PERFORM 9700-DATE-LINK.
  7982     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7983     MOVE EIBTIME                TO TIME-IN.
  7984     MOVE TIME-OUT               TO TIMEO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 140
* EL6316.cbl
  7985     MOVE -1                     TO LTRIDL
  7986*    MOVE AL-UANON               TO PRTSWA
  7987     IF PI-PROCESSOR-IS-CSR-SUPER
  7988        perform varying s1 from +1 by +1 until
  7989           s1 > +12
  7990           MOVE AL-UANON            TO reacda (s1)
  7991        end-perform
  7992     END-IF
  7993     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  7994
  7995* EXEC CICS SEND
  7996*        MAP      (MAP-NAME)
  7997*        MAPSET   (MAPSET-NAME)
  7998*        FROM     (EL631IO)
  7999*        ERASE
  8000*        CURSOR
  8001*    END-EXEC.
  8002     MOVE LENGTH OF
  8003      EL631IO
  8004       TO DFHEIV12
  8005     MOVE -1
  8006       TO DFHEIV11
  8007*    MOVE '8$     CT  E    H L F ,   #00007212' TO DFHEIV0
  8008     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8009     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8010     MOVE X'2020233030303037323132' TO DFHEIV0(25:11)
  8011     CALL 'kxdfhei1' USING DFHEIV0,
  8012           MAP-NAME,
  8013           EL631IO,
  8014           DFHEIV12,
  8015           MAPSET-NAME,
  8016           DFHEIV99,
  8017           DFHEIV99,
  8018           DFHEIV99,
  8019           DFHEIV11,
  8020           DFHEIV99,
  8021           DFHEIV99,
  8022           DFHEIV99
  8023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8024
  8025     GO TO 9100-RETURN-TRAN.
  8026 8200-SEND-DATAONLY.
  8027     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8028     MOVE '5'                    TO DC-OPTION-CODE.
  8029     PERFORM 9700-DATE-LINK.
  8030     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8031     MOVE EIBTIME                TO TIME-IN.
  8032     MOVE TIME-OUT               TO TIMEO.
  8033     MOVE -1                     TO PFENTRL
  8034     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  8035
  8036* EXEC CICS SEND
  8037*        MAP      (MAP-NAME)
  8038*        MAPSET   (MAPSET-NAME)
  8039*        FROM     (EL631IO)
  8040*        DATAONLY
  8041*        ERASEAUP
  8042*        CURSOR
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 141
* EL6316.cbl
  8043*    END-EXEC.
  8044     MOVE LENGTH OF
  8045      EL631IO
  8046       TO DFHEIV12
  8047     MOVE -1
  8048       TO DFHEIV11
  8049*    MOVE '8$D    CT  A    H L F ,   #00007229' TO DFHEIV0
  8050     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8051     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8052     MOVE X'2020233030303037323239' TO DFHEIV0(25:11)
  8053     CALL 'kxdfhei1' USING DFHEIV0,
  8054           MAP-NAME,
  8055           EL631IO,
  8056           DFHEIV12,
  8057           MAPSET-NAME,
  8058           DFHEIV99,
  8059           DFHEIV99,
  8060           DFHEIV99,
  8061           DFHEIV11,
  8062           DFHEIV99,
  8063           DFHEIV99,
  8064           DFHEIV99
  8065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8066
  8067     GO TO 9100-RETURN-TRAN.
  8068 8300-SEND-TEXT.
  8069
  8070* EXEC CICS SEND TEXT
  8071*        FROM     (LOGOFF-TEXT)
  8072*        LENGTH   (LOGOFF-LENGTH)
  8073*        ERASE
  8074*        FREEKB
  8075*    END-EXEC.
  8076*    MOVE '8&      T  E F  H   F -   #00007239' TO DFHEIV0
  8077     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8078     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8079     MOVE X'2020233030303037323339' TO DFHEIV0(25:11)
  8080     CALL 'kxdfhei1' USING DFHEIV0,
  8081           LOGOFF-TEXT,
  8082           LOGOFF-LENGTH,
  8083           DFHEIV99,
  8084           DFHEIV99,
  8085           DFHEIV99,
  8086           DFHEIV99,
  8087           DFHEIV99,
  8088           DFHEIV99,
  8089           DFHEIV99,
  8090           DFHEIV99,
  8091           DFHEIV99,
  8092           DFHEIV99
  8093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8094
  8095
  8096* EXEC CICS RETURN
  8097*    END-EXEC.
  8098*    MOVE '.(                    ''   #00007245' TO DFHEIV0
  8099     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 142
* EL6316.cbl
  8101     MOVE X'2020233030303037323435' TO DFHEIV0(25:11)
  8102     CALL 'kxdfhei1' USING DFHEIV0,
  8103           DFHEIV99,
  8104           DFHEIV99,
  8105           DFHEIV99,
  8106           DFHEIV99,
  8107           DFHEIV99,
  8108           DFHEIV99
  8109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8110
  8111 8800-UNAUTHORIZED-ACCESS.
  8112     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8113     GO TO 8300-SEND-TEXT.
  8114 8810-PF23.
  8115     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8116     MOVE XCTL-005               TO PGM-NAME.
  8117     GO TO 9300-XCTL.
  8118 9000-RETURN-CICS.
  8119
  8120* EXEC CICS RETURN
  8121*    END-EXEC.
  8122*    MOVE '.(                    ''   #00007255' TO DFHEIV0
  8123     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8124     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8125     MOVE X'2020233030303037323535' TO DFHEIV0(25:11)
  8126     CALL 'kxdfhei1' USING DFHEIV0,
  8127           DFHEIV99,
  8128           DFHEIV99,
  8129           DFHEIV99,
  8130           DFHEIV99,
  8131           DFHEIV99,
  8132           DFHEIV99
  8133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8134
  8135 9100-RETURN-TRAN.
  8136     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8137     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8138
  8139* EXEC CICS RETURN
  8140*        TRANSID    (TRANS-ID)
  8141*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8142*        LENGTH     (1300)
  8143*    END-EXEC.
  8144     MOVE 1300
  8145       TO DFHEIV11
  8146*    MOVE '.(CT                  ''   #00007260' TO DFHEIV0
  8147     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8148     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8149     MOVE X'2020233030303037323630' TO DFHEIV0(25:11)
  8150     CALL 'kxdfhei1' USING DFHEIV0,
  8151           TRANS-ID,
  8152           PROGRAM-INTERFACE-BLOCK,
  8153           DFHEIV11,
  8154           DFHEIV99,
  8155           DFHEIV99,
  8156           DFHEIV99
  8157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8158
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 143
* EL6316.cbl
  8159 9200-RETURN-MAIN-MENU.
  8160     MOVE XCTL-626               TO PGM-NAME.
  8161     GO TO 9300-XCTL.
  8162 9300-XCTL.
  8163
  8164* EXEC CICS XCTL
  8165*        PROGRAM    (PGM-NAME)
  8166*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8167*        LENGTH     (1300)
  8168*    END-EXEC.
  8169     MOVE 1300
  8170       TO DFHEIV11
  8171*    MOVE '.$C                   %   #00007269' TO DFHEIV0
  8172     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8173     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8174     MOVE X'2020233030303037323639' TO DFHEIV0(25:11)
  8175     CALL 'kxdfhei1' USING DFHEIV0,
  8176           PGM-NAME,
  8177           PROGRAM-INTERFACE-BLOCK,
  8178           DFHEIV11,
  8179           DFHEIV99
  8180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8181
  8182 9400-CLEAR.
  8183     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8184
  8185* EXEC CICS XCTL
  8186*        PROGRAM    (PGM-NAME)
  8187*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8188*        LENGTH     (1300)
  8189*    END-EXEC.
  8190     MOVE 1300
  8191       TO DFHEIV11
  8192*    MOVE '.$C                   %   #00007276' TO DFHEIV0
  8193     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8194     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8195     MOVE X'2020233030303037323736' TO DFHEIV0(25:11)
  8196     CALL 'kxdfhei1' USING DFHEIV0,
  8197           PGM-NAME,
  8198           PROGRAM-INTERFACE-BLOCK,
  8199           DFHEIV11,
  8200           DFHEIV99
  8201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8202
  8203 9500-PF12.
  8204     MOVE XCTL-010               TO PGM-NAME.
  8205     GO TO 9300-XCTL.
  8206 9600-PGMID-ERROR.
  8207
  8208* EXEC CICS HANDLE CONDITION
  8209*        PGMIDERR    (8300-SEND-TEXT)
  8210*    END-EXEC.
  8211*    MOVE '"$L                   ! " #00007285' TO DFHEIV0
  8212     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8214     MOVE X'2220233030303037323835' TO DFHEIV0(25:11)
  8215     CALL 'kxdfhei1' USING DFHEIV0
  8216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 144
* EL6316.cbl
  8217
  8218     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8219     MOVE ' '                    TO PI-ENTRY-CD-1.
  8220     MOVE XCTL-005               TO PGM-NAME.
  8221     MOVE PGM-NAME               TO LOGOFF-PGM.
  8222     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8223     GO TO 9300-XCTL.
  8224 9700-DATE-LINK.
  8225     MOVE LINK-ELDATCV           TO PGM-NAME.
  8226
  8227* EXEC CICS LINK
  8228*        PROGRAM    (PGM-NAME)
  8229*        COMMAREA   (DATE-CONVERSION-DATA)
  8230*        LENGTH     (DC-COMM-LENGTH)
  8231*    END-EXEC.
  8232*    MOVE '."C                   (   #00007296' TO DFHEIV0
  8233     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8235     MOVE X'2020233030303037323936' TO DFHEIV0(25:11)
  8236     CALL 'kxdfhei1' USING DFHEIV0,
  8237           PGM-NAME,
  8238           DATE-CONVERSION-DATA,
  8239           DC-COMM-LENGTH,
  8240           DFHEIV99,
  8241           DFHEIV99,
  8242           DFHEIV99,
  8243           DFHEIV99
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8245
  8246 9900-ERROR-FORMAT.
  8247     IF NOT EMI-ERRORS-COMPLETE
  8248        MOVE LINK-001            TO PGM-NAME
  8249
  8250* EXEC CICS LINK
  8251*           PROGRAM    (PGM-NAME)
  8252*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8253*           LENGTH     (EMI-COMM-LENGTH)
  8254*       END-EXEC
  8255*    MOVE '."C                   (   #00007304' TO DFHEIV0
  8256     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8258     MOVE X'2020233030303037333034' TO DFHEIV0(25:11)
  8259     CALL 'kxdfhei1' USING DFHEIV0,
  8260           PGM-NAME,
  8261           ERROR-MESSAGE-INTERFACE-BLOCK,
  8262           EMI-COMM-LENGTH,
  8263           DFHEIV99,
  8264           DFHEIV99,
  8265           DFHEIV99,
  8266           DFHEIV99
  8267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8268     END-IF
  8269     .
  8270 9900-EXIT.
  8271     EXIT.
  8272 9990-ABEND.
  8273     MOVE LINK-004               TO PGM-NAME.
  8274     MOVE DFHEIBLK               TO EMI-LINE1.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 145
* EL6316.cbl
  8275
  8276* EXEC CICS LINK
  8277*        PROGRAM   (PGM-NAME)
  8278*        COMMAREA  (EMI-LINE1)
  8279*        LENGTH    (72)
  8280*    END-EXEC.
  8281     MOVE 72
  8282       TO DFHEIV11
  8283*    MOVE '."C                   (   #00007316' TO DFHEIV0
  8284     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8285     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8286     MOVE X'2020233030303037333136' TO DFHEIV0(25:11)
  8287     CALL 'kxdfhei1' USING DFHEIV0,
  8288           PGM-NAME,
  8289           EMI-LINE1,
  8290           DFHEIV11,
  8291           DFHEIV99,
  8292           DFHEIV99,
  8293           DFHEIV99,
  8294           DFHEIV99
  8295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8296
  8297     GO TO 8200-SEND-DATAONLY.
  8298
  8299* GOBACK.
  8300     MOVE '9%                    "   ' TO DFHEIV0
  8301     MOVE 'EL6316' TO DFHEIV1
  8302     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8303     GOBACK.
  8304 9995-SECURITY-VIOLATION.
  8305*                            COPY ELCSCTP.
  8306******************************************************************
  8307*                                                                *
  8308*                            ELCSCTP                             *
  8309*                            VMOD=2.001                          *
  8310*                                                                *
  8311*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8312******************************************************************
  8313
  8314
  8315     MOVE EIBDATE          TO SM-JUL-DATE.
  8316     MOVE EIBTRMID         TO SM-TERMID.
  8317     MOVE THIS-PGM         TO SM-PGM.
  8318     MOVE EIBTIME          TO TIME-IN.
  8319     MOVE TIME-OUT         TO SM-TIME.
  8320     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8321
  8322
  8323* EXEC CICS LINK
  8324*         PROGRAM  ('EL003')
  8325*         COMMAREA (SECURITY-MESSAGE)
  8326*         LENGTH   (80)
  8327*    END-EXEC.
  8328     MOVE 'EL003' TO DFHEIV1
  8329     MOVE 80
  8330       TO DFHEIV11
  8331*    MOVE '."C                   (   #00007341' TO DFHEIV0
  8332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page 146
* EL6316.cbl
  8333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8334     MOVE X'2020233030303037333431' TO DFHEIV0(25:11)
  8335     CALL 'kxdfhei1' USING DFHEIV0,
  8336           DFHEIV1,
  8337           SECURITY-MESSAGE,
  8338           DFHEIV11,
  8339           DFHEIV99,
  8340           DFHEIV99,
  8341           DFHEIV99,
  8342           DFHEIV99
  8343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8344
  8345
  8346******************************************************************
  8347
  8348 9995-EXIT.
  8349     EXIT.
  8350
  8351 9999-DFHBACK SECTION.
  8352     MOVE '9%                    "   ' TO DFHEIV0
  8353     MOVE 'EL6316' TO DFHEIV1
  8354     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8355     GOBACK.
  8356 9999-DFHEXIT.
  8357     IF DFHEIGDJ EQUAL 0001
  8358         NEXT SENTENCE
  8359     ELSE IF DFHEIGDJ EQUAL 2
  8360         GO TO 8300-SEND-TEXT
  8361         DEPENDING ON DFHEIGDI.
  8362     MOVE '9%                    "   ' TO DFHEIV0
  8363     MOVE 'EL6316' TO DFHEIV1
  8364     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8365     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34536     Code:       19250
