* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL680.cbl
* Options: int("EL680.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL680.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL680.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL680.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL680 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:21:06.
     7*                            VMOD 2.015
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL680.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXF6 - PAYMENT CALCULATIONS.
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34******************************************************************
    35
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL680.cbl
    37 ENVIRONMENT DIVISION.
    38
    39 DATA DIVISION.
    40
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*   EL680  WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '************VMOD=2.015 *********'.
    46
    47 01  WS-DATE-AREA.
    48     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    49     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    50
    51 01  ACCESS-KEYS.
    52     12  ELCNTL-KEY.
    53         16  CNTL-COMP-ID    PIC XXX.
    54         16  CNTL-REC-TYPE   PIC X.
    55         16  CNTL-ACCESS     PIC X(4).
    56         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
    57
    58 01  SPC-FLD.
    59     03  SPC-FLD-9    PIC 99.
    60
    61*********************  INPUT AREAS *******************************
    62 01  FILLER.
    63     05  WS-NAME                 PIC X(20)           VALUE SPACES.
    64     05  WS-FREQ                 PIC XX              VALUE SPACES.
    65     05  WS-BASIS-X              PIC XX              VALUE SPACES.
    66     05  WS-NPBEN                PIC X               VALUE SPACES.
    67     05  WS-BALYN                PIC X               VALUE SPACES.
    68     05  WS-OBYN                 PIC X               VALUE SPACES.
    69     05  WS-ADDCHG               PIC X               VALUE SPACES.
    70         88 NO-CHG                                   VALUE ' '.
    71         88 CHG-LF                                   VALUE '1'.
    72         88 CHG-AH                                   VALUE '2'.
    73         88 CHG-LF-AH                                VALUE '3'.
    74
    75 01  FILLER      COMP-3.
    76     05  WS-AMOUNT-REQUESTED     PIC S9(9)V99        VALUE +0.
    77     05  WS-APR                  PIC S9(6)V9(8)      VALUE +0.
    78     05  WS-NUMBER-OF-PMTS       PIC S999            VALUE +0.
    79     05  WS-ADDTL-DAYS           PIC S999            VALUE +0.
    80     05  WS-TRUNC                PIC S999            VALUE +0.
    81     05  WS-EXTRA                PIC S9              VALUE +0.
    82     05  WS-LIFE-RATE            PIC S9(6)V9(8)      VALUE +0.
    83     05  WS-LIFE-DEVIATION       PIC S9(6)V9(8)      VALUE +0.
    84     05  WS-AH-RATE              PIC S9(6)V9(8)      VALUE +0.
    85     05  WS-BL-RATE              PIC S9(6)V9(8)      VALUE +0.
    86     05  WS-AH-DEVIATION         PIC S9(6)V9(8)      VALUE +0.
    87     05  WS-PAYMENTS-COVERED     PIC S999            VALUE +0.
    88     05  WS-BALLOON-AMOUNT       PIC S9(6)V99        VALUE +0.
    89*    05  WS-REGULAR-PAYMENT      PIC S9(6)V99        VALUE +0.
    90
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL680.cbl
    92
    93 01  FILLER         COMP-3.
    94     05  ANGLM                   PIC S9(7)V9(11) VALUE ZERO.
    95     05  ANGLN                   PIC S9(7)V9(11) VALUE ZERO.
    96
    97     05  AHN                     PIC S999        VALUE ZERO.
    98     05  ATF                     PIC S9(7)V9(11) VALUE ZERO.
    99     05  EMII                    PIC S999        VALUE ZERO.
   100     05  OTF                     PIC S9(7)V9(11) VALUE ZERO.
   101     05  PPY                     PIC S999        VALUE ZERO.
   102
   103     05  CA                      PIC S9(7)V9(11) VALUE ZERO.
   104     05  I                       PIC S9(7)V9(11) VALUE ZERO.
   105     05  K1                      PIC S9(7)V9(11) VALUE ZERO.
   106     05  L                       PIC S9(7)V9(11) VALUE ZERO.
   107     05  L1                      PIC S9(7)V9(11) VALUE ZERO.
   108     05  M                       PIC S9(7)V9(11) VALUE ZERO.
   109     05  N                       PIC S9(5)       VALUE ZERO.
   110     05  N1                      PIC S9(7)V9(11) VALUE ZERO.
   111     05  RA                      PIC S9(7)V9(11) VALUE ZERO.
   112     05  TA                      PIC S9(7)V9(11) VALUE ZERO.
   113     05  V                       PIC S9(7)V9(11) VALUE ZERO.
   114     05  VA                      PIC S9(7)V9(11) VALUE ZERO.
   115     05  VU                      PIC S9(7)V9(11) VALUE ZERO.
   116     05  VU1                     PIC S9(7)V9(11) VALUE ZERO.
   117
   118     05  NALF                    PIC S9(7)V9(11) VALUE ZERO.
   119     05  NPLF                    PIC S9(7)V9(11) VALUE ZERO.
   120     05  PADJ                    PIC S9(7)V9(11) VALUE ZERO.
   121
   122     05  TOT-PMTS                PIC S9(7)V9(11) VALUE ZERO.
   123     05  ATOT-PMTS               PIC S9(7)V9(11) VALUE ZERO.
   124     05  ADL-DAYS                PIC S999        VALUE ZERO.
   125     05  ADL-ADJ                 PIC S9(7)V9(11) VALUE ZERO.
   126     05  COV-TERM                PIC S999        VALUE ZERO.
   127
   128     05  LIFE-RATE               PIC S9(7)V9(11) VALUE ZERO.
   129     05  LIFEDEV                 PIC S9(7)V9(11) VALUE ZERO.
   130     05  LR                      PIC S9(7)V9(11) VALUE ZERO.
   131     05  LIFE-PREM               PIC S9(7)V9(11) VALUE ZERO.
   132
   133     05  AH-RATE                 PIC S9(7)V9(11) VALUE ZERO.
   134     05  AHDEV                   PIC S9(7)V9(11) VALUE ZERO.
   135     05  AH                      PIC S9(7)V9(11) VALUE ZERO.
   136     05  AH-PREM                 PIC S9(7)V9(11) VALUE ZERO.
   137
   138     05  BL-RATE                 PIC S9(7)V9(11) VALUE ZERO.
   139     05  BL                      PIC S9(7)V9(11) VALUE ZERO.
   140
   141************ OUTPUT AREAS ******
   142     05  L-PREMIUM               PIC S9(7)V99    VALUE ZERO.
   143     05  A-PREMIUM               PIC S9(7)V99    VALUE ZERO.
   144     05  PAYMENT                 PIC S9(7)V99    VALUE ZERO.
   145     05  TOT-FIN                 PIC S9(7)V99    VALUE ZERO.
   146     05  TOT-PAYMT               PIC S9(7)V99    VALUE ZERO.
   147     05  TOT-INTRS               PIC S9(7)V99    VALUE ZERO.
   148
   149 01  FILLER         COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL680.cbl
   150     05  V-NTH                   PIC S9(7)V9(11) VALUE ZERO.
   151     05  B                       PIC S9(7)V9(11) VALUE ZERO.
   152     05  ANGLN-LESS-1            PIC S9(7)V9(11) VALUE ZERO.
   153     05  NM1                     PIC S9(7)V9(11) VALUE ZERO.
   154     05  AEQ                     PIC S9(7)V9(11) VALUE ZERO.
   155     05  MPT                     PIC S9(7)V9(11) VALUE ZERO.
   156     05  MPB                     PIC S9(7)V9(11) VALUE ZERO.
   157     05  MP                      PIC S9(7)V9(11) VALUE ZERO.
   158     05  IA                      PIC S9(7)V9(11) VALUE ZERO.
   159
   160 01  FILLER.
   161     05  XREPT                       PIC S999    COMP.
   162     05  WS-ERROR-COUNT              PIC S999        VALUE ZERO.
   163     05  WS-MESSAGE                  PIC X(79).
   164     05  WS-BASIS                    PIC S99         VALUE ZERO.
   165     05  WS-TIME-WORK                PIC S9(7)    VALUE ZERO.
   166     05  WS-TIME                     REDEFINES
   167         WS-TIME-WORK                PIC S999V9(4).
   168
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL680.cbl
   170 01  ERROR-MESSAGES.
   171     12  ER-0004                 PIC X(4)  VALUE '0004'.
   172     12  ER-0008                 PIC X(4)  VALUE '0008'.
   173     12  ER-0029                 PIC X(4)  VALUE '0029'.
   174     12  ER-0042                 PIC X(4)  VALUE '0042'.
   175     12  ER-0190                 PIC X(4)  VALUE '0190'.
   176     12  ER-0412                 PIC X(4)  VALUE '0412'.
   177     12  ER-0413                 PIC X(4)  VALUE '0413'.
   178     12  ER-2361                 PIC X(4)  VALUE '2361'.
   179     12  ER-2363                 PIC X(4)  VALUE '2363'.
   180     12  ER-2364                 PIC X(4)  VALUE '2364'.
   181     12  ER-2365                 PIC X(4)  VALUE '2365'.
   182     12  ER-2366                 PIC X(4)  VALUE '2366'.
   183     12  ER-2367                 PIC X(4)  VALUE '2367'.
   184     12  ER-2920                 PIC X(4)  VALUE '2920'.
   185     12  ER-2921                 PIC X(4)  VALUE '2921'.
   186     12  ER-2922                 PIC X(4)  VALUE '2922'.
   187     12  ER-2923                 PIC X(4)  VALUE '2923'.
   188     12  ER-2924                 PIC X(4)  VALUE '2924'.
   189     12  ER-2925                 PIC X(4)  VALUE '2925'.
   190     12  ER-2926                 PIC X(4)  VALUE '2926'.
   191     12  ER-2927                 PIC X(4)  VALUE '2927'.
   192     12  ER-4004                 PIC X(4)  VALUE '4004'.
   193     12  ER-4007                 PIC X(4)  VALUE '4007'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL680.cbl
   195 01  STANDARD-AREAS.
   196     12  MAPSET-NAME         PIC X(8)    VALUE 'EL680S'.
   197     12  MAP-NAME            PIC X(8)    VALUE 'EL680A'.
   198     12  SCREEN-NUMBER       PIC X(4)    VALUE '680A'.
   199     12  TRANS-ID            PIC X(4)    VALUE 'EXF6'.
   200     12  START-TRANS-ID      PIC X(4)    VALUE 'EXF7'.
   201     12  THIS-PGM            PIC X(8)    VALUE 'EL680'.
   202     12  PGM-NAME            PIC X(8).
   203     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   204     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   205     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   206     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   207     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   208
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL680.cbl
   210*                            COPY EL680S.
   211 01  EL680AI.
   212     05  FILLER            PIC  X(0012).
   213*    -------------------------------
   214     05  ADATEL PIC S9(0004) COMP.
   215     05  ADATEF PIC  X(0001).
   216     05  FILLER REDEFINES ADATEF.
   217         10  ADATEA PIC  X(0001).
   218     05  ADATEI PIC  X(0008).
   219*    -------------------------------
   220     05  ATIMEL PIC S9(0004) COMP.
   221     05  ATIMEF PIC  X(0001).
   222     05  FILLER REDEFINES ATIMEF.
   223         10  ATIMEA PIC  X(0001).
   224     05  ATIMEI PIC  X(0005).
   225*    -------------------------------
   226     05  ACOMPIDL PIC S9(0004) COMP.
   227     05  ACOMPIDF PIC  X(0001).
   228     05  FILLER REDEFINES ACOMPIDF.
   229         10  ACOMPIDA PIC  X(0001).
   230     05  ACOMPIDI PIC  X(0003).
   231*    -------------------------------
   232     05  ANAMEL PIC S9(0004) COMP.
   233     05  ANAMEF PIC  X(0001).
   234     05  FILLER REDEFINES ANAMEF.
   235         10  ANAMEA PIC  X(0001).
   236     05  ANAMEI PIC  X(0020).
   237*    -------------------------------
   238     05  AAMOUNTL PIC S9(0004) COMP.
   239     05  AAMOUNTF PIC  X(0001).
   240     05  FILLER REDEFINES AAMOUNTF.
   241         10  AAMOUNTA PIC  X(0001).
   242     05  AAMOUNTI PIC  9(10)V99.
   243*    -------------------------------
   244     05  AINTRATL PIC S9(0004) COMP.
   245     05  AINTRATF PIC  X(0001).
   246     05  FILLER REDEFINES AINTRATF.
   247         10  AINTRATA PIC  X(0001).
   248     05  AINTRATI PIC  9(4)V9(4).
   249*    -------------------------------
   250     05  AFREQL PIC S9(0004) COMP.
   251     05  AFREQF PIC  X(0001).
   252     05  FILLER REDEFINES AFREQF.
   253         10  AFREQA PIC  X(0001).
   254     05  AFREQI PIC  X(0002).
   255*    -------------------------------
   256     05  BAMOUNTL PIC S9(0004) COMP.
   257     05  BAMOUNTF PIC  X(0001).
   258     05  FILLER REDEFINES BAMOUNTF.
   259         10  BAMOUNTA PIC  X(0001).
   260     05  BAMOUNTI PIC  X(0011).
   261*    -------------------------------
   262     05  ANOPMTSL PIC S9(0004) COMP.
   263     05  ANOPMTSF PIC  X(0001).
   264     05  FILLER REDEFINES ANOPMTSF.
   265         10  ANOPMTSA PIC  X(0001).
   266     05  ANOPMTSI PIC  999.
   267*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL680.cbl
   268     05  BLAMTL PIC S9(0004) COMP.
   269     05  BLAMTF PIC  X(0001).
   270     05  FILLER REDEFINES BLAMTF.
   271         10  BLAMTA PIC  X(0001).
   272     05  BLAMTI PIC  X(0011).
   273*    -------------------------------
   274     05  AADDAYSL PIC S9(0004) COMP.
   275     05  AADDAYSF PIC  X(0001).
   276     05  FILLER REDEFINES AADDAYSF.
   277         10  AADDAYSA PIC  X(0001).
   278     05  AADDAYSI PIC  999.
   279*    -------------------------------
   280     05  ADDCHGL PIC S9(0004) COMP.
   281     05  ADDCHGF PIC  X(0001).
   282     05  FILLER REDEFINES ADDCHGF.
   283         10  ADDCHGA PIC  X(0001).
   284     05  ADDCHGI PIC  X(0001).
   285*    -------------------------------
   286     05  BDAMTL PIC S9(0004) COMP.
   287     05  BDAMTF PIC  X(0001).
   288     05  FILLER REDEFINES BDAMTF.
   289         10  BDAMTA PIC  X(0001).
   290     05  BDAMTI PIC  X(0011).
   291*    -------------------------------
   292     05  ABASISL PIC S9(0004) COMP.
   293     05  ABASISF PIC  X(0001).
   294     05  FILLER REDEFINES ABASISF.
   295         10  ABASISA PIC  X(0001).
   296     05  ABASISI PIC  X(0002).
   297*    -------------------------------
   298     05  BMOPMTL PIC S9(0004) COMP.
   299     05  BMOPMTF PIC  X(0001).
   300     05  FILLER REDEFINES BMOPMTF.
   301         10  BMOPMTA PIC  X(0001).
   302     05  BMOPMTI PIC  X(0011).
   303*    -------------------------------
   304     05  OBYORNL PIC S9(0004) COMP.
   305     05  OBYORNF PIC  X(0001).
   306     05  FILLER REDEFINES OBYORNF.
   307         10  OBYORNA PIC  X(0001).
   308     05  OBYORNI PIC  X(0001).
   309*    -------------------------------
   310     05  BALPMTL PIC S9(0004) COMP.
   311     05  BALPMTF PIC  X(0001).
   312     05  FILLER REDEFINES BALPMTF.
   313         10  BALPMTA PIC  X(0001).
   314     05  BALPMTI PIC  X(0011).
   315*    -------------------------------
   316     05  ANPREML PIC S9(0004) COMP.
   317     05  ANPREMF PIC  X(0001).
   318     05  FILLER REDEFINES ANPREMF.
   319         10  ANPREMA PIC  X(0001).
   320     05  ANPREMI PIC  X(0001).
   321*    -------------------------------
   322     05  BTOTPMTL PIC S9(0004) COMP.
   323     05  BTOTPMTF PIC  X(0001).
   324     05  FILLER REDEFINES BTOTPMTF.
   325         10  BTOTPMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL680.cbl
   326     05  BTOTPMTI PIC  X(0011).
   327*    -------------------------------
   328     05  ATRUNCL PIC S9(0004) COMP.
   329     05  ATRUNCF PIC  X(0001).
   330     05  FILLER REDEFINES ATRUNCF.
   331         10  ATRUNCA PIC  X(0001).
   332     05  ATRUNCI PIC  999.
   333*    -------------------------------
   334     05  BTOTINTL PIC S9(0004) COMP.
   335     05  BTOTINTF PIC  X(0001).
   336     05  FILLER REDEFINES BTOTINTF.
   337         10  BTOTINTA PIC  X(0001).
   338     05  BTOTINTI PIC  X(0011).
   339*    -------------------------------
   340     05  AEXTRAL PIC S9(0004) COMP.
   341     05  AEXTRAF PIC  X(0001).
   342     05  FILLER REDEFINES AEXTRAF.
   343         10  AEXTRAA PIC  X(0001).
   344     05  AEXTRAI PIC  9.
   345*    -------------------------------
   346     05  ALRATEL PIC S9(0004) COMP.
   347     05  ALRATEF PIC  X(0001).
   348     05  FILLER REDEFINES ALRATEF.
   349         10  ALRATEA PIC  X(0001).
   350     05  ALRATEI PIC  9(4)V9(4).
   351*    -------------------------------
   352     05  ALFDEVL PIC S9(0004) COMP.
   353     05  ALFDEVF PIC  X(0001).
   354     05  FILLER REDEFINES ALFDEVF.
   355         10  ALFDEVA PIC  X(0001).
   356     05  ALFDEVI PIC  9(4)V999.
   357*    -------------------------------
   358     05  ADRATEL PIC S9(0004) COMP.
   359     05  ADRATEF PIC  X(0001).
   360     05  FILLER REDEFINES ADRATEF.
   361         10  ADRATEA PIC  X(0001).
   362     05  ADRATEI PIC  9(4)V9(4).
   363*    -------------------------------
   364     05  AAHDEVL PIC S9(0004) COMP.
   365     05  AAHDEVF PIC  X(0001).
   366     05  FILLER REDEFINES AAHDEVF.
   367         10  AAHDEVA PIC  X(0001).
   368     05  AAHDEVI PIC  9(4)V999.
   369*    -------------------------------
   370     05  ANOTLFL PIC S9(0004) COMP.
   371     05  ANOTLFF PIC  X(0001).
   372     05  FILLER REDEFINES ANOTLFF.
   373         10  ANOTLFA PIC  X(0001).
   374     05  ANOTLFI PIC  999.
   375*    -------------------------------
   376     05  BALAMTL PIC S9(0004) COMP.
   377     05  BALAMTF PIC  X(0001).
   378     05  FILLER REDEFINES BALAMTF.
   379         10  BALAMTA PIC  X(0001).
   380     05  BALAMTI PIC  9(10)V99.
   381*    -------------------------------
   382     05  BALRL PIC S9(0004) COMP.
   383     05  BALRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL680.cbl
   384     05  FILLER REDEFINES BALRF.
   385         10  BALRA PIC  X(0001).
   386     05  BALRI PIC  X(0036).
   387*    -------------------------------
   388     05  BLRATEL PIC S9(0004) COMP.
   389     05  BLRATEF PIC  X(0001).
   390     05  FILLER REDEFINES BLRATEF.
   391         10  BLRATEA PIC  X(0001).
   392     05  BLRATEI PIC  9(4)V9(4).
   393*    -------------------------------
   394     05  BALYNL PIC S9(0004) COMP.
   395     05  BALYNF PIC  X(0001).
   396     05  FILLER REDEFINES BALYNF.
   397         10  BALYNA PIC  X(0001).
   398     05  BALYNI PIC  X(0001).
   399*    -------------------------------
   400     05  ERRMSG1L PIC S9(0004) COMP.
   401     05  ERRMSG1F PIC  X(0001).
   402     05  FILLER REDEFINES ERRMSG1F.
   403         10  ERRMSG1A PIC  X(0001).
   404     05  ERRMSG1I PIC  X(0079).
   405*    -------------------------------
   406     05  PFENTERL PIC S9(0004) COMP.
   407     05  PFENTERF PIC  X(0001).
   408     05  FILLER REDEFINES PFENTERF.
   409         10  PFENTERA PIC  X(0001).
   410     05  PFENTERI PIC  99.
   411 01  EL680AO REDEFINES EL680AI.
   412     05  FILLER            PIC  X(0012).
   413*    -------------------------------
   414     05  FILLER            PIC  X(0003).
   415     05  ADATEO PIC  X(0008).
   416*    -------------------------------
   417     05  FILLER            PIC  X(0003).
   418     05  ATIMEO PIC  99.99.
   419*    -------------------------------
   420     05  FILLER            PIC  X(0003).
   421     05  ACOMPIDO PIC  X(0003).
   422*    -------------------------------
   423     05  FILLER            PIC  X(0003).
   424     05  ANAMEO PIC  X(0020).
   425*    -------------------------------
   426     05  FILLER            PIC  X(0003).
   427     05  AAMOUNTO PIC  Z,ZZZ,ZZ9.99.
   428*    -------------------------------
   429     05  FILLER            PIC  X(0003).
   430     05  AINTRATO PIC  ZZ9.9(4).
   431*    -------------------------------
   432     05  FILLER            PIC  X(0003).
   433     05  AFREQO PIC  X(0002).
   434*    -------------------------------
   435     05  FILLER            PIC  X(0003).
   436     05  BAMOUNTO PIC  ZZZ,ZZ9.99-.
   437*    -------------------------------
   438     05  FILLER            PIC  X(0003).
   439     05  ANOPMTSO PIC  ZZ9.
   440*    -------------------------------
   441     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL680.cbl
   442     05  BLAMTO PIC  ZZZ,ZZ9.99-.
   443*    -------------------------------
   444     05  FILLER            PIC  X(0003).
   445     05  AADDAYSO PIC  ZZ9.
   446*    -------------------------------
   447     05  FILLER            PIC  X(0003).
   448     05  ADDCHGO PIC  X(0001).
   449*    -------------------------------
   450     05  FILLER            PIC  X(0003).
   451     05  BDAMTO PIC  ZZZ,ZZ9.99-.
   452*    -------------------------------
   453     05  FILLER            PIC  X(0003).
   454     05  ABASISO PIC  X(0002).
   455*    -------------------------------
   456     05  FILLER            PIC  X(0003).
   457     05  BMOPMTO PIC  ZZZ,ZZ9.99-.
   458*    -------------------------------
   459     05  FILLER            PIC  X(0003).
   460     05  OBYORNO PIC  X(0001).
   461*    -------------------------------
   462     05  FILLER            PIC  X(0003).
   463     05  BALPMTO PIC  ZZZ,ZZ9.99-.
   464*    -------------------------------
   465     05  FILLER            PIC  X(0003).
   466     05  ANPREMO PIC  X(0001).
   467*    -------------------------------
   468     05  FILLER            PIC  X(0003).
   469     05  BTOTPMTO PIC  ZZZ,ZZ9.99-.
   470*    -------------------------------
   471     05  FILLER            PIC  X(0003).
   472     05  ATRUNCO PIC  ZZ9.
   473*    -------------------------------
   474     05  FILLER            PIC  X(0003).
   475     05  BTOTINTO PIC  ZZZ,ZZ9.99-.
   476*    -------------------------------
   477     05  FILLER            PIC  X(0003).
   478     05  AEXTRAO PIC  9.
   479*    -------------------------------
   480     05  FILLER            PIC  X(0003).
   481     05  ALRATEO PIC  ZZ9.9(4).
   482*    -------------------------------
   483     05  FILLER            PIC  X(0003).
   484     05  ALFDEVO PIC  ZZ9.999.
   485*    -------------------------------
   486     05  FILLER            PIC  X(0003).
   487     05  ADRATEO PIC  ZZ9.9(4).
   488*    -------------------------------
   489     05  FILLER            PIC  X(0003).
   490     05  AAHDEVO PIC  ZZ9.999.
   491*    -------------------------------
   492     05  FILLER            PIC  X(0003).
   493     05  ANOTLFO PIC  ZZ9.
   494*    -------------------------------
   495     05  FILLER            PIC  X(0003).
   496     05  BALAMTO PIC  Z,ZZZ,ZZ9.99.
   497*    -------------------------------
   498     05  FILLER            PIC  X(0003).
   499     05  BALRO PIC  X(0036).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL680.cbl
   500*    -------------------------------
   501     05  FILLER            PIC  X(0003).
   502     05  BLRATEO PIC  ZZ9.9(4).
   503*    -------------------------------
   504     05  FILLER            PIC  X(0003).
   505     05  BALYNO PIC  X(0001).
   506*    -------------------------------
   507     05  FILLER            PIC  X(0003).
   508     05  ERRMSG1O PIC  X(0079).
   509*    -------------------------------
   510     05  FILLER            PIC  X(0003).
   511     05  PFENTERO PIC  Z9.
   512*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL680.cbl
   514*                            COPY ELCLOGOF.
   515******************************************************************
   516*                                                                *
   517*                                                                *
   518*                            ELCLOGOF.                           *
   519*                            VMOD=2.001                          *
   520*                                                                *
   521*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   522*                                                                *
   523******************************************************************
   524 01  CLASIC-LOGOFF.
   525     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   526     12  LOGOFF-TEXT.
   527         16  FILLER          PIC X(5)    VALUE SPACES.
   528         16  LOGOFF-MSG.
   529             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   530             20  FILLER      PIC X       VALUE SPACES.
   531             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   532         16  FILLER          PIC X(80)
   533           VALUE '* YOU ARE NOW LOGGED OFF'.
   534         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   535         16  FILLER          PIC X       VALUE QUOTE.
   536         16  LOGOFF-SYS-MSG  PIC X(17)
   537           VALUE 'S CLAS-IC SYSTEM '.
   538     12  TEXT-MESSAGES.
   539         16  UNACCESS-MSG    PIC X(29)
   540             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   541         16  PGMIDERR-MSG    PIC X(17)
   542             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL680.cbl
   544*                            COPY ELCDATE.
   545******************************************************************
   546*                                                                *
   547*                                                                *
   548*                            ELCDATE.                            *
   549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   550*                            VMOD=2.003
   551*                                                                *
   552*                                                                *
   553*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   554*                 LENGTH = 200                                   *
   555******************************************************************
   556
   557 01  DATE-CONVERSION-DATA.
   558     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   559     12  DC-OPTION-CODE                PIC X.
   560         88  BIN-TO-GREG                VALUE ' '.
   561         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   562         88  EDIT-GREG-TO-BIN           VALUE '2'.
   563         88  YMD-GREG-TO-BIN            VALUE '3'.
   564         88  MDY-GREG-TO-BIN            VALUE '4'.
   565         88  JULIAN-TO-BIN              VALUE '5'.
   566         88  BIN-PLUS-ELAPSED           VALUE '6'.
   567         88  FIND-CENTURY               VALUE '7'.
   568         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   569         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   570         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   571         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   572         88  JULIAN-TO-BIN-3            VALUE 'C'.
   573         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   574         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   575         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   576         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   577         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   578         88  CHECK-LEAP-YEAR            VALUE 'H'.
   579         88  BIN-3-TO-GREG              VALUE 'I'.
   580         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   581         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   582         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   583         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   584         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   585         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   586         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   587         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   588         88  THREE-CHARACTER-BIN
   589                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   590         88  GREGORIAN-TO-BIN
   591                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   592         88  BIN-TO-GREGORIAN
   593                  VALUES ' ' '1' 'I' '8' 'G'.
   594         88  JULIAN-TO-BINARY
   595                  VALUES '5' 'C' 'E' 'F'.
   596     12  DC-ERROR-CODE                 PIC X.
   597         88  NO-CONVERSION-ERROR        VALUE ' '.
   598         88  DATE-CONVERSION-ERROR
   599                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   600         88  DATE-IS-ZERO               VALUE '1'.
   601         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL680.cbl
   602         88  DATE-IS-INVALID            VALUE '3'.
   603         88  DATE1-GREATER-DATE2        VALUE '4'.
   604         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   605         88  DATE-INVALID-OPTION        VALUE '9'.
   606         88  INVALID-CENTURY            VALUE 'A'.
   607         88  ONLY-CENTURY               VALUE 'B'.
   608         88  ONLY-LEAP-YEAR             VALUE 'C'.
   609         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   610     12  DC-END-OF-MONTH               PIC X.
   611         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   612     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   613         88  USE-NORMAL-PROCESS         VALUE ' '.
   614         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   615         88  ADJUST-UP-100-YRS          VALUE '2'.
   616     12  FILLER                        PIC X.
   617     12  DC-CONVERSION-DATES.
   618         16  DC-BIN-DATE-1             PIC XX.
   619         16  DC-BIN-DATE-2             PIC XX.
   620         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   621         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   622                       DC-GREG-DATE-1-EDIT.
   623             20  DC-EDIT1-MONTH        PIC 99.
   624             20  SLASH1-1              PIC X.
   625             20  DC-EDIT1-DAY          PIC 99.
   626             20  SLASH1-2              PIC X.
   627             20  DC-EDIT1-YEAR         PIC 99.
   628         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   629         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   630                     DC-GREG-DATE-2-EDIT.
   631             20  DC-EDIT2-MONTH        PIC 99.
   632             20  SLASH2-1              PIC X.
   633             20  DC-EDIT2-DAY          PIC 99.
   634             20  SLASH2-2              PIC X.
   635             20  DC-EDIT2-YEAR         PIC 99.
   636         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   637         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   638                     DC-GREG-DATE-1-YMD.
   639             20  DC-YMD-YEAR           PIC 99.
   640             20  DC-YMD-MONTH          PIC 99.
   641             20  DC-YMD-DAY            PIC 99.
   642         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   643         16  DC-GREG-DATE-1-MDY-R REDEFINES
   644                      DC-GREG-DATE-1-MDY.
   645             20  DC-MDY-MONTH          PIC 99.
   646             20  DC-MDY-DAY            PIC 99.
   647             20  DC-MDY-YEAR           PIC 99.
   648         16  DC-GREG-DATE-1-ALPHA.
   649             20  DC-ALPHA-MONTH        PIC X(10).
   650             20  DC-ALPHA-DAY          PIC 99.
   651             20  FILLER                PIC XX.
   652             20  DC-ALPHA-CENTURY.
   653                 24 DC-ALPHA-CEN-N     PIC 99.
   654             20  DC-ALPHA-YEAR         PIC 99.
   655         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   656         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   657         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   658         16  DC-JULIAN-DATE            PIC 9(05).
   659         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL680.cbl
   660                                       PIC 9(05).
   661         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   662             20  DC-JULIAN-YEAR        PIC 99.
   663             20  DC-JULIAN-DAYS        PIC 999.
   664         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   665         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   666         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   667     12  DATE-CONVERSION-VARIBLES.
   668         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   669         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   670             20  FILLER                PIC 9(3).
   671             20  HOLD-CEN-1-CCYY.
   672                 24  HOLD-CEN-1-CC     PIC 99.
   673                 24  HOLD-CEN-1-YY     PIC 99.
   674             20  HOLD-CEN-1-MO         PIC 99.
   675             20  HOLD-CEN-1-DA         PIC 99.
   676         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   677             20  HOLD-CEN-1-R-MO       PIC 99.
   678             20  HOLD-CEN-1-R-DA       PIC 99.
   679             20  HOLD-CEN-1-R-CCYY.
   680                 24  HOLD-CEN-1-R-CC   PIC 99.
   681                 24  HOLD-CEN-1-R-YY   PIC 99.
   682             20  FILLER                PIC 9(3).
   683         16  HOLD-CENTURY-1-X.
   684             20  FILLER                PIC X(3)  VALUE SPACES.
   685             20  HOLD-CEN-1-X-CCYY.
   686                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   687                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   688             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   689             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   690         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   691             20  HOLD-CEN-1-R-X-MO     PIC XX.
   692             20  HOLD-CEN-1-R-X-DA     PIC XX.
   693             20  HOLD-CEN-1-R-X-CCYY.
   694                 24  HOLD-CEN-1-R-X-CC PIC XX.
   695                 24  HOLD-CEN-1-R-X-YY PIC XX.
   696             20  FILLER                PIC XXX.
   697         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   698         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   699         16  DC-JULIAN-DATE-1          PIC 9(07).
   700         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   701             20  DC-JULIAN-1-CCYY.
   702                 24  DC-JULIAN-1-CC    PIC 99.
   703                 24  DC-JULIAN-1-YR    PIC 99.
   704             20  DC-JULIAN-DA-1        PIC 999.
   705         16  DC-JULIAN-DATE-2          PIC 9(07).
   706         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   707             20  DC-JULIAN-2-CCYY.
   708                 24  DC-JULIAN-2-CC    PIC 99.
   709                 24  DC-JULIAN-2-YR    PIC 99.
   710             20  DC-JULIAN-DA-2        PIC 999.
   711         16  DC-GREG-DATE-A-EDIT.
   712             20  DC-EDITA-MONTH        PIC 99.
   713             20  SLASHA-1              PIC X VALUE '/'.
   714             20  DC-EDITA-DAY          PIC 99.
   715             20  SLASHA-2              PIC X VALUE '/'.
   716             20  DC-EDITA-CCYY.
   717                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL680.cbl
   718                 24  DC-EDITA-YEAR     PIC 99.
   719         16  DC-GREG-DATE-B-EDIT.
   720             20  DC-EDITB-MONTH        PIC 99.
   721             20  SLASHB-1              PIC X VALUE '/'.
   722             20  DC-EDITB-DAY          PIC 99.
   723             20  SLASHB-2              PIC X VALUE '/'.
   724             20  DC-EDITB-CCYY.
   725                 24  DC-EDITB-CENT     PIC 99.
   726                 24  DC-EDITB-YEAR     PIC 99.
   727         16  DC-GREG-DATE-CYMD         PIC 9(08).
   728         16  DC-GREG-DATE-CYMD-R REDEFINES
   729                              DC-GREG-DATE-CYMD.
   730             20  DC-CYMD-CEN           PIC 99.
   731             20  DC-CYMD-YEAR          PIC 99.
   732             20  DC-CYMD-MONTH         PIC 99.
   733             20  DC-CYMD-DAY           PIC 99.
   734         16  DC-GREG-DATE-MDCY         PIC 9(08).
   735         16  DC-GREG-DATE-MDCY-R REDEFINES
   736                              DC-GREG-DATE-MDCY.
   737             20  DC-MDCY-MONTH         PIC 99.
   738             20  DC-MDCY-DAY           PIC 99.
   739             20  DC-MDCY-CEN           PIC 99.
   740             20  DC-MDCY-YEAR          PIC 99.
   741    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   742        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   743    12  DC-EL310-DATE                  PIC X(21).
   744    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL680.cbl
   746*                            COPY ELCATTR.
   747******************************************************************
   748*                                                                *
   749*                            ELCATTR.                            *
   750*                            VMOD=2.001                          *
   751*                                                                *
   752*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   753*                                                                *
   754*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   755*                                                                *
   756*                   POS 1   P=PROTECTED                          *
   757*                           U=UNPROTECTED                        *
   758*                           S=ASKIP                              *
   759*                   POS 2   A=ALPHA/NUMERIC                      *
   760*                           N=NUMERIC                            *
   761*                   POS 3   N=NORMAL                             *
   762*                           B=BRIGHT                             *
   763*                           D=DARK                               *
   764*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   765*                           OF=MODIFIED DATA TAG OFF             *
   766*                                                                *
   767*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   768******************************************************************
   769 01  ATTRIBUTE-LIST.
   770     12  AL-PABOF            PIC X       VALUE 'Y'.
   771     12  AL-PABON            PIC X       VALUE 'Z'.
   772     12  AL-PADOF            PIC X       VALUE '%'.
   773     12  AL-PADON            PIC X       VALUE '_'.
   774     12  AL-PANOF            PIC X       VALUE '-'.
   775     12  AL-PANON            PIC X       VALUE '/'.
   776     12  AL-SABOF            PIC X       VALUE '8'.
   777     12  AL-SABON            PIC X       VALUE '9'.
   778     12  AL-SADOF            PIC X       VALUE '@'.
   779     12  AL-SADON            PIC X       VALUE QUOTE.
   780     12  AL-SANOF            PIC X       VALUE '0'.
   781     12  AL-SANON            PIC X       VALUE '1'.
   782     12  AL-UABOF            PIC X       VALUE 'H'.
   783     12  AL-UABON            PIC X       VALUE 'I'.
   784     12  AL-UADOF            PIC X       VALUE '<'.
   785     12  AL-UADON            PIC X       VALUE '('.
   786     12  AL-UANOF            PIC X       VALUE ' '.
   787     12  AL-UANON            PIC X       VALUE 'A'.
   788     12  AL-UNBOF            PIC X       VALUE 'Q'.
   789     12  AL-UNBON            PIC X       VALUE 'R'.
   790     12  AL-UNDOF            PIC X       VALUE '*'.
   791     12  AL-UNDON            PIC X       VALUE ')'.
   792     12  AL-UNNOF            PIC X       VALUE '&'.
   793     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL680.cbl
   795*                            COPY ELCAID.
   796******************************************************************
   797*                                                                *
   798*                            ELCAID.                             *
   799*                            VMOD=2.001                          *
   800*                                                                *
   801*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   802*                                                                *
   803*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   804*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   805******************************************************************
   806
   807 01  DFHAID.
   808   02  DFHNULL   PIC  X  VALUE  ' '.
   809   02  DFHENTER  PIC  X  VALUE  QUOTE.
   810   02  DFHCLEAR  PIC  X  VALUE  '_'.
   811   02  DFHPEN    PIC  X  VALUE  '='.
   812   02  DFHOPID   PIC  X  VALUE  'W'.
   813   02  DFHPA1    PIC  X  VALUE  '%'.
   814   02  DFHPA2    PIC  X  VALUE  '>'.
   815   02  DFHPA3    PIC  X  VALUE  ','.
   816   02  DFHPF1    PIC  X  VALUE  '1'.
   817   02  DFHPF2    PIC  X  VALUE  '2'.
   818   02  DFHPF3    PIC  X  VALUE  '3'.
   819   02  DFHPF4    PIC  X  VALUE  '4'.
   820   02  DFHPF5    PIC  X  VALUE  '5'.
   821   02  DFHPF6    PIC  X  VALUE  '6'.
   822   02  DFHPF7    PIC  X  VALUE  '7'.
   823   02  DFHPF8    PIC  X  VALUE  '8'.
   824   02  DFHPF9    PIC  X  VALUE  '9'.
   825   02  DFHPF10   PIC  X  VALUE  ':'.
   826   02  DFHPF11   PIC  X  VALUE  '#'.
   827   02  DFHPF12   PIC  X  VALUE  '@'.
   828   02  DFHPF13   PIC  X  VALUE  'A'.
   829   02  DFHPF14   PIC  X  VALUE  'B'.
   830   02  DFHPF15   PIC  X  VALUE  'C'.
   831   02  DFHPF16   PIC  X  VALUE  'D'.
   832   02  DFHPF17   PIC  X  VALUE  'E'.
   833   02  DFHPF18   PIC  X  VALUE  'F'.
   834   02  DFHPF19   PIC  X  VALUE  'G'.
   835   02  DFHPF20   PIC  X  VALUE  'H'.
   836   02  DFHPF21   PIC  X  VALUE  'I'.
   837*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   838   02  DFHPF22   PIC  X  VALUE  '['.
   839   02  DFHPF23   PIC  X  VALUE  '.'.
   840   02  DFHPF24   PIC  X  VALUE  '<'.
   841   02  DFHMSRE   PIC  X  VALUE  'X'.
   842   02  DFHSTRF   PIC  X  VALUE  'h'.
   843   02  DFHTRIG   PIC  X  VALUE  '"'.
   844 01  FILLER    REDEFINES DFHAID.
   845     12  FILLER              PIC X(8).
   846     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL680.cbl
   848*                            COPY ELCEMIB.
   849******************************************************************
   850*                                                                *
   851*                                                                *
   852*                            ELCEMIB.                            *
   853*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   854*                            VMOD=2.005                          *
   855*                                                                *
   856*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   857*                                                                *
   858******************************************************************
   859 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   860     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   861     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   862     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   863     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   864     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   865     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   866     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   867     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   868     12  EMI-SWITCH1             PIC X        VALUE '1'.
   869         88  EMI-NO-ERRORS                    VALUE '1'.
   870         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   871         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   872     12  EMI-SWITCH2             PIC X        VALUE '1'.
   873         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   874     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   875         88  EMI-AREA1-EMPTY                  VALUE '1'.
   876         88  EMI-AREA1-FULL                   VALUE '2'.
   877     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   878         88  EMI-AREA2-EMPTY                  VALUE '1'.
   879         88  EMI-AREA2-FULL                   VALUE '2'.
   880     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   881         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   882         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   883         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   884         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   885         88  EMI-BYPASS-FATALS                VALUE 'X'.
   886     12  EMI-ERROR-LINES.
   887         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   888         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   889         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   890         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   891             20  EMI-ERR-CODES OCCURS 10 TIMES.
   892                 24  EMI-ERR-NUM         PIC X(4).
   893                 24  EMI-FILLER          PIC X.
   894                 24  EMI-SEV             PIC X.
   895                 24  FILLER              PIC X.
   896             20  FILLER                  PIC X(02).
   897     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   898         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   899             20  EMI-ERROR-NUMBER    PIC X(4).
   900             20  EMI-FILL            PIC X.
   901             20  EMI-SEVERITY        PIC X.
   902             20  FILLER              PIC X.
   903             20  EMI-ERROR-TEXT.
   904                 24  EMI-TEXT-VARIABLE   PIC X(10).
   905                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL680.cbl
   906     12  EMI-SEVERITY-SAVE           PIC X.
   907         88  EMI-NOTE                    VALUE 'N'.
   908         88  EMI-WARNING                 VALUE 'W'.
   909         88  EMI-FORCABLE                VALUE 'F'.
   910         88  EMI-FATAL                   VALUE 'X'.
   911     12  EMI-MESSAGE-FLAG            PIC X.
   912         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   913         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   914     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   915     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   916         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   917         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   918         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   919     12  FILLER                      PIC X(137)  VALUE SPACES.
   920     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   921     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   922     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   923     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL680.cbl
   925*                            COPY ELCINTF.
   926******************************************************************
   927*                                                                *
   928*                                                                *
   929*                            ELCINTF.                            *
   930*                            VMOD=2.017                          *
   931*                                                                *
   932*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   933*                                                                *
   934*       LENGTH = 1024                                            *
   935*                                                                *
   936******************************************************************
   937 01  PROGRAM-INTERFACE-BLOCK.
   938     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   939     12  PI-CALLING-PROGRAM              PIC X(8).
   940     12  PI-SAVED-PROGRAM-1              PIC X(8).
   941     12  PI-SAVED-PROGRAM-2              PIC X(8).
   942     12  PI-SAVED-PROGRAM-3              PIC X(8).
   943     12  PI-SAVED-PROGRAM-4              PIC X(8).
   944     12  PI-SAVED-PROGRAM-5              PIC X(8).
   945     12  PI-SAVED-PROGRAM-6              PIC X(8).
   946     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   947     12  PI-COMPANY-ID                   PIC XXX.
   948     12  PI-COMPANY-CD                   PIC X.
   949
   950     12  PI-COMPANY-PASSWORD             PIC X(8).
   951
   952     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   953
   954     12  PI-CONTROL-IN-PROGRESS.
   955         16  PI-CARRIER                  PIC X.
   956         16  PI-GROUPING                 PIC X(6).
   957         16  PI-STATE                    PIC XX.
   958         16  PI-ACCOUNT                  PIC X(10).
   959         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   960                                         PIC X(10).
   961         16  PI-CLAIM-CERT-GRP.
   962             20  PI-CLAIM-NO             PIC X(7).
   963             20  PI-CERT-NO.
   964                 25  PI-CERT-PRIME       PIC X(10).
   965                 25  PI-CERT-SFX         PIC X.
   966             20  PI-CERT-EFF-DT          PIC XX.
   967         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   968             20  PI-PLAN-CODE            PIC X(2).
   969             20  PI-REVISION-NUMBER      PIC X(3).
   970             20  PI-PLAN-EFF-DT          PIC X(2).
   971             20  PI-PLAN-EXP-DT          PIC X(2).
   972             20  FILLER                  PIC X(11).
   973         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   974             20  PI-OE-REFERENCE-1.
   975                 25  PI-OE-REF-1-PRIME   PIC X(18).
   976                 25  PI-OE-REF-1-SUFF    PIC XX.
   977
   978     12  PI-SESSION-IN-PROGRESS          PIC X.
   979         88  CLAIM-SESSION                   VALUE '1'.
   980         88  CREDIT-SESSION                  VALUE '2'.
   981         88  WARRANTY-SESSION                VALUE '3'.
   982         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL680.cbl
   983         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   984
   985
   986*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   987
   988     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   989     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   990
   991     12  PI-CREDIT-USER                  PIC X.
   992         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   993         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   994
   995     12  PI-CLAIM-USER                   PIC X.
   996         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   997         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   998
   999     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1000         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1001         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1002         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1003         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1004         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1005
  1006     12  PI-PROCESSOR-ID                 PIC X(4).
  1007
  1008     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1009
  1010     12  PI-MEMBER-CAPTION               PIC X(10).
  1011
  1012     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1013         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1014
  1015     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1016     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1017     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1018     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1019
  1020     12  PI-AH-OVERRIDE-L1               PIC X.
  1021     12  PI-AH-OVERRIDE-L2               PIC XX.
  1022     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1023     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1024
  1025     12  PI-NEW-SYSTEM                   PIC X(2).
  1026
  1027     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1028     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1029         88  PI-USES-PAID-TO                 VALUE '1'.
  1030     12  PI-CRDTCRD-SYSTEM.
  1031         16  PI-CRDTCRD-USER             PIC X.
  1032             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1033             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1034         16  PI-CC-MONTH-END-DT          PIC XX.
  1035     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1036
  1037     12  PI-OE-REFERENCE-2.
  1038         16  PI-OE-REF-2-PRIME           PIC X(10).
  1039         16  PI-OE-REF-2-SUFF            PIC X.
  1040
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL680.cbl
  1041     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1042
  1043     12  PI-LANGUAGE-TYPE                PIC X.
  1044             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1045             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1046             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1047
  1048     12  PI-POLICY-LINKAGE-IND           PIC X.
  1049         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1050         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1051                                                   LOW-VALUES.
  1052
  1053     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1054     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1055         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1056         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1057     12  FILLER                          PIC X(4).
  1058
  1059     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1060
  1061     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1062         PI-SYSTEM-LEVEL.
  1063
  1064         16  PI-ENTRY-CODES.
  1065             20  PI-ENTRY-CD-1           PIC X.
  1066             20  PI-ENTRY-CD-2           PIC X.
  1067
  1068         16  PI-RETURN-CODES.
  1069             20  PI-RETURN-CD-1          PIC X.
  1070             20  PI-RETURN-CD-2          PIC X.
  1071
  1072         16  PI-UPDATE-STATUS-SAVE.
  1073             20  PI-UPDATE-BY            PIC X(4).
  1074             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1075
  1076         16  PI-LOWER-CASE-LETTERS       PIC X.
  1077             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1078
  1079*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1080*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1081*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1082
  1083         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1084             88  ST-ACCNT-CNTL               VALUE ' '.
  1085             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1086             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1087             88  ACCNT-CNTL                  VALUE '3'.
  1088             88  CARR-ACCNT-CNTL             VALUE '4'.
  1089
  1090         16  PI-PROCESSOR-CAP-LIST.
  1091             20  PI-SYSTEM-CONTROLS.
  1092                24 PI-SYSTEM-DISPLAY     PIC X.
  1093                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1094                24 PI-SYSTEM-MODIFY      PIC X.
  1095                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1096             20  FILLER                  PIC XX.
  1097             20  PI-DISPLAY-CAP          PIC X.
  1098                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL680.cbl
  1099             20  PI-MODIFY-CAP           PIC X.
  1100                 88  MODIFY-CAP              VALUE 'Y'.
  1101             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1102                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1103             20  PI-FORCE-CAP            PIC X.
  1104                 88  FORCE-CAP               VALUE 'Y'.
  1105
  1106         16  PI-PROGRAM-CONTROLS.
  1107             20  PI-PGM-PRINT-OPT        PIC X.
  1108             20  PI-PGM-FORMAT-OPT       PIC X.
  1109             20  PI-PGM-PROCESS-OPT      PIC X.
  1110             20  PI-PGM-TOTALS-OPT       PIC X.
  1111
  1112         16  PI-HELP-INTERFACE.
  1113             20  PI-LAST-ERROR-NO        PIC X(4).
  1114             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1115
  1116         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1117             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1118
  1119         16  PI-CR-CONTROL-IN-PROGRESS.
  1120             20  PI-CR-CARRIER           PIC X.
  1121             20  PI-CR-GROUPING          PIC X(6).
  1122             20  PI-CR-STATE             PIC XX.
  1123             20  PI-CR-ACCOUNT           PIC X(10).
  1124             20  PI-CR-FIN-RESP          PIC X(10).
  1125             20  PI-CR-TYPE              PIC X.
  1126
  1127         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1128
  1129         16  PI-CR-MONTH-END-DT          PIC XX.
  1130
  1131         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1132             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1133             88  PI-ZERO-CARRIER             VALUE '1'.
  1134             88  PI-ZERO-GROUPING            VALUE '2'.
  1135             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1136
  1137         16  PI-CARRIER-SECURITY         PIC X.
  1138             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1139
  1140         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1141             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1142             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1143
  1144         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1145             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1146                                         INDEXED BY PI-ACCESS-NDX
  1147                                         PIC X.
  1148
  1149         16  PI-GA-BILLING-CONTROL       PIC X.
  1150             88  PI-GA-BILLING               VALUE '1'.
  1151
  1152         16  PI-MAIL-PROCESSING          PIC X.
  1153             88  PI-MAIL-YES                 VALUE 'Y'.
  1154
  1155         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1156
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL680.cbl
  1157         16  PI-AR-SYSTEM.
  1158             20  PI-AR-PROCESSING-CNTL   PIC X.
  1159                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1160             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1161             20  PI-AR-MONTH-END-DT      PIC XX.
  1162
  1163         16  PI-MP-SYSTEM.
  1164             20  PI-MORTGAGE-USER            PIC X.
  1165                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1166                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1167             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1168                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1169                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1170                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1171                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1172                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1173             20  PI-MP-MONTH-END-DT          PIC XX.
  1174             20  PI-MP-REFERENCE-NO.
  1175                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1176                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1177
  1178         16  PI-LABEL-CONTROL            PIC X(01).
  1179             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1180             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1181
  1182         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1183             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1184
  1185         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1186             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1187             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1188
  1189         16  FILLER                      PIC X(14).
  1190
  1191     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1192******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL680.cbl
  1194****************************************************************
  1195*
  1196* Copyright (c) 2007 by Clerity Solutions, Inc.
  1197* All rights reserved.
  1198*
  1199****************************************************************
  1200 01  DFHEIV.
  1201   02  DFHEIV0               PIC X(35).
  1202   02  DFHEIV1               PIC X(08).
  1203   02  DFHEIV2               PIC X(08).
  1204   02  DFHEIV3               PIC X(08).
  1205   02  DFHEIV4               PIC X(06).
  1206   02  DFHEIV5               PIC X(04).
  1207   02  DFHEIV6               PIC X(04).
  1208   02  DFHEIV7               PIC X(02).
  1209   02  DFHEIV8               PIC X(02).
  1210   02  DFHEIV9               PIC X(01).
  1211   02  DFHEIV10              PIC S9(7) COMP-3.
  1212   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1213   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1214   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1215   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1216   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1217   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1218   02  DFHEIV17              PIC X(04).
  1219   02  DFHEIV18              PIC X(04).
  1220   02  DFHEIV19              PIC X(04).
  1221   02  DFHEIV20              USAGE IS POINTER.
  1222   02  DFHEIV21              USAGE IS POINTER.
  1223   02  DFHEIV22              USAGE IS POINTER.
  1224   02  DFHEIV23              USAGE IS POINTER.
  1225   02  DFHEIV24              USAGE IS POINTER.
  1226   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1227   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1228   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1229   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1230   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1231   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1232   02  FILLER                PIC X(02).
  1233   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1234   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1235   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1236   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1237   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1238 LINKAGE  SECTION.
  1239*****************************************************************
  1240*                                                               *
  1241* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1242* All rights reserved.                                          *
  1243*                                                               *
  1244*****************************************************************
  1245 01  dfheiblk.
  1246     02  eibtime          pic s9(7) comp-3.
  1247     02  eibdate          pic s9(7) comp-3.
  1248     02  eibtrnid         pic x(4).
  1249     02  eibtaskn         pic s9(7) comp-3.
  1250     02  eibtrmid         pic x(4).
  1251     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL680.cbl
  1252     02  eibcposn         pic s9(4) comp.
  1253     02  eibcalen         pic s9(4) comp.
  1254     02  eibaid           pic x(1).
  1255     02  eibfiller1       pic x(1).
  1256     02  eibfn            pic x(2).
  1257     02  eibfiller2       pic x(2).
  1258     02  eibrcode         pic x(6).
  1259     02  eibfiller3       pic x(2).
  1260     02  eibds            pic x(8).
  1261     02  eibreqid         pic x(8).
  1262     02  eibrsrce         pic x(8).
  1263     02  eibsync          pic x(1).
  1264     02  eibfree          pic x(1).
  1265     02  eibrecv          pic x(1).
  1266     02  eibsend          pic x(1).
  1267     02  eibatt           pic x(1).
  1268     02  eibeoc           pic x(1).
  1269     02  eibfmh           pic x(1).
  1270     02  eibcompl         pic x(1).
  1271     02  eibsig           pic x(1).
  1272     02  eibconf          pic x(1).
  1273     02  eiberr           pic x(1).
  1274     02  eibrldbk         pic x(1).
  1275     02  eiberrcd         pic x(4).
  1276     02  eibsynrb         pic x(1).
  1277     02  eibnodat         pic x(1).
  1278     02  eibfiller5       pic x(2).
  1279     02  eibresp          pic 9(09) comp.
  1280     02  eibresp2         pic 9(09) comp.
  1281     02  dfheigdj         pic s9(4) comp.
  1282     02  dfheigdk         pic s9(4) comp.
  1283 01  DFHCOMMAREA         PIC X(1024).
  1284*01 PARMLIST   COMP.
  1285*    02  FILLER          PIC S9(8).
  1286*    02  ELCNTL-POINTER  PIC S9(8).
  1287
  1288*                             COPY ELCCNTL.
  1289******************************************************************
  1290*                                                                *
  1291*                                                                *
  1292*                            ELCCNTL.                            *
  1293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1294*                            VMOD=2.059                          *
  1295*                                                                *
  1296*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1297*                                                                *
  1298*   FILE TYPE = VSAM,KSDS                                        *
  1299*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1300*                                                                *
  1301*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1302*       ALTERNATE INDEX = NONE                                   *
  1303*                                                                *
  1304*   LOG = YES                                                    *
  1305*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1306******************************************************************
  1307*                   C H A N G E   L O G
  1308*
  1309* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL680.cbl
  1310*-----------------------------------------------------------------
  1311*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1312* EFFECTIVE    NUMBER
  1313*-----------------------------------------------------------------
  1314* 082503                   PEMA  ADD BENEFIT GROUP
  1315* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1316* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1317* 092705    2005050300006  PEMA  ADD SPP LEASES
  1318* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1319* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1320* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1321* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1322* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1323******************************************************************
  1324*
  1325 01  CONTROL-FILE.
  1326     12  CF-RECORD-ID                       PIC XX.
  1327         88  VALID-CF-ID                        VALUE 'CF'.
  1328
  1329     12  CF-CONTROL-PRIMARY.
  1330         16  CF-COMPANY-ID                  PIC XXX.
  1331         16  CF-RECORD-TYPE                 PIC X.
  1332             88  CF-COMPANY-MASTER              VALUE '1'.
  1333             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1334             88  CF-STATE-MASTER                VALUE '3'.
  1335             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1336             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1337             88  CF-CARRIER-MASTER              VALUE '6'.
  1338             88  CF-MORTALITY-MASTER            VALUE '7'.
  1339             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1340             88  CF-TERMINAL-MASTER             VALUE '9'.
  1341             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1342             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1343             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1344             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1345             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1346             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1347             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1348             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1349             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1350         16  CF-ACCESS-CD-GENL              PIC X(4).
  1351         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1352             20  CF-PROCESSOR               PIC X(4).
  1353         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1354             20  CF-STATE-CODE              PIC XX.
  1355             20  FILLER                     PIC XX.
  1356         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1357             20  FILLER                     PIC XX.
  1358             20  CF-HI-BEN-IN-REC           PIC XX.
  1359         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1360             20  FILLER                     PIC XXX.
  1361             20  CF-CARRIER-CNTL            PIC X.
  1362         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1363             20  FILLER                     PIC XX.
  1364             20  CF-HI-TYPE-IN-REC          PIC 99.
  1365         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1366             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1367                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL680.cbl
  1368             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1369             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1370         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1371             20  FILLER                     PIC X.
  1372             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1373         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1374             20  FILLER                     PIC XX.
  1375             20  CF-MORTGAGE-PLAN           PIC XX.
  1376         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1377
  1378     12  CF-LAST-MAINT-DT                   PIC XX.
  1379     12  CF-LAST-MAINT-BY                   PIC X(4).
  1380     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1381
  1382     12  CF-RECORD-BODY                     PIC X(728).
  1383
  1384
  1385****************************************************************
  1386*             COMPANY MASTER RECORD                            *
  1387****************************************************************
  1388
  1389     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1390         16  CF-COMPANY-ADDRESS.
  1391             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1392             20  CF-CL-IN-CARE-OF           PIC X(30).
  1393             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1394             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1395             20  CF-CL-CITY-STATE           PIC X(30).
  1396             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1397             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1398         16  CF-COMPANY-CD                  PIC X.
  1399         16  CF-COMPANY-PASSWORD            PIC X(8).
  1400         16  CF-SECURITY-OPTION             PIC X.
  1401             88  ALL-SECURITY                   VALUE '1'.
  1402             88  COMPANY-VERIFY                 VALUE '2'.
  1403             88  PROCESSOR-VERIFY               VALUE '3'.
  1404             88  NO-SECURITY                    VALUE '4'.
  1405             88  ALL-BUT-TERM                   VALUE '5'.
  1406         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1407             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1408         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1409             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1410         16  CF-INFORCE-LOCATION            PIC X.
  1411             88  CERTS-ARE-ONLINE               VALUE '1'.
  1412             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1413             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1414         16  CF-LOWER-CASE-LETTERS          PIC X.
  1415         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1416             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1417             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1418             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1419             88  CF-ACCNT-CNTL                  VALUE '3'.
  1420             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1421
  1422         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1423         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1424
  1425         16  CF-LGX-CREDIT-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL680.cbl
  1426             88  CO-IS-NOT-USER                 VALUE 'N'.
  1427             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1428
  1429         16 CF-CREDIT-CALC-CODES.
  1430             20  CF-CR-REM-TERM-CALC PIC X.
  1431               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1432               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1433               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1434               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1435               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1436               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1437               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1438             20  CF-CR-R78-METHOD           PIC X.
  1439               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1440               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1441
  1442         16  CF-CLAIM-CONTROL-COUNTS.
  1443             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1444                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1445
  1446             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1447                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1448
  1449             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1450                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1451
  1452             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1453                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1454
  1455         16  CF-CURRENT-MONTH-END           PIC XX.
  1456
  1457         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1458             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1459             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1460             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1461             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1462                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1463                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1464             20  CF-CO-PREM-REJECT-SW       PIC X.
  1465                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1466                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1467             20  CF-CO-REF-REJECT-SW        PIC X.
  1468                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1469                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1470
  1471         16  CF-CO-REPORTING-DT             PIC XX.
  1472         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1473         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1474           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1475           88  CF-CO-MONTH-END                  VALUE '1'.
  1476
  1477         16  CF-LGX-CLAIM-USER              PIC X.
  1478             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1479             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1480
  1481         16  CF-CREDIT-EDIT-CONTROLS.
  1482             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1483             20  CF-MIN-AGE                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL680.cbl
  1484             20  CF-DEFAULT-AGE             PIC 99.
  1485             20  CF-MIN-TERM                PIC S999      COMP-3.
  1486             20  CF-MAX-TERM                PIC S999      COMP-3.
  1487             20  CF-DEFAULT-SEX             PIC X.
  1488             20  CF-JOINT-AGE-INPUT         PIC X.
  1489                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1490             20  CF-BIRTH-DATE-INPUT        PIC X.
  1491                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1492             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1493                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1494                 88  CF-ZERO-CARRIER            VALUE '1'.
  1495                 88  CF-ZERO-GROUPING           VALUE '2'.
  1496                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1497             20  CF-EDIT-SW                 PIC X.
  1498                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1499             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1500             20  CF-CR-PR-METHOD            PIC X.
  1501               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1502               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1503             20  FILLER                     PIC X.
  1504
  1505         16  CF-CREDIT-MISC-CONTROLS.
  1506             20  CF-REIN-TABLE-SW           PIC X.
  1507                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1508             20  CF-COMP-TABLE-SW           PIC X.
  1509                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1510             20  CF-EXPERIENCE-RETENTION-AGE
  1511                                            PIC S9        COMP-3.
  1512             20  CF-CONVERSION-DT           PIC XX.
  1513             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1514             20  CF-RUN-FREQUENCY-SW        PIC X.
  1515                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1516                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1517
  1518             20  CF-CR-CHECK-NO-CONTROL.
  1519                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1520                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1521                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1522                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1523                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1524                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1525
  1526                 24  CF-CR-CHECK-COUNT       REDEFINES
  1527                     CF-CR-CHECK-COUNTER      PIC X(4).
  1528
  1529                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1530                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1531
  1532                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1533                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1534                 24  CF-MAIL-PROCESSING       PIC X.
  1535                     88  MAIL-PROCESSING          VALUE 'Y'.
  1536
  1537         16  CF-MISC-SYSTEM-CONTROL.
  1538             20  CF-SYSTEM-C                 PIC X.
  1539                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1540             20  CF-SYSTEM-D                 PIC X.
  1541                 88  DAILY-BILL-SYS-USED         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL680.cbl
  1542             20  CF-SOC-SEC-NO-SW            PIC X.
  1543                 88  SOC-SEC-NO-USED             VALUE '1'.
  1544             20  CF-MEMBER-NO-SW             PIC X.
  1545                 88  MEMBER-NO-USED              VALUE '1'.
  1546             20  CF-TAX-ID-NUMBER            PIC X(11).
  1547             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1548             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1549                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1550                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1551                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1552                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1553             20  CF-SYSTEM-E                 PIC X.
  1554                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1555
  1556         16  CF-LGX-LIFE-USER               PIC X.
  1557             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1558             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1559
  1560         16  CF-CR-MONTH-END-DT             PIC XX.
  1561
  1562         16  CF-FILE-MAINT-DATES.
  1563             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1564                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1565             20  CF-LAST-BATCH       REDEFINES
  1566                 CF-LAST-BATCH-NO               PIC X(4).
  1567             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1568             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1569             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1570             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1571             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1572             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1573             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1574             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1575             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1576             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1577
  1578         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1579         16  FILLER                         PIC X.
  1580
  1581         16  CF-ALT-MORT-CODE               PIC X(4).
  1582         16  CF-MEMBER-CAPTION              PIC X(10).
  1583
  1584         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1585             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1586             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1587             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1588             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1589             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1590
  1591         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1592
  1593         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1594         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1595         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1596         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1597
  1598         16  CF-AH-OVERRIDE-L1              PIC X.
  1599         16  CF-AH-OVERRIDE-L2              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL680.cbl
  1600         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1601         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1602
  1603         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1604         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1605
  1606         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1607         16  CF-AR-LAST-EL860-DT            PIC XX.
  1608         16  CF-MP-MONTH-END-DT             PIC XX.
  1609
  1610         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1611         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1612             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1613
  1614         16  CF-AR-MONTH-END-DT             PIC XX.
  1615
  1616         16  CF-CRDTCRD-USER                PIC X.
  1617             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1618             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1619
  1620         16  CF-CC-MONTH-END-DT             PIC XX.
  1621
  1622         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1623
  1624         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1625             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1626             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1627             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1628         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1629         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1630         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1631         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1632             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1633             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1634         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1635         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1636         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1637             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1638         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1639
  1640         16  CF-CL-ZIP-CODE.
  1641             20  CF-CL-ZIP-PRIME.
  1642                 24  CF-CL-ZIP-1ST          PIC X.
  1643                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1644                 24  FILLER                 PIC X(4).
  1645             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1646         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1647             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1648             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1649             20  FILLER                     PIC XXX.
  1650
  1651         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1652         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1653         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1654         16  CF-CO-OPTION-START-DATE        PIC XX.
  1655         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1656           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1657                                                      '3' '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL680.cbl
  1658           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1659           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1660           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1661           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1662           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1663           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1664
  1665         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1666
  1667         16  CF-PAYMENT-APPROVAL-LEVELS.
  1668             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1669             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1670             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1671             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1672             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1673             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1674
  1675         16  CF-END-USER-REPORTING-USER     PIC X.
  1676             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1677             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1678
  1679         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1680             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1681             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1682
  1683         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1684
  1685         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1686         16  FILLER                         PIC X.
  1687
  1688         16  CF-CREDIT-ARCHIVE-CNTL.
  1689             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1690             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1691             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1692
  1693         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1694
  1695         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1696             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1697             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1698
  1699         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1700             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1701             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1702
  1703         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1704
  1705         16  CF-CO-ACH-ID-CODE              PIC  X.
  1706             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1707             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1708             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1709         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1710         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1711         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1712         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1713         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1714         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1715         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL680.cbl
  1716         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1717         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1718                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1719         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1720                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1721
  1722         16  CF-CO-OVER-SHORT.
  1723             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1724             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1725
  1726*         16  FILLER                         PIC X(102).
  1727         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1728             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1729             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1730
  1731         16  CF-AH-APPROVAL-DAYS.
  1732             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1733             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1734             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1735             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1736
  1737         16  FILLER                         PIC X(82).
  1738****************************************************************
  1739*             PROCESSOR/USER RECORD                            *
  1740****************************************************************
  1741
  1742     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1743         16  CF-PROCESSOR-NAME              PIC X(30).
  1744         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1745         16  CF-PROCESSOR-TITLE             PIC X(26).
  1746         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1747                 88  MESSAGE-YES                VALUE 'Y'.
  1748                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1749
  1750*****************************************************
  1751****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1752****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1753****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1754****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1755*****************************************************
  1756
  1757         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1758             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1759             20  CF-APPLICATION-FORCE       PIC X.
  1760             20  CF-INDIVIDUAL-APP.
  1761                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1762                     28  CF-BROWSE-APP      PIC X.
  1763                     28  CF-UPDATE-APP      PIC X.
  1764
  1765         16  CF-CURRENT-TERM-ON             PIC X(4).
  1766         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1767             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1768             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1769             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1770             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1771             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1772             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1773             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL680.cbl
  1774         16  CF-PROCESSOR-CARRIER           PIC X.
  1775             88  NO-CARRIER-SECURITY            VALUE ' '.
  1776         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1777             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1778         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1779             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1780         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1781             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1782
  1783         16  CF-PROC-SYS-ACCESS-SW.
  1784             20  CF-PROC-CREDIT-CLAIMS-SW.
  1785                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1786                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1787                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1788                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1789             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1790                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1791                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1792             20  CF-PROC-LIFE-GNRLDGR-SW.
  1793                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1794                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1795                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1796                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1797             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1798                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1799                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1800         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1801             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1802             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1803         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1804
  1805         16  CF-APPROVAL-LEVEL                  PIC X.
  1806             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1807             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1808             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1809             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1810
  1811         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1812
  1813         16  CF-LANGUAGE-TYPE                   PIC X.
  1814             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1815             88  CF-LANG-IS-FR                      VALUE 'F'.
  1816         16  FILLER                             PIC  X(240).
  1817
  1818****************************************************************
  1819*             PROCESSOR/REMINDERS RECORD                       *
  1820****************************************************************
  1821
  1822     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1823         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1824             20  CF-START-REMIND-DT         PIC XX.
  1825             20  CF-END-REMIND-DT           PIC XX.
  1826             20  CF-REMINDER-TEXT           PIC X(50).
  1827         16  FILLER                         PIC X(296).
  1828
  1829
  1830****************************************************************
  1831*             STATE MASTER RECORD                              *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL680.cbl
  1832****************************************************************
  1833
  1834     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1835         16  CF-STATE-ABBREVIATION          PIC XX.
  1836         16  CF-STATE-NAME                  PIC X(25).
  1837         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1838         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1839             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1840             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1841             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1842             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1843                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1844                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1845             20  CF-ST-PREM-REJECT-SW       PIC X.
  1846                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1847                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1848             20  CF-ST-REF-REJECT-SW        PIC X.
  1849                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1850                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1851         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1852         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1853         16  CF-ST-REFUND-RULES.
  1854             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1855             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1856             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1857         16  CF-ST-FST-PMT-EXTENSION.
  1858             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1859             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1860                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1861                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1862                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1863                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1864         16  CF-ST-STATE-CALL.
  1865             20  CF-ST-CALL-UNEARNED        PIC X.
  1866             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1867             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1868         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1869             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1870             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1871         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1872         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1873         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1874         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1875         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1876         16  FILLER                         PIC X.
  1877         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1878             20  CF-ST-BENEFIT-CD           PIC XX.
  1879             20  CF-ST-BENEFIT-KIND         PIC X.
  1880                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1881                 88  CF-ST-AH-KIND              VALUE 'A'.
  1882             20  CF-ST-REM-TERM-CALC        PIC X.
  1883                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1884                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1885                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1886                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1887                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1888                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1889                 88  ST-EARN-AFTER-14TH         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL680.cbl
  1890                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1891
  1892             20  CF-ST-REFUND-CALC          PIC X.
  1893                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1894                 88  ST-REFD-BY-R78             VALUE '1'.
  1895                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1896                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1897                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1898                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1899                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1900                 88  ST-REFD-UTAH               VALUE '7'.
  1901                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1902                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1903                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1904
  1905             20  CF-ST-EARNING-CALC         PIC X.
  1906                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1907                 88  ST-EARN-BY-R78             VALUE '1'.
  1908                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1909                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1910                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1911                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1912                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1913                 88  ST-EARN-MEAN               VALUE '8'.
  1914                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1915
  1916             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1917                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1918                 88  ST-OVRD-BY-R78             VALUE '1'.
  1919                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1920                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1921                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1922                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1923                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1924                 88  ST-OVRD-MEAN               VALUE '8'.
  1925                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1926             20  FILLER                     PIC X.
  1927
  1928         16  CF-ST-COMMISSION-CAPS.
  1929             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1930             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1931             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1932             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1933         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1934                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1935
  1936         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1937
  1938         16  CF-ST-STATUTORY-INTEREST.
  1939             20  CF-ST-STAT-DATE-FROM       PIC X.
  1940                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1941                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1942             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1943             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1944             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1945             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1946             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1947
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL680.cbl
  1948         16  CF-ST-OVER-SHORT.
  1949             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1950             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1951
  1952         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1953
  1954         16  CF-ST-RT-CALC                  PIC X.
  1955
  1956         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1957         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1958         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1959         16  CF-ST-RF-LR-CALC               PIC X.
  1960         16  CF-ST-RF-LL-CALC               PIC X.
  1961         16  CF-ST-RF-LN-CALC               PIC X.
  1962         16  CF-ST-RF-AH-CALC               PIC X.
  1963         16  CF-ST-RF-CP-CALC               PIC X.
  1964*        16  FILLER                         PIC X(206).
  1965*CIDMOD         16  FILLER                         PIC X(192).
  1966         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1967             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1968         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1969         16  CF-ST-VFY-2ND-BENE             PIC X.
  1970         16  FILLER                         PIC X(186).
  1971
  1972****************************************************************
  1973*             BENEFIT MASTER RECORD                            *
  1974****************************************************************
  1975
  1976     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1977         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1978             20  CF-BENEFIT-CODE            PIC XX.
  1979             20  CF-BENEFIT-NUMERIC  REDEFINES
  1980                 CF-BENEFIT-CODE            PIC XX.
  1981             20  CF-BENEFIT-ALPHA           PIC XXX.
  1982             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1983             20  CF-BENEFIT-COMMENT         PIC X(10).
  1984
  1985             20  CF-LF-COVERAGE-TYPE        PIC X.
  1986                 88  CF-REDUCING                VALUE 'R'.
  1987                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1988
  1989             20  CF-SPECIAL-CALC-CD         PIC X.
  1990                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1991                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1992                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1993                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1994                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1995                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1996                 88  CF-FARM-PLAN               VALUE 'F'.
  1997                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1998                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1999                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2000                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2001                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2002                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2003                 88  CF-PRUDENTIAL              VALUE 'P'.
  2004                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2005                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL680.cbl
  2006                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2007                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2008                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2009                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2010
  2011             20  CF-JOINT-INDICATOR         PIC X.
  2012                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2013
  2014*            20  FILLER                     PIC X(12).
  2015             20  FILLER                     PIC X(11).
  2016             20  CF-BENEFIT-CATEGORY        PIC X.
  2017             20  CF-LOAN-TYPE               PIC X(8).
  2018
  2019             20  CF-CO-REM-TERM-CALC        PIC X.
  2020                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2021                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2022                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2023                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2024                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2025
  2026             20  CF-CO-EARNINGS-CALC        PIC X.
  2027                 88  CO-EARN-BY-R78             VALUE '1'.
  2028                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2029                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2030                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2031                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2032                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2033                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2034                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2035
  2036             20  CF-CO-REFUND-CALC          PIC X.
  2037                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2038                 88  CO-REFD-BY-R78             VALUE '1'.
  2039                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2040                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2041                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2042                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2043                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2044                 88  CO-REFD-MEAN               VALUE '8'.
  2045                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2046                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2047                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2048
  2049             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2050                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2051                 88  CO-OVRD-BY-R78             VALUE '1'.
  2052                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2053                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2054                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2055                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2056                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2057                 88  CO-OVRD-MEAN               VALUE '8'.
  2058                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2059
  2060             20  CF-CO-BEN-I-G-CD           PIC X.
  2061                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2062                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2063                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL680.cbl
  2064
  2065         16  FILLER                         PIC X(304).
  2066
  2067
  2068****************************************************************
  2069*             CARRIER MASTER RECORD                            *
  2070****************************************************************
  2071
  2072     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2073         16  CF-ADDRESS-DATA.
  2074             20  CF-MAIL-TO-NAME            PIC X(30).
  2075             20  CF-IN-CARE-OF              PIC X(30).
  2076             20  CF-ADDRESS-LINE-1          PIC X(30).
  2077             20  CF-ADDRESS-LINE-2          PIC X(30).
  2078             20  CF-CITY-STATE              PIC X(30).
  2079             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2080             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2081
  2082         16  CF-CLAIM-NO-CONTROL.
  2083             20  CF-CLAIM-NO-METHOD         PIC X.
  2084                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2085                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2086                 88  CLAIM-NO-SEQ               VALUE '3'.
  2087                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2088             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2089                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2090                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2091                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2092
  2093         16  CF-CHECK-NO-CONTROL.
  2094             20  CF-CHECK-NO-METHOD         PIC X.
  2095                 88  CHECK-NO-MANUAL            VALUE '1'.
  2096                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2097                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2098                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2099             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2100                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2101
  2102         16  CF-DOMICILE-STATE              PIC XX.
  2103
  2104         16  CF-EXPENSE-CONTROLS.
  2105             20  CF-EXPENSE-METHOD          PIC X.
  2106                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2107                 88  DOLLARS-PER-PMT            VALUE '2'.
  2108                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2109                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2110             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2111             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2112
  2113         16  CF-CORRESPONDENCE-CONTROL.
  2114             20  CF-LETTER-RESEND-OPT       PIC X.
  2115                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2116                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2117             20  FILLER                     PIC X(4).
  2118
  2119         16  CF-RESERVE-CONTROLS.
  2120             20  CF-MANUAL-SW               PIC X.
  2121                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL680.cbl
  2122             20  CF-FUTURE-SW               PIC X.
  2123                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2124             20  CF-PTC-SW                  PIC X.
  2125                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2126             20  CF-IBNR-SW                 PIC X.
  2127                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2128             20  CF-PTC-LF-SW               PIC X.
  2129                 88  CF-LF-PTC-USED             VALUE '1'.
  2130             20  CF-CDT-ACCESS-METHOD       PIC X.
  2131                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2132                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2133                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2134             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2135
  2136         16  CF-CLAIM-CALC-METHOD           PIC X.
  2137             88  360-PLUS-MONTHS                VALUE '1'.
  2138             88  365-PLUS-MONTHS                VALUE '2'.
  2139             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2140             88  360-DAILY                      VALUE '4'.
  2141             88  365-DAILY                      VALUE '5'.
  2142
  2143         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2144         16  FILLER                         PIC X(11).
  2145
  2146         16  CF-LIMIT-AMOUNTS.
  2147             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2148             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2149             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2150             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2151             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2152             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2153             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2154             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2155             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2156             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2157
  2158         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2159         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2160         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2161
  2162         16  CF-ZIP-CODE.
  2163             20  CF-ZIP-PRIME.
  2164                 24  CF-ZIP-1ST             PIC X.
  2165                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2166                 24  FILLER                 PIC X(4).
  2167             20  CF-ZIP-PLUS4               PIC X(4).
  2168         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2169             20  CF-CAN-POSTAL-1            PIC XXX.
  2170             20  CF-CAN-POSTAL-2            PIC XXX.
  2171             20  FILLER                     PIC XXX.
  2172
  2173         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2174         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2175         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2176
  2177         16  CF-RATING-SWITCH               PIC X.
  2178             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2179             88  CF-NO-RATING                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL680.cbl
  2180
  2181         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2182
  2183         16  CF-CARRIER-OVER-SHORT.
  2184             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2185             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2186
  2187         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2188         16  CF-SECPAY-SWITCH               PIC X.
  2189             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2190             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2191         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2192         16  FILLER                         PIC X(448).
  2193*        16  FILLER                         PIC X(452).
  2194
  2195
  2196****************************************************************
  2197*             MORTALITY MASTER RECORD                          *
  2198****************************************************************
  2199
  2200     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2201         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2202                                INDEXED BY CF-MORT-NDX.
  2203             20  CF-MORT-TABLE              PIC X(5).
  2204             20  CF-MORT-TABLE-TYPE         PIC X.
  2205                 88  CF-MORT-JOINT              VALUE 'J'.
  2206                 88  CF-MORT-SINGLE             VALUE 'S'.
  2207                 88  CF-MORT-COMBINED           VALUE 'C'.
  2208                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2209                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2210             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2211             20  CF-MORT-AGE-METHOD         PIC XX.
  2212                 88  CF-AGE-LAST                VALUE 'AL'.
  2213                 88  CF-AGE-NEAR                VALUE 'AN'.
  2214             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2215             20  CF-MORT-ADJUSTMENT-DIRECTION
  2216                                            PIC X.
  2217                 88  CF-MINUS                   VALUE '-'.
  2218                 88  CF-PLUS                    VALUE '+'.
  2219             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2220             20  CF-MORT-JOINT-CODE         PIC X.
  2221                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2222             20  CF-MORT-PC-Q               PIC X.
  2223                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2224             20  CF-MORT-TABLE-CODE         PIC X(4).
  2225             20  CF-MORT-COMMENTS           PIC X(15).
  2226             20  FILLER                     PIC X(14).
  2227
  2228         16  FILLER                         PIC X(251).
  2229
  2230
  2231****************************************************************
  2232*             BUSSINESS TYPE MASTER RECORD                     *
  2233****************************************************************
  2234
  2235     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2236* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2237* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL680.cbl
  2238* AND RECORD 05 IS TYPES 81-99
  2239         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2240             20  CF-BUSINESS-TITLE          PIC  X(19).
  2241             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2242                                            PIC S9V9(4) COMP-3.
  2243             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2244             20  FILLER                     PIC  X.
  2245         16  FILLER                         PIC  X(248).
  2246
  2247
  2248****************************************************************
  2249*             TERMINAL MASTER RECORD                           *
  2250****************************************************************
  2251
  2252     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2253
  2254         16  CF-COMPANY-TERMINALS.
  2255             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2256                                  PIC X(4).
  2257         16  FILLER               PIC X(248).
  2258
  2259
  2260****************************************************************
  2261*             LIFE EDIT MASTER RECORD                          *
  2262****************************************************************
  2263
  2264     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2265         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2266             20  CF-LIFE-CODE-IN            PIC XX.
  2267             20  CF-LIFE-CODE-OUT           PIC XX.
  2268         16  FILLER                         PIC X(248).
  2269
  2270
  2271****************************************************************
  2272*             AH EDIT MASTER RECORD                            *
  2273****************************************************************
  2274
  2275     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2276         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2277             20  CF-AH-CODE-IN              PIC XXX.
  2278             20  CF-AH-CODE-OUT             PIC XX.
  2279         16  FILLER                         PIC X(248).
  2280
  2281
  2282****************************************************************
  2283*             CREDIBILITY TABLES                               *
  2284****************************************************************
  2285
  2286     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2287         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2288                             INDEXED BY CF-CRDB-NDX.
  2289             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2290             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2291             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2292         16  FILLER                         PIC  X(332).
  2293
  2294
  2295****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL680.cbl
  2296*             REPORT CUSTOMIZATION RECORD                      *
  2297****************************************************************
  2298
  2299     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2300         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2301             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2302             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2303             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2304**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2305****       A T-TRANSFER.                                   ****
  2306             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2307
  2308         16  FILLER                         PIC XX.
  2309
  2310         16  CF-CARRIER-CNTL-OPT.
  2311             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2312                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2313                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2314             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2315                                            PIC X.
  2316         16  CF-GROUP-CNTL-OPT.
  2317             20  CF-GROUP-OPT-SEQ           PIC 9.
  2318                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2319                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2320             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2321                                            PIC X(6).
  2322         16  CF-STATE-CNTL-OPT.
  2323             20  CF-STATE-OPT-SEQ           PIC 9.
  2324                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2325                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2326             20  CF-STATE-SELECT OCCURS 3 TIMES
  2327                                            PIC XX.
  2328         16  CF-ACCOUNT-CNTL-OPT.
  2329             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2330                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2331                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2332             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2333                                            PIC X(10).
  2334         16  CF-BUS-TYP-CNTL-OPT.
  2335             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2336                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2337                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2338             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2339                                            PIC XX.
  2340         16  CF-LF-TYP-CNTL-OPT.
  2341             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2342                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2343                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2344             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2345                                            PIC XX.
  2346         16  CF-AH-TYP-CNTL-OPT.
  2347             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2348                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2349                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2350             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2351                                            PIC XX.
  2352         16  CF-REPTCD1-CNTL-OPT.
  2353             20  CF-REPTCD1-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL680.cbl
  2354                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2355                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2356             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2357                                            PIC X(10).
  2358         16  CF-REPTCD2-CNTL-OPT.
  2359             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2360                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2361                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2362             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2363                                            PIC X(10).
  2364         16  CF-USER1-CNTL-OPT.
  2365             20  CF-USER1-OPT-SEQ           PIC 9.
  2366                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2367                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2368             20  CF-USER1-SELECT OCCURS 3 TIMES
  2369                                            PIC X(10).
  2370         16  CF-USER2-CNTL-OPT.
  2371             20  CF-USER2-OPT-SEQ           PIC 9.
  2372                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2373                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2374             20  CF-USER2-SELECT OCCURS 3 TIMES
  2375                                            PIC X(10).
  2376         16  CF-USER3-CNTL-OPT.
  2377             20  CF-USER3-OPT-SEQ           PIC 9.
  2378                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2379                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2380             20  CF-USER3-SELECT OCCURS 3 TIMES
  2381                                            PIC X(10).
  2382         16  CF-USER4-CNTL-OPT.
  2383             20  CF-USER4-OPT-SEQ           PIC 9.
  2384                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2385                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2386             20  CF-USER4-SELECT OCCURS 3 TIMES
  2387                                            PIC X(10).
  2388         16  CF-USER5-CNTL-OPT.
  2389             20  CF-USER5-OPT-SEQ           PIC 9.
  2390                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2391                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2392             20  CF-USER5-SELECT OCCURS 3 TIMES
  2393                                            PIC X(10).
  2394         16  CF-REINS-CNTL-OPT.
  2395             20  CF-REINS-OPT-SEQ           PIC 9.
  2396                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2397                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2398             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2399                 24  CF-REINS-PRIME         PIC XXX.
  2400                 24  CF-REINS-SUB           PIC XXX.
  2401
  2402         16  CF-AGENT-CNTL-OPT.
  2403             20  CF-AGENT-OPT-SEQ           PIC 9.
  2404                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2405                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2406             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2407                                            PIC X(10).
  2408
  2409         16  FILLER                         PIC X(43).
  2410
  2411         16  CF-LOSS-RATIO-SELECT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL680.cbl
  2412             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2413             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2414         16  CF-ENTRY-DATE-SELECT.
  2415             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2416             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2417         16  CF-EFFECTIVE-DATE-SELECT.
  2418             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2419             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2420
  2421         16  CF-EXCEPTION-LIST-IND          PIC X.
  2422             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2423
  2424         16  FILLER                         PIC X(318).
  2425
  2426****************************************************************
  2427*                  EXCEPTION REPORTING RECORD                  *
  2428****************************************************************
  2429
  2430     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2431         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2432             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2433
  2434         16  CF-COMBINED-LIFE-AH-OPT.
  2435             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2436             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2437             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2438             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2439
  2440         16  CF-LIFE-OPT.
  2441             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2442             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2443             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2444             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2445             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2446             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2447             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2448             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2449             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2450             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2451
  2452         16  CF-AH-OPT.
  2453             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2454             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2455             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2456             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2457             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2458             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2459             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2460             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2461             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2462             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2463
  2464         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2465             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2466             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2467             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2468
  2469         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL680.cbl
  2470
  2471         16  FILLER                         PIC X(673).
  2472
  2473
  2474****************************************************************
  2475*             MORTGAGE SYSTEM PLAN RECORD                      *
  2476****************************************************************
  2477
  2478     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2479         16  CF-PLAN-TYPE                   PIC X.
  2480             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2481             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2482             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2483         16  CF-PLAN-ABBREV                 PIC XXX.
  2484         16  CF-PLAN-DESCRIPT               PIC X(10).
  2485         16  CF-PLAN-NOTES                  PIC X(20).
  2486         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2487         16  CF-PLAN-UNDERWRITING.
  2488             20  CF-PLAN-TERM-DATA.
  2489                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2490                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2491             20  CF-PLAN-AGE-DATA.
  2492                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2493                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2494                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2495             20  CF-PLAN-BENEFIT-DATA.
  2496                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2497                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2498                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2499                                            PIC S9(7)V99  COMP-3.
  2500         16  CF-PLAN-POLICY-FORMS.
  2501             20  CF-POLICY-FORM             PIC X(12).
  2502             20  CF-MASTER-APPLICATION      PIC X(12).
  2503             20  CF-MASTER-POLICY           PIC X(12).
  2504         16  CF-PLAN-RATING.
  2505             20  CF-RATE-CODE               PIC X(5).
  2506             20  CF-SEX-RATING              PIC X.
  2507                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2508                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2509             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2510             20  CF-SUB-STD-TYPE            PIC X.
  2511                 88  CF-PCT-OF-PREM            VALUE '1'.
  2512                 88  CF-PCT-OF-BENE            VALUE '2'.
  2513         16  CF-PLAN-PREM-TOLERANCES.
  2514             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2515             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2516         16  CF-PLAN-PYMT-TOLERANCES.
  2517             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2518             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2519         16  CF-PLAN-MISC-DATA.
  2520             20  FILLER                     PIC X.
  2521             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2522             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2523         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2524         16  CF-PLAN-IND-GRP                PIC X.
  2525             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2526                                                     '1'.
  2527             88  CF-MORT-GROUP-PLAN            VALUE 'G'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL680.cbl
  2528                                                     '2'.
  2529         16  CF-MIB-SEARCH-SW               PIC X.
  2530             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2531             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2532             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2533             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2534         16  CF-ALPHA-SEARCH-SW             PIC X.
  2535             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2536             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2537             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2538             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2539             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2540             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2541             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2542             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2543             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2544             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2545                                                     'A' 'B' 'C'
  2546                                                     'X' 'Y' 'Z'.
  2547         16  CF-EFF-DT-RULE-SW              PIC X.
  2548             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2549             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2550             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2551             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2552             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2553         16  FILLER                         PIC X(4).
  2554         16  CF-HEALTH-QUESTIONS            PIC X.
  2555             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2556         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2557         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2558         16  CF-PLAN-SNGL-JNT               PIC X.
  2559             88  CF-COMBINED-PLAN              VALUE 'C'.
  2560             88  CF-JNT-PLAN                   VALUE 'J'.
  2561             88  CF-SNGL-PLAN                  VALUE 'S'.
  2562         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2563         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2564         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2565         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2566         16  CF-RERATE-CNTL                 PIC  X.
  2567             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2568             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2569             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2570             88  CF-AUTO-RECALC                 VALUE '4'.
  2571         16  CF-BENEFIT-TYPE                PIC  X.
  2572             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2573             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2574         16  CF-POLICY-FEE                  PIC S999V99
  2575                                                    COMP-3.
  2576         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2577         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2578         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2579         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2580         16  FILLER                         PIC  X(32).
  2581         16  CF-TERMINATION-FORM            PIC  X(04).
  2582         16  FILLER                         PIC  X(08).
  2583         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2584                                                       COMP-3.
  2585         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL680.cbl
  2586         16  CF-ISSUE-LETTER                PIC  X(4).
  2587         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2588         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2589             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2590             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2591         16  CF-MP-REFUND-CALC              PIC X.
  2592             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2593             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2594             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2595             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2596             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2597             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2598             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2599             88  CF-MP-REFD-MEAN                VALUE '8'.
  2600         16  CF-ALT-RATE-CODE               PIC  X(5).
  2601
  2602
  2603         16  FILLER                         PIC X(498).
  2604****************************************************************
  2605*             MORTGAGE COMPANY MASTER RECORD                   *
  2606****************************************************************
  2607
  2608     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2609         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2610         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2611             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2612             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2613             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2614             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2615             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2616
  2617         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2618         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2619         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2620         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2621         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2622
  2623         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2624             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2625         16  CF-MP-RECON-USE-IND            PIC X(1).
  2626             88  CF-MP-USE-RECON             VALUE 'Y'.
  2627         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2628             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2629         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2630             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2631             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2632         16  FILLER                         PIC X(1).
  2633         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2634             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2635         16  CF-MORTG-MIB-VERSION           PIC X.
  2636             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2637             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2638             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2639         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2640             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2641                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2642             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2643                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL680.cbl
  2644             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2645                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2646             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2647                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2648             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2649                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2650             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2651                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2652         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2653         16  FILLER                         PIC X(7).
  2654         16  CF-MORTG-DESTINATION-SYMBOL.
  2655             20  CF-MORTG-MIB-COMM          PIC X(5).
  2656             20  CF-MORTG-MIB-TERM          PIC X(5).
  2657         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2658             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2659         16  FILLER                         PIC X(03).
  2660         16  CF-MP-CHECK-NO-CONTROL.
  2661             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2662                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2663                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2664                                                ' ' LOW-VALUES.
  2665                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2666                                               VALUE '3'.
  2667         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2668         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2669         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2670             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2671                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2672             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2673                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2674             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2675                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2676             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2677                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2678             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2679                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2680             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2681                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2682         16  CF-MORTG-BILLING-AREA.
  2683             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2684                                            PIC X.
  2685         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2686         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2687         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2688         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2689             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2690             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2691         16  FILLER                         PIC X.
  2692         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2693             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2694             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2695         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2696         16  FILLER                         PIC X(8).
  2697         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2698         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2699         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2700         16  CF-ACH-COMPANY-ID.
  2701             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL680.cbl
  2702                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2703                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2704                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2705             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2706         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2707             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2708         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2709             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2710             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2711         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2712         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2713         16  FILLER                         PIC X(536).
  2714
  2715****************************************************************
  2716*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2717****************************************************************
  2718
  2719     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2720         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2721             20  CF-FEMALE-HEIGHT.
  2722                 24  CF-FEMALE-FT           PIC 99.
  2723                 24  CF-FEMALE-IN           PIC 99.
  2724             20  CF-FEMALE-MIN-WT           PIC 999.
  2725             20  CF-FEMALE-MAX-WT           PIC 999.
  2726         16  FILLER                         PIC X(428).
  2727
  2728     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2729         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2730             20  CF-MALE-HEIGHT.
  2731                 24  CF-MALE-FT             PIC 99.
  2732                 24  CF-MALE-IN             PIC 99.
  2733             20  CF-MALE-MIN-WT             PIC 999.
  2734             20  CF-MALE-MAX-WT             PIC 999.
  2735         16  FILLER                         PIC X(428).
  2736******************************************************************
  2737*             AUTOMATIC ACTIVITY RECORD                          *
  2738******************************************************************
  2739     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2740         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2741             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2742             20  CF-SYS-LETTER-ID           PIC X(04).
  2743             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2744             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2745             20  CF-SYS-RESET-SW            PIC X(01).
  2746             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2747             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2748
  2749         16  FILLER                         PIC X(50).
  2750
  2751         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2752             20  CF-USER-ACTIVE-SW          PIC X(01).
  2753             20  CF-USER-LETTER-ID          PIC X(04).
  2754             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2755             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2756             20  CF-USER-RESET-SW           PIC X(01).
  2757             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2758             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2759             20  CF-USER-ACTIVITY-DESC      PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL680.cbl
  2760
  2761         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL680.cbl
  2763 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE.
  2764 0000-DFHEXIT SECTION.
  2765     MOVE '9#                    $   ' TO DFHEIV0.
  2766     MOVE 'EL680' TO DFHEIV1.
  2767     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2768     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2769     MOVE '5'                   TO DC-OPTION-CODE.
  2770     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2771     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2772     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2773
  2774     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2775     MOVE 2           TO EMI-NUMBER-OF-LINES.
  2776
  2777     IF EIBCALEN = 0
  2778         GO TO 8800-UNAUTHORIZED-ACCESS.
  2779
  2780     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2781         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2782             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2783             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2784             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2785             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2786             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2787             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2788             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2789             MOVE THIS-PGM             TO PI-CALLING-PROGRAM.
  2790
  2791     IF EIBTRNID NOT = TRANS-ID
  2792         GO TO 8100-SEND-INITIAL-MAP.
  2793
  2794     IF EIBAID = DFHCLEAR
  2795         GO TO 9400-CLEAR.
  2796
  2797
  2798* EXEC CICS HANDLE CONDITION
  2799*        MAPFAIL (8100-SEND-INITIAL-MAP)
  2800*    END-EXEC.
  2801*    MOVE '"$?                   ! " #00002793' TO DFHEIV0
  2802     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  2803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2804     MOVE X'2220233030303032373933' TO DFHEIV0(25:11)
  2805     CALL 'kxdfhei1' USING DFHEIV0
  2806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2807
  2808
  2809 0100-RECEIVE-MAP.
  2810
  2811* EXEC CICS RECEIVE
  2812*        MAP    (MAP-NAME)
  2813*        MAPSET (MAPSET-NAME)
  2814*        INTO   (EL680AI)
  2815*    END-EXEC.
  2816     MOVE LENGTH OF
  2817      EL680AI
  2818       TO DFHEIV11
  2819*    MOVE '8"T I  L              ''   #00002798' TO DFHEIV0
  2820     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL680.cbl
  2821     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2822     MOVE X'2020233030303032373938' TO DFHEIV0(25:11)
  2823     CALL 'kxdfhei1' USING DFHEIV0,
  2824           MAP-NAME,
  2825           EL680AI,
  2826           DFHEIV11,
  2827           MAPSET-NAME,
  2828           DFHEIV99,
  2829           DFHEIV99
  2830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2831
  2832
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL680.cbl
  2834 0200-RECEIVE.
  2835     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2836         MOVE ER-0008  TO EMI-ERROR
  2837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2838         MOVE -1    TO ANAMEL
  2839         GO TO 8200-SEND-DATAONLY.
  2840
  2841     IF PFENTERL = 0
  2842         GO TO 0300-CHECK-PFKEYS.
  2843     IF EIBAID NOT = DFHENTER
  2844         MOVE ER-0004  TO EMI-ERROR
  2845         GO TO 0320-INPUT-ERROR.
  2846
  2847     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2848         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2849     ELSE
  2850         MOVE ER-0029  TO EMI-ERROR
  2851         GO TO 0320-INPUT-ERROR.
  2852
  2853 0300-CHECK-PFKEYS.
  2854     IF EIBAID = DFHPF1
  2855         GO TO 1000-EDIT-INPUT-DATA.
  2856
  2857     IF EIBAID = DFHPF23
  2858         GO TO 8810-PF23.
  2859
  2860     IF EIBAID = DFHPF24
  2861         GO TO 9200-RETURN-MAIN-MENU.
  2862
  2863     IF EIBAID = DFHPF12
  2864         GO TO 9500-PF12.
  2865
  2866     IF EIBAID = DFHENTER
  2867         GO TO 1000-EDIT-INPUT-DATA.
  2868
  2869     MOVE ER-0029 TO EMI-ERROR.
  2870 0320-INPUT-ERROR.
  2871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2872     MOVE AL-UNBON               TO PFENTERA.
  2873     IF PFENTERL = 0
  2874         MOVE -1                 TO ANAMEL
  2875     ELSE
  2876         MOVE -1                 TO PFENTERL.
  2877
  2878     GO TO 8200-SEND-DATAONLY.
  2879
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL680.cbl
  2881 1000-EDIT-INPUT-DATA.
  2882******EDIT AMOUNT REQUESTED
  2883
  2884
  2885* EXEC CICS BIF DEEDIT
  2886*        FIELD  (AAMOUNTI)
  2887*        LENGTH (12)
  2888*    END-EXEC.
  2889     MOVE 12
  2890       TO DFHEIV11
  2891*    MOVE '@"L                   #   #00002855' TO DFHEIV0
  2892     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2893     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2894     MOVE X'2020233030303032383535' TO DFHEIV0(25:11)
  2895     CALL 'kxdfhei1' USING DFHEIV0,
  2896           AAMOUNTI,
  2897           DFHEIV11
  2898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2899
  2900
  2901     IF (AAMOUNTI NUMERIC)  AND
  2902        (AAMOUNTI NOT = ZERO)
  2903         MOVE AAMOUNTI       TO  WS-AMOUNT-REQUESTED
  2904                                 AAMOUNTO
  2905         MOVE AL-UNNON       TO  AAMOUNTA
  2906       ELSE
  2907         MOVE -1             TO  AAMOUNTL
  2908         MOVE AL-UNBON       TO  AAMOUNTA
  2909         MOVE ER-2361        TO  EMI-ERROR
  2910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2911         ADD +1  TO  WS-ERROR-COUNT.
  2912
  2913***********INTEREST RATE (APR)
  2914
  2915* EXEC CICS BIF DEEDIT
  2916*        FIELD  (AINTRATI)
  2917*        LENGTH (8)
  2918*    END-EXEC.
  2919     MOVE 8
  2920       TO DFHEIV11
  2921*    MOVE '@"L                   #   #00002873' TO DFHEIV0
  2922     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2923     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2924     MOVE X'2020233030303032383733' TO DFHEIV0(25:11)
  2925     CALL 'kxdfhei1' USING DFHEIV0,
  2926           AINTRATI,
  2927           DFHEIV11
  2928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2929
  2930
  2931     IF (AINTRATI NUMERIC)  AND
  2932        (AINTRATI NOT = ZERO)
  2933         MOVE AINTRATI       TO  WS-APR
  2934                                 AINTRATO
  2935         MOVE AL-UNNON       TO  AINTRATA
  2936       ELSE
  2937         MOVE -1             TO  AINTRATL
  2938         MOVE AL-UNBON       TO  AINTRATA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL680.cbl
  2939         MOVE ER-2363        TO  EMI-ERROR
  2940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2941         ADD +1  TO  WS-ERROR-COUNT.
  2942
  2943***********PAYMENT FREQUENCY
  2944     IF AFREQI = 'MO' OR 'SM' OR 'BW' OR 'WK' OR
  2945                 'SA' OR 'AN' OR '13'
  2946         MOVE AL-UANON       TO  AFREQA
  2947         MOVE AFREQI         TO  WS-FREQ
  2948       ELSE
  2949         MOVE -1             TO  AFREQL
  2950         MOVE AL-UABON       TO  AFREQA
  2951         MOVE ER-2920        TO  EMI-ERROR
  2952         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2953         ADD +1  TO  WS-ERROR-COUNT.
  2954
  2955***********NUMBER OF PAYMENTS
  2956
  2957* EXEC CICS BIF DEEDIT
  2958*        FIELD  (ANOPMTSI)
  2959*        LENGTH (3)
  2960*    END-EXEC.
  2961     MOVE 3
  2962       TO DFHEIV11
  2963*    MOVE '@"L                   #   #00002903' TO DFHEIV0
  2964     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2965     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2966     MOVE X'2020233030303032393033' TO DFHEIV0(25:11)
  2967     CALL 'kxdfhei1' USING DFHEIV0,
  2968           ANOPMTSI,
  2969           DFHEIV11
  2970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2971
  2972
  2973     IF (ANOPMTSI NUMERIC) AND
  2974        (ANOPMTSI NOT = ZERO)
  2975         MOVE ANOPMTSI       TO  WS-NUMBER-OF-PMTS
  2976                                 ANOPMTSO
  2977         MOVE AL-UNNON       TO  ANOPMTSA
  2978       ELSE
  2979         MOVE -1             TO  ANOPMTSL
  2980         MOVE AL-UNBON       TO  ANOPMTSA
  2981         MOVE ER-2364        TO  EMI-ERROR
  2982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2983         ADD +1  TO  WS-ERROR-COUNT.
  2984
  2985***********ADDITIONAL DAYS TO FIRST PAYMENT
  2986     IF AADDAYSL GREATER THAN ZERO
  2987
  2988* EXEC CICS BIF DEEDIT
  2989*            FIELD  (AADDAYSI)
  2990*            LENGTH (3)
  2991*        END-EXEC
  2992     MOVE 3
  2993       TO DFHEIV11
  2994*    MOVE '@"L                   #   #00002922' TO DFHEIV0
  2995     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2996     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL680.cbl
  2997     MOVE X'2020233030303032393232' TO DFHEIV0(25:11)
  2998     CALL 'kxdfhei1' USING DFHEIV0,
  2999           AADDAYSI,
  3000           DFHEIV11
  3001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3002         IF AADDAYSI NUMERIC
  3003             MOVE AADDAYSI       TO  WS-ADDTL-DAYS
  3004                                     AADDAYSO
  3005             MOVE AL-UNNON       TO  AADDAYSA
  3006           ELSE
  3007             MOVE -1             TO  AADDAYSL
  3008             MOVE AL-UNBON       TO  AADDAYSA
  3009             MOVE ER-2921        TO  EMI-ERROR
  3010             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3011             ADD +1  TO  WS-ERROR-COUNT.
  3012
  3013***********ADDITIONAL DAYS CHARGING METHOD
  3014********** SPACE=NO CHG, 1=LF, 2=AH, 3=LF AND AH
  3015     IF ADDCHGL  GREATER THAN ZERO
  3016     IF ADDCHGI = '1' OR '2' OR '3' OR ' '
  3017         MOVE AL-UANON       TO  ADDCHGA
  3018         MOVE ADDCHGI        TO  WS-ADDCHG
  3019       ELSE
  3020         MOVE -1             TO  ADDCHGL
  3021         MOVE AL-UABON       TO  ADDCHGA
  3022         MOVE ER-4004        TO  EMI-ERROR
  3023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3024         ADD +1  TO  WS-ERROR-COUNT.
  3025
  3026***********BASIS
  3027     IF ABASISI = 'AF' OR 'TP' OR 'NP'
  3028         MOVE AL-UANON       TO  ABASISA
  3029         MOVE ABASISI        TO  WS-BASIS-X
  3030       ELSE
  3031         MOVE -1             TO  ABASISL
  3032         MOVE AL-UABON       TO  ABASISA
  3033         MOVE ER-2367        TO  EMI-ERROR
  3034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3035         ADD +1  TO  WS-ERROR-COUNT.
  3036
  3037**********USE O/B NET ACTUARIAL RATE
  3038     IF OBYORNL GREATER ZERO
  3039     IF OBYORNI = 'Y' OR 'N'
  3040         MOVE AL-UANON       TO  OBYORNA
  3041         MOVE OBYORNI        TO  WS-OBYN
  3042       ELSE
  3043         MOVE -1             TO  OBYORNL
  3044         MOVE AL-UABON       TO  OBYORNA
  3045         MOVE ER-2922        TO  EMI-ERROR
  3046         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3047         ADD +1  TO  WS-ERROR-COUNT.
  3048
  3049***********NP BENEFIT INCLUDES PREMIUM (Y/N)
  3050     IF WS-BASIS-X = 'NP'
  3051         IF ANPREMI = 'Y' OR 'N'
  3052             MOVE AL-UANON       TO  ANPREMA
  3053             MOVE ANPREMI        TO  WS-NPBEN
  3054           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL680.cbl
  3055             MOVE -1             TO  ANPREML
  3056             MOVE AL-UABON       TO  ANPREMA
  3057             MOVE ER-2922        TO  EMI-ERROR
  3058             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3059             ADD +1  TO  WS-ERROR-COUNT.
  3060
  3061***********TRUNCATED LIFE NO. OF PAYMENTS COVERED
  3062     IF ATRUNCL GREATER THAN ZERO
  3063
  3064* EXEC CICS BIF DEEDIT
  3065*            FIELD  (ATRUNCI)
  3066*            LENGTH (3)
  3067*        END-EXEC
  3068     MOVE 3
  3069       TO DFHEIV11
  3070*    MOVE '@"L                   #   #00002987' TO DFHEIV0
  3071     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3072     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3073     MOVE X'2020233030303032393837' TO DFHEIV0(25:11)
  3074     CALL 'kxdfhei1' USING DFHEIV0,
  3075           ATRUNCI,
  3076           DFHEIV11
  3077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3078         IF ATRUNCI IS NUMERIC
  3079             MOVE ATRUNCI        TO  WS-TRUNC
  3080                                     ATRUNCO
  3081             MOVE AL-UNNON       TO  ATRUNCA
  3082           IF WS-TRUNC GREATER WS-NUMBER-OF-PMTS
  3083             MOVE -1             TO  ATRUNCL
  3084             MOVE AL-UNBON       TO  ATRUNCA
  3085             MOVE ER-4007        TO  EMI-ERROR
  3086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3087             ADD +1  TO  WS-ERROR-COUNT
  3088           ELSE
  3089             NEXT SENTENCE
  3090           ELSE
  3091             MOVE -1             TO  ATRUNCL
  3092             MOVE AL-UNBON       TO  ATRUNCA
  3093             MOVE ER-2923        TO  EMI-ERROR
  3094             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3095             ADD +1  TO  WS-ERROR-COUNT.
  3096
  3097***********EXTRA INTEREST PERIODS
  3098     IF AEXTRAL GREATER THAN ZERO
  3099
  3100* EXEC CICS BIF DEEDIT
  3101*            FIELD  (AEXTRAI)
  3102*            LENGTH (1)
  3103*        END-EXEC
  3104     MOVE 1
  3105       TO DFHEIV11
  3106*    MOVE '@"L                   #   #00003012' TO DFHEIV0
  3107     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3108     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3109     MOVE X'2020233030303033303132' TO DFHEIV0(25:11)
  3110     CALL 'kxdfhei1' USING DFHEIV0,
  3111           AEXTRAI,
  3112           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL680.cbl
  3113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3114         IF AEXTRAI NUMERIC
  3115             MOVE AEXTRAI        TO  WS-EXTRA
  3116                                     AEXTRAO
  3117             MOVE AL-UNNON       TO  AEXTRAA
  3118           ELSE
  3119             MOVE -1             TO  AEXTRAL
  3120             MOVE AL-UNBON       TO  AEXTRAA
  3121             MOVE ER-2924        TO  EMI-ERROR
  3122             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3123             ADD +1  TO  WS-ERROR-COUNT.
  3124
  3125***********LIFE RATE
  3126     IF ALRATEL GREATER THAN ZERO
  3127
  3128* EXEC CICS BIF DEEDIT
  3129*            FIELD  (ALRATEI)
  3130*            LENGTH (8)
  3131*        END-EXEC
  3132     MOVE 8
  3133       TO DFHEIV11
  3134*    MOVE '@"L                   #   #00003029' TO DFHEIV0
  3135     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3136     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3137     MOVE X'2020233030303033303239' TO DFHEIV0(25:11)
  3138     CALL 'kxdfhei1' USING DFHEIV0,
  3139           ALRATEI,
  3140           DFHEIV11
  3141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3142         IF ALRATEI NUMERIC
  3143             MOVE ALRATEI        TO  WS-LIFE-RATE
  3144                                     ALRATEO
  3145             MOVE AL-UNNON       TO  ALRATEA
  3146           ELSE
  3147             MOVE -1             TO  ALRATEL
  3148             MOVE AL-UNBON       TO  ALRATEA
  3149             MOVE ER-2365        TO  EMI-ERROR
  3150             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3151             ADD +1  TO  WS-ERROR-COUNT.
  3152
  3153***********LIFE DEVIATION
  3154     IF ALFDEVL GREATER THAN ZERO
  3155
  3156* EXEC CICS BIF DEEDIT
  3157*            FIELD  (ALFDEVI)
  3158*            LENGTH (7)
  3159*        END-EXEC
  3160     MOVE 7
  3161       TO DFHEIV11
  3162*    MOVE '@"L                   #   #00003046' TO DFHEIV0
  3163     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3164     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3165     MOVE X'2020233030303033303436' TO DFHEIV0(25:11)
  3166     CALL 'kxdfhei1' USING DFHEIV0,
  3167           ALFDEVI,
  3168           DFHEIV11
  3169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3170         IF ALFDEVI NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL680.cbl
  3171             MOVE ALFDEVI        TO  WS-LIFE-DEVIATION
  3172                                     ALFDEVO
  3173             MOVE AL-UNNON       TO  ALFDEVA
  3174           ELSE
  3175             MOVE -1             TO  ALFDEVL
  3176             MOVE AL-UNBON       TO  ALFDEVA
  3177             MOVE ER-2925        TO  EMI-ERROR
  3178             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3179             ADD +1  TO  WS-ERROR-COUNT
  3180     ELSE
  3181        MOVE 100 TO WS-LIFE-DEVIATION
  3182                    ALFDEVO.
  3183
  3184***********DISABILITY RATE
  3185     IF ADRATEL GREATER THAN ZERO
  3186
  3187* EXEC CICS BIF DEEDIT
  3188*            FIELD  (ADRATEI)
  3189*            LENGTH (8)
  3190*        END-EXEC
  3191     MOVE 8
  3192       TO DFHEIV11
  3193*    MOVE '@"L                   #   #00003066' TO DFHEIV0
  3194     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3195     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3196     MOVE X'2020233030303033303636' TO DFHEIV0(25:11)
  3197     CALL 'kxdfhei1' USING DFHEIV0,
  3198           ADRATEI,
  3199           DFHEIV11
  3200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3201         IF ADRATEI NUMERIC
  3202             MOVE ADRATEI        TO  WS-AH-RATE
  3203                                     ADRATEO
  3204             MOVE AL-UNNON       TO  ADRATEA
  3205           ELSE
  3206             MOVE -1             TO  ADRATEL
  3207             MOVE AL-UNBON       TO  ADRATEA
  3208             MOVE ER-2366        TO  EMI-ERROR
  3209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3210             ADD +1  TO  WS-ERROR-COUNT.
  3211
  3212***********AH DEVIATION
  3213     IF AAHDEVL GREATER THAN ZERO
  3214
  3215* EXEC CICS BIF DEEDIT
  3216*            FIELD  (AAHDEVI)
  3217*            LENGTH (7)
  3218*        END-EXEC
  3219     MOVE 7
  3220       TO DFHEIV11
  3221*    MOVE '@"L                   #   #00003083' TO DFHEIV0
  3222     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3223     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3224     MOVE X'2020233030303033303833' TO DFHEIV0(25:11)
  3225     CALL 'kxdfhei1' USING DFHEIV0,
  3226           AAHDEVI,
  3227           DFHEIV11
  3228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL680.cbl
  3229         IF AAHDEVI NUMERIC
  3230             MOVE AAHDEVI        TO  WS-AH-DEVIATION
  3231                                     AAHDEVO
  3232             MOVE AL-UNNON       TO  AAHDEVA
  3233           ELSE
  3234             MOVE -1             TO  AAHDEVL
  3235             MOVE AL-UNBON       TO  AAHDEVA
  3236             MOVE ER-2926        TO  EMI-ERROR
  3237             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3238             ADD +1  TO  WS-ERROR-COUNT
  3239     ELSE
  3240        MOVE 100 TO WS-AH-DEVIATION
  3241                    AAHDEVO.
  3242
  3243********** NO. PAYMENTS COVERED IF NOT SAME AS LIFE
  3244     IF ANOTLFL GREATER THAN ZERO
  3245
  3246* EXEC CICS BIF DEEDIT
  3247*            FIELD  (ANOTLFI)
  3248*            LENGTH (3)
  3249*        END-EXEC
  3250     MOVE 3
  3251       TO DFHEIV11
  3252*    MOVE '@"L                   #   #00003103' TO DFHEIV0
  3253     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3254     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3255     MOVE X'2020233030303033313033' TO DFHEIV0(25:11)
  3256     CALL 'kxdfhei1' USING DFHEIV0,
  3257           ANOTLFI,
  3258           DFHEIV11
  3259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3260         IF ANOTLFI NUMERIC
  3261             MOVE ANOTLFI        TO  WS-PAYMENTS-COVERED
  3262                                     ANOTLFO
  3263             MOVE AL-UNNON       TO  ANOTLFA
  3264           ELSE
  3265             MOVE -1             TO  ANOTLFL
  3266             MOVE AL-UNBON       TO  ANOTLFA
  3267             MOVE ER-2927        TO  EMI-ERROR
  3268             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3269             ADD +1  TO  WS-ERROR-COUNT.
  3270
  3271********** BALLOON AMOUNT
  3272     IF BALAMTL GREATER THAN ZERO
  3273
  3274* EXEC CICS BIF DEEDIT
  3275*            FIELD  (BALAMTI)
  3276*            LENGTH (12)
  3277*        END-EXEC
  3278     MOVE 12
  3279       TO DFHEIV11
  3280*    MOVE '@"L                   #   #00003120' TO DFHEIV0
  3281     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3282     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3283     MOVE X'2020233030303033313230' TO DFHEIV0(25:11)
  3284     CALL 'kxdfhei1' USING DFHEIV0,
  3285           BALAMTI,
  3286           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL680.cbl
  3287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3288         IF BALAMTI NUMERIC
  3289             MOVE BALAMTI        TO  WS-BALLOON-AMOUNT
  3290                                     BALAMTO
  3291             MOVE AL-UNNON       TO  BALAMTA
  3292           ELSE
  3293             MOVE -1             TO  BALAMTL
  3294             MOVE AL-UNBON       TO  BALAMTA
  3295             MOVE ER-2927        TO  EMI-ERROR
  3296             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3297             ADD +1  TO  WS-ERROR-COUNT.
  3298
  3299***********BALLOON RATE
  3300     IF BLRATEL GREATER THAN ZERO
  3301
  3302* EXEC CICS BIF DEEDIT
  3303*            FIELD  (BLRATEI)
  3304*            LENGTH (8)
  3305*        END-EXEC
  3306     MOVE 8
  3307       TO DFHEIV11
  3308*    MOVE '@"L                   #   #00003137' TO DFHEIV0
  3309     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3311     MOVE X'2020233030303033313337' TO DFHEIV0(25:11)
  3312     CALL 'kxdfhei1' USING DFHEIV0,
  3313           BLRATEI,
  3314           DFHEIV11
  3315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3316         IF BLRATEI NUMERIC
  3317             MOVE BLRATEI        TO  WS-BL-RATE
  3318                                     BLRATEO
  3319             MOVE AL-UNNON       TO  BLRATEA
  3320           ELSE
  3321             MOVE -1             TO  BLRATEL
  3322             MOVE AL-UNBON       TO  BLRATEA
  3323             MOVE ER-2366        TO  EMI-ERROR
  3324             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3325             ADD +1  TO  WS-ERROR-COUNT.
  3326
  3327********** BALLOON PAYMENT COINCIDE W/LAST PAYMENT (Y/N)
  3328     IF BALYNL GREATER THAN ZERO
  3329         IF BALYNI = 'Y' OR 'N'
  3330             MOVE BALYNI         TO  WS-BALYN
  3331             MOVE AL-UANON       TO  BALYNA
  3332           ELSE
  3333             MOVE -1             TO  BALYNL
  3334             MOVE AL-UABON       TO  BALYNA
  3335             MOVE ER-2927        TO  EMI-ERROR
  3336             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3337             ADD +1  TO  WS-ERROR-COUNT.
  3338
  3339********** REGULAR PAYMENT AMOUNT
  3340*    IF BALPAYL GREATER THAN ZERO
  3341*        EXEC CICS BIF DEEDIT
  3342*            FIELD  (BALPAYI)
  3343*            LENGTH (12)
  3344*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL680.cbl
  3345*        IF BALPAYI NUMERIC  AND
  3346*           BALPAYI NOT = ZERO
  3347*            MOVE BALPAYI        TO  WS-REGULAR-PAYMENT
  3348*                                    BALPAYO
  3349*            MOVE AL-UNNON       TO  BALPAYA
  3350*          ELSE
  3351*            MOVE -1             TO  BALPAYL
  3352*            MOVE AL-UNBON       TO  BALPAYA
  3353*            MOVE ER-2927        TO  EMI-ERROR
  3354*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3355*            ADD +1  TO  WS-ERROR-COUNT.
  3356
  3357     IF WS-ERROR-COUNT GREATER THAN ZERO
  3358         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL680.cbl
  3360
  3361 4000-PERFORM-CALCULATIONS.
  3362     IF WS-FREQ = 'MO'
  3363          MOVE 12 TO PPY.
  3364     IF WS-FREQ = '13'
  3365          MOVE 13 TO PPY.
  3366     IF WS-FREQ = 'SM'
  3367          MOVE 24 TO PPY.
  3368     IF WS-FREQ = 'BW'
  3369          MOVE 26 TO PPY.
  3370     IF WS-FREQ = 'WK'
  3371          MOVE 52 TO PPY.
  3372     IF WS-FREQ = 'SA'
  3373          MOVE 2 TO PPY.
  3374     IF WS-FREQ = 'AN'
  3375          MOVE 1 TO PPY.
  3376
  3377     IF WS-BASIS-X = 'AF'
  3378          MOVE 1 TO WS-BASIS.
  3379     IF WS-BASIS-X = 'TP'
  3380          MOVE 2 TO WS-BASIS.
  3381     IF WS-BASIS-X = 'NP'
  3382          MOVE 3 TO WS-BASIS.
  3383
  3384     MOVE WS-AMOUNT-REQUESTED TO OTF.
  3385
  3386     COMPUTE I = WS-APR / (100 * PPY).
  3387
  3388     MOVE WS-ADDTL-DAYS TO ADL-DAYS.
  3389
  3390     COMPUTE ADL-ADJ = 1 + I * ADL-DAYS / (365 / PPY).
  3391
  3392     COMPUTE ATF = OTF * ADL-ADJ.
  3393
  3394     MOVE WS-TRUNC TO COV-TERM.
  3395
  3396     MOVE WS-PAYMENTS-COVERED TO AHN.
  3397
  3398     MOVE WS-NUMBER-OF-PMTS TO N.
  3399
  3400     IF AHN LESS 1
  3401         MOVE COV-TERM TO AHN.
  3402
  3403     IF AHN LESS 1
  3404         MOVE N TO AHN.
  3405
  3406     MOVE WS-EXTRA TO EMII.
  3407
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL680.cbl
  3409
  3410 4000-CONTINUE-CALCS-1.
  3411********* M USED FOR TRUNCATED NET PAY
  3412     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3413                         OR 'LGX'
  3414        IF WS-TRUNC NOT EQUAL +0
  3415           MOVE WS-TRUNC         TO M.
  3416
  3417     MOVE WS-LIFE-RATE TO LIFE-RATE.
  3418
  3419     COMPUTE LR = (LIFE-RATE / 100) * 12 / PPY.
  3420
  3421     COMPUTE LIFEDEV = WS-LIFE-DEVIATION / 100.
  3422
  3423     COMPUTE LR = LR * LIFEDEV.
  3424
  3425     MOVE WS-AH-RATE TO AH-RATE.
  3426
  3427     COMPUTE AH = AH-RATE / 100.
  3428
  3429     COMPUTE AHDEV = WS-AH-DEVIATION / 100.
  3430
  3431     COMPUTE AH = AH * AHDEV.
  3432
  3433****** BALLOON RATE
  3434     MOVE WS-BL-RATE TO BL-RATE.
  3435
  3436     COMPUTE BL = BL-RATE / 100.
  3437*******************
  3438
  3439*****  N1 USED FOR O/B
  3440     IF COV-TERM = ZERO
  3441        COMPUTE N1 = N * 12 / PPY
  3442       ELSE
  3443        COMPUTE N1 = COV-TERM * 12 / PPY.
  3444
  3445     COMPUTE K1 = 12 / PPY.
  3446
  3447     IF PPY = 1 OR 2
  3448         MOVE 1     TO K1.
  3449
  3450     COMPUTE PADJ = (N1 + K1) / (N1 + 1).
  3451
  3452     IF WS-OBYN = 'Y'
  3453        IF PI-COMPANY-ID EQUAL 'CSO' OR 'CID' OR 'LGX' OR 'AHL'
  3454        COMPUTE L = LR * PADJ * M / 12 * (N1 + 1) / 20 * 12 / N1
  3455        ELSE
  3456        COMPUTE L = LR * PADJ * N / 12 * (N1 + 1) / 20 * 12 / N1
  3457     ELSE
  3458        IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3459                         OR 'CID' OR 'AHL'
  3460                         OR 'LGX'
  3461           COMPUTE L = LR * PADJ * M / 12
  3462        ELSE
  3463*          COMPUTE L = LR * PADJ * N / 12.
  3464           COMPUTE L = LR * PADJ * AHN / 12.
  3465
  3466     IF WS-BALLOON-AMOUNT NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL680.cbl
  3467         GO TO 7000-BALLOON-CALC.
  3468
  3469     COMPUTE V = 1 / (1 + I).
  3470
  3471     COMPUTE VU = 1 - V ** N.
  3472
  3473     COMPUTE ANGLN = VU / I.
  3474
  3475     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3476                         OR 'CID' OR 'AHL'
  3477                         OR 'LGX'
  3478        COMPUTE TOT-PMTS = I / VU * M
  3479     ELSE
  3480        COMPUTE TOT-PMTS = I / VU * N.
  3481
  3482     COMPUTE ATOT-PMTS = I / VU * AHN.
  3483
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL680.cbl
  3485
  3486 4000-CONTINUE-CALCS-2.
  3487     GO TO 4000-COMM, 4000-COMM, 4000-NP
  3488         DEPENDING ON WS-BASIS.
  3489
  3490 4000-NP.
  3491     MOVE COV-TERM TO M.
  3492     IF M = 0
  3493        MOVE N TO M.
  3494
  3495     COMPUTE VU1 = 1 - V ** (N - M).
  3496
  3497     COMPUTE ANGLM = VU1 / I.
  3498
  3499     COMPUTE VA = (M - ANGLN + ANGLM) * 2 * N
  3500                   / (I * M * (2 * N - M + 1) * ANGLN).
  3501
  3502     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3503                         OR 'CID' OR 'AHL'
  3504                         OR 'LGX'
  3505        COMPUTE VA = VA * ((1 + N) / (1 + M)).
  3506
  3507     COMPUTE RA = 1 - (N - M) * (N - M + 1) / (N * (N + 1)).
  3508
  3509     COMPUTE TA = VA * RA.
  3510
  3511     COMPUTE NPLF = TA * L * (1 + EMII * I).
  3512
  3513     IF WS-NPBEN = 'Y'
  3514        COMPUTE NPLF = NPLF / (1 - NPLF).
  3515
  3516 4000-COMM.
  3517     MOVE ZERO TO LIFE-PREM AH-PREM.
  3518
  3519     PERFORM 4000-GET-PREMIUM THRU 4000-EXIT.
  3520     GO TO 6000-DISPLAY-RESULTS.
  3521
  3522 4000-GET-PREMIUM.
  3523     PERFORM 5000-COMPUTE-PREMIUMS THRU 5000-EXIT
  3524         VARYING XREPT FROM +1 BY +1 UNTIL XREPT = +15.
  3525 4000-EXIT.
  3526     EXIT.
  3527
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL680.cbl
  3529
  3530 5000-COMPUTE-PREMIUMS.
  3531     GO TO 5000-AF, 5000-TP, 5000-NP
  3532         DEPENDING ON WS-BASIS.
  3533
  3534 5000-AF.
  3535     COMPUTE LIFE-PREM = L / (1 - L) * (1 + AH-PREM).
  3536     GO TO 5000-GET-AH-PREM.
  3537
  3538 5000-TP.
  3539     COMPUTE LIFE-PREM = TOT-PMTS * L / (1 - TOT-PMTS * L)
  3540                             * (1 + AH-PREM).
  3541     GO TO 5000-GET-AH-PREM.
  3542
  3543 5000-NP.
  3544     COMPUTE LIFE-PREM = NPLF * (1 + AH-PREM).
  3545     GO TO 5000-GET-AH-PREM.
  3546
  3547 5000-GET-AH-PREM.
  3548     COMPUTE AH-PREM = ATOT-PMTS * AH / (1 - ATOT-PMTS * AH)
  3549                             * (1 + LIFE-PREM).
  3550
  3551     IF AH = 0 OR
  3552        LR = 0
  3553          GO TO 4000-EXIT.
  3554
  3555 5000-EXIT.
  3556     EXIT.
  3557
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL680.cbl
  3559
  3560 6000-DISPLAY-RESULTS.
  3561     IF CHG-LF OR CHG-LF-AH
  3562         COMPUTE L-PREMIUM = LIFE-PREM * ATF
  3563       ELSE
  3564         COMPUTE L-PREMIUM = LIFE-PREM * OTF.
  3565
  3566     COMPUTE L-PREMIUM = (L-PREMIUM * 100 + .502) / 100.
  3567
  3568     IF CHG-AH OR CHG-LF-AH
  3569         COMPUTE A-PREMIUM = AH-PREM * ATF
  3570       ELSE
  3571         COMPUTE A-PREMIUM = AH-PREM * OTF.
  3572
  3573     COMPUTE A-PREMIUM = (A-PREMIUM * 100 + .502) / 100.
  3574
  3575     COMPUTE PAYMENT = I / VU * (ATF + L-PREMIUM + A-PREMIUM).
  3576
  3577     COMPUTE PAYMENT = (PAYMENT * 100 + .002) / 100.
  3578
  3579     COMPUTE TOT-FIN = OTF + L-PREMIUM + A-PREMIUM.
  3580
  3581     COMPUTE TOT-PAYMT = N * PAYMENT.
  3582
  3583     COMPUTE TOT-INTRS = TOT-PAYMT - TOT-FIN.
  3584
  3585 6500-COMMON-DISPLAY.
  3586     MOVE TOT-FIN             TO BAMOUNTO.
  3587
  3588     MOVE L-PREMIUM           TO BLAMTO.
  3589     MOVE A-PREMIUM           TO BDAMTO.
  3590     MOVE PAYMENT             TO BMOPMTO.
  3591     MOVE TOT-PAYMT           TO BTOTPMTO.
  3592     MOVE TOT-INTRS           TO BTOTINTO.
  3593     MOVE B                   TO BALPMTO.
  3594
  3595     MOVE -1                  TO ANAMEL.
  3596     GO TO 8200-SEND-DATAONLY.
  3597
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL680.cbl
  3599 7000-BALLOON-CALC.
  3600     MOVE WS-BALLOON-AMOUNT   TO B.
  3601*    MOVE WS-REGULAR-PAYMENT  TO MP.
  3602
  3603     COMPUTE V = 1 / (1 + I).
  3604
  3605     COMPUTE V-NTH = V ** N.
  3606
  3607     COMPUTE ANGLN = (1 - V-NTH) / I.
  3608
  3609     COMPUTE ANGLN-LESS-1 = (1 - V-NTH / V) / I.
  3610
  3611     COMPUTE NM1 = N - 1.
  3612
  3613     COMPUTE AEQ = N / (N + 1).
  3614
  3615     IF WS-BALYN = 'Y'
  3616         MOVE N TO NM1
  3617         MOVE ANGLN TO ANGLN-LESS-1
  3618         MOVE 1 TO AEQ.
  3619
  3620     IF WS-BASIS = 2
  3621         GO TO 7500-TP-BALLOON.
  3622
  3623*    IF MP NOT = ZERO
  3624*        GO TO 7200-REGULAR-PAYMENT.
  3625
  3626     COMPUTE MPT = (N + 1) / 2 * (ATF - B * V-NTH) + L * (1 + EMII
  3627                  * I) * B * ANGLN.
  3628
  3629     COMPUTE MPB = (N + 1) / 2 * (ANGLN-LESS-1 - NM1 * AH) - L
  3630                   * (1 + EMII * I) * ((NM1 - ANGLN-LESS-1) / I).
  3631
  3632     DIVIDE MPT BY MPB GIVING MP.
  3633
  3634     GO TO 8000-DISPLAY-BALLOON-RESULTS.
  3635
  3636 7200-REGULAR-PAYMENT.
  3637     COMPUTE MPB = (N + 1) / 2 * (ANGLN-LESS-1 - NM1 * AH) - L
  3638                    * (1 + EMII * I) * (NM1 - ANGLN-LESS-1) / I.
  3639
  3640     COMPUTE B = (MPB * MP - (N + 1) / 2 * ATF) / (L * (1 + EMII
  3641                   * I) * ANGLN - (N + 1) / 2 * V-NTH).
  3642
  3643     GO TO 8000-DISPLAY-BALLOON-RESULTS.
  3644
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL680.cbl
  3646 7500-TP-BALLOON.
  3647*    IF MP NOT = ZERO
  3648*        GO TO 7600-REGULAR-PAYMENT.
  3649
  3650     COMPUTE MPT = (ATF - B * V-NTH) + L * B * 2 * N / (N + 1).
  3651
  3652     COMPUTE MPB = (ANGLN-LESS-1 - NM1 * AH) - L * NM1 * AEQ.
  3653
  3654     COMPUTE MP = MPT / MPB.
  3655
  3656     GO TO 7700-SKIP.
  3657
  3658 7600-REGULAR-PAYMENT.
  3659     COMPUTE MPB = (ANGLN-LESS-1 - NM1 * AH) - L * NM1 * AEQ.
  3660
  3661     COMPUTE B = (MPB * MP - ATF) / (L * 2 * N / (N + 1) - V-NTH).
  3662
  3663 7700-SKIP.
  3664     COMPUTE IA = MP * NM1 + B.
  3665
  3666     IF WS-BALYN = 'Y'
  3667         COMPUTE VA = 1 + B / IA * (N - 1) / (N + 1)
  3668      ELSE
  3669         COMPUTE VA = N * (IA + B) / (IA * (N + 1)).
  3670
  3671 8000-DISPLAY-BALLOON-RESULTS.
  3672     COMPUTE A-PREMIUM = NM1 * MP * AH.
  3673
  3674     IF WS-BASIS = 2
  3675        COMPUTE L-PREMIUM = L * IA * VA
  3676      ELSE
  3677        COMPUTE L-PREMIUM = MP * ANGLN-LESS-1 + B * V-NTH - ATF -
  3678                A-PREMIUM.
  3679
  3680** IF BALLOON RATE KEYED, ADD PREMIUM TO LIFE PREMIUM
  3681     IF BL GREATER ZERO
  3682         COMPUTE L-PREMIUM = L-PREMIUM + (B * BL).
  3683
  3684     COMPUTE L-PREMIUM = (L-PREMIUM * 100 + .502) / 100.
  3685
  3686     COMPUTE A-PREMIUM = (A-PREMIUM * 100 + .502) / 100.
  3687
  3688     COMPUTE TOT-FIN = OTF + L-PREMIUM + A-PREMIUM.
  3689
  3690     COMPUTE MP = (MP * 100 + .002) / 100.
  3691     COMPUTE TOT-PAYMT = MP * NM1 + B.
  3692     MOVE MP TO PAYMENT.
  3693
  3694     COMPUTE TOT-INTRS = TOT-PAYMT - TOT-FIN.
  3695
  3696     GO TO 6500-COMMON-DISPLAY.
  3697
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL680.cbl
  3699 8100-SEND-INITIAL-MAP SECTION.
  3700     MOVE LOW-VALUES             TO  EL680AI.
  3701
  3702     MOVE SAVE-DATE              TO  ADATEO.
  3703     MOVE EIBTIME                TO  WS-TIME-WORK.
  3704     MOVE WS-TIME                TO  ATIMEO.
  3705
  3706     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3707
  3708
  3709* EXEC CICS SEND
  3710*        FROM   (EL680AI)
  3711*        MAPSET (MAPSET-NAME)
  3712*        MAP    (MAP-NAME)
  3713*        ERASE
  3714*    END-EXEC.
  3715     MOVE LENGTH OF
  3716      EL680AI
  3717       TO DFHEIV11
  3718*    MOVE '8$      T  E    H L F ,   #00003533' TO DFHEIV0
  3719     MOVE X'382420202020202054202045' TO DFHEIV0(1:12)
  3720     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3721     MOVE X'2020233030303033353333' TO DFHEIV0(25:11)
  3722     CALL 'kxdfhei1' USING DFHEIV0,
  3723           MAP-NAME,
  3724           EL680AI,
  3725           DFHEIV11,
  3726           MAPSET-NAME,
  3727           DFHEIV99,
  3728           DFHEIV99,
  3729           DFHEIV99,
  3730           DFHEIV99,
  3731           DFHEIV99,
  3732           DFHEIV99,
  3733           DFHEIV99
  3734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3735
  3736
  3737     GO TO 9100-RETURN-TRAN.
  3738
  3739 8100-EXIT.
  3740      EXIT.
  3741
  3742 8200-SEND-DATAONLY SECTION.
  3743     MOVE SAVE-DATE              TO  ADATEO.
  3744     MOVE EIBTIME                TO  WS-TIME-WORK.
  3745     MOVE WS-TIME                TO  ATIMEO.
  3746
  3747     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3748
  3749     IF EMI-ERROR = 0
  3750        IF EIBAID = DFHPF1
  3751           MOVE SPACE            TO EIBAID
  3752           PERFORM 9000-START-PRINTER THRU 9000-EXIT
  3753           MOVE SPACES           TO SPC-FLD
  3754           MOVE SPC-FLD          TO PFENTERI
  3755           MOVE 0                TO PFENTERL
  3756           MOVE AL-UNNOF         TO PFENTERA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL680.cbl
  3757
  3758
  3759* EXEC CICS SEND DATAONLY
  3760*        FROM   (EL680AI)
  3761*        MAPSET (MAPSET-NAME)
  3762*        MAP    (MAP-NAME)
  3763*        CURSOR
  3764*    END-EXEC.
  3765     MOVE LENGTH OF
  3766      EL680AI
  3767       TO DFHEIV12
  3768     MOVE -1
  3769       TO DFHEIV11
  3770*    MOVE '8$D    CT       H L F ,   #00003561' TO DFHEIV0
  3771     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3772     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3773     MOVE X'2020233030303033353631' TO DFHEIV0(25:11)
  3774     CALL 'kxdfhei1' USING DFHEIV0,
  3775           MAP-NAME,
  3776           EL680AI,
  3777           DFHEIV12,
  3778           MAPSET-NAME,
  3779           DFHEIV99,
  3780           DFHEIV99,
  3781           DFHEIV99,
  3782           DFHEIV11,
  3783           DFHEIV99,
  3784           DFHEIV99,
  3785           DFHEIV99
  3786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3787
  3788
  3789     GO TO 9100-RETURN-TRAN.
  3790
  3791 8200-EXIT.
  3792     EXIT.
  3793
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL680.cbl
  3795 8300-SEND-TEXT SECTION.
  3796
  3797* EXEC CICS SEND TEXT
  3798*        FROM   (LOGOFF-TEXT)
  3799*        LENGTH (LOGOFF-LENGTH)
  3800*        ERASE  FREEKB
  3801*    END-EXEC.
  3802*    MOVE '8&      T  E F  H   F -   #00003575' TO DFHEIV0
  3803     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3804     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3805     MOVE X'2020233030303033353735' TO DFHEIV0(25:11)
  3806     CALL 'kxdfhei1' USING DFHEIV0,
  3807           LOGOFF-TEXT,
  3808           LOGOFF-LENGTH,
  3809           DFHEIV99,
  3810           DFHEIV99,
  3811           DFHEIV99,
  3812           DFHEIV99,
  3813           DFHEIV99,
  3814           DFHEIV99,
  3815           DFHEIV99,
  3816           DFHEIV99,
  3817           DFHEIV99,
  3818           DFHEIV99
  3819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3820
  3821
  3822
  3823* EXEC CICS RETURN
  3824*    END-EXEC.
  3825*    MOVE '.(                    &   #00003581' TO DFHEIV0
  3826     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3827     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3828     MOVE X'2020233030303033353831' TO DFHEIV0(25:11)
  3829     CALL 'kxdfhei1' USING DFHEIV0,
  3830           DFHEIV99,
  3831           DFHEIV99,
  3832           DFHEIV99,
  3833           DFHEIV99,
  3834           DFHEIV99
  3835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3836
  3837
  3838 8300-EXIT.
  3839     EXIT.
  3840
  3841 8400-NOT-FOUND.
  3842     MOVE ER-0190                TO EMI-ERROR.
  3843     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3844     GO TO 8200-SEND-DATAONLY.
  3845
  3846 8820-TERMID-ERROR.
  3847     MOVE ER-0412                TO EMI-ERROR.
  3848     GO TO 8999-OPEN-ERROR.
  3849
  3850 8830-TRANS-ERROR.
  3851     MOVE ER-0413                TO EMI-ERROR.
  3852     GO TO 8999-OPEN-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL680.cbl
  3853
  3854 8840-CNTL-NOT-OPEN.
  3855     MOVE ER-0042 TO EMI-ERROR.
  3856     GO TO 8999-OPEN-ERROR.
  3857
  3858 8800-UNAUTHORIZED-ACCESS.
  3859     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3860     GO TO 8300-SEND-TEXT.
  3861
  3862 8810-PF23.
  3863     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3864     MOVE XCTL-005               TO PGM-NAME.
  3865     GO TO 9300-XCTL.
  3866
  3867 8999-OPEN-ERROR.
  3868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3869     GO TO 8200-SEND-DATAONLY.
  3870
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL680.cbl
  3872 9000-START-PRINTER.
  3873     MOVE PI-COMPANY-ID TO CNTL-COMP-ID.
  3874
  3875
  3876* EXEC CICS HANDLE CONDITION
  3877*         NOTOPEN     (8840-CNTL-NOT-OPEN)
  3878*         NOTFND      (8400-NOT-FOUND)
  3879*         TERMIDERR   (8820-TERMID-ERROR)
  3880*         TRANSIDERR  (8830-TRANS-ERROR)
  3881*    END-EXEC.
  3882*    MOVE '"$JI[\                ! # #00003621' TO DFHEIV0
  3883     MOVE X'22244A495B5C202020202020' TO DFHEIV0(1:12)
  3884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3885     MOVE X'2320233030303033363231' TO DFHEIV0(25:11)
  3886     CALL 'kxdfhei1' USING DFHEIV0
  3887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3888
  3889
  3890     MOVE '1'        TO CNTL-REC-TYPE.
  3891     MOVE SPACES     TO CNTL-ACCESS.
  3892     MOVE +0         TO CNTL-SEQ-NO.
  3893
  3894
  3895* EXEC CICS READ
  3896*        DATASET ('ELCNTL')
  3897*        SET     (ADDRESS OF CONTROL-FILE)
  3898*        RIDFLD  (ELCNTL-KEY)
  3899*    END-EXEC.
  3900     MOVE 'ELCNTL' TO DFHEIV1
  3901*    MOVE '&"S        E          (   #00003632' TO DFHEIV0
  3902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3904     MOVE X'2020233030303033363332' TO DFHEIV0(25:11)
  3905     CALL 'kxdfhei1' USING DFHEIV0,
  3906           DFHEIV1,
  3907           DFHEIV20,
  3908           DFHEIV99,
  3909           ELCNTL-KEY,
  3910           DFHEIV99,
  3911           DFHEIV99,
  3912           DFHEIV99
  3913     SET ADDRESS OF CONTROL-FILE TO
  3914         DFHEIV20
  3915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3916
  3917
  3918     IF PI-COMPANY-ID = 'DMD' OR 'CID' OR 'AHL'
  3919*        MOVE EIBTRMID       TO CF-FORMS-PRINTER-ID
  3920         MOVE EL680AI        TO PI-PROGRAM-WORK-AREA
  3921
  3922* EXEC CICS START
  3923*             INTERVAL  (0)
  3924*             TRANSID   (START-TRANS-ID)
  3925*             FROM      (PROGRAM-INTERFACE-BLOCK)
  3926*             LENGTH    (PI-COMM-LENGTH)
  3927*             TERMID (CF-FORMS-PRINTER-ID)
  3928*             END-EXEC
  3929     MOVE 0 TO DFHEIV10
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL680.cbl
  3930*    MOVE '0(ILF                 0   #00003641' TO DFHEIV0
  3931     MOVE X'3028494C4620202020202020' TO DFHEIV0(1:12)
  3932     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  3933     MOVE X'2020233030303033363431' TO DFHEIV0(25:11)
  3934     CALL 'kxdfhei1' USING DFHEIV0,
  3935           DFHEIV10,
  3936           START-TRANS-ID,
  3937           DFHEIV99,
  3938           PROGRAM-INTERFACE-BLOCK,
  3939           PI-COMM-LENGTH,
  3940           DFHEIV99,
  3941           DFHEIV99,
  3942           DFHEIV99,
  3943           DFHEIV99,
  3944           DFHEIV99,
  3945           DFHEIV99,
  3946           DFHEIV99,
  3947           DFHEIV99,
  3948           DFHEIV99,
  3949           DFHEIV99
  3950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3951     ELSE
  3952
  3953* EXEC CICS START
  3954*            TRANSID(START-TRANS-ID)
  3955*            TERMID (CF-FORMS-PRINTER-ID)
  3956*            FROM   (EL680AI)
  3957*            LENGTH (426)
  3958*        END-EXEC.
  3959     MOVE 426
  3960       TO DFHEIV11
  3961*    MOVE '0( LFT                0   #00003649' TO DFHEIV0
  3962     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  3963     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  3964     MOVE X'2020233030303033363439' TO DFHEIV0(25:11)
  3965     CALL 'kxdfhei1' USING DFHEIV0,
  3966           DFHEIV99,
  3967           START-TRANS-ID,
  3968           DFHEIV99,
  3969           EL680AI,
  3970           DFHEIV11,
  3971           CF-FORMS-PRINTER-ID,
  3972           DFHEIV99,
  3973           DFHEIV99,
  3974           DFHEIV99,
  3975           DFHEIV99,
  3976           DFHEIV99,
  3977           DFHEIV99,
  3978           DFHEIV99,
  3979           DFHEIV99,
  3980           DFHEIV99
  3981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3982
  3983
  3984 9000-EXIT.
  3985     EXIT.
  3986
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL680.cbl
  3988 9100-RETURN-TRAN.
  3989     MOVE    EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3990     MOVE SCREEN-NUMBER             TO PI-CURRENT-SCREEN-NO.
  3991
  3992* EXEC CICS RETURN
  3993*        TRANSID    (TRANS-ID)
  3994*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3995*        LENGTH     (PI-COMM-LENGTH)
  3996*    END-EXEC.
  3997*    MOVE '.(CT                  &   #00003663' TO DFHEIV0
  3998     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3999     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4000     MOVE X'2020233030303033363633' TO DFHEIV0(25:11)
  4001     CALL 'kxdfhei1' USING DFHEIV0,
  4002           TRANS-ID,
  4003           PROGRAM-INTERFACE-BLOCK,
  4004           PI-COMM-LENGTH,
  4005           DFHEIV99,
  4006           DFHEIV99
  4007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4008
  4009
  4010
  4011* GOBACK.
  4012     MOVE '9%                    "   ' TO DFHEIV0
  4013     MOVE 'EL680' TO DFHEIV1
  4014     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4015     GOBACK.
  4016
  4017 9200-RETURN-MAIN-MENU.
  4018     MOVE XCTL-626               TO PGM-NAME.
  4019     GO TO 9300-XCTL.
  4020
  4021 9300-XCTL.
  4022
  4023* EXEC CICS XCTL
  4024*        PROGRAM    (PGM-NAME)
  4025*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4026*        LENGTH     (PI-COMM-LENGTH)
  4027*    END-EXEC.
  4028*    MOVE '.$C                   $   #00003676' TO DFHEIV0
  4029     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4030     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4031     MOVE X'2020233030303033363736' TO DFHEIV0(25:11)
  4032     CALL 'kxdfhei1' USING DFHEIV0,
  4033           PGM-NAME,
  4034           PROGRAM-INTERFACE-BLOCK,
  4035           PI-COMM-LENGTH
  4036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4037
  4038
  4039 9400-CLEAR.
  4040     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  4041     GO TO 9300-XCTL.
  4042
  4043 9500-PF12.
  4044     MOVE XCTL-010               TO PGM-NAME.
  4045     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL680.cbl
  4046
  4047 9600-PGMID-ERROR.
  4048
  4049* EXEC CICS HANDLE CONDITION
  4050*        PGMIDERR    (8300-SEND-TEXT)
  4051*    END-EXEC.
  4052*    MOVE '"$L                   ! $ #00003691' TO DFHEIV0
  4053     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4055     MOVE X'2420233030303033363931' TO DFHEIV0(25:11)
  4056     CALL 'kxdfhei1' USING DFHEIV0
  4057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4058
  4059
  4060     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  4061     MOVE ' '                    TO PI-ENTRY-CD-1.
  4062     MOVE XCTL-005               TO PGM-NAME.
  4063     MOVE PGM-NAME               TO LOGOFF-PGM.
  4064     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  4065     GO TO 9300-XCTL.
  4066
  4067 9700-LINK-DATE-CONVERT.
  4068
  4069* EXEC CICS LINK
  4070*        PROGRAM    ('ELDATCV')
  4071*        COMMAREA   (DATE-CONVERSION-DATA)
  4072*        LENGTH     (DC-COMM-LENGTH)
  4073*    END-EXEC.
  4074     MOVE 'ELDATCV' TO DFHEIV1
  4075*    MOVE '."C                   ''   #00003703' TO DFHEIV0
  4076     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4077     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4078     MOVE X'2020233030303033373033' TO DFHEIV0(25:11)
  4079     CALL 'kxdfhei1' USING DFHEIV0,
  4080           DFHEIV1,
  4081           DATE-CONVERSION-DATA,
  4082           DC-COMM-LENGTH,
  4083           DFHEIV99,
  4084           DFHEIV99,
  4085           DFHEIV99
  4086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4087
  4088
  4089 9700-EXIT.
  4090     EXIT.
  4091
  4092 9900-ERROR-FORMAT.
  4093     IF NOT EMI-ERRORS-COMPLETE
  4094         MOVE LINK-001           TO PGM-NAME
  4095
  4096* EXEC CICS LINK
  4097*            PROGRAM    (PGM-NAME)
  4098*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  4099*            LENGTH     (EMI-COMM-LENGTH)
  4100*        END-EXEC.
  4101*    MOVE '."C                   ''   #00003715' TO DFHEIV0
  4102     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL680.cbl
  4104     MOVE X'2020233030303033373135' TO DFHEIV0(25:11)
  4105     CALL 'kxdfhei1' USING DFHEIV0,
  4106           PGM-NAME,
  4107           ERROR-MESSAGE-INTERFACE-BLOCK,
  4108           EMI-COMM-LENGTH,
  4109           DFHEIV99,
  4110           DFHEIV99,
  4111           DFHEIV99
  4112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4113
  4114
  4115 9900-EXIT.
  4116     EXIT.
  4117
  4118 9990-ABEND.
  4119     MOVE LINK-004               TO PGM-NAME.
  4120     MOVE DFHEIBLK               TO EMI-LINE1.
  4121
  4122
  4123* EXEC CICS LINK
  4124*        PROGRAM   (PGM-NAME)
  4125*        COMMAREA  (EMI-LINE1)
  4126*        LENGTH    (72)
  4127*    END-EXEC.
  4128     MOVE 72
  4129       TO DFHEIV11
  4130*    MOVE '."C                   ''   #00003728' TO DFHEIV0
  4131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4132     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4133     MOVE X'2020233030303033373238' TO DFHEIV0(25:11)
  4134     CALL 'kxdfhei1' USING DFHEIV0,
  4135           PGM-NAME,
  4136           EMI-LINE1,
  4137           DFHEIV11,
  4138           DFHEIV99,
  4139           DFHEIV99,
  4140           DFHEIV99
  4141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4142
  4143
  4144     GO TO 8200-SEND-DATAONLY.
  4145
  4146
  4147 9999-DFHBACK SECTION.
  4148     MOVE '9%                    "   ' TO DFHEIV0
  4149     MOVE 'EL680' TO DFHEIV1
  4150     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4151     GOBACK.
  4152 9999-DFHEXIT.
  4153     IF DFHEIGDJ EQUAL 0001
  4154         NEXT SENTENCE
  4155     ELSE IF DFHEIGDJ EQUAL 2
  4156         GO TO 8100-SEND-INITIAL-MAP
  4157         DEPENDING ON DFHEIGDI
  4158     ELSE IF DFHEIGDJ EQUAL 3
  4159         GO TO 8840-CNTL-NOT-OPEN,
  4160               8400-NOT-FOUND,
  4161               8820-TERMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL680.cbl
  4162               8830-TRANS-ERROR
  4163         DEPENDING ON DFHEIGDI
  4164     ELSE IF DFHEIGDJ EQUAL 4
  4165         GO TO 8300-SEND-TEXT
  4166         DEPENDING ON DFHEIGDI.
  4167     MOVE '9%                    "   ' TO DFHEIV0
  4168     MOVE 'EL680' TO DFHEIV1
  4169     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4170     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4328     Code:       10660
